* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL642.cbl
* Options: int("EL642.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL642.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL642.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL642.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL642 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/06/95 10:16:47.
     7*                            VMOD=2.031
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL642.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXH7 - GENERAL AGENT BILLING
    27*                           (PREPARE AN AGENT STATEMENT).
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    38* 050206    2005072800002  PEMA  ADD PROCESSING FOR DCC COMM.
    39* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    40* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    41******************************************************************
    42
    43 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL642.cbl
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*    EL642 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '***********VMOD 2.031 **********'.
    52 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    53 77  S1                          PIC S999 COMP-3 VALUE +0.
    54 77  CLAS-LOOK                   PIC XX      VALUE '  '.
    55
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL642.cbl
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL642.cbl
   108 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   109     88  RESP-NORMAL               VALUE +0.
   110     88  RESP-NOTFND               VALUE +13.
   111     88  RESP-NOTOPEN              VALUE +19.
   112     88  RESP-ENDFILE              VALUE +20.
   113 01  WS-AH-CATEGORY              PIC X   VALUE SPACES.
   114 01  STANDARD-AREAS.
   115     12  SC-ITEM             PIC S9(4)   COMP    VALUE +1.
   116
   117     12  W-TRANSFER-CONTROL.
   118         16  WT-CR-CARRIER           PIC X.
   119         16  WT-CR-GROUPING          PIC X(6).
   120         16  WT-CR-STATE             PIC XX.
   121         16  WT-CR-ACCOUNT           PIC X(10).
   122         16  WT-CR-FIN-RESP          PIC X(10).
   123         16  WT-CR-TYPE              PIC X.
   124
   125     12  GETMAIN-SPACE       PIC  X              VALUE SPACE.
   126     12  MAP-NAME            PIC  X(8)           VALUE 'EL642A'.
   127     12  MAPSET-NAME         PIC  X(8)           VALUE 'EL642S'.
   128     12  SCREEN-NUMBER       PIC  X(4)           VALUE '642A'.
   129     12  TRANS-ID            PIC  X(4)           VALUE 'EXH7'.
   130     12  EL633-TRANS-ID      PIC  X(4)           VALUE 'EXB7'.
   131     12  EL633DMD-TRANS-ID   PIC  X(4)           VALUE 'EX1F'.
   132     12  EL635-TRANS-ID      PIC  X(4)           VALUE 'EXJ4'.
   133     12  EL650-TRANS-ID      PIC  X(4)           VALUE 'EXC4'.
   134     12  EL652-TRANS-ID      PIC  X(4)           VALUE 'EXD4'.
   135     12  EL658-TRANS-ID      PIC  X(4)           VALUE 'EXJ3'.
   136     12  THIS-PGM            PIC  X(8)           VALUE 'EL642'.
   137     12  EL642A              PIC  X(8)           VALUE 'EL642A'.
   138     12  EL642B              PIC  X(8)           VALUE 'EL642B'.
   139     12  PGM-NAME            PIC  X(8).
   140     12  TIME-IN             PIC S9(7).
   141     12  TIME-OUT-R  REDEFINES  TIME-IN.
   142         16  FILLER          PIC  X.
   143         16  TIME-OUT        PIC  99V99.
   144         16  FILLER          PIC  XX.
   145     12  XCTL-005            PIC  X(8)           VALUE 'EL005'.
   146     12  XCTL-010            PIC  X(8)           VALUE 'EL010'.
   147     12  XCTL-626            PIC  X(8)           VALUE 'EL626'.
   148     12  XCTL-633            PIC  X(8)           VALUE 'EL633'.
   149     12  XCTL-633DMD         PIC  X(8)           VALUE 'EL633DMD'.
   150     12  XCTL-635            PIC  X(8)           VALUE 'EL635'.
   151     12  XCTL-PYAJ           PIC  X(8)           VALUE 'EL633'.
   152     12  XCTL-650            PIC  X(8)           VALUE 'EL650'.
   153     12  XCTL-652            PIC  X(8)           VALUE 'EL652'.
   154     12  XCTL-6401           PIC  X(8)           VALUE 'EL6401'.
   155     12  XCTL-658            PIC  X(8)           VALUE 'EL658'.
   156     12  LINK-001            PIC  X(8)           VALUE 'EL001'.
   157     12  LINK-004            PIC  X(8)           VALUE 'EL004'.
   158     12  LINK-ELDATCV        PIC  X(8)           VALUE 'ELDATCV'.
   159     12  ERPNDB-ALT-FILE-ID  PIC  X(8)           VALUE 'ERPNDB2'.
   160     12  ERPNDB-FILE-ID      PIC  X(8)           VALUE 'ERPNDB'.
   161     12  ELCNTL-FILE-ID      PIC  X(8)           VALUE 'ELCNTL'.
   162     12  ERCOMP-FILE-ID      PIC  X(8)           VALUE 'ERCOMP'.
   163     12  ERPYAJ-FILE-ID      PIC  X(8)           VALUE 'ERPYAJ'.
   164     12  ERACCT-ALT-FILE-ID  PIC  X(8)           VALUE 'ERACCT2'.
   165     12  ERACCT-FILE-ID      PIC  X(8)           VALUE 'ERACCT'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL642.cbl
   166     12  ERBILL-FILE-ID      PIC  X(8)           VALUE 'ERBILL'.
   167     12  ERGXRF-FILE-ID      PIC  X(8)           VALUE 'ERGXRF'.
   168     12  ERCOMM-FILE-ID      PIC  X(8)           VALUE 'ERCOMM'.
   169     12  ERCTBL-FILE-ID      PIC  X(8)           VALUE 'ERCTBL'.
   170     12  ERRESC-FILE-ID      PIC  X(8)           VALUE 'ERRESC'.
   171     12  RETURNED-FROM       PIC  X(8)           VALUE SPACES.
   172     12  QID.
   173         16  QID-TERM        PIC  X(4).
   174         16  FILLER          PIC  X(4)           VALUE '642A'.
   175
   176 01  WORK-AREA.
   177     12  FIRST-TIME-SW               PIC  X      VALUE 'Y'.
   178         88  FIRST-TIME                          VALUE 'Y'.
   179     12  COMPENSATION-SW             PIC  X      VALUE ' '.
   180         88  GENERAL-AGENT                       VALUE 'G'.
   181     12  LIFE-INDICATOR              PIC  X      VALUE ' '.
   182         88  JOINT-LIFE                          VALUE 'J'.
   183     12  BENEFIT-MASTER-FOUND-SW     PIC  X      VALUE ' '.
   184         88  BENEFIT-MASTER-FOUND                VALUE 'Y'.
   185     12  COMMISSION-TBL-SW           PIC  X      VALUE ' '.
   186         88  COMMISSION-TBL-PRESENT              VALUE 'Y'.
   187     12  INVALID-ACCOUNT-SW          PIC  X      VALUE ' '.
   188         88  INVALID-ACCOUNT                     VALUE 'Y'.
   189     12  NEW-ACCOUNT-SW              PIC  X      VALUE ' '.
   190         88  NEW-ACCOUNT                         VALUE 'Y'.
   191     12  VALID-BILL-TYPE-VALUES      PIC  X      VALUE SPACE.
   192         88  VALID-BILL-TYPE                     VALUE  '1' '2'
   193                                                    '3' '4' '5'.
   194     12  BILL-BATCH-TRAILER-SW       PIC  X      VALUE SPACE.
   195         88  BILL-BATCH-TRAILER                  VALUE 'Y'.
   196     12  ERCOMM-FOUND-SW             PIC  X      VALUE SPACE.
   197         88  ERCOMM-FOUND                        VALUE 'Y'.
   198         88  ERCOMM-NOT-FOUND                    VALUE 'N'.
   199     12  ERCTBL-FOUND-SW             PIC  X      VALUE SPACE.
   200         88  ERCTBL-FOUND                        VALUE 'Y'.
   201         88  ERCTBL-NOT-FOUND                    VALUE 'N'.
   202     12  GXRF-EOF-SW                 PIC  X      VALUE SPACE.
   203         88  GXRF-EOF                            VALUE 'Y'.
   204     12  PNDB-EOF-SW                 PIC  X      VALUE SPACE.
   205         88  PNDB-EOF                            VALUE 'Y'.
   206     12  PYAJ-EOF-SW                 PIC  X      VALUE SPACE.
   207         88  PYAJ-EOF                            VALUE 'Y'.
   208     12  COMP-UPDATE-SW              PIC  X      VALUE SPACE.
   209         88  UPDATE-COMP-TOTALS                  VALUE 'Y'.
   210     12  LIMIT-BILLING-SW            PIC  X      VALUE SPACE.
   211         88  LIMIT-BILLING                       VALUE 'Y'.
   212     12  WS-PROCESS-SW               PIC  X      VALUE SPACE.
   213         88  DO-NOT-BILL-THIS-ACCT               VALUE 'Y'.
   214     12  NO-BILL-REC-SW              PIC  X      VALUE SPACE.
   215         88  NO-BILL-RECS                        VALUE 'Y'.
   216     12  DATA-VOIDED-SW              PIC  X      VALUE SPACE.
   217         88  DATA-VOIDED                         VALUE 'Y'.
   218     12  BATCHES-PROCESSED-SW        PIC  X      VALUE SPACE.
   219         88  MORE-THAN-6-BATCHES                 VALUE 'Y'.
   220     12  ACCOUNT-CARRY-BAL-SW        PIC  X      VALUE SPACE.
   221         88  ACCOUNT-CARRY-BAL                   VALUE 'Y'.
   222     12  BILLING-DETAIL-TYPE         PIC  XX VALUE SPACES.
   223         88  TOTAL-STATEMENT                     VALUE 'TS'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL642.cbl
   224         88  TOTAL-ACCOUNT                       VALUE 'TA'.
   225         88  TOTAL-BOTH                          VALUE 'TB'.
   226         88  GEN-AGT-ADDRESS                     VALUE 'GA'.
   227     12  ELCNTL-UPDATE-SW            PIC  X      VALUE SPACE.
   228         88  ELCNTL-UPDATE                       VALUE 'Y'.
   229     12  WS-BILL-TYPE                PIC  X      VALUE SPACE.
   230         88  WS-UPDATE-FILES                     VALUE '3' '4'
   231                                                       '5'.
   232     12  SUB                     PIC S999 COMP-3 VALUE ZEROS.
   233     12  ACCOM-SUB               PIC  99 COMP VALUE ZEROS.
   234     12  GX-SUB                  PIC S9(4) COMP VALUE ZEROS.
   235     12  COMP-SUB                PIC S9(4) COMP VALUE ZEROS.
   236     12  CE-SUB                  PIC S9(4) COMP VALUE ZEROS.
   237     12  BEN-SUB                 PIC S9(4) COMP VALUE ZEROS.
   238     12  WORK-SEQ-NO             PIC S9(9) COMP-3.
   239     12  WS-ERROR-MSG.
   240         16  WS-ERROR-TEXT       PIC  X(35)      VALUE SPACES.
   241         16  WS-ERROR-BATCH      PIC  X(6)       VALUE SPACES.
   242         16  FILLER              PIC  X(24)      VALUE SPACES.
   243     12  WS-WORK-DATE.
   244         16  WS-MONTH            PIC  99         VALUE ZEROS.
   245         16  WS-DAY              PIC  99         VALUE ZEROS.
   246         16  WS-YEAR             PIC  99         VALUE ZEROS.
   247     12  WS-MONTH-END-DATE.
   248         16  WS-ME-YEAR          PIC  99         VALUE ZEROS.
   249         16  WS-ME-MONTH         PIC  99         VALUE ZEROS.
   250         16  WS-ME-DAY           PIC  99         VALUE ZEROS.
   251     12  WS-CURRENT-DATE         PIC  XX         VALUE SPACES.
   252     12  WS-CURRENT-DATE-MDY     PIC  X(6)       VALUE SPACES.
   253     12  WS-CURRENT-DATE-EDIT    PIC  X(8)       VALUE SPACES.
   254     12  WS-PREV-BILL-DATE       PIC  XX     VALUE LOW-VALUES.
   255     12  MONTHS-DIFF-LF          PIC S9(05).
   256     12  MONTHS-DIFF-AH          PIC S9(05).
   257     12  WS-LF-CANCEL-DATE.
   258         16  WS-LF-CANCEL-YR     PIC 99.
   259         16  WS-LF-CANCEL-MO     PIC 99.
   260         16  WS-LF-CANCEL-DA     PIC 99.
   261     12  WS-AH-CANCEL-DATE.
   262         16  WS-AH-CANCEL-YR     PIC 99.
   263         16  WS-AH-CANCEL-MO     PIC 99.
   264         16  WS-AH-CANCEL-DA     PIC 99.
   265     12  WS-EFFECT-DATE.
   266         16  WS-EFFECT-YR        PIC 99.
   267         16  WS-EFFECT-MO        PIC 99.
   268         16  WS-EFFECT-DA        PIC 99.
   269     12  WS-BEGIN-DATE.
   270         16  FILLER              PIC  X(3)       VALUE SPACES.
   271         16  WS-BEGIN-DAY        PIC  XX         VALUE SPACES.
   272         16  FILLER              PIC  X(3)       VALUE SPACES.
   273     12  PRINT-CONTROL.
   274         16  SINGLE-SPACE        PIC  X          VALUE SPACE.
   275         16  DOUBLE-SPACE        PIC  X          VALUE ZERO.
   276         16  TRIPLE-SPACE        PIC  X          VALUE '-'.
   277         16  SUPPRESS-SPACE      PIC  X          VALUE '+'.
   278         16  TOP-OF-PAGE         PIC  X          VALUE '1'.
   279     12  WS-EXP-DATE.
   280         16  WS-SAV-EXP-DT   OCCURS  10  TIMES
   281                 INDEXED BY  DTNDX   PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL642.cbl
   282     12  WS-REMIT-TO.
   283         16  WS-SAV-REMIT-TO     OCCURS  10  TIMES
   284                 INDEXED BY  RTNDX   PIC  X(6).
   285     12  WORK-REMIT-TO           PIC  X(6)       VALUE SPACES.
   286     12  WS-REMITTED             PIC S9(6)V99    VALUE ZEROS.
   287     12  WS-LINECTR              PIC  99         VALUE ZEROS.
   288     12  WS-PGECTR               PIC  9(3)       VALUE 1.
   289     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   290     12  WS-CARR-COMP.
   291         16  WS-CARRIER          PIC  X          VALUE SPACE.
   292         16  WS-COMP             PIC  X(3)       VALUE SPACES.
   293     12  WORK-AMT                PIC S9(7)V99    VALUE ZEROS.
   294     12  JOURNAL-LENGTH          PIC S9(4) COMP VALUE ZERO.
   295     12  LF-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   296     12  JT-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   297     12  AH-COMM-TBL-NO          PIC  X(3)       VALUE SPACES.
   298     12  AGENT-OWES              PIC  X(18)      VALUE
   299             'AGENT OWES       ='.
   300     12  OWED-TO-AGENT           PIC  X(18)      VALUE
   301             'OWED TO AGENT    ='.
   302     12  WS-PY-ENTRY-COMMENT.
   303         16  WS-PY-CURRENT-DATE  PIC  X(6).
   304         16  FILLER              PIC  X(14)      VALUE
   305                 ' CHK TO AGENT'.
   306     12  WS-ACCT-NOT-BILLED      PIC  X(18)      VALUE
   307             'ACCOUNT NOT BILLED'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL642.cbl
   309     12  WS-AGENT-ADDR-AREA.
   310         16  WS-AGENT-LINES  OCCURS  6  TIMES
   311                 INDEXED BY  A-INDX.
   312             20  WS-AGENT-ZIP.
   313                 24  WS-AGENT-1ST-ZIP    PIC  X(4).
   314                 24  WS-AGENT-2ND-ZIP    PIC  X(5).
   315             20  FILLER                  PIC  X(12).
   316             20  WS-A-LAST-ZIP.
   317                 24  WS-A-LAST-1ST-ZIP   PIC  X(4).
   318                 24  WS-A-LAST-2ND-ZIP   PIC  X(5).
   319     12  WS-COMPENSATION-WORK-AREA.
   320         16  WS-COMM-CK-AMT      PIC S9(5)V99 COMP-3 VALUE +0.
   321         16  WS-COMM-AGE         PIC  99.
   322         16  WS-COMM-TERM        PIC  9(3).
   323         16  WS-LF-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   324         16  WS-AH-ISS-COMP      PIC S9(5)V99 COMP-3 VALUE +0.
   325         16  WS-I-LF-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   326         16  WS-I-AH-PREMIUM-AMT PIC S9(7)V99 COMP-3 VALUE +0.
   327         16  WS-I-LF-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   328         16  WS-I-AH-BENEFIT-AMT PIC S9(9)V99 COMP-3 VALUE +0.
   329         16  WS-C-LF-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   330         16  WS-C-AH-CANCEL-AMT  PIC S9(7)V99 COMP-3 VALUE +0.
   331         16  WS-WK-RATE          PIC SV9(5)    COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL642.cbl
   333     12  WS-ACCOUNT-TOTALS       COMP-3.
   334         16  WS-ACCT-BEG-BAL         PIC S9(7)V99 VALUE ZEROS.
   335         16  WS-ACCT-NET-PREM        PIC S9(7)V99 VALUE ZEROS.
   336         16  WS-AH-ACCT-COMP         PIC S9(7)V99 VALUE ZEROS.
   337         16  WS-ACCT-COMP            PIC S9(7)V99 VALUE ZEROS.
   338         16  WS-ACCT-PAY-ADJS        PIC S9(7)V99 VALUE ZEROS.
   339         16  WS-ACCT-UNPAID-NET-PREM PIC S9(7)V99 VALUE ZEROS.
   340         16  WS-ACCT-LF-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   341         16  WS-ACCT-AH-OVERWRITE    PIC S9(7)V99 VALUE ZEROS.
   342     12  WS-GENERAL-AGENT-TOTALS COMP-3.
   343         16  WS-GA-BEG-BAL           PIC S9(7)V99 VALUE ZEROS.
   344         16  WS-GA-NET-PREM          PIC S9(7)V99 VALUE ZEROS.
   345         16  WS-GA-COMP              PIC S9(7)V99 VALUE ZEROS.
   346         16  WS-GA-PAY-ADJS          PIC S9(7)V99 VALUE ZEROS.
   347         16  WS-GA-UNPAID-NET-PREM   PIC S9(7)V99 VALUE ZEROS.
   348         16  WS-GA-LF-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   349         16  WS-GA-AH-OVERWRITE      PIC S9(7)V99 VALUE ZEROS.
   350         16  WS-GA-END-BAL           PIC S9(7)V99 VALUE ZEROS.
   351         16  WS-GA-AMT-DUE           PIC S9(7)V99 VALUE ZEROS.
   352     12  WS-GENERAL-AGENT-COMMISSIONS.
   353         16  WS-GA-LEVEL         PIC S99     COMP   VALUE +0.
   354         16  WS-GA-LF-COM        PIC SV9(5) COMP-3 VALUE +.0.
   355         16  WS-GA-AH-COM        PIC SV9(5) COMP-3 VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL642.cbl
   357 01  ACCESS-KEYS.
   358     12  ERPNDB-PRIME-KEY.
   359         16  ERPNDB-CO-CD        PIC  X          VALUE SPACES.
   360         16  ERPNDB-BATCH        PIC  X(6)       VALUE SPACES.
   361         16  ERPNDB-SEQ-NO       PIC S9(4) COMP.
   362         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP.
   363     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   364     12  ERPNDB-ALT-KEY.
   365         16  ERPNDB-CO-CD-A1     PIC  X          VALUE SPACES.
   366         16  ERPNDB-CARR         PIC  X          VALUE SPACES.
   367         16  ERPNDB-GROUP        PIC  X(6)       VALUE SPACES.
   368         16  ERPNDB-STATE        PIC  XX         VALUE SPACES.
   369         16  ERPNDB-ACCT         PIC  X(10)      VALUE SPACES.
   370         16  ERPNDB-EFF-DT       PIC  XX         VALUE SPACES.
   371         16  ERPNDB-CERT.
   372             20  ERPNDB-CERT-PRM PIC  X(10)      VALUE SPACES.
   373             20  ERPNDB-CERTSFX  PIC  X          VALUE SPACES.
   374         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   375         16  ERPNDB-REC-TYPE     PIC  X          VALUE SPACES.
   376     12  ELCNTL-KEY.
   377         16  ELCNTL-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   378         16  ELCNTL-REC-TYPE     PIC  X          VALUE SPACES.
   379         16  ELCNTL-ACCESS.
   380             20  ELCNTL-FILLER   PIC  X(3)       VALUE SPACES.
   381             20  ELCNTL-CARRIER  PIC  X          VALUE SPACES.
   382         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   383     12  ELCNTL-BENEFIT-KEY.
   384         16  CLBENF-COMPANY-ID   PIC  X(3)       VALUE SPACES.
   385         16  CLBENF-REC-TYPE     PIC  X          VALUE SPACES.
   386         16  CLBENF-ACCESS.
   387             20  FILLER          PIC  XX         VALUE SPACES.
   388             20  CLBENF-CD       PIC  XX         VALUE SPACES.
   389         16  CLBENF-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   390     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   391     12  ERCOMP-KEY.
   392         16  ERCOMP-COMP-CD      PIC  X          VALUE SPACE.
   393         16  ERCOMP-CARRIER      PIC  X          VALUE SPACES.
   394         16  ERCOMP-GROUPING     PIC  X(6)       VALUE SPACES.
   395         16  ERCOMP-FIN-RESP     PIC  X(10)      VALUE SPACES.
   396         16  ERCOMP-ACCT         PIC  X(10)      VALUE SPACES.
   397         16  ERCOMP-RECORD-TYPE  PIC  X          VALUE SPACES.
   398     12  ERPYAJ-BROWSE-COMP-KEY.
   399         16  ERPYAJ-BR-COMP-CD   PIC  X          VALUE SPACE.
   400         16  ERPYAJ-BR-CARRIER   PIC  X          VALUE SPACES.
   401         16  ERPYAJ-BR-GROUPING  PIC  X(6)       VALUE SPACES.
   402         16  ERPYAJ-BR-FIN-RESP  PIC  X(10)      VALUE SPACES.
   403         16  ERPYAJ-BR-ACCOUNT   PIC  X(10)      VALUE SPACES.
   404     12  ERCOMP-PREV-KEY         PIC  X(29)      VALUE SPACES.
   405     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   406     12  ERPYAJ-KEY.
   407         16  ERPYAJ-COMP-CD      PIC  X          VALUE SPACE.
   408         16  ERPYAJ-CARRIER      PIC  X          VALUE SPACES.
   409         16  ERPYAJ-GROUPING     PIC  X(6)       VALUE SPACES.
   410         16  ERPYAJ-FIN-RESP     PIC  X(10)      VALUE SPACES.
   411         16  ERPYAJ-ACCOUNT      PIC  X(10)      VALUE SPACES.
   412         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) COMP VALUE +0.
   413         16  ERPYAJ-RECORD-TYPE  PIC  X          VALUE SPACES.
   414     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL642.cbl
   415     12  ERACCT-PRIME-KEY.
   416         16  ERACCT-P-CO-CD      PIC  X          VALUE SPACES.
   417         16  ERACCT-P-CARRIER    PIC  X          VALUE SPACES.
   418         16  ERACCT-P-GROUPING   PIC  X(6)       VALUE SPACES.
   419         16  ERACCT-P-STATE      PIC  XX         VALUE SPACES.
   420         16  ERACCT-P-ACCOUNT    PIC  X(10)      VALUE SPACES.
   421         16  ERACCT-P-EXP-DATE   PIC  XX         VALUE SPACES.
   422         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   423     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   424     12  ERACCT-ALT-KEY.
   425         16  ERACCT-A-CO-CD      PIC  X          VALUE SPACES.
   426         16  ERACCT-A-CARRIER    PIC  X          VALUE SPACES.
   427         16  ERACCT-A-GROUPING   PIC  X(6)       VALUE SPACES.
   428         16  ERACCT-A-STATE      PIC  XX         VALUE SPACES.
   429         16  ERACCT-A-ACCOUNT    PIC  X(10)      VALUE SPACES.
   430         16  ERACCT-A-EXP-DATE   PIC  XX         VALUE SPACES.
   431         16  FILLER              PIC  X(4)   VALUE LOW-VALUES.
   432     12  ERBILL-KEY.
   433         16  ERBILL-CO-CD        PIC  X.
   434         16  ERBILL-CARRIER      PIC  X.
   435         16  ERBILL-GROUP        PIC  X(6).
   436         16  ERBILL-ACCT         PIC  X(10).
   437         16  ERBILL-FIN-RESP     PIC  X(10).
   438         16  ERBILL-REC-TYPE     PIC  X.
   439         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   440     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   441     12  ERGXRF-KEY.
   442         16  ERGXRF-COMPANY-CD   PIC  X.
   443         16  ERGXRF-CARRIER      PIC  X.
   444         16  ERGXRF-GROUPING     PIC  X(6).
   445         16  ERGXRF-AGENT-NO     PIC  X(10).
   446     12  ERGXRF-FIXED-LENGTH     PIC S9(4) COMP VALUE +64.
   447     12  ERGXRF-VAR-LENGTH       PIC S9(4) COMP VALUE +24.
   448     12  ERGXRF-LENGTH           PIC S9(4) COMP VALUE ZEROS.
   449     12  ERCOMM-KEY.
   450         16  ERCOMM-COMPANY-CD   PIC  X.
   451         16  ERCOMM-CARRIER      PIC  X.
   452         16  ERCOMM-GROUPING     PIC  X(6).
   453         16  ERCOMM-STATE        PIC  XX.
   454         16  ERCOMM-ACCOUNT      PIC  X(10).
   455         16  ERCOMM-CERT-EFF-DT  PIC  XX.
   456         16  ERCOMM-CERT-NO.
   457             20  CE-CERT-PRIME   PIC  X(10).
   458             20  CE-CERT-SFX     PIC  X.
   459     12  ERCOMM-LENGTH           PIC S9(4) COMP VALUE +250.
   460     12  ERCTBL-KEY.
   461         16  ERCTBL-COMPANY-CD       PIC  X.
   462         16  ERCTBL-TABLE            PIC  X(3).
   463         16  ERCTBL-CNTRL-2.
   464             20  ERCTBL-BEN-TYPE     PIC  X.
   465             20  ERCTBL-BEN-CODE     PIC  XX.
   466     12  ERCTBL-LENGTH               PIC S9(4) COMP VALUE +200.
   467     12  SAVE-ERACCT-PRIME-KEY.
   468         16  SV-ERACCT-P-CO-CD       PIC  X      VALUE SPACES.
   469         16  SV-ERACCT-P-CARRIER     PIC  X      VALUE SPACES.
   470         16  SV-ERACCT-P-GROUPING    PIC  X(6)   VALUE SPACES.
   471         16  SV-ERACCT-P-STATE       PIC  XX     VALUE SPACES.
   472         16  SV-ERACCT-P-ACCOUNT     PIC  X(10)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL642.cbl
   473         16  SV-ERACCT-P-EXP-DATE    PIC  XX     VALUE SPACES.
   474*****************************************************************
   475*      START OF WORKING STORAGE FOR CLIENT-DMD                  *
   476*****************************************************************
   477*RESIDENT STATE TAXES MASTER(ERRESC)
   478*
   479     12  WS-SV-ERRESC-KEY             PIC X(32).
   480
   481     12  WS-ERRESC-KEY.
   482         16 WS-ERRESC-SEARCH-KEY.
   483             20  WS-ERRESC-COMPANY-CD PIC  X.
   484             20  WS-ERRESC-CARRIER    PIC  X.
   485             20  WS-ERRESC-GROUP      PIC X(6).
   486             20  WS-ERRESC-STATE      PIC XX.
   487             20  WS-ERRESC-ACCOUNT    PIC X(10).
   488         16 WS-ERRESC-RESIDUAL-KEY.
   489             20  WS-ERRESC-AGENT      PIC X(10).
   490             20  WS-ERRESC-RES-STATE  PIC XX.
   491             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   492*                                          YYYYMMDD
   493     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   494     12  WS-SUB1                      PIC    S99 COMP-3.
   495     12  WS-SUB                       PIC    S99 COMP-3.
   496     12  WS-CONTRACT-DATE             PIC 9(8).
   497     12  WS-COMM-SW                   PIC XX VALUE SPACES.
   498         88  AH-COMM                             VALUE 'AH'.
   499         88  LF-COMM                             VALUE 'LF'.
   500*****************************************************************
   501*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   502*****************************************************************
   503
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL642.cbl
   505 01  ERROR-NUMBERS.
   506     12  ER-0004             PIC  X(4)           VALUE '0004'.
   507     12  ER-0008             PIC  X(4)           VALUE '0008'.
   508     12  ER-0022             PIC  X(4)           VALUE '0022'.
   509     12  ER-0028             PIC  X(4)           VALUE '0028'.
   510     12  ER-0029             PIC  X(4)           VALUE '0029'.
   511     12  ER-0070             PIC  X(4)           VALUE '0070'.
   512     12  ER-0194             PIC  X(4)           VALUE '0194'.
   513     12  ER-0195             PIC  X(4)           VALUE '0195'.
   514     12  ER-0196             PIC  X(4)           VALUE '0196'.
   515     12  ER-0197             PIC  X(4)           VALUE '0197'.
   516     12  ER-2208             PIC  X(4)           VALUE '2208'.
   517     12  ER-2210             PIC  X(4)           VALUE '2210'.
   518     12  ER-2215             PIC  X(4)           VALUE '2215'.
   519     12  ER-2230             PIC  X(4)           VALUE '2230'.
   520     12  ER-2233             PIC  X(4)           VALUE '2233'.
   521     12  ER-2370             PIC  X(4)           VALUE '2370'.
   522     12  ER-2371             PIC  X(4)           VALUE '2371'.
   523     12  ER-2249             PIC  X(4)           VALUE '2249'.
   524     12  ER-2250             PIC  X(4)           VALUE '2250'.
   525     12  ER-2383             PIC  X(4)           VALUE '2383'.
   526     12  ER-2385             PIC  X(4)           VALUE '2385'.
   527     12  ER-2399             PIC  X(4)           VALUE '2399'.
   528     12  ER-2400             PIC  X(4)           VALUE '2400'.
   529     12  ER-2401             PIC  X(4)           VALUE '2401'.
   530     12  ER-2403             PIC  X(4)           VALUE '2403'.
   531     12  ER-2404             PIC  X(4)           VALUE '2404'.
   532     12  ER-2405             PIC  X(4)           VALUE '2405'.
   533     12  ER-2406             PIC  X(4)           VALUE '2406'.
   534     12  ER-2407             PIC  X(4)           VALUE '2407'.
   535     12  ER-2408             PIC  X(4)           VALUE '2408'.
   536     12  ER-2409             PIC  X(4)           VALUE '2409'.
   537     12  ER-2411             PIC  X(4)           VALUE '2411'.
   538     12  ER-2421             PIC  X(4)           VALUE '2421'.
   539     12  ER-2434             PIC  X(4)           VALUE '2434'.
   540     12  ER-2435             PIC  X(4)           VALUE '2435'.
   541     12  ER-2436             PIC  X(4)           VALUE '2436'.
   542     12  ER-2438             PIC  X(4)           VALUE '2438'.
   543     12  ER-2439             PIC  X(4)           VALUE '2439'.
   544     12  ER-2443             PIC  X(4)           VALUE '2443'.
   545     12  ER-2472             PIC  X(4)           VALUE '2472'.
   546     12  ER-2564             PIC  X(4)           VALUE '2564'.
   547     12  ER-2570             PIC  X(4)           VALUE '2570'.
   548     12  ER-2571             PIC  X(4)           VALUE '2571'.
   549     12  ER-2590             PIC  X(4)           VALUE '2571'.
   550     12  ER-2597             PIC  X(4)           VALUE '2597'.
   551     12  ER-2910             PIC  X(4)           VALUE '2910'.
   552     12  ER-2911             PIC  X(4)           VALUE '2911'.
   553     12  ER-2912             PIC  X(4)           VALUE '2912'.
   554     12  ER-2913             PIC  X(4)           VALUE '2913'.
   555     12  ER-2914             PIC  X(4)           VALUE '2914'.
   556     12  ER-2915             PIC  X(4)           VALUE '2915'.
   557     12  ER-2916             PIC  X(4)           VALUE '2916'.
   558     12  ER-2917             PIC  X(4)           VALUE '2917'.
   559     12  ER-2918             PIC  X(4)           VALUE '2918'.
   560     12  ER-3145             PIC  X(4)           VALUE '3145'.
   561     12  ER-3165             PIC  X(4)           VALUE '3165'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL642.cbl
   563 01  CENTER-DATA-WORK-AREA.
   564     12  X1                  PIC S9(4)   COMP    VALUE +0.
   565     12  X2                  PIC S9(4)   COMP    VALUE +0.
   566     12  X3                  PIC S9(4)   COMP    VALUE +0.
   567     12  X-LEN               PIC S9(4)   COMP    VALUE +0.
   568     12  CENTER-WORK-1.
   569         16  CW1-PIC         PIC  X      OCCURS  44  TIMES.
   570     12  CENTER-WORK-2.
   571         16  CW2-PIC         PIC  X      OCCURS  44  TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL642.cbl
   573 01  GA-REPORT-HEADINGS.
   574     12  GA-PREVIEW-HD.
   575         16  FILLER          PIC  X(44)          VALUE
   576                 '                                          **'.
   577         16  FILLER          PIC  X(45)          VALUE
   578                 '** STATEMENT IS FOR REVIEW PURPOSES ONLY ***'.
   579         16  FILLER          PIC  X(44)          VALUE
   580                 '*                                           '.
   581     12  GA-HD1.
   582         16  FILLER          PIC  X(44)          VALUE SPACES.
   583         16  FILLER          PIC  X(44)          VALUE
   584                 '            AGENT    STATEMENT              '.
   585         16  FILLER          PIC  X(37)          VALUE SPACES.
   586         16  FILLER          PIC  X(7)           VALUE ' EL642 '.
   587     12  GA-HD2.
   588         16  FILLER          PIC  X(43)          VALUE SPACES.
   589         16  HD-CO           PIC  X(44)          VALUE SPACES.
   590         16  FILLER          PIC  X(37)          VALUE SPACES.
   591         16  HD-RUN-DT       PIC  X(8)           VALUE SPACES.
   592     12  GA-HD3.
   593         16  FILLER          PIC  X(57)          VALUE SPACES.
   594         16  HD-DT           PIC  X(18)          VALUE SPACES.
   595         16  FILLER          PIC  X(37)          VALUE SPACES.
   596         16  FILLER          PIC  X(5)           VALUE 'PAGE '.
   597         16  HD-PG           PIC ZZ,ZZ9.
   598     12  GA-HD4.
   599         16  FILLER          PIC  X(44)          VALUE
   600                 ' ------------- A C C O U N T -------------  '.
   601         16  FILLER          PIC  X(44)          VALUE
   602                 'BEGINNING      NET       ACCOUNT    PAYMENTS'.
   603         16  FILLER          PIC  X(44)          VALUE
   604                 '     UNPAID                          AMT.   '.
   605     12  GA-HD5.
   606         16  FILLER          PIC  X(44)          VALUE
   607                 '   NUMBER                 NAME              '.
   608         16  FILLER          PIC  X(44)          VALUE
   609                 ' BALANCE     PREMIUM     COMPENS.   ADJUSTS.'.
   610         16  FILLER          PIC  X(44)          VALUE
   611                 '  NET PREMIUM  BENEFIT  OVERWRITE    DUE    '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL642.cbl
   613*                            COPY ELCDATE.
   614******************************************************************
   615*                                                                *
   616*                                                                *
   617*                            ELCDATE.                            *
   618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   619*                            VMOD=2.003
   620*                                                                *
   621*                                                                *
   622*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   623*                 LENGTH = 200                                   *
   624******************************************************************
   625
   626 01  DATE-CONVERSION-DATA.
   627     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   628     12  DC-OPTION-CODE                PIC X.
   629         88  BIN-TO-GREG                VALUE ' '.
   630         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   631         88  EDIT-GREG-TO-BIN           VALUE '2'.
   632         88  YMD-GREG-TO-BIN            VALUE '3'.
   633         88  MDY-GREG-TO-BIN            VALUE '4'.
   634         88  JULIAN-TO-BIN              VALUE '5'.
   635         88  BIN-PLUS-ELAPSED           VALUE '6'.
   636         88  FIND-CENTURY               VALUE '7'.
   637         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   638         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   639         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   640         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   641         88  JULIAN-TO-BIN-3            VALUE 'C'.
   642         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   643         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   644         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   645         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   646         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   647         88  CHECK-LEAP-YEAR            VALUE 'H'.
   648         88  BIN-3-TO-GREG              VALUE 'I'.
   649         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   650         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   651         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   652         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   653         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   654         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   655         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   656         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   657         88  THREE-CHARACTER-BIN
   658                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   659         88  GREGORIAN-TO-BIN
   660                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   661         88  BIN-TO-GREGORIAN
   662                  VALUES ' ' '1' 'I' '8' 'G'.
   663         88  JULIAN-TO-BINARY
   664                  VALUES '5' 'C' 'E' 'F'.
   665     12  DC-ERROR-CODE                 PIC X.
   666         88  NO-CONVERSION-ERROR        VALUE ' '.
   667         88  DATE-CONVERSION-ERROR
   668                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   669         88  DATE-IS-ZERO               VALUE '1'.
   670         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL642.cbl
   671         88  DATE-IS-INVALID            VALUE '3'.
   672         88  DATE1-GREATER-DATE2        VALUE '4'.
   673         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   674         88  DATE-INVALID-OPTION        VALUE '9'.
   675         88  INVALID-CENTURY            VALUE 'A'.
   676         88  ONLY-CENTURY               VALUE 'B'.
   677         88  ONLY-LEAP-YEAR             VALUE 'C'.
   678         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   679     12  DC-END-OF-MONTH               PIC X.
   680         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   681     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   682         88  USE-NORMAL-PROCESS         VALUE ' '.
   683         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   684         88  ADJUST-UP-100-YRS          VALUE '2'.
   685     12  FILLER                        PIC X.
   686     12  DC-CONVERSION-DATES.
   687         16  DC-BIN-DATE-1             PIC XX.
   688         16  DC-BIN-DATE-2             PIC XX.
   689         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   690         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   691                       DC-GREG-DATE-1-EDIT.
   692             20  DC-EDIT1-MONTH        PIC 99.
   693             20  SLASH1-1              PIC X.
   694             20  DC-EDIT1-DAY          PIC 99.
   695             20  SLASH1-2              PIC X.
   696             20  DC-EDIT1-YEAR         PIC 99.
   697         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   698         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   699                     DC-GREG-DATE-2-EDIT.
   700             20  DC-EDIT2-MONTH        PIC 99.
   701             20  SLASH2-1              PIC X.
   702             20  DC-EDIT2-DAY          PIC 99.
   703             20  SLASH2-2              PIC X.
   704             20  DC-EDIT2-YEAR         PIC 99.
   705         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   706         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   707                     DC-GREG-DATE-1-YMD.
   708             20  DC-YMD-YEAR           PIC 99.
   709             20  DC-YMD-MONTH          PIC 99.
   710             20  DC-YMD-DAY            PIC 99.
   711         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   712         16  DC-GREG-DATE-1-MDY-R REDEFINES
   713                      DC-GREG-DATE-1-MDY.
   714             20  DC-MDY-MONTH          PIC 99.
   715             20  DC-MDY-DAY            PIC 99.
   716             20  DC-MDY-YEAR           PIC 99.
   717         16  DC-GREG-DATE-1-ALPHA.
   718             20  DC-ALPHA-MONTH        PIC X(10).
   719             20  DC-ALPHA-DAY          PIC 99.
   720             20  FILLER                PIC XX.
   721             20  DC-ALPHA-CENTURY.
   722                 24 DC-ALPHA-CEN-N     PIC 99.
   723             20  DC-ALPHA-YEAR         PIC 99.
   724         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   725         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   726         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   727         16  DC-JULIAN-DATE            PIC 9(05).
   728         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL642.cbl
   729                                       PIC 9(05).
   730         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   731             20  DC-JULIAN-YEAR        PIC 99.
   732             20  DC-JULIAN-DAYS        PIC 999.
   733         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   734         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   735         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   736     12  DATE-CONVERSION-VARIBLES.
   737         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   738         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   739             20  FILLER                PIC 9(3).
   740             20  HOLD-CEN-1-CCYY.
   741                 24  HOLD-CEN-1-CC     PIC 99.
   742                 24  HOLD-CEN-1-YY     PIC 99.
   743             20  HOLD-CEN-1-MO         PIC 99.
   744             20  HOLD-CEN-1-DA         PIC 99.
   745         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   746             20  HOLD-CEN-1-R-MO       PIC 99.
   747             20  HOLD-CEN-1-R-DA       PIC 99.
   748             20  HOLD-CEN-1-R-CCYY.
   749                 24  HOLD-CEN-1-R-CC   PIC 99.
   750                 24  HOLD-CEN-1-R-YY   PIC 99.
   751             20  FILLER                PIC 9(3).
   752         16  HOLD-CENTURY-1-X.
   753             20  FILLER                PIC X(3)  VALUE SPACES.
   754             20  HOLD-CEN-1-X-CCYY.
   755                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   756                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   757             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   758             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   759         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   760             20  HOLD-CEN-1-R-X-MO     PIC XX.
   761             20  HOLD-CEN-1-R-X-DA     PIC XX.
   762             20  HOLD-CEN-1-R-X-CCYY.
   763                 24  HOLD-CEN-1-R-X-CC PIC XX.
   764                 24  HOLD-CEN-1-R-X-YY PIC XX.
   765             20  FILLER                PIC XXX.
   766         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   767         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   768         16  DC-JULIAN-DATE-1          PIC 9(07).
   769         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   770             20  DC-JULIAN-1-CCYY.
   771                 24  DC-JULIAN-1-CC    PIC 99.
   772                 24  DC-JULIAN-1-YR    PIC 99.
   773             20  DC-JULIAN-DA-1        PIC 999.
   774         16  DC-JULIAN-DATE-2          PIC 9(07).
   775         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   776             20  DC-JULIAN-2-CCYY.
   777                 24  DC-JULIAN-2-CC    PIC 99.
   778                 24  DC-JULIAN-2-YR    PIC 99.
   779             20  DC-JULIAN-DA-2        PIC 999.
   780         16  DC-GREG-DATE-A-EDIT.
   781             20  DC-EDITA-MONTH        PIC 99.
   782             20  SLASHA-1              PIC X VALUE '/'.
   783             20  DC-EDITA-DAY          PIC 99.
   784             20  SLASHA-2              PIC X VALUE '/'.
   785             20  DC-EDITA-CCYY.
   786                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL642.cbl
   787                 24  DC-EDITA-YEAR     PIC 99.
   788         16  DC-GREG-DATE-B-EDIT.
   789             20  DC-EDITB-MONTH        PIC 99.
   790             20  SLASHB-1              PIC X VALUE '/'.
   791             20  DC-EDITB-DAY          PIC 99.
   792             20  SLASHB-2              PIC X VALUE '/'.
   793             20  DC-EDITB-CCYY.
   794                 24  DC-EDITB-CENT     PIC 99.
   795                 24  DC-EDITB-YEAR     PIC 99.
   796         16  DC-GREG-DATE-CYMD         PIC 9(08).
   797         16  DC-GREG-DATE-CYMD-R REDEFINES
   798                              DC-GREG-DATE-CYMD.
   799             20  DC-CYMD-CEN           PIC 99.
   800             20  DC-CYMD-YEAR          PIC 99.
   801             20  DC-CYMD-MONTH         PIC 99.
   802             20  DC-CYMD-DAY           PIC 99.
   803         16  DC-GREG-DATE-MDCY         PIC 9(08).
   804         16  DC-GREG-DATE-MDCY-R REDEFINES
   805                              DC-GREG-DATE-MDCY.
   806             20  DC-MDCY-MONTH         PIC 99.
   807             20  DC-MDCY-DAY           PIC 99.
   808             20  DC-MDCY-CEN           PIC 99.
   809             20  DC-MDCY-YEAR          PIC 99.
   810    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   811        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   812    12  DC-EL310-DATE                  PIC X(21).
   813    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL642.cbl
   815*                            COPY ELCLOGOF.
   816******************************************************************
   817*                                                                *
   818*                                                                *
   819*                            ELCLOGOF.                           *
   820*                            VMOD=2.001                          *
   821*                                                                *
   822*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   823*                                                                *
   824******************************************************************
   825 01  CLASIC-LOGOFF.
   826     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   827     12  LOGOFF-TEXT.
   828         16  FILLER          PIC X(5)    VALUE SPACES.
   829         16  LOGOFF-MSG.
   830             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   831             20  FILLER      PIC X       VALUE SPACES.
   832             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   833         16  FILLER          PIC X(80)
   834           VALUE '* YOU ARE NOW LOGGED OFF'.
   835         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   836         16  FILLER          PIC X       VALUE QUOTE.
   837         16  LOGOFF-SYS-MSG  PIC X(17)
   838           VALUE 'S CLAS-IC SYSTEM '.
   839     12  TEXT-MESSAGES.
   840         16  UNACCESS-MSG    PIC X(29)
   841             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   842         16  PGMIDERR-MSG    PIC X(17)
   843             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL642.cbl
   845*                            COPY ELCATTR.
   846******************************************************************
   847*                                                                *
   848*                            ELCATTR.                            *
   849*                            VMOD=2.001                          *
   850*                                                                *
   851*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   852*                                                                *
   853*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   854*                                                                *
   855*                   POS 1   P=PROTECTED                          *
   856*                           U=UNPROTECTED                        *
   857*                           S=ASKIP                              *
   858*                   POS 2   A=ALPHA/NUMERIC                      *
   859*                           N=NUMERIC                            *
   860*                   POS 3   N=NORMAL                             *
   861*                           B=BRIGHT                             *
   862*                           D=DARK                               *
   863*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   864*                           OF=MODIFIED DATA TAG OFF             *
   865*                                                                *
   866*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   867******************************************************************
   868 01  ATTRIBUTE-LIST.
   869     12  AL-PABOF            PIC X       VALUE 'Y'.
   870     12  AL-PABON            PIC X       VALUE 'Z'.
   871     12  AL-PADOF            PIC X       VALUE '%'.
   872     12  AL-PADON            PIC X       VALUE '_'.
   873     12  AL-PANOF            PIC X       VALUE '-'.
   874     12  AL-PANON            PIC X       VALUE '/'.
   875     12  AL-SABOF            PIC X       VALUE '8'.
   876     12  AL-SABON            PIC X       VALUE '9'.
   877     12  AL-SADOF            PIC X       VALUE '@'.
   878     12  AL-SADON            PIC X       VALUE QUOTE.
   879     12  AL-SANOF            PIC X       VALUE '0'.
   880     12  AL-SANON            PIC X       VALUE '1'.
   881     12  AL-UABOF            PIC X       VALUE 'H'.
   882     12  AL-UABON            PIC X       VALUE 'I'.
   883     12  AL-UADOF            PIC X       VALUE '<'.
   884     12  AL-UADON            PIC X       VALUE '('.
   885     12  AL-UANOF            PIC X       VALUE ' '.
   886     12  AL-UANON            PIC X       VALUE 'A'.
   887     12  AL-UNBOF            PIC X       VALUE 'Q'.
   888     12  AL-UNBON            PIC X       VALUE 'R'.
   889     12  AL-UNDOF            PIC X       VALUE '*'.
   890     12  AL-UNDON            PIC X       VALUE ')'.
   891     12  AL-UNNOF            PIC X       VALUE '&'.
   892     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL642.cbl
   894*                            COPY ELCEMIB.
   895******************************************************************
   896*                                                                *
   897*                                                                *
   898*                            ELCEMIB.                            *
   899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   900*                            VMOD=2.005                          *
   901*                                                                *
   902*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   903*                                                                *
   904******************************************************************
   905 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   906     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   907     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   908     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   909     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   910     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   911     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   912     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   913     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   914     12  EMI-SWITCH1             PIC X        VALUE '1'.
   915         88  EMI-NO-ERRORS                    VALUE '1'.
   916         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   917         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   918     12  EMI-SWITCH2             PIC X        VALUE '1'.
   919         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   920     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   921         88  EMI-AREA1-EMPTY                  VALUE '1'.
   922         88  EMI-AREA1-FULL                   VALUE '2'.
   923     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   924         88  EMI-AREA2-EMPTY                  VALUE '1'.
   925         88  EMI-AREA2-FULL                   VALUE '2'.
   926     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   927         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   928         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   929         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   930         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   931         88  EMI-BYPASS-FATALS                VALUE 'X'.
   932     12  EMI-ERROR-LINES.
   933         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   934         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   935         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   936         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   937             20  EMI-ERR-CODES OCCURS 10 TIMES.
   938                 24  EMI-ERR-NUM         PIC X(4).
   939                 24  EMI-FILLER          PIC X.
   940                 24  EMI-SEV             PIC X.
   941                 24  FILLER              PIC X.
   942             20  FILLER                  PIC X(02).
   943     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   944         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   945             20  EMI-ERROR-NUMBER    PIC X(4).
   946             20  EMI-FILL            PIC X.
   947             20  EMI-SEVERITY        PIC X.
   948             20  FILLER              PIC X.
   949             20  EMI-ERROR-TEXT.
   950                 24  EMI-TEXT-VARIABLE   PIC X(10).
   951                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL642.cbl
   952     12  EMI-SEVERITY-SAVE           PIC X.
   953         88  EMI-NOTE                    VALUE 'N'.
   954         88  EMI-WARNING                 VALUE 'W'.
   955         88  EMI-FORCABLE                VALUE 'F'.
   956         88  EMI-FATAL                   VALUE 'X'.
   957     12  EMI-MESSAGE-FLAG            PIC X.
   958         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   959         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   960     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   961     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   962         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   963         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   964         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   965     12  emi-claim-no                pic x(7).
   966     12  emi-claim-type              pic x(6).
   967     12  FILLER                      PIC X(124)  VALUE SPACES.
   968     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   969     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   970     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   971     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL642.cbl
   973*                            COPY ELCINTF.
   974******************************************************************
   975*                                                                *
   976*                                                                *
   977*                            ELCINTF.                            *
   978*                            VMOD=2.017                          *
   979*                                                                *
   980*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   981*                                                                *
   982*       LENGTH = 1024                                            *
   983*                                                                *
   984******************************************************************
   985*                   C H A N G E   L O G
   986*
   987* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   988*-----------------------------------------------------------------
   989*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   990* EFFECTIVE    NUMBER
   991*-----------------------------------------------------------------
   992* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   993******************************************************************
   994 01  PROGRAM-INTERFACE-BLOCK.
   995     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   996     12  PI-CALLING-PROGRAM              PIC X(8).
   997     12  PI-SAVED-PROGRAM-1              PIC X(8).
   998     12  PI-SAVED-PROGRAM-2              PIC X(8).
   999     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1000     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1001     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1002     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1003     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1004     12  PI-COMPANY-ID                   PIC XXX.
  1005     12  PI-COMPANY-CD                   PIC X.
  1006
  1007     12  PI-COMPANY-PASSWORD             PIC X(8).
  1008
  1009     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1010
  1011     12  PI-CONTROL-IN-PROGRESS.
  1012         16  PI-CARRIER                  PIC X.
  1013         16  PI-GROUPING                 PIC X(6).
  1014         16  PI-STATE                    PIC XX.
  1015         16  PI-ACCOUNT                  PIC X(10).
  1016         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1017                                         PIC X(10).
  1018         16  PI-CLAIM-CERT-GRP.
  1019             20  PI-CLAIM-NO             PIC X(7).
  1020             20  PI-CERT-NO.
  1021                 25  PI-CERT-PRIME       PIC X(10).
  1022                 25  PI-CERT-SFX         PIC X.
  1023             20  PI-CERT-EFF-DT          PIC XX.
  1024         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1025             20  PI-PLAN-CODE            PIC X(2).
  1026             20  PI-REVISION-NUMBER      PIC X(3).
  1027             20  PI-PLAN-EFF-DT          PIC X(2).
  1028             20  PI-PLAN-EXP-DT          PIC X(2).
  1029             20  FILLER                  PIC X(11).
  1030         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL642.cbl
  1031             20  PI-OE-REFERENCE-1.
  1032                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1033                 25  PI-OE-REF-1-SUFF    PIC XX.
  1034
  1035     12  PI-SESSION-IN-PROGRESS          PIC X.
  1036         88  CLAIM-SESSION                   VALUE '1'.
  1037         88  CREDIT-SESSION                  VALUE '2'.
  1038         88  WARRANTY-SESSION                VALUE '3'.
  1039         88  MORTGAGE-SESSION                VALUE '4'.
  1040         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1041
  1042
  1043*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1044
  1045     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1046     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1047
  1048     12  PI-CREDIT-USER                  PIC X.
  1049         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1050         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1051
  1052     12  PI-CLAIM-USER                   PIC X.
  1053         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1054         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1055
  1056     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1057         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1058         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1059         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1060         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1061         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1062
  1063     12  PI-PROCESSOR-ID                 PIC X(4).
  1064
  1065     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1066
  1067     12  PI-MEMBER-CAPTION               PIC X(10).
  1068
  1069     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1070         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1071
  1072     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1073     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1074     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1075     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1076
  1077     12  PI-AH-OVERRIDE-L1               PIC X.
  1078     12  PI-AH-OVERRIDE-L2               PIC XX.
  1079     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1080     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1081
  1082     12  PI-NEW-SYSTEM                   PIC X(2).
  1083
  1084     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1085     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1086         88  PI-USES-PAID-TO                 VALUE '1'.
  1087     12  PI-CRDTCRD-SYSTEM.
  1088         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL642.cbl
  1089             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1090             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1091         16  PI-CC-MONTH-END-DT          PIC XX.
  1092     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1093
  1094     12  PI-OE-REFERENCE-2.
  1095         16  PI-OE-REF-2-PRIME           PIC X(10).
  1096         16  PI-OE-REF-2-SUFF            PIC X.
  1097
  1098     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1099
  1100     12  PI-LANGUAGE-TYPE                PIC X.
  1101             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1102             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1103             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1104
  1105     12  PI-POLICY-LINKAGE-IND           PIC X.
  1106         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1107         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1108                                                   LOW-VALUES.
  1109
  1110     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1111     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1112         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1113         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1114
  1115     12  PI-PROCESSOR-CSR-IND            PIC X.
  1116         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1117         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1118
  1119     12  FILLER                          PIC X(3).
  1120
  1121     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1122
  1123     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1124         PI-SYSTEM-LEVEL.
  1125
  1126         16  PI-ENTRY-CODES.
  1127             20  PI-ENTRY-CD-1           PIC X.
  1128             20  PI-ENTRY-CD-2           PIC X.
  1129
  1130         16  PI-RETURN-CODES.
  1131             20  PI-RETURN-CD-1          PIC X.
  1132             20  PI-RETURN-CD-2          PIC X.
  1133
  1134         16  PI-UPDATE-STATUS-SAVE.
  1135             20  PI-UPDATE-BY            PIC X(4).
  1136             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1137
  1138         16  PI-LOWER-CASE-LETTERS       PIC X.
  1139             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1140
  1141*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1142*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1143*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1144
  1145         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1146             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL642.cbl
  1147             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1148             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1149             88  ACCNT-CNTL                  VALUE '3'.
  1150             88  CARR-ACCNT-CNTL             VALUE '4'.
  1151
  1152         16  PI-PROCESSOR-CAP-LIST.
  1153             20  PI-SYSTEM-CONTROLS.
  1154                24 PI-SYSTEM-DISPLAY     PIC X.
  1155                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1156                24 PI-SYSTEM-MODIFY      PIC X.
  1157                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1158             20  FILLER                  PIC XX.
  1159             20  PI-DISPLAY-CAP          PIC X.
  1160                 88  DISPLAY-CAP             VALUE 'Y'.
  1161             20  PI-MODIFY-CAP           PIC X.
  1162                 88  MODIFY-CAP              VALUE 'Y'.
  1163             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1164                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1165             20  PI-FORCE-CAP            PIC X.
  1166                 88  FORCE-CAP               VALUE 'Y'.
  1167
  1168         16  PI-PROGRAM-CONTROLS.
  1169             20  PI-PGM-PRINT-OPT        PIC X.
  1170             20  PI-PGM-FORMAT-OPT       PIC X.
  1171             20  PI-PGM-PROCESS-OPT      PIC X.
  1172             20  PI-PGM-TOTALS-OPT       PIC X.
  1173
  1174         16  PI-HELP-INTERFACE.
  1175             20  PI-LAST-ERROR-NO        PIC X(4).
  1176             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1177
  1178         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1179             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1180
  1181         16  PI-CR-CONTROL-IN-PROGRESS.
  1182             20  PI-CR-CARRIER           PIC X.
  1183             20  PI-CR-GROUPING          PIC X(6).
  1184             20  PI-CR-STATE             PIC XX.
  1185             20  PI-CR-ACCOUNT           PIC X(10).
  1186             20  PI-CR-FIN-RESP          PIC X(10).
  1187             20  PI-CR-TYPE              PIC X.
  1188
  1189         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1190
  1191         16  PI-CR-MONTH-END-DT          PIC XX.
  1192
  1193         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1194             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1195             88  PI-ZERO-CARRIER             VALUE '1'.
  1196             88  PI-ZERO-GROUPING            VALUE '2'.
  1197             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1198
  1199         16  PI-CARRIER-SECURITY         PIC X.
  1200             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1201
  1202         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1203             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1204             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL642.cbl
  1205
  1206         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1207             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1208                                         INDEXED BY PI-ACCESS-NDX
  1209                                         PIC X.
  1210
  1211         16  PI-GA-BILLING-CONTROL       PIC X.
  1212             88  PI-GA-BILLING               VALUE '1'.
  1213
  1214         16  PI-MAIL-PROCESSING          PIC X.
  1215             88  PI-MAIL-YES                 VALUE 'Y'.
  1216
  1217         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1218
  1219         16  PI-AR-SYSTEM.
  1220             20  PI-AR-PROCESSING-CNTL   PIC X.
  1221                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1222             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1223             20  PI-AR-MONTH-END-DT      PIC XX.
  1224
  1225         16  PI-MP-SYSTEM.
  1226             20  PI-MORTGAGE-USER            PIC X.
  1227                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1228                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1229             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1230                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1231                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1232                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1233                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1234                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1235             20  PI-MP-MONTH-END-DT          PIC XX.
  1236             20  PI-MP-REFERENCE-NO.
  1237                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1238                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1239
  1240         16  PI-LABEL-CONTROL            PIC X(01).
  1241             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1242             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1243
  1244         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1245             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1246
  1247         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1248             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1249             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1250
  1251         16  FILLER                      PIC X(14).
  1252
  1253     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1254******************************************************************
  1255     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1256         16  PI-MAP-NAME         PIC  X(8).
  1257         16  PI-AGENT-NAME       PIC  X(20).
  1258         16  PI-SAV-REMIT-TO     PIC  X(10).
  1259         16  PI-SAV-FIN-RESP     PIC  X(10).
  1260         16  PI-SAV-ACCT         PIC  X(10).
  1261         16  PI-SAV-ACCT-AGT     PIC  X(10).
  1262         16  PI-SAV-ACCT-NAME    PIC  X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL642.cbl
  1263         16  PI-SAV-AGENT        PIC  X(10).
  1264         16  PI-SAV-CARR         PIC  X.
  1265         16  PI-SAV-GROUP        PIC  X(6).
  1266         16  PI-SAV-STATE        PIC  XX.
  1267         16  PI-SAV-EXP-DT       PIC  XX.
  1268         16  PI-UNPAID-NET-PREM  PIC S9(7)V99    COMP-3.
  1269         16  PI-COMP-UNPAID-PREM PIC S9(7)V99    COMP-3.
  1270         16  PI-BAL-FRWD         PIC S9(7)V99    COMP-3.
  1271         16  PI-PREMIUM          PIC S9(7)V99    COMP-3.
  1272         16  PI-REMITTED         PIC S9(7)V99    COMP-3.
  1273         16  PI-TOT-ISS-COMP     PIC S9(7)V99    COMP-3.
  1274         16  PI-TOT-CAN-COMP     PIC S9(7)V99    COMP-3.
  1275         16  PI-ADJUSTMNTS       PIC S9(7)V99    COMP-3.
  1276         16  PI-DISBURSED        PIC S9(7)V99    COMP-3.
  1277         16  PI-END-BAL          PIC S9(7)V99    COMP-3.
  1278         16  PI-LF-ISS-COMP      PIC S9(7)V99    COMP-3.
  1279         16  PI-AH-ISS-COMP      PIC S9(7)V99    COMP-3.
  1280         16  PI-LF-CAN-COMP      PIC S9(7)V99    COMP-3.
  1281         16  PI-AH-CAN-COMP      PIC S9(7)V99    COMP-3.
  1282         16  PI-DUE-FOR-ACCT     PIC S9(7)V99    COMP-3.
  1283         16  PI-ACCT-BEG-BAL     PIC S9(7)V99    COMP-3.
  1284         16  PI-ACCT-NET-PREM    PIC S9(7)V99    COMP-3.
  1285         16  PI-ACCT-COMP        PIC S9(7)V99    COMP-3.
  1286         16  PI-ACCT-PAY-ADJS    PIC S9(7)V99    COMP-3.
  1287         16  PI-BILL-TYPE        PIC  X.
  1288             88  PI-PREV-BILL                    VALUE '1'.
  1289             88  PI-PREV-REBILL                  VALUE '2'.
  1290             88  PI-PREVIEW                      VALUE '1' '2'.
  1291             88  PI-BILL                         VALUE '3'.
  1292             88  PI-REBILLING                    VALUE '4'.
  1293             88  PI-VOID-BILL                    VALUE '5'.
  1294             88  PI-TOT-REBILL                   VALUE '2' '4'.
  1295             88  PI-UPDATE-FILES                 VALUE '3' '4'
  1296                                                       '5'.
  1297             88  PI-BILLING-FUNCTION             VALUE '1' '2'
  1298                                                       '3' '4'.
  1299         16  PI-BILL-ERRS        PIC  X.
  1300         16  PI-CHECK-SW         PIC  X.
  1301             88  PI-CHECK-PRODUCED               VALUE 'Y'.
  1302         16  PI-DATA-BILLED-SW   PIC  X.
  1303             88  PI-DATA-BILLED                  VALUE 'Y'.
  1304         16  PI-ACCT-BILLED-SW   PIC  X.
  1305             88  PI-ACCT-BILLED                  VALUE 'Y'.
  1306         16  PI-MONTH-END-DATE.
  1307             20  PI-ME-MONTH     PIC  99.
  1308             20  FILLER          PIC  X.
  1309             20  PI-ME-DAY       PIC  99.
  1310             20  FILLER          PIC  X.
  1311             20  PI-ME-YEAR      PIC  99.
  1312         16  PI-LIMIT-BILLING-ACCOUNTS.
  1313             20  PI-BILLING-ACCOUNTS     OCCURS  3  TIMES
  1314                                     PIC  X(10).
  1315         16  PI-ISSUE-INFO.
  1316             20  PI-ISSUES-BILLED    PIC S9(6) COMP-3.
  1317             20  PI-ISSUES-INER      PIC S9(6) COMP-3.
  1318             20  PI-ISSUES-PREV      PIC S9(6) COMP-3.
  1319         16  PI-CANCEL-INFO.
  1320             20  PI-CANCELS-BILLED   PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL642.cbl
  1321             20  PI-CANCELS-INER     PIC S9(6) COMP-3.
  1322             20  PI-CANCELS-PREV     PIC S9(6) COMP-3.
  1323         16  PI-UNKNOWN              PIC S9(6) COMP-3.
  1324         16  PI-COMP-CONTROL.
  1325             20  PI-COMP-CARRIER     PIC  X.
  1326             20  PI-COMP-GROUPING    PIC  X(6).
  1327             20  PI-COMP-FIN-RESP    PIC  X(10).
  1328         16  PI-SCRN-CONTROL.
  1329             20  PI-SCR-CARRIER      PIC  X.
  1330             20  PI-SCR-GROUPING     PIC  X(6).
  1331             20  PI-SCR-STATE        PIC  XX.
  1332             20  PI-SCR-ACCOUNT      PIC  X(10).
  1333             20  PI-SCR-FIN-RESP     PIC  X(10).
  1334             20  PI-SCR-TYPE         PIC  X.
  1335         16  PI-TRANSFER-SW          PIC  X.
  1336             88  PI-TRANSFER-BEFORE-ACT  VALUE 'Y'.
  1337         16  FILLER                  PIC  X(307).
  1338
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL642.cbl
  1340*                            COPY ELCJPFX.
  1341******************************************************************
  1342*                                                                *
  1343*                                                                *
  1344*                            ELCJPFX.                            *
  1345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1346*                            VMOD=2.002                          *
  1347*                                                                *
  1348*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1349*                                                                *
  1350*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1351*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1352*        ELCNTL - CONTROL FILE                                   *
  1353*        ELMSTR - CLAIM MASTERS                                  *
  1354*        ELTRLR - ACTIVITY TRAILERS                              *
  1355*        ELCHKQ - CHECK QUE                                      *
  1356******************************************************************
  1357 01  JOURNAL-RECORD.
  1358     12  jp-date                     pic s9(5) comp-3.
  1359     12  jp-time                     pic s9(7) comp-3.
  1360     12  JP-USER-ID                  PIC X(4).
  1361     12  JP-FILE-ID                  PIC X(8).
  1362     12  JP-PROGRAM-ID               PIC X(8).
  1363     12  JP-RECORD-TYPE              PIC X.
  1364         88 JP-ADD              VALUE 'A'.
  1365         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1366         88 JP-AFTER-CHANGE     VALUE 'C'.
  1367         88 JP-DELETE           VALUE 'D'.
  1368         88 JP-GENERIC-DELETE   VALUE 'G'.
  1369         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1370         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1371     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1372     12  JP-RECORD-AREA
  1373
  1374
  1375                             PIC  X(1464).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL642.cbl
  1377*                            COPY ELCAID.
  1378******************************************************************
  1379*                                                                *
  1380*                            ELCAID.                             *
  1381*                            VMOD=2.001                          *
  1382*                                                                *
  1383*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1384*                                                                *
  1385*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1386*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1387******************************************************************
  1388
  1389 01  DFHAID.
  1390   02  DFHNULL   PIC  X  VALUE  ' '.
  1391   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1392   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1393   02  DFHPEN    PIC  X  VALUE  '='.
  1394   02  DFHOPID   PIC  X  VALUE  'W'.
  1395   02  DFHPA1    PIC  X  VALUE  '%'.
  1396   02  DFHPA2    PIC  X  VALUE  '>'.
  1397   02  DFHPA3    PIC  X  VALUE  ','.
  1398   02  DFHPF1    PIC  X  VALUE  '1'.
  1399   02  DFHPF2    PIC  X  VALUE  '2'.
  1400   02  DFHPF3    PIC  X  VALUE  '3'.
  1401   02  DFHPF4    PIC  X  VALUE  '4'.
  1402   02  DFHPF5    PIC  X  VALUE  '5'.
  1403   02  DFHPF6    PIC  X  VALUE  '6'.
  1404   02  DFHPF7    PIC  X  VALUE  '7'.
  1405   02  DFHPF8    PIC  X  VALUE  '8'.
  1406   02  DFHPF9    PIC  X  VALUE  '9'.
  1407   02  DFHPF10   PIC  X  VALUE  ':'.
  1408   02  DFHPF11   PIC  X  VALUE  '#'.
  1409   02  DFHPF12   PIC  X  VALUE  '@'.
  1410   02  DFHPF13   PIC  X  VALUE  'A'.
  1411   02  DFHPF14   PIC  X  VALUE  'B'.
  1412   02  DFHPF15   PIC  X  VALUE  'C'.
  1413   02  DFHPF16   PIC  X  VALUE  'D'.
  1414   02  DFHPF17   PIC  X  VALUE  'E'.
  1415   02  DFHPF18   PIC  X  VALUE  'F'.
  1416   02  DFHPF19   PIC  X  VALUE  'G'.
  1417   02  DFHPF20   PIC  X  VALUE  'H'.
  1418   02  DFHPF21   PIC  X  VALUE  'I'.
  1419*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1420   02  DFHPF22   PIC  X  VALUE  '['.
  1421   02  DFHPF23   PIC  X  VALUE  '.'.
  1422   02  DFHPF24   PIC  X  VALUE  '<'.
  1423   02  DFHMSRE   PIC  X  VALUE  'X'.
  1424   02  DFHSTRF   PIC  X  VALUE  'h'.
  1425   02  DFHTRIG   PIC  X  VALUE  '"'.
  1426
  1427 01  FILLER  REDEFINES  DFHAID.
  1428     12  FILLER              PIC  X(8).
  1429     12  PF-VALUES           PIC  X      OCCURS  2  TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL642.cbl
  1431*                            COPY EL642S.
  1432 01  EL642AI.
  1433     05  FILLER            PIC  X(0012).
  1434*    -------------------------------
  1435     05  ADATEL PIC S9(0004) COMP.
  1436     05  ADATEF PIC  X(0001).
  1437     05  FILLER REDEFINES ADATEF.
  1438         10  ADATEA PIC  X(0001).
  1439     05  ADATEI PIC  X(0008).
  1440*    -------------------------------
  1441     05  ATIMEL PIC S9(0004) COMP.
  1442     05  ATIMEF PIC  X(0001).
  1443     05  FILLER REDEFINES ATIMEF.
  1444         10  ATIMEA PIC  X(0001).
  1445     05  ATIMEI PIC  X(0005).
  1446*    -------------------------------
  1447     05  CMPNYIDL PIC S9(0004) COMP.
  1448     05  CMPNYIDF PIC  X(0001).
  1449     05  FILLER REDEFINES CMPNYIDF.
  1450         10  CMPNYIDA PIC  X(0001).
  1451     05  CMPNYIDI PIC  X(0003).
  1452*    -------------------------------
  1453     05  USERIDL PIC S9(0004) COMP.
  1454     05  USERIDF PIC  X(0001).
  1455     05  FILLER REDEFINES USERIDF.
  1456         10  USERIDA PIC  X(0001).
  1457     05  USERIDI PIC  X(0004).
  1458*    -------------------------------
  1459     05  ABEGBALL PIC S9(0004) COMP.
  1460     05  ABEGBALF PIC  X(0001).
  1461     05  FILLER REDEFINES ABEGBALF.
  1462         10  ABEGBALA PIC  X(0001).
  1463     05  ABEGBALI PIC  X(0010).
  1464*    -------------------------------
  1465     05  ACARHDGL PIC S9(0004) COMP.
  1466     05  ACARHDGF PIC  X(0001).
  1467     05  FILLER REDEFINES ACARHDGF.
  1468         10  ACARHDGA PIC  X(0001).
  1469     05  ACARHDGI PIC  X(0007).
  1470*    -------------------------------
  1471     05  AGRPHDGL PIC S9(0004) COMP.
  1472     05  AGRPHDGF PIC  X(0001).
  1473     05  FILLER REDEFINES AGRPHDGF.
  1474         10  AGRPHDGA PIC  X(0001).
  1475     05  AGRPHDGI PIC  X(0005).
  1476*    -------------------------------
  1477     05  AUPDPRML PIC S9(0004) COMP.
  1478     05  AUPDPRMF PIC  X(0001).
  1479     05  FILLER REDEFINES AUPDPRMF.
  1480         10  AUPDPRMA PIC  X(0001).
  1481     05  AUPDPRMI PIC  X(0010).
  1482*    -------------------------------
  1483     05  AAGENTL PIC S9(0004) COMP.
  1484     05  AAGENTF PIC  X(0001).
  1485     05  FILLER REDEFINES AAGENTF.
  1486         10  AAGENTA PIC  X(0001).
  1487     05  AAGENTI PIC  X(0010).
  1488*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL642.cbl
  1489     05  ACARIERL PIC S9(0004) COMP.
  1490     05  ACARIERF PIC  X(0001).
  1491     05  FILLER REDEFINES ACARIERF.
  1492         10  ACARIERA PIC  X(0001).
  1493     05  ACARIERI PIC  X(0001).
  1494*    -------------------------------
  1495     05  AGROUPL PIC S9(0004) COMP.
  1496     05  AGROUPF PIC  X(0001).
  1497     05  FILLER REDEFINES AGROUPF.
  1498         10  AGROUPA PIC  X(0001).
  1499     05  AGROUPI PIC  X(0006).
  1500*    -------------------------------
  1501     05  AUPDCOML PIC S9(0004) COMP.
  1502     05  AUPDCOMF PIC  X(0001).
  1503     05  FILLER REDEFINES AUPDCOMF.
  1504         10  AUPDCOMA PIC  X(0001).
  1505     05  AUPDCOMI PIC  X(0010).
  1506*    -------------------------------
  1507     05  APREMUML PIC S9(0004) COMP.
  1508     05  APREMUMF PIC  X(0001).
  1509     05  FILLER REDEFINES APREMUMF.
  1510         10  APREMUMA PIC  X(0001).
  1511     05  APREMUMI PIC  X(0010).
  1512*    -------------------------------
  1513     05  ACOMPISL PIC S9(0004) COMP.
  1514     05  ACOMPISF PIC  X(0001).
  1515     05  FILLER REDEFINES ACOMPISF.
  1516         10  ACOMPISA PIC  X(0001).
  1517     05  ACOMPISI PIC  X(0010).
  1518*    -------------------------------
  1519     05  ACOMCANL PIC S9(0004) COMP.
  1520     05  ACOMCANF PIC  X(0001).
  1521     05  FILLER REDEFINES ACOMCANF.
  1522         10  ACOMCANA PIC  X(0001).
  1523     05  ACOMCANI PIC  X(0010).
  1524*    -------------------------------
  1525     05  ABILL1L PIC S9(0004) COMP.
  1526     05  ABILL1F PIC  X(0001).
  1527     05  FILLER REDEFINES ABILL1F.
  1528         10  ABILL1A PIC  X(0001).
  1529     05  ABILL1I PIC  X(0005).
  1530*    -------------------------------
  1531     05  AINER1L PIC S9(0004) COMP.
  1532     05  AINER1F PIC  X(0001).
  1533     05  FILLER REDEFINES AINER1F.
  1534         10  AINER1A PIC  X(0001).
  1535     05  AINER1I PIC  X(0005).
  1536*    -------------------------------
  1537     05  APRVBL1L PIC S9(0004) COMP.
  1538     05  APRVBL1F PIC  X(0001).
  1539     05  FILLER REDEFINES APRVBL1F.
  1540         10  APRVBL1A PIC  X(0001).
  1541     05  APRVBL1I PIC  X(0005).
  1542*    -------------------------------
  1543     05  AADJUSTL PIC S9(0004) COMP.
  1544     05  AADJUSTF PIC  X(0001).
  1545     05  FILLER REDEFINES AADJUSTF.
  1546         10  AADJUSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL642.cbl
  1547     05  AADJUSTI PIC  X(0010).
  1548*    -------------------------------
  1549     05  ABILL2L PIC S9(0004) COMP.
  1550     05  ABILL2F PIC  X(0001).
  1551     05  FILLER REDEFINES ABILL2F.
  1552         10  ABILL2A PIC  X(0001).
  1553     05  ABILL2I PIC  X(0005).
  1554*    -------------------------------
  1555     05  AINER2L PIC S9(0004) COMP.
  1556     05  AINER2F PIC  X(0001).
  1557     05  FILLER REDEFINES AINER2F.
  1558         10  AINER2A PIC  X(0001).
  1559     05  AINER2I PIC  X(0005).
  1560*    -------------------------------
  1561     05  APRVBL2L PIC S9(0004) COMP.
  1562     05  APRVBL2F PIC  X(0001).
  1563     05  FILLER REDEFINES APRVBL2F.
  1564         10  APRVBL2A PIC  X(0001).
  1565     05  APRVBL2I PIC  X(0005).
  1566*    -------------------------------
  1567     05  AREMITL PIC S9(0004) COMP.
  1568     05  AREMITF PIC  X(0001).
  1569     05  FILLER REDEFINES AREMITF.
  1570         10  AREMITA PIC  X(0001).
  1571     05  AREMITI PIC  X(0010).
  1572*    -------------------------------
  1573     05  ADISBURL PIC S9(0004) COMP.
  1574     05  ADISBURF PIC  X(0001).
  1575     05  FILLER REDEFINES ADISBURF.
  1576         10  ADISBURA PIC  X(0001).
  1577     05  ADISBURI PIC  X(0010).
  1578*    -------------------------------
  1579     05  AACTHDGL PIC S9(0004) COMP.
  1580     05  AACTHDGF PIC  X(0001).
  1581     05  FILLER REDEFINES AACTHDGF.
  1582         10  AACTHDGA PIC  X(0001).
  1583     05  AACTHDGI PIC  X(0029).
  1584*    -------------------------------
  1585     05  AACTDUEL PIC S9(0004) COMP.
  1586     05  AACTDUEF PIC  X(0001).
  1587     05  FILLER REDEFINES AACTDUEF.
  1588         10  AACTDUEA PIC  X(0001).
  1589     05  AACTDUEI PIC  X(0010).
  1590*    -------------------------------
  1591     05  AENDHDGL PIC S9(0004) COMP.
  1592     05  AENDHDGF PIC  X(0001).
  1593     05  FILLER REDEFINES AENDHDGF.
  1594         10  AENDHDGA PIC  X(0001).
  1595     05  AENDHDGI PIC  X(0018).
  1596*    -------------------------------
  1597     05  ANETDUEL PIC S9(0004) COMP.
  1598     05  ANETDUEF PIC  X(0001).
  1599     05  FILLER REDEFINES ANETDUEF.
  1600         10  ANETDUEA PIC  X(0001).
  1601     05  ANETDUEI PIC  X(0010).
  1602*    -------------------------------
  1603     05  ABILTYPL PIC S9(0004) COMP.
  1604     05  ABILTYPF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL642.cbl
  1605     05  FILLER REDEFINES ABILTYPF.
  1606         10  ABILTYPA PIC  X(0001).
  1607     05  ABILTYPI PIC  X(0001).
  1608*    -------------------------------
  1609     05  APRODSWL PIC S9(0004) COMP.
  1610     05  APRODSWF PIC  X(0001).
  1611     05  FILLER REDEFINES APRODSWF.
  1612         10  APRODSWA PIC  X(0001).
  1613     05  APRODSWI PIC  X(0001).
  1614*    -------------------------------
  1615     05  AACCT1L PIC S9(0004) COMP.
  1616     05  AACCT1F PIC  X(0001).
  1617     05  FILLER REDEFINES AACCT1F.
  1618         10  AACCT1A PIC  X(0001).
  1619     05  AACCT1I PIC  X(0010).
  1620*    -------------------------------
  1621     05  AACCT2L PIC S9(0004) COMP.
  1622     05  AACCT2F PIC  X(0001).
  1623     05  FILLER REDEFINES AACCT2F.
  1624         10  AACCT2A PIC  X(0001).
  1625     05  AACCT2I PIC  X(0010).
  1626*    -------------------------------
  1627     05  AACCT3L PIC S9(0004) COMP.
  1628     05  AACCT3F PIC  X(0001).
  1629     05  FILLER REDEFINES AACCT3F.
  1630         10  AACCT3A PIC  X(0001).
  1631     05  AACCT3I PIC  X(0010).
  1632*    -------------------------------
  1633     05  AUNKNERL PIC S9(0004) COMP.
  1634     05  AUNKNERF PIC  X(0001).
  1635     05  FILLER REDEFINES AUNKNERF.
  1636         10  AUNKNERA PIC  X(0001).
  1637     05  AUNKNERI PIC  X(0008).
  1638*    -------------------------------
  1639     05  AERMSG1L PIC S9(0004) COMP.
  1640     05  AERMSG1F PIC  X(0001).
  1641     05  FILLER REDEFINES AERMSG1F.
  1642         10  AERMSG1A PIC  X(0001).
  1643     05  AERMSG1I PIC  X(0076).
  1644*    -------------------------------
  1645     05  AERMSG2L PIC S9(0004) COMP.
  1646     05  AERMSG2F PIC  X(0001).
  1647     05  FILLER REDEFINES AERMSG2F.
  1648         10  AERMSG2A PIC  X(0001).
  1649     05  AERMSG2I PIC  X(0076).
  1650*    -------------------------------
  1651     05  APFNTERL PIC S9(0004) COMP.
  1652     05  APFNTERF PIC  X(0001).
  1653     05  FILLER REDEFINES APFNTERF.
  1654         10  APFNTERA PIC  X(0001).
  1655     05  APFNTERI PIC  9(2).
  1656 01  EL642AO REDEFINES EL642AI.
  1657     05  FILLER            PIC  X(0012).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  ADATEO PIC  X(0008).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL642.cbl
  1663     05  ATIMEO PIC  99.99.
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  CMPNYIDO PIC  X(0003).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  USERIDO PIC  X(0004).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  ABEGBALO PIC  ZZZZZ9.99-.
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  ACARHDGO PIC  X(0007).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  AGRPHDGO PIC  X(0005).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  AUPDPRMO PIC  ZZZZZ9.99-.
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  AAGENTO PIC  X(0010).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  ACARIERO PIC  X(0001).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  AGROUPO PIC  X(0006).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  AUPDCOMO PIC  ZZZZZ9.99-.
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  APREMUMO PIC  ZZZZZ9.99-.
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  ACOMPISO PIC  ZZZZZ9.99-.
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  ACOMCANO PIC  ZZZZZ9.99-.
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  ABILL1O PIC  Z,ZZZ.
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  AINER1O PIC  Z,ZZZ.
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  APRVBL1O PIC  Z,ZZZ.
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  AADJUSTO PIC  ZZZZZ9.99-.
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  ABILL2O PIC  Z,ZZZ.
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  AINER2O PIC  Z,ZZZ.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL642.cbl
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  APRVBL2O PIC  Z,ZZZ.
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  AREMITO PIC  ZZZZZ9.99-.
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  ADISBURO PIC  ZZZZZ9.99-.
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  AACTHDGO PIC  X(0029).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  AACTDUEO PIC  ZZZZZ9.99-.
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  AENDHDGO PIC  X(0018).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  ANETDUEO PIC  ZZZZZ9.99-.
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  ABILTYPO PIC  X(0001).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  APRODSWO PIC  X(0001).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  AACCT1O PIC  X(0010).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  AACCT2O PIC  X(0010).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  AACCT3O PIC  X(0010).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  AUNKNERO PIC  ZZZ,ZZZ-.
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  AERMSG1O PIC  X(0076).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  AERMSG2O PIC  X(0076).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  APFNTERO PIC  99.
  1769*    -------------------------------
  1770 01  EL642BI REDEFINES EL642AI.
  1771     05  FILLER            PIC  X(0012).
  1772*    -------------------------------
  1773     05  BDATEL PIC S9(0004) COMP.
  1774     05  BDATEF PIC  X(0001).
  1775     05  FILLER REDEFINES BDATEF.
  1776         10  BDATEA PIC  X(0001).
  1777     05  BDATEI PIC  X(0008).
  1778*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL642.cbl
  1779     05  BTIMEL PIC S9(0004) COMP.
  1780     05  BTIMEF PIC  X(0001).
  1781     05  FILLER REDEFINES BTIMEF.
  1782         10  BTIMEA PIC  X(0001).
  1783     05  BTIMEI PIC  X(0005).
  1784*    -------------------------------
  1785     05  BCMPNYL PIC S9(0004) COMP.
  1786     05  BCMPNYF PIC  X(0001).
  1787     05  FILLER REDEFINES BCMPNYF.
  1788         10  BCMPNYA PIC  X(0001).
  1789     05  BCMPNYI PIC  X(0003).
  1790*    -------------------------------
  1791     05  BUSERIDL PIC S9(0004) COMP.
  1792     05  BUSERIDF PIC  X(0001).
  1793     05  FILLER REDEFINES BUSERIDF.
  1794         10  BUSERIDA PIC  X(0001).
  1795     05  BUSERIDI PIC  X(0004).
  1796*    -------------------------------
  1797     05  BCHKNOL PIC S9(0004) COMP.
  1798     05  BCHKNOF PIC  X(0001).
  1799     05  FILLER REDEFINES BCHKNOF.
  1800         10  BCHKNOA PIC  X(0001).
  1801     05  BCHKNOI PIC  9(6).
  1802*    -------------------------------
  1803     05  BNAMEL PIC S9(0004) COMP.
  1804     05  BNAMEF PIC  X(0001).
  1805     05  FILLER REDEFINES BNAMEF.
  1806         10  BNAMEA PIC  X(0001).
  1807     05  BNAMEI PIC  X(0029).
  1808*    -------------------------------
  1809     05  BCHKAMTL PIC S9(0004) COMP.
  1810     05  BCHKAMTF PIC  X(0001).
  1811     05  FILLER REDEFINES BCHKAMTF.
  1812         10  BCHKAMTA PIC  X(0001).
  1813     05  BCHKAMTI PIC  9(7)V99.
  1814*    -------------------------------
  1815     05  BADDR1L PIC S9(0004) COMP.
  1816     05  BADDR1F PIC  X(0001).
  1817     05  FILLER REDEFINES BADDR1F.
  1818         10  BADDR1A PIC  X(0001).
  1819     05  BADDR1I PIC  X(0029).
  1820*    -------------------------------
  1821     05  BADDR2L PIC S9(0004) COMP.
  1822     05  BADDR2F PIC  X(0001).
  1823     05  FILLER REDEFINES BADDR2F.
  1824         10  BADDR2A PIC  X(0001).
  1825     05  BADDR2I PIC  X(0029).
  1826*    -------------------------------
  1827     05  BPAYDT1L PIC S9(0004) COMP.
  1828     05  BPAYDT1F PIC  X(0001).
  1829     05  FILLER REDEFINES BPAYDT1F.
  1830         10  BPAYDT1A PIC  X(0001).
  1831     05  BPAYDT1I PIC  X(0008).
  1832*    -------------------------------
  1833     05  BCITYSTL PIC S9(0004) COMP.
  1834     05  BCITYSTF PIC  X(0001).
  1835     05  FILLER REDEFINES BCITYSTF.
  1836         10  BCITYSTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL642.cbl
  1837     05  BCITYSTI PIC  X(0029).
  1838*    -------------------------------
  1839     05  BPAYDT2L PIC S9(0004) COMP.
  1840     05  BPAYDT2F PIC  X(0001).
  1841     05  FILLER REDEFINES BPAYDT2F.
  1842         10  BPAYDT2A PIC  X(0001).
  1843     05  BPAYDT2I PIC  X(0008).
  1844*    -------------------------------
  1845     05  BZIPL PIC S9(0004) COMP.
  1846     05  BZIPF PIC  X(0001).
  1847     05  FILLER REDEFINES BZIPF.
  1848         10  BZIPA PIC  X(0001).
  1849     05  BZIPI PIC  X(0009).
  1850*    -------------------------------
  1851     05  BALAMTL PIC S9(0004) COMP.
  1852     05  BALAMTF PIC  X(0001).
  1853     05  FILLER REDEFINES BALAMTF.
  1854         10  BALAMTA PIC  X(0001).
  1855     05  BALAMTI PIC  X(0010).
  1856*    -------------------------------
  1857     05  BERMSGL PIC S9(0004) COMP.
  1858     05  BERMSGF PIC  X(0001).
  1859     05  FILLER REDEFINES BERMSGF.
  1860         10  BERMSGA PIC  X(0001).
  1861     05  BERMSGI PIC  X(0078).
  1862*    -------------------------------
  1863     05  BPFNTERL PIC S9(0004) COMP.
  1864     05  BPFNTERF PIC  X(0001).
  1865     05  FILLER REDEFINES BPFNTERF.
  1866         10  BPFNTERA PIC  X(0001).
  1867     05  BPFNTERI PIC  9(2).
  1868 01  EL642BO REDEFINES EL642AI.
  1869     05  FILLER            PIC  X(0012).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  BDATEO PIC  X(0008).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  BTIMEO PIC  99.99.
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  BCMPNYO PIC  X(0003).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  BUSERIDO PIC  X(0004).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  BCHKNOO PIC  X(0006).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  BNAMEO PIC  X(0029).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  BCHKAMTO PIC  Z(6).99.
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  BADDR1O PIC  X(0029).
  1894*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL642.cbl
  1895     05  FILLER            PIC  X(0003).
  1896     05  BADDR2O PIC  X(0029).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  BPAYDT1O PIC  X(0008).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  BCITYSTO PIC  X(0029).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  BPAYDT2O PIC  X(0008).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  BZIPO PIC  X(0009).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  BALAMTO PIC  Z(6).99-.
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  BERMSGO PIC  X(0078).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  BPFNTERO PIC  9(2).
  1918*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL642.cbl
  1920****************************************************************
  1921*
  1922* Copyright (c) 2007 by Clerity Solutions, Inc.
  1923* All rights reserved.
  1924*
  1925****************************************************************
  1926 01  DFHEIV.
  1927   02  DFHEIV0               PIC X(35).
  1928   02  DFHEIV1               PIC X(08).
  1929   02  DFHEIV2               PIC X(08).
  1930   02  DFHEIV3               PIC X(08).
  1931   02  DFHEIV4               PIC X(06).
  1932   02  DFHEIV5               PIC X(04).
  1933   02  DFHEIV6               PIC X(04).
  1934   02  DFHEIV7               PIC X(02).
  1935   02  DFHEIV8               PIC X(02).
  1936   02  DFHEIV9               PIC X(01).
  1937   02  DFHEIV10              PIC S9(7) COMP-3.
  1938   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1939   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1940   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1941   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1942   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1943   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1944   02  DFHEIV17              PIC X(04).
  1945   02  DFHEIV18              PIC X(04).
  1946   02  DFHEIV19              PIC X(04).
  1947   02  DFHEIV20              USAGE IS POINTER.
  1948   02  DFHEIV21              USAGE IS POINTER.
  1949   02  DFHEIV22              USAGE IS POINTER.
  1950   02  DFHEIV23              USAGE IS POINTER.
  1951   02  DFHEIV24              USAGE IS POINTER.
  1952   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1953   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1954   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1955   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1956   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1957   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1958   02  FILLER                PIC X(02).
  1959   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1960   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1961   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1962   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1963   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1964 LINKAGE  SECTION.
  1965*****************************************************************
  1966*                                                               *
  1967* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1968* All rights reserved.                                          *
  1969*                                                               *
  1970*****************************************************************
  1971 01  dfheiblk.
  1972     02  eibtime          pic s9(7) comp-3.
  1973     02  eibdate          pic s9(7) comp-3.
  1974     02  eibtrnid         pic x(4).
  1975     02  eibtaskn         pic s9(7) comp-3.
  1976     02  eibtrmid         pic x(4).
  1977     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL642.cbl
  1978     02  eibcposn         pic s9(4) comp.
  1979     02  eibcalen         pic s9(4) comp.
  1980     02  eibaid           pic x(1).
  1981     02  eibfiller1       pic x(1).
  1982     02  eibfn            pic x(2).
  1983     02  eibfiller2       pic x(2).
  1984     02  eibrcode         pic x(6).
  1985     02  eibfiller3       pic x(2).
  1986     02  eibds            pic x(8).
  1987     02  eibreqid         pic x(8).
  1988     02  eibrsrce         pic x(8).
  1989     02  eibsync          pic x(1).
  1990     02  eibfree          pic x(1).
  1991     02  eibrecv          pic x(1).
  1992     02  eibsend          pic x(1).
  1993     02  eibatt           pic x(1).
  1994     02  eibeoc           pic x(1).
  1995     02  eibfmh           pic x(1).
  1996     02  eibcompl         pic x(1).
  1997     02  eibsig           pic x(1).
  1998     02  eibconf          pic x(1).
  1999     02  eiberr           pic x(1).
  2000     02  eibrldbk         pic x(1).
  2001     02  eiberrcd         pic x(4).
  2002     02  eibsynrb         pic x(1).
  2003     02  eibnodat         pic x(1).
  2004     02  eibfiller5       pic x(2).
  2005     02  eibresp          pic 9(09) comp.
  2006     02  eibresp2         pic 9(09) comp.
  2007     02  dfheigdj         pic s9(4) comp.
  2008     02  dfheigdk         pic s9(4) comp.
  2009
  2010 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL642.cbl
  2012*01 PARMLIST             COMP.
  2013*    12  FILLER              PIC S9(8).
  2014*    12  ERPNDB-POINTER      PIC S9(8).
  2015*    12  ELCNTL-POINTER      PIC S9(8).
  2016*    12  ERCOMP-POINTER      PIC S9(8).
  2017*    12  ERPYAJ-POINTER      PIC S9(8).
  2018*    12  ERACCT-POINTER      PIC S9(8).
  2019*    12  ERBILL-POINTER      PIC S9(8).
  2020*    12  ERCOMM-POINTER      PIC S9(8).
  2021*    12  ERCTBL-POINTER      PIC S9(8).
  2022*    12  ERGXRF-POINTER      PIC S9(8).
  2023*    12  ERGXRF2-POINTER     PIC S9(8).
  2024*    12  ERGXRF3-POINTER     PIC S9(8).
  2025*    12  ERGXRF4-POINTER     PIC S9(8).
  2026*    12  ERGXRF5-POINTER     PIC S9(8).
  2027*    12  ERGXRF6-POINTER     PIC S9(8).
  2028*    12  ERGXRF7-POINTER     PIC S9(8).
  2029*    12  ERGXRF8-POINTER     PIC S9(8).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL642.cbl
  2031*                            COPY ERCPNDB.
  2032******************************************************************
  2033*                                                                *
  2034*                                                                *
  2035*                            ERCPNDB.                            *
  2036*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2037*                            VMOD=2.025                          *
  2038*                                                                *
  2039*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2040*                                                                *
  2041******************************************************************
  2042*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2043*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2044******************************************************************
  2045*                                                                *
  2046*                                                                *
  2047*   FILE TYPE = VSAM,KSDS                                        *
  2048*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2049*                                                                *
  2050*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2051*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2052*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2053*                                                 RKP=13,LEN=36  *
  2054*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2055*                                      AND CHG-SEQ.)             *
  2056*                                                RKP=49,LEN=11   *
  2057*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2058*                                      AND CHG-SEQ.)             *
  2059*                                                RKP=60,LEN=15   *
  2060*                                                                *
  2061*   LOG = NO                                                     *
  2062*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2063******************************************************************
  2064******************************************************************
  2065*                   C H A N G E   L O G
  2066*
  2067* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2068*-----------------------------------------------------------------
  2069*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2070* EFFECTIVE    NUMBER
  2071*-----------------------------------------------------------------
  2072* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2073* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2074* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2075* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2076* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2077* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2078* 032306                   PEMA  ADD BOW LOAN NUMBER
  2079* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2080* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2081* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2082* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2083* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2084* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2085* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2086* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2087* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2088******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL642.cbl
  2089
  2090 01  PENDING-BUSINESS.
  2091     12  PB-RECORD-ID                     PIC XX.
  2092         88  VALID-PB-ID                        VALUE 'PB'.
  2093
  2094     12  PB-CONTROL-PRIMARY.
  2095         16  PB-COMPANY-CD                PIC X.
  2096         16  PB-ENTRY-BATCH               PIC X(6).
  2097         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2098         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2099
  2100     12  PB-CONTROL-BY-ACCOUNT.
  2101         16  PB-COMPANY-CD-A1             PIC X.
  2102         16  PB-CARRIER                   PIC X.
  2103         16  PB-GROUPING.
  2104             20  PB-GROUPING-PREFIX       PIC XXX.
  2105             20  PB-GROUPING-PRIME        PIC XXX.
  2106         16  PB-STATE                     PIC XX.
  2107         16  PB-ACCOUNT.
  2108             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2109             20  PB-ACCOUNT-PRIME         PIC X(6).
  2110         16  PB-CERT-EFF-DT               PIC XX.
  2111         16  PB-CERT-NO.
  2112             20  PB-CERT-PRIME            PIC X(10).
  2113             20  PB-CERT-SFX              PIC X.
  2114         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2115
  2116         16  PB-RECORD-TYPE               PIC X.
  2117             88  PB-MAILING-DATA                VALUE '0'.
  2118             88  PB-ISSUE                       VALUE '1'.
  2119             88  PB-CANCELLATION                VALUE '2'.
  2120             88  PB-BATCH-TRAILER               VALUE '9'.
  2121
  2122     12  PB-CONTROL-BY-ORIG-BATCH.
  2123         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2124         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2125         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2126         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2127
  2128     12  PB-CONTROL-BY-CSR.
  2129         16  PB-CSR-COMPANY-CD            PIC X.
  2130         16  PB-CSR-ID                    PIC X(4).
  2131         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2132         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2133         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2134******************************************************************
  2135*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2136******************************************************************
  2137
  2138     12  PB-LAST-MAINT-DT                 PIC XX.
  2139     12  PB-LAST-MAINT-BY                 PIC X(4).
  2140     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2141
  2142     12  PB-RECORD-BODY                   PIC X(375).
  2143
  2144     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2145         16  PB-CERT-ORIGIN               PIC X.
  2146             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL642.cbl
  2147         16  PB-I-NAME.
  2148             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2149             20  PB-I-INSURED-FIRST-NAME.
  2150                 24  PB-I-INSURED-1ST-INIT PIC X.
  2151                 24  FILLER                PIC X(9).
  2152             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2153         16  PB-I-AGE                     PIC S99   COMP-3.
  2154         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2155         16  PB-I-BIRTHDAY                PIC XX.
  2156         16  PB-I-INSURED-SEX             PIC X.
  2157             88  PB-SEX-MALE     VALUE 'M'.
  2158             88  PB-SEX-FEMALE   VALUE 'F'.
  2159
  2160         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2161         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2162         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2163         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2164         16  PB-I-SKIP-CODE               PIC X.
  2165             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2166             88  PB-SKIP-JULY              VALUE '1'.
  2167             88  PB-SKIP-AUGUST            VALUE '2'.
  2168             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2169             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2170             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2171             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2172             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2173             88  PB-SKIP-JUNE              VALUE '8'.
  2174             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2175             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2176             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2177         16  PB-I-TERM-TYPE               PIC X.
  2178             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2179             88  PB-PAID-WEEKLY            VALUE 'W'.
  2180             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2181             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2182             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2183         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2184         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2185         16  PB-I-DATA-ENTRY-SW           PIC X.
  2186             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2187             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2188             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2189             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2190         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2191         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2192*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2193         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2194         16  FILLER                       PIC X.
  2195
  2196         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2197             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2198             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2199                                                   '90' THRU '99'.
  2200         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2201                                          PIC XX.
  2202         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2203         16  PB-I-AMOUNT-FINANCED REDEFINES
  2204                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL642.cbl
  2205         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2206         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2207                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2208         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2209         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2210         16  PB-I-CLP-AMOUNT REDEFINES
  2211                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2212         16  PB-I-LF-CALC-FLAG            PIC X.
  2213             88 PB-COMP-LF-PREM               VALUE '?'.
  2214         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2215         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2216         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2217         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2218         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2219         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2220         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2221         16  PB-I-LF-ABBR                 PIC XXX.
  2222         16  PB-I-LF-INPUT-CD             PIC XX.
  2223
  2224         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2225             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2226             88  PB-INVALID-AH               VALUE '  ' '00'
  2227                                                   '90' THRU '99'.
  2228         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2229         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2230         16  PB-I-AH-CALC-FLAG            PIC X.
  2231             88 PB-COMP-AH-PREM                  VALUE '?'.
  2232         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2233         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2234         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2235         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2236         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2237         16  PB-I-AH-ABBR                 PIC XXX.
  2238         16  PB-I-AH-INPUT-CD             PIC XXX.
  2239
  2240         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2241         16  PB-I-REIN-TABLE              PIC XXX.
  2242         16  PB-I-BUSINESS-TYPE           PIC 99.
  2243         16  PB-I-INDV-GRP-CD             PIC X.
  2244         16  PB-I-MORT-CODE.
  2245             20  PB-I-TABLE               PIC X.
  2246             20  PB-I-INTEREST            PIC XX.
  2247             20  PB-I-MORT-TYP            PIC X.
  2248         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2249         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2250         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2251         16  PB-I-INDV-GRP-OVRD           PIC X.
  2252         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2253         16  PB-I-SIG-SW                  PIC X.
  2254             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2255         16  PB-I-RATE-CLASS              PIC XX.
  2256         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2257         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2258         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2259         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2260         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2261         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2262         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL642.cbl
  2263         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2264         16  PB-I-OB-FLAG                 PIC X.
  2265             88  PB-I-OB                      VALUE 'B'.
  2266             88  PB-I-SUMMARY                 VALUE 'Z'.
  2267         16  PB-I-ENTRY-STATUS            PIC X.
  2268             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2269                                              'M' '5' '9' '2'.
  2270             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2271             88  PB-I-POLICY-PENDING          VALUE '2'.
  2272             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2273             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2274             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2275             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2276             88  PB-I-REIN-ONLY               VALUE '9'.
  2277             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2278             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2279             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2280             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2281         16  PB-I-INT-CODE                PIC X.
  2282             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2283             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2284         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2285         16  PB-I-SOC-SEC-NO              PIC X(11).
  2286         16  PB-I-MEMBER-NO               PIC X(12).
  2287         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2288*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2289         16  PB-I-OLD-LOF                 PIC XXX.
  2290         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2291         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2292         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2293         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2294         16  PB-I-LIFE-INDICATOR          PIC X.
  2295             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2296         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2297         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2298                                          PIC S9(5)V99    COMP-3.
  2299         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2300             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2301             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2302         16  PB-I-1ST-PMT-DT              PIC XX.
  2303         16  PB-I-JOINT-INSURED.
  2304             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2305             20 PB-I-JOINT-FIRST-NAME.
  2306                24  PB-I-JOINT-FIRST-INIT PIC X.
  2307                24  FILLER                PIC X(9).
  2308             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2309*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2310         16  PB-I-BENEFICIARY-NAME.
  2311             20  PB-I-BANK-NUMBER         PIC X(10).
  2312             20  FILLER                   PIC X(15).
  2313         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2314         16  PB-I-REFERENCE               PIC X(12).
  2315         16  FILLER REDEFINES PB-I-REFERENCE.
  2316             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2317             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2318             20  PB-I-CLP-STATE           PIC XX.
  2319         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2320             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL642.cbl
  2321             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2322             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2323         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2324         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2325         16  PB-I-RESIDENT-STATE          PIC XX.
  2326         16  PB-I-RATE-CODE               PIC X(4).
  2327         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2328         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2329         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2330         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2331         16  PB-I-BANK-NOCHRGB            PIC 99.
  2332         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2333         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2334
  2335     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2336         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2337             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2338         16  PB-C-CANCEL-ORIGIN           PIC X.
  2339             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2340         16  PB-C-LF-CANCEL-DT            PIC XX.
  2341         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2342         16  PB-C-LF-CALC-REQ             PIC X.
  2343             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2344         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2345         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2346         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2347             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2348         16  PB-C-AH-CANCEL-DT            PIC XX.
  2349         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2350         16  PB-C-AH-CALC-REQ             PIC X.
  2351             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2352         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2353         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2354         16  PB-C-LAST-NAME               PIC X(15).
  2355         16  PB-C-REFUND-SW               PIC X.
  2356             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2357             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2358         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2359         16  PB-C-PAYEE-CODE              PIC X(6).
  2360         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2361         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2362         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2363         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2364         16  PB-C-REFERENCE               PIC X(12).
  2365         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2366         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2367         16  PB-C-POST-CARD-IND           PIC X.
  2368         16  PB-C-CANCEL-REASON           PIC X.
  2369         16  PB-C-REF-INTERFACE-SW        PIC X.
  2370         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2371         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2372         16  FILLER                       PIC X(01).
  2373*        16  FILLER                       PIC X(18).
  2374         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2375*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2376         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2377         16  PB-CANCELED-CERT-DATA.
  2378             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL642.cbl
  2379                 24  PB-CI-LAST-NAME      PIC X(15).
  2380                 24  PB-CI-INITIALS       PIC XX.
  2381             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2382             20  PB-CI-INSURED-SEX        PIC X.
  2383             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2384             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2385             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2386             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2387             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2388             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2389             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2390             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2391             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2392             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2393             20  PB-CI-RATE-CLASS         PIC XX.
  2394             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2395             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2396             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2397             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2398             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2399             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2400             20  PB-CI-LF-ABBR            PIC X(3).
  2401             20  PB-CI-AH-ABBR            PIC X(3).
  2402             20  PB-CI-OB-FLAG            PIC X.
  2403                 88  PB-CI-OB                VALUE 'B'.
  2404             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2405                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2406                                           'M' '4' '5' '9' '2'.
  2407                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2408                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2409                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2410                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2411                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2412                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2413                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2414                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2415                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2416                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2417                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2418                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2419                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2420             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2421                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2422                                           'M' '4' '5' '9' '2'.
  2423                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2424                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2425                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2426                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2427                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2428                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2429                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2430                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2431                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2432                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2433                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2434                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2435                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2436             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL642.cbl
  2437             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2438             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2439             20  PB-CI-MEMBER-NO          PIC X(12).
  2440             20  PB-CI-INT-CODE           PIC X.
  2441                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2442                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2443             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2444             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2445             20  PB-CI-COMP-EXCP-SW       PIC X.
  2446                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2447                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2448             20  PB-CI-ENTRY-STATUS       PIC X.
  2449             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2450             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2451             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2452             20  PB-CI-DEATH-DT           PIC XX.
  2453             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2454             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2455             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2456             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2457             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2458             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2459             20  PB-CI-ENTRY-DT              PIC XX.
  2460             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2461             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2462             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2463             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2464             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2465             20  PB-CI-OLD-LOF               PIC XXX.
  2466*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2467             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2468             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2469             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2470             20  PB-CI-INDV-GRP-CD           PIC X.
  2471             20  PB-CI-BENEFICIARY-NAME.
  2472                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2473                 24  FILLER                  PIC X(15).
  2474             20  PB-CI-NOTE-SW               PIC X.
  2475             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2476             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2477             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2478             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2479             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2480             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2481             20  PB-CI-FIRST-NAME            PIC X(10).
  2482             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2483
  2484         16  FILLER                       PIC X(13).
  2485*032306  16  FILLER                       PIC X(27).
  2486*        16  FILLER                       PIC X(46).
  2487
  2488     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2489         16  FILLER                       PIC X(10).
  2490         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2491         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2492         16  PB-M-INSURED-MID-INIT        PIC X.
  2493         16  PB-M-INSURED-AGE             PIC 99.
  2494         16  PB-M-INSURED-BIRTHDAY        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL642.cbl
  2495         16  PB-M-INSURED-SEX             PIC X.
  2496         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2497         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2498         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2499         16  PB-M-INSURED-CITY-STATE.
  2500             20  PB-M-INSURED-CITY        PIC X(28).
  2501             20  PB-M-INSURED-STATE       PIC XX.
  2502         16  PB-M-INSURED-ZIP-CODE.
  2503             20  PB-M-INSURED-ZIP-PRIME.
  2504                 24  PB-M-INSURED-ZIP-1   PIC X.
  2505                     88  PB-M-CANADIAN-POST-CODE
  2506                                             VALUE 'A' THRU 'Z'.
  2507                 24  FILLER               PIC X(4).
  2508             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2509         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2510                                        PB-M-INSURED-ZIP-CODE.
  2511             20  PM-M-INS-CAN-POST1       PIC XXX.
  2512             20  PM-M-INS-CAN-POST2       PIC XXX.
  2513             20  FILLER                   PIC XXX.
  2514         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2515         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2516         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2517         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2518         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2519         16  PB-M-CRED-BENE-CITYST.
  2520             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2521             20  PB-M-CRED-BENE-STATE     PIC XX.
  2522         16  FILLER                       PIC X(92).
  2523
  2524     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2525         16  FILLER                       PIC X(10).
  2526         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2527         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2528         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2529         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2530         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2531         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2532         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2533         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2534         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2535         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2536         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2537         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2538         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2539         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2540         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2541         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2542         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2543         16  PB-ACCOUNT-NAME              PIC X(30).
  2544         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2545         16  PB-REFERENCE                 PIC X(12).
  2546         16  PB-B-RECEIVED-DT             PIC XX.
  2547         16  FILLER                       PIC X(234).
  2548
  2549     12  PB-RECORD-STATUS.
  2550         16  PB-CREDIT-SELECT-DT          PIC XX.
  2551         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2552         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL642.cbl
  2553         16  PB-BILLING-STATUS            PIC X.
  2554             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2555             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2556             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2557         16  PB-RECORD-BILL               PIC X.
  2558             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2559             88  PB-RECORD-RETURNED           VALUE 'R'.
  2560             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2561             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2562             88  PB-OVERRIDE-AH               VALUE 'A'.
  2563             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2564         16  PB-BATCH-ENTRY               PIC X.
  2565             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2566             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2567             88  PB-REISSUED-CERT             VALUE 'E'.
  2568             88  PB-CASH-CERT                 VALUE 'C'.
  2569             88  PB-MONTHLY-CERT              VALUE 'M'.
  2570             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2571             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2572             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2573         16  PB-FORCE-CODE                PIC X.
  2574             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2575             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2576             88  PB-CANCEL-FORCE              VALUE '8'.
  2577             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2578             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2579             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2580             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2581             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2582             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2583             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2584         16  PB-FATAL-FLAG                PIC X.
  2585             88  PB-FATAL-ERRORS              VALUE 'X'.
  2586         16  PB-FORCE-ER-CD               PIC X.
  2587             88  PB-FORCE-ERRORS              VALUE 'F'.
  2588             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2589         16  PB-WARN-ER-CD                PIC X.
  2590             88  PB-WARNING-ERRORS            VALUE 'W'.
  2591         16  FILLER                       PIC X.
  2592         16  PB-OUT-BAL-CD                PIC X.
  2593             88  PB-OUT-OF-BAL                VALUE 'O'.
  2594         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2595         16  PB-AH-OVERRIDE-L1            PIC X.
  2596         16  PB-INPUT-DT                  PIC XX.
  2597         16  PB-INPUT-BY                  PIC X(4).
  2598         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2599         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2600         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2601         16  PB-LF-EARNING-METHOD         PIC X.
  2602         16  PB-AH-EARNING-METHOD         PIC X.
  2603         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2604         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2605         16  PB-REIN-CD                   PIC XXX.
  2606         16  PB-LF-REFUND-TYPE            PIC X.
  2607         16  PB-AH-REFUND-TYPE            PIC X.
  2608         16  PB-ACCT-EFF-DT               PIC XX.
  2609         16  PB-ACCT-EXP-DT               PIC XX.
  2610         16  PB-COMPANY-ID                PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL642.cbl
  2611         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2612         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2613         16  PB-SV-CARRIER                PIC X.
  2614         16  PB-SV-GROUPING               PIC X(6).
  2615         16  PB-SV-STATE                  PIC XX.
  2616         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2617         16  PB-GA-BILLING-INFO.
  2618             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2619                                          PIC XX.
  2620         16  PB-SV-REMIT-TO  REDEFINES
  2621             PB-GA-BILLING-INFO           PIC X(10).
  2622         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2623         16  PB-I-LOAN-OFFICER            PIC X(5).
  2624         16  PB-I-VIN                     PIC X(17).
  2625
  2626         16  FILLER                       PIC X(04).
  2627         16  IMNET-BYPASS-SW              PIC X.
  2628
  2629******************************************************************
  2630*                COMMON EDIT ERRORS                              *
  2631******************************************************************
  2632
  2633     12  PB-COMMON-ERRORS.
  2634         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2635                                           PIC S9(4)     COMP.
  2636
  2637******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL642.cbl
  2639*                            COPY ELCCNTL.
  2640******************************************************************
  2641*                                                                *
  2642*                                                                *
  2643*                            ELCCNTL.                            *
  2644*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2645*                            VMOD=2.059                          *
  2646*                                                                *
  2647*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2648*                                                                *
  2649*   FILE TYPE = VSAM,KSDS                                        *
  2650*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2651*                                                                *
  2652*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2653*       ALTERNATE INDEX = NONE                                   *
  2654*                                                                *
  2655*   LOG = YES                                                    *
  2656*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2657******************************************************************
  2658*                   C H A N G E   L O G
  2659*
  2660* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2661*-----------------------------------------------------------------
  2662*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2663* EFFECTIVE    NUMBER
  2664*-----------------------------------------------------------------
  2665* 082503                   PEMA  ADD BENEFIT GROUP
  2666* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2667* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2668* 092705    2005050300006  PEMA  ADD SPP LEASES
  2669* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2670* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2671* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2672* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2673* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2674* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2675* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2676* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2677* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2678* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2679******************************************************************
  2680*
  2681 01  CONTROL-FILE.
  2682     12  CF-RECORD-ID                       PIC XX.
  2683         88  VALID-CF-ID                        VALUE 'CF'.
  2684
  2685     12  CF-CONTROL-PRIMARY.
  2686         16  CF-COMPANY-ID                  PIC XXX.
  2687         16  CF-RECORD-TYPE                 PIC X.
  2688             88  CF-COMPANY-MASTER              VALUE '1'.
  2689             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2690             88  CF-STATE-MASTER                VALUE '3'.
  2691             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2692             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2693             88  CF-CARRIER-MASTER              VALUE '6'.
  2694             88  CF-MORTALITY-MASTER            VALUE '7'.
  2695             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2696             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL642.cbl
  2697             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2698             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2699             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2700             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2701             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2702             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2703             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2704             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2705             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2706         16  CF-ACCESS-CD-GENL              PIC X(4).
  2707         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2708             20  CF-PROCESSOR               PIC X(4).
  2709         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2710             20  CF-STATE-CODE              PIC XX.
  2711             20  FILLER                     PIC XX.
  2712         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2713             20  FILLER                     PIC XX.
  2714             20  CF-HI-BEN-IN-REC           PIC XX.
  2715         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2716             20  FILLER                     PIC XXX.
  2717             20  CF-CARRIER-CNTL            PIC X.
  2718         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2719             20  FILLER                     PIC XX.
  2720             20  CF-HI-TYPE-IN-REC          PIC 99.
  2721         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2722             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2723                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2724             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2725             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2726         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2727             20  FILLER                     PIC X.
  2728             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2729         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2730             20  FILLER                     PIC XX.
  2731             20  CF-MORTGAGE-PLAN           PIC XX.
  2732         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2733
  2734     12  CF-LAST-MAINT-DT                   PIC XX.
  2735     12  CF-LAST-MAINT-BY                   PIC X(4).
  2736     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2737
  2738     12  CF-RECORD-BODY                     PIC X(728).
  2739
  2740
  2741****************************************************************
  2742*             COMPANY MASTER RECORD                            *
  2743****************************************************************
  2744
  2745     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2746         16  CF-COMPANY-ADDRESS.
  2747             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2748             20  CF-CL-IN-CARE-OF           PIC X(30).
  2749             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2750             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2751             20  CF-CL-CITY-STATE           PIC X(30).
  2752             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2753             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2754         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL642.cbl
  2755         16  CF-COMPANY-PASSWORD            PIC X(8).
  2756         16  CF-SECURITY-OPTION             PIC X.
  2757             88  ALL-SECURITY                   VALUE '1'.
  2758             88  COMPANY-VERIFY                 VALUE '2'.
  2759             88  PROCESSOR-VERIFY               VALUE '3'.
  2760             88  NO-SECURITY                    VALUE '4'.
  2761             88  ALL-BUT-TERM                   VALUE '5'.
  2762         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2763             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2764         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2765             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2766         16  CF-INFORCE-LOCATION            PIC X.
  2767             88  CERTS-ARE-ONLINE               VALUE '1'.
  2768             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2769             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2770         16  CF-LOWER-CASE-LETTERS          PIC X.
  2771         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2772             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2773             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2774             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2775             88  CF-ACCNT-CNTL                  VALUE '3'.
  2776             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2777
  2778         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2779         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2780
  2781         16  CF-LGX-CREDIT-USER             PIC X.
  2782             88  CO-IS-NOT-USER                 VALUE 'N'.
  2783             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2784
  2785         16 CF-CREDIT-CALC-CODES.
  2786             20  CF-CR-REM-TERM-CALC PIC X.
  2787               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2788               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2789               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2790               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2791               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2792               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2793               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2794             20  CF-CR-R78-METHOD           PIC X.
  2795               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2796               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2797
  2798         16  CF-CLAIM-CONTROL-COUNTS.
  2799             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2800                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2801
  2802             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2803                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2804
  2805             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2806                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2807
  2808             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2809                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2810
  2811         16  CF-CURRENT-MONTH-END           PIC XX.
  2812
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL642.cbl
  2813         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2814             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2815             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2816             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2817             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2818                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2819                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2820             20  CF-CO-PREM-REJECT-SW       PIC X.
  2821                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2822                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2823             20  CF-CO-REF-REJECT-SW        PIC X.
  2824                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2825                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2826
  2827         16  CF-CO-REPORTING-DT             PIC XX.
  2828         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2829         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2830           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2831           88  CF-CO-MONTH-END                  VALUE '1'.
  2832
  2833         16  CF-LGX-CLAIM-USER              PIC X.
  2834             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2835             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2836
  2837         16  CF-CREDIT-EDIT-CONTROLS.
  2838             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2839             20  CF-MIN-AGE                 PIC 99.
  2840             20  CF-DEFAULT-AGE             PIC 99.
  2841             20  CF-MIN-TERM                PIC S999      COMP-3.
  2842             20  CF-MAX-TERM                PIC S999      COMP-3.
  2843             20  CF-DEFAULT-SEX             PIC X.
  2844             20  CF-JOINT-AGE-INPUT         PIC X.
  2845                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2846             20  CF-BIRTH-DATE-INPUT        PIC X.
  2847                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2848             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2849                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2850                 88  CF-ZERO-CARRIER            VALUE '1'.
  2851                 88  CF-ZERO-GROUPING           VALUE '2'.
  2852                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2853             20  CF-EDIT-SW                 PIC X.
  2854                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2855             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2856             20  CF-CR-PR-METHOD            PIC X.
  2857               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2858               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2859             20  FILLER                     PIC X.
  2860
  2861         16  CF-CREDIT-MISC-CONTROLS.
  2862             20  CF-REIN-TABLE-SW           PIC X.
  2863                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2864             20  CF-COMP-TABLE-SW           PIC X.
  2865                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2866             20  CF-EXPERIENCE-RETENTION-AGE
  2867                                            PIC S9        COMP-3.
  2868             20  CF-CONVERSION-DT           PIC XX.
  2869             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2870             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL642.cbl
  2871                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2872                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2873
  2874             20  CF-CR-CHECK-NO-CONTROL.
  2875                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2876                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2877                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2878                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2879                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2880                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2881
  2882                 24  CF-CR-CHECK-COUNT       REDEFINES
  2883                     CF-CR-CHECK-COUNTER      PIC X(4).
  2884
  2885                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2886                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2887
  2888                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2889                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2890                 24  CF-MAIL-PROCESSING       PIC X.
  2891                     88  MAIL-PROCESSING          VALUE 'Y'.
  2892
  2893         16  CF-MISC-SYSTEM-CONTROL.
  2894             20  CF-SYSTEM-C                 PIC X.
  2895                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2896             20  CF-SYSTEM-D                 PIC X.
  2897                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2898             20  CF-SOC-SEC-NO-SW            PIC X.
  2899                 88  SOC-SEC-NO-USED             VALUE '1'.
  2900             20  CF-MEMBER-NO-SW             PIC X.
  2901                 88  MEMBER-NO-USED              VALUE '1'.
  2902             20  CF-TAX-ID-NUMBER            PIC X(11).
  2903             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2904             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2905                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2906                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2907                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2908                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2909             20  CF-SYSTEM-E                 PIC X.
  2910                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2911
  2912         16  CF-LGX-LIFE-USER               PIC X.
  2913             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2914             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2915
  2916         16  CF-CR-MONTH-END-DT             PIC XX.
  2917
  2918         16  CF-FILE-MAINT-DATES.
  2919             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2920                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2921             20  CF-LAST-BATCH       REDEFINES
  2922                 CF-LAST-BATCH-NO               PIC X(4).
  2923             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2924             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2925             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2926             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2927             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2928             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL642.cbl
  2929             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2930             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2931             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2932             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2933
  2934         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2935         16  FILLER                         PIC X.
  2936
  2937         16  CF-ALT-MORT-CODE               PIC X(4).
  2938         16  CF-MEMBER-CAPTION              PIC X(10).
  2939
  2940         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2941             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2942             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2943             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2944             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2945             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2946
  2947         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2948
  2949         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2950         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2951         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2952         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2953
  2954         16  CF-AH-OVERRIDE-L1              PIC X.
  2955         16  CF-AH-OVERRIDE-L2              PIC XX.
  2956         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2957         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2958
  2959         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2960         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2961
  2962         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2963         16  CF-AR-LAST-EL860-DT            PIC XX.
  2964         16  CF-MP-MONTH-END-DT             PIC XX.
  2965
  2966         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2967         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2968             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2969
  2970         16  CF-AR-MONTH-END-DT             PIC XX.
  2971
  2972         16  CF-CRDTCRD-USER                PIC X.
  2973             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2974             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2975
  2976         16  CF-CC-MONTH-END-DT             PIC XX.
  2977
  2978         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2979
  2980         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2981             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2982             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2983             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2984         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2985         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2986         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL642.cbl
  2987         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2988             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2989             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2990         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2991         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2992         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2993             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2994         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2995
  2996         16  CF-CL-ZIP-CODE.
  2997             20  CF-CL-ZIP-PRIME.
  2998                 24  CF-CL-ZIP-1ST          PIC X.
  2999                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3000                 24  FILLER                 PIC X(4).
  3001             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3002         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3003             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3004             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3005             20  FILLER                     PIC XXX.
  3006
  3007         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3008         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3009         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3010         16  CF-CO-OPTION-START-DATE        PIC XX.
  3011         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3012           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3013                                                      '3' '4'.
  3014           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3015           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3016           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3017           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3018           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3019           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3020
  3021         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3022
  3023         16  CF-PAYMENT-APPROVAL-LEVELS.
  3024             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3025             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3026             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3027             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3028             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3029             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3030
  3031         16  CF-END-USER-REPORTING-USER     PIC X.
  3032             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3033             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3034
  3035         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3036             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3037             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3038
  3039         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3040
  3041         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3042         16  FILLER                         PIC X.
  3043
  3044         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL642.cbl
  3045             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3046             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3047             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3048
  3049         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3050
  3051         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3052             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3053             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3054
  3055         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3056             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3057             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3058
  3059         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3060
  3061         16  CF-CO-ACH-ID-CODE              PIC  X.
  3062             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3063             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3064             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3065         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3066         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3067         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3068         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3069         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3070         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3071         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3072         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3073         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3074                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3075         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3076                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3077
  3078         16  CF-CO-OVER-SHORT.
  3079             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3080             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3081
  3082*         16  FILLER                         PIC X(102).
  3083         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3084             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3085             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3086
  3087         16  CF-AH-APPROVAL-DAYS.
  3088             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3089             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3090             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3091             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3092
  3093         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3094
  3095         16  CF-APPROV-LEV-5.
  3096             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3097             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3098             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3099
  3100         16  FILLER                         PIC X(68).
  3101****************************************************************
  3102*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL642.cbl
  3103****************************************************************
  3104
  3105     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3106         16  CF-PROCESSOR-NAME              PIC X(30).
  3107         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3108         16  CF-PROCESSOR-TITLE             PIC X(26).
  3109         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3110                 88  MESSAGE-YES                VALUE 'Y'.
  3111                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3112
  3113*****************************************************
  3114****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3115****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3116****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3117****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3118*****************************************************
  3119
  3120         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3121             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3122             20  CF-APPLICATION-FORCE       PIC X.
  3123             20  CF-INDIVIDUAL-APP.
  3124                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3125                     28  CF-BROWSE-APP      PIC X.
  3126                     28  CF-UPDATE-APP      PIC X.
  3127
  3128         16  CF-CURRENT-TERM-ON             PIC X(4).
  3129         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3130             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3131             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3132             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3133             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3134             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3135             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3136             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3137         16  CF-PROCESSOR-CARRIER           PIC X.
  3138             88  NO-CARRIER-SECURITY            VALUE ' '.
  3139         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3140             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3141         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3142             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3143         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3144             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3145
  3146         16  CF-PROC-SYS-ACCESS-SW.
  3147             20  CF-PROC-CREDIT-CLAIMS-SW.
  3148                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3149                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3150                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3151                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3152             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3153                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3154                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3155             20  CF-PROC-LIFE-GNRLDGR-SW.
  3156                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3157                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3158                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3159                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3160             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL642.cbl
  3161                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3162                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3163         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3164             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3165             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3166         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3167
  3168         16  CF-APPROVAL-LEVEL                  PIC X.
  3169             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3170             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3171             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3172             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3173             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3174
  3175         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3176
  3177         16  CF-LANGUAGE-TYPE                   PIC X.
  3178             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3179             88  CF-LANG-IS-FR                      VALUE 'F'.
  3180
  3181         16  CF-CSR-IND                         PIC X.
  3182         16  FILLER                             PIC X(239).
  3183
  3184****************************************************************
  3185*             PROCESSOR/REMINDERS RECORD                       *
  3186****************************************************************
  3187
  3188     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3189         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3190             20  CF-START-REMIND-DT         PIC XX.
  3191             20  CF-END-REMIND-DT           PIC XX.
  3192             20  CF-REMINDER-TEXT           PIC X(50).
  3193         16  FILLER                         PIC X(296).
  3194
  3195
  3196****************************************************************
  3197*             STATE MASTER RECORD                              *
  3198****************************************************************
  3199
  3200     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3201         16  CF-STATE-ABBREVIATION          PIC XX.
  3202         16  CF-STATE-NAME                  PIC X(25).
  3203         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3204         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3205             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3206             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3207             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3208             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3209                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3210                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3211             20  CF-ST-PREM-REJECT-SW       PIC X.
  3212                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3213                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3214             20  CF-ST-REF-REJECT-SW        PIC X.
  3215                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3216                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3217         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3218         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL642.cbl
  3219         16  CF-ST-REFUND-RULES.
  3220             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3221             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3222             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3223         16  CF-ST-FST-PMT-EXTENSION.
  3224             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3225             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3226                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3227                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3228                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3229                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3230         16  CF-ST-STATE-CALL.
  3231             20  CF-ST-CALL-UNEARNED        PIC X.
  3232             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3233             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3234         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3235             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3236             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3237         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3238         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3239         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3240         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3241         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3242         16  FILLER                         PIC X.
  3243         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3244             20  CF-ST-BENEFIT-CD           PIC XX.
  3245             20  CF-ST-BENEFIT-KIND         PIC X.
  3246                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3247                 88  CF-ST-AH-KIND              VALUE 'A'.
  3248             20  CF-ST-REM-TERM-CALC        PIC X.
  3249                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3250                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3251                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3252                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3253                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3254                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3255                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3256                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3257
  3258             20  CF-ST-REFUND-CALC          PIC X.
  3259                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3260                 88  ST-REFD-BY-R78             VALUE '1'.
  3261                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3262                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3263                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3264                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3265                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3266                 88  ST-REFD-UTAH               VALUE '7'.
  3267                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3268                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3269                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3270
  3271             20  CF-ST-EARNING-CALC         PIC X.
  3272                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3273                 88  ST-EARN-BY-R78             VALUE '1'.
  3274                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3275                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3276                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL642.cbl
  3277                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3278                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3279                 88  ST-EARN-MEAN               VALUE '8'.
  3280                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3281
  3282             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3283                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3284                 88  ST-OVRD-BY-R78             VALUE '1'.
  3285                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3286                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3287                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3288                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3289                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3290                 88  ST-OVRD-MEAN               VALUE '8'.
  3291                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3292             20  FILLER                     PIC X.
  3293
  3294         16  CF-ST-COMMISSION-CAPS.
  3295             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3296             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3297             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3298             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3299         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3300                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3301
  3302         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3303
  3304         16  CF-ST-STATUTORY-INTEREST.
  3305             20  CF-ST-STAT-DATE-FROM       PIC X.
  3306                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3307                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3308             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3309             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3310             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3311             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3312             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3313
  3314         16  CF-ST-OVER-SHORT.
  3315             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3316             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3317
  3318         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3319
  3320         16  CF-ST-RT-CALC                  PIC X.
  3321
  3322         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3323         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3324         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3325         16  CF-ST-RF-LR-CALC               PIC X.
  3326         16  CF-ST-RF-LL-CALC               PIC X.
  3327         16  CF-ST-RF-LN-CALC               PIC X.
  3328         16  CF-ST-RF-AH-CALC               PIC X.
  3329         16  CF-ST-RF-CP-CALC               PIC X.
  3330*        16  FILLER                         PIC X(206).
  3331*CIDMOD         16  FILLER                         PIC X(192).
  3332         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3333             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3334         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL642.cbl
  3335         16  CF-ST-VFY-2ND-BENE             PIC X.
  3336         16  CF-ST-CAUSAL-STATE             PIC X.
  3337         16  FILLER                         PIC X(185).
  3338
  3339****************************************************************
  3340*             BENEFIT MASTER RECORD                            *
  3341****************************************************************
  3342
  3343     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3344         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3345             20  CF-BENEFIT-CODE            PIC XX.
  3346             20  CF-BENEFIT-NUMERIC  REDEFINES
  3347                 CF-BENEFIT-CODE            PIC XX.
  3348             20  CF-BENEFIT-ALPHA           PIC XXX.
  3349             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3350             20  CF-BENEFIT-COMMENT         PIC X(10).
  3351
  3352             20  CF-LF-COVERAGE-TYPE        PIC X.
  3353                 88  CF-REDUCING                VALUE 'R'.
  3354                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3355
  3356             20  CF-SPECIAL-CALC-CD         PIC X.
  3357                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3358                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3359                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3360                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3361                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3362                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3363                 88  CF-FARM-PLAN               VALUE 'F'.
  3364                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3365                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3366                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3367                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3368                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3369                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3370                 88  CF-PRUDENTIAL              VALUE 'P'.
  3371                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3372                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3373                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3374                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3375                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3376                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3377
  3378             20  CF-JOINT-INDICATOR         PIC X.
  3379                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3380
  3381*            20  FILLER                     PIC X(12).
  3382             20  cf-maximum-benefits        pic s999 comp-3.
  3383             20  FILLER                     PIC X(09).
  3384             20  CF-BENEFIT-CATEGORY        PIC X.
  3385             20  CF-LOAN-TYPE               PIC X(8).
  3386
  3387             20  CF-CO-REM-TERM-CALC        PIC X.
  3388                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3389                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3390                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3391                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3392                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL642.cbl
  3393
  3394             20  CF-CO-EARNINGS-CALC        PIC X.
  3395                 88  CO-EARN-BY-R78             VALUE '1'.
  3396                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3397                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3398                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3399                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3400                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3401                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3402                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3403
  3404             20  CF-CO-REFUND-CALC          PIC X.
  3405                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3406                 88  CO-REFD-BY-R78             VALUE '1'.
  3407                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3408                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3409                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3410                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3411                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3412                 88  CO-REFD-MEAN               VALUE '8'.
  3413                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3414                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3415                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3416
  3417             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3418                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3419                 88  CO-OVRD-BY-R78             VALUE '1'.
  3420                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3421                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3422                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3423                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3424                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3425                 88  CO-OVRD-MEAN               VALUE '8'.
  3426                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3427
  3428             20  CF-CO-BEN-I-G-CD           PIC X.
  3429                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3430                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3431                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3432
  3433         16  FILLER                         PIC X(304).
  3434
  3435
  3436****************************************************************
  3437*             CARRIER MASTER RECORD                            *
  3438****************************************************************
  3439
  3440     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3441         16  CF-ADDRESS-DATA.
  3442             20  CF-MAIL-TO-NAME            PIC X(30).
  3443             20  CF-IN-CARE-OF              PIC X(30).
  3444             20  CF-ADDRESS-LINE-1          PIC X(30).
  3445             20  CF-ADDRESS-LINE-2          PIC X(30).
  3446             20  CF-CITY-STATE              PIC X(30).
  3447             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3448             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3449
  3450         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL642.cbl
  3451             20  CF-CLAIM-NO-METHOD         PIC X.
  3452                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3453                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3454                 88  CLAIM-NO-SEQ               VALUE '3'.
  3455                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3456             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3457                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3458                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3459                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3460
  3461         16  CF-CHECK-NO-CONTROL.
  3462             20  CF-CHECK-NO-METHOD         PIC X.
  3463                 88  CHECK-NO-MANUAL            VALUE '1'.
  3464                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3465                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3466                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3467             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3468                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3469
  3470         16  CF-DOMICILE-STATE              PIC XX.
  3471
  3472         16  CF-EXPENSE-CONTROLS.
  3473             20  CF-EXPENSE-METHOD          PIC X.
  3474                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3475                 88  DOLLARS-PER-PMT            VALUE '2'.
  3476                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3477                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3478             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3479             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3480
  3481         16  CF-CORRESPONDENCE-CONTROL.
  3482             20  CF-LETTER-RESEND-OPT       PIC X.
  3483                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3484                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3485             20  FILLER                     PIC X(4).
  3486
  3487         16  CF-RESERVE-CONTROLS.
  3488             20  CF-MANUAL-SW               PIC X.
  3489                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3490             20  CF-FUTURE-SW               PIC X.
  3491                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3492             20  CF-PTC-SW                  PIC X.
  3493                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3494             20  CF-IBNR-SW                 PIC X.
  3495                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3496             20  CF-PTC-LF-SW               PIC X.
  3497                 88  CF-LF-PTC-USED             VALUE '1'.
  3498             20  CF-CDT-ACCESS-METHOD       PIC X.
  3499                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3500                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3501                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3502             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3503
  3504         16  CF-CLAIM-CALC-METHOD           PIC X.
  3505             88  360-PLUS-MONTHS                VALUE '1'.
  3506             88  365-PLUS-MONTHS                VALUE '2'.
  3507             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3508             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL642.cbl
  3509             88  365-DAILY                      VALUE '5'.
  3510
  3511         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3512         16  FILLER                         PIC X(11).
  3513
  3514         16  CF-LIMIT-AMOUNTS.
  3515             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3516             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3517             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3518             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3519             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3520             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3521             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3522             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3523             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3524             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3525
  3526         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3527         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3528         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3529
  3530         16  CF-ZIP-CODE.
  3531             20  CF-ZIP-PRIME.
  3532                 24  CF-ZIP-1ST             PIC X.
  3533                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3534                 24  FILLER                 PIC X(4).
  3535             20  CF-ZIP-PLUS4               PIC X(4).
  3536         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3537             20  CF-CAN-POSTAL-1            PIC XXX.
  3538             20  CF-CAN-POSTAL-2            PIC XXX.
  3539             20  FILLER                     PIC XXX.
  3540
  3541         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3542         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3543         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3544
  3545         16  CF-RATING-SWITCH               PIC X.
  3546             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3547             88  CF-NO-RATING                   VALUE 'N'.
  3548
  3549         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3550
  3551         16  CF-CARRIER-OVER-SHORT.
  3552             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3553             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3554
  3555         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3556         16  CF-SECPAY-SWITCH               PIC X.
  3557             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3558             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3559         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3560         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3561         16  FILLER                         PIC X(444).
  3562*        16  FILLER                         PIC X(452).
  3563
  3564
  3565****************************************************************
  3566*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL642.cbl
  3567****************************************************************
  3568
  3569     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3570         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3571                                INDEXED BY CF-MORT-NDX.
  3572             20  CF-MORT-TABLE              PIC X(5).
  3573             20  CF-MORT-TABLE-TYPE         PIC X.
  3574                 88  CF-MORT-JOINT              VALUE 'J'.
  3575                 88  CF-MORT-SINGLE             VALUE 'S'.
  3576                 88  CF-MORT-COMBINED           VALUE 'C'.
  3577                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3578                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3579             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3580             20  CF-MORT-AGE-METHOD         PIC XX.
  3581                 88  CF-AGE-LAST                VALUE 'AL'.
  3582                 88  CF-AGE-NEAR                VALUE 'AN'.
  3583             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3584             20  CF-MORT-ADJUSTMENT-DIRECTION
  3585                                            PIC X.
  3586                 88  CF-MINUS                   VALUE '-'.
  3587                 88  CF-PLUS                    VALUE '+'.
  3588             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3589             20  CF-MORT-JOINT-CODE         PIC X.
  3590                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3591             20  CF-MORT-PC-Q               PIC X.
  3592                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3593             20  CF-MORT-TABLE-CODE         PIC X(4).
  3594             20  CF-MORT-COMMENTS           PIC X(15).
  3595             20  FILLER                     PIC X(14).
  3596
  3597         16  FILLER                         PIC X(251).
  3598
  3599
  3600****************************************************************
  3601*             BUSSINESS TYPE MASTER RECORD                     *
  3602****************************************************************
  3603
  3604     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3605* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3606* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3607* AND RECORD 05 IS TYPES 81-99
  3608         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3609             20  CF-BUSINESS-TITLE          PIC  X(19).
  3610             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3611                                            PIC S9V9(4) COMP-3.
  3612             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3613             20  FILLER                     PIC  X.
  3614         16  FILLER                         PIC  X(248).
  3615
  3616
  3617****************************************************************
  3618*             TERMINAL MASTER RECORD                           *
  3619****************************************************************
  3620
  3621     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3622
  3623         16  CF-COMPANY-TERMINALS.
  3624             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL642.cbl
  3625                                  PIC X(4).
  3626         16  FILLER               PIC X(248).
  3627
  3628
  3629****************************************************************
  3630*             LIFE EDIT MASTER RECORD                          *
  3631****************************************************************
  3632
  3633     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3634         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3635             20  CF-LIFE-CODE-IN            PIC XX.
  3636             20  CF-LIFE-CODE-OUT           PIC XX.
  3637         16  FILLER                         PIC X(248).
  3638
  3639
  3640****************************************************************
  3641*             AH EDIT MASTER RECORD                            *
  3642****************************************************************
  3643
  3644     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3645         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3646             20  CF-AH-CODE-IN              PIC XXX.
  3647             20  CF-AH-CODE-OUT             PIC XX.
  3648         16  FILLER                         PIC X(248).
  3649
  3650
  3651****************************************************************
  3652*             CREDIBILITY TABLES                               *
  3653****************************************************************
  3654
  3655     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3656         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3657                             INDEXED BY CF-CRDB-NDX.
  3658             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3659             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3660             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3661         16  FILLER                         PIC  X(332).
  3662
  3663
  3664****************************************************************
  3665*             REPORT CUSTOMIZATION RECORD                      *
  3666****************************************************************
  3667
  3668     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3669         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3670             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3671             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3672             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3673**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3674****       A T-TRANSFER.                                   ****
  3675             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3676
  3677         16  FILLER                         PIC XX.
  3678
  3679         16  CF-CARRIER-CNTL-OPT.
  3680             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3681                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3682                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL642.cbl
  3683             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3684                                            PIC X.
  3685         16  CF-GROUP-CNTL-OPT.
  3686             20  CF-GROUP-OPT-SEQ           PIC 9.
  3687                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3688                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3689             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3690                                            PIC X(6).
  3691         16  CF-STATE-CNTL-OPT.
  3692             20  CF-STATE-OPT-SEQ           PIC 9.
  3693                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3694                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3695             20  CF-STATE-SELECT OCCURS 3 TIMES
  3696                                            PIC XX.
  3697         16  CF-ACCOUNT-CNTL-OPT.
  3698             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3699                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3700                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3701             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3702                                            PIC X(10).
  3703         16  CF-BUS-TYP-CNTL-OPT.
  3704             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3705                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3706                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3707             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3708                                            PIC XX.
  3709         16  CF-LF-TYP-CNTL-OPT.
  3710             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3711                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3712                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3713             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3714                                            PIC XX.
  3715         16  CF-AH-TYP-CNTL-OPT.
  3716             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3717                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3718                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3719             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3720                                            PIC XX.
  3721         16  CF-REPTCD1-CNTL-OPT.
  3722             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3723                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3724                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3725             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3726                                            PIC X(10).
  3727         16  CF-REPTCD2-CNTL-OPT.
  3728             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3729                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3730                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3731             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3732                                            PIC X(10).
  3733         16  CF-USER1-CNTL-OPT.
  3734             20  CF-USER1-OPT-SEQ           PIC 9.
  3735                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3736                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3737             20  CF-USER1-SELECT OCCURS 3 TIMES
  3738                                            PIC X(10).
  3739         16  CF-USER2-CNTL-OPT.
  3740             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL642.cbl
  3741                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3742                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3743             20  CF-USER2-SELECT OCCURS 3 TIMES
  3744                                            PIC X(10).
  3745         16  CF-USER3-CNTL-OPT.
  3746             20  CF-USER3-OPT-SEQ           PIC 9.
  3747                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3748                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3749             20  CF-USER3-SELECT OCCURS 3 TIMES
  3750                                            PIC X(10).
  3751         16  CF-USER4-CNTL-OPT.
  3752             20  CF-USER4-OPT-SEQ           PIC 9.
  3753                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3754                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3755             20  CF-USER4-SELECT OCCURS 3 TIMES
  3756                                            PIC X(10).
  3757         16  CF-USER5-CNTL-OPT.
  3758             20  CF-USER5-OPT-SEQ           PIC 9.
  3759                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3760                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3761             20  CF-USER5-SELECT OCCURS 3 TIMES
  3762                                            PIC X(10).
  3763         16  CF-REINS-CNTL-OPT.
  3764             20  CF-REINS-OPT-SEQ           PIC 9.
  3765                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3766                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3767             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3768                 24  CF-REINS-PRIME         PIC XXX.
  3769                 24  CF-REINS-SUB           PIC XXX.
  3770
  3771         16  CF-AGENT-CNTL-OPT.
  3772             20  CF-AGENT-OPT-SEQ           PIC 9.
  3773                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3774                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3775             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3776                                            PIC X(10).
  3777
  3778         16  FILLER                         PIC X(43).
  3779
  3780         16  CF-LOSS-RATIO-SELECT.
  3781             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3782             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3783         16  CF-ENTRY-DATE-SELECT.
  3784             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3785             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3786         16  CF-EFFECTIVE-DATE-SELECT.
  3787             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3788             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3789
  3790         16  CF-EXCEPTION-LIST-IND          PIC X.
  3791             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3792
  3793         16  FILLER                         PIC X(318).
  3794
  3795****************************************************************
  3796*                  EXCEPTION REPORTING RECORD                  *
  3797****************************************************************
  3798
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL642.cbl
  3799     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3800         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3801             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3802
  3803         16  CF-COMBINED-LIFE-AH-OPT.
  3804             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3805             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3806             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3807             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3808
  3809         16  CF-LIFE-OPT.
  3810             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3811             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3812             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3813             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3814             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3815             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3816             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3817             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3818             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3819             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3820
  3821         16  CF-AH-OPT.
  3822             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3823             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3824             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3825             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3826             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3827             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3828             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3829             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3830             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3831             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3832
  3833         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3834             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3835             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3836             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3837
  3838         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3839
  3840         16  FILLER                         PIC X(673).
  3841
  3842
  3843****************************************************************
  3844*             MORTGAGE SYSTEM PLAN RECORD                      *
  3845****************************************************************
  3846
  3847     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3848         16  CF-PLAN-TYPE                   PIC X.
  3849             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3850             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3851             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3852         16  CF-PLAN-ABBREV                 PIC XXX.
  3853         16  CF-PLAN-DESCRIPT               PIC X(10).
  3854         16  CF-PLAN-NOTES                  PIC X(20).
  3855         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3856         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL642.cbl
  3857             20  CF-PLAN-TERM-DATA.
  3858                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3859                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3860             20  CF-PLAN-AGE-DATA.
  3861                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3862                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3863                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3864             20  CF-PLAN-BENEFIT-DATA.
  3865                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3866                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3867                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3868                                            PIC S9(7)V99  COMP-3.
  3869         16  CF-PLAN-POLICY-FORMS.
  3870             20  CF-POLICY-FORM             PIC X(12).
  3871             20  CF-MASTER-APPLICATION      PIC X(12).
  3872             20  CF-MASTER-POLICY           PIC X(12).
  3873         16  CF-PLAN-RATING.
  3874             20  CF-RATE-CODE               PIC X(5).
  3875             20  CF-SEX-RATING              PIC X.
  3876                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3877                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3878             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3879             20  CF-SUB-STD-TYPE            PIC X.
  3880                 88  CF-PCT-OF-PREM            VALUE '1'.
  3881                 88  CF-PCT-OF-BENE            VALUE '2'.
  3882         16  CF-PLAN-PREM-TOLERANCES.
  3883             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3884             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3885         16  CF-PLAN-PYMT-TOLERANCES.
  3886             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3887             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3888         16  CF-PLAN-MISC-DATA.
  3889             20  FILLER                     PIC X.
  3890             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3891             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3892         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3893         16  CF-PLAN-IND-GRP                PIC X.
  3894             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3895                                                     '1'.
  3896             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3897                                                     '2'.
  3898         16  CF-MIB-SEARCH-SW               PIC X.
  3899             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3900             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3901             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3902             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3903         16  CF-ALPHA-SEARCH-SW             PIC X.
  3904             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3905             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3906             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3907             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3908             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3909             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3910             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3911             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3912             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3913             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3914                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL642.cbl
  3915                                                     'X' 'Y' 'Z'.
  3916         16  CF-EFF-DT-RULE-SW              PIC X.
  3917             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3918             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3919             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3920             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3921             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3922         16  FILLER                         PIC X(4).
  3923         16  CF-HEALTH-QUESTIONS            PIC X.
  3924             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3925         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3926         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3927         16  CF-PLAN-SNGL-JNT               PIC X.
  3928             88  CF-COMBINED-PLAN              VALUE 'C'.
  3929             88  CF-JNT-PLAN                   VALUE 'J'.
  3930             88  CF-SNGL-PLAN                  VALUE 'S'.
  3931         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3932         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3933         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3934         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3935         16  CF-RERATE-CNTL                 PIC  X.
  3936             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3937             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3938             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3939             88  CF-AUTO-RECALC                 VALUE '4'.
  3940         16  CF-BENEFIT-TYPE                PIC  X.
  3941             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3942             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3943         16  CF-POLICY-FEE                  PIC S999V99
  3944                                                    COMP-3.
  3945         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3946         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3947         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3948         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3949         16  FILLER                         PIC  X(32).
  3950         16  CF-TERMINATION-FORM            PIC  X(04).
  3951         16  FILLER                         PIC  X(08).
  3952         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3953                                                       COMP-3.
  3954         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3955         16  CF-ISSUE-LETTER                PIC  X(4).
  3956         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3957         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3958             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3959             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3960         16  CF-MP-REFUND-CALC              PIC X.
  3961             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3962             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3963             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3964             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3965             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3966             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3967             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3968             88  CF-MP-REFD-MEAN                VALUE '8'.
  3969         16  CF-ALT-RATE-CODE               PIC  X(5).
  3970
  3971
  3972         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL642.cbl
  3973****************************************************************
  3974*             MORTGAGE COMPANY MASTER RECORD                   *
  3975****************************************************************
  3976
  3977     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3978         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3979         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3980             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3981             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3982             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3983             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3984             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3985
  3986         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3987         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3988         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3989         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3990         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3991
  3992         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3993             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3994         16  CF-MP-RECON-USE-IND            PIC X(1).
  3995             88  CF-MP-USE-RECON             VALUE 'Y'.
  3996         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3997             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3998         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3999             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4000             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4001         16  FILLER                         PIC X(1).
  4002         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4003             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4004         16  CF-MORTG-MIB-VERSION           PIC X.
  4005             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4006             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4007             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4008         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4009             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4010                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4011             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4012                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4013             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4014                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4015             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4016                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4017             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4018                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4019             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4020                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4021         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4022         16  FILLER                         PIC X(7).
  4023         16  CF-MORTG-DESTINATION-SYMBOL.
  4024             20  CF-MORTG-MIB-COMM          PIC X(5).
  4025             20  CF-MORTG-MIB-TERM          PIC X(5).
  4026         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4027             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4028         16  FILLER                         PIC X(03).
  4029         16  CF-MP-CHECK-NO-CONTROL.
  4030             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL642.cbl
  4031                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4032                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4033                                                ' ' LOW-VALUES.
  4034                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4035                                               VALUE '3'.
  4036         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4037         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4038         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4039             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4040                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4041             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4042                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4043             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4044                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4045             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4046                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4047             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4048                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4049             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4050                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4051         16  CF-MORTG-BILLING-AREA.
  4052             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4053                                            PIC X.
  4054         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4055         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4056         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4057         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4058             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4059             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4060         16  FILLER                         PIC X.
  4061         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4062             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4063             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4064         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4065         16  FILLER                         PIC X(8).
  4066         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4067         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4068         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4069         16  CF-ACH-COMPANY-ID.
  4070             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4071                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4072                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4073                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4074             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4075         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4076             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4077         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4078             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4079             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4080         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4081         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4082         16  FILLER                         PIC X(536).
  4083
  4084****************************************************************
  4085*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4086****************************************************************
  4087
  4088     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL642.cbl
  4089         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4090             20  CF-FEMALE-HEIGHT.
  4091                 24  CF-FEMALE-FT           PIC 99.
  4092                 24  CF-FEMALE-IN           PIC 99.
  4093             20  CF-FEMALE-MIN-WT           PIC 999.
  4094             20  CF-FEMALE-MAX-WT           PIC 999.
  4095         16  FILLER                         PIC X(428).
  4096
  4097     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4098         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4099             20  CF-MALE-HEIGHT.
  4100                 24  CF-MALE-FT             PIC 99.
  4101                 24  CF-MALE-IN             PIC 99.
  4102             20  CF-MALE-MIN-WT             PIC 999.
  4103             20  CF-MALE-MAX-WT             PIC 999.
  4104         16  FILLER                         PIC X(428).
  4105******************************************************************
  4106*             AUTOMATIC ACTIVITY RECORD                          *
  4107******************************************************************
  4108     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4109         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4110             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4111             20  CF-SYS-LETTER-ID           PIC X(04).
  4112             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4113             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4114             20  CF-SYS-RESET-SW            PIC X(01).
  4115             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4116             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4117
  4118         16  FILLER                         PIC X(50).
  4119
  4120         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4121             20  CF-USER-ACTIVE-SW          PIC X(01).
  4122             20  CF-USER-LETTER-ID          PIC X(04).
  4123             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4124             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4125             20  CF-USER-RESET-SW           PIC X(01).
  4126             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4127             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4128             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4129
  4130         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL642.cbl
  4132*                            COPY ERCCOMP.
  4133******************************************************************
  4134*                                                                *
  4135*                                                                *
  4136*                            ERCCOMP                             *
  4137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4138*                            VMOD=2.019                          *
  4139*                                                                *
  4140*   ONLINE CREDIT SYSTEM                                         *
  4141*                                                                *
  4142*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4143*                                                                *
  4144*   FILE TYPE = VSAM,KSDS                                        *
  4145*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4146*                                                                *
  4147*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4148*       ALTERNATE PATH = NONE                                    *
  4149*                                                                *
  4150*   LOG = NO                                                     *
  4151*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4152*                                                                *
  4153******************************************************************
  4154*                   C H A N G E   L O G
  4155*
  4156* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4157*-----------------------------------------------------------------
  4158*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4159* EFFECTIVE    NUMBER
  4160*-----------------------------------------------------------------
  4161* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4162* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4163* 092205    2005050300006  PEMA  ADD LEASE FEE
  4164* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4165* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4166* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4167* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4168* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4169* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4170******************************************************************
  4171
  4172 01  COMPENSATION-MASTER.
  4173     12  CO-RECORD-ID                          PIC XX.
  4174         88  VALID-CO-ID                          VALUE 'CO'.
  4175
  4176     12  CO-CONTROL-PRIMARY.
  4177         16  CO-COMPANY-CD                     PIC X.
  4178         16  CO-CONTROL.
  4179             20  CO-CTL-1.
  4180                 24  CO-CARR-GROUP.
  4181                     28  CO-CARRIER            PIC X.
  4182                     28  CO-GROUPING.
  4183                         32  CO-GROUP-PREFIX   PIC XXX.
  4184                         32  CO-GROUP-PRIME    PIC XXX.
  4185                 24  CO-RESP-NO.
  4186                     28  CO-RESP-PREFIX        PIC X(4).
  4187                     28  CO-RESP-PRIME         PIC X(6).
  4188             20  CO-CTL-2.
  4189                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL642.cbl
  4190                     28  CO-ACCT-PREFIX        PIC X(4).
  4191                     28  CO-ACCT-PRIME         PIC X(6).
  4192         16  CO-TYPE                           PIC X.
  4193             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4194             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4195             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4196
  4197     12  CO-MAINT-INFORMATION.
  4198         16  CO-LAST-MAINT-DT                  PIC XX.
  4199         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4200         16  CO-LAST-MAINT-USER                PIC X(4).
  4201     12  FILLER                                PIC XX.
  4202     12  CO-STMT-TYPE                          PIC XXX.
  4203     12  CO-COMP-TYPE                          PIC X.
  4204         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4205     12  CO-STMT-OWNER                         PIC X(4).
  4206     12  CO-BALANCE-CONTROL                    PIC X.
  4207         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4208         88  CO-NO-BALANCE                        VALUE 'N'.
  4209
  4210     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4211         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4212         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4213         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4214
  4215     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4216         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4217         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4218
  4219     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4220     12  CO-GA-DIRECT-DEP                      PIC X.
  4221     12  CO-FUTURE-SPACE                       PIC X.
  4222         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4223
  4224     12  CO-ACCT-NAME                          PIC X(30).
  4225     12  CO-MAIL-NAME                          PIC X(30).
  4226     12  CO-ADDR-1                             PIC X(30).
  4227     12  CO-ADDR-2                             PIC X(30).
  4228     12  CO-ADDR-3.
  4229         16  CO-ADDR-CITY                      PIC X(27).
  4230         16  CO-ADDR-STATE                     PIC XX.
  4231     12  CO-CSO-1099                           PIC X.
  4232     12  CO-ZIP.
  4233         16  CO-ZIP-PRIME.
  4234             20  CO-ZIP-PRI-1ST                PIC X.
  4235                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4236             20  FILLER                        PIC X(4).
  4237         16  CO-ZIP-PLUS4                      PIC X(4).
  4238     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4239         16  CO-CAN-POSTAL-1                   PIC XXX.
  4240         16  CO-CAN-POSTAL-2                   PIC XXX.
  4241         16  FILLER                            PIC XXX.
  4242     12  CO-SOC-SEC                            PIC X(13).
  4243     12  CO-TELEPHONE.
  4244         16  CO-AREA-CODE                      PIC XXX.
  4245         16  CO-PREFIX                         PIC XXX.
  4246         16  CO-PHONE                          PIC X(4).
  4247
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL642.cbl
  4248     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4249
  4250     12  CO-AR-BAL-LEVEL                       PIC X.
  4251         88  CO-AR-REF-LVL                        VALUE '1'.
  4252         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4253         88  CO-AR-BILL-LVL                       VALUE '2'.
  4254         88  CO-AR-AGT-LVL                        VALUE '3'.
  4255         88  CO-AR-FR-LVL                         VALUE '4'.
  4256
  4257     12  CO-AR-NORMAL-PRINT                    PIC X.
  4258         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4259         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4260
  4261     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4262
  4263     12  CO-AR-REPORTING                       PIC X.
  4264         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4265         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4266
  4267     12  CO-AR-PULL-CHECK                      PIC X.
  4268         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4269         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4270
  4271     12  CO-AR-BALANCE-PRINT                   PIC X.
  4272         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4273
  4274     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4275         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4276         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4277         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4278
  4279     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4280
  4281     12  CO-USER-CODE                          PIC X.
  4282     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4283
  4284******************************************************************
  4285*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4286*    THE LAST MONTH END RUN.
  4287******************************************************************
  4288
  4289     12  CO-LAST-ACTIVITY-DATE.
  4290         16  CO-ACT-YEAR                       PIC 99.
  4291         16  CO-ACT-MONTH                      PIC 99.
  4292         16  CO-ACT-DAY                        PIC 99.
  4293
  4294     12  CO-LAST-STMT-DT.
  4295         16  CO-LAST-STMT-YEAR                 PIC 99.
  4296         16  CO-LAST-STMT-MONTH                PIC 99.
  4297         16  CO-LAST-STMT-DAY                  PIC 99.
  4298
  4299     12  CO-MO-END-TOTALS.
  4300         16  CO-MONTHLY-TOTALS.
  4301             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4302             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4303             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4304             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4305             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL642.cbl
  4306
  4307         16  CO-AGING-TOTALS.
  4308             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4309             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4310             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4311             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4312
  4313         16  CO-YTD-TOTALS.
  4314             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4315             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4316
  4317         16  CO-OVER-UNDER-TOTALS.
  4318             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4319             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4320
  4321     12  CO-MISCELLANEOUS-TOTALS.
  4322         16  CO-FICA-TOTALS.
  4323             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4324             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4325
  4326         16  CO-CLAIM-TOTALS.
  4327             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4328             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4329
  4330******************************************************************
  4331*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4332*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4333******************************************************************
  4334
  4335     12  CO-CURRENT-TOTALS.
  4336         16  CO-CURRENT-LAST-STMT-DT.
  4337             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4338             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4339             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4340
  4341         16  CO-CURRENT-MONTHLY-TOTALS.
  4342             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4343             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4344             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4345             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4346             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4347
  4348         16  CO-CURRENT-AGING-TOTALS.
  4349             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4350             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4351             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4352             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4353
  4354         16  CO-CURRENT-YTD-TOTALS.
  4355             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4356             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4357
  4358     12  CO-PAID-COMM-TOTALS.
  4359         16  CO-YTD-PAID-COMMS.
  4360             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4361             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4362
  4363     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL642.cbl
  4364         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4365         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4366
  4367     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4368         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4369         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4370         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4371         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4372         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4373         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4374         88  CO-FINAL-LETTER                  VALUE 'F'.
  4375         88  CO-RECONCILING                   VALUE 'R'.
  4376         88  CO-PHONE-CALL                    VALUE 'P'.
  4377         88  CO-LEGAL                         VALUE 'L'.
  4378         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4379         88  CO-WRITE-OFF                     VALUE 'W'.
  4380         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4381
  4382     12  CO-CSR-CODE                       PIC X(4).
  4383
  4384     12  CO-GA-STATUS-INFO.
  4385         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4386         16  CO-GA-TERMINATION-DT          PIC XX.
  4387         16  CO-GA-STATUS-CODE             PIC X.
  4388             88  CO-GA-ACTIVE                 VALUE 'A'.
  4389             88  CO-GA-INACTIVE               VALUE 'I'.
  4390             88  CO-GA-PENDING                VALUE 'P'.
  4391         16  CO-GA-COMMENTS.
  4392             20  CO-GA-COMMENT-1           PIC X(40).
  4393             20  CO-GA-COMMENT-2           PIC X(40).
  4394             20  CO-GA-COMMENT-3           PIC X(40).
  4395             20  CO-GA-COMMENT-4           PIC X(40).
  4396
  4397     12  CO-RPTCD2                         PIC X(10).
  4398     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4399         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4400         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4401
  4402     12  CO-TYPE-AGENT                     PIC X(01).
  4403         88  CO-CORPORATION                   VALUE 'C'.
  4404         88  CO-PARTNERSHIP                   VALUE 'P'.
  4405         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4406         88  CO-TRUST                         VALUE 'T'.
  4407         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4408
  4409     12  CO-FAXNO.
  4410         16  CO-FAX-AREA-CODE                  PIC XXX.
  4411         16  CO-FAX-PREFIX                     PIC XXX.
  4412         16  CO-FAX-PHONE                      PIC X(4).
  4413
  4414     12  CO-BANK-INFORMATION.
  4415         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4416         16  CO-BANK-TRANSIT-NON REDEFINES
  4417             CO-BANK-TRANSIT-NO                PIC 9(8).
  4418
  4419         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4420     12  CO-MISC-DEDUCT-INFO REDEFINES
  4421                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL642.cbl
  4422         16  CO-MD-GL-ACCT                     PIC X(10).
  4423         16  CO-MD-DIV                         PIC XX.
  4424         16  CO-MD-CENTER                      PIC X(4).
  4425         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4426         16  CO-CREATE-AP-CHECK                PIC X.
  4427         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4428         16  FILLER                            PIC XXX.
  4429     12  CO-ACH-STATUS                         PIC X.
  4430         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4431         88  CO-ACH-PENDING                        VALUE 'P'.
  4432
  4433     12  CO-BILL-SW                            PIC X.
  4434     12  CO-CONTROL-NAME                       PIC X(30).
  4435     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4436     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4437     12  CO-CLP-STATE                          PIC XX.
  4438     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4439     12  CO-SPP-REFUND-EDIT                    PIC X.
  4440
  4441******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL642.cbl
  4443*                            COPY ERCPYAJ.
  4444******************************************************************
  4445*                                                                *
  4446*                            ERCPYAJ                             *
  4447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4448*                            VMOD=2.015                          *
  4449*                                                                *
  4450*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4451*                                                                *
  4452*                                                                *
  4453*   FILE TYPE = VSAM,KSDS                                        *
  4454*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4455*                                                                *
  4456*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4457*       ALTERNATE PATHS = NONE                                   *
  4458*                                                                *
  4459*   LOG = YES                                                    *
  4460*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4461******************************************************************
  4462******************************************************************
  4463*                   C H A N G E   L O G
  4464*
  4465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4466*-----------------------------------------------------------------
  4467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4468* EFFECTIVE    NUMBER
  4469*-----------------------------------------------------------------
  4470* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4471* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4472******************************************************************
  4473
  4474 01  PENDING-PAY-ADJ.
  4475     12  PY-RECORD-ID                     PIC XX.
  4476         88  VALID-PY-ID                        VALUE 'PY'.
  4477
  4478     12  PY-CONTROL-PRIMARY.
  4479         16  PY-COMPANY-CD                PIC X.
  4480         16  PY-CARRIER                   PIC X.
  4481         16  PY-GROUPING                  PIC X(6).
  4482         16  PY-FIN-RESP                  PIC X(10).
  4483         16  PY-ACCOUNT                   PIC X(10).
  4484         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4485                                          PIC X(10).
  4486         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4487         16  PY-RECORD-TYPE               PIC X.
  4488             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4489             88  PY-DEPOSIT                   VALUE 'D'.
  4490             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4491             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4492             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4493             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4494             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4495             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4496             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4497             88  PY-FICA-ENTRY                VALUE 'F'.
  4498             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4499             88  PY-POLICY-FEE                VALUE 'W'.
  4500             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL642.cbl
  4501
  4502     12  PY-PYMT-TYPE                     PIC X.
  4503             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4504             88  PY-REINS-PYMT                VALUE 'R'.
  4505             88  PY-EXP-PYMT                  VALUE 'E'.
  4506
  4507     12  PY-BIL-INV                       PIC X(6).
  4508     12  PY-REF-NO                        PIC X(12).
  4509
  4510     12  PY-LAST-MAINT-DT                 PIC XX.
  4511     12  PY-LAST-MAINT-BY                 PIC X(4).
  4512     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4513
  4514     12  PY-PYADJ-RECORD.
  4515         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4516         16  PY-ENTRY-COMMENT             PIC X(30).
  4517         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4518             20  PY-GL-ACCOUNT            PIC X(10).
  4519             20  PY-GL-STATE              PIC X(02).
  4520             20  PY-GL-CANC-SW            PIC X(01).
  4521                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4522                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4523             20  PY-GL-COMMENT            PIC X(10).
  4524             20  FILLER      REDEFINES PY-GL-COMMENT.
  4525                 24  PY-GL-CHECK-NO       PIC 9(06).
  4526                 24  FILLER               PIC X(04).
  4527             20  FILLER                   PIC X(07).
  4528         16  PY-SAVE-ACCOUNT              PIC X(10).
  4529         16  PY-SAVE-TYPE                 PIC X(01).
  4530
  4531         16  PY-LETTERS.
  4532             20  PY-LETTER OCCURS 3 TIMES
  4533                           INDEXED BY PY-LET-NDX
  4534                                          PIC X(04).
  4535
  4536         16  PY-ERCOMP-TYPE               PIC X.
  4537             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4538             88  PY-GA-TYPE                   VALUE 'G'.
  4539             88  PY-BANK-TYPE                 VALUE 'B'.
  4540         16  FILLER                       PIC X(05).
  4541
  4542     12  PY-RECORD-STATUS.
  4543         16  PY-CREDIT-SELECT-DT          PIC XX.
  4544         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4545         16  PY-BILLED-DATE               PIC XX.
  4546         16  PY-REPORTED-DT               PIC XX.
  4547         16  PY-PMT-APPLIED               PIC X.
  4548             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4549             88  PY-GA-PMT                    VALUE 'G'.
  4550             88  PY-OVWRITE-PMT               VALUE 'O'.
  4551             88  PY-NON-AR-PMT                VALUE 'N'.
  4552         16  FILLER                       PIC X(5).
  4553         16  PY-INPUT-DT                  PIC XX.
  4554         16  PY-CHECK-NUMBER              PIC X(6).
  4555         16  PY-VOID-SW                   PIC X.
  4556             88  PY-CHECK-VOIDED              VALUE 'V'.
  4557         16  PY-CHECK-ORIGIN-SW           PIC X.
  4558             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL642.cbl
  4559             88  PY-REFUND-CHECK              VALUE 'R'.
  4560             88  PY-GA-CHECK                  VALUE 'G'.
  4561             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4562             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4563         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4564         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4565         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4566         16  PY-BILL-FLAG                 PIC X.
  4567             88  PY-BILLED                    VALUE 'B'.
  4568         16  PY-AR-FLAG                   PIC X.
  4569             88  PY-AR-CYCLE                  VALUE 'C'.
  4570             88  PY-AR-MONTH-END              VALUE 'M'.
  4571         16  PY-AR-DATE                   PIC XX.
  4572
  4573     12  PY-GL-CODES.
  4574         16  PY-GL-DB                     PIC X(14).
  4575         16  PY-GL-CR                     PIC X(14).
  4576         16  PY-GL-FLAG                   PIC X.
  4577         16  PY-GL-DATE                   PIC XX.
  4578
  4579     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4580     12  FILLER                           PIC X(3).
  4581******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL642.cbl
  4583*                            COPY ERCACCT.
  4584******************************************************************
  4585*                                                                *
  4586*                                                                *
  4587*                            ERCACCT                             *
  4588*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4589*                            VMOD=2.031                          *
  4590*                                                                *
  4591*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4592*                                                                *
  4593*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4594*   VSAM ACCOUNT MASTER FILES.                                   *
  4595*                                                                *
  4596*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4597*                                                                *
  4598*   FILE TYPE = VSAM,KSDS                                        *
  4599*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4600*                                                                *
  4601*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4602*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4603*                                                                *
  4604*   LOG = NO                                                     *
  4605*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4606*                                                                *
  4607*                                                                *
  4608******************************************************************
  4609*                   C H A N G E   L O G
  4610*
  4611* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4612*-----------------------------------------------------------------
  4613*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4614* EFFECTIVE    NUMBER
  4615*-----------------------------------------------------------------
  4616* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4617* 092705    2005050300006  PEMA  ADD SPP LEASES
  4618* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4619* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4620* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4621* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4622* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4623******************************************************************
  4624
  4625 01  ACCOUNT-MASTER.
  4626     12  AM-RECORD-ID                      PIC XX.
  4627         88  VALID-AM-ID                      VALUE 'AM'.
  4628
  4629     12  AM-CONTROL-PRIMARY.
  4630         16  AM-COMPANY-CD                 PIC X.
  4631         16  AM-MSTR-CNTRL.
  4632             20  AM-CONTROL-A.
  4633                 24  AM-CARRIER            PIC X.
  4634                 24  AM-GROUPING.
  4635                     28 AM-GROUPING-PREFIX PIC XXX.
  4636                     28 AM-GROUPING-PRIME  PIC XXX.
  4637                 24  AM-STATE              PIC XX.
  4638                 24  AM-ACCOUNT.
  4639                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4640                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL642.cbl
  4641             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4642                                           PIC X(19).
  4643             20  AM-CNTRL-B.
  4644                 24  AM-EXPIRATION-DT      PIC XX.
  4645                 24  FILLER                PIC X(4).
  4646             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4647                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4648
  4649     12  AM-CONTROL-BY-VAR-GRP.
  4650         16  AM-COMPANY-CD-A1              PIC X.
  4651         16  AM-VG-CARRIER                 PIC X.
  4652         16  AM-VG-GROUPING                PIC X(6).
  4653         16  AM-VG-STATE                   PIC XX.
  4654         16  AM-VG-ACCOUNT                 PIC X(10).
  4655         16  AM-VG-DATE.
  4656             20  AM-VG-EXPIRATION-DT       PIC XX.
  4657             20  FILLER                    PIC X(4).
  4658         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4659                                           PIC 9(11)      COMP-3.
  4660     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4661         16  FILLER                        PIC X(10).
  4662         16  AM-VG-KEY3.
  4663             20  AM-VG3-ACCOUNT            PIC X(10).
  4664             20  AM-VG3-EXP-DT             PIC XX.
  4665         16  FILLER                        PIC X(4).
  4666     12  AM-MAINT-INFORMATION.
  4667         16  AM-LAST-MAINT-DT              PIC XX.
  4668         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4669         16  AM-LAST-MAINT-USER            PIC X(4).
  4670         16  FILLER                        PIC XX.
  4671
  4672     12  AM-EFFECTIVE-DT                   PIC XX.
  4673     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4674
  4675     12  AM-PREV-DATES  COMP-3.
  4676         16  AM-PREV-EXP-DT                PIC 9(11).
  4677         16  AM-PREV-EFF-DT                PIC 9(11).
  4678
  4679     12  AM-REPORT-CODE-1                  PIC X(10).
  4680     12  AM-REPORT-CODE-2                  PIC X(10).
  4681
  4682     12  AM-CITY-CODE                      PIC X(4).
  4683     12  AM-COUNTY-PARISH                  PIC X(6).
  4684
  4685     12  AM-NAME                           PIC X(30).
  4686     12  AM-PERSON                         PIC X(30).
  4687     12  AM-ADDRS                          PIC X(30).
  4688     12  AM-CITY.
  4689         16  AM-ADDR-CITY                  PIC X(28).
  4690         16  AM-ADDR-STATE                 PIC XX.
  4691     12  AM-ZIP.
  4692         16  AM-ZIP-PRIME.
  4693             20  AM-ZIP-PRI-1ST            PIC X.
  4694                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4695             20  FILLER                    PIC X(4).
  4696         16  AM-ZIP-PLUS4                  PIC X(4).
  4697     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4698         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL642.cbl
  4699         16  AM-CAN-POSTAL-2               PIC XXX.
  4700         16  FILLER                        PIC XXX.
  4701     12  AM-TEL-NO.
  4702         16  AM-AREA-CODE                  PIC 999.
  4703         16  AM-TEL-PRE                    PIC 999.
  4704         16  AM-TEL-NBR                    PIC 9(4).
  4705     12  AM-TEL-LOC                        PIC X.
  4706         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4707         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4708
  4709     12  AM-COMM-STRUCTURE.
  4710         16  AM-DEFN-1.
  4711             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4712                 24  AM-AGT.
  4713                     28  AM-AGT-PREFIX     PIC X(4).
  4714                     28  AM-AGT-PRIME      PIC X(6).
  4715                 24  AM-COM-TYP            PIC X.
  4716                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4717                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4718                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4719                 24  AM-RECALC-LV-INDIC    PIC X.
  4720                 24  AM-RETRO-LV-INDIC     PIC X.
  4721                 24  AM-GL-CODES           PIC X.
  4722                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4723                 24  FILLER                PIC X(01).
  4724         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4725             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4726                 24  FILLER                PIC X(11).
  4727                 24  AM-L-COMA             PIC XXX.
  4728                 24  AM-J-COMA             PIC XXX.
  4729                 24  AM-A-COMA             PIC XXX.
  4730                 24  FILLER                PIC X(6).
  4731
  4732     12  AM-COMM-CHANGE-STATUS             PIC X.
  4733         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4734
  4735     12  AM-CSR-CODE                       PIC X(4).
  4736
  4737     12  AM-BILLING-STATUS                 PIC X.
  4738         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4739         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4740     12  AM-AUTO-REFUND-SW                 PIC X.
  4741         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4742         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4743     12  AM-GPCD                           PIC 99.
  4744     12  AM-IG                             PIC X.
  4745         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4746         88  AM-HAS-GROUP                     VALUE '2'.
  4747     12  AM-STATUS                         PIC X.
  4748         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4749         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4750         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4751         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4752         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4753         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4754     12  AM-REMIT-TO                       PIC 99.
  4755     12  AM-ID-NO                          PIC X(11).
  4756
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL642.cbl
  4757     12  AM-CAL-TABLE                      PIC XX.
  4758     12  AM-LF-DEVIATION                   PIC XXX.
  4759     12  AM-AH-DEVIATION                   PIC XXX.
  4760     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4761     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4762     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4763     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4764     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4765     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4766
  4767     12  AM-USER-FIELDS.
  4768         16  AM-FLD-1                      PIC XX.
  4769         16  AM-FLD-2                      PIC XX.
  4770         16  AM-FLD-3                      PIC XX.
  4771         16  AM-FLD-4                      PIC XX.
  4772         16  AM-FLD-5                      PIC XX.
  4773
  4774     12  AM-1ST-PROD-DATE.
  4775         16  AM-1ST-PROD-YR                PIC XX.
  4776         16  AM-1ST-PROD-MO                PIC XX.
  4777         16  AM-1ST-PROD-DA                PIC XX.
  4778     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4779     12  AM-CERTS-PURGED-DATE.
  4780         16  AM-PUR-YR                     PIC XX.
  4781         16  AM-PUR-MO                     PIC XX.
  4782         16  AM-PUR-DA                     PIC XX.
  4783     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4784     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4785     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4786     12  AM-INACTIVE-DATE.
  4787         16  AM-INA-MO                     PIC 99.
  4788         16  AM-INA-DA                     PIC 99.
  4789         16  AM-INA-YR                     PIC 99.
  4790     12  AM-AR-HI-CERT-DATE                PIC XX.
  4791
  4792     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4793     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4794
  4795     12  AM-OB-PAYMENT-MODE                PIC X.
  4796         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4797         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4798         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4799         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4800
  4801     12  AM-AH-ONLY-INDICATOR              PIC X.
  4802         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4803         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4804
  4805     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4806
  4807     12  AM-OVER-SHORT.
  4808         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4809         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4810
  4811     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4812     12  AM-DCC-CLP-STATE                  PIC XX.
  4813
  4814     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL642.cbl
  4815     12  AM-RECALC-REIN                    PIC X.
  4816
  4817     12  AM-REI-TABLE                      PIC XXX.
  4818     12  AM-REI-ET-LF                      PIC X.
  4819     12  AM-REI-ET-AH                      PIC X.
  4820     12  AM-REI-PE-LF                      PIC X.
  4821     12  AM-REI-PE-AH                      PIC X.
  4822     12  AM-REI-PRT-ST                     PIC X.
  4823     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4824     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4825     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4826     12  AM-REI-GROUP-A                    PIC X(6).
  4827     12  AM-REI-MORT                       PIC X(4).
  4828     12  AM-REI-PRT-OW                     PIC X.
  4829     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4830     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4831     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4832     12  AM-REI-GROUP-B                    PIC X(6).
  4833
  4834     12  AM-TRUST-TYPE                     PIC X(2).
  4835
  4836     12  AM-EMPLOYER-STMT-USED             PIC X.
  4837     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4838
  4839     12  AM-STD-AH-TYPE                    PIC XX.
  4840     12  AM-EARN-METHODS.
  4841         16  AM-EARN-METHOD-R              PIC X.
  4842             88 AM-REF-RL-R78                 VALUE 'R'.
  4843             88 AM-REF-RL-PR                  VALUE 'P'.
  4844             88 AM-REF-RL-MEAN                VALUE 'M'.
  4845             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4846         16  AM-EARN-METHOD-L              PIC X.
  4847             88 AM-REF-LL-R78                 VALUE 'R'.
  4848             88 AM-REF-LL-PR                  VALUE 'P'.
  4849             88 AM-REF-LL-MEAN                VALUE 'M'.
  4850             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4851         16  AM-EARN-METHOD-A              PIC X.
  4852             88 AM-REF-AH-R78                 VALUE 'R'.
  4853             88 AM-REF-AH-PR                  VALUE 'P'.
  4854             88 AM-REF-AH-MEAN                VALUE 'M'.
  4855             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4856             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4857             88 AM-REF-AH-NET                 VALUE 'N'.
  4858
  4859     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4860     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4861     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4862
  4863     12  AM-RET-Y-N                        PIC X.
  4864     12  AM-RET-P-E                        PIC X.
  4865     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4866     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4867     12  AM-RET-GRP                        PIC X(6).
  4868     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4869         16  AM-POOL-PRIME                 PIC XXX.
  4870         16  AM-POOL-SUB                   PIC XXX.
  4871     12  AM-RETRO-EARNINGS.
  4872         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL642.cbl
  4873         16  AM-RET-EARN-L                 PIC X.
  4874         16  AM-RET-EARN-A                 PIC X.
  4875     12  AM-RET-ST-TAX-USE                 PIC X.
  4876         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4877         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4878     12  AM-RETRO-BEG-EARNINGS.
  4879         16  AM-RET-BEG-EARN-R             PIC X.
  4880         16  AM-RET-BEG-EARN-L             PIC X.
  4881         16  AM-RET-BEG-EARN-A             PIC X.
  4882     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4883     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4884
  4885     12  AM-USER-SELECT-OPTIONS.
  4886         16  AM-USER-SELECT-1              PIC X(10).
  4887         16  AM-USER-SELECT-2              PIC X(10).
  4888         16  AM-USER-SELECT-3              PIC X(10).
  4889         16  AM-USER-SELECT-4              PIC X(10).
  4890         16  AM-USER-SELECT-5              PIC X(10).
  4891
  4892     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4893
  4894     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4895
  4896     12  AM-RPT045A-SWITCH                 PIC X.
  4897         88  RPT045A-OFF                   VALUE 'N'.
  4898
  4899     12  AM-INSURANCE-LIMITS.
  4900         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4901         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4902
  4903     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4904         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4905
  4906     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4907         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4908         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4909
  4910     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4911
  4912     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4913     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4914     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4915     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4916     12  AM-DCC-UEF-STATE                  PIC XX.
  4917     12  FILLER                            PIC XXX.
  4918     12  AM-REPORT-CODE-3                  PIC X(10).
  4919*    12  FILLER                            PIC X(22).
  4920
  4921     12  AM-RESERVE-DATE.
  4922         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4923         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4924         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4925
  4926     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4927     12  AM-NOTIFICATION-TYPES.
  4928         16  AM-NOTIF-OF-LETTERS           PIC X.
  4929         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4930         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL642.cbl
  4931         16  AM-NOTIF-OF-STATUS            PIC X.
  4932
  4933     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4934         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4935         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4936         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4937         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4938
  4939     12  AM-BENEFIT-CONTROLS.
  4940         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4941             20  AM-BENEFIT-CODE           PIC XX.
  4942             20  AM-BENEFIT-TYPE           PIC X.
  4943             20  AM-BENEFIT-REVISION       PIC XXX.
  4944             20  AM-BENEFIT-REM-TERM       PIC X.
  4945             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4946             20  FILLER                    PIC XX.
  4947         16  FILLER                        PIC X(80).
  4948
  4949     12  AM-TRANSFER-DATA.
  4950         16  AM-TRANSFERRED-FROM.
  4951             20  AM-TRNFROM-CARRIER        PIC X.
  4952             20  AM-TRNFROM-GROUPING.
  4953                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4954                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4955             20  AM-TRNFROM-STATE          PIC XX.
  4956             20  AM-TRNFROM-ACCOUNT.
  4957                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4958                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4959             20  AM-TRNFROM-DTE            PIC XX.
  4960         16  AM-TRANSFERRED-TO.
  4961             20  AM-TRNTO-CARRIER          PIC X.
  4962             20  AM-TRNTO-GROUPING.
  4963                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4964                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4965             20  AM-TRNTO-STATE            PIC XX.
  4966             20  AM-TRNTO-ACCOUNT.
  4967                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4968                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4969             20  AM-TRNTO-DTE              PIC XX.
  4970         16  FILLER                        PIC X(10).
  4971
  4972     12  AM-SAVED-REMIT-TO                 PIC 99.
  4973
  4974     12  AM-COMM-STRUCTURE-SAVED.
  4975         16  AM-DEFN-1-SAVED.
  4976             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4977                 24  AM-AGT-SV             PIC X(10).
  4978                 24  AM-COM-TYP-SV         PIC X.
  4979                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4980                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4981                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4982                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4983                 24  FILLER                PIC X.
  4984                 24  AM-GL-CODES-SV        PIC X.
  4985                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4986                 24  FILLER                PIC X.
  4987         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4988             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL642.cbl
  4989                 24  FILLER                PIC X(11).
  4990                 24  AM-L-COMA-SV          PIC XXX.
  4991                 24  AM-J-COMA-SV          PIC XXX.
  4992                 24  AM-A-COMA-SV          PIC XXX.
  4993                 24  FILLER                PIC X(6).
  4994
  4995     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4996         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4997            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4998            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4999            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5000
  5001     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5002     12  FILLER                            PIC X(120).
  5003
  5004     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5005         16  AM-CONTROL-NAME               PIC X(30).
  5006         16  AM-EXECUTIVE-ONE.
  5007             20  AM-EXEC1-NAME             PIC X(15).
  5008             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5009                                                          COMP-3.
  5010             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5011                                                          COMP-3.
  5012         16  AM-EXECUTIVE-TWO.
  5013             20  AM-EXEC2-NAME             PIC X(15).
  5014             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5015                                                          COMP-3.
  5016             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5017                                                          COMP-3.
  5018
  5019     12  AM-RETRO-ADDITIONAL-DATA.
  5020         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5021         16  AM-RETRO-PREM-P-E             PIC X.
  5022         16  AM-RETRO-CLMS-P-I             PIC X.
  5023         16  AM-RETRO-RET-BRACKET-LF.
  5024             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5025                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5026                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5027             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5028                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5029                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5030             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5031                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5032                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5033         16  AM-RETRO-RET-BRACKET-AH.
  5034             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5035                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5036                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5037                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5038             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5039                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5040                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5041             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5042                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5043                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5044
  5045     12  AM-COMMENTS.
  5046         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL642.cbl
  5047
  5048     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5049         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5050         16  AM-FLI-BILLING-CODE           PIC X.
  5051         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5052         16  AM-FLI-UNITED-IDENT           PIC X.
  5053         16  AM-FLI-INTEREST-LOST-DATA.
  5054             20  AM-FLI-BANK-NO            PIC X(5).
  5055             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5056             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5057             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5058         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5059             20  AM-FLI-AGT                PIC X(9).
  5060             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5061             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5062         16  FILLER                        PIC X(102).
  5063
  5064     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5065         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5066             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5067             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5068             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5069             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5070             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5071         16  FILLER                          PIC X(10).
  5072******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL642.cbl
  5074*                            COPY ERCBILL.
  5075******************************************************************
  5076*                                                                *
  5077*                                                                *
  5078*                            ERCBILL                             *
  5079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5080*                            VMOD=2.007                          *
  5081*                                                                *
  5082*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5083*                                                                *
  5084*   FILE TYPE = VSAM,KSDS                                        *
  5085*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5086*                                                                *
  5087*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5088*                                                                *
  5089*   LOG = NO                                                     *
  5090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5091******************************************************************
  5092 01  BILLING-STATEMENT.
  5093     02 BILLING-STATEMENT-FILE.
  5094     12  BI-RECORD-ID                PIC XX.
  5095         88  VALID-BI-ID                VALUE 'BI'.
  5096
  5097     12  BI-CONTROL-PRIMARY.
  5098         16  BI-COMPANY-CD           PIC X.
  5099         16  BI-CARRIER              PIC X.
  5100         16  BI-GROUPING             PIC X(6).
  5101         16  BI-ACCOUNT              PIC X(10).
  5102         16  BI-FIN-RESP             PIC X(10).
  5103         16  BI-RECORD-TYPE          PIC X.
  5104             88  BI-HEADER-DATA         VALUE '1'.
  5105             88  BI-ADDRESS-DATA        VALUE '2'.
  5106             88  BI-TEXT-DATA           VALUE '3'.
  5107         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5108
  5109     12  BI-TEXT-RECORD.
  5110         16  BI-SKIP-CONTROL         PIC X.
  5111         16  BI-TEXT-LINE            PIC X(157).
  5112         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5113             20  BI-ADDR-LIT         PIC X(14).
  5114             20  BI-CO               PIC X(7).
  5115             20  BI-DASH             PIC X.
  5116             20  BI-ACCT             PIC X(10).
  5117             20  FILLER              PIC XX.
  5118             20  BI-ACCT-ADDR        PIC X(30).
  5119             20  FILLER              PIC X.
  5120             20  BI-REMIT-LIT        PIC X(11).
  5121             20  FILLER              PIC XX.
  5122             20  BI-REMIT-ADDR       PIC X(30).
  5123             20  FILLER              PIC X(49).
  5124         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5125             20  BI-INS-LAST-NAME    PIC X(15).
  5126             20  FILLER              PIC X.
  5127             20  BI-INS-1ST-NAME     PIC X(10).
  5128             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5129                 24  BI-INS-INITS    PIC XX.
  5130                 24  FILLER          PIC X(8).
  5131             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL642.cbl
  5132             20  BI-UNDRWRTR.
  5133                 24  BI-INS-INIT     PIC X.
  5134                 24  FILLER          PIC XXX.
  5135             20  BI-CERT             PIC X(11).
  5136             20  FILLER              PIC XX.
  5137             20  BI-EFF-DT           PIC X(8).
  5138             20  FILLER              PIC XX.
  5139             20  BI-CAN-DT           PIC X(8).
  5140             20  FILLER              PIC XX.
  5141             20  BI-ED-TERM          PIC ZZZ.
  5142             20  FILLER              PIC XX.
  5143             20  BI-TYPE             PIC XXXX.
  5144             20  FILLER              PIC X.
  5145             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5146             20  FILLER              PIC X(3).
  5147             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5148             20  FILLER              PIC XX.
  5149             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5150             20  FILLER              PIC XX.
  5151             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5152             20  FILLER              PIC X(26).
  5153         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5154             20  FILLER              PIC X(42).
  5155             20  BI-TOT-DESC         PIC X(20).
  5156             20  FILLER REDEFINES BI-TOT-DESC.
  5157                 24  BI-TOT-LIT      PIC X(6).
  5158                 24  BI-OVERRIDE-L6  PIC X(14).
  5159             20  FILLER              PIC X(11).
  5160             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5161             20  BI-TOT-DASH REDEFINES
  5162                 BI-TOT-PREM         PIC X(15).
  5163             20  FILLER              PIC X(11).
  5164             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5165             20  FILLER              PIC XX.
  5166             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5167             20  FILLER              PIC X(26).
  5168         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5169             20  BI-ENTRY-DESC       PIC X(30).
  5170             20  FILLER              PIC X(11).
  5171             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5172             20  FILLER              PIC X(31).
  5173             20  BI-ACCTG-COMMENT    PIC X(30).
  5174             20  FILLER              PIC X(39).
  5175         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5176             20  FILLER              PIC X(42).
  5177             20  BI-TOT-DESC5        PIC X(20).
  5178             20  FILLER              PIC X(11).
  5179             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5180             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5181             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5182             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5183             20  FILLER              PIC X(24).
  5184         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5185             20  BI-TEXT-2-81        PIC X(80).
  5186             20  FILLER              PIC X(77).
  5187         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5188             20  FILLER              PIC X(53).
  5189             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL642.cbl
  5190             20  FILLER              PIC X(25).
  5191         16  BI-TEXT-TYPE            PIC X.
  5192             88 DETAIL-LINE              VALUE 'D'.
  5193         16  BI-TERM                 PIC S999.
  5194         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5195         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5196         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5197
  5198     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5199         16  FILLER                  PIC X.
  5200         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5201         16  FILLER                  PIC X(10).
  5202         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5203         16  FILLER                  PIC X(106).
  5204
  5205     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5206         16  BI-PROCESSOR-CD         PIC X(4).
  5207         16  BI-STATEMENT-TYPE       PIC X.
  5208             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5209         16  BI-NO-OF-COPIES         PIC S9.
  5210         16  BI-CREATION-DT          PIC XX.
  5211         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5212         16  BI-ACCOUNT-TOTALS.
  5213             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5214             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5215             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5216             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5217             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5218             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5219             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5220             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5221         16  BI-FIN-RESP-ACCT        PIC X(10).
  5222         16  BI-FIN-RESP-NAME        PIC X(30).
  5223         16  FILLER                  PIC X(79).
  5224
  5225
  5226     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5227     12  FILLER                      PIC XX.
  5228
  5229     12  GA-CONTROL-PRIMARY.
  5230         16  FILLER                  PIC X(31).
  5231
  5232     12  GA-TEXT-RECORD.
  5233         16  GA-SKIP-CONTROL         PIC X.
  5234         16  GA-TEXT-LINE            PIC X(132).
  5235         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5236             20  FILLER              PIC X.
  5237             20  GA-CARRIER          PIC X.
  5238             20  GA-GROUPING         PIC X(6).
  5239             20  GA-DASH             PIC X.
  5240             20  GA-AGENT            PIC X(10).
  5241             20  FILLER              PIC X.
  5242             20  GA-AGENT-ADDR       PIC X(30).
  5243             20  FILLER              PIC X(82).
  5244         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5245             20  GA-ACCT             PIC X(10).
  5246             20  FILLER              PIC X.
  5247             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL642.cbl
  5248             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5249             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5250             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5251             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5252             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5253             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5254             20  FILLER              PIC X.
  5255             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5256             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5257             20  FILLER              PIC X.
  5258         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5259             20  FILLER              PIC X(11).
  5260             20  GA-ENTRY-DESC       PIC X(30).
  5261             20  FILLER              PIC X(60).
  5262             20  GA-ENTRY-COMMENT    PIC X(30).
  5263             20  FILLER              PIC X.
  5264         16  FILLER.
  5265             20  GA-BENEFIT-CD       PIC XX.
  5266             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5267             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5268             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5269             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5270             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5271             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5272             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5273             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5274
  5275     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5276         16  FILLER                  PIC X.
  5277         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5278         16  FILLER                  PIC X(144).
  5279
  5280     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5281         16  GA-PROCESSOR-CD         PIC X(4).
  5282         16  GA-STATEMENT-TYPE       PIC X.
  5283             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5284         16  GA-NO-OF-COPIES         PIC S9.
  5285         16  GA-CREATION-DT          PIC XX.
  5286         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5287         16  GA-AGENT-TOTALS.
  5288             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5289             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5290             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5291             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5292             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5293             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5294             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5295             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5296             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5297         16  GA-AGENTS-NAME          PIC X(30).
  5298         16  FILLER                  PIC X(81).
  5299     12  FILLER                      PIC XX.
  5300
  5301
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL642.cbl
  5303*                            COPY ERCCOMM.
  5304******************************************************************
  5305*                                                                *
  5306*                                                                *
  5307*                            ERCCOMM                             *
  5308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5309*                            VMOD=2.003                          *
  5310*                                                                *
  5311*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *
  5312*                             FROM THOSE IN ACCOUNT MASTER       *
  5313*                                                                *
  5314*        FILE TYPE= VSAM,KSDS                                    *
  5315*        RECORD SIZE = 250    RECFORM = FIXED                    *
  5316*                                                                *
  5317*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *
  5318*                                                                *
  5319*        LOG = YES                                               *
  5320*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5321*                                                                *
  5322******************************************************************
  5323
  5324 01  COMMISSION-EXCEPTIONS.
  5325     12  CE-RECORD-ID                PIC  XX.
  5326         88  VALID-CE-ID         VALUE 'CE'.
  5327
  5328     12  CE-CONTROL-PRIMARY.
  5329         16  CE-COMPANY-CD           PIC  X.
  5330         16  CE-CARRIER              PIC  X.
  5331         16  CE-GROUPING             PIC  X(6).
  5332         16  CE-STATE                PIC  XX.
  5333         16  CE-ACCOUNT              PIC  X(10).
  5334         16  CE-CERT-EFF-DT          PIC  XX.
  5335         16  CE-CERT-NO.
  5336             20  CE-CERT-PRIME       PIC  X(10).
  5337             20  CE-CERT-SFX         PIC  X.
  5338
  5339     12  CE-CERT-EXPIRATION-DT       PIC  XX.
  5340
  5341     12  CE-COMP-STRUCTURE.
  5342         16  CE-DEFN-1.
  5343             20  CE-AGT-COMMS       OCCURS 10 TIMES.
  5344                 24  CE-AGENT-NO    PIC  X(10).
  5345                 24  CE-COMP-TYPE   PIC  X.
  5346                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.
  5347                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.
  5348         16  CE-DEFN-2              REDEFINES CE-DEFN-1.
  5349             20  CE-COMP-TABLES     OCCURS 10 TIMES.
  5350                 24  FILLER         PIC  X(11).
  5351                 24  CE-LF-COMPT    PIC  X(3).
  5352                 24  CE-AH-COMPT    PIC  X(3).
  5353
  5354     12  FILLER                     PIC  X(43).
  5355******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL642.cbl
  5357*                            COPY ERCCTBL.
  5358******************************************************************
  5359*                                                                *
  5360*                                                                *
  5361*                            ERCCTBL                             *
  5362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5363*                            VMOD=2.003
  5364*                                                                *
  5365*   ONLINE CREDIT SYSTEM                                         *
  5366*                                                                *
  5367*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5368*                                                                *
  5369*   FILE TYPE = VSAM,KSDS                                        *
  5370*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5371*                                                                *
  5372*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5373*       ALTERNATE PATH = NONE                                    *
  5374*                                                                *
  5375*   LOG = NO                                                     *
  5376*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5377*                                                                *
  5378*                                                                *
  5379******************************************************************
  5380
  5381 01  COMM-TABLE-RECORD.
  5382     12  CT-RECORD-ID                      PIC XX.
  5383         88  VALID-CT-ID                      VALUE 'CT'.
  5384
  5385     12  CT-CONTROL-PRIMARY.
  5386         16  CT-COMPANY-CD                 PIC X.
  5387         16  CT-TABLE                      PIC XXX.
  5388         16  CT-CNTRL-2.
  5389             20  CT-BEN-TYPE               PIC X.
  5390             20  CT-BEN-CODE               PIC XX.
  5391
  5392     12  CT-MAINT-INFORMATION.
  5393         16  CT-LAST-MAINT-DT              PIC XX.
  5394         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5395         16  CT-LAST-MAINT-USER            PIC X(4).
  5396         16  FILLER                        PIC X(31).
  5397
  5398     12  CT-LIMITS.
  5399         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5400
  5401         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5402
  5403         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5404
  5405     12  CT-RATES.
  5406         16  CT-RTX          OCCURS 27 TIMES.
  5407             20  CT-RT                     PIC SV9(5)     COMP-3.
  5408             20  CT-RT-R   REDEFINES
  5409                 CT-RT                     PIC XXX.
  5410
  5411     12  FILLER                            PIC  X(42).
  5412
  5413******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL642.cbl
  5415*                            COPY ERCGXRF.
  5416******************************************************************
  5417*                                                                *
  5418*                                                                *
  5419*                            ERCGXRF                             *
  5420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5421*                            VMOD=2.002                          *
  5422*                                                                *
  5423*   ONLINE CREDIT SYSTEM                                         *
  5424*                                                                *
  5425*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
  5426*                                                                *
  5427*   FILE TYPE = VSAM,KSDS                                        *
  5428*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  5429*                                                                *
  5430*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
  5431*       ALTERNATE PATH = NONE                                    *
  5432*                                                                *
  5433*   LOG = NO                                                     *
  5434*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5435*                                                                *
  5436******************************************************************
  5437
  5438 01  AGENT-CROSS-REFERENCE.
  5439     12  GX-RECORD-ID                PIC XX.
  5440         88  VALID-GX-ID             VALUE 'GX'.
  5441
  5442     12  GX-CONTROL-PRIMARY.
  5443         16  GX-COMPANY-CD           PIC X.
  5444         16  GX-CARRIER              PIC X.
  5445         16  GX-GROUPING             PIC X(6).
  5446         16  GX-AGENT-NO             PIC X(10).
  5447
  5448     12  GX-MAINT-INFORMATION.
  5449         16  GX-LAST-MAINT-DT        PIC XX.
  5450         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  5451         16  GX-LAST-MAINT-USER      PIC X(4).
  5452         16  FILLER                  PIC X(9).
  5453
  5454     12  FILLER                      PIC X(37).
  5455
  5456     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
  5457
  5458     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
  5459                            DEPENDING ON GX-AGENT-POINTER-CNT.
  5460         16  GX-AM-CARRIER           PIC X.
  5461         16  GX-AM-GROUPING          PIC X(6).
  5462         16  GX-AM-STATE             PIC XX.
  5463         16  GX-AM-ACCOUNT           PIC X(10).
  5464         16  GX-AM-EXPIRATION-DT     PIC XX.
  5465         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
  5466         16  GX-LAST-BILL-DT         PIC XX.
  5467         16  GX-AM-EFF-DT            PIC XX.
  5468         16  FILLER                  PIC X(4).
  5469
  5470******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL642.cbl
  5472*                            COPY ERCRESC.
  5473******************************************************************
  5474*                                                                *
  5475*                            ERCRESC                             *
  5476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5477*                            VMOD=2.003                          *
  5478*                                                                *
  5479*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  5480*                                                                *
  5481*   FILE TYPE = VSAM,KSDS                                        *
  5482*   RECORD SIZE = 103 RECFORM = FIXED                            *
  5483*                                                                *
  5484*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  5485*       ALTERNATE PATH1 = NONE                                   *
  5486*                                                                *
  5487*   LOG = NO                                                     *
  5488*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5489*                                                                *
  5490******************************************************************
  5491
  5492 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  5493
  5494     10  ERRESC-RECORD-KEY.
  5495         15  RESC-COMPANY-CD           PIC   X.
  5496         15  RESC-CARRIER              PIC   X.
  5497         15  RESC-GROUP                PIC   X(6).
  5498         15  RESC-STATE                PIC   XX.
  5499         15  RESC-ACCOUNT              PIC   X(10).
  5500         15  RESC-AGENT                PIC   X(10).
  5501         15  RESC-RESIDENT-STATE       PIC   XX.
  5502         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  5503*                                           YYYYMMDD
  5504     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  5505
  5506     10  RESC-COMM-RECORD-DATA.
  5507         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  5508             20 RESC-COVERAGE-CAT      PIC    X.
  5509             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  5510             20 RESC-COMMISSION-TAB REDEFINES
  5511                RESC-COMMISSION-PER    PIC  XXX.
  5512
  5513     10  RESC-MAINT-BY                 PIC X(4).
  5514     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  5515     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  5516*                                          YYYYMMDD
  5517
  5518 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5519                          CONTROL-FILE COMPENSATION-MASTER
  5520                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5521                          BILLING-STATEMENT
  5522                          COMMISSION-EXCEPTIONS
  5523                          COMM-TABLE-RECORD
  5524                          AGENT-CROSS-REFERENCE
  5525                          ACCOUNT-RESIDENT-ST-COMMISSION.
  5526 0000-DFHEXIT SECTION.
  5527     MOVE '9#                    $   ' TO DFHEIV0.
  5528     MOVE 'EL642' TO DFHEIV1.
  5529     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL642.cbl
  5530
  5531     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5532     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5533     MOVE EIBTRMID               TO  QID-TERM.
  5534     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5535     MOVE '5'                    TO  DC-OPTION-CODE.
  5536
  5537     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  5538
  5539     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-DATE.
  5540     MOVE DC-GREG-DATE-1-MDY     TO  WS-CURRENT-DATE-MDY.
  5541     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DATE-EDIT.
  5542
  5543     IF EIBCALEN  =  ZERO
  5544         GO TO 8800-UNAUTHORIZED-ACCESS.
  5545
  5546     IF PI-RETURN-TO-PROGRAM  =  THIS-PGM
  5547         MOVE PI-CALLING-PROGRAM  TO  RETURNED-FROM.
  5548
  5549     IF PI-CALLING-PROGRAM NOT  =  THIS-PGM
  5550         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  5551             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5552             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5553             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5554             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5555             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5556             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5557             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5558             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5559             MOVE PI-CR-CONTROL-IN-PROGRESS
  5560                                        TO  W-TRANSFER-CONTROL
  5561             MOVE SPACES
  5562                                   TO  PI-CR-CONTROL-IN-PROGRESS
  5563         ELSE
  5564             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5565             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5566             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5567             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5568             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5569             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5570             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5571             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5572
  5573     MOVE LOW-VALUES             TO  EL642AI.
  5574
  5575     IF PI-AR-PROCESSING
  5576        MOVE XCTL-635            TO XCTL-PYAJ.
  5577
  5578     IF PI-COMPANY-ID = 'DMD'
  5579        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5580
  5581     IF RETURNED-FROM  NOT =  SPACES
  5582         PERFORM 0600-RECOVER-TEMP-STORAGE  THRU  0690-EXIT
  5583         IF RETURNED-FROM  =  XCTL-PYAJ
  5584           AND  NOT  PI-VOID-BILL
  5585             MOVE ZEROS          TO  PI-ADJUSTMNTS
  5586                                     PI-DISBURSED
  5587                                     PI-REMITTED
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL642.cbl
  5588             GO TO 1200-PYAJ-BILLING-COMPLETE
  5589         ELSE
  5590             MOVE -1             TO  APFNTERL
  5591             IF PI-TRANSFER-BEFORE-ACT
  5592                 GO TO 8100-SEND-INITIAL-MAP
  5593             ELSE
  5594                 PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5595                 GO TO 8100-SEND-INITIAL-MAP.
  5596
  5597     IF EIBTRNID  NOT =  TRANS-ID
  5598         MOVE EL642A             TO  PI-MAP-NAME
  5599         MOVE -1                 TO  APFNTERL
  5600         GO TO 8100-SEND-INITIAL-MAP.
  5601
  5602
  5603* EXEC CICS HANDLE CONDITION
  5604*        PGMIDERR  (9600-PGMID-ERROR)
  5605*        ERROR     (9990-ABEND)
  5606*    END-EXEC.
  5607*    MOVE '"$L.                  ! " #00005598' TO DFHEIV0
  5608     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5610     MOVE X'2220233030303035353938' TO DFHEIV0(25:11)
  5611     CALL 'kxdfhei1' USING DFHEIV0
  5612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5613
  5614
  5615     IF EIBAID  =  DFHCLEAR
  5616         IF PI-MAP-NAME  =  EL642B
  5617             PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT
  5618             MOVE EL642A         TO  PI-MAP-NAME
  5619             MOVE -1             TO  APFNTERL
  5620             GO TO 8100-SEND-INITIAL-MAP
  5621         ELSE
  5622             GO TO 9400-CLEAR.
  5623
  5624     IF PI-PROCESSOR-ID  =  'LGXX'
  5625         GO TO 0200-RECEIVE.
  5626
  5627
  5628* EXEC CICS READQ TS
  5629*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5630*        INTO    (SECURITY-CONTROL)
  5631*        LENGTH  (SC-COMM-LENGTH)
  5632*        ITEM    (SC-ITEM)
  5633*    END-EXEC.
  5634*    MOVE '*$II   L              ''   #00005615' TO DFHEIV0
  5635     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5637     MOVE X'2020233030303035363135' TO DFHEIV0(25:11)
  5638     CALL 'kxdfhei1' USING DFHEIV0,
  5639           PI-SECURITY-TEMP-STORE-ID,
  5640           SECURITY-CONTROL,
  5641           SC-COMM-LENGTH,
  5642           SC-ITEM,
  5643           DFHEIV99,
  5644           DFHEIV99
  5645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL642.cbl
  5646
  5647
  5648     MOVE SC-CREDIT-DISPLAY (19)  TO  PI-DISPLAY-CAP.
  5649     MOVE SC-CREDIT-UPDATE  (19)  TO  PI-MODIFY-CAP.
  5650
  5651     IF NOT  DISPLAY-CAP
  5652         MOVE 'READ'              TO  SM-READ
  5653         PERFORM 9995-SECURITY-VIOLATION
  5654         MOVE ER-0070             TO  EMI-ERROR
  5655         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5656         GO TO 8100-SEND-INITIAL-MAP.
  5657
  5658 0200-RECEIVE.
  5659     IF EIBAID  =  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5660         MOVE ER-0008            TO  EMI-ERROR
  5661         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5662         IF PI-MAP-NAME  =  EL642A
  5663             MOVE -1             TO  APFNTERL
  5664             GO TO 8200-SEND-DATAONLY
  5665         ELSE
  5666             MOVE -1             TO  BPFNTERL
  5667             GO TO 8200-SEND-DATAONLY.
  5668
  5669
  5670* EXEC CICS RECEIVE
  5671*        MAP     (PI-MAP-NAME)
  5672*        MAPSET  (MAPSET-NAME)
  5673*        INTO    (EL642AI)
  5674*    END-EXEC.
  5675     MOVE LENGTH OF
  5676      EL642AI
  5677       TO DFHEIV11
  5678*    MOVE '8"T I  L              ''   #00005643' TO DFHEIV0
  5679     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5680     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5681     MOVE X'2020233030303035363433' TO DFHEIV0(25:11)
  5682     CALL 'kxdfhei1' USING DFHEIV0,
  5683           PI-MAP-NAME,
  5684           EL642AI,
  5685           DFHEIV11,
  5686           MAPSET-NAME,
  5687           DFHEIV99,
  5688           DFHEIV99
  5689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5690
  5691
  5692     IF PI-MAP-NAME  =  EL642A
  5693         IF APFNTERL  GREATER THAN  ZERO
  5694             IF EIBAID  NOT =  DFHENTER
  5695                 MOVE ER-0004    TO  EMI-ERROR
  5696                 MOVE AL-UNBOF   TO  APFNTERA
  5697                 MOVE -1         TO  APFNTERL
  5698                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5699                 GO TO 8200-SEND-DATAONLY
  5700             ELSE
  5701                 IF APFNTERI  NUMERIC
  5702                   AND  APFNTERI  GREATER THAN  ZERO
  5703                   AND  APFNTERI  LESS THAN  25
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL642.cbl
  5704                     MOVE PF-VALUES (APFNTERI)  TO  EIBAID
  5705                 ELSE
  5706                     MOVE ER-0029   TO  EMI-ERROR
  5707                     MOVE AL-UNBOF  TO  APFNTERA
  5708                     MOVE -1        TO  APFNTERL
  5709                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5710                     GO TO 8200-SEND-DATAONLY
  5711         ELSE
  5712             NEXT SENTENCE
  5713     ELSE
  5714         IF PI-MAP-NAME  =  EL642B
  5715             IF BPFNTERL  GREATER THAN  ZERO
  5716                 IF EIBAID  NOT =  DFHENTER
  5717                     MOVE ER-0004   TO  EMI-ERROR
  5718                     MOVE AL-UNBOF  TO  BPFNTERA
  5719                     MOVE -1        TO  BPFNTERL
  5720                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5721                     GO TO 8200-SEND-DATAONLY
  5722                 ELSE
  5723                     IF BPFNTERI  NUMERIC
  5724                       AND  BPFNTERI  GREATER THAN  ZERO
  5725                       AND  BPFNTERI  LESS THAN  25
  5726                         MOVE PF-VALUES (BPFNTERI)  TO  EIBAID
  5727                     ELSE
  5728                         MOVE ER-0029   TO  EMI-ERROR
  5729                         MOVE AL-UNBOF  TO  BPFNTERA
  5730                         MOVE -1        TO  BPFNTERL
  5731                         PERFORM 9900-ERROR-FORMAT
  5732                             THRU  9900-EXIT
  5733                         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL642.cbl
  5735 0300-CHECK-PFKEYS.
  5736     IF EIBAID  =  DFHPF23
  5737         GO TO 8810-PF23.
  5738
  5739     IF EIBAID  =  DFHPF24
  5740         GO TO 9200-RETURN-MAIN-MENU.
  5741
  5742     IF EIBAID  =  DFHPF12
  5743         GO TO 9500-PF12.
  5744
  5745 0310-CHECK-PFKEYS.
  5746     IF EIBAID  =  DFHPF3
  5747       AND  PI-MAP-NAME  =  EL642A
  5748         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5749         MOVE SPACES             TO  PI-CR-CONTROL-IN-PROGRESS
  5750         MOVE XCTL-650           TO  PGM-NAME
  5751         GO TO 9300-XCTL.
  5752
  5753     IF EIBAID  =  DFHPF4
  5754       AND  PI-MAP-NAME  =  EL642A
  5755        NEXT SENTENCE
  5756     ELSE
  5757        GO TO 0320-CONT-PFKEYS.
  5758
  5759     IF PI-CR-FIN-RESP  NOT =  SPACES
  5760         MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5761         MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5762         MOVE SPACE             TO  PI-CR-STATE
  5763         MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5764         MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5765         MOVE 'G'               TO  PI-CR-TYPE
  5766         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5767         MOVE XCTL-652       TO  PGM-NAME
  5768         GO TO 9300-XCTL.
  5769
  5770     IF PI-SCR-FIN-RESP EQUAL SPACES OR LOW-VALUES
  5771         GO TO 0315-PF4-ERROR.
  5772
  5773     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5774
  5775     MOVE PI-SCR-CARRIER        TO  PI-CR-CARRIER.
  5776     MOVE PI-SCR-GROUPING       TO  PI-CR-GROUPING.
  5777     MOVE SPACE                 TO  PI-CR-STATE.
  5778     MOVE LOW-VALUES            TO  PI-CR-ACCOUNT.
  5779     MOVE PI-SCR-FIN-RESP       TO  PI-CR-FIN-RESP.
  5780     MOVE 'G'                   TO  PI-CR-TYPE.
  5781     MOVE 'Y'                   TO  PI-TRANSFER-SW.
  5782
  5783     IF PI-ZERO-CARRIER
  5784       OR  PI-ZERO-CAR-GROUP
  5785         MOVE ZEROS              TO  PI-CR-CARRIER.
  5786
  5787     IF PI-ZERO-GROUPING
  5788        OR  PI-ZERO-CAR-GROUP
  5789         MOVE ZEROS              TO  PI-CR-GROUPING.
  5790
  5791     MOVE XCTL-652       TO  PGM-NAME
  5792
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL642.cbl
  5793     GO TO 9300-XCTL.
  5794
  5795 0315-PF4-ERROR.
  5796
  5797     MOVE ER-2407        TO  EMI-ERROR.
  5798     MOVE -1             TO  APFNTERL.
  5799     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5800     GO TO 8200-SEND-DATAONLY.
  5801
  5802 0320-CONT-PFKEYS.
  5803
  5804     IF EIBAID  =  DFHPF6
  5805       AND  PI-MAP-NAME  =  EL642A
  5806         MOVE LOW-VALUES         TO  EL642AO
  5807         MOVE PI-SAV-CARR        TO  PI-CR-CARRIER
  5808         MOVE PI-SAV-GROUP       TO  PI-CR-GROUPING
  5809         MOVE SPACE              TO  PI-CR-STATE
  5810         MOVE LOW-VALUES         TO  PI-CR-ACCOUNT
  5811         MOVE PI-SAV-AGENT       TO  PI-CR-FIN-RESP
  5812         MOVE 'G'                TO  PI-CR-TYPE
  5813         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5814         MOVE XCTL-6401          TO  PGM-NAME
  5815         GO TO 9300-XCTL.
  5816
  5817     IF EIBAID  =  DFHPF7
  5818       AND  PI-MAP-NAME  =  EL642A
  5819         IF PI-CR-FIN-RESP  NOT =  SPACES
  5820             MOVE PI-COMP-CARRIER   TO  PI-CR-CARRIER
  5821             MOVE PI-COMP-GROUPING  TO  PI-CR-GROUPING
  5822             MOVE SPACE             TO  PI-CR-STATE
  5823             MOVE LOW-VALUES        TO  PI-CR-ACCOUNT
  5824             MOVE PI-SAV-AGENT      TO  PI-CR-FIN-RESP
  5825             MOVE 'G'               TO  PI-CR-TYPE
  5826             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5827             MOVE XCTL-PYAJ      TO  PGM-NAME
  5828             GO TO 9300-XCTL
  5829         ELSE
  5830             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5831                                       XCTL-633DMD
  5832                 GO TO 9400-CLEAR
  5833            ELSE
  5834                 MOVE ER-2411        TO  EMI-ERROR
  5835                 MOVE -1             TO  APFNTERL
  5836                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5837                 GO TO 8200-SEND-DATAONLY.
  5838
  5839     IF EIBAID  =  DFHPF8
  5840       AND  PI-MAP-NAME  =  EL642A
  5841         IF PI-CR-FIN-RESP  NOT =  SPACES
  5842             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5843             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5844             MOVE SPACE          TO  PI-CR-STATE
  5845             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5846             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5847             MOVE 'G'            TO  PI-CR-TYPE
  5848             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5849             MOVE XCTL-658       TO  PGM-NAME
  5850             GO TO 9300-XCTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL642.cbl
  5851         ELSE
  5852         IF PI-SCR-FIN-RESP  NOT =  SPACES
  5853             PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5854             MOVE PI-SCR-CARRIER  TO  PI-CR-CARRIER
  5855             MOVE PI-SCR-GROUPING TO  PI-CR-GROUPING
  5856             MOVE SPACE           TO  PI-CR-STATE
  5857             MOVE LOW-VALUES      TO  PI-CR-ACCOUNT
  5858             MOVE PI-SCR-FIN-RESP TO  PI-CR-FIN-RESP
  5859             MOVE 'G'             TO  PI-CR-TYPE
  5860             MOVE XCTL-658       TO  PGM-NAME
  5861             GO TO 9300-XCTL
  5862         ELSE
  5863             MOVE ER-2399        TO  EMI-ERROR
  5864             MOVE -1             TO  APFNTERL
  5865             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5866             GO TO 8200-SEND-DATAONLY.
  5867
  5868     IF EIBAID  =  DFHPF1
  5869       AND  PI-MAP-NAME  =  EL642B
  5870         GO TO 7500-PRODUCE-CHECK.
  5871
  5872     IF EIBAID  =  DFHPF5
  5873       AND  PI-MAP-NAME  =  EL642A
  5874         IF PI-CR-FIN-RESP NOT  =  SPACES
  5875             MOVE PI-SAV-CARR    TO  PI-CR-CARRIER
  5876             MOVE PI-SAV-GROUP   TO  PI-CR-GROUPING
  5877             MOVE SPACE          TO  PI-CR-STATE
  5878             MOVE LOW-VALUES     TO  PI-CR-ACCOUNT
  5879             MOVE PI-SAV-AGENT   TO  PI-CR-FIN-RESP
  5880             MOVE 'G'            TO  PI-CR-TYPE
  5881             MOVE EL642B         TO  PI-MAP-NAME
  5882             GO TO 7000-PROCESS-CHECK
  5883         ELSE
  5884             MOVE ER-2400        TO  EMI-ERROR
  5885             MOVE -1             TO  APFNTERL
  5886             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5887             GO TO 8200-SEND-DATAONLY.
  5888
  5889     IF PI-MAP-NAME  =  EL642A
  5890         IF EIBAID  =  DFHENTER
  5891           OR  DFHPF3
  5892             GO TO 0330-EDIT-DATA.
  5893
  5894 0320-INPUT-ERROR.
  5895     MOVE ER-0029                TO  EMI-ERROR.
  5896
  5897     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5898
  5899     IF PI-MAP-NAME  =  EL642A
  5900         MOVE AL-UNBON           TO  APFNTERA
  5901         MOVE -1                 TO  APFNTERL
  5902     ELSE
  5903         MOVE AL-UNBON           TO  BPFNTERA
  5904         MOVE -1                 TO  BPFNTERL.
  5905
  5906     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL642.cbl
  5908 0330-EDIT-DATA.
  5909     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5910
  5911     IF VALID-BILL-TYPE
  5912         IF NOT MODIFY-CAP
  5913             IF ABILTYPI  =  '1' OR '2'
  5914                 NEXT SENTENCE
  5915             ELSE
  5916                 MOVE 'UPDATE'   TO  SM-READ
  5917                 PERFORM 9995-SECURITY-VIOLATION
  5918                 MOVE ER-0070    TO  EMI-ERROR
  5919                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5920                 GO TO 8100-SEND-INITIAL-MAP.
  5921
  5922     MOVE SPACES                 TO  PI-LIMIT-BILLING-ACCOUNTS.
  5923
  5924 0350-ERROR-CHECK.
  5925     IF EMI-ERROR  =  ZEROS
  5926         NEXT SENTENCE
  5927     ELSE
  5928         GO TO 8200-SEND-DATAONLY.
  5929
  5930     IF AAGENTL  GREATER THAN  ZEROS
  5931         MOVE AL-UANON           TO  AAGENTA
  5932         MOVE AAGENTI            TO  PI-SAV-AGENT
  5933     ELSE
  5934         MOVE -1                 TO  AAGENTL
  5935         MOVE AL-UABON           TO  AAGENTA
  5936         MOVE ER-2910            TO  EMI-ERROR
  5937         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5938
  5939     IF ACARIERL  GREATER THAN  ZEROS
  5940         MOVE AL-UANON           TO  ACARIERA
  5941         MOVE ACARIERI           TO  PI-SAV-CARR
  5942                                     PI-CR-CARRIER
  5943                                     PI-COMP-CARRIER
  5944     ELSE
  5945         IF NOT  PI-ZERO-CARRIER
  5946           AND  NOT  PI-ZERO-CAR-GROUP
  5947             MOVE -1             TO  ACARIERL
  5948             MOVE AL-UABON       TO  ACARIERA
  5949             MOVE ER-0194        TO  EMI-ERROR
  5950             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5951         ELSE
  5952             MOVE ZERO           TO  PI-SAV-CARR
  5953                                     PI-COMP-CARRIER.
  5954
  5955     IF AGROUPL  GREATER THAN  ZEROS
  5956         MOVE AL-UANON           TO  AGROUPA
  5957         MOVE AGROUPI            TO  PI-SAV-GROUP
  5958                                     PI-CR-GROUPING
  5959                                     PI-COMP-GROUPING
  5960     ELSE
  5961         IF NOT  PI-ZERO-GROUPING
  5962           AND  NOT  PI-ZERO-CAR-GROUP
  5963             MOVE -1             TO  AGROUPL
  5964             MOVE AL-UABON       TO  AGROUPA
  5965             MOVE ER-0195        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL642.cbl
  5966             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5967         ELSE
  5968             MOVE ZERO           TO  PI-SAV-GROUP
  5969                                     PI-COMP-GROUPING.
  5970
  5971     MOVE ABILTYPI               TO  VALID-BILL-TYPE-VALUES.
  5972
  5973     IF VALID-BILL-TYPE
  5974         MOVE AL-UANON           TO  ABILTYPA
  5975         MOVE ABILTYPI           TO  PI-BILL-TYPE
  5976                                     WS-BILL-TYPE
  5977     ELSE
  5978         MOVE -1                 TO  ABILTYPL
  5979         MOVE ER-2249            TO  EMI-ERROR
  5980         MOVE AL-UABON           TO  ABILTYPA
  5981         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5982
  5983     IF PI-AR-PROCESSING
  5984        IF PI-PREVIEW
  5985           NEXT SENTENCE
  5986        ELSE
  5987           MOVE -1               TO ABILTYPL
  5988           MOVE ER-3145          TO EMI-ERROR
  5989           MOVE AL-UABON         TO ABILTYPA
  5990           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5991
  5992     IF APRODSWL  NOT =  ZEROS
  5993         IF PI-PREVIEW
  5994             IF APRODSWI  =  'Y'  OR  'N'
  5995                 MOVE AL-UANON   TO  APRODSWA
  5996             ELSE
  5997                 MOVE -1         TO  APRODSWL
  5998                 MOVE ER-2436    TO  EMI-ERROR
  5999                 MOVE AL-UABON   TO  APRODSWA
  6000                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6001         ELSE
  6002             MOVE -1             TO  APRODSWL
  6003             MOVE ER-2434        TO  EMI-ERROR
  6004             MOVE AL-UABON       TO  APRODSWA
  6005             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6006     ELSE
  6007         IF PI-PREVIEW
  6008             MOVE -1             TO  APRODSWL
  6009             MOVE ER-2435        TO  EMI-ERROR
  6010             MOVE AL-UABON       TO  APRODSWA
  6011             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6012
  6013     IF AACCT1L  NOT =  ZEROS
  6014         MOVE AL-UANON           TO  AACCT1A
  6015         MOVE 'Y'                TO  LIMIT-BILLING-SW
  6016         MOVE AACCT1I            TO  PI-BILLING-ACCOUNTS (1).
  6017
  6018     IF AACCT2L  NOT =  ZEROS
  6019         MOVE AL-UANON           TO  AACCT2A
  6020         MOVE 'Y'                TO  LIMIT-BILLING-SW
  6021         MOVE AACCT2I            TO  PI-BILLING-ACCOUNTS (2).
  6022
  6023     IF AACCT3L  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL642.cbl
  6024         MOVE AL-UANON           TO  AACCT3A
  6025         MOVE 'Y'                TO  LIMIT-BILLING-SW
  6026         MOVE AACCT3I            TO  PI-BILLING-ACCOUNTS (3).
  6027
  6028     IF EMI-ERROR  =  ZEROS
  6029         GO TO 1000-BILLING-PROCESS.
  6030
  6031     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL642.cbl
  6033 0500-CREATE-TEMP-STORAGE.
  6034     IF PI-BAL-FRWD  NOT  NUMERIC
  6035         MOVE ZEROS              TO  PI-BAL-FRWD
  6036                                     PI-PREMIUM
  6037                                     PI-REMITTED
  6038                                     PI-TOT-ISS-COMP
  6039                                     PI-TOT-CAN-COMP
  6040                                     PI-ADJUSTMNTS
  6041                                     PI-DISBURSED
  6042                                     PI-END-BAL
  6043                                     PI-UNPAID-NET-PREM
  6044                                     PI-COMP-UNPAID-PREM
  6045                                     PI-LF-ISS-COMP
  6046                                     PI-AH-ISS-COMP
  6047                                     PI-LF-CAN-COMP
  6048                                     PI-AH-CAN-COMP
  6049                                     PI-DUE-FOR-ACCT
  6050                                     PI-ACCT-BEG-BAL
  6051                                     PI-ACCT-NET-PREM
  6052                                     PI-ACCT-COMP
  6053                                     PI-ACCT-PAY-ADJS.
  6054
  6055
  6056* EXEC CICS WRITEQ TS
  6057*        QUEUE   (QID)
  6058*        FROM    (PROGRAM-INTERFACE-BLOCK)
  6059*        LENGTH  (PI-COMM-LENGTH)
  6060*    END-EXEC.
  6061*    MOVE '*"                    ''   #00006012' TO DFHEIV0
  6062     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  6063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6064     MOVE X'2020233030303036303132' TO DFHEIV0(25:11)
  6065     CALL 'kxdfhei1' USING DFHEIV0,
  6066           QID,
  6067           PROGRAM-INTERFACE-BLOCK,
  6068           PI-COMM-LENGTH,
  6069           DFHEIV99,
  6070           DFHEIV99,
  6071           DFHEIV99
  6072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6073
  6074
  6075 0590-EXIT.
  6076      EXIT.
  6077
  6078 0600-RECOVER-TEMP-STORAGE.
  6079
  6080* EXEC CICS READQ TS
  6081*        QUEUE   (QID)
  6082*        INTO    (PROGRAM-INTERFACE-BLOCK)
  6083*        LENGTH  (PI-COMM-LENGTH)
  6084*    END-EXEC.
  6085*    MOVE '*$I    L              ''   #00006022' TO DFHEIV0
  6086     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6087     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6088     MOVE X'2020233030303036303232' TO DFHEIV0(25:11)
  6089     CALL 'kxdfhei1' USING DFHEIV0,
  6090           QID,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL642.cbl
  6091           PROGRAM-INTERFACE-BLOCK,
  6092           PI-COMM-LENGTH,
  6093           DFHEIV99,
  6094           DFHEIV99,
  6095           DFHEIV99
  6096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6097
  6098
  6099     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  6100
  6101     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6102
  6103 0690-EXIT.
  6104      EXIT.
  6105
  6106 0800-DELETE-TS.
  6107
  6108* EXEC CICS HANDLE CONDITION
  6109*        QIDERR  (0890-EXIT)
  6110*    END-EXEC.
  6111*    MOVE '"$N                   ! # #00006036' TO DFHEIV0
  6112     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6114     MOVE X'2320233030303036303336' TO DFHEIV0(25:11)
  6115     CALL 'kxdfhei1' USING DFHEIV0
  6116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6117
  6118
  6119
  6120* EXEC CICS DELETEQ TS
  6121*        QUEUE  (QID)
  6122*    END-EXEC.
  6123*    MOVE '*&                    #   #00006040' TO DFHEIV0
  6124     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6125     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6126     MOVE X'2020233030303036303430' TO DFHEIV0(25:11)
  6127     CALL 'kxdfhei1' USING DFHEIV0,
  6128           QID,
  6129           DFHEIV99
  6130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6131
  6132
  6133 0890-EXIT.
  6134      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL642.cbl
  6136******************************************************************
  6137*    THIS SECTION PROCESSES THE PENDING BUSINESS FILE BASED ON   *
  6138*    ACCOUNT DATE RANGES FOR EACH ACCOUNT THAT A GENERAL AGENT   *
  6139*    RECEIVES COMMISION FROM.  THE PROFILE OF A GENERAL AGENT    *
  6140*    IS MAINTAINED IN THE AGENT-CROSS-REFERENCE FILE.            *
  6141*                                                                *
  6142*    1.  IF VOID BILLING                                         *
  6143*            GO TO VOID-BILLING.                                 *
  6144*                                                                *
  6145*    2.  READ COMPENSATIONG MASTER FOR GENERAL AGENT TO GET      *
  6146*        THE AGENT'S ENDING BALANCE AND ADDRESS.                 *
  6147*                                                                *
  6148*    3.  READ THE AGENT-CROSS-REFERENCE-FILE.                    *
  6149*                                                                *
  6150*    4.  PROCESS EACH ACCOUNT ASSOCIATED WITH A GENERAL AGENT.   *
  6151*                                                                *
  6152*        A.  PROCESSS EACH DATE RANGE PER ACCOUNT AND ACCUMULATE *
  6153*            STATISTICS FOR THAT ACCOUNT.                        *
  6154*                                                                *
  6155*            1. PROCESS THE ACTIVE RECORDS ON PENDING BUSINESS.  *
  6156*               OMIT ANY RECORDS THAT HAVE ANY FATAL OR UNFORCED *
  6157*               ERRORS.  DO NOT PROCESS ANY REINSURANCE OR BILL- *
  6158*               ING ADJUSTMENT RECORDS.  IF BILLING UPDATE, FLAG
  6159*               EACH PENDING BUSINESS RECORD THAT IS PRCESSED.   *
  6160*                                                                *
  6161*            2.  ACCUMULATE STATISTICS FOR SCREEN DISPLAY.       *
  6162*                                                                *
  6163*            3.  COMPUTE ACCOUNT AND AGENT COMMISSION.           *
  6164*                                                                *
  6165*         B.  ACCUMULATE THE PAYMENT AND ADJUSTMENTS FOR         *
  6166*             EACH ACCOUNT THE GENERAL AGENT IS RESPONSIBLE FOR. *
  6167*                                                                *
  6168*         C.  PRINT ACCUMULATED STATISTICS FOR EACH ACCOUNT.     *
  6169*             OMITT ANY ACCOUNTS THAT DIDN'T HAVE ANY NEW BUS.   *
  6170*                                                                *
  6171*    5.  PRINT AN AGENT TOTAL OF ALL THE ACCOUNTS AND THE        *
  6172*        GENERAL AGENTS PAYMENTS AND ADJUSTMENTS.                *
  6173******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL642.cbl
  6175 1000-BILLING-PROCESS.
  6176     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD
  6177                                     ERPNDB-CO-CD-A1
  6178                                     ERCOMP-COMP-CD
  6179                                     ERPYAJ-COMP-CD
  6180                                     ERACCT-P-CO-CD
  6181                                     ERACCT-A-CO-CD
  6182                                     ERCOMM-COMPANY-CD
  6183                                     ERCTBL-COMPANY-CD.
  6184
  6185     MOVE ZEROS                  TO  PI-BAL-FRWD
  6186                                     PI-UNKNOWN
  6187                                     PI-UNPAID-NET-PREM
  6188                                     PI-COMP-UNPAID-PREM
  6189                                     PI-PREMIUM
  6190                                     PI-REMITTED
  6191                                     PI-TOT-ISS-COMP
  6192                                     PI-TOT-CAN-COMP
  6193                                     PI-ADJUSTMNTS
  6194                                     PI-DISBURSED
  6195                                     PI-END-BAL
  6196                                     PI-LF-ISS-COMP
  6197                                     PI-AH-ISS-COMP
  6198                                     PI-LF-CAN-COMP
  6199                                     PI-AH-CAN-COMP
  6200                                     PI-DUE-FOR-ACCT
  6201                                     PI-ACCT-BEG-BAL
  6202                                     PI-ACCT-NET-PREM
  6203                                     PI-ACCT-COMP
  6204                                     PI-ACCT-PAY-ADJS
  6205                                     PI-ISSUES-BILLED
  6206                                     PI-ISSUES-INER
  6207                                     PI-ISSUES-PREV
  6208                                     PI-CANCELS-BILLED
  6209                                     PI-CANCELS-INER
  6210                                     PI-CANCELS-PREV.
  6211
  6212     IF PI-VOID-BILL
  6213         GO TO 2000-VOID-BILLING.
  6214
  6215     MOVE SPACES                 TO  ELCNTL-KEY.
  6216     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  6217
  6218     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  6219
  6220     IF EMI-ERROR  NOT =  ZEROS
  6221         GO TO 8200-SEND-DATAONLY.
  6222
  6223     IF CF-ACCOUNT-MSTR-MAINT-DT  =  LOW-VALUES
  6224       OR  CF-COMPENSATION-MSTR-MAINT-DT  =  LOW-VALUES
  6225         MOVE ER-2571            TO  EMI-ERROR
  6226         MOVE -1                 TO  APFNTERL
  6227         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6228         GO TO 8200-SEND-DATAONLY.
  6229
  6230     IF CF-FORMS-PRINTER-ID  =  SPACES
  6231       AND  (ABILTYPI = '3'  OR  '4')
  6232         MOVE ER-2590            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL642.cbl
  6233         MOVE -1                 TO  ABILTYPL
  6234         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6235         GO TO 8200-SEND-DATAONLY.
  6236
  6237     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  6238     MOVE SPACE                  TO  DC-OPTION-CODE.
  6239
  6240     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  6241
  6242     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  6243     MOVE WS-CURRENT-DATE-EDIT   TO  HD-RUN-DT.
  6244     MOVE CF-CL-MAIL-TO-NAME     TO  CENTER-WORK-1.
  6245     MOVE +44                    TO  X-LEN.
  6246
  6247     PERFORM 8600-CENTER-DATA  THRU  8690-C-D-X.
  6248
  6249     MOVE CENTER-WORK-2          TO  HD-CO.
  6250     MOVE SPACE                  TO  PI-DATA-BILLED-SW.
  6251     MOVE 'G'                    TO  COMPENSATION-SW
  6252                                     PI-CR-TYPE.
  6253
  6254     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  6255
  6256     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  6257
  6258     MOVE +0                     TO  GX-SUB.
  6259
  6260 1005-GXRF-BILLING-PROCESS-LOOP.
  6261     ADD +1                      TO  GX-SUB.
  6262
  6263     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  6264         IF PI-ACCT-BILLED
  6265             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6266             GO TO 1200-PYAJ-BILLING-COMPLETE
  6267         ELSE
  6268             GO TO 1200-PYAJ-BILLING-COMPLETE.
  6269     IF LIMIT-BILLING
  6270         IF GX-AM-ACCOUNT (GX-SUB)  =  PI-BILLING-ACCOUNTS (1)
  6271                                   OR  PI-BILLING-ACCOUNTS (2)
  6272                                   OR  PI-BILLING-ACCOUNTS (3)
  6273             NEXT SENTENCE
  6274         ELSE
  6275             GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6276
  6277     IF FIRST-TIME
  6278         MOVE 'N'                      TO  FIRST-TIME-SW
  6279         MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER
  6280         MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING
  6281         MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE
  6282         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  6283
  6284     IF GX-AM-CARRIER (GX-SUB)  =  PI-CR-CARRIER
  6285       AND  GX-AM-GROUPING (GX-SUB)  =  PI-CR-GROUPING
  6286       AND  GX-AM-STATE (GX-SUB)  =  PI-CR-STATE
  6287       AND  GX-AM-ACCOUNT (GX-SUB)  =  PI-CR-ACCOUNT
  6288         NEXT SENTENCE
  6289     ELSE
  6290         IF PI-ACCT-BILLED
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL642.cbl
  6291             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6292             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6293             IF APRODSWI  =  'N'
  6294                 NEXT SENTENCE
  6295             ELSE
  6296                 PERFORM 3000-WRITE-BILLING-DETAIL
  6297                     THRU  3990-EXIT.
  6298
  6299     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  6300     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  6301     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  6302     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-SAV-ACCT
  6303                                       PI-CR-ACCOUNT.
  6304     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  6305                                   TO  PI-SAV-EXP-DT.
  6306
  6307     PERFORM 4300-READ-ACCOUNT-MASTER  THRU  4390-EXIT.
  6308
  6309     IF INVALID-ACCOUNT
  6310         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6311
  6312     IF PI-UPDATE-FILES
  6313         MOVE WS-GA-LEVEL        TO  GX-AM-LEVEL-NO (GX-SUB)
  6314         MOVE WS-CURRENT-DATE    TO  GX-LAST-BILL-DT (GX-SUB).
  6315
  6316     IF NEW-ACCOUNT
  6317         IF PI-ACCT-BILLED
  6318             PERFORM 1100-PYAJ-BILLING-PROCESS  THRU  1190-EXIT
  6319             MOVE 'TA'           TO  BILLING-DETAIL-TYPE
  6320             IF APRODSWI  =  'N'
  6321                 NEXT SENTENCE
  6322             ELSE
  6323                 PERFORM 3000-WRITE-BILLING-DETAIL
  6324                     THRU  3990-EXIT.
  6325
  6326     MOVE 'A'                    TO  COMPENSATION-SW
  6327                                      PI-CR-TYPE.
  6328
  6329     PERFORM 6000-READ-COMP-MASTER     THRU 6090-EXIT.
  6330     PERFORM 1100-PYAJ-BILLING-PROCESS THRU 1190-EXIT.
  6331     PERFORM 4000-PNDB-START-BROWSE    THRU 4090-EXIT.
  6332
  6333     IF PNDB-EOF
  6334         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6335
  6336 1010-PNDB-BILLING-PROCESS-LOOP.
  6337     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  6338
  6339     IF PNDB-EOF
  6340         PERFORM 4160-PNDB-END-BROWSE
  6341         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6342
  6343     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD  AND
  6344        PB-SV-CARRIER     =  PI-CR-CARRIER  AND
  6345        PB-SV-GROUPING    =  PI-CR-GROUPING AND
  6346        PB-SV-STATE       =  PI-CR-STATE    AND
  6347        PB-ACCOUNT        =  PI-CR-ACCOUNT
  6348         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL642.cbl
  6349     ELSE
  6350         PERFORM 4160-PNDB-END-BROWSE
  6351         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6352
  6353     IF PB-BATCH-TRAILER
  6354         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6355
  6356     IF PB-ALT-CHG-SEQ-NO  NOT =  ZEROS
  6357         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6358
  6359     IF PB-CERT-EFF-DT LESS GX-AM-EXPIRATION-DT (GX-SUB)
  6360         NEXT SENTENCE
  6361      ELSE
  6362         PERFORM 4160-PNDB-END-BROWSE
  6363         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6364
  6365     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  6366         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6367
  6368     IF PB-CERT-EFF-DT  GREATER THAN  ERACCT-P-EXP-DATE
  6369         PERFORM 4160-PNDB-END-BROWSE
  6370         GO TO 1005-GXRF-BILLING-PROCESS-LOOP.
  6371
  6372     IF (PB-ISSUE)
  6373       AND
  6374        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6375         PB-I-POLICY-IS-MONTHLY OR
  6376         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6377         PB-I-UNDERWRITE-POLICY)
  6378           GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6379     ELSE
  6380         IF (PB-CANCELLATION)
  6381           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6382             OR  PB-CI-AH-POLICY-IS-REISSUE
  6383             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6384             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6385             OR  PB-CI-LF-POLICY-IS-DECLINED
  6386             OR  PB-CI-AH-POLICY-IS-VOID
  6387             OR  PB-CI-LF-REIN-ONLY
  6388             OR  PB-CI-AH-REIN-ONLY)
  6389               GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6390
  6391     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6392         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6393
  6394     IF PB-RECORD-ON-HOLD
  6395         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6396         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6397
  6398     IF PB-FATAL-ERRORS
  6399       OR  PB-UNFORCED-ERRORS
  6400         PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT
  6401         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6402
  6403     MOVE 'Y'                    TO  PI-ACCT-BILLED-SW
  6404                                     PI-DATA-BILLED-SW.
  6405
  6406     PERFORM 1040-UPDATE-BILLING-STATISTICS  THRU  1049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL642.cbl
  6407
  6408     PERFORM 1030-COMPUTE-COMMISSION-TOTALS  THRU  1039-EXIT.
  6409
  6410     IF PI-BILL
  6411       OR  PI-REBILLING
  6412         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6413
  6414     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL642.cbl
  6416 1030-COMPUTE-COMMISSION-TOTALS.
  6417     IF PB-CANCELLATION
  6418         GO TO 1035-COMPUTE-CANCEL-COMM.
  6419
  6420     MOVE SPACES                 TO WS-AH-CATEGORY
  6421     IF (PI-COMPANY-ID = 'DCC')
  6422        AND (NOT PB-INVALID-AH)
  6423        MOVE SPACES              TO ELCNTL-KEY
  6424        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6425        MOVE '5'                 TO ELCNTL-REC-TYPE
  6426        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6427                                    CLAS-LOOK
  6428        MOVE +0                  TO ELCNTL-SEQ-NO
  6429        PERFORM 6130-FIND-BENEFIT-CD
  6430                                 THRU 6140-EXIT
  6431     END-IF
  6432     PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6433
  6434     IF (PB-OVERRIDE-LIFE
  6435        OR PB-OVERRIDE-BOTH)
  6436        IF NOT PB-INVALID-LIFE
  6437           COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREM-CALC +
  6438                                       PB-I-LF-ALT-PREM-CALC
  6439        END-IF
  6440     ELSE
  6441        IF NOT PB-INVALID-LIFE
  6442           COMPUTE WS-I-LF-PREMIUM-AMT = PB-I-LF-PREMIUM-AMT +
  6443                                       PB-I-LF-ALT-PREMIUM-AMT
  6444        END-IF
  6445     END-IF
  6446
  6447     IF (PB-OVERRIDE-AH
  6448        OR PB-OVERRIDE-BOTH)
  6449        MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  6450     ELSE
  6451        MOVE PB-I-AH-PREMIUM-AMT TO  WS-I-AH-PREMIUM-AMT
  6452     END-IF
  6453
  6454     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6455       OR  PI-TOT-REBILL
  6456         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM +
  6457             WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT
  6458         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6459             (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT) +
  6460              WS-ACCT-UNPAID-NET-PREM.
  6461
  6462     COMPUTE PI-PREMIUM = PI-PREMIUM +
  6463         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6464
  6465     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6466         (WS-I-LF-PREMIUM-AMT * WS-GA-LF-COM).
  6467
  6468     IF AM-COM-TYP (WS-GA-LEVEL) = 'K' OR 'I' OR 'L'
  6469        COMPUTE PI-AH-ISS-COMP = WS-GA-AH-COM * +1000
  6470     ELSE
  6471        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6472         (WS-I-AH-PREMIUM-AMT  * WS-GA-AH-COM)
  6473     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL642.cbl
  6474
  6475     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES OR SPACES)
  6476       OR  PI-TOT-REBILL
  6477         COMPUTE WS-ACCT-LF-OVERWRITE =
  6478             (PI-LF-ISS-COMP + WS-ACCT-LF-OVERWRITE)
  6479         COMPUTE WS-ACCT-AH-OVERWRITE =
  6480             (PI-AH-ISS-COMP + WS-ACCT-AH-OVERWRITE)
  6481         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM +
  6482             PI-LF-ISS-COMP + PI-AH-ISS-COMP.
  6483
  6484     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6485         (PI-LF-ISS-COMP + PI-AH-ISS-COMP).
  6486
  6487 1033-COMPUTE-ACCOUNT-COMM.
  6488
  6489     COMPUTE WS-ACCT-NET-PREM ROUNDED = WS-ACCT-NET-PREM +
  6490         (WS-I-LF-PREMIUM-AMT + WS-I-AH-PREMIUM-AMT).
  6491
  6492     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6493         GO TO 1039-EXIT.
  6494
  6495     COMPUTE WS-ACCT-COMP ROUNDED =
  6496        (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION)
  6497        + WS-ACCT-COMP
  6498
  6499     IF WS-AH-CATEGORY = 'G' OR 'L'
  6500        COMPUTE WS-ACCT-COMP ROUNDED =
  6501           (WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6502           - PB-I-ADDL-CLP) + WS-ACCT-COMP
  6503     ELSE
  6504        COMPUTE WS-ACCT-COMP ROUNDED =
  6505           (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)   +
  6506            WS-ACCT-COMP
  6507     END-IF
  6508
  6509     GO TO 1039-EXIT.
  6510
  6511 1035-COMPUTE-CANCEL-COMM.
  6512     IF PB-CI-CERT-HAS-ERCOMM-ENTRY
  6513         PERFORM 4700-PROCESS-COMM-EXCEPTION  THRU  4790-EXIT
  6514     ELSE
  6515         PERFORM 4400-FIND-COMMISSION  THRU  4490-EXIT.
  6516     MOVE SPACES                 TO WS-AH-CATEGORY
  6517     IF (PI-COMPANY-ID = 'DCC')
  6518        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6519        MOVE SPACES              TO ELCNTL-KEY
  6520        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6521        MOVE '5'                 TO ELCNTL-REC-TYPE
  6522        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6523                                    CLAS-LOOK
  6524        MOVE +0                  TO ELCNTL-SEQ-NO
  6525        PERFORM 6130-FIND-BENEFIT-CD
  6526                                 THRU 6140-EXIT
  6527     END-IF
  6528
  6529     IF PB-OVERRIDE-LIFE
  6530       OR  PB-OVERRIDE-BOTH
  6531         MOVE PB-C-LF-REF-CALC   TO  WS-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL642.cbl
  6532     ELSE
  6533         MOVE PB-C-LF-CANCEL-AMT
  6534                                 TO  WS-C-LF-CANCEL-AMT.
  6535
  6536     IF PB-OVERRIDE-AH
  6537       OR  PB-OVERRIDE-BOTH
  6538         MOVE PB-C-AH-REF-CALC   TO  WS-C-AH-CANCEL-AMT
  6539     ELSE
  6540         MOVE PB-C-AH-CANCEL-AMT
  6541                                 TO  WS-C-AH-CANCEL-AMT.
  6542
  6543     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  LOW-VALUES  OR  SPACES
  6544       OR  PI-TOT-REBILL
  6545         COMPUTE PI-UNPAID-NET-PREM = PI-UNPAID-NET-PREM -
  6546             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6547         COMPUTE WS-ACCT-UNPAID-NET-PREM =
  6548             WS-ACCT-UNPAID-NET-PREM -
  6549             (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6550
  6551     COMPUTE PI-PREMIUM = PI-PREMIUM -
  6552         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
  6553
  6554     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6555     MOVE  PB-C-LF-CANCEL-DT      TO  DC-BIN-DATE-2.
  6556     MOVE  '1'                    TO  DC-OPTION-CODE.
  6557     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6558     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-LF.
  6559
  6560     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6561         ADD  +1                  TO  MONTHS-DIFF-LF.
  6562
  6563     MOVE  PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6564     MOVE  PB-C-AH-CANCEL-DT      TO  DC-BIN-DATE-2.
  6565     MOVE  '1'                    TO  DC-OPTION-CODE.
  6566     PERFORM  8500-DATE-CONVERT  THRU  8500-EXIT.
  6567     MOVE  DC-ELAPSED-MONTHS      TO  MONTHS-DIFF-AH.
  6568
  6569     IF DC-ODD-DAYS-OVER  GREATER THAN   ZEROS
  6570         ADD  +1                  TO  MONTHS-DIFF-AH.
  6571
  6572     MOVE ZEROS                   TO  SUB.
  6573     MOVE ZEROS                   TO  PI-LF-CAN-COMP
  6574                                      PI-AH-CAN-COMP.
  6575
  6576 1036-COMPUTE-GA-LOOP.
  6577
  6578     ADD  +1                      TO  SUB.
  6579
  6580     IF SUB > +10
  6581         MOVE  ZEROS              TO  SUB
  6582         GO TO  1037-CONTINUE.
  6583
  6584     IF AM-AGT (SUB)   NOT  EQUAL  PI-SAV-AGENT
  6585         GO TO  1036-COMPUTE-GA-LOOP.
  6586
  6587     IF AM-COM-TYP (SUB) = 'O' OR 'P' OR 'G' OR 'B' OR 'K' OR 'S'
  6588         NEXT SENTENCE
  6589     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL642.cbl
  6590         GO TO  1036-COMPUTE-GA-LOOP.
  6591
  6592     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6593         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6594
  6595     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6596         MOVE  ZEROS           TO  PI-LF-CAN-COMP
  6597         GO TO 1037-CHECK-AH-COMM.
  6598
  6599     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6600                              AND
  6601        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6602         MOVE  ZEROS               TO  PI-LF-CAN-COMP
  6603     ELSE
  6604         COMPUTE PI-LF-CAN-COMP ROUNDED = PI-LF-CAN-COMP +
  6605             (WS-C-LF-CANCEL-AMT * WS-GA-LF-COM).
  6606
  6607 1037-CHECK-AH-COMM.
  6608
  6609     IF AM-COMM-CHARGEBACK (SUB)    EQUAL   '99'
  6610         MOVE  ZEROS           TO  PI-AH-CAN-COMP
  6611         GO TO 1036-COMPUTE-GA-LOOP.
  6612
  6613     IF (MONTHS-DIFF-AH GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6614                              AND
  6615        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6616         MOVE  ZEROS               TO  PI-AH-CAN-COMP
  6617     ELSE
  6618        IF (AM-COM-TYP (SUB) = 'K')
  6619           AND (WS-C-AH-CANCEL-AMT > ZEROS)
  6620           COMPUTE PI-AH-CAN-COMP ROUNDED =
  6621              PI-AH-CAN-COMP + (WS-GA-AH-COM * +1000)
  6622        ELSE
  6623           COMPUTE PI-AH-CAN-COMP ROUNDED =  PI-AH-CAN-COMP +
  6624             (WS-C-AH-CANCEL-AMT  * WS-GA-AH-COM)
  6625        END-IF
  6626     END-IF
  6627
  6628     GO TO 1036-COMPUTE-GA-LOOP.
  6629
  6630 1037-CONTINUE.
  6631
  6632     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  6633       OR  PI-TOT-REBILL
  6634         COMPUTE WS-ACCT-LF-OVERWRITE =
  6635             (WS-ACCT-LF-OVERWRITE - PI-LF-CAN-COMP)
  6636         COMPUTE WS-ACCT-AH-OVERWRITE =
  6637             (WS-ACCT-AH-OVERWRITE - PI-AH-CAN-COMP)
  6638         COMPUTE PI-COMP-UNPAID-PREM = PI-COMP-UNPAID-PREM -
  6639             PI-LF-CAN-COMP - PI-AH-CAN-COMP.
  6640
  6641     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6642         (PI-LF-CAN-COMP + PI-AH-CAN-COMP).
  6643
  6644 1038-COMPUTE-ACCOUNT-COMM.
  6645
  6646     COMPUTE WS-ACCT-NET-PREM = WS-ACCT-NET-PREM -
  6647         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL642.cbl
  6648
  6649     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  6650         GO TO 1039-EXIT.
  6651
  6652     MOVE ZEROS                   TO  SUB.
  6653
  6654 103X-ACCOUNT-LOOP.
  6655
  6656     ADD  +1                      TO  SUB.
  6657
  6658     IF SUB > +10
  6659         MOVE  ZEROS              TO  SUB
  6660         GO TO  1039-EXIT.
  6661
  6662     IF AM-COM-TYP (SUB) = 'C' OR 'D' OR 'F'
  6663         NEXT SENTENCE
  6664     ELSE
  6665         GO TO  103X-ACCOUNT-LOOP.
  6666
  6667     IF AM-COMM-CHARGEBACK (SUB)    NOT NUMERIC
  6668         MOVE  ZEROS               TO  AM-COMM-CHARGEBACK (SUB).
  6669
  6670     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6671         MOVE  ZEROS          TO  WS-C-LF-CANCEL-AMT
  6672         GO TO 103X-CHECK-AH-COMM.
  6673
  6674     IF (MONTHS-DIFF-LF  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6675                              AND
  6676        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6677         MOVE  ZEROS              TO  WS-C-LF-CANCEL-AMT.
  6678
  6679 103X-CHECK-AH-COMM.
  6680
  6681     IF AM-COMM-CHARGEBACK (SUB)   EQUAL   '99'
  6682         MOVE  ZEROS          TO  WS-C-AH-CANCEL-AMT
  6683         GO TO 103X-COMPUTE-ACCT-TOT.
  6684
  6685     IF (MONTHS-DIFF-AH  GREATER THAN  AM-COMM-CHARGEBACK (SUB))
  6686                              AND
  6687        (AM-COMM-CHARGEBACK (SUB)  NOT  EQUAL   ZEROS)
  6688         MOVE  ZEROS              TO  WS-C-AH-CANCEL-AMT.
  6689
  6690 103X-COMPUTE-ACCT-TOT.
  6691     COMPUTE WS-ACCT-COMP   ROUNDED  =  WS-ACCT-COMP  -
  6692         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6693*        + (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6694     IF WS-AH-CATEGORY = 'G' OR 'L'
  6695        COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6696           PB-CI-AH-PREMIUM-AMT
  6697           COMPUTE WS-AH-ACCT-COMP ROUNDED =
  6698           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6699           PB-CI-LF-ALT-PREMIUM-AMT
  6700           - PB-CI-ADDL-CLP))
  6701     ELSE
  6702        COMPUTE WS-AH-ACCT-COMP  ROUNDED =
  6703           (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6704     END-IF
  6705     COMPUTE WS-ACCT-COMP =  WS-ACCT-COMP  - WS-AH-ACCT-COMP
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL642.cbl
  6706
  6707     GO TO 103X-ACCOUNT-LOOP.
  6708
  6709 1039-EXIT.
  6710     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL642.cbl
  6712 1040-UPDATE-BILLING-STATISTICS.
  6713     IF PB-ISSUE
  6714         IF PB-FATAL-ERRORS
  6715           OR  PB-UNFORCED-ERRORS
  6716           OR  PB-RECORD-ON-HOLD
  6717             ADD +1              TO  PI-ISSUES-INER
  6718             GO TO 1049-EXIT.
  6719
  6720     IF PB-CANCELLATION
  6721         IF PB-FATAL-ERRORS
  6722           OR  PB-UNFORCED-ERRORS
  6723           OR  PB-RECORD-ON-HOLD
  6724             ADD +1              TO  PI-CANCELS-INER
  6725             GO TO 1049-EXIT.
  6726
  6727     IF PB-ISSUE
  6728         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6729                (LOW-VALUES OR SPACES)
  6730           OR  PI-TOT-REBILL
  6731             ADD +1              TO  PI-ISSUES-BILLED
  6732             GO TO 1049-EXIT.
  6733
  6734     IF PB-CANCELLATION
  6735         IF PB-GA-BILL-DT (WS-GA-LEVEL)  =
  6736                (LOW-VALUES OR SPACES)
  6737           OR  PI-TOT-REBILL
  6738             ADD +1              TO  PI-CANCELS-BILLED
  6739             GO TO 1049-EXIT.
  6740
  6741     IF PB-ISSUE
  6742         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6743           AND  SPACES
  6744             ADD +1              TO  PI-ISSUES-PREV
  6745             GO TO 1049-EXIT.
  6746
  6747     IF PB-CANCELLATION
  6748         IF PB-GA-BILL-DT (WS-GA-LEVEL)  NOT =  LOW-VALUES
  6749           AND  SPACES
  6750             ADD +1              TO  PI-CANCELS-PREV
  6751             GO TO 1049-EXIT.
  6752
  6753     ADD +1                      TO  PI-UNKNOWN.
  6754
  6755 1049-EXIT.
  6756     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL642.cbl
  6758 1100-PYAJ-BILLING-PROCESS.
  6759******************************************************************
  6760*   PROCESS THE ACCOUNTS PAYMENTS AND ADUSTMENTS. IF THE GENERAL *
  6761*   AGENT IS NOT FINANCIALLY RESPONSIBLE FOR THE ACCOUNT DO NOT  *
  6762*   PROCESS THE ACCOUNT'S PAYMENTS AND ADJUSTMENTS.              *
  6763*                                                                *
  6764*   1.  PROCESS THE ACCOUNT'S PAYMENTS AND ADUSTMENTS.           *
  6765*                                                                *
  6766*   2.  IF THE GENERAL AGENT IS NOT FINANCIALLY RESPONSIBLE FOR  *
  6767*       THE ACCOUNT, DO NOT PROCESS THE ACCOUNT'S PAYMENTS AND   *
  6768*       ADJUSTMENTS.                                             *
  6769*                                                                *
  6770*   3.  IF PRINTED BILL IS NOT PRODUCED, DO NOT PROCESS THE      *
  6771*       ACCOUNT'S PAYMENTS AND ADJUSTMENTS.                      *
  6772******************************************************************
  6773
  6774     IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  6775         NEXT SENTENCE
  6776     ELSE
  6777         GO TO 1190-EXIT.
  6778
  6779     IF PI-UPDATE-FILES
  6780       OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6781         NEXT SENTENCE
  6782     ELSE
  6783         GO TO 1190-EXIT.
  6784
  6785 1105-PYAJ-BILLING-STARTBR-LOOP.
  6786     MOVE 'A'                    TO  COMPENSATION-SW.
  6787
  6788     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6789
  6790     IF PYAJ-EOF
  6791         GO TO 1190-EXIT.
  6792
  6793 1110-PYAJ-BILLING-READ-LOOP.
  6794     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6795
  6796     IF PYAJ-EOF
  6797         PERFORM 4800-PYAJ-END-BROWSE
  6798         GO TO 1190-EXIT.
  6799
  6800     IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6801       AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6802       AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6803       AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6804       AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6805         NEXT SENTENCE
  6806     ELSE
  6807         PERFORM 4800-PYAJ-END-BROWSE
  6808         GO TO 1190-EXIT.
  6809
  6810     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6811         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6812
  6813     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6814                              OR 'Z'
  6815         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL642.cbl
  6816     ELSE
  6817         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6818
  6819     IF PY-VOID-SW  NOT =  SPACES
  6820         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6821
  6822     IF PI-AR-PROCESSING
  6823        IF PY-AR-DATE  =  LOW-VALUES
  6824           NEXT SENTENCE
  6825        ELSE
  6826           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6827     ELSE
  6828        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6829            PY-AR-DATE = LOW-VALUES)
  6830           NEXT SENTENCE
  6831        ELSE
  6832           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6833
  6834     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6835        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6836        PY-ADD-TO-BALANCE
  6837         ADD PY-ENTRY-AMT        TO  WS-ACCT-PAY-ADJS
  6838     ELSE
  6839         SUBTRACT PY-ENTRY-AMT   FROM  WS-ACCT-PAY-ADJS.
  6840
  6841     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6842
  6843 1190-EXIT.
  6844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL642.cbl
  6846 1200-PYAJ-BILLING-COMPLETE.
  6847******************************************************************
  6848*      1. IF PRINTED BILL IS PRODUCED PRINT THE GENERAL AGENT'S  *
  6849*         TOTALS.                                                *
  6850*                                                                *
  6851*      2. PROCESS THE GENERAL AGENT'S PAYMENTS AND ADJUSTMENTS.  *
  6852******************************************************************
  6853
  6854     IF PI-DATA-BILLED
  6855         NEXT SENTENCE
  6856     ELSE
  6857         MOVE ER-2913            TO  EMI-ERROR
  6858         MOVE -1                 TO  AACCT1L
  6859         MOVE AL-UABON           TO  AACCT1A
  6860         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6861
  6862     IF RETURNED-FROM  =  SPACES
  6863         IF PI-UPDATE-FILES
  6864           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6865             IF PI-ACCT-BILLED
  6866                 MOVE 'TB'       TO  BILLING-DETAIL-TYPE
  6867                 PERFORM 3000-WRITE-BILLING-DETAIL
  6868                         THRU  3990-EXIT
  6869             ELSE
  6870                 MOVE 'TS'       TO  BILLING-DETAIL-TYPE
  6871                 PERFORM 3000-WRITE-BILLING-DETAIL
  6872                         THRU  3990-EXIT.
  6873
  6874 1205-PYAJ-BILLING-STARTBR-LOOP.
  6875     MOVE PI-SAV-AGENT           TO  PI-SAV-FIN-RESP.
  6876     MOVE 'G'                    TO  COMPENSATION-SW.
  6877
  6878     PERFORM 4500-PYAJ-START-BROWSE  THRU  4590-EXIT.
  6879
  6880     IF PYAJ-EOF
  6881         GO TO 1260-BILLING-COMPLETE.
  6882
  6883 1210-PYAJ-BILLING-READ-LOOP.
  6884     PERFORM 4600-PYAJ-READ-NEXT  THRU  4690-EXIT.
  6885
  6886     IF PYAJ-EOF
  6887         GO TO 1250-END-AGENTS-PAY-ADJS.
  6888
  6889     IF NOT PI-AR-PROCESSING
  6890         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6891           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6892           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6893           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6894           AND  PY-ACCOUNT  =  ERPYAJ-BR-ACCOUNT
  6895             GO TO 1230-CHECK-PYAJ-ENTRY
  6896         ELSE
  6897             GO TO 1250-END-AGENTS-PAY-ADJS
  6898     ELSE
  6899         IF PY-COMPANY-CD  =  ERPYAJ-BR-COMP-CD
  6900           AND  PY-CARRIER  =  ERPYAJ-BR-CARRIER
  6901           AND  PY-GROUPING  =  ERPYAJ-BR-GROUPING
  6902           AND  PY-FIN-RESP  =  ERPYAJ-BR-FIN-RESP
  6903             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL642.cbl
  6904         ELSE
  6905             GO TO 1250-END-AGENTS-PAY-ADJS.
  6906
  6907      IF PY-PMT-APPLIED = 'O' OR
  6908         PY-ACCOUNT = LOW-VALUES
  6909          NEXT SENTENCE
  6910      ELSE
  6911          GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6912
  6913 1230-CHECK-PYAJ-ENTRY.
  6914
  6915     IF PY-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  6916         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6917
  6918     IF PY-RECORD-TYPE  = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6919                              OR 'Z'
  6920         NEXT SENTENCE
  6921     ELSE
  6922         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6923
  6924     IF PY-VOID-SW  NOT =  SPACES
  6925         GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6926
  6927     IF PI-AR-PROCESSING
  6928        IF PY-AR-DATE  =  LOW-VALUES
  6929           OR  PI-TOT-REBILL
  6930           OR  RETURNED-FROM  =  XCTL-PYAJ
  6931               NEXT SENTENCE
  6932        ELSE
  6933           GO TO 1210-PYAJ-BILLING-READ-LOOP
  6934     ELSE
  6935        IF (PY-BILLED-DATE  =  LOW-VALUES AND
  6936            PY-AR-DATE = LOW-VALUES)
  6937           OR  PI-TOT-REBILL
  6938           OR  RETURNED-FROM  =  XCTL-PYAJ
  6939           NEXT SENTENCE
  6940        ELSE
  6941           GO TO 1210-PYAJ-BILLING-READ-LOOP.
  6942
  6943     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6944        PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6945        PY-ADD-TO-BALANCE
  6946         ADD PY-ENTRY-AMT        TO  PI-REMITTED
  6947     ELSE
  6948         IF PY-CHARGE-TO-AGENT
  6949           OR  PY-ADJ-CHG-TO-AGT
  6950             IF PY-GA-CHECK
  6951                 ADD PY-ENTRY-AMT  TO  PI-DISBURSED
  6952             ELSE
  6953                 ADD PY-ENTRY-AMT  TO  PI-ADJUSTMNTS.
  6954
  6955     IF RETURNED-FROM  =  SPACES
  6956         IF PI-UPDATE-FILES
  6957           OR  (PI-PREVIEW  AND  APRODSWI = 'Y')
  6958             MOVE 'BP'           TO  BILLING-DETAIL-TYPE
  6959             PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  6960
  6961     GO TO 1210-PYAJ-BILLING-READ-LOOP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL642.cbl
  6962
  6963 1250-END-AGENTS-PAY-ADJS.
  6964     PERFORM 4800-PYAJ-END-BROWSE.
  6965
  6966     IF PI-DATA-BILLED
  6967         NEXT SENTENCE
  6968     ELSE
  6969         MOVE ER-2913            TO  EMI-ERROR
  6970         MOVE -1                 TO  AACCT1L
  6971         MOVE AL-UABON           TO  AACCT1A
  6972         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6973
  6974 1260-BILLING-COMPLETE.
  6975     IF WS-UPDATE-FILES
  6976         PERFORM 6500-REWRITE-CROSS-REFERENCE.
  6977
  6978     IF EMI-NO-ERRORS
  6979         MOVE 0000               TO  EMI-ERROR
  6980         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6981
  6982     MOVE -1                     TO  AAGENTL.
  6983
  6984     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
  6985
  6986     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL642.cbl
  6988 2000-VOID-BILLING.
  6989******************************************************************
  6990*     THIS SECTION WILL RESET THE GA-BILLING-FLAGS IN THE        *
  6991*     PENDING BUSINESS RECORDS AND RESET THE LAST BILLED         *
  6992*     DATE IN THE GENERAL AGENT'S CROSS-REFERENCE-FILE TO        *
  6993*     LOW-VALUES.                                                *
  6994******************************************************************
  6995
  6996     MOVE SPACES                 TO  ELCNTL-KEY.
  6997     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  6998
  6999     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  7000
  7001     IF EMI-ERROR  NOT =  ZEROS
  7002         GO TO 8200-SEND-DATAONLY.
  7003
  7004     MOVE CF-CURRENT-MONTH-END   TO  DC-BIN-DATE-1.
  7005     MOVE SPACE                  TO  DC-OPTION-CODE.
  7006
  7007     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  7008
  7009     MOVE DC-GREG-DATE-1-EDIT    TO  PI-MONTH-END-DATE.
  7010
  7011     PERFORM 6400-READ-CROSS-REFERENCE  THRU  6490-EXIT.
  7012
  7013     MOVE +0                     TO  GX-SUB.
  7014
  7015 2005-GXRF-BILLING-PROCESS-LOOP.
  7016     ADD +1                      TO  GX-SUB.
  7017
  7018     IF GX-SUB  GREATER THAN  GX-AGENT-POINTER-CNT
  7019         GO TO 2100-VOID-PNDB-COMPLETE.
  7020
  7021     MOVE GX-AM-CARRIER (GX-SUB)   TO  PI-CR-CARRIER.
  7022     MOVE GX-AM-GROUPING (GX-SUB)  TO  PI-CR-GROUPING.
  7023     MOVE GX-AM-STATE (GX-SUB)     TO  PI-CR-STATE.
  7024     MOVE GX-AM-ACCOUNT (GX-SUB)   TO  PI-CR-ACCOUNT.
  7025     MOVE GX-AGENT-NO              TO  PI-SAV-AGENT.
  7026     MOVE GX-AM-EXPIRATION-DT (GX-SUB)
  7027                                   TO  PI-SAV-EXP-DT.
  7028     MOVE GX-AM-LEVEL-NO (GX-SUB)  TO  WS-GA-LEVEL.
  7029     MOVE LOW-VALUES               TO  GX-LAST-BILL-DT (GX-SUB).
  7030
  7031     PERFORM 4000-PNDB-START-BROWSE  THRU  4090-EXIT.
  7032
  7033     IF PNDB-EOF
  7034         PERFORM 4160-PNDB-END-BROWSE
  7035         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7036
  7037 2010-VOID-PNDB-LOOP.
  7038     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  7039
  7040     IF PNDB-EOF
  7041         PERFORM 4160-PNDB-END-BROWSE
  7042         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7043
  7044     IF PB-COMPANY-CD-A1  =  PI-COMPANY-CD
  7045       AND  PB-SV-CARRIER  =  PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL642.cbl
  7046       AND  PB-SV-GROUPING  =  PI-CR-GROUPING
  7047       AND  PB-SV-STATE  =  PI-CR-STATE
  7048       AND  PB-ACCOUNT  =  PI-CR-ACCOUNT
  7049         NEXT SENTENCE
  7050     ELSE
  7051         PERFORM 4160-PNDB-END-BROWSE
  7052         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7053
  7054     IF PB-CREDIT-ACCEPT-DT  NOT =  LOW-VALUES
  7055         GO TO 2010-VOID-PNDB-LOOP.
  7056
  7057     IF PB-GA-BILL-DT (WS-GA-LEVEL)  =  (LOW-VALUES  OR  SPACES)
  7058         GO TO 2010-VOID-PNDB-LOOP.
  7059
  7060     IF PB-CERT-EFF-DT  =  GX-AM-EXPIRATION-DT (GX-SUB)
  7061       OR  PB-CERT-EFF-DT  GREATER THAN
  7062               GX-AM-EXPIRATION-DT (GX-SUB)
  7063         PERFORM 4160-PNDB-END-BROWSE
  7064         GO TO 2005-GXRF-BILLING-PROCESS-LOOP.
  7065
  7066     IF PB-CERT-EFF-DT  LESS THAN  GX-AM-EFF-DT (GX-SUB)
  7067         GO TO 2010-VOID-PNDB-LOOP.
  7068
  7069     IF PB-BATCH-TRAILER
  7070         GO TO 2010-VOID-PNDB-LOOP.
  7071
  7072     PERFORM 4200-PNDB-REWRITE  THRU  4290-EXIT.
  7073
  7074     MOVE 'Y'                    TO  DATA-VOIDED-SW.
  7075
  7076     GO TO 2010-VOID-PNDB-LOOP.
  7077
  7078 2100-VOID-PNDB-COMPLETE.
  7079     IF DATA-VOIDED
  7080         NEXT SENTENCE
  7081     ELSE
  7082         MOVE -1                 TO  APFNTERL
  7083         MOVE ER-2401            TO  EMI-ERROR
  7084         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7085         GO TO 8100-SEND-INITIAL-MAP.
  7086
  7087     PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT.
  7088
  7089     PERFORM 6500-REWRITE-CROSS-REFERENCE  THRU  6590-EXIT.
  7090
  7091 2105-VOID-COMPLETE.
  7092     MOVE 0000                   TO  EMI-ERROR
  7093
  7094     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7095
  7096     MOVE -1                     TO  AAGENTL.
  7097
  7098     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL642.cbl
  7100 3000-WRITE-BILLING-DETAIL.
  7101******************************************************************
  7102*     THIS SECTION FORMATS THE BILLING PRINT RECORDS.  THESE     *
  7103*     RECORDS ARE CREATED IN THE SAME FORMAT THAT THEY APPEAR    *
  7104*     WHEN PRINTED.                                              *
  7105*                                                                *
  7106*     THIS SECTION PRINTS THE BILLING STATEMENT AND PRINT LABELS.*
  7107*     BILLING-DETAIL-TYPES                                       *
  7108*            TOTAL-STATEMENT   TS                                *
  7109*            TOTAL-ACCOUNT     TA                                *
  7110*            TOTAL-BOTH        TB                                *
  7111*            GAN-AGT-ADDRESS   GA                                *
  7112*                              BP                                *
  7113******************************************************************
  7114
  7115     IF GEN-AGT-ADDRESS
  7116         PERFORM 3930-BILL-READ  THRU  3930-EXIT
  7117         IF NO-BILL-RECS
  7118             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7119         ELSE
  7120             IF BI-PREVIEW-ONLY
  7121               OR  BI-INITIAL-PRINT-DATE  NOT =  LOW-VALUES
  7122               OR  PI-TOT-REBILL
  7123                 PERFORM 3940-BILL-GENERIC-DELETE
  7124                     THRU  3940-EXIT
  7125                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7126             ELSE
  7127                 MOVE ER-2403    TO  EMI-ERROR
  7128                 MOVE -1         TO  ABILTYPL
  7129                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7130                 GO TO 8200-SEND-DATAONLY.
  7131
  7132 3100-FORMAT-DETAIL-LINES.
  7133     IF WS-LINECTR  GREATER THAN  23
  7134         MOVE ZEROS              TO  WS-LINECTR
  7135         MOVE '3'                TO  BI-RECORD-TYPE
  7136         MOVE TRIPLE-SPACE       TO  BI-SKIP-CONTROL
  7137         MOVE '          CONTINUED ON NEXT PAGE'
  7138                                 TO  BI-TEXT-LINE
  7139         PERFORM 3920-BILL-WRITE
  7140         PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7141
  7142     IF WS-LINECTR  =  ZEROS
  7143         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7144     ELSE
  7145         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7146
  7147     MOVE '3'                    TO  BI-RECORD-TYPE.
  7148     MOVE SPACES                 TO  GA-TEXT-LINE.
  7149
  7150     IF TOTAL-STATEMENT
  7151         GO TO 3175-CHECK-AGENT-TOTAL.
  7152
  7153     IF BILLING-DETAIL-TYPE  =  'BP'
  7154        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7155            MOVE PY-ENTRY-COMMENT
  7156                                 TO  GA-ENTRY-DESC
  7157            MULTIPLY PY-ENTRY-AMT  BY  -1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL642.cbl
  7158                GIVING  GA-PMTS-ADJS
  7159            MOVE PY-ENTRY-COMMENT
  7160                                 TO  GA-ENTRY-DESC
  7161            MOVE '* ACCOUNTING ENTRY *'
  7162                                 TO  GA-ENTRY-COMMENT
  7163            ADD +1               TO  WS-LINECTR
  7164            IF PY-ACCOUNT = LOW-VALUES
  7165                MOVE SPACES      TO  GA-ACCT
  7166                PERFORM 3920-BILL-WRITE
  7167                GO TO 3990-EXIT
  7168            ELSE
  7169                MOVE PY-ACCOUNT  TO  GA-ACCT
  7170                PERFORM 3920-BILL-WRITE
  7171                GO TO 3990-EXIT.
  7172
  7173     IF BILLING-DETAIL-TYPE  =  'BP'
  7174         MOVE PY-ENTRY-COMMENT   TO  GA-ENTRY-DESC
  7175         MOVE PY-ENTRY-AMT       TO  GA-PMTS-ADJS
  7176         MOVE '* ACCOUNTING ENTRY *'
  7177                                 TO  GA-ENTRY-COMMENT
  7178         MOVE PY-ACCOUNT         TO  GA-ACCT
  7179         ADD +1                  TO  WS-LINECTR
  7180            IF PY-ACCOUNT = LOW-VALUES
  7181                MOVE SPACES      TO  GA-ACCT
  7182                PERFORM 3920-BILL-WRITE
  7183                GO TO 3990-EXIT
  7184            ELSE
  7185                MOVE PY-ACCOUNT  TO  GA-ACCT
  7186                PERFORM 3920-BILL-WRITE
  7187                GO TO 3990-EXIT.
  7188
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL642.cbl
  7190 3150-FORMAT-ACCOUNT-LINE.
  7191     MOVE SPACES                 TO  GA-TEXT-LINE.
  7192     MOVE PI-SAV-ACCT-AGT        TO  GA-ACCT.
  7193     MOVE PI-SAV-ACCT-NAME       TO  GA-ACCT-NAME.
  7194     MOVE WS-ACCT-BEG-BAL        TO  GA-BEG-BAL
  7195                                     GA-BEG-BAL-AMT.
  7196     MOVE WS-ACCT-NET-PREM       TO  GA-NET-PREM
  7197                                     GA-NET-PREM-AMT.
  7198     MOVE WS-ACCT-COMP           TO  GA-ACCT-COMP
  7199                                     GA-ACCT-COMP-AMT.
  7200     MOVE WS-ACCT-PAY-ADJS       TO  GA-PMTS-ADJS
  7201                                     GA-PMTS-ADJS-AMT.
  7202
  7203     IF PI-SAV-AGENT  NOT =  PI-SAV-REMIT-TO
  7204         MOVE ZEROS              TO  GA-END-BAL-AMT
  7205     ELSE
  7206         COMPUTE GA-END-BAL-AMT =
  7207             (WS-ACCT-BEG-BAL + WS-ACCT-NET-PREM) -
  7208              (WS-ACCT-COMP + WS-ACCT-PAY-ADJS).
  7209
  7210     MOVE WS-ACCT-UNPAID-NET-PREM
  7211                                 TO  GA-UNPAID-NET-PREM
  7212                                     GA-UNPAID-NET-AMT.
  7213     MOVE ZEROS                  TO  GA-OVERWRITE-AMT.
  7214
  7215     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
  7216         MOVE PI-LIFE-OVERRIDE-L6
  7217                                 TO  GA-BEN-OVERRIDE-L6
  7218         MOVE PI-LIFE-OVERRIDE-L2
  7219                                 TO  GA-BENEFIT-CD
  7220         MOVE WS-ACCT-LF-OVERWRITE
  7221                                 TO  GA-OVERWRITE
  7222                                     GA-OVERWRITE-AMT
  7223     ELSE
  7224         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7225             MOVE PI-AH-OVERRIDE-L6
  7226                                 TO  GA-BEN-OVERRIDE-L6
  7227             MOVE PI-AH-OVERRIDE-L2
  7228                                 TO  GA-BENEFIT-CD
  7229             MOVE WS-ACCT-AH-OVERWRITE
  7230                                 TO  GA-OVERWRITE
  7231                                     GA-OVERWRITE-AMT.
  7232
  7233     COMPUTE GA-AMT-DUE-AMT = GA-END-BAL-AMT -
  7234         (WS-ACCT-LF-OVERWRITE + WS-ACCT-AH-OVERWRITE).
  7235
  7236     ADD  GA-AMT-DUE-AMT         TO  WS-GA-AMT-DUE.
  7237
  7238     MOVE GA-AMT-DUE-AMT         TO  GA-AMT-DUE.
  7239
  7240     ADD +1                      TO  WS-LINECTR.
  7241
  7242     PERFORM 3920-BILL-WRITE.
  7243
  7244     MOVE SPACES                 TO  GA-TEXT-LINE.
  7245     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7246
  7247     IF WS-ACCT-LF-OVERWRITE  NOT =  ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL642.cbl
  7248         IF WS-ACCT-AH-OVERWRITE  NOT =  ZEROS
  7249             MOVE PI-AH-OVERRIDE-L6
  7250                                 TO  GA-BEN-OVERRIDE-L6
  7251             MOVE PI-AH-OVERRIDE-L2
  7252                                 TO  GA-BENEFIT-CD
  7253             MOVE WS-ACCT-AH-OVERWRITE
  7254                                 TO  GA-OVERWRITE
  7255                                     GA-OVERWRITE-AMT
  7256             MOVE ZEROS          TO  GA-BEG-BAL-AMT
  7257                                     GA-END-BAL-AMT
  7258                                     GA-NET-PREM-AMT
  7259                                     GA-ACCT-COMP-AMT
  7260                                     GA-PMTS-ADJS-AMT
  7261                                     GA-UNPAID-NET-AMT
  7262                                     GA-AMT-DUE-AMT
  7263             ADD +1              TO  WS-LINECTR
  7264             PERFORM 3920-BILL-WRITE.
  7265
  7266     ADD WS-ACCT-BEG-BAL         TO  WS-GA-BEG-BAL
  7267                                     PI-ACCT-BEG-BAL.
  7268     ADD WS-ACCT-NET-PREM        TO  WS-GA-NET-PREM
  7269                                     PI-ACCT-NET-PREM.
  7270     ADD WS-ACCT-COMP            TO  WS-GA-COMP
  7271                                     PI-ACCT-COMP.
  7272     ADD WS-ACCT-PAY-ADJS        TO  WS-GA-PAY-ADJS
  7273                                     PI-ACCT-PAY-ADJS.
  7274     ADD WS-ACCT-UNPAID-NET-PREM
  7275                                 TO  WS-GA-UNPAID-NET-PREM.
  7276     ADD WS-ACCT-LF-OVERWRITE    TO  WS-GA-LF-OVERWRITE.
  7277     ADD WS-ACCT-AH-OVERWRITE    TO  WS-GA-AH-OVERWRITE.
  7278     ADD GA-END-BAL-AMT          TO  WS-GA-END-BAL.
  7279
  7280     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL
  7281                                     WS-ACCT-NET-PREM
  7282                                     WS-ACCT-COMP
  7283                                     WS-ACCT-PAY-ADJS
  7284                                     WS-ACCT-UNPAID-NET-PREM
  7285                                     WS-ACCT-LF-OVERWRITE
  7286                                     WS-ACCT-AH-OVERWRITE.
  7287     MOVE SPACE                  TO  PI-ACCT-BILLED-SW.
  7288     MOVE SPACE                  TO  ACCOUNT-CARRY-BAL-SW.
  7289
  7290     IF TOTAL-STATEMENT
  7291         GO TO 3400-FORMAT-TOTAL-LINE.
  7292
  7293 3175-CHECK-AGENT-TOTAL.
  7294
  7295     IF TOTAL-STATEMENT OR
  7296        TOTAL-BOTH
  7297         GO TO 3400-FORMAT-TOTAL-LINE.
  7298
  7299     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL642.cbl
  7301 3200-FORMAT-HDR-ADDR-RECS.
  7302     PERFORM 3910-BILL-GETMAIN.
  7303
  7304     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7305
  7306     SET A-INDX                  TO  1.
  7307
  7308     PERFORM 3210-FORMAT-ADDR-RECS  THRU  3210-EXIT  6  TIMES.
  7309
  7310     MOVE ZEROS                  TO  WS-LINE-SEQ-NO.
  7311
  7312     PERFORM 3300-FORMAT-HEADINGS  THRU  3380-EXIT.
  7313
  7314     PERFORM 3220-WRITE-AGENTS-BAL  THRU  3220-EXIT.
  7315
  7316     GO TO 3990-EXIT.
  7317
  7318 3210-FORMAT-ADDR-RECS.
  7319     MOVE '2'                    TO  BI-RECORD-TYPE.
  7320     MOVE SPACES                 TO  GA-TEXT-LINE.
  7321     MOVE WS-AGENT-LINES (A-INDX)
  7322                                 TO  GA-ACCT-ADDRESS-LINE.
  7323
  7324     PERFORM 3920-BILL-WRITE.
  7325
  7326     SET A-INDX                  UP  BY  1.
  7327
  7328 3210-EXIT.
  7329     EXIT.
  7330
  7331 3220-WRITE-AGENTS-BAL.
  7332     MOVE SPACES                 TO GA-TEXT-LINE.
  7333     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7334
  7335     PERFORM 3920-BILL-WRITE.
  7336
  7337     MOVE 'BEGINNING BALANCE'    TO  GA-ACCT-NAME
  7338     MOVE PI-BAL-FRWD            TO  GA-BEG-BAL.
  7339     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7340
  7341     PERFORM 3920-BILL-WRITE.
  7342
  7343     MOVE SPACES                 TO  GA-TEXT-LINE.
  7344     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7345
  7346     PERFORM 3920-BILL-WRITE.
  7347
  7348 3220-EXIT.
  7349     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL642.cbl
  7351 3300-FORMAT-HEADINGS.
  7352     MOVE WS-PGECTR              TO  HD-PG.
  7353
  7354     ADD +1                      TO  WS-PGECTR.
  7355
  7356     MOVE '3'                    TO  BI-RECORD-TYPE.
  7357     MOVE TOP-OF-PAGE            TO  BI-SKIP-CONTROL.
  7358
  7359     IF NOT PI-PREVIEW
  7360         MOVE GA-HD1             TO  GA-TEXT-LINE
  7361     ELSE
  7362         MOVE GA-PREVIEW-HD      TO  GA-TEXT-LINE
  7363         PERFORM 3920-BILL-WRITE
  7364         MOVE '3'                TO  BI-RECORD-TYPE
  7365         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7366         MOVE GA-HD1             TO  GA-TEXT-LINE.
  7367
  7368     PERFORM 3920-BILL-WRITE.
  7369
  7370     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7371     MOVE GA-HD2                 TO  GA-TEXT-LINE.
  7372
  7373     PERFORM 3920-BILL-WRITE.
  7374
  7375     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7376     MOVE GA-HD3                 TO  GA-TEXT-LINE.
  7377
  7378     PERFORM 3920-BILL-WRITE.
  7379
  7380     SET A-INDX                  TO  1.
  7381
  7382     PERFORM 3390-FORMAT-ADDR-TEXT-LINES  THRU  3390-EXIT
  7383         6  TIMES.
  7384
  7385     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7386     MOVE GA-HD4                 TO  GA-TEXT-LINE.
  7387
  7388     PERFORM 3920-BILL-WRITE.
  7389
  7390     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7391     MOVE GA-HD5                 TO  GA-TEXT-LINE.
  7392
  7393     PERFORM 3920-BILL-WRITE.
  7394
  7395 3380-EXIT.
  7396     EXIT.
  7397
  7398 3390-FORMAT-ADDR-TEXT-LINES.
  7399     MOVE '3'                    TO  BI-RECORD-TYPE.
  7400     MOVE SPACES                 TO  GA-TEXT-LINE.
  7401
  7402     IF A-INDX  =  1
  7403         MOVE DOUBLE-SPACE       TO  BI-SKIP-CONTROL
  7404         MOVE PI-SAV-CARR        TO  GA-CARRIER
  7405         MOVE PI-SAV-GROUP       TO  GA-GROUPING
  7406         MOVE PI-SAV-AGENT       TO  GA-AGENT
  7407         MOVE '-'                TO  GA-DASH
  7408     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL642.cbl
  7409         MOVE SINGLE-SPACE       TO  BI-SKIP-CONTROL.
  7410
  7411     MOVE WS-AGENT-LINES (A-INDX)  TO  GA-AGENT-ADDR.
  7412
  7413     PERFORM 3920-BILL-WRITE.
  7414
  7415     SET A-INDX                  UP  BY  1.
  7416
  7417 3390-EXIT.
  7418     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL642.cbl
  7420 3400-FORMAT-TOTAL-LINE.
  7421     MOVE SPACES                 TO  GA-TEXT-LINE.
  7422     MOVE DOUBLE-SPACE           TO  BI-SKIP-CONTROL.
  7423     MOVE '3'                    TO  BI-RECORD-TYPE.
  7424     MOVE SPACES                 TO  GA-TEXT-LINE.
  7425
  7426     PERFORM 3920-BILL-WRITE.
  7427
  7428     MOVE SPACES                 TO  GA-TEXT-LINE.
  7429     MOVE 'AGENT TOTAL'          TO  GA-ACCT-NAME.
  7430     MOVE WS-GA-BEG-BAL          TO  GA-BEG-BAL
  7431                                     GA-BEG-BAL-AMT.
  7432     MOVE WS-GA-NET-PREM         TO  GA-NET-PREM
  7433                                     GA-NET-PREM-AMT.
  7434     MOVE WS-GA-COMP             TO  GA-ACCT-COMP
  7435                                     GA-ACCT-COMP-AMT.
  7436     MOVE WS-GA-PAY-ADJS         TO  GA-PMTS-ADJS
  7437                                     GA-PMTS-ADJS-AMT.
  7438     MOVE WS-GA-END-BAL          TO  GA-END-BAL-AMT.
  7439     MOVE WS-GA-UNPAID-NET-PREM  TO  GA-UNPAID-NET-PREM
  7440                                     GA-UNPAID-NET-AMT.
  7441     MOVE PI-LIFE-OVERRIDE-L6    TO  GA-BEN-OVERRIDE-L6.
  7442     MOVE PI-LIFE-OVERRIDE-L2    TO  GA-BENEFIT-CD.
  7443     MOVE WS-GA-LF-OVERWRITE     TO  GA-OVERWRITE
  7444                                     GA-OVERWRITE-AMT.
  7445     MOVE WS-GA-AMT-DUE          TO  GA-AMT-DUE-AMT
  7446                                     GA-AMT-DUE.
  7447
  7448     PERFORM 3920-BILL-WRITE.
  7449
  7450     MOVE SPACES                 TO  GA-TEXT-LINE.
  7451     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7452     MOVE PI-AH-OVERRIDE-L6      TO  GA-BEN-OVERRIDE-L6
  7453     MOVE PI-AH-OVERRIDE-L2      TO  GA-BENEFIT-CD
  7454     MOVE WS-GA-AH-OVERWRITE     TO  GA-OVERWRITE
  7455                                     GA-OVERWRITE-AMT.
  7456
  7457     PERFORM 3920-BILL-WRITE.
  7458
  7459     MOVE SPACES                 TO  GA-TEXT-LINE.
  7460     MOVE SINGLE-SPACE           TO  BI-SKIP-CONTROL.
  7461
  7462     PERFORM 3920-BILL-WRITE.
  7463
  7464     MOVE SPACES                 TO  GA-TEXT-LINE.
  7465     MOVE '1'                    TO  BI-RECORD-TYPE.
  7466     MOVE PI-PROCESSOR-ID        TO  GA-PROCESSOR-CD.
  7467
  7468     IF PI-PREV-BILL
  7469       OR  PI-PREV-REBILL
  7470         MOVE 'P'                TO  GA-STATEMENT-TYPE.
  7471
  7472     MOVE +1                     TO  GA-NO-OF-COPIES.
  7473     MOVE WS-CURRENT-DATE        TO  GA-CREATION-DT.
  7474     MOVE LOW-VALUES             TO  GA-INITIAL-PRINT-DATE.
  7475     MOVE PI-UNPAID-NET-PREM     TO  GA-NET-UNPD.
  7476     MOVE PI-COMP-UNPAID-PREM    TO  GA-COMP-UNPD-PREM.
  7477     MOVE PI-PREMIUM             TO  GA-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL642.cbl
  7478     MOVE PI-REMITTED            TO  GA-REMITTED.
  7479     MOVE PI-TOT-ISS-COMP        TO  GA-TOT-ISS-COMP.
  7480     MOVE PI-TOT-CAN-COMP        TO  GA-TOT-CAN-COMP.
  7481     MOVE PI-ADJUSTMNTS          TO  GA-ADJUSTMNTS.
  7482     MOVE PI-DISBURSED           TO  GA-DISBURSED.
  7483     MOVE PI-AGENT-NAME          TO  GA-AGENTS-NAME.
  7484
  7485     PERFORM 3920-BILL-WRITE.
  7486
  7487     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL642.cbl
  7489 3910-BILL-GETMAIN.
  7490
  7491* EXEC CICS GETMAIN
  7492*        SET      (ADDRESS OF BILLING-STATEMENT)
  7493*        LENGTH   (210)
  7494*        INITIMG  (GETMAIN-SPACE)
  7495*    END-EXEC.
  7496     MOVE 210
  7497       TO DFHEIV11
  7498*    MOVE ',"IL                  $   #00007401' TO DFHEIV0
  7499     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7500     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7501     MOVE X'2020233030303037343031' TO DFHEIV0(25:11)
  7502     CALL 'kxdfhei1' USING DFHEIV0,
  7503           DFHEIV20,
  7504           DFHEIV11,
  7505           GETMAIN-SPACE
  7506     SET ADDRESS OF BILLING-STATEMENT TO
  7507         DFHEIV20
  7508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7509
  7510
  7511 3920-BILL-WRITE.
  7512     MOVE PI-COMPANY-CD          TO  BI-COMPANY-CD.
  7513     MOVE PI-SAV-CARR            TO  BI-CARRIER.
  7514     MOVE PI-SAV-GROUP           TO  BI-GROUPING.
  7515     MOVE LOW-VALUES             TO  BI-ACCOUNT.
  7516     MOVE PI-SAV-AGENT           TO  BI-FIN-RESP.
  7517     MOVE 'BI'                   TO  BI-RECORD-ID.
  7518
  7519     ADD +1                      TO  WS-LINE-SEQ-NO.
  7520
  7521     IF BI-RECORD-TYPE = '1'
  7522         MOVE ZEROS              TO  BI-LINE-SEQ-NO
  7523     ELSE
  7524         MOVE WS-LINE-SEQ-NO     TO  BI-LINE-SEQ-NO.
  7525
  7526
  7527* EXEC CICS WRITE
  7528*        DATASET  (ERBILL-FILE-ID)
  7529*        FROM     (BILLING-STATEMENT)
  7530*        RIDFLD   (BI-CONTROL-PRIMARY)
  7531*    END-EXEC.
  7532     MOVE LENGTH OF
  7533      BILLING-STATEMENT
  7534       TO DFHEIV11
  7535*    MOVE '&$ L                  ''   #00007422' TO DFHEIV0
  7536     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7537     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7538     MOVE X'2020233030303037343232' TO DFHEIV0(25:11)
  7539     CALL 'kxdfhei1' USING DFHEIV0,
  7540           ERBILL-FILE-ID,
  7541           BILLING-STATEMENT,
  7542           DFHEIV11,
  7543           BI-CONTROL-PRIMARY,
  7544           DFHEIV99,
  7545           DFHEIV99
  7546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL642.cbl
  7547
  7548
  7549 3930-BILL-READ.
  7550     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7551     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7552     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7553     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7554     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7555     MOVE '1'                    TO  ERBILL-REC-TYPE.
  7556     MOVE ZEROS                  TO  ERBILL-LINE-SEQ-NO.
  7557
  7558
  7559* EXEC CICS HANDLE CONDITION
  7560*        NOTFND  (3930-BILL-NOTFND)
  7561*    END-EXEC.
  7562*    MOVE '"$I                   ! $ #00007437' TO DFHEIV0
  7563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7565     MOVE X'2420233030303037343337' TO DFHEIV0(25:11)
  7566     CALL 'kxdfhei1' USING DFHEIV0
  7567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7568
  7569
  7570
  7571* EXEC CICS READ
  7572*        SET      (ADDRESS OF BILLING-STATEMENT)
  7573*        DATASET  (ERBILL-FILE-ID)
  7574*        RIDFLD   (ERBILL-KEY)
  7575*        GTEQ
  7576*    END-EXEC.
  7577*    MOVE '&"S        G          (   #00007441' TO DFHEIV0
  7578     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7580     MOVE X'2020233030303037343431' TO DFHEIV0(25:11)
  7581     CALL 'kxdfhei1' USING DFHEIV0,
  7582           ERBILL-FILE-ID,
  7583           DFHEIV20,
  7584           DFHEIV99,
  7585           ERBILL-KEY,
  7586           DFHEIV99,
  7587           DFHEIV99,
  7588           DFHEIV99
  7589     SET ADDRESS OF BILLING-STATEMENT TO
  7590         DFHEIV20
  7591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7592
  7593
  7594     IF BI-COMPANY-CD  =  PI-COMPANY-CD
  7595       AND  BI-CARRIER  =  ERBILL-CARRIER
  7596       AND  BI-GROUPING  =  ERBILL-GROUP
  7597       AND  BI-ACCOUNT  =  ERBILL-ACCT
  7598       AND  BI-FIN-RESP  =  ERBILL-FIN-RESP
  7599         MOVE SPACE              TO  NO-BILL-REC-SW
  7600         GO TO 3930-EXIT
  7601     ELSE
  7602         GO TO 3930-BILL-NOTFND.
  7603
  7604 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL642.cbl
  7605     MOVE 'Y'                    TO  NO-BILL-REC-SW.
  7606
  7607 3930-EXIT.
  7608     EXIT.
  7609
  7610 3940-BILL-GENERIC-DELETE.
  7611
  7612* EXEC CICS HANDLE CONDITION
  7613*        NOTFND  (3940-EXIT)
  7614*    END-EXEC.
  7615*    MOVE '"$I                   ! % #00007465' TO DFHEIV0
  7616     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7618     MOVE X'2520233030303037343635' TO DFHEIV0(25:11)
  7619     CALL 'kxdfhei1' USING DFHEIV0
  7620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7621
  7622
  7623     MOVE PI-COMPANY-CD          TO  ERBILL-CO-CD.
  7624     MOVE PI-SAV-CARR            TO  ERBILL-CARRIER.
  7625     MOVE PI-SAV-GROUP           TO  ERBILL-GROUP.
  7626     MOVE LOW-VALUES             TO  ERBILL-ACCT.
  7627     MOVE PI-SAV-AGENT           TO  ERBILL-FIN-RESP.
  7628
  7629
  7630* EXEC CICS DELETE
  7631*        DATASET    (ERBILL-FILE-ID)
  7632*        RIDFLD     (ERBILL-KEY)
  7633*        KEYLENGTH  (28)
  7634*        GENERIC
  7635*    END-EXEC.
  7636     MOVE 28
  7637       TO DFHEIV11
  7638*    MOVE '&(  RKG               &   #00007475' TO DFHEIV0
  7639     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  7640     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7641     MOVE X'2020233030303037343735' TO DFHEIV0(25:11)
  7642     CALL 'kxdfhei1' USING DFHEIV0,
  7643           ERBILL-FILE-ID,
  7644           ERBILL-KEY,
  7645           DFHEIV11,
  7646           DFHEIV99,
  7647           DFHEIV99
  7648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7649
  7650
  7651 3940-EXIT.
  7652     EXIT.
  7653
  7654 3990-EXIT.
  7655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL642.cbl
  7657 4000-PNDB-START-BROWSE.
  7658     MOVE SPACES                 TO  ERPNDB-ALT-KEY.
  7659     MOVE PI-COMPANY-CD          TO  ERPNDB-CO-CD-A1.
  7660
  7661     IF CARR-GROUP-ST-ACCNT-CNTL
  7662         MOVE GX-AM-CARRIER  (GX-SUB)  TO  ERPNDB-CARR
  7663         MOVE GX-AM-GROUPING (GX-SUB)  TO  ERPNDB-GROUP
  7664         MOVE GX-AM-STATE    (GX-SUB)  TO  ERPNDB-STATE
  7665         MOVE GX-AM-ACCOUNT  (GX-SUB)  TO  ERPNDB-ACCT
  7666     ELSE
  7667     IF CARR-ST-ACCNT-CNTL
  7668         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7669         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7670         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7671     ELSE
  7672     IF CARR-ACCNT-CNTL
  7673         MOVE GX-AM-CARRIER (GX-SUB)   TO  ERPNDB-CARR
  7674         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7675     ELSE
  7676     IF ACCNT-CNTL
  7677         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT
  7678     ELSE
  7679         MOVE GX-AM-STATE   (GX-SUB)   TO  ERPNDB-STATE
  7680         MOVE GX-AM-ACCOUNT (GX-SUB)   TO  ERPNDB-ACCT.
  7681
  7682     MOVE GX-AM-EFF-DT (GX-SUB)  TO  ERPNDB-EFF-DT.
  7683
  7684
  7685* EXEC CICS HANDLE CONDITION
  7686*        NOTFND  (4010-REC-NOT-FND)
  7687*    END-EXEC.
  7688*    MOVE '"$I                   ! & #00007515' TO DFHEIV0
  7689     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7691     MOVE X'2620233030303037353135' TO DFHEIV0(25:11)
  7692     CALL 'kxdfhei1' USING DFHEIV0
  7693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7694
  7695
  7696
  7697* EXEC CICS STARTBR
  7698*        DATASET  (ERPNDB-ALT-FILE-ID)
  7699*        RIDFLD   (ERPNDB-ALT-KEY)
  7700*        GTEQ
  7701*    END-EXEC.
  7702     MOVE 0
  7703       TO DFHEIV11
  7704*    MOVE '&,         G          &   #00007519' TO DFHEIV0
  7705     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7707     MOVE X'2020233030303037353139' TO DFHEIV0(25:11)
  7708     CALL 'kxdfhei1' USING DFHEIV0,
  7709           ERPNDB-ALT-FILE-ID,
  7710           ERPNDB-ALT-KEY,
  7711           DFHEIV99,
  7712           DFHEIV11,
  7713           DFHEIV99
  7714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL642.cbl
  7715
  7716
  7717     GO TO 4090-EXIT.
  7718
  7719 4010-REC-NOT-FND.
  7720     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7721
  7722 4090-EXIT.
  7723     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL642.cbl
  7725 4100-PNDB-READ-NEXT.
  7726
  7727* EXEC CICS HANDLE CONDITION
  7728*        ENDFILE  (4110-END-OF-FILE)
  7729*    END-EXEC.
  7730*    MOVE '"$''                   ! '' #00007534' TO DFHEIV0
  7731     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7733     MOVE X'2720233030303037353334' TO DFHEIV0(25:11)
  7734     CALL 'kxdfhei1' USING DFHEIV0
  7735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7736
  7737
  7738
  7739* EXEC CICS READNEXT
  7740*        SET      (ADDRESS OF PENDING-BUSINESS)
  7741*        DATASET  (ERPNDB-ALT-FILE-ID)
  7742*        RIDFLD   (ERPNDB-ALT-KEY)
  7743*    END-EXEC.
  7744     MOVE 0
  7745       TO DFHEIV11
  7746*    MOVE '&.S                   )   #00007538' TO DFHEIV0
  7747     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7748     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7749     MOVE X'2020233030303037353338' TO DFHEIV0(25:11)
  7750     CALL 'kxdfhei1' USING DFHEIV0,
  7751           ERPNDB-ALT-FILE-ID,
  7752           DFHEIV20,
  7753           DFHEIV99,
  7754           ERPNDB-ALT-KEY,
  7755           DFHEIV99,
  7756           DFHEIV11,
  7757           DFHEIV99,
  7758           DFHEIV99
  7759     SET ADDRESS OF PENDING-BUSINESS TO
  7760         DFHEIV20
  7761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7762
  7763
  7764     GO TO 4150-EXIT.
  7765
  7766 4110-END-OF-FILE.
  7767     MOVE 'Y'                    TO  PNDB-EOF-SW.
  7768
  7769 4150-EXIT.
  7770     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL642.cbl
  7772 4160-PNDB-END-BROWSE.
  7773
  7774* EXEC CICS ENDBR
  7775*        DATASET  (ERPNDB-ALT-FILE-ID)
  7776*    END-EXEC.
  7777     MOVE 0
  7778       TO DFHEIV11
  7779*    MOVE '&2                    $   #00007553' TO DFHEIV0
  7780     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7781     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7782     MOVE X'2020233030303037353533' TO DFHEIV0(25:11)
  7783     CALL 'kxdfhei1' USING DFHEIV0,
  7784           ERPNDB-ALT-FILE-ID,
  7785           DFHEIV11,
  7786           DFHEIV99
  7787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7788
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL642.cbl
  7790 4200-PNDB-REWRITE.
  7791     MOVE PB-COMPANY-CD          TO  ERPNDB-CO-CD.
  7792     MOVE PB-ENTRY-BATCH         TO  ERPNDB-BATCH.
  7793     MOVE PB-BATCH-SEQ-NO        TO  ERPNDB-SEQ-NO.
  7794     MOVE PB-BATCH-CHG-SEQ-NO    TO  ERPNDB-CHG-SEQ-NO.
  7795
  7796     PERFORM 4160-PNDB-END-BROWSE
  7797
  7798
  7799* EXEC CICS READ
  7800*        SET      (ADDRESS OF PENDING-BUSINESS)
  7801*        DATASET  (ERPNDB-FILE-ID)
  7802*        RIDFLD   (ERPNDB-PRIME-KEY)
  7803*        UPDATE
  7804*    END-EXEC.
  7805*    MOVE '&"S        EU         (   #00007565' TO DFHEIV0
  7806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7807     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7808     MOVE X'2020233030303037353635' TO DFHEIV0(25:11)
  7809     CALL 'kxdfhei1' USING DFHEIV0,
  7810           ERPNDB-FILE-ID,
  7811           DFHEIV20,
  7812           DFHEIV99,
  7813           ERPNDB-PRIME-KEY,
  7814           DFHEIV99,
  7815           DFHEIV99,
  7816           DFHEIV99
  7817     SET ADDRESS OF PENDING-BUSINESS TO
  7818         DFHEIV20
  7819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7820
  7821
  7822     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7823     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7824     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7825
  7826     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7827
  7828     PERFORM 8400-LOG-JOURNAL-RECORD.
  7829
  7830     IF PI-VOID-BILL
  7831         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (WS-GA-LEVEL)
  7832     ELSE
  7833         MOVE WS-CURRENT-DATE    TO  PB-GA-BILL-DT (WS-GA-LEVEL).
  7834
  7835     MOVE PI-PROCESSOR-ID        TO  PB-LAST-MAINT-BY.
  7836     MOVE EIBTIME                TO  PB-LAST-MAINT-HHMMSS.
  7837     MOVE WS-CURRENT-DATE        TO  PB-LAST-MAINT-DT.
  7838     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7839     MOVE PENDING-BUSINESS       TO  JP-RECORD-AREA.
  7840     MOVE ERPNDB-FILE-ID         TO  JP-FILE-ID.
  7841
  7842     COMPUTE JOURNAL-LENGTH = ERPNDB-LENGTH + 23.
  7843
  7844
  7845* EXEC CICS REWRITE
  7846*        DATASET  (ERPNDB-FILE-ID)
  7847*        FROM     (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL642.cbl
  7848*    END-EXEC.
  7849     MOVE LENGTH OF
  7850      PENDING-BUSINESS
  7851       TO DFHEIV11
  7852*    MOVE '&& L                  %   #00007594' TO DFHEIV0
  7853     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7855     MOVE X'2020233030303037353934' TO DFHEIV0(25:11)
  7856     CALL 'kxdfhei1' USING DFHEIV0,
  7857           ERPNDB-FILE-ID,
  7858           PENDING-BUSINESS,
  7859           DFHEIV11,
  7860           DFHEIV99
  7861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7862
  7863
  7864     PERFORM 8400-LOG-JOURNAL-RECORD.
  7865
  7866
  7867* EXEC CICS HANDLE CONDITION
  7868*        NOTFND  (4290-REC-NOT-FND)
  7869*    END-EXEC.
  7870*    MOVE '"$I                   ! ( #00007601' TO DFHEIV0
  7871     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7873     MOVE X'2820233030303037363031' TO DFHEIV0(25:11)
  7874     CALL 'kxdfhei1' USING DFHEIV0
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7876
  7877
  7878
  7879* EXEC CICS STARTBR
  7880*        DATASET  (ERPNDB-ALT-FILE-ID)
  7881*        RIDFLD   (ERPNDB-ALT-KEY)
  7882*        GTEQ
  7883*    END-EXEC.
  7884     MOVE 0
  7885       TO DFHEIV11
  7886*    MOVE '&,         G          &   #00007605' TO DFHEIV0
  7887     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7888     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7889     MOVE X'2020233030303037363035' TO DFHEIV0(25:11)
  7890     CALL 'kxdfhei1' USING DFHEIV0,
  7891           ERPNDB-ALT-FILE-ID,
  7892           ERPNDB-ALT-KEY,
  7893           DFHEIV99,
  7894           DFHEIV11,
  7895           DFHEIV99
  7896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7897
  7898
  7899     PERFORM 4100-PNDB-READ-NEXT  THRU  4150-EXIT.
  7900
  7901     GO TO 4290-EXIT.
  7902
  7903 4290-REC-NOT-FND.
  7904     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  7905
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL642.cbl
  7906 4290-EXIT.
  7907     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL642.cbl
  7909 4300-READ-ACCOUNT-MASTER.
  7910
  7911     MOVE SPACE                  TO  INVALID-ACCOUNT-SW.
  7912     MOVE PI-COMPANY-CD          TO  ERACCT-P-CO-CD.
  7913     MOVE PI-CR-CARRIER          TO  ERACCT-P-CARRIER.
  7914     MOVE PI-CR-GROUPING         TO  ERACCT-P-GROUPING.
  7915     MOVE PI-CR-STATE            TO  ERACCT-P-STATE.
  7916     MOVE PI-CR-ACCOUNT          TO  ERACCT-P-ACCOUNT.
  7917     MOVE PI-SAV-EXP-DT          TO  ERACCT-P-EXP-DATE.
  7918
  7919
  7920* EXEC CICS HANDLE CONDITION
  7921*        NOTFND  (4370-ACCOUNT-INVALID)
  7922*    END-EXEC.
  7923*    MOVE '"$I                   ! ) #00007631' TO DFHEIV0
  7924     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7926     MOVE X'2920233030303037363331' TO DFHEIV0(25:11)
  7927     CALL 'kxdfhei1' USING DFHEIV0
  7928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7929
  7930
  7931
  7932* EXEC CICS READ
  7933*        DATASET  (ERACCT-FILE-ID)
  7934*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7935*        RIDFLD   (ERACCT-PRIME-KEY)
  7936*        EQUAL
  7937*    END-EXEC.
  7938*    MOVE '&"S        E          (   #00007635' TO DFHEIV0
  7939     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7941     MOVE X'2020233030303037363335' TO DFHEIV0(25:11)
  7942     CALL 'kxdfhei1' USING DFHEIV0,
  7943           ERACCT-FILE-ID,
  7944           DFHEIV20,
  7945           DFHEIV99,
  7946           ERACCT-PRIME-KEY,
  7947           DFHEIV99,
  7948           DFHEIV99,
  7949           DFHEIV99
  7950     SET ADDRESS OF ACCOUNT-MASTER TO
  7951         DFHEIV20
  7952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7953
  7954
  7955     IF AM-REMIT-TO  NOT GREATER THAN  '00'
  7956         GO TO 4370-ACCOUNT-INVALID.
  7957
  7958     IF AM-AGT (AM-REMIT-TO)  =  SPACES
  7959         MOVE PI-CR-ACCOUNT      TO  PI-SAV-REMIT-TO
  7960     ELSE
  7961         MOVE AM-AGT (AM-REMIT-TO)
  7962                                 TO  PI-SAV-REMIT-TO.
  7963
  7964     MOVE AM-EXPIRATION-DT       TO  ERACCT-P-EXP-DATE.
  7965     MOVE AM-CARRIER             TO  PI-CR-CARRIER.
  7966     MOVE AM-GROUPING            TO  PI-CR-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL642.cbl
  7967     MOVE AM-STATE               TO  PI-CR-STATE.
  7968     MOVE AM-AGT (AM-REMIT-TO)   TO  PI-SAV-FIN-RESP
  7969                                     PI-COMP-FIN-RESP.
  7970
  7971     IF PI-ZERO-CARRIER
  7972       OR  PI-ZERO-CAR-GROUP
  7973         MOVE ZEROS              TO  PI-COMP-CARRIER
  7974     ELSE
  7975         MOVE AM-CARRIER         TO  PI-COMP-CARRIER.
  7976
  7977     IF PI-ZERO-GROUPING
  7978        OR  PI-ZERO-CAR-GROUP
  7979         MOVE ZEROS              TO  PI-COMP-GROUPING
  7980     ELSE
  7981         MOVE AM-GROUPING        TO  PI-COMP-GROUPING.
  7982
  7983     IF CARR-GROUP-ST-ACCNT-CNTL
  7984         MOVE SPACE              TO  NEW-ACCOUNT-SW.
  7985
  7986     MOVE +0                     TO  ACCOM-SUB.
  7987
  7988 4320-FIND-ACCT-RESPONSIBILITY.
  7989     ADD +1                      TO  ACCOM-SUB.
  7990
  7991     IF ACCOM-SUB  GREATER THAN  +10
  7992         MOVE  AM-ACCOUNT        TO  GA-ACCT
  7993         GO TO 4330-FIND-GA-COMMISSION.
  7994
  7995     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F'
  7996         NEXT SENTENCE
  7997     ELSE
  7998         GO TO 4320-FIND-ACCT-RESPONSIBILITY.
  7999
  8000     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-ACCT-AGT
  8001         MOVE 'Y'                TO  NEW-ACCOUNT-SW.
  8002
  8003     MOVE AM-AGT (ACCOM-SUB)     TO  PI-SAV-ACCT-AGT.
  8004     MOVE AM-NAME                TO  PI-SAV-ACCT-NAME.
  8005
  8006 4330-FIND-GA-COMMISSION.
  8007     MOVE ZEROS                  TO  WS-GA-LEVEL
  8008                                     WS-GA-LF-COM
  8009                                     WS-GA-AH-COM.
  8010     MOVE +0                     TO  ACCOM-SUB.
  8011
  8012 4340-SEARCH-FOR-GA-COMMISSION.
  8013     ADD +1                      TO  ACCOM-SUB.
  8014
  8015     IF ACCOM-SUB  GREATER THAN  +10
  8016         GO TO 4370-ACCOUNT-INVALID.
  8017
  8018     IF AM-COM-TYP (ACCOM-SUB) = 'O' OR 'P' OR 'G' OR 'B' OR 'K'
  8019                              OR 'S'
  8020        CONTINUE
  8021     ELSE
  8022        GO TO 4340-SEARCH-FOR-GA-COMMISSION
  8023     END-IF
  8024
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL642.cbl
  8025     IF AM-AGT (ACCOM-SUB)  NOT =  PI-SAV-AGENT
  8026         GO TO 4340-SEARCH-FOR-GA-COMMISSION.
  8027
  8028     MOVE ACCOM-SUB              TO  WS-GA-LEVEL.
  8029
  8030     GO TO 4390-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL642.cbl
  8032 4370-ACCOUNT-INVALID.
  8033     MOVE 'Y'                    TO  INVALID-ACCOUNT-SW.
  8034     MOVE ER-2210                TO  EMI-ERROR.
  8035
  8036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8037
  8038     GO TO 4390-EXIT.
  8039
  8040 4390-EXIT.
  8041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL642.cbl
  8043 4400-FIND-COMMISSION.
  8044******************************************************************
  8045*    IF THE AGENT'S COMMISSION IS NUMERIC FOR A&H AND LIFE       *
  8046*    IN THE ACCOUNT MASTER THAT IS THE COMMISSION.  IF THE       *
  8047*    COMMISSION IN THE A&H AND LIFE CONTAINS A TABLE CODE        *
  8048*    READ THE COMMISSION-TABLE TO GET THE COMMISSION RATE.       *
  8049*    FOR CLIENT "DMD" THE ABOVE COMMISSION MAY BE OVERWRITTEN    *
  8050*    IF AN ACCOUNT RESIDENT STATE COMMISSION RECORD EXISTS.      *
  8051******************************************************************
  8052
  8053     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  8054
  8055 4405-FIND-AH-COMMISSION.
  8056* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8057     IF PB-ISSUE
  8058         MOVE PB-I-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8059     ELSE
  8060         MOVE PB-CI-AH-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8061
  8062     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  8063
  8064     MOVE 'AH'                   TO WS-COMM-SW.
  8065
  8066     IF AM-A-COM (WS-GA-LEVEL)  NUMERIC
  8067         MOVE AM-A-COM (WS-GA-LEVEL)
  8068                                 TO  WS-COMMISSION
  8069         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8070         MOVE WS-COMMISSION      TO  WS-GA-AH-COM
  8071         GO TO 4410-FIND-LIFE-COMMISSION.
  8072
  8073     IF ERCTBL-BEN-CODE  =  ZEROS
  8074         MOVE ZEROS              TO  WS-GA-LF-COM
  8075         GO TO 4410-FIND-LIFE-COMMISSION.
  8076
  8077     MOVE ZEROS                  TO WS-SUB1.
  8078     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8079     IF WS-SUB1 IS GREATER THAN ZEROS
  8080         GO TO 4410-FIND-LIFE-COMMISSION.
  8081
  8082     MOVE 'A'                     TO  ERCTBL-BEN-TYPE.
  8083
  8084     MOVE AM-A-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  8085     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8086
  8087     IF ERCTBL-NOT-FOUND
  8088         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8089         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8090         IF ERCTBL-NOT-FOUND
  8091             MOVE -1             TO  AAGENTL
  8092             MOVE ER-2916        TO  EMI-ERROR
  8093             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8094             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8095             GO TO 8200-SEND-DATAONLY.
  8096
  8097     PERFORM 6680-AH-GET-COMP-RATE.
  8098
  8099 4410-FIND-LIFE-COMMISSION.
  8100     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL642.cbl
  8101         MOVE PB-CI-LF-BENEFIT-CD  TO CLBENF-CD
  8102     ELSE
  8103         MOVE PB-I-LF-BENEFIT-CD   TO CLBENF-CD.
  8104
  8105     MOVE 'LF'                   TO WS-COMM-SW.
  8106
  8107     IF CLBENF-CD  =  ZEROS  OR  SPACES
  8108         MOVE ZEROS              TO  WS-GA-LF-COM
  8109         GO TO 4490-EXIT.
  8110
  8111     IF PB-ISSUE
  8112         MOVE PB-I-LIFE-INDICATOR TO LIFE-INDICATOR
  8113         GO TO 4420-CONT-FIND-LIFE-COMMISSION.
  8114
  8115     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  8116
  8117     IF BENEFIT-MASTER-FOUND
  8118         NEXT SENTENCE
  8119     ELSE
  8120         MOVE -1                 TO  AAGENTL
  8121         MOVE ER-2917            TO  EMI-ERROR
  8122         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8123         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8124         GO TO 8200-SEND-DATAONLY.
  8125
  8126 4420-CONT-FIND-LIFE-COMMISSION.
  8127* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8128
  8129     IF PB-ISSUE
  8130         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8131     ELSE
  8132         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8133
  8134     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  8135
  8136     IF JOINT-LIFE
  8137         NEXT SENTENCE
  8138     ELSE
  8139         GO TO 4430-SINGLE-LIFE-COMMISSION.
  8140
  8141     IF AM-J-COM (WS-GA-LEVEL)  NUMERIC
  8142         MOVE AM-J-COM (WS-GA-LEVEL)
  8143                                 TO  WS-COMMISSION
  8144         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8145         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8146         GO TO 4490-EXIT.
  8147
  8148     MOVE ZEROS                  TO WS-SUB1.
  8149     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8150     IF WS-SUB1 IS GREATER THAN ZEROS
  8151         GO TO 4490-EXIT.
  8152
  8153     MOVE AM-J-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE.
  8154
  8155     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8156
  8157     IF ERCTBL-NOT-FOUND
  8158         MOVE 'AA'               TO  ERCTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL642.cbl
  8159         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8160         IF ERCTBL-NOT-FOUND
  8161             MOVE -1             TO  AAGENTL
  8162             MOVE ER-2916        TO  EMI-ERROR
  8163             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8164             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8165             GO TO 8200-SEND-DATAONLY.
  8166
  8167     PERFORM 6680-LF-GET-COMP-RATE.
  8168     GO TO 4490-EXIT.
  8169
  8170 4430-SINGLE-LIFE-COMMISSION.
  8171* SET UP COMMISSION TABLE KEY BEFORE DETERMINING COMMISSION
  8172
  8173     IF PB-ISSUE
  8174         MOVE PB-I-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE
  8175     ELSE
  8176         MOVE PB-CI-LF-BENEFIT-CD TO  ERCTBL-BEN-CODE.
  8177
  8178     MOVE 'L'                     TO  ERCTBL-BEN-TYPE.
  8179*
  8180     IF AM-L-COM (WS-GA-LEVEL)  NUMERIC
  8181         MOVE AM-L-COM (WS-GA-LEVEL)
  8182                                 TO  WS-COMMISSION
  8183         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  8184         MOVE WS-COMMISSION      TO  WS-GA-LF-COM
  8185         GO TO 4490-EXIT.
  8186
  8187     MOVE ZEROS                  TO WS-SUB1.
  8188     PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT.
  8189     IF WS-SUB1 IS GREATER THAN ZEROS
  8190         GO TO 4490-EXIT.
  8191
  8192     MOVE ZEROS                  TO WS-SUB1.
  8193     MOVE AM-L-COMA (WS-GA-LEVEL) TO ERCTBL-TABLE
  8194
  8195     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8196
  8197     IF ERCTBL-NOT-FOUND
  8198         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8199         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8200         IF ERCTBL-NOT-FOUND
  8201             MOVE -1             TO  AAGENTL
  8202             MOVE ER-2916        TO  EMI-ERROR
  8203             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8204             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8205             GO TO 8200-SEND-DATAONLY.
  8206
  8207     PERFORM 6680-LF-GET-COMP-RATE.
  8208     GO TO 4490-EXIT.
  8209
  8210 4490-EXIT.
  8211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL642.cbl
  8213 4500-PYAJ-START-BROWSE.
  8214     MOVE LOW-VALUES             TO  ERPYAJ-KEY.
  8215     MOVE PI-COMPANY-CD          TO  ERPYAJ-COMP-CD.
  8216
  8217     IF GENERAL-AGENT
  8218         MOVE PI-SAV-CARR        TO  ERPYAJ-CARRIER
  8219         MOVE PI-SAV-GROUP       TO  ERPYAJ-GROUPING
  8220         MOVE PI-SAV-AGENT       TO  ERPYAJ-FIN-RESP
  8221         MOVE LOW-VALUES         TO  ERPYAJ-ACCOUNT
  8222     ELSE
  8223         MOVE PI-COMP-CARRIER    TO  ERPYAJ-CARRIER
  8224         MOVE PI-COMP-GROUPING   TO  ERPYAJ-GROUPING
  8225         MOVE PI-COMP-FIN-RESP   TO  ERPYAJ-FIN-RESP
  8226         MOVE PI-CR-ACCOUNT      TO  ERPYAJ-ACCOUNT.
  8227
  8228     MOVE ERPYAJ-KEY             TO  ERPYAJ-BROWSE-COMP-KEY.
  8229
  8230
  8231* EXEC CICS HANDLE CONDITION
  8232*        NOTFND  (4510-REC-NOT-FND)
  8233*    END-EXEC.
  8234*    MOVE '"$I                   ! * #00007917' TO DFHEIV0
  8235     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8237     MOVE X'2A20233030303037393137' TO DFHEIV0(25:11)
  8238     CALL 'kxdfhei1' USING DFHEIV0
  8239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8240
  8241
  8242
  8243* EXEC CICS STARTBR
  8244*        DATASET  (ERPYAJ-FILE-ID)
  8245*        RIDFLD   (ERPYAJ-KEY)
  8246*        GTEQ
  8247*    END-EXEC.
  8248     MOVE 0
  8249       TO DFHEIV11
  8250*    MOVE '&,         G          &   #00007921' TO DFHEIV0
  8251     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8252     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8253     MOVE X'2020233030303037393231' TO DFHEIV0(25:11)
  8254     CALL 'kxdfhei1' USING DFHEIV0,
  8255           ERPYAJ-FILE-ID,
  8256           ERPYAJ-KEY,
  8257           DFHEIV99,
  8258           DFHEIV11,
  8259           DFHEIV99
  8260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8261
  8262
  8263     GO TO 4590-EXIT.
  8264
  8265 4510-REC-NOT-FND.
  8266     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8267
  8268 4590-EXIT.
  8269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL642.cbl
  8271 4600-PYAJ-READ-NEXT.
  8272
  8273* EXEC CICS HANDLE CONDITION
  8274*        ENDFILE  (4610-END-OF-FILE)
  8275*    END-EXEC.
  8276*    MOVE '"$''                   ! + #00007936' TO DFHEIV0
  8277     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8279     MOVE X'2B20233030303037393336' TO DFHEIV0(25:11)
  8280     CALL 'kxdfhei1' USING DFHEIV0
  8281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8282
  8283
  8284
  8285* EXEC CICS READNEXT
  8286*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  8287*        DATASET  (ERPYAJ-FILE-ID)
  8288*        RIDFLD   (ERPYAJ-KEY)
  8289*    END-EXEC.
  8290     MOVE 0
  8291       TO DFHEIV11
  8292*    MOVE '&.S                   )   #00007940' TO DFHEIV0
  8293     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8294     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8295     MOVE X'2020233030303037393430' TO DFHEIV0(25:11)
  8296     CALL 'kxdfhei1' USING DFHEIV0,
  8297           ERPYAJ-FILE-ID,
  8298           DFHEIV20,
  8299           DFHEIV99,
  8300           ERPYAJ-KEY,
  8301           DFHEIV99,
  8302           DFHEIV11,
  8303           DFHEIV99,
  8304           DFHEIV99
  8305     SET ADDRESS OF PENDING-PAY-ADJ TO
  8306         DFHEIV20
  8307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8308
  8309
  8310     GO TO 4690-EXIT.
  8311
  8312 4610-END-OF-FILE.
  8313     MOVE 'Y'                    TO  PYAJ-EOF-SW.
  8314
  8315 4690-EXIT.
  8316     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL642.cbl
  8318 4700-PROCESS-COMM-EXCEPTION.
  8319     PERFORM 6600-READ-COMMISSION-EXCEPTION  THRU  6620-EXIT.
  8320
  8321     IF ERCOMM-NOT-FOUND
  8322         MOVE -1                 TO  AAGENTL
  8323         MOVE ER-2915            TO  EMI-ERROR
  8324         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8325         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8326         GO TO 8200-SEND-DATAONLY.
  8327
  8328     MOVE WS-GA-LEVEL            TO  CE-SUB.
  8329     MOVE PI-COMPANY-CD          TO  ERCTBL-COMPANY-CD.
  8330
  8331     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8332         IF CE-AH-COMP (CE-SUB)  NUMERIC
  8333             MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8334             MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8335             GO TO 4790-EXIT.
  8336
  8337 4715-FIND-AH-COMMISSION.
  8338     IF CE-AH-COMP (CE-SUB)  NUMERIC
  8339         MOVE CE-AH-COMP (CE-SUB)  TO  WS-GA-AH-COM
  8340         GO TO 4750-FIND-LIFE-COMMISSION.
  8341
  8342     MOVE CE-AH-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8343
  8344     IF PB-ISSUE
  8345         MOVE PB-I-AH-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8346     ELSE
  8347         MOVE PB-CI-AH-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8348
  8349     IF ERCTBL-BEN-CODE  =  ZEROS
  8350         MOVE ZEROS              TO  WS-GA-AH-COM
  8351         GO TO 4750-FIND-LIFE-COMMISSION.
  8352
  8353     MOVE 'A'                    TO  ERCTBL-BEN-TYPE.
  8354
  8355     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8356
  8357     IF ERCTBL-NOT-FOUND
  8358         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8359         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8360         IF ERCTBL-NOT-FOUND
  8361             MOVE -1             TO  AAGENTL
  8362             MOVE ER-2916        TO  EMI-ERROR
  8363             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8364             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8365             GO TO 8200-SEND-DATAONLY.
  8366
  8367     IF PB-ISSUE
  8368         COMPUTE WS-COMM-CK-AMT =
  8369             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8370         MOVE PB-I-AGE           TO  WS-COMM-AGE
  8371         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  8372     ELSE
  8373         COMPUTE WS-COMM-CK-AMT =
  8374             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8375         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL642.cbl
  8376         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  8377
  8378     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8379
  8380     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  8381
  8382 4750-FIND-LIFE-COMMISSION.
  8383     IF PB-ISSUE
  8384         MOVE PB-I-LF-BENEFIT-CD   TO  CLBENF-CD
  8385     ELSE
  8386         MOVE PB-CI-LF-BENEFIT-CD  TO  CLBENF-CD.
  8387
  8388     IF CLBENF-CD  =  ZEROS  OR  SPACES
  8389         MOVE ZEROS              TO  WS-GA-LF-COM
  8390         GO TO 4790-EXIT.
  8391
  8392     IF PB-ISSUE
  8393         MOVE PB-I-LIFE-INDICATOR  TO  LIFE-INDICATOR
  8394         GO TO 4760-CONT-FIND-LIFE-COMMISSION.
  8395
  8396     PERFORM 6800-READ-BENEFIT-MASTER  THRU  6890-EXIT.
  8397
  8398     IF BENEFIT-MASTER-FOUND
  8399         NEXT SENTENCE
  8400     ELSE
  8401         MOVE -1                 TO  AAGENTL
  8402         MOVE ER-2917            TO  EMI-ERROR
  8403         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8404         PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8405         GO TO 8200-SEND-DATAONLY.
  8406
  8407 4760-CONT-FIND-LIFE-COMMISSION.
  8408     IF JOINT-LIFE NEXT SENTENCE
  8409     ELSE
  8410         GO TO 4770-SINGLE-LIFE-COMMISSION.
  8411
  8412     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8413         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8414         GO TO 4790-EXIT.
  8415
  8416     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8417
  8418     IF PB-ISSUE
  8419         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8420     ELSE
  8421         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8422
  8423     MOVE 'J'                    TO  ERCTBL-BEN-TYPE.
  8424
  8425     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8426
  8427     IF ERCTBL-NOT-FOUND
  8428         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8429         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8430         IF ERCTBL-NOT-FOUND
  8431             MOVE -1             TO  AAGENTL
  8432             MOVE ER-2916        TO  EMI-ERROR
  8433             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL642.cbl
  8434             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8435             GO TO 8200-SEND-DATAONLY.
  8436
  8437     IF PB-ISSUE
  8438         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8439         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8440         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8441     ELSE
  8442         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8443         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8444         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8445
  8446     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8447
  8448     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8449
  8450     GO TO 4790-EXIT.
  8451
  8452 4770-SINGLE-LIFE-COMMISSION.
  8453     IF CE-LF-COMP (CE-SUB)  NUMERIC
  8454         MOVE CE-LF-COMP (CE-SUB)  TO  WS-GA-LF-COM
  8455         GO TO 4790-EXIT.
  8456
  8457     MOVE CE-LF-COMPT (CE-SUB)   TO  ERCTBL-TABLE.
  8458
  8459     IF PB-ISSUE
  8460         MOVE PB-I-LF-BENEFIT-CD   TO  ERCTBL-BEN-CODE
  8461     ELSE
  8462         MOVE PB-CI-LF-BENEFIT-CD  TO  ERCTBL-BEN-CODE.
  8463
  8464     MOVE 'L'                    TO  ERCTBL-BEN-TYPE.
  8465
  8466     PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT.
  8467
  8468     IF ERCTBL-NOT-FOUND
  8469         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  8470         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8471         IF ERCTBL-NOT-FOUND
  8472             MOVE -1             TO  AAGENTL
  8473             MOVE ER-2916        TO  EMI-ERROR
  8474             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8475             PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8476             GO TO 8200-SEND-DATAONLY.
  8477
  8478     IF PB-ISSUE
  8479         MOVE PB-I-LF-BENEFIT-AMT   TO  WS-COMM-CK-AMT
  8480         MOVE PB-I-AGE              TO  WS-COMM-AGE
  8481         MOVE PB-I-LF-TERM          TO  WS-COMM-TERM
  8482     ELSE
  8483         MOVE PB-CI-INSURED-AGE     TO  WS-COMM-AGE
  8484         MOVE PB-CI-LF-TERM         TO  WS-COMM-TERM
  8485         MOVE PB-CI-LF-BENEFIT-AMT  TO  WS-COMM-CK-AMT.
  8486
  8487     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  8488
  8489     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  8490
  8491 4790-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL642.cbl
  8492     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL642.cbl
  8494 4800-PYAJ-END-BROWSE.
  8495
  8496* EXEC CICS ENDBR
  8497*        DATASET  (ERPYAJ-FILE-ID)
  8498*    END-EXEC.
  8499     MOVE 0
  8500       TO DFHEIV11
  8501*    MOVE '&2                    $   #00008131' TO DFHEIV0
  8502     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8503     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8504     MOVE X'2020233030303038313331' TO DFHEIV0(25:11)
  8505     CALL 'kxdfhei1' USING DFHEIV0,
  8506           ERPYAJ-FILE-ID,
  8507           DFHEIV11,
  8508           DFHEIV99
  8509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8510
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL642.cbl
  8512 4900-GET-COMP-RATE.
  8513     MOVE +1                     TO  COMP-SUB.
  8514
  8515     IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (1)
  8516         ADD +9                  TO  COMP-SUB
  8517         IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (2)
  8518             ADD +9              TO  COMP-SUB
  8519             IF WS-COMM-CK-AMT  GREATER THAN  CT-TBF (3)
  8520                 MOVE -1         TO  AAGENTL
  8521                 MOVE ER-2918    TO  EMI-ERROR
  8522                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8523                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8524                 GO TO 8200-SEND-DATAONLY.
  8525
  8526     IF WS-COMM-AGE  GREATER THAN  CT-AGE (1)
  8527         ADD +3                  TO  COMP-SUB
  8528         IF WS-COMM-AGE  GREATER THAN  CT-AGE (2)
  8529             ADD +1              TO  COMP-SUB
  8530             IF WS-COMM-AGE  GREATER THAN  CT-AGE (3)
  8531                 MOVE -1         TO  AAGENTL
  8532                 MOVE ER-2918    TO  EMI-ERROR
  8533                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8534                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8535                 GO TO 8200-SEND-DATAONLY.
  8536
  8537     IF WS-COMM-TERM  GREATER  CT-TRM (1)
  8538         ADD +1                  TO  COMP-SUB
  8539         IF WS-COMM-TERM  GREATER THAN  CT-TRM (2)
  8540             ADD +1              TO  COMP-SUB
  8541             IF WS-COMM-TERM  GREATER THAN  CT-TRM (3)
  8542                 MOVE -1         TO  AAGENTL
  8543                 MOVE ER-2918    TO  EMI-ERROR
  8544                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8545                 PERFORM 8900-SYNCPOINT-ROLLBACK  THRU  8900-EXIT
  8546                 GO TO 8200-SEND-DATAONLY.
  8547
  8548     IF CT-RT (COMP-SUB)  NOT  NUMERIC
  8549         MOVE CT-RT-R (COMP-SUB)  TO  ERCTBL-TABLE
  8550         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  8551         GO TO 4900-GET-COMP-RATE.
  8552
  8553     MOVE CT-RT (COMP-SUB)       TO  WS-WK-RATE.
  8554
  8555 4990-EXIT.
  8556     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL642.cbl
  8558 5000-FORMAT-SCREEN.
  8559     MOVE LOW-VALUES             TO  EL642AO.
  8560
  8561     IF PI-SAV-AGENT  GREATER THAN  SPACES
  8562         MOVE PI-SAV-AGENT       TO  AAGENTO
  8563         MOVE PI-SAV-CARR        TO  ACARIERO
  8564         MOVE PI-SAV-GROUP       TO  AGROUPO.
  8565
  8566     MOVE PI-BILL-TYPE           TO  ABILTYPI.
  8567     MOVE AL-UANON               TO  AAGENTA
  8568                                     ACARIERA
  8569                                     AGROUPA
  8570                                     ABILTYPA.
  8571
  8572     IF PI-BILLING-ACCOUNTS (1)  NOT =  SPACES
  8573         MOVE PI-BILLING-ACCOUNTS (1)
  8574                                 TO  AACCT1I
  8575         MOVE AL-UANON           TO  AACCT1A.
  8576
  8577     IF PI-BILLING-ACCOUNTS (2)  NOT =  SPACES
  8578         MOVE PI-BILLING-ACCOUNTS (2)
  8579                                 TO  AACCT2I
  8580         MOVE AL-UANON           TO  AACCT2A.
  8581
  8582     IF PI-BILLING-ACCOUNTS (3)  NOT =  SPACES
  8583         MOVE PI-BILLING-ACCOUNTS (3)
  8584                                 TO  AACCT3I
  8585         MOVE AL-UANON           TO  AACCT3A.
  8586
  8587 5005-FORMAT-STATS.
  8588
  8589     IF PI-CR-FIN-RESP = SPACES
  8590         GO TO 5090-EXIT.
  8591
  8592     MOVE PI-BAL-FRWD            TO  ABEGBALO.
  8593     MOVE PI-UNPAID-NET-PREM     TO  AUPDPRMO.
  8594     MOVE PI-COMP-UNPAID-PREM    TO  AUPDCOMO.
  8595     MOVE PI-ISSUES-BILLED       TO  ABILL1O.
  8596     MOVE PI-ISSUES-INER         TO  AINER1O.
  8597     MOVE PI-ISSUES-PREV         TO  APRVBL1O.
  8598     MOVE PI-CANCELS-BILLED      TO  ABILL2O.
  8599     MOVE PI-CANCELS-INER        TO  AINER2O.
  8600     MOVE PI-CANCELS-PREV        TO  APRVBL2O.
  8601
  8602
  8603     IF PI-UNKNOWN  GREATER THAN  ZEROS
  8604         MOVE ER-2912            TO  EMI-ERROR
  8605         MOVE PI-UNKNOWN         TO  AUNKNERO
  8606         MOVE AL-SABOF           TO  AUNKNERA
  8607         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8608
  8609     MOVE PI-PREMIUM             TO  APREMUMO.
  8610     MOVE PI-REMITTED            TO  AREMITO.
  8611     MOVE PI-TOT-ISS-COMP        TO  ACOMPISO.
  8612     MOVE PI-TOT-CAN-COMP        TO  ACOMCANO.
  8613     MOVE PI-ADJUSTMNTS          TO  AADJUSTO.
  8614     MOVE PI-DISBURSED           TO  ADISBURO.
  8615     MOVE ZERO                   TO  PI-END-BAL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL642.cbl
  8616
  8617     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8618         COMPUTE PI-DUE-FOR-ACCT =
  8619             (PI-ACCT-BEG-BAL + PI-ACCT-NET-PREM) -
  8620              (PI-ACCT-COMP + PI-ACCT-PAY-ADJS).
  8621
  8622     COMPUTE PI-END-BAL = PI-BAL-FRWD - PI-TOT-ISS-COMP
  8623                        + PI-TOT-CAN-COMP + PI-ADJUSTMNTS
  8624                        - PI-REMITTED + PI-DISBURSED.
  8625
  8626     MOVE PI-END-BAL             TO  ANETDUEO.
  8627
  8628     IF PI-END-BAL  NEGATIVE
  8629         MOVE OWED-TO-AGENT      TO  AENDHDGO
  8630     ELSE
  8631         IF PI-END-BAL  GREATER THAN  ZERO
  8632             MOVE AGENT-OWES     TO  AENDHDGO
  8633         ELSE
  8634             MOVE 'BALANCE='     TO  AENDHDGO.
  8635
  8636     IF PI-SAV-AGENT = PI-SAV-REMIT-TO
  8637         IF PI-DUE-FOR-ACCT  NOT =  ZERO
  8638             MOVE PI-DUE-FOR-ACCT
  8639                                 TO  AACTDUEO
  8640             IF PI-DUE-FOR-ACCT  NEGATIVE
  8641                 MOVE 'DUE GA ON BEHALF OF ACCOUNTS'
  8642                                 TO  AACTHDGO
  8643             ELSE
  8644                 MOVE 'GA OWES ON BEHALF OF ACCOUNTS'
  8645                                 TO  AACTHDGO.
  8646
  8647 5080-CONT.
  8648     IF RETURNED-FROM  NOT =  SPACES
  8649         IF RETURNED-FROM  NOT =  XCTL-6401
  8650             MOVE ER-2421        TO  EMI-ERROR
  8651             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8652             MOVE ZEROS          TO  EMI-ERROR.
  8653
  8654 5090-EXIT.
  8655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL642.cbl
  8657 6000-READ-COMP-MASTER.
  8658
  8659* EXEC CICS HANDLE CONDITION
  8660*        NOTFND  (6070-NO-COMP-MSTR)
  8661*    END-EXEC.
  8662*    MOVE '"$I                   ! , #00008281' TO DFHEIV0
  8663     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8665     MOVE X'2C20233030303038323831' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  8671
  8672     IF GENERAL-AGENT
  8673         MOVE PI-SAV-CARR        TO  ERCOMP-CARRIER
  8674         MOVE PI-SAV-GROUP       TO  ERCOMP-GROUPING
  8675         MOVE PI-SAV-AGENT       TO  ERCOMP-FIN-RESP
  8676     ELSE
  8677         MOVE PI-COMP-CARRIER    TO  ERCOMP-CARRIER
  8678         MOVE PI-COMP-GROUPING   TO  ERCOMP-GROUPING
  8679         MOVE PI-COMP-FIN-RESP   TO  ERCOMP-FIN-RESP.
  8680
  8681     MOVE ERCOMP-FIN-RESP        TO  PI-CR-FIN-RESP.
  8682
  8683     IF EIBAID  =  DFHPF5  OR  GENERAL-AGENT
  8684         MOVE LOW-VALUES         TO  ERCOMP-ACCT
  8685         MOVE 'G'                TO  ERCOMP-RECORD-TYPE
  8686     ELSE
  8687         MOVE PI-SAV-ACCT-AGT    TO  ERCOMP-ACCT
  8688         MOVE 'A'                TO  ERCOMP-RECORD-TYPE.
  8689
  8690     IF ERCOMP-KEY  =  ERCOMP-PREV-KEY
  8691         GO TO 6090-EXIT.
  8692
  8693     MOVE ERCOMP-KEY             TO  ERCOMP-PREV-KEY.
  8694
  8695
  8696* EXEC CICS READ
  8697*        DATASET  (ERCOMP-FILE-ID)
  8698*        SET      (ADDRESS OF COMPENSATION-MASTER)
  8699*        RIDFLD   (ERCOMP-KEY)
  8700*        RESP     (WS-RESPONSE)
  8701*    END-EXEC.
  8702*    MOVE '&"S        E          (  N#00008310' TO DFHEIV0
  8703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8705     MOVE X'204E233030303038333130' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
  8707           ERCOMP-FILE-ID,
  8708           DFHEIV20,
  8709           DFHEIV99,
  8710           ERCOMP-KEY,
  8711           DFHEIV99,
  8712           DFHEIV99,
  8713           DFHEIV99
  8714     SET ADDRESS OF COMPENSATION-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL642.cbl
  8715         DFHEIV20
  8716     MOVE EIBRESP  TO WS-RESPONSE
  8717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8718
  8719
  8720     IF NOT RESP-NORMAL
  8721        IF ERCOMP-RECORD-TYPE = 'G'
  8722           MOVE 'B'              TO ERCOMP-RECORD-TYPE
  8723
  8724* EXEC CICS READ
  8725*             DATASET (ERCOMP-FILE-ID)
  8726*             SET     (ADDRESS OF COMPENSATION-MASTER)
  8727*             RIDFLD  (ERCOMP-KEY)
  8728*          END-EXEC
  8729*    MOVE '&"S        E          (   #00008320' TO DFHEIV0
  8730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8732     MOVE X'2020233030303038333230' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0,
  8734           ERCOMP-FILE-ID,
  8735           DFHEIV20,
  8736           DFHEIV99,
  8737           ERCOMP-KEY,
  8738           DFHEIV99,
  8739           DFHEIV99,
  8740           DFHEIV99
  8741     SET ADDRESS OF COMPENSATION-MASTER TO
  8742         DFHEIV20
  8743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8744        END-IF
  8745     END-IF
  8746
  8747     IF PI-MAP-NAME  =  EL642B
  8748         GO TO 6090-EXIT.
  8749
  8750     IF GENERAL-AGENT
  8751         MOVE CO-CURRENT-END-BAL TO  PI-BAL-FRWD
  8752     ELSE
  8753         IF PI-SAV-AGENT  =  PI-SAV-REMIT-TO
  8754             MOVE CO-CURRENT-END-BAL
  8755                                 TO  WS-ACCT-BEG-BAL
  8756             GO TO 6090-EXIT
  8757         ELSE
  8758             MOVE ZEROS          TO  WS-ACCT-BEG-BAL
  8759             GO TO 6090-EXIT.
  8760
  8761     IF PI-UPDATE-FILES
  8762       OR  (PI-PREVIEW  AND  APRODSWI  =  'Y')
  8763         NEXT SENTENCE
  8764     ELSE
  8765         GO TO 6090-EXIT.
  8766
  8767 6002-FORMAT-ADDRESS-LOOP.
  8768     MOVE CO-ACCT-NAME           TO  PI-AGENT-NAME.
  8769     MOVE CO-MAIL-NAME           TO  WS-AGENT-LINES (1).
  8770     MOVE CO-ACCT-NAME           TO  WS-AGENT-LINES (2).
  8771     MOVE CO-ADDR-1              TO  WS-AGENT-LINES (3).
  8772     MOVE CO-ADDR-2              TO  WS-AGENT-LINES (4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL642.cbl
  8773     MOVE CO-ADDR-3              TO  WS-AGENT-LINES (5).
  8774     MOVE CO-ZIP                 TO  WS-AGENT-LINES (6).
  8775
  8776 6060-FORMAT-ADDRESS-LOOP.
  8777     IF WS-AGENT-ADDR-AREA  =  SPACES
  8778         GO TO 6090-EXIT.
  8779
  8780     IF WS-AGENT-LINES (1)  =  SPACES
  8781         MOVE WS-AGENT-LINES (2)  TO  WS-AGENT-LINES (1)
  8782         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8783         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8784         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8785         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8786         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8787         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8788
  8789     IF WS-AGENT-LINES (2)  =  SPACES
  8790       AND  WS-AGENT-LINES (3)  =  SPACES
  8791       AND  WS-AGENT-LINES (4)  =  SPACES
  8792       AND  WS-AGENT-LINES (5)  =  SPACES
  8793       AND  WS-AGENT-LINES (6)  =  SPACES
  8794         GO TO 6065-MOVE-ZIP.
  8795
  8796     IF WS-AGENT-LINES (2)  =  SPACES
  8797         MOVE WS-AGENT-LINES (3)  TO  WS-AGENT-LINES (2)
  8798         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8799         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8800         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8801         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8802         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8803
  8804     IF WS-AGENT-LINES (3)  =  SPACES
  8805       AND  WS-AGENT-LINES (4)  =  SPACES
  8806       AND  WS-AGENT-LINES (5)  =  SPACES
  8807       AND  WS-AGENT-LINES (6)  =  SPACES
  8808         GO TO 6065-MOVE-ZIP.
  8809
  8810     IF WS-AGENT-LINES (3)  =  SPACES
  8811         MOVE WS-AGENT-LINES (4)  TO  WS-AGENT-LINES (3)
  8812         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8813         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8814         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8815         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8816
  8817     IF WS-AGENT-LINES (4)  =  SPACES
  8818       AND  WS-AGENT-LINES (5)  =  SPACES
  8819       AND  WS-AGENT-LINES (6)  =  SPACES
  8820         GO TO 6065-MOVE-ZIP.
  8821
  8822     IF WS-AGENT-LINES (4)  =  SPACES
  8823         MOVE WS-AGENT-LINES (5)  TO  WS-AGENT-LINES (4)
  8824         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8825         MOVE SPACES              TO  WS-AGENT-LINES (6)
  8826         GO TO 6060-FORMAT-ADDRESS-LOOP.
  8827
  8828     IF WS-AGENT-LINES (5)  =  SPACES
  8829         MOVE WS-AGENT-LINES (6)  TO  WS-AGENT-LINES (5)
  8830         MOVE SPACES              TO  WS-AGENT-LINES (6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL642.cbl
  8831
  8832 6065-MOVE-ZIP.
  8833
  8834     IF WS-AGENT-LINES (6) NOT =  SPACES
  8835         IF CO-CANADIAN-POST-CODE
  8836                 OR
  8837            WS-AGENT-1ST-ZIP (6)  NOT =  ZEROS
  8838             MOVE WS-AGENT-ZIP (6)
  8839                                 TO  WS-A-LAST-ZIP (5)
  8840             MOVE SPACES         TO  WS-AGENT-LINES (6)
  8841         ELSE
  8842             MOVE WS-AGENT-2ND-ZIP (5)
  8843                                 TO  WS-A-LAST-2ND-ZIP (4)
  8844             MOVE SPACES         TO  WS-AGENT-LINES (5)
  8845     ELSE
  8846         IF WS-AGENT-LINES (5) NOT =  SPACES
  8847             IF CO-CANADIAN-POST-CODE
  8848                     OR
  8849                WS-AGENT-1ST-ZIP (5)  NOT =  ZEROS
  8850                 MOVE WS-AGENT-ZIP (5)
  8851                                 TO  WS-A-LAST-ZIP (5)
  8852                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8853             ELSE
  8854                 MOVE WS-AGENT-2ND-ZIP (5)
  8855                                 TO  WS-A-LAST-2ND-ZIP (5)
  8856                 MOVE SPACES     TO  WS-AGENT-ZIP (5)
  8857         ELSE
  8858             IF WS-AGENT-LINES (4) NOT =  SPACES
  8859                 IF CO-CANADIAN-POST-CODE
  8860                         OR
  8861                    WS-AGENT-1ST-ZIP (4)  NOT =  ZEROS
  8862                     MOVE WS-AGENT-ZIP (4)
  8863                                 TO  WS-A-LAST-ZIP (4)
  8864                     MOVE SPACES TO  WS-AGENT-ZIP (4)
  8865                 ELSE
  8866                     MOVE WS-AGENT-2ND-ZIP (4)
  8867                                 TO  WS-A-LAST-2ND-ZIP (4)
  8868                     MOVE SPACES TO  WS-AGENT-ZIP (4).
  8869
  8870     MOVE 'GA'                   TO  BILLING-DETAIL-TYPE.
  8871
  8872     PERFORM 3000-WRITE-BILLING-DETAIL  THRU  3990-EXIT.
  8873
  8874     GO TO 6090-EXIT.
  8875
  8876 6070-NO-COMP-MSTR.
  8877     IF GENERAL-AGENT
  8878         MOVE -1                 TO  AAGENTL
  8879         MOVE ER-2230            TO  EMI-ERROR
  8880         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8881         GO TO 8200-SEND-DATAONLY.
  8882
  8883     MOVE ZEROS                  TO  WS-ACCT-BEG-BAL.
  8884
  8885     GO TO 6090-EXIT.
  8886
  8887 6090-EXIT.
  8888     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL642.cbl
  8890 6100-READ-CONTROL-FILE.
  8891     MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY-ID.
  8892     MOVE +0                     TO  ELCNTL-SEQ-NO.
  8893
  8894
  8895* EXEC CICS HANDLE CONDITION
  8896*        NOTFND  (6110-NO-RECORD)
  8897*    END-EXEC.
  8898*    MOVE '"$I                   ! - #00008475' TO DFHEIV0
  8899     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8901     MOVE X'2D20233030303038343735' TO DFHEIV0(25:11)
  8902     CALL 'kxdfhei1' USING DFHEIV0
  8903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8904
  8905
  8906     IF NOT  ELCNTL-UPDATE
  8907
  8908* EXEC CICS READ
  8909*            DATASET  (ELCNTL-FILE-ID)
  8910*            SET      (ADDRESS OF CONTROL-FILE)
  8911*            RIDFLD   (ELCNTL-KEY)
  8912*        END-EXEC
  8913*    MOVE '&"S        E          (   #00008480' TO DFHEIV0
  8914     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8916     MOVE X'2020233030303038343830' TO DFHEIV0(25:11)
  8917     CALL 'kxdfhei1' USING DFHEIV0,
  8918           ELCNTL-FILE-ID,
  8919           DFHEIV20,
  8920           DFHEIV99,
  8921           ELCNTL-KEY,
  8922           DFHEIV99,
  8923           DFHEIV99,
  8924           DFHEIV99
  8925     SET ADDRESS OF CONTROL-FILE TO
  8926         DFHEIV20
  8927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8928     ELSE
  8929         MOVE SPACE              TO  ELCNTL-UPDATE-SW
  8930
  8931* EXEC CICS READ
  8932*            DATASET  (ELCNTL-FILE-ID)
  8933*            SET      (ADDRESS OF CONTROL-FILE)
  8934*            RIDFLD   (ELCNTL-KEY)
  8935*            UPDATE
  8936*        END-EXEC.
  8937*    MOVE '&"S        EU         (   #00008487' TO DFHEIV0
  8938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8939     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038343837' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           ELCNTL-FILE-ID,
  8943           DFHEIV20,
  8944           DFHEIV99,
  8945           ELCNTL-KEY,
  8946           DFHEIV99,
  8947           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL642.cbl
  8948           DFHEIV99
  8949     SET ADDRESS OF CONTROL-FILE TO
  8950         DFHEIV20
  8951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8952
  8953
  8954     GO TO 6120-EXIT.
  8955
  8956 6110-NO-RECORD.
  8957     IF ELCNTL-REC-TYPE  =  1
  8958         MOVE ER-0022            TO  EMI-ERROR
  8959     ELSE
  8960         MOVE ER-2208            TO  EMI-ERROR
  8961         MOVE -1                 TO  ACARIERL
  8962         MOVE AL-UABON           TO  ACARIERA
  8963
  8964     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8965
  8966 6120-EXIT.
  8967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL642.cbl
  8969 6130-FIND-BENEFIT-CD.
  8970
  8971* EXEC CICS READ
  8972*       DATASET (ELCNTL-FILE-ID)
  8973*       SET     (ADDRESS OF CONTROL-FILE)
  8974*       RIDFLD  (ELCNTL-KEY)
  8975*       GTEQ
  8976*       RESP    (WS-RESPONSE)
  8977*    END-EXEC
  8978*    MOVE '&"S        G          (  N#00008510' TO DFHEIV0
  8979     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8980     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8981     MOVE X'204E233030303038353130' TO DFHEIV0(25:11)
  8982     CALL 'kxdfhei1' USING DFHEIV0,
  8983           ELCNTL-FILE-ID,
  8984           DFHEIV20,
  8985           DFHEIV99,
  8986           ELCNTL-KEY,
  8987           DFHEIV99,
  8988           DFHEIV99,
  8989           DFHEIV99
  8990     SET ADDRESS OF CONTROL-FILE TO
  8991         DFHEIV20
  8992     MOVE EIBRESP  TO WS-RESPONSE
  8993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8994     IF RESP-NORMAL
  8995        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  8996           AND (CF-RECORD-TYPE = '5')
  8997           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8998              (S1 > +8)
  8999              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9000           END-PERFORM
  9001           IF S1 NOT > +8
  9002              MOVE CF-BENEFIT-CATEGORY (S1)
  9003                                 TO WS-AH-CATEGORY
  9004              GO TO 6140-EXIT
  9005           END-IF
  9006        END-IF
  9007     END-IF
  9008     .
  9009 6140-NO-RECORD.
  9010     MOVE ER-0028                TO EMI-ERROR
  9011     MOVE -1                     TO ACARIERL
  9012     MOVE AL-UABON               TO ACARIERA
  9013     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9014     .
  9015 6140-EXIT.
  9016     EXIT.
  9017 6200-REWRITE-CONTROL-FILE.
  9018     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9019     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9020     MOVE ELCNTL-FILE-ID         TO  JP-FILE-ID.
  9021
  9022     COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23.
  9023
  9024
  9025* EXEC CICS REWRITE
  9026*        DATASET  (ELCNTL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL642.cbl
  9027*        FROM     (CONTROL-FILE)
  9028*    END-EXEC.
  9029     MOVE LENGTH OF
  9030      CONTROL-FILE
  9031       TO DFHEIV11
  9032*    MOVE '&& L                  %   #00008547' TO DFHEIV0
  9033     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9034     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9035     MOVE X'2020233030303038353437' TO DFHEIV0(25:11)
  9036     CALL 'kxdfhei1' USING DFHEIV0,
  9037           ELCNTL-FILE-ID,
  9038           CONTROL-FILE,
  9039           DFHEIV11,
  9040           DFHEIV99
  9041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9042
  9043
  9044     PERFORM 8400-LOG-JOURNAL-RECORD.
  9045
  9046 6290-EXIT.
  9047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL642.cbl
  9049 6400-READ-CROSS-REFERENCE.
  9050     MOVE PI-COMPANY-CD          TO  ERGXRF-COMPANY-CD.
  9051     MOVE PI-SAV-AGENT           TO  ERGXRF-AGENT-NO.
  9052
  9053     IF NOT  PI-ZERO-CARRIER
  9054       AND  NOT  PI-ZERO-CAR-GROUP
  9055         MOVE PI-CR-CARRIER      TO  ERGXRF-CARRIER
  9056     ELSE
  9057         MOVE ZEROS              TO  ERGXRF-CARRIER.
  9058
  9059     IF NOT  PI-ZERO-GROUPING
  9060       AND  NOT  PI-ZERO-CAR-GROUP
  9061         MOVE PI-CR-GROUPING     TO  ERGXRF-GROUPING
  9062     ELSE
  9063         MOVE ZEROS              TO  ERGXRF-GROUPING.
  9064
  9065
  9066* EXEC CICS HANDLE CONDITION
  9067*        NOTFND  (6410-NOT-FOUND)
  9068*    END-EXEC.
  9069*    MOVE '"$I                   ! . #00008573' TO DFHEIV0
  9070     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9071     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9072     MOVE X'2E20233030303038353733' TO DFHEIV0(25:11)
  9073     CALL 'kxdfhei1' USING DFHEIV0
  9074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9075
  9076
  9077
  9078* EXEC CICS READ
  9079*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  9080*        DATASET  (ERGXRF-FILE-ID)
  9081*        RIDFLD   (ERGXRF-KEY)
  9082*        LENGTH   (ERGXRF-LENGTH)
  9083*        UPDATE
  9084*    END-EXEC.
  9085*    MOVE '&"SL       EU         (   #00008577' TO DFHEIV0
  9086     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  9087     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9088     MOVE X'2020233030303038353737' TO DFHEIV0(25:11)
  9089     CALL 'kxdfhei1' USING DFHEIV0,
  9090           ERGXRF-FILE-ID,
  9091           DFHEIV20,
  9092           ERGXRF-LENGTH,
  9093           ERGXRF-KEY,
  9094           DFHEIV99,
  9095           DFHEIV99,
  9096           DFHEIV99
  9097     SET ADDRESS OF AGENT-CROSS-REFERENCE TO
  9098         DFHEIV20
  9099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9100
  9101
  9102     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  9103
  9104     IF PI-UPDATE-FILES
  9105         MOVE 'B'                TO  JP-RECORD-TYPE
  9106         MOVE AGENT-CROSS-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL642.cbl
  9107                                 TO  JP-RECORD-AREA
  9108         MOVE ERGXRF-FILE-ID     TO  JP-FILE-ID
  9109         COMPUTE JOURNAL-LENGTH = ERGXRF-LENGTH + 23
  9110         PERFORM 8400-LOG-JOURNAL-RECORD.
  9111
  9112     GO TO 6490-EXIT.
  9113
  9114 6410-NOT-FOUND.
  9115     MOVE -1                     TO  AAGENTL.
  9116     MOVE ER-2911                TO  EMI-ERROR.
  9117
  9118     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9119
  9120     GO TO 8200-SEND-DATAONLY.
  9121
  9122 6490-EXIT.
  9123     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL642.cbl
  9125 6500-REWRITE-CROSS-REFERENCE.
  9126     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9127     MOVE AGENT-CROSS-REFERENCE  TO  JP-RECORD-AREA.
  9128     MOVE ERGXRF-FILE-ID         TO  JP-FILE-ID.
  9129
  9130
  9131* EXEC CICS REWRITE
  9132*        DATASET  (ERGXRF-FILE-ID)
  9133*        FROM     (AGENT-CROSS-REFERENCE)
  9134*        LENGTH   (ERGXRF-LENGTH)
  9135*    END-EXEC.
  9136*    MOVE '&& L                  %   #00008613' TO DFHEIV0
  9137     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9138     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9139     MOVE X'2020233030303038363133' TO DFHEIV0(25:11)
  9140     CALL 'kxdfhei1' USING DFHEIV0,
  9141           ERGXRF-FILE-ID,
  9142           AGENT-CROSS-REFERENCE,
  9143           ERGXRF-LENGTH,
  9144           DFHEIV99
  9145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9146
  9147
  9148     PERFORM 8400-LOG-JOURNAL-RECORD.
  9149
  9150 6590-EXIT.
  9151     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL642.cbl
  9153 6600-READ-COMMISSION-EXCEPTION.
  9154
  9155* EXEC CICS HANDLE CONDITION
  9156*        NOTFND  (6610-NOT-FOUND)
  9157*    END-EXEC.
  9158*    MOVE '"$I                   ! / #00008625' TO DFHEIV0
  9159     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9161     MOVE X'2F20233030303038363235' TO DFHEIV0(25:11)
  9162     CALL 'kxdfhei1' USING DFHEIV0
  9163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9164
  9165
  9166     MOVE 'Y'                    TO ERCOMM-FOUND-SW.
  9167     MOVE PB-CONTROL-BY-ACCOUNT  TO  ERCOMM-KEY.
  9168     MOVE PB-SV-CARRIER          TO  ERCOMM-CARRIER.
  9169     MOVE PB-SV-GROUPING         TO  ERCOMM-GROUPING.
  9170     MOVE PB-SV-STATE            TO  ERCOMM-STATE.
  9171
  9172
  9173* EXEC CICS READ
  9174*        SET      (ADDRESS OF COMMISSION-EXCEPTIONS)
  9175*        DATASET  (ERCOMM-FILE-ID)
  9176*        RIDFLD   (ERCOMM-KEY)
  9177*    END-EXEC.
  9178*    MOVE '&"S        E          (   #00008635' TO DFHEIV0
  9179     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9181     MOVE X'2020233030303038363335' TO DFHEIV0(25:11)
  9182     CALL 'kxdfhei1' USING DFHEIV0,
  9183           ERCOMM-FILE-ID,
  9184           DFHEIV20,
  9185           DFHEIV99,
  9186           ERCOMM-KEY,
  9187           DFHEIV99,
  9188           DFHEIV99,
  9189           DFHEIV99
  9190     SET ADDRESS OF COMMISSION-EXCEPTIONS TO
  9191         DFHEIV20
  9192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9193
  9194
  9195     GO TO 6620-EXIT.
  9196
  9197 6610-NOT-FOUND.
  9198     MOVE 'N'                    TO  ERCOMM-FOUND-SW.
  9199
  9200 6620-EXIT.
  9201     EXIT.
  9202
  9203**START***********************************************************
  9204*      CUSTOM CODING FOR CLIENT "DMD"
  9205******************************************************************
  9206*
  9207 6650-GET-RES-STATE-COMM.
  9208*6650-BROWSE-FORWARD.
  9209
  9210     IF PB-COMPANY-ID NOT = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL642.cbl
  9211         GO TO 6700-COMM-EXIT.
  9212
  9213     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
  9214     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
  9215     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
  9216     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
  9217     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
  9218     MOVE AM-AGT (WS-GA-LEVEL) TO WS-ERRESC-AGENT.
  9219     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
  9220
  9221*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
  9222*
  9223     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
  9224     SET BIN-TO-GREG          TO TRUE.
  9225     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9226
  9227     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
  9228
  9229     IF DC-GREG-DATE-1-YMD (1:2) IS LESS THAN '10'
  9230         MOVE '20'            TO WS-CONTRACT-DATE (1:2)
  9231     ELSE
  9232         MOVE '19'            TO WS-CONTRACT-DATE (1:2).
  9233
  9234     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
  9235
  9236
  9237* EXEC CICS HANDLE CONDITION
  9238*        INVREQ    (6660-START-BROWSE)
  9239*        NOTFND    (6700-COMM-EXIT)
  9240*    END-EXEC.
  9241*    MOVE '"$8I                  ! 0 #00008682' TO DFHEIV0
  9242     MOVE X'222438492020202020202020' TO DFHEIV0(1:12)
  9243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9244     MOVE X'3020233030303038363832' TO DFHEIV0(25:11)
  9245     CALL 'kxdfhei1' USING DFHEIV0
  9246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9247
  9248
  9249
  9250* EXEC CICS RESETBR
  9251*        DATASET (ERRESC-FILE-ID)
  9252*        RIDFLD  (WS-ERRESC-KEY)
  9253*    END-EXEC.
  9254     MOVE 0
  9255       TO DFHEIV11
  9256*    MOVE '&4         G          &   #00008687' TO DFHEIV0
  9257     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
  9258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9259     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
  9260     CALL 'kxdfhei1' USING DFHEIV0,
  9261           ERRESC-FILE-ID,
  9262           WS-ERRESC-KEY,
  9263           DFHEIV99,
  9264           DFHEIV11,
  9265           DFHEIV99
  9266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9267
  9268
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL642.cbl
  9269 6660-START-BROWSE.
  9270
  9271
  9272* EXEC CICS HANDLE CONDITION
  9273*        NOTFND    (6700-COMM-EXIT)
  9274*        ENDFILE   (6700-COMM-EXIT)
  9275*    END-EXEC.
  9276*    MOVE '"$I''                  ! 1 #00008694' TO DFHEIV0
  9277     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9279     MOVE X'3120233030303038363934' TO DFHEIV0(25:11)
  9280     CALL 'kxdfhei1' USING DFHEIV0
  9281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9282
  9283
  9284
  9285* EXEC CICS STARTBR
  9286*        DATASET (ERRESC-FILE-ID)
  9287*        RIDFLD  (WS-ERRESC-KEY)
  9288*        GTEQ
  9289*    END-EXEC.
  9290     MOVE 0
  9291       TO DFHEIV11
  9292*    MOVE '&,         G          &   #00008699' TO DFHEIV0
  9293     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9295     MOVE X'2020233030303038363939' TO DFHEIV0(25:11)
  9296     CALL 'kxdfhei1' USING DFHEIV0,
  9297           ERRESC-FILE-ID,
  9298           WS-ERRESC-KEY,
  9299           DFHEIV99,
  9300           DFHEIV11,
  9301           DFHEIV99
  9302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9303
  9304
  9305     MOVE WS-ERRESC-KEY           TO WS-SV-ERRESC-KEY.
  9306
  9307 6670-READ-NEXT-ERRESC-MASTER.
  9308
  9309
  9310* EXEC CICS HANDLE CONDITION
  9311*        NOTFND    (6700-COMM-EXIT)
  9312*        ENDFILE   (6700-COMM-EXIT)
  9313*    END-EXEC.
  9314*    MOVE '"$I''                  ! 2 #00008709' TO DFHEIV0
  9315     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9317     MOVE X'3220233030303038373039' TO DFHEIV0(25:11)
  9318     CALL 'kxdfhei1' USING DFHEIV0
  9319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9320
  9321
  9322
  9323* EXEC CICS READNEXT
  9324*        SET      (ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION)
  9325*        DATASET (ERRESC-FILE-ID)
  9326*        RIDFLD  (WS-ERRESC-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL642.cbl
  9327*    END-EXEC.
  9328     MOVE 0
  9329       TO DFHEIV11
  9330*    MOVE '&.S                   )   #00008714' TO DFHEIV0
  9331     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9332     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9333     MOVE X'2020233030303038373134' TO DFHEIV0(25:11)
  9334     CALL 'kxdfhei1' USING DFHEIV0,
  9335           ERRESC-FILE-ID,
  9336           DFHEIV20,
  9337           DFHEIV99,
  9338           WS-ERRESC-KEY,
  9339           DFHEIV99,
  9340           DFHEIV11,
  9341           DFHEIV99,
  9342           DFHEIV99
  9343     SET ADDRESS OF ACCOUNT-RESIDENT-ST-COMMISSION TO
  9344         DFHEIV20
  9345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9346
  9347
  9348     IF ERRESC-RECORD-KEY (1:32) = WS-SV-ERRESC-KEY
  9349        NEXT SENTENCE
  9350     ELSE
  9351
  9352* EXEC CICS ENDBR
  9353*            DATASET (ERRESC-FILE-ID)
  9354*       END-EXEC
  9355     MOVE 0
  9356       TO DFHEIV11
  9357*    MOVE '&2                    $   #00008723' TO DFHEIV0
  9358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9360     MOVE X'2020233030303038373233' TO DFHEIV0(25:11)
  9361     CALL 'kxdfhei1' USING DFHEIV0,
  9362           ERRESC-FILE-ID,
  9363           DFHEIV11,
  9364           DFHEIV99
  9365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9366        GO TO 6700-COMM-EXIT.
  9367
  9368* CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT
  9369* STATE COMMISSIONS RECORD'S EFFECT TIME PERIOD????
  9370     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
  9371
  9372* EXEC CICS ENDBR
  9373*            DATASET (ERRESC-FILE-ID)
  9374*       END-EXEC
  9375     MOVE 0
  9376       TO DFHEIV11
  9377*    MOVE '&2                    $   #00008731' TO DFHEIV0
  9378     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9380     MOVE X'2020233030303038373331' TO DFHEIV0(25:11)
  9381     CALL 'kxdfhei1' USING DFHEIV0,
  9382           ERRESC-FILE-ID,
  9383           DFHEIV11,
  9384           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL642.cbl
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9386        GO TO 6700-COMM-EXIT.
  9387
  9388* SEARCH FOR MATCHING CATEGORY CODE ENTRY
  9389*
  9390*    IF RESC-COMMISSION IS NUMERIC THAT IS THE COMMISSION TO OVER-
  9391*    RIDE AH OR LIFE COMMISSION IN IN THE ACCOUNT MASTER.
  9392*    IF RESC-COMMISSION NOT NUMERIC, USE VALUE TO GET COMMISSION
  9393*    FROM COMMISSION TABLE IF RECORD EXISTS.
  9394*
  9395     MOVE ZEROS               TO WS-SUB WS-SUB1.
  9396
  9397     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
  9398
  9399     IF WS-SUB1 IS GREATER THAN ZERO
  9400         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
  9401             PERFORM 6680-SET-COMMISSION
  9402         ELSE
  9403             PERFORM 6680-SET-TABLE-CODE.
  9404
  9405
  9406* EXEC CICS ENDBR
  9407*         DATASET (ERRESC-FILE-ID)
  9408*    END-EXEC.
  9409     MOVE 0
  9410       TO DFHEIV11
  9411*    MOVE '&2                    $   #00008753' TO DFHEIV0
  9412     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9414     MOVE X'2020233030303038373533' TO DFHEIV0(25:11)
  9415     CALL 'kxdfhei1' USING DFHEIV0,
  9416           ERRESC-FILE-ID,
  9417           DFHEIV11,
  9418           DFHEIV99
  9419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9420
  9421
  9422     GO TO 6700-COMM-EXIT.
  9423
  9424 6680-SET-TABLE-CODE.
  9425     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
  9426        MOVE ZEROS             TO WS-SUB1
  9427     ELSE
  9428
  9429* READ COMMISSION TABLE(CTBL)  KEY VALUES PRESET IN CALLING
  9430* PARAGRAPHS(4405-FIND-AH, 4420-CONT-FIND-LIFE, 4430-SINGLE-LIFE)
  9431
  9432     MOVE RESC-COMMISSION-TAB (WS-SUB) TO ERCTBL-TABLE
  9433     PERFORM 6680-READ-CTBL-TABLE.
  9434
  9435 6680-READ-CTBL-TABLE.
  9436*
  9437* READ COMMISSION TABLE TO VERIFY IF ACCOUNT RESIDENT STATE
  9438* COMMISSION RECORD CONTAINS A VALID COMPENSATION TABLE CODE.
  9439* IF CODE IS NOT VALID USE CODE IN ACCOUNT MASTER
  9440
  9441     PERFORM 6700-READ-COMMISSION-TABLE THRU 6790-EXIT.
  9442
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL642.cbl
  9443     IF ERCTBL-NOT-FOUND
  9444         MOVE 'AA'               TO  ERCTBL-BEN-CODE
  9445         PERFORM 6700-READ-COMMISSION-TABLE  THRU  6790-EXIT
  9446         IF ERCTBL-NOT-FOUND
  9447             MOVE ZEROS          TO  WS-SUB1.
  9448
  9449     IF ERCTBL-FOUND
  9450        IF AH-COMM
  9451            PERFORM 6680-AH-GET-COMP-RATE
  9452        ELSE
  9453            PERFORM 6680-LF-GET-COMP-RATE.
  9454
  9455 6680-AH-GET-COMP-RATE.
  9456     IF PB-ISSUE
  9457         COMPUTE WS-COMM-CK-AMT =
  9458             PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9459         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9460         MOVE PB-I-AH-TERM       TO  WS-COMM-TERM
  9461     ELSE
  9462         COMPUTE WS-COMM-CK-AMT =
  9463             PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9464         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9465         MOVE PB-CI-AH-TERM      TO  WS-COMM-TERM.
  9466
  9467     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9468
  9469     MOVE WS-WK-RATE             TO  WS-GA-AH-COM.
  9470
  9471 6680-LF-GET-COMP-RATE.
  9472     IF PB-ISSUE
  9473         MOVE PB-I-LF-BENEFIT-AMT
  9474                                 TO  WS-COMM-CK-AMT
  9475         MOVE PB-I-AGE           TO  WS-COMM-AGE
  9476         MOVE PB-I-LF-TERM       TO  WS-COMM-TERM
  9477     ELSE
  9478         MOVE PB-CI-INSURED-AGE  TO  WS-COMM-AGE
  9479         MOVE PB-CI-LF-TERM      TO  WS-COMM-TERM
  9480         MOVE PB-CI-LF-BENEFIT-AMT
  9481                                 TO  WS-COMM-CK-AMT.
  9482
  9483     PERFORM 4900-GET-COMP-RATE  THRU  4990-EXIT.
  9484
  9485     MOVE WS-WK-RATE             TO  WS-GA-LF-COM.
  9486
  9487 6680-SET-COMMISSION.
  9488     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
  9489           MOVE ZEROS          TO WS-SUB1
  9490       ELSE
  9491           MOVE RESC-COMMISSION-PER (WS-SUB)
  9492                              TO WS-COMMISSION
  9493           IF AH-COMM
  9494              MOVE WS-COMMISSION TO WS-GA-AH-COM
  9495           ELSE
  9496              MOVE WS-COMMISSION TO WS-GA-LF-COM.
  9497
  9498 6680-SEARCH-CATEGORY.
  9499     ADD +1 TO WS-SUB.
  9500     IF WS-SUB IS GREATER THAN +12
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL642.cbl
  9501         GO TO 6680-EXIT.
  9502
  9503     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
  9504          MOVE WS-SUB         TO WS-SUB1
  9505          GO TO 6680-EXIT.
  9506
  9507     GO TO 6680-SEARCH-CATEGORY.
  9508
  9509 6680-EXIT.
  9510     EXIT.
  9511
  9512 6700-COMM-EXIT.
  9513     EXIT.
  9514**END*************************************************************
  9515*      CUSTOM CODING FOR CLIENT "DMD"
  9516******************************************************************
  9517*
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL642.cbl
  9519 6700-READ-COMMISSION-TABLE.
  9520
  9521* EXEC CICS HANDLE CONDITION
  9522*        NOTFND  (6710-NOT-FOUND)
  9523*    END-EXEC.
  9524*    MOVE '"$I                   ! 3 #00008855' TO DFHEIV0
  9525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9527     MOVE X'3320233030303038383535' TO DFHEIV0(25:11)
  9528     CALL 'kxdfhei1' USING DFHEIV0
  9529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9530
  9531
  9532     MOVE 'Y'                    TO  ERCTBL-FOUND-SW.
  9533
  9534
  9535* EXEC CICS READ
  9536*        SET      (ADDRESS OF COMM-TABLE-RECORD)
  9537*        DATASET  (ERCTBL-FILE-ID)
  9538*        RIDFLD   (ERCTBL-KEY)
  9539*    END-EXEC.
  9540*    MOVE '&"S        E          (   #00008861' TO DFHEIV0
  9541     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9543     MOVE X'2020233030303038383631' TO DFHEIV0(25:11)
  9544     CALL 'kxdfhei1' USING DFHEIV0,
  9545           ERCTBL-FILE-ID,
  9546           DFHEIV20,
  9547           DFHEIV99,
  9548           ERCTBL-KEY,
  9549           DFHEIV99,
  9550           DFHEIV99,
  9551           DFHEIV99
  9552     SET ADDRESS OF COMM-TABLE-RECORD TO
  9553         DFHEIV20
  9554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9555
  9556
  9557     GO TO 6790-EXIT.
  9558
  9559 6710-NOT-FOUND.
  9560     MOVE 'N'                    TO  ERCTBL-FOUND-SW.
  9561
  9562 6790-EXIT.
  9563     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL642.cbl
  9565 6800-READ-BENEFIT-MASTER.
  9566
  9567* EXEC CICS HANDLE CONDITION
  9568*        NOTFND  (6880-NOT-FOUND)
  9569*    END-EXEC.
  9570*    MOVE '"$I                   ! 4 #00008876' TO DFHEIV0
  9571     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9573     MOVE X'3420233030303038383736' TO DFHEIV0(25:11)
  9574     CALL 'kxdfhei1' USING DFHEIV0
  9575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9576
  9577
  9578     MOVE 'Y'                    TO  BENEFIT-MASTER-FOUND-SW.
  9579     MOVE PB-COMPANY-ID          TO  CLBENF-COMPANY-ID.
  9580     MOVE '4'                    TO  CLBENF-REC-TYPE.
  9581     MOVE +0                     TO  CLBENF-SEQ-NO.
  9582
  9583
  9584* EXEC CICS READ
  9585*        SET      (ADDRESS OF CONTROL-FILE)
  9586*        DATASET  (ELCNTL-FILE-ID)
  9587*        RIDFLD   (ELCNTL-BENEFIT-KEY)
  9588*        GTEQ
  9589*    END-EXEC.
  9590*    MOVE '&"S        G          (   #00008885' TO DFHEIV0
  9591     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9592     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9593     MOVE X'2020233030303038383835' TO DFHEIV0(25:11)
  9594     CALL 'kxdfhei1' USING DFHEIV0,
  9595           ELCNTL-FILE-ID,
  9596           DFHEIV20,
  9597           DFHEIV99,
  9598           ELCNTL-BENEFIT-KEY,
  9599           DFHEIV99,
  9600           DFHEIV99,
  9601           DFHEIV99
  9602     SET ADDRESS OF CONTROL-FILE TO
  9603         DFHEIV20
  9604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9605
  9606
  9607     IF CLBENF-COMPANY-ID  NOT =  CF-COMPANY-ID
  9608         GO TO 6880-NOT-FOUND.
  9609
  9610     IF CLBENF-REC-TYPE  NOT =  CF-RECORD-TYPE
  9611         GO TO 6880-NOT-FOUND.
  9612
  9613     MOVE +0                     TO  BEN-SUB.
  9614
  9615 6810-FIND-BENEFIT.
  9616     ADD +1                      TO  BEN-SUB.
  9617
  9618     IF BEN-SUB  GREATER THAN  +8
  9619         GO TO 6880-NOT-FOUND.
  9620
  9621     IF CF-BENEFIT-CODE (BEN-SUB)  =  CLBENF-CD
  9622         MOVE CF-JOINT-INDICATOR (BEN-SUB)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL642.cbl
  9623                                 TO  LIFE-INDICATOR
  9624         GO TO 6890-EXIT.
  9625
  9626     GO TO 6810-FIND-BENEFIT.
  9627
  9628 6880-NOT-FOUND.
  9629     MOVE 'N'                    TO  BENEFIT-MASTER-FOUND-SW.
  9630
  9631 6890-EXIT.
  9632     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL642.cbl
  9634 7000-PROCESS-CHECK.
  9635     MOVE LOW-VALUES             TO  EL642BO.
  9636
  9637     MOVE 'G'                    TO  COMPENSATION-SW
  9638                                     PI-CR-TYPE.
  9639
  9640     PERFORM 6000-READ-COMP-MASTER  THRU  6090-EXIT.
  9641
  9642     IF EMI-ERROR = ZEROS
  9643         MOVE CO-MAIL-NAME       TO  BNAMEO
  9644         MOVE CO-ADDR-1          TO  BADDR1O
  9645         MOVE CO-ADDR-2          TO  BADDR2O
  9646*        MOVE CO-ADDR-3          TO  BCITYSTO
  9647         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9648            DELIMITED BY '  ' INTO BCITYSTO
  9649         END-STRING
  9650         MOVE CO-ZIP             TO  BZIPO
  9651     ELSE
  9652         MOVE EL642A             TO  PI-MAP-NAME
  9653         MOVE -1                 TO  BPFNTERL
  9654         GO TO 8200-SEND-DATAONLY.
  9655
  9656     IF PI-COMP-UNPAID-PREM  GREATER THAN  ZERO
  9657         MOVE PI-COMP-UNPAID-PREM
  9658                                 TO BCHKAMTO
  9659     ELSE
  9660         MOVE ZEROS              TO  BCHKAMTO.
  9661
  9662     MOVE AL-UNNON               TO  BCHKAMTA.
  9663     MOVE WS-CURRENT-DATE-EDIT   TO  BPAYDT1O.
  9664     MOVE -1                     TO  BCHKNOL.
  9665
  9666     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL642.cbl
  9668 7500-PRODUCE-CHECK.
  9669     MOVE SPACES                 TO  ELCNTL-KEY.
  9670     MOVE '1'                    TO  ELCNTL-REC-TYPE.
  9671     MOVE 'Y'                    TO  ELCNTL-UPDATE-SW.
  9672
  9673     PERFORM 6100-READ-CONTROL-FILE  THRU  6120-EXIT.
  9674
  9675     IF EMI-ERROR  NOT =  ZEROS
  9676         GO TO 8200-SEND-DATAONLY.
  9677
  9678     IF CR-CHECK-NO-AUTO-SEQ
  9679         MOVE 'B'                TO  JP-RECORD-TYPE
  9680         MOVE CONTROL-FILE       TO  JP-RECORD-AREA
  9681         MOVE ELCNTL-FILE-ID     TO  JP-FILE-ID
  9682         COMPUTE JOURNAL-LENGTH = ELCNTL-LENGTH + 23
  9683         PERFORM 8400-LOG-JOURNAL-RECORD
  9684         IF CR-CHECK-CNT-RESET-VALUE
  9685             MOVE CF-CR-CHECK-COUNTER
  9686                                 TO  BCHKNOI
  9687             MOVE +1             TO  CF-CR-CHECK-COUNTER
  9688             MOVE 6              TO  BCHKNOL
  9689         ELSE
  9690             MOVE CF-CR-CHECK-COUNTER
  9691                                 TO  BCHKNOI
  9692             MOVE 6              TO  BCHKNOL
  9693             ADD +1              TO  CF-CR-CHECK-COUNTER.
  9694
  9695     IF CR-CHECK-NO-MANUAL
  9696         IF BCHKNOL = ZEROS
  9697             MOVE ER-2438        TO  EMI-ERROR
  9698             MOVE -1             TO  BCHKNOL
  9699             MOVE AL-UNBON       TO  BCHKNOA
  9700             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9701             GO TO 8200-SEND-DATAONLY
  9702         ELSE
  9703             IF BCHKNOI NOT NUMERIC
  9704                 MOVE ER-2439    TO  EMI-ERROR
  9705                 MOVE -1         TO  BCHKNOL
  9706                 MOVE AL-UNBON   TO  BCHKNOA
  9707                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9708                 GO TO 8200-SEND-DATAONLY.
  9709
  9710
  9711* EXEC CICS GETMAIN
  9712*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  9713*        LENGTH   (ERPYAJ-LENGTH)
  9714*        INITIMG  (GETMAIN-SPACE)
  9715*    END-EXEC.
  9716*    MOVE ',"IL                  $   #00008995' TO DFHEIV0
  9717     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9718     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9719     MOVE X'2020233030303038393935' TO DFHEIV0(25:11)
  9720     CALL 'kxdfhei1' USING DFHEIV0,
  9721           DFHEIV20,
  9722           ERPYAJ-LENGTH,
  9723           GETMAIN-SPACE
  9724     SET ADDRESS OF PENDING-PAY-ADJ TO
  9725         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL642.cbl
  9726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9727
  9728
  9729
  9730* EXEC CICS BIF DEEDIT
  9731*        FIELD   (BCHKAMTI)
  9732*        LENGTH  (09)
  9733*    END-EXEC.
  9734     MOVE 09
  9735       TO DFHEIV11
  9736*    MOVE '@"L                   #   #00009001' TO DFHEIV0
  9737     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9738     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9739     MOVE X'2020233030303039303031' TO DFHEIV0(25:11)
  9740     CALL 'kxdfhei1' USING DFHEIV0,
  9741           BCHKAMTI,
  9742           DFHEIV11
  9743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9744
  9745
  9746     IF BCHKAMTI NOT GREATER THAN ZEROS
  9747         MOVE ER-3165    TO  EMI-ERROR
  9748         MOVE -1         TO  BCHKAMTL
  9749         MOVE AL-UNBON   TO  BCHKAMTA
  9750         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9751         GO TO 8200-SEND-DATAONLY.
  9752
  9753     MOVE 'Y'                    TO  PI-CHECK-SW.
  9754     MOVE 'PY'                   TO  PY-RECORD-ID.
  9755     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  9756     MOVE PI-SAV-CARR            TO  PY-CARRIER.
  9757     MOVE PI-SAV-GROUP           TO  PY-GROUPING.
  9758     MOVE PI-SAV-AGENT           TO  PY-FIN-RESP.
  9759     MOVE LOW-VALUES             TO  PY-ACCOUNT.
  9760     MOVE 'C'                    TO  PY-RECORD-TYPE.
  9761     MOVE EIBTIME                TO  PY-FILE-SEQ-NO.
  9762     MOVE WS-CURRENT-DATE-MDY    TO  WS-PY-CURRENT-DATE.
  9763     MOVE WS-PY-ENTRY-COMMENT    TO  PY-ENTRY-COMMENT.
  9764     MOVE BCHKAMTI               TO  PY-ENTRY-AMT.
  9765
  9766     ADD BCHKAMTI                TO  PI-DISBURSED.
  9767
  9768     IF NOT  CR-CHECK-NO-AT-PRINT
  9769         MOVE BCHKNOI            TO  PY-CHECK-NUMBER.
  9770
  9771     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  9772     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  9773     MOVE WS-CURRENT-DATE        TO  PY-LAST-MAINT-DT
  9774                                     PY-INPUT-DT.
  9775     MOVE LOW-VALUES             TO  PY-BILLED-DATE
  9776                                     PY-AR-DATE.
  9777     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  9778                                     PY-CHECK-QUE-SEQUENCE.
  9779     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  9780                                     PY-REPORTED-DT
  9781                                     PY-CHECK-WRITTEN-DT.
  9782     MOVE PI-CR-MONTH-END-DT     TO  PY-CREDIT-SELECT-DT.
  9783     MOVE 'G'                    TO  PY-CHECK-ORIGIN-SW.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL642.cbl
  9784     MOVE 'A'                    TO  JP-RECORD-TYPE.
  9785     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  9786     MOVE ERPYAJ-FILE-ID         TO  JP-FILE-ID.
  9787
  9788     COMPUTE JOURNAL-LENGTH = ERPYAJ-LENGTH + 23.
  9789
  9790
  9791* EXEC CICS WRITE
  9792*        DATASET  (ERPYAJ-FILE-ID)
  9793*        FROM     (PENDING-PAY-ADJ)
  9794*        RIDFLD   (PY-CONTROL-PRIMARY)
  9795*    END-EXEC.
  9796     MOVE LENGTH OF
  9797      PENDING-PAY-ADJ
  9798       TO DFHEIV11
  9799*    MOVE '&$ L                  ''   #00009050' TO DFHEIV0
  9800     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9801     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9802     MOVE X'2020233030303039303530' TO DFHEIV0(25:11)
  9803     CALL 'kxdfhei1' USING DFHEIV0,
  9804           ERPYAJ-FILE-ID,
  9805           PENDING-PAY-ADJ,
  9806           DFHEIV11,
  9807           PY-CONTROL-PRIMARY,
  9808           DFHEIV99,
  9809           DFHEIV99
  9810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9811
  9812
  9813     PERFORM 8400-LOG-JOURNAL-RECORD.
  9814
  9815     IF CR-CHECK-NO-AUTO-SEQ
  9816         PERFORM 6200-REWRITE-CONTROL-FILE  THRU  6290-EXIT
  9817     ELSE
  9818
  9819* EXEC CICS UNLOCK
  9820*            DATASET  (ELCNTL-FILE-ID)
  9821*        END-EXEC.
  9822*    MOVE '&*                    #   #00009061' TO DFHEIV0
  9823     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9824     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9825     MOVE X'2020233030303039303631' TO DFHEIV0(25:11)
  9826     CALL 'kxdfhei1' USING DFHEIV0,
  9827           ELCNTL-FILE-ID,
  9828           DFHEIV99
  9829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9830
  9831
  9832     MOVE EL642A                 TO  PI-MAP-NAME.
  9833
  9834     PERFORM 5000-FORMAT-SCREEN  THRU  5090-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL642.cbl
  9836 8100-SEND-INITIAL-MAP.
  9837
  9838     MOVE SPACES TO PI-TRANSFER-SW.
  9839
  9840     IF PI-MAP-NAME  =  EL642A
  9841         NEXT SENTENCE
  9842     ELSE
  9843         GO TO 8110-SEND-INITIAL-CHECK-MAP.
  9844
  9845     MOVE WS-CURRENT-DATE-EDIT   TO  ADATEO.
  9846     MOVE EIBTIME                TO  TIME-IN.
  9847     MOVE TIME-OUT               TO  ATIMEO.
  9848     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9849     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9850     MOVE -1                     TO  AAGENTL.
  9851     MOVE EMI-MESSAGE-AREA (1)   TO  AERMSG1O.
  9852     MOVE EMI-MESSAGE-AREA (2)   TO  AERMSG2O.
  9853
  9854     IF PI-ZERO-CARRIER
  9855         MOVE AL-SADOF           TO  ACARHDGA
  9856                                     ACARIERA.
  9857
  9858     IF PI-ZERO-GROUPING
  9859         MOVE AL-SADOF           TO  AGRPHDGA
  9860                                     AGROUPA.
  9861
  9862     IF PI-ZERO-CAR-GROUP
  9863         MOVE AL-SADOF           TO  ACARHDGA
  9864                                     ACARIERA
  9865         MOVE AL-SADOF           TO  AGRPHDGA
  9866                                     AGROUPA.
  9867
  9868     IF (EIBTRNID = EL633-TRANS-ID OR EL635-TRANS-ID OR
  9869                    EL633DMD-TRANS-ID OR
  9870                    EL650-TRANS-ID OR EL652-TRANS-ID OR
  9871                    EL658-TRANS-ID)    AND
  9872        (WT-CR-FIN-RESP NOT EQUAL SPACES AND LOW-VALUES)
  9873         MOVE -1                    TO  ABILTYPL
  9874         MOVE WT-CR-STATE           TO  PI-SCR-STATE
  9875         MOVE WT-CR-ACCOUNT         TO  PI-SCR-ACCOUNT
  9876         MOVE WT-CR-TYPE            TO  PI-SCR-TYPE
  9877         IF PI-ZERO-CARRIER
  9878             MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9879                                        PI-SCR-FIN-RESP
  9880             MOVE WT-CR-GROUPING    TO  AGROUPI
  9881                                        PI-SCR-GROUPING
  9882             MOVE AL-UANON          TO  AAGENTA
  9883                                        AGROUPA
  9884             MOVE 10                TO  AAGENTL
  9885             MOVE 6                 TO  AGROUPL
  9886         ELSE
  9887            IF PI-ZERO-GROUPING
  9888                MOVE WT-CR-CARRIER    TO  ACARIERI
  9889                                          PI-SCR-CARRIER
  9890                MOVE WT-CR-FIN-RESP   TO  AAGENTI
  9891                                          PI-SCR-FIN-RESP
  9892                MOVE AL-UANON         TO  ACARIERA
  9893                                          AAGENTA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL642.cbl
  9894                MOVE 10               TO  AAGENTL
  9895                MOVE 1                TO  ACARIERL
  9896            ELSE
  9897               IF PI-ZERO-CAR-GROUP
  9898                   MOVE WT-CR-FIN-RESP TO  AAGENTI
  9899                                           PI-SCR-FIN-RESP
  9900                   MOVE AL-UANON       TO  AAGENTA
  9901                   MOVE 10             TO  AAGENTL
  9902               ELSE
  9903                   MOVE WT-CR-CARRIER     TO  ACARIERI
  9904                                              PI-SCR-CARRIER
  9905                   MOVE WT-CR-FIN-RESP    TO  AAGENTI
  9906                                              PI-SCR-FIN-RESP
  9907                   MOVE WT-CR-GROUPING    TO  AGROUPI
  9908                                              PI-SCR-GROUPING
  9909                   MOVE AL-UANON          TO  AAGENTA
  9910                                              AGROUPA
  9911                                              ACARIERA
  9912                   MOVE 10                TO  AAGENTL
  9913                   MOVE 6                 TO  AGROUPL
  9914                   MOVE 1                 TO  ACARIERL.
  9915
  9916
  9917* EXEC CICS SEND
  9918*        MAP     (PI-MAP-NAME)
  9919*        MAPSET  (MAPSET-NAME)
  9920*        FROM    (EL642AO)
  9921*        ERASE
  9922*        CURSOR
  9923*    END-EXEC.
  9924     MOVE LENGTH OF
  9925      EL642AO
  9926       TO DFHEIV12
  9927     MOVE -1
  9928       TO DFHEIV11
  9929*    MOVE '8$     CT  E    H L F ,   #00009149' TO DFHEIV0
  9930     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9931     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9932     MOVE X'2020233030303039313439' TO DFHEIV0(25:11)
  9933     CALL 'kxdfhei1' USING DFHEIV0,
  9934           PI-MAP-NAME,
  9935           EL642AO,
  9936           DFHEIV12,
  9937           MAPSET-NAME,
  9938           DFHEIV99,
  9939           DFHEIV99,
  9940           DFHEIV99,
  9941           DFHEIV11,
  9942           DFHEIV99,
  9943           DFHEIV99,
  9944           DFHEIV99
  9945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9946
  9947
  9948     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL642.cbl
  9950 8110-SEND-INITIAL-CHECK-MAP.
  9951     MOVE WS-CURRENT-DATE-EDIT   TO  BDATEO.
  9952     MOVE EIBTIME                TO  TIME-IN.
  9953     MOVE TIME-OUT               TO  BTIMEO.
  9954     MOVE PI-COMPANY-ID          TO  BCMPNYO.
  9955     MOVE PI-PROCESSOR-ID        TO  BUSERIDO.
  9956     MOVE -1                     TO  BPFNTERL.
  9957     MOVE EMI-MESSAGE-AREA (1)   TO  BERMSGO.
  9958
  9959
  9960* EXEC CICS SEND
  9961*        MAP     (PI-MAP-NAME)
  9962*        MAPSET  (MAPSET-NAME)
  9963*        FROM    (EL642BO)
  9964*        ERASE
  9965*        CURSOR
  9966*    END-EXEC.
  9967     MOVE LENGTH OF
  9968      EL642BO
  9969       TO DFHEIV12
  9970     MOVE -1
  9971       TO DFHEIV11
  9972*    MOVE '8$     CT  E    H L F ,   #00009168' TO DFHEIV0
  9973     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9974     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9975     MOVE X'2020233030303039313638' TO DFHEIV0(25:11)
  9976     CALL 'kxdfhei1' USING DFHEIV0,
  9977           PI-MAP-NAME,
  9978           EL642BO,
  9979           DFHEIV12,
  9980           MAPSET-NAME,
  9981           DFHEIV99,
  9982           DFHEIV99,
  9983           DFHEIV99,
  9984           DFHEIV11,
  9985           DFHEIV99,
  9986           DFHEIV99,
  9987           DFHEIV99
  9988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9989
  9990
  9991     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL642.cbl
  9993 8200-SEND-DATAONLY.
  9994     IF PI-MAP-NAME  =  EL642A
  9995         MOVE WS-CURRENT-DATE-EDIT  TO  ADATEO
  9996         MOVE EIBTIME               TO  TIME-IN
  9997         MOVE TIME-OUT              TO  ATIMEO
  9998         MOVE PI-COMPANY-ID         TO  CMPNYIDO
  9999         MOVE PI-PROCESSOR-ID       TO  USERIDO
 10000         MOVE EMI-MESSAGE-AREA (1)  TO  AERMSG1O
 10001         MOVE EMI-MESSAGE-AREA (2)  TO  AERMSG2O
 10002
 10003* EXEC CICS SEND
 10004*            MAP     (PI-MAP-NAME)
 10005*            MAPSET  (MAPSET-NAME)
 10006*            FROM    (EL642AO)
 10007*            DATAONLY
 10008*            ERASEAUP
 10009*            CURSOR
 10010*        END-EXEC
 10011     MOVE LENGTH OF
 10012      EL642AO
 10013       TO DFHEIV12
 10014     MOVE -1
 10015       TO DFHEIV11
 10016*    MOVE '8$D    CT  A    H L F ,   #00009187' TO DFHEIV0
 10017     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10018     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10019     MOVE X'2020233030303039313837' TO DFHEIV0(25:11)
 10020     CALL 'kxdfhei1' USING DFHEIV0,
 10021           PI-MAP-NAME,
 10022           EL642AO,
 10023           DFHEIV12,
 10024           MAPSET-NAME,
 10025           DFHEIV99,
 10026           DFHEIV99,
 10027           DFHEIV99,
 10028           DFHEIV11,
 10029           DFHEIV99,
 10030           DFHEIV99,
 10031           DFHEIV99
 10032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10033     ELSE
 10034         MOVE WS-CURRENT-DATE-EDIT  TO  BDATEO
 10035         MOVE EIBTIME               TO  TIME-IN
 10036         MOVE TIME-OUT              TO  BTIMEO
 10037         MOVE PI-COMPANY-ID         TO  BCMPNYO
 10038         MOVE PI-PROCESSOR-ID       TO  BUSERIDO
 10039         MOVE EMI-MESSAGE-AREA (1)  TO  BERMSGO
 10040
 10041* EXEC CICS SEND
 10042*            MAP     (PI-MAP-NAME)
 10043*            MAPSET  (MAPSET-NAME)
 10044*            FROM    (EL642BO)
 10045*            DATAONLY
 10046*            ERASEAUP
 10047*            CURSOR
 10048*        END-EXEC.
 10049     MOVE LENGTH OF
 10050      EL642BO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL642.cbl
 10051       TO DFHEIV12
 10052     MOVE -1
 10053       TO DFHEIV11
 10054*    MOVE '8$D    CT  A    H L F ,   #00009202' TO DFHEIV0
 10055     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10056     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10057     MOVE X'2020233030303039323032' TO DFHEIV0(25:11)
 10058     CALL 'kxdfhei1' USING DFHEIV0,
 10059           PI-MAP-NAME,
 10060           EL642BO,
 10061           DFHEIV12,
 10062           MAPSET-NAME,
 10063           DFHEIV99,
 10064           DFHEIV99,
 10065           DFHEIV99,
 10066           DFHEIV11,
 10067           DFHEIV99,
 10068           DFHEIV99,
 10069           DFHEIV99
 10070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10071
 10072
 10073     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL642.cbl
 10075 8300-SEND-TEXT.
 10076
 10077* EXEC CICS SEND TEXT
 10078*        FROM    (LOGOFF-TEXT)
 10079*        LENGTH  (LOGOFF-LENGTH)
 10080*        ERASE
 10081*        FREEKB
 10082*    END-EXEC.
 10083*    MOVE '8&      T  E F  H   F -   #00009214' TO DFHEIV0
 10084     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10085     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10086     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
 10087     CALL 'kxdfhei1' USING DFHEIV0,
 10088           LOGOFF-TEXT,
 10089           LOGOFF-LENGTH,
 10090           DFHEIV99,
 10091           DFHEIV99,
 10092           DFHEIV99,
 10093           DFHEIV99,
 10094           DFHEIV99,
 10095           DFHEIV99,
 10096           DFHEIV99,
 10097           DFHEIV99,
 10098           DFHEIV99,
 10099           DFHEIV99
 10100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10101
 10102
 10103
 10104* EXEC CICS RETURN
 10105*    END-EXEC.
 10106*    MOVE '.(                    ''   #00009221' TO DFHEIV0
 10107     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10108     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10109     MOVE X'2020233030303039323231' TO DFHEIV0(25:11)
 10110     CALL 'kxdfhei1' USING DFHEIV0,
 10111           DFHEIV99,
 10112           DFHEIV99,
 10113           DFHEIV99,
 10114           DFHEIV99,
 10115           DFHEIV99,
 10116           DFHEIV99
 10117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10118
 10119
 10120 8400-LOG-JOURNAL-RECORD.
 10121     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10122     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10123
 10124*    EXEC CICS JOURNAL
 10125*        JFILEID  (PI-JOURNAL-FILE-ID)
 10126*        JTYPEID  ('EL')
 10127*        FROM     (JOURNAL-RECORD)
 10128*        LENGTH   (JOURNAL-LENGTH)
 10129*    END-EXEC.
 10130
 10131 8500-DATE-CONVERT.
 10132
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL642.cbl
 10133* EXEC CICS LINK
 10134*        PROGRAM   (LINK-ELDATCV)
 10135*        COMMAREA  (DATE-CONVERSION-DATA)
 10136*        LENGTH    (DC-COMM-LENGTH) END-EXEC.
 10137*    MOVE '."C                   (   #00009236' TO DFHEIV0
 10138     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10139     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10140     MOVE X'2020233030303039323336' TO DFHEIV0(25:11)
 10141     CALL 'kxdfhei1' USING DFHEIV0,
 10142           LINK-ELDATCV,
 10143           DATE-CONVERSION-DATA,
 10144           DC-COMM-LENGTH,
 10145           DFHEIV99,
 10146           DFHEIV99,
 10147           DFHEIV99,
 10148           DFHEIV99
 10149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10150
 10151
 10152 8500-EXIT.
 10153     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL642.cbl
 10155 8600-CENTER-DATA.
 10156     MOVE SPACE                  TO  CENTER-WORK-2.
 10157
 10158     IF CW1-PIC (1)  NOT =  SPACE
 10159       AND  CW1-PIC (X-LEN)  NOT =  SPACE
 10160         MOVE CENTER-WORK-1      TO  CENTER-WORK-2
 10161         GO TO 8690-C-D-X.
 10162
 10163     MOVE +0                     TO  X1.
 10164     MOVE X-LEN                  TO  X2.
 10165
 10166 8660-C-D-LOOP-1.
 10167     IF CW1-PIC (X2)  =  SPACE
 10168         ADD +1                  TO  X1
 10169         SUBTRACT +1             FROM  X2
 10170         GO TO 8660-C-D-LOOP-1.
 10171
 10172     MOVE +1                     TO  X2.
 10173
 10174 8670-C-D-LOOP-2.
 10175     IF CW1-PIC (X2)  =  SPACE
 10176         ADD +1                  TO  X1  X2
 10177         GO TO 8670-C-D-LOOP-2.
 10178
 10179     COMPUTE X3 = (X1 / +2) + +1.
 10180     COMPUTE X1 = X-LEN - X1.
 10181
 10182 8680-C-D-LOOP-3.
 10183     IF X1  NOT =  +0
 10184         MOVE CW1-PIC (X2)       TO  CW2-PIC (X3)
 10185         ADD +1                  TO  X2  X3
 10186         SUBTRACT +1             FROM  X1
 10187         GO TO 8680-C-D-LOOP-3.
 10188
 10189 8690-C-D-X.
 10190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL642.cbl
 10192 8800-UNAUTHORIZED-ACCESS.
 10193     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10194
 10195     GO TO 8300-SEND-TEXT.
 10196
 10197 8810-PF23.
 10198     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10199     MOVE XCTL-005               TO  PGM-NAME.
 10200
 10201     GO TO 9300-XCTL.
 10202
 10203 8900-SYNCPOINT-ROLLBACK.
 10204
 10205* EXEC CICS SYNCPOINT
 10206*        ROLLBACK
 10207*    END-EXEC.
 10208*    MOVE '6"R                   !   #00009293' TO DFHEIV0
 10209     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10211     MOVE X'2020233030303039323933' TO DFHEIV0(25:11)
 10212     CALL 'kxdfhei1' USING DFHEIV0
 10213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10214
 10215
 10216
 10217* EXEC CICS DUMP
 10218*        DUMPCODE  ('LGXX')
 10219*        TASK
 10220*    END-EXEC.
 10221     MOVE 'LGXX' TO DFHEIV5
 10222*    MOVE '<"   T                $   #00009297' TO DFHEIV0
 10223     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 10224     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10225     MOVE X'2020233030303039323937' TO DFHEIV0(25:11)
 10226     CALL 'kxdfhei1' USING DFHEIV0,
 10227           DFHEIV5,
 10228           DFHEIV99,
 10229           DFHEIV99
 10230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10231
 10232
 10233 8900-EXIT.
 10234     EXIT.
 10235
 10236 9100-RETURN-TRAN.
 10237     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10238     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10239
 10240
 10241* EXEC CICS RETURN
 10242*        TRANSID   (TRANS-ID)
 10243*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10244*        LENGTH    (PI-COMM-LENGTH)
 10245*    END-EXEC.
 10246*    MOVE '.(CT                  ''   #00009309' TO DFHEIV0
 10247     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10248     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10249     MOVE X'2020233030303039333039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL642.cbl
 10250     CALL 'kxdfhei1' USING DFHEIV0,
 10251           TRANS-ID,
 10252           PROGRAM-INTERFACE-BLOCK,
 10253           PI-COMM-LENGTH,
 10254           DFHEIV99,
 10255           DFHEIV99,
 10256           DFHEIV99
 10257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10258
 10259
 10260 9200-RETURN-MAIN-MENU.
 10261     MOVE XCTL-626               TO  PGM-NAME.
 10262
 10263     GO TO 9300-XCTL.
 10264
 10265 9300-XCTL.
 10266
 10267* EXEC CICS XCTL
 10268*        PROGRAM   (PGM-NAME)
 10269*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10270*        LENGTH    (PI-COMM-LENGTH)
 10271*    END-EXEC.
 10272*    MOVE '.$C                   %   #00009321' TO DFHEIV0
 10273     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10274     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10275     MOVE X'2020233030303039333231' TO DFHEIV0(25:11)
 10276     CALL 'kxdfhei1' USING DFHEIV0,
 10277           PGM-NAME,
 10278           PROGRAM-INTERFACE-BLOCK,
 10279           PI-COMM-LENGTH,
 10280           DFHEIV99
 10281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10282
 10283
 10284 9400-CLEAR.
 10285     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME
 10286
 10287     GO TO 9300-XCTL.
 10288
 10289 9500-PF12.
 10290     MOVE XCTL-010               TO  PGM-NAME.
 10291
 10292     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 212
* EL642.cbl
 10294 9600-PGMID-ERROR.
 10295
 10296* EXEC CICS HANDLE CONDITION
 10297*        PGMIDERR  (8300-SEND-TEXT)
 10298*    END-EXEC.
 10299*    MOVE '"$L                   ! 5 #00009338' TO DFHEIV0
 10300     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10302     MOVE X'3520233030303039333338' TO DFHEIV0(25:11)
 10303     CALL 'kxdfhei1' USING DFHEIV0
 10304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10305
 10306
 10307     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10308     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10309     MOVE XCTL-005               TO  PGM-NAME.
 10310     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10311     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10312
 10313     GO TO 9300-XCTL.
 10314
 10315 9900-ERROR-FORMAT.
 10316     IF NOT  EMI-ERRORS-COMPLETE
 10317         MOVE LINK-001           TO  PGM-NAME
 10318
 10319* EXEC CICS LINK
 10320*            PROGRAM   (PGM-NAME)
 10321*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10322*            LENGTH    (EMI-COMM-LENGTH)
 10323*        END-EXEC.
 10324*    MOVE '."C                   (   #00009353' TO DFHEIV0
 10325     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10327     MOVE X'2020233030303039333533' TO DFHEIV0(25:11)
 10328     CALL 'kxdfhei1' USING DFHEIV0,
 10329           PGM-NAME,
 10330           ERROR-MESSAGE-INTERFACE-BLOCK,
 10331           EMI-COMM-LENGTH,
 10332           DFHEIV99,
 10333           DFHEIV99,
 10334           DFHEIV99,
 10335           DFHEIV99
 10336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10337
 10338
 10339 9900-EXIT.
 10340     EXIT.
 10341
 10342 9990-ABEND.
 10343     MOVE LINK-004               TO  PGM-NAME.
 10344     MOVE DFHEIBLK               TO  EMI-LINE1
 10345
 10346
 10347* EXEC CICS LINK
 10348*        PROGRAM   (PGM-NAME)
 10349*        COMMAREA  (EMI-LINE1)
 10350*        LENGTH    (72)
 10351*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 213
* EL642.cbl
 10352     MOVE 72
 10353       TO DFHEIV11
 10354*    MOVE '."C                   (   #00009366' TO DFHEIV0
 10355     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10357     MOVE X'2020233030303039333636' TO DFHEIV0(25:11)
 10358     CALL 'kxdfhei1' USING DFHEIV0,
 10359           PGM-NAME,
 10360           EMI-LINE1,
 10361           DFHEIV11,
 10362           DFHEIV99,
 10363           DFHEIV99,
 10364           DFHEIV99,
 10365           DFHEIV99
 10366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10367
 10368
 10369     IF PI-MAP-NAME  =  EL642A
 10370         MOVE -1                 TO  APFNTERL
 10371     ELSE
 10372         MOVE -1                 TO  BPFNTERL.
 10373
 10374     GO TO 8200-SEND-DATAONLY.
 10375
 10376 9995-SECURITY-VIOLATION.
 10377*                            COPY ELCSCTP.
 10378******************************************************************
 10379*                                                                *
 10380*                            ELCSCTP                             *
 10381*                            VMOD=2.001                          *
 10382*                                                                *
 10383*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10384******************************************************************
 10385
 10386
 10387     MOVE EIBDATE          TO SM-JUL-DATE.
 10388     MOVE EIBTRMID         TO SM-TERMID.
 10389     MOVE THIS-PGM         TO SM-PGM.
 10390     MOVE EIBTIME          TO TIME-IN.
 10391     MOVE TIME-OUT         TO SM-TIME.
 10392     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10393
 10394
 10395* EXEC CICS LINK
 10396*         PROGRAM  ('EL003')
 10397*         COMMAREA (SECURITY-MESSAGE)
 10398*         LENGTH   (80)
 10399*    END-EXEC.
 10400     MOVE 'EL003' TO DFHEIV1
 10401     MOVE 80
 10402       TO DFHEIV11
 10403*    MOVE '."C                   (   #00009397' TO DFHEIV0
 10404     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10405     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10406     MOVE X'2020233030303039333937' TO DFHEIV0(25:11)
 10407     CALL 'kxdfhei1' USING DFHEIV0,
 10408           DFHEIV1,
 10409           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 214
* EL642.cbl
 10410           DFHEIV11,
 10411           DFHEIV99,
 10412           DFHEIV99,
 10413           DFHEIV99,
 10414           DFHEIV99
 10415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10416
 10417
 10418******************************************************************
 10419
 10420
 10421 9999-DFHBACK SECTION.
 10422     MOVE '9%                    "   ' TO DFHEIV0
 10423     MOVE 'EL642' TO DFHEIV1
 10424     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10425     GOBACK.
 10426 9999-DFHEXIT.
 10427     IF DFHEIGDJ EQUAL 0001
 10428         NEXT SENTENCE
 10429     ELSE IF DFHEIGDJ EQUAL 2
 10430         GO TO 9600-PGMID-ERROR,
 10431               9990-ABEND
 10432         DEPENDING ON DFHEIGDI
 10433     ELSE IF DFHEIGDJ EQUAL 3
 10434         GO TO 0890-EXIT
 10435         DEPENDING ON DFHEIGDI
 10436     ELSE IF DFHEIGDJ EQUAL 4
 10437         GO TO 3930-BILL-NOTFND
 10438         DEPENDING ON DFHEIGDI
 10439     ELSE IF DFHEIGDJ EQUAL 5
 10440         GO TO 3940-EXIT
 10441         DEPENDING ON DFHEIGDI
 10442     ELSE IF DFHEIGDJ EQUAL 6
 10443         GO TO 4010-REC-NOT-FND
 10444         DEPENDING ON DFHEIGDI
 10445     ELSE IF DFHEIGDJ EQUAL 7
 10446         GO TO 4110-END-OF-FILE
 10447         DEPENDING ON DFHEIGDI
 10448     ELSE IF DFHEIGDJ EQUAL 8
 10449         GO TO 4290-REC-NOT-FND
 10450         DEPENDING ON DFHEIGDI
 10451     ELSE IF DFHEIGDJ EQUAL 9
 10452         GO TO 4370-ACCOUNT-INVALID
 10453         DEPENDING ON DFHEIGDI
 10454     ELSE IF DFHEIGDJ EQUAL 10
 10455         GO TO 4510-REC-NOT-FND
 10456         DEPENDING ON DFHEIGDI
 10457     ELSE IF DFHEIGDJ EQUAL 11
 10458         GO TO 4610-END-OF-FILE
 10459         DEPENDING ON DFHEIGDI
 10460     ELSE IF DFHEIGDJ EQUAL 12
 10461         GO TO 6070-NO-COMP-MSTR
 10462         DEPENDING ON DFHEIGDI
 10463     ELSE IF DFHEIGDJ EQUAL 13
 10464         GO TO 6110-NO-RECORD
 10465         DEPENDING ON DFHEIGDI
 10466     ELSE IF DFHEIGDJ EQUAL 14
 10467         GO TO 6410-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 215
* EL642.cbl
 10468         DEPENDING ON DFHEIGDI
 10469     ELSE IF DFHEIGDJ EQUAL 15
 10470         GO TO 6610-NOT-FOUND
 10471         DEPENDING ON DFHEIGDI
 10472     ELSE IF DFHEIGDJ EQUAL 16
 10473         GO TO 6660-START-BROWSE,
 10474               6700-COMM-EXIT
 10475         DEPENDING ON DFHEIGDI
 10476     ELSE IF DFHEIGDJ EQUAL 17
 10477         GO TO 6700-COMM-EXIT,
 10478               6700-COMM-EXIT
 10479         DEPENDING ON DFHEIGDI
 10480     ELSE IF DFHEIGDJ EQUAL 18
 10481         GO TO 6700-COMM-EXIT,
 10482               6700-COMM-EXIT
 10483         DEPENDING ON DFHEIGDI
 10484     ELSE IF DFHEIGDJ EQUAL 19
 10485         GO TO 6710-NOT-FOUND
 10486         DEPENDING ON DFHEIGDI
 10487     ELSE IF DFHEIGDJ EQUAL 20
 10488         GO TO 6880-NOT-FOUND
 10489         DEPENDING ON DFHEIGDI
 10490     ELSE IF DFHEIGDJ EQUAL 21
 10491         GO TO 8300-SEND-TEXT
 10492         DEPENDING ON DFHEIGDI.
 10493     MOVE '9%                    "   ' TO DFHEIV0
 10494     MOVE 'EL642' TO DFHEIV1
 10495     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10496     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8024     Code:       29751
