* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   1
* WSMESS02.cbl
* Options: int("WSMESS02.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("WSMESS02.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"WSMESS02.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "WSMESS02.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. WSMESS02.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 05-Feb-19 08:06.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   2
* WSMESS02.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*     Premium Quote                                              *
    18*  Returns premium calc based on info passed to me.              *
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 020617   2017020300002   PEMA  New Program
    28* 080817   2017020300002   PEMA  Limit and ben code assign changes
    29******************************************************************
    30 ENVIRONMENT DIVISION.
    31 data division.
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34 77  FILLER  PIC X(32) VALUE '********************************'.
    35 77  FILLER  PIC X(32) VALUE '   WSMESS02 WORKING STORAGE     '.
    36 77  FILLER  PIC X(32) VALUE '********************************'.
    37*
    38* program buffers
    39*
    40 77  ws-seq-num                  pic s9(8) comp value 0.
    41 77  ws-flags                    pic s9(8) comp value 0.
    42 77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
    43 77  ws-comp-id                  pic xxx value spaces.
    44 77  WS-SAVE-ACCOUNT             PIC X(10)  VALUE SPACES.
    45 77  WS-BIN-ORIG-EFF-DT          PIC XX  VALUE LOW-VALUES.
    46 77  WS-ORIG-EFF-DT              PIC X(10)  VALUE SPACES.
    47 77  WS-EFF-DATE                 PIC X(10)  VALUE SPACES.
    48 77  WS-lf-exp-date              PIC X(10)  VALUE SPACES.
    49 77  ws-ah-exp-date              pic x(10)  value spaces.
    50 77  ws-loan-exp-date            pic x(10)  value spaces.
    51 77  X1                          PIC S999 COMP-3 VALUE +0.
    52 77  S1                          PIC S999 COMP-3 VALUE +0.
    53 77  S2                          PIC S999 COMP-3 VALUE +0.
    54 77  S3                          PIC S999 COMP-3 VALUE +0.
    55 77  b1                          pic s999 comp-3 value +0.
    56 77  WS-BUILD-SW                 PIC X.
    57     88  TIME-TO-BUILD               VALUE 'Y'.
    58 77  WS-SAVE-ERACCT              PIC X(2000).
    59 77  WS-DIS-RESP                 PIC 9(05) VALUE ZEROS.
    60 77  WS-PERFORM-SW               PIC X VALUE SPACES.
    61     88  GET-RATES                    VALUE 'R'.
    62     88  GET-ACT-ACCTS                VALUE 'A'.
    63 77  ws-bin-current-dt           pic xx  value low-values.
    64 77  ws-bin-eff-dt               pic xx  value low-values.
    65 77  ws-bin-lf-exp-dt            pic xx  value low-values.
    66 77  ws-bin-ah-exp-dt            pic xx  value low-values.
    67 77  ws-bin-loan-exp-dt          pic xx  value low-values.
    68 77  ws-bin-1st-pmt-dt           pic xx  value low-values.
    69 77  ws-bin-pri-birth-dt         pic xx  value low-values.
    70 77  ws-bin-cob-birth-dt         pic xx  value low-values.
    71 77  ws-limit-att-age-dt         pic xx  value low-values.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   3
* WSMESS02.cbl
    72 77  WS-DISP-AMT                 PIC Z,ZZZ,Z99.99.
    73 77  ws-disp-rate                pic z9.99999.
    74 77  WS-ERACCT-SW                PIC X VALUE ' '.
    75     88  END-OF-ERACCT                 VALUE 'Y'.
    76 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    77     88  END-OF-ERCTBL                 VALUE 'Y'.
    78 77  WS-STATUS                   PIC X.
    79 77  ws-socket-sw                pic x value ' '.
    80     88  end-of-socket              value 'Y'.
    81 77  rec-cnt                     pic 9(5) value zeros.
    82 77  ws-stop-sw                  pic x value ' '.
    83     88  i-say-stop                 value 'Y'.
    84 77  ws-browse-sw                pic x value ' '.
    85     88  browse-started            value 'Y'.
    86 77  ws-contract-sw              pic x  value ' '.
    87     88  contract-no-assigned      value 'Y'.
    88 77  ws-error-sw                 pic x value ' '.
    89     88  error-in-one-coverage     value 'Y'.
    90 77  ws-connect-sw               pic x value ' '.
    91     88  connected-to-db           value 'Y'.
    92 77  client-id                   pic xxx.
    93 77  ws-error-sub                pic 999  value zeros.
    94 77  ws-error-sup                pic x(25) value spaces.
    95 77  ws-form-limit-name          pic x(50) value spaces.
    96 77  l1                          pic s999 comp-3 value +0.
    97 77  tx-discount-rate            pic s9v9(5) comp-3 value .00292.
    98 77  ws-discount-rate            pic s99v9(5) comp-3 value +0.
    99 77  temp-discount-rate          PIC S9V9(11) comp-3 value +0.
   100 77  ws-rate-type                pic x.
   101     88  sp-rate                   value 'S'.
   102     88  mob-rate                  value 'M'.
   103 77  ws-recalc-lf                pic x value ' '.
   104     88  recalc-lf                  value 'Y'.
   105 77  ws-recalc-di                pic x value ' '.
   106     88  recalc-di                  value 'Y'.
   107 77  ws-temp-lf-term             pic s999v99 comp-3 value +0.
   108 01  P pointer.
   109 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   110 01  var-ptr pointer.
   111 01  env-var-len                 pic 9(4)  binary.
   112 01  rc                          pic 9(9)  binary.
   113 01  WS-KIXSYS.
   114     05  WS-KIX-FIL1             PIC X(10).
   115     05  WS-KIX-APPS             PIC X(10).
   116     05  WS-KIX-ENV              PIC X(10).
   117     05  WS-KIX-MYENV            PIC X(10).
   118     05  WS-KIX-SYS              PIC X(10).
   119 01  ws-new-lf-term              pic 999 value zeros.
   120 01  ws-new-ah-term              pic 999 value zeros.
   121 01  a-angle-n                   pic s9(7)v9(11) comp-3 value +0.
   122 01  a-angle-n-m                 pic s9(7)v9(11) comp-3 value +0.
   123 01  a-prm-angle-n               pic s9(7)v9(11) comp-3 value +0.
   124 01  a-prm-angle-n-m             pic s9(7)v9(11) comp-3 value +0.
   125 01  LIFE-FACTOR                 PIC S9(7)V9(11) COMP-3 value +0.
   126 01  SINGLE-FACTOR               PIC S9(7)V9(11) COMP-3 value +0.
   127 01  gamma                       pic s9(7)v9(11) comp-5 value +0.
   128 01  temp-value-1                pic s9(7)v9(11) comp-3 value +0.
   129 01  temp-value-2                pic s9(7)v9(11) comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   4
* WSMESS02.cbl
   130 01  temp-value-3                pic s9(7)v9(11) comp-3 value +0.
   131 01  temp-value-4                pic s9(7)v9(11) comp-3 value +0.
   132 01  temp-value-5                pic s9(7)v9(11) comp-3 value +0.
   133 01  temp-value-6                pic s9(7)v9(11) comp-3 value +0.
   134 01  V-TO-M                      PIC S9(7)V9(11) COMP-3 value +0.
   135 01  X-TO-N                      PIC S9(7)V9(11) COMP-3 value +0.
   136 01  V-TO-N                      PIC S9(7)V9(11) COMP-3 value +0.
   137 01  X-TO-M                      PIC S9(7)V9(11) COMP-3 value +0.
   138 01  V-TO-N-M                    PIC S9(7)V9(11) COMP-3 value +0.
   139 01  X                           PIC S9(4)V9(11) COMP-3 value +0.
   140 01  mob                         pic s9(7)v9(11) comp-3 value +0.
   141 01  mnthly-rate                 pic s9(7)v9(11) comp-3 value +0.
   142 01  m                           pic s9(4)v9(4)  comp-3 value +0.
   143 01  n                           pic s9(4)v9(4)  comp-3 value +0.
   144 01  i                           pic s9(7)v9(11) comp-3 value +0.
   145 01  l                           PIC S9(7)V99    comp-3 value +0.
   146 01  pmt                         pic s9(7)v99    comp-3 value +0.
   147 01  dispmt                      pic s9(7)v99    comp-3 value +0.
   148 01  lifepmt1                    pic s9(7)v99    comp-3 value +0.
   149 01  lifepmt2                    pic s9(7)v99    comp-3 value +0.
   150 01  newpmt                      pic s9(7)v99    comp-3 value +0.
   151 01  ppy                         pic s9(5)       comp-3 value +0.
   152 01  dpp                         pic s9(5)       comp-3 value +0.
   153 01  d                           pic s9(5)       comp-3 value +0.
   154 01  plus2                       pic s9(5)       comp-3 value +0.
   155 01  lf-rate                     pic s999v9(5)   comp-3 value +0.
   156 01  ah-rate                     pic s999v9(5)   comp-3 value +0.
   157 01  DL-PREMIUM                  PIC S9(7)V99    comp-3 value +0.
   158 01  LL-PREMIUM                  PIC S9(7)V99    comp-3 value +0.
   159 01  AH-PREMIUM                  PIC S9(7)V99    comp-3 value +0.
   160 01  T-FINANCED                  PIC S9(7)V99    comp-3 value +0.
   161 01  T-REG-Z-FINANCED            PIC S9(7)V99    comp-3 value +0.
   162 01  T-PAYMENTS                  PIC S9(7)V99    comp-3 value +0.
*  163 EXEC SQL
*  164    INCLUDE SQLDA
*  165 END-EXEC
   166 01 SQLDA sync.
   167    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   168    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   169    05 SQLN                  PIC S9(4) COMP-5 value 0.
   170    05 SQLD                  PIC S9(4) COMP-5 value 0.
   171    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   172       10 SQLTYPE            PIC S9(4) COMP-5.
   173       10 SQLLEN             PIC S9(4) COMP-5.
   174$IF P64 SET
   175X      *> For 64-bit environments, ensure that SQLDATA is
   176X      *> aligned on an 8-byte boundary.
   177X      10 FILLER             PIC S9(9) COMP-5.
   178$END
   179       10 SQLDATA            USAGE POINTER.
   180       10 SQLIND             USAGE POINTER.
   181       10 SQLNAME.
   182          15 SQLNAMEL        PIC S9(4) COMP-5.
   183          15 SQLNAMEC        PIC X(30).
   184
   185* Values for SQLTYPE
   186
   187 78  ESQL-DATE-CHAR              VALUE 384.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   5
* WSMESS02.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   188 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   189 78  ESQL-DATE-REC               VALUE 386.
   190 78  ESQL-DATE-REC-NULL          VALUE 387.
   191 78  ESQL-TIME-CHAR              VALUE 388.
   192 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   193 78  ESQL-TIME-REC               VALUE 390.
   194 78  ESQL-TIME-REC-NULL          VALUE 391.
   195 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   196 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   197 78  ESQL-TIMESTAMP-REC          VALUE 394.
   198 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   199 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   200 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   201 78  ESQL-TS-OFFSET-REC          VALUE 398.
   202 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   203 78  ESQL-LONGVARBINARY          VALUE 404.
   204 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   205 78  ESQL-LONGVARCHAR            VALUE 408.
   206 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   207 78  ESQL-BINARY                 VALUE 444.
   208 78  ESQL-BINARY-NULL            VALUE 445.
   209 78  ESQL-VARBINARY              VALUE 446.
   210 78  ESQL-VARBINARY-NULL         VALUE 447.
   211 78  ESQL-VARCHAR                VALUE 448.
   212 78  ESQL-VARCHAR-NULL           VALUE 449.
   213
   214 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   215 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   216
   217 78  ESQL-CHAR                   VALUE 452.
   218 78  ESQL-CHAR-NULL              VALUE 453.
   219
   220 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   221 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   222
   223 78  ESQL-DOUBLE                 VALUE 480.
   224 78  ESQL-DOUBLE-NULL            VALUE 481.
   225 78  ESQL-REAL                   VALUE 482.
   226 78  ESQL-REAL-NULL              VALUE 483.
   227 78  ESQL-DECIMAL                VALUE 484.
   228 78  ESQL-DECIMAL-NULL           VALUE 485.
   229 78  ESQL-INTEGER                VALUE 496.
   230 78  ESQL-INTEGER-NULL           VALUE 497.
   231 78  ESQL-SMALLINT               VALUE 500.
   232 78  ESQL-SMALLINT-NULL          VALUE 501.
   233 78  ESQL-TINYINT                VALUE 502.
   234 78  ESQL-TINYINT-NULL           VALUE 503.
*  235 EXEC SQL
*  236    INCLUDE SQLCA
*  237 END-EXEC
   238 01 SQLCA.
   239     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   240     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   241     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   242     05  SQLERRM.
   243         49  SQLERRML    PIC S9(4) COMP-5.
   244         49  SQLERRMC    PIC X(70).
   245     05  SQLERRP         PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   6
* WSMESS02.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   246     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   247     05  SQLWARN.
   248         10  SQLWARN0    PIC X.
   249         10  SQLWARN1    PIC X.
   250         10  SQLWARN2    PIC X.
   251         10  SQLWARN3    PIC X.
   252         10  SQLWARN4    PIC X.
   253         10  SQLWARN5    PIC X.
   254         10  SQLWARN6    PIC X.
   255         10  SQLWARN7    PIC X.
   256     05  SQLEXT.
   257         10  SQLWARN8    PIC X.
   258         10  SQLWARN9    PIC X.
   259         10  SQLWARN10   PIC X.
   260         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   261     05  SQLSTATE    PIC X(5).
   262 EXEC SQL
   263    BEGIN DECLARE SECTION
   264 END-EXEC
   265 01  ws-dealer-state             pic xx.
   266 01  ws-dealer-id                pic x(10).
   267 01  ws-contract-eff-dt          pic x(10).
   268 01  ws-contract-no              pic x(10) value spaces.
   269 01  ws-contract-suffix          pic x     value spaces.
   270 01  ws-key-stuff.
   271     05  ws-ks-contract-no       pic x(10) value spaces.
   272 01  ws-error-message            pic x(50) value spaces.
   273 01  sqlcmd                      pic x(1024).
   274 01  svr                         pic x(32).
   275 01  usr                         pic x(32).
   276 01  pass                        pic x(32).
   277 01  usr-pass                    pic x(64).
   278 01  ws-disp-code                pic s9(11).
   279***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   280***                                                            ***
   281***  These indicators are used to determine if a variable      ***
   282***  is        null.           The indicator will be -1        ***
   283***  if the value        is null  and +0 if the value is       ***
   284***  something other than null.  Here is an example on how     ***
   285***  to use the indicator variables.                           ***
   286***                                                            ***
   287***     EXEC SQL                                               ***
   288***        fetch checkapp into                                 ***
   289***           :db-app-status :nu-app-status,                   ***
   290***           :db-app-by     :nu-app-by,                       ***
   291***           :db-app-date   :nu-app-date,                     ***
   292***           :db-app-batch  :nu-app-batch                     ***
   293***     END-EXEC                                               ***
   294***                                                            ***
   295***           OR This way on an update                         ***
   296***                                                            ***
   297***     EXEC SQL                                               ***
   298***        UPDATE                                              ***
   299***           CUC_Logic_Remittance                             ***
   300***        SET                                                 ***
   301***           LogicStatus     = :ws-status-code,               ***
   302***           LogicStatusDate = :ws-status-date,               ***
   303***           BatchNumber     = :ws-batch-no :nu-batchno       ***
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   7
* WSMESS02.cbl
   304***        WHERE                                               ***
   305***           RemitId = :ws-remit-id                           ***
   306***     END-EXEC                                               ***
   307***                                                            ***
   308***    Also, when the table has a column with a data type of   ***
   309***  "BIT" and used as true/false move the 1 byte receiving    ***
   310***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   311***  then its false. I think true would be 256.                ***
   312***                                                            ***
   313***                                                            ***
   314***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   315 01  indicator-vaiables-for-nulls.
   316     05  nu-partial-cov          pic s9(4) comp value +0.
   317     05  nu-check-elig           pic s9(4) comp value +0.
   318     05  nu-allow-trunc          pic s9(4) comp value +0.
   319     05  nu-app-by               pic s9(4) comp value +0.
   320     05  nu-app-date             pic s9(4) comp value +0.
   321     05  nu-app-batch            pic s9(4) comp value +0.
   322     05  nu-fincar               pic s9(4) comp value +0.
   323     05  nu-batchno              pic s9(4) comp value +0.
   324     05  nu-error-message        pic s9(4) comp value +0.
   325 01  sql-cert-records.
   326     05  sql-dlr-state           pic xx.
   327     05  sql-dlr-id              pic x(10).
   328     05  sql-eff-dt              pic x(10).
   329     05  sql-contr-no            pic x(10).
   330     05  sql-contr-suffix        pic x.
   331 01  ws-limit-issue-age          pic 999.
   332 01  ws-att-age                  pic 999v99.
   333 01  ws-pri-att-age              pic 999v99.
   334 01  ws-cob-att-age              pic 999v99.
   335 01  form-limit-table.
   336     05  ws-limit-name           pic x(50).
   337     05  ws-limit-cov-type       pic xx.
   338     05  ws-limit-lo-age         pic 999.
   339     05  ws-limit-hi-age         pic 999.
   340     05  ws-limit-att-age        pic 999.
   341     05  ws-limit-max-term       pic 999.
   342     05  ws-limit-max-jnt-term   pic 999.
   343     05  ws-limit-max-mo-ben     pic 9(5).
   344     05  ws-limit-max-tot-ben    pic 9(7).
   345     05  ws-limit-partial-cov    pic s9(4) comp-5.
   346     05  ws-limit-check-elig     pic s9(4) comp-5.
   347     05  ws-limit-elig-max-term  pic 999.
   348     05  ws-limit-allow-truncated pic s9(4) comp-5.
   349
   350 01  state-benefit-code-table.
   351     05  ws-sbc-min-amt          pic 999999.
   352     05  ws-sbc-state            pic xx.
   353     05  ws-sbc-cov-type         pic xx.
   354     05  ws-sbc-ben-amt          pic 999999.
   355     05  ws-sbc-sin-jnt          pic x.
   356     05  ws-sbc-dismember        pic x.
   357     05  ws-sbc-retroelim        pic x.
   358     05  ws-sbc-wait-days        pic 999.
   359     05  ws-sbc-max-bens         pic 999.
   360     05  ws-sbc-logic-ben-code   pic xx.
   361 EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   8
* WSMESS02.cbl
   362    END DECLARE SECTION
   363 END-EXEC
   364 01  filler.
   365     05  ws-work-in              pic x(10).
   366     05  ws-work-out             pic x(10).
   367     05  ws-work-out-v2 redefines
   368         ws-work-out             pic 9(8)v99.
   369     05  ws-work-out-v0 redefines
   370         ws-work-out             pic 9(10).
   371     05  ws-work-out-v5 redefines
   372         ws-work-out             pic 9(5)v9(5).
   373 01  filler.
   374     05  ws-last-suffix          pic x value low-values.
   375     05  ws-tbl-last-suffix      pic x value low-values.
   376     05  filler.  *> Use X1 for this table.
   377         10  ws-codes            pic x(26) value
   378         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   379         10  ws-suffix-value redefines ws-codes
   380           occurs 26             pic x.
   381 01  ws-work-date.
   382     05  ws-work-ccyy            pic x(4).
   383     05  ws-work-mm              pic xx.
   384     05  ws-work-dd              pic xx.
   385 01  ws-work-date-num redefines ws-work-date
   386                                 pic 9(8).
   387 01  filler.
   388     05  ws-test-bin-dt          pic xx.
   389     05  ws-comp-bin-dt redefines ws-test-bin-dt
   390                                 pic s9(4) comp.
   391 01  ws-disp-bin-dt              pic 9(9) value zeros.
   392 01  ws-rate-file-stuff.
   393     12  ERRATE-KEY.
   394         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
   395         16  RATE-STATE-CODE.
   396             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
   397             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
   398             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
   399         16  RATE-L-AH-CODE.
   400             20  RATE-L-AH       PIC  X       VALUE SPACE.
   401             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   402         16  RATE-LIMITS.
   403             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   404             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   405             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   406             20  RATE-SEX        PIC  X       VALUE '9'.
   407         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   408     12  SAVE-ERRATE-KEY.
   409         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   410         16  SVRT-STATE-CODE.
   411             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   412             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   413             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   414         16  SVRT-L-AH-CODE.
   415             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   416             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   417         16  SVRT-LIMITS.
   418             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
   419             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page   9
* WSMESS02.cbl
   420             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   421             20  SVRT-SEX        PIC  X       VALUE '9'.
   422         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   423 01  raw-message002-area.
   424     05  raw-message-num         pic x(10).
   425     05  raw-state               pic xx.
   426     05  raw-acct-no             pic x(10).
   427     05  raw-vin                 pic x(17).
   428     05  raw-lf-ben-code         pic xx.
   429     05  raw-ah-ben-code         pic xx.
   430     05  raw-earn-meth           pic x.
   431     05  raw-pri-birth-date      pic x(10).
   432     05  raw-cob-birth-date      pic x(10).
   433     05  raw-loan-amt            pic x(9).
   434     05  raw-eff-date            pic x(10).
   435     05  raw-1st-pmt-dt          pic x(10).
   436     05  raw-pmts-per-year       pic xx.
   437     05  raw-loan-term           pic xxx.
   438     05  raw-lf-term             pic XXX.
   439     05  raw-ah-term             pic xxx.
   440     05  raw-apr                 pic x(8).
   441     05  raw-lf-sin-jnt-ind      pic x.
   442     05  raw-ah-sin-jnt-ind      pic x.
   443     05  raw-dismemberment       pic x.
   444     05  raw-retro-elim          pic x.
   445     05  raw-waiting-days        pic xx.
   446     05  raw-crit-per            pic xx.
   447 01  ws-rate-work-area.
   448     05  ws-rate-state           pic xx.
   449     05  ws-rate-acct-no         pic x(10).
   450     05  ws-rate-vin             pic x(17).
   451     05  ws-rate-in-lf-ben-code  pic xx.
   452     05  ws-rate-in-ah-ben-code  pic xx.
   453     05  ws-rate-earn-meth       pic x.
   454     05  ws-rate-pri-birth-date  pic x(10).
   455     05  ws-rate-cob-birth-date  pic x(10).
   456     05  ws-rate-eff-date        pic x(10).
   457     05  ws-rate-1st-pmt-dt      pic x(10).
   458     05  ws-rate-benefit-type    pic x.
   459     05  ws-rate-lf-benefit-cd   pic xx.
   460     05  ws-rate-ah-benefit-cd   pic xx.
   461     05  ws-rate-loan-amt        pic 9(6)v99.
   462     05  ws-rate-per-pmt         pic 9(7)v99.
   463     05  ws-rate-loan-pmt        pic 9(7)v99.
   464     05  ws-rate-lf-prem         pic 9(5)v99.
   465     05  ws-rate-ah-prem         pic 9(5)v99.
   466     05  ws-rate-lf-rate         pic 99v9(5).
   467     05  ws-rate-ah-rate         pic 99v9(5).
   468     05  ws-rate-apr             pic 99v9(5).
   469     05  ws-rate-pmts-per-year   pic 99.
   470     05  ws-rate-loan-term       pic 999  value zeros.
   471     05  ws-rate-lf-term         pic 999  value zeros.
   472     05  ws-rate-ah-term         pic 999  value zeros.
   473     05  ws-issue-age            pic 999  value zeros.
   474     05  ws-cob-age              pic 999  value zeros.
   475     05  ws-rate-age             pic 999  value zeros.
   476     05  ws-max-lf-benefit       pic 9(7)v99 value zeros.
   477     05  ws-max-ah-benefit       pic 9(7)v99 value zeros.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  10
* WSMESS02.cbl
   478     05  ws-rate-tot-financed    pic s9(7)v99 value zeros.
   479     05  ws-rate-tot-pmts        pic s9(7)v99 value zeros.
   480     05  ws-rate-crit-per        pic 99.
   481     05  ws-rate-sin-jnt-lf      pic x.
   482     05  ws-rate-sin-jnt-ah      pic x.
   483     05  ws-rate-dismemberment   pic x.
   484     05  ws-rate-retro-elim      pic x.
   485     05  ws-rate-waiting-days    pic 99.
   486     05  ws-rate-fullterm        pic x.
   487 01  ws-lf-limits.
   488     05  ws-lf-limit-lo-age         pic 999.
   489     05  ws-lf-limit-hi-age         pic 999.
   490     05  ws-lf-limit-att-age        pic 999.
   491     05  ws-lf-limit-max-term       pic 999.
   492     05  ws-lf-limit-max-benefit    pic 9(7).
   493     05  ws-lf-limit-partial-cov    pic s9(4) comp-5.
   494     05  ws-lf-limit-check-elig     pic s9(4) comp-5.
   495     05  ws-lf-limit-elig-max-term  pic 999.
   496     05  ws-lf-limit-allow-truncated pic s9(4) comp-5.
   497 01  ws-di-limits.
   498     05  ws-di-limit-lo-age         pic 999.
   499     05  ws-di-limit-hi-age         pic 999.
   500     05  ws-di-limit-att-age        pic 999.
   501     05  ws-di-limit-max-term       pic 999.
   502     05  ws-di-limit-max-jnt-term   pic 999.
   503     05  ws-di-limit-max-mo-ben     pic 9(5).
   504     05  ws-di-limit-max-tot-ben    pic 9(7).
   505     05  ws-di-limit-partial-cov    pic s9(4) comp-5.
   506     05  ws-di-limit-check-elig     pic s9(4) comp-5.
   507     05  ws-di-limit-elig-max-term  pic 999.
   508     05  ws-di-limit-allow-truncated pic s9(4) comp-5.
   509 01  ws-return-string.
   510     05  ws-return-error-no      pic x(4).
   511     05  ws-sc1                  pic x.
   512     05  ws-return-error-mess    pic x(150).
   513     05  ws-sc2                  pic x.
   514     05  ws-return-contract-no   pic x(11).
   515     05  ws-sc3                  pic x.
   516     05  ws-return-lf-max-amt    pic z,zzz,z99.99.
   517     05  ws-sc4                  pic x.
   518     05  ws-return-ah-max-amt    pic zzz,z99.99.
   519     05  ws-sc5                  pic x.
   520     05  ws-return-lf-prem       pic zzz,z99.99.
   521     05  ws-sc6                  pic x.
   522     05  ws-return-ah-prem       pic zzz,z99.99.
   523     05  ws-sc7                  pic x.
   524     05  ws-return-lf-rate       pic z9.99999.
   525     05  ws-sc8                  pic x.
   526     05  ws-return-ah-rate       pic z9.99999.
   527     05  ws-sc9                  pic x.
   528     05  ws-return-lf-exp-dt     pic x(10).
   529     05  ws-sc10                 pic x.
   530     05  ws-return-ah-exp-dt     pic x(10).
   531     05  ws-sc11                 pic x.
   532     05  ws-return-lf-benefit-cd pic xx.
   533     05  ws-sc12                 pic x.
   534     05  ws-return-ah-benefit-cd pic xx.
   535     05  ws-sc13                 pic x.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  11
* WSMESS02.cbl
   536     05  ws-return-period-pmt    pic zzz,z99.99.
   537     05  ws-sc14                 pic x.
   538     05  ws-return-tot-financed  pic z,zzz,z99.99.
   539     05  ws-sc15                 pic x.
   540     05  ws-return-tot-pmts      pic z,zzz,z99.99.
   541     05  ws-sc16                 pic x.
   542     05  ws-return-loan-exp-dt   pic x(10).
   543     05  ws-sc17                 pic x.
   544     05  ws-return-limit-name    pic x(50).
   545     05  ws-sc18                 pic x.
   546     05  ws-return-rate-class    pic xx.
   547     05  ws-sc19                 pic x.
   548     05  ws-return-loan-pmt      pic zzz,z99.99.
   549     05  ws-sc20                 pic x.
   550     05  ws-return-principal     pic zzz,z99.99.
   551     05  ws-sc21                 pic x.
   552     05  ws-return-lf-term       pic zz9.
   553     05  ws-sc22                 pic x.
   554     05  ws-return-ah-term       pic zz9.
   555     05  ws-sc23                 pic x.
   556     05  ws-return-lf-bencd      pic xx.
   557     05  ws-sc24                 pic x.
   558     05  ws-return-max-bens      pic 99.
   559 01  WS-AM-KEY.
   560     05  WS-AM-COMPANY-CD        PIC X.
   561     05  WS-AM-CARRIER           PIC X.
   562     05  WS-AM-GROUP             PIC X(6).
   563     05  WS-AM-STATE             PIC XX.
   564     05  WS-AM-ACCOUNT           PIC X(10).
   565     05  WS-AM-EXP-DT            PIC XX.
   566     05  FILLER                  PIC X(4).
   567 01  ws-cm5-compare-key          pic x(12).
   568 01  WS-CM5-KEY.
   569     05  WS-CM5-COMPANY-CD       PIC X.
   570     05  WS-CM5-CERT-NO          PIC X(11).
   571 01  ws-cm-compare-key           pic x(33).
   572 01  WS-CM-KEY.
   573     05  WS-CM-COMPANY-CD        PIC X.
   574     05  WS-CM-CARRIER           PIC X.
   575     05  WS-CM-GROUP             PIC X(6).
   576     05  WS-CM-STATE             PIC XX.
   577     05  WS-CM-ACCOUNT           PIC X(10).
   578     05  WS-CM-EFF-DT            PIC XX.
   579     05  WS-CM-CERT-NO.
   580         10  ws-cm-cert-ten      pic x(10).
   581         10  ws-cm-cert-suffix   pic x.
   582 01  WS-CS-KEY.
   583     05  WS-CS-COMPANY-CD        PIC X.
   584     05  WS-CS-CARRIER           PIC X.
   585     05  WS-CS-GROUP             PIC X(6).
   586     05  WS-CS-STATE             PIC XX.
   587     05  WS-CS-ACCOUNT           PIC X(10).
   588     05  WS-CS-EFF-DT            PIC XX.
   589     05  WS-CS-CERT-NO           PIC X(11).
   590     05  WS-CS-TRLR-TYPE         PIC X.
   591 01  WS-AM-ALT-KEY.
   592     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   593     05  WS-AM-ALT-EXP-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  12
* WSMESS02.cbl
   594 01  WS-CF-KEY-SAVE              PIC X(10).
   595 01  WS-CF-KEY.
   596     05  WS-CF-COMPANY-ID        PIC XXX.
   597     05  WS-CF-RECORD-TYPE       PIC X.
   598     05  WS-CF-ACCESS            PIC X(4).
   599     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   600 01  filler.
   601     05  ws-errors-table.
   602         10  filler              pic x(130) value
   603         '0000Transaction successfully completed'.
   604         10  filler              pic x(130) value
   605         '0101Amount entered contains invalid characters. Please c
   606-        'orrect and re-submit'.
   607         10  filler              pic x(130) value
   608         '0102Date entered is invalid. Please correct and re-submi
   609-        't'.
   610         10  filler              pic x(130) value
   611         '0103Customer age exceeds age limit. Not eligible for cov
   612-        'erage'.
   613         10  filler              pic x(130) value
   614         '0104Customer will exceed age limit during term of covera
   615-        'ge. Not eligible for coverage'.
   616         10  filler              pic x(130) value
   617         '0105Invalid loan term. Term must be more than 0 and less
   618-        ' than 360'.
   619         10  filler              pic x(130) value
   620         '0106Insurance term exceeds maximum term allowed. Loan is
   621-        ' not eligible for credit insurance'.
   622         10  filler              pic x(130) value
   623         '0107Insurance term exceeds maximum term allowed. Loan is
   624-        ' not eligible for Joint credit disability insurance'.
   625         10  filler              pic x(130) value
   626         '0108Insurance term exceeds maximum term allowed. Loan is
   627-        ' not eligible for credit disability insurance'.
   628         10  filler              pic x(130) value
   629         '0109Total of payments exceeds maximum allowed. Loan is n
   630-        'ot eligible for credit insurance'.
   631         10  filler              pic x(130) value
   632         '0110Monthly payment exceeds maximum allowed. Loan is not
   633-        ' eligible for disability insurance'.
   634         10  filler              pic x(130) value
   635         '0111Loan term cannot be less than insurance term. Loan i
   636-        's not eligible for credit insurance'.
   637         10  filler              pic x(130) value
   638         '0112Term times monthly payment exceeds Maximum total dis
   639-        'ability benefit. Loan is not eligible for credit disabil
   640-        'ity insurance'.
   641         10  filler              pic x(130) value
   642         '0113Cannot rate based on existing loan terms'.
   643         10  filler              pic x(130) value
   644         '0114Cannot rate life coverage based on existing loan ter
   645-        'ms'.
   646         10  filler              pic x(130) value
   647         '0115Cannot rate disability coverage based on existing lo
   648-        'an terms'.
   649         10  filler              pic x(130) value
   650         '0116Problem with rate file. Unable to rate'.
   651         10  filler              pic x(130) value
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  13
* WSMESS02.cbl
   652         '0117Calculated premium is outside of tolerance'.
   653         10  filler              pic x(130) value
   654         '0118This appears to be a duplicate record. Unable to rat
   655-        'e'.
   656         10  filler              pic x(130) value
   657         '0119Loan term and insurance term cannot be zero. Unable
   658-        'to rate'.
   659         10  filler              pic x(130) value
   660         '0120Loan term and insurance term cannot be zero. Unable
   661-        'to rate'.
   662         10  filler              pic x(130) value
   663         '0121Cannot locate limit table. Unable to rate'.
   664         10  filler              pic x(130) value
   665         '0122Invalid company id '.
   666         10  filler              pic x(130) value
   667         '0123Cannot locate life benefit code. Unable to rate'.
   668         10  filler              pic x(130) value
   669         '0124Cannot locate disability benefit code. Unable to rat
   670-        'e'.
   671         10  filler              pic x(130) value
   672         '0125Calculated total of payments do not match submitted
   673-        'total of payments. Unable to rate'.
   674         10  filler              pic x(130) value
   675         '0126Life and Disability Terms must be the same'.
   676         10  filler              pic x(130) value
   677         '0127Loan term and insurance term must be the same on Gro
   678-        'ss coverages'.
   679         10  filler              pic x(130) value
   680         '0128Total of payments does not match benefit amount prov
   681-        'ided on Gross coverage. Unable to rate'.
   682         10  filler              pic x(130) value
   683         '0129Calculated amount financed does not match provided a
   684-        'mount financed. Unable to rate'.
   685         10  filler              pic x(130) value
   686         '0130Insurance term exceeds maximum eligibility term. Loa
   687-        'n is not eligible for credit insurance'.
   688         10  filler              pic x(130) value
   689         '0131Amount exceeds maximum eligibility amount. Loan is n
   690-        'ot eligible for credit insurance'.
   691     05  filler redefines ws-errors-table occurs 32.
   692         10  ws-table-error-no   pic x(4).
   693         10  ws-table-error-mess pic x(126).
   694 01  ws-mess002-length           pic s9(4) comp value +1024.
   695 01  WS-MESS002-PASS-AREA        PIC X(1024).
   696 01  WS-CID-NO                   PIC X(8).
   697 01  WS-DISP-RESP                PIC 9(5).
   698 01  WS-RESPONSE                 PIC S9(8)   COMP.
   699     88  RESP-NORMAL                  VALUE +00.
   700     88  RESP-NOTFND                  VALUE +13.
   701     88  resp-duprec                  value +14.
   702     88  resp-dupkey                  value +15.
   703     88  RESP-NOTOPEN                 VALUE +19.
   704     88  RESP-ENDFILE                 VALUE +20.
   705*                                 COPY ERCACCT.
   706******************************************************************
   707*                                                                *
   708*                                                                *
   709*                            ERCACCT                             *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  14
* WSMESS02.cbl
   710*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   711*                            VMOD=2.031                          *
   712*                                                                *
   713*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   714*                                                                *
   715*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   716*   VSAM ACCOUNT MASTER FILES.                                   *
   717*                                                                *
   718*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   719*                                                                *
   720*   FILE TYPE = VSAM,KSDS                                        *
   721*   RECORD SIZE = 2000  RECFORM = FIX                            *
   722*                                                                *
   723*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   724*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   725*                                                                *
   726*   LOG = NO                                                     *
   727*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   728*                                                                *
   729*                                                                *
   730******************************************************************
   731*                   C H A N G E   L O G
   732*
   733* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   734*-----------------------------------------------------------------
   735*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   736* EFFECTIVE    NUMBER
   737*-----------------------------------------------------------------
   738* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   739* 092705    2005050300006  PEMA  ADD SPP LEASES
   740* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   741* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   742* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   743* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   744* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   745* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   746******************************************************************
   747
   748 01  ACCOUNT-MASTER.
   749     12  AM-RECORD-ID                      PIC XX.
   750         88  VALID-AM-ID                      VALUE 'AM'.
   751
   752     12  AM-CONTROL-PRIMARY.
   753         16  AM-COMPANY-CD                 PIC X.
   754         16  AM-MSTR-CNTRL.
   755             20  AM-CONTROL-A.
   756                 24  AM-CARRIER            PIC X.
   757                 24  AM-GROUPING.
   758                     28 AM-GROUPING-PREFIX PIC XXX.
   759                     28 AM-GROUPING-PRIME  PIC XXX.
   760                 24  AM-STATE              PIC XX.
   761                 24  AM-ACCOUNT.
   762                     28  AM-ACCOUNT-PREFIX PIC X(4).
   763                     28  AM-ACCOUNT-PRIME  PIC X(6).
   764             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   765                                           PIC X(19).
   766             20  AM-CNTRL-B.
   767                 24  AM-EXPIRATION-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  15
* WSMESS02.cbl
   768                 24  FILLER                PIC X(4).
   769             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   770                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   771
   772     12  AM-CONTROL-BY-VAR-GRP.
   773         16  AM-COMPANY-CD-A1              PIC X.
   774         16  AM-VG-CARRIER                 PIC X.
   775         16  AM-VG-GROUPING                PIC X(6).
   776         16  AM-VG-STATE                   PIC XX.
   777         16  AM-VG-ACCOUNT                 PIC X(10).
   778         16  AM-VG-DATE.
   779             20  AM-VG-EXPIRATION-DT       PIC XX.
   780             20  FILLER                    PIC X(4).
   781         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   782                                           PIC 9(11)      COMP-3.
   783     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   784         16  FILLER                        PIC X(10).
   785         16  AM-VG-KEY3.
   786             20  AM-VG3-ACCOUNT            PIC X(10).
   787             20  AM-VG3-EXP-DT             PIC XX.
   788         16  FILLER                        PIC X(4).
   789     12  AM-MAINT-INFORMATION.
   790         16  AM-LAST-MAINT-DT              PIC XX.
   791         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   792         16  AM-LAST-MAINT-USER            PIC X(4).
   793         16  FILLER                        PIC XX.
   794
   795     12  AM-EFFECTIVE-DT                   PIC XX.
   796     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   797
   798     12  AM-PREV-DATES  COMP-3.
   799         16  AM-PREV-EXP-DT                PIC 9(11).
   800         16  AM-PREV-EFF-DT                PIC 9(11).
   801
   802     12  AM-REPORT-CODE-1                  PIC X(10).
   803     12  AM-REPORT-CODE-2                  PIC X(10).
   804
   805     12  AM-CITY-CODE                      PIC X(4).
   806     12  AM-COUNTY-PARISH                  PIC X(6).
   807
   808     12  AM-NAME                           PIC X(30).
   809     12  AM-PERSON                         PIC X(30).
   810     12  AM-ADDRS                          PIC X(30).
   811     12  AM-CITY.
   812         16  AM-ADDR-CITY                  PIC X(28).
   813         16  AM-ADDR-STATE                 PIC XX.
   814     12  AM-ZIP.
   815         16  AM-ZIP-PRIME.
   816             20  AM-ZIP-PRI-1ST            PIC X.
   817                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   818             20  FILLER                    PIC X(4).
   819         16  AM-ZIP-PLUS4                  PIC X(4).
   820     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   821         16  AM-CAN-POSTAL-1               PIC XXX.
   822         16  AM-CAN-POSTAL-2               PIC XXX.
   823         16  FILLER                        PIC XXX.
   824     12  AM-TEL-NO.
   825         16  AM-AREA-CODE                  PIC 999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  16
* WSMESS02.cbl
   826         16  AM-TEL-PRE                    PIC 999.
   827         16  AM-TEL-NBR                    PIC 9(4).
   828     12  AM-TEL-LOC                        PIC X.
   829         88  AM-TEL-AT-HOME                   VALUE 'H'.
   830         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   831
   832     12  AM-COMM-STRUCTURE.
   833         16  AM-DEFN-1.
   834             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   835                 24  AM-AGT.
   836                     28  AM-AGT-PREFIX     PIC X(4).
   837                     28  AM-AGT-PRIME      PIC X(6).
   838                 24  AM-COM-TYP            PIC X.
   839                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   840                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   841                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   842                 24  AM-RECALC-LV-INDIC    PIC X.
   843                 24  AM-RETRO-LV-INDIC     PIC X.
   844                 24  AM-GL-CODES           PIC X.
   845                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   846                 24  FILLER                PIC X(01).
   847         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   848             20  AM-COM-TBLS        OCCURS 10 TIMES.
   849                 24  FILLER                PIC X(11).
   850                 24  AM-L-COMA             PIC XXX.
   851                 24  AM-J-COMA             PIC XXX.
   852                 24  AM-A-COMA             PIC XXX.
   853                 24  FILLER                PIC X(6).
   854
   855     12  AM-COMM-CHANGE-STATUS             PIC X.
   856         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   857
   858     12  AM-CSR-CODE                       PIC X(4).
   859
   860     12  AM-BILLING-STATUS                 PIC X.
   861         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   862         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   863     12  AM-AUTO-REFUND-SW                 PIC X.
   864         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   865         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   866     12  AM-GPCD                           PIC 99.
   867     12  AM-IG                             PIC X.
   868         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   869         88  AM-HAS-GROUP                     VALUE '2'.
   870     12  AM-STATUS                         PIC X.
   871         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   872         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   873         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   874         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   875         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   876         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   877         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   878         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   879         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   880         88  AM-ACCOUNT-PENDING               VALUE '9'.
   881     12  AM-REMIT-TO                       PIC 99.
   882     12  AM-ID-NO                          PIC X(11).
   883
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  17
* WSMESS02.cbl
   884     12  AM-CAL-TABLE                      PIC XX.
   885     12  AM-LF-DEVIATION                   PIC XXX.
   886     12  AM-AH-DEVIATION                   PIC XXX.
   887     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   888     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   889     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   890     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   891     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   892     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   893
   894     12  AM-USER-FIELDS.
   895         16  AM-FLD-1                      PIC XX.
   896         16  AM-FLD-2                      PIC XX.
   897         16  AM-FLD-3                      PIC XX.
   898         16  AM-FLD-4                      PIC XX.
   899         16  AM-FLD-5                      PIC XX.
   900
   901     12  AM-1ST-PROD-DATE.
   902         16  AM-1ST-PROD-YR                PIC XX.
   903         16  AM-1ST-PROD-MO                PIC XX.
   904         16  AM-1ST-PROD-DA                PIC XX.
   905     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   906     12  AM-CERTS-PURGED-DATE.
   907         16  AM-PUR-YR                     PIC XX.
   908         16  AM-PUR-MO                     PIC XX.
   909         16  AM-PUR-DA                     PIC XX.
   910     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   911     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   912     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   913     12  AM-INACTIVE-DATE.
   914         16  AM-INA-MO                     PIC 99.
   915         16  AM-INA-DA                     PIC 99.
   916         16  AM-INA-YR                     PIC 99.
   917     12  AM-AR-HI-CERT-DATE                PIC XX.
   918
   919     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   920     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   921
   922     12  AM-OB-PAYMENT-MODE                PIC X.
   923         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   924         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   925         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   926         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   927
   928     12  AM-AH-ONLY-INDICATOR              PIC X.
   929         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   930         88  AM-NO-AH-ONLY                    VALUE 'N'.
   931
   932     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   933
   934     12  AM-OVER-SHORT.
   935         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   936         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   937
   938     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   939     12  AM-DCC-CLP-STATE                  PIC XX.
   940
   941     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  18
* WSMESS02.cbl
   942     12  AM-RECALC-REIN                    PIC X.
   943
   944     12  AM-REI-TABLE                      PIC XXX.
   945     12  AM-REI-ET-LF                      PIC X.
   946     12  AM-REI-ET-AH                      PIC X.
   947     12  AM-REI-PE-LF                      PIC X.
   948     12  AM-REI-PE-AH                      PIC X.
   949     12  AM-REI-PRT-ST                     PIC X.
   950     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   951     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   952     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   953     12  AM-REI-GROUP-A                    PIC X(6).
   954     12  AM-REI-MORT                       PIC X(4).
   955     12  AM-REI-PRT-OW                     PIC X.
   956     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   957     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   958     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   959     12  AM-REI-GROUP-B                    PIC X(6).
   960
   961     12  AM-TRUST-TYPE                     PIC X(2).
   962
   963     12  AM-EMPLOYER-STMT-USED             PIC X.
   964     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   965
   966     12  AM-STD-AH-TYPE                    PIC XX.
   967     12  AM-EARN-METHODS.
   968         16  AM-EARN-METHOD-R              PIC X.
   969             88 AM-REF-RL-R78                 VALUE 'R'.
   970             88 AM-REF-RL-PR                  VALUE 'P'.
   971             88 AM-REF-RL-MEAN                VALUE 'M'.
   972             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   973         16  AM-EARN-METHOD-L              PIC X.
   974             88 AM-REF-LL-R78                 VALUE 'R'.
   975             88 AM-REF-LL-PR                  VALUE 'P'.
   976             88 AM-REF-LL-MEAN                VALUE 'M'.
   977             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   978         16  AM-EARN-METHOD-A              PIC X.
   979             88 AM-REF-AH-R78                 VALUE 'R'.
   980             88 AM-REF-AH-PR                  VALUE 'P'.
   981             88 AM-REF-AH-MEAN                VALUE 'M'.
   982             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   983             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   984             88 AM-REF-AH-NET                 VALUE 'N'.
   985
   986     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   987     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   988     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   989
   990     12  AM-RET-Y-N                        PIC X.
   991     12  AM-RET-P-E                        PIC X.
   992     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   993     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   994     12  AM-RET-GRP                        PIC X(6).
   995     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   996         16  AM-POOL-PRIME                 PIC XXX.
   997         16  AM-POOL-SUB                   PIC XXX.
   998     12  AM-RETRO-EARNINGS.
   999         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  19
* WSMESS02.cbl
  1000         16  AM-RET-EARN-L                 PIC X.
  1001         16  AM-RET-EARN-A                 PIC X.
  1002     12  AM-RET-ST-TAX-USE                 PIC X.
  1003         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1004         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1005     12  AM-RETRO-BEG-EARNINGS.
  1006         16  AM-RET-BEG-EARN-R             PIC X.
  1007         16  AM-RET-BEG-EARN-L             PIC X.
  1008         16  AM-RET-BEG-EARN-A             PIC X.
  1009     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1010     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1011
  1012     12  AM-USER-SELECT-OPTIONS.
  1013         16  AM-USER-SELECT-1              PIC X(10).
  1014         16  AM-USER-SELECT-2              PIC X(10).
  1015         16  AM-USER-SELECT-3              PIC X(10).
  1016         16  AM-USER-SELECT-4              PIC X(10).
  1017         16  AM-USER-SELECT-5              PIC X(10).
  1018
  1019     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1020
  1021     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1022
  1023     12  AM-RPT045A-SWITCH                 PIC X.
  1024         88  RPT045A-OFF                   VALUE 'N'.
  1025
  1026     12  AM-INSURANCE-LIMITS.
  1027         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1028         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1029
  1030     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1031         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1032
  1033     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1034         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1035         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1036
  1037     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1038
  1039     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1040     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1041     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1042     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1043     12  AM-DCC-UEF-STATE                  PIC XX.
  1044     12  FILLER                            PIC XXX.
  1045     12  AM-REPORT-CODE-3                  PIC X(10).
  1046*    12  FILLER                            PIC X(22).
  1047
  1048     12  AM-RESERVE-DATE.
  1049         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1050         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1051         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1052
  1053     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1054     12  AM-NOTIFICATION-TYPES.
  1055         16  AM-NOTIF-OF-LETTERS           PIC X.
  1056         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1057         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  20
* WSMESS02.cbl
  1058         16  AM-NOTIF-OF-STATUS            PIC X.
  1059
  1060     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1061         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1062         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1063         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1064         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1065
  1066     12  AM-BENEFIT-CONTROLS.
  1067         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1068             20  AM-BENEFIT-CODE           PIC XX.
  1069             20  AM-BENEFIT-TYPE           PIC X.
  1070             20  AM-BENEFIT-REVISION       PIC XXX.
  1071             20  AM-BENEFIT-REM-TERM       PIC X.
  1072             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1073             20  FILLER                    PIC XX.
  1074         16  FILLER                        PIC X(80).
  1075
  1076     12  AM-TRANSFER-DATA.
  1077         16  AM-TRANSFERRED-FROM.
  1078             20  AM-TRNFROM-CARRIER        PIC X.
  1079             20  AM-TRNFROM-GROUPING.
  1080                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1081                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1082             20  AM-TRNFROM-STATE          PIC XX.
  1083             20  AM-TRNFROM-ACCOUNT.
  1084                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1085                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1086             20  AM-TRNFROM-DTE            PIC XX.
  1087         16  AM-TRANSFERRED-TO.
  1088             20  AM-TRNTO-CARRIER          PIC X.
  1089             20  AM-TRNTO-GROUPING.
  1090                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1091                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1092             20  AM-TRNTO-STATE            PIC XX.
  1093             20  AM-TRNTO-ACCOUNT.
  1094                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1095                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1096             20  AM-TRNTO-DTE              PIC XX.
  1097         16  FILLER                        PIC X(10).
  1098
  1099     12  AM-SAVED-REMIT-TO                 PIC 99.
  1100
  1101     12  AM-COMM-STRUCTURE-SAVED.
  1102         16  AM-DEFN-1-SAVED.
  1103             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1104                 24  AM-AGT-SV             PIC X(10).
  1105                 24  AM-COM-TYP-SV         PIC X.
  1106                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1107                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1108                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1109                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1110                 24  FILLER                PIC X.
  1111                 24  AM-GL-CODES-SV        PIC X.
  1112                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1113                 24  FILLER                PIC X.
  1114         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1115             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  21
* WSMESS02.cbl
  1116                 24  FILLER                PIC X(11).
  1117                 24  AM-L-COMA-SV          PIC XXX.
  1118                 24  AM-J-COMA-SV          PIC XXX.
  1119                 24  AM-A-COMA-SV          PIC XXX.
  1120                 24  FILLER                PIC X(6).
  1121
  1122     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1123         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1124            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1125            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1126            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1127
  1128     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1129     12  FILLER                            PIC X(120).
  1130
  1131     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1132         16  AM-CONTROL-NAME               PIC X(30).
  1133         16  AM-EXECUTIVE-ONE.
  1134             20  AM-EXEC1-NAME             PIC X(15).
  1135             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1136                                                          COMP-3.
  1137             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1138                                                          COMP-3.
  1139         16  AM-EXECUTIVE-TWO.
  1140             20  AM-EXEC2-NAME             PIC X(15).
  1141             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1142                                                          COMP-3.
  1143             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1144                                                          COMP-3.
  1145
  1146     12  AM-RETRO-ADDITIONAL-DATA.
  1147         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1148         16  AM-RETRO-PREM-P-E             PIC X.
  1149         16  AM-RETRO-CLMS-P-I             PIC X.
  1150         16  AM-RETRO-RET-BRACKET-LF.
  1151             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1152                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1153                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1154             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1155                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1156                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1157             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1158                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1159                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1160         16  AM-RETRO-RET-BRACKET-AH.
  1161             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1162                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1163                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1164                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1165             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1166                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1167                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1168             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1169                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1170                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1171
  1172     12  AM-COMMENTS.
  1173         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  22
* WSMESS02.cbl
  1174
  1175     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1176         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1177         16  AM-FLI-BILLING-CODE           PIC X.
  1178         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1179         16  AM-FLI-UNITED-IDENT           PIC X.
  1180         16  AM-FLI-INTEREST-LOST-DATA.
  1181             20  AM-FLI-BANK-NO            PIC X(5).
  1182             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1183             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1184             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1185         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1186             20  AM-FLI-AGT                PIC X(9).
  1187             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1188             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1189         16  FILLER                        PIC X(102).
  1190
  1191     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1192         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1193             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1194             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1195             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1196             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1197             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1198         16  FILLER                          PIC X(10).
  1199******************************************************************
  1200*                                 COPY ERCRATE.
  1201******************************************************************
  1202*                                                                *
  1203*                                                                *
  1204*                            ERCRATE                             *
  1205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1206*                            VMOD=2.008                          *
  1207*                                                                *
  1208*   ONLINE CREDIT SYSTEM                                         *
  1209*                                                                *
  1210*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1211*                                                                *
  1212*   FILE TYPE = VSAM,KSDS                                        *
  1213*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1214*                                                                *
  1215*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1216*       ALTERNATE PATH = NONE                                    *
  1217*                                                                *
  1218*   LOG = NO                                                     *
  1219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1220*                                                                *
  1221******************************************************************
  1222******************************************************************
  1223*                   C H A N G E   L O G
  1224*
  1225* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1226*-----------------------------------------------------------------
  1227*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1228* EFFECTIVE    NUMBER
  1229*-----------------------------------------------------------------
  1230* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1231******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  23
* WSMESS02.cbl
  1232
  1233 01  RATE-RECORD.
  1234     12  RT-RECORD-ID                      PIC XX.
  1235         88  VALID-RT-ID                      VALUE 'RT'.
  1236
  1237     12  RT-CONTROL-PRIMARY.
  1238         16  RT-COMPANY-CD                 PIC X.
  1239         16  RT-STATE-CODE.
  1240             20  RT-ST-CODE                PIC XX.
  1241             20  RT-ST-CLASS               PIC XX.
  1242             20  RT-ST-DEV                 PIC XXX.
  1243         16  RT-L-AH-CODE.
  1244             20  RT-L-AH                   PIC X.
  1245             20  RT-LAH-NUM                PIC XX.
  1246         16  RT-LIMITS.
  1247             20  RT-HIGH-AGE               PIC 99.
  1248             20  RT-HIGH-AMT               PIC 9(6).
  1249             20  RT-FUTURE                 PIC XX.
  1250             20  RT-SEX                    PIC X.
  1251         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1252
  1253     12  RT-MAINT-INFORMATION.
  1254         16  RT-LAST-MAINT-DT              PIC XX.
  1255         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1256         16  RT-LAST-MAINT-USER            PIC X(4).
  1257         16  FILLER                        PIC X(10).
  1258
  1259     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1260     12  RT-RATE-COMMENT                   PIC X(50).
  1261
  1262     12  CSL-RESERVED                      PIC X(10).
  1263     12  FILLER                            PIC X(12).
  1264
  1265     12  RT-MAX-AGE                        PIC 99.
  1266
  1267     12  RT-LIFE-LIMS-FLDS.
  1268         16  RT-LIFE-MORT-CODE             PIC X(4).
  1269         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1270             20  RT-L-EX-AGE               PIC 99.
  1271             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1272             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1273         16  FILLER                        PIC X(20).
  1274
  1275     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1276         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1277             20  RT-AH-AGE                 PIC 99.
  1278             20  RT-AH-TERM                PIC S999       COMP-3.
  1279             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1280             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1281
  1282     12  RT-LIFE-RATES.
  1283         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1284
  1285     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1286         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1287
  1288     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1289
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  24
* WSMESS02.cbl
  1290     12  RT-DISCOUNT-OPTION                PIC X.
  1291         88  RT-DO-NOT-USE                     VALUE ' '.
  1292         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1293         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1294
  1295     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1296     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1297
  1298     12  RT-COMPOSITE-OPTION               PIC X.
  1299         88  RT-NO-COMPOSITE                   VALUE ' '.
  1300         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1301
  1302     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1303
  1304     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
  1305     12  FILLER                            PIC X(13).
  1306
  1307     12  RT-TYPE-RATE                      PIC X.
  1308         88  RT-IS-STND                        VALUE ' ' 'S'.
  1309         88  RT-IS-OB                          VALUE 'O'.
  1310
  1311     12  RT-SRT-ALPHA                      PIC X.
  1312
  1313     12  RT-CONTROL-2.
  1314         16  RTC-1                         PIC X(7).
  1315         16  RTC-3                         PIC X(11).
  1316         16  RTC-4                         PIC 9(11) COMP-3.
  1317         16  RTC-2                         PIC X(3).
  1318******************************************************************
  1319*                                 COPY ELCCERT.
  1320******************************************************************
  1321*                                                                *
  1322*                            ELCCERT.                            *
  1323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1324*                            VMOD=2.013                          *
  1325*                                                                *
  1326*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1327*                                                                *
  1328*   FILE TYPE = VSAM,KSDS                                        *
  1329*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1330*                                                                *
  1331*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1332*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1333*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1334*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1335*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1336*                                                                *
  1337*   LOG = YES                                                    *
  1338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1339******************************************************************
  1340*                   C H A N G E   L O G
  1341*
  1342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1343*-----------------------------------------------------------------
  1344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1345* EFFECTIVE    NUMBER
  1346*-----------------------------------------------------------------
  1347* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  25
* WSMESS02.cbl
  1348* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1349* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1350* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1351* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1352* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1353* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1354* 032612  CR2011110200001  PEMA  AHL CHANGES
  1355* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1356* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1357* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1358******************************************************************
  1359
  1360 01  CERTIFICATE-MASTER.
  1361     12  CM-RECORD-ID                      PIC XX.
  1362         88  VALID-CM-ID                      VALUE 'CM'.
  1363
  1364     12  CM-CONTROL-PRIMARY.
  1365         16  CM-COMPANY-CD                 PIC X.
  1366         16  CM-CARRIER                    PIC X.
  1367         16  CM-GROUPING.
  1368             20  CM-GROUPING-PREFIX        PIC X(3).
  1369             20  CM-GROUPING-PRIME         PIC X(3).
  1370         16  CM-STATE                      PIC XX.
  1371         16  CM-ACCOUNT.
  1372             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1373             20  CM-ACCOUNT-PRIME          PIC X(6).
  1374         16  CM-CERT-EFF-DT                PIC XX.
  1375         16  CM-CERT-NO.
  1376             20  CM-CERT-PRIME             PIC X(10).
  1377             20  CM-CERT-SFX               PIC X.
  1378
  1379     12  CM-CONTROL-BY-NAME.
  1380         16  CM-COMPANY-CD-A1              PIC X.
  1381         16  CM-INSURED-LAST-NAME          PIC X(15).
  1382         16  CM-INSURED-INITIALS.
  1383             20  CM-INSURED-INITIAL1       PIC X.
  1384             20  CM-INSURED-INITIAL2       PIC X.
  1385
  1386     12  CM-CONTROL-BY-SSN.
  1387         16  CM-COMPANY-CD-A2              PIC X.
  1388         16  CM-SOC-SEC-NO.
  1389             20  CM-SSN-STATE              PIC XX.
  1390             20  CM-SSN-ACCOUNT            PIC X(6).
  1391             20  CM-SSN-LN3.
  1392                 25  CM-INSURED-INITIALS-A2.
  1393                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1394                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1395                 25 CM-PART-LAST-NAME-A2         PIC X.
  1396
  1397     12  CM-CONTROL-BY-CERT-NO.
  1398         16  CM-COMPANY-CD-A4              PIC X.
  1399         16  CM-CERT-NO-A4                 PIC X(11).
  1400
  1401     12  CM-CONTROL-BY-MEMB.
  1402         16  CM-COMPANY-CD-A5              PIC X.
  1403         16  CM-MEMBER-NO.
  1404             20  CM-MEMB-STATE             PIC XX.
  1405             20  CM-MEMB-ACCOUNT           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  26
* WSMESS02.cbl
  1406             20  CM-MEMB-LN4.
  1407                 25  CM-INSURED-INITIALS-A5.
  1408                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1409                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1410                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1411
  1412     12  CM-INSURED-PROFILE-DATA.
  1413         16  CM-INSURED-FIRST-NAME.
  1414             20  CM-INSURED-1ST-INIT       PIC X.
  1415             20  FILLER                    PIC X(9).
  1416         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1417         16  CM-INSURED-SEX                PIC X.
  1418             88  CM-SEX-MALE                  VALUE 'M'.
  1419             88  CM-SEX-FEMAL                 VALUE 'F'.
  1420         16  CM-INSURED-JOINT-AGE          PIC 99.
  1421         16  CM-JOINT-INSURED-NAME.
  1422             20  CM-JT-LAST-NAME           PIC X(15).
  1423             20  CM-JT-FIRST-NAME.
  1424                 24  CM-JT-1ST-INIT        PIC X.
  1425                 24  FILLER                PIC X(9).
  1426             20  CM-JT-INITIAL             PIC X.
  1427
  1428     12  CM-LIFE-DATA.
  1429         16  CM-LF-BENEFIT-CD              PIC XX.
  1430         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1431         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1432         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1433         16  CM-LF-DEV-CODE                PIC XXX.
  1434         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1435         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1436         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1437         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1438         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1439         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1440         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1441         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1442         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1443         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1444         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1445         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1446         16  cm-temp-epiq                  pic xx.
  1447             88  EPIQ-CLASS                  value 'EQ'.
  1448*        16  FILLER                        PIC XX.
  1449
  1450     12  CM-AH-DATA.
  1451         16  CM-AH-BENEFIT-CD              PIC XX.
  1452         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1453         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1454         16  CM-AH-DEV-CODE                PIC XXX.
  1455         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1456         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1457         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1458         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1459         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1460         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1461         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1462         16  CM-AH-PAID-THRU-DT            PIC XX.
  1463             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  27
* WSMESS02.cbl
  1464         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1465         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1466         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1467         16  FILLER                        PIC X.
  1468
  1469     12  CM-LOAN-INFORMATION.
  1470         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1471         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1472                                           PIC S9(5)V99  COMP-3.
  1473         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1474         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1475         16  CM-PAY-FREQUENCY              PIC S99.
  1476         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1477         16  CM-RATE-CLASS                 PIC XX.
  1478         16  CM-BENEFICIARY                PIC X(25).
  1479         16  CM-POLICY-FORM-NO             PIC X(12).
  1480         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1481         16  CM-LAST-ADD-ON-DT             PIC XX.
  1482         16  CM-DEDUCTIBLE-AMOUNTS.
  1483             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1484             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1485         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1486             20  CM-RESIDENT-STATE         PIC XX.
  1487             20  CM-RATE-CODE              PIC X(4).
  1488             20  FILLER                    PIC XX.
  1489         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1490             20  CM-LOAN-OFFICER           PIC X(5).
  1491             20  FILLER                    PIC XXX.
  1492         16  CM-CSR-CODE                   PIC XXX.
  1493         16  CM-UNDERWRITING-CODE          PIC X.
  1494             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1495         16  CM-POST-CARD-IND              PIC X.
  1496         16  CM-REF-INTERFACE-SW           PIC X.
  1497         16  CM-PREMIUM-TYPE               PIC X.
  1498             88  CM-SING-PRM                  VALUE '1'.
  1499             88  CM-O-B-COVERAGE              VALUE '2'.
  1500             88  CM-OPEN-END                  VALUE '3'.
  1501         16  CM-IND-GRP-TYPE               PIC X.
  1502             88  CM-INDIVIDUAL                VALUE 'I'.
  1503             88  CM-GROUP                     VALUE 'G'.
  1504         16  CM-SKIP-CODE                  PIC X.
  1505             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1506             88  SKIP-JULY                    VALUE '1'.
  1507             88  SKIP-AUGUST                  VALUE '2'.
  1508             88  SKIP-SEPTEMBER               VALUE '3'.
  1509             88  SKIP-JULY-AUG                VALUE '4'.
  1510             88  SKIP-AUG-SEPT                VALUE '5'.
  1511             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1512             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1513             88  SKIP-JUNE                    VALUE '8'.
  1514             88  SKIP-JUNE-JULY               VALUE '9'.
  1515             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1516             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1517         16  CM-PAYMENT-MODE               PIC X.
  1518             88  PAY-MONTHLY                  VALUE SPACE.
  1519             88  PAY-WEEKLY                   VALUE '1'.
  1520             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1521             88  PAY-BI-WEEKLY                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  28
* WSMESS02.cbl
  1522             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1523         16  CM-LOAN-NUMBER                PIC X(8).
  1524         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1525         16  CM-OLD-LOF                    PIC XXX.
  1526*        16  CM-LOAN-OFFICER               PIC XXX.
  1527         16  CM-REIN-TABLE                 PIC XXX.
  1528         16  CM-SPECIAL-REIN-CODE          PIC X.
  1529         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1530         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1531         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1532
  1533     12  CM-STATUS-DATA.
  1534         16  CM-ENTRY-STATUS               PIC X.
  1535         16  CM-ENTRY-DT                   PIC XX.
  1536
  1537         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1538         16  CM-LF-CANCEL-DT               PIC XX.
  1539         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1540
  1541         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1542         16  CM-LF-DEATH-DT                PIC XX.
  1543         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1544
  1545         16  CM-LF-CURRENT-STATUS          PIC X.
  1546             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1547                                                'M' '4' '5' '9'.
  1548             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1549             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1550             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1551             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1552             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1553             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1554             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1555             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1556             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1557             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1558             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1559             88  CM-LF-DECLINED               VALUE 'D'.
  1560             88  CM-LF-VOIDED                 VALUE 'V'.
  1561
  1562         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1563         16  CM-AH-CANCEL-DT               PIC XX.
  1564         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1565
  1566         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1567         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1568         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1569
  1570         16  CM-AH-CURRENT-STATUS          PIC X.
  1571             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1572                                                'M' '4' '5' '9'.
  1573             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1574             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1575             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1576             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1577             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1578             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1579             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  29
* WSMESS02.cbl
  1580             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1581             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1582             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1583             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1584             88  CM-AH-DECLINED               VALUE 'D'.
  1585             88  CM-AH-VOIDED                 VALUE 'V'.
  1586
  1587         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1588             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1589             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1590             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1591         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1592
  1593         16  CM-ENTRY-BATCH                PIC X(6).
  1594         16  CM-LF-EXIT-BATCH              PIC X(6).
  1595         16  CM-AH-EXIT-BATCH              PIC X(6).
  1596         16  CM-LAST-MONTH-END             PIC XX.
  1597
  1598     12  CM-NOTE-SW                        PIC X.
  1599         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1600         88  CERT-NOTES-PRESENT               VALUE '1'.
  1601         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1602         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1603         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1604         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1605         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1606         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1607     12  CM-COMP-EXCP-SW                   PIC X.
  1608         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1609         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1610     12  CM-INSURED-ADDRESS-SW             PIC X.
  1611         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1612         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1613
  1614*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1615     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1616     12  FILLER                            PIC X.
  1617
  1618*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1619     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1620     12  FILLER                            PIC X.
  1621*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1622     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1623
  1624     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1625         88  CERT-ADDED-BATCH                 VALUE ' '.
  1626         88  CERT-ADDED-ONLINE                VALUE '1'.
  1627         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1628         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1629         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1630     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1631         88  CERT-AS-LOADED                   VALUE ' '.
  1632         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1633         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1634         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1635         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1636         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1637         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  30
* WSMESS02.cbl
  1638         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1639
  1640     12  CM-ACCOUNT-COMM-PCTS.
  1641         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1642         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1643
  1644     12  CM-USER-FIELD                     PIC X.
  1645     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1646     12  CM-CLP-STATE                      PIC XX.
  1647     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1648     12  CM-USER-RESERVED                  PIC XXX.
  1649     12  FILLER REDEFINES CM-USER-RESERVED.
  1650         16  CM-AH-CLASS-CD                PIC XX.
  1651         16  F                             PIC X.
  1652******************************************************************
  1653*                                 COPY ELCCRTT.
  1654******************************************************************
  1655*                                                                *
  1656*                            ELCCRTT.                            *
  1657*                                                                *
  1658*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1659*                                                                *
  1660*   FILE TYPE = VSAM,KSDS                                        *
  1661*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1662*                                                                *
  1663*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1664*                                                                *
  1665*   LOG = YES                                                    *
  1666*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1667******************************************************************
  1668*                   C H A N G E   L O G
  1669*
  1670* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1671*-----------------------------------------------------------------
  1672*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1673* EFFECTIVE    NUMBER
  1674*-----------------------------------------------------------------
  1675* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1676* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1677* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1678* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1679* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1680* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1681* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1682* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1683* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1684* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  1685* 091318  CR2018073000001  PEMA  ADD Refund methods
  1686* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1687******************************************************************
  1688
  1689 01  CERTIFICATE-TRAILERS.
  1690     12  CS-RECORD-ID                      PIC XX.
  1691         88  VALID-CS-ID                      VALUE 'CS'.
  1692
  1693     12  CS-CONTROL-PRIMARY.
  1694         16  CS-COMPANY-CD                 PIC X.
  1695         16  CS-CARRIER                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  31
* WSMESS02.cbl
  1696         16  CS-GROUPING                   PIC X(6).
  1697         16  CS-STATE                      PIC XX.
  1698         16  CS-ACCOUNT                    PIC X(10).
  1699         16  CS-CERT-EFF-DT                PIC XX.
  1700         16  CS-CERT-NO.
  1701             20  CS-CERT-PRIME             PIC X(10).
  1702             20  CS-CERT-SFX               PIC X.
  1703         16  CS-TRAILER-TYPE               PIC X.
  1704             88  COMM-TRLR           VALUE 'A'.
  1705             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1706             88  CERT-DATA-TRLR      VALUE 'C'.
  1707
  1708     12  CS-DATA-AREA                      PIC X(516).
  1709
  1710     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1711         16  CS-BANK-COMMISSION-AREA.
  1712             20  CS-BANK-COMMS       OCCURS 10.
  1713                 24  CS-AGT                PIC X(10).
  1714                 24  CS-COM-TYP            PIC X.
  1715                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1716                 24  CS-RECALC-LV-INDIC    PIC X.
  1717                 24  FILLER                PIC X(10).
  1718         16  FILLER                        PIC X(256).
  1719
  1720     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1721****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1722         16  CS-MB-CLAIM-DATA OCCURS 24.
  1723             20  CS-CLAIM-NO               PIC X(7).
  1724             20  CS-CLAIM-TYPE             PIC X.
  1725                 88  CS-AH-CLM               VALUE 'A'.
  1726                 88  CS-IU-CLM               VALUE 'I'.
  1727                 88  CS-GP-CLM               VALUE 'G'.
  1728                 88  CS-LF-CLM               VALUE 'L'.
  1729                 88  CS-PR-CLM               VALUE 'P'.
  1730                 88  CS-FL-CLM               VALUE 'F'.
  1731                 88  CS-OT-CLM               VALUE 'O'.
  1732             20  CS-INSURED-TYPE           PIC X.
  1733                 88  CS-PRIM-INSURED          VALUE 'P'.
  1734                 88  CS-CO-BORROWER           VALUE 'C'.
  1735             20  CS-BENEFIT-PERIOD         PIC 99.
  1736             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1737             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1738             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1739         16  FILLER                        PIC X(12).
  1740     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1741         16  CS-VIN-NUMBER                 PIC X(17).
  1742         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1743         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1744         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1745         16  cs-agent-name.
  1746             20  cs-agent-fname            pic x(20).
  1747             20  cs-agent-mi               pic x.
  1748             20  cs-agent-lname            pic x(25).
  1749         16  cs-license-no                 pic x(15).
  1750         16  cs-npn-number                 pic x(10).
  1751         16  cs-agent-edit-status          pic x.
  1752             88  cs-ae-refer-to-manager      value 'M'.
  1753             88  cs-ae-cover-sheet           value 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  32
* WSMESS02.cbl
  1754             88  cs-ae-sig-form              value 'S'.
  1755             88  cs-ae-verified              value 'V'.
  1756             88  cs-unidentified-signature   value 'U'.
  1757             88  cs-cert-returned            value 'R'.
  1758             88  cs-accept-no-commission     value 'N'.
  1759         16  cs-year                       pic 9999.
  1760         16  cs-make                       pic x(20).
  1761         16  cs-model                      pic x(20).
  1762         16  cs-future                     pic x(20).
  1763         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1764         16  cs-claim-verification-status  pic x.
  1765             88  cs-clm-ver-eligible         value 'A'.
  1766             88  cs-clm-ver-partial-elig     value 'B'.
  1767             88  cs-clm-ver-not-eligible     value 'C'.
  1768             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  1769             88  cs-clm-ver-not-part-elig-rw value 'E'.
  1770             88  cs-clm-ver-ND-CERT          value 'F'.
  1771             88  cs-clm-ver-spec-other       value 'G'.
  1772             88  cs-clam-ver-pratial-corrected
  1773                                             value 'H'.
  1774             88  cs-clm-ver-no-matches       value 'I'.
  1775             88  cs-clm-ver-not-elig-corrected
  1776                                             value 'J'.
  1777             88  cs-clm-ver-needs-review     value 'R'.
  1778             88  cs-clm-ver-sent-to-claims   value 'W'.
  1779         16  CS-LF-REFUND-METHOD           PIC X.
  1780         16  CS-AH-REFUND-METHOD           PIC X.
  1781         16  FILLER                        PIC X(353). *> was 420
  1782*        16  FILLER                        PIC X(496).
  1783*                                 COPY ELCCNTL.
  1784******************************************************************
  1785*                                                                *
  1786*                                                                *
  1787*                            ELCCNTL.                            *
  1788*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1789*                            VMOD=2.059                          *
  1790*                                                                *
  1791*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1792*                                                                *
  1793*   FILE TYPE = VSAM,KSDS                                        *
  1794*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1795*                                                                *
  1796*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1797*       ALTERNATE INDEX = NONE                                   *
  1798*                                                                *
  1799*   LOG = YES                                                    *
  1800*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1801******************************************************************
  1802*                   C H A N G E   L O G
  1803*
  1804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1805*-----------------------------------------------------------------
  1806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1807* EFFECTIVE    NUMBER
  1808*-----------------------------------------------------------------
  1809* 082503                   PEMA  ADD BENEFIT GROUP
  1810* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1811* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  33
* WSMESS02.cbl
  1812* 092705    2005050300006  PEMA  ADD SPP LEASES
  1813* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1814* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1815* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1816* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1817* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1818* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1819* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1820* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1821* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1822* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1823* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1824******************************************************************
  1825*
  1826 01  CONTROL-FILE.
  1827     12  CF-RECORD-ID                       PIC XX.
  1828         88  VALID-CF-ID                        VALUE 'CF'.
  1829
  1830     12  CF-CONTROL-PRIMARY.
  1831         16  CF-COMPANY-ID                  PIC XXX.
  1832         16  CF-RECORD-TYPE                 PIC X.
  1833             88  CF-COMPANY-MASTER              VALUE '1'.
  1834             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1835             88  CF-STATE-MASTER                VALUE '3'.
  1836             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1837             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1838             88  CF-CARRIER-MASTER              VALUE '6'.
  1839             88  CF-MORTALITY-MASTER            VALUE '7'.
  1840             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1841             88  CF-TERMINAL-MASTER             VALUE '9'.
  1842             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1843             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1844             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1845             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1846             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1847             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1848             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1849             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1850             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1851         16  CF-ACCESS-CD-GENL              PIC X(4).
  1852         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1853             20  CF-PROCESSOR               PIC X(4).
  1854         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1855             20  CF-STATE-CODE              PIC XX.
  1856             20  FILLER                     PIC XX.
  1857         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1858             20  FILLER                     PIC XX.
  1859             20  CF-HI-BEN-IN-REC           PIC XX.
  1860         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1861             20  FILLER                     PIC XXX.
  1862             20  CF-CARRIER-CNTL            PIC X.
  1863         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1864             20  FILLER                     PIC XX.
  1865             20  CF-HI-TYPE-IN-REC          PIC 99.
  1866         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1867             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1868                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1869             20  CF-CRDB-BENEFIT-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  34
* WSMESS02.cbl
  1870             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1871         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1872             20  FILLER                     PIC X.
  1873             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1874         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1875             20  FILLER                     PIC XX.
  1876             20  CF-MORTGAGE-PLAN           PIC XX.
  1877         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1878
  1879     12  CF-LAST-MAINT-DT                   PIC XX.
  1880     12  CF-LAST-MAINT-BY                   PIC X(4).
  1881     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1882
  1883     12  CF-RECORD-BODY                     PIC X(728).
  1884
  1885
  1886****************************************************************
  1887*             COMPANY MASTER RECORD                            *
  1888****************************************************************
  1889
  1890     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1891         16  CF-COMPANY-ADDRESS.
  1892             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1893             20  CF-CL-IN-CARE-OF           PIC X(30).
  1894             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1895             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1896             20  CF-CL-CITY-STATE           PIC X(30).
  1897             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1898             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1899         16  CF-COMPANY-CD                  PIC X.
  1900         16  CF-COMPANY-PASSWORD            PIC X(8).
  1901         16  CF-SECURITY-OPTION             PIC X.
  1902             88  ALL-SECURITY                   VALUE '1'.
  1903             88  COMPANY-VERIFY                 VALUE '2'.
  1904             88  PROCESSOR-VERIFY               VALUE '3'.
  1905             88  NO-SECURITY                    VALUE '4'.
  1906             88  ALL-BUT-TERM                   VALUE '5'.
  1907         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1908             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1909         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1910             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1911         16  CF-INFORCE-LOCATION            PIC X.
  1912             88  CERTS-ARE-ONLINE               VALUE '1'.
  1913             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1914             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1915         16  CF-LOWER-CASE-LETTERS          PIC X.
  1916         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1917             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1918             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1919             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1920             88  CF-ACCNT-CNTL                  VALUE '3'.
  1921             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1922
  1923         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1924         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1925
  1926         16  CF-LGX-CREDIT-USER             PIC X.
  1927             88  CO-IS-NOT-USER                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  35
* WSMESS02.cbl
  1928             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1929
  1930         16 CF-CREDIT-CALC-CODES.
  1931             20  CF-CR-REM-TERM-CALC PIC X.
  1932               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1933               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1934               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1935               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1936               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1937               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1938               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1939             20  CF-CR-R78-METHOD           PIC X.
  1940               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1941               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1942
  1943         16  CF-CLAIM-CONTROL-COUNTS.
  1944             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1945                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1946
  1947             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1948                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1949
  1950             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1951                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1952
  1953             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1954                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1955
  1956         16  CF-CURRENT-MONTH-END           PIC XX.
  1957
  1958         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1959             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1960             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1961             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1962             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1963                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1964                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1965             20  CF-CO-PREM-REJECT-SW       PIC X.
  1966                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1967                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1968             20  CF-CO-REF-REJECT-SW        PIC X.
  1969                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1970                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1971
  1972         16  CF-CO-REPORTING-DT             PIC XX.
  1973         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1974         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1975           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1976           88  CF-CO-MONTH-END                  VALUE '1'.
  1977
  1978         16  CF-LGX-CLAIM-USER              PIC X.
  1979             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1980             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1981
  1982         16  CF-CREDIT-EDIT-CONTROLS.
  1983             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1984             20  CF-MIN-AGE                 PIC 99.
  1985             20  CF-DEFAULT-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  36
* WSMESS02.cbl
  1986             20  CF-MIN-TERM                PIC S999      COMP-3.
  1987             20  CF-MAX-TERM                PIC S999      COMP-3.
  1988             20  CF-DEFAULT-SEX             PIC X.
  1989             20  CF-JOINT-AGE-INPUT         PIC X.
  1990                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1991             20  CF-BIRTH-DATE-INPUT        PIC X.
  1992                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1993             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1994                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1995                 88  CF-ZERO-CARRIER            VALUE '1'.
  1996                 88  CF-ZERO-GROUPING           VALUE '2'.
  1997                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1998             20  CF-EDIT-SW                 PIC X.
  1999                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2000             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2001             20  CF-CR-PR-METHOD            PIC X.
  2002               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2003               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2004             20  FILLER                     PIC X.
  2005
  2006         16  CF-CREDIT-MISC-CONTROLS.
  2007             20  CF-REIN-TABLE-SW           PIC X.
  2008                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2009             20  CF-COMP-TABLE-SW           PIC X.
  2010                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2011             20  CF-EXPERIENCE-RETENTION-AGE
  2012                                            PIC S9        COMP-3.
  2013             20  CF-CONVERSION-DT           PIC XX.
  2014             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2015             20  CF-RUN-FREQUENCY-SW        PIC X.
  2016                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2017                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2018
  2019             20  CF-CR-CHECK-NO-CONTROL.
  2020                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2021                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2022                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2023                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2024                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2025                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2026
  2027                 24  CF-CR-CHECK-COUNT       REDEFINES
  2028                     CF-CR-CHECK-COUNTER      PIC X(4).
  2029
  2030                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2031                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2032
  2033                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2034                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2035                 24  CF-MAIL-PROCESSING       PIC X.
  2036                     88  MAIL-PROCESSING          VALUE 'Y'.
  2037
  2038         16  CF-MISC-SYSTEM-CONTROL.
  2039             20  CF-SYSTEM-C                 PIC X.
  2040                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2041             20  CF-SYSTEM-D                 PIC X.
  2042                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2043             20  CF-SOC-SEC-NO-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  37
* WSMESS02.cbl
  2044                 88  SOC-SEC-NO-USED             VALUE '1'.
  2045             20  CF-MEMBER-NO-SW             PIC X.
  2046                 88  MEMBER-NO-USED              VALUE '1'.
  2047             20  CF-TAX-ID-NUMBER            PIC X(11).
  2048             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2049             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2050                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2051                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2052                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2053                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2054             20  CF-SYSTEM-E                 PIC X.
  2055                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2056
  2057         16  CF-LGX-LIFE-USER               PIC X.
  2058             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2059             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2060
  2061         16  CF-CR-MONTH-END-DT             PIC XX.
  2062
  2063         16  CF-FILE-MAINT-DATES.
  2064             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2065                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2066             20  CF-LAST-BATCH       REDEFINES
  2067                 CF-LAST-BATCH-NO               PIC X(4).
  2068             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2069             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2070             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2071             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2072             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2073             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2074             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2075             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2076             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2077             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2078
  2079         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2080         16  FILLER                         PIC X.
  2081
  2082         16  CF-ALT-MORT-CODE               PIC X(4).
  2083         16  CF-MEMBER-CAPTION              PIC X(10).
  2084
  2085         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2086             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2087             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2088             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2089             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2090             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2091
  2092         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2093
  2094         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2095         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2096         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2097         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2098
  2099         16  CF-AH-OVERRIDE-L1              PIC X.
  2100         16  CF-AH-OVERRIDE-L2              PIC XX.
  2101         16  CF-AH-OVERRIDE-L6              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  38
* WSMESS02.cbl
  2102         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2103
  2104         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2105         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2106
  2107         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2108         16  CF-AR-LAST-EL860-DT            PIC XX.
  2109         16  CF-MP-MONTH-END-DT             PIC XX.
  2110
  2111         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2112         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2113             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2114
  2115         16  CF-AR-MONTH-END-DT             PIC XX.
  2116
  2117         16  CF-CRDTCRD-USER                PIC X.
  2118             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2119             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2120
  2121         16  CF-CC-MONTH-END-DT             PIC XX.
  2122
  2123         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2124
  2125         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2126             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2127             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2128             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2129         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2130         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2131         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2132         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2133             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2134             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2135         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2136         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2137         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2138             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2139         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2140
  2141         16  CF-CL-ZIP-CODE.
  2142             20  CF-CL-ZIP-PRIME.
  2143                 24  CF-CL-ZIP-1ST          PIC X.
  2144                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2145                 24  FILLER                 PIC X(4).
  2146             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2147         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2148             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2149             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2150             20  FILLER                     PIC XXX.
  2151
  2152         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2153         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2154         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2155         16  CF-CO-OPTION-START-DATE        PIC XX.
  2156         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2157           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2158                                                      '3' '4'.
  2159           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  39
* WSMESS02.cbl
  2160           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2161           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2162           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2163           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2164           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2165
  2166         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2167
  2168         16  CF-PAYMENT-APPROVAL-LEVELS.
  2169             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2170             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2171             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2172             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2173             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2174             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2175
  2176         16  CF-END-USER-REPORTING-USER     PIC X.
  2177             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2178             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2179
  2180         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2181             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2182             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2183
  2184         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2185
  2186         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2187         16  FILLER                         PIC X.
  2188
  2189         16  CF-CREDIT-ARCHIVE-CNTL.
  2190             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2191             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2192             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2193
  2194         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2195
  2196         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2197             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2198             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2199
  2200         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2201             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2202             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2203
  2204         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2205
  2206         16  CF-CO-ACH-ID-CODE              PIC  X.
  2207             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2208             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2209             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2210         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2211         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2212         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2213         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2214         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2215         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2216         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2217         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  40
* WSMESS02.cbl
  2218         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2219                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2220         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2221                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2222
  2223         16  CF-CO-OVER-SHORT.
  2224             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2225             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2226
  2227*         16  FILLER                         PIC X(102).
  2228         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2229             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2230             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2231
  2232         16  CF-AH-APPROVAL-DAYS.
  2233             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2234             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2235             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2236             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2237
  2238         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2239
  2240         16  CF-APPROV-LEV-5.
  2241             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2242             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2243             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2244
  2245         16  FILLER                         PIC X(68).
  2246****************************************************************
  2247*             PROCESSOR/USER RECORD                            *
  2248****************************************************************
  2249
  2250     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2251         16  CF-PROCESSOR-NAME              PIC X(30).
  2252         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2253         16  CF-PROCESSOR-TITLE             PIC X(26).
  2254         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2255                 88  MESSAGE-YES                VALUE 'Y'.
  2256                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2257
  2258*****************************************************
  2259****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2260****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2261****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2262****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2263*****************************************************
  2264
  2265         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2266             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2267             20  CF-APPLICATION-FORCE       PIC X.
  2268             20  CF-INDIVIDUAL-APP.
  2269                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2270                     28  CF-BROWSE-APP      PIC X.
  2271                     28  CF-UPDATE-APP      PIC X.
  2272
  2273         16  CF-CURRENT-TERM-ON             PIC X(4).
  2274         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2275             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  41
* WSMESS02.cbl
  2276             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2277             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2278             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2279             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2280             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2281             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2282         16  CF-PROCESSOR-CARRIER           PIC X.
  2283             88  NO-CARRIER-SECURITY            VALUE ' '.
  2284         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2285             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2286         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2287             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2288         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2289             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2290
  2291         16  CF-PROC-SYS-ACCESS-SW.
  2292             20  CF-PROC-CREDIT-CLAIMS-SW.
  2293                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2294                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2295                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2296                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2297             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2298                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2299                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2300             20  CF-PROC-LIFE-GNRLDGR-SW.
  2301                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2302                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2303                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2304                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2305             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2306                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2307                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2308         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2309             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2310             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2311         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2312
  2313         16  CF-APPROVAL-LEVEL                  PIC X.
  2314             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2315             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2316             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2317             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2318             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2319
  2320         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2321
  2322         16  CF-LANGUAGE-TYPE                   PIC X.
  2323             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2324             88  CF-LANG-IS-FR                      VALUE 'F'.
  2325
  2326         16  CF-CSR-IND                         PIC X.
  2327         16  FILLER                             PIC X(239).
  2328
  2329****************************************************************
  2330*             PROCESSOR/REMINDERS RECORD                       *
  2331****************************************************************
  2332
  2333     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  42
* WSMESS02.cbl
  2334         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2335             20  CF-START-REMIND-DT         PIC XX.
  2336             20  CF-END-REMIND-DT           PIC XX.
  2337             20  CF-REMINDER-TEXT           PIC X(50).
  2338         16  FILLER                         PIC X(296).
  2339
  2340
  2341****************************************************************
  2342*             STATE MASTER RECORD                              *
  2343****************************************************************
  2344
  2345     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2346         16  CF-STATE-ABBREVIATION          PIC XX.
  2347         16  CF-STATE-NAME                  PIC X(25).
  2348         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2349         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2350             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2351             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2352             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2353             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2354                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2355                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2356             20  CF-ST-PREM-REJECT-SW       PIC X.
  2357                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2358                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2359             20  CF-ST-REF-REJECT-SW        PIC X.
  2360                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2361                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2362         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2363         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2364         16  CF-ST-REFUND-RULES.
  2365             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2366             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2367             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2368         16  CF-ST-FST-PMT-EXTENSION.
  2369             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2370             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2371                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2372                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2373                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2374                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2375         16  CF-ST-STATE-CALL.
  2376             20  CF-ST-CALL-UNEARNED        PIC X.
  2377             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2378             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2379         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2380             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2381             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2382         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2383         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2384         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2385         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2386         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2387         16  FILLER                         PIC X.
  2388         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2389             20  CF-ST-BENEFIT-CD           PIC XX.
  2390             20  CF-ST-BENEFIT-KIND         PIC X.
  2391                 88  CF-ST-LIFE-KIND            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  43
* WSMESS02.cbl
  2392                 88  CF-ST-AH-KIND              VALUE 'A'.
  2393             20  CF-ST-REM-TERM-CALC        PIC X.
  2394                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2395                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2396                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2397                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2398                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2399                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2400                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2401                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2402
  2403             20  CF-ST-REFUND-CALC          PIC X.
  2404                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2405                 88  ST-REFD-BY-R78             VALUE '1'.
  2406                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2407                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2408                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2409                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2410                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2411                 88  ST-REFD-UTAH               VALUE '7'.
  2412                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2413                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2414                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2415
  2416             20  CF-ST-EARNING-CALC         PIC X.
  2417                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2418                 88  ST-EARN-BY-R78             VALUE '1'.
  2419                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2420                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2421                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2422                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2423                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2424                 88  ST-EARN-MEAN               VALUE '8'.
  2425                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2426
  2427             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2428                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2429                 88  ST-OVRD-BY-R78             VALUE '1'.
  2430                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2431                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2432                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2433                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2434                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2435                 88  ST-OVRD-MEAN               VALUE '8'.
  2436                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2437             20  cf-st-extra-periods        pic 9.
  2438*            20  FILLER                     PIC X.
  2439
  2440         16  CF-ST-COMMISSION-CAPS.
  2441             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2442             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2443             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2444             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2445         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2446                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2447                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2448                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2449
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  44
* WSMESS02.cbl
  2450         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2451
  2452         16  CF-ST-STATUTORY-INTEREST.
  2453             20  CF-ST-STAT-DATE-FROM       PIC X.
  2454                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2455                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2456             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2457             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2458             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2459             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2460             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2461
  2462         16  CF-ST-OVER-SHORT.
  2463             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2464             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2465
  2466         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2467
  2468         16  CF-ST-RT-CALC                  PIC X.
  2469
  2470         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2471         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2472         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2473         16  CF-ST-RF-LR-CALC               PIC X.
  2474         16  CF-ST-RF-LL-CALC               PIC X.
  2475         16  CF-ST-RF-LN-CALC               PIC X.
  2476         16  CF-ST-RF-AH-CALC               PIC X.
  2477         16  CF-ST-RF-CP-CALC               PIC X.
  2478*        16  FILLER                         PIC X(206).
  2479*CIDMOD         16  FILLER                         PIC X(192).
  2480         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2481             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2482         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2483         16  CF-ST-VFY-2ND-BENE             PIC X.
  2484         16  CF-ST-CAUSAL-STATE             PIC X.
  2485         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2486         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2487         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2488             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2489         16  CF-ST-NET-ONLY-STATE           PIC X.
  2490             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2491         16  cf-commission-cap-required     pic x.
  2492         16  CF-ST-GA-COMMISSION-CAPS.
  2493             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2494             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2495             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2496             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2497         16  CF-ST-TOT-COMMISSION-CAPS.
  2498             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2499             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2500             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2501             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2502         16  FILLER                         PIC X(156).
  2503
  2504****************************************************************
  2505*             BENEFIT MASTER RECORD                            *
  2506****************************************************************
  2507
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  45
* WSMESS02.cbl
  2508     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2509         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2510             20  CF-BENEFIT-CODE            PIC XX.
  2511             20  CF-BENEFIT-NUMERIC  REDEFINES
  2512                 CF-BENEFIT-CODE            PIC XX.
  2513             20  CF-BENEFIT-ALPHA           PIC XXX.
  2514             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2515             20  CF-BENEFIT-COMMENT         PIC X(10).
  2516
  2517             20  CF-LF-COVERAGE-TYPE        PIC X.
  2518                 88  CF-REDUCING                VALUE 'R'.
  2519                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2520
  2521             20  CF-SPECIAL-CALC-CD         PIC X.
  2522                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2523                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2524                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2525                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2526                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2527                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2528                 88  CF-FARM-PLAN               VALUE 'F'.
  2529                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2530                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2531                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2532                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2533                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2534                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2535                 88  CF-PRUDENTIAL              VALUE 'P'.
  2536                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2537                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2538                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2539                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2540                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2541                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2542
  2543             20  CF-JOINT-INDICATOR         PIC X.
  2544                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2545
  2546*            20  FILLER                     PIC X(12).
  2547             20  cf-maximum-benefits        pic s999 comp-3.
  2548             20  FILLER                     PIC X(09).
  2549             20  CF-BENEFIT-CATEGORY        PIC X.
  2550             20  CF-LOAN-TYPE               PIC X(8).
  2551
  2552             20  CF-CO-REM-TERM-CALC        PIC X.
  2553                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2554                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2555                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2556                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2557                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2558
  2559             20  CF-CO-EARNINGS-CALC        PIC X.
  2560                 88  CO-EARN-BY-R78             VALUE '1'.
  2561                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2562                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2563                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2564                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2565                 88  CO-EARN-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  46
* WSMESS02.cbl
  2566                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2567                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2568
  2569             20  CF-CO-REFUND-CALC          PIC X.
  2570                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2571                 88  CO-REFD-BY-R78             VALUE '1'.
  2572                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2573                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2574                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2575                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2576                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2577                 88  CO-REFD-MEAN               VALUE '8'.
  2578                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2579                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2580                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2581
  2582             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2583                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2584                 88  CO-OVRD-BY-R78             VALUE '1'.
  2585                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2586                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2587                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2588                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2589                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2590                 88  CO-OVRD-MEAN               VALUE '8'.
  2591                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2592
  2593             20  CF-CO-BEN-I-G-CD           PIC X.
  2594                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2595                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2596                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2597
  2598         16  FILLER                         PIC X(304).
  2599
  2600
  2601****************************************************************
  2602*             CARRIER MASTER RECORD                            *
  2603****************************************************************
  2604
  2605     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2606         16  CF-ADDRESS-DATA.
  2607             20  CF-MAIL-TO-NAME            PIC X(30).
  2608             20  CF-IN-CARE-OF              PIC X(30).
  2609             20  CF-ADDRESS-LINE-1          PIC X(30).
  2610             20  CF-ADDRESS-LINE-2          PIC X(30).
  2611             20  CF-CITY-STATE              PIC X(30).
  2612             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2613             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2614
  2615         16  CF-CLAIM-NO-CONTROL.
  2616             20  CF-CLAIM-NO-METHOD         PIC X.
  2617                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2618                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2619                 88  CLAIM-NO-SEQ               VALUE '3'.
  2620                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2621             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2622                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2623                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  47
* WSMESS02.cbl
  2624                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2625
  2626         16  CF-CHECK-NO-CONTROL.
  2627             20  CF-CHECK-NO-METHOD         PIC X.
  2628                 88  CHECK-NO-MANUAL            VALUE '1'.
  2629                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2630                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2631                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2632             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2633                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2634
  2635         16  CF-DOMICILE-STATE              PIC XX.
  2636
  2637         16  CF-EXPENSE-CONTROLS.
  2638             20  CF-EXPENSE-METHOD          PIC X.
  2639                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2640                 88  DOLLARS-PER-PMT            VALUE '2'.
  2641                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2642                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2643             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2644             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2645
  2646         16  CF-CORRESPONDENCE-CONTROL.
  2647             20  CF-LETTER-RESEND-OPT       PIC X.
  2648                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2649                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2650             20  FILLER                     PIC X(4).
  2651
  2652         16  CF-RESERVE-CONTROLS.
  2653             20  CF-MANUAL-SW               PIC X.
  2654                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2655             20  CF-FUTURE-SW               PIC X.
  2656                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2657             20  CF-PTC-SW                  PIC X.
  2658                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2659             20  CF-IBNR-SW                 PIC X.
  2660                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2661             20  CF-PTC-LF-SW               PIC X.
  2662                 88  CF-LF-PTC-USED             VALUE '1'.
  2663             20  CF-CDT-ACCESS-METHOD       PIC X.
  2664                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2665                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2666                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2667             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2668
  2669         16  CF-CLAIM-CALC-METHOD           PIC X.
  2670             88  360-PLUS-MONTHS                VALUE '1'.
  2671             88  365-PLUS-MONTHS                VALUE '2'.
  2672             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2673             88  360-DAILY                      VALUE '4'.
  2674             88  365-DAILY                      VALUE '5'.
  2675
  2676         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2677         16  FILLER                         PIC X(11).
  2678
  2679         16  CF-LIMIT-AMOUNTS.
  2680             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2681             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  48
* WSMESS02.cbl
  2682             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2683             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2684             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2685             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2686             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2687             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2688             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2689             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2690
  2691         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2692         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2693         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2694
  2695         16  CF-ZIP-CODE.
  2696             20  CF-ZIP-PRIME.
  2697                 24  CF-ZIP-1ST             PIC X.
  2698                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2699                 24  FILLER                 PIC X(4).
  2700             20  CF-ZIP-PLUS4               PIC X(4).
  2701         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2702             20  CF-CAN-POSTAL-1            PIC XXX.
  2703             20  CF-CAN-POSTAL-2            PIC XXX.
  2704             20  FILLER                     PIC XXX.
  2705
  2706         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2707         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2708         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2709
  2710         16  CF-RATING-SWITCH               PIC X.
  2711             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2712             88  CF-NO-RATING                   VALUE 'N'.
  2713
  2714         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2715
  2716         16  CF-CARRIER-OVER-SHORT.
  2717             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2718             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2719
  2720         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2721         16  CF-SECPAY-SWITCH               PIC X.
  2722             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2723             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2724         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2725         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2726         16  FILLER                         PIC X(444).
  2727*        16  FILLER                         PIC X(452).
  2728
  2729
  2730****************************************************************
  2731*             MORTALITY MASTER RECORD                          *
  2732****************************************************************
  2733
  2734     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2735         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2736                                INDEXED BY CF-MORT-NDX.
  2737             20  CF-MORT-TABLE              PIC X(5).
  2738             20  CF-MORT-TABLE-TYPE         PIC X.
  2739                 88  CF-MORT-JOINT              VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  49
* WSMESS02.cbl
  2740                 88  CF-MORT-SINGLE             VALUE 'S'.
  2741                 88  CF-MORT-COMBINED           VALUE 'C'.
  2742                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2743                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2744             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2745             20  CF-MORT-AGE-METHOD         PIC XX.
  2746                 88  CF-AGE-LAST                VALUE 'AL'.
  2747                 88  CF-AGE-NEAR                VALUE 'AN'.
  2748             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2749             20  CF-MORT-ADJUSTMENT-DIRECTION
  2750                                            PIC X.
  2751                 88  CF-MINUS                   VALUE '-'.
  2752                 88  CF-PLUS                    VALUE '+'.
  2753             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2754             20  CF-MORT-JOINT-CODE         PIC X.
  2755                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2756             20  CF-MORT-PC-Q               PIC X.
  2757                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2758             20  CF-MORT-TABLE-CODE         PIC X(4).
  2759             20  CF-MORT-COMMENTS           PIC X(15).
  2760             20  FILLER                     PIC X(14).
  2761
  2762         16  FILLER                         PIC X(251).
  2763
  2764
  2765****************************************************************
  2766*             BUSSINESS TYPE MASTER RECORD                     *
  2767****************************************************************
  2768
  2769     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2770* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2771* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2772* AND RECORD 05 IS TYPES 81-99
  2773         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2774             20  CF-BUSINESS-TITLE          PIC  X(19).
  2775             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2776                                            PIC S9V9(4) COMP-3.
  2777             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2778             20  FILLER                     PIC  X.
  2779         16  FILLER                         PIC  X(248).
  2780
  2781
  2782****************************************************************
  2783*             TERMINAL MASTER RECORD                           *
  2784****************************************************************
  2785
  2786     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2787
  2788         16  CF-COMPANY-TERMINALS.
  2789             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2790                                  PIC X(4).
  2791         16  FILLER               PIC X(248).
  2792
  2793
  2794****************************************************************
  2795*             LIFE EDIT MASTER RECORD                          *
  2796****************************************************************
  2797
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  50
* WSMESS02.cbl
  2798     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2799         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2800             20  CF-LIFE-CODE-IN            PIC XX.
  2801             20  CF-LIFE-CODE-OUT           PIC XX.
  2802         16  FILLER                         PIC X(248).
  2803
  2804
  2805****************************************************************
  2806*             AH EDIT MASTER RECORD                            *
  2807****************************************************************
  2808
  2809     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2810         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2811             20  CF-AH-CODE-IN              PIC XXX.
  2812             20  CF-AH-CODE-OUT             PIC XX.
  2813         16  FILLER                         PIC X(248).
  2814
  2815
  2816****************************************************************
  2817*             CREDIBILITY TABLES                               *
  2818****************************************************************
  2819
  2820     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2821         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2822                             INDEXED BY CF-CRDB-NDX.
  2823             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2824             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2825             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2826         16  FILLER                         PIC  X(332).
  2827
  2828
  2829****************************************************************
  2830*             REPORT CUSTOMIZATION RECORD                      *
  2831****************************************************************
  2832
  2833     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2834         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2835             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2836             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2837             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2838**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2839****       A T-TRANSFER.                                   ****
  2840             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2841
  2842         16  FILLER                         PIC XX.
  2843
  2844         16  CF-CARRIER-CNTL-OPT.
  2845             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2846                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2847                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2848             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2849                                            PIC X.
  2850         16  CF-GROUP-CNTL-OPT.
  2851             20  CF-GROUP-OPT-SEQ           PIC 9.
  2852                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2853                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2854             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2855                                            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  51
* WSMESS02.cbl
  2856         16  CF-STATE-CNTL-OPT.
  2857             20  CF-STATE-OPT-SEQ           PIC 9.
  2858                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2859                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2860             20  CF-STATE-SELECT OCCURS 3 TIMES
  2861                                            PIC XX.
  2862         16  CF-ACCOUNT-CNTL-OPT.
  2863             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2864                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2865                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2866             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2867                                            PIC X(10).
  2868         16  CF-BUS-TYP-CNTL-OPT.
  2869             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2870                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2871                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2872             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2873                                            PIC XX.
  2874         16  CF-LF-TYP-CNTL-OPT.
  2875             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2876                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2877                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2878             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2879                                            PIC XX.
  2880         16  CF-AH-TYP-CNTL-OPT.
  2881             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2882                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2883                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2884             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2885                                            PIC XX.
  2886         16  CF-REPTCD1-CNTL-OPT.
  2887             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2888                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2889                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2890             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2891                                            PIC X(10).
  2892         16  CF-REPTCD2-CNTL-OPT.
  2893             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2894                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2895                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2896             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2897                                            PIC X(10).
  2898         16  CF-USER1-CNTL-OPT.
  2899             20  CF-USER1-OPT-SEQ           PIC 9.
  2900                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2901                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2902             20  CF-USER1-SELECT OCCURS 3 TIMES
  2903                                            PIC X(10).
  2904         16  CF-USER2-CNTL-OPT.
  2905             20  CF-USER2-OPT-SEQ           PIC 9.
  2906                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2907                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2908             20  CF-USER2-SELECT OCCURS 3 TIMES
  2909                                            PIC X(10).
  2910         16  CF-USER3-CNTL-OPT.
  2911             20  CF-USER3-OPT-SEQ           PIC 9.
  2912                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2913                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  52
* WSMESS02.cbl
  2914             20  CF-USER3-SELECT OCCURS 3 TIMES
  2915                                            PIC X(10).
  2916         16  CF-USER4-CNTL-OPT.
  2917             20  CF-USER4-OPT-SEQ           PIC 9.
  2918                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2919                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2920             20  CF-USER4-SELECT OCCURS 3 TIMES
  2921                                            PIC X(10).
  2922         16  CF-USER5-CNTL-OPT.
  2923             20  CF-USER5-OPT-SEQ           PIC 9.
  2924                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2925                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2926             20  CF-USER5-SELECT OCCURS 3 TIMES
  2927                                            PIC X(10).
  2928         16  CF-REINS-CNTL-OPT.
  2929             20  CF-REINS-OPT-SEQ           PIC 9.
  2930                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2931                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2932             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2933                 24  CF-REINS-PRIME         PIC XXX.
  2934                 24  CF-REINS-SUB           PIC XXX.
  2935
  2936         16  CF-AGENT-CNTL-OPT.
  2937             20  CF-AGENT-OPT-SEQ           PIC 9.
  2938                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2939                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2940             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2941                                            PIC X(10).
  2942
  2943         16  FILLER                         PIC X(43).
  2944
  2945         16  CF-LOSS-RATIO-SELECT.
  2946             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2947             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2948         16  CF-ENTRY-DATE-SELECT.
  2949             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2950             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2951         16  CF-EFFECTIVE-DATE-SELECT.
  2952             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2953             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2954
  2955         16  CF-EXCEPTION-LIST-IND          PIC X.
  2956             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2957
  2958         16  FILLER                         PIC X(318).
  2959
  2960****************************************************************
  2961*                  EXCEPTION REPORTING RECORD                  *
  2962****************************************************************
  2963
  2964     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2965         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2966             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2967
  2968         16  CF-COMBINED-LIFE-AH-OPT.
  2969             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2970             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2971             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  53
* WSMESS02.cbl
  2972             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2973
  2974         16  CF-LIFE-OPT.
  2975             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2976             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2977             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2978             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2979             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2980             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2981             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2982             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2983             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2984             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2985
  2986         16  CF-AH-OPT.
  2987             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2988             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2989             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2990             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2991             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2992             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2993             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2994             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2995             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2996             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2997
  2998         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2999             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3000             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3001             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3002
  3003         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3004
  3005         16  FILLER                         PIC X(673).
  3006
  3007
  3008****************************************************************
  3009*             MORTGAGE SYSTEM PLAN RECORD                      *
  3010****************************************************************
  3011
  3012     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3013         16  CF-PLAN-TYPE                   PIC X.
  3014             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3015             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3016             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3017         16  CF-PLAN-ABBREV                 PIC XXX.
  3018         16  CF-PLAN-DESCRIPT               PIC X(10).
  3019         16  CF-PLAN-NOTES                  PIC X(20).
  3020         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3021         16  CF-PLAN-UNDERWRITING.
  3022             20  CF-PLAN-TERM-DATA.
  3023                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3024                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3025             20  CF-PLAN-AGE-DATA.
  3026                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3027                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3028                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3029             20  CF-PLAN-BENEFIT-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  54
* WSMESS02.cbl
  3030                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3031                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3032                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3033                                            PIC S9(7)V99  COMP-3.
  3034         16  CF-PLAN-POLICY-FORMS.
  3035             20  CF-POLICY-FORM             PIC X(12).
  3036             20  CF-MASTER-APPLICATION      PIC X(12).
  3037             20  CF-MASTER-POLICY           PIC X(12).
  3038         16  CF-PLAN-RATING.
  3039             20  CF-RATE-CODE               PIC X(5).
  3040             20  CF-SEX-RATING              PIC X.
  3041                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3042                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3043             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3044             20  CF-SUB-STD-TYPE            PIC X.
  3045                 88  CF-PCT-OF-PREM            VALUE '1'.
  3046                 88  CF-PCT-OF-BENE            VALUE '2'.
  3047         16  CF-PLAN-PREM-TOLERANCES.
  3048             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3049             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3050         16  CF-PLAN-PYMT-TOLERANCES.
  3051             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3052             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3053         16  CF-PLAN-MISC-DATA.
  3054             20  FILLER                     PIC X.
  3055             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3056             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3057         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3058         16  CF-PLAN-IND-GRP                PIC X.
  3059             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3060                                                     '1'.
  3061             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3062                                                     '2'.
  3063         16  CF-MIB-SEARCH-SW               PIC X.
  3064             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3065             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3066             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3067             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3068         16  CF-ALPHA-SEARCH-SW             PIC X.
  3069             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3070             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3071             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3072             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3073             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3074             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3075             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3076             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3077             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3078             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3079                                                     'A' 'B' 'C'
  3080                                                     'X' 'Y' 'Z'.
  3081         16  CF-EFF-DT-RULE-SW              PIC X.
  3082             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3083             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3084             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3085             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3086             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3087         16  FILLER                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  55
* WSMESS02.cbl
  3088         16  CF-HEALTH-QUESTIONS            PIC X.
  3089             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3090         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3091         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3092         16  CF-PLAN-SNGL-JNT               PIC X.
  3093             88  CF-COMBINED-PLAN              VALUE 'C'.
  3094             88  CF-JNT-PLAN                   VALUE 'J'.
  3095             88  CF-SNGL-PLAN                  VALUE 'S'.
  3096         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3097         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3098         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3099         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3100         16  CF-RERATE-CNTL                 PIC  X.
  3101             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3102             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3103             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3104             88  CF-AUTO-RECALC                 VALUE '4'.
  3105         16  CF-BENEFIT-TYPE                PIC  X.
  3106             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3107             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3108         16  CF-POLICY-FEE                  PIC S999V99
  3109                                                    COMP-3.
  3110         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3111         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3112         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3113         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3114         16  FILLER                         PIC  X(32).
  3115         16  CF-TERMINATION-FORM            PIC  X(04).
  3116         16  FILLER                         PIC  X(08).
  3117         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3118                                                       COMP-3.
  3119         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3120         16  CF-ISSUE-LETTER                PIC  X(4).
  3121         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3122         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3123             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3124             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3125         16  CF-MP-REFUND-CALC              PIC X.
  3126             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3127             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3128             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3129             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3130             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3131             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3132             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3133             88  CF-MP-REFD-MEAN                VALUE '8'.
  3134         16  CF-ALT-RATE-CODE               PIC  X(5).
  3135
  3136
  3137         16  FILLER                         PIC X(498).
  3138****************************************************************
  3139*             MORTGAGE COMPANY MASTER RECORD                   *
  3140****************************************************************
  3141
  3142     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3143         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3144         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3145             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  56
* WSMESS02.cbl
  3146             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3147             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3148             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3149             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3150
  3151         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3152         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3153         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3154         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3155         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3156
  3157         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3158             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3159         16  CF-MP-RECON-USE-IND            PIC X(1).
  3160             88  CF-MP-USE-RECON             VALUE 'Y'.
  3161         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3162             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3163         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3164             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3165             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3166         16  FILLER                         PIC X(1).
  3167         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3168             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3169         16  CF-MORTG-MIB-VERSION           PIC X.
  3170             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3171             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3172             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3173         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3174             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3175                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3176             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3177                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3178             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3179                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3180             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3181                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3182             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3183                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3184             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3185                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3186         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3187         16  FILLER                         PIC X(7).
  3188         16  CF-MORTG-DESTINATION-SYMBOL.
  3189             20  CF-MORTG-MIB-COMM          PIC X(5).
  3190             20  CF-MORTG-MIB-TERM          PIC X(5).
  3191         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3192             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3193         16  FILLER                         PIC X(03).
  3194         16  CF-MP-CHECK-NO-CONTROL.
  3195             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3196                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3197                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3198                                                ' ' LOW-VALUES.
  3199                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3200                                               VALUE '3'.
  3201         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3202         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3203         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  57
* WSMESS02.cbl
  3204             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3205                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3206             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3207                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3208             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3209                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3210             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3211                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3212             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3213                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3214             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3215                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3216         16  CF-MORTG-BILLING-AREA.
  3217             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3218                                            PIC X.
  3219         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3220         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3221         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3222         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3223             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3224             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3225         16  FILLER                         PIC X.
  3226         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3227             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3228             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3229         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3230         16  FILLER                         PIC X(8).
  3231         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3232         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3233         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3234         16  CF-ACH-COMPANY-ID.
  3235             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3236                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3237                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3238                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3239             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3240         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3241             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3242         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3243             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3244             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3245         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3246         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3247         16  FILLER                         PIC X(536).
  3248
  3249****************************************************************
  3250*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3251****************************************************************
  3252
  3253     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3254         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3255             20  CF-FEMALE-HEIGHT.
  3256                 24  CF-FEMALE-FT           PIC 99.
  3257                 24  CF-FEMALE-IN           PIC 99.
  3258             20  CF-FEMALE-MIN-WT           PIC 999.
  3259             20  CF-FEMALE-MAX-WT           PIC 999.
  3260         16  FILLER                         PIC X(428).
  3261
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  58
* WSMESS02.cbl
  3262     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3263         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3264             20  CF-MALE-HEIGHT.
  3265                 24  CF-MALE-FT             PIC 99.
  3266                 24  CF-MALE-IN             PIC 99.
  3267             20  CF-MALE-MIN-WT             PIC 999.
  3268             20  CF-MALE-MAX-WT             PIC 999.
  3269         16  FILLER                         PIC X(428).
  3270******************************************************************
  3271*             AUTOMATIC ACTIVITY RECORD                          *
  3272******************************************************************
  3273     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3274         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3275             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3276             20  CF-SYS-LETTER-ID           PIC X(04).
  3277             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3278             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3279             20  CF-SYS-RESET-SW            PIC X(01).
  3280             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3281             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3282
  3283         16  FILLER                         PIC X(50).
  3284
  3285         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3286             20  CF-USER-ACTIVE-SW          PIC X(01).
  3287             20  CF-USER-LETTER-ID          PIC X(04).
  3288             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3289             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3290             20  CF-USER-RESET-SW           PIC X(01).
  3291             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3292             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3293             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3294
  3295         16  FILLER                         PIC X(246).
  3296*                                 COPY ELCFUNDT.
  3297*****************************************************************
  3298*                                                               *
  3299*                            ELCFUNDT.                          *
  3300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
  3301*                            VMOD=2.001                         *
  3302*                                                               *
  3303*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
  3304*                                                               *
  3305*****************************************************************
  3306
  3307
  3308 01  FUNCTION-DATE.
  3309     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
  3310     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
  3311         10  WS-FN-CCYR            PIC 9(4).
  3312         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
  3313             15  WS-FN-CC          PIC 99.
  3314             15  WS-FN-YR          PIC 99.
  3315         10  WS-FN-MO              PIC 99.
  3316         10  WS-FN-DA              PIC 99.
  3317     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
  3318     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
  3319     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  59
* WSMESS02.cbl
  3320     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
  3321     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
  3322         88  WS-BEHIND-GMT                     VALUE '-'.
  3323         88  WS-AFTER-GMT                      VALUE '+'.
  3324         88  WS-NO-GMT                         VALUE ZERO.
  3325     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
  3326     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
  3327*                                 COPY ELCDATE.
  3328******************************************************************
  3329*                                                                *
  3330*                                                                *
  3331*                            ELCDATE.                            *
  3332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3333*                            VMOD=2.003
  3334*                                                                *
  3335*                                                                *
  3336*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3337*                 LENGTH = 200                                   *
  3338******************************************************************
  3339
  3340 01  DATE-CONVERSION-DATA.
  3341     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3342     12  DC-OPTION-CODE                PIC X.
  3343         88  BIN-TO-GREG                VALUE ' '.
  3344         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3345         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3346         88  YMD-GREG-TO-BIN            VALUE '3'.
  3347         88  MDY-GREG-TO-BIN            VALUE '4'.
  3348         88  JULIAN-TO-BIN              VALUE '5'.
  3349         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3350         88  FIND-CENTURY               VALUE '7'.
  3351         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3352         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3353         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3354         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3355         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3356         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3357         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3358         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3359         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3360         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3361         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3362         88  BIN-3-TO-GREG              VALUE 'I'.
  3363         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3364         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3365         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3366         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3367         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3368         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3369         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3370         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3371         88  THREE-CHARACTER-BIN
  3372                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3373         88  GREGORIAN-TO-BIN
  3374                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3375         88  BIN-TO-GREGORIAN
  3376                  VALUES ' ' '1' 'I' '8' 'G'.
  3377         88  JULIAN-TO-BINARY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  60
* WSMESS02.cbl
  3378                  VALUES '5' 'C' 'E' 'F'.
  3379     12  DC-ERROR-CODE                 PIC X.
  3380         88  NO-CONVERSION-ERROR        VALUE ' '.
  3381         88  DATE-CONVERSION-ERROR
  3382                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3383         88  DATE-IS-ZERO               VALUE '1'.
  3384         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3385         88  DATE-IS-INVALID            VALUE '3'.
  3386         88  DATE1-GREATER-DATE2        VALUE '4'.
  3387         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3388         88  DATE-INVALID-OPTION        VALUE '9'.
  3389         88  INVALID-CENTURY            VALUE 'A'.
  3390         88  ONLY-CENTURY               VALUE 'B'.
  3391         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3392         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3393     12  DC-END-OF-MONTH               PIC X.
  3394         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3395     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3396         88  USE-NORMAL-PROCESS         VALUE ' '.
  3397         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3398         88  ADJUST-UP-100-YRS          VALUE '2'.
  3399     12  FILLER                        PIC X.
  3400     12  DC-CONVERSION-DATES.
  3401         16  DC-BIN-DATE-1             PIC XX.
  3402         16  DC-BIN-DATE-2             PIC XX.
  3403         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3404         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3405                       DC-GREG-DATE-1-EDIT.
  3406             20  DC-EDIT1-MONTH        PIC 99.
  3407             20  SLASH1-1              PIC X.
  3408             20  DC-EDIT1-DAY          PIC 99.
  3409             20  SLASH1-2              PIC X.
  3410             20  DC-EDIT1-YEAR         PIC 99.
  3411         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3412         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3413                     DC-GREG-DATE-2-EDIT.
  3414             20  DC-EDIT2-MONTH        PIC 99.
  3415             20  SLASH2-1              PIC X.
  3416             20  DC-EDIT2-DAY          PIC 99.
  3417             20  SLASH2-2              PIC X.
  3418             20  DC-EDIT2-YEAR         PIC 99.
  3419         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3420         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3421                     DC-GREG-DATE-1-YMD.
  3422             20  DC-YMD-YEAR           PIC 99.
  3423             20  DC-YMD-MONTH          PIC 99.
  3424             20  DC-YMD-DAY            PIC 99.
  3425         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3426         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3427                      DC-GREG-DATE-1-MDY.
  3428             20  DC-MDY-MONTH          PIC 99.
  3429             20  DC-MDY-DAY            PIC 99.
  3430             20  DC-MDY-YEAR           PIC 99.
  3431         16  DC-GREG-DATE-1-ALPHA.
  3432             20  DC-ALPHA-MONTH        PIC X(10).
  3433             20  DC-ALPHA-DAY          PIC 99.
  3434             20  FILLER                PIC XX.
  3435             20  DC-ALPHA-CENTURY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  61
* WSMESS02.cbl
  3436                 24 DC-ALPHA-CEN-N     PIC 99.
  3437             20  DC-ALPHA-YEAR         PIC 99.
  3438         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3439         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3440         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3441         16  DC-JULIAN-DATE            PIC 9(05).
  3442         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3443                                       PIC 9(05).
  3444         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3445             20  DC-JULIAN-YEAR        PIC 99.
  3446             20  DC-JULIAN-DAYS        PIC 999.
  3447         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3448         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3449         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3450     12  DATE-CONVERSION-VARIBLES.
  3451         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3452         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3453             20  FILLER                PIC 9(3).
  3454             20  HOLD-CEN-1-CCYY.
  3455                 24  HOLD-CEN-1-CC     PIC 99.
  3456                 24  HOLD-CEN-1-YY     PIC 99.
  3457             20  HOLD-CEN-1-MO         PIC 99.
  3458             20  HOLD-CEN-1-DA         PIC 99.
  3459         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3460             20  HOLD-CEN-1-R-MO       PIC 99.
  3461             20  HOLD-CEN-1-R-DA       PIC 99.
  3462             20  HOLD-CEN-1-R-CCYY.
  3463                 24  HOLD-CEN-1-R-CC   PIC 99.
  3464                 24  HOLD-CEN-1-R-YY   PIC 99.
  3465             20  FILLER                PIC 9(3).
  3466         16  HOLD-CENTURY-1-X.
  3467             20  FILLER                PIC X(3)  VALUE SPACES.
  3468             20  HOLD-CEN-1-X-CCYY.
  3469                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3470                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3471             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3472             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3473         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3474             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3475             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3476             20  HOLD-CEN-1-R-X-CCYY.
  3477                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3478                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3479             20  FILLER                PIC XXX.
  3480         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3481         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3482         16  DC-JULIAN-DATE-1          PIC 9(07).
  3483         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3484             20  DC-JULIAN-1-CCYY.
  3485                 24  DC-JULIAN-1-CC    PIC 99.
  3486                 24  DC-JULIAN-1-YR    PIC 99.
  3487             20  DC-JULIAN-DA-1        PIC 999.
  3488         16  DC-JULIAN-DATE-2          PIC 9(07).
  3489         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3490             20  DC-JULIAN-2-CCYY.
  3491                 24  DC-JULIAN-2-CC    PIC 99.
  3492                 24  DC-JULIAN-2-YR    PIC 99.
  3493             20  DC-JULIAN-DA-2        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  62
* WSMESS02.cbl
  3494         16  DC-GREG-DATE-A-EDIT.
  3495             20  DC-EDITA-MONTH        PIC 99.
  3496             20  SLASHA-1              PIC X VALUE '/'.
  3497             20  DC-EDITA-DAY          PIC 99.
  3498             20  SLASHA-2              PIC X VALUE '/'.
  3499             20  DC-EDITA-CCYY.
  3500                 24  DC-EDITA-CENT     PIC 99.
  3501                 24  DC-EDITA-YEAR     PIC 99.
  3502         16  DC-GREG-DATE-B-EDIT.
  3503             20  DC-EDITB-MONTH        PIC 99.
  3504             20  SLASHB-1              PIC X VALUE '/'.
  3505             20  DC-EDITB-DAY          PIC 99.
  3506             20  SLASHB-2              PIC X VALUE '/'.
  3507             20  DC-EDITB-CCYY.
  3508                 24  DC-EDITB-CENT     PIC 99.
  3509                 24  DC-EDITB-YEAR     PIC 99.
  3510         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3511         16  DC-GREG-DATE-CYMD-R REDEFINES
  3512                              DC-GREG-DATE-CYMD.
  3513             20  DC-CYMD-CEN           PIC 99.
  3514             20  DC-CYMD-YEAR          PIC 99.
  3515             20  DC-CYMD-MONTH         PIC 99.
  3516             20  DC-CYMD-DAY           PIC 99.
  3517         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3518         16  DC-GREG-DATE-MDCY-R REDEFINES
  3519                              DC-GREG-DATE-MDCY.
  3520             20  DC-MDCY-MONTH         PIC 99.
  3521             20  DC-MDCY-DAY           PIC 99.
  3522             20  DC-MDCY-CEN           PIC 99.
  3523             20  DC-MDCY-YEAR          PIC 99.
  3524    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3525        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3526    12  DC-EL310-DATE                  PIC X(21).
  3527    12  FILLER                         PIC X(28).
  3528*                                 COPY ELCCALC.
  3529******************************************************************
  3530*                                                                *
  3531*                           ELCCALC.                            *
  3532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3533*                            VMOD=2.025                          *
  3534*                                                                *
  3535*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3536*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3537*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3538*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3539*                                                                *
  3540*  PASSED TO ELRTRM                                              *
  3541*  -----------------                                             *
  3542*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3543*  ORIGINAL TERM                                                 *
  3544*  BEGINNING DATE                                                *
  3545*  ENDING DATE                                                   *
  3546*  COMPANY I.D.                                                  *
  3547*  ACCOUNT MASTER USER FIELD                                     *
  3548*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3549*  FREE LOOK DAYS                                                *
  3550*                                                                *
  3551*  RETURNED FROM ELRTRM                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  63
* WSMESS02.cbl
  3552*  ---------------------                                         *
  3553*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3554*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3555*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3556*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3557*----------------------------------------------------------------*
  3558*  PASSED TO ELRAMT                                              *
  3559*  ----------------                                              *
  3560*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3561*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3562*  ORIGINAL AMOUNT                                               *
  3563*  ALTERNATE BENEFIT (BALLON)                                    *
  3564*  A.P.R. - NET PAY ONLY                                         *
  3565*  METHOD
  3566*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3567*  COMPANY I.D.                                                  *
  3568*  BENEFIT TYPE                                                  *
  3569*                                                                *
  3570*  RETURNED FROM ELRAMT                                          *
  3571*  --------------------                                          *
  3572*  REMAINING AMOUNT 1 - CURRENT                                  *
  3573*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3574*  REMAINING AMOUNT FACTOR
  3575*----------------------------------------------------------------*
  3576*  PASSED TO ELRESV                                              *
  3577*  -----------------                                             *
  3578*  CERTIFICATE EFFECTIVE DATE                                    *
  3579*  VALUATION DATE                                                *
  3580*  PAID THRU DATE                                                *
  3581*  BENEFIT                                                       *
  3582*  INCURRED DATE                                                 *
  3583*  REPORTED DATE                                                 *
  3584*  ISSUE AGE                                                     *
  3585*  TERM                                                          *
  3586*  CDT PERCENT                                                   *
  3587*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3588* *CLAIM TYPE (LIFE, A/H)                                        *
  3589* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3590* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3591*                                                                *
  3592*  RETURNED FROM ELRESV                                          *
  3593*  --------------------                                          *
  3594*  CDT TABLE USED                                                *
  3595*  CDT FACTOR USED                                               *
  3596*  PAY TO CURRENT RESERVE                                        *
  3597*  I.B.N.R. - A/H ONLY                                           *
  3598*  FUTURE (ACCRUED) AH ONLY                                      *
  3599*----------------------------------------------------------------*
  3600*  PASSED TO ELRATE                                              *
  3601*  ----------------                                              *
  3602*  CERT ISSUE DATE                                               *
  3603*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3604*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3605*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3606*  STATE CODE (CLIENT DEFINED)                                   *
  3607*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3608*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3609*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  64
* WSMESS02.cbl
  3610*  ISSUE AGE                                                     *
  3611*  ORIGINAL BENEFIT AMOUNT                                       *
  3612*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3613*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3614*  BENEFIT KIND (LIFE OR A/H)                                    *
  3615*  A.P.R.                                                        *
  3616*  METHOD
  3617*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3618*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3619*  COMPANY I.D. (3 CHARACTER)                                    *
  3620*  BENEFIT CODE                                                  *
  3621*  BENEFIT OVERRIDE CODE                                         *
  3622*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3623*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3624*  JOINT INDICATOR (CSL ONLY)                                    *
  3625*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3626*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3627*                                                                *
  3628*  RETURNED FROM ELRATE                                          *
  3629*  --------------------                                          *
  3630*  CALCULATED PREMIUM                                            *
  3631*  PREMIUM RATE                                                  *
  3632*  MORTALITY CODE                                                *
  3633*  MAX ATTAINED AGE                                              *
  3634*  MAX AGE                                                       *
  3635*  MAX TERM                                                      *
  3636*  MAX MONTHLY BENEFIT                                           *
  3637*  MAX TOTAL BENIFIT                                             *
  3638*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3639*----------------------------------------------------------------*
  3640*  PASSED TO ELRFND                                              *
  3641*  ----------------                                              *
  3642*  CERT ISSUE DATE                                               *
  3643*  REFUND DATE                                                   *
  3644*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3645*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3646*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3647*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3648*  STATE CODE (CLIENT DEFINED)                                   *
  3649*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3650*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3651*  DEVIATION CODE                                                *
  3652*  ISSUE AGE                                                     *
  3653*  ORIGINAL BENEFIT AMOUNT                                       *
  3654*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3655*  PROCESS TYPE (CANCEL)                                         *
  3656*  BENEFIT KIND (LIFE OR A/H)                                    *
  3657*  A.P.R.                                                        *
  3658*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3659*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3660*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3661*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3662*  COMPANY I.D. (3 CHARACTER)                                    *
  3663*  BENEFIT CODE                                                  *
  3664*  BENEFIT OVERRIDE CODE                                         *
  3665*                                                                *
  3666*  RETURNED FROM ELRFND                                          *
  3667*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  65
* WSMESS02.cbl
  3668*  CALCULATED REFUND                                             *
  3669*----------------------------------------------------------------*
  3670*  PASSED TO ELEARN                                              *
  3671*  ----------------                                              *
  3672*  CERT ISSUE DATE                                               *
  3673*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3674*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3675*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3676*  STATE CODE (CLIENT DEFINED)                                   *
  3677*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3678*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3679*  DEVIATION CODE                                                *
  3680*  ISSUE AGE                                                     *
  3681*  ORIGINAL BENEFIT AMOUNT                                       *
  3682*  BENEFIT KIND (LIFE OR A/H)                                    *
  3683*  A.P.R.                                                        *
  3684*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3685*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3686*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3687*  COMPANY I.D. (3 CHARACTER)                                    *
  3688*  BENEFIT CODE                                                  *
  3689*  BENEFIT OVERRIDE CODE                                         *
  3690*                                                                *
  3691*  RETURNED FROM ELEARN                                          *
  3692*  --------------------                                          *
  3693*  INDICATED  EARNINGS                                           *
  3694*----------------------------------------------------------------*
  3695*                 LENGTH = 450                                   *
  3696*                                                                *
  3697******************************************************************
  3698******************************************************************
  3699*                   C H A N G E   L O G
  3700*
  3701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3702*-----------------------------------------------------------------
  3703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3704* EFFECTIVE    NUMBER
  3705*-----------------------------------------------------------------
  3706* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3707* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3708* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3709* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3710* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3711* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3712* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3713* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3714* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3715* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3716* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3717******************************************************************
  3718
  3719 01  CALCULATION-PASS-AREA.
  3720     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3721                                     COMP.
  3722
  3723     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3724       88  NO-CP-ERROR                             VALUE ZERO.
  3725       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  66
* WSMESS02.cbl
  3726                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3727       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3728       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3729       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3730       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3731       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3732       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3733       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3734       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3735       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3736       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3737       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3738       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3739       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3740       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3741       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3742       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3743       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3744
  3745     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3746       88  NO-CP-ERROR-2                           VALUE ZERO.
  3747***********************  INPUT AREAS ****************************
  3748
  3749     12  CP-CALCULATION-AREA.
  3750         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3751         16  CP-CERT-EFF-DT        PIC XX.
  3752         16  CP-VALUATION-DT       PIC XX.
  3753         16  CP-PAID-THRU-DT       PIC XX.
  3754         16  CP-BENEFIT-TYPE       PIC X.
  3755           88  CP-AH                               VALUE 'A' 'D'
  3756                                                   'I' 'U'.
  3757           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3758           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3759         16  CP-INCURRED-DT        PIC XX.
  3760         16  CP-REPORTED-DT        PIC XX.
  3761         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3762         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3763         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-CDT-METHOD         PIC X.
  3768           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3769           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3770           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3771         16  CP-CLAIM-TYPE         PIC X.
  3772           88  CP-AH-CLAIM                         VALUE 'A'.
  3773           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3774         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3783                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  67
* WSMESS02.cbl
  3784         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3787                                     COMP-3.
  3788         16  CP-REM-TERM-METHOD    PIC X.
  3789           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3790           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3791           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3792           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3793           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3794           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3795           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3796         16  CP-EARNING-METHOD     PIC X.
  3797           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3798           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3799           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3800           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3801           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3802           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3803           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3804           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3805           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3806           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3807           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3808           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3809           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3810           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3811         16  CP-PROCESS-TYPE       PIC X.
  3812           88  CP-CLAIM                            VALUE '1'.
  3813           88  CP-CANCEL                           VALUE '2'.
  3814           88  CP-ISSUE                            VALUE '3'.
  3815         16  CP-SPECIAL-CALC-CD    PIC X.
  3816           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3817           88  CP-1-MTH-INTEREST               VALUE ' '.
  3818           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3819           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3820           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3821           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3822           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3823           88  CP-FARM-PLAN                    VALUE 'F'.
  3824           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3825           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3826           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3827           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3828           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3829           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3830           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3831           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3832           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3833           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3834                                                     'W' 'X'.
  3835           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3836           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3837           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3838           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3839           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3840           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3841           88  CP-PROPERTY-BENEFIT             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  68
* WSMESS02.cbl
  3842           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3843           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3844           88  CP-CSL-METH-1                   VALUE '5'.
  3845           88  CP-CSL-METH-2                   VALUE '6'.
  3846           88  CP-CSL-METH-3                   VALUE '7'.
  3847           88  CP-CSL-METH-4                   VALUE '8'.
  3848
  3849         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3850                                     COMP-3.
  3851         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3852         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3853         16  CP-STATE              PIC XX          VALUE SPACE.
  3854         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3855         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3856           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3857               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3858         16  CP-R78-OPTION         PIC X.
  3859           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3860           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3861
  3862         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3863         16  CP-IBNR-RESERVE-SW    PIC X.
  3864         16  CP-CLAIM-STATUS       PIC X.
  3865         16  CP-RATE-FILE          PIC X.
  3866         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3867                                     COMP-3.
  3868
  3869         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3870         16  CP-AH-OVERRIDE-CODE   PIC X.
  3871
  3872         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3873                                     COMP-3.
  3874         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3875                                   PIC S9(5)V99 COMP-3.
  3876         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3877                                     COMP-3.
  3878         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3879                                     COMP-3.
  3880         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3883                                  PIC S9(7)V99 COMP-3.
  3884
  3885         16  CP-PAID-FROM-DATE     PIC X(02).
  3886         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3887         16  CP-EXT-DAYS-CALC      PIC X.
  3888           88  CP-EXT-NO-CHG                   VALUE ' '.
  3889           88  CP-EXT-CHG-LF                   VALUE '1'.
  3890           88  CP-EXT-CHG-AH                   VALUE '2'.
  3891           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3892         16  CP-DOMICILE-STATE     PIC XX.
  3893         16  CP-CARRIER            PIC X.
  3894         16  CP-REIN-FLAG          PIC X.
  3895         16  CP-REM-TRM-CALC-OPTION PIC X.
  3896           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3897                      '2' '3' '4' '5'.
  3898           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3899           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  69
* WSMESS02.cbl
  3900           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3901           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3902           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3903           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3904           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3905           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3906         16  CP-SIG-SWITCH         PIC X.
  3907         16  CP-RATING-METHOD      PIC X.
  3908           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3909           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3910           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3911           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3912           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3913           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3914           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3915           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3916           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3917         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3918                                     COMP-3.
  3919         16  CP-BEN-CATEGORY       PIC X.
  3920         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3921         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3922                                   PIC S99V9(5) COMP-3.
  3923         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3924         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3925                                   PIC S99V9(5) COMP-3.
  3926         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3927         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3928         16  CP-EXPIRE-DT          PIC XX.
  3929         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3930         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3931         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3932         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3933         16  CP-DDF-SPEC-CALC      PIC X.
  3934             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3935             88  CP-CALC-CLP              VALUE 'C'.
  3936         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3937         16  CP-CANCEL-REASON      PIC X.
  3938         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3939         16  CP-PMT-MODE           PIC X.
  3940         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3941         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3942         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3943         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3944         16  FILLER                PIC X.
  3945
  3946***************    OUTPUT FROM ELRESV   ************************
  3947
  3948         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3949
  3950         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3951                                     COMP-3.
  3952         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3953                                     COMP-3.
  3954         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3955                                     COMP-3.
  3956         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3957                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  70
* WSMESS02.cbl
  3958         16  FILLER                PIC X(09).
  3959***************    OUTPUT FROM ELRTRM   *************************
  3960
  3961         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3962                                     COMP-3.
  3963         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3964                                     COMP-3.
  3965         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3966                                     COMP-3.
  3967         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3968                                     COMP-3.
  3969         16  FILLER                PIC X(12).
  3970
  3971***************    OUTPUT FROM ELRAMT   *************************
  3972
  3973         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3974                                     COMP-3.
  3975         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3976                                     COMP-3.
  3977         16  FILLER                PIC X(12).
  3978
  3979***************    OUTPUT FROM ELRATE   *************************
  3980
  3981         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3982                                     COMP-3.
  3983         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3984                                     COMP-3.
  3985         16  CP-MORTALITY-CODE     PIC X(4).
  3986         16  CP-RATE-EDIT-FLAG     PIC X.
  3987             88  CP-RATES-NEED-APR                  VALUE '1'.
  3988         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3989                                     COMP-3.
  3990         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3991         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3992         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3993                                   PIC S9(7)V99 COMP-3.
  3994         16  FILLER                PIC X(07).
  3995
  3996***************    OUTPUT FROM ELRFND   *************************
  3997
  3998         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3999                                     COMP-3.
  4000         16  CP-REFUND-TYPE-USED   PIC X.
  4001           88  CP-R-AS-R78                         VALUE '1'.
  4002           88  CP-R-AS-PRORATA                     VALUE '2'.
  4003           88  CP-R-AS-CALIF                       VALUE '3'.
  4004           88  CP-R-AS-TEXAS                       VALUE '4'.
  4005           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4006           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4007           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4008           88  CP-R-AS-MEAN                        VALUE '8'.
  4009           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4010           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4011           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4012           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4013           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4014           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4015         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  71
* WSMESS02.cbl
  4016
  4017***************    OUTPUT FROM ELEARN   *************************
  4018
  4019         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4020                                     COMP-3.
  4021         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4022                                     COMP-3.
  4023         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4024                                     COMP-3.
  4025         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4026                                     COMP-3.
  4027         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4028                                     COMP-3.
  4029         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4030                                     COMP-3.
  4031         16  CP-EARNING-TYPE-USED  PIC X.
  4032           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4033           88  CP-E-AS-R78                         VALUE '1'.
  4034           88  CP-E-AS-PRORATA                     VALUE '2'.
  4035           88  CP-E-AS-TEXAS                       VALUE '4'.
  4036           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4037           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4038           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4039           88  CP-E-AS-MEAN                        VALUE '8'.
  4040           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4041         16  FILLER                PIC X(12).
  4042
  4043***************    OUTPUT FROM ELPMNT   *************************
  4044
  4045         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4046                                     COMP-3.
  4047         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4048                                     COMP-3.
  4049         16  FILLER                PIC X(12).
  4050
  4051***************   MISC WORK AREAS    *****************************
  4052         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4053                                     COMP-3.
  4054         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4055                                     COMP-3.
  4056         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4057                                     COMP-3.
  4058         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4059                                     COMP-3.
  4060         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4061                                     COMP-3.
  4062         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4063                                     COMP-3.
  4064         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4065             88  OPEN-RATE-FILE                   VALUE 'O'.
  4066             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4067             88  IO-ERROR                         VALUE 'E'.
  4068
  4069         16  CP-FIRST-PAY-DATE     PIC XX.
  4070
  4071         16  CP-JOINT-INDICATOR    PIC X.
  4072
  4073         16  CP-RESERVE-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  72
* WSMESS02.cbl
  4074                                   PIC S9(4)V9    VALUE ZERO
  4075                                     COMP-3.
  4076
  4077         16  CP-INSURED-BIRTH-DT   PIC XX.
  4078
  4079         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4080                                     COMP-3.
  4081
  4082         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4083                                     COMP-3.
  4084
  4085         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4086                                     COMP-3.
  4087
  4088         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4089                                     COMP-3.
  4090
  4091         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4092                                     COMP-3.
  4093
  4094         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4095                                     COMP-3.
  4096
  4097         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4098                                     COMP-3.
  4099
  4100         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4101             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4102
  4103         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4104                                     COMP-3.
  4105         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4106                                     COMP-3.
  4107         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4108         16  cp-extra-periods      pic 9 value zeros.
  4109         16  cp-net-only-state     pic x value spaces.
  4110         16  FILLER                PIC X(13).
  4111******************************************************************
  4112****************************************************************
  4113*
  4114* Copyright (c) 2007-2013 Dell Inc.
  4115* All rights reserved.
  4116*
  4117****************************************************************
  4118 01  DFHEIV.
  4119   02  DFHEIV0               PIC X(35).
  4120   02  DFHEIV1               PIC X(08).
  4121   02  DFHEIV2               PIC X(08).
  4122   02  DFHEIV3               PIC X(08).
  4123   02  DFHEIV4               PIC X(06).
  4124   02  DFHEIV5               PIC X(04).
  4125   02  DFHEIV6               PIC X(04).
  4126   02  DFHEIV7               PIC X(02).
  4127   02  DFHEIV8               PIC X(02).
  4128   02  DFHEIV9               PIC X(01).
  4129   02  DFHEIV10              PIC S9(7) COMP-3.
  4130   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4131   02  DFHEIV12              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  73
* WSMESS02.cbl
  4132   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4133   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4134   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4135   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4136   02  DFHEIV17              PIC X(04).
  4137   02  DFHEIV18              PIC X(04).
  4138   02  DFHEIV19              PIC X(04).
  4139   02  DFHEIV20              USAGE IS POINTER.
  4140   02  DFHEIV21              USAGE IS POINTER.
  4141   02  DFHEIV22              USAGE IS POINTER.
  4142   02  DFHEIV23              USAGE IS POINTER.
  4143   02  DFHEIV24              USAGE IS POINTER.
  4144   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4145   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4146   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4147   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4148   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4149   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4150   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4151   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4152   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4153   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4154   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4155   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4156   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4157   02  FILLER                PIC X(02).
  4158   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4159   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4160   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4161   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4162   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4163   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4164   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4165 LINKAGE  SECTION.
  4166*****************************************************************
  4167*                                                               *
  4168* Copyright (c) 2007-2013 Dell Inc.                             *
  4169* All rights reserved.                                          *
  4170*                                                               *
  4171*****************************************************************
  4172 01  dfheiblk.
  4173     02  eibtime          pic s9(7) comp-3.
  4174     02  eibdate          pic s9(7) comp-3.
  4175     02  eibtrnid         pic x(4).
  4176     02  eibtaskn         pic s9(7) comp-3.
  4177     02  eibtrmid         pic x(4).
  4178     02  dfheigdi         pic s9(4) comp.
  4179     02  eibcposn         pic s9(4) comp.
  4180     02  eibcalen         pic s9(4) comp.
  4181     02  eibaid           pic x(1).
  4182     02  eibfiller1       pic x(1).
  4183     02  eibfn            pic x(2).
  4184     02  eibfiller2       pic x(2).
  4185     02  eibrcode         pic x(6).
  4186     02  eibfiller3       pic x(2).
  4187     02  eibds            pic x(8).
  4188     02  eibreqid         pic x(8).
  4189     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  74
* WSMESS02.cbl
  4190     02  eibsync          pic x(1).
  4191     02  eibfree          pic x(1).
  4192     02  eibrecv          pic x(1).
  4193     02  eibsend          pic x(1).
  4194     02  eibatt           pic x(1).
  4195     02  eibeoc           pic x(1).
  4196     02  eibfmh           pic x(1).
  4197     02  eibcompl         pic x(1).
  4198     02  eibsig           pic x(1).
  4199     02  eibconf          pic x(1).
  4200     02  eiberr           pic x(1).
  4201     02  eibrldbk         pic x(1).
  4202     02  eiberrcd         pic x(4).
  4203     02  eibsynrb         pic x(1).
  4204     02  eibnodat         pic x(1).
  4205     02  eibfiller5       pic x(2).
  4206     02  eibresp          pic s9(8) comp.
  4207     02  eibresp2         pic s9(8) comp.
  4208     02  dfheigdj         pic s9(4) comp.
  4209     02  dfheigdk         pic s9(4) comp.
  4210 01  DFHCOMMAREA                 pic x(1024).
  4211 01  var  pic x(30).
  4212 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  4213 0000-DFHEXIT SECTION.
  4214     MOVE '9#                    $   ' TO DFHEIV0.
  4215     MOVE 'WSMESS02' TO DFHEIV1.
  4216     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4217     display ' Entering program WSMESS02 '
  4218     move dfhcommarea            to ws-mess002-pass-area
  4219     perform 0000-init           thru 0000-exit
  4220     perform 0010-process-message
  4221                                 thru 0010-exit
  4222*    move ' returning string goes here ' to ws-return-string
  4223     go to 0300-RETURN-CICS
  4224     .
  4225 0000-init.
  4226     move 'CID'                  to client-id
  4227     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  4228     move ws-fn-cymd             to dc-greg-date-cymd
  4229     move 'L'                    to dc-option-code
  4230     perform 9700-date-link      thru 9700-exit
  4231     if no-conversion-error
  4232        move dc-bin-date-1       to ws-bin-current-dt
  4233     else
  4234        display ' error current dt invalid ' dc-error-code
  4235     end-if
  4236     set P to address of KIXSYS
  4237     CALL "getenv" using by value P returning var-ptr
  4238     if var-ptr = null then
  4239        display ' kixsys not set '
  4240     else
  4241        set address of var to var-ptr
  4242        move 0 to env-var-len
  4243        inspect var tallying env-var-len
  4244          for characters before X'00'
  4245        unstring var (1:env-var-len) delimited by '/'
  4246           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  4247              WS-KIX-SYS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  75
* WSMESS02.cbl
  4248        end-unstring
  4249     end-if
  4250     evaluate client-id
  4251        when 'DCC'
  4252           MOVE X'05'            TO WS-COMP-CD
  4253           MOVE 'DCC'            TO WS-COMP-ID
  4254        when 'CID'
  4255           MOVE X'04'            TO WS-COMP-CD
  4256           MOVE 'CID'            TO WS-COMP-ID
  4257        when 'AHL'
  4258           MOVE X'06'            TO WS-COMP-CD
  4259           MOVE 'AHL'            TO WS-COMP-ID
  4260        when other
  4261           display ' Invalid company id ' client-id
  4262           move 23               to ws-error-sub
  4263           move client-id        to ws-error-sup
  4264           perform 0180-error-handle
  4265                                 thru 0180-exit
  4266*          move '0113;Invalid company id ' to ws-return-string
  4267           go to 0300-RETURN-CICS
  4268     END-evaluate
  4269     move 1                      to ws-error-sub
  4270     move low-values             to ws-bin-lf-exp-dt
  4271                                    ws-bin-ah-exp-dt
  4272                                    ws-bin-loan-exp-dt
  4273     move spaces                 to ws-return-string
  4274     move ';'                    to ws-sc1
  4275                                    ws-sc2
  4276                                    ws-sc3
  4277                                    ws-sc4
  4278                                    ws-sc5
  4279                                    ws-sc6
  4280                                    ws-sc7
  4281                                    ws-sc8
  4282                                    ws-sc9
  4283                                    ws-sc10
  4284                                    ws-sc11
  4285                                    ws-sc12
  4286                                    ws-sc13
  4287                                    ws-sc14
  4288                                    ws-sc15
  4289                                    ws-sc16
  4290                                    ws-sc17
  4291                                    ws-sc18
  4292                                    ws-sc19
  4293                                    ws-sc20
  4294                                    ws-sc21
  4295                                    ws-sc22
  4296                                    ws-sc23
  4297                                    ws-sc24
  4298     .
  4299 0000-exit.
  4300     exit.
  4301 0010-process-message.
  4302     perform 0110-unstring       thru 0110-exit
  4303     perform 0120-format-message thru 0120-exit
  4304     perform 0020-edit-received  thru 0020-exit
  4305     perform 0050-get-account    thru 0050-exit
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  76
* WSMESS02.cbl
  4306     perform 0090-get-limits     thru 0090-exit
  4307     perform 0025-assign-ben-cd  thru 0025-exit
  4308     perform 0030-get-lf-rate    thru 0030-exit
  4309     perform 0035-get-ah-rate    thru 0035-exit
  4310     if ws-rate-in-lf-ben-code (1:1) = 'N' or 'T'
  4311        perform 0200-calc-NP-payment
  4312                                 thru 0200-exit
  4313     else
  4314        perform 0250-calc-GP-payment
  4315                                 thru 0250-exit
  4316     end-if
  4317*    go to 0010-exit
  4318     if (contract-no-assigned)
  4319            or
  4320        (error-in-one-coverage)
  4321        continue
  4322     else
  4323        perform 0190-final-limit-check
  4324                                 thru 0190-exit
  4325        perform 0060-check-for-dup
  4326                                 thru 0060-exit
  4327        perform 0070-open-cursor thru 0070-exit
  4328        perform 0080-process-input
  4329                                 thru 0080-exit
  4330     end-if
  4331     perform 0040-format-buffer  thru 0040-exit
  4332     set contract-no-assigned to true
  4333     .
  4334 0010-exit.
  4335     exit.
  4336 0020-edit-received.
  4337     if ws-rate-sin-jnt-lf = 'S' OR 'J'
  4338        continue
  4339     else
  4340        move 'S'                 to ws-rate-sin-jnt-lf
  4341     end-if
  4342     if ws-rate-sin-jnt-ah = 'S' OR 'J'
  4343        continue
  4344     else
  4345        move 'S'                 to ws-rate-sin-jnt-ah
  4346     end-if
  4347     if ws-rate-dismemberment = 'Y'
  4348        continue
  4349     else
  4350        move 'N'                 to ws-rate-dismemberment
  4351     end-if
  4352     if ws-rate-in-ah-ben-code = 'A'
  4353        if ws-rate-retro-elim = 'R' or 'E'
  4354           continue
  4355        else
  4356           move 'R'              to ws-rate-retro-elim
  4357        end-if
  4358     else
  4359        move spaces              to ws-rate-retro-elim
  4360     end-if
  4361**==============================================================**
  4362**                                                              **
  4363**  Validate passed effective date. Probably should add edits   **
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  77
* WSMESS02.cbl
  4364**                                                              **
  4365**==============================================================**
  4366     move ws-rate-eff-date (7:4) to ws-work-date (1:4)
  4367     move ws-rate-eff-date (1:2) to ws-work-date (5:2)
  4368     move ws-rate-eff-date (4:2) to ws-work-date (7:2)
  4369     move ws-work-date-num       to dc-greg-date-cymd
  4370     move 'L'                    to dc-option-code
  4371     perform 9700-date-link      thru 9700-exit
  4372     if no-conversion-error
  4373        move dc-bin-date-1       to ws-bin-eff-dt
  4374     else
  4375        move 3                   to ws-error-sub
  4376        move '- Eff Date'        to ws-error-sup
  4377        perform 0180-error-handle
  4378                                 thru 0180-exit
  4379        go to 0300-RETURN-CICS
  4380     end-if
  4381     if ws-bin-eff-dt > ws-bin-current-dt
  4382        move 3                   to ws-error-sub
  4383        move '- Future Eff'      to ws-error-sup
  4384        perform 0180-error-handle
  4385                                 thru 0180-exit
  4386        go to 0300-RETURN-CICS
  4387     end-if
  4388**==============================================================**
  4389**                                                              **
  4390**  Validate passed 1st pmt date.   Probably should add edits   **
  4391**                                                              **
  4392**==============================================================**
  4393     move ws-rate-1st-pmt-dt (7:4)
  4394                                 to ws-work-date (1:4)
  4395     move ws-rate-1st-pmt-dt (1:2)
  4396                                 to ws-work-date (5:2)
  4397     move ws-rate-1st-pmt-dt (4:2)
  4398                                 to ws-work-date (7:2)
  4399     move ws-work-date-num       to dc-greg-date-cymd
  4400     move 'L'                    to dc-option-code
  4401     perform 9700-date-link      thru 9700-exit
  4402     if no-conversion-error
  4403        move dc-bin-date-1       to ws-bin-1st-pmt-dt
  4404     else
  4405        move low-values          to ws-bin-1st-pmt-dt
  4406        move 3                   to ws-error-sub
  4407        move '- 1st Pmt Dt'      to ws-error-sup
  4408        perform 0180-error-handle
  4409                                 thru 0180-exit
  4410        go to 0300-RETURN-CICS
  4411     end-if
  4412     if ws-bin-1st-pmt-dt <= ws-bin-eff-dt
  4413        move low-values          to ws-bin-1st-pmt-dt
  4414        move 3                   to ws-error-sub
  4415        move '- 1st Pmt !> Eff dt' to ws-error-sup
  4416        perform 0180-error-handle
  4417                                 thru 0180-exit
  4418        go to 0300-RETURN-CICS
  4419     end-if
  4420**==============================================================**
  4421**                                                              **
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  78
* WSMESS02.cbl
  4422**  Only use the code below if there is a time they don't       **
  4423**  send the 1st pmt date.                                      **
  4424**                                                              **
  4425**==============================================================**
  4426     if ws-bin-1st-pmt-dt = low-values
  4427        move +1                  to dc-elapsed-months
  4428        move +0                  to dc-elapsed-days
  4429        move '6'                 to dc-option-code
  4430        perform 9700-date-link   thru 9700-exit
  4431        if no-conversion-error
  4432           move dc-bin-date-2    to ws-bin-1st-pmt-dt
  4433        else
  4434           move 3                to ws-error-sub
  4435           move '- 1st Pmt Dt'   to ws-error-sup
  4436           perform 0180-error-handle
  4437                                 thru 0180-exit
  4438           go to 0300-RETURN-CICS
  4439        end-if
  4440     end-if
  4441**==============================================================**
  4442**                                                              **
  4443**  Calculate the days to first payment date                    **
  4444**                                                              **
  4445**==============================================================**
  4446     move ws-bin-eff-dt          to dc-bin-date-1
  4447     move ws-bin-1st-pmt-dt      to dc-bin-date-2
  4448     move zeros                  to dc-elapsed-months
  4449                                    dc-elapsed-days
  4450     move '1'                    to dc-option-code
  4451     perform 9700-date-link   thru 9700-exit
  4452     if no-conversion-error
  4453        move dc-elapsed-days     to d
  4454     else
  4455        move 30                  to d
  4456     end-if
  4457*    if d = 31
  4458*       move 30 to d
  4459*    end-if
  4460**==============================================================**
  4461**                                                              **
  4462**  Sometimes a lf term is passed to this module                **
  4463**   even thought there is no life coverage. I try and rate it  **
  4464**                                                              **
  4465**==============================================================**
  4466     if ws-rate-in-lf-ben-code = spaces
  4467        move zeros               to ws-rate-lf-term
  4468     end-if
  4469     .
  4470 0020-calc-lf-exp.
  4471**==============================================================**
  4472**                                                              **
  4473**  Calculate the lf expiration date to be passed back.         **
  4474**                                                              **
  4475**==============================================================**
  4476     if ws-rate-lf-term > 0
  4477        move ws-bin-1st-pmt-dt   to dc-bin-date-1
  4478        compute dc-elapsed-months = ws-rate-lf-term - 1
  4479        move +0                  to dc-elapsed-days
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  79
* WSMESS02.cbl
  4480        move '6'                 to dc-option-code
  4481        perform 9700-date-link   thru 9700-exit
  4482        if no-conversion-error
  4483           move dc-bin-date-2    to ws-bin-lf-exp-dt
  4484           move dc-greg-date-a-edit
  4485                                 to ws-lf-exp-date
  4486        else
  4487           move 3                to ws-error-sub
  4488           move '- Lf Exp Dt'    to ws-error-sup
  4489           perform 0180-error-handle
  4490                                 thru 0180-exit
  4491           go to 0300-RETURN-CICS
  4492        end-if
  4493     end-if
  4494     .
  4495 0020-calc-ah-exp.
  4496**==============================================================**
  4497**                                                              **
  4498**  Calculate the ah expiration date to be passed back.         **
  4499**                                                              **
  4500**==============================================================**
  4501     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4502     compute dc-elapsed-months = ws-rate-ah-term - 1
  4503     move +0                     to dc-elapsed-days
  4504     move '6'                    to dc-option-code
  4505     perform 9700-date-link      thru 9700-exit
  4506     if no-conversion-error
  4507        move dc-bin-date-2       to ws-bin-ah-exp-dt
  4508        move dc-greg-date-a-edit to ws-ah-exp-date
  4509     else
  4510        move 3                   to ws-error-sub
  4511        move '- Ah Exp Dt'       to ws-error-sup
  4512        perform 0180-error-handle
  4513                                 thru 0180-exit
  4514        go to 0300-RETURN-CICS
  4515     end-if
  4516     .
  4517 0020-calc-loan-exp.
  4518**==============================================================**
  4519**                                                              **
  4520**  Calculate the loan expiration date to be passed back.       **
  4521**                                                              **
  4522**==============================================================**
  4523     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4524     compute dc-elapsed-months = ws-rate-loan-term - 1
  4525     move +0                     to dc-elapsed-days
  4526     move '6'                    to dc-option-code
  4527     perform 9700-date-link      thru 9700-exit
  4528     if no-conversion-error
  4529        move dc-bin-date-2       to ws-bin-loan-exp-dt
  4530        move dc-greg-date-a-edit to ws-loan-exp-date
  4531     else
  4532        move 3                   to ws-error-sub
  4533        move '- Loan Exp Dt'     to ws-error-sup
  4534        perform 0180-error-handle
  4535                                 thru 0180-exit
  4536        go to 0300-RETURN-CICS
  4537     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  80
* WSMESS02.cbl
  4538**==============================================================**
  4539**                                                              **
  4540**  Validate primary borrower birth date.                       **
  4541**                                                              **
  4542**==============================================================**
  4543     move ws-rate-pri-birth-date (7:4)
  4544                                 to ws-work-date (1:4)
  4545     move ws-rate-pri-birth-date (1:2)
  4546                                 to ws-work-date (5:2)
  4547     move ws-rate-pri-birth-date (4:2)
  4548                                 to ws-work-date (7:2)
  4549     move ws-work-date-num       to dc-greg-date-cymd
  4550     move 'L'                    to dc-option-code
  4551     perform 9700-date-link      thru 9700-exit
  4552     if no-conversion-error
  4553        move dc-bin-date-1       to ws-bin-pri-birth-dt
  4554     else
  4555        move 3                   to ws-error-sub
  4556        move '- Pri DOB '        to ws-error-sup
  4557        perform 0180-error-handle
  4558                                 thru 0180-exit
  4559        go to 0300-RETURN-CICS
  4560     end-if
  4561**==============================================================**
  4562**                                                              **
  4563**  Validate co borrowers birth date.                           **
  4564**                                                              **
  4565**==============================================================**
  4566     if ws-rate-cob-birth-date (7:4) = spaces
  4567        move zeros               to ws-rate-cob-birth-date
  4568     end-if
  4569     move ws-rate-cob-birth-date (7:4)
  4570                                 to ws-work-date (1:4)
  4571     move ws-rate-cob-birth-date (1:2)
  4572                                 to ws-work-date (5:2)
  4573     move ws-rate-cob-birth-date (4:2)
  4574                                 to ws-work-date (7:2)
  4575     move low-values             to ws-bin-cob-birth-dt
  4576     if ws-work-date-num not = zeros
  4577        move ws-work-date-num    to dc-greg-date-cymd
  4578        move 'L'                 to dc-option-code
  4579        perform 9700-date-link   thru 9700-exit
  4580        if no-conversion-error
  4581           move dc-bin-date-1    to ws-bin-cob-birth-dt
  4582        else
  4583           move 3                to ws-error-sub
  4584           move '- Cob DOB '     to ws-error-sup
  4585           perform 0180-error-handle
  4586                                 thru 0180-exit
  4587           go to 0300-RETURN-CICS
  4588        end-if
  4589     end-if
  4590**==============================================================**
  4591**                                                              **
  4592**  Calculate primary borrowers age.                            **
  4593**                                                              **
  4594**==============================================================**
  4595     move ws-bin-pri-birth-dt    to dc-bin-date-1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  81
* WSMESS02.cbl
  4596     move ws-bin-eff-dt          to dc-bin-date-2
  4597     move '1'                    to dc-option-code
  4598     perform 9700-date-link      thru 9700-exit
  4599     if no-conversion-error
  4600        compute ws-issue-age = dc-elapsed-months / +12
  4601     else
  4602        move 3                   to ws-error-sub
  4603        move '- Pri DOB '        to ws-error-sup
  4604        perform 0180-error-handle
  4605                                 thru 0180-exit
  4606        go to 0300-RETURN-CICS
  4607     end-if
  4608     .
  4609 0020-calc-pri-att-age.
  4610**==============================================================**
  4611**                                                              **
  4612**  Calculate primary borrowers age at expiration date          **
  4613**                                                              **
  4614**==============================================================**
  4615     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4616     move ws-bin-lf-exp-dt       to dc-bin-date-2
  4617     if ws-bin-ah-exp-dt > dc-bin-date-2
  4618        move ws-bin-ah-exp-dt    to dc-bin-date-2
  4619     end-if
  4620     move '1'                    to dc-option-code
  4621     perform 9700-date-link      thru 9700-exit
  4622     if no-conversion-error
  4623        compute ws-pri-att-age =
  4624           dc-elapsed-months / +12
  4625     else
  4626        move 3                   to ws-error-sub
  4627        move '- Pri DOB '        to ws-error-sup
  4628        perform 0180-error-handle
  4629                                 thru 0180-exit
  4630        go to 0300-RETURN-CICS
  4631     end-if
  4632     .
  4633 0020-calc-cob-age.
  4634**==============================================================**
  4635**                                                              **
  4636**  Calculate co borrowers age.                                 **
  4637**                                                              **
  4638**==============================================================**
  4639     move zeros                  to ws-cob-age
  4640     if ws-bin-cob-birth-dt not = low-values
  4641        move ws-bin-cob-birth-dt to dc-bin-date-1
  4642        move ws-bin-eff-dt       to dc-bin-date-2
  4643        move '1'                 to dc-option-code
  4644        perform 9700-date-link   thru 9700-exit
  4645        if no-conversion-error
  4646           compute ws-cob-age = dc-elapsed-months / +12
  4647        else
  4648           move 3                to ws-error-sub
  4649           move '- Cob DOB '     to ws-error-sup
  4650           perform 0180-error-handle
  4651                                 thru 0180-exit
  4652           go to 0300-RETURN-CICS
  4653        end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  82
* WSMESS02.cbl
  4654     end-if
  4655     move ws-issue-age           to ws-rate-age
  4656     if ws-cob-age > ws-rate-age
  4657        move ws-cob-age          to ws-rate-age
  4658     end-if
  4659     .
  4660 0020-calc-cob-att-age.
  4661**==============================================================**
  4662**                                                              **
  4663**  Calculate co borrowers age at expiration date               **
  4664**                                                              **
  4665**==============================================================**
  4666     move zeros                  to ws-cob-att-age
  4667     if ws-bin-cob-birth-dt not = low-values
  4668        move ws-bin-cob-birth-dt to dc-bin-date-1
  4669        move ws-bin-lf-exp-dt    to dc-bin-date-2
  4670        if ws-bin-ah-exp-dt > dc-bin-date-2
  4671           move ws-bin-ah-exp-dt to dc-bin-date-2
  4672        end-if
  4673        move '1'                 to dc-option-code
  4674        perform 9700-date-link   thru 9700-exit
  4675        if no-conversion-error
  4676           compute ws-cob-att-age =
  4677              dc-elapsed-months / +12
  4678        else
  4679           move 3                to ws-error-sub
  4680           move '- Cob DOB '     to ws-error-sup
  4681           perform 0180-error-handle
  4682                                 thru 0180-exit
  4683           go to 0300-RETURN-CICS
  4684        end-if
  4685     end-if
  4686     move ws-cob-att-age         to ws-att-age
  4687     if ws-pri-att-age > ws-att-age
  4688        move ws-pri-att-age      to ws-att-age
  4689     end-if
  4690     .
  4691 0020-val-terms.
  4692**==============================================================**
  4693**                                                              **
  4694**  Validate life and dis terms                                 **
  4695**                                                              **
  4696**==============================================================**
  4697     if (ws-rate-lf-term > 0)
  4698        and (ws-rate-ah-term > 0)
  4699        if ws-rate-lf-term <> ws-rate-ah-term
  4700           move 27               to ws-error-sub
  4701           move ' '              to ws-error-sup
  4702           perform 0180-error-handle
  4703                                 thru 0180-exit
  4704           go to 0300-RETURN-CICS
  4705        end-if
  4706     end-if
  4707**==============================================================**
  4708**                                                              **
  4709**  Validate Loan term against insurance term.                  **
  4710**                                                              **
  4711**==============================================================**
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  83
* WSMESS02.cbl
  4712     if ((ws-rate-in-lf-ben-code (1:1) = 'G')
  4713        and (ws-rate-lf-term > 0)
  4714        and (ws-rate-lf-term <> ws-rate-loan-term))
  4715                  or
  4716        ((ws-rate-in-lf-ben-code (i:1) = ' ')
  4717        and (ws-rate-ah-term > 0)
  4718        and (ws-rate-ah-term <> ws-rate-loan-term))
  4719        move 28               to ws-error-sub
  4720        move ' '              to ws-error-sup
  4721        perform 0180-error-handle
  4722                                 thru 0180-exit
  4723        go to 0300-RETURN-CICS
  4724     end-if
  4725     .
  4726 0020-exit.
  4727     exit.
  4728 0025-assign-ben-cd.
  4729     if not connected-to-db
  4730        perform 6000-connect-to-db thru 6000-exit
  4731     end-if
  4732     move ws-rate-state          to ws-sbc-state
  4733     evaluate true
  4734        when ws-rate-in-lf-ben-code (1:1) = 'N'
  4735           move 'NP'             to ws-sbc-cov-type
  4736        when ws-rate-in-lf-ben-code (1:1) = 'T'
  4737           move 'NT'             to ws-sbc-cov-type
  4738        when ws-rate-in-lf-ben-code (1:1) = 'L'
  4739           move 'LL'             to ws-sbc-cov-type
  4740        when ws-rate-in-lf-ben-code (1:1) = ' '
  4741           go to 0025-get-ah-ben
  4742        when other
  4743           move 'GP'             to ws-sbc-cov-type
  4744     end-evaluate
  4745     move ws-rate-loan-amt       to ws-sbc-ben-amt
  4746     move ws-rate-sin-jnt-lf     to ws-sbc-sin-jnt
  4747     move ws-rate-dismemberment  to ws-sbc-dismember
  4748     EXEC SQL
  4749        SELECT TOP (1)
  4750           MIN(BenefitAmt) as LessAmt,
  4751           LogicBenCode
  4752        INTO
  4753           :ws-sbc-min-amt,
  4754           :ws-sbc-logic-ben-code
  4755        FROM
  4756           BenefitCodeMapping
  4757        WHERE
  4758           State           = :ws-sbc-state
  4759           and CovType     = :ws-sbc-cov-type
  4760           and SinJnt      = :ws-sbc-sin-jnt
  4761           and Dismem      = :ws-sbc-dismember
  4762           and BenefitAmt  > :ws-sbc-ben-amt
  4763        GROUP BY
  4764           LogicBenCode
  4765        ORDER BY
  4766           LessAmt
  4767     end-exec
  4768     if sqlcode not = 0 and 1
  4769        display "Error: cannot find lf benefit code "
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  84
* WSMESS02.cbl
  4770           ws-sbc-state ' ' ws-sbc-cov-type ' ' ws-sbc-sin-jnt
  4771           ' ' ws-sbc-dismember
  4772        display ' sql return code ' sqlcode
  4773        display ' sql err mess    ' sqlerrmc
  4774        move 24                  to ws-error-sub
  4775        move spaces to ws-error-sup
  4776        string
  4777           ws-sbc-state ' '
  4778           ws-sbc-cov-type ' '
  4779           ws-sbc-sin-jnt ' '
  4780           ws-sbc-dismember
  4781           delimited by size into ws-error-sup
  4782        perform 0180-error-handle
  4783                                 thru 0180-exit
  4784        go to 0300-return-cics
  4785     end-if
  4786**==============================================================**
  4787**                                                              **
  4788** The below code already works, just want to try some stuff    **
  4789**                                                              **
  4790**==============================================================**
  4791*    EXEC SQL
  4792*       SELECT
  4793*          LogicBenCode
  4794*       INTO
  4795*          :ws-sbc-logic-ben-code
  4796*       FROM
  4797*          BenefitCodeMapping
  4798*       WHERE
  4799*          State           = :ws-sbc-state
  4800*          and CovType     = :ws-sbc-cov-type
  4801*          and SinJnt      = :ws-sbc-sin-jnt
  4802*          and Dismem      = :ws-sbc-dismember
  4803*          and BenefitAmt  > :ws-sbc-ben-amt
  4804*    end-exec
  4805*
  4806*    if sqlcode not = 0
  4807*          ws-sbc-state ' ' ws-sbc-cov-type ' ' ws-sbc-sin-jnt
  4808*          ' ' ws-sbc-dismember
  4809*       display ' sql return code ' sqlcode
  4810*       display ' sql err mess    ' sqlerrmc
  4811*       move 19                  to ws-error-sub
  4812*       move spaces to ws-error-sup
  4813*       string
  4814*          ws-sbc-dismember
  4815*          delimited by size into ws-error-sup
  4816*       perform 0180-error-handle
  4817*                                thru 0180-exit
  4818*       go to 0300-return-cics
  4819*    end-if
  4820     move ws-sbc-logic-ben-code  to ws-rate-lf-benefit-cd
  4821     .
  4822 0025-get-ah-ben.
  4823     if ws-rate-in-ah-ben-code (1:1) = ' '
  4824        go to 0025-exit
  4825     end-if
  4826     move ws-rate-state          to ws-sbc-state
  4827     move 'DI'                   to ws-sbc-cov-type
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  85
* WSMESS02.cbl
  4828     move ws-rate-loan-amt       to ws-sbc-ben-amt
  4829     move ws-rate-sin-jnt-ah     to ws-sbc-sin-jnt
  4830     move ws-rate-retro-elim     to ws-sbc-retroelim
  4831     move ws-rate-waiting-days   to ws-sbc-wait-days
  4832     move ws-rate-crit-per       to ws-sbc-max-bens
  4833     EXEC SQL
  4834        SELECT TOP (1)
  4835           MIN(BenefitAmt) as LessAmt,
  4836           LogicBenCode
  4837        INTO
  4838           :ws-sbc-min-amt,
  4839           :ws-sbc-logic-ben-code
  4840        FROM
  4841           BenefitCodeMapping
  4842        WHERE
  4843           State           = :ws-sbc-state
  4844           and CovType     = :ws-sbc-cov-type
  4845           and SinJnt      = :ws-sbc-sin-jnt
  4846           and RetroElim   = :ws-sbc-retroelim
  4847           and WaitDays    = :ws-sbc-wait-days
  4848           and MaxBens     = :ws-sbc-max-bens
  4849           and BenefitAmt  > :ws-sbc-ben-amt
  4850        GROUP BY
  4851           LogicBenCode
  4852        ORDER BY
  4853           LessAmt
  4854     end-exec
  4855     if sqlcode not = 0
  4856        display "Error: cannot find ah benefit code "
  4857           ws-sbc-state ' ' ws-sbc-cov-type ' ' ws-sbc-sin-jnt
  4858           ' ' ws-sbc-retroelim ' ' ws-sbc-wait-days ' '
  4859           ws-sbc-max-bens
  4860        display ' sql return code ' sqlcode
  4861        display ' sql err mess    ' sqlerrmc
  4862        move 25                  to ws-error-sub
  4863        move spaces              to ws-error-sup
  4864        string
  4865           ws-sbc-state ' '
  4866           ws-sbc-cov-type ' '
  4867           ws-sbc-sin-jnt ' '
  4868           ws-sbc-retroelim ' '
  4869           ws-sbc-wait-days ' '
  4870           ws-sbc-max-bens
  4871           delimited by size into ws-error-sup
  4872        perform 0180-error-handle
  4873                                 thru 0180-exit
  4874        go to 0300-return-cics
  4875     end-if
  4876     move ws-sbc-logic-ben-code  to ws-rate-ah-benefit-cd
  4877     .
  4878 0025-exit.
  4879     exit.
  4880 0030-get-lf-rate.
  4881     if (ws-rate-in-lf-ben-code (1:1) = ' ')
  4882        or (ws-rate-lf-term = zeros)
  4883        go to 0030-exit
  4884     end-if
  4885*    move spaces                 to calculation-pass-area
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  86
* WSMESS02.cbl
  4886     move zeros                  to cp-r-max-mon-ben
  4887                                    cp-r-max-tot-ben
  4888                                    cp-rate-dev-pct
  4889                                    cp-original-premium
  4890                                    cp-critical-months
  4891                                    cp-term-or-ext-days
  4892     move am-cal-table           to cp-class-CODE
  4893     move am-lf-deviation        to cp-deviation-code
  4894     move ws-rate-state          to cp-state
  4895                                    cp-state-std-abbrv
  4896     move 'L'                    to cp-benefit-type
  4897     move ws-rate-lf-benefit-cd  to cp-benefit-cd
  4898     move ws-rate-loan-amt       to cp-original-benefit
  4899                                    cp-rating-benefit-amt
  4900     move ws-rate-age            to cp-issue-age
  4901     move ws-comp-id             to cp-company-id
  4902     move ws-comp-cd             to cp-company-cd
  4903     move ws-rate-apr            to cp-loan-apr
  4904     if ws-rate-loan-term = zeros
  4905        move ws-rate-lf-term     to ws-rate-loan-term
  4906     end-if
  4907     move ws-rate-lf-term        to cp-original-term
  4908     move ws-rate-loan-term      to cp-loan-term
  4909     if (cp-original-term = zeros)
  4910        and (cp-loan-term = zeros)
  4911        move 20                  to ws-error-sub
  4912        move '-Lf term'          to ws-error-sup
  4913        perform 0180-error-handle
  4914                                 thru 0180-exit
  4915        go to 0300-return-cics
  4916     end-if
  4917     move 'L'                    to cp-life-override-code
  4918     move 'A'                    to cp-ah-override-code
  4919     move '3'                    to cp-process-type
  4920     move ws-rate-earn-meth      to cp-earning-method
  4921                                    cp-rating-method
  4922     move 'R'                    to cp-rate-file
  4923     move ws-bin-eff-dt          to cp-cert-eff-dt
  4924     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4925     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4926     evaluate true
  4927        when cp-return-code = '7'
  4928           move 0                to cp-return-code
  4929           move 14               to ws-error-sub
  4930           move '-Lf Rates'      to ws-error-sup
  4931           perform 0180-error-handle
  4932                                 thru 0180-exit
  4933           go to 0300-return-cics
  4934        when cp-return-code = '6'
  4935           move 0                to cp-return-code
  4936           move 15               to ws-error-sub
  4937           move '-Lf Rates'      to ws-error-sup
  4938           perform 0180-error-handle
  4939                                 thru 0180-exit
  4940           go to 0300-return-cics
  4941        when cp-return-code = 'D'
  4942           move 0                to cp-return-code
  4943           move 17               to ws-error-sub
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  87
* WSMESS02.cbl
  4944           move ' '              to ws-error-sup
  4945           perform 0180-error-handle
  4946                                 thru 0180-exit
  4947           go to 0300-return-cics
  4948     end-evaluate
  4949     if cp-error-occured
  4950        move zeros               to lf-rate
  4951        move 17                  to ws-error-sub
  4952        move '-Lf rate'          to ws-error-sup
  4953        perform 0180-error-handle
  4954                                 thru 0180-exit
  4955        go to 0300-return-cics
  4956     end-if
  4957     move 'S'                    to ws-rate-type
  4958     move +0                     to ws-discount-rate
  4959     if (rt-discount-option <> ' ')
  4960        and (rt-discount-ob-rate > zeros)
  4961        move rt-discount-ob-rate to cp-premium-rate
  4962        move rt-discount-rate    to ws-discount-rate
  4963        if ws-discount-rate > 1
  4964           if cp-state = 'PA'
  4965              compute ws-discount-rate rounded =
  4966                 ws-discount-rate / 100
  4967           else
  4968              compute ws-discount-rate rounded =
  4969                 ws-discount-rate / 1200
  4970           end-if
  4971        end-if
  4972        set mob-rate to true
  4973     else
  4974        move rt-l-rate (cp-original-term)
  4975                                 to cp-premium-rate
  4976     end-if
  4977     if cp-premium-rate not numeric
  4978        move zeros to cp-premium-rate
  4979     end-if
  4980**==============================================================**
  4981**                                                              **
  4982**      The below chunk of code is for those states that have   **
  4983**   the SP equivalent of a discounted MOB rate stored in       **
  4984**   Logic. All it does is calc a 12 month rate to be used      **
  4985**   with the QC formulas because they expect that. I did this  **
  4986**   so we wouldn't have a ton of hard coded formulas that      **
  4987**   basically do the same thing.                               **
  4988**                                                              **
  4989**==============================================================**
  4990     if (ws-rate-in-lf-ben-code (1:1) = 'G')
  4991        and (cp-state = 'IN' OR 'MT' OR 'ND' OR 'NJ' OR 'PA')
  4992        display ' converting MOB to SP ' cp-premium-rate
  4993        compute cp-premium-rate rounded =
  4994           cp-premium-rate / cp-loan-term * 12
  4995        display ' new rate FOR ' CP-STATE ' ' cp-premium-rate
  4996     end-if
  4997     move cp-premium-rate        to lf-rate
  4998                                    ws-rate-lf-rate
  4999     move zeros                  to ws-max-lf-benefit
  5000     .
  5001 0030-exit.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  88
* WSMESS02.cbl
  5002     exit.
  5003 0035-get-ah-rate.
  5004     move zeros to ws-rate-ah-rate
  5005     if ws-rate-in-ah-ben-code (1:1) = ' '
  5006        go to 0035-exit
  5007     end-if
  5008*    move spaces                 to calculation-pass-area
  5009     move zeros                  to cp-r-max-mon-ben
  5010                                    cp-r-max-tot-ben
  5011                                    cp-rate-dev-pct
  5012                                    cp-original-premium
  5013                                    cp-critical-months
  5014                                    cp-term-or-ext-days
  5015                                    cp-original-benefit
  5016                                    cp-rating-benefit-amt
  5017     move am-cal-table           to cp-class-CODE
  5018     move am-ah-deviation        to cp-deviation-code
  5019     move ws-rate-state          to cp-state
  5020                                    cp-state-std-abbrv
  5021     move 'A'                    to cp-benefit-type
  5022     move ws-rate-ah-benefit-cd  to cp-benefit-cd
  5023     if ws-rate-ah-term > zeros
  5024        compute cp-original-benefit =
  5025           ws-rate-loan-amt / ws-rate-ah-term
  5026        move cp-original-benefit to cp-rating-benefit-amt
  5027     end-if
  5028*    move ws-rate-loan-amt       to cp-original-benefit
  5029*                                   cp-rating-benefit-amt
  5030     move ws-rate-age            to cp-issue-age
  5031     move ws-comp-id             to cp-company-id
  5032     move ws-comp-cd             to cp-company-cd
  5033     if ws-rate-loan-term = zeros
  5034        move ws-rate-ah-term     to ws-rate-loan-term
  5035     end-if
  5036     move ws-rate-ah-term        to cp-original-term
  5037     move ws-rate-loan-term      to cp-loan-term
  5038     if (cp-original-term = zeros)
  5039        and (cp-loan-term = zeros)
  5040        move 21                  to ws-error-sub
  5041        move '-DI term'          to ws-error-sup
  5042        perform 0180-error-handle
  5043                                 thru 0180-exit
  5044        go to 0300-return-cics
  5045     end-if
  5046     move 'L'                    to cp-life-override-code
  5047     move 'A'                    to cp-ah-override-code
  5048     move '3'                    to cp-process-type
  5049     move ws-rate-earn-meth      to cp-earning-method
  5050                                    cp-rating-method
  5051     move 'R'                    to cp-rate-file
  5052     move ws-bin-eff-dt          to cp-cert-eff-dt
  5053     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  5054     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  5055     evaluate true
  5056        when cp-return-code = '7'
  5057           move '0'              to cp-return-code
  5058           move 14               to ws-error-sub
  5059           move '-Ah Rates'      to ws-error-sup
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  89
* WSMESS02.cbl
  5060           perform 0180-error-handle
  5061                                 thru 0180-exit
  5062           go to 0300-return-cics
  5063        when cp-return-code = '6'
  5064           move '0'              to cp-return-code
  5065           move 16               to ws-error-sub
  5066           move ' '              to ws-error-sup
  5067           perform 0180-error-handle
  5068                                 thru 0180-exit
  5069           go to 0300-return-cics
  5070        when cp-return-code = 'D'
  5071           move '0'              to cp-return-code
  5072           move 17               to ws-error-sub
  5073           move ' '              to ws-error-sup
  5074           perform 0180-error-handle
  5075                                 thru 0180-exit
  5076           go to 0300-return-cics
  5077     end-evaluate
  5078     if cp-error-occured
  5079        move zeros               to lf-rate
  5080        move 17                  to ws-error-sub
  5081        move '-DI rate'          to ws-error-sup
  5082        perform 0180-error-handle
  5083                                 thru 0180-exit
  5084        go to 0300-return-cics
  5085     end-if
  5086     move rt-ah-rate (cp-original-term)
  5087                                 to cp-premium-rate
  5088    move cp-premium-rate         to ah-rate
  5089                                    ws-rate-ah-rate
  5090    move zeros                   to ws-max-ah-benefit
  5091     .
  5092 0035-exit.
  5093     exit.
  5094 0040-format-buffer.
  5095*    move spaces                 to ws-return-string
  5096     perform 0045-format-error   thru 0045-exit
  5097     move ';'                    to ws-sc1
  5098                                    ws-sc2
  5099                                    ws-sc3
  5100                                    ws-sc4
  5101                                    ws-sc5
  5102                                    ws-sc6
  5103                                    ws-sc7
  5104                                    ws-sc8
  5105                                    ws-sc9
  5106                                    ws-sc10
  5107                                    ws-sc11
  5108                                    ws-sc12
  5109                                    ws-sc13
  5110                                    ws-sc14
  5111                                    ws-sc15
  5112                                    ws-sc16
  5113                                    ws-sc17
  5114                                    ws-sc18
  5115                                    ws-sc19
  5116                                    ws-sc20
  5117                                    ws-sc21
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  90
* WSMESS02.cbl
  5118                                    ws-sc22
  5119                                    ws-sc23
  5120                                    ws-sc24
  5121     if no-cp-error
  5122        if ws-contract-suffix = spaces or low-values
  5123           move ws-contract-no   to ws-return-contract-no (2:10)
  5124        else
  5125           move ws-contract-no   to ws-return-contract-no (1:10)
  5126           move ws-contract-suffix
  5127                                 to ws-return-contract-no (11:1)
  5128        end-if
  5129        move ws-rate-lf-prem     to ws-return-lf-prem
  5130        move ws-rate-ah-prem     to ws-return-ah-prem
  5131        move ws-rate-lf-rate     to ws-return-lf-rate
  5132        move ws-rate-ah-rate     to ws-return-ah-rate
  5133        move zeros               to ws-return-principal
  5134        move ws-rate-lf-term     to ws-return-lf-term
  5135        move ws-rate-ah-term     to ws-return-ah-term
  5136        move ws-rate-in-lf-ben-code
  5137                                 to ws-return-lf-bencd
  5138        move ws-rate-crit-per    to ws-return-max-bens
  5139        move ws-max-ah-benefit   to ws-return-ah-max-amt
  5140        move ws-max-lf-benefit   to ws-return-lf-max-amt
  5141        move ws-lf-exp-date      to ws-return-lf-exp-dt
  5142        move ws-ah-exp-date      to ws-return-ah-exp-dt
  5143        move ws-loan-exp-date    to ws-return-loan-exp-dt
  5144        move ws-rate-lf-benefit-cd
  5145                                 to ws-return-lf-benefit-cd
  5146        move ws-rate-ah-benefit-cd
  5147                                 to ws-return-ah-benefit-cd
  5148        move ws-rate-per-pmt     to ws-return-period-pmt
  5149        move ws-rate-loan-pmt    to ws-return-loan-pmt
  5150        move ws-rate-tot-financed to ws-return-tot-financed
  5151        move ws-rate-tot-pmts    to ws-return-tot-pmts
  5152        move ws-limit-name       to ws-return-limit-name
  5153        move am-cal-table        to ws-return-rate-class
  5154     else
  5155        set error-in-one-coverage to true
  5156        move spaces              to ws-contract-no
  5157                                    ws-contract-suffix
  5158     end-if
  5159     .
  5160 0040-exit.
  5161     exit.
  5162 0045-format-error.
  5163     evaluate true
  5164        when cp-return-code = '0'
  5165           move +1               to s1
  5166        when cp-return-code = '1'
  5167           move +2               to s1
  5168        when cp-return-code = '2'
  5169           move +3               to s1
  5170        when cp-return-code = 'A'
  5171           move +4               to s1
  5172        when cp-return-code = 'B'
  5173           move +5               to s1
  5174        when cp-return-code = '4'
  5175           move +6               to s1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  91
* WSMESS02.cbl
  5176        when cp-return-code = '9'
  5177           move +7               to s1
  5178        when cp-return-code = '8'
  5179           move +8               to s1
  5180*       when cp-return-code = 'H'
  5181*          move +9               to s1
  5182        when cp-return-code = 'C'
  5183           move +10              to s1
  5184        when cp-return-code = '7'
  5185           move +11              to s1
  5186        when cp-return-code = '6'
  5187           move +12              to s1
  5188        when cp-return-code = 'D'
  5189           move +13              to s1
  5190        when cp-return-code = 'X'
  5191           move +17              to s1
  5192        when cp-return-code = 'Z'
  5193           move +14              to s1
  5194           move cp-calc-premium  to ws-return-ah-prem
  5195           move cp-premium-rate  to ws-return-ah-rate
  5196           move ws-max-ah-benefit   to ws-return-ah-max-amt
  5197           move ws-ah-exp-date      to ws-return-ah-exp-dt
  5198           move ws-rate-ah-benefit-cd to ws-return-ah-benefit-cd
  5199        when cp-return-code = 'Y'
  5200           move +15              to s1
  5201           move cp-calc-premium  to ws-return-ah-prem
  5202           move cp-premium-rate  to ws-return-ah-rate
  5203           move ws-max-ah-benefit   to ws-return-ah-max-amt
  5204           move ws-ah-exp-date      to ws-return-ah-exp-dt
  5205           move ws-rate-ah-benefit-cd to ws-return-ah-benefit-cd
  5206     end-evaluate
  5207     move ws-table-error-no (s1) to ws-return-error-no
  5208     move ws-table-error-mess (s1)
  5209                                 to ws-return-error-mess
  5210     .
  5211 0045-exit.
  5212     exit.
  5213 0050-get-account.
  5214     move ws-comp-cd             to ws-am-company-cd
  5215     move '9'                    to ws-am-carrier
  5216     if ws-rate-state = 'KY'
  5217        move '8'                 to ws-am-carrier
  5218     end-if
  5219     move '000000'               to ws-am-group
  5220     move ws-rate-state          to ws-am-state
  5221     move ws-rate-acct-no        to ws-am-account
  5222     move ws-bin-eff-dt          to ws-am-exp-dt
  5223
  5224* exec cics read
  5225*       dataset      ('ERACCT')
  5226*       ridfld       (ws-am-key)
  5227*       into         (account-master)
  5228*       GTEQ
  5229*       resp         (ws-response)
  5230*    end-exec
  5231     MOVE LENGTH OF
  5232      account-master
  5233       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  92
* WSMESS02.cbl
  5234     MOVE 'ERACCT' TO DFHEIV1
  5235*    MOVE '&"IL       G          (  N#00005130' TO DFHEIV0
  5236     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5238     MOVE X'204E233030303035313330' TO DFHEIV0(25:11)
  5239     CALL 'kxdfhei1' USING DFHEIV0,
  5240           DFHEIV1,
  5241           account-master,
  5242           DFHEIV11,
  5243           ws-am-key,
  5244           DFHEIV99,
  5245           DFHEIV99,
  5246           DFHEIV99
  5247     MOVE EIBRESP  TO ws-response
  5248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5249     if resp-normal
  5250        and (ws-comp-cd = am-company-cd)
  5251        and (ws-rate-state = am-state)
  5252        and (ws-rate-acct-no = am-account)
  5253        and (ws-bin-eff-dt >= am-effective-dt)
  5254        and (ws-bin-eff-dt < am-expiration-dt)
  5255        continue
  5256     else
  5257        move '0114;No account mstr found ' to ws-return-string
  5258        go to 0300-RETURN-CICS
  5259     end-if
  5260     move am-comment-line (1)    to ws-form-limit-name
  5261     move spaces                 to ws-limit-name
  5262     perform varying l1 from +50 by -1 until
  5263        (l1 < +1)
  5264        or (ws-form-limit-name (l1:1) <> ' ')
  5265     end-perform
  5266     if l1 > +3
  5267        perform varying l1 from l1 by -1 until
  5268           (l1 < +1)
  5269           or (ws-form-limit-name (l1:1) = ' ')
  5270        end-perform
  5271        if l1 > +3
  5272           subtract +1 from l1
  5273           move ws-form-limit-name (1:l1)
  5274                                 to ws-limit-name
  5275        end-if
  5276     end-if
  5277     .
  5278 0050-exit.
  5279     exit.
  5280 0060-check-for-dup.
  5281**==============================================================**
  5282**                                                              **
  5283**    All i'm going to do here is check for a dup using         **
  5284**  the state, account, eff dt and last six of vin and a space  **
  5285**  in the cert suffix. If I do find one then I will have to    **
  5286**  find the last suffix and use the next available one in the  **
  5287**  suffix table.                                               **
  5288**                                                              **
  5289**==============================================================**
  5290     move +1                     to x1
  5291     move ' '                    to ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  93
* WSMESS02.cbl
  5292     move ws-comp-cd             to ws-cm-key
  5293     move '9'                    to ws-cm-carrier
  5294     if ws-rate-state = 'KY'
  5295        move '8'                 to ws-cm-carrier
  5296     end-if
  5297     move '000000'               to ws-cm-group
  5298     move ws-rate-state          to ws-cm-state
  5299     move ws-rate-acct-no        to ws-cm-account
  5300     move ws-bin-eff-dt          to ws-cm-eff-dt
  5301     string
  5302        '0000'
  5303        ws-rate-vin (12:6)
  5304        ' ' delimited by size into ws-cm-cert-no
  5305     end-string
  5306     move ws-cm-key              to ws-cm-compare-key
  5307     move ws-cm-cert-ten         to ws-contract-no
  5308     move low-values             to ws-last-suffix
  5309
  5310* exec cics startbr
  5311*       dataset      ('ELCERT')
  5312*       ridfld       (ws-cm-key)
  5313*       gteq
  5314*       resp         (ws-response)
  5315*    end-exec
  5316     MOVE 'ELCERT' TO DFHEIV1
  5317     MOVE 0
  5318       TO DFHEIV11
  5319*    MOVE '&,         G          &  N#00005197' TO DFHEIV0
  5320     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5321     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5322     MOVE X'204E233030303035313937' TO DFHEIV0(25:11)
  5323     CALL 'kxdfhei1' USING DFHEIV0,
  5324           DFHEIV1,
  5325           ws-cm-key,
  5326           DFHEIV99,
  5327           DFHEIV11,
  5328           DFHEIV99
  5329     MOVE EIBRESP  TO ws-response
  5330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5331     evaluate true
  5332        when resp-normal
  5333           set browse-started to true
  5334        when resp-notfnd or resp-endfile
  5335           set i-say-stop to true
  5336        when other
  5337           move ws-response to ws-disp-resp
  5338           string
  5339              '9999' ';'
  5340              'Bad elcert startbr ' ';'
  5341              ws-disp-resp delimited by size
  5342                                 into ws-return-string
  5343           end-string
  5344           display ' something went wrong with start br '
  5345              ws-response
  5346           go to 0300-RETURN-CICS
  5347     end-evaluate
  5348     perform until i-say-stop
  5349
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  94
* WSMESS02.cbl
  5350* exec cics readnext
  5351*          dataset      ('ELCERT')
  5352*          ridfld       (ws-cm-key)
  5353*          into         (certificate-master)
  5354*          resp         (ws-response)
  5355*       end-exec
  5356     MOVE LENGTH OF
  5357      certificate-master
  5358       TO DFHEIV12
  5359     MOVE 'ELCERT' TO DFHEIV1
  5360     MOVE 0
  5361       TO DFHEIV11
  5362*    MOVE '&.IL                  )  N#00005221' TO DFHEIV0
  5363     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5364     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5365     MOVE X'204E233030303035323231' TO DFHEIV0(25:11)
  5366     CALL 'kxdfhei1' USING DFHEIV0,
  5367           DFHEIV1,
  5368           certificate-master,
  5369           DFHEIV12,
  5370           ws-cm-key,
  5371           DFHEIV99,
  5372           DFHEIV11,
  5373           DFHEIV99,
  5374           DFHEIV99
  5375     MOVE EIBRESP  TO ws-response
  5376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5377        if resp-normal
  5378           if ws-cm-key (1:32) = ws-cm-compare-key (1:32)
  5379              move ws-cm-cert-suffix
  5380                                 to ws-last-suffix
  5381           else
  5382              set i-say-stop to true
  5383           end-if
  5384        else
  5385           set i-say-stop to true
  5386        end-if
  5387     end-perform
  5388     if browse-started
  5389
  5390* exec cics endbr
  5391*          dataset   ('ELCERT')
  5392*       END-EXEC
  5393     MOVE 'ELCERT' TO DFHEIV1
  5394     MOVE 0
  5395       TO DFHEIV11
  5396*    MOVE '&2                    $   #00005239' TO DFHEIV0
  5397     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5399     MOVE X'2020233030303035323339' TO DFHEIV0(25:11)
  5400     CALL 'kxdfhei1' USING DFHEIV0,
  5401           DFHEIV1,
  5402           DFHEIV11,
  5403           DFHEIV99
  5404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5405     end-if
  5406     if ws-last-suffix not = low-values
  5407        perform varying x1 from +1 by +1 until
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  95
* WSMESS02.cbl
  5408           (x1 > +26)
  5409           or (ws-last-suffix = ws-suffix-value (x1))
  5410        end-perform
  5411        if x1 < +27
  5412           move ws-suffix-value (x1 + 1)
  5413                                 to ws-contract-suffix
  5414        else
  5415           display ' more than 26 suffix codes ' ws-last-suffix
  5416           move 19               to ws-error-sub
  5417           move spaces           to ws-error-sup
  5418           perform 0180-error-handle
  5419                                 thru 0180-exit
  5420           go to 0300-return-cics
  5421        end-if
  5422     end-if
  5423     .
  5424 0060-exit.
  5425     exit.
  5426 0070-open-cursor.
  5427*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  5428***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5429***                                                            ***
  5430***  The dates on the sql table have values in the time        ***
  5431***  so I convert it to a string and just use mm/dd/yyyy       ***
  5432***  to perform the comparison.                                ***
  5433***                                                            ***
  5434***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  5435     if not connected-to-db
  5436        perform 6000-connect-to-db thru 6000-exit
  5437     end-if
  5438     move ws-rate-state          to ws-dealer-state
  5439     move ws-rate-acct-no        to ws-dealer-id
  5440     move ws-rate-eff-date       to ws-contract-eff-dt
  5441     move zeros                  to ws-ks-contract-no
  5442     move ws-rate-vin (12:6)     to ws-ks-contract-no (5:6)
  5443     EXEC SQL
  5444        DECLARE
  5445           contracts cursor for
  5446        SELECT
  5447           DlrState,
  5448           DlrId,
  5449           EffDt,
  5450           ContractNo,
  5451           ContractSuffix
  5452        FROM
  5453           PendingContracts
  5454        WHERE
  5455           DlrState     = :ws-dealer-state
  5456           and DlrId    = :ws-dealer-id
  5457           and EffDt    = :ws-contract-eff-dt
  5458           and ContractNo  = :ws-ks-contract-no
  5459        ORDER BY
  5460           dlrstate,
  5461           dlrid,
  5462           effdt,
  5463           contractno,
  5464           contractsuffix
  5465     end-exec
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  96
* WSMESS02.cbl
  5466     if sqlcode not = 0
  5467        display "Error: cannot declare cursor "
  5468        display ' sql retrun code ' sqlcode
  5469        display ' sql err mess    ' sqlerrmc
  5470        go to 0070-exit
  5471     end-if
  5472     EXEC SQL
  5473        open contracts
  5474     END-EXEC
  5475     if sqlcode not = 0
  5476        display "Error: cannot open cursor "
  5477        display ' sql retrun code ' sqlcode
  5478        display ' sql err mess    ' sqlerrmc
  5479        go to 0070-exit
  5480     end-if
  5481     .
  5482 0070-exit.
  5483     exit.
  5484 0080-process-input.
  5485     perform until sqlcode not = 0
  5486        EXEC SQL
  5487           fetch contracts into
  5488              :sql-dlr-state,
  5489              :sql-dlr-id,
  5490              :sql-eff-dt,
  5491              :sql-contr-no,
  5492              :sql-contr-suffix
  5493        END-EXEC
  5494        if sqlcode = 0
  5495           move sql-contr-suffix to ws-tbl-last-suffix
  5496        else
  5497           if sqlcode not = 0 and 100
  5498              display "Error: cannot fetch row "
  5499              display ' sql return code ' sqlcode
  5500              display ' sql err mess    ' sqlerrmc
  5501           end-if
  5502        end-if
  5503     end-perform
  5504     if ws-tbl-last-suffix not = low-values
  5505        and (ws-tbl-last-suffix > ws-last-suffix)
  5506        perform varying x1 from +1 by +1 until
  5507           (x1 > +26)
  5508           or (ws-tbl-last-suffix = ws-suffix-value (x1))
  5509        end-perform
  5510        if x1 < +27
  5511           move ws-suffix-value (x1 + 1)
  5512                                 to ws-contract-suffix
  5513        else
  5514           display ' more than 26 suffix codes ' ws-last-suffix
  5515           move 19               to ws-error-sub
  5516           move spaces           to ws-error-sup
  5517           perform 0180-error-handle
  5518                                 thru 0180-exit
  5519           go to 0300-return-cics
  5520        end-if
  5521     end-if
  5522     EXEC SQL
  5523         close contracts
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  97
* WSMESS02.cbl
  5524     END-EXEC
  5525     if sqlcode not = 0
  5526        display "Error: cannot close cursor "
  5527        display ' sql retrun code ' sqlcode
  5528        display ' sql err mess    ' sqlerrmc
  5529     end-if
  5530     .
  5531 0080-exit.
  5532     exit.
  5533 0090-get-limits.
  5534     move zeros                  to ws-lf-limit-lo-age
  5535                                    ws-lf-limit-hi-age
  5536                                    ws-lf-limit-att-age
  5537                                    ws-lf-limit-max-term
  5538                                    ws-lf-limit-max-benefit
  5539                                    ws-lf-limit-partial-cov
  5540                                    ws-lf-limit-check-elig
  5541                                    ws-lf-limit-elig-max-term
  5542                                    ws-lf-limit-allow-truncated
  5543                                    ws-di-limit-lo-age
  5544                                    ws-di-limit-hi-age
  5545                                    ws-di-limit-att-age
  5546                                    ws-di-limit-max-term
  5547                                    ws-di-limit-max-jnt-term
  5548                                    ws-di-limit-max-mo-ben
  5549                                    ws-di-limit-max-tot-ben
  5550                                    ws-di-limit-partial-cov
  5551                                    ws-di-limit-check-elig
  5552                                    ws-di-limit-elig-max-term
  5553                                    ws-di-limit-allow-truncated
  5554     if (ws-rate-lf-term = zeros)
  5555        and (ws-rate-ah-term <> zeros)
  5556        move 'N '                to ws-rate-in-lf-ben-code
  5557     end-if
  5558     perform 0092-get-lf-limits  thru 0092-exit
  5559     perform 0097-get-di-limits  thru 0097-exit
  5560     if recalc-lf
  5561        perform 0020-calc-lf-exp
  5562     end-if
  5563     if recalc-di
  5564        perform 0020-calc-ah-exp
  5565        if ws-rate-ah-term < ws-rate-crit-per
  5566           move zeros            to ws-rate-crit-per
  5567     end-if
  5568     if recalc-lf or recalc-di
  5569        perform 0020-calc-pri-att-age
  5570        perform 0020-calc-cob-att-age
  5571     end-if
  5572     .
  5573 0090-exit.
  5574     exit.
  5575 0092-get-lf-limits.
  5576     if not connected-to-db
  5577        perform 6000-connect-to-db thru 6000-exit
  5578     end-if
  5579     evaluate true
  5580        when raw-lf-ben-code (1:1) = 'L'
  5581           move 'LL'             to ws-limit-cov-type
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  98
* WSMESS02.cbl
  5582        when raw-ah-ben-code (1:1) = ' '
  5583           move 'LO'             to ws-limit-cov-type
  5584        when raw-lf-ben-code (1:1) = 'N' or 'G' or 'T'
  5585           move 'RL'             to ws-limit-cov-type
  5586        when other   *> Assuming no life coverage
  5587           go to 0092-exit
  5588     end-evaluate
  5589     move zeros                  to ws-limit-lo-age
  5590                                    ws-limit-hi-age
  5591                                    ws-limit-att-age
  5592                                    ws-limit-max-term
  5593                                    ws-limit-max-jnt-term
  5594                                    ws-limit-max-mo-ben
  5595                                    ws-limit-max-tot-ben
  5596                                    ws-limit-partial-cov
  5597                                    ws-limit-check-elig
  5598                                    ws-limit-elig-max-term
  5599                                    ws-limit-allow-truncated
  5600     move ws-rate-age            to ws-limit-issue-age
  5601     .
  5602 0092-get-life.
  5603     move 30                     to ws-limit-issue-age
  5604     EXEC SQL
  5605        SELECT
  5606           AttainedAge
  5607        INTO
  5608           :ws-limit-att-age
  5609        FROM
  5610           FormLimits
  5611        WHERE
  5612           Limit           = :ws-limit-name
  5613           and CovType     = :ws-limit-cov-type
  5614           and LoIssueAge <= :ws-limit-issue-age
  5615           and HiIssueAge >= :ws-limit-issue-age
  5616     end-exec
  5617     if sqlcode not = 0
  5618        display "Error: cannot find limitsa " ws-limit-name
  5619           ' ' ws-limit-cov-type ' ' ws-limit-issue-age
  5620        display ' sql retrun code ' sqlcode
  5621        display ' sql err mess    ' sqlerrmc
  5622        if (ws-limit-cov-type = 'LO')
  5623           and (raw-ah-ben-code (1:1) = ' ')
  5624           move 'RL'             to ws-limit-cov-type
  5625           go to 0092-get-life
  5626        else
  5627           display "Error: cannot find limits " ws-limit-name
  5628              ' ' ws-limit-cov-type ' ' ws-limit-issue-age
  5629           display ' sql retrun code ' sqlcode
  5630           display ' sql err mess    ' sqlerrmc
  5631           move 22                  to ws-error-sub
  5632           move ws-limit-name       to ws-error-sup
  5633           perform 0180-error-handle
  5634                                    thru 0180-exit
  5635           go to 0300-return-cics
  5636        end-if
  5637     end-if
  5638     move ws-rate-age            to ws-limit-issue-age
  5639     EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page  99
* WSMESS02.cbl
  5640        SELECT
  5641           AttainedAge,
  5642           MaxTerm,
  5643           MaxTotBen,
  5644           PartialCoverage,
  5645           CheckEligibility,
  5646           EligibilityMaxTerm,
  5647           AllowTruncated
  5648        INTO
  5649           :ws-limit-att-age,
  5650           :ws-limit-max-term,
  5651           :ws-limit-max-tot-ben,
  5652           :ws-limit-partial-cov  :nu-partial-cov,
  5653           :ws-limit-check-elig   :nu-check-elig,
  5654           :ws-limit-elig-max-term,
  5655           :ws-limit-allow-truncated  :nu-allow-trunc
  5656        FROM
  5657           FormLimits
  5658        WHERE
  5659           Limit           = :ws-limit-name
  5660           and CovType     = :ws-limit-cov-type
  5661           and LoIssueAge <= :ws-limit-issue-age
  5662           and HiIssueAge >= :ws-limit-issue-age
  5663     end-exec
  5664     if sqlcode not = 0
  5665        display "Error: cannot find limits for age "
  5666           ws-limit-name ' ' ws-limit-cov-type ' '
  5667           ws-limit-issue-age
  5668        display ' sql retrun code ' sqlcode
  5669        display ' sql err mess    ' sqlerrmc
  5670        move 4                   to ws-error-sub
  5671       move ws-limit-name        to ws-error-sup
  5672       perform 0180-error-handle thru 0180-exit
  5673       go to 0300-return-cics
  5674     end-if
  5675*    display ' good get on limit *'  ws-limit-name '*'
  5676*       ws-limit-att-age '*' ws-limit-cov-type '*'
  5677*         ws-limit-issue-age '*' ws-limit-att-age '*'
  5678*         ws-limit-partial-cov '*' ws-limit-check-elig '*'
  5679*         ws-limit-elig-max-term '*'
  5680*         ws-limit-allow-truncated '*'
  5681     move ws-limit-lo-age        to ws-lf-limit-lo-age
  5682     move ws-limit-hi-age        to ws-lf-limit-hi-age
  5683     move ws-limit-att-age       to ws-lf-limit-att-age
  5684     move ws-limit-max-term      to ws-lf-limit-max-term
  5685     move ws-limit-max-tot-ben   to ws-lf-limit-max-benefit
  5686     move ws-limit-partial-cov   to ws-lf-limit-partial-cov
  5687     move ws-limit-check-elig    to ws-lf-limit-check-elig
  5688     move ws-limit-elig-max-term to ws-lf-limit-elig-max-term
  5689     move ws-limit-allow-truncated
  5690                                 to ws-lf-limit-allow-truncated
  5691     if ws-lf-limit-check-elig = 0
  5692        go to 0092-continue
  5693     end-if
  5694     if ws-rate-loan-term <= ws-lf-limit-elig-max-term
  5695        continue
  5696     else
  5697        move 31                  to ws-error-sub
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 100
* WSMESS02.cbl
  5698        move ' '                 to ws-error-sup
  5699        perform 0180-error-handle
  5700                                 thru 0180-exit
  5701        go to 0300-return-cics
  5702     end-if
  5703     if ws-rate-loan-amt <= ws-lf-limit-max-benefit
  5704        continue
  5705     else
  5706        move 32                  to ws-error-sub
  5707        move '- Lf Benefit '     to ws-error-sup
  5708        perform 0180-error-handle
  5709                                 thru 0180-exit
  5710        go to 0300-return-cics
  5711     end-if
  5712     .
  5713 0092-continue.
  5714     move ' '                    to ws-recalc-lf
  5715     if ws-lf-limit-allow-truncated = 0
  5716        go to 0092-exit
  5717     end-if
  5718     if ws-att-age <= ws-lf-limit-att-age
  5719        go to 0092-exit
  5720     end-if
  5721*****  Calculate the date in which they will turn the
  5722*****  limit attained age.
  5723     move ws-bin-pri-birth-dt to dc-bin-date-1
  5724     if (ws-bin-cob-birth-dt < dc-bin-date-1)
  5725        and (ws-bin-cob-birth-dt <> low-values)
  5726        move ws-bin-cob-birth-dt to dc-bin-date-1
  5727     end-if
  5728     move dc-bin-date-1          to ws-test-bin-dt
  5729     move ws-comp-bin-dt         to ws-disp-bin-dt
  5730     compute dc-elapsed-months = (ws-lf-limit-att-age * 12)
  5731     move '6'                    to dc-option-code
  5732     move zeros                  to dc-elapsed-days
  5733     PERFORM 9700-date-link      thru 9700-exit
  5734     if no-conversion-error
  5735        move dc-bin-date-2       to ws-limit-att-age-dt
  5736     else
  5737        move low-values          to ws-limit-att-age-dt
  5738     end-if
  5739     move dc-bin-date-2          to ws-test-bin-dt
  5740     move ws-comp-bin-dt         to ws-disp-bin-dt
  5741     set recalc-lf to true
  5742     compute ws-temp-lf-term = ws-rate-lf-term -
  5743        ((ws-att-age - ws-lf-limit-att-age) * 12)
  5744     compute ws-rate-lf-term = ws-rate-lf-term -
  5745        ((ws-att-age - ws-lf-limit-att-age) * 12)
  5746     move 'T '                   to ws-rate-in-lf-ben-code
  5747*****  Calculate the new expiration date.
  5748     perform 0020-calc-lf-exp
  5749     if ws-bin-lf-exp-dt > ws-limit-att-age-dt
  5750        subtract 1 from ws-rate-lf-term
  5751     end-if
  5752*    if ws-rate-loan-amt <= ws-limit-max-tot-ben
  5753*       continue
  5754*    else
  5755*       move 8                   to ws-error-sub
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 101
* WSMESS02.cbl
  5756*       move '- Lf Benefit '     to ws-error-sup
  5757*       perform 0180-error-handle
  5758*                                thru 0180-exit
  5759*       go to 0300-return-cics
  5760*    end-if
  5761*
  5762*    if ws-rate-lf-term <= ws-limit-max-term
  5763*       continue
  5764*    else
  5765*       move 7                   to ws-error-sub
  5766*       move '- Lf Term '        to ws-error-sup
  5767*       perform 0180-error-handle
  5768*                                thru 0180-exit
  5769*       go to 0300-return-cics
  5770*    end-if
  5771*    if ws-att-age <= ws-limit-att-age
  5772*       continue
  5773*    else
  5774*       move 5                   to ws-error-sub
  5775*       move ws-att-age          to ws-error-sup
  5776*       perform 0180-error-handle
  5777*                                thru 0180-exit
  5778*       go to 0300-return-cics
  5779*    end-if
  5780     .
  5781 0092-exit.
  5782     exit.
  5783 0097-get-di-limits.
  5784     if raw-ah-ben-code (1:1) = 'A'
  5785        move 'DI'                to ws-limit-cov-type
  5786     else   *>  Assuming no AH coverage
  5787        go to 0097-exit
  5788     end-if
  5789     if not connected-to-db
  5790        perform 6000-connect-to-db thru 6000-exit
  5791     end-if
  5792***  True = -1
  5793     move 30                     to ws-limit-issue-age
  5794     EXEC SQL
  5795        SELECT distinct top 1
  5796           AttainedAge
  5797        INTO
  5798           :ws-limit-att-age
  5799        FROM
  5800           FormLimits
  5801        WHERE
  5802           Limit           = :ws-limit-name
  5803           and CovType     = :ws-limit-cov-type
  5804           and LoIssueAge <= :ws-limit-issue-age
  5805           and HiIssueAge >= :ws-limit-issue-age
  5806     end-exec
  5807     if sqlcode not = 0
  5808        display "Error: cannot find limits " ws-limit-name
  5809        display ' sql retrun code ' sqlcode
  5810        display ' sql err mess    ' sqlerrmc
  5811        move 22                  to ws-error-sub
  5812        move ws-limit-name       to ws-error-sup
  5813        perform 0180-error-handle
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 102
* WSMESS02.cbl
  5814                                 thru 0180-exit
  5815        go to 0300-return-cics
  5816     end-if
  5817     move ws-rate-age            to ws-limit-issue-age
  5818     EXEC SQL
  5819        SELECT distinct top 1
  5820           AttainedAge,
  5821           MaxTerm,
  5822           MaxJntTerm,
  5823           MaxMoBen,
  5824           MaxTotBen,
  5825           PartialCoverage,
  5826           CheckEligibility,
  5827           EligibilityMaxTerm,
  5828           AllowTruncated
  5829        INTO
  5830           :ws-limit-att-age,
  5831           :ws-limit-max-term,
  5832           :ws-limit-max-jnt-term,
  5833           :ws-limit-max-mo-ben,
  5834           :ws-limit-max-tot-ben,
  5835           :ws-limit-partial-cov   :nu-partial-cov,
  5836           :ws-limit-check-elig    :nu-check-elig,
  5837           :ws-limit-elig-max-term,
  5838           :ws-limit-allow-truncated  :nu-allow-trunc
  5839        FROM
  5840           FormLimits
  5841        WHERE
  5842           Limit           = :ws-limit-name
  5843           and CovType     = :ws-limit-cov-type
  5844           and LoIssueAge <= :ws-limit-issue-age
  5845           and HiIssueAge >= :ws-limit-issue-age
  5846     end-exec
  5847     if sqlcode not = 0
  5848        display "Error: cannot find limits " ws-limit-name
  5849        display ' sql retrun code ' sqlcode
  5850        display ' sql err mess    ' sqlerrmc
  5851        move 4                   to ws-error-sub
  5852        move ws-limit-name       to ws-error-sup
  5853        perform 0180-error-handle
  5854                                 thru 0180-exit
  5855        go to 0300-return-cics
  5856     end-if
  5857     move ws-limit-lo-age        to ws-di-limit-lo-age
  5858     move ws-limit-hi-age        to ws-di-limit-hi-age
  5859     move ws-limit-att-age       to ws-di-limit-att-age
  5860     move ws-limit-max-term      to ws-di-limit-max-term
  5861     move ws-limit-max-jnt-term  to ws-di-limit-max-jnt-term
  5862     move ws-limit-max-mo-ben    to ws-di-limit-max-mo-ben
  5863     move ws-limit-max-tot-ben   to ws-di-limit-max-tot-ben
  5864     move ws-limit-partial-cov   to ws-di-limit-partial-cov
  5865     move ws-limit-check-elig    to ws-di-limit-check-elig
  5866     move ws-limit-elig-max-term to ws-di-limit-elig-max-term
  5867     move ws-limit-allow-truncated
  5868                                 to ws-di-limit-allow-truncated
  5869     if ws-di-limit-check-elig = 0
  5870        go to 0097-continue
  5871     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 103
* WSMESS02.cbl
  5872     if ws-rate-loan-term <= ws-di-limit-elig-max-term
  5873        continue
  5874     else
  5875        move 31                  to ws-error-sub
  5876        move ' '                 to ws-error-sup
  5877        perform 0180-error-handle
  5878                                 thru 0180-exit
  5879        go to 0300-return-cics
  5880     end-if
  5881*    if (ws-rate-ah-term * ws-rate-per-pmt) <=
  5882*                  ws-di-limit-max-tot-ben
  5883*       continue
  5884*    else
  5885*       move 32                  to ws-error-sub
  5886*       move '- Di ToT Ben '     to ws-error-sup
  5887*       perform 0180-error-handle
  5888*                                thru 0180-exit
  5889*       go to 0300-return-cics
  5890*    end-if
  5891     .
  5892 0097-continue.
  5893     move ' '                    to ws-recalc-di
  5894     if ws-di-limit-allow-truncated = 0
  5895        go to 0097-exit
  5896     end-if
  5897     if ws-att-age <= ws-di-limit-att-age
  5898        go to 0097-exit
  5899     end-if
  5900     compute ws-rate-ah-term = ws-rate-ah-term -
  5901        ((ws-att-age - ws-di-limit-att-age) * 12)
  5902     set recalc-di to true
  5903     if (ws-rate-lf-term > zeros)
  5904        and (ws-rate-ah-term <> ws-rate-lf-term)
  5905        move ws-rate-lf-term     to ws-rate-ah-term
  5906     end-if
  5907*    if ws-rate-per-pmt <= ws-limit-max-mo-ben
  5908*       continue
  5909*    else
  5910*       move 8                   to ws-error-sub
  5911*       move '- Ah Benefit '     to ws-error-sup
  5912*       perform 0180-error-handle
  5913*                                thru 0180-exit
  5914*       go to 0300-return-cics
  5915*    end-if
  5916*
  5917*    if ws-rate-ah-term <= ws-limit-max-term
  5918*       continue
  5919*    else
  5920*       move 7                   to ws-error-sub
  5921*       move '- Ah Term '        to ws-error-sup
  5922*       perform 0180-error-handle
  5923*                                thru 0180-exit
  5924*       go to 0300-return-cics
  5925*    end-if
  5926*
  5927*    if ws-att-age <= ws-limit-att-age
  5928*       continue
  5929*    else
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 104
* WSMESS02.cbl
  5930*       move 5                   to ws-error-sub
  5931*       move ws-att-age          to ws-error-sup
  5932*       perform 0180-error-handle
  5933*                                thru 0180-exit
  5934*       go to 0300-return-cics
  5935*    end-if
  5936     .
  5937 0097-exit.
  5938     exit.
  5939 0110-unstring.
  5940***____________________________________________________________***
  5941**|                                                            |**
  5942**|    Unstring the raw data into data elements                |**
  5943**|                                                            |**
  5944***____________________________________________________________***
  5945        unstring dfhcommarea
  5946           delimited by '|' into
  5947              raw-message-num
  5948              raw-state
  5949              raw-acct-no
  5950              raw-vin
  5951              raw-lf-ben-code
  5952              raw-ah-ben-code
  5953              raw-earn-meth
  5954              raw-pri-birth-date
  5955              raw-cob-birth-date
  5956              raw-loan-amt
  5957              raw-eff-date
  5958              raw-1st-pmt-dt
  5959              raw-pmts-per-year
  5960              raw-loan-term
  5961              raw-lf-term
  5962              raw-ah-term
  5963              raw-apr
  5964              raw-lf-sin-jnt-ind
  5965              raw-ah-sin-jnt-ind
  5966              raw-dismemberment
  5967              raw-retro-elim
  5968              raw-waiting-days
  5969              raw-crit-per
  5970        end-unstring
  5971     .
  5972 0110-exit.
  5973     exit.
  5974 0120-format-message.
  5975***____________________________________________________________***
  5976**|                                                            |**
  5977**|    Format each data element to be consistant with          |**
  5978**|  COBOL rate copybook model                                 |**
  5979**|                                                            |**
  5980***____________________________________________________________***
  5981     inspect
  5982        raw-acct-no replacing leading spaces by zeros
  5983     inspect
  5984        raw-pmts-per-year replacing leading spaces by zeros
  5985     inspect
  5986        raw-loan-term replacing leading spaces by zeros
  5987     inspect
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 105
* WSMESS02.cbl
  5988        raw-lf-term replacing leading spaces by zeros
  5989     inspect
  5990        raw-ah-term replacing leading spaces by zeros
  5991     inspect
  5992        raw-waiting-days replacing leading spaces by zeros
  5993     inspect
  5994        raw-crit-per replacing leading spaces by zeros
  5995     inspect
  5996        raw-loan-amt replacing all spaces by zeros
  5997     inspect
  5998        raw-apr replacing all spaces by zeros
  5999     move raw-loan-amt           to ws-work-in
  6000     perform 0130-format-amt     thru 0130-exit
  6001     move ws-work-out-v2         to ws-rate-loan-amt
  6002*    display ' ben  in *' ws-work-in '*'
  6003*    display ' ben  out *' ws-work-out '*'
  6004     move raw-loan-term          to ws-work-in
  6005     perform 0140-format-term    thru 0140-exit
  6006     move ws-work-out-v0         to ws-rate-loan-term
  6007*    display ' ln term in *' ws-work-in '*'
  6008*    display ' ln term out *' ws-work-out '*'
  6009     move raw-lf-term            to ws-work-in
  6010     perform 0140-format-term    thru 0140-exit
  6011     move ws-work-out-v0         to ws-rate-lf-term
  6012*    display ' lf  term in *' ws-work-in '*'
  6013*    display ' lf  term out *' ws-work-out '*'
  6014     move raw-ah-term            to ws-work-in
  6015     perform 0140-format-term    thru 0140-exit
  6016     move ws-work-out-v0         to ws-rate-ah-term
  6017*    display ' ah  term in *' ws-work-in '*'
  6018*    display ' ah  term out *' ws-work-out '*'
  6019     move raw-waiting-days       to ws-work-in
  6020     perform 0140-format-term    thru 0140-exit
  6021     move ws-work-out-v0         to ws-rate-waiting-days
  6022*    display ' wait day in *' ws-work-in '*'
  6023*    display ' wait day out *' ws-work-out '*'
  6024     move raw-crit-per           to ws-work-in
  6025     perform 0140-format-term    thru 0140-exit
  6026     move ws-work-out-v0         to ws-rate-crit-per
  6027*    display ' crit per in *' ws-work-in '*'
  6028*    display ' crit per out *' ws-work-out '*'
  6029     move raw-pmts-per-year      to ws-work-in
  6030     perform 0140-format-term    thru 0140-exit
  6031     move ws-work-out-v0         to ws-rate-pmts-per-year
  6032*    display ' pmts per yr *' ws-work-in '*'
  6033*    display ' pmts per yr  *' ws-work-out '*'
  6034     move raw-apr                to ws-work-in
  6035     perform 0150-format-apr     thru 0150-exit
  6036     move ws-work-out-v5         to ws-rate-apr
  6037*    display ' ins apr  in *' ws-work-in '*'
  6038*    display ' ins apr  out *' ws-work-out '*'
  6039     move raw-state              to ws-rate-state
  6040     move raw-acct-no            to ws-rate-acct-no
  6041     move raw-vin                to ws-rate-vin
  6042     move raw-lf-ben-code        to ws-rate-in-lf-ben-code
  6043     move raw-ah-ben-code        to ws-rate-in-ah-ben-code
  6044     move raw-earn-meth          to ws-rate-earn-meth
  6045     move raw-pri-birth-date     to ws-rate-pri-birth-date
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 106
* WSMESS02.cbl
  6046     move raw-cob-birth-date     to ws-rate-cob-birth-date
  6047     move raw-eff-date           to ws-rate-eff-date
  6048     move raw-1st-pmt-dt         to ws-rate-1st-pmt-dt
  6049     move raw-lf-sin-jnt-ind     to ws-rate-sin-jnt-lf
  6050     move raw-ah-sin-jnt-ind     to ws-rate-sin-jnt-ah
  6051     move raw-dismemberment      to ws-rate-dismemberment
  6052     move raw-retro-elim         to ws-rate-retro-elim
  6053     if ws-rate-crit-per = zeros
  6054        move 'Y'                 to ws-rate-fullterm
  6055     else
  6056        move 'N'                 to ws-rate-fullterm
  6057     end-if
  6058     .
  6059 0120-exit.
  6060     exit.
  6061 0130-format-amt.
  6062     move zeros                  to ws-work-out
  6063     perform varying s2 from +10 by -1 until
  6064        (s2 < +1)
  6065        or (ws-work-in (s2:1) = '.')
  6066     end-perform
  6067     if s2 < +9
  6068        move ws-work-in (s2 + 1:2)
  6069                              to ws-work-out (9:2)
  6070        move +8               to s3
  6071        subtract +1 from s2
  6072        perform varying s2 from s2 by -1 until
  6073           (s2 < +1)
  6074           or (s3 = 0)
  6075           move ws-work-in (s2:1) to ws-work-out (s3:1)
  6076           subtract +1 from s3
  6077        end-perform
  6078     end-if
  6079     .
  6080 0130-exit.
  6081     exit.
  6082 0140-format-term.
  6083     move zeros                  to ws-work-out
  6084     perform varying s2 from +10 by -1 until
  6085        (s2 < +1)
  6086        or (ws-work-in (s2:1) numeric)
  6087     end-perform
  6088     if s2 > +0
  6089        move ws-work-in (s2:1)
  6090                              to ws-work-out (10:1)
  6091        move +9               to s3
  6092        subtract +1 from s2
  6093        perform varying s2 from s2 by -1 until
  6094           (s2 < +1)
  6095           or (s3 = 7)
  6096           move ws-work-in (s2:1) to ws-work-out (s3:1)
  6097           subtract +1 from s3
  6098        end-perform
  6099     end-if
  6100     .
  6101 0140-exit.
  6102     exit.
  6103 0150-format-apr.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 107
* WSMESS02.cbl
  6104     move zeros                  to ws-work-out
  6105     perform varying s2 from +10 by -1 until
  6106        (s2 < +1)
  6107        or (ws-work-in (s2:1) = '.')
  6108     end-perform
  6109     if s2 < +5
  6110        move ws-work-in (s2 + 1:5)
  6111                              to ws-work-out (6:5)
  6112        move +5               to s3
  6113        subtract +1 from s2
  6114        perform varying s2 from s2 by -1 until
  6115           (s2 < +1)
  6116           or (s3 = 0)
  6117           move ws-work-in (s2:1) to ws-work-out (s3:1)
  6118           subtract +1 from s3
  6119        end-perform
  6120     end-if
  6121     .
  6122 0150-exit.
  6123     exit.
  6124 0180-error-handle.
  6125     move ws-table-error-no (ws-error-sub)
  6126                                 to ws-return-error-no
  6127     move spaces                 to ws-return-error-mess
  6128     string
  6129        ws-table-error-mess (ws-error-sub)
  6130        ws-error-sup
  6131        delimited by '  ' into ws-return-error-mess
  6132     end-string
  6133     .
  6134 0180-exit.
  6135     exit.
  6136 0190-final-limit-check.
  6137     if ws-rate-in-lf-ben-code (1:1) = ' '
  6138        go to 0190-final-ah
  6139     end-if
  6140*    display ' rate loan amt  ' ws-rate-loan-amt
  6141*    display ' max lf benefit ' ws-max-lf-benefit
  6142*    display ' lf prem        ' ws-rate-lf-prem
  6143*    display ' ah prem        ' ws-rate-ah-prem
  6144*    display ' lf limit max   ' ws-lf-limit-max-benefit
  6145*    display ' att age        ' ws-att-age
  6146*    display ' limit att age  ' ws-lf-limit-att-age
  6147*    display ' rate lf term   ' ws-rate-lf-term
  6148*    display ' limit max trm  ' ws-lf-limit-max-term
  6149     if ws-lf-limit-check-elig <> 0
  6150        if (ws-rate-loan-amt +
  6151            ws-rate-lf-prem +
  6152            ws-rate-ah-prem)  <= ws-lf-limit-max-benefit
  6153           continue
  6154        else
  6155           move 32               to ws-error-sub
  6156           move '- Lf Benefit '  to ws-error-sup
  6157           perform 0180-error-handle
  6158                                 thru 0180-exit
  6159           go to 0300-return-cics
  6160        end-if
  6161     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 108
* WSMESS02.cbl
  6162     if (ws-max-lf-benefit <= ws-lf-limit-max-benefit)
  6163        or (ws-lf-limit-max-benefit = zeros)
  6164        continue
  6165     else
  6166        move 10                  to ws-error-sub
  6167        move '- Lf Benefit '     to ws-error-sup
  6168        perform 0180-error-handle
  6169                                 thru 0180-exit
  6170        go to 0300-return-cics
  6171     end-if
  6172     if ws-rate-lf-term <= ws-lf-limit-max-term
  6173        continue
  6174     else
  6175        move 9                   to ws-error-sub
  6176        move '- Lf Term '        to ws-error-sup
  6177        perform 0180-error-handle
  6178                                 thru 0180-exit
  6179        go to 0300-return-cics
  6180     end-if
  6181     if (ws-att-age <= ws-lf-limit-att-age)
  6182        or (ws-lf-limit-att-age = zeros)
  6183        continue
  6184     else
  6185        move 5                   to ws-error-sub
  6186        move ws-att-age          to ws-error-sup
  6187        perform 0180-error-handle
  6188                                 thru 0180-exit
  6189        go to 0300-return-cics
  6190     end-if
  6191     .
  6192 0190-final-ah.
  6193     if ws-rate-in-ah-ben-code (1:1) = ' '
  6194        go to 0190-exit
  6195     end-if
  6196*    display ' made it to 0190-final-ah ' ws-di-limit-check-elig
  6197*    display ' rate loan amt      ' ws-rate-loan-amt
  6198*    display ' rate ah prem       ' ws-rate-ah-prem
  6199*    display ' di limit max totben' ws-di-limit-max-tot-ben
  6200*    display ' rate ah term       ' ws-rate-ah-term
  6201*    display ' rate per pmt       ' ws-rate-per-pmt
  6202*    display ' rate loan term     ' ws-rate-loan-term
  6203     if ws-di-limit-check-elig <> 0
  6204        if (ws-rate-loan-amt +
  6205            ws-rate-ah-prem)  <= ws-di-limit-max-tot-ben
  6206           continue
  6207        else
  6208           move 32               to ws-error-sub
  6209           move '- Di Benefit '  to ws-error-sup
  6210           perform 0180-error-handle
  6211                                 thru 0180-exit
  6212           go to 0300-return-cics
  6213        end-if
  6214        if ws-rate-state = 'FL'
  6215           if ((ws-rate-loan-term * ws-rate-per-pmt) <=
  6216                      ws-di-limit-max-tot-ben)
  6217              continue
  6218           else
  6219              move 32            to ws-error-sub
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 109
* WSMESS02.cbl
  6220              move '- Di ToT Ben ' to ws-error-sup
  6221              perform 0180-error-handle
  6222                                 thru 0180-exit
  6223              go to 0300-return-cics
  6224           end-if
  6225        end-if
  6226     end-if
  6227     if ws-max-ah-benefit <= ws-di-limit-max-mo-ben
  6228        continue
  6229     else
  6230        move 11                  to ws-error-sub
  6231        move '- Ah Benefit '     to ws-error-sup
  6232        perform 0180-error-handle
  6233                                 thru 0180-exit
  6234        go to 0300-return-cics
  6235     end-if
  6236     if ws-rate-sin-jnt-ah = 'J'
  6237        if ws-rate-ah-term <= ws-di-limit-max-jnt-term
  6238           continue
  6239        else
  6240           move 8                   to ws-error-sub
  6241           move '- Ah TermJNT'      to ws-error-sup
  6242           perform 0180-error-handle
  6243                                    thru 0180-exit
  6244           go to 0300-return-cics
  6245        end-if
  6246     else
  6247        if ws-rate-ah-term <= ws-di-limit-max-term
  6248           continue
  6249        else
  6250           move 9                   to ws-error-sub
  6251           move '- Ah Term '        to ws-error-sup
  6252           perform 0180-error-handle
  6253                                    thru 0180-exit
  6254           go to 0300-return-cics
  6255        end-if
  6256     end-if
  6257     if (ws-rate-ah-term * ws-max-ah-benefit) <=
  6258                   ws-di-limit-max-tot-ben
  6259        continue
  6260     else
  6261        move 13                  to ws-error-sub
  6262        move '- Ah Tot Ben '     to ws-error-sup
  6263        perform 0180-error-handle
  6264                                 thru 0180-exit
  6265        go to 0300-return-cics
  6266     end-if
  6267     if ws-att-age <= ws-di-limit-att-age
  6268        continue
  6269     else
  6270        move 5                   to ws-error-sub
  6271        move ws-att-age          to ws-error-sup
  6272        perform 0180-error-handle
  6273                                 thru 0180-exit
  6274        go to 0300-return-cics
  6275     end-if
  6276     .
  6277 0190-exit.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 110
* WSMESS02.cbl
  6278     exit.
  6279 0200-calc-NP-payment.
  6280     move ws-rate-loan-amt       to l
  6281     move ws-rate-loan-term      to n
  6282     move ws-rate-lf-term        to m
  6283     if m = zeros
  6284        move ws-rate-ah-term to m
  6285     end-if
  6286     move ws-rate-pmts-per-year  to ppy
  6287     move 30                     to dpp
  6288     compute i = ws-rate-apr / (ppy *100)
  6289     if i = zeros
  6290        move .0000001            to i
  6291     end-if
  6292     COMPUTE A-ANGLE-N ROUNDED =
  6293         (1 - ((1 / (1 + I)) ** N)) / I
  6294     COMPUTE A-ANGLE-N-M ROUNDED =
  6295         (1 - ((1 / (1 + I)) ** (N - M))) / I
  6296     COMPUTE GAMMA ROUNDED =
  6297         (1 + ((D * I) / DPP)) / (1 + I)
  6298     COMPUTE A-PRM-ANGLE-N ROUNDED = A-ANGLE-N / GAMMA
  6299     compute ws-rate-loan-pmt rounded =
  6300        l / a-prm-angle-n
  6301***____________________________________________________________***
  6302**(-                                                          -)**
  6303**(-   This section is for TX Net Pay + 1                     -)**
  6304**(-   This formula is designed to use the actual MOB rate    -)**
  6305**(- and then applies the discount using x.                   -)**
  6306**(-   This formula works for net and net truncated.          -)**
  6307**(-                                                          -)**
  6308***____________________________________________________________***
  6309     if ws-rate-state <> 'TX'
  6310        go to 0200-try-oh
  6311     end-if
  6312     COMPUTE X ROUNDED = 1 / (1 + TX-DISCOUNT-RATE)
  6313     COMPUTE V-TO-N ROUNDED = (1 / (1 + I)) ** N
  6314     COMPUTE X-TO-M ROUNDED = X ** M
  6315     COMPUTE V-TO-N-M ROUNDED = (1 / (1 + I)) ** (N - M)
  6316     COMPUTE TEMP-VALUE-1 ROUNDED =
  6317         (1 + I) / I
  6318     COMPUTE TEMP-VALUE-2 ROUNDED =
  6319         (X-TO-M - 1) / (X - 1)
  6320     COMPUTE TEMP-VALUE-3 ROUNDED =
  6321         ((X-TO-M * V-TO-N-M) - V-TO-N) /
  6322         ((X * (1 + I)) - 1)
  6323     COMPUTE TEMP-VALUE-4 ROUNDED =
  6324         M * (AH-RATE / 100)
  6325     COMPUTE TEMP-VALUE-5 ROUNDED =
  6326         A-PRM-ANGLE-N * (1 + I)
  6327     COMPUTE LIFE-FACTOR ROUNDED =
  6328         TEMP-VALUE-1 * (TEMP-VALUE-2 - TEMP-VALUE-3) *
  6329         (lf-rate / 1000)
  6330     COMPUTE PMT ROUNDED =
  6331         L / (A-PRM-ANGLE-N - LIFE-FACTOR - TEMP-VALUE-4)
  6332     COMPUTE SINGLE-FACTOR ROUNDED =
  6333         (LIFE-FACTOR * 100) / TEMP-VALUE-5
  6334     .
  6335 0200-check-tx-partial.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 111
* WSMESS02.cbl
  6336     if ws-lf-limit-partial-cov = 0
  6337        display ' no partial coverage '
  6338        move pmt                 to dispmt
  6339                                    lifepmt1
  6340                                    lifepmt2
  6341                                    newpmt
  6342        go to 0200-carry-on-tx
  6343     end-if
  6344     if pmt < ws-di-limit-max-mo-ben
  6345        move pmt                 to dispmt
  6346     else
  6347        move ws-di-limit-max-mo-ben
  6348                                 to dispmt
  6349     end-if
  6350     if (ws-di-limit-max-tot-ben / n) < dispmt
  6351        compute dispmt rounded =
  6352           (ws-di-limit-max-tot-ben / n) - .005
  6353     end-if
  6354     compute lifepmt1 rounded =
  6355        (l + (single-factor * (pmt * a-prm-angle-n * (1 + 1 * i))
  6356        / 100) + dispmt * m * ah-rate / 100) / a-prm-angle-n
  6357     if (ws-lf-limit-max-benefit / a-prm-angle-n) < lifepmt1
  6358        compute lifepmt1 rounded =
  6359           ws-lf-limit-max-benefit / a-prm-angle-n
  6360        move ws-lf-limit-max-benefit
  6361                                 to ws-max-lf-benefit
  6362     end-if
  6363     compute newpmt rounded =
  6364        (l + (single-factor * (lifepmt1 * a-prm-angle-n *
  6365        (1 + 1 * i)) / 100) + dispmt * m * ah-rate / 100) /
  6366        a-prm-angle-n
  6367     .
  6368 0200-carry-on-tx.
  6369     COMPUTE DL-PREMIUM ROUNDED =
  6370         SINGLE-FACTOR *
  6371         ((lifePMT1 * TEMP-VALUE-5) / 100)
  6372     COMPUTE AH-PREMIUM ROUNDED =
  6373         disPMT * TEMP-VALUE-4
  6374*    display 'discount       ' tx-discount-rate
  6375*    display ' v to n        ' v-to-n
  6376*    display ' x to m        ' x-to-m
  6377*    display ' v to n - m    ' v-to-n-m
  6378*    display ' anglen        ' a-angle-n
  6379*    display ' gamma         ' gamma
  6380*    display ' anglend       ' a-prm-angle-n
  6381*    display ' tv1           ' temp-value-1
  6382*    display ' tv2           ' temp-value-2
  6383*    display ' tv3           ' temp-value-3
  6384*    display ' tv4           ' temp-value-4
  6385*    display ' tv5           ' temp-value-5
  6386*    display ' lf factor     ' life-factor
  6387*    display ' payment       ' pmt
  6388*    display ' dis pmt       ' dispmt
  6389*    display ' lifepmt1      ' lifepmt1
  6390*    display ' new pmt       ' newpmt
  6391*    display ' single factor ' single-factor
  6392*    display ' lf prem       ' dl-premium
  6393*    display ' disab prem    ' ah-premium
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 112
* WSMESS02.cbl
  6394     go to 0200-continue
  6395     .
  6396 0200-try-oh.
  6397***____________________________________________________________***
  6398**(-                                                          -)**
  6399**(-   This section is for OH, AK, KY, MA, MN, NH, NV         -)**
  6400**(-     and WA                                               -)**
  6401**(-                                                          -)**
  6402***____________________________________________________________***
  6403     if ws-rate-state <> 'OH' and 'AK' and 'KY' and 'MA' and
  6404                         'MN' and 'NH' and 'NV' and 'WA'
  6405        go to 0200-try-al
  6406     end-if
  6407     evaluate true
  6408        when ws-rate-state = 'OH' or 'AK' or 'KY' or 'NH' or
  6409                             'NV'
  6410           move 2                to plus2
  6411        when ws-rate-state = 'MN'
  6412           move 1                to plus2
  6413        when ws-rate-state = 'MA' or 'WA'
  6414           move 0                to plus2
  6415        when other
  6416           move 1                to plus2
  6417     end-evaluate
  6418     COMPUTE TEMP-VALUE-1 ROUNDED =
  6419        ((M - (A-ANGLE-N - A-ANGLE-N-M)) / I)
  6420     compute temp-value-2 rounded =
  6421        (temp-value-1 * lf-rate * (1 + (plus2 * i))) / 1000
  6422*    COMPUTE TEMP-VALUE-2 ROUNDED =
  6423*       (lf-rate / 1000) * (1 + (PLUS2 * I))
  6424     COMPUTE TEMP-VALUE-3 ROUNDED =
  6425        M * (AH-RATE / 100)
  6426     COMPUTE PMT ROUNDED = L /
  6427        (A-PRM-ANGLE-N -
  6428        TEMP-VALUE-2 - TEMP-VALUE-3)
  6429*    COMPUTE PMT ROUNDED = L /
  6430*       (A-PRM-ANGLE-N -
  6431*       (TEMP-VALUE-1 * TEMP-VALUE-2) - TEMP-VALUE-3)
  6432     if ws-lf-limit-partial-cov = 0
  6433        move pmt                 to dispmt
  6434                                    lifepmt1
  6435                                    lifepmt2
  6436                                    newpmt
  6437     end-if
  6438     .
  6439 0200-carry-on-oh.
  6440     COMPUTE DL-PREMIUM ROUNDED =
  6441        PMT * TEMP-VALUE-2
  6442*    COMPUTE DL-PREMIUM ROUNDED =
  6443*       PMT * TEMP-VALUE-1 * TEMP-VALUE-2
  6444     COMPUTE AH-PREMIUM ROUNDED =
  6445        PMT * m * (ah-rate / 100)
  6446*    COMPUTE AH-PREMIUM ROUNDED =
  6447*       PMT * TEMP-VALUE-3
  6448*    display ' plus2      ' plus2
  6449*    display ' days       ' d
  6450*    display ' anglen     ' A-ANGLE-N
  6451*    display ' anglend    ' a-prm-angle-n
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 113
* WSMESS02.cbl
  6452*    display ' gamma      ' gamma
  6453*    display ' tv1        ' temp-value-1
  6454*    display ' tv2        ' temp-value-2
  6455*    display ' tv3        ' temp-value-3
  6456*    display ' pmt        ' pmt
  6457*    display ' lf prem    ' dl-premium
  6458*    display ' ah prem    ' ah-premium
  6459     go to 0200-continue
  6460     .
  6461 0200-try-al.
  6462***____________________________________________________________***
  6463**(-                                                          -)**
  6464**(-   This section is for AL STD RATES.                      -)**
  6465**(-                                                          -)**
  6466***____________________________________________________________***
  6467     if ws-rate-state <> 'AL'
  6468        go to 0200-try-ME
  6469     end-if
  6470     COMPUTE TEMP-VALUE-1 ROUNDED =
  6471         M - (A-ANGLE-N - A-ANGLE-N-M) + (I * M)
  6472     COMPUTE TEMP-VALUE-2 ROUNDED =
  6473         TEMP-VALUE-1 / I * lf-RATE
  6474     COMPUTE TEMP-VALUE-3 ROUNDED =
  6475         M * (AH-RATE / 100)
  6476     COMPUTE pmt ROUNDED =
  6477         L /
  6478         (A-PRM-ANGLE-N - (TEMP-VALUE-2 / 1000) -
  6479         TEMP-VALUE-3)
  6480     if ws-lf-limit-partial-cov = 0
  6481        move pmt                 to dispmt
  6482                                    lifepmt1
  6483                                    lifepmt2
  6484                                    newpmt
  6485     end-if
  6486     .
  6487 0200-carry-on-al.
  6488     COMPUTE DL-PREMIUM ROUNDED =
  6489         PMT * (TEMP-VALUE-2 / 1000)
  6490     COMPUTE AH-PREMIUM ROUNDED =
  6491         PMT * TEMP-VALUE-3
  6492     go to 0200-continue
  6493     .
  6494 0200-try-ME.
  6495***____________________________________________________________***
  6496**(-                                                          -)**
  6497**(-   This section is for ME STD RATES.                      -)**
  6498**(-                                                          -)**
  6499***____________________________________________________________***
  6500     if ws-rate-state <> 'ME'
  6501        go to 0200-try-IN
  6502     end-if
  6503     COMPUTE TEMP-DISCOUNT-RATE ROUNDED =
  6504         1 / (1 + ((0.045 * N) / 24))
  6505     COMPUTE TEMP-VALUE-1 ROUNDED =
  6506         (N - A-ANGLE-N) / I
  6507     COMPUTE TEMP-VALUE-2 ROUNDED =
  6508         TEMP-VALUE-1 * (lf-rate / 1000) * TEMP-DISCOUNT-RATE
  6509     COMPUTE TEMP-VALUE-3 ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 114
* WSMESS02.cbl
  6510         (N * AH-RATE) / 100
  6511     COMPUTE PMT ROUNDED =
  6512         L / (A-PRM-ANGLE-N - TEMP-VALUE-2 - TEMP-VALUE-3)
  6513     if ws-lf-limit-partial-cov = 0
  6514        move pmt                 to dispmt
  6515                                    lifepmt1
  6516                                    lifepmt2
  6517                                    newpmt
  6518     end-if
  6519     .
  6520 0200-carry-on-me.
  6521     COMPUTE DL-PREMIUM ROUNDED =
  6522         PMT * TEMP-VALUE-2
  6523     COMPUTE AH-PREMIUM ROUNDED =
  6524         PMT * TEMP-VALUE-3
  6525     go to 0200-continue
  6526     .
  6527 0200-try-IN.
  6528***____________________________________________________________***
  6529**(-                                                          -)**
  6530**(-   This section is for IN, MT, ND, NJ, AZ, RI, VT and VA  -)**
  6531**(-                                                          -)**
  6532***____________________________________________________________***
  6533     if ws-rate-state <> 'IN' and 'MT' and 'ND' and 'NJ' and
  6534                         'AZ' and 'RI' and 'VT' and 'VA'
  6535        go to 0200-try-PA
  6536     end-if
  6537     evaluate true
  6538        when ws-rate-state = 'MT' or 'AZ' or 'RI' or 'VT'
  6539           MOVE 2                TO PLUS2
  6540        when ws-rate-state = 'IN' or 'ND' or 'VA'
  6541           MOVE 0                TO PLUS2
  6542        when ws-rate-state = 'NJ'
  6543           move 1                to plus2
  6544     end-evaluate
  6545     COMPUTE V-TO-N ROUNDED = (1 / (1 + I)) ** N
  6546
  6547     COMPUTE TEMP-DISCOUNT-RATE ROUNDED =
  6548         ws-DISCOUNT-RATE * 12 / PPY
  6549     COMPUTE X ROUNDED = 1 / (1 + TEMP-DISCOUNT-RATE)
  6550     COMPUTE X-TO-N ROUNDED = X ** N
  6551     COMPUTE TEMP-VALUE-1 ROUNDED =
  6552         (X-TO-N - V-TO-N) / ((X * (1 + I)) - 1)
  6553     COMPUTE TEMP-VALUE-2 ROUNDED =
  6554         (X-TO-N - 1) / (X - 1)
  6555     COMPUTE TEMP-VALUE-4 ROUNDED =
  6556         TEMP-VALUE-2 - TEMP-VALUE-1
  6557     COMPUTE TEMP-VALUE-5 ROUNDED =
  6558         1 + ((PLUS2 * PPY / 12) * I)
  6559     COMPUTE LIFE-FACTOR ROUNDED =
  6560         (TEMP-VALUE-5 / I) * TEMP-VALUE-4 *
  6561         (lf-rate / 1000)
  6562     COMPUTE TEMP-VALUE-3 ROUNDED =
  6563         (N * AH-RATE) / 100
  6564     COMPUTE SINGLE-FACTOR ROUNDED =
  6565         (LIFE-FACTOR * 100) / (A-ANGLE-N * TEMP-VALUE-5)
  6566     COMPUTE PMT ROUNDED =
  6567         L / (A-PRM-ANGLE-N - LIFE-FACTOR - TEMP-VALUE-3)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 115
* WSMESS02.cbl
  6568     if ws-lf-limit-partial-cov = 0
  6569        move pmt                 to dispmt
  6570                                    lifepmt1
  6571                                    lifepmt2
  6572                                    newpmt
  6573     end-if
  6574     .
  6575 0200-carry-on-in.
  6576     COMPUTE DL-PREMIUM ROUNDED =
  6577         SINGLE-FACTOR *
  6578         ((PMT * A-ANGLE-N * TEMP-VALUE-5) / 100)
  6579     COMPUTE AH-PREMIUM ROUNDED =
  6580         PMT * TEMP-VALUE-3
  6581     go to 0200-continue
  6582     .
  6583 0200-try-PA.
  6584***____________________________________________________________***
  6585**(-                                                          -)**
  6586**(-   This section is for PA.                                -)**
  6587**(-                                                          -)**
  6588***____________________________________________________________***
  6589     if ws-rate-state <> 'PA'
  6590        go to 0200-try-all-other
  6591     end-if
  6592     evaluate true
  6593        when ws-rate-state = 'PA'
  6594           MOVE 0                TO PLUS2
  6595        when other
  6596           move 1                to plus2
  6597     end-evaluate
  6598     COMPUTE TEMP-VALUE-1 ROUNDED =
  6599         1 + (ws-DISCOUNT-RATE * (M / 24))
  6600     COMPUTE TEMP-VALUE-2 ROUNDED =
  6601         1 / (10 * TEMP-VALUE-1)
  6602     COMPUTE TEMP-VALUE-3 ROUNDED =
  6603         (M * AH-RATE) / 100
  6604     COMPUTE TEMP-VALUE-4 ROUNDED =
  6605         (M - (A-ANGLE-N - A-ANGLE-N-M)) / I
  6606     COMPUTE TEMP-VALUE-5 ROUNDED =
  6607         (lf-rate / 100) * (1 + (PLUS2 * ws-rate-apr / 12))
  6608     COMPUTE TEMP-VALUE-6 ROUNDED =
  6609         TEMP-VALUE-4 * TEMP-VALUE-2 * TEMP-VALUE-5
  6610     COMPUTE PMT ROUNDED =
  6611         L / (A-PRM-ANGLE-N - TEMP-VALUE-6 - TEMP-VALUE-3)
  6612     if ws-lf-limit-partial-cov = 0
  6613        move pmt                 to dispmt
  6614                                    lifepmt1
  6615                                    lifepmt2
  6616                                    newpmt
  6617     end-if
  6618     .
  6619 0200-carry-on-PA.
  6620     COMPUTE DL-PREMIUM ROUNDED =
  6621         PMT * TEMP-VALUE-6
  6622     COMPUTE AH-PREMIUM ROUNDED =
  6623         PMT * TEMP-VALUE-3
  6624     go to 0200-continue
  6625     .
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 116
* WSMESS02.cbl
  6626 0200-try-all-other.
  6627***____________________________________________________________***
  6628**(-                                                          -)**
  6629**(-   This works for all states other than listed above      -)**
  6630**(-  Haven't figured out all the states' extra months        -)**
  6631**(-  interest yet.                                           -)**
  6632**(-                                                          -)**
  6633***____________________________________________________________***
  6634     evaluate true
  6635        when ws-rate-state = 'SC'
  6636           move 1                to plus2
  6637        when other
  6638           move 2                to plus2
  6639     end-evaluate
  6640     COMPUTE TEMP-VALUE-3 ROUNDED =
  6641        M + ((D - DPP) / DPP)
  6642***____________________________________________________________***
  6643**(-                                                          -)**
  6644**(-      OK, the below formula works in conjunction with     -)**
  6645**(-    other than 30 days to first payment. Since Logic      -)**
  6646**(-    gives me the actual rate, I have to convert it to the -)**
  6647**(-   annual rate so it works just like QC.                  -)**
  6648**(-                                                          -)**
  6649**(-                                                          -)**
  6650***____________________________________________________________***
  6651     compute mnthly-rate rounded = lf-rate / m
  6652     compute mob rounded = mnthly-rate * 12
  6653     compute mob rounded = lf-rate / (m / 12)
  6654*    compute mob rounded =
  6655*       (lf-rate / (m + (ppy/12))) * 2
  6656     COMPUTE MOB ROUNDED =
  6657        (mob *
  6658        (TEMP-VALUE-3 / PPY)) / ((M + (PPY / 12)) / 2)
  6659     COMPUTE TEMP-VALUE-1 ROUNDED =
  6660         (M - (A-ANGLE-N - A-ANGLE-N-M)) / I
  6661     COMPUTE TEMP-VALUE-2 ROUNDED =
  6662         1 + (PLUS2 * I * (PPY / 12))
  6663*    display ' L         ' l
  6664*    display ' anglen       ' a-angle-n
  6665*    display ' days(d)      ' d
  6666*    display ' gamma        ' gamma
  6667*    display ' tv3          ' temp-value-3
  6668*    display 'a-prm-angle-n ' a-prm-angle-n
  6669*    display ' tv1          ' temp-value-1
  6670*    display ' mob          ' mob
  6671*    display ' tv2          ' temp-value-2
  6672*    display ' ah rate      ' ah-rate
  6673*    display ' m            ' m
  6674     COMPUTE pmt ROUNDED =
  6675         L / (A-PRM-ANGLE-N - (TEMP-VALUE-1 * (MOB / 100) *
  6676         TEMP-VALUE-2) - ((ah-rate * M) / 100))
  6677     .
  6678 0200-check-partial.
  6679     if ws-lf-limit-partial-cov = 0
  6680        move pmt                 to dispmt
  6681                                    lifepmt1
  6682                                    lifepmt2
  6683                                    newpmt
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 117
* WSMESS02.cbl
  6684        go to 0200-carry-on-all-other
  6685     end-if
  6686     if pmt < ws-di-limit-max-mo-ben
  6687        move pmt                 to dispmt
  6688     else
  6689        move ws-di-limit-max-mo-ben
  6690                                 to dispmt
  6691     end-if
  6692     if (ws-di-limit-max-tot-ben / m) < dispmt
  6693        compute dispmt rounded =
  6694           (ws-di-limit-max-tot-ben / m) - .005
  6695     end-if
  6696     compute lifepmt1 rounded =
  6697        (l + pmt * temp-value-1 * mob / 100 * temp-value-2 +
  6698        dispmt * (ah-rate * m) / 100) / a-prm-angle-n
  6699     if (ws-lf-limit-max-benefit / a-prm-angle-n) < lifepmt1
  6700        compute lifepmt1 rounded =
  6701           ws-lf-limit-max-benefit / a-prm-angle-n
  6702        move ws-lf-limit-max-benefit
  6703                                 to ws-max-lf-benefit
  6704     end-if
  6705     compute newpmt rounded =
  6706        (l +lifepmt1 * temp-value-1 * mob / 100 * temp-value-2 +
  6707        dispmt * (ah-rate * m) / 100) / a-prm-angle-n
  6708     .
  6709 0200-carry-on-all-other.
  6710     COMPUTE DL-PREMIUM ROUNDED = lifepmt1 *
  6711         TEMP-VALUE-1 * (MOB / 100) * TEMP-VALUE-2
  6712     COMPUTE AH-PREMIUM ROUNDED =
  6713         disPmt * M * (AH-RATE / 100)
  6714     move pmt                    to ws-rate-per-pmt
  6715     move dl-premium             to ws-rate-lf-prem
  6716     move ah-premium             to ws-rate-ah-prem
  6717     move t-financed             to ws-rate-tot-financed
  6718     move t-payments             to ws-rate-tot-pmts
  6719     .
  6720 0200-continue.
  6721     COMPUTE T-FINANCED =
  6722         L + DL-PREMIUM + AH-PREMIUM
  6723     COMPUTE T-PAYMENTS = N * newPmt
  6724     if ws-max-lf-benefit = zeros
  6725        move t-financed          to ws-max-lf-benefit
  6726     end-if
  6727     move newpmt                 to ws-rate-per-pmt
  6728     move dispmt                 to ws-max-ah-benefit
  6729     move dl-premium             to ws-rate-lf-prem
  6730     move ah-premium             to ws-rate-ah-prem
  6731     move t-financed             to ws-rate-tot-financed
  6732     move t-payments             to ws-rate-tot-pmts
  6733*    display ' new pmt       ' newpmt
  6734*    display ' dis pmt       ' dispmt
  6735*    display ' lifepmt1      ' lifepmt1
  6736*    display ' lf-rate       ' lf-rate
  6737*    display ' ah-rate       ' ah-rate
  6738*    display ' payment       ' pmt
  6739*    display ' lf prem       ' ws-rate-lf-prem
  6740*    display ' ah prem       ' ws-rate-ah-prem
  6741*    display ' tot financed  ' ws-rate-tot-financed
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 118
* WSMESS02.cbl
  6742*    display ' tot payments  ' ws-rate-tot-pmts
  6743     .
  6744 0200-exit.
  6745     exit.
  6746 0250-calc-GP-payment.
  6747*  States with special coding in quick-calc for Gross Pay
  6748*   AZ
  6749*   IN
  6750*   MT
  6751*   ND
  6752*   NJ
  6753*   PA
  6754***____________________________________________________________***
  6755**(-                                                          -)**
  6756**(-   Right now this should work for all states other than   -)**
  6757**(-    those listed above.                                   -)**
  6758**(-                                                          -)**
  6759***____________________________________________________________***
  6760     move ws-rate-loan-amt       to l
  6761     move ws-rate-loan-term      to n
  6762     move ws-rate-lf-term        to m
  6763     if m = zeros
  6764        move ws-rate-ah-term     to m
  6765     end-if
  6766     move ws-rate-pmts-per-year  to ppy
  6767     move 30                     to dpp
  6768     compute i = ws-rate-apr / (ppy * 100)
  6769     if i = 0
  6770        move n                   to a-angle-n
  6771     else
  6772        COMPUTE A-ANGLE-N ROUNDED =
  6773           (1 - ((1 / (1 + I)) ** N)) / I
  6774     end-if
  6775     COMPUTE GAMMA ROUNDED =
  6776         (1 + ((D * I) / DPP)) / (1 + I)
  6777     COMPUTE A-PRM-ANGLE-N ROUNDED =
  6778        A-ANGLE-N / GAMMA
  6779     compute ws-rate-loan-pmt rounded =
  6780        l / a-prm-angle-n
  6781     COMPUTE TEMP-VALUE-1 ROUNDED =
  6782        (N + ((D - DPP) / DPP)) / PPY
  6783     compute mnthly-rate rounded = lf-rate / n
  6784     compute mob rounded = mnthly-rate * 12
  6785*    compute mob rounded =
  6786*       (lf-rate / n * 12)
  6787     COMPUTE TEMP-VALUE-2 ROUNDED = A-PRM-ANGLE-N -
  6788        ((N * TEMP-VALUE-1 *
  6789        (mob / 100)) +
  6790        (N * (aH-RATE / 100)))
  6791     COMPUTE pmt ROUNDED = L / TEMP-VALUE-2
  6792*    display ' anglen ' a-angle-n
  6793*    display ' gamma  ' gamma
  6794*    display ' prm anglen ' a-prm-angle-n
  6795*    display ' tv1        ' temp-value-1
  6796*    display ' mob        ' mob
  6797*    display ' tv2        ' temp-value-2
  6798*    display ' pmt        ' pmt
  6799     .
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 119
* WSMESS02.cbl
  6800 0250-check-for-partial.
  6801     if ws-lf-limit-partial-cov = 0
  6802        move pmt                 to dispmt
  6803                                    lifepmt1
  6804                                    lifepmt2
  6805                                    newpmt
  6806        go to 0250-carry-on
  6807     end-if
  6808     if pmt < ws-di-limit-max-mo-ben
  6809        move pmt                 to dispmt
  6810     else
  6811        move ws-di-limit-max-mo-ben
  6812                                 to dispmt
  6813     end-if
  6814     if (ws-di-limit-max-tot-ben / n) < dispmt
  6815        compute dispmt rounded =
  6816           (ws-di-limit-max-tot-ben / n) - .005
  6817     end-if
  6818     compute lifepmt1 rounded =
  6819        (l + (pmt * n * (n + (d - dpp) / dpp) / ppy * mob /
  6820           100) + dispmt * (n * ah-rate / 100)) / A-PRM-ANGLE-N
  6821     if (ws-lf-limit-max-benefit / n) < lifepmt1
  6822        compute lifepmt1 rounded =
  6823           ws-lf-limit-max-benefit / n
  6824        move ws-lf-limit-max-benefit
  6825                                 to ws-max-lf-benefit
  6826     end-if
  6827     compute newpmt rounded =
  6828        (l + (lifepmt1 * n * (n + (d - dpp) / dpp) / ppy *
  6829           mob / 100) + dispmt * (n * ah-rate / 100)) /
  6830           A-PRM-ANGLE-N
  6831     .
  6832 0250-carry-on.
  6833     COMPUTE DL-PREMIUM ROUNDED =
  6834        lifepmt1 * N * TEMP-VALUE-1 *
  6835        (mob / 100)
  6836     COMPUTE AH-PREMIUM ROUNDED =
  6837        dispmt * m * (AH-RATE / 100)
  6838*    display ' L         ' l
  6839*    display ' anglen       ' a-angle-n
  6840*    display ' days(d)      ' d
  6841*    display ' gamma        ' gamma
  6842*    display 'a-prm-angle-n ' a-prm-angle-n
  6843*    display ' tv1          ' temp-value-1
  6844*    display ' mob          ' mob
  6845*    display ' tv2          ' temp-value-2
  6846*    display ' ah rate      ' ah-rate
  6847*    display ' m            ' m
  6848     COMPUTE T-FINANCED =
  6849         L + DL-PREMIUM + AH-PREMIUM
  6850     COMPUTE T-PAYMENTS = N * newPmt
  6851     if i = 0
  6852        move t-financed          to t-payments
  6853     end-if
  6854     if ws-max-lf-benefit = zeros
  6855        move t-payments          to ws-max-lf-benefit
  6856     end-if
  6857     move newpmt                 to ws-rate-per-pmt
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 120
* WSMESS02.cbl
  6858     move dispmt                 to ws-max-ah-benefit
  6859     move dl-premium             to ws-rate-lf-prem
  6860     move ah-premium             to ws-rate-ah-prem
  6861     move t-financed             to ws-rate-tot-financed
  6862     move t-payments             to ws-rate-tot-pmts
  6863*    display ' lf-rate       ' lf-rate
  6864*    display ' ah-rate       ' ah-rate
  6865*    display ' payment       ' pmt
  6866*    display ' dis pmt       ' dispmt
  6867*    display ' lifepmt1      ' lifepmt1
  6868*    display ' new pmt       ' newpmt
  6869*    display ' lf prem       ' ws-rate-lf-prem
  6870*    display ' ah prem       ' ws-rate-ah-prem
  6871*    display ' tot financed  ' ws-rate-tot-financed
  6872*    display ' tot payments  ' ws-rate-tot-pmts
  6873     go to 0250-exit
  6874     .
  6875 xxxx-code-that-works.  *>!!!!!!
  6876***____________________________________________________________***
  6877**(-                                                          -)**
  6878**(-   Right now this should work for all states other than   -)**
  6879**(-    listed above. Below worked prior to adding partial    -)**
  6880**(-    coverage stuff.                                       -)**
  6881***____________________________________________________________***
  6882     move ws-rate-loan-amt       to l
  6883     move ws-rate-loan-term      to n
  6884     move ws-rate-lf-term        to m
  6885     move ws-rate-pmts-per-year  to ppy
  6886     move 30                     to dpp
  6887     compute i = ws-rate-apr / (ppy * 100)
  6888     if i = 0
  6889        move n                   to a-angle-n
  6890     else
  6891        COMPUTE A-ANGLE-N ROUNDED =
  6892           (1 - ((1 / (1 + I)) ** N)) / I
  6893     end-if
  6894     if i = 0
  6895        compute a-angle-n-m = n - m
  6896     else
  6897        COMPUTE A-ANGLE-N-M ROUNDED =
  6898           (1 - ((1 / (1 + I)) ** (N - M))) / I
  6899     end-if
  6900     COMPUTE GAMMA ROUNDED =
  6901         (1 + ((D * I) / DPP)) / (1 + I)
  6902     COMPUTE A-PRM-ANGLE-N ROUNDED =
  6903        A-ANGLE-N / GAMMA
  6904     COMPUTE TEMP-VALUE-1 ROUNDED =
  6905        (N + ((D - DPP) / DPP)) / PPY
  6906     compute mob rounded =
  6907        (lf-rate / n * 12)
  6908     COMPUTE TEMP-VALUE-2 ROUNDED = A-PRM-ANGLE-N -
  6909        ((N * TEMP-VALUE-1 *
  6910        (mob / 100)) +
  6911        (N * (aH-RATE / 100)))
  6912     COMPUTE pmt ROUNDED = L / TEMP-VALUE-2
  6913     COMPUTE DL-PREMIUM ROUNDED =
  6914        pmt * N * TEMP-VALUE-1 *
  6915        (mob / 100)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 121
* WSMESS02.cbl
  6916     COMPUTE AH-PREMIUM ROUNDED =
  6917        pmt * N * (AH-RATE / 100)
  6918*    display ' L         ' l
  6919*    display ' anglen       ' a-angle-n
  6920*    display ' days(d)      ' d
  6921*    display ' gamma        ' gamma
  6922*    display 'a-prm-angle-n ' a-prm-angle-n
  6923*    display ' tv1          ' temp-value-1
  6924*    display ' mob          ' mob
  6925*    display ' tv2          ' temp-value-2
  6926*    display ' ah rate      ' ah-rate
  6927*    display ' m            ' m
  6928     COMPUTE T-FINANCED =
  6929         L + DL-PREMIUM + AH-PREMIUM
  6930     COMPUTE T-PAYMENTS = N * Pmt
  6931     move pmt                    to ws-rate-per-pmt
  6932     move dl-premium             to ws-rate-lf-prem
  6933     move ah-premium             to ws-rate-ah-prem
  6934     move t-financed             to ws-rate-tot-financed
  6935     move t-payments             to ws-rate-tot-pmts
  6936*    display ' lf-rate       ' lf-rate
  6937*    display ' ah-rate       ' ah-rate
  6938*    display ' payment       ' pmt
  6939*    display ' lf prem       ' ws-rate-lf-prem
  6940*    display ' ah prem       ' ws-rate-ah-prem
  6941*    display ' tot financed  ' ws-rate-tot-financed
  6942*    display ' tot payments  ' ws-rate-tot-pmts
  6943     .
  6944 0250-exit.
  6945     exit.
  6946 0300-RETURN-CICS.
  6947     perform 0400-disconnect     thru 0400-exit
  6948     move ws-return-string       to dfhcommarea
  6949
  6950* exec cics return end-exec
  6951*    MOVE '.(                    ''   #00006786' TO DFHEIV0
  6952     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6953     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6954     MOVE X'2020233030303036373836' TO DFHEIV0(25:11)
  6955     CALL 'kxdfhei1' USING DFHEIV0,
  6956           DFHEIV99,
  6957           DFHEIV99,
  6958           DFHEIV99,
  6959           DFHEIV99,
  6960           DFHEIV99,
  6961           DFHEIV99
  6962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6963
  6964* goback
  6965
  6966     MOVE '9%                    "   ' TO DFHEIV0
  6967     MOVE 'WSMESS02' TO DFHEIV1
  6968     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6969     goback
  6970     .
  6971 0300-exit.
  6972     exit.
  6973 0400-disconnect.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 122
* WSMESS02.cbl
  6974     if connected-to-db
  6975        EXEC SQL
  6976            disconnect all
  6977        END-EXEC
  6978        move ' ' to ws-connect-sw
  6979     end-if
  6980     .
  6981 0400-exit.
  6982     exit.
  6983 6000-CONNECT-TO-DB.
  6984***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  6985***                                                            ***
  6986***                                                            ***
  6987***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  6988     evaluate true
  6989        when ws-kix-myenv = 'cid1p'
  6990           MOVE 'NTCSO2_CrtManage'
  6991                                 TO SVR
  6992           move 'sa'             to usr
  6993           move 'ntcso2'         to pass
  6994        when ws-kix-myenv = 'mdoff'
  6995           MOVE 'NTSQLTST2UAT_CrtManage'
  6996                                 TO SVR
  6997           move 'sa'             to usr
  6998           move 'sql2008r2'      to pass
  6999        when other
  7000           MOVE 'NTSQLTST2_CrtManage'
  7001                                 TO SVR
  7002           move 'sa'             to usr
  7003           move 'sql2008r2'      to pass
  7004     end-evaluate
  7005     string
  7006         usr delimited space
  7007         "." delimited size
  7008         pass delimited space into usr-pass
  7009     end-string
  7010     EXEC SQL
  7011        CONNECT TO :svr USER :usr-pass
  7012     END-EXEC
  7013     if sqlcode not = 0
  7014        display "Error: cannot connect to " svr
  7015        display sqlcode
  7016        display sqlerrmc
  7017     else
  7018        display ' Successful Connect ' sqlcode
  7019        set connected-to-db to true
  7020     end-if
  7021     .
  7022 6000-EXIT.
  7023     EXIT.
  7024 7000-GET-RATE.
  7025     move all '9'                to errate-key
  7026     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD
  7027     MOVE CP-STATE               TO RATE-ST-CODE
  7028     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS
  7029     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV
  7030     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE
  7031     IF CP-RATING-BENEFIT-AMT NOT NUMERIC OR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 123
* WSMESS02.cbl
  7032        CP-RATING-BENEFIT-AMT = ZEROS
  7033        MOVE CP-ORIGINAL-BENEFIT TO RATE-HIGH-AMT
  7034     ELSE
  7035        MOVE CP-RATING-BENEFIT-AMT
  7036                                 TO RATE-HIGH-AMT
  7037     end-if
  7038     IF CP-AH
  7039         MOVE CP-AH-OVERRIDE-CODE
  7040                                 TO RATE-L-AH
  7041     ELSE
  7042         MOVE CP-LIFE-OVERRIDE-CODE
  7043                                 TO RATE-L-AH
  7044     end-if
  7045     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM
  7046     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  7047     MOVE SPACE                  TO DC-OPTION-CODE
  7048     PERFORM 9700-date-link      thru 9700-exit
  7049     IF NO-CONVERSION-ERROR
  7050        move errate-key          to save-errate-key
  7051        MOVE dc-greg-date-cymd   TO RATE-EXPIRY-DATE
  7052                                    svrt-expiry-date
  7053     ELSE
  7054        MOVE '2'                 TO CP-RETURN-CODE
  7055        GO TO 7000-exit
  7056     END-IF
  7057
  7058* EXEC CICS STARTBR
  7059*       DATASET  ('ERRATE')
  7060*       RIDFLD   (ERRATE-KEY)
  7061*       RESP     (ws-response)
  7062*       GTEQ
  7063*    END-EXEC
  7064     MOVE 'ERRATE' TO DFHEIV1
  7065     MOVE 0
  7066       TO DFHEIV11
  7067*    MOVE '&,         G          &  N#00006875' TO DFHEIV0
  7068     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7069     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7070     MOVE X'204E233030303036383735' TO DFHEIV0(25:11)
  7071     CALL 'kxdfhei1' USING DFHEIV0,
  7072           DFHEIV1,
  7073           ERRATE-KEY,
  7074           DFHEIV99,
  7075           DFHEIV11,
  7076           DFHEIV99
  7077     MOVE EIBRESP  TO ws-response
  7078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7079     if not resp-normal
  7080        move '6'                 to cp-return-code
  7081        go to 7000-exit
  7082     end-if
  7083     .
  7084 7000-read-loop.
  7085
  7086* EXEC CICS READNEXT
  7087*       DATASET  ('ERRATE')
  7088*       into     (RATE-RECORD)
  7089*       RESP     (ws-response)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 124
* WSMESS02.cbl
  7090*       RIDFLD   (ERRATE-KEY)
  7091*    END-EXEC
  7092     MOVE LENGTH OF
  7093      RATE-RECORD
  7094       TO DFHEIV12
  7095     MOVE 'ERRATE' TO DFHEIV1
  7096     MOVE 0
  7097       TO DFHEIV11
  7098*    MOVE '&.IL                  )  N#00006887' TO DFHEIV0
  7099     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7100     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7101     MOVE X'204E233030303036383837' TO DFHEIV0(25:11)
  7102     CALL 'kxdfhei1' USING DFHEIV0,
  7103           DFHEIV1,
  7104           RATE-RECORD,
  7105           DFHEIV12,
  7106           ERRATE-KEY,
  7107           DFHEIV99,
  7108           DFHEIV11,
  7109           DFHEIV99,
  7110           DFHEIV99
  7111     MOVE EIBRESP  TO ws-response
  7112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7113     if not resp-normal
  7114        move '6'                 to cp-return-code
  7115        go to 7000-done
  7116     end-if
  7117     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  7118        SVRT-ST-CODE    = RT-ST-CODE     AND
  7119        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  7120        SVRT-ST-DEV     = RT-ST-DEV      AND
  7121        SVRT-L-AH       = RT-L-AH        AND
  7122        SVRT-LAH-NUM    = RT-LAH-NUM
  7123        continue
  7124     ELSE
  7125        move '6'                 to cp-return-code
  7126        go to 7000-done
  7127     end-if
  7128     IF SVRT-HIGH-AGE > RT-HIGH-AGE
  7129        move '6'                 to cp-return-code
  7130        go to 7000-done
  7131     end-if
  7132     IF SVRT-HIGH-AMT >= RT-HIGH-AMT
  7133        GO TO 7000-read-loop
  7134     end-if
  7135     IF SVRT-EXPIRY-DATE > RT-EXPIRY-DATE
  7136        GO TO 7000-read-loop
  7137     end-if
  7138     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  7139        GO TO 7000-read-loop
  7140     end-if
  7141     .
  7142 7000-done.
  7143
  7144* EXEC CICS ENDBR
  7145*       DATASET  ('ERRATE')
  7146*    END-EXEC
  7147     MOVE 'ERRATE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:06 Page 125
* WSMESS02.cbl
  7148     MOVE 0
  7149       TO DFHEIV11
  7150*    MOVE '&2                    $   #00006923' TO DFHEIV0
  7151     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7152     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7153     MOVE X'2020233030303036393233' TO DFHEIV0(25:11)
  7154     CALL 'kxdfhei1' USING DFHEIV0,
  7155           DFHEIV1,
  7156           DFHEIV11,
  7157           DFHEIV99
  7158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7159     .
  7160 7000-EXIT.
  7161     EXIT.
  7162 9700-DATE-LINK.
  7163
  7164* EXEC CICS LINK
  7165*         PROGRAM  ('ELDATCV')
  7166*         COMMAREA (DATE-CONVERSION-DATA)
  7167*         LENGTH   (DC-COMM-LENGTH)
  7168*    END-EXEC.
  7169     MOVE 'ELDATCV' TO DFHEIV1
  7170*    MOVE '."C                   (   #00006930' TO DFHEIV0
  7171     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7173     MOVE X'2020233030303036393330' TO DFHEIV0(25:11)
  7174     CALL 'kxdfhei1' USING DFHEIV0,
  7175           DFHEIV1,
  7176           DATE-CONVERSION-DATA,
  7177           DC-COMM-LENGTH,
  7178           DFHEIV99,
  7179           DFHEIV99,
  7180           DFHEIV99,
  7181           DFHEIV99
  7182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7183
  7184 9700-EXIT.
  7185      EXIT.
  7186
  7187 9999-DFHBACK SECTION.
  7188     MOVE '9%                    "   ' TO DFHEIV0
  7189     MOVE 'WSMESS02' TO DFHEIV1
  7190     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7191     GOBACK.
  7192 9999-DFHEXIT.
  7193     IF DFHEIGDJ EQUAL 0001
  7194         NEXT SENTENCE.
  7195     MOVE '9%                    "   ' TO DFHEIV0
  7196     MOVE 'WSMESS02' TO DFHEIV1
  7197     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7198     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      150892     Code:       31118
