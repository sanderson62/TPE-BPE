* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48* 021418  CR2017110200001  TANA  EDIT NAME CHANGE AGST INSRD TYPE
    49* 052918  CR2018031500002  TANA  Add Message for filing time limit
    50* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    51* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    52* 011020  IR2019121100004  PEMA  ADD last name to compare.
    53* 071720  CR2019112600001  TANA  Remove filing time limit error
    54* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    55******************************************************************
    56
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   3
* EL131.cbl
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
    61
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER  PIC X(32)  VALUE '********************************'.
    66 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    67 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    68 77  s1                          pic s999 comp-3 value+0.
    69 77  s2                          pic s999 comp-3 value+0.
    70 77  a1                          pic s999 comp-3 value+0.
    71 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    72 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    73 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    74 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    75 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    76 77  ws-max-extension            pic s999 comp-3 value +0.
    77 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    78 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    79 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    80     88  ERPDEF-FOUND                 VALUE 'Y'.
    81 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    82     88  TRLR-FILE-EOF                VALUE 'Y'.
    83 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    84     88  PAYMENT-PENDING              VALUE 'Y'.
    85 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    86     88  AUTH-RCVD                    VALUE 'Y'.
    87     88  NO-AUTH-RCVD                 VALUE 'N'.
    88 77  ws-eracct-sw                pic x  value ' '.
    89     88  acct-found                value 'Y'.
    90 77  ws-benper-sw                pic x   value ' '.
    91     88  good-benper               value 'Y'.
    92 77  ws-claim-type               pic x value ' '.
    93 77  ws-ben-per                  pic 99 value 00.
    94 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    95 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    96 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    97 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    98
    99 01  LCP-TIME-OF-DAY-XX.
   100     05  LCP-TIME-OF-DAY-68        PIC 9(6).
   101     05  FILLER                    PIC 99.
   102 01  LCP-CICS-TIME                 PIC 9(15).
   103*                            COPY ELCSCTM.
   104******************************************************************
   105*                                                                *
   106*                                                                *
   107*                            ELCSCTM                             *
   108*                            VMOD=2.001                          *
   109*                                                                *
   110*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   111*                                                                *
   112******************************************************************
   113 01  SECURITY-MESSAGE.
   114     12  FILLER                          PIC X(30)
   115            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   4
* EL131.cbl
   116     12  SM-READ                         PIC X(6).
   117     12  FILLER                          PIC X(5)
   118            VALUE ' PGM='.
   119     12  SM-PGM                          PIC X(6).
   120     12  FILLER                          PIC X(5)
   121            VALUE ' OPR='.
   122     12  SM-PROCESSOR-ID                 PIC X(4).
   123     12  FILLER                          PIC X(6)
   124            VALUE ' TERM='.
   125     12  SM-TERMID                       PIC X(4).
   126     12  FILLER                          PIC XX   VALUE SPACE.
   127     12  SM-JUL-DATE                     PIC 9(5).
   128     12  FILLER                          PIC X    VALUE SPACE.
   129     12  SM-TIME                         PIC 99.99.
   130
   131
   132*                            COPY ELCSCRTY.
   133******************************************************************
   134*                                                                *
   135*                                                                *
   136*                            ELCSCRTY                            *
   137*                            VMOD=2.001                          *
   138*                                                                *
   139*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   140*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   141*        SAVED IN PI-SECURITY-ADDRESS.                           *
   142*                                                                *
   143******************************************************************
   144 01  SECURITY-CONTROL.
   145     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   146     12  FILLER                       PIC XX    VALUE 'SC'.
   147     12  SC-CREDIT-CODES.
   148         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   149             20  SC-CREDIT-DISPLAY    PIC X.
   150             20  SC-CREDIT-UPDATE     PIC X.
   151     12  SC-CLAIMS-CODES.
   152         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   153             20  SC-CLAIMS-DISPLAY    PIC X.
   154             20  SC-CLAIMS-UPDATE     PIC X.
   155
   156*                            COPY ELCNWA.
   157*****************************************************************
   158*                                                               *
   159*                                                               *
   160*                            ELCNWA.                            *
   161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   162*                            VMOD=2.003                         *
   163*                                                               *
   164*            M O V E   N A M E   W O R K   A R E A.             *
   165*                                                               *
   166*****************************************************************.
   167
   168 01  WS-NAME-WORK-AREA.
   169     05  WS-INSURED-LAST-NAME        PIC X(15).
   170     05  WS-INSURED-1ST-NAME         PIC X(12).
   171     05  WS-INSURED-MID-INIT         PIC X.
   172
   173     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   5
* EL131.cbl
   174         10  WS-NW                   PIC X
   175             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   176
   177     05  WS-NAME-WORK2.
   178         10  WS-NW2                  PIC X
   179             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   180                                        NWA-INDEX0.
   181
   182     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   183                                     COMP-3.
   184
   185
   186 01  ws-dcc-error-line.
   187     05  filler occurs 15.
   188         10  ws-error-no        pic x(4).
   189 01  WS-DATE-AREA.
   190     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   191     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   192     12  SAVE-DATE-CCYYMMDD.
   193         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   194         16  SAVE-DATE-YMD.
   195             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   196             20  FILLER         PIC X(4)    VALUE SPACES.
   197
   198 01  WS-BLANK                   PIC X       VALUE ' '.
   199
   200 01  CSO-WORK-FIELDS.
   201     05  WS-HOLD-CLAIM-STATUS    PIC X.
   202     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   203     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   204         10  WS-RECURRENT-YN     PIC X.
   205         10  FILLER              PIC X.
   206
   207 01  LITERALS-NUMBERS.
   208     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   209     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   210     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   211     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   212     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   213     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   214     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   215     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   216
   217     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   218     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   219     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   220     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   221     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   222     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   223     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   224     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   225     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   226     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   227
   228     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   229
   230     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   231
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   6
* EL131.cbl
   232     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   233     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   234     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   235     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   236     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   237     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   238     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   239     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   240     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   241     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   242     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   243     12  WS-CONTEST-NOTE      PIC X(44)
   244         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   245     12  WS-FILE-LIM-NOTE     PIC X(44)
   246         VALUE 'FILING TIME LIMIT OK - INCRD DT CHGD'.
   247
   248     12  WS-FILING-NOTE     PIC X(30)
   249         VALUE 'FILING TIME LIMIT EXCEEDED'.
   250
   251     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   252     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   253     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   254     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   255         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   256     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   257     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   258     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   259     12  WS-ICD-CODE-1           PIC X(8).
   260     12  WS-ICD-CODE-2           PIC X(8).
   261     12  WS-CLAIM-SEQU.
   262         16  FILLER              PIC X VALUE '('.
   263         16  WS-CURRENT-SEQU     PIC Z9.
   264         16  FILLER              PIC X(04) VALUE ' OF '.
   265         16  WS-OF-SEQU          PIC Z9.
   266         16  FILLER              PIC X VALUE ')'.
   267     12  WS-EDIT-BEN-CODE        PIC XX.
   268         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   269                                          '90' THRU '99'.
   270
   271     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   272     12  WS-EDIT-NUMBER          PIC ZZZ9.
   273
   274     12  WS-RESPONSE             PIC S9(8)   COMP.
   275         88  WS-RESP-NORMAL              VALUE +00.
   276         88  WS-RESP-ERROR               VALUE +01.
   277         88  WS-RESP-NOTFND              VALUE +13.
   278         88  WS-RESP-DUPKEY              VALUE +15.
   279         88  WS-RESP-NOTOPEN             VALUE +19.
   280         88  WS-RESP-ENDFILE             VALUE +20.
   281
   282     12  WS-MOS-PAID             PIC 999.
   283     12  WS-ODD-DAYS             PIC 99.
   284     12  WS-REM-MOS              PIC 999.
   285     12  WS-REM-DAYS             PIC 99.
   286     12  WS-TERM-IN-DAYS         PIC 9(4).
   287     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   288
   289     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   7
* EL131.cbl
   290     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   291     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   292     12  WS-RESET-SW             PIC X       VALUE 'N'.
   293     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   294     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   295     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   296
   297 01  DMD-DATE-YYYYMMDD.
   298     12  DMD-DECADE          PIC XX      VALUE SPACES.
   299     12  DMD-YYMMDD.
   300         16  DMD-YY          PIC XX      VALUE SPACES.
   301         16  DMD-MM          PIC XX      VALUE SPACES.
   302         16  DMD-DD          PIC XX      VALUE SPACES.
   303
   304 01  DMD-DATE-MMDDYYYY.
   305     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   306     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   307     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   308     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   309     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   310     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   311
   312 01  WS-MAIL-CODE.
   313     12  FILLER              PIC X.
   314     12  DMD-MAIL-CODE.
   315         16  WS-MAIL-4       PIC X(4).
   316         16  WS-MAIL-5       PIC X.
   317     12  FILLER              PIC X(4).
   318
   319     12  W-NAME-LAST             PIC  X(15).
   320     12  W-NAME-FIRST            PIC  X(15).
   321     12  W-NAME-MIDDLE.
   322         16  FILLER              PIC  X.
   323         16  W-NAME-MIDDLE-2     PIC  X.
   324         16  FILLER              PIC  X(13).
   325
   326*    COPY ELCDCTB.
   327******************************************************************
   328*                                                                *
   329*                                                                *
   330*                            ELCDCTB.                            *
   331*                            VMOD=2.002                          *
   332*                                                                *
   333*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   334*       COMMUNICATIONS AREA                                      *
   335*                                                                *
   336******************************************************************
   337 01  DCT-COMMUNICATION-AREA.
   338     12  DCT-BILLING-BANK-ID      PIC  X(05).
   339     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   340     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   341     12  DCT-PRODUCT-CODE         PIC  X(02).
   342     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   343     12  DCT-RETURN-CODE          PIC  X(02).
   344     12  DCT-MAIL-CODE            PIC  X(05).
   345     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   346     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   8
* EL131.cbl
   348 01  ERROR-SWITCHES.
   349     12  ERROR-SWITCH            PIC X.
   350         88  SCREEN-ERROR                    VALUE 'X'.
   351     12  MSTR-KEY-SWITCH         PIC X.
   352         88  MSTR-KEY-CHANGED                VALUE 'X'.
   353     12  CERT-KEY-SWITCH         PIC X.
   354*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   355         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   356*********SET TO Y IF PRIMARY KEY WILL CHANGE
   357         88  CERT-KEY-CHANGED                VALUE 'Y'.
   358     12  MSTR-SWITCH             PIC X.
   359         88  MSTR-UPDATES                    VALUE 'X'.
   360     12  crtt-switch             pic x value spaces.
   361         88  crtt-update             value 'X'.
   362     12  CERT-SWITCH             PIC X.
   363         88  CERT-UPDATES                    VALUE 'X'.
   364     12  UPDATE-SWITCH           PIC X.
   365         88  UPDATES-PRESENT                 VALUE 'X'.
   366     12  TRLR-SWITCH             PIC X.
   367         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   368         88  UPDATE-MADE                     VALUE 'Y'.
   369     12  NINETY-TRLR-SWITCH      PIC X.
   370         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   371     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   372         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   373     12  EARNINGS-CALC-SWITCH    PIC X.
   374         88  TEX-REG                         VALUE '4'.
   375         88  NET-PAY                         VALUE '5'.
   376     12  DLYACTV-SW              PIC X       VALUE 'N'.
   377         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page   9
* EL131.cbl
   379 01  EDIT-WORK-AREA.
   380     12  COUNT-2                 PIC 9.
   381     12  CALL-PGM                PIC X(8).
   382     12  TRANS-ID                PIC X(4).
   383     12  CHECK-PFKEYS            PIC 99.
   384     12  CHECK-MAINT             PIC X.
   385         88  ADD-ALPHA-RECORD                VALUE 'A'.
   386         88  CHANGE-CLAIM                    VALUE 'C'.
   387         88  DELETE-CLAIM                    VALUE 'D'.
   388         88  CHANGE-NAME                     VALUE 'N'.
   389         88  VALID-OPTIONS                   VALUE 'A' 'C'
   390                                                   'D' 'N'.
   391
   392     12  HOLD-BENEFIT            PIC XX.
   393     12  HOLD-FREQ               PIC XX.
   394     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   395     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   396     12  HOLD-PDTHRU             PIC XX.
   397     12  HOLD-ADDON              PIC XX.
   398     12  HOLD-NODAYS             PIC 9(4).
   399     12  HOLD-NOPMTS             PIC 9(3).
   400     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   401     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   402     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   403     12  HOLD-BIRTH              PIC XX.
   404     12  HOLD-END                PIC XX.
   405     12  HOLD-EFF                PIC XX.
   406     12  HOLD-ENTRY              PIC XX.
   407     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   408     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   409     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   410     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   411     12  HOLD-LF-CV-CAN          PIC XX.
   412     12  HOLD-AH-CV-CAN          PIC XX.
   413     12  DIVIDE-QUOT             PIC 9(3).
   414     12  DIVIDE-REM              PIC 9(3).
   415
   416     12  WS-ALPHA-DATE.
   417         16  WS-ALPHA-YEAR.
   418             20  WS-ALPHA-YY-1   PIC 99.
   419             20  WS-ALPHA-YY-2   PIC 99.
   420         16  WS-ALPHA-MM         PIC 99.
   421         16  WS-ALPHA-DD         PIC 99.
   422
   423     12  BUILD-VALID-DATE.
   424         16  BUILD-MONTH         PIC 99.
   425         16  BUILD-DAY           PIC 99.
   426         16  BUILD-YEAR          PIC 99.
   427     12  DEEDIT-MMYY-INPUT.
   428         16  FILLER              PIC X.
   429         16  DEEDIT-MONTH        PIC XX.
   430         16  DEEDIT-YEAR         PIC XX.
   431     12  DEEDIT-BEN              PIC 9(9)V99.
   432     12  DEEDIT-DATE-INPUT.
   433         16  FILLER              PIC XX.
   434         16  DEEDIT-DATE         PIC X(6).
   435     12  WORK-DATE-MDY.
   436         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  10
* EL131.cbl
   437         16  FILLER              PIC X(4).
   438         16  YEAR-WORK           PIC XX.
   439     12  WORK-DATE-MY.
   440         16  WORK-MONTH          PIC XX.
   441         16  WORK-SLASH          PIC X       VALUE '/'.
   442         16  WORK-YEAR           PIC XX.
   443     12  HOLD-DATE.
   444         16  HOLD-MONTH          PIC 99.
   445         16  FILLER              PIC X(4).
   446         16  HOLD-YEAR           PIC 99.
   447     12  SPLIT-INFO-LINE-1.
   448         16  SPLIT-INFO-DESC     PIC X(15).
   449         16  FILLER              PIC X(5)    VALUE ' OLD='.
   450         16  SPLIT-INFO-OLD      PIC X(40).
   451     12  EFF-TERM-MO             PIC 9(4).
   452     12  CURR-MO                 PIC 9(4).
   453     12  WS-BIN-CURRENT-DT       PIC XX.
   454     12  WS-CALC-METHOD          PIC X.
   455     12  WS-INITIALS.
   456         16  WS-INIT-1           PIC X.
   457         16  WS-INIT-2           PIC X.
   458     12  WS-REIN-TABLE.
   459         16  WS-REIN-1           PIC X.
   460         16  WS-REIN-2           PIC X.
   461         16  WS-REIN-3           PIC X.
   462     12  PI-KEY.
   463         16  PI-TERM             PIC X(4).
   464         16  PI-QUAL             PIC X(4).
   465     12  CHECK-KEY               PIC X(20).
   466     12  SAVE-ACCT-KEY           PIC X(20).
   467     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   468     12  WS-SOC-SEC-NUMBER.
   469         16  WS-SOC-SEC-NO       PIC 9(9).
   470         16  WS-SOC-SEC-BLANK    PIC X(2).
   471     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   472         16  WS-SSN-1-3          PIC 9(3).
   473         16  WS-SSN-DASH1        PIC X(1).
   474         16  WS-SSN-4-5          PIC 9(2).
   475         16  WS-SSN-DASH2        PIC X(1).
   476         16  WS-SSN-6-9          PIC 9(4).
   477     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   478     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   479
   480 01  WS-SAVE-FIELDS.
   481     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   482     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   483     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   485     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   487     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   489     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   491     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   493     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  11
* EL131.cbl
   495     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   497     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   499     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   501     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   503     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   505     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   507     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   509     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   511     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   513     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   514     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   515     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   516     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   517     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   518     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   519     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   520     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   521     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   522     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   523     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   524     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   525     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   526     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   527     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   528     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   529     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   530     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   531     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   532     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   533     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   534     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   535     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   536
   537 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   538     12  M                   PIC S9(7)V99           VALUE ZEROS.
   539     12  L                   PIC S9(7)V99           VALUE ZEROS.
   540     12  N                   PIC S9(3)              VALUE ZEROS.
   541     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   542     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   543     12  I                   PIC S99V9(5)           VALUE ZEROS.
   544     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   545     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   546     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   547     12  R                   PIC S9(3)              VALUE ZEROS.
   548     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   549     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   550     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   551     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   552     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  12
* EL131.cbl
   553     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   554     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   555     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   556     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   557
   558 01  TERM-CALC-WORK-AREA.
   559     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   560     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   561     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   562     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   563     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   564     12  V-EXPONENTS.
   565        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   566     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   567
   568 01  TIME-IN.
   569     12  UN-HOURS                PIC XX.
   570     12  UN-MINUTES              PIC XX.
   571     12  FILLER                  PIC XX.
   572
   573 01  TIME-OUT.
   574     12  FOR-HOURS               PIC XX.
   575     12  FILLER                  PIC X       VALUE '.'.
   576     12  FOR-MINUTES             PIC XX.
   577
   578 01  ERROR-NUMBERS.
   579     12  ER-0000                 PIC X(4)    VALUE '0000'.
   580     12  ER-0004                 PIC X(4)    VALUE '0004'.
   581     12  ER-0008                 PIC X(4)    VALUE '0008'.
   582     12  ER-0023                 PIC X(4)    VALUE '0023'.
   583     12  ER-0029                 PIC X(4)    VALUE '0029'.
   584     12  ER-0068                 PIC X(4)    VALUE '0068'.
   585     12  ER-0070                 PIC X(4)    VALUE '0070'.
   586     12  ER-0149                 PIC X(4)    VALUE '0149'.
   587     12  ER-0154                 PIC X(4)    VALUE '0154'.
   588     12  ER-0169                 PIC X(4)    VALUE '0169'.
   589     12  ER-0192                 PIC X(4)    VALUE '0192'.
   590     12  ER-0199                 PIC X(4)    VALUE '0199'.
   591     12  ER-0203                 PIC X(4)    VALUE '0203'.
   592     12  ER-0204                 PIC X(4)    VALUE '0204'.
   593     12  ER-0205                 PIC X(4)    VALUE '0205'.
   594     12  ER-0206                 PIC X(4)    VALUE '0206'.
   595     12  ER-0208                 PIC X(4)    VALUE '0208'.
   596     12  ER-0210                 PIC X(4)    VALUE '0210'.
   597     12  ER-0215                 PIC X(4)    VALUE '0215'.
   598     12  ER-0219                 PIC X(4)    VALUE '0219'.
   599     12  ER-0220                 PIC X(4)    VALUE '0220'.
   600     12  ER-0222                 PIC X(4)    VALUE '0222'.
   601     12  ER-0223                 PIC X(4)    VALUE '0223'.
   602     12  ER-0224                 PIC X(4)    VALUE '0224'.
   603     12  ER-0227                 PIC X(4)    VALUE '0227'.
   604     12  ER-0230                 PIC X(4)    VALUE '0230'.
   605     12  ER-0232                 PIC X(4)    VALUE '0232'.
   606     12  ER-0233                 PIC X(4)    VALUE '0233'.
   607     12  ER-0236                 PIC X(4)    VALUE '0236'.
   608     12  ER-0237                 PIC X(4)    VALUE '0237'.
   609     12  ER-0238                 PIC X(4)    VALUE '0238'.
   610     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  13
* EL131.cbl
   611     12  ER-0241                 PIC X(4)    VALUE '0241'.
   612     12  ER-0243                 PIC X(4)    VALUE '0243'.
   613     12  ER-0244                 PIC X(4)    VALUE '0244'.
   614     12  ER-0246                 PIC X(4)    VALUE '0246'.
   615     12  ER-0247                 PIC X(4)    VALUE '0247'.
   616     12  ER-0248                 PIC X(4)    VALUE '0248'.
   617     12  ER-0250                 PIC X(4)    VALUE '0250'.
   618     12  ER-0251                 PIC X(4)    VALUE '0251'.
   619     12  ER-0253                 PIC X(4)    VALUE '0253'.
   620     12  ER-0256                 PIC X(4)    VALUE '0256'.
   621     12  ER-0257                 PIC X(4)    VALUE '0257'.
   622     12  ER-0258                 PIC X(4)    VALUE '0258'.
   623     12  ER-0259                 PIC X(4)    VALUE '0259'.
   624     12  ER-0260                 PIC X(4)    VALUE '0260'.
   625     12  ER-0261                 PIC X(4)    VALUE '0261'.
   626     12  ER-0262                 PIC X(4)    VALUE '0262'.
   627     12  ER-0263                 PIC X(4)    VALUE '0263'.
   628     12  ER-0273                 PIC X(4)    VALUE '0273'.
   629     12  ER-0274                 PIC X(4)    VALUE '0274'.
   630     12  ER-0276                 PIC X(4)    VALUE '0276'.
   631     12  ER-0282                 PIC X(4)    VALUE '0282'.
   632     12  ER-0283                 PIC X(4)    VALUE '0283'.
   633     12  ER-0309                 PIC X(4)    VALUE '0309'.
   634     12  ER-0310                 PIC X(4)    VALUE '0310'.
   635     12  ER-0311                 PIC X(4)    VALUE '0311'.
   636     12  ER-0333                 PIC X(4)    VALUE '0333'.
   637     12  ER-0360                 PIC X(4)    VALUE '0360'.
   638     12  ER-0377                 PIC X(4)    VALUE '0377'.
   639     12  ER-0402                 PIC X(4)    VALUE '0402'.
   640     12  ER-0416                 PIC X(4)    VALUE '0416'.
   641     12  ER-0426                 PIC X(4)    VALUE '0426'.
   642     12  ER-0427                 PIC X(4)    VALUE '0427'.
   643     12  ER-0428                 PIC X(4)    VALUE '0428'.
   644     12  ER-0429                 PIC X(4)    VALUE '0429'.
   645     12  ER-0430                 PIC X(4)    VALUE '0430'.
   646     12  ER-0458                 PIC X(4)    VALUE '0458'.
   647     12  ER-0475                 PIC X(4)    VALUE '0475'.
   648     12  ER-0491                 PIC X(4)    VALUE '0491'.
   649     12  ER-0509                 PIC X(4)    VALUE '0509'.
   650     12  ER-0510                 PIC X(4)    VALUE '0510'.
   651     12  ER-0511                 PIC X(4)    VALUE '0511'.
   652     12  ER-0512                 PIC X(4)    VALUE '0512'.
   653     12  ER-0519                 PIC X(4)    VALUE '0519'.
   654     12  ER-0520                 PIC X(4)    VALUE '0520'.
   655     12  ER-0521                 PIC X(4)    VALUE '0521'.
   656     12  ER-0547                 PIC X(4)    VALUE '0547'.
   657     12  ER-0548                 PIC X(4)    VALUE '0548'.
   658     12  ER-0549                 PIC X(4)    VALUE '0549'.
   659     12  ER-0565                 PIC X(4)    VALUE '0565'.
   660     12  ER-0598                 PIC X(4)    VALUE '0598'.
   661     12  ER-0639                 PIC X(4)    VALUE '0639'.
   662     12  ER-0797                 PIC X(4)    VALUE '0797'.
   663     12  ER-0802                 PIC X(4)    VALUE '0802'.
   664     12  ER-0803                 PIC X(4)    VALUE '0803'.
   665     12  ER-0849                 PIC X(4)    VALUE '0849'.
   666     12  ER-0885                 PIC X(4)    VALUE '0885'.
   667     12  ER-0887                 PIC X(4)    VALUE '0887'.
   668     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  14
* EL131.cbl
   669     12  ER-0921                 PIC X(4)    VALUE '0921'.
   670     12  ER-0938                 PIC X(4)    VALUE '0938'.
   671     12  ER-0946                 PIC X(4)    VALUE '0946'.
   672     12  ER-0947                 PIC X(4)    VALUE '0947'.
   673     12  ER-0948                 PIC X(4)    VALUE '0948'.
   674     12  ER-0949                 PIC X(4)    VALUE '0949'.
   675     12  ER-0950                 PIC X(4)    VALUE '0950'.
   676     12  ER-0951                 PIC X(4)    VALUE '0951'.
   677     12  ER-0954                 PIC X(4)    VALUE '0954'.
   678     12  ER-0974                 PIC X(4)    VALUE '0974'.
   679     12  ER-0975                 PIC X(4)    VALUE '0975'.
   680     12  ER-0992                 PIC X(4)    VALUE '0992'.
   681     12  er-1581                 pic x(4)    value '1581'.
   682     12  ER-1651                 PIC X(4)    VALUE '1651'.
   683     12  ER-1652                 PIC X(4)    VALUE '1652'.
   684     12  ER-1653                 PIC X(4)    VALUE '1653'.
   685     12  ER-1654                 PIC X(4)    VALUE '1654'.
   686     12  ER-1655                 PIC X(4)    VALUE '1655'.
   687     12  er-1656                 pic x(4)    value '1656'.
   688     12  ER-1661                 PIC X(4)    VALUE '1661'.
   689     12  ER-1662                 PIC X(4)    VALUE '1662'.
   690     12  ER-1663                 PIC X(4)    VALUE '1663'.
   691     12  er-1664                 pic x(4)    value '1664'.
   692     12  er-1665                 pic x(4)    value '1665'.
   693     12  er-1666                 pic x(4)    value '1666'.
   694     12  er-1668                 pic x(4)    value '1668'.
   695     12  er-1669                 pic x(4)    value '1669'.
   696     12  er-1675                 pic x(4)    value '1675'.
   697     12  er-1676                 pic x(4)    value '1676'.
   698     12  ER-1678                 PIC X(4)    VALUE '1678'.
   699     12  ER-1679                 PIC X(4)    VALUE '1679'.
   700     12  ER-1772                 PIC X(4)    VALUE '1772'.
   701     12  ER-1773                 PIC X(4)    VALUE '1773'.
   702     12  ER-1778                 PIC X(4)    VALUE '1778'.
   703     12  ER-2280                 PIC X(4)    VALUE '2280'.
   704     12  ER-2878                 PIC X(4)    VALUE '2878'.
   705     12  ER-7572                 PIC X(4)    VALUE '7572'.
   706     12  ER-7641                 PIC X(4)    VALUE '7641'.
   707     12  ER-7642                 PIC X(4)    VALUE '7642'.
   708     12  ER-7650                 PIC X(4)    VALUE '7650'.
   709     12  ER-7651                 PIC X(4)    VALUE '7651'.
   710     12  ER-7687                 PIC X(4)    VALUE '7687'.
   711     12  ER-7689                 PIC X(4)    VALUE '7689'.
   712     12  ER-7690                 PIC X(4)    VALUE '7690'.
   713     12  ER-7691                 PIC X(4)    VALUE '7691'.
   714     12  ER-8003                 PIC X(4)    VALUE '8003'.
   715     12  ER-8051                 PIC X(4)    VALUE '8051'.
   716     12  ER-8052                 PIC X(4)    VALUE '8052'.
   717     12  ER-8053                 PIC X(4)    VALUE '8053'.
   718     12  ER-8054                 PIC X(4)    VALUE '8054'.
   719     12  ER-8055                 PIC X(4)    VALUE '8055'.
   720     12  ER-8056                 PIC X(4)    VALUE '8056'.
   721     12  ER-8057                 PIC X(4)    VALUE '8057'.
   722     12  ER-8058                 PIC X(4)    VALUE '8058'.
   723     12  ER-8059                 PIC X(4)    VALUE '8059'.
   724     12  ER-8060                 PIC X(4)    VALUE '8060'.
   725     12  ER-8061                 PIC X(4)    VALUE '8061'.
   726     12  ER-8062                 PIC X(4)    VALUE '8062'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  15
* EL131.cbl
   727     12  ER-8063                 PIC X(4)    VALUE '8063'.
   728     12  ER-8064                 PIC X(4)    VALUE '8064'.
   729     12  ER-8065                 PIC X(4)    VALUE '8065'.
   730     12  ER-8066                 PIC X(4)    VALUE '8066'.
   731     12  ER-8152                 PIC X(4)    VALUE '8152'.
   732     12  ER-8153                 PIC X(4)    VALUE '8153'.
   733     12  ER-8154                 PIC X(4)    VALUE '8154'.
   734     12  ER-8155                 PIC X(4)    VALUE '8155'.
   735 01  ERPDEF-KEY-SAVE             PIC X(18).
   736 01  ERPDEF-KEY.
   737     12  ERPDEF-COMPANY-CD       PIC X.
   738     12  ERPDEF-STATE            PIC XX.
   739     12  ERPDEF-PROD-CD          PIC XXX.
   740     12  F                       PIC X(7).
   741     12  ERPDEF-BEN-TYPE         PIC X.
   742     12  ERPDEF-BEN-CODE         PIC XX.
   743     12  ERPDEF-EXP-DT           PIC XX.
   744 01  MSTR-KEY.
   745     12  COMPANY-CODE            PIC X.
   746     12  CARRIER-CODE            PIC X.
   747     12  CLAIM-NO                PIC X(7).
   748     12  CERT-NO.
   749         16  CERT-NO-PRIME       PIC X(10).
   750         16  CERT-NO-SUFX        PIC X.
   751
   752 01  WS-SAVE-CLAIM-KEY.
   753     12  WS-SAVE-COMPANY-CD      PIC X.
   754     12  WS-SAVE-CARRIER         PIC X.
   755     12  WS-SAVE-CLAIM-NO        PIC X(7).
   756     12  WS-SAVE-CERT-NO.
   757         16  WS-CERT-NO-PRIME    PIC X(10).
   758         16  WS-CERT-NO-SUFX     PIC X.
   759
   760 01  CERT-KEY.
   761     12  CERT-COMPANY-CODE       PIC X.
   762     12  CERT-CARRIER            PIC X.
   763     12  CERT-GROUP              PIC X(6).
   764     12  CERT-STATE              PIC XX.
   765     12  CERT-ACCOUNT            PIC X(10).
   766     12  CERT-DATE               PIC XX.
   767     12  CERT-CERT.
   768         16  CERT-CERT-PRIME     PIC X(10).
   769         16  CERT-CERT-SUFX      PIC X.
   770
   771 01  ELCRTT-KEY.
   772     05  CTRLR-COMP-CD       PIC X.
   773     05  CTRLR-CARRIER       PIC X.
   774     05  CTRLR-GROUPING      PIC X(6).
   775     05  CTRLR-STATE         PIC X(2).
   776     05  CTRLR-ACCOUNT       PIC X(10).
   777     05  CTRLR-EFF-DT        PIC XX.
   778     05  CTRLR-CERT-NO       PIC X(11).
   779     05  CTRLR-REC-TYPE      PIC X.
   780 01  NOTE-KEY.
   781     12  NOTE-COMP-CD            PIC X.
   782     12  NOTE-CERT-KEY.
   783         16  NOTE-CARRIER        PIC X.
   784         16  NOTE-GROUP          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  16
* EL131.cbl
   785         16  NOTE-STATE          PIC XX.
   786         16  NOTE-ACCOUNT        PIC X(10).
   787         16  NOTE-DATE           PIC XX.
   788         16  NOTE-CERT-NO        PIC X(11).
   789
   790 01  TRLR-KEY.
   791     12  TRLR-MAIN-KEY.
   792         16  TRLR-COMPANY-CD     PIC X.
   793         16  TRLR-CARRIER        PIC X.
   794         16  TRLR-CLAIM-NO       PIC X(07).
   795         16  TRLR-CERT-NO        PIC X(11).
   796     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   797
   798 01  BENEFIT-KEY.
   799     12  BEN-CO-ID               PIC X(3).
   800     12  BEN-REC-TYPE            PIC X.
   801     12  FILLER                  PIC XX.
   802     12  BEN-ACC-CD              PIC XX.
   803     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   804
   805 01  CNTL-KEY.
   806     12  CNTL-CO-ID              PIC X(3).
   807     12  CNTL-REC-TYPE           PIC X.
   808     12  CNTL-PROC-ID            PIC X(4).
   809     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   810         16  CNTL-STATE-NUMBER   PIC XX.
   811         16  FILLER              PIC XX.
   812     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   813         16  FILLER              PIC X(3).
   814         16  CNTL-CARRIER        PIC X.
   815     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   816
   817 01  ACTQ-KEY                    PIC X(20).
   818
   819 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   820
   821 01  CHKQ-KEY.
   822     12  CHKQ-COMPANY-CODE       PIC X.
   823     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   824     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   825
   826 01  ARCH-KEY.
   827     12  ARCH-COMPANY-CODE       PIC X.
   828     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   829     12  ARCH-RECORD-TYPE        PIC X.
   830     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   831
   832 01  ACCT-KEY.
   833     05  ACCT-PARTIAL-KEY.
   834         12  ACCT-COMPANY-CODE   PIC X.
   835         12  ACCT-CARRIER        PIC X.
   836         12  ACCT-GROUP          PIC X(6).
   837         12  ACCT-STATE          PIC XX.
   838         12  ACCT-ACCOUNT        PIC X(10).
   839     05  ACCT-DATE               PIC XX.
   840
   841 01  WS-ELBENE-KEY.
   842     12  WS-ELBENE-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  17
* EL131.cbl
   843     12  WS-ELBENE-RECORD-TYPE   PIC X.
   844     12  WS-ELBENE-ID            PIC X(10).
   845
   846 01  ELALPH-KEY.
   847     12  ELALPH-COMPANY-CD       PIC X.
   848     12  ELALPH-SOURCE           PIC X.
   849     12  ELALPH-NAME.
   850         16  ELALPH-LAST-NAME    PIC X(15).
   851         16  ELALPH-FIRST-NAME.
   852             20  ELALPH-FIRST-INIT   PIC X.
   853             20  FILLER              PIC X(11).
   854         16  ELALPH-MIDDLE-INIT  PIC X.
   855     12  ELALPH-DATE             PIC X(08).
   856     12  ELALPH-TIME             PIC S9(04)    COMP.
   857
   858 01  COMP-LENGTHS.
   859     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   860     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   861     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   862     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   863     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   864     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   865     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   866     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   867     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   868     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   869     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   870     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   871     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   872     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  18
* EL131.cbl
   874*                                COPY ELCLNKLT.
   875******************************************************************
   876*                                                                *
   877*                                                                *
   878*                           ELCLNKLT                             *
   879*                            VMOD=2.003                          *
   880*                                                                *
   881*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   882*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   883*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   884*                                                                *
   885*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   886*   COMPLETING THE REQUIRED FIELDS.                              *
   887*                                                                *
   888*   THE CALLING PROGRAM SHOULD CHECK:                            *
   889*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   890*                              9999 INDICATES AN UNKNOWN ABEND   *
   891*                                   WAS DETECTED.                *
   892*                              ALL OTHER VALUES ARE NORMAL ERROR *
   893*                              CODES FOUND IN THE ERROR FILE.    *
   894******************************************************************
   895 01  W-1523-LINKDATA.
   896     12  W-1523-COMMON-PI-DATA.
   897         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   898         16  FILLER              PIC  X(67).
   899         16  W-1523-COMPANY-CD   PIC  X(01).
   900         16  FILLER              PIC  X(10).
   901         16  W-1523-CONTROL-IN-PROGRESS.
   902             20  W-1523-CARRIER  PIC  X(01).
   903             20  W-1523-GROUPING PIC  X(06).
   904             20  W-1523-STATE    PIC  X(02).
   905             20  W-1523-ACCOUNT  PIC  X(10).
   906             20  W-1523-CLAIM-CERT-GRP.
   907                 24  W-1523-CLAIM-NO
   908                                 PIC  X(07).
   909                 24  W-1523-CERT-NO.
   910                     28  W-1523-CERT-PRIME
   911                                 PIC  X(10).
   912                     28  W-1523-CERT-SFX
   913                                 PIC  X(01).
   914                 24  W-1523-CERT-EFF-DT
   915                                 PIC  X(02).
   916         16  FILLER              PIC X(265).
   917
   918     12  W-1523-WORK-AREA.
   919         16  W-1523-FORM-NUMBER  PIC  X(04).
   920         16  W-1523-NUMBER-COPIES
   921                                 PIC  9(01).
   922         16  W-1523-ADDR-TYPE    PIC  X(02).
   923         16  W-1523-FOLLOW-UP-DATE
   924                                 PIC  X(02).
   925         16  W-1523-RESEND-DATE  PIC  X(02).
   926         16  W-1523-ERROR-CODE   PIC  9(04).
   927             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   928             88  W-1523-FATAL-ERROR
   929                                    VALUES  0006 0013 0042
   930                                            0154 0168 0169
   931                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  19
* EL131.cbl
   932                                            0179 0186 0281
   933                                            0332 2055 3697
   934                                            3698 3699 3770
   935                                            3771 3772 7675
   936                                            9106 9808 9883
   937                                            9887.
   938             88  W-1523-STOP-ERRORS
   939                                    VALUES  0013 0042 0154
   940                                            0168 0169 0172
   941                                            0281 0332 2055
   942                                            3698 3699 7675
   943                                            9106 9808 9883
   944                                            9999.
   945         16  W-1523-REASON       PIC  X(70).
   946         16  W-1523-ARCHIVE-NUMBER
   947                                 PIC  9(08).
   948     12  W-1523-POINTER-AREA.
   949         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   950         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   951         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   952         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   953         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  20
* EL131.cbl
   955*                                COPY ELCINTF.
   956******************************************************************
   957*                                                                *
   958*                                                                *
   959*                            ELCINTF.                            *
   960*                            VMOD=2.017                          *
   961*                                                                *
   962*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   963*                                                                *
   964*       LENGTH = 1024                                            *
   965*                                                                *
   966******************************************************************
   967*                   C H A N G E   L O G
   968*
   969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   970*-----------------------------------------------------------------
   971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   972* EFFECTIVE    NUMBER
   973*-----------------------------------------------------------------
   974* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   975******************************************************************
   976 01  PROGRAM-INTERFACE-BLOCK.
   977     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   978     12  PI-CALLING-PROGRAM              PIC X(8).
   979     12  PI-SAVED-PROGRAM-1              PIC X(8).
   980     12  PI-SAVED-PROGRAM-2              PIC X(8).
   981     12  PI-SAVED-PROGRAM-3              PIC X(8).
   982     12  PI-SAVED-PROGRAM-4              PIC X(8).
   983     12  PI-SAVED-PROGRAM-5              PIC X(8).
   984     12  PI-SAVED-PROGRAM-6              PIC X(8).
   985     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   986     12  PI-COMPANY-ID                   PIC XXX.
   987     12  PI-COMPANY-CD                   PIC X.
   988
   989     12  PI-COMPANY-PASSWORD             PIC X(8).
   990
   991     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   992
   993     12  PI-CONTROL-IN-PROGRESS.
   994         16  PI-CARRIER                  PIC X.
   995         16  PI-GROUPING                 PIC X(6).
   996         16  PI-STATE                    PIC XX.
   997         16  PI-ACCOUNT                  PIC X(10).
   998         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   999                                         PIC X(10).
  1000         16  PI-CLAIM-CERT-GRP.
  1001             20  PI-CLAIM-NO             PIC X(7).
  1002             20  PI-CERT-NO.
  1003                 25  PI-CERT-PRIME       PIC X(10).
  1004                 25  PI-CERT-SFX         PIC X.
  1005             20  PI-CERT-EFF-DT          PIC XX.
  1006         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1007             20  PI-PLAN-CODE            PIC X(2).
  1008             20  PI-REVISION-NUMBER      PIC X(3).
  1009             20  PI-PLAN-EFF-DT          PIC X(2).
  1010             20  PI-PLAN-EXP-DT          PIC X(2).
  1011             20  FILLER                  PIC X(11).
  1012         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  21
* EL131.cbl
  1013             20  PI-OE-REFERENCE-1.
  1014                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1015                 25  PI-OE-REF-1-SUFF    PIC XX.
  1016
  1017     12  PI-SESSION-IN-PROGRESS          PIC X.
  1018         88  CLAIM-SESSION                   VALUE '1'.
  1019         88  CREDIT-SESSION                  VALUE '2'.
  1020         88  WARRANTY-SESSION                VALUE '3'.
  1021         88  MORTGAGE-SESSION                VALUE '4'.
  1022         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1023
  1024
  1025*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1026
  1027     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1028     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1029
  1030     12  PI-CREDIT-USER                  PIC X.
  1031         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1032         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1033
  1034     12  PI-CLAIM-USER                   PIC X.
  1035         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1036         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1037
  1038     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1039         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1040         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1041         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1042         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1043         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1044
  1045     12  PI-PROCESSOR-ID                 PIC X(4).
  1046
  1047     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1048
  1049     12  PI-MEMBER-CAPTION               PIC X(10).
  1050
  1051     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1052         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1053
  1054     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1055     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1056     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1057     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1058
  1059     12  PI-AH-OVERRIDE-L1               PIC X.
  1060     12  PI-AH-OVERRIDE-L2               PIC XX.
  1061     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1062     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1063
  1064     12  PI-NEW-SYSTEM                   PIC X(2).
  1065
  1066     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1067     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1068         88  PI-USES-PAID-TO                 VALUE '1'.
  1069     12  PI-CRDTCRD-SYSTEM.
  1070         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  22
* EL131.cbl
  1071             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1072             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1073         16  PI-CC-MONTH-END-DT          PIC XX.
  1074     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1075
  1076     12  PI-OE-REFERENCE-2.
  1077         16  PI-OE-REF-2-PRIME           PIC X(10).
  1078         16  PI-OE-REF-2-SUFF            PIC X.
  1079
  1080     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1081
  1082     12  PI-LANGUAGE-TYPE                PIC X.
  1083             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1084             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1085             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1086
  1087     12  PI-POLICY-LINKAGE-IND           PIC X.
  1088         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1089         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1090                                                   LOW-VALUES.
  1091
  1092     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1093     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1094         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1095         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1096
  1097     12  PI-PROCESSOR-CSR-IND            PIC X.
  1098         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1099         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1100
  1101     12  FILLER                          PIC X(3).
  1102
  1103     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1104
  1105     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1106         PI-SYSTEM-LEVEL.
  1107
  1108         16  PI-ENTRY-CODES.
  1109             20  PI-ENTRY-CD-1           PIC X.
  1110             20  PI-ENTRY-CD-2           PIC X.
  1111
  1112         16  PI-RETURN-CODES.
  1113             20  PI-RETURN-CD-1          PIC X.
  1114             20  PI-RETURN-CD-2          PIC X.
  1115
  1116         16  PI-UPDATE-STATUS-SAVE.
  1117             20  PI-UPDATE-BY            PIC X(4).
  1118             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1119
  1120         16  PI-LOWER-CASE-LETTERS       PIC X.
  1121             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1122
  1123*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1124*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1125*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1126
  1127         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1128             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  23
* EL131.cbl
  1129             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1130             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1131             88  ACCNT-CNTL                  VALUE '3'.
  1132             88  CARR-ACCNT-CNTL             VALUE '4'.
  1133
  1134         16  PI-PROCESSOR-CAP-LIST.
  1135             20  PI-SYSTEM-CONTROLS.
  1136                24 PI-SYSTEM-DISPLAY     PIC X.
  1137                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1138                24 PI-SYSTEM-MODIFY      PIC X.
  1139                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1140             20  FILLER                  PIC XX.
  1141             20  PI-DISPLAY-CAP          PIC X.
  1142                 88  DISPLAY-CAP             VALUE 'Y'.
  1143             20  PI-MODIFY-CAP           PIC X.
  1144                 88  MODIFY-CAP              VALUE 'Y'.
  1145             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1146                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1147             20  PI-FORCE-CAP            PIC X.
  1148                 88  FORCE-CAP               VALUE 'Y'.
  1149
  1150         16  PI-PROGRAM-CONTROLS.
  1151             20  PI-PGM-PRINT-OPT        PIC X.
  1152             20  PI-PGM-FORMAT-OPT       PIC X.
  1153             20  PI-PGM-PROCESS-OPT      PIC X.
  1154             20  PI-PGM-TOTALS-OPT       PIC X.
  1155
  1156         16  PI-HELP-INTERFACE.
  1157             20  PI-LAST-ERROR-NO        PIC X(4).
  1158             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1159
  1160         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1161             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1162
  1163         16  PI-CR-CONTROL-IN-PROGRESS.
  1164             20  PI-CR-CARRIER           PIC X.
  1165             20  PI-CR-GROUPING          PIC X(6).
  1166             20  PI-CR-STATE             PIC XX.
  1167             20  PI-CR-ACCOUNT           PIC X(10).
  1168             20  PI-CR-FIN-RESP          PIC X(10).
  1169             20  PI-CR-TYPE              PIC X.
  1170
  1171         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1172
  1173         16  PI-CR-MONTH-END-DT          PIC XX.
  1174
  1175         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1176             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1177             88  PI-ZERO-CARRIER             VALUE '1'.
  1178             88  PI-ZERO-GROUPING            VALUE '2'.
  1179             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1180
  1181         16  PI-CARRIER-SECURITY         PIC X.
  1182             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1183
  1184         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1185             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1186             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  24
* EL131.cbl
  1187
  1188         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1189             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1190                                         INDEXED BY PI-ACCESS-NDX
  1191                                         PIC X.
  1192
  1193         16  PI-GA-BILLING-CONTROL       PIC X.
  1194             88  PI-GA-BILLING               VALUE '1'.
  1195
  1196         16  PI-MAIL-PROCESSING          PIC X.
  1197             88  PI-MAIL-YES                 VALUE 'Y'.
  1198
  1199         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1200
  1201         16  PI-AR-SYSTEM.
  1202             20  PI-AR-PROCESSING-CNTL   PIC X.
  1203                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1204             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1205             20  PI-AR-MONTH-END-DT      PIC XX.
  1206
  1207         16  PI-MP-SYSTEM.
  1208             20  PI-MORTGAGE-USER            PIC X.
  1209                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1210                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1211             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1212                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1213                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1214                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1215                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1216                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1217             20  PI-MP-MONTH-END-DT          PIC XX.
  1218             20  PI-MP-REFERENCE-NO.
  1219                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1220                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1221
  1222         16  PI-LABEL-CONTROL            PIC X(01).
  1223             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1224             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1225
  1226         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1227             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1228
  1229         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1230             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1231             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1232
  1233         16  FILLER                      PIC X(14).
  1234
  1235     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1236******************************************************************
  1237     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1238         16  PI-NO-PMTS                    PIC 9(4).
  1239         16  PI-CERT-SWITCH                PIC X.
  1240             88  CREATED-CERT              VALUE '2'.
  1241         16  PI-PREM-TYPE                  PIC X.
  1242         16  PI-SAVE-CERT-NO.
  1243             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1244             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  25
* EL131.cbl
  1245         16  FILLER                        PIC X(46).
  1246         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1247         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1248         16  PI-REC-FOUND-SW               PIC X.
  1249         16  PI-LETTER-SW                  PIC X.
  1250         16  PI-PREV-TRLR-KEY              PIC X(22).
  1251         16  pi-claim-type                 pic x.
  1252         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1253         16  pi-approval-level             pic x.
  1254         16  FILLER                        PIC X(543).
  1255
  1256 01  SAVE-RECORD                 PIC X(450).
  1257
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  26
* EL131.cbl
  1259*                                COPY ELCLOGOF SUPPRESS.
  1260******************************************************************
  1261*                                                                *
  1262*                                                                *
  1263*                            ELCLOGOF.                           *
  1264*                            VMOD=2.001                          *
  1265*                                                                *
  1266*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1267*                                                                *
  1268******************************************************************
  1269 01  CLASIC-LOGOFF.
  1270     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1271     12  LOGOFF-TEXT.
  1272         16  FILLER          PIC X(5)    VALUE SPACES.
  1273         16  LOGOFF-MSG.
  1274             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1275             20  FILLER      PIC X       VALUE SPACES.
  1276             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1277         16  FILLER          PIC X(80)
  1278           VALUE '* YOU ARE NOW LOGGED OFF'.
  1279         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1280         16  FILLER          PIC X       VALUE QUOTE.
  1281         16  LOGOFF-SYS-MSG  PIC X(17)
  1282           VALUE 'S CLAS-IC SYSTEM '.
  1283     12  TEXT-MESSAGES.
  1284         16  UNACCESS-MSG    PIC X(29)
  1285             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1286         16  PGMIDERR-MSG    PIC X(17)
  1287             VALUE 'PROGRAM NOT FOUND'.
  1288
  1289*                                COPY ELCATTR SUPPRESS.
  1290******************************************************************
  1291*                                                                *
  1292*                            ELCATTR.                            *
  1293*                            VMOD=2.001                          *
  1294*                                                                *
  1295*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1296*                                                                *
  1297*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1298*                                                                *
  1299*                   POS 1   P=PROTECTED                          *
  1300*                           U=UNPROTECTED                        *
  1301*                           S=ASKIP                              *
  1302*                   POS 2   A=ALPHA/NUMERIC                      *
  1303*                           N=NUMERIC                            *
  1304*                   POS 3   N=NORMAL                             *
  1305*                           B=BRIGHT                             *
  1306*                           D=DARK                               *
  1307*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1308*                           OF=MODIFIED DATA TAG OFF             *
  1309*                                                                *
  1310*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1311******************************************************************
  1312 01  ATTRIBUTE-LIST.
  1313     12  AL-PABOF            PIC X       VALUE 'Y'.
  1314     12  AL-PABON            PIC X       VALUE 'Z'.
  1315     12  AL-PADOF            PIC X       VALUE '%'.
  1316     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  27
* EL131.cbl
  1317     12  AL-PANOF            PIC X       VALUE '-'.
  1318     12  AL-PANON            PIC X       VALUE '/'.
  1319     12  AL-SABOF            PIC X       VALUE '8'.
  1320     12  AL-SABON            PIC X       VALUE '9'.
  1321     12  AL-SADOF            PIC X       VALUE '@'.
  1322     12  AL-SADON            PIC X       VALUE QUOTE.
  1323     12  AL-SANOF            PIC X       VALUE '0'.
  1324     12  AL-SANON            PIC X       VALUE '1'.
  1325     12  AL-UABOF            PIC X       VALUE 'H'.
  1326     12  AL-UABON            PIC X       VALUE 'I'.
  1327     12  AL-UADOF            PIC X       VALUE '<'.
  1328     12  AL-UADON            PIC X       VALUE '('.
  1329     12  AL-UANOF            PIC X       VALUE ' '.
  1330     12  AL-UANON            PIC X       VALUE 'A'.
  1331     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1332     12  AL-UNBON            PIC X       VALUE 'R'.
  1333     12  AL-UNDOF            PIC X       VALUE '*'.
  1334     12  AL-UNDON            PIC X       VALUE ')'.
  1335     12  AL-UNNOF            PIC X       VALUE '&'.
  1336     12  AL-UNNON            PIC X       VALUE 'J'.
  1337
  1338*                                COPY ELCAID SUPPRESS.
  1339******************************************************************
  1340*                                                                *
  1341*                            ELCAID.                             *
  1342*                            VMOD=2.001                          *
  1343*                                                                *
  1344*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1345*                                                                *
  1346*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1347*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1348******************************************************************
  1349
  1350 01  DFHAID.
  1351   02  DFHNULL   PIC  X  VALUE  ' '.
  1352   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1353   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1354   02  DFHPEN    PIC  X  VALUE  '='.
  1355   02  DFHOPID   PIC  X  VALUE  'W'.
  1356   02  DFHPA1    PIC  X  VALUE  '%'.
  1357   02  DFHPA2    PIC  X  VALUE  '>'.
  1358   02  DFHPA3    PIC  X  VALUE  ','.
  1359   02  DFHPF1    PIC  X  VALUE  '1'.
  1360   02  DFHPF2    PIC  X  VALUE  '2'.
  1361   02  DFHPF3    PIC  X  VALUE  '3'.
  1362   02  DFHPF4    PIC  X  VALUE  '4'.
  1363   02  DFHPF5    PIC  X  VALUE  '5'.
  1364   02  DFHPF6    PIC  X  VALUE  '6'.
  1365   02  DFHPF7    PIC  X  VALUE  '7'.
  1366   02  DFHPF8    PIC  X  VALUE  '8'.
  1367   02  DFHPF9    PIC  X  VALUE  '9'.
  1368   02  DFHPF10   PIC  X  VALUE  ':'.
  1369   02  DFHPF11   PIC  X  VALUE  '#'.
  1370   02  DFHPF12   PIC  X  VALUE  '@'.
  1371   02  DFHPF13   PIC  X  VALUE  'A'.
  1372   02  DFHPF14   PIC  X  VALUE  'B'.
  1373   02  DFHPF15   PIC  X  VALUE  'C'.
  1374   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  28
* EL131.cbl
  1375   02  DFHPF17   PIC  X  VALUE  'E'.
  1376   02  DFHPF18   PIC  X  VALUE  'F'.
  1377   02  DFHPF19   PIC  X  VALUE  'G'.
  1378   02  DFHPF20   PIC  X  VALUE  'H'.
  1379   02  DFHPF21   PIC  X  VALUE  'I'.
  1380*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1381   02  DFHPF22   PIC  X  VALUE  '['.
  1382   02  DFHPF23   PIC  X  VALUE  '.'.
  1383   02  DFHPF24   PIC  X  VALUE  '<'.
  1384   02  DFHMSRE   PIC  X  VALUE  'X'.
  1385   02  DFHSTRF   PIC  X  VALUE  'h'.
  1386   02  DFHTRIG   PIC  X  VALUE  '"'.
  1387 01  FILLER REDEFINES DFHAID.
  1388     12  FILLER                  PIC X(8).
  1389     12  AID-KEYS OCCURS 24 TIMES.
  1390         16  FILLER              PIC X.
  1391
  1392*                                COPY EL131S.
  1393 01  EL131AI.
  1394     05  FILLER            PIC  X(0012).
  1395*    -------------------------------
  1396     05  DATEL PIC S9(0004) COMP.
  1397     05  DATEF PIC  X(0001).
  1398     05  FILLER REDEFINES DATEF.
  1399         10  DATEA PIC  X(0001).
  1400     05  DATEI PIC  X(0008).
  1401*    -------------------------------
  1402     05  TIMEL PIC S9(0004) COMP.
  1403     05  TIMEF PIC  X(0001).
  1404     05  FILLER REDEFINES TIMEF.
  1405         10  TIMEA PIC  X(0001).
  1406     05  TIMEI PIC  X(0005).
  1407*    -------------------------------
  1408     05  SEQUL PIC S9(0004) COMP.
  1409     05  SEQUF PIC  X(0001).
  1410     05  FILLER REDEFINES SEQUF.
  1411         10  SEQUA PIC  X(0001).
  1412     05  SEQUI PIC  X(0010).
  1413*    -------------------------------
  1414     05  COMPL PIC S9(0004) COMP.
  1415     05  COMPF PIC  X(0001).
  1416     05  FILLER REDEFINES COMPF.
  1417         10  COMPA PIC  X(0001).
  1418     05  COMPI PIC  X(0003).
  1419*    -------------------------------
  1420     05  USERIDL PIC S9(0004) COMP.
  1421     05  USERIDF PIC  X(0001).
  1422     05  FILLER REDEFINES USERIDF.
  1423         10  USERIDA PIC  X(0001).
  1424     05  USERIDI PIC  X(0004).
  1425*    -------------------------------
  1426     05  LABEL1L PIC S9(0004) COMP.
  1427     05  LABEL1F PIC  X(0001).
  1428     05  FILLER REDEFINES LABEL1F.
  1429         10  LABEL1A PIC  X(0001).
  1430     05  LABEL1I PIC  X(0011).
  1431*    -------------------------------
  1432     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  29
* EL131.cbl
  1433     05  PCERTNOF PIC  X(0001).
  1434     05  FILLER REDEFINES PCERTNOF.
  1435         10  PCERTNOA PIC  X(0001).
  1436     05  PCERTNOI PIC  X(0010).
  1437*    -------------------------------
  1438     05  PSUFXL PIC S9(0004) COMP.
  1439     05  PSUFXF PIC  X(0001).
  1440     05  FILLER REDEFINES PSUFXF.
  1441         10  PSUFXA PIC  X(0001).
  1442     05  PSUFXI PIC  X(0001).
  1443*    -------------------------------
  1444     05  CCNOL PIC S9(0004) COMP.
  1445     05  CCNOF PIC  X(0001).
  1446     05  FILLER REDEFINES CCNOF.
  1447         10  CCNOA PIC  X(0001).
  1448     05  CCNOI PIC  X(0016).
  1449*    -------------------------------
  1450     05  MAINTL PIC S9(0004) COMP.
  1451     05  MAINTF PIC  X(0001).
  1452     05  FILLER REDEFINES MAINTF.
  1453         10  MAINTA PIC  X(0001).
  1454     05  MAINTI PIC  X(0001).
  1455*    -------------------------------
  1456     05  CLAIML PIC S9(0004) COMP.
  1457     05  CLAIMF PIC  X(0001).
  1458     05  FILLER REDEFINES CLAIMF.
  1459         10  CLAIMA PIC  X(0001).
  1460     05  CLAIMI PIC  X(0007).
  1461*    -------------------------------
  1462     05  CARRL PIC S9(0004) COMP.
  1463     05  CARRF PIC  X(0001).
  1464     05  FILLER REDEFINES CARRF.
  1465         10  CARRA PIC  X(0001).
  1466     05  CARRI PIC  X(0001).
  1467*    -------------------------------
  1468     05  CERTL PIC S9(0004) COMP.
  1469     05  CERTF PIC  X(0001).
  1470     05  FILLER REDEFINES CERTF.
  1471         10  CERTA PIC  X(0001).
  1472     05  CERTI PIC  X(0010).
  1473*    -------------------------------
  1474     05  SUFXL PIC S9(0004) COMP.
  1475     05  SUFXF PIC  X(0001).
  1476     05  FILLER REDEFINES SUFXF.
  1477         10  SUFXA PIC  X(0001).
  1478     05  SUFXI PIC  X(0001).
  1479*    -------------------------------
  1480     05  TYPEL PIC S9(0004) COMP.
  1481     05  TYPEF PIC  X(0001).
  1482     05  FILLER REDEFINES TYPEF.
  1483         10  TYPEA PIC  X(0001).
  1484     05  TYPEI PIC  X(0001).
  1485*    -------------------------------
  1486     05  BENPERL PIC S9(0004) COMP.
  1487     05  BENPERF PIC  X(0001).
  1488     05  FILLER REDEFINES BENPERF.
  1489         10  BENPERA PIC  X(0001).
  1490     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  30
* EL131.cbl
  1491*    -------------------------------
  1492     05  INSTYPEL PIC S9(0004) COMP.
  1493     05  INSTYPEF PIC  X(0001).
  1494     05  FILLER REDEFINES INSTYPEF.
  1495         10  INSTYPEA PIC  X(0001).
  1496     05  INSTYPEI PIC  X(0001).
  1497*    -------------------------------
  1498     05  STATUSL PIC S9(0004) COMP.
  1499     05  STATUSF PIC  X(0001).
  1500     05  FILLER REDEFINES STATUSF.
  1501         10  STATUSA PIC  X(0001).
  1502     05  STATUSI PIC  X(0006).
  1503*    -------------------------------
  1504     05  INCL PIC S9(0004) COMP.
  1505     05  INCF PIC  X(0001).
  1506     05  FILLER REDEFINES INCF.
  1507         10  INCA PIC  X(0001).
  1508     05  INCI PIC  X(0008).
  1509*    -------------------------------
  1510     05  REPL PIC S9(0004) COMP.
  1511     05  REPF PIC  X(0001).
  1512     05  FILLER REDEFINES REPF.
  1513         10  REPA PIC  X(0001).
  1514     05  REPI PIC  X(0008).
  1515*    -------------------------------
  1516     05  ICD1L PIC S9(0004) COMP.
  1517     05  ICD1F PIC  X(0001).
  1518     05  FILLER REDEFINES ICD1F.
  1519         10  ICD1A PIC  X(0001).
  1520     05  ICD1I PIC  X(0008).
  1521*    -------------------------------
  1522     05  ICD2L PIC S9(0004) COMP.
  1523     05  ICD2F PIC  X(0001).
  1524     05  FILLER REDEFINES ICD2F.
  1525         10  ICD2A PIC  X(0001).
  1526     05  ICD2I PIC  X(0008).
  1527*    -------------------------------
  1528     05  DIAGL PIC S9(0004) COMP.
  1529     05  DIAGF PIC  X(0001).
  1530     05  FILLER REDEFINES DIAGF.
  1531         10  DIAGA PIC  X(0001).
  1532     05  DIAGI PIC  X(0060).
  1533*    -------------------------------
  1534     05  ACCSWL PIC S9(0004) COMP.
  1535     05  ACCSWF PIC  X(0001).
  1536     05  FILLER REDEFINES ACCSWF.
  1537         10  ACCSWA PIC  X(0001).
  1538     05  ACCSWI PIC  X(0001).
  1539*    -------------------------------
  1540     05  BENEL PIC S9(0004) COMP.
  1541     05  BENEF PIC  X(0001).
  1542     05  FILLER REDEFINES BENEF.
  1543         10  BENEA PIC  X(0001).
  1544     05  BENEI PIC  X(0010).
  1545*    -------------------------------
  1546     05  BIRTHL PIC S9(0004) COMP.
  1547     05  BIRTHF PIC  X(0001).
  1548     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  31
* EL131.cbl
  1549         10  BIRTHA PIC  X(0001).
  1550     05  BIRTHI PIC  X(0008).
  1551*    -------------------------------
  1552     05  SOCIALL PIC S9(0004) COMP.
  1553     05  SOCIALF PIC  X(0001).
  1554     05  FILLER REDEFINES SOCIALF.
  1555         10  SOCIALA PIC  X(0001).
  1556     05  SOCIALI PIC  X(0011).
  1557*    -------------------------------
  1558     05  SEXL PIC S9(0004) COMP.
  1559     05  SEXF PIC  X(0001).
  1560     05  FILLER REDEFINES SEXF.
  1561         10  SEXA PIC  X(0001).
  1562     05  SEXI PIC  X(0001).
  1563*    -------------------------------
  1564     05  MLNAMEL PIC S9(0004) COMP.
  1565     05  MLNAMEF PIC  X(0001).
  1566     05  FILLER REDEFINES MLNAMEF.
  1567         10  MLNAMEA PIC  X(0001).
  1568     05  MLNAMEI PIC  X(0015).
  1569*    -------------------------------
  1570     05  MFNAMEL PIC S9(0004) COMP.
  1571     05  MFNAMEF PIC  X(0001).
  1572     05  FILLER REDEFINES MFNAMEF.
  1573         10  MFNAMEA PIC  X(0001).
  1574     05  MFNAMEI PIC  X(0012).
  1575*    -------------------------------
  1576     05  MMINITL PIC S9(0004) COMP.
  1577     05  MMINITF PIC  X(0001).
  1578     05  FILLER REDEFINES MMINITF.
  1579         10  MMINITA PIC  X(0001).
  1580     05  MMINITI PIC  X(0001).
  1581*    -------------------------------
  1582     05  AUTHRCVL PIC S9(0004) COMP.
  1583     05  AUTHRCVF PIC  X(0001).
  1584     05  FILLER REDEFINES AUTHRCVF.
  1585         10  AUTHRCVA PIC  X(0001).
  1586     05  AUTHRCVI PIC  X(0001).
  1587*    -------------------------------
  1588     05  CRTLNMEL PIC S9(0004) COMP.
  1589     05  CRTLNMEF PIC  X(0001).
  1590     05  FILLER REDEFINES CRTLNMEF.
  1591         10  CRTLNMEA PIC  X(0001).
  1592     05  CRTLNMEI PIC  X(0015).
  1593*    -------------------------------
  1594     05  CRTFNMEL PIC S9(0004) COMP.
  1595     05  CRTFNMEF PIC  X(0001).
  1596     05  FILLER REDEFINES CRTFNMEF.
  1597         10  CRTFNMEA PIC  X(0001).
  1598     05  CRTFNMEI PIC  X(0012).
  1599*    -------------------------------
  1600     05  CRTINITL PIC S9(0004) COMP.
  1601     05  CRTINITF PIC  X(0001).
  1602     05  FILLER REDEFINES CRTINITF.
  1603         10  CRTINITA PIC  X(0001).
  1604     05  CRTINITI PIC  X(0001).
  1605*    -------------------------------
  1606     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  32
* EL131.cbl
  1607     05  LOANBALF PIC  X(0001).
  1608     05  FILLER REDEFINES LOANBALF.
  1609         10  LOANBALA PIC  X(0001).
  1610     05  LOANBALI PIC  9(7)V99.
  1611*    -------------------------------
  1612     05  PROCL PIC S9(0004) COMP.
  1613     05  PROCF PIC  X(0001).
  1614     05  FILLER REDEFINES PROCF.
  1615         10  PROCA PIC  X(0001).
  1616     05  PROCI PIC  X(0004).
  1617*    -------------------------------
  1618     05  SUPVL PIC S9(0004) COMP.
  1619     05  SUPVF PIC  X(0001).
  1620     05  FILLER REDEFINES SUPVF.
  1621         10  SUPVA PIC  X(0001).
  1622     05  SUPVI PIC  X(0001).
  1623*    -------------------------------
  1624     05  PRICDL PIC S9(0004) COMP.
  1625     05  PRICDF PIC  X(0001).
  1626     05  FILLER REDEFINES PRICDF.
  1627         10  PRICDA PIC  X(0001).
  1628     05  PRICDI PIC  X(0001).
  1629*    -------------------------------
  1630     05  CRITPL PIC S9(0004) COMP.
  1631     05  CRITPF PIC  X(0001).
  1632     05  FILLER REDEFINES CRITPF.
  1633         10  CRITPA PIC  X(0001).
  1634     05  CRITPI PIC  X(0002).
  1635*    -------------------------------
  1636     05  EXTENSL PIC S9(0004) COMP.
  1637     05  EXTENSF PIC  X(0001).
  1638     05  FILLER REDEFINES EXTENSF.
  1639         10  EXTENSA PIC  X(0001).
  1640     05  EXTENSI PIC  99.
  1641*    -------------------------------
  1642     05  FILETOL PIC S9(0004) COMP.
  1643     05  FILETOF PIC  X(0001).
  1644     05  FILLER REDEFINES FILETOF.
  1645         10  FILETOA PIC  X(0001).
  1646     05  FILETOI PIC  X(0004).
  1647*    -------------------------------
  1648     05  PTHRHDGL PIC S9(0004) COMP.
  1649     05  PTHRHDGF PIC  X(0001).
  1650     05  FILLER REDEFINES PTHRHDGF.
  1651         10  PTHRHDGA PIC  X(0001).
  1652     05  PTHRHDGI PIC  X(0010).
  1653*    -------------------------------
  1654     05  PDTHRUL PIC S9(0004) COMP.
  1655     05  PDTHRUF PIC  X(0001).
  1656     05  FILLER REDEFINES PDTHRUF.
  1657         10  PDTHRUA PIC  X(0001).
  1658     05  PDTHRUI PIC  X(0008).
  1659*    -------------------------------
  1660     05  PDAMTL PIC S9(0004) COMP.
  1661     05  PDAMTF PIC  X(0001).
  1662     05  FILLER REDEFINES PDAMTF.
  1663         10  PDAMTA PIC  X(0001).
  1664     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  33
* EL131.cbl
  1665*    -------------------------------
  1666     05  NODAYSL PIC S9(0004) COMP.
  1667     05  NODAYSF PIC  X(0001).
  1668     05  FILLER REDEFINES NODAYSF.
  1669         10  NODAYSA PIC  X(0001).
  1670     05  NODAYSI PIC  9(5).
  1671*    -------------------------------
  1672     05  NOPMTSL PIC S9(0004) COMP.
  1673     05  NOPMTSF PIC  X(0001).
  1674     05  FILLER REDEFINES NOPMTSF.
  1675         10  NOPMTSA PIC  X(0001).
  1676     05  NOPMTSI PIC  9(4).
  1677*    -------------------------------
  1678     05  FORMTYPL PIC S9(0004) COMP.
  1679     05  FORMTYPF PIC  X(0001).
  1680     05  FILLER REDEFINES FORMTYPF.
  1681         10  FORMTYPA PIC  X(0001).
  1682     05  FORMTYPI PIC  X(0001).
  1683*    -------------------------------
  1684     05  ESTL PIC S9(0004) COMP.
  1685     05  ESTF PIC  X(0001).
  1686     05  FILLER REDEFINES ESTF.
  1687         10  ESTA PIC  X(0001).
  1688     05  ESTI PIC  X(0008).
  1689*    -------------------------------
  1690     05  AUIDL PIC S9(0004) COMP.
  1691     05  AUIDF PIC  X(0001).
  1692     05  FILLER REDEFINES AUIDF.
  1693         10  AUIDA PIC  X(0001).
  1694     05  AUIDI PIC  X(0004).
  1695*    -------------------------------
  1696     05  OCCL PIC S9(0004) COMP.
  1697     05  OCCF PIC  X(0001).
  1698     05  FILLER REDEFINES OCCF.
  1699         10  OCCA PIC  X(0001).
  1700     05  OCCI PIC  X(0006).
  1701*    -------------------------------
  1702     05  MNTDTL PIC S9(0004) COMP.
  1703     05  MNTDTF PIC  X(0001).
  1704     05  FILLER REDEFINES MNTDTF.
  1705         10  MNTDTA PIC  X(0001).
  1706     05  MNTDTI PIC  X(0008).
  1707*    -------------------------------
  1708     05  MNTTYPEL PIC S9(0004) COMP.
  1709     05  MNTTYPEF PIC  X(0001).
  1710     05  FILLER REDEFINES MNTTYPEF.
  1711         10  MNTTYPEA PIC  X(0001).
  1712     05  MNTTYPEI PIC  X(0006).
  1713*    -------------------------------
  1714     05  CERTCARL PIC S9(0004) COMP.
  1715     05  CERTCARF PIC  X(0001).
  1716     05  FILLER REDEFINES CERTCARF.
  1717         10  CERTCARA PIC  X(0001).
  1718     05  CERTCARI PIC  X(0001).
  1719*    -------------------------------
  1720     05  CERTGRPL PIC S9(0004) COMP.
  1721     05  CERTGRPF PIC  X(0001).
  1722     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  34
* EL131.cbl
  1723         10  CERTGRPA PIC  X(0001).
  1724     05  CERTGRPI PIC  X(0006).
  1725*    -------------------------------
  1726     05  CERTSTL PIC S9(0004) COMP.
  1727     05  CERTSTF PIC  X(0001).
  1728     05  FILLER REDEFINES CERTSTF.
  1729         10  CERTSTA PIC  X(0001).
  1730     05  CERTSTI PIC  X(0002).
  1731*    -------------------------------
  1732     05  CERTACTL PIC S9(0004) COMP.
  1733     05  CERTACTF PIC  X(0001).
  1734     05  FILLER REDEFINES CERTACTF.
  1735         10  CERTACTA PIC  X(0001).
  1736     05  CERTACTI PIC  X(0010).
  1737*    -------------------------------
  1738     05  CERTEFFL PIC S9(0004) COMP.
  1739     05  CERTEFFF PIC  X(0001).
  1740     05  FILLER REDEFINES CERTEFFF.
  1741         10  CERTEFFA PIC  X(0001).
  1742     05  CERTEFFI PIC  X(0008).
  1743*    -------------------------------
  1744     05  ISSAGEL PIC S9(0004) COMP.
  1745     05  ISSAGEF PIC  X(0001).
  1746     05  FILLER REDEFINES ISSAGEF.
  1747         10  ISSAGEA PIC  X(0001).
  1748     05  ISSAGEI PIC  X(0002).
  1749*    -------------------------------
  1750     05  APRL PIC S9(0004) COMP.
  1751     05  APRF PIC  X(0001).
  1752     05  FILLER REDEFINES APRF.
  1753         10  APRA PIC  X(0001).
  1754     05  APRI PIC  9(4)V9(4).
  1755*    -------------------------------
  1756     05  PMTFREQL PIC S9(0004) COMP.
  1757     05  PMTFREQF PIC  X(0001).
  1758     05  FILLER REDEFINES PMTFREQF.
  1759         10  PMTFREQA PIC  X(0001).
  1760     05  PMTFREQI PIC  99.
  1761*    -------------------------------
  1762     05  INDGRPL PIC S9(0004) COMP.
  1763     05  INDGRPF PIC  X(0001).
  1764     05  FILLER REDEFINES INDGRPF.
  1765         10  INDGRPA PIC  X(0001).
  1766     05  INDGRPI PIC  X(0001).
  1767*    -------------------------------
  1768     05  PREMTYPL PIC S9(0004) COMP.
  1769     05  PREMTYPF PIC  X(0001).
  1770     05  FILLER REDEFINES PREMTYPF.
  1771         10  PREMTYPA PIC  X(0001).
  1772     05  PREMTYPI PIC  X(0001).
  1773*    -------------------------------
  1774     05  REINCDL PIC S9(0004) COMP.
  1775     05  REINCDF PIC  X(0001).
  1776     05  FILLER REDEFINES REINCDF.
  1777         10  REINCDA PIC  X(0001).
  1778     05  REINCDI PIC  X(0001).
  1779*    -------------------------------
  1780     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  35
* EL131.cbl
  1781     05  JNTLNMEF PIC  X(0001).
  1782     05  FILLER REDEFINES JNTLNMEF.
  1783         10  JNTLNMEA PIC  X(0001).
  1784     05  JNTLNMEI PIC  X(0015).
  1785*    -------------------------------
  1786     05  JNTFNMEL PIC S9(0004) COMP.
  1787     05  JNTFNMEF PIC  X(0001).
  1788     05  FILLER REDEFINES JNTFNMEF.
  1789         10  JNTFNMEA PIC  X(0001).
  1790     05  JNTFNMEI PIC  X(0012).
  1791*    -------------------------------
  1792     05  JNTINITL PIC S9(0004) COMP.
  1793     05  JNTINITF PIC  X(0001).
  1794     05  FILLER REDEFINES JNTINITF.
  1795         10  JNTINITA PIC  X(0001).
  1796     05  JNTINITI PIC  X(0001).
  1797*    -------------------------------
  1798     05  JNTAGEL PIC S9(0004) COMP.
  1799     05  JNTAGEF PIC  X(0001).
  1800     05  FILLER REDEFINES JNTAGEF.
  1801         10  JNTAGEA PIC  X(0001).
  1802     05  JNTAGEI PIC  X(0002).
  1803*    -------------------------------
  1804     05  ADDONDTL PIC S9(0004) COMP.
  1805     05  ADDONDTF PIC  X(0001).
  1806     05  FILLER REDEFINES ADDONDTF.
  1807         10  ADDONDTA PIC  X(0001).
  1808     05  ADDONDTI PIC  X(0008).
  1809*    -------------------------------
  1810     05  LCVDSCRL PIC S9(0004) COMP.
  1811     05  LCVDSCRF PIC  X(0001).
  1812     05  FILLER REDEFINES LCVDSCRF.
  1813         10  LCVDSCRA PIC  X(0001).
  1814     05  LCVDSCRI PIC  X(0006).
  1815*    -------------------------------
  1816     05  LCVKINDL PIC S9(0004) COMP.
  1817     05  LCVKINDF PIC  X(0001).
  1818     05  FILLER REDEFINES LCVKINDF.
  1819         10  LCVKINDA PIC  X(0001).
  1820     05  LCVKINDI PIC  X(0003).
  1821*    -------------------------------
  1822     05  LCVCDL PIC S9(0004) COMP.
  1823     05  LCVCDF PIC  X(0001).
  1824     05  FILLER REDEFINES LCVCDF.
  1825         10  LCVCDA PIC  X(0001).
  1826     05  LCVCDI PIC  X(0002).
  1827*    -------------------------------
  1828     05  LCVOTRML PIC S9(0004) COMP.
  1829     05  LCVOTRMF PIC  X(0001).
  1830     05  FILLER REDEFINES LCVOTRMF.
  1831         10  LCVOTRMA PIC  X(0001).
  1832     05  LCVOTRMI PIC  999.
  1833*    -------------------------------
  1834     05  LCVRTRML PIC S9(0004) COMP.
  1835     05  LCVRTRMF PIC  X(0001).
  1836     05  FILLER REDEFINES LCVRTRMF.
  1837         10  LCVRTRMA PIC  X(0001).
  1838     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  36
* EL131.cbl
  1839*    -------------------------------
  1840     05  LCVRATEL PIC S9(0004) COMP.
  1841     05  LCVRATEF PIC  X(0001).
  1842     05  FILLER REDEFINES LCVRATEF.
  1843         10  LCVRATEA PIC  X(0001).
  1844     05  LCVRATEI PIC  9999V99.
  1845*    -------------------------------
  1846     05  LCVBENEL PIC S9(0004) COMP.
  1847     05  LCVBENEF PIC  X(0001).
  1848     05  FILLER REDEFINES LCVBENEF.
  1849         10  LCVBENEA PIC  X(0001).
  1850     05  LCVBENEI PIC  9(9)V99.
  1851*    -------------------------------
  1852     05  LCVFORML PIC S9(0004) COMP.
  1853     05  LCVFORMF PIC  X(0001).
  1854     05  FILLER REDEFINES LCVFORMF.
  1855         10  LCVFORMA PIC  X(0001).
  1856     05  LCVFORMI PIC  X(0012).
  1857*    -------------------------------
  1858     05  LCVCNDTL PIC S9(0004) COMP.
  1859     05  LCVCNDTF PIC  X(0001).
  1860     05  FILLER REDEFINES LCVCNDTF.
  1861         10  LCVCNDTA PIC  X(0001).
  1862     05  LCVCNDTI PIC  X(0008).
  1863*    -------------------------------
  1864     05  LCVEXITL PIC S9(0004) COMP.
  1865     05  LCVEXITF PIC  X(0001).
  1866     05  FILLER REDEFINES LCVEXITF.
  1867         10  LCVEXITA PIC  X(0001).
  1868     05  LCVEXITI PIC  X(0008).
  1869*    -------------------------------
  1870     05  LCVSTATL PIC S9(0004) COMP.
  1871     05  LCVSTATF PIC  X(0001).
  1872     05  FILLER REDEFINES LCVSTATF.
  1873         10  LCVSTATA PIC  X(0001).
  1874     05  LCVSTATI PIC  X(0006).
  1875*    -------------------------------
  1876     05  ACVDSCRL PIC S9(0004) COMP.
  1877     05  ACVDSCRF PIC  X(0001).
  1878     05  FILLER REDEFINES ACVDSCRF.
  1879         10  ACVDSCRA PIC  X(0001).
  1880     05  ACVDSCRI PIC  X(0006).
  1881*    -------------------------------
  1882     05  ACVKINDL PIC S9(0004) COMP.
  1883     05  ACVKINDF PIC  X(0001).
  1884     05  FILLER REDEFINES ACVKINDF.
  1885         10  ACVKINDA PIC  X(0001).
  1886     05  ACVKINDI PIC  X(0003).
  1887*    -------------------------------
  1888     05  ACVCDL PIC S9(0004) COMP.
  1889     05  ACVCDF PIC  X(0001).
  1890     05  FILLER REDEFINES ACVCDF.
  1891         10  ACVCDA PIC  X(0001).
  1892     05  ACVCDI PIC  X(0002).
  1893*    -------------------------------
  1894     05  ACVOTRML PIC S9(0004) COMP.
  1895     05  ACVOTRMF PIC  X(0001).
  1896     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  37
* EL131.cbl
  1897         10  ACVOTRMA PIC  X(0001).
  1898     05  ACVOTRMI PIC  999.
  1899*    -------------------------------
  1900     05  ACVRTRML PIC S9(0004) COMP.
  1901     05  ACVRTRMF PIC  X(0001).
  1902     05  FILLER REDEFINES ACVRTRMF.
  1903         10  ACVRTRMA PIC  X(0001).
  1904     05  ACVRTRMI PIC  X(0003).
  1905*    -------------------------------
  1906     05  ACVRATEL PIC S9(0004) COMP.
  1907     05  ACVRATEF PIC  X(0001).
  1908     05  FILLER REDEFINES ACVRATEF.
  1909         10  ACVRATEA PIC  X(0001).
  1910     05  ACVRATEI PIC  9999V99.
  1911*    -------------------------------
  1912     05  ACVBENEL PIC S9(0004) COMP.
  1913     05  ACVBENEF PIC  X(0001).
  1914     05  FILLER REDEFINES ACVBENEF.
  1915         10  ACVBENEA PIC  X(0001).
  1916     05  ACVBENEI PIC  9(9)V99.
  1917*    -------------------------------
  1918     05  ACVFORML PIC S9(0004) COMP.
  1919     05  ACVFORMF PIC  X(0001).
  1920     05  FILLER REDEFINES ACVFORMF.
  1921         10  ACVFORMA PIC  X(0001).
  1922     05  ACVFORMI PIC  X(0012).
  1923*    -------------------------------
  1924     05  ACVCNDTL PIC S9(0004) COMP.
  1925     05  ACVCNDTF PIC  X(0001).
  1926     05  FILLER REDEFINES ACVCNDTF.
  1927         10  ACVCNDTA PIC  X(0001).
  1928     05  ACVCNDTI PIC  X(0008).
  1929*    -------------------------------
  1930     05  ACVEXITL PIC S9(0004) COMP.
  1931     05  ACVEXITF PIC  X(0001).
  1932     05  FILLER REDEFINES ACVEXITF.
  1933         10  ACVEXITA PIC  X(0001).
  1934     05  ACVEXITI PIC  X(0008).
  1935*    -------------------------------
  1936     05  ACVSTATL PIC S9(0004) COMP.
  1937     05  ACVSTATF PIC  X(0001).
  1938     05  FILLER REDEFINES ACVSTATF.
  1939         10  ACVSTATA PIC  X(0001).
  1940     05  ACVSTATI PIC  X(0006).
  1941*    -------------------------------
  1942     05  LABEL2L PIC S9(0004) COMP.
  1943     05  LABEL2F PIC  X(0001).
  1944     05  FILLER REDEFINES LABEL2F.
  1945         10  LABEL2A PIC  X(0001).
  1946     05  LABEL2I PIC  X(0014).
  1947*    -------------------------------
  1948     05  BCERT1L PIC S9(0004) COMP.
  1949     05  BCERT1F PIC  X(0001).
  1950     05  FILLER REDEFINES BCERT1F.
  1951         10  BCERT1A PIC  X(0001).
  1952     05  BCERT1I PIC  X(0010).
  1953*    -------------------------------
  1954     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  38
* EL131.cbl
  1955     05  BSUFX1F PIC  X(0001).
  1956     05  FILLER REDEFINES BSUFX1F.
  1957         10  BSUFX1A PIC  X(0001).
  1958     05  BSUFX1I PIC  X(0001).
  1959*    -------------------------------
  1960     05  BCERT2L PIC S9(0004) COMP.
  1961     05  BCERT2F PIC  X(0001).
  1962     05  FILLER REDEFINES BCERT2F.
  1963         10  BCERT2A PIC  X(0001).
  1964     05  BCERT2I PIC  X(0010).
  1965*    -------------------------------
  1966     05  BSUFX2L PIC S9(0004) COMP.
  1967     05  BSUFX2F PIC  X(0001).
  1968     05  FILLER REDEFINES BSUFX2F.
  1969         10  BSUFX2A PIC  X(0001).
  1970     05  BSUFX2I PIC  X(0001).
  1971*    -------------------------------
  1972     05  BCERT3L PIC S9(0004) COMP.
  1973     05  BCERT3F PIC  X(0001).
  1974     05  FILLER REDEFINES BCERT3F.
  1975         10  BCERT3A PIC  X(0001).
  1976     05  BCERT3I PIC  X(0010).
  1977*    -------------------------------
  1978     05  BSUFX3L PIC S9(0004) COMP.
  1979     05  BSUFX3F PIC  X(0001).
  1980     05  FILLER REDEFINES BSUFX3F.
  1981         10  BSUFX3A PIC  X(0001).
  1982     05  BSUFX3I PIC  X(0001).
  1983*    -------------------------------
  1984     05  BCERT4L PIC S9(0004) COMP.
  1985     05  BCERT4F PIC  X(0001).
  1986     05  FILLER REDEFINES BCERT4F.
  1987         10  BCERT4A PIC  X(0001).
  1988     05  BCERT4I PIC  X(0010).
  1989*    -------------------------------
  1990     05  BSUFX4L PIC S9(0004) COMP.
  1991     05  BSUFX4F PIC  X(0001).
  1992     05  FILLER REDEFINES BSUFX4F.
  1993         10  BSUFX4A PIC  X(0001).
  1994     05  BSUFX4I PIC  X(0001).
  1995*    -------------------------------
  1996     05  BCERT5L PIC S9(0004) COMP.
  1997     05  BCERT5F PIC  X(0001).
  1998     05  FILLER REDEFINES BCERT5F.
  1999         10  BCERT5A PIC  X(0001).
  2000     05  BCERT5I PIC  X(0010).
  2001*    -------------------------------
  2002     05  BSUFX5L PIC S9(0004) COMP.
  2003     05  BSUFX5F PIC  X(0001).
  2004     05  FILLER REDEFINES BSUFX5F.
  2005         10  BSUFX5A PIC  X(0001).
  2006     05  BSUFX5I PIC  X(0001).
  2007*    -------------------------------
  2008     05  MSG1L PIC S9(0004) COMP.
  2009     05  MSG1F PIC  X(0001).
  2010     05  FILLER REDEFINES MSG1F.
  2011         10  MSG1A PIC  X(0001).
  2012     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  39
* EL131.cbl
  2013*    -------------------------------
  2014     05  MSG2L PIC S9(0004) COMP.
  2015     05  MSG2F PIC  X(0001).
  2016     05  FILLER REDEFINES MSG2F.
  2017         10  MSG2A PIC  X(0001).
  2018     05  MSG2I PIC  X(0072).
  2019*    -------------------------------
  2020     05  PFKEYL PIC S9(0004) COMP.
  2021     05  PFKEYF PIC  X(0001).
  2022     05  FILLER REDEFINES PFKEYF.
  2023         10  PFKEYA PIC  X(0001).
  2024     05  PFKEYI PIC  99.
  2025*    -------------------------------
  2026     05  PFKEY6L PIC S9(0004) COMP.
  2027     05  PFKEY6F PIC  X(0001).
  2028     05  FILLER REDEFINES PFKEY6F.
  2029         10  PFKEY6A PIC  X(0001).
  2030     05  PFKEY6I PIC  X(0016).
  2031 01  EL131AO REDEFINES EL131AI.
  2032     05  FILLER            PIC  X(0012).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  DATEO PIC  X(0008).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  TIMEO PIC  99.99.
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  SEQUO PIC  X(0010).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  COMPO PIC  X(0003).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  USERIDO PIC  X(0004).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  LABEL1O PIC  X(0011).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  PCERTNOO PIC  X(0010).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  PSUFXO PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  CCNOO PIC  X(0016).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  MAINTO PIC  X(0001).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  CLAIMO PIC  X(0007).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  CARRO PIC  X(0001).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  40
* EL131.cbl
  2071     05  CERTO PIC  X(0010).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  SUFXO PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  TYPEO PIC  X(0001).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  BENPERO PIC  X(0002).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  INSTYPEO PIC  X(0001).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  STATUSO PIC  X(0006).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  INCO PIC  X(0008).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  REPO PIC  X(0008).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  ICD1O PIC  X(0008).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  ICD2O PIC  X(0008).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  DIAGO PIC  X(0060).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  ACCSWO PIC  X(0001).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  BENEO PIC  X(0010).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  BIRTHO PIC  X(0008).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  SOCIALO PIC  X(0011).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  SEXO PIC  X(0001).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  MLNAMEO PIC  X(0015).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  MFNAMEO PIC  X(0012).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  MMINITO PIC  X(0001).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  41
* EL131.cbl
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  CRTLNMEO PIC  X(0015).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  CRTFNMEO PIC  X(0012).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  CRTINITO PIC  X(0001).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  LOANBALO PIC  ZZZZZ9.99.
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  PROCO PIC  X(0004).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  SUPVO PIC  X(0001).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  PRICDO PIC  X(0001).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  CRITPO PIC  X(0002).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  EXTENSO PIC  X(0002).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  FILETOO PIC  X(0004).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  PTHRHDGO PIC  X(0010).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  PDTHRUO PIC  X(0008).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  PDAMTO PIC  Z(06).99.
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  NODAYSO PIC  ZZZ99.
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  NOPMTSO PIC  ZZ99.
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  FORMTYPO PIC  X(0001).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  ESTO PIC  X(0008).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  AUIDO PIC  X(0004).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  OCCO PIC  X(0006).
  2186*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  42
* EL131.cbl
  2187     05  FILLER            PIC  X(0003).
  2188     05  MNTDTO PIC  X(0008).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  MNTTYPEO PIC  X(0006).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  CERTCARO PIC  X(0001).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  CERTGRPO PIC  X(0006).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  CERTSTO PIC  X(0002).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  CERTACTO PIC  X(0010).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  CERTEFFO PIC  X(0008).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  ISSAGEO PIC  X(0002).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  APRO PIC  9(3).9(4).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  PMTFREQO PIC  99.
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  INDGRPO PIC  X(0001).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  PREMTYPO PIC  X(0001).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  REINCDO PIC  X(0001).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  JNTLNMEO PIC  X(0015).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  JNTFNMEO PIC  X(0012).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  JNTINITO PIC  X(0001).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  JNTAGEO PIC  X(0002).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  ADDONDTO PIC  X(0008).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  LCVDSCRO PIC  X(0006).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  43
* EL131.cbl
  2245     05  LCVKINDO PIC  X(0003).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  LCVCDO PIC  X(0002).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  LCVOTRMO PIC  999.
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  LCVRTRMO PIC  999.
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  LCVRATEO PIC  ZZZ.ZZ.
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  LCVFORMO PIC  X(0012).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  LCVCNDTO PIC  X(0008).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  LCVEXITO PIC  X(0008).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  LCVSTATO PIC  X(0006).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  ACVDSCRO PIC  X(0006).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  ACVKINDO PIC  X(0003).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  ACVCDO PIC  X(0002).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  ACVOTRMO PIC  999.
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  ACVRTRMO PIC  999.
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  ACVRATEO PIC  ZZZ.ZZ.
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  ACVFORMO PIC  X(0012).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  ACVCNDTO PIC  X(0008).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  44
* EL131.cbl
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  ACVSTATO PIC  X(0006).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  LABEL2O PIC  X(0014).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BCERT1O PIC  X(0010).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  BSUFX1O PIC  X(0001).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  BCERT2O PIC  X(0010).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  BSUFX2O PIC  X(0001).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  BCERT3O PIC  X(0010).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  BSUFX3O PIC  X(0001).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  BCERT4O PIC  X(0010).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  BSUFX4O PIC  X(0001).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  BCERT5O PIC  X(0010).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  BSUFX5O PIC  X(0001).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  MSG1O PIC  X(0072).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  MSG2O PIC  X(0072).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  PFKEYO PIC  X(0002).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  PFKEY6O PIC  X(0016).
  2351*    -------------------------------
  2352
  2353*                                COPY ELCEMIB SUPPRESS.
  2354******************************************************************
  2355*                                                                *
  2356*                                                                *
  2357*                            ELCEMIB.                            *
  2358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2359*                            VMOD=2.005                          *
  2360*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  45
* EL131.cbl
  2361*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2362*                                                                *
  2363******************************************************************
  2364 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2365     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2366     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2367     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2368     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2369     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2370     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2371     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2372     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2373     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2374         88  EMI-NO-ERRORS                    VALUE '1'.
  2375         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2376         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2377     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2378         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2379     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2380         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2381         88  EMI-AREA1-FULL                   VALUE '2'.
  2382     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2383         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2384         88  EMI-AREA2-FULL                   VALUE '2'.
  2385     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2386         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2387         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2388         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2389         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2390         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2391     12  EMI-ERROR-LINES.
  2392         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2393         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2394         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2395         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2396             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2397                 24  EMI-ERR-NUM         PIC X(4).
  2398                 24  EMI-FILLER          PIC X.
  2399                 24  EMI-SEV             PIC X.
  2400                 24  FILLER              PIC X.
  2401             20  FILLER                  PIC X(02).
  2402     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2403         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2404             20  EMI-ERROR-NUMBER    PIC X(4).
  2405             20  EMI-FILL            PIC X.
  2406             20  EMI-SEVERITY        PIC X.
  2407             20  FILLER              PIC X.
  2408             20  EMI-ERROR-TEXT.
  2409                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2410                 24  FILLER          PIC X(55).
  2411     12  EMI-SEVERITY-SAVE           PIC X.
  2412         88  EMI-NOTE                    VALUE 'N'.
  2413         88  EMI-WARNING                 VALUE 'W'.
  2414         88  EMI-FORCABLE                VALUE 'F'.
  2415         88  EMI-FATAL                   VALUE 'X'.
  2416     12  EMI-MESSAGE-FLAG            PIC X.
  2417         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2418         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  46
* EL131.cbl
  2419     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2420     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2421         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2422         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2423         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2424     12  emi-claim-no                pic x(7).
  2425     12  emi-claim-type              pic x(6).
  2426     12  FILLER                      PIC X(124)  VALUE SPACES.
  2427     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2428     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2429     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2430     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2431
  2432*                                COPY ELCJPFX SUPPRESS.
  2433******************************************************************
  2434*                                                                *
  2435*                                                                *
  2436*                            ELCJPFX.                            *
  2437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2438*                            VMOD=2.002                          *
  2439*                                                                *
  2440*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2441*                                                                *
  2442*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2443*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2444*        ELCNTL - CONTROL FILE                                   *
  2445*        ELMSTR - CLAIM MASTERS                                  *
  2446*        ELTRLR - ACTIVITY TRAILERS                              *
  2447*        ELCHKQ - CHECK QUE                                      *
  2448******************************************************************
  2449 01  JOURNAL-RECORD.
  2450     12  jp-date                     pic s9(5) comp-3.
  2451     12  jp-time                     pic s9(7) comp-3.
  2452     12  JP-USER-ID                  PIC X(4).
  2453     12  JP-FILE-ID                  PIC X(8).
  2454     12  JP-PROGRAM-ID               PIC X(8).
  2455     12  JP-RECORD-TYPE              PIC X.
  2456         88 JP-ADD              VALUE 'A'.
  2457         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2458         88 JP-AFTER-CHANGE     VALUE 'C'.
  2459         88 JP-DELETE           VALUE 'D'.
  2460         88 JP-GENERIC-DELETE   VALUE 'G'.
  2461         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2462         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2463     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2464     12  JP-RECORD-AREA
  2465
  2466
  2467                                 PIC X(750).
  2468
  2469*                                COPY ELCCALC.
  2470******************************************************************
  2471*                                                                *
  2472*                           ELCCALC.                            *
  2473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2474*                            VMOD=2.025                          *
  2475*                                                                *
  2476*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  47
* EL131.cbl
  2477*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2478*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2479*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2480*                                                                *
  2481*  PASSED TO ELRTRM                                              *
  2482*  -----------------                                             *
  2483*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2484*  ORIGINAL TERM                                                 *
  2485*  BEGINNING DATE                                                *
  2486*  ENDING DATE                                                   *
  2487*  COMPANY I.D.                                                  *
  2488*  ACCOUNT MASTER USER FIELD                                     *
  2489*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2490*  FREE LOOK DAYS                                                *
  2491*                                                                *
  2492*  RETURNED FROM ELRTRM                                          *
  2493*  ---------------------                                         *
  2494*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2495*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2496*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2497*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2498*----------------------------------------------------------------*
  2499*  PASSED TO ELRAMT                                              *
  2500*  ----------------                                              *
  2501*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2502*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2503*  ORIGINAL AMOUNT                                               *
  2504*  ALTERNATE BENEFIT (BALLON)                                    *
  2505*  A.P.R. - NET PAY ONLY                                         *
  2506*  METHOD
  2507*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2508*  COMPANY I.D.                                                  *
  2509*  BENEFIT TYPE                                                  *
  2510*                                                                *
  2511*  RETURNED FROM ELRAMT                                          *
  2512*  --------------------                                          *
  2513*  REMAINING AMOUNT 1 - CURRENT                                  *
  2514*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2515*  REMAINING AMOUNT FACTOR
  2516*----------------------------------------------------------------*
  2517*  PASSED TO ELRESV                                              *
  2518*  -----------------                                             *
  2519*  CERTIFICATE EFFECTIVE DATE                                    *
  2520*  VALUATION DATE                                                *
  2521*  PAID THRU DATE                                                *
  2522*  BENEFIT                                                       *
  2523*  INCURRED DATE                                                 *
  2524*  REPORTED DATE                                                 *
  2525*  ISSUE AGE                                                     *
  2526*  TERM                                                          *
  2527*  CDT PERCENT                                                   *
  2528*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2529* *CLAIM TYPE (LIFE, A/H)                                        *
  2530* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2531* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2532*                                                                *
  2533*  RETURNED FROM ELRESV                                          *
  2534*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  48
* EL131.cbl
  2535*  CDT TABLE USED                                                *
  2536*  CDT FACTOR USED                                               *
  2537*  PAY TO CURRENT RESERVE                                        *
  2538*  I.B.N.R. - A/H ONLY                                           *
  2539*  FUTURE (ACCRUED) AH ONLY                                      *
  2540*----------------------------------------------------------------*
  2541*  PASSED TO ELRATE                                              *
  2542*  ----------------                                              *
  2543*  CERT ISSUE DATE                                               *
  2544*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2545*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2546*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2547*  STATE CODE (CLIENT DEFINED)                                   *
  2548*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2549*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2550*  DEVIATION CODE                                                *
  2551*  ISSUE AGE                                                     *
  2552*  ORIGINAL BENEFIT AMOUNT                                       *
  2553*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2554*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2555*  BENEFIT KIND (LIFE OR A/H)                                    *
  2556*  A.P.R.                                                        *
  2557*  METHOD
  2558*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2559*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2560*  COMPANY I.D. (3 CHARACTER)                                    *
  2561*  BENEFIT CODE                                                  *
  2562*  BENEFIT OVERRIDE CODE                                         *
  2563*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2564*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2565*  JOINT INDICATOR (CSL ONLY)                                    *
  2566*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2567*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2568*                                                                *
  2569*  RETURNED FROM ELRATE                                          *
  2570*  --------------------                                          *
  2571*  CALCULATED PREMIUM                                            *
  2572*  PREMIUM RATE                                                  *
  2573*  MORTALITY CODE                                                *
  2574*  MAX ATTAINED AGE                                              *
  2575*  MAX AGE                                                       *
  2576*  MAX TERM                                                      *
  2577*  MAX MONTHLY BENEFIT                                           *
  2578*  MAX TOTAL BENIFIT                                             *
  2579*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2580*----------------------------------------------------------------*
  2581*  PASSED TO ELRFND                                              *
  2582*  ----------------                                              *
  2583*  CERT ISSUE DATE                                               *
  2584*  REFUND DATE                                                   *
  2585*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2586*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2587*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2588*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2589*  STATE CODE (CLIENT DEFINED)                                   *
  2590*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2591*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2592*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  49
* EL131.cbl
  2593*  ISSUE AGE                                                     *
  2594*  ORIGINAL BENEFIT AMOUNT                                       *
  2595*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2596*  PROCESS TYPE (CANCEL)                                         *
  2597*  BENEFIT KIND (LIFE OR A/H)                                    *
  2598*  A.P.R.                                                        *
  2599*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2600*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2601*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2602*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2603*  COMPANY I.D. (3 CHARACTER)                                    *
  2604*  BENEFIT CODE                                                  *
  2605*  BENEFIT OVERRIDE CODE                                         *
  2606*                                                                *
  2607*  RETURNED FROM ELRFND                                          *
  2608*  --------------------                                          *
  2609*  CALCULATED REFUND                                             *
  2610*----------------------------------------------------------------*
  2611*  PASSED TO ELEARN                                              *
  2612*  ----------------                                              *
  2613*  CERT ISSUE DATE                                               *
  2614*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2615*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2616*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2617*  STATE CODE (CLIENT DEFINED)                                   *
  2618*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2619*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2620*  DEVIATION CODE                                                *
  2621*  ISSUE AGE                                                     *
  2622*  ORIGINAL BENEFIT AMOUNT                                       *
  2623*  BENEFIT KIND (LIFE OR A/H)                                    *
  2624*  A.P.R.                                                        *
  2625*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2626*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2627*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2628*  COMPANY I.D. (3 CHARACTER)                                    *
  2629*  BENEFIT CODE                                                  *
  2630*  BENEFIT OVERRIDE CODE                                         *
  2631*                                                                *
  2632*  RETURNED FROM ELEARN                                          *
  2633*  --------------------                                          *
  2634*  INDICATED  EARNINGS                                           *
  2635*----------------------------------------------------------------*
  2636*                 LENGTH = 450                                   *
  2637*                                                                *
  2638******************************************************************
  2639******************************************************************
  2640*                   C H A N G E   L O G
  2641*
  2642* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2643*-----------------------------------------------------------------
  2644*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2645* EFFECTIVE    NUMBER
  2646*-----------------------------------------------------------------
  2647* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2648* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2649* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2650* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  50
* EL131.cbl
  2651* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2652* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2653* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2654* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2655* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2656* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2657* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2658* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  2659******************************************************************
  2660
  2661 01  CALCULATION-PASS-AREA.
  2662     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2663                                     COMP.
  2664
  2665     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2666       88  NO-CP-ERROR                             VALUE ZERO.
  2667       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2668                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  2669       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2670       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2671       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2672       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2673       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2674       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2675       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2676       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2677       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2678       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2679       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2680       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2681       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2682       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2683       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2684       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2685       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2686       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  2687
  2688     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2689       88  NO-CP-ERROR-2                           VALUE ZERO.
  2690***********************  INPUT AREAS ****************************
  2691
  2692     12  CP-CALCULATION-AREA.
  2693         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2694         16  CP-CERT-EFF-DT        PIC XX.
  2695         16  CP-VALUATION-DT       PIC XX.
  2696         16  CP-PAID-THRU-DT       PIC XX.
  2697         16  CP-BENEFIT-TYPE       PIC X.
  2698           88  CP-AH                               VALUE 'A' 'D'
  2699                                                   'I' 'U'.
  2700           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2701           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2702         16  CP-INCURRED-DT        PIC XX.
  2703         16  CP-REPORTED-DT        PIC XX.
  2704         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2705         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2706         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2707                                     COMP-3.
  2708         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  51
* EL131.cbl
  2709                                     COMP-3.
  2710         16  CP-CDT-METHOD         PIC X.
  2711           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2712           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2713           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2714         16  CP-CLAIM-TYPE         PIC X.
  2715           88  CP-AH-CLAIM                         VALUE 'A'.
  2716           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2717         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2718                                     COMP-3.
  2719         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2720                                     COMP-3.
  2721         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2722                                     COMP-3.
  2723         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2724                                     COMP-3.
  2725         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2726                                     COMP-3.
  2727         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2728                                     COMP-3.
  2729         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2730                                     COMP-3.
  2731         16  CP-REM-TERM-METHOD    PIC X.
  2732           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2733           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2734           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2735           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2736           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2737           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2738           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2739         16  CP-EARNING-METHOD     PIC X.
  2740           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2741           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2742           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2743           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2744           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2745           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2746           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2747           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2748           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2749           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2750           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2751           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2752           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2753           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2754         16  CP-PROCESS-TYPE       PIC X.
  2755           88  CP-CLAIM                            VALUE '1'.
  2756           88  CP-CANCEL                           VALUE '2'.
  2757           88  CP-ISSUE                            VALUE '3'.
  2758         16  CP-SPECIAL-CALC-CD    PIC X.
  2759           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2760           88  CP-1-MTH-INTEREST               VALUE ' '.
  2761           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2762           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2763           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2764           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2765           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2766           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  52
* EL131.cbl
  2767           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2768           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2769           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2770           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2771           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2772           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2773           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2774           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2775           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2776           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2777                                                     'W' 'X'.
  2778           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2779           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2780           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2781           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2782           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2783           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2784           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2785           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2786           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2787           88  CP-CSL-METH-1                   VALUE '5'.
  2788           88  CP-CSL-METH-2                   VALUE '6'.
  2789           88  CP-CSL-METH-3                   VALUE '7'.
  2790           88  CP-CSL-METH-4                   VALUE '8'.
  2791
  2792         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2795         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2796         16  CP-STATE              PIC XX          VALUE SPACE.
  2797         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2798         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2799           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2800               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2801         16  CP-R78-OPTION         PIC X.
  2802           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2803           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2804
  2805         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2806         16  CP-IBNR-RESERVE-SW    PIC X.
  2807         16  CP-CLAIM-STATUS       PIC X.
  2808         16  CP-RATE-FILE          PIC X.
  2809         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2810                                     COMP-3.
  2811
  2812         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2813         16  CP-AH-OVERRIDE-CODE   PIC X.
  2814
  2815         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2816                                     COMP-3.
  2817         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2818                                   PIC S9(5)V99 COMP-3.
  2819         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2822                                     COMP-3.
  2823         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2824                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  53
* EL131.cbl
  2825         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2826                                  PIC S9(7)V99 COMP-3.
  2827
  2828         16  CP-PAID-FROM-DATE     PIC X(02).
  2829         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2830         16  CP-EXT-DAYS-CALC      PIC X.
  2831           88  CP-EXT-NO-CHG                   VALUE ' '.
  2832           88  CP-EXT-CHG-LF                   VALUE '1'.
  2833           88  CP-EXT-CHG-AH                   VALUE '2'.
  2834           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2835         16  CP-DOMICILE-STATE     PIC XX.
  2836         16  CP-CARRIER            PIC X.
  2837         16  CP-REIN-FLAG          PIC X.
  2838         16  CP-REM-TRM-CALC-OPTION PIC X.
  2839           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2840                      '2' '3' '4' '5'.
  2841           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2842           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2843           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2844           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2845           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2846           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2847           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2848           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2849         16  CP-SIG-SWITCH         PIC X.
  2850         16  CP-RATING-METHOD      PIC X.
  2851           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2852           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2853           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2854           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2855           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2856           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2857           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2858           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2859           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2860         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2861                                     COMP-3.
  2862         16  CP-BEN-CATEGORY       PIC X.
  2863         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2864         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2865                                   PIC S99V9(5) COMP-3.
  2866         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2867         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2868                                   PIC S99V9(5) COMP-3.
  2869         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2870         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2871         16  CP-EXPIRE-DT          PIC XX.
  2872         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2873         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2874         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2875         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2876         16  CP-DDF-SPEC-CALC      PIC X.
  2877             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2878             88  CP-CALC-CLP              VALUE 'C'.
  2879         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2880         16  CP-CANCEL-REASON      PIC X.
  2881         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2882         16  CP-PMT-MODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  54
* EL131.cbl
  2883         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2884         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2885         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2886         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2887         16  FILLER                PIC X.
  2888
  2889***************    OUTPUT FROM ELRESV   ************************
  2890
  2891         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2892
  2893         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2894                                     COMP-3.
  2895         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2896                                     COMP-3.
  2897         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2898                                     COMP-3.
  2899         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2900                                     COMP-3.
  2901         16  FILLER                PIC X(09).
  2902***************    OUTPUT FROM ELRTRM   *************************
  2903
  2904         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2905                                     COMP-3.
  2906         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2907                                     COMP-3.
  2908         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2909                                     COMP-3.
  2910         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2911                                     COMP-3.
  2912         16  FILLER                PIC X(12).
  2913
  2914***************    OUTPUT FROM ELRAMT   *************************
  2915
  2916         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2917                                     COMP-3.
  2918         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2919                                     COMP-3.
  2920         16  FILLER                PIC X(12).
  2921
  2922***************    OUTPUT FROM ELRATE   *************************
  2923
  2924         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2925                                     COMP-3.
  2926         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2927                                     COMP-3.
  2928         16  CP-MORTALITY-CODE     PIC X(4).
  2929         16  CP-RATE-EDIT-FLAG     PIC X.
  2930             88  CP-RATES-NEED-APR                  VALUE '1'.
  2931         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2932                                     COMP-3.
  2933         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2934         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2935         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2936                                   PIC S9(7)V99 COMP-3.
  2937         16  FILLER                PIC X(07).
  2938
  2939***************    OUTPUT FROM ELRFND   *************************
  2940
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  55
* EL131.cbl
  2941         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2942                                     COMP-3.
  2943         16  CP-REFUND-TYPE-USED   PIC X.
  2944           88  CP-R-AS-R78                         VALUE '1'.
  2945           88  CP-R-AS-PRORATA                     VALUE '2'.
  2946           88  CP-R-AS-CALIF                       VALUE '3'.
  2947           88  CP-R-AS-TEXAS                       VALUE '4'.
  2948           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2949           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2950           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2951           88  CP-R-AS-MEAN                        VALUE '8'.
  2952           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2953           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2954           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2955           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2956           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2957           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2958         16  FILLER                PIC X(12).
  2959
  2960***************    OUTPUT FROM ELEARN   *************************
  2961
  2962         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2963                                     COMP-3.
  2964         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2965                                     COMP-3.
  2966         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2967                                     COMP-3.
  2968         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2969                                     COMP-3.
  2970         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2971                                     COMP-3.
  2972         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2973                                     COMP-3.
  2974         16  CP-EARNING-TYPE-USED  PIC X.
  2975           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2976           88  CP-E-AS-R78                         VALUE '1'.
  2977           88  CP-E-AS-PRORATA                     VALUE '2'.
  2978           88  CP-E-AS-TEXAS                       VALUE '4'.
  2979           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2980           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2981           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2982           88  CP-E-AS-MEAN                        VALUE '8'.
  2983           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2984         16  FILLER                PIC X(12).
  2985
  2986***************    OUTPUT FROM ELPMNT   *************************
  2987
  2988         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2989                                     COMP-3.
  2990         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2991                                     COMP-3.
  2992         16  FILLER                PIC X(12).
  2993
  2994***************   MISC WORK AREAS    *****************************
  2995         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2996                                     COMP-3.
  2997         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2998                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  56
* EL131.cbl
  2999         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3000                                     COMP-3.
  3001         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3002                                     COMP-3.
  3003         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3004                                     COMP-3.
  3005         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3006                                     COMP-3.
  3007         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3008             88  OPEN-RATE-FILE                   VALUE 'O'.
  3009             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3010             88  IO-ERROR                         VALUE 'E'.
  3011
  3012         16  CP-FIRST-PAY-DATE     PIC XX.
  3013
  3014         16  CP-JOINT-INDICATOR    PIC X.
  3015
  3016         16  CP-RESERVE-REMAINING-TERM
  3017                                   PIC S9(4)V9    VALUE ZERO
  3018                                     COMP-3.
  3019
  3020         16  CP-INSURED-BIRTH-DT   PIC XX.
  3021
  3022         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3023                                     COMP-3.
  3024
  3025         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3026                                     COMP-3.
  3027
  3028         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3029                                     COMP-3.
  3030
  3031         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3032                                     COMP-3.
  3033
  3034         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3035                                     COMP-3.
  3036
  3037         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3038                                     COMP-3.
  3039
  3040         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3041                                     COMP-3.
  3042
  3043         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3044             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3045
  3046         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3047                                     COMP-3.
  3048         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3049                                     COMP-3.
  3050         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3051         16  cp-extra-periods      pic 9 value zeros.
  3052         16  cp-net-only-state     pic x value spaces.
  3053         16  FILLER                PIC X(13).
  3054******************************************************************
  3055
  3056*                                COPY ELCDATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  57
* EL131.cbl
  3057******************************************************************
  3058*                                                                *
  3059*                                                                *
  3060*                            ELCDATE.                            *
  3061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3062*                            VMOD=2.003
  3063*                                                                *
  3064*                                                                *
  3065*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3066*                 LENGTH = 200                                   *
  3067******************************************************************
  3068
  3069 01  DATE-CONVERSION-DATA.
  3070     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3071     12  DC-OPTION-CODE                PIC X.
  3072         88  BIN-TO-GREG                VALUE ' '.
  3073         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3074         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3075         88  YMD-GREG-TO-BIN            VALUE '3'.
  3076         88  MDY-GREG-TO-BIN            VALUE '4'.
  3077         88  JULIAN-TO-BIN              VALUE '5'.
  3078         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3079         88  FIND-CENTURY               VALUE '7'.
  3080         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3081         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3082         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3083         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3084         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3085         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3086         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3087         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3088         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3089         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3090         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3091         88  BIN-3-TO-GREG              VALUE 'I'.
  3092         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3093         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3094         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3095         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3096         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3097         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3098         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3099         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3100         88  THREE-CHARACTER-BIN
  3101                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3102         88  GREGORIAN-TO-BIN
  3103                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3104         88  BIN-TO-GREGORIAN
  3105                  VALUES ' ' '1' 'I' '8' 'G'.
  3106         88  JULIAN-TO-BINARY
  3107                  VALUES '5' 'C' 'E' 'F'.
  3108     12  DC-ERROR-CODE                 PIC X.
  3109         88  NO-CONVERSION-ERROR        VALUE ' '.
  3110         88  DATE-CONVERSION-ERROR
  3111                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3112         88  DATE-IS-ZERO               VALUE '1'.
  3113         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3114         88  DATE-IS-INVALID            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  58
* EL131.cbl
  3115         88  DATE1-GREATER-DATE2        VALUE '4'.
  3116         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3117         88  DATE-INVALID-OPTION        VALUE '9'.
  3118         88  INVALID-CENTURY            VALUE 'A'.
  3119         88  ONLY-CENTURY               VALUE 'B'.
  3120         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3121         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3122     12  DC-END-OF-MONTH               PIC X.
  3123         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3124     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3125         88  USE-NORMAL-PROCESS         VALUE ' '.
  3126         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3127         88  ADJUST-UP-100-YRS          VALUE '2'.
  3128     12  FILLER                        PIC X.
  3129     12  DC-CONVERSION-DATES.
  3130         16  DC-BIN-DATE-1             PIC XX.
  3131         16  DC-BIN-DATE-2             PIC XX.
  3132         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3133         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3134                       DC-GREG-DATE-1-EDIT.
  3135             20  DC-EDIT1-MONTH        PIC 99.
  3136             20  SLASH1-1              PIC X.
  3137             20  DC-EDIT1-DAY          PIC 99.
  3138             20  SLASH1-2              PIC X.
  3139             20  DC-EDIT1-YEAR         PIC 99.
  3140         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3141         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3142                     DC-GREG-DATE-2-EDIT.
  3143             20  DC-EDIT2-MONTH        PIC 99.
  3144             20  SLASH2-1              PIC X.
  3145             20  DC-EDIT2-DAY          PIC 99.
  3146             20  SLASH2-2              PIC X.
  3147             20  DC-EDIT2-YEAR         PIC 99.
  3148         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3149         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3150                     DC-GREG-DATE-1-YMD.
  3151             20  DC-YMD-YEAR           PIC 99.
  3152             20  DC-YMD-MONTH          PIC 99.
  3153             20  DC-YMD-DAY            PIC 99.
  3154         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3155         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3156                      DC-GREG-DATE-1-MDY.
  3157             20  DC-MDY-MONTH          PIC 99.
  3158             20  DC-MDY-DAY            PIC 99.
  3159             20  DC-MDY-YEAR           PIC 99.
  3160         16  DC-GREG-DATE-1-ALPHA.
  3161             20  DC-ALPHA-MONTH        PIC X(10).
  3162             20  DC-ALPHA-DAY          PIC 99.
  3163             20  FILLER                PIC XX.
  3164             20  DC-ALPHA-CENTURY.
  3165                 24 DC-ALPHA-CEN-N     PIC 99.
  3166             20  DC-ALPHA-YEAR         PIC 99.
  3167         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3168         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3169         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3170         16  DC-JULIAN-DATE            PIC 9(05).
  3171         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3172                                       PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  59
* EL131.cbl
  3173         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3174             20  DC-JULIAN-YEAR        PIC 99.
  3175             20  DC-JULIAN-DAYS        PIC 999.
  3176         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3177         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3178         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3179     12  DATE-CONVERSION-VARIBLES.
  3180         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3181         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3182             20  FILLER                PIC 9(3).
  3183             20  HOLD-CEN-1-CCYY.
  3184                 24  HOLD-CEN-1-CC     PIC 99.
  3185                 24  HOLD-CEN-1-YY     PIC 99.
  3186             20  HOLD-CEN-1-MO         PIC 99.
  3187             20  HOLD-CEN-1-DA         PIC 99.
  3188         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3189             20  HOLD-CEN-1-R-MO       PIC 99.
  3190             20  HOLD-CEN-1-R-DA       PIC 99.
  3191             20  HOLD-CEN-1-R-CCYY.
  3192                 24  HOLD-CEN-1-R-CC   PIC 99.
  3193                 24  HOLD-CEN-1-R-YY   PIC 99.
  3194             20  FILLER                PIC 9(3).
  3195         16  HOLD-CENTURY-1-X.
  3196             20  FILLER                PIC X(3)  VALUE SPACES.
  3197             20  HOLD-CEN-1-X-CCYY.
  3198                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3199                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3200             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3201             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3202         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3203             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3204             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3205             20  HOLD-CEN-1-R-X-CCYY.
  3206                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3207                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3208             20  FILLER                PIC XXX.
  3209         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3210         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3211         16  DC-JULIAN-DATE-1          PIC 9(07).
  3212         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3213             20  DC-JULIAN-1-CCYY.
  3214                 24  DC-JULIAN-1-CC    PIC 99.
  3215                 24  DC-JULIAN-1-YR    PIC 99.
  3216             20  DC-JULIAN-DA-1        PIC 999.
  3217         16  DC-JULIAN-DATE-2          PIC 9(07).
  3218         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3219             20  DC-JULIAN-2-CCYY.
  3220                 24  DC-JULIAN-2-CC    PIC 99.
  3221                 24  DC-JULIAN-2-YR    PIC 99.
  3222             20  DC-JULIAN-DA-2        PIC 999.
  3223         16  DC-GREG-DATE-A-EDIT.
  3224             20  DC-EDITA-MONTH        PIC 99.
  3225             20  SLASHA-1              PIC X VALUE '/'.
  3226             20  DC-EDITA-DAY          PIC 99.
  3227             20  SLASHA-2              PIC X VALUE '/'.
  3228             20  DC-EDITA-CCYY.
  3229                 24  DC-EDITA-CENT     PIC 99.
  3230                 24  DC-EDITA-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  60
* EL131.cbl
  3231         16  DC-GREG-DATE-B-EDIT.
  3232             20  DC-EDITB-MONTH        PIC 99.
  3233             20  SLASHB-1              PIC X VALUE '/'.
  3234             20  DC-EDITB-DAY          PIC 99.
  3235             20  SLASHB-2              PIC X VALUE '/'.
  3236             20  DC-EDITB-CCYY.
  3237                 24  DC-EDITB-CENT     PIC 99.
  3238                 24  DC-EDITB-YEAR     PIC 99.
  3239         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3240         16  DC-GREG-DATE-CYMD-R REDEFINES
  3241                              DC-GREG-DATE-CYMD.
  3242             20  DC-CYMD-CEN           PIC 99.
  3243             20  DC-CYMD-YEAR          PIC 99.
  3244             20  DC-CYMD-MONTH         PIC 99.
  3245             20  DC-CYMD-DAY           PIC 99.
  3246         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3247         16  DC-GREG-DATE-MDCY-R REDEFINES
  3248                              DC-GREG-DATE-MDCY.
  3249             20  DC-MDCY-MONTH         PIC 99.
  3250             20  DC-MDCY-DAY           PIC 99.
  3251             20  DC-MDCY-CEN           PIC 99.
  3252             20  DC-MDCY-YEAR          PIC 99.
  3253    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3254        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3255    12  DC-EL310-DATE                  PIC X(21).
  3256    12  FILLER                         PIC X(28).
  3257
  3258*                                COPY ELCDMO.
  3259******************************************************************
  3260*                                                                *
  3261*                                                                *
  3262*                            ELCDMO.                             *
  3263*                            VMOD=2.004                          *
  3264*                                                                *
  3265*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3266*        COMMUNICATION AREA                                      *
  3267*   FILE TYPE = NA                                               *
  3268*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3269*                                                                *
  3270******************************************************************
  3271 01  DMO-COMMUNICATION-AREA.
  3272     12  DM-RECORD-TYPE                  PIC  X(02).
  3273             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3274             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3275             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3276     12  DM-DIST-CODE                    PIC  X(04).
  3277     12  DM-MAIL-CODE                    PIC  X(05).
  3278     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3279     12  DM-INSURED-NAME                 PIC  X(30).
  3280     12  DM-CLAIM-NO                     PIC  X(07).
  3281     12  DM-CLAIM-TYPE                   PIC  X.
  3282
  3283     12  DM-STATUS-DATA-AREA.
  3284         16  DM-CLAIM-STATUS             PIC  X.
  3285             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3286             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3287             88  DM-CLOSED                        VALUE '3'.
  3288             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  61
* EL131.cbl
  3289             88  DM-DEFAULT                       VALUE '9'.
  3290         16  DM-STATUS-DATE              PIC  X(08).
  3291******YYYYMMDD
  3292         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3293             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3294             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3295             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3296             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3297             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3298             88  DM-RE-OPENED                     VALUE 'R'.
  3299             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3300             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3301             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3302         16  DM-STAT-CARRIER             PIC X.
  3303
  3304     12  DM-DRAFT-DATA-AREA.
  3305         16  DM-PAYMENT-TYPE             PIC  X.
  3306             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3307         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3308         16  DM-PAYMENT-DATE             PIC  X(08).
  3309******YYYYMMDD
  3310         16  DM-CERT-NO                  PIC  X(11).
  3311         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3312         16  DM-CARRIER                  PIC  X.
  3313
  3314     12  DM-RETURN-CODE                  PIC  XX.
  3315*                                COPY ERCPDEF.
  3316******************************************************************
  3317*                                                                *
  3318*                                                                *
  3319*                            ERCPDEF.                            *
  3320*                                                                *
  3321*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3322*                                                                *
  3323*    FILE TYPE = VSAM,KSDS                                       *
  3324*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3325*                                                                *
  3326*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3327*                                                                *
  3328*    LOG = YES                                                   *
  3329*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3330******************************************************************
  3331*                   C H A N G E   L O G
  3332*
  3333* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3334*-----------------------------------------------------------------
  3335*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3336* EFFECTIVE    NUMBER
  3337*-----------------------------------------------------------------
  3338* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3339* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3340* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3341* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3342******************************************************************
  3343 01  PRODUCT-MASTER.
  3344    12  PD-RECORD-ID                 PIC X(02).
  3345        88  VALID-PD-ID                  VALUE 'PD'.
  3346    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  62
* EL131.cbl
  3347        16  PD-COMPANY-CD            PIC X.
  3348        16  PD-STATE                 PIC XX.
  3349        16  PD-PRODUCT-CD            PIC XXX.
  3350        16  PD-FILLER                PIC X(7).
  3351        16  PD-BEN-TYPE              PIC X.
  3352        16  PD-BEN-CODE              PIC XX.
  3353        16  PD-PROD-EXP-DT           PIC XX.
  3354    12  FILLER                       PIC X(50).
  3355    12  PD-PRODUCT-DATA OCCURS 8.
  3356        16  PD-PROD-CODE             PIC X.
  3357            88  PD-PROD-LIFE           VALUE 'L'.
  3358            88  PD-PROD-PROP           VALUE 'P'.
  3359            88  PD-PROD-AH             VALUE 'A'.
  3360            88  PD-PROD-IU             VALUE 'I'.
  3361            88  PD-PROD-GAP            VALUE 'G'.
  3362            88  PD-PROD-FAML           VALUE 'F'.
  3363            88  PD-PROD-OTH            VALUE 'O'.
  3364        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3365        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3366        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3367        16  PD-MAX-TERM              PIC S999        COMP-3.
  3368        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3369        16  FILLER                   PIC X.
  3370        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3371        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3372        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3373        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3374        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3375        16  PD-REC-CRIT-PERIOD       PIC 99.
  3376        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3377            20  PD-RECURRING-YN      PIC X.
  3378            20  FILLER               PIC X.
  3379        16  PD-RTW-MOS               PIC 99.
  3380        16  PD-MAX-EXTENSION         PIC 99.
  3381        16  pd-ben-pct               pic sv999 comp-3.
  3382*       16  FILLER                   PIC XX.
  3383    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3384    12  PD-TERM-LIMITS OCCURS 15.
  3385        16  PD-LOW-TERM              PIC S999        COMP-3.
  3386        16  PD-HI-TERM               PIC S999        COMP-3.
  3387*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3388    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3389        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3390        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3391    12  PD-EARN-FACTORS.
  3392        16  FILLER OCCURS 15.
  3393            20  FILLER OCCURS 15.
  3394                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3395    12  PD-PRODUCT-DESC              PIC X(80).
  3396    12  PD-TRUNCATED                 PIC X.
  3397    12  FILLER                       PIC X(59).
  3398    12  PD-MAINT-INFORMATION.
  3399        16  PD-LAST-MAINT-DT         PIC X(02).
  3400        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3401        16  PD-LAST-MAINT-BY         PIC X(04).
  3402*                                COPY ELCCRTT.
  3403******************************************************************
  3404*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  63
* EL131.cbl
  3405*                            ELCCRTT.                            *
  3406*                                                                *
  3407*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3408*                                                                *
  3409*   FILE TYPE = VSAM,KSDS                                        *
  3410*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3411*                                                                *
  3412*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3413*                                                                *
  3414*   LOG = YES                                                    *
  3415*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3416******************************************************************
  3417*                   C H A N G E   L O G
  3418*
  3419* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3420*-----------------------------------------------------------------
  3421*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3422* EFFECTIVE    NUMBER
  3423*-----------------------------------------------------------------
  3424* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3425* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3426* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3427* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3428* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3429* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3430* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3431* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3432* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3433* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3434* 091318  CR2018073000001  PEMA  ADD Refund methods
  3435* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3436******************************************************************
  3437
  3438 01  CERTIFICATE-TRAILERS.
  3439     12  CS-RECORD-ID                      PIC XX.
  3440         88  VALID-CS-ID                      VALUE 'CS'.
  3441
  3442     12  CS-CONTROL-PRIMARY.
  3443         16  CS-COMPANY-CD                 PIC X.
  3444         16  CS-CARRIER                    PIC X.
  3445         16  CS-GROUPING                   PIC X(6).
  3446         16  CS-STATE                      PIC XX.
  3447         16  CS-ACCOUNT                    PIC X(10).
  3448         16  CS-CERT-EFF-DT                PIC XX.
  3449         16  CS-CERT-NO.
  3450             20  CS-CERT-PRIME             PIC X(10).
  3451             20  CS-CERT-SFX               PIC X.
  3452         16  CS-TRAILER-TYPE               PIC X.
  3453             88  COMM-TRLR           VALUE 'A'.
  3454             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3455             88  CERT-DATA-TRLR      VALUE 'C'.
  3456
  3457     12  CS-DATA-AREA                      PIC X(516).
  3458
  3459     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3460         16  CS-BANK-COMMISSION-AREA.
  3461             20  CS-BANK-COMMS       OCCURS 10.
  3462                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  64
* EL131.cbl
  3463                 24  CS-COM-TYP            PIC X.
  3464                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3465                 24  CS-RECALC-LV-INDIC    PIC X.
  3466                 24  FILLER                PIC X(10).
  3467         16  FILLER                        PIC X(256).
  3468
  3469     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3470****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3471         16  CS-MB-CLAIM-DATA OCCURS 24.
  3472             20  CS-CLAIM-NO               PIC X(7).
  3473             20  CS-CLAIM-TYPE             PIC X.
  3474                 88  CS-AH-CLM               VALUE 'A'.
  3475                 88  CS-IU-CLM               VALUE 'I'.
  3476                 88  CS-GP-CLM               VALUE 'G'.
  3477                 88  CS-LF-CLM               VALUE 'L'.
  3478                 88  CS-PR-CLM               VALUE 'P'.
  3479                 88  CS-FL-CLM               VALUE 'F'.
  3480                 88  CS-OT-CLM               VALUE 'O'.
  3481             20  CS-INSURED-TYPE           PIC X.
  3482                 88  CS-PRIM-INSURED          VALUE 'P'.
  3483                 88  CS-CO-BORROWER           VALUE 'C'.
  3484             20  CS-BENEFIT-PERIOD         PIC 99.
  3485             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3486             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3487             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3488         16  FILLER                        PIC X(12).
  3489     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3490         16  CS-VIN-NUMBER                 PIC X(17).
  3491         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3492         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3493         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3494         16  cs-agent-name.
  3495             20  cs-agent-fname            pic x(20).
  3496             20  cs-agent-mi               pic x.
  3497             20  cs-agent-lname            pic x(25).
  3498         16  cs-license-no                 pic x(15).
  3499         16  cs-npn-number                 pic x(10).
  3500         16  cs-agent-edit-status          pic x.
  3501             88  cs-ae-refer-to-manager      value 'M'.
  3502             88  cs-ae-cover-sheet           value 'C'.
  3503             88  cs-ae-sig-form              value 'S'.
  3504             88  cs-ae-verified              value 'V'.
  3505             88  cs-unidentified-signature   value 'U'.
  3506             88  cs-cert-returned            value 'R'.
  3507             88  cs-accept-no-commission     value 'N'.
  3508         16  cs-year                       pic 9999.
  3509         16  cs-make                       pic x(20).
  3510         16  cs-model                      pic x(20).
  3511         16  cs-future                     pic x(20).
  3512         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3513         16  cs-claim-verification-status  pic x.
  3514             88  cs-clm-ver-eligible         value 'A'.
  3515             88  cs-clm-ver-partial-elig     value 'B'.
  3516             88  cs-clm-ver-not-eligible     value 'C'.
  3517             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3518             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3519             88  cs-clm-ver-ND-CERT          value 'F'.
  3520             88  cs-clm-ver-spec-other       value 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  65
* EL131.cbl
  3521             88  cs-clam-ver-pratial-corrected
  3522                                             value 'H'.
  3523             88  cs-clm-ver-no-matches       value 'I'.
  3524             88  cs-clm-ver-not-elig-corrected
  3525                                             value 'J'.
  3526             88  cs-clm-ver-needs-review     value 'R'.
  3527             88  cs-clm-ver-sent-to-claims   value 'W'.
  3528         16  CS-LF-REFUND-METHOD           PIC X.
  3529         16  CS-AH-REFUND-METHOD           PIC X.
  3530         16  FILLER                        PIC X(353). *> was 420
  3531*        16  FILLER                        PIC X(496).
  3532
  3533****************************************************************
  3534*
  3535* Copyright (c) 2007-2013 Dell Inc.
  3536* All rights reserved.
  3537*
  3538****************************************************************
  3539 01  DFHEIV.
  3540   02  DFHEIV0               PIC X(35).
  3541   02  DFHEIV1               PIC X(08).
  3542   02  DFHEIV2               PIC X(08).
  3543   02  DFHEIV3               PIC X(08).
  3544   02  DFHEIV4               PIC X(06).
  3545   02  DFHEIV5               PIC X(04).
  3546   02  DFHEIV6               PIC X(04).
  3547   02  DFHEIV7               PIC X(02).
  3548   02  DFHEIV8               PIC X(02).
  3549   02  DFHEIV9               PIC X(01).
  3550   02  DFHEIV10              PIC S9(7) COMP-3.
  3551   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3552   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3553   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3554   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3555   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3556   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3557   02  DFHEIV17              PIC X(04).
  3558   02  DFHEIV18              PIC X(04).
  3559   02  DFHEIV19              PIC X(04).
  3560   02  DFHEIV20              USAGE IS POINTER.
  3561   02  DFHEIV21              USAGE IS POINTER.
  3562   02  DFHEIV22              USAGE IS POINTER.
  3563   02  DFHEIV23              USAGE IS POINTER.
  3564   02  DFHEIV24              USAGE IS POINTER.
  3565   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3566   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3567   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3568   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3569   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3570   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3571   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3572   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3573   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3574   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3575   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3576   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3577   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3578   02  FILLER                PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  66
* EL131.cbl
  3579   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3580   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3581   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3582   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3583   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3584   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3585   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3586 LINKAGE  SECTION.
  3587*****************************************************************
  3588*                                                               *
  3589* Copyright (c) 2007-2013 Dell Inc.                             *
  3590* All rights reserved.                                          *
  3591*                                                               *
  3592*****************************************************************
  3593 01  dfheiblk.
  3594     02  eibtime          pic s9(7) comp-3.
  3595     02  eibdate          pic s9(7) comp-3.
  3596     02  eibtrnid         pic x(4).
  3597     02  eibtaskn         pic s9(7) comp-3.
  3598     02  eibtrmid         pic x(4).
  3599     02  dfheigdi         pic s9(4) comp.
  3600     02  eibcposn         pic s9(4) comp.
  3601     02  eibcalen         pic s9(4) comp.
  3602     02  eibaid           pic x(1).
  3603     02  eibfiller1       pic x(1).
  3604     02  eibfn            pic x(2).
  3605     02  eibfiller2       pic x(2).
  3606     02  eibrcode         pic x(6).
  3607     02  eibfiller3       pic x(2).
  3608     02  eibds            pic x(8).
  3609     02  eibreqid         pic x(8).
  3610     02  eibrsrce         pic x(8).
  3611     02  eibsync          pic x(1).
  3612     02  eibfree          pic x(1).
  3613     02  eibrecv          pic x(1).
  3614     02  eibsend          pic x(1).
  3615     02  eibatt           pic x(1).
  3616     02  eibeoc           pic x(1).
  3617     02  eibfmh           pic x(1).
  3618     02  eibcompl         pic x(1).
  3619     02  eibsig           pic x(1).
  3620     02  eibconf          pic x(1).
  3621     02  eiberr           pic x(1).
  3622     02  eibrldbk         pic x(1).
  3623     02  eiberrcd         pic x(4).
  3624     02  eibsynrb         pic x(1).
  3625     02  eibnodat         pic x(1).
  3626     02  eibfiller5       pic x(2).
  3627     02  eibresp          pic s9(8) comp.
  3628     02  eibresp2         pic s9(8) comp.
  3629     02  dfheigdj         pic s9(4) comp.
  3630     02  dfheigdk         pic s9(4) comp.
  3631 01  DFHCOMMAREA                 PIC X(1024).
  3632
  3633*                                COPY ELCMSTR.
  3634******************************************************************
  3635*                                                                *
  3636*                            ELCMSTR.                            *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  67
* EL131.cbl
  3637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3638*                            VMOD=2.012                          *
  3639*                                                                *
  3640*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3641*                                                                *
  3642*   FILE TYPE = VSAM,KSDS                                        *
  3643*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3644*                                                                *
  3645*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3646*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3647*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3648*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3649*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3650*                                                 RKP=75,LEN=21  *
  3651*                                                                *
  3652*   **** NOTE ****                                               *
  3653*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3654*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3655*                                                                *
  3656*   LOG = YES                                                    *
  3657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3658******************************************************************
  3659*                   C H A N G E   L O G
  3660*
  3661* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3662*-----------------------------------------------------------------
  3663*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3664* EFFECTIVE    NUMBER
  3665*-----------------------------------------------------------------
  3666* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3667* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3668* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3669* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3670* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3671* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3672* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3673******************************************************************
  3674 01  CLAIM-MASTER.
  3675     12  CL-RECORD-ID                PIC XX.
  3676         88  VALID-CL-ID         VALUE 'CL'.
  3677
  3678     12  CL-CONTROL-PRIMARY.
  3679         16  CL-COMPANY-CD           PIC X.
  3680         16  CL-CARRIER              PIC X.
  3681         16  CL-CLAIM-NO             PIC X(7).
  3682         16  CL-CERT-NO.
  3683             20  CL-CERT-PRIME       PIC X(10).
  3684             20  CL-CERT-SFX         PIC X.
  3685
  3686     12  CL-CONTROL-BY-NAME.
  3687         16  CL-COMPANY-CD-A1        PIC X.
  3688         16  CL-INSURED-LAST-NAME    PIC X(15).
  3689         16  CL-INSURED-NAME.
  3690             20  CL-INSURED-1ST-NAME PIC X(12).
  3691             20  CL-INSURED-MID-INIT PIC X.
  3692
  3693     12  CL-CONTROL-BY-SSN.
  3694         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  68
* EL131.cbl
  3695         16  CL-SOC-SEC-NO.
  3696             20  CL-SSN-STATE        PIC XX.
  3697             20  CL-SSN-ACCOUNT      PIC X(6).
  3698             20  CL-SSN-LN3          PIC X(3).
  3699
  3700     12  CL-CONTROL-BY-CERT-NO.
  3701         16  CL-COMPANY-CD-A4        PIC X.
  3702         16  CL-CERT-NO-A4.
  3703             20  CL-CERT-A4-PRIME    PIC X(10).
  3704             20  CL-CERT-A4-SFX      PIC X.
  3705
  3706     12  CL-CONTROL-BY-CCN.
  3707         16  CL-COMPANY-CD-A5        PIC X.
  3708         16  CL-CCN-A5.
  3709             20  CL-CCN.
  3710                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3711                 24  CL-CCN-PRIME-A5 PIC X(12).
  3712             20  CL-CCN-FILLER-A5    PIC X(4).
  3713
  3714     12  CL-INSURED-PROFILE-DATA.
  3715         16  CL-INSURED-BIRTH-DT     PIC XX.
  3716         16  CL-INSURED-SEX-CD       PIC X.
  3717             88  INSURED-IS-MALE        VALUE 'M'.
  3718             88  INSURED-IS-FEMALE      VALUE 'F'.
  3719             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3720         16  CL-INSURED-OCC-CD       PIC X(6).
  3721         16  FILLER                  PIC X(5).
  3722
  3723     12  CL-PROCESSING-INFO.
  3724         16  CL-PROCESSOR-ID         PIC X(4).
  3725         16  CL-CLAIM-STATUS         PIC X.
  3726             88  CLAIM-IS-OPEN          VALUE 'O'.
  3727             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3728         16  CL-CLAIM-TYPE           PIC X.
  3729*            88  AH-CLAIM               VALUE 'A'.
  3730*            88  LIFE-CLAIM             VALUE 'L'.
  3731*            88  PROPERTY-CLAIM         VALUE 'P'.
  3732*            88  IUI-CLAIM              VALUE 'I'.
  3733*            88  GAP-CLAIM              VALUE 'G'.
  3734*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3735*            88  OTHER-CLAIM            VALUE 'O'.
  3736         16  CL-CLAIM-PREM-TYPE      PIC X.
  3737             88  SINGLE-PREMIUM         VALUE '1'.
  3738             88  O-B-COVERAGE           VALUE '2'.
  3739             88  OPEN-END-COVERAGE      VALUE '3'.
  3740         16  CL-INCURRED-DT          PIC XX.
  3741         16  CL-REPORTED-DT          PIC XX.
  3742         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3743         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3744         16  CL-LAST-PMT-DT          PIC XX.
  3745         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3746         16  CL-PAID-THRU-DT         PIC XX.
  3747         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3748         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3749         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3750         16  CL-PMT-CALC-METHOD      PIC X.
  3751             88  CL-360-DAY-YR          VALUE '1'.
  3752             88  CL-365-DAY-YR          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  69
* EL131.cbl
  3753             88  CL-FULL-MONTHS         VALUE '3'.
  3754         16  CL-CAUSE-CD             PIC X(6).
  3755
  3756         16  CL-PRIME-CERT-NO.
  3757             20  CL-PRIME-CERT-PRIME PIC X(10).
  3758             20  CL-PRIME-CERT-SFX   PIC X.
  3759
  3760         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3761             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3762             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3763
  3764         16  CL-MICROFILM-NO         PIC X(10).
  3765         16  FILLER REDEFINES CL-MICROFILM-NO.
  3766             20  CL-BENEFIT-PERIOD   PIC 99.
  3767             20  FILLER              PIC X(8).
  3768         16  CL-PROG-FORM-TYPE       PIC X.
  3769         16  CL-LAST-ADD-ON-DT       PIC XX.
  3770
  3771         16  CL-LAST-REOPEN-DT       PIC XX.
  3772         16  CL-LAST-CLOSE-DT        PIC XX.
  3773         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3774             88  FINAL-PAID             VALUE '1'.
  3775             88  CLAIM-DENIED           VALUE '2'.
  3776             88  AUTO-CLOSE             VALUE '3'.
  3777             88  MANUAL-CLOSE           VALUE '4'.
  3778             88  BENEFITS-CHANGED       VALUE 'C'.
  3779             88  SETUP-ERRORS           VALUE 'E'.
  3780         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3781         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3782         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3783             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3784         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3785         16  FILLER                  PIC X.
  3786
  3787     12  CL-CERTIFICATE-DATA.
  3788         16  CL-CERT-ORIGIN          PIC X.
  3789             88  CERT-WAS-ONLINE        VALUE '1'.
  3790             88  CERT-WAS-CREATED       VALUE '2'.
  3791             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3792         16  CL-CERT-KEY-DATA.
  3793             20  CL-CERT-CARRIER     PIC X.
  3794             20  CL-CERT-GROUPING    PIC X(6).
  3795             20  CL-CERT-STATE       PIC XX.
  3796             20  CL-CERT-ACCOUNT.
  3797                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3798                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3799             20  CL-CERT-EFF-DT      PIC XX.
  3800
  3801     12  CL-STATUS-CONTROLS.
  3802         16  CL-PRIORITY-CD          PIC X.
  3803             88  CONFIDENTIAL-DATA      VALUE '8'.
  3804             88  HIGHEST-PRIORITY       VALUE '9'.
  3805         16  CL-SUPV-ATTN-CD         PIC X.
  3806             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3807             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3808         16  CL-PURGED-DT            PIC XX.
  3809         16  CL-RESTORED-DT          PIC XX.
  3810         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  70
* EL131.cbl
  3811         16  CL-NEXT-RESEND-DT       PIC XX.
  3812         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3813         16  CL-CRITICAL-PERIOD      PIC 99.
  3814*        16  FILLER                  PIC XX.
  3815         16  CL-LAST-MAINT-DT        PIC XX.
  3816         16  CL-LAST-MAINT-USER      PIC X(4).
  3817         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3818         16  CL-LAST-MAINT-TYPE      PIC X.
  3819             88  CLAIM-SET-UP           VALUE ' '.
  3820             88  PAYMENT-MADE           VALUE '1'.
  3821             88  LETTER-SENT            VALUE '2'.
  3822             88  MASTER-WAS-ALTERED     VALUE '3'.
  3823             88  MASTER-WAS-RESTORED    VALUE '4'.
  3824             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3825             88  FILE-CONVERTED         VALUE '6'.
  3826             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3827             88  ERROR-CORRECTION       VALUE 'E'.
  3828         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3829         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3830         16  CL-BENEFICIARY          PIC X(10).
  3831         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3832         16  CL-DENIAL-TYPE          PIC X.
  3833             88  CL-TYPE-DENIAL          VALUE '1'.
  3834             88  CL-TYPE-RESCISSION      VALUE '2'.
  3835             88  CL-TYPE-REFORMATION     VALUE '3'.
  3836             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3837             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3838         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3839         16  filler                  pic x(3).
  3840*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3841*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3842*        16  CL-RTW-DT               PIC XX.
  3843
  3844     12  CL-TRAILER-CONTROLS.
  3845         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3846             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3847             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3848             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3849         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3850         16  FILLER                  PIC XX.
  3851         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3852         16  CL-ADDRESS-TRAILER-CNT.
  3853             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3854                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3855             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3856                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3857             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3858                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3859             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3860                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3861             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3862                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3863             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3864                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3865             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3866                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3867
  3868     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  71
* EL131.cbl
  3869         16  CL-CV-REFNO-PRIME       PIC X(18).
  3870         16  CL-CV-REFNO-SFX         PIC XX.
  3871
  3872     12  CL-FILE-LOCATION            PIC X(4).
  3873
  3874     12  CL-PROCESS-ERRORS.
  3875         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3876             88  NO-FATAL-ERRORS        VALUE ZERO.
  3877         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3878             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3879
  3880     12  CL-PRODUCT-CD               PIC X.
  3881
  3882     12  CL-CURRENT-KEY-DATA.
  3883         16  CL-CURRENT-CARRIER      PIC X.
  3884         16  CL-CURRENT-GROUPING     PIC X(6).
  3885         16  CL-CURRENT-STATE        PIC XX.
  3886         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3887
  3888     12  CL-ASSOCIATES               PIC X.
  3889         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3890         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3891         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3892         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3893
  3894     12  CL-ACTIVITY-CODE            PIC 99.
  3895     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3896     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3897
  3898     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3899     12  CL-LAG-REPORT-CODE          PIC 9.
  3900     12  CL-LOAN-TYPE                PIC XX.
  3901     12  CL-LEGAL-STATE              PIC XX.
  3902
  3903     12  CL-YESNOSW                  PIC X.
  3904     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3905         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3906         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3907         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3908     12  cl-insured-type             pic x.
  3909         88  cl-claim-on-primary         value 'P'.
  3910         88  cl-claim-on-co-borrower     value 'C'.
  3911     12  cl-benefit-expiration-dt    PIC XX.
  3912
  3913*                                COPY ELCCERT.
  3914******************************************************************
  3915*                                                                *
  3916*                            ELCCERT.                            *
  3917*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3918*                            VMOD=2.013                          *
  3919*                                                                *
  3920*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3921*                                                                *
  3922*   FILE TYPE = VSAM,KSDS                                        *
  3923*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3924*                                                                *
  3925*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3926*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  72
* EL131.cbl
  3927*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3928*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3929*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3930*                                                                *
  3931*   LOG = YES                                                    *
  3932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3933******************************************************************
  3934*                   C H A N G E   L O G
  3935*
  3936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3937*-----------------------------------------------------------------
  3938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3939* EFFECTIVE    NUMBER
  3940*-----------------------------------------------------------------
  3941* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3942* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3943* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3944* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3945* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3946* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3947* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3948* 032612  CR2011110200001  PEMA  AHL CHANGES
  3949* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3950* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3951* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3952******************************************************************
  3953
  3954 01  CERTIFICATE-MASTER.
  3955     12  CM-RECORD-ID                      PIC XX.
  3956         88  VALID-CM-ID                      VALUE 'CM'.
  3957
  3958     12  CM-CONTROL-PRIMARY.
  3959         16  CM-COMPANY-CD                 PIC X.
  3960         16  CM-CARRIER                    PIC X.
  3961         16  CM-GROUPING.
  3962             20  CM-GROUPING-PREFIX        PIC X(3).
  3963             20  CM-GROUPING-PRIME         PIC X(3).
  3964         16  CM-STATE                      PIC XX.
  3965         16  CM-ACCOUNT.
  3966             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3967             20  CM-ACCOUNT-PRIME          PIC X(6).
  3968         16  CM-CERT-EFF-DT                PIC XX.
  3969         16  CM-CERT-NO.
  3970             20  CM-CERT-PRIME             PIC X(10).
  3971             20  CM-CERT-SFX               PIC X.
  3972
  3973     12  CM-CONTROL-BY-NAME.
  3974         16  CM-COMPANY-CD-A1              PIC X.
  3975         16  CM-INSURED-LAST-NAME          PIC X(15).
  3976         16  CM-INSURED-INITIALS.
  3977             20  CM-INSURED-INITIAL1       PIC X.
  3978             20  CM-INSURED-INITIAL2       PIC X.
  3979
  3980     12  CM-CONTROL-BY-SSN.
  3981         16  CM-COMPANY-CD-A2              PIC X.
  3982         16  CM-SOC-SEC-NO.
  3983             20  CM-SSN-STATE              PIC XX.
  3984             20  CM-SSN-ACCOUNT            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  73
* EL131.cbl
  3985             20  CM-SSN-LN3.
  3986                 25  CM-INSURED-INITIALS-A2.
  3987                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3988                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3989                 25 CM-PART-LAST-NAME-A2         PIC X.
  3990
  3991     12  CM-CONTROL-BY-CERT-NO.
  3992         16  CM-COMPANY-CD-A4              PIC X.
  3993         16  CM-CERT-NO-A4                 PIC X(11).
  3994
  3995     12  CM-CONTROL-BY-MEMB.
  3996         16  CM-COMPANY-CD-A5              PIC X.
  3997         16  CM-MEMBER-NO.
  3998             20  CM-MEMB-STATE             PIC XX.
  3999             20  CM-MEMB-ACCOUNT           PIC X(6).
  4000             20  CM-MEMB-LN4.
  4001                 25  CM-INSURED-INITIALS-A5.
  4002                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4003                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4004                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4005
  4006     12  CM-INSURED-PROFILE-DATA.
  4007         16  CM-INSURED-FIRST-NAME.
  4008             20  CM-INSURED-1ST-INIT       PIC X.
  4009             20  FILLER                    PIC X(9).
  4010         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4011         16  CM-INSURED-SEX                PIC X.
  4012             88  CM-SEX-MALE                  VALUE 'M'.
  4013             88  CM-SEX-FEMAL                 VALUE 'F'.
  4014         16  CM-INSURED-JOINT-AGE          PIC 99.
  4015         16  CM-JOINT-INSURED-NAME.
  4016             20  CM-JT-LAST-NAME           PIC X(15).
  4017             20  CM-JT-FIRST-NAME.
  4018                 24  CM-JT-1ST-INIT        PIC X.
  4019                 24  FILLER                PIC X(9).
  4020             20  CM-JT-INITIAL             PIC X.
  4021
  4022     12  CM-LIFE-DATA.
  4023         16  CM-LF-BENEFIT-CD              PIC XX.
  4024         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4025         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4026         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4027         16  CM-LF-DEV-CODE                PIC XXX.
  4028         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4029         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4030         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4031         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4032         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4033         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4034         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4035         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4036         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4037         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4038         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4039         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4040         16  cm-temp-epiq                  pic xx.
  4041             88  EPIQ-CLASS                  value 'EQ'.
  4042*        16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  74
* EL131.cbl
  4043
  4044     12  CM-AH-DATA.
  4045         16  CM-AH-BENEFIT-CD              PIC XX.
  4046         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4047         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4048         16  CM-AH-DEV-CODE                PIC XXX.
  4049         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4050         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4051         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4052         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4053         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4054         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4055         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4056         16  CM-AH-PAID-THRU-DT            PIC XX.
  4057             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4058         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4059         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4060         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4061         16  FILLER                        PIC X.
  4062
  4063     12  CM-LOAN-INFORMATION.
  4064         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4065         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4066                                           PIC S9(5)V99  COMP-3.
  4067         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4068         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4069         16  CM-PAY-FREQUENCY              PIC S99.
  4070         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4071         16  CM-RATE-CLASS                 PIC XX.
  4072         16  CM-BENEFICIARY                PIC X(25).
  4073         16  CM-POLICY-FORM-NO             PIC X(12).
  4074         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4075         16  CM-LAST-ADD-ON-DT             PIC XX.
  4076         16  CM-DEDUCTIBLE-AMOUNTS.
  4077             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4078             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4079         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4080             20  CM-RESIDENT-STATE         PIC XX.
  4081             20  CM-RATE-CODE              PIC X(4).
  4082             20  FILLER                    PIC XX.
  4083         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4084             20  CM-LOAN-OFFICER           PIC X(5).
  4085             20  FILLER                    PIC XXX.
  4086         16  CM-CSR-CODE                   PIC XXX.
  4087         16  CM-UNDERWRITING-CODE          PIC X.
  4088             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4089         16  CM-POST-CARD-IND              PIC X.
  4090         16  CM-REF-INTERFACE-SW           PIC X.
  4091         16  CM-PREMIUM-TYPE               PIC X.
  4092             88  CM-SING-PRM                  VALUE '1'.
  4093             88  CM-O-B-COVERAGE              VALUE '2'.
  4094             88  CM-OPEN-END                  VALUE '3'.
  4095         16  CM-IND-GRP-TYPE               PIC X.
  4096             88  CM-INDIVIDUAL                VALUE 'I'.
  4097             88  CM-GROUP                     VALUE 'G'.
  4098         16  CM-SKIP-CODE                  PIC X.
  4099             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4100             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  75
* EL131.cbl
  4101             88  SKIP-AUGUST                  VALUE '2'.
  4102             88  SKIP-SEPTEMBER               VALUE '3'.
  4103             88  SKIP-JULY-AUG                VALUE '4'.
  4104             88  SKIP-AUG-SEPT                VALUE '5'.
  4105             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4106             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4107             88  SKIP-JUNE                    VALUE '8'.
  4108             88  SKIP-JUNE-JULY               VALUE '9'.
  4109             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4110             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4111         16  CM-PAYMENT-MODE               PIC X.
  4112             88  PAY-MONTHLY                  VALUE SPACE.
  4113             88  PAY-WEEKLY                   VALUE '1'.
  4114             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4115             88  PAY-BI-WEEKLY                VALUE '3'.
  4116             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4117         16  CM-LOAN-NUMBER                PIC X(8).
  4118         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4119         16  CM-OLD-LOF                    PIC XXX.
  4120*        16  CM-LOAN-OFFICER               PIC XXX.
  4121         16  CM-REIN-TABLE                 PIC XXX.
  4122         16  CM-SPECIAL-REIN-CODE          PIC X.
  4123         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4124         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4125         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4126
  4127     12  CM-STATUS-DATA.
  4128         16  CM-ENTRY-STATUS               PIC X.
  4129         16  CM-ENTRY-DT                   PIC XX.
  4130
  4131         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4132         16  CM-LF-CANCEL-DT               PIC XX.
  4133         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4134
  4135         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4136         16  CM-LF-DEATH-DT                PIC XX.
  4137         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4138
  4139         16  CM-LF-CURRENT-STATUS          PIC X.
  4140             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4141                                                'M' '4' '5' '9'.
  4142             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4143             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4144             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4145             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4146             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4147             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4148             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4149             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4150             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4151             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4152             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4153             88  CM-LF-DECLINED               VALUE 'D'.
  4154             88  CM-LF-VOIDED                 VALUE 'V'.
  4155
  4156         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4157         16  CM-AH-CANCEL-DT               PIC XX.
  4158         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  76
* EL131.cbl
  4159
  4160         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4161         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4162         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4163
  4164         16  CM-AH-CURRENT-STATUS          PIC X.
  4165             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4166                                                'M' '4' '5' '9'.
  4167             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4168             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4169             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4170             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4171             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4172             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4173             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4174             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4175             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4176             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4177             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4178             88  CM-AH-DECLINED               VALUE 'D'.
  4179             88  CM-AH-VOIDED                 VALUE 'V'.
  4180
  4181         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4182             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4183             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4184             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4185         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4186
  4187         16  CM-ENTRY-BATCH                PIC X(6).
  4188         16  CM-LF-EXIT-BATCH              PIC X(6).
  4189         16  CM-AH-EXIT-BATCH              PIC X(6).
  4190         16  CM-LAST-MONTH-END             PIC XX.
  4191
  4192     12  CM-NOTE-SW                        PIC X.
  4193         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4194         88  CERT-NOTES-PRESENT               VALUE '1'.
  4195         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4196         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4197         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4198         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4199         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4200         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4201     12  CM-COMP-EXCP-SW                   PIC X.
  4202         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4203         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4204     12  CM-INSURED-ADDRESS-SW             PIC X.
  4205         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4206         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4207
  4208*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4209     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4210     12  FILLER                            PIC X.
  4211
  4212*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4213     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4214     12  FILLER                            PIC X.
  4215*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4216     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  77
* EL131.cbl
  4217
  4218     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4219         88  CERT-ADDED-BATCH                 VALUE ' '.
  4220         88  CERT-ADDED-ONLINE                VALUE '1'.
  4221         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4222         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4223         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4224     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4225         88  CERT-AS-LOADED                   VALUE ' '.
  4226         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4227         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4228         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4229         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4230         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4231         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4232         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4233
  4234     12  CM-ACCOUNT-COMM-PCTS.
  4235         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4236         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4237
  4238     12  CM-USER-FIELD                     PIC X.
  4239     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4240     12  CM-CLP-STATE                      PIC XX.
  4241     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4242     12  CM-USER-RESERVED                  PIC XXX.
  4243     12  FILLER REDEFINES CM-USER-RESERVED.
  4244         16  CM-AH-CLASS-CD                PIC XX.
  4245         16  F                             PIC X.
  4246******************************************************************
  4247
  4248*                                COPY ELCTRLR.
  4249******************************************************************
  4250*                                                                *
  4251*                            ELCTRLR.                            *
  4252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4253*                            VMOD=2.014                          *
  4254*                                                                *
  4255*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4256*                                                                *
  4257*   FILE TYPE = VSAM,KSDS                                        *
  4258*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4259*                                                                *
  4260*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4261*       ALTERNATE INDEX = NONE                                   *
  4262*                                                                *
  4263*   LOG = YES                                                    *
  4264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4265******************************************************************
  4266*                   C H A N G E   L O G
  4267*
  4268* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4269*-----------------------------------------------------------------
  4270*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4271* EFFECTIVE    NUMBER
  4272*-----------------------------------------------------------------
  4273* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4274* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  78
* EL131.cbl
  4275* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4276* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4277* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4278* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4279* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4280* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4281* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4282* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4283* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4284* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4285* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4286* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4287* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4288* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4289* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4290* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4291* 040814    2014030500002  AJRA  ADD ICD CODES
  4292* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4293* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4294* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4295* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4296* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  4297******************************************************************
  4298 01  ACTIVITY-TRAILERS.
  4299     12  AT-RECORD-ID                    PIC XX.
  4300         88  VALID-AT-ID                       VALUE 'AT'.
  4301
  4302     12  AT-CONTROL-PRIMARY.
  4303         16  AT-COMPANY-CD               PIC X.
  4304         16  AT-CARRIER                  PIC X.
  4305         16  AT-CLAIM-NO                 PIC X(7).
  4306         16  AT-CERT-NO.
  4307             20  AT-CERT-PRIME           PIC X(10).
  4308             20  AT-CERT-SFX             PIC X.
  4309         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4310             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4311             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4312             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4313             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4314             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4315             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4316             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4317             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4318             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4319             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4320             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4321             88  AT-BENEFICIARY-TRL           VALUE +91.
  4322             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4323             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4324             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4325             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4326
  4327     12  AT-TRAILER-TYPE                 PIC X.
  4328         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4329         88  PAYMENT-TR                       VALUE '2'.
  4330         88  AUTO-PAY-TR                      VALUE '3'.
  4331         88  CORRESPONDENCE-TR                VALUE '4'.
  4332         88  ADDRESS-TR                       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  79
* EL131.cbl
  4333         88  GENERAL-INFO-TR                  VALUE '6'.
  4334         88  AUTO-PROMPT-TR                   VALUE '7'.
  4335         88  DENIAL-TR                        VALUE '8'.
  4336         88  INCURRED-CHG-TR                  VALUE '9'.
  4337         88  FORM-CONTROL-TR                  VALUE 'A'.
  4338
  4339     12  AT-RECORDED-DT                  PIC XX.
  4340     12  AT-RECORDED-BY                  PIC X(4).
  4341     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4342
  4343     12  AT-TRAILER-BODY                 PIC X(165).
  4344
  4345     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4346         16  AT-RESERVE-CONTROLS.
  4347             20  AT-MANUAL-SW            PIC X.
  4348                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4349             20  AT-FUTURE-SW            PIC X.
  4350                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4351             20  AT-PTC-SW               PIC X.
  4352                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4353             20  AT-IBNR-SW              PIC X.
  4354                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4355             20  AT-PTC-LF-SW            PIC X.
  4356                 88  AT-LF-PTC-USED          VALUE '1'.
  4357             20  AT-CDT-ACCESS-METHOD    PIC X.
  4358                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4359                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4360                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4361             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4362         16  AT-LAST-COMPUTED-DT         PIC XX.
  4363         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4364         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4365         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4366         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4367         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4368         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4369         16  AT-EXPENSE-CONTROLS.
  4370             20  AT-EXPENSE-METHOD       PIC X.
  4371                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4372                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4373                 88  PERCENT-OF-PMT           VALUE '3'.
  4374                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4375             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4376             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4377         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4378         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4379
  4380         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4381         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4382
  4383*        16  FILLER                      PIC X(53).
  4384         16  FILLER                      PIC X(47).
  4385
  4386         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4387         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4388
  4389         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4390             20  AT-OPEN-CLOSE-DATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  80
* EL131.cbl
  4391             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4392*                    C = CLOSED
  4393*                    O = OPEN
  4394             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4395*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4396
  4397     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4398         16  AT-PAYMENT-TYPE             PIC X.
  4399             88  PARTIAL-PAYMENT                VALUE '1'.
  4400             88  FINAL-PAYMENT                  VALUE '2'.
  4401             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4402             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4403             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4404             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4405             88  VOIDED-PAYMENT                 VALUE '9'.
  4406             88  TRANSFER                       VALUE 'T'.
  4407             88  LIFE-INTEREST                  VALUE 'I'.
  4408
  4409         16  AT-CLAIM-TYPE               PIC X.
  4410             88  PAID-FOR-AH                    VALUE 'A'.
  4411             88  PAID-FOR-LIFE                  VALUE 'L'.
  4412             88  PAID-FOR-IUI                   VALUE 'I'.
  4413             88  PAID-FOR-GAP                   VALUE 'G'.
  4414             88  PAID-FOR-FAM                   VALUE 'F'.
  4415             88  PAID-FOR-OTH                   VALUE 'O'.
  4416         16  AT-CLAIM-PREM-TYPE          PIC X.
  4417             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4418             88  AT-O-B-COVERAGE                VALUE '2'.
  4419             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4420         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4421         16  AT-CHECK-NO                 PIC X(7).
  4422         16  AT-PAID-FROM-DT             PIC XX.
  4423         16  AT-PAID-THRU-DT             PIC XX.
  4424         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4425         16  AT-ACH-PAYMENT              PIC X.
  4426*        16  FILLER                      PIC X.
  4427         16  AT-PAYEES-NAME              PIC X(30).
  4428         16  AT-PAYMENT-ORIGIN           PIC X.
  4429             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4430             88  ONLINE-AUTO-PMT                VALUE '2'.
  4431             88  OFFLINE-PMT                    VALUE '3'.
  4432         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4433         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4434         16  AT-VOID-DATA.
  4435             20  AT-VOID-DT              PIC XX.
  4436*00144       20  AT-VOID-REASON          PIC X(30).
  4437             20  AT-VOID-REASON          PIC X(26).
  4438         16  AT-PMT-APPROVED-BY          PIC X(04).
  4439         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4440         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4441         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4442                                         PIC S99V9(5)  COMP-3.
  4443         16  AT-CREDIT-INTERFACE.
  4444             20  AT-PMT-SELECT-DT        PIC XX.
  4445                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4446             20  AT-PMT-ACCEPT-DT        PIC XX.
  4447                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4448             20  AT-VOID-SELECT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  81
* EL131.cbl
  4449                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4450             20  AT-VOID-ACCEPT-DT       PIC XX.
  4451                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4452
  4453         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4454                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4455                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4456         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4457
  4458         16  AT-FORCE-CONTROL            PIC X.
  4459             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4460         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4461         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4462         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4463         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4464         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4465         16  AT-BENEFIT-TYPE             PIC X.
  4466
  4467         16  AT-EXPENSE-TYPE             PIC X.
  4468         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4469
  4470         16  AT-PAYEE-TYPE-CD.
  4471             20  AT-PAYEE-TYPE           PIC X.
  4472                 88  INSURED-PAID           VALUE 'I'.
  4473                 88  BENEFICIARY-PAID       VALUE 'B'.
  4474                 88  ACCOUNT-PAID           VALUE 'A'.
  4475                 88  OTHER-1-PAID           VALUE 'O'.
  4476                 88  OTHER-2-PAID           VALUE 'Q'.
  4477                 88  DOCTOR-PAID            VALUE 'P'.
  4478                 88  EMPLOYER-PAID          VALUE 'E'.
  4479             20  AT-PAYEE-SEQ            PIC X.
  4480
  4481         16  AT-CASH-PAYMENT             PIC X.
  4482         16  AT-GROUPED-PAYMENT          PIC X.
  4483         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4484         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4485         16  AT-APPROVED-LEVEL           PIC X.
  4486         16  AT-VOID-TYPE                PIC X.
  4487             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4488             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4489         16  AT-AIG-UNEMP-IND            PIC X.
  4490             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4491         16  AT-ASSOCIATES               PIC X.
  4492             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4493             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4494
  4495         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4496         16  AT-CV-PMT-CODE              PIC X.
  4497             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4498             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4499             88  FULL-ADD-PAYMENT           VALUE '3'.
  4500             88  HALF-ADD-PAYMENT           VALUE '4'.
  4501             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4502             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4503             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4504             88  ADDL-PAYMENT               VALUE '8'.
  4505
  4506         16  AT-EOB-CODE1                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  82
* EL131.cbl
  4507         16  AT-EOB-CODE2                PIC XXX.
  4508         16  AT-EOB-CODE3                PIC XXX.
  4509         16  FILLER REDEFINES AT-EOB-CODE3.
  4510             20  AT-PRINT-CLM-FORM       PIC X.
  4511             20  AT-PRINT-SURVEY         PIC X.
  4512             20  AT-SPECIAL-RELEASE      PIC X.
  4513         16  AT-EOB-CODE4                PIC XXX.
  4514         16  FILLER REDEFINES AT-EOB-CODE4.
  4515             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4516             20  FILLER                  PIC X.
  4517         16  AT-EOB-CODE5                PIC XXX.
  4518         16  FILLER REDEFINES AT-EOB-CODE5.
  4519             20  AT-PMT-PROOF-DT         PIC XX.
  4520             20  FILLER                  PIC X.
  4521
  4522         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4523             88  AT-PRINT-EOB            VALUE 'Y'.
  4524
  4525         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4526         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4527
  4528     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4529         16  AT-SCHEDULE-START-DT        PIC XX.
  4530         16  AT-SCHEDULE-END-DT          PIC XX.
  4531         16  AT-TERMINATED-DT            PIC XX.
  4532         16  AT-LAST-PMT-TYPE            PIC X.
  4533             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4534             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4535         16  AT-FIRST-PMT-DATA.
  4536             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4537             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4538             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4539         16  AT-REGULAR-PMT-DATA.
  4540             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4541             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4542             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4543         16  AT-AUTO-PAYEE-CD.
  4544             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4545                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4546                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4547                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4548                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4549                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4550             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4551         16  AT-AUTO-PAY-DAY             PIC 99.
  4552         16  AT-AUTO-CASH                PIC X.
  4553             88  AT-CASH                      VALUE 'Y'.
  4554             88  AT-NON-CASH                  VALUE 'N'.
  4555*        16  FILLER                      PIC X(129).
  4556         16  AT-AUTO-END-LETTER          PIC X(4).
  4557         16  FILLER                      PIC X(125).
  4558
  4559         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4560         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4561
  4562     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4563         16  AT-LETTER-SENT-DT           PIC XX.
  4564         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  83
* EL131.cbl
  4565         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4566         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4567         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4568         16  AT-LETTER-ORIGIN            PIC X.
  4569             88  ONLINE-CREATION              VALUE '1' '3'.
  4570             88  OFFLINE-CREATION             VALUE '2' '4'.
  4571             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4572             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4573         16  AT-STD-LETTER-FORM          PIC X(4).
  4574         16  AT-REASON-TEXT              PIC X(70).
  4575         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4576         16  AT-ADDRESEE-TYPE            PIC X.
  4577              88  INSURED-ADDRESEE            VALUE 'I'.
  4578              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4579              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4580              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4581              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4582              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4583              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4584         16  AT-ADDRESSEE-NAME           PIC X(30).
  4585         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4586         16  AT-RESEND-PRINT-DATE        PIC XX.
  4587         16  AT-CORR-SOL-UNSOL           PIC X.
  4588         16  AT-LETTER-PURGED-DT         PIC XX.
  4589*
  4590*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4591*
  4592         16  AT-CSO-REDEFINITION.
  4593             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4594             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4595             20  AT-LETTER-TO-BENE       PIC X(1).
  4596             20  AT-STOP-LETTER-DT       PIC X(2).
  4597             20  AT-AUTH-RCVD            PIC X(1).
  4598             20  FILLER                  PIC X(18).
  4599*             20  FILLER                  PIC X(27).
  4600             20  AT-CSO-LETTER-STATUS    PIC X.
  4601                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4602                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4603                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4604             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4605             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4606*
  4607*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4608*
  4609*        16  FILLER                      PIC X(26).
  4610*
  4611*        16  AT-DMD-BSR-CODE             PIC X.
  4612*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4613*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4614*
  4615*        16  AT-DMD-LETTER-STATUS        PIC X.
  4616*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4617*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4618*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4619*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4620*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4621
  4622         16  AT-CORR-LAST-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  84
* EL131.cbl
  4623         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4624
  4625     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4626         16  AT-ADDRESS-TYPE             PIC X.
  4627             88  INSURED-ADDRESS               VALUE 'I'.
  4628             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4629             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4630             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4631             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4632             88  OTHER-ADDRESS-1               VALUE 'O'.
  4633             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4634         16  AT-MAIL-TO-NAME             PIC X(30).
  4635         16  AT-ADDRESS-LINE-1           PIC X(30).
  4636         16  AT-ADDRESS-LINE-2           PIC X(30).
  4637         16  AT-CITY-STATE.
  4638             20  AT-CITY                 PIC X(28).
  4639             20  AT-STATE                PIC XX.
  4640         16  AT-ZIP.
  4641             20  AT-ZIP-CODE.
  4642                 24  AT-ZIP-1ST          PIC X.
  4643                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4644                 24  FILLER              PIC X(4).
  4645             20  AT-ZIP-PLUS4            PIC X(4).
  4646         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4647             20  AT-CAN-POSTAL-1         PIC XXX.
  4648             20  AT-CAN-POSTAL-2         PIC XXX.
  4649             20  FILLER                  PIC XXX.
  4650         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4651*         16  FILLER                      PIC X(23).
  4652         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4653         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4654         16  FILLER                      PIC X(13).
  4655         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4656         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4657
  4658     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4659         16  AT-INFO-LINE-1              PIC X(60).
  4660         16  FILLER REDEFINES AT-INFO-LINE-1.
  4661             20  AT-NOTE-ERROR-NO OCCURS 15
  4662                                         PIC X(4).
  4663         16  AT-INFO-LINE-2              PIC X(60).
  4664         16  FILLER REDEFINES AT-INFO-LINE-2.
  4665             20  AT-ICD-CODE-1           PIC X(8).
  4666             20  AT-ICD-CODE-2           PIC X(8).
  4667             20  FILLER                  PIC X(44).
  4668         16  AT-INFO-TRAILER-TYPE        PIC X.
  4669             88  AT-ERRORS-NOTE          VALUE 'E'.
  4670             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4671             88  AT-CALL-NOTE            VALUE 'C'.
  4672             88  AT-MAINT-NOTE           VALUE 'M'.
  4673             88  AT-CERT-CHANGE          VALUE 'X'.
  4674             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4675             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4676             88  AT-CERT-CANCELLED       VALUE 'T'.
  4677         16  AT-CALL-TYPE                PIC X.
  4678             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4679             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  4680             88  AT-PHONE-CALL-OUT       VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  85
* EL131.cbl
  4681         16  AT-NOTE-CONTINUATION        PIC X.
  4682             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4683         16  AT-EOB-CODES-EXIST          PIC X.
  4684             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4685         16  FILLER                      PIC X(35).
  4686         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4687         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4688
  4689     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4690         16  AT-PROMPT-LINE-1            PIC X(60).
  4691         16  AT-PROMPT-LINE-2            PIC X(60).
  4692         16  AT-PROMPT-START-DT          PIC XX.
  4693         16  AT-PROMPT-END-DT            PIC XX.
  4694         16  FILLER                      PIC X(35).
  4695         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4696         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4697
  4698     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4699         16  AT-DENIAL-INFO-1            PIC X(60).
  4700         16  AT-DENIAL-INFO-2            PIC X(60).
  4701         16  AT-DENIAL-DT                PIC XX.
  4702         16  AT-RETRACTION-DT            PIC XX.
  4703         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4704*         16  FILLER                      PIC X(31).
  4705         16  AT-DENIAL-PROOF-DT          PIC XX.
  4706         16  FILLER                      PIC X(29).
  4707         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4708         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4709
  4710     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4711         16  AT-OLD-INCURRED-DT          PIC XX.
  4712         16  AT-OLD-REPORTED-DT          PIC XX.
  4713         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4714         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4715         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4716         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4717         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4718         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4719         16  FILLER                      PIC X(26).
  4720         16  AT-OLD-DIAG-CODE            PIC X(6).
  4721         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4722         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4723         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4724         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4725         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4726         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4727         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4728         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4729         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4730         16  FILLER                      PIC X(9).
  4731         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4732
  4733     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4734         16  AT-FORM-SEND-ON-DT          PIC XX.
  4735         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4736         16  AT-FORM-RE-SEND-DT          PIC XX.
  4737         16  AT-FORM-ANSWERED-DT         PIC XX.
  4738         16  AT-FORM-PRINTED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  86
* EL131.cbl
  4739         16  AT-FORM-REPRINT-DT          PIC XX.
  4740         16  AT-FORM-TYPE                PIC X.
  4741             88  INITIAL-FORM                  VALUE '1'.
  4742             88  PROGRESS-FORM                 VALUE '2'.
  4743         16  AT-INSTRUCT-LN-1            PIC X(28).
  4744         16  AT-INSTRUCT-LN-2            PIC X(28).
  4745         16  AT-INSTRUCT-LN-3            PIC X(28).
  4746         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4747         16  AT-FORM-ADDRESS             PIC X.
  4748             88  FORM-TO-INSURED              VALUE 'I'.
  4749             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4750             88  FORM-TO-OTHER-1              VALUE 'O'.
  4751             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4752         16  AT-RELATED-1.
  4753             20 AT-REL-CARR-1            PIC X.
  4754             20 AT-REL-CLAIM-1           PIC X(7).
  4755             20 AT-REL-CERT-1            PIC X(11).
  4756         16  AT-RELATED-2.
  4757             20 AT-REL-CARR-2            PIC X.
  4758             20 AT-REL-CLAIM-2           PIC X(7).
  4759             20 AT-REL-CERT-2            PIC X(11).
  4760         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4761         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4762         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4763         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4764         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4765         16  AT-STOP-FORM-DT             PIC X(2).
  4766
  4767         16  FILLER                      PIC X(09).
  4768         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4769         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4770******************************************************************
  4771
  4772*                                COPY ELCCNTL.
  4773******************************************************************
  4774*                                                                *
  4775*                                                                *
  4776*                            ELCCNTL.                            *
  4777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4778*                            VMOD=2.059                          *
  4779*                                                                *
  4780*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4781*                                                                *
  4782*   FILE TYPE = VSAM,KSDS                                        *
  4783*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4784*                                                                *
  4785*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4786*       ALTERNATE INDEX = NONE                                   *
  4787*                                                                *
  4788*   LOG = YES                                                    *
  4789*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4790******************************************************************
  4791*                   C H A N G E   L O G
  4792*
  4793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4794*-----------------------------------------------------------------
  4795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4796* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  87
* EL131.cbl
  4797*-----------------------------------------------------------------
  4798* 082503                   PEMA  ADD BENEFIT GROUP
  4799* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4800* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4801* 092705    2005050300006  PEMA  ADD SPP LEASES
  4802* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4803* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4804* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4805* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4806* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4807* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4808* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4809* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4810* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4811* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4812* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4813******************************************************************
  4814*
  4815 01  CONTROL-FILE.
  4816     12  CF-RECORD-ID                       PIC XX.
  4817         88  VALID-CF-ID                        VALUE 'CF'.
  4818
  4819     12  CF-CONTROL-PRIMARY.
  4820         16  CF-COMPANY-ID                  PIC XXX.
  4821         16  CF-RECORD-TYPE                 PIC X.
  4822             88  CF-COMPANY-MASTER              VALUE '1'.
  4823             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4824             88  CF-STATE-MASTER                VALUE '3'.
  4825             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4826             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4827             88  CF-CARRIER-MASTER              VALUE '6'.
  4828             88  CF-MORTALITY-MASTER            VALUE '7'.
  4829             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4830             88  CF-TERMINAL-MASTER             VALUE '9'.
  4831             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4832             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4833             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4834             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4835             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4836             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4837             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4838             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4839             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4840         16  CF-ACCESS-CD-GENL              PIC X(4).
  4841         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4842             20  CF-PROCESSOR               PIC X(4).
  4843         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4844             20  CF-STATE-CODE              PIC XX.
  4845             20  FILLER                     PIC XX.
  4846         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4847             20  FILLER                     PIC XX.
  4848             20  CF-HI-BEN-IN-REC           PIC XX.
  4849         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4850             20  FILLER                     PIC XXX.
  4851             20  CF-CARRIER-CNTL            PIC X.
  4852         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4853             20  FILLER                     PIC XX.
  4854             20  CF-HI-TYPE-IN-REC          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  88
* EL131.cbl
  4855         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4856             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4857                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4858             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4859             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4860         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4861             20  FILLER                     PIC X.
  4862             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4863         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4864             20  FILLER                     PIC XX.
  4865             20  CF-MORTGAGE-PLAN           PIC XX.
  4866         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4867
  4868     12  CF-LAST-MAINT-DT                   PIC XX.
  4869     12  CF-LAST-MAINT-BY                   PIC X(4).
  4870     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4871
  4872     12  CF-RECORD-BODY                     PIC X(728).
  4873
  4874
  4875****************************************************************
  4876*             COMPANY MASTER RECORD                            *
  4877****************************************************************
  4878
  4879     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4880         16  CF-COMPANY-ADDRESS.
  4881             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4882             20  CF-CL-IN-CARE-OF           PIC X(30).
  4883             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4884             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4885             20  CF-CL-CITY-STATE           PIC X(30).
  4886             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4887             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4888         16  CF-COMPANY-CD                  PIC X.
  4889         16  CF-COMPANY-PASSWORD            PIC X(8).
  4890         16  CF-SECURITY-OPTION             PIC X.
  4891             88  ALL-SECURITY                   VALUE '1'.
  4892             88  COMPANY-VERIFY                 VALUE '2'.
  4893             88  PROCESSOR-VERIFY               VALUE '3'.
  4894             88  NO-SECURITY                    VALUE '4'.
  4895             88  ALL-BUT-TERM                   VALUE '5'.
  4896         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4897             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4898         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4899             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4900         16  CF-INFORCE-LOCATION            PIC X.
  4901             88  CERTS-ARE-ONLINE               VALUE '1'.
  4902             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4903             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4904         16  CF-LOWER-CASE-LETTERS          PIC X.
  4905         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4906             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4907             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4908             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4909             88  CF-ACCNT-CNTL                  VALUE '3'.
  4910             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4911
  4912         16  CF-FORMS-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  89
* EL131.cbl
  4913         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4914
  4915         16  CF-LGX-CREDIT-USER             PIC X.
  4916             88  CO-IS-NOT-USER                 VALUE 'N'.
  4917             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4918
  4919         16 CF-CREDIT-CALC-CODES.
  4920             20  CF-CR-REM-TERM-CALC PIC X.
  4921               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4922               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4923               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4924               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4925               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4926               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4927               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4928             20  CF-CR-R78-METHOD           PIC X.
  4929               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4930               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4931
  4932         16  CF-CLAIM-CONTROL-COUNTS.
  4933             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4934                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4935
  4936             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4937                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4938
  4939             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4940                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4941
  4942             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4943                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4944
  4945         16  CF-CURRENT-MONTH-END           PIC XX.
  4946
  4947         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4948             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4949             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4950             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4951             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4952                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4953                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4954             20  CF-CO-PREM-REJECT-SW       PIC X.
  4955                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4956                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4957             20  CF-CO-REF-REJECT-SW        PIC X.
  4958                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4959                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4960
  4961         16  CF-CO-REPORTING-DT             PIC XX.
  4962         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4963         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4964           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4965           88  CF-CO-MONTH-END                  VALUE '1'.
  4966
  4967         16  CF-LGX-CLAIM-USER              PIC X.
  4968             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4969             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4970
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  90
* EL131.cbl
  4971         16  CF-CREDIT-EDIT-CONTROLS.
  4972             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4973             20  CF-MIN-AGE                 PIC 99.
  4974             20  CF-DEFAULT-AGE             PIC 99.
  4975             20  CF-MIN-TERM                PIC S999      COMP-3.
  4976             20  CF-MAX-TERM                PIC S999      COMP-3.
  4977             20  CF-DEFAULT-SEX             PIC X.
  4978             20  CF-JOINT-AGE-INPUT         PIC X.
  4979                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4980             20  CF-BIRTH-DATE-INPUT        PIC X.
  4981                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4982             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4983                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4984                 88  CF-ZERO-CARRIER            VALUE '1'.
  4985                 88  CF-ZERO-GROUPING           VALUE '2'.
  4986                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4987             20  CF-EDIT-SW                 PIC X.
  4988                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4989             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4990             20  CF-CR-PR-METHOD            PIC X.
  4991               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4992               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4993             20  FILLER                     PIC X.
  4994
  4995         16  CF-CREDIT-MISC-CONTROLS.
  4996             20  CF-REIN-TABLE-SW           PIC X.
  4997                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4998             20  CF-COMP-TABLE-SW           PIC X.
  4999                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5000             20  CF-EXPERIENCE-RETENTION-AGE
  5001                                            PIC S9        COMP-3.
  5002             20  CF-CONVERSION-DT           PIC XX.
  5003             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5004             20  CF-RUN-FREQUENCY-SW        PIC X.
  5005                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5006                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5007
  5008             20  CF-CR-CHECK-NO-CONTROL.
  5009                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5010                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5011                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5012                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5013                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5014                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5015
  5016                 24  CF-CR-CHECK-COUNT       REDEFINES
  5017                     CF-CR-CHECK-COUNTER      PIC X(4).
  5018
  5019                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5020                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5021
  5022                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5023                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5024                 24  CF-MAIL-PROCESSING       PIC X.
  5025                     88  MAIL-PROCESSING          VALUE 'Y'.
  5026
  5027         16  CF-MISC-SYSTEM-CONTROL.
  5028             20  CF-SYSTEM-C                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  91
* EL131.cbl
  5029                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5030             20  CF-SYSTEM-D                 PIC X.
  5031                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5032             20  CF-SOC-SEC-NO-SW            PIC X.
  5033                 88  SOC-SEC-NO-USED             VALUE '1'.
  5034             20  CF-MEMBER-NO-SW             PIC X.
  5035                 88  MEMBER-NO-USED              VALUE '1'.
  5036             20  CF-TAX-ID-NUMBER            PIC X(11).
  5037             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5038             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5039                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5040                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5041                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5042                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5043             20  CF-SYSTEM-E                 PIC X.
  5044                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5045
  5046         16  CF-LGX-LIFE-USER               PIC X.
  5047             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5048             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5049
  5050         16  CF-CR-MONTH-END-DT             PIC XX.
  5051
  5052         16  CF-FILE-MAINT-DATES.
  5053             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5054                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5055             20  CF-LAST-BATCH       REDEFINES
  5056                 CF-LAST-BATCH-NO               PIC X(4).
  5057             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5058             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5059             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5060             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5061             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5062             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5063             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5064             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5065             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5066             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5067
  5068         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5069         16  FILLER                         PIC X.
  5070
  5071         16  CF-ALT-MORT-CODE               PIC X(4).
  5072         16  CF-MEMBER-CAPTION              PIC X(10).
  5073
  5074         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5075             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5076             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5077             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5078             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5079             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5080
  5081         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5082
  5083         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5084         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5085         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5086         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  92
* EL131.cbl
  5087
  5088         16  CF-AH-OVERRIDE-L1              PIC X.
  5089         16  CF-AH-OVERRIDE-L2              PIC XX.
  5090         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5091         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5092
  5093         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5094         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5095
  5096         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5097         16  CF-AR-LAST-EL860-DT            PIC XX.
  5098         16  CF-MP-MONTH-END-DT             PIC XX.
  5099
  5100         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5101         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5102             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5103
  5104         16  CF-AR-MONTH-END-DT             PIC XX.
  5105
  5106         16  CF-CRDTCRD-USER                PIC X.
  5107             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5108             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5109
  5110         16  CF-CC-MONTH-END-DT             PIC XX.
  5111
  5112         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5113
  5114         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5115             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5116             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5117             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5118         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5119         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5120         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5121         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5122             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5123             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5124         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5125         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5126         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5127             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5128         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5129
  5130         16  CF-CL-ZIP-CODE.
  5131             20  CF-CL-ZIP-PRIME.
  5132                 24  CF-CL-ZIP-1ST          PIC X.
  5133                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5134                 24  FILLER                 PIC X(4).
  5135             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5136         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5137             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5138             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5139             20  FILLER                     PIC XXX.
  5140
  5141         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5142         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5143         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5144         16  CF-CO-OPTION-START-DATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  93
* EL131.cbl
  5145         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5146           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5147                                                      '3' '4'.
  5148           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5149           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5150           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5151           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5152           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5153           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5154
  5155         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5156
  5157         16  CF-PAYMENT-APPROVAL-LEVELS.
  5158             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5159             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5160             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5161             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5162             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5163             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5164
  5165         16  CF-END-USER-REPORTING-USER     PIC X.
  5166             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5167             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5168
  5169         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5170             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5171             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5172
  5173         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5174
  5175         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5176         16  FILLER                         PIC X.
  5177
  5178         16  CF-CREDIT-ARCHIVE-CNTL.
  5179             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5180             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5181             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5182
  5183         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5184
  5185         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5186             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5187             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5188
  5189         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5190             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5191             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5192
  5193         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5194
  5195         16  CF-CO-ACH-ID-CODE              PIC  X.
  5196             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5197             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5198             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5199         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5200         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5201         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5202         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  94
* EL131.cbl
  5203         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5204         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5205         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5206         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5207         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5208                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5209         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5210                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5211
  5212         16  CF-CO-OVER-SHORT.
  5213             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5214             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5215
  5216*         16  FILLER                         PIC X(102).
  5217         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5218             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5219             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5220
  5221         16  CF-AH-APPROVAL-DAYS.
  5222             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5223             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5224             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5225             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5226
  5227         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5228
  5229         16  CF-APPROV-LEV-5.
  5230             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5231             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5232             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5233
  5234         16  FILLER                         PIC X(68).
  5235****************************************************************
  5236*             PROCESSOR/USER RECORD                            *
  5237****************************************************************
  5238
  5239     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5240         16  CF-PROCESSOR-NAME              PIC X(30).
  5241         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5242         16  CF-PROCESSOR-TITLE             PIC X(26).
  5243         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5244                 88  MESSAGE-YES                VALUE 'Y'.
  5245                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5246
  5247*****************************************************
  5248****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5249****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5250****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5251****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5252*****************************************************
  5253
  5254         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5255             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5256             20  CF-APPLICATION-FORCE       PIC X.
  5257             20  CF-INDIVIDUAL-APP.
  5258                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5259                     28  CF-BROWSE-APP      PIC X.
  5260                     28  CF-UPDATE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  95
* EL131.cbl
  5261
  5262         16  CF-CURRENT-TERM-ON             PIC X(4).
  5263         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5264             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5265             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5266             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5267             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5268             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5269             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5270             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5271         16  CF-PROCESSOR-CARRIER           PIC X.
  5272             88  NO-CARRIER-SECURITY            VALUE ' '.
  5273         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5274             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5275         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5276             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5277         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5278             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5279
  5280         16  CF-PROC-SYS-ACCESS-SW.
  5281             20  CF-PROC-CREDIT-CLAIMS-SW.
  5282                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5283                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5284                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5285                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5286             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5287                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5288                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5289             20  CF-PROC-LIFE-GNRLDGR-SW.
  5290                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5291                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5292                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5293                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5294             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5295                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5296                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5297         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5298             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5299             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5300         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5301
  5302         16  CF-APPROVAL-LEVEL                  PIC X.
  5303             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5304             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5305             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5306             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5307             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5308
  5309         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5310
  5311         16  CF-LANGUAGE-TYPE                   PIC X.
  5312             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5313             88  CF-LANG-IS-FR                      VALUE 'F'.
  5314
  5315         16  CF-CSR-IND                         PIC X.
  5316         16  FILLER                             PIC X(239).
  5317
  5318****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  96
* EL131.cbl
  5319*             PROCESSOR/REMINDERS RECORD                       *
  5320****************************************************************
  5321
  5322     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5323         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5324             20  CF-START-REMIND-DT         PIC XX.
  5325             20  CF-END-REMIND-DT           PIC XX.
  5326             20  CF-REMINDER-TEXT           PIC X(50).
  5327         16  FILLER                         PIC X(296).
  5328
  5329
  5330****************************************************************
  5331*             STATE MASTER RECORD                              *
  5332****************************************************************
  5333
  5334     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5335         16  CF-STATE-ABBREVIATION          PIC XX.
  5336         16  CF-STATE-NAME                  PIC X(25).
  5337         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5338         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5339             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5340             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5341             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5342             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5343                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5344                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5345             20  CF-ST-PREM-REJECT-SW       PIC X.
  5346                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5347                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5348             20  CF-ST-REF-REJECT-SW        PIC X.
  5349                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5350                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5351         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5352         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5353         16  CF-ST-REFUND-RULES.
  5354             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5355             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5356             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5357         16  CF-ST-FST-PMT-EXTENSION.
  5358             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5359             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5360                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5361                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5362                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5363                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5364         16  CF-ST-STATE-CALL.
  5365             20  CF-ST-CALL-UNEARNED        PIC X.
  5366             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5367             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5368         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5369             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5370             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5371         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5372         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5373         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5374         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5375         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5376         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  97
* EL131.cbl
  5377         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5378             20  CF-ST-BENEFIT-CD           PIC XX.
  5379             20  CF-ST-BENEFIT-KIND         PIC X.
  5380                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5381                 88  CF-ST-AH-KIND              VALUE 'A'.
  5382             20  CF-ST-REM-TERM-CALC        PIC X.
  5383                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5384                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5385                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5386                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5387                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5388                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5389                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5390                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5391
  5392             20  CF-ST-REFUND-CALC          PIC X.
  5393                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5394                 88  ST-REFD-BY-R78             VALUE '1'.
  5395                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5396                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5397                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5398                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5399                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5400                 88  ST-REFD-UTAH               VALUE '7'.
  5401                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5402                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5403                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5404
  5405             20  CF-ST-EARNING-CALC         PIC X.
  5406                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5407                 88  ST-EARN-BY-R78             VALUE '1'.
  5408                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5409                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5410                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5411                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5412                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5413                 88  ST-EARN-MEAN               VALUE '8'.
  5414                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5415
  5416             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5417                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5418                 88  ST-OVRD-BY-R78             VALUE '1'.
  5419                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5420                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5421                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5422                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5423                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5424                 88  ST-OVRD-MEAN               VALUE '8'.
  5425                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5426             20  cf-st-extra-periods        pic 9.
  5427*            20  FILLER                     PIC X.
  5428
  5429         16  CF-ST-COMMISSION-CAPS.
  5430             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5431             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5432             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5433             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5434         16  CF-COMM-CAP-LIMIT-TO           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  98
* EL131.cbl
  5435                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5436                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5437                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5438
  5439         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5440
  5441         16  CF-ST-STATUTORY-INTEREST.
  5442             20  CF-ST-STAT-DATE-FROM       PIC X.
  5443                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5444                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5445             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5446             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5447             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5448             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5449             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5450
  5451         16  CF-ST-OVER-SHORT.
  5452             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5453             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5454
  5455         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5456
  5457         16  CF-ST-RT-CALC                  PIC X.
  5458
  5459         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5460         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5461         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5462         16  CF-ST-RF-LR-CALC               PIC X.
  5463         16  CF-ST-RF-LL-CALC               PIC X.
  5464         16  CF-ST-RF-LN-CALC               PIC X.
  5465         16  CF-ST-RF-AH-CALC               PIC X.
  5466         16  CF-ST-RF-CP-CALC               PIC X.
  5467*        16  FILLER                         PIC X(206).
  5468*CIDMOD         16  FILLER                         PIC X(192).
  5469         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5470             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5471         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5472         16  CF-ST-VFY-2ND-BENE             PIC X.
  5473         16  CF-ST-CAUSAL-STATE             PIC X.
  5474         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5475         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5476         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5477             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5478         16  CF-ST-NET-ONLY-STATE           PIC X.
  5479             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5480         16  cf-commission-cap-required     pic x.
  5481         16  CF-ST-GA-COMMISSION-CAPS.
  5482             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5483             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5484             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5485             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5486         16  CF-ST-TOT-COMMISSION-CAPS.
  5487             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5488             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5489             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5490             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5491         16  FILLER                         PIC X(156).
  5492
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page  99
* EL131.cbl
  5493****************************************************************
  5494*             BENEFIT MASTER RECORD                            *
  5495****************************************************************
  5496
  5497     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5498         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5499             20  CF-BENEFIT-CODE            PIC XX.
  5500             20  CF-BENEFIT-NUMERIC  REDEFINES
  5501                 CF-BENEFIT-CODE            PIC XX.
  5502             20  CF-BENEFIT-ALPHA           PIC XXX.
  5503             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5504             20  CF-BENEFIT-COMMENT         PIC X(10).
  5505
  5506             20  CF-LF-COVERAGE-TYPE        PIC X.
  5507                 88  CF-REDUCING                VALUE 'R'.
  5508                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5509
  5510             20  CF-SPECIAL-CALC-CD         PIC X.
  5511                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5512                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5513                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5514                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5515                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5516                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5517                 88  CF-FARM-PLAN               VALUE 'F'.
  5518                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5519                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5520                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5521                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5522                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5523                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5524                 88  CF-PRUDENTIAL              VALUE 'P'.
  5525                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5526                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5527                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5528                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5529                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5530                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5531
  5532             20  CF-JOINT-INDICATOR         PIC X.
  5533                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5534
  5535*            20  FILLER                     PIC X(12).
  5536             20  cf-maximum-benefits        pic s999 comp-3.
  5537             20  FILLER                     PIC X(09).
  5538             20  CF-BENEFIT-CATEGORY        PIC X.
  5539             20  CF-LOAN-TYPE               PIC X(8).
  5540
  5541             20  CF-CO-REM-TERM-CALC        PIC X.
  5542                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5543                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5544                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5545                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5546                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5547
  5548             20  CF-CO-EARNINGS-CALC        PIC X.
  5549                 88  CO-EARN-BY-R78             VALUE '1'.
  5550                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 100
* EL131.cbl
  5551                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5552                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5553                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5554                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5555                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5556                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5557
  5558             20  CF-CO-REFUND-CALC          PIC X.
  5559                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5560                 88  CO-REFD-BY-R78             VALUE '1'.
  5561                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5562                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5563                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5564                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5565                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5566                 88  CO-REFD-MEAN               VALUE '8'.
  5567                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5568                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5569                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5570
  5571             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5572                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5573                 88  CO-OVRD-BY-R78             VALUE '1'.
  5574                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5575                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5576                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5577                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5578                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5579                 88  CO-OVRD-MEAN               VALUE '8'.
  5580                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5581
  5582             20  CF-CO-BEN-I-G-CD           PIC X.
  5583                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5584                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5585                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5586
  5587         16  FILLER                         PIC X(304).
  5588
  5589
  5590****************************************************************
  5591*             CARRIER MASTER RECORD                            *
  5592****************************************************************
  5593
  5594     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5595         16  CF-ADDRESS-DATA.
  5596             20  CF-MAIL-TO-NAME            PIC X(30).
  5597             20  CF-IN-CARE-OF              PIC X(30).
  5598             20  CF-ADDRESS-LINE-1          PIC X(30).
  5599             20  CF-ADDRESS-LINE-2          PIC X(30).
  5600             20  CF-CITY-STATE              PIC X(30).
  5601             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5602             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5603
  5604         16  CF-CLAIM-NO-CONTROL.
  5605             20  CF-CLAIM-NO-METHOD         PIC X.
  5606                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5607                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5608                 88  CLAIM-NO-SEQ               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 101
* EL131.cbl
  5609                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5610             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5611                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5612                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5613                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5614
  5615         16  CF-CHECK-NO-CONTROL.
  5616             20  CF-CHECK-NO-METHOD         PIC X.
  5617                 88  CHECK-NO-MANUAL            VALUE '1'.
  5618                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5619                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5620                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5621             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5622                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5623
  5624         16  CF-DOMICILE-STATE              PIC XX.
  5625
  5626         16  CF-EXPENSE-CONTROLS.
  5627             20  CF-EXPENSE-METHOD          PIC X.
  5628                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5629                 88  DOLLARS-PER-PMT            VALUE '2'.
  5630                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5631                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5632             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5633             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5634
  5635         16  CF-CORRESPONDENCE-CONTROL.
  5636             20  CF-LETTER-RESEND-OPT       PIC X.
  5637                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5638                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5639             20  FILLER                     PIC X(4).
  5640
  5641         16  CF-RESERVE-CONTROLS.
  5642             20  CF-MANUAL-SW               PIC X.
  5643                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5644             20  CF-FUTURE-SW               PIC X.
  5645                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5646             20  CF-PTC-SW                  PIC X.
  5647                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5648             20  CF-IBNR-SW                 PIC X.
  5649                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5650             20  CF-PTC-LF-SW               PIC X.
  5651                 88  CF-LF-PTC-USED             VALUE '1'.
  5652             20  CF-CDT-ACCESS-METHOD       PIC X.
  5653                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5654                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5655                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5656             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5657
  5658         16  CF-CLAIM-CALC-METHOD           PIC X.
  5659             88  360-PLUS-MONTHS                VALUE '1'.
  5660             88  365-PLUS-MONTHS                VALUE '2'.
  5661             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5662             88  360-DAILY                      VALUE '4'.
  5663             88  365-DAILY                      VALUE '5'.
  5664
  5665         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5666         16  FILLER                         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 102
* EL131.cbl
  5667
  5668         16  CF-LIMIT-AMOUNTS.
  5669             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5670             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5671             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5672             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5673             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5674             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5675             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5676             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5677             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5678             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5679
  5680         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5681         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5682         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5683
  5684         16  CF-ZIP-CODE.
  5685             20  CF-ZIP-PRIME.
  5686                 24  CF-ZIP-1ST             PIC X.
  5687                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5688                 24  FILLER                 PIC X(4).
  5689             20  CF-ZIP-PLUS4               PIC X(4).
  5690         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5691             20  CF-CAN-POSTAL-1            PIC XXX.
  5692             20  CF-CAN-POSTAL-2            PIC XXX.
  5693             20  FILLER                     PIC XXX.
  5694
  5695         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5696         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5697         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5698
  5699         16  CF-RATING-SWITCH               PIC X.
  5700             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5701             88  CF-NO-RATING                   VALUE 'N'.
  5702
  5703         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5704
  5705         16  CF-CARRIER-OVER-SHORT.
  5706             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5707             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5708
  5709         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5710         16  CF-SECPAY-SWITCH               PIC X.
  5711             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5712             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5713         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5714         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5715         16  FILLER                         PIC X(444).
  5716*        16  FILLER                         PIC X(452).
  5717
  5718
  5719****************************************************************
  5720*             MORTALITY MASTER RECORD                          *
  5721****************************************************************
  5722
  5723     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5724         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 103
* EL131.cbl
  5725                                INDEXED BY CF-MORT-NDX.
  5726             20  CF-MORT-TABLE              PIC X(5).
  5727             20  CF-MORT-TABLE-TYPE         PIC X.
  5728                 88  CF-MORT-JOINT              VALUE 'J'.
  5729                 88  CF-MORT-SINGLE             VALUE 'S'.
  5730                 88  CF-MORT-COMBINED           VALUE 'C'.
  5731                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5732                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5733             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5734             20  CF-MORT-AGE-METHOD         PIC XX.
  5735                 88  CF-AGE-LAST                VALUE 'AL'.
  5736                 88  CF-AGE-NEAR                VALUE 'AN'.
  5737             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5738             20  CF-MORT-ADJUSTMENT-DIRECTION
  5739                                            PIC X.
  5740                 88  CF-MINUS                   VALUE '-'.
  5741                 88  CF-PLUS                    VALUE '+'.
  5742             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5743             20  CF-MORT-JOINT-CODE         PIC X.
  5744                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5745             20  CF-MORT-PC-Q               PIC X.
  5746                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5747             20  CF-MORT-TABLE-CODE         PIC X(4).
  5748             20  CF-MORT-COMMENTS           PIC X(15).
  5749             20  FILLER                     PIC X(14).
  5750
  5751         16  FILLER                         PIC X(251).
  5752
  5753
  5754****************************************************************
  5755*             BUSSINESS TYPE MASTER RECORD                     *
  5756****************************************************************
  5757
  5758     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5759* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5760* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5761* AND RECORD 05 IS TYPES 81-99
  5762         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5763             20  CF-BUSINESS-TITLE          PIC  X(19).
  5764             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5765                                            PIC S9V9(4) COMP-3.
  5766             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5767             20  FILLER                     PIC  X.
  5768         16  FILLER                         PIC  X(248).
  5769
  5770
  5771****************************************************************
  5772*             TERMINAL MASTER RECORD                           *
  5773****************************************************************
  5774
  5775     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5776
  5777         16  CF-COMPANY-TERMINALS.
  5778             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5779                                  PIC X(4).
  5780         16  FILLER               PIC X(248).
  5781
  5782
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 104
* EL131.cbl
  5783****************************************************************
  5784*             LIFE EDIT MASTER RECORD                          *
  5785****************************************************************
  5786
  5787     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5788         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5789             20  CF-LIFE-CODE-IN            PIC XX.
  5790             20  CF-LIFE-CODE-OUT           PIC XX.
  5791         16  FILLER                         PIC X(248).
  5792
  5793
  5794****************************************************************
  5795*             AH EDIT MASTER RECORD                            *
  5796****************************************************************
  5797
  5798     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5799         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5800             20  CF-AH-CODE-IN              PIC XXX.
  5801             20  CF-AH-CODE-OUT             PIC XX.
  5802         16  FILLER                         PIC X(248).
  5803
  5804
  5805****************************************************************
  5806*             CREDIBILITY TABLES                               *
  5807****************************************************************
  5808
  5809     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5810         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5811                             INDEXED BY CF-CRDB-NDX.
  5812             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5813             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5814             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5815         16  FILLER                         PIC  X(332).
  5816
  5817
  5818****************************************************************
  5819*             REPORT CUSTOMIZATION RECORD                      *
  5820****************************************************************
  5821
  5822     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5823         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5824             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5825             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5826             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5827**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5828****       A T-TRANSFER.                                   ****
  5829             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5830
  5831         16  FILLER                         PIC XX.
  5832
  5833         16  CF-CARRIER-CNTL-OPT.
  5834             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5835                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5836                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5837             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5838                                            PIC X.
  5839         16  CF-GROUP-CNTL-OPT.
  5840             20  CF-GROUP-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 105
* EL131.cbl
  5841                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5842                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5843             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5844                                            PIC X(6).
  5845         16  CF-STATE-CNTL-OPT.
  5846             20  CF-STATE-OPT-SEQ           PIC 9.
  5847                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5848                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5849             20  CF-STATE-SELECT OCCURS 3 TIMES
  5850                                            PIC XX.
  5851         16  CF-ACCOUNT-CNTL-OPT.
  5852             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5853                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5854                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5855             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5856                                            PIC X(10).
  5857         16  CF-BUS-TYP-CNTL-OPT.
  5858             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5859                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5860                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5861             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5862                                            PIC XX.
  5863         16  CF-LF-TYP-CNTL-OPT.
  5864             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5865                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5866                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5867             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5868                                            PIC XX.
  5869         16  CF-AH-TYP-CNTL-OPT.
  5870             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5871                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5872                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5873             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5874                                            PIC XX.
  5875         16  CF-REPTCD1-CNTL-OPT.
  5876             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5877                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5878                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5879             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5880                                            PIC X(10).
  5881         16  CF-REPTCD2-CNTL-OPT.
  5882             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5883                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5884                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5885             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5886                                            PIC X(10).
  5887         16  CF-USER1-CNTL-OPT.
  5888             20  CF-USER1-OPT-SEQ           PIC 9.
  5889                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5890                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5891             20  CF-USER1-SELECT OCCURS 3 TIMES
  5892                                            PIC X(10).
  5893         16  CF-USER2-CNTL-OPT.
  5894             20  CF-USER2-OPT-SEQ           PIC 9.
  5895                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5896                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5897             20  CF-USER2-SELECT OCCURS 3 TIMES
  5898                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 106
* EL131.cbl
  5899         16  CF-USER3-CNTL-OPT.
  5900             20  CF-USER3-OPT-SEQ           PIC 9.
  5901                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5902                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5903             20  CF-USER3-SELECT OCCURS 3 TIMES
  5904                                            PIC X(10).
  5905         16  CF-USER4-CNTL-OPT.
  5906             20  CF-USER4-OPT-SEQ           PIC 9.
  5907                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5908                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5909             20  CF-USER4-SELECT OCCURS 3 TIMES
  5910                                            PIC X(10).
  5911         16  CF-USER5-CNTL-OPT.
  5912             20  CF-USER5-OPT-SEQ           PIC 9.
  5913                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5914                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5915             20  CF-USER5-SELECT OCCURS 3 TIMES
  5916                                            PIC X(10).
  5917         16  CF-REINS-CNTL-OPT.
  5918             20  CF-REINS-OPT-SEQ           PIC 9.
  5919                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5920                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5921             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5922                 24  CF-REINS-PRIME         PIC XXX.
  5923                 24  CF-REINS-SUB           PIC XXX.
  5924
  5925         16  CF-AGENT-CNTL-OPT.
  5926             20  CF-AGENT-OPT-SEQ           PIC 9.
  5927                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5928                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5929             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5930                                            PIC X(10).
  5931
  5932         16  FILLER                         PIC X(43).
  5933
  5934         16  CF-LOSS-RATIO-SELECT.
  5935             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5936             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5937         16  CF-ENTRY-DATE-SELECT.
  5938             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5939             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5940         16  CF-EFFECTIVE-DATE-SELECT.
  5941             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5942             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5943
  5944         16  CF-EXCEPTION-LIST-IND          PIC X.
  5945             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5946
  5947         16  FILLER                         PIC X(318).
  5948
  5949****************************************************************
  5950*                  EXCEPTION REPORTING RECORD                  *
  5951****************************************************************
  5952
  5953     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5954         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5955             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5956
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 107
* EL131.cbl
  5957         16  CF-COMBINED-LIFE-AH-OPT.
  5958             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5959             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5960             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5961             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5962
  5963         16  CF-LIFE-OPT.
  5964             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5965             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5966             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5967             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5968             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5969             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5970             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5971             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5972             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5973             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5974
  5975         16  CF-AH-OPT.
  5976             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5977             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5978             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5979             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5980             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5981             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5982             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5983             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5984             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5985             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5986
  5987         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5988             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5989             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5990             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5991
  5992         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5993
  5994         16  FILLER                         PIC X(673).
  5995
  5996
  5997****************************************************************
  5998*             MORTGAGE SYSTEM PLAN RECORD                      *
  5999****************************************************************
  6000
  6001     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6002         16  CF-PLAN-TYPE                   PIC X.
  6003             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6004             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6005             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6006         16  CF-PLAN-ABBREV                 PIC XXX.
  6007         16  CF-PLAN-DESCRIPT               PIC X(10).
  6008         16  CF-PLAN-NOTES                  PIC X(20).
  6009         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6010         16  CF-PLAN-UNDERWRITING.
  6011             20  CF-PLAN-TERM-DATA.
  6012                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6013                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6014             20  CF-PLAN-AGE-DATA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 108
* EL131.cbl
  6015                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6016                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6017                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6018             20  CF-PLAN-BENEFIT-DATA.
  6019                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6020                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6021                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6022                                            PIC S9(7)V99  COMP-3.
  6023         16  CF-PLAN-POLICY-FORMS.
  6024             20  CF-POLICY-FORM             PIC X(12).
  6025             20  CF-MASTER-APPLICATION      PIC X(12).
  6026             20  CF-MASTER-POLICY           PIC X(12).
  6027         16  CF-PLAN-RATING.
  6028             20  CF-RATE-CODE               PIC X(5).
  6029             20  CF-SEX-RATING              PIC X.
  6030                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6031                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6032             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6033             20  CF-SUB-STD-TYPE            PIC X.
  6034                 88  CF-PCT-OF-PREM            VALUE '1'.
  6035                 88  CF-PCT-OF-BENE            VALUE '2'.
  6036         16  CF-PLAN-PREM-TOLERANCES.
  6037             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6038             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6039         16  CF-PLAN-PYMT-TOLERANCES.
  6040             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6041             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6042         16  CF-PLAN-MISC-DATA.
  6043             20  FILLER                     PIC X.
  6044             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6045             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6046         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6047         16  CF-PLAN-IND-GRP                PIC X.
  6048             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6049                                                     '1'.
  6050             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6051                                                     '2'.
  6052         16  CF-MIB-SEARCH-SW               PIC X.
  6053             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6054             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6055             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6056             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6057         16  CF-ALPHA-SEARCH-SW             PIC X.
  6058             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6059             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6060             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6061             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6062             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6063             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6064             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6065             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6066             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6067             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6068                                                     'A' 'B' 'C'
  6069                                                     'X' 'Y' 'Z'.
  6070         16  CF-EFF-DT-RULE-SW              PIC X.
  6071             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6072             88  CF-EFF-DT-MONTH               VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 109
* EL131.cbl
  6073             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6074             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6075             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6076         16  FILLER                         PIC X(4).
  6077         16  CF-HEALTH-QUESTIONS            PIC X.
  6078             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6079         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6080         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6081         16  CF-PLAN-SNGL-JNT               PIC X.
  6082             88  CF-COMBINED-PLAN              VALUE 'C'.
  6083             88  CF-JNT-PLAN                   VALUE 'J'.
  6084             88  CF-SNGL-PLAN                  VALUE 'S'.
  6085         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6086         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6087         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6088         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6089         16  CF-RERATE-CNTL                 PIC  X.
  6090             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6091             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6092             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6093             88  CF-AUTO-RECALC                 VALUE '4'.
  6094         16  CF-BENEFIT-TYPE                PIC  X.
  6095             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6096             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6097         16  CF-POLICY-FEE                  PIC S999V99
  6098                                                    COMP-3.
  6099         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6100         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6101         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6102         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6103         16  FILLER                         PIC  X(32).
  6104         16  CF-TERMINATION-FORM            PIC  X(04).
  6105         16  FILLER                         PIC  X(08).
  6106         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6107                                                       COMP-3.
  6108         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6109         16  CF-ISSUE-LETTER                PIC  X(4).
  6110         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6111         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6112             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6113             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6114         16  CF-MP-REFUND-CALC              PIC X.
  6115             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6116             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6117             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6118             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6119             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6120             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6121             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6122             88  CF-MP-REFD-MEAN                VALUE '8'.
  6123         16  CF-ALT-RATE-CODE               PIC  X(5).
  6124
  6125
  6126         16  FILLER                         PIC X(498).
  6127****************************************************************
  6128*             MORTGAGE COMPANY MASTER RECORD                   *
  6129****************************************************************
  6130
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 110
* EL131.cbl
  6131     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6132         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6133         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6134             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6135             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6136             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6137             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6138             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6139
  6140         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6141         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6142         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6143         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6144         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6145
  6146         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6147             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6148         16  CF-MP-RECON-USE-IND            PIC X(1).
  6149             88  CF-MP-USE-RECON             VALUE 'Y'.
  6150         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6151             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6152         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6153             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6154             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6155         16  FILLER                         PIC X(1).
  6156         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6157             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6158         16  CF-MORTG-MIB-VERSION           PIC X.
  6159             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6160             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6161             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6162         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6163             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6164                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6165             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6166                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6167             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6168                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6169             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6170                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6171             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6172                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6173             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6174                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6175         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6176         16  FILLER                         PIC X(7).
  6177         16  CF-MORTG-DESTINATION-SYMBOL.
  6178             20  CF-MORTG-MIB-COMM          PIC X(5).
  6179             20  CF-MORTG-MIB-TERM          PIC X(5).
  6180         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6181             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6182         16  FILLER                         PIC X(03).
  6183         16  CF-MP-CHECK-NO-CONTROL.
  6184             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6185                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6186                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6187                                                ' ' LOW-VALUES.
  6188                 88  CF-MP-CHECK-NO-PRE-PRINTED
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 111
* EL131.cbl
  6189                                               VALUE '3'.
  6190         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6191         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6192         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6193             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6194                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6195             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6196                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6197             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6198                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6199             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6200                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6201             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6202                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6203             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6204                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6205         16  CF-MORTG-BILLING-AREA.
  6206             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6207                                            PIC X.
  6208         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6209         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6210         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6211         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6212             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6213             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6214         16  FILLER                         PIC X.
  6215         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6216             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6217             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6218         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6219         16  FILLER                         PIC X(8).
  6220         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6221         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6222         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6223         16  CF-ACH-COMPANY-ID.
  6224             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6225                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6226                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6227                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6228             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6229         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6230             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6231         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6232             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6233             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6234         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6235         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6236         16  FILLER                         PIC X(536).
  6237
  6238****************************************************************
  6239*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6240****************************************************************
  6241
  6242     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6243         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6244             20  CF-FEMALE-HEIGHT.
  6245                 24  CF-FEMALE-FT           PIC 99.
  6246                 24  CF-FEMALE-IN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 112
* EL131.cbl
  6247             20  CF-FEMALE-MIN-WT           PIC 999.
  6248             20  CF-FEMALE-MAX-WT           PIC 999.
  6249         16  FILLER                         PIC X(428).
  6250
  6251     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6252         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6253             20  CF-MALE-HEIGHT.
  6254                 24  CF-MALE-FT             PIC 99.
  6255                 24  CF-MALE-IN             PIC 99.
  6256             20  CF-MALE-MIN-WT             PIC 999.
  6257             20  CF-MALE-MAX-WT             PIC 999.
  6258         16  FILLER                         PIC X(428).
  6259******************************************************************
  6260*             AUTOMATIC ACTIVITY RECORD                          *
  6261******************************************************************
  6262     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6263         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6264             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6265             20  CF-SYS-LETTER-ID           PIC X(04).
  6266             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6267             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6268             20  CF-SYS-RESET-SW            PIC X(01).
  6269             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6270             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6271
  6272         16  FILLER                         PIC X(50).
  6273
  6274         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6275             20  CF-USER-ACTIVE-SW          PIC X(01).
  6276             20  CF-USER-LETTER-ID          PIC X(04).
  6277             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6278             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6279             20  CF-USER-RESET-SW           PIC X(01).
  6280             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6281             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6282             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6283
  6284         16  FILLER                         PIC X(246).
  6285
  6286*                                COPY ELCACTQ.
  6287******************************************************************
  6288*                                                                *
  6289*                            ELCACTQ.                            *
  6290*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6291*                            VMOD=2.004                          *
  6292*                                                                *
  6293*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6294*                                                                *
  6295*   FILE TYPE = VSAM,KSDS                                        *
  6296*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6297*                                                                *
  6298*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6299*       ALTERNATE INDEX = NONE                                   *
  6300*                                                                *
  6301*   LOG = YES                                                    *
  6302*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6303*                                                                *
  6304*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 113
* EL131.cbl
  6305******************************************************************
  6306
  6307 01  ACTIVITY-QUE.
  6308     12  AQ-RECORD-ID                PIC XX.
  6309         88  VALID-AQ-ID                VALUE 'AQ'.
  6310
  6311     12  AQ-CONTROL-PRIMARY.
  6312         16  AQ-COMPANY-CD           PIC X.
  6313         16  AQ-CARRIER              PIC X.
  6314         16  AQ-CLAIM-NO             PIC X(7).
  6315         16  AQ-CERT-NO.
  6316             20  AQ-CERT-PRIME       PIC X(10).
  6317             20  AQ-CERT-SFX         PIC X.
  6318
  6319     12  AQ-PENDING-ACTIVITY-FLAGS.
  6320         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6321         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6322             88  PENDING-PAYMENTS       VALUE '1'.
  6323         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6324             88  PENDING-FULL-PRINT     VALUE '1'.
  6325             88  PENDING-PART-PRINT     VALUE '2'.
  6326         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6327             88  PENDING-LETTERS        VALUE '1'.
  6328         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6329             88  PENDING-RESTORE        VALUE 'C'.
  6330             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6331
  6332     12  FILLER                      PIC X(20).
  6333
  6334     12  AQ-RESEND-DATE              PIC XX.
  6335     12  AQ-FOLLOWUP-DATE            PIC XX.
  6336     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6337     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6338     12  AQ-AUTO-LETTER              PIC X(4).
  6339     12  FILLER                      PIC XX.
  6340     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6341*****************************************************************
  6342
  6343*                                COPY ERCACCT.
  6344******************************************************************
  6345*                                                                *
  6346*                                                                *
  6347*                            ERCACCT                             *
  6348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6349*                            VMOD=2.031                          *
  6350*                                                                *
  6351*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6352*                                                                *
  6353*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6354*   VSAM ACCOUNT MASTER FILES.                                   *
  6355*                                                                *
  6356*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6357*                                                                *
  6358*   FILE TYPE = VSAM,KSDS                                        *
  6359*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6360*                                                                *
  6361*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6362*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 114
* EL131.cbl
  6363*                                                                *
  6364*   LOG = NO                                                     *
  6365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6366*                                                                *
  6367*                                                                *
  6368******************************************************************
  6369*                   C H A N G E   L O G
  6370*
  6371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6372*-----------------------------------------------------------------
  6373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6374* EFFECTIVE    NUMBER
  6375*-----------------------------------------------------------------
  6376* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6377* 092705    2005050300006  PEMA  ADD SPP LEASES
  6378* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6379* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6380* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6381* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6382* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6383* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6384******************************************************************
  6385
  6386 01  ACCOUNT-MASTER.
  6387     12  AM-RECORD-ID                      PIC XX.
  6388         88  VALID-AM-ID                      VALUE 'AM'.
  6389
  6390     12  AM-CONTROL-PRIMARY.
  6391         16  AM-COMPANY-CD                 PIC X.
  6392         16  AM-MSTR-CNTRL.
  6393             20  AM-CONTROL-A.
  6394                 24  AM-CARRIER            PIC X.
  6395                 24  AM-GROUPING.
  6396                     28 AM-GROUPING-PREFIX PIC XXX.
  6397                     28 AM-GROUPING-PRIME  PIC XXX.
  6398                 24  AM-STATE              PIC XX.
  6399                 24  AM-ACCOUNT.
  6400                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6401                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6402             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6403                                           PIC X(19).
  6404             20  AM-CNTRL-B.
  6405                 24  AM-EXPIRATION-DT      PIC XX.
  6406                 24  FILLER                PIC X(4).
  6407             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6408                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6409
  6410     12  AM-CONTROL-BY-VAR-GRP.
  6411         16  AM-COMPANY-CD-A1              PIC X.
  6412         16  AM-VG-CARRIER                 PIC X.
  6413         16  AM-VG-GROUPING                PIC X(6).
  6414         16  AM-VG-STATE                   PIC XX.
  6415         16  AM-VG-ACCOUNT                 PIC X(10).
  6416         16  AM-VG-DATE.
  6417             20  AM-VG-EXPIRATION-DT       PIC XX.
  6418             20  FILLER                    PIC X(4).
  6419         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6420                                           PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 115
* EL131.cbl
  6421     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6422         16  FILLER                        PIC X(10).
  6423         16  AM-VG-KEY3.
  6424             20  AM-VG3-ACCOUNT            PIC X(10).
  6425             20  AM-VG3-EXP-DT             PIC XX.
  6426         16  FILLER                        PIC X(4).
  6427     12  AM-MAINT-INFORMATION.
  6428         16  AM-LAST-MAINT-DT              PIC XX.
  6429         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6430         16  AM-LAST-MAINT-USER            PIC X(4).
  6431         16  FILLER                        PIC XX.
  6432
  6433     12  AM-EFFECTIVE-DT                   PIC XX.
  6434     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6435
  6436     12  AM-PREV-DATES  COMP-3.
  6437         16  AM-PREV-EXP-DT                PIC 9(11).
  6438         16  AM-PREV-EFF-DT                PIC 9(11).
  6439
  6440     12  AM-REPORT-CODE-1                  PIC X(10).
  6441     12  AM-REPORT-CODE-2                  PIC X(10).
  6442
  6443     12  AM-CITY-CODE                      PIC X(4).
  6444     12  AM-COUNTY-PARISH                  PIC X(6).
  6445
  6446     12  AM-NAME                           PIC X(30).
  6447     12  AM-PERSON                         PIC X(30).
  6448     12  AM-ADDRS                          PIC X(30).
  6449     12  AM-CITY.
  6450         16  AM-ADDR-CITY                  PIC X(28).
  6451         16  AM-ADDR-STATE                 PIC XX.
  6452     12  AM-ZIP.
  6453         16  AM-ZIP-PRIME.
  6454             20  AM-ZIP-PRI-1ST            PIC X.
  6455                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6456             20  FILLER                    PIC X(4).
  6457         16  AM-ZIP-PLUS4                  PIC X(4).
  6458     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6459         16  AM-CAN-POSTAL-1               PIC XXX.
  6460         16  AM-CAN-POSTAL-2               PIC XXX.
  6461         16  FILLER                        PIC XXX.
  6462     12  AM-TEL-NO.
  6463         16  AM-AREA-CODE                  PIC 999.
  6464         16  AM-TEL-PRE                    PIC 999.
  6465         16  AM-TEL-NBR                    PIC 9(4).
  6466     12  AM-TEL-LOC                        PIC X.
  6467         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6468         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6469
  6470     12  AM-COMM-STRUCTURE.
  6471         16  AM-DEFN-1.
  6472             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6473                 24  AM-AGT.
  6474                     28  AM-AGT-PREFIX     PIC X(4).
  6475                     28  AM-AGT-PRIME      PIC X(6).
  6476                 24  AM-COM-TYP            PIC X.
  6477                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6478                 24  AM-J-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 116
* EL131.cbl
  6479                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6480                 24  AM-RECALC-LV-INDIC    PIC X.
  6481                 24  AM-RETRO-LV-INDIC     PIC X.
  6482                 24  AM-GL-CODES           PIC X.
  6483                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6484                 24  FILLER                PIC X(01).
  6485         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6486             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6487                 24  FILLER                PIC X(11).
  6488                 24  AM-L-COMA             PIC XXX.
  6489                 24  AM-J-COMA             PIC XXX.
  6490                 24  AM-A-COMA             PIC XXX.
  6491                 24  FILLER                PIC X(6).
  6492
  6493     12  AM-COMM-CHANGE-STATUS             PIC X.
  6494         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6495
  6496     12  AM-CSR-CODE                       PIC X(4).
  6497
  6498     12  AM-BILLING-STATUS                 PIC X.
  6499         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6500         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6501     12  AM-AUTO-REFUND-SW                 PIC X.
  6502         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6503         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6504     12  AM-GPCD                           PIC 99.
  6505     12  AM-IG                             PIC X.
  6506         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6507         88  AM-HAS-GROUP                     VALUE '2'.
  6508     12  AM-STATUS                         PIC X.
  6509         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6510         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6511         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6512         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6513         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6514         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6515         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6516         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6517         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6518         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6519     12  AM-REMIT-TO                       PIC 99.
  6520     12  AM-ID-NO                          PIC X(11).
  6521
  6522     12  AM-CAL-TABLE                      PIC XX.
  6523     12  AM-LF-DEVIATION                   PIC XXX.
  6524     12  AM-AH-DEVIATION                   PIC XXX.
  6525     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6526     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6527     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6528     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6529     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6530     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6531
  6532     12  AM-USER-FIELDS.
  6533         16  AM-FLD-1                      PIC XX.
  6534         16  AM-FLD-2                      PIC XX.
  6535         16  AM-FLD-3                      PIC XX.
  6536         16  AM-FLD-4                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 117
* EL131.cbl
  6537         16  AM-FLD-5                      PIC XX.
  6538
  6539     12  AM-1ST-PROD-DATE.
  6540         16  AM-1ST-PROD-YR                PIC XX.
  6541         16  AM-1ST-PROD-MO                PIC XX.
  6542         16  AM-1ST-PROD-DA                PIC XX.
  6543     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6544     12  AM-CERTS-PURGED-DATE.
  6545         16  AM-PUR-YR                     PIC XX.
  6546         16  AM-PUR-MO                     PIC XX.
  6547         16  AM-PUR-DA                     PIC XX.
  6548     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6549     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6550     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6551     12  AM-INACTIVE-DATE.
  6552         16  AM-INA-MO                     PIC 99.
  6553         16  AM-INA-DA                     PIC 99.
  6554         16  AM-INA-YR                     PIC 99.
  6555     12  AM-AR-HI-CERT-DATE                PIC XX.
  6556
  6557     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6558     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6559
  6560     12  AM-OB-PAYMENT-MODE                PIC X.
  6561         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6562         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6563         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6564         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6565
  6566     12  AM-AH-ONLY-INDICATOR              PIC X.
  6567         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6568         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6569
  6570     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6571
  6572     12  AM-OVER-SHORT.
  6573         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6574         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6575
  6576     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6577     12  AM-DCC-CLP-STATE                  PIC XX.
  6578
  6579     12  AM-RECALC-COMM                    PIC X.
  6580     12  AM-RECALC-REIN                    PIC X.
  6581
  6582     12  AM-REI-TABLE                      PIC XXX.
  6583     12  AM-REI-ET-LF                      PIC X.
  6584     12  AM-REI-ET-AH                      PIC X.
  6585     12  AM-REI-PE-LF                      PIC X.
  6586     12  AM-REI-PE-AH                      PIC X.
  6587     12  AM-REI-PRT-ST                     PIC X.
  6588     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6589     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6590     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6591     12  AM-REI-GROUP-A                    PIC X(6).
  6592     12  AM-REI-MORT                       PIC X(4).
  6593     12  AM-REI-PRT-OW                     PIC X.
  6594     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 118
* EL131.cbl
  6595     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6596     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6597     12  AM-REI-GROUP-B                    PIC X(6).
  6598
  6599     12  AM-TRUST-TYPE                     PIC X(2).
  6600
  6601     12  AM-EMPLOYER-STMT-USED             PIC X.
  6602     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6603
  6604     12  AM-STD-AH-TYPE                    PIC XX.
  6605     12  AM-EARN-METHODS.
  6606         16  AM-EARN-METHOD-R              PIC X.
  6607             88 AM-REF-RL-R78                 VALUE 'R'.
  6608             88 AM-REF-RL-PR                  VALUE 'P'.
  6609             88 AM-REF-RL-MEAN                VALUE 'M'.
  6610             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6611         16  AM-EARN-METHOD-L              PIC X.
  6612             88 AM-REF-LL-R78                 VALUE 'R'.
  6613             88 AM-REF-LL-PR                  VALUE 'P'.
  6614             88 AM-REF-LL-MEAN                VALUE 'M'.
  6615             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6616         16  AM-EARN-METHOD-A              PIC X.
  6617             88 AM-REF-AH-R78                 VALUE 'R'.
  6618             88 AM-REF-AH-PR                  VALUE 'P'.
  6619             88 AM-REF-AH-MEAN                VALUE 'M'.
  6620             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6621             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6622             88 AM-REF-AH-NET                 VALUE 'N'.
  6623
  6624     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6625     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6626     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6627
  6628     12  AM-RET-Y-N                        PIC X.
  6629     12  AM-RET-P-E                        PIC X.
  6630     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6631     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6632     12  AM-RET-GRP                        PIC X(6).
  6633     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6634         16  AM-POOL-PRIME                 PIC XXX.
  6635         16  AM-POOL-SUB                   PIC XXX.
  6636     12  AM-RETRO-EARNINGS.
  6637         16  AM-RET-EARN-R                 PIC X.
  6638         16  AM-RET-EARN-L                 PIC X.
  6639         16  AM-RET-EARN-A                 PIC X.
  6640     12  AM-RET-ST-TAX-USE                 PIC X.
  6641         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6642         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6643     12  AM-RETRO-BEG-EARNINGS.
  6644         16  AM-RET-BEG-EARN-R             PIC X.
  6645         16  AM-RET-BEG-EARN-L             PIC X.
  6646         16  AM-RET-BEG-EARN-A             PIC X.
  6647     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6648     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6649
  6650     12  AM-USER-SELECT-OPTIONS.
  6651         16  AM-USER-SELECT-1              PIC X(10).
  6652         16  AM-USER-SELECT-2              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 119
* EL131.cbl
  6653         16  AM-USER-SELECT-3              PIC X(10).
  6654         16  AM-USER-SELECT-4              PIC X(10).
  6655         16  AM-USER-SELECT-5              PIC X(10).
  6656
  6657     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6658
  6659     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6660
  6661     12  AM-RPT045A-SWITCH                 PIC X.
  6662         88  RPT045A-OFF                   VALUE 'N'.
  6663
  6664     12  AM-INSURANCE-LIMITS.
  6665         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6666         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6667
  6668     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6669         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6670
  6671     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6672         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6673         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6674
  6675     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6676
  6677     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6678     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6679     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6680     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6681     12  AM-DCC-UEF-STATE                  PIC XX.
  6682     12  FILLER                            PIC XXX.
  6683     12  AM-REPORT-CODE-3                  PIC X(10).
  6684*    12  FILLER                            PIC X(22).
  6685
  6686     12  AM-RESERVE-DATE.
  6687         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6688         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6689         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6690
  6691     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6692     12  AM-NOTIFICATION-TYPES.
  6693         16  AM-NOTIF-OF-LETTERS           PIC X.
  6694         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6695         16  AM-NOTIF-OF-REPORTS           PIC X.
  6696         16  AM-NOTIF-OF-STATUS            PIC X.
  6697
  6698     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6699         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6700         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6701         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6702         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6703
  6704     12  AM-BENEFIT-CONTROLS.
  6705         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6706             20  AM-BENEFIT-CODE           PIC XX.
  6707             20  AM-BENEFIT-TYPE           PIC X.
  6708             20  AM-BENEFIT-REVISION       PIC XXX.
  6709             20  AM-BENEFIT-REM-TERM       PIC X.
  6710             20  AM-BENEFIT-RETRO-Y-N      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 120
* EL131.cbl
  6711             20  FILLER                    PIC XX.
  6712         16  FILLER                        PIC X(80).
  6713
  6714     12  AM-TRANSFER-DATA.
  6715         16  AM-TRANSFERRED-FROM.
  6716             20  AM-TRNFROM-CARRIER        PIC X.
  6717             20  AM-TRNFROM-GROUPING.
  6718                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6719                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6720             20  AM-TRNFROM-STATE          PIC XX.
  6721             20  AM-TRNFROM-ACCOUNT.
  6722                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6723                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6724             20  AM-TRNFROM-DTE            PIC XX.
  6725         16  AM-TRANSFERRED-TO.
  6726             20  AM-TRNTO-CARRIER          PIC X.
  6727             20  AM-TRNTO-GROUPING.
  6728                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6729                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6730             20  AM-TRNTO-STATE            PIC XX.
  6731             20  AM-TRNTO-ACCOUNT.
  6732                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6733                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6734             20  AM-TRNTO-DTE              PIC XX.
  6735         16  FILLER                        PIC X(10).
  6736
  6737     12  AM-SAVED-REMIT-TO                 PIC 99.
  6738
  6739     12  AM-COMM-STRUCTURE-SAVED.
  6740         16  AM-DEFN-1-SAVED.
  6741             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6742                 24  AM-AGT-SV             PIC X(10).
  6743                 24  AM-COM-TYP-SV         PIC X.
  6744                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6745                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6746                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6747                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6748                 24  FILLER                PIC X.
  6749                 24  AM-GL-CODES-SV        PIC X.
  6750                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6751                 24  FILLER                PIC X.
  6752         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6753             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6754                 24  FILLER                PIC X(11).
  6755                 24  AM-L-COMA-SV          PIC XXX.
  6756                 24  AM-J-COMA-SV          PIC XXX.
  6757                 24  AM-A-COMA-SV          PIC XXX.
  6758                 24  FILLER                PIC X(6).
  6759
  6760     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6761         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6762            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6763            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6764            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6765
  6766     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6767     12  FILLER                            PIC X(120).
  6768
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 121
* EL131.cbl
  6769     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6770         16  AM-CONTROL-NAME               PIC X(30).
  6771         16  AM-EXECUTIVE-ONE.
  6772             20  AM-EXEC1-NAME             PIC X(15).
  6773             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6774                                                          COMP-3.
  6775             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6776                                                          COMP-3.
  6777         16  AM-EXECUTIVE-TWO.
  6778             20  AM-EXEC2-NAME             PIC X(15).
  6779             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6780                                                          COMP-3.
  6781             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6782                                                          COMP-3.
  6783
  6784     12  AM-RETRO-ADDITIONAL-DATA.
  6785         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6786         16  AM-RETRO-PREM-P-E             PIC X.
  6787         16  AM-RETRO-CLMS-P-I             PIC X.
  6788         16  AM-RETRO-RET-BRACKET-LF.
  6789             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6790                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6791                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6792             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6793                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6794                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6795             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6796                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6797                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6798         16  AM-RETRO-RET-BRACKET-AH.
  6799             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6800                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6801                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6802                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6803             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6804                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6805                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6806             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6807                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6808                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6809
  6810     12  AM-COMMENTS.
  6811         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6812
  6813     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6814         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6815         16  AM-FLI-BILLING-CODE           PIC X.
  6816         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6817         16  AM-FLI-UNITED-IDENT           PIC X.
  6818         16  AM-FLI-INTEREST-LOST-DATA.
  6819             20  AM-FLI-BANK-NO            PIC X(5).
  6820             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6821             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6822             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6823         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6824             20  AM-FLI-AGT                PIC X(9).
  6825             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6826             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 122
* EL131.cbl
  6827         16  FILLER                        PIC X(102).
  6828
  6829     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6830         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6831             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6832             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6833             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6834             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6835             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6836         16  FILLER                          PIC X(10).
  6837******************************************************************
  6838
  6839*                                COPY ELCCHKQ.
  6840******************************************************************
  6841*                                                                *
  6842*                                                                *
  6843*                            ELCCHKQ.                            *
  6844*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6845*                            VMOD=2.007                          *
  6846*                                                                *
  6847*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6848*                                                                *
  6849*   FILE TYPE = VSAM,KSDS                                        *
  6850*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6851*                                                                *
  6852*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6853*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6854*                                                                *
  6855*   LOG = YES                                                    *
  6856*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6857******************************************************************
  6858 01  CHECK-QUE.
  6859     12  CQ-RECORD-ID                PIC XX.
  6860         88  VALID-CQ-ID         VALUE 'CQ'.
  6861
  6862     12  CQ-CONTROL-PRIMARY.
  6863         16  CQ-COMPANY-CD           PIC X.
  6864         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6865         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6866
  6867     12  CQ-CONTROL-BY-PAYEE.
  6868         16  CQ-CONTROL-BY-NUMBER.
  6869             20  CQ-COMPANY-CD-A1     PIC X.
  6870             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6871         16  CQ-PAYEE-CARRIER        PIC X.
  6872         16  CQ-PAYEE-GROUPING       PIC X(6).
  6873         16  CQ-PAYEE-STATE          PIC XX.
  6874         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6875         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6876
  6877     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6878         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6879         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6880         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6881         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6882         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6883         16  FILLER                  PIC X(3).
  6884
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 123
* EL131.cbl
  6885     12  CQ-ENTRY-TYPE               PIC X.
  6886             88  CHECK-ON-QUE           VALUE 'Q'.
  6887             88  ALIGNMENT-CHECK        VALUE 'A'.
  6888             88  SPOILED-CHECK          VALUE 'S'.
  6889             88  PAYMENT-ABORTED        VALUE 'X'.
  6890
  6891     12  CQ-CLAIM-MAST-CNTL.
  6892         16  CQ-CARRIER              PIC X.
  6893         16  CQ-CLAIM-NO             PIC X(7).
  6894         16  CQ-CERT-NO.
  6895             20  CQ-CERT-PRIME       PIC X(10).
  6896             20  CQ-CERT-SFX         PIC X.
  6897         16  CQ-CLAIM-TYPE           PIC X.
  6898             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6899             88  CQ-AH-CLAIM            VALUE 'A'.
  6900         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6901             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6902             88  CQ-O-B-COVERAGE        VALUE '2'.
  6903             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6904
  6905     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6906     12  CQ-CHECK-NUMBER             PIC X(7).
  6907     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6908     12  CQ-PAYMENT-TYPE             PIC X.
  6909             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6910             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6911             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6912             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6913             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6914             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6915             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6916             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6917     12  CQ-VOID-INDICATOR           PIC X.
  6918             88  CHECK-IS-STOPPED          VALUE 'S'.
  6919             88  CHECK-IS-VOID             VALUE 'V'.
  6920     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6921     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6922     12  CQ-CHECK-BY-USER            PIC X(4).
  6923     12  CQ-PRE-NUMBERING-SW         PIC X.
  6924       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6925       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6926
  6927     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6928     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6929     12  CQ-LEDGER-FLAG              PIC X(01).
  6930     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6931     12  CQ-LAST-UPDATED-DT          PIC XX.
  6932     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6933     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6934
  6935     12  FILLER                      PIC X(04).
  6936
  6937******************************************************************
  6938
  6939*                                COPY ELCARCH.
  6940******************************************************************
  6941*                                                                *
  6942*                            ELCARCH.                            *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 124
* EL131.cbl
  6943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6944*                            VMOD=2.007                          *
  6945*                                                                *
  6946*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6947*                                                                *
  6948*   FILE TYPE = VSAM,KSDS                                        *
  6949*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6950*                                                                *
  6951*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6952*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6953*                                                                *
  6954*   LOG = NO                                                     *
  6955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6956*                                                                *
  6957*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6958******************************************************************
  6959 01  LETTER-ARCHIVE.
  6960     12  LA-RECORD-ID                PIC XX.
  6961         88  VALID-LA-ID                VALUE 'LA'.
  6962
  6963     12  LA-CONTROL-PRIMARY.
  6964         16  LA-COMPANY-CD           PIC X.
  6965         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6966         16  LA-RECORD-TYPE          PIC X.
  6967             88  LA-HEADER-DATA         VALUE '1'.
  6968             88  LA-ADDRESS-DATA        VALUE '2'.
  6969             88  LA-TEXT-DATA           VALUE '3'.
  6970             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6971         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6972
  6973     12  LA-CONTROL-BY-TYPE.
  6974         16  LA-COMPANY-CD-A1        PIC X.
  6975         16  LA-RECORD-TYPE-A1       PIC X.
  6976         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6977         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6978
  6979     12  LA-TEXT-RECORD.
  6980         16  LA-SKIP-CONTROL         PIC XX.
  6981             88  NO-LINES-SKIPPED       VALUE SPACES.
  6982             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6983         16  LA-TEXT-LINE            PIC X(70).
  6984
  6985     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6986         16  FILLER                  PIC XX.
  6987         16  LA-ADDRESS-LINE         PIC X(30).
  6988         16  FILLER                  PIC X(40).
  6989
  6990     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6991         16  FILLER                  PIC XX.
  6992         16  LA-CARRIER              PIC X.
  6993         16  LA-CLAIM-NO             PIC X(7).
  6994         16  LA-CERT-NO.
  6995             20  LA-CERT-PRIME       PIC X(10).
  6996             20  LA-CERT-SFX         PIC X.
  6997         16  LA-NO-OF-COPIES         PIC S9.
  6998         16  LA-RESEND-DATE          PIC XX.
  6999         16  LA-PROCESSOR-CD         PIC X(4).
  7000         16  LA-CREATION-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 125
* EL131.cbl
  7001         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7002         16  LA-RESEND-PRINT-DATE    PIC XX.
  7003         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7004         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7005*
  7006* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7007*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7008*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7009*   I        20  LA-DMD-RES-ST           PIC XX.
  7010*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7011*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7012*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7013*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7014*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7015*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7016*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7017*   I        20  LA-DMD-UND-CODE         PIC XX.
  7018*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7019*   V    16  FILLER                  PIC X(15).
  7020* -----
  7021*
  7022* REINSERTED  CSO  MODS
  7023*
  7024         16  FILLER.
  7025             20  FILLER                  PIC X(29).
  7026             20  LA-CSO-LETTER-STATUS    PIC X.
  7027                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7028                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7029                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7030             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7031             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7032*
  7033
  7034     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7035         16  FILLER                  PIC XX.
  7036         16  LA4-CARRIER             PIC X.
  7037         16  LA4-CLAIM-NO            PIC X(7).
  7038         16  LA4-CERT-NO.
  7039             20  LA4-CERT-PRIME      PIC X(10).
  7040             20  LA4-CERT-SFX        PIC X.
  7041         16  LA4-NO-OF-COPIES        PIC S9.
  7042         16  LA4-RESEND-DATE         PIC XX.
  7043         16  LA4-PROCESSOR-CD        PIC X(4).
  7044         16  LA4-CREATION-DT         PIC XX.
  7045         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7046         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7047         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7048         16  LA4-FORM-TYPE           PIC X.
  7049             88  LA4-INITIAL-FORM    VALUE '1'.
  7050             88  LA4-PROGRESS-FORM   VALUE '2'.
  7051         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7052         16  LA4-STATE               PIC X(02).
  7053         16  FILLER                  PIC X(31).
  7054******************************************************************
  7055
  7056*                                COPY ELCBENE.
  7057******************************************************************
  7058*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 126
* EL131.cbl
  7059*                            ELCBENE.                            *
  7060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7061*                            VMOD=2.006                          *
  7062*                                                                *
  7063*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7064*                                                                *
  7065*   FILE TYPE = VSAM,KSDS                                        *
  7066*   RECORD SIZE = 500   RECFORM = FIX                            *
  7067*                                                                *
  7068*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7069*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7070*                                                                *
  7071*   LOG = YES                                                    *
  7072*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7073*                                                                *
  7074*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7075******************************************************************
  7076*                   C H A N G E   L O G
  7077*
  7078* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7079*-----------------------------------------------------------------
  7080*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7081* EFFECTIVE    NUMBER
  7082*-----------------------------------------------------------------
  7083* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7084* 082317  CR2017082100003  PEMA  Add sub type
  7085* 032019  CR2019011400002  PEMA  Add email address for ach report
  7086******************************************************************
  7087
  7088 01  BENEFICIARY-MASTER.
  7089     12  BE-RECORD-ID                PIC XX.
  7090         88  VALID-BE-ID                VALUE 'BE'.
  7091
  7092     12  BE-CONTROL-PRIMARY.
  7093         16  BE-COMPANY-CD           PIC X.
  7094         16  BE-RECORD-TYPE          PIC X.
  7095             88  BENEFICIARY-RECORD  VALUE 'B'.
  7096             88  ADJUSTOR-RECORD     VALUE 'A'.
  7097         16  BE-BENEFICIARY          PIC X(10).
  7098     12  BE-CONTROL-BY-NAME.
  7099         16  BE-COMPANY-CD-A1        PIC X.
  7100         16  BE-RECORD-TYPE-A1       PIC X.
  7101         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7102         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7103
  7104     12  BE-LAST-MAINT-DT            PIC XX.
  7105     12  BE-LAST-MAINT-BY            PIC X(4).
  7106     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7107
  7108     12  BE-ADDRESS-DATA.
  7109         16  BE-MAIL-TO-NAME         PIC X(30).
  7110         16  BE-ADDRESS-LINE-1       PIC X(30).
  7111         16  BE-ADDRESS-LINE-2       PIC X(30).
  7112         16  BE-ADDRESS-LINE-3       PIC X(30).
  7113         16  BE-CITY-STATE.
  7114             20  BE-CITY             PIC X(28).
  7115             20  BE-STATE            PIC XX.
  7116         16  BE-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 127
* EL131.cbl
  7117             20  BE-ZIP-PRIME.
  7118                 24  BE-ZIP-1ST      PIC X.
  7119                     88  BE-CANADIAN-POST-CODE
  7120                                         VALUE 'A' THRU 'Z'.
  7121                 24  FILLER          PIC X(4).
  7122             20  BE-ZIP-PLUS4        PIC X(4).
  7123         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7124             20  BE-CAN-POSTAL-1     PIC XXX.
  7125             20  BE-CAN-POSTAL-2     PIC XXX.
  7126             20  FILLER              PIC XXX.
  7127         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7128         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7129
  7130******************************************************************
  7131*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7132*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7133******************************************************************
  7134     12  BE-CARRIER                  PIC X.
  7135
  7136     12  BE-ADDRESS-DATA2.
  7137         16  BE-MAIL-TO-NAME2        PIC X(30).
  7138         16  BE-ADDRESS-LINE-12      PIC X(30).
  7139         16  BE-ADDRESS-LINE-22      PIC X(30).
  7140         16  BE-ADDRESS-LINE-32      PIC X(30).
  7141         16  BE-CITY-STATE2.
  7142             20  BE-CITY2            PIC X(28).
  7143             20  BE-STATE2           PIC XX.
  7144         16  BE-ZIP-CODE2.
  7145             20  BE-ZIP-PRIME2.
  7146                 24  BE-ZIP-1ST2     PIC X.
  7147                     88  BE-CANADIAN-POST-CODE2
  7148                                         VALUE 'A' THRU 'Z'.
  7149                 24  FILLER          PIC X(4).
  7150             20  BE-ZIP-PLUS42       PIC X(4).
  7151         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7152             20  BE-CAN-POSTAL-12    PIC XXX.
  7153             20  BE-CAN-POSTAL-22    PIC XXX.
  7154             20  FILLER              PIC XXX.
  7155         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7156         16  BE-ACH-DATA.
  7157             20  BE-ACH-YES-OR-NO    PIC X.
  7158                 88  BE-ON-ACH       VALUE 'Y'.
  7159                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7160             20  BE-ACH-ABA-ROUTING-NUMBER
  7161                                     PIC X(15).
  7162             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7163                                     PIC X(20).
  7164             20  BE-ACH-SUB-TYPE     PIC XX.
  7165             20  BE-ACH-EMAIL-YN     PIC X.
  7166                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  7167             20  be-ach-email-addr   PIC X(40).
  7168         16  BE-BILLING-STMT-DATA.
  7169*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7170             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7171             20  BE-OUTPUT-TYPE      PIC X.
  7172                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7173                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7174
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 128
* EL131.cbl
  7175     12  filler                      PIC X(16).
  7176******************************************************************
  7177
  7178*                                COPY ELCDAR.
  7179******************************************************************
  7180*                                                                *
  7181*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7182*   FILE TYPE = VSAM,KSDS                                        *
  7183*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7184*   BASE CLUSTER = DLYACTV                                       *
  7185*   LOG = YES                                                    *
  7186*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7187*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7188*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7189*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7190*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7191*               BY PROGRAM "LGINFCE".                            *
  7192*                                                                *
  7193******************************************************************
  7194 01  DAILY-ACTIVITY-RECORD.
  7195     05  DA-KEY.
  7196         10  DA-COMP-CD          PIC X.
  7197         10  DA-CARRIER          PIC X.
  7198         10  DA-CLAIM-NO         PIC X(7).
  7199         10  DA-CERT-NO.
  7200             15  DA-CERT-PRIME   PIC X(10).
  7201             15  DA-CERT-SFX     PIC X.
  7202     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7203     05  DA-RECORD-TYPE          PIC X.
  7204     05  FILLER                  PIC X(2).
  7205******************************************************************
  7206
  7207*                                COPY ELCALPH.
  7208******************************************************************
  7209*                                                                *
  7210*                            ELCALPH.                            *
  7211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7212*                            VMOD=2.003                          *
  7213*                                                                *
  7214*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7215*                                                                *
  7216*   FILE TYPE = VSAM,KSDS                                        *
  7217*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7218*                                                                *
  7219*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7220*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7221*                                                                *
  7222*   LOG = YES                                                    *
  7223*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7224*                                                                *
  7225*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7226******************************************************************
  7227
  7228 01  ALPHA-INDEX.
  7229     12  AI-RECORD-ID                         PIC XX.
  7230         88  VALID-AI-ID                  VALUE 'AI'.
  7231     12  AI-CONTROL-PRIMARY.
  7232         16  AI-COMPANY-CD                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 129
* EL131.cbl
  7233         16  AI-SOURCE                         PIC X.
  7234             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7235             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7236         16  AI-NAME.
  7237             20  AI-LAST-NAME                  PIC X(15).
  7238             20  AI-FIRST-NAME.
  7239                 24  AI-FIRST-INITIAL          PIC X.
  7240                 24  FILLER                    PIC X(11).
  7241             20  AI-MIDDLE-INIT                PIC X.
  7242         16  AI-DATE                           PIC X(8).
  7243         16  AI-TIME                           PIC S9(07) COMP-3.
  7244
  7245     12  AI-CONTROL-BY-ADMIN-KEY.
  7246         16  AI-CM-COMPANY-CD                  PIC X.
  7247         16  AI-CM-SOURCE                      PIC X.
  7248         16  AI-CM-CARRIER                     PIC X.
  7249         16  AI-CM-GROUPING.
  7250             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7251             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7252         16  AI-CM-STATE                       PIC XX.
  7253         16  AI-CM-PRODUCER.
  7254             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7255             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7256         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7257         16  AI-CM-CERTIFICATE-NUMBER.
  7258             20  AI-CM-CERT-PRIME              PIC X(10).
  7259             20  AI-CM-CERT-SFX                PIC X.
  7260         16  AI-CM-DATE                        PIC X(8).
  7261         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7262         16  FILLER                            PIC X(11).
  7263
  7264     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7265         AI-CONTROL-BY-ADMIN-KEY.
  7266         16  AI-CL-COMPANY-CD                  PIC X.
  7267         16  AI-CL-SOURCE                      PIC X.
  7268         16  AI-CL-CARRIER                     PIC X.
  7269         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7270         16  AI-CL-CERTIFICATE-NUMBER.
  7271             20  AI-CL-CERT-PRIME              PIC X(10).
  7272             20  AI-CL-CERT-SFX                PIC X.
  7273         16  AI-CL-DATE                        PIC X(8).
  7274         16  AI-CL-INCURRED-DATE               PIC XX.
  7275         16  AI-CL-CLOSE-DATE                  PIC XX.
  7276         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7277         16  AI-CREDIT-CARD-NUMBER.
  7278             20  AI-CCN.
  7279                 24  AI-CCN-PREFIX             PIC X(4).
  7280                 24  AI-CCN-PRIME              PIC X(12).
  7281             20  AI-CCN-FILLER                 PIC X(4).
  7282
  7283     12  AI-MAINT-INFO.
  7284         16  AI-LAST-MAINT-BY                  PIC X(4).
  7285         16  AI-LAST-MAINT-DT                  PIC XX.
  7286         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7287
  7288     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7289
  7290     12  FILLER                                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 130
* EL131.cbl
  7291
  7292
  7293*                                COPY ERCDMDNT.
  7294******************************************************************
  7295*                                                                *
  7296*                            ERCDMDNT                            *
  7297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7298*                            VMOD=2.005                          *
  7299*                                                                *
  7300*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7301*                                                                *
  7302*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7303*                                                                *
  7304*        FILE TYPE= VSAM,KSDS                                    *
  7305*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7306*                                                                *
  7307*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7308*                                                                *
  7309*        LOG = YES                                               *
  7310*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7311*                                                                *
  7312******************************************************************
  7313
  7314 01  CERTIFICATE-NOTE.
  7315     12  CN-RECORD-ID                     PIC  XX.
  7316         88  VALID-CN-ID                      VALUE 'CN'.
  7317
  7318     12  CN-CONTROL-PRIMARY.
  7319         16  CN-COMPANY-CD                PIC X.
  7320         16  CN-CERT-KEY.
  7321             20  CN-CARRIER               PIC X.
  7322             20  CN-GROUPING.
  7323                 24  CN-GROUPING-PREFIX   PIC XXX.
  7324                 24  CN-GROUPING-PRIME    PIC XXX.
  7325             20  CN-STATE                 PIC XX.
  7326             20  CN-ACCOUNT.
  7327                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7328                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7329             20  CN-CERT-EFF-DT           PIC XX.
  7330             20  CN-CERT-NO.
  7331                 24  CN-CERT-PRIME        PIC X(10).
  7332                 24  CN-CERT-SFX          PIC X.
  7333
  7334     12  CN-BILLING-START-LINE-NO         PIC 99.
  7335     12  CN-BILLING-END-LINE-NO           PIC 99.
  7336
  7337     12  CN-LINES.
  7338         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7339
  7340     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7341         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7342         16  CN-CSI-GENERAL-DATA-AREA.
  7343             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7344
  7345         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7346             CN-CSI-GENERAL-DATA-AREA.
  7347             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7348             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 131
* EL131.cbl
  7349             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7350             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7351             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7352             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7353             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7354             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7355             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7356             20  FILLER                       PIC XX.
  7357             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7358             20  FILLER                       PIC X(38).
  7359
  7360         16  CN-CSI-PRODUCT-DATA-AREA.
  7361             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7362
  7363         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7364             CN-CSI-PRODUCT-DATA-AREA.
  7365             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7366             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7367             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7368             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7369             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7370             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7371             20  FILLER                   PIC XX.
  7372             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7373             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7374             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7375             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7376             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7377             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7378             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7379             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7380             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7381             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7382             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7383             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7384             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7385             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7386             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7387             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7388             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7389             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7390             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7391             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7392             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7393             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7394             20  FILLER                   PIC X(25).
  7395
  7396         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7397             CN-CSI-CREDIT-CARD-DATA.
  7398             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7399             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7400             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7401             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7402             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7403             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7404             20  FILLER                   PIC XX.
  7405             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7406             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 132
* EL131.cbl
  7407             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7408             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7409             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7410             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7411             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7412             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7413             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7414             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7415             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7416             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7417             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7418             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7419             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7420             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7421             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7422             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7423             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7424             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7425             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7426             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7427             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7428             20  FILLER                   PIC X(17).
  7429
  7430         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7431             CN-CSI-FAMILY-LEAVE-DATA.
  7432             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7433             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7434             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7435             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7436             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7437             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7438             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7439             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7440             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7441             20  CN-CSI-SL-INT-ON-PROCEEDS
  7442                                          PIC S9(5)V99  COMP-3.
  7443             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7444             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7445             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7446             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7447             20  CN-CSI-SL-POLICY-BENEFITS
  7448                                          PIC S9(5)V99  COMP-3.
  7449             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7450             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7451             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7452             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7453             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7454             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7455             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7456             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7457             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7458             20  CN-CSI-SL-STATE-NOT      PIC X.
  7459             20  FILLER                   PIC XX.
  7460
  7461         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7462             CN-CSI-SENIOR-LIFE-DATA.
  7463             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7464             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 133
* EL131.cbl
  7465             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7466                                          PIC S9(5)V99  COMP-3.
  7467             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7468             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7469             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7470             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7471             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7472             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7473             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7474             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7475             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7476             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7477             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7478             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7479             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7480             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7481             20  CN-CSI-PP-REPAIR         PIC X.
  7482             20  CN-CSI-PP-REPLACE        PIC X.
  7483             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7484             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7485             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7486             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7487             20  FILLER                   PIC X(5).
  7488
  7489         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7490             CN-CSI-PURCH-PROP-DATA.
  7491             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7492             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7493             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7494             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7495             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7496             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7497             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7498             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7499             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7500             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7501             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7502             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7503             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7504             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7505             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7506             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7507             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7508             20  CN-CSI-EW-REPLACE        PIC X.
  7509             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7510             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7511             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7512             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7513             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7514             20  FILLER                   PIC X(4).
  7515
  7516     12  CN-LAST-MAINT-DT                 PIC XX.
  7517     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7518     12  CN-LAST-MAINT-USER               PIC X(4).
  7519     12  FILLER                           PIC X(6).
  7520
  7521******************************************************************
  7522
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 134
* EL131.cbl
  7524 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7525                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7526                          CONTROL-FILE ACTIVITY-QUE
  7527                          ACCOUNT-MASTER CHECK-QUE
  7528                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7529                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7530                          CERTIFICATE-NOTE.
  7531 0000-DFHEXIT SECTION.
  7532     MOVE '9#                    $   ' TO DFHEIV0.
  7533     MOVE 'EL131' TO DFHEIV1.
  7534     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7535
  7536     IF EIBCALEN = ZERO
  7537         GO TO 8800-UNAUTHORIZED-ACCESS.
  7538
  7539     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7540     MOVE '5'                    TO DC-OPTION-CODE.
  7541     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7542     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7543     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7544     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7545
  7546     IF SAVE-DATE-YY GREATER 70
  7547         MOVE 19                 TO SAVE-DATE-CC
  7548      ELSE
  7549         MOVE 20                 TO SAVE-DATE-CC.
  7550
  7551
  7552* EXEC CICS HANDLE CONDITION
  7553*        PGMIDERR (8820-XCTL-ERROR)
  7554*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7555*        ERROR    (9990-ABEND)
  7556*    END-EXEC.
  7557*    MOVE '"$LI.                 ! " #00007547' TO DFHEIV0
  7558     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7560     MOVE X'2220233030303037353437' TO DFHEIV0(25:11)
  7561     CALL 'kxdfhei1' USING DFHEIV0
  7562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7563
  7564
  7565     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7566     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7567     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7568
  7569     INITIALIZE    EDIT-WORK-AREA.
  7570     MOVE '/'                    TO WORK-SLASH.
  7571     MOVE SPACES                 TO ERROR-SWITCHES.
  7572
  7573     MOVE TRAN-ID                TO TRANS-ID.
  7574     MOVE EIBTRMID               TO PI-TERM.
  7575     MOVE MAP-ID                 TO PI-QUAL.
  7576
  7577     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7578
  7579     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7580         MOVE LOW-VALUES         TO EL131AO
  7581         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 135
* EL131.cbl
  7582         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7583         MOVE -1                 TO MAINTL
  7584         GO TO 8110-SEND-DATA.
  7585
  7586     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7587         MOVE LOW-VALUES         TO EL131AO
  7588         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7589         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7590         MOVE 'X'                TO PI-RETURN-CD-1
  7591         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7592         MOVE -1                 TO MAINTL
  7593         IF WS-RETURNED-FROM = XCTL-EL114
  7594             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7595         END-IF
  7596         GO TO 8100-SEND-MAP.
  7597
  7598     IF EIBAID = DFHCLEAR
  7599         GO TO 8200-RETURN-PRIOR.
  7600
  7601     IF PI-PROCESSOR-ID = 'LGXX'
  7602         NEXT SENTENCE
  7603     ELSE
  7604
  7605* EXEC CICS READQ TS
  7606*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7607*            INTO    (SECURITY-CONTROL)
  7608*            LENGTH  (SC-COMM-LENGTH)
  7609*            ITEM    (SC-ITEM)
  7610*        END-EXEC
  7611*    MOVE '*$II   L              ''   #00007592' TO DFHEIV0
  7612     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7614     MOVE X'2020233030303037353932' TO DFHEIV0(25:11)
  7615     CALL 'kxdfhei1' USING DFHEIV0,
  7616           PI-SECURITY-TEMP-STORE-ID,
  7617           SECURITY-CONTROL,
  7618           SC-COMM-LENGTH,
  7619           SC-ITEM,
  7620           DFHEIV99,
  7621           DFHEIV99
  7622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7623         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7624         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7625         IF NOT DISPLAY-CAP
  7626             MOVE 'READ'               TO  SM-READ
  7627             PERFORM 9995-SECURITY-VIOLATION
  7628             MOVE ER-0070              TO  EMI-ERROR
  7629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7630             GO TO 8100-SEND-MAP.
  7631
  7632
  7633* EXEC CICS RECEIVE
  7634*        MAP    ('EL131A')
  7635*        MAPSET ('EL131S')
  7636*    END-EXEC.
  7637     MOVE 'EL131A' TO DFHEIV1
  7638     MOVE 'EL131S' TO DFHEIV2
  7639*    MOVE '8"T                   ''   #00007607' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 136
* EL131.cbl
  7640     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7642     MOVE X'2020233030303037363037' TO DFHEIV0(25:11)
  7643     CALL 'kxdfhei1' USING DFHEIV0,
  7644           DFHEIV1,
  7645           EL131AI,
  7646           DFHEIV99,
  7647           DFHEIV2,
  7648           DFHEIV99,
  7649           DFHEIV99
  7650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7651
  7652
  7653     IF PFKEYL GREATER THAN ZERO
  7654         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7655
  7656     IF SCREEN-ERROR
  7657         MOVE ER-0004 TO EMI-ERROR
  7658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7659         MOVE -1 TO MAINTL
  7660         GO TO 8110-SEND-DATA.
  7661
  7662     IF EIBAID = DFHPF3
  7663         GO TO 8500-TRLR-MNT.
  7664
  7665     IF EIBAID = DFHPF4
  7666         GO TO 8600-ADDR-MNT.
  7667
  7668     IF EIBAID = DFHPF5
  7669         GO TO 8700-CERT-MNT.
  7670
  7671     IF PI-COMPANY-ID = 'DMD'
  7672       IF EIBAID = DFHPF6
  7673         GO TO 8750-DMD-CLM-FIX.
  7674
  7675     IF EIBAID = DFHPF7
  7676         GO TO 4000-FORCE-ERRORS.
  7677
  7678     IF EIBAID = DFHPF12
  7679         GO TO 8300-GET-HELP.
  7680
  7681     IF EIBAID = DFHPF15
  7682         GO TO 8725-BENEFICIARY-MNT
  7683     END-IF.
  7684
  7685     IF EIBAID = DFHPF23
  7686         GO TO 8810-PF23-ENTERED.
  7687
  7688     IF EIBAID = DFHPF24
  7689         GO TO 8400-RETURN-MASTER.
  7690
  7691     IF EIBAID NOT = DFHENTER
  7692         MOVE ER-0029            TO EMI-ERROR
  7693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7694         MOVE -1                 TO MAINTL
  7695         GO TO 8110-SEND-DATA.
  7696
  7697     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 137
* EL131.cbl
  7698         MOVE ER-0311            TO EMI-ERROR
  7699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7700         MOVE -1                 TO MAINTL
  7701         GO TO 8110-SEND-DATA.
  7702
  7703     IF MAINTI = 'A'
  7704         GO TO 0500-ADD-ALPHA-ONLY.
  7705
  7706     IF MAINTI = 'N'
  7707         GO TO 0600-CHANGE-NAME.
  7708
  7709     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7710     PERFORM 1030-EDIT-NAME THRU 1030-EXIT.
  7711
  7712     IF SCREEN-ERROR
  7713         GO TO 8110-SEND-DATA.
  7714
  7715     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7716         MOVE ER-0276            TO EMI-ERROR
  7717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7718         MOVE -1                 TO MAINTL
  7719         GO TO 8110-SEND-DATA.
  7720
  7721     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7722
  7723     IF SCREEN-ERROR
  7724         GO TO 8110-SEND-DATA.
  7725
  7726     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7727
  7728     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7729
  7730     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7731         GO TO 8110-SEND-DATA.
  7732
  7733     IF EMI-FATAL-CTR GREATER THAN ZERO
  7734         GO TO 8110-SEND-DATA.
  7735
  7736     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7737
  7738     IF WS-OPEN-CLOSE-SW = 'Y'
  7739         IF PI-LETTER-SW = 'Y'
  7740             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7741             MOVE 'T'            TO  CNTL-REC-TYPE
  7742             MOVE SPACES         TO  CNTL-PROC-ID
  7743             MOVE +0             TO  CNTL-SEQ-NO
  7744
  7745* EXEC CICS READ
  7746*                DATASET   (CNTL-FILE-ID)
  7747*                RIDFLD    (CNTL-KEY)
  7748*                SET       (ADDRESS OF CONTROL-FILE)
  7749*            END-EXEC
  7750*    MOVE '&"S        E          (   #00007703' TO DFHEIV0
  7751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7753     MOVE X'2020233030303037373033' TO DFHEIV0(25:11)
  7754     CALL 'kxdfhei1' USING DFHEIV0,
  7755           CNTL-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 138
* EL131.cbl
  7756           DFHEIV20,
  7757           DFHEIV99,
  7758           CNTL-KEY,
  7759           DFHEIV99,
  7760           DFHEIV99,
  7761           DFHEIV99
  7762     SET ADDRESS OF CONTROL-FILE TO
  7763         DFHEIV20
  7764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7765             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7766
  7767     MOVE ER-0000                TO EMI-ERROR.
  7768     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7769
  7770     MOVE SPACE                  TO MAINTO.
  7771     MOVE -1                     TO MAINTL.
  7772     GO TO 8100-SEND-MAP.
  7773
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 139
* EL131.cbl
  7775 0100-UPDATE-PI.
  7776
  7777     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7778     IF WS-RETURNED-FROM = XCTL-EL114
  7779***sometimes there is crap in positions 7-10 when no code was sele
  7780        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7781          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7782        END-IF
  7783     END-IF.
  7784
  7785     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7786         GO TO 0110-UPDATE-UP.
  7787
  7788     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7789     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7790     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7791     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7792     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7793     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7794     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7795     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7796     GO TO 0120-UPDATE-PI-EXIT.
  7797
  7798 0110-UPDATE-UP.
  7799     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7800     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7801     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7802     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7803     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7804     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7805     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7806     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7807
  7808
  7809* EXEC CICS HANDLE CONDITION
  7810*         QIDERR    (0130-TS-ERROR)
  7811*         ITEMERR   (0130-TS-ERROR)
  7812*    END-EXEC.
  7813*    MOVE '"$N<                  ! # #00007751' TO DFHEIV0
  7814     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7816     MOVE X'2320233030303037373531' TO DFHEIV0(25:11)
  7817     CALL 'kxdfhei1' USING DFHEIV0
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7819
  7820
  7821     IF WS-RETURNED-FROM = XCTL-EL114
  7822
  7823* EXEC CICS READQ TS
  7824*            QUEUE    (PI-KEY)
  7825*            INTO     (EL131AI)
  7826*            LENGTH   (MAP-LENGTH)
  7827*       END-EXEC
  7828*    MOVE '*$I    L              ''   #00007757' TO DFHEIV0
  7829     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7831     MOVE X'2020233030303037373537' TO DFHEIV0(25:11)
  7832     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 140
* EL131.cbl
  7833           PI-KEY,
  7834           EL131AI,
  7835           MAP-LENGTH,
  7836           DFHEIV99,
  7837           DFHEIV99,
  7838           DFHEIV99
  7839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7840
  7841        IF WS-SAVE-BENEFICIARY > SPACES
  7842            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7843            MOVE +10            TO BENEL
  7844            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7845        END-IF
  7846        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7847     END-IF.
  7848
  7849
  7850* EXEC CICS READQ TS
  7851*         QUEUE    (PI-KEY)
  7852*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7853*         LENGTH   (PI-COMM-LENGTH)
  7854*    END-EXEC.
  7855*    MOVE '*$I    L              ''   #00007771' TO DFHEIV0
  7856     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7857     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7858     MOVE X'2020233030303037373731' TO DFHEIV0(25:11)
  7859     CALL 'kxdfhei1' USING DFHEIV0,
  7860           PI-KEY,
  7861           PROGRAM-INTERFACE-BLOCK,
  7862           PI-COMM-LENGTH,
  7863           DFHEIV99,
  7864           DFHEIV99,
  7865           DFHEIV99
  7866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7867
  7868
  7869
  7870* EXEC CICS DELETEQ TS
  7871*         QUEUE    (PI-KEY)
  7872*    END-EXEC.
  7873*    MOVE '*&                    #   #00007777' TO DFHEIV0
  7874     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7875     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7876     MOVE X'2020233030303037373737' TO DFHEIV0(25:11)
  7877     CALL 'kxdfhei1' USING DFHEIV0,
  7878           PI-KEY,
  7879           DFHEIV99
  7880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7881
  7882
  7883 0120-UPDATE-PI-EXIT.
  7884     EXIT.
  7885
  7886 0130-TS-ERROR.
  7887     MOVE LOW-VALUES             TO EL131AO.
  7888     MOVE ER-0192                TO EMI-ERROR.
  7889
  7890     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 141
* EL131.cbl
  7891
  7892     GO TO 8100-SEND-MAP.
  7893
  7894 0200-TRANS-PF.
  7895     IF EIBAID NOT = DFHENTER
  7896         MOVE 'X'                TO ERROR-SWITCH
  7897         GO TO 0210-EXIT.
  7898
  7899     IF PFKEYI NOT NUMERIC
  7900         MOVE 'X'                TO ERROR-SWITCH
  7901         GO TO 0210-EXIT.
  7902
  7903     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7904
  7905     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7906         MOVE 'X' TO ERROR-SWITCH
  7907         GO TO 0210-EXIT.
  7908
  7909     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7910
  7911 0210-EXIT.
  7912     EXIT.
  7913
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 142
* EL131.cbl
  7915 0500-ADD-ALPHA-ONLY.
  7916******************************************************************
  7917*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7918*    RECORD.                                                     *
  7919******************************************************************
  7920
  7921     IF MLNAMEL = +0 AND
  7922        MFNAMEL = +0 AND
  7923        MMINITL = +0
  7924         MOVE ER-0797                TO  EMI-ERROR
  7925         MOVE -1                     TO  MAINTL
  7926         MOVE AL-UABON               TO  MAINTA
  7927         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7928         GO TO 8110-SEND-DATA.
  7929
  7930     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7931     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7932     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7933     MOVE PI-CERT-NO                 TO  CERT-NO.
  7934
  7935
  7936* EXEC CICS READ
  7937*        DATASET   (CLMS-FILE-ID)
  7938*        RIDFLD    (MSTR-KEY)
  7939*        SET       (ADDRESS OF CLAIM-MASTER)
  7940*    END-EXEC.
  7941*    MOVE '&"S        E          (   #00007833' TO DFHEIV0
  7942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7944     MOVE X'2020233030303037383333' TO DFHEIV0(25:11)
  7945     CALL 'kxdfhei1' USING DFHEIV0,
  7946           CLMS-FILE-ID,
  7947           DFHEIV20,
  7948           DFHEIV99,
  7949           MSTR-KEY,
  7950           DFHEIV99,
  7951           DFHEIV99,
  7952           DFHEIV99
  7953     SET ADDRESS OF CLAIM-MASTER TO
  7954         DFHEIV20
  7955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7956
  7957
  7958
  7959* EXEC CICS GETMAIN
  7960*        SET       (ADDRESS OF ALPHA-INDEX)
  7961*        LENGTH    (ALPH-LENGTH)
  7962*        INITIMG   (GETMAIN-SPACE)
  7963*    END-EXEC.
  7964*    MOVE ',"IL                  $   #00007839' TO DFHEIV0
  7965     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7966     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7967     MOVE X'2020233030303037383339' TO DFHEIV0(25:11)
  7968     CALL 'kxdfhei1' USING DFHEIV0,
  7969           DFHEIV20,
  7970           ALPH-LENGTH,
  7971           GETMAIN-SPACE
  7972     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 143
* EL131.cbl
  7973         DFHEIV20
  7974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7975
  7976
  7977     MOVE 'AI'                       TO  AI-RECORD-ID.
  7978     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7979                                         AI-CL-COMPANY-CD.
  7980     MOVE 'C'                        TO  AI-SOURCE
  7981                                         AI-CL-SOURCE.
  7982
  7983     IF MLNAMEL IS GREATER THAN +0
  7984         MOVE MLNAMEI                TO  AI-LAST-NAME
  7985     ELSE
  7986         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7987
  7988     IF MFNAMEL IS GREATER THAN +0
  7989         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7990     ELSE
  7991         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7992
  7993     IF MMINITL IS GREATER THAN +0
  7994         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7995     ELSE
  7996         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7997
  7998     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7999     MOVE '5'                        TO  DC-OPTION-CODE.
  8000     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8001     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8002     IF BUILD-YEAR IS GREATER THAN 50
  8003         MOVE '19'                   TO  WS-ALPHA-YY-1
  8004         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8005         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8006         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8007     ELSE
  8008         MOVE '20'                   TO  WS-ALPHA-YY-1
  8009         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8010         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8011         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8012
  8013     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8014                                         AI-CL-DATE.
  8015
  8016     MOVE EIBTIME                    TO  AI-TIME
  8017                                         AI-CL-TIME.
  8018
  8019     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8020     MOVE 'C'                        TO  AI-CL-SOURCE.
  8021     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8022     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8023     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8024     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8025     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8026
  8027     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8028     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8029     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8030
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 144
* EL131.cbl
  8031
  8032* EXEC CICS WRITE
  8033*        DATASET   (ALPH-FILE-ID)
  8034*        RIDFLD    (AI-CONTROL-PRIMARY)
  8035*        FROM      (ALPHA-INDEX)
  8036*    END-EXEC.
  8037     MOVE LENGTH OF
  8038      ALPHA-INDEX
  8039       TO DFHEIV11
  8040*    MOVE '&$ L                  ''   #00007899' TO DFHEIV0
  8041     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8042     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8043     MOVE X'2020233030303037383939' TO DFHEIV0(25:11)
  8044     CALL 'kxdfhei1' USING DFHEIV0,
  8045           ALPH-FILE-ID,
  8046           ALPHA-INDEX,
  8047           DFHEIV11,
  8048           AI-CONTROL-PRIMARY,
  8049           DFHEIV99,
  8050           DFHEIV99
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054     MOVE LOW-VALUES                 TO  EL131AO.
  8055     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8056     MOVE ER-0000                    TO  EMI-ERROR.
  8057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8058     MOVE -1                         TO  MAINTL.
  8059     GO TO 8100-SEND-MAP.
  8060
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 145
* EL131.cbl
  8062 0600-CHANGE-NAME.
  8063******************************************************************
  8064*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8065*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8066******************************************************************
  8067
  8068     IF MLNAMEL = +0 AND
  8069        MFNAMEL = +0 AND
  8070        MMINITL = +0
  8071         MOVE ER-0276                TO  EMI-ERROR
  8072         MOVE -1                     TO  MAINTL
  8073         MOVE AL-UABON               TO  MAINTA
  8074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8075         GO TO 8110-SEND-DATA.
  8076
  8077     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8078     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8079     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8080     MOVE PI-CERT-NO                 TO  CERT-NO.
  8081
  8082
  8083* EXEC CICS READ
  8084*        DATASET   (CLMS-FILE-ID)
  8085*        RIDFLD    (MSTR-KEY)
  8086*        SET       (ADDRESS OF CLAIM-MASTER)
  8087*    END-EXEC.
  8088*    MOVE '&"S        E          (   #00007933' TO DFHEIV0
  8089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8091     MOVE X'2020233030303037393333' TO DFHEIV0(25:11)
  8092     CALL 'kxdfhei1' USING DFHEIV0,
  8093           CLMS-FILE-ID,
  8094           DFHEIV20,
  8095           DFHEIV99,
  8096           MSTR-KEY,
  8097           DFHEIV99,
  8098           DFHEIV99,
  8099           DFHEIV99
  8100     SET ADDRESS OF CLAIM-MASTER TO
  8101         DFHEIV20
  8102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8103
  8104
  8105
  8106* EXEC CICS GETMAIN
  8107*        SET       (ADDRESS OF ALPHA-INDEX)
  8108*        LENGTH    (ALPH-LENGTH)
  8109*        INITIMG   (GETMAIN-SPACE)
  8110*    END-EXEC.
  8111*    MOVE ',"IL                  $   #00007939' TO DFHEIV0
  8112     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8113     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8114     MOVE X'2020233030303037393339' TO DFHEIV0(25:11)
  8115     CALL 'kxdfhei1' USING DFHEIV0,
  8116           DFHEIV20,
  8117           ALPH-LENGTH,
  8118           GETMAIN-SPACE
  8119     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 146
* EL131.cbl
  8120         DFHEIV20
  8121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8122
  8123
  8124     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  8125     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  8126     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  8127     MOVE CL-CERT-STATE          TO CERT-STATE
  8128     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  8129     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  8130     MOVE CL-CERT-NO             TO CERT-CERT
  8131
  8132
  8133* EXEC CICS READ
  8134*       DATASET   (CERT-FILE-ID)
  8135*       RIDFLD    (CERT-KEY)
  8136*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  8137*       RESP      (WS-RESPONSE)
  8138*    END-EXEC
  8139*    MOVE '&"S        E          (  N#00007953' TO DFHEIV0
  8140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8142     MOVE X'204E233030303037393533' TO DFHEIV0(25:11)
  8143     CALL 'kxdfhei1' USING DFHEIV0,
  8144           CERT-FILE-ID,
  8145           DFHEIV20,
  8146           DFHEIV99,
  8147           CERT-KEY,
  8148           DFHEIV99,
  8149           DFHEIV99,
  8150           DFHEIV99
  8151     SET ADDRESS OF CERTIFICATE-MASTER TO
  8152         DFHEIV20
  8153     MOVE EIBRESP  TO WS-RESPONSE
  8154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8155
  8156     IF INSTYPEL > ZEROS
  8157        MOVE INSTYPEI TO CL-INSURED-TYPE
  8158     END-IF
  8159
  8160     IF MFNAMEL > +0
  8161        IF CL-INSURED-TYPE = 'C'
  8162          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  8163           MOVE ER-1675             TO EMI-ERROR
  8164           MOVE -1                  TO MFNAMEL
  8165           MOVE AL-UABON            TO MFNAMEA
  8166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8167           GO TO 8110-SEND-DATA
  8168        ELSE
  8169          IF CL-INSURED-TYPE = 'P'
  8170            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  8171             MOVE ER-1676             TO EMI-ERROR
  8172             MOVE -1                  TO MFNAMEL
  8173             MOVE AL-UABON            TO MFNAMEA
  8174             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8175             GO TO 8110-SEND-DATA
  8176          END-IF
  8177        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 147
* EL131.cbl
  8178     END-IF
  8179     MOVE 'AI'                       TO  AI-RECORD-ID.
  8180     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8181                                         AI-CL-COMPANY-CD.
  8182     MOVE 'C'                        TO  AI-SOURCE
  8183                                         AI-CL-SOURCE.
  8184
  8185     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8186     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8187     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8188
  8189     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8190     MOVE '5'                        TO  DC-OPTION-CODE.
  8191     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8192     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8193     IF BUILD-YEAR IS GREATER THAN 50
  8194         MOVE '19'                   TO  WS-ALPHA-YY-1
  8195         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8196         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8197         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8198     ELSE
  8199         MOVE '20'                   TO  WS-ALPHA-YY-1
  8200         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8201         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8202         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8203
  8204     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8205                                         AI-CL-DATE.
  8206
  8207     MOVE EIBTIME                    TO  AI-TIME
  8208                                         AI-CL-TIME.
  8209
  8210     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8211     MOVE 'C'                        TO  AI-CL-SOURCE.
  8212     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8213     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8214     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8215     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8216     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8217
  8218     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8219     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8220     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8221
  8222     IF PI-COMPANY-ID = 'CID' or 'AHL' or 'FNL'
  8223         MOVE 'Y'                TO CL-YESNOSW
  8224     END-IF.
  8225
  8226
  8227* EXEC CICS WRITE
  8228*        DATASET   (ALPH-FILE-ID)
  8229*        RIDFLD    (AI-CONTROL-PRIMARY)
  8230*        FROM      (ALPHA-INDEX)
  8231*    END-EXEC.
  8232     MOVE LENGTH OF
  8233      ALPHA-INDEX
  8234       TO DFHEIV11
  8235*    MOVE '&$ L                  ''   #00008030' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 148
* EL131.cbl
  8236     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8237     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8238     MOVE X'2020233030303038303330' TO DFHEIV0(25:11)
  8239     CALL 'kxdfhei1' USING DFHEIV0,
  8240           ALPH-FILE-ID,
  8241           ALPHA-INDEX,
  8242           DFHEIV11,
  8243           AI-CONTROL-PRIMARY,
  8244           DFHEIV99,
  8245           DFHEIV99
  8246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8247
  8248
  8249
  8250* EXEC CICS READ
  8251*        DATASET   (CLMS-FILE-ID)
  8252*        RIDFLD    (MSTR-KEY)
  8253*        SET       (ADDRESS OF CLAIM-MASTER)
  8254*        UPDATE
  8255*    END-EXEC.
  8256*    MOVE '&"S        EU         (   #00008036' TO DFHEIV0
  8257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8258     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8259     MOVE X'2020233030303038303336' TO DFHEIV0(25:11)
  8260     CALL 'kxdfhei1' USING DFHEIV0,
  8261           CLMS-FILE-ID,
  8262           DFHEIV20,
  8263           DFHEIV99,
  8264           MSTR-KEY,
  8265           DFHEIV99,
  8266           DFHEIV99,
  8267           DFHEIV99
  8268     SET ADDRESS OF CLAIM-MASTER TO
  8269         DFHEIV20
  8270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8271
  8272
  8273     if (cl-priority-cd = '8')
  8274        and (pi-processor-id not = 'PEMA'and 'JMS '
  8275             AND 'AMWA' AND 'KMSB')
  8276        MOVE ER-8003             TO EMI-ERROR
  8277        PERFORM 9900-ERROR-FORMAT
  8278                                 THRU 9900-EXIT
  8279        MOVE -1                  TO MAINTL
  8280        GO TO 8110-SEND-DATA
  8281     end-if
  8282
  8283     IF MLNAMEL IS GREATER THAN +0
  8284         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8285
  8286     IF MFNAMEL IS GREATER THAN +0
  8287         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8288
  8289     IF MMINITL IS GREATER THAN +0
  8290         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
  8291
  8292     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8293     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 149
* EL131.cbl
  8294     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8295     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8296
  8297     IF PI-COMPANY-ID = 'CID' or 'AHL' OR 'FNL'
  8298         MOVE 'Y'                TO CL-YESNOSW
  8299     END-IF.
  8300
  8301
  8302* EXEC CICS HANDLE CONDITION
  8303*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8304*    END-EXEC.
  8305*    MOVE '"$$                   ! $ #00008071' TO DFHEIV0
  8306     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8308     MOVE X'2420233030303038303731' TO DFHEIV0(25:11)
  8309     CALL 'kxdfhei1' USING DFHEIV0
  8310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8311
  8312
  8313
  8314* EXEC CICS REWRITE
  8315*        DATASET   (CLMS-FILE-ID)
  8316*        FROM      (CLAIM-MASTER)
  8317*    END-EXEC.
  8318     MOVE LENGTH OF
  8319      CLAIM-MASTER
  8320       TO DFHEIV11
  8321*    MOVE '&& L                  %   #00008075' TO DFHEIV0
  8322     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8323     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8324     MOVE X'2020233030303038303735' TO DFHEIV0(25:11)
  8325     CALL 'kxdfhei1' USING DFHEIV0,
  8326           CLMS-FILE-ID,
  8327           CLAIM-MASTER,
  8328           DFHEIV11,
  8329           DFHEIV99
  8330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8331
  8332
  8333 0600-CONTINUE-NAME-UPDATE.
  8334
  8335     MOVE LOW-VALUES                 TO  EL131AO.
  8336     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8337     MOVE ER-0000                    TO  EMI-ERROR.
  8338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8339     MOVE -1                         TO  MAINTL.
  8340     GO TO 8100-SEND-MAP.
  8341
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 150
* EL131.cbl
  8343 1000-EDIT-SCREEN.
  8344
  8345     MOVE MAINTI                 TO CHECK-MAINT.
  8346
  8347     IF NOT VALID-OPTIONS
  8348         MOVE 'X'                TO ERROR-SWITCH
  8349         MOVE -1                 TO MAINTL
  8350         MOVE AL-UABON           TO MAINTA
  8351         MOVE ER-0023            TO EMI-ERROR
  8352         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8353         GO TO 1010-EXIT.
  8354
  8355     IF NOT MODIFY-CAP
  8356         MOVE 'UPDATE'           TO  SM-READ
  8357         PERFORM 9995-SECURITY-VIOLATION
  8358         MOVE ER-0070               TO  EMI-ERROR
  8359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8360         GO TO 8100-SEND-MAP.
  8361
  8362     IF DELETE-CLAIM
  8363         MOVE AL-UANON TO MAINTA
  8364         GO TO 1010-EXIT.
  8365
  8366     MOVE AL-UANON               TO MAINTA.
  8367
  8368     IF CCNOI GREATER THAN LOW-VALUES
  8369         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8370
  8371     IF PI-COMPANY-ID = 'CSL'
  8372        CONTINUE
  8373     ELSE
  8374        IF TYPEL > ZERO
  8375           IF ((PI-COMPANY-ID = 'CID' or 'AHL' OR 'FNL')
  8376              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8377                    PI-LIFE-OVERRIDE-L1 OR 'O'))
  8378                       OR
  8379              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8380              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8381                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F' OR 'O'))
  8382              MOVE AL-UANON      TO TYPEA
  8383              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8384           ELSE
  8385              MOVE ER-0199       TO EMI-ERROR
  8386              PERFORM 9900-ERROR-FORMAT
  8387                                 THRU 9900-EXIT
  8388              MOVE AL-UABON      TO TYPEA
  8389              MOVE -1            TO TYPEL
  8390              MOVE 'X'           TO ERROR-SWITCH
  8391           END-IF
  8392        ELSE
  8393           MOVE AL-UANOF         TO TYPEA
  8394        END-IF
  8395     END-IF
  8396     IF STATUSI GREATER THAN LOW-VALUES
  8397         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8398             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8399             MOVE AL-UANON       TO STATUSA
  8400             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 151
* EL131.cbl
  8401             MOVE 'Y'            TO DLYACTV-SW
  8402         ELSE
  8403             MOVE ER-0333        TO EMI-ERROR
  8404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8405             MOVE AL-UABON       TO STATUSA
  8406             MOVE -1             TO STATUSL
  8407             MOVE 'X'            TO ERROR-SWITCH
  8408         END-IF
  8409     ELSE
  8410         MOVE SPACE              TO TRLR-SWITCH
  8411         MOVE 'N'                TO DLYACTV-SW
  8412         MOVE AL-UANOF           TO STATUSA.
  8413
  8414     IF PROCI GREATER THAN LOW-VALUES
  8415         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8416     ELSE
  8417         MOVE AL-UANOF TO PROCA.
  8418
  8419     IF SEXI GREATER THAN LOW-VALUES
  8420         IF SEXI = 'F' OR 'M'
  8421             MOVE AL-UANON       TO SEXA
  8422             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8423           ELSE
  8424             MOVE ER-0219        TO EMI-ERROR
  8425             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8426             MOVE AL-UABON       TO SEXA
  8427             MOVE -1             TO SEXL
  8428             MOVE 'X'            TO ERROR-SWITCH
  8429       ELSE
  8430         MOVE AL-UANOF           TO SEXA.
  8431
  8432     IF BIRTHL = +0
  8433         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8434         MOVE AL-UANOF           TO  BIRTHA
  8435         GO TO 1000-CONTINUE-EDITS.
  8436
  8437     IF BIRTHI = SPACES
  8438         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8439         MOVE 'X'                TO  UPDATE-SWITCH
  8440                                     MSTR-SWITCH
  8441         GO TO 1000-CONTINUE-EDITS.
  8442
  8443     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8444     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8445     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8446     MOVE '4'                    TO  DC-OPTION-CODE.
  8447     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8448     IF DATE-CONVERSION-ERROR
  8449         MOVE ER-0220            TO  EMI-ERROR
  8450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8451         MOVE AL-UABON           TO  BIRTHA
  8452         MOVE -1                 TO  BIRTHL
  8453         MOVE 'X'                TO  ERROR-SWITCH
  8454         GO TO 1000-CONTINUE-EDITS.
  8455
  8456******************************************************************
  8457**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8458**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 152
* EL131.cbl
  8459**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8460******************************************************************
  8461     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8462         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8463         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8464         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8465         MOVE '4'                TO  DC-OPTION-CODE
  8466         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8467         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8468                                     DC-ELAPSED-DAYS
  8469         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8470         IF DATE-CONVERSION-ERROR
  8471             MOVE ER-0220        TO  EMI-ERROR
  8472             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8473             MOVE AL-UABON       TO  BIRTHA
  8474             MOVE -1             TO  BIRTHL
  8475             MOVE 'X'            TO  ERROR-SWITCH
  8476             GO TO 1000-CONTINUE-EDITS.
  8477
  8478     MOVE AL-UANON               TO  BIRTHA.
  8479     MOVE 'X'                    TO  UPDATE-SWITCH
  8480                                     MSTR-SWITCH.
  8481     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8482     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8483     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8484
  8485 1000-CONTINUE-EDITS.
  8486
  8487     IF SOCIALI GREATER THAN LOW-VALUES
  8488         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8489         IF WS-SOC-SEC-NO NUMERIC AND
  8490           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8491             NEXT SENTENCE
  8492         ELSE
  8493            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8494               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8495               WS-SSN-DASH2 = '-'
  8496                 NEXT SENTENCE
  8497            ELSE
  8498                 MOVE ER-0887        TO  EMI-ERROR
  8499                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8500                 MOVE AL-UABON       TO  SOCIALA
  8501                 MOVE -1             TO  SOCIALL
  8502                 MOVE 'X'            TO  ERROR-SWITCH
  8503            END-IF
  8504        END-IF
  8505     END-IF.
  8506     if critpl > zeros
  8507        and critpi numeric
  8508        move al-uanon            to critpa
  8509        move 'X'                 to update-switch
  8510     end-if
  8511     IF SOCIALI GREATER THAN LOW-VALUES
  8512         MOVE AL-UANON           TO SOCIALA
  8513         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8514     ELSE
  8515         MOVE AL-UANOF           TO SOCIALA.
  8516
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 153
* EL131.cbl
  8517     IF OCCI GREATER THAN LOW-VALUES
  8518         MOVE AL-UANON           TO OCCA
  8519         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8520     ELSE
  8521         MOVE AL-UANOF           TO OCCA.
  8522
  8523     IF BENEL NOT GREATER THAN ZERO
  8524            GO TO 1005-CONTINUE-EDITS.
  8525
  8526     IF BENEI = SPACES
  8527        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8528           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8529           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8530           IF AUTO-PAY-TO-BENE = 'Y'
  8531               MOVE ER-1773      TO  EMI-ERROR
  8532               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8533               MOVE 'X'          TO ERROR-SWITCH
  8534               MOVE AL-UABON     TO BENEA
  8535               MOVE -1           TO BENEL
  8536           ELSE
  8537               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8538           END-IF
  8539        ELSE
  8540           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8541           IF PAYMENT-PENDING
  8542               MOVE ER-1772      TO  EMI-ERROR
  8543               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8544               MOVE 'X'          TO ERROR-SWITCH
  8545               MOVE AL-UABON     TO BENEA
  8546               MOVE -1           TO BENEL
  8547           END-IF
  8548           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8549        END-IF
  8550        GO TO 1005-CONTINUE-EDITS.
  8551
  8552
  8553* EXEC CICS HANDLE CONDITION
  8554*        NOTFND (1004-BENE-NOT-FOUND)
  8555*    END-EXEC.
  8556*    MOVE '"$I                   ! % #00008299' TO DFHEIV0
  8557     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8559     MOVE X'2520233030303038323939' TO DFHEIV0(25:11)
  8560     CALL 'kxdfhei1' USING DFHEIV0
  8561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8562
  8563
  8564     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8565     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8566     MOVE BENEI                  TO  WS-ELBENE-ID.
  8567
  8568
  8569* EXEC CICS READ
  8570*        DATASET ('ELBENE')
  8571*        RIDFLD  (WS-ELBENE-KEY)
  8572*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8573*    END-EXEC.
  8574     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 154
* EL131.cbl
  8575*    MOVE '&"S        E          (   #00008307' TO DFHEIV0
  8576     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8578     MOVE X'2020233030303038333037' TO DFHEIV0(25:11)
  8579     CALL 'kxdfhei1' USING DFHEIV0,
  8580           DFHEIV1,
  8581           DFHEIV20,
  8582           DFHEIV99,
  8583           WS-ELBENE-KEY,
  8584           DFHEIV99,
  8585           DFHEIV99,
  8586           DFHEIV99
  8587     SET ADDRESS OF BENEFICIARY-MASTER TO
  8588         DFHEIV20
  8589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8590
  8591
  8592     MOVE AL-UANON               TO  BENEA.
  8593     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8594
  8595     GO TO 1005-CONTINUE-EDITS.
  8596
  8597 1004-BENE-NOT-FOUND.
  8598     MOVE ER-0565                TO  EMI-ERROR.
  8599
  8600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8601     MOVE 'X'                    TO ERROR-SWITCH.
  8602     MOVE AL-UABON               TO BENEA.
  8603     MOVE -1                     TO BENEL.
  8604
  8605 1005-CONTINUE-EDITS.
  8606
  8607     IF DIAGI GREATER THAN LOW-VALUES
  8608         MOVE AL-UANON           TO DIAGA
  8609         MOVE 'X'                TO UPDATE-SWITCH
  8610                                    NINETY-TRLR-SWITCH
  8611     ELSE
  8612         MOVE AL-UANOF           TO DIAGA.
  8613
  8614     IF ICD1I GREATER THAN LOW-VALUES
  8615         IF (ICD1I GREATER THAN SPACES) AND
  8616            (ICD1I(4:1) NOT = '.')
  8617             IF ICD1I(4:1) = ' '
  8618                 MOVE '.' TO ICD1I(4:1)
  8619             ELSE
  8620                 IF ICD1I(8:1) = ' '
  8621                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8622                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8623                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8624                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8625                     MOVE '.'        TO ICD1I(4:1)
  8626                 END-IF
  8627             END-IF
  8628         END-IF
  8629         IF (ICD1I GREATER THAN SPACES) AND
  8630            (ICD1I(1:1) NOT > ' ' OR
  8631             ICD1I(2:1) NOT > ' ' OR
  8632             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 155
* EL131.cbl
  8633             ICD1I(4:1) NOT = '.')
  8634              MOVE ER-0992        TO  EMI-ERROR
  8635              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8636              MOVE 'X'            TO ERROR-SWITCH
  8637              MOVE AL-UABON       TO ICD1A
  8638              MOVE -1             TO ICD1L
  8639         ELSE
  8640             MOVE AL-UANON       TO ICD1A
  8641             MOVE 'X'            TO UPDATE-SWITCH
  8642                                    NINETY-TRLR-SWITCH
  8643         END-IF
  8644     ELSE
  8645         MOVE AL-UANOF           TO ICD1A
  8646     END-IF.
  8647
  8648     IF ICD2I GREATER THAN LOW-VALUES
  8649         IF (ICD2I GREATER THAN SPACES) AND
  8650            (ICD2I(4:1) NOT = '.')
  8651             IF ICD2I(4:1) = ' '
  8652                 MOVE '.' TO ICD2I(4:1)
  8653             ELSE
  8654                 IF ICD2I(8:1) = ' '
  8655                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8656                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8657                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8658                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8659                     MOVE '.'        TO ICD2I(4:1)
  8660                 END-IF
  8661             END-IF
  8662         END-IF
  8663         IF (ICD2I GREATER THAN SPACES) AND
  8664            (ICD2I(1:1) NOT > ' ' OR
  8665             ICD2I(2:1) NOT > ' ' OR
  8666             ICD2I(3:1) NOT > ' ' OR
  8667             ICD2I(4:1) NOT = '.')
  8668              MOVE ER-0992        TO EMI-ERROR
  8669              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8670              MOVE 'X'            TO ERROR-SWITCH
  8671              MOVE AL-UABON       TO ICD2A
  8672              MOVE -1             TO ICD2L
  8673         ELSE
  8674             MOVE AL-UANON       TO ICD2A
  8675             MOVE 'X'            TO UPDATE-SWITCH
  8676                                    NINETY-TRLR-SWITCH
  8677         END-IF
  8678     ELSE
  8679         MOVE AL-UANOF           TO ICD2A
  8680     END-IF.
  8681
  8682*    IF CAUSEI GREATER THAN LOW-VALUES
  8683*        MOVE AL-UANON           TO CAUSEA
  8684*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8685*    ELSE
  8686*        MOVE AL-UANOF           TO CAUSEA.
  8687
  8688*    IF ENDL GREATER THAN ZERO
  8689*        MOVE LOW-VALUES         TO HOLD-END
  8690*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 156
* EL131.cbl
  8691*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8692*        ELSE
  8693*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8694*            EXEC CICS BIF DEEDIT
  8695*                FIELD    (DEEDIT-DATE-INPUT)
  8696*                LENGTH   (DATE-LENGTH)
  8697*            END-EXEC
  8698*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8699*            MOVE '4'            TO DC-OPTION-CODE
  8700*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8701*            IF NOT DATE-CONVERSION-ERROR
  8702*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8703*                MOVE AL-UANON   TO ENDA
  8704*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8705*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8706*            ELSE
  8707*                MOVE ER-0224    TO EMI-ERROR
  8708*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8709*                MOVE AL-UABON   TO ENDA
  8710*                MOVE -1         TO ENDL
  8711*                MOVE 'X'        TO ERROR-SWITCH
  8712*      ELSE
  8713*          MOVE AL-UANOF         TO ENDA.
  8714
  8715     IF INCL GREATER THAN ZERO
  8716         MOVE LOW-VALUES         TO HOLD-INCUR
  8717         IF INCI = SPACES
  8718             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8719         ELSE
  8720             MOVE INCI           TO DEEDIT-DATE-INPUT
  8721
  8722* EXEC CICS BIF DEEDIT
  8723*                FIELD    (DEEDIT-DATE-INPUT)
  8724*                LENGTH   (DATE-LENGTH)
  8725*            END-EXEC
  8726*    MOVE '@"L                   #   #00008442' TO DFHEIV0
  8727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8729     MOVE X'2020233030303038343432' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           DEEDIT-DATE-INPUT,
  8732           DATE-LENGTH
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8734             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8735             MOVE '4'            TO DC-OPTION-CODE
  8736             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8737             IF NOT DATE-CONVERSION-ERROR
  8738                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8739                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8740                 MOVE AL-UANON           TO INCA
  8741                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8742             ELSE
  8743                 MOVE ER-0222    TO EMI-ERROR
  8744                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8745                 MOVE AL-UABON   TO INCA
  8746                 MOVE -1         TO INCL
  8747                 MOVE 'X'        TO ERROR-SWITCH
  8748       ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 157
* EL131.cbl
  8749           IF PI-NO-PMTS = ZEROS
  8750               MOVE AL-UANOF     TO INCA.
  8751
  8752     IF REPL GREATER THAN ZERO
  8753         MOVE LOW-VALUES         TO HOLD-REPORTED
  8754         IF REPI = SPACES
  8755             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8756         ELSE
  8757             MOVE REPI           TO DEEDIT-DATE-INPUT
  8758
  8759* EXEC CICS BIF DEEDIT
  8760*                FIELD    (DEEDIT-DATE-INPUT)
  8761*                LENGTH   (DATE-LENGTH)
  8762*            END-EXEC
  8763*    MOVE '@"L                   #   #00008470' TO DFHEIV0
  8764     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8766     MOVE X'2020233030303038343730' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0,
  8768           DEEDIT-DATE-INPUT,
  8769           DATE-LENGTH
  8770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8771             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8772             MOVE '4'            TO DC-OPTION-CODE
  8773             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8774             IF NOT DATE-CONVERSION-ERROR
  8775                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8776                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8777                 MOVE AL-UANON   TO REPA
  8778                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8779             ELSE
  8780                 MOVE ER-0223    TO EMI-ERROR
  8781                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8782                 MOVE AL-UABON   TO REPA
  8783                 MOVE -1         TO REPL
  8784                 MOVE 'X'        TO ERROR-SWITCH
  8785       ELSE
  8786         MOVE AL-UANOF TO REPA.
  8787
  8788     IF PDTHRUI GREATER THAN LOW-VALUES
  8789        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8790        IF PDTHRUI = SPACES
  8791           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8792        ELSE
  8793           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8794
  8795* EXEC CICS BIF DEEDIT
  8796*               FIELD    (DEEDIT-DATE-INPUT)
  8797*               LENGTH   (DATE-LENGTH)
  8798*          END-EXEC
  8799*    MOVE '@"L                   #   #00008497' TO DFHEIV0
  8800     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8801     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8802     MOVE X'2020233030303038343937' TO DFHEIV0(25:11)
  8803     CALL 'kxdfhei1' USING DFHEIV0,
  8804           DEEDIT-DATE-INPUT,
  8805           DATE-LENGTH
  8806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 158
* EL131.cbl
  8807           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8808           MOVE '4'            TO DC-OPTION-CODE
  8809           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8810           IF NOT DATE-CONVERSION-ERROR
  8811              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8812              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8813              MOVE AL-UANON   TO PDTHRUA
  8814              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8815              IF PI-USES-PAID-TO
  8816                 MOVE '6'            TO DC-OPTION-CODE
  8817                 MOVE -1             TO DC-ELAPSED-DAYS
  8818                 MOVE +0             TO DC-ELAPSED-MONTHS
  8819                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8820                 IF NO-CONVERSION-ERROR
  8821                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8822                 ELSE
  8823                    NEXT SENTENCE
  8824              ELSE
  8825                 NEXT SENTENCE
  8826           ELSE
  8827              MOVE ER-0475    TO EMI-ERROR
  8828              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8829              MOVE AL-UABON   TO PDTHRUA
  8830              MOVE -1         TO PDTHRUL
  8831              MOVE 'X'        TO ERROR-SWITCH
  8832     ELSE
  8833        IF MODIFY-CAP
  8834           MOVE AL-UANOF        TO PDTHRUA.
  8835
  8836     IF PDAMTL GREATER THAN +0
  8837         MOVE ZEROS              TO HOLD-PDAMT
  8838
  8839* EXEC CICS BIF DEEDIT
  8840*            FIELD    (PDAMTI)
  8841*            LENGTH   (9)
  8842*        END-EXEC
  8843     MOVE 9
  8844       TO DFHEIV11
  8845*    MOVE '@"L                   #   #00008532' TO DFHEIV0
  8846     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8847     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8848     MOVE X'2020233030303038353332' TO DFHEIV0(25:11)
  8849     CALL 'kxdfhei1' USING DFHEIV0,
  8850           PDAMTI,
  8851           DFHEIV11
  8852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8853         IF PDAMTI NUMERIC
  8854             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8855             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8856             MOVE AL-UNNON       TO PDAMTA
  8857         ELSE
  8858             MOVE ER-0547        TO EMI-ERROR
  8859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8860             MOVE AL-UNBON       TO PDAMTA
  8861             MOVE -1             TO PDAMTL
  8862             MOVE 'X'            TO ERROR-SWITCH
  8863     ELSE
  8864         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 159
* EL131.cbl
  8865            MOVE AL-UNNOF        TO PDAMTA.
  8866
  8867     IF NODAYSI GREATER THAN LOW-VALUES
  8868         MOVE ZEROS              TO HOLD-NODAYS
  8869
  8870* EXEC CICS BIF DEEDIT
  8871*            FIELD (NODAYSI)
  8872*            LENGTH (5)
  8873*        END-EXEC
  8874     MOVE 5
  8875       TO DFHEIV11
  8876*    MOVE '@"L                   #   #00008552' TO DFHEIV0
  8877     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8878     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8879     MOVE X'2020233030303038353532' TO DFHEIV0(25:11)
  8880     CALL 'kxdfhei1' USING DFHEIV0,
  8881           NODAYSI,
  8882           DFHEIV11
  8883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8884         IF NODAYSI NUMERIC
  8885             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8886             MOVE AL-UNNON       TO NODAYSA
  8887             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8888         ELSE
  8889             MOVE ER-0491        TO EMI-ERROR
  8890             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8891             MOVE AL-UNBON       TO NODAYSA
  8892             MOVE -1             TO NODAYSL
  8893             MOVE 'X'            TO ERROR-SWITCH
  8894     ELSE
  8895         IF MODIFY-CAP
  8896            MOVE AL-UNNOF        TO NODAYSA.
  8897
  8898     IF NOPMTSI GREATER THAN LOW-VALUES
  8899         MOVE ZEROS              TO HOLD-NOPMTS
  8900
  8901* EXEC CICS BIF DEEDIT
  8902*            FIELD (NOPMTSI)
  8903*            LENGTH (4)
  8904*        END-EXEC
  8905     MOVE 4
  8906       TO DFHEIV11
  8907*    MOVE '@"L                   #   #00008572' TO DFHEIV0
  8908     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8910     MOVE X'2020233030303038353732' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0,
  8912           NOPMTSI,
  8913           DFHEIV11
  8914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8915         IF NOPMTSI NUMERIC
  8916             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8917             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8918             MOVE AL-UNNON       TO NOPMTSA
  8919           ELSE
  8920             MOVE ER-0548        TO EMI-ERROR
  8921             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8922             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 160
* EL131.cbl
  8923             MOVE -1             TO NOPMTSL
  8924             MOVE 'X'            TO ERROR-SWITCH
  8925       ELSE
  8926         IF MODIFY-CAP
  8927            MOVE AL-UNNOF        TO NOPMTSA.
  8928
  8929     IF FORMTYPI GREATER THAN LOW-VALUES
  8930         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8931             MOVE AL-UANON       TO FORMTYPA
  8932             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8933           ELSE
  8934             MOVE ER-7650        TO EMI-ERROR
  8935             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8936             MOVE AL-UABON       TO FORMTYPA
  8937             MOVE -1             TO FORMTYPL
  8938             MOVE 'X'            TO ERROR-SWITCH
  8939       ELSE
  8940         MOVE AL-UANOF           TO FORMTYPA.
  8941
  8942     IF PRICDL GREATER THAN ZERO
  8943         IF (PRICDI = ' ') OR
  8944            (PRICDI GREATER THAN ZERO   AND
  8945             PRICDI NOT GREATER THAN '9')
  8946             MOVE AL-UANON       TO PRICDA
  8947             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8948         ELSE
  8949             MOVE ER-0274        TO EMI-ERROR
  8950             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8951             MOVE AL-UABON       TO PRICDA
  8952             MOVE -1             TO PRICDL
  8953             MOVE 'X'            TO ERROR-SWITCH
  8954     ELSE
  8955         MOVE AL-UANOF TO PRICDA.
  8956
  8957     IF PI-COMPANY-ID = 'DMD'
  8958     IF PRICDL GREATER THAN ZERO
  8959       IF SYSTEM-MODIFY-CAP  OR
  8960          PI-PROCESSOR-ID = 'LGXX'
  8961             NEXT SENTENCE
  8962           ELSE
  8963            IF CL-PRIORITY-CD = '9'  OR
  8964               PRICDI         = '9'
  8965                  MOVE ER-0938        TO EMI-ERROR
  8966                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8967                  MOVE AL-UABON       TO PRICDA
  8968                  MOVE -1             TO PRICDL
  8969                  MOVE 'X'            TO ERROR-SWITCH.
  8970
  8971     IF FILETOL GREATER THAN ZERO
  8972         MOVE AL-UANON           TO FILETOA
  8973         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8974     ELSE
  8975         MOVE AL-UANOF TO FILETOA.
  8976
  8977     IF SUPVL GREATER THAN ZERO
  8978         IF SUPVI = 'Y' OR 'N' OR SPACE
  8979             MOVE AL-UANON       TO SUPVA
  8980             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 161
* EL131.cbl
  8981         ELSE
  8982             MOVE ER-0230        TO EMI-ERROR
  8983             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8984             MOVE AL-UABON       TO SUPVA
  8985             MOVE -1             TO SUPVL
  8986             MOVE 'X'            TO ERROR-SWITCH
  8987     ELSE
  8988         MOVE AL-UANOF           TO SUPVA.
  8989
  8990     IF MLNAMEL GREATER THAN ZERO
  8991         IF MLNAMEI GREATER THAN SPACES
  8992            MOVE AL-UANON        TO MLNAMEA
  8993            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8994                                     MSTR-KEY-SWITCH
  8995         ELSE
  8996            MOVE ER-0236         TO EMI-ERROR
  8997            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8998            MOVE AL-UABON        TO MLNAMEA
  8999            MOVE -1              TO MLNAMEL
  9000            MOVE 'X'             TO ERROR-SWITCH
  9001     ELSE
  9002         MOVE AL-UANOF           TO MLNAMEA.
  9003
  9004     IF MFNAMEI GREATER THAN LOW-VALUES
  9005         MOVE AL-UANON           TO MFNAMEA
  9006         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9007     ELSE
  9008         MOVE AL-UANOF           TO MFNAMEA.
  9009
  9010     IF MMINITI GREATER THAN LOW-VALUES
  9011         MOVE AL-UANON           TO MMINITA
  9012         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9013     ELSE
  9014         MOVE AL-UANOF           TO MMINITA.
  9015
  9016     IF CRTLNMEI GREATER THAN LOW-VALUES
  9017         IF CRTLNMEI NOT = SPACES
  9018            MOVE AL-UANON        TO CRTLNMEA
  9019            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  9020                                     CERT-KEY-SWITCH
  9021        ELSE
  9022            MOVE ER-0236         TO EMI-ERROR
  9023            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9024            MOVE AL-UABON        TO CRTLNMEA
  9025            MOVE -1              TO CRTLNMEL
  9026            MOVE 'X'             TO ERROR-SWITCH
  9027     ELSE
  9028         MOVE AL-UANOF           TO CRTLNMEA.
  9029
  9030     IF CRTFNMEI GREATER THAN LOW-VALUES
  9031         MOVE AL-UANON           TO CRTFNMEA
  9032         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9033     ELSE
  9034         MOVE AL-UANOF           TO CRTFNMEA.
  9035
  9036     IF CRTINITI GREATER THAN LOW-VALUES
  9037         MOVE AL-UANON           TO CRTINITA
  9038         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 162
* EL131.cbl
  9039     ELSE
  9040         MOVE AL-UANOF           TO CRTINITA.
  9041
  9042     IF ISSAGEL GREATER THAN ZERO
  9043         IF ISSAGEI NUMERIC
  9044            MOVE AL-UANON        TO ISSAGEA
  9045            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9046         ELSE
  9047            MOVE ER-0237         TO EMI-ERROR
  9048            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9049            MOVE AL-UABON        TO ISSAGEA
  9050            MOVE -1              TO ISSAGEL
  9051            MOVE 'X'             TO ERROR-SWITCH
  9052     ELSE
  9053         MOVE AL-UANOF           TO ISSAGEA.
  9054
  9055     IF JNTFNMEI GREATER THAN LOW-VALUES
  9056         MOVE AL-UANON           TO JNTFNMEA
  9057         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9058     ELSE
  9059         MOVE AL-UANOF           TO JNTFNMEA.
  9060
  9061     IF JNTLNMEI GREATER THAN LOW-VALUES
  9062         MOVE AL-UANON           TO JNTLNMEA
  9063         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9064     ELSE
  9065         MOVE AL-UANOF           TO JNTLNMEA.
  9066
  9067     IF JNTINITI GREATER THAN LOW-VALUES
  9068         MOVE AL-UANON           TO JNTINITA
  9069         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9070     ELSE
  9071         MOVE AL-UANOF           TO JNTINITA.
  9072
  9073     IF JNTAGEL GREATER THAN ZERO
  9074         IF JNTAGEI NUMERIC
  9075            MOVE AL-UANON        TO JNTAGEA
  9076            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9077         ELSE
  9078            MOVE ER-0238         TO EMI-ERROR
  9079            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9080            MOVE AL-UABON        TO JNTAGEA
  9081            MOVE -1              TO JNTAGEL
  9082            MOVE 'X'             TO ERROR-SWITCH
  9083     ELSE
  9084         MOVE AL-UANOF           TO JNTAGEA.
  9085
  9086     IF ADDONDTI GREATER THAN LOW-VALUES
  9087         MOVE LOW-VALUES         TO HOLD-ADDON
  9088         IF ADDONDTI = SPACES
  9089             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  9090         ELSE
  9091             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  9092
  9093* EXEC CICS BIF DEEDIT
  9094*                FIELD    (DEEDIT-DATE-INPUT)
  9095*                LENGTH   (DATE-LENGTH)
  9096*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 163
* EL131.cbl
  9097*    MOVE '@"L                   #   #00008753' TO DFHEIV0
  9098     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9099     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9100     MOVE X'2020233030303038373533' TO DFHEIV0(25:11)
  9101     CALL 'kxdfhei1' USING DFHEIV0,
  9102           DEEDIT-DATE-INPUT,
  9103           DATE-LENGTH
  9104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9105             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9106             MOVE '4'            TO DC-OPTION-CODE
  9107             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9108             IF NOT DATE-CONVERSION-ERROR
  9109                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  9110                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  9111                                                  CERT-SWITCH
  9112                 MOVE AL-UANON   TO ADDONDTA
  9113                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9114             ELSE
  9115                 MOVE ER-7651    TO EMI-ERROR
  9116                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9117                 MOVE AL-UABON   TO ADDONDTA
  9118                 MOVE -1         TO ADDONDTL
  9119                 MOVE 'X'        TO ERROR-SWITCH
  9120       ELSE
  9121         MOVE AL-UANOF TO ADDONDTA.
  9122
  9123     IF LCVCDI GREATER THAN LOW-VALUES
  9124         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9125         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9126     ELSE
  9127         MOVE AL-UANOF           TO LCVCDA.
  9128
  9129     IF ACVCDI GREATER THAN LOW-VALUES
  9130         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9131         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9132     ELSE
  9133         MOVE AL-UANOF           TO ACVCDA.
  9134
  9135     IF LCVOTRMI GREATER THAN LOW-VALUES
  9136
  9137* EXEC CICS BIF DEEDIT
  9138*            FIELD (LCVOTRMI)
  9139*            LENGTH(3)
  9140*        END-EXEC
  9141     MOVE 3
  9142       TO DFHEIV11
  9143*    MOVE '@"L                   #   #00008788' TO DFHEIV0
  9144     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9145     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9146     MOVE X'2020233030303038373838' TO DFHEIV0(25:11)
  9147     CALL 'kxdfhei1' USING DFHEIV0,
  9148           LCVOTRMI,
  9149           DFHEIV11
  9150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9151         IF LCVOTRMI IS NUMERIC
  9152             MOVE LCVOTRMI       TO LCVOTRMO
  9153             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9154             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 164
* EL131.cbl
  9155         ELSE
  9156             MOVE ER-0241        TO EMI-ERROR
  9157             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9158             MOVE AL-UNBON       TO LCVOTRMA
  9159             MOVE 'X'            TO ERROR-SWITCH
  9160             MOVE -1             TO LCVOTRML
  9161     ELSE
  9162         MOVE AL-UANOF           TO LCVOTRMA.
  9163
  9164     IF ACVOTRMI GREATER THAN LOW-VALUES
  9165
  9166* EXEC CICS BIF DEEDIT
  9167*            FIELD (ACVOTRMI)
  9168*            LENGTH(3)
  9169*        END-EXEC
  9170     MOVE 3
  9171       TO DFHEIV11
  9172*    MOVE '@"L                   #   #00008806' TO DFHEIV0
  9173     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9174     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9175     MOVE X'2020233030303038383036' TO DFHEIV0(25:11)
  9176     CALL 'kxdfhei1' USING DFHEIV0,
  9177           ACVOTRMI,
  9178           DFHEIV11
  9179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9180         IF ACVOTRMI IS NUMERIC
  9181             MOVE ACVOTRMI       TO ACVOTRMO
  9182             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9183             MOVE AL-UANON       TO ACVOTRMA
  9184         ELSE
  9185             MOVE ER-0241        TO EMI-ERROR
  9186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9187             MOVE AL-UNBON       TO ACVOTRMA
  9188             MOVE 'X'            TO ERROR-SWITCH
  9189             MOVE -1             TO ACVOTRML
  9190     ELSE
  9191         MOVE AL-UANOF           TO ACVOTRMA.
  9192
  9193     IF LCVRATEL GREATER THAN +0
  9194
  9195* EXEC CICS BIF DEEDIT
  9196*            FIELD (LCVRATEI)
  9197*            LENGTH(6)
  9198*        END-EXEC
  9199     MOVE 6
  9200       TO DFHEIV11
  9201*    MOVE '@"L                   #   #00008824' TO DFHEIV0
  9202     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9203     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9204     MOVE X'2020233030303038383234' TO DFHEIV0(25:11)
  9205     CALL 'kxdfhei1' USING DFHEIV0,
  9206           LCVRATEI,
  9207           DFHEIV11
  9208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9209         IF LCVRATEI IS NUMERIC
  9210             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9211             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9212             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 165
* EL131.cbl
  9213         ELSE
  9214             MOVE ER-2280        TO EMI-ERROR
  9215             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9216             MOVE AL-UNBON       TO LCVRATEA
  9217             MOVE 'X'            TO ERROR-SWITCH
  9218             MOVE -1             TO LCVRATEL
  9219     ELSE
  9220         MOVE AL-UNNOF           TO LCVRATEA.
  9221
  9222     IF ACVRATEL GREATER THAN +0
  9223
  9224* EXEC CICS BIF DEEDIT
  9225*            FIELD (ACVRATEI)
  9226*            LENGTH(6)
  9227*        END-EXEC
  9228     MOVE 6
  9229       TO DFHEIV11
  9230*    MOVE '@"L                   #   #00008842' TO DFHEIV0
  9231     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9232     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9233     MOVE X'2020233030303038383432' TO DFHEIV0(25:11)
  9234     CALL 'kxdfhei1' USING DFHEIV0,
  9235           ACVRATEI,
  9236           DFHEIV11
  9237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9238         IF ACVRATEI IS NUMERIC
  9239             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9240             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9241             MOVE AL-UNNON       TO ACVRATEA
  9242         ELSE
  9243             MOVE ER-2280        TO EMI-ERROR
  9244             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9245             MOVE AL-UNBON       TO ACVRATEA
  9246             MOVE 'X'            TO ERROR-SWITCH
  9247             MOVE -1             TO ACVRATEL
  9248     ELSE
  9249         MOVE AL-UNNOF           TO ACVRATEA.
  9250
  9251     IF LCVBENEL GREATER THAN ZERO
  9252
  9253* EXEC CICS BIF DEEDIT
  9254*            FIELD (LCVBENEI)
  9255*            LENGTH (11)
  9256*        END-EXEC
  9257     MOVE 11
  9258       TO DFHEIV11
  9259*    MOVE '@"L                   #   #00008860' TO DFHEIV0
  9260     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9261     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9262     MOVE X'2020233030303038383630' TO DFHEIV0(25:11)
  9263     CALL 'kxdfhei1' USING DFHEIV0,
  9264           LCVBENEI,
  9265           DFHEIV11
  9266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9267         IF LCVBENEI IS NUMERIC
  9268            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9269            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9270            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 166
* EL131.cbl
  9271         ELSE
  9272            MOVE ER-0243         TO EMI-ERROR
  9273            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9274            MOVE AL-UNBON        TO LCVBENEA
  9275            MOVE -1              TO LCVBENEL
  9276            MOVE 'X'             TO ERROR-SWITCH
  9277     ELSE
  9278         MOVE AL-UANOF           TO LCVBENEA.
  9279
  9280     IF ACVBENEL GREATER THAN ZERO
  9281
  9282* EXEC CICS BIF DEEDIT
  9283*            FIELD (ACVBENEI)
  9284*            LENGTH (11)
  9285*        END-EXEC
  9286     MOVE 11
  9287       TO DFHEIV11
  9288*    MOVE '@"L                   #   #00008878' TO DFHEIV0
  9289     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9290     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9291     MOVE X'2020233030303038383738' TO DFHEIV0(25:11)
  9292     CALL 'kxdfhei1' USING DFHEIV0,
  9293           ACVBENEI,
  9294           DFHEIV11
  9295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9296         IF ACVBENEI IS NUMERIC
  9297            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9298            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9299            MOVE AL-UNNON        TO ACVBENEA
  9300         ELSE
  9301            MOVE ER-0243         TO EMI-ERROR
  9302            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9303            MOVE AL-UNBON        TO ACVBENEA
  9304            MOVE -1              TO ACVBENEL
  9305            MOVE 'X'             TO ERROR-SWITCH
  9306     ELSE
  9307         MOVE AL-UANOF           TO ACVBENEA.
  9308
  9309     IF LCVFORMI GREATER THAN LOW-VALUES
  9310        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9311        MOVE AL-UANON            TO LCVFORMA
  9312     ELSE
  9313        MOVE AL-UANOF            TO LCVFORMA.
  9314
  9315     IF ACVFORMI GREATER THAN LOW-VALUES
  9316        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9317        MOVE AL-UANON            TO ACVFORMA
  9318     ELSE
  9319        MOVE AL-UANOF            TO ACVFORMA.
  9320
  9321     IF LCVCNDTL GREATER THAN ZERO
  9322         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9323         IF LCVCNDTI = SPACES
  9324             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9325         ELSE
  9326             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9327             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9328             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 167
* EL131.cbl
  9329             MOVE '4'            TO DC-OPTION-CODE
  9330             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9331             IF NOT DATE-CONVERSION-ERROR
  9332                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9333                 MOVE AL-UANON   TO LCVCNDTA
  9334                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9335                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9336             ELSE
  9337                 MOVE ER-0246    TO EMI-ERROR
  9338                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9339                 MOVE AL-UABON   TO LCVCNDTA
  9340                 MOVE -1         TO LCVCNDTL
  9341                 MOVE 'X'        TO ERROR-SWITCH
  9342     ELSE
  9343         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9344         MOVE AL-UANOF           TO LCVCNDTA.
  9345
  9346     IF ACVCNDTL GREATER THAN ZERO
  9347         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9348         IF ACVCNDTI = SPACES
  9349             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9350         ELSE
  9351             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9352             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9353             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9354             MOVE '4'            TO DC-OPTION-CODE
  9355             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9356             IF NOT DATE-CONVERSION-ERROR
  9357                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9358                 MOVE AL-UANON   TO ACVCNDTA
  9359                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9360                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9361             ELSE
  9362                 MOVE ER-0246    TO EMI-ERROR
  9363                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9364                 MOVE AL-UABON   TO ACVCNDTA
  9365                 MOVE -1         TO ACVCNDTL
  9366                 MOVE 'X'        TO ERROR-SWITCH
  9367     ELSE
  9368         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9369         MOVE AL-UANOF           TO ACVCNDTA.
  9370
  9371     IF APRL GREATER THAN +0
  9372
  9373* EXEC CICS BIF DEEDIT
  9374*            FIELD    (APRI)
  9375*            LENGTH   (8)
  9376*        END-EXEC
  9377     MOVE 8
  9378       TO DFHEIV11
  9379*    MOVE '@"L                   #   #00008958' TO DFHEIV0
  9380     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9381     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9382     MOVE X'2020233030303038393538' TO DFHEIV0(25:11)
  9383     CALL 'kxdfhei1' USING DFHEIV0,
  9384           APRI,
  9385           DFHEIV11
  9386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 168
* EL131.cbl
  9387         IF APRI NUMERIC
  9388            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9389            MOVE APRI            TO HOLD-APR APRO
  9390            MOVE AL-UANON        TO APRA
  9391          ELSE
  9392            MOVE ER-0259         TO EMI-ERROR
  9393            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9394            MOVE AL-UABON        TO APRA
  9395            MOVE -1              TO APRL
  9396            MOVE 'X'             TO ERROR-SWITCH
  9397     ELSE
  9398         MOVE AL-UANOF           TO APRA.
  9399
  9400     IF PMTFREQL GREATER THAN ZERO
  9401
  9402* EXEC CICS BIF DEEDIT
  9403*            FIELD    (PMTFREQI)
  9404*            LENGTH   (2)
  9405*        END-EXEC
  9406     MOVE 2
  9407       TO DFHEIV11
  9408*    MOVE '@"L                   #   #00008976' TO DFHEIV0
  9409     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9410     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9411     MOVE X'2020233030303038393736' TO DFHEIV0(25:11)
  9412     CALL 'kxdfhei1' USING DFHEIV0,
  9413           PMTFREQI,
  9414           DFHEIV11
  9415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9416         IF PMTFREQI NUMERIC
  9417            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9418            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9419            MOVE AL-UANON        TO PMTFREQA
  9420          ELSE
  9421            MOVE ER-0427         TO EMI-ERROR
  9422            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9423            MOVE AL-UABON        TO PMTFREQA
  9424            MOVE -1              TO PMTFREQL
  9425            MOVE 'X'             TO ERROR-SWITCH
  9426     ELSE
  9427         MOVE AL-UANOF           TO PMTFREQA.
  9428
  9429     IF INDGRPL GREATER THAN ZERO
  9430         IF INDGRPI = 'I' OR 'G' OR SPACE
  9431             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9432             MOVE AL-UANON       TO INDGRPA
  9433          ELSE
  9434             MOVE ER-0260        TO EMI-ERROR
  9435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9436             MOVE AL-UABON       TO INDGRPA
  9437             MOVE -1             TO INDGRPL
  9438             MOVE 'X'            TO ERROR-SWITCH
  9439     ELSE
  9440         MOVE AL-UANOF           TO INDGRPA.
  9441
  9442     IF PREMTYPL GREATER THAN ZERO
  9443         IF PREMTYPI = '1' OR '2' OR '3'
  9444            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 169
* EL131.cbl
  9445            MOVE AL-UNNON        TO PREMTYPA
  9446            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9447          ELSE
  9448            MOVE ER-0227         TO EMI-ERROR
  9449            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9450            MOVE AL-UNBON        TO PREMTYPA
  9451            MOVE -1              TO PREMTYPL
  9452            MOVE 'X'             TO ERROR-SWITCH
  9453     ELSE
  9454         MOVE AL-UANOF           TO PREMTYPA.
  9455
  9456     IF LOANBALL GREATER THAN ZERO
  9457
  9458* EXEC CICS BIF DEEDIT
  9459*             FIELD    (LOANBALI)
  9460*             LENGTH   (9)
  9461*        END-EXEC
  9462     MOVE 9
  9463       TO DFHEIV11
  9464*    MOVE '@"L                   #   #00009021' TO DFHEIV0
  9465     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9466     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9467     MOVE X'2020233030303039303231' TO DFHEIV0(25:11)
  9468     CALL 'kxdfhei1' USING DFHEIV0,
  9469           LOANBALI,
  9470           DFHEIV11
  9471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9472         IF LOANBALI NUMERIC
  9473             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9474             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9475             MOVE AL-UNNON TO LOANBALA
  9476         ELSE
  9477             MOVE ER-0639        TO EMI-ERROR
  9478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9479             MOVE AL-UNBON       TO LOANBALA
  9480             MOVE -1             TO LOANBALL
  9481             MOVE 'X'            TO ERROR-SWITCH
  9482     ELSE
  9483         MOVE AL-UNNOF           TO LOANBALA.
  9484
  9485*    IF LOANNOL GREATER THAN ZERO
  9486*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9487*          MOVE AL-UANON            TO LOANNOA
  9488*       ELSE
  9489*          MOVE AL-UANOF            TO LOANNOA.
  9490
  9491     IF REINCDI GREATER THAN LOW-VALUES
  9492        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9493        MOVE AL-UANON            TO REINCDA
  9494     ELSE
  9495        MOVE AL-UANOF            TO REINCDA.
  9496
  9497     IF CERTI GREATER THAN LOW-VALUES
  9498         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9499     ELSE
  9500         MOVE AL-UANOF           TO CERTA.
  9501
  9502     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 170
* EL131.cbl
  9503         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9504     ELSE
  9505         MOVE AL-UANOF           TO CERTEFFA.
  9506
  9507     IF CERTACTI GREATER THAN LOW-VALUES
  9508         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9509     ELSE
  9510         MOVE AL-UANOF           TO CERTACTA.
  9511
  9512     IF CERTSTI GREATER THAN LOW-VALUES
  9513         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9514     ELSE
  9515         MOVE AL-UANOF           TO CERTSTA.
  9516
  9517     IF CERTCARI GREATER THAN LOW-VALUES
  9518         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9519     ELSE
  9520         MOVE AL-UANOF           TO CERTCARA.
  9521
  9522     IF DLYACTV-RECORD-NEEDED
  9523         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9524                 1150-EXIT
  9525     END-IF.
  9526
  9527     IF CERTEFFI GREATER LOW-VALUES OR
  9528        CERTACTI GREATER LOW-VALUES OR
  9529        CERTSTI  GREATER LOW-VALUES OR
  9530        CERTCARI GREATER LOW-VALUES OR
  9531        CERTGRPI GREATER LOW-VALUES
  9532        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9533
  9534*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9535*      IF PI-PREM-TYPE NOT = '1'  AND
  9536*         PI-NO-PMTS = ZEROS
  9537*          IF LOANBALL GREATER +0 OR
  9538*             ACVBENEL GREATER +0
  9539*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9540     if not acct-found
  9541        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9542     end-if
  9543     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9544     MOVE PI-CARRIER             TO CARRIER-CODE
  9545     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9546     MOVE PI-CERT-NO             TO CERT-NO
  9547
  9548* EXEC CICS READ
  9549*        DATASET   (CLMS-FILE-ID)
  9550*        RIDFLD    (MSTR-KEY)
  9551*        SET       (ADDRESS OF CLAIM-MASTER)
  9552*        RESP      (WS-RESPONSE)
  9553*    END-EXEC
  9554*    MOVE '&"S        E          (  N#00009100' TO DFHEIV0
  9555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9557     MOVE X'204E233030303039313030' TO DFHEIV0(25:11)
  9558     CALL 'kxdfhei1' USING DFHEIV0,
  9559           CLMS-FILE-ID,
  9560           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 171
* EL131.cbl
  9561           DFHEIV99,
  9562           MSTR-KEY,
  9563           DFHEIV99,
  9564           DFHEIV99,
  9565           DFHEIV99
  9566     SET ADDRESS OF CLAIM-MASTER TO
  9567         DFHEIV20
  9568     MOVE EIBRESP  TO WS-RESPONSE
  9569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9570     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9571     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9572     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9573     MOVE CL-CERT-STATE          TO CERT-STATE
  9574     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9575     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9576     MOVE CL-CERT-NO             TO CERT-CERT
  9577
  9578* EXEC CICS READ
  9579*       DATASET   (CERT-FILE-ID)
  9580*       RIDFLD    (CERT-KEY)
  9581*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9582*       RESP      (WS-RESPONSE)
  9583*    END-EXEC
  9584*    MOVE '&"S        E          (  N#00009113' TO DFHEIV0
  9585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9587     MOVE X'204E233030303039313133' TO DFHEIV0(25:11)
  9588     CALL 'kxdfhei1' USING DFHEIV0,
  9589           CERT-FILE-ID,
  9590           DFHEIV20,
  9591           DFHEIV99,
  9592           CERT-KEY,
  9593           DFHEIV99,
  9594           DFHEIV99,
  9595           DFHEIV99
  9596     SET ADDRESS OF CERTIFICATE-MASTER TO
  9597         DFHEIV20
  9598     MOVE EIBRESP  TO WS-RESPONSE
  9599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9600     if mfnamei > low-values
  9601        move mfnamei to w-name-first
  9602     else
  9603        move cl-insured-1st-name to w-name-first
  9604     end-if
  9605     if mlnamei > low-values
  9606        move mlnamei to w-name-last
  9607     else
  9608        move cl-insured-last-name to w-name-last
  9609     end-if
  9610     if instypel > zeros
  9611        evaluate true
  9612           when cl-no-of-days-paid > zeros
  9613              move er-1668       to emi-error
  9614              perform 9900-error-format
  9615                                 thru 9900-exit
  9616              move al-uabon      to instypea
  9617              move -1            to instypel
  9618              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 172
* EL131.cbl
  9619           when instypei = 'C'
  9620              if (w-name-first (1:10) = cm-insured-first-name)
  9621                 and (w-name-last = cm-insured-last-name)
  9622                 move er-1666    to emi-error
  9623                 PERFORM 9900-ERROR-FORMAT
  9624                                 THRU 9900-EXIT
  9625                 move al-uabon   to instypea
  9626                 move -1         to instypel
  9627                 move 'X'        to error-switch
  9628              end-if
  9629           when instypei = 'P'
  9630              if (w-name-first (1:10) <> cm-insured-first-name)
  9631                 or (w-name-last <> cm-insured-last-name)
  9632                 move er-1676    to emi-error
  9633                 PERFORM 9900-ERROR-FORMAT
  9634                                 THRU 9900-EXIT
  9635                 move al-uabon   to instypea
  9636                 move -1         to instypel
  9637                 move 'X'        to error-switch
  9638              end-if
  9639        end-evaluate
  9640     end-if
  9641*    if (instypel > zeros)
  9642*       and (cl-no-of-days-paid > zero)
  9643*       move er-1668             to emi-error
  9644*       perform 9900-error-format thru 9900-exit
  9645*       move al-uabon            to instypea
  9646*       move -1                  to instypel
  9647*       move 'X'                 to error-switch
  9648*    end-if
  9649*
  9650*    if instypel > zero
  9651*       if instypei = 'C'
  9652*          if w-name-first (1:10) = cm-insured-first-name
  9653*             move er-1666          to emi-error
  9654*             PERFORM 9900-ERROR-FORMAT
  9655*                                   THRU 9900-EXIT
  9656*             move al-uabon         to instypea
  9657*             move -1               to instypel
  9658*             move 'X'              to error-switch
  9659*          end-if
  9660*       end-if
  9661*    end-if
  9662     if (pi-company-id = 'DCC' OR 'VPP')
  9663        and (acct-found)
  9664        perform 2120-check-pdef  thru 2120-exit
  9665        IF EXTENSL > ZERO
  9666           IF EXTENSI NUMERIC
  9667              IF EXTENSI >  WS-MAX-EXTENSION
  9668                AND ERPDEF-FOUND
  9669                 MOVE ER-1678          TO EMI-ERROR
  9670                 PERFORM 9900-ERROR-FORMAT
  9671                                       THRU 9900-EXIT
  9672                 MOVE AL-UABON         TO EXTENSA
  9673                 MOVE -1               TO EXTENSL
  9674                 MOVE 'X'              TO ERROR-SWITCH
  9675              ELSE
  9676                 MOVE 'X'              TO UPDATE-SWITCH
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 173
* EL131.cbl
  9677              END-IF
  9678           ELSE
  9679              MOVE ER-1778          TO EMI-ERROR
  9680              PERFORM 9900-ERROR-FORMAT
  9681                                    THRU 9900-EXIT
  9682              MOVE AL-UABON         TO EXTENSA
  9683              MOVE -1               TO EXTENSL
  9684              MOVE 'X'              TO ERROR-SWITCH
  9685           END-IF
  9686        END-IF
  9687     end-if
  9688     if benperl > zeros
  9689        move al-uanon            to benpera
  9690     end-if
  9691     if benperl > zeros
  9692        if benperi numeric
  9693           perform 1015-edit-benefit-period
  9694                                 thru 1015-exit
  9695        else
  9696           move er-1669          to emi-error
  9697           PERFORM 9900-ERROR-FORMAT
  9698                                 THRU 9900-EXIT
  9699           move al-uabon         to benpera
  9700           move -1               to benperl
  9701           move 'X'              to error-switch
  9702        end-if
  9703    end-if
  9704     if instypel > zeros
  9705        if instypei = 'P' OR 'C'
  9706           move 'X'              to update-switch
  9707                                    mstr-switch
  9708           move al-uanon         to instypea
  9709        else
  9710            move er-1654          to emi-error
  9711           PERFORM 9900-ERROR-FORMAT
  9712                                 THRU 9900-EXIT
  9713           move al-uabon         to instypea
  9714           move -1               to instypel
  9715           move 'X'              to error-switch
  9716        end-if
  9717    end-if
  9718     if accswl > zeros
  9719        if accswi = 'Y' OR 'N'
  9720           MOVE 'X'              TO UPDATE-SWITCH
  9721                                    MSTR-SWITCH
  9722           MOVE AL-UANON         TO accswa
  9723*       else
  9724*          move er-1656          to emi-error
  9725*          PERFORM 9900-ERROR-FORMAT
  9726*                                THRU 9900-EXIT
  9727*          move al-uabon         to accswa
  9728*          move -1               to accswl
  9729*          move 'X'              to error-switch
  9730*          move al-uanof         to accswa
  9731        end-if
  9732     end-if
  9733     IF CERTL = ZEROS AND
  9734        SUFXL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 174
* EL131.cbl
  9735          GO TO 1010-EXIT.
  9736
  9737     IF CERTL GREATER THAN ZEROS
  9738         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9739             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9740             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9741             MOVE 'X'            TO ERROR-SWITCH
  9742             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9743
  9744     IF SUFXL GREATER THAN ZEROS
  9745         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9746             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9747             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9748             MOVE 'X'            TO ERROR-SWITCH
  9749             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9750
  9751 1010-EXIT.
  9752     EXIT.
  9753
  9754 1015-edit-benefit-period.
  9755     move ' '                    to ws-benper-sw
  9756     evaluate true
  9757        when not erpdef-found
  9758           set good-benper       to true
  9759        when pd-recurring-yn (a1) = 'Y'
  9760           set good-benper       to true
  9761        when pd-recurring-yn (a1) = 'N'
  9762           if benperi < 02
  9763              set good-benper    to true
  9764           end-if
  9765        when pd-rec-crit-period (a1) numeric
  9766           if benperi <= pd-rec-crit-period (a1)
  9767              set good-benper    to true
  9768           end-if
  9769     end-evaluate
  9770     MOVE CERT-KEY               TO ELCRTT-KEY
  9771     MOVE 'B'                    TO CTRLR-REC-TYPE
  9772
  9773* EXEC CICS READ
  9774*       DATASET   ('ELCRTT')
  9775*       RIDFLD    (ELCRTT-KEY)
  9776*       INTO      (CERTIFICATE-TRAILERS)
  9777*       RESP      (WS-RESPONSE)
  9778*    END-EXEC
  9779     MOVE LENGTH OF
  9780      CERTIFICATE-TRAILERS
  9781       TO DFHEIV11
  9782     MOVE 'ELCRTT' TO DFHEIV1
  9783*    MOVE '&"IL       E          (  N#00009291' TO DFHEIV0
  9784     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9785     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9786     MOVE X'204E233030303039323931' TO DFHEIV0(25:11)
  9787     CALL 'kxdfhei1' USING DFHEIV0,
  9788           DFHEIV1,
  9789           CERTIFICATE-TRAILERS,
  9790           DFHEIV11,
  9791           ELCRTT-KEY,
  9792           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 175
* EL131.cbl
  9793           DFHEIV99,
  9794           DFHEIV99
  9795     MOVE EIBRESP  TO WS-RESPONSE
  9796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9797     IF WS-RESP-NORMAL
  9798        perform varying s1 from +1 by +1 until
  9799           (s1 > +24)
  9800           or ((cs-claim-type (s1) = cl-claim-type)
  9801           and (cs-insured-type (s1) = cl-insured-type)
  9802           and (cs-benefit-period (s1) > benperi))
  9803        end-perform
  9804        if s1 < +25
  9805           move er-1665          to emi-error
  9806           PERFORM 9900-ERROR-FORMAT
  9807                                 THRU 9900-EXIT
  9808           move al-uabon         to benpera
  9809           move -1               to benperl
  9810           move 'X'              to error-switch
  9811           go to 1015-exit
  9812*       else
  9813*          set good-benper       to true
  9814        end-if
  9815     end-if
  9816     if good-benper
  9817        move 'X'                 to update-switch
  9818                                    mstr-switch
  9819        move al-uanon            to benpera
  9820     else
  9821        move er-1669             to emi-error
  9822        PERFORM 9900-ERROR-FORMAT
  9823                                 THRU 9900-EXIT
  9824        move al-uabon            to benpera
  9825        move -1                  to benperl
  9826        move 'X'                 to error-switch
  9827     end-if
  9828     .
  9829 1015-exit.
  9830     exit.
  9831 1030-EDIT-NAME.
  9832     IF INSTYPEL > ZEROS
  9833        MOVE INSTYPEI TO CL-INSURED-TYPE
  9834     END-IF
  9835     IF MFNAMEL > +0
  9836        IF CL-INSURED-TYPE = 'C'
  9837          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  9838           MOVE ER-1675             TO EMI-ERROR
  9839           MOVE -1                  TO MFNAMEL
  9840           MOVE AL-UABON            TO MFNAMEA
  9841           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9842           MOVE 'X'                 TO ERROR-SWITCH
  9843        ELSE
  9844          IF CL-INSURED-TYPE = 'P'
  9845            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  9846             MOVE ER-1676             TO EMI-ERROR
  9847             MOVE -1                  TO MFNAMEL
  9848             MOVE AL-UABON            TO MFNAMEA
  9849             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9850             MOVE 'X'                 TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 176
* EL131.cbl
  9851          END-IF
  9852        END-IF
  9853     END-IF.
  9854
  9855 1030-EXIT.
  9856     EXIT.
  9857 1050-EDIT-BENE.
  9858     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9859     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9860     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9861     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9862     MOVE 1000               TO TRLR-SEQ-NO.
  9863
  9864
  9865* EXEC CICS HANDLE CONDITION
  9866*         NOTFND    (1052-DONE)
  9867*         ENDFILE   (1052-DONE)
  9868*    END-EXEC.
  9869*    MOVE '"$I''                  ! & #00009364' TO DFHEIV0
  9870     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9872     MOVE X'2620233030303039333634' TO DFHEIV0(25:11)
  9873     CALL 'kxdfhei1' USING DFHEIV0
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9875
  9876
  9877
  9878* EXEC CICS STARTBR
  9879*        DATASET (TRLR-FILE-ID)
  9880*        RIDFLD  (TRLR-KEY)
  9881*    END-EXEC
  9882     MOVE 0
  9883       TO DFHEIV11
  9884*    MOVE '&,         G          &   #00009369' TO DFHEIV0
  9885     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9887     MOVE X'2020233030303039333639' TO DFHEIV0(25:11)
  9888     CALL 'kxdfhei1' USING DFHEIV0,
  9889           TRLR-FILE-ID,
  9890           TRLR-KEY,
  9891           DFHEIV99,
  9892           DFHEIV11,
  9893           DFHEIV99
  9894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9895
  9896
  9897     MOVE SPACES TO WS-TRLR-FILE-EOF
  9898                    WS-PAYMENT-PENDING
  9899     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9900       UNTIL  TRLR-FILE-EOF
  9901         OR PAYMENT-PENDING
  9902
  9903
  9904* EXEC CICS ENDBR
  9905*        DATASET (TRLR-FILE-ID)
  9906*    END-EXEC.
  9907     MOVE 0
  9908       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 177
* EL131.cbl
  9909*    MOVE '&2                    $   #00009381' TO DFHEIV0
  9910     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9911     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9912     MOVE X'2020233030303039333831' TO DFHEIV0(25:11)
  9913     CALL 'kxdfhei1' USING DFHEIV0,
  9914           TRLR-FILE-ID,
  9915           DFHEIV11,
  9916           DFHEIV99
  9917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9918
  9919 1050-EXIT.
  9920     EXIT.
  9921
  9922 1052-READ-TRLR.
  9923
  9924* EXEC CICS READNEXT
  9925*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9926*         DATASET  (TRLR-FILE-ID)
  9927*         RIDFLD   (TRLR-KEY)
  9928*    END-EXEC.
  9929     MOVE 0
  9930       TO DFHEIV11
  9931*    MOVE '&.S                   )   #00009388' TO DFHEIV0
  9932     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9933     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9934     MOVE X'2020233030303039333838' TO DFHEIV0(25:11)
  9935     CALL 'kxdfhei1' USING DFHEIV0,
  9936           TRLR-FILE-ID,
  9937           DFHEIV20,
  9938           DFHEIV99,
  9939           TRLR-KEY,
  9940           DFHEIV99,
  9941           DFHEIV11,
  9942           DFHEIV99,
  9943           DFHEIV99
  9944     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9945         DFHEIV20
  9946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9947
  9948
  9949     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9950       AND PI-CARRIER  = TRLR-CARRIER
  9951       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9952       AND PI-CERT-NO  = TRLR-CERT-NO
  9953        CONTINUE
  9954     ELSE
  9955        GO TO 1052-DONE
  9956     END-IF.
  9957
  9958     IF PAYMENT-TR
  9959       AND BENEFICIARY-PAID
  9960       AND AT-VOID-DT = LOW-VALUES
  9961       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9962         SET PAYMENT-PENDING TO TRUE
  9963     END-IF.
  9964
  9965     IF CORRESPONDENCE-TR
  9966        IF AT-AUTH-RCVD = 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 178
* EL131.cbl
  9967           SET AUTH-RCVD TO TRUE
  9968        ELSE
  9969        IF AT-AUTH-RCVD = 'N'
  9970           SET NO-AUTH-RCVD TO TRUE
  9971        END-IF
  9972        END-IF
  9973     END-IF.
  9974
  9975     GO TO 1052-EXIT.
  9976
  9977 1052-DONE.
  9978     SET TRLR-FILE-EOF TO TRUE.
  9979 1052-EXIT.
  9980     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 179
* EL131.cbl
  9982 1120-EDIT-PROC.
  9983     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9984     MOVE '2'                    TO CNTL-REC-TYPE.
  9985     MOVE PROCI                  TO CNTL-PROC-ID.
  9986     MOVE ZERO                   TO CNTL-SEQ-NO.
  9987
  9988
  9989* EXEC CICS HANDLE CONDITION
  9990*         NOTFND    (1120-CNTL-NOTFND)
  9991*    END-EXEC.
  9992*    MOVE '"$I                   ! '' #00009433' TO DFHEIV0
  9993     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9995     MOVE X'2720233030303039343333' TO DFHEIV0(25:11)
  9996     CALL 'kxdfhei1' USING DFHEIV0
  9997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9998
  9999
 10000
 10001* EXEC CICS READ
 10002*         SET      (ADDRESS OF CONTROL-FILE)
 10003*         DATASET  (CNTL-FILE-ID)
 10004*         RIDFLD   (CNTL-KEY)
 10005*    END-EXEC.
 10006*    MOVE '&"S        E          (   #00009437' TO DFHEIV0
 10007     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10009     MOVE X'2020233030303039343337' TO DFHEIV0(25:11)
 10010     CALL 'kxdfhei1' USING DFHEIV0,
 10011           CNTL-FILE-ID,
 10012           DFHEIV20,
 10013           DFHEIV99,
 10014           CNTL-KEY,
 10015           DFHEIV99,
 10016           DFHEIV99,
 10017           DFHEIV99
 10018     SET ADDRESS OF CONTROL-FILE TO
 10019         DFHEIV20
 10020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10021
 10022
 10023     MOVE AL-UANON               TO PROCA.
 10024     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
 10025     GO TO 1120-EXIT.
 10026
 10027 1120-CNTL-NOTFND.
 10028     MOVE ER-0273                TO EMI-ERROR.
 10029     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10030     MOVE AL-UABON               TO PROCA.
 10031     MOVE -1                     TO PROCL.
 10032     MOVE 'X'                    TO ERROR-SWITCH.
 10033
 10034 1120-EXIT.
 10035     EXIT.
 10036
 10037*************************************************************
 10038*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
 10039*************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 180
* EL131.cbl
 10040
 10041 1150-OUTPUT-ACTIVITY-RECORD.
 10042
 10043
 10044* EXEC CICS GETMAIN
 10045*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 10046*        LENGTH (25)
 10047*        INITIMG (WS-BLANK)
 10048*    END-EXEC.
 10049     MOVE 25
 10050       TO DFHEIV11
 10051*    MOVE ',"IL                  $   #00009463' TO DFHEIV0
 10052     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10053     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10054     MOVE X'2020233030303039343633' TO DFHEIV0(25:11)
 10055     CALL 'kxdfhei1' USING DFHEIV0,
 10056           DFHEIV20,
 10057           DFHEIV11,
 10058           WS-BLANK
 10059     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 10060         DFHEIV20
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063
 10064     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 10065     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 10066     MOVE PI-CARRIER             TO DA-CARRIER.
 10067     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
 10068     MOVE PI-CERT-NO             TO DA-CERT-NO.
 10069     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
 10070     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
 10071
 10072
 10073* EXEC CICS HANDLE CONDITION
 10074*        NOTOPEN (1150-NOTOPEN-ERROR)
 10075*        DUPREC (1150-EXIT)
 10076*    END-EXEC.
 10077*    MOVE '"$J%                  ! ( #00009477' TO DFHEIV0
 10078     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10080     MOVE X'2820233030303039343737' TO DFHEIV0(25:11)
 10081     CALL 'kxdfhei1' USING DFHEIV0
 10082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10083
 10084     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
 10085     MOVE 'DLYACTV'              TO JP-FILE-ID.
 10086     MOVE 'A'                    TO JP-RECORD-TYPE.
 10087     MOVE +48                    TO JOURNAL-LENGTH.
 10088
 10089
 10090* EXEC CICS WRITE
 10091*        DATASET ('DLYACTV')
 10092*        RIDFLD (DA-KEY)
 10093*        FROM (DAILY-ACTIVITY-RECORD)
 10094*        LENGTH (25)
 10095*    END-EXEC.
 10096     MOVE 'DLYACTV' TO DFHEIV1
 10097     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 181
* EL131.cbl
 10098       TO DFHEIV11
 10099*    MOVE '&$ L                  ''   #00009486' TO DFHEIV0
 10100     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10101     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10102     MOVE X'2020233030303039343836' TO DFHEIV0(25:11)
 10103     CALL 'kxdfhei1' USING DFHEIV0,
 10104           DFHEIV1,
 10105           DAILY-ACTIVITY-RECORD,
 10106           DFHEIV11,
 10107           DA-KEY,
 10108           DFHEIV99,
 10109           DFHEIV99
 10110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10111
 10112
 10113     GO TO 1150-EXIT.
 10114
 10115 1150-NOTOPEN-ERROR.
 10116
 10117     MOVE '2955'                 TO EMI-ERROR.
 10118     MOVE -1                     TO MAINTL.
 10119     MOVE AL-UANON               TO MAINTA.
 10120     MOVE 'X'                    TO ERROR-SWITCH.
 10121     PERFORM 9900-ERROR-FORMAT THRU
 10122             9900-EXIT.
 10123
 10124 1150-EXIT.
 10125     EXIT.
 10126
 10127*************************************************************
 10128*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
 10129*************************************************************
 10130
 10131 1240-EDIT-LIFE-CODE.
 10132
 10133     IF INVALID-BENEFIT-CODE
 10134         GO TO 1240-SET-ERROR.
 10135
 10136     MOVE SPACES                 TO BENEFIT-KEY.
 10137     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10138     MOVE '4'                    TO BEN-REC-TYPE.
 10139     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10140     MOVE ZERO                   TO BEN-SEQ-NO.
 10141
 10142
 10143* EXEC CICS READ GTEQ
 10144*         DATASET  (CNTL-FILE-ID)
 10145*         RIDFLD   (BENEFIT-KEY)
 10146*         SET      (ADDRESS OF CONTROL-FILE)
 10147*    END-EXEC.
 10148*    MOVE '&"S        G          (   #00009522' TO DFHEIV0
 10149     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10151     MOVE X'2020233030303039353232' TO DFHEIV0(25:11)
 10152     CALL 'kxdfhei1' USING DFHEIV0,
 10153           CNTL-FILE-ID,
 10154           DFHEIV20,
 10155           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 182
* EL131.cbl
 10156           BENEFIT-KEY,
 10157           DFHEIV99,
 10158           DFHEIV99,
 10159           DFHEIV99
 10160     SET ADDRESS OF CONTROL-FILE TO
 10161         DFHEIV20
 10162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10163
 10164
 10165     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10166        CF-RECORD-TYPE NOT = '4'
 10167         GO TO 1240-SET-ERROR.
 10168
 10169     MOVE ZERO                   TO COUNT-2.
 10170     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10171
 10172     IF SCREEN-ERROR
 10173         GO TO 1240-SET-ERROR.
 10174
 10175 1240-SET-CODE-SWITCHES.
 10176     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10177     MOVE AL-UANON               TO LCVCDA.
 10178     GO TO 1240-EXIT.
 10179
 10180 1240-SET-ERROR.
 10181     MOVE ER-0240                TO EMI-ERROR.
 10182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10183     MOVE 'X'                    TO ERROR-SWITCH.
 10184     MOVE AL-UABON               TO LCVCDA.
 10185     MOVE -1                     TO LCVCDL.
 10186
 10187 1240-EXIT.
 10188     EXIT.
 10189
 10190 1310-EDIT-AH-CODE.
 10191     IF INVALID-BENEFIT-CODE
 10192         GO TO 1310-SET-ERROR.
 10193
 10194     MOVE SPACES                 TO BENEFIT-KEY.
 10195     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10196     MOVE '5'                    TO BEN-REC-TYPE.
 10197     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10198     MOVE ZERO                   TO BEN-SEQ-NO.
 10199
 10200
 10201* EXEC CICS READ GTEQ
 10202*         DATASET  (CNTL-FILE-ID)
 10203*         RIDFLD   (BENEFIT-KEY)
 10204*         SET      (ADDRESS OF CONTROL-FILE)
 10205*    END-EXEC.
 10206*    MOVE '&"S        G          (   #00009563' TO DFHEIV0
 10207     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10208     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10209     MOVE X'2020233030303039353633' TO DFHEIV0(25:11)
 10210     CALL 'kxdfhei1' USING DFHEIV0,
 10211           CNTL-FILE-ID,
 10212           DFHEIV20,
 10213           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 183
* EL131.cbl
 10214           BENEFIT-KEY,
 10215           DFHEIV99,
 10216           DFHEIV99,
 10217           DFHEIV99
 10218     SET ADDRESS OF CONTROL-FILE TO
 10219         DFHEIV20
 10220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10221
 10222
 10223     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10224        CF-RECORD-TYPE NOT = '5'
 10225         GO TO 1310-SET-ERROR.
 10226
 10227     MOVE ZERO                   TO COUNT-2.
 10228     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10229     IF SCREEN-ERROR
 10230         GO TO 1310-SET-ERROR.
 10231
 10232 1310-SET-CODE-SWITCHES.
 10233     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10234     MOVE AL-UANON               TO ACVCDA.
 10235     GO TO 1310-EXIT.
 10236
 10237 1310-SET-ERROR.
 10238     MOVE ER-0250                TO EMI-ERROR.
 10239     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10240     MOVE AL-UABON               TO ACVCDA.
 10241     MOVE 'X'                    TO ERROR-SWITCH.
 10242     MOVE -1                     TO ACVCDL.
 10243
 10244 1310-EXIT.
 10245     EXIT.
 10246
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 184
* EL131.cbl
 10248 1460-EDIT-CERT-NO.
 10249     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10250     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10251
 10252     IF WS-SAVE-CERT-NO = SPACES
 10253         MOVE ER-0203            TO EMI-ERROR
 10254         GO TO 1460-CERT-NO-ERROR.
 10255
 10256     IF WS-CERT-NO-PRIME = SPACES AND
 10257        WS-CERT-NO-SUFX GREATER THAN SPACE
 10258            MOVE ER-0210         TO EMI-ERROR
 10259            GO TO 1460-CERT-NO-ERROR.
 10260
 10261     MOVE 'X'                    TO UPDATE-SWITCH.
 10262     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10263     MOVE AL-UANON               TO CERTA.
 10264
 10265     IF SUFXL IS GREATER THAN 0
 10266         MOVE AL-UANON           TO SUFXA.
 10267
 10268     GO TO 1460-EXIT.
 10269
 10270 1460-CERT-NO-ERROR.
 10271     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10272     MOVE AL-UABON               TO SUFXA.
 10273     MOVE AL-UABON               TO CERTA.
 10274     MOVE -1                     TO CERTL.
 10275     MOVE 'X'                    TO ERROR-SWITCH.
 10276
 10277 1460-EXIT.
 10278     EXIT.
 10279
 10280 1470-EDIT-EFF.
 10281     IF CERTEFFI = SPACES
 10282         GO TO 1470-DATE-ERROR.
 10283
 10284     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10285     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10286     IF DEEDIT-DATE = ZERO
 10287         GO TO 1470-DATE-ERROR.
 10288
 10289     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10290     MOVE '4'                    TO DC-OPTION-CODE.
 10291     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10292     IF NOT DATE-CONVERSION-ERROR
 10293         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10294         MOVE AL-UANON           TO CERTEFFA
 10295         MOVE 'X'                TO UPDATE-SWITCH
 10296         MOVE 'Y'                TO CERT-KEY-SWITCH
 10297         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10298         GO TO 1470-EXIT.
 10299
 10300 1470-DATE-ERROR.
 10301     MOVE ER-0215                TO EMI-ERROR.
 10302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10303     MOVE AL-UABON               TO CERTEFFA.
 10304     MOVE -1                     TO CERTEFFL.
 10305     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 185
* EL131.cbl
 10306
 10307 1470-EXIT.
 10308     EXIT.
 10309
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 186
* EL131.cbl
 10311 1480-EDIT-ACCT.
 10312     IF CERTACTI = SPACES
 10313         MOVE ER-0232            TO EMI-ERROR
 10314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10315         MOVE AL-UABON           TO CERTACTA
 10316         MOVE -1                 TO CERTACTL
 10317         MOVE 'X'                TO ERROR-SWITCH
 10318     ELSE
 10319         MOVE 'X'                TO UPDATE-SWITCH
 10320         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10321
 10322 1480-EXIT.
 10323     EXIT.
 10324
 10325 1490-EDIT-STATE.
 10326     IF CERTSTI = SPACES
 10327         MOVE ER-0233            TO EMI-ERROR
 10328         GO TO 1490-STATE-ERROR.
 10329
 10330     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10331     MOVE '3'                    TO CNTL-REC-TYPE.
 10332     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10333     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10334     MOVE ZERO                   TO CNTL-SEQ-NO.
 10335
 10336
 10337* EXEC CICS HANDLE CONDITION
 10338*         NOTFND (1490-STATE-NOTFND)
 10339*    END-EXEC.
 10340*    MOVE '"$I                   ! ) #00009682' TO DFHEIV0
 10341     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10343     MOVE X'2920233030303039363832' TO DFHEIV0(25:11)
 10344     CALL 'kxdfhei1' USING DFHEIV0
 10345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10346
 10347
 10348
 10349* EXEC CICS READ
 10350*         SET        (ADDRESS OF CONTROL-FILE)
 10351*         DATASET    ('ELCNTL')
 10352*         RIDFLD     (CNTL-KEY)
 10353*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10354*         GENERIC
 10355*    END-EXEC.
 10356     MOVE 'ELCNTL' TO DFHEIV1
 10357*    MOVE '&"S  KG    E          (   #00009686' TO DFHEIV0
 10358     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10360     MOVE X'2020233030303039363836' TO DFHEIV0(25:11)
 10361     CALL 'kxdfhei1' USING DFHEIV0,
 10362           DFHEIV1,
 10363           DFHEIV20,
 10364           DFHEIV99,
 10365           CNTL-KEY,
 10366           CNTL-GENERIC-LENGTH,
 10367           DFHEIV99,
 10368           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 187
* EL131.cbl
 10369     SET ADDRESS OF CONTROL-FILE TO
 10370         DFHEIV20
 10371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10372
 10373
 10374     MOVE AL-UANON               TO CERTSTA.
 10375     MOVE 'X'                    TO UPDATE-SWITCH.
 10376     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10377     GO TO 1490-EXIT.
 10378
 10379 1490-STATE-NOTFND.
 10380     MOVE ER-0149                TO EMI-ERROR.
 10381
 10382 1490-STATE-ERROR.
 10383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10384     MOVE AL-UABON               TO CERTSTA.
 10385     MOVE -1                     TO CERTSTL.
 10386     MOVE 'X'                    TO ERROR-SWITCH.
 10387
 10388 1490-EXIT.
 10389     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 188
* EL131.cbl
 10391 1500-EDIT-CARR.
 10392     IF CERTCARI = SPACES
 10393         GO TO 1500-CARR-NOTFND.
 10394
 10395     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10396     MOVE '6'                    TO CNTL-REC-TYPE.
 10397     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10398     MOVE CERTCARI               TO CNTL-CARRIER.
 10399     MOVE ZERO                   TO CNTL-SEQ-NO.
 10400
 10401
 10402* EXEC CICS HANDLE CONDITION
 10403*         NOTFND   (1500-CARR-NOTFND)
 10404*    END-EXEC.
 10405*    MOVE '"$I                   ! * #00009721' TO DFHEIV0
 10406     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10408     MOVE X'2A20233030303039373231' TO DFHEIV0(25:11)
 10409     CALL 'kxdfhei1' USING DFHEIV0
 10410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10411
 10412
 10413
 10414* EXEC CICS READ
 10415*         SET        (ADDRESS OF CONTROL-FILE)
 10416*         DATASET    ('ELCNTL')
 10417*         RIDFLD     (CNTL-KEY)
 10418*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10419*         GENERIC
 10420*    END-EXEC.
 10421     MOVE 'ELCNTL' TO DFHEIV1
 10422*    MOVE '&"S  KG    E          (   #00009725' TO DFHEIV0
 10423     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10425     MOVE X'2020233030303039373235' TO DFHEIV0(25:11)
 10426     CALL 'kxdfhei1' USING DFHEIV0,
 10427           DFHEIV1,
 10428           DFHEIV20,
 10429           DFHEIV99,
 10430           CNTL-KEY,
 10431           CNTL-GENERIC-LENGTH,
 10432           DFHEIV99,
 10433           DFHEIV99
 10434     SET ADDRESS OF CONTROL-FILE TO
 10435         DFHEIV20
 10436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10437
 10438
 10439     MOVE AL-UANON               TO CERTCARA.
 10440     MOVE 'X'                    TO UPDATE-SWITCH.
 10441     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10442     GO TO 1500-EXIT.
 10443
 10444 1500-CARR-NOTFND.
 10445     MOVE ER-0360                TO EMI-ERROR.
 10446     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10447     MOVE AL-UABON               TO CERTCARA.
 10448     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 189
* EL131.cbl
 10449     MOVE 'X'                    TO ERROR-SWITCH.
 10450
 10451 1500-EXIT.
 10452     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 190
* EL131.cbl
 10454 1510-DEEDIT-DATE.
 10455
 10456* EXEC CICS BIF DEEDIT
 10457*         FIELD    (DEEDIT-DATE-INPUT)
 10458*         LENGTH   (DATE-LENGTH)
 10459*    END-EXEC.
 10460*    MOVE '@"L                   #   #00009749' TO DFHEIV0
 10461     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10462     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10463     MOVE X'2020233030303039373439' TO DFHEIV0(25:11)
 10464     CALL 'kxdfhei1' USING DFHEIV0,
 10465           DEEDIT-DATE-INPUT,
 10466           DATE-LENGTH
 10467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10468
 10469
 10470 1510-EXIT.
 10471     EXIT.
 10472
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 191
* EL131.cbl
 10474 1620-VERIFY-ACCT.
 10475
 10476     move ' '                    to ws-eracct-sw
 10477     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10478     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10479     MOVE PI-GROUPING            TO ACCT-GROUP.
 10480     MOVE PI-STATE               TO ACCT-STATE.
 10481     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10482
 10483     IF CERTEFFI GREATER THAN LOW-VALUES
 10484         MOVE HOLD-EFF           TO ACCT-DATE
 10485     ELSE
 10486         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10487
 10488     IF CERTACTI GREATER THAN LOW-VALUES
 10489         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10490     IF CERTSTI GREATER THAN LOW-VALUES
 10491         MOVE CERTSTI            TO  ACCT-STATE.
 10492     IF CERTCARI GREATER THAN LOW-VALUES
 10493         MOVE CERTCARI           TO  ACCT-CARRIER.
 10494     IF CERTGRPI GREATER THAN LOW-VALUES
 10495         MOVE CERTGRPI           TO ACCT-GROUP.
 10496
 10497     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10498
 10499
 10500* EXEC CICS HANDLE CONDITION
 10501*         NOTFND  (1620-ACCT-NOTFND)
 10502*    END-EXEC.
 10503*    MOVE '"$I                   ! + #00009783' TO DFHEIV0
 10504     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10506     MOVE X'2B20233030303039373833' TO DFHEIV0(25:11)
 10507     CALL 'kxdfhei1' USING DFHEIV0
 10508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10509
 10510
 10511
 10512* EXEC CICS STARTBR
 10513*         DATASET   (ACCT-FILE-ID)
 10514*         RIDFLD    (ACCT-KEY)
 10515*    END-EXEC.
 10516     MOVE 0
 10517       TO DFHEIV11
 10518*    MOVE '&,         G          &   #00009787' TO DFHEIV0
 10519     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10520     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10521     MOVE X'2020233030303039373837' TO DFHEIV0(25:11)
 10522     CALL 'kxdfhei1' USING DFHEIV0,
 10523           ACCT-FILE-ID,
 10524           ACCT-KEY,
 10525           DFHEIV99,
 10526           DFHEIV11,
 10527           DFHEIV99
 10528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10529
 10530
 10531 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 192
* EL131.cbl
 10532
 10533
 10534* EXEC CICS READNEXT
 10535*         DATASET  (ACCT-FILE-ID)
 10536*         RIDFLD   (ACCT-KEY)
 10537*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10538*    END-EXEC.
 10539     MOVE 0
 10540       TO DFHEIV11
 10541*    MOVE '&.S                   )   #00009794' TO DFHEIV0
 10542     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10543     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10544     MOVE X'2020233030303039373934' TO DFHEIV0(25:11)
 10545     CALL 'kxdfhei1' USING DFHEIV0,
 10546           ACCT-FILE-ID,
 10547           DFHEIV20,
 10548           DFHEIV99,
 10549           ACCT-KEY,
 10550           DFHEIV99,
 10551           DFHEIV11,
 10552           DFHEIV99,
 10553           DFHEIV99
 10554     SET ADDRESS OF ACCOUNT-MASTER TO
 10555         DFHEIV20
 10556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10557
 10558
 10559     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10560         GO TO 1620-ACCT-NOTFND.
 10561
 10562     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10563        HOLD-EFF     LESS AM-EXPIRATION-DT
 10564         NEXT SENTENCE
 10565     ELSE
 10566         GO TO 1620-ACCT-LOOP.
 10567
 10568     set acct-found to true
 10569     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10570         GO TO 1620-ACCT-END-BROWSE.
 10571
 10572     IF LOANBALL GREATER THAN +0
 10573         IF AM-MAX-TOT-BEN NUMERIC  AND
 10574            AM-MAX-TOT-BEN GREATER THAN ZERO
 10575             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10576                 MOVE AL-UNBON     TO LOANBALA
 10577                 MOVE -1           TO LOANBALL
 10578                 MOVE 'X'          TO ERROR-SWITCH
 10579                 MOVE ER-7641      TO EMI-ERROR
 10580                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10581
 10582     IF ACVBENEL GREATER THAN +0
 10583         IF AM-MAX-MON-BEN NUMERIC  AND
 10584            AM-MAX-MON-BEN GREATER THAN ZERO
 10585             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10586                 MOVE AL-UNBON     TO ACVBENEA
 10587                 MOVE -1           TO ACVBENEL
 10588                 MOVE 'X'          TO ERROR-SWITCH
 10589                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 193
* EL131.cbl
 10590                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10591
 10592 1620-ACCT-END-BROWSE.
 10593
 10594
 10595* EXEC CICS ENDBR
 10596*         DATASET (ACCT-FILE-ID)
 10597*    END-EXEC.
 10598     MOVE 0
 10599       TO DFHEIV11
 10600*    MOVE '&2                    $   #00009835' TO DFHEIV0
 10601     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10602     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10603     MOVE X'2020233030303039383335' TO DFHEIV0(25:11)
 10604     CALL 'kxdfhei1' USING DFHEIV0,
 10605           ACCT-FILE-ID,
 10606           DFHEIV11,
 10607           DFHEIV99
 10608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10609
 10610
 10611     GO TO 1620-EXIT.
 10612
 10613 1620-ACCT-NOTFND.
 10614
 10615     MOVE -1                     TO MAINTL.
 10616     MOVE 'X'                    TO ERROR-SWITCH.
 10617     MOVE ER-0426                TO EMI-ERROR.
 10618     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10619
 10620 1620-EXIT.
 10621     EXIT.
 10622
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 194
* EL131.cbl
 10624 2000-UPDATE-CLAIM.
 10625
 10626     MOVE SPACES                 TO ERROR-SWITCH.
 10627     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10628     MOVE PI-CARRIER             TO CARRIER-CODE.
 10629     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10630     MOVE PI-CERT-NO             TO CERT-NO.
 10631
 10632     IF DELETE-CLAIM
 10633         GO TO 3000-DELETE-CLAIM.
 10634
 10635     IF  NOT MODIFY-CAP
 10636         MOVE ER-0070            TO EMI-ERROR
 10637         MOVE 'X'                TO ERROR-SWITCH
 10638         MOVE -1                 TO MAINTL
 10639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10640         GO TO 2000-EXIT.
 10641
 10642     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10643     MOVE ZERO                   TO TRLR-SEQ-NO.
 10644
 10645
 10646* EXEC CICS READ UPDATE
 10647*         SET       (ADDRESS OF CLAIM-MASTER)
 10648*         DATASET   (CLMS-FILE-ID)
 10649*         RIDFLD    (MSTR-KEY)
 10650*    END-EXEC.
 10651*    MOVE '&"S        EU         (   #00009873' TO DFHEIV0
 10652     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10653     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10654     MOVE X'2020233030303039383733' TO DFHEIV0(25:11)
 10655     CALL 'kxdfhei1' USING DFHEIV0,
 10656           CLMS-FILE-ID,
 10657           DFHEIV20,
 10658           DFHEIV99,
 10659           MSTR-KEY,
 10660           DFHEIV99,
 10661           DFHEIV99,
 10662           DFHEIV99
 10663     SET ADDRESS OF CLAIM-MASTER TO
 10664         DFHEIV20
 10665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10666
 10667
 10668     if (incl > zeros)
 10669        and (cl-no-of-pmts-made > 0)
 10670        and (hold-incur > low-values)
 10671        and (hold-incur not = cl-incurred-dt)
 10672        if hold-incur > cl-incurred-dt
 10673           move cl-incurred-dt   to dc-bin-date-1
 10674           move hold-incur       to dc-bin-date-2
 10675        else
 10676           move hold-incur       to dc-bin-date-1
 10677           move cl-incurred-dt   to dc-bin-date-2
 10678        end-if
 10679        move '1'                 to dc-option-code
 10680        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10681        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 195
* EL131.cbl
 10682           MOVE ER-1663             TO EMI-ERROR
 10683           PERFORM 9900-ERROR-FORMAT
 10684                                 THRU 9900-EXIT
 10685           MOVE -1                  TO MAINTL
 10686           GO TO 8110-SEND-DATA
 10687        end-if
 10688     end-if
 10689     IF (CL-PRIORITY-CD = '8')
 10690        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10691             AND 'AMWA' AND 'KMSB')
 10692        MOVE ER-8003             TO EMI-ERROR
 10693        PERFORM 9900-ERROR-FORMAT
 10694                                 THRU 9900-EXIT
 10695        MOVE -1                  TO MAINTL
 10696        GO TO 8110-SEND-DATA
 10697     END-IF
 10698
 10699     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10700         MOVE ER-0068            TO EMI-ERROR
 10701         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10702         GO TO 2000-EXIT.
 10703
 10704     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10705         MOVE ER-0068            TO EMI-ERROR
 10706         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10707         GO TO 2000-EXIT.
 10708
 10709     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10710         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10711
 10712     IF CL-PURGED-DT NOT = LOW-VALUES
 10713         MOVE ER-7691            TO EMI-ERROR
 10714         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10715         GO TO 2000-EXIT.
 10716
 10717     IF CERT-KEY-CHANGED
 10718         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10719
 10720     IF SCREEN-ERROR
 10721         MOVE ER-0068            TO EMI-ERROR
 10722         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10723         GO TO 2000-EXIT.
 10724
 10725     IF NINETY-TRLR-UPDATED
 10726         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10727
 10728     IF MSTR-KEY-CHANGED
 10729         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10730        ELSE
 10731         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10732
 10733     IF TRLR-UPDATE-REQUIRED
 10734         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10735
 10736 2000-CHECK-CERT.
 10737     IF NOT CERT-UPDATES
 10738         GO TO 2000-EXIT.
 10739
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 196
* EL131.cbl
 10740     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10741     MOVE PI-CARRIER             TO CERT-CARRIER.
 10742     MOVE PI-GROUPING            TO CERT-GROUP.
 10743     MOVE PI-STATE               TO CERT-STATE.
 10744     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10745     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10746     MOVE PI-CERT-NO             TO CERT-CERT.
 10747
 10748     IF CERT-ALT-KEY-CHANGED
 10749         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10750     ELSE
 10751         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10752
 10753 2000-EXIT.
 10754     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 197
* EL131.cbl
 10756 2010-RELEASE-REC.
 10757
 10758* EXEC CICS UNLOCK
 10759*         DATASET  (CLMS-FILE-ID)
 10760*    END-EXEC
 10761*    MOVE '&*                    #   #00009968' TO DFHEIV0
 10762     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10763     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10764     MOVE X'2020233030303039393638' TO DFHEIV0(25:11)
 10765     CALL 'kxdfhei1' USING DFHEIV0,
 10766           CLMS-FILE-ID,
 10767           DFHEIV99
 10768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10769
 10770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10771     MOVE 'X'                    TO ERROR-SWITCH.
 10772
 10773 2010-EXIT.
 10774     EXIT.
 10775
 10776 2020-NORMAL-UPDATE.
 10777     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10778
 10779     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10780
 10781     IF WS-OPEN-CLOSE-SW = 'Y'
 10782       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10783       IF PI-REC-FOUND-SW = 'Y'
 10784         IF CL-ACTIVITY-CODE = 09
 10785           NEXT SENTENCE
 10786         ELSE
 10787           IF WS-RESET-SW = 'Y'
 10788             IF CL-CLAIM-STATUS = 'C'
 10789               MOVE 07               TO  CL-ACTIVITY-CODE
 10790               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10791               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10792             ELSE
 10793               MOVE 08               TO  CL-ACTIVITY-CODE
 10794               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10795               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10796
 10797     IF PI-COMPANY-ID = 'CID' or 'AHL' OR 'FNL'
 10798         MOVE 'Y'                TO CL-YESNOSW
 10799     END-IF.
 10800
 10801     if pi-company-id = 'DCC' OR 'VPP'
 10802        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10803        perform 2120-check-pdef  thru 2120-exit
 10804     end-if
 10805     if ((benperl <> zeros)
 10806        and (benperi numeric))
 10807                  or
 10808            (instypel <> zeros)
 10809        perform 2140-update-elcrtt thru 2140-exit
 10810     end-if
 10811
 10812* EXEC CICS HANDLE CONDITION
 10813*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 198
* EL131.cbl
 10814*    END-EXEC.
 10815*    MOVE '"$$                   ! , #00010013' TO DFHEIV0
 10816     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10818     MOVE X'2C20233030303130303133' TO DFHEIV0(25:11)
 10819     CALL 'kxdfhei1' USING DFHEIV0
 10820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10821
 10822
 10823
 10824* EXEC CICS REWRITE
 10825*         DATASET   (CLMS-FILE-ID)
 10826*         FROM      (CLAIM-MASTER)
 10827*    END-EXEC.
 10828     MOVE LENGTH OF
 10829      CLAIM-MASTER
 10830       TO DFHEIV11
 10831*    MOVE '&& L                  %   #00010017' TO DFHEIV0
 10832     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10833     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10834     MOVE X'2020233030303130303137' TO DFHEIV0(25:11)
 10835     CALL 'kxdfhei1' USING DFHEIV0,
 10836           CLMS-FILE-ID,
 10837           CLAIM-MASTER,
 10838           DFHEIV11,
 10839           DFHEIV99
 10840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10841
 10842
 10843 2020-EXIT.
 10844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 199
* EL131.cbl
 10846 2030-KEY-UPDATE.
 10847     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10848
 10849
 10850* EXEC CICS DELETE
 10851*        DATASET  (CLMS-FILE-ID)
 10852*    END-EXEC.
 10853*    MOVE '&(                    &   #00010028' TO DFHEIV0
 10854     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10855     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10856     MOVE X'2020233030303130303238' TO DFHEIV0(25:11)
 10857     CALL 'kxdfhei1' USING DFHEIV0,
 10858           CLMS-FILE-ID,
 10859           DFHEIV99,
 10860           DFHEIV99,
 10861           DFHEIV99,
 10862           DFHEIV99
 10863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10864
 10865
 10866
 10867* EXEC CICS GETMAIN
 10868*         SET      (ADDRESS OF CLAIM-MASTER)
 10869*         LENGTH   (MSTR-LENGTH)
 10870*         INITIMG  (GETMAIN-SPACE)
 10871*    END-EXEC.
 10872*    MOVE ',"IL                  $   #00010032' TO DFHEIV0
 10873     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10874     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10875     MOVE X'2020233030303130303332' TO DFHEIV0(25:11)
 10876     CALL 'kxdfhei1' USING DFHEIV0,
 10877           DFHEIV20,
 10878           MSTR-LENGTH,
 10879           GETMAIN-SPACE
 10880     SET ADDRESS OF CLAIM-MASTER TO
 10881         DFHEIV20
 10882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10883
 10884
 10885     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10886
 10887     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10888
 10889     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10890
 10891     IF WS-OPEN-CLOSE-SW = 'Y'
 10892       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10893         IF PI-REC-FOUND-SW = 'Y'
 10894           IF CL-ACTIVITY-CODE = 09
 10895             NEXT SENTENCE
 10896           ELSE
 10897             IF WS-RESET-SW = 'Y'
 10898               IF CL-CLAIM-STATUS = 'C'
 10899                 MOVE 07             TO  CL-ACTIVITY-CODE
 10900                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10901                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10902               ELSE
 10903                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 200
* EL131.cbl
 10904                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10905                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10906
 10907
 10908* EXEC CICS HANDLE CONDITION
 10909*         DUPKEY    (2030-EXIT)
 10910*    END-EXEC.
 10911*    MOVE '"$$                   ! - #00010060' TO DFHEIV0
 10912     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10914     MOVE X'2D20233030303130303630' TO DFHEIV0(25:11)
 10915     CALL 'kxdfhei1' USING DFHEIV0
 10916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10917
 10918
 10919** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10920*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10921
 10922     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'
 10923         MOVE 'Y'                TO CL-YESNOSW
 10924     END-IF.
 10925
 10926
 10927* EXEC CICS WRITE
 10928*         DATASET   (CLMS-FILE-ID)
 10929*         RIDFLD    (MSTR-KEY)
 10930*         FROM      (CLAIM-MASTER)
 10931*    END-EXEC.
 10932     MOVE LENGTH OF
 10933      CLAIM-MASTER
 10934       TO DFHEIV11
 10935*    MOVE '&$ L                  ''   #00010071' TO DFHEIV0
 10936     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10937     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10938     MOVE X'2020233030303130303731' TO DFHEIV0(25:11)
 10939     CALL 'kxdfhei1' USING DFHEIV0,
 10940           CLMS-FILE-ID,
 10941           CLAIM-MASTER,
 10942           DFHEIV11,
 10943           MSTR-KEY,
 10944           DFHEIV99,
 10945           DFHEIV99
 10946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10947
 10948
 10949 2030-EXIT.
 10950     EXIT.
 10951
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 201
* EL131.cbl
 10953 2040-NORMAL-UPDATE.
 10954
 10955* EXEC CICS READ UPDATE
 10956*         DATASET  (CERT-FILE-ID)
 10957*         RIDFLD   (CERT-KEY)
 10958*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10959*    END-EXEC.
 10960*    MOVE '&"S        EU         (   #00010082' TO DFHEIV0
 10961     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10962     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10963     MOVE X'2020233030303130303832' TO DFHEIV0(25:11)
 10964     CALL 'kxdfhei1' USING DFHEIV0,
 10965           CERT-FILE-ID,
 10966           DFHEIV20,
 10967           DFHEIV99,
 10968           CERT-KEY,
 10969           DFHEIV99,
 10970           DFHEIV99,
 10971           DFHEIV99
 10972     SET ADDRESS OF CERTIFICATE-MASTER TO
 10973         DFHEIV20
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
 10977     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10978
 10979
 10980* EXEC CICS HANDLE CONDITION
 10981*         DUPKEY   (2040-EXIT)
 10982*    END-EXEC.
 10983*    MOVE '"$$                   ! . #00010090' TO DFHEIV0
 10984     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10985     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10986     MOVE X'2E20233030303130303930' TO DFHEIV0(25:11)
 10987     CALL 'kxdfhei1' USING DFHEIV0
 10988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10989
 10990
 10991
 10992* EXEC CICS REWRITE
 10993*         DATASET  (CERT-FILE-ID)
 10994*         FROM     (CERTIFICATE-MASTER)
 10995*    END-EXEC.
 10996     MOVE LENGTH OF
 10997      CERTIFICATE-MASTER
 10998       TO DFHEIV11
 10999*    MOVE '&& L                  %   #00010094' TO DFHEIV0
 11000     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11001     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11002     MOVE X'2020233030303130303934' TO DFHEIV0(25:11)
 11003     CALL 'kxdfhei1' USING DFHEIV0,
 11004           CERT-FILE-ID,
 11005           CERTIFICATE-MASTER,
 11006           DFHEIV11,
 11007           DFHEIV99
 11008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11009
 11010
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 202
* EL131.cbl
 11011 2040-EXIT.
 11012     EXIT.
 11013
 11014 2050-KEY-UPDATE.
 11015
 11016* EXEC CICS READ UPDATE
 11017*         DATASET  (CERT-FILE-ID)
 11018*         RIDFLD   (CERT-KEY)
 11019*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11020*    END-EXEC.
 11021*    MOVE '&"S        EU         (   #00010103' TO DFHEIV0
 11022     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11023     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11024     MOVE X'2020233030303130313033' TO DFHEIV0(25:11)
 11025     CALL 'kxdfhei1' USING DFHEIV0,
 11026           CERT-FILE-ID,
 11027           DFHEIV20,
 11028           DFHEIV99,
 11029           CERT-KEY,
 11030           DFHEIV99,
 11031           DFHEIV99,
 11032           DFHEIV99
 11033     SET ADDRESS OF CERTIFICATE-MASTER TO
 11034         DFHEIV20
 11035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11036
 11037
 11038     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 11039
 11040
 11041* EXEC CICS DELETE
 11042*         DATASET   (CERT-FILE-ID)
 11043*    END-EXEC.
 11044*    MOVE '&(                    &   #00010111' TO DFHEIV0
 11045     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11046     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11047     MOVE X'2020233030303130313131' TO DFHEIV0(25:11)
 11048     CALL 'kxdfhei1' USING DFHEIV0,
 11049           CERT-FILE-ID,
 11050           DFHEIV99,
 11051           DFHEIV99,
 11052           DFHEIV99,
 11053           DFHEIV99
 11054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11055
 11056
 11057
 11058* EXEC CICS GETMAIN
 11059*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11060*         LENGTH    (CERT-LENGTH)
 11061*         INITIMG   (GETMAIN-SPACE)
 11062*    END-EXEC.
 11063*    MOVE ',"IL                  $   #00010115' TO DFHEIV0
 11064     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11065     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11066     MOVE X'2020233030303130313135' TO DFHEIV0(25:11)
 11067     CALL 'kxdfhei1' USING DFHEIV0,
 11068           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 203
* EL131.cbl
 11069           CERT-LENGTH,
 11070           GETMAIN-SPACE
 11071     SET ADDRESS OF CERTIFICATE-MASTER TO
 11072         DFHEIV20
 11073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11074
 11075
 11076     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 11077
 11078     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11079
 11080
 11081* EXEC CICS HANDLE CONDITION
 11082*         DUPKEY (2050-EXIT)
 11083*    END-EXEC.
 11084*    MOVE '"$$                   ! / #00010125' TO DFHEIV0
 11085     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11087     MOVE X'2F20233030303130313235' TO DFHEIV0(25:11)
 11088     CALL 'kxdfhei1' USING DFHEIV0
 11089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11090
 11091
 11092
 11093* EXEC CICS WRITE
 11094*         DATASET  (CERT-FILE-ID)
 11095*         RIDFLD   (CERT-KEY)
 11096*         FROM     (CERTIFICATE-MASTER)
 11097*    END-EXEC.
 11098     MOVE LENGTH OF
 11099      CERTIFICATE-MASTER
 11100       TO DFHEIV11
 11101*    MOVE '&$ L                  ''   #00010129' TO DFHEIV0
 11102     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11104     MOVE X'2020233030303130313239' TO DFHEIV0(25:11)
 11105     CALL 'kxdfhei1' USING DFHEIV0,
 11106           CERT-FILE-ID,
 11107           CERTIFICATE-MASTER,
 11108           DFHEIV11,
 11109           CERT-KEY,
 11110           DFHEIV99,
 11111           DFHEIV99
 11112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11113
 11114
 11115 2050-EXIT.
 11116     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 204
* EL131.cbl
 11118 2060-CHANGE-CERT.
 11119     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11120     MOVE PI-CARRIER             TO CERT-CARRIER.
 11121     MOVE PI-GROUPING            TO CERT-GROUP.
 11122     MOVE PI-STATE               TO CERT-STATE.
 11123     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11124     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11125     MOVE PI-CERT-NO             TO CERT-CERT.
 11126     IF CERTEFFI GREATER THAN LOW-VALUES
 11127         MOVE HOLD-EFF           TO CERT-DATE.
 11128     IF CERTACTI GREATER THAN LOW-VALUES
 11129         MOVE CERTACTI           TO CERT-ACCOUNT.
 11130     IF CERTSTI GREATER THAN LOW-VALUES
 11131         MOVE CERTSTI            TO CERT-STATE.
 11132     IF CERTCARI GREATER THAN LOW-VALUES
 11133         MOVE CERTCARI           TO CERT-CARRIER.
 11134     IF CERTGRPI GREATER THAN LOW-VALUES
 11135         MOVE CERTGRPI           TO CERT-GROUP.
 11136     IF CERTI GREATER THAN LOW-VALUES
 11137         MOVE CERTI              TO CERT-CERT-PRIME.
 11138     IF SUFXI GREATER THAN LOW-VALUES
 11139         MOVE SUFXI              TO CERT-CERT-SUFX.
 11140
 11141
 11142* EXEC CICS HANDLE CONDITION
 11143*         NOTFND   (2060-CERT-NOTFND)
 11144*    END-EXEC.
 11145*    MOVE '"$I                   ! 0 #00010161' TO DFHEIV0
 11146     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11148     MOVE X'3020233030303130313631' TO DFHEIV0(25:11)
 11149     CALL 'kxdfhei1' USING DFHEIV0
 11150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11151
 11152
 11153
 11154* EXEC CICS READ UPDATE
 11155*         DATASET  (CERT-FILE-ID)
 11156*         RIDFLD   (CERT-KEY)
 11157*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11158*    END-EXEC.
 11159*    MOVE '&"S        EU         (   #00010165' TO DFHEIV0
 11160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11161     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11162     MOVE X'2020233030303130313635' TO DFHEIV0(25:11)
 11163     CALL 'kxdfhei1' USING DFHEIV0,
 11164           CERT-FILE-ID,
 11165           DFHEIV20,
 11166           DFHEIV99,
 11167           CERT-KEY,
 11168           DFHEIV99,
 11169           DFHEIV99,
 11170           DFHEIV99
 11171     SET ADDRESS OF CERTIFICATE-MASTER TO
 11172         DFHEIV20
 11173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11174
 11175
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 205
* EL131.cbl
 11176     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11177
 11178     IF CM-CLAIM-INTERFACE-SW = SPACES
 11179        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11180
 11181
 11182* EXEC CICS HANDLE CONDITION
 11183*         DUPKEY   (2060-DUPKEY)
 11184*    END-EXEC.
 11185*    MOVE '"$$                   ! 1 #00010176' TO DFHEIV0
 11186     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11188     MOVE X'3120233030303130313736' TO DFHEIV0(25:11)
 11189     CALL 'kxdfhei1' USING DFHEIV0
 11190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11191
 11192
 11193
 11194* EXEC CICS REWRITE
 11195*         DATASET  (CERT-FILE-ID)
 11196*         FROM     (CERTIFICATE-MASTER)
 11197*    END-EXEC.
 11198     MOVE LENGTH OF
 11199      CERTIFICATE-MASTER
 11200       TO DFHEIV11
 11201*    MOVE '&& L                  %   #00010180' TO DFHEIV0
 11202     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11203     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11204     MOVE X'2020233030303130313830' TO DFHEIV0(25:11)
 11205     CALL 'kxdfhei1' USING DFHEIV0,
 11206           CERT-FILE-ID,
 11207           CERTIFICATE-MASTER,
 11208           DFHEIV11,
 11209           DFHEIV99
 11210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11211
 11212
 11213 2060-DUPKEY.
 11214
 11215     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11216
 11217 2060-CHANGE-TRLR-ACTQ.
 11218     IF SCREEN-ERROR
 11219         GO TO 2060-EXIT.
 11220
 11221     IF CERTI    GREATER LOW-VALUES OR
 11222        SUFXI    GREATER LOW-VALUES OR
 11223        CERTCARI GREATER LOW-VALUES
 11224         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11225         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11226
 11227     MOVE SPACES                 TO CERT-KEY-SWITCH
 11228                                    CERT-SWITCH
 11229                                    TRLR-SWITCH
 11230                                    NINETY-TRLR-SWITCH.
 11231     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11232     GO TO 2060-EXIT.
 11233
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 206
* EL131.cbl
 11234 2060-CERT-NOTFND.
 11235     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11236
 11237     IF WS-REC-FOUND-SW = 'N'
 11238         MOVE ER-0206            TO  EMI-ERROR
 11239         MOVE -1                 TO  MAINTL
 11240         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11241
 11242* EXEC CICS UNLOCK
 11243*            DATASET   (CLMS-FILE-ID)
 11244*        END-EXEC
 11245*    MOVE '&*                    #   #00010213' TO DFHEIV0
 11246     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11247     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11248     MOVE X'2020233030303130323133' TO DFHEIV0(25:11)
 11249     CALL 'kxdfhei1' USING DFHEIV0,
 11250           CLMS-FILE-ID,
 11251           DFHEIV99
 11252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11253         GO TO 8110-SEND-DATA.
 11254
 11255     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11256
 11257     GO TO 2060-CHANGE-TRLR-ACTQ.
 11258
 11259 2060-EXIT.
 11260     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 207
* EL131.cbl
 11262 2070-CHECK-OLD.
 11263
 11264
 11265* EXEC CICS HANDLE CONDITION
 11266*        NOTFND   (2070-NOT-FOUND)
 11267*    END-EXEC.
 11268*    MOVE '"$I                   ! 2 #00010227' TO DFHEIV0
 11269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11271     MOVE X'3220233030303130323237' TO DFHEIV0(25:11)
 11272     CALL 'kxdfhei1' USING DFHEIV0
 11273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11274
 11275
 11276     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11277     MOVE PI-CARRIER             TO CERT-CARRIER.
 11278     MOVE PI-GROUPING            TO CERT-GROUP.
 11279     MOVE PI-STATE               TO CERT-STATE.
 11280     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11281     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11282     MOVE PI-CERT-NO             TO CERT-CERT.
 11283
 11284
 11285* EXEC CICS READ UPDATE
 11286*         DATASET  (CERT-FILE-ID)
 11287*         RIDFLD   (CERT-KEY)
 11288*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11289*    END-EXEC.
 11290*    MOVE '&"S        EU         (   #00010239' TO DFHEIV0
 11291     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11292     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11293     MOVE X'2020233030303130323339' TO DFHEIV0(25:11)
 11294     CALL 'kxdfhei1' USING DFHEIV0,
 11295           CERT-FILE-ID,
 11296           DFHEIV20,
 11297           DFHEIV99,
 11298           CERT-KEY,
 11299           DFHEIV99,
 11300           DFHEIV99,
 11301           DFHEIV99
 11302     SET ADDRESS OF CERTIFICATE-MASTER TO
 11303         DFHEIV20
 11304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11305
 11306
 11307     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11308     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11309     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11310
 11311     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11312         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11313
 11314     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11315       AND
 11316        CERT-WAS-CREATED-FOR-CLAIM
 11317         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11318
 11319* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 208
* EL131.cbl
 11320*             DATASET   (CERT-FILE-ID)
 11321*        END-EXEC
 11322*    MOVE '&(                    &   #00010256' TO DFHEIV0
 11323     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11324     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11325     MOVE X'2020233030303130323536' TO DFHEIV0(25:11)
 11326     CALL 'kxdfhei1' USING DFHEIV0,
 11327           CERT-FILE-ID,
 11328           DFHEIV99,
 11329           DFHEIV99,
 11330           DFHEIV99,
 11331           DFHEIV99
 11332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11333         GO TO 2070-EXIT.
 11334
 11335     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11336         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11337
 11338
 11339* EXEC CICS HANDLE CONDITION
 11340*         DUPKEY   (2070-EXIT)
 11341*    END-EXEC.
 11342*    MOVE '"$$                   ! 3 #00010264' TO DFHEIV0
 11343     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11345     MOVE X'3320233030303130323634' TO DFHEIV0(25:11)
 11346     CALL 'kxdfhei1' USING DFHEIV0
 11347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11348
 11349
 11350
 11351* EXEC CICS REWRITE
 11352*         DATASET  (CERT-FILE-ID)
 11353*         FROM     (CERTIFICATE-MASTER)
 11354*    END-EXEC.
 11355     MOVE LENGTH OF
 11356      CERTIFICATE-MASTER
 11357       TO DFHEIV11
 11358*    MOVE '&& L                  %   #00010268' TO DFHEIV0
 11359     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11360     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11361     MOVE X'2020233030303130323638' TO DFHEIV0(25:11)
 11362     CALL 'kxdfhei1' USING DFHEIV0,
 11363           CERT-FILE-ID,
 11364           CERTIFICATE-MASTER,
 11365           DFHEIV11,
 11366           DFHEIV99
 11367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11368
 11369
 11370     GO TO 2070-EXIT.
 11371
 11372 2070-NOT-FOUND.
 11373     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11374
 11375 2070-EXIT.
 11376     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 209
* EL131.cbl
 11378 2080-CREATE-CERT.
 11379
 11380* EXEC CICS GETMAIN
 11381*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11382*         LENGTH    (CERT-LENGTH)
 11383*         INITIMG   (GETMAIN-SPACE)
 11384*    END-EXEC.
 11385*    MOVE ',"IL                  $   #00010282' TO DFHEIV0
 11386     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11387     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11388     MOVE X'2020233030303130323832' TO DFHEIV0(25:11)
 11389     CALL 'kxdfhei1' USING DFHEIV0,
 11390           DFHEIV20,
 11391           CERT-LENGTH,
 11392           GETMAIN-SPACE
 11393     SET ADDRESS OF CERTIFICATE-MASTER TO
 11394         DFHEIV20
 11395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11396
 11397
 11398     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11399
 11400     IF CERTEFFI GREATER THAN LOW-VALUES
 11401         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11402                                    DC-BIN-DATE-1
 11403         MOVE '6'                TO DC-OPTION-CODE
 11404         MOVE +1                 TO DC-ELAPSED-MONTHS
 11405         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11406         IF NO-CONVERSION-ERROR
 11407             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11408
 11409     IF CERTACTI GREATER THAN LOW-VALUES
 11410         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11411     IF CERTSTI GREATER THAN LOW-VALUES
 11412         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11413     IF CERTCARI GREATER THAN LOW-VALUES
 11414         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11415     IF CERTGRPI GREATER THAN LOW-VALUES
 11416         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11417     IF CERTI GREATER THAN LOW-VALUES
 11418         MOVE CERTI              TO CERT-CERT-PRIME
 11419                                    CM-CERT-PRIME
 11420         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11421
 11422     IF SUFXI GREATER THAN LOW-VALUES
 11423         MOVE SUFXI              TO CERT-CERT-SUFX
 11424                                    CM-CERT-SFX
 11425         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11426
 11427     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11428
 11429     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11430
 11431     MOVE SPACES                 TO CM-ENTRY-BATCH
 11432                                    CM-LF-EXIT-BATCH
 11433                                    CM-AH-EXIT-BATCH
 11434                                    CM-CREDIT-INTERFACE-SW-1
 11435                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 210
* EL131.cbl
 11436
 11437     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11438                               '9' OR 'D' OR 'V'
 11439         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11440
 11441     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11442                               '9' OR 'D' OR 'V'
 11443         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11444
 11445     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11446                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11447     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11448
 11449
 11450* EXEC CICS HANDLE CONDITION
 11451*         DUPKEY (2080-EXIT)
 11452*    END-EXEC.
 11453*    MOVE '"$$                   ! 4 #00010339' TO DFHEIV0
 11454     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11456     MOVE X'3420233030303130333339' TO DFHEIV0(25:11)
 11457     CALL 'kxdfhei1' USING DFHEIV0
 11458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11459
 11460
 11461
 11462* EXEC CICS WRITE
 11463*         DATASET  (CERT-FILE-ID)
 11464*         RIDFLD   (CERT-KEY)
 11465*         FROM     (CERTIFICATE-MASTER)
 11466*    END-EXEC.
 11467     MOVE LENGTH OF
 11468      CERTIFICATE-MASTER
 11469       TO DFHEIV11
 11470*    MOVE '&$ L                  ''   #00010343' TO DFHEIV0
 11471     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11472     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11473     MOVE X'2020233030303130333433' TO DFHEIV0(25:11)
 11474     CALL 'kxdfhei1' USING DFHEIV0,
 11475           CERT-FILE-ID,
 11476           CERTIFICATE-MASTER,
 11477           DFHEIV11,
 11478           CERT-KEY,
 11479           DFHEIV99,
 11480           DFHEIV99
 11481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11482
 11483
 11484 2080-EXIT.
 11485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 211
* EL131.cbl
 11487 2100-MOVE-MSTR.
 11488     IF TYPEI GREATER THAN LOW-VALUES
 11489         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11490
 11491     IF STATUSI = LOW-VALUES
 11492         GO TO 2100-NO-STATUS-CHANGE.
 11493
 11494     IF STATUSI = 'OPEN' OR 'O'
 11495         IF CL-CLAIM-STATUS = 'O'
 11496             MOVE SPACES         TO TRLR-SWITCH
 11497                 GO TO 2100-NO-STATUS-CHANGE.
 11498
 11499     IF STATUSI = 'CLOSED' OR 'C'
 11500         IF CL-CLAIM-STATUS = 'C'
 11501             MOVE SPACES         TO TRLR-SWITCH
 11502                 GO TO 2100-NO-STATUS-CHANGE.
 11503
 11504     IF PI-COMPANY-ID = 'DMD'
 11505        IF STATUSI = 'OPEN' OR 'O'
 11506           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11507              MOVE ZERO       TO STATUSL
 11508              MOVE LOW-VALUES TO STATUSI
 11509              GO TO 2100-NO-STATUS-CHANGE.
 11510
 11511     IF PI-COMPANY-ID = 'DMD'
 11512         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11513
 11514     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11515
 11516 2100-NO-STATUS-CHANGE.
 11517
 11518     IF CCNOI GREATER THAN LOW-VALUES
 11519         MOVE CCNOI              TO CL-CCN.
 11520
 11521     IF PROCI GREATER THAN LOW-VALUES
 11522         MOVE PROCI              TO CL-PROCESSOR-ID.
 11523
 11524     if (accswi > low-values)
 11525        and (accswi = 'Y' OR 'N')
 11526        move accswi              to cl-accident-claim-sw
 11527     end-if
 11528     if benperi > low-values
 11529        and benperi numeric
 11530        move benperi             to cl-benefit-period
 11531     end-if
 11532     if instypei > low-values
 11533        move instypei            to cl-insured-type
 11534     end-if
 11535     IF SEXI GREATER THAN LOW-VALUES
 11536         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11537
 11538     IF BIRTHI GREATER THAN LOW-VALUES
 11539         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11540
 11541     IF SOCIALI GREATER THAN LOW-VALUES
 11542       AND
 11543        SOCIALI = SPACES
 11544         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 212
* EL131.cbl
 11545         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11546         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11547     ELSE
 11548         IF SOCIALI GREATER THAN LOW-VALUES
 11549             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11550
 11551     IF OCCI GREATER THAN LOW-VALUES
 11552         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11553
 11554     IF BENEL GREATER THAN ZERO
 11555         MOVE BENEI              TO CL-BENEFICIARY.
 11556
 11557     IF DIAGI GREATER THAN LOW-VALUES
 11558         MOVE DIAGI              TO WS-DIAGNOSIS.
 11559
 11560     IF ICD1I GREATER THAN LOW-VALUES
 11561         MOVE ICD1I              TO WS-ICD-CODE-1
 11562     END-IF.
 11563
 11564     IF ICD2I GREATER THAN LOW-VALUES
 11565         MOVE ICD2I              TO WS-ICD-CODE-2
 11566     END-IF.
 11567
 11568     IF PREMTYPI GREATER THAN LOW-VALUES
 11569         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11570
 11571*    IF CAUSEI GREATER THAN LOW-VALUES
 11572*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11573
 11574*    IF ENDI GREATER THAN LOW-VALUES
 11575*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11576
 11577     IF PDTHRUI GREATER THAN LOW-VALUES
 11578        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11579
 11580     IF PDAMTL GREATER THAN +0
 11581        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11582
 11583     IF NODAYSI GREATER THAN LOW-VALUES
 11584        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11585
 11586     IF NOPMTSI GREATER THAN LOW-VALUES
 11587        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11588
 11589     IF FORMTYPI GREATER THAN LOW-VALUES
 11590        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11591
 11592     IF INCI GREATER THAN LOW-VALUES
 11593        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11594
 11595     IF REPI GREATER THAN LOW-VALUES
 11596        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11597
 11598     IF ADDONDTI GREATER THAN LOW-VALUES
 11599        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11600
 11601     IF PRICDI GREATER THAN LOW-VALUES
 11602         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 213
* EL131.cbl
 11603
 11604     IF CRITPL  > ZEROS
 11605        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11606     END-IF
 11607
 11608     IF EXTENSL  > ZEROS
 11609        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11610     END-IF
 11611*    IF CRITPTL > ZEROS
 11612*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11613*    END-IF
 11614
 11615*    IF RTWMOSL > ZEROS
 11616*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11617*    END-IF
 11618     IF FILETOI GREATER THAN LOW-VALUES
 11619         MOVE FILETOI            TO CL-FILE-LOCATION.
 11620
 11621     IF SUPVI GREATER THAN LOW-VALUES
 11622         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11623
 11624     IF MLNAMEI GREATER THAN LOW-VALUES
 11625         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11626
 11627     IF MFNAMEI GREATER THAN LOW-VALUES
 11628         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11629
 11630     IF MMINITI GREATER THAN LOW-VALUES
 11631         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11632
 11633     IF CERTEFFI GREATER THAN LOW-VALUES
 11634         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11635
 11636     IF CERTACTI GREATER THAN LOW-VALUES
 11637         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11638
 11639     IF CERTSTI GREATER THAN LOW-VALUES
 11640         MOVE CERTSTI            TO CL-CERT-STATE.
 11641
 11642     IF CERTCARI GREATER THAN LOW-VALUES
 11643         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11644                                    CL-CARRIER.
 11645
 11646     IF CERTGRPI GREATER THAN LOW-VALUES
 11647         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11648
 11649     IF CERTI GREATER THAN LOW-VALUES
 11650         MOVE CERTI              TO CERT-NO-PRIME.
 11651
 11652     IF SUFXI GREATER THAN LOW-VALUES
 11653         MOVE SUFXI              TO CERT-NO-SUFX.
 11654
 11655     MOVE CERT-NO                TO CL-CERT-NO
 11656                                    CL-CERT-NO-A4.
 11657
 11658     IF PI-COMPANY-ID = 'FLA'
 11659          NEXT SENTENCE
 11660     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 214
* EL131.cbl
 11661         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11662         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11663         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11664         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11665
 11666     IF TRLR-UPDATE-REQUIRED
 11667        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11668        MOVE ZEROS              TO TRLR-SEQ-NO
 11669
 11670* EXEC CICS READ
 11671*            DATASET   (TRLR-FILE-ID)
 11672*            RIDFLD    (TRLR-KEY)
 11673*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11674*       END-EXEC
 11675*    MOVE '&"S        E          (   #00010534' TO DFHEIV0
 11676     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11677     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11678     MOVE X'2020233030303130353334' TO DFHEIV0(25:11)
 11679     CALL 'kxdfhei1' USING DFHEIV0,
 11680           TRLR-FILE-ID,
 11681           DFHEIV20,
 11682           DFHEIV99,
 11683           TRLR-KEY,
 11684           DFHEIV99,
 11685           DFHEIV99,
 11686           DFHEIV99
 11687     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11688         DFHEIV20
 11689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11690        IF AT-TRAILER-TYPE = '1'
 11691           MOVE +1 TO MISC-SUB
 11692           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11693           MISC-SUB GREATER THAN +6 OR
 11694           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11695           IF MISC-SUB GREATER THAN +1
 11696              SUBTRACT +1 FROM MISC-SUB
 11697              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11698                 GO TO 2100-BYPASS-LAST-UPDATE.
 11699
 11700     IF TRLR-UPDATE-REQUIRED AND
 11701        CLAIM-IS-OPEN
 11702         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11703     ELSE
 11704         IF TRLR-UPDATE-REQUIRED AND
 11705            CLAIM-IS-CLOSED
 11706             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11707             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11708
 11709 2100-BYPASS-LAST-UPDATE.
 11710     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11711     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11712
 11713     GO TO 2100-EXIT.
 11714
 11715 2100-BUMP-OPEN-CLOSE-HIST.
 11716     ADD +1                      TO MISC-SUB.
 11717
 11718 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 215
* EL131.cbl
 11719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 216
* EL131.cbl
 11721 2120-check-pdef.
 11722     move +0                     to s1
 11723     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11724     move spaces                 to ws-dcc-error-line
 11725     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11726     IF ERPDEF-FOUND
 11727        perform 2130-check-trlr  thru 2130-exit
 11728        move +1                  to s1
 11729*       if cl-accident-claim-sw = ' '
 11730*          move er-1655             to ws-error-no (s1)
 11731*          add +1 to s1
 11732*       end-if
 11733        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11734        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11735        if (hold-incur > low-values)
 11736           and (incl > zeros)
 11737           and (hold-incur not = cl-incurred-dt)
 11738           move hold-incur       to dc-bin-date-2
 11739        end-if
 11740        MOVE '1'                 TO DC-OPTION-CODE
 11741        MOVE +0                  TO DC-ELAPSED-MONTHS
 11742                                    DC-ELAPSED-DAYS
 11743        PERFORM 9800-CONVERT-DATE
 11744                                 THRU 9800-EXIT
 11745        IF NO-CONVERSION-ERROR
 11746           MOVE DC-ELAPSED-MONTHS
 11747                                 TO WS-MONTHS-BETWEEN
 11748           IF DC-ELAPSED-DAYS > 1
 11749              ADD 1 TO WS-MONTHS-BETWEEN
 11750           END-IF
 11751        ELSE
 11752           display ' dte conv error ' dc-error-code
 11753           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11754        END-IF
 11755        IF (WS-EXCL-PERIOD = ZEROS)
 11756           OR (WS-MONTHS-BETWEEN = ZEROS)
 11757           CONTINUE
 11758        ELSE
 11759           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11760              MOVE ER-1651       TO ws-error-no (s1)
 11761              add +1             to s1
 11762           END-IF
 11763        END-IF
 11764        IF (WS-COV-ENDS = ZEROS)
 11765           OR (WS-MONTHS-BETWEEN = ZEROS)
 11766           CONTINUE
 11767        ELSE
 11768           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11769              MOVE -1            TO MAINTL
 11770              MOVE ER-1653       TO ws-error-no (s1)
 11771              add +1 to s1
 11772           END-IF
 11773        END-IF
 11774        IF (WS-ACC-PERIOD = ZEROS)
 11775           OR (WS-MONTHS-BETWEEN = ZEROS)
 11776           CONTINUE
 11777        ELSE
 11778           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 217
* EL131.cbl
 11779              and (accswi = spaces or low-values)
 11780*             and (cl-accident-claim-sw = ' ')
 11781              move er-1655       to ws-error-no (s1)
 11782              add +1             to s1
 11783           end-if
 11784           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11785*             if (cl-accident-claim-sw not = 'Y')
 11786              if (accswi not = 'Y')
 11787                 MOVE ER-1652    TO ws-error-no (s1)
 11788              else
 11789                 move er-1662    to ws-error-no (s1)
 11790              end-if
 11791              MOVE -1            TO MAINTL
 11792              add +1             to s1
 11793           END-IF
 11794        END-IF
 11795        if cl-claim-type  = 'I'
 11796           move er-1661          to ws-error-no (s1)
 11797           add +1                to s1
 11798        end-if
 11799        perform 2130-check-trlr  thru 2130-exit
 11800     END-IF
 11801
 11802     .
 11803 2120-exit.
 11804     exit.
 11805
 11806 2130-check-trlr.
 11807
 11808     evaluate true
 11809        when s1 = +0
 11810           move cl-control-primary
 11811                                 to trlr-key
 11812           MOVE +95              TO TRLR-SEQ-NO
 11813
 11814* EXEC CICS READ
 11815*             update
 11816*             DATASET  ('ELTRLR')
 11817*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11818*             RIDFLD   (TRLR-KEY)
 11819*             RESP     (WS-RESPONSE)
 11820*          END-EXEC
 11821     MOVE 'ELTRLR' TO DFHEIV1
 11822*    MOVE '&"S        EU         (  N#00010662' TO DFHEIV0
 11823     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11824     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11825     MOVE X'204E233030303130363632' TO DFHEIV0(25:11)
 11826     CALL 'kxdfhei1' USING DFHEIV0,
 11827           DFHEIV1,
 11828           DFHEIV20,
 11829           DFHEIV99,
 11830           TRLR-KEY,
 11831           DFHEIV99,
 11832           DFHEIV99,
 11833           DFHEIV99
 11834     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11835         DFHEIV20
 11836     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 218
* EL131.cbl
 11837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11838           if ws-resp-normal
 11839              move spaces        to at-info-line-1
 11840           end-if
 11841        when s1 = +1
 11842           if ws-resp-normal
 11843
 11844* exec cics rewrite
 11845*                dataset   ('ELTRLR')
 11846*                from      (activity-trailers)
 11847*             end-exec
 11848     MOVE LENGTH OF
 11849      activity-trailers
 11850       TO DFHEIV11
 11851     MOVE 'ELTRLR' TO DFHEIV1
 11852*    MOVE '&& L                  %   #00010674' TO DFHEIV0
 11853     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11855     MOVE X'2020233030303130363734' TO DFHEIV0(25:11)
 11856     CALL 'kxdfhei1' USING DFHEIV0,
 11857           DFHEIV1,
 11858           activity-trailers,
 11859           DFHEIV11,
 11860           DFHEIV99
 11861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11862           end-if
 11863        when s1 > +1
 11864           if ws-resp-normal
 11865              move ws-dcc-error-line
 11866                                 to at-info-line-1
 11867
 11868* exec cics rewrite
 11869*                dataset   ('ELTRLR')
 11870*                from      (activity-trailers)
 11871*             end-exec
 11872     MOVE LENGTH OF
 11873      activity-trailers
 11874       TO DFHEIV11
 11875     MOVE 'ELTRLR' TO DFHEIV1
 11876*    MOVE '&& L                  %   #00010683' TO DFHEIV0
 11877     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11878     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11879     MOVE X'2020233030303130363833' TO DFHEIV0(25:11)
 11880     CALL 'kxdfhei1' USING DFHEIV0,
 11881           DFHEIV1,
 11882           activity-trailers,
 11883           DFHEIV11,
 11884           DFHEIV99
 11885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11886           else
 11887
 11888* EXEC CICS GETMAIN
 11889*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11890*                LENGTH   (TRLR-LENGTH)
 11891*                INITIMG  (GETMAIN-SPACE)
 11892*             END-EXEC
 11893*    MOVE ',"IL                  $   #00010688' TO DFHEIV0
 11894     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 219
* EL131.cbl
 11895     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11896     MOVE X'2020233030303130363838' TO DFHEIV0(25:11)
 11897     CALL 'kxdfhei1' USING DFHEIV0,
 11898           DFHEIV20,
 11899           TRLR-LENGTH,
 11900           GETMAIN-SPACE
 11901     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11902         DFHEIV20
 11903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11904              move 'AT'          to at-record-id
 11905              move cl-control-primary
 11906                                 to at-control-primary
 11907              move +95           to at-sequence-no
 11908              move '6'           to at-trailer-type
 11909              move ws-dcc-error-line
 11910                                 to at-info-line-1
 11911              move 'E'           to at-info-trailer-type
 11912              move save-bin-date to at-recorded-dt
 11913                                    at-gen-info-last-maint-dt
 11914              move pi-processor-id
 11915                                 to at-recorded-by
 11916                                    at-gen-info-last-updated-by
 11917              move eibtime       to at-last-maint-hhmmss
 11918
 11919* exec cics write
 11920*                dataset   ('ELTRLR')
 11921*                from      (activity-trailers)
 11922*                ridfld    (trlr-key)
 11923*             end-exec
 11924     MOVE LENGTH OF
 11925      activity-trailers
 11926       TO DFHEIV11
 11927     MOVE 'ELTRLR' TO DFHEIV1
 11928*    MOVE '&$ L                  ''   #00010707' TO DFHEIV0
 11929     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11930     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11931     MOVE X'2020233030303130373037' TO DFHEIV0(25:11)
 11932     CALL 'kxdfhei1' USING DFHEIV0,
 11933           DFHEIV1,
 11934           activity-trailers,
 11935           DFHEIV11,
 11936           trlr-key,
 11937           DFHEIV99,
 11938           DFHEIV99
 11939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11940              perform varying s1 from +1 by +1 until
 11941                 ws-error-no (s1) = spaces
 11942                 move ws-error-no (s1)
 11943                                 to emi-error
 11944                 PERFORM 9900-ERROR-FORMAT
 11945                                 THRU 9900-EXIT
 11946              end-perform
 11947           end-if
 11948     end-evaluate
 11949
 11950     .
 11951 2130-exit.
 11952     exit.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 220
* EL131.cbl
 11953 2140-update-elcrtt.
 11954     move ' '                    to crtt-switch
 11955     MOVE CERT-KEY               TO ELCRTT-KEY
 11956     MOVE 'B'                    TO CTRLR-REC-TYPE
 11957
 11958* EXEC CICS READ
 11959*       UPDATE
 11960*       DATASET   ('ELCRTT')
 11961*       RIDFLD    (ELCRTT-KEY)
 11962*       INTO      (CERTIFICATE-TRAILERS)
 11963*       RESP      (WS-RESPONSE)
 11964*    END-EXEC
 11965     MOVE LENGTH OF
 11966      CERTIFICATE-TRAILERS
 11967       TO DFHEIV11
 11968     MOVE 'ELCRTT' TO DFHEIV1
 11969*    MOVE '&"IL       EU         (  N#00010729' TO DFHEIV0
 11970     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11971     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11972     MOVE X'204E233030303130373239' TO DFHEIV0(25:11)
 11973     CALL 'kxdfhei1' USING DFHEIV0,
 11974           DFHEIV1,
 11975           CERTIFICATE-TRAILERS,
 11976           DFHEIV11,
 11977           ELCRTT-KEY,
 11978           DFHEIV99,
 11979           DFHEIV99,
 11980           DFHEIV99
 11981     MOVE EIBRESP  TO WS-RESPONSE
 11982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11983     IF WS-RESP-NORMAL
 11984        perform varying s1 from +1 by +1 until
 11985           (s1 > +24)
 11986           or (cs-claim-no (s1) = cl-claim-no)
 11987        end-perform
 11988        if (s1 < +25)
 11989           if (benperl <> zeros)
 11990              and (cs-benefit-period (s1) not = benperi)
 11991              move benperi       to cs-benefit-period (s1)
 11992              set crtt-update    to true
 11993          end-if
 11994          if (instypel <> zeros)
 11995             and (instypei not = cs-insured-type (s1))
 11996             move instypei      to cs-insured-type (s1)
 11997             set crtt-update    to true
 11998          end-if
 11999          move cs-claim-type (s1) to ws-claim-type
 12000          move cs-benefit-period (s1) to ws-ben-per
 12001        end-if
 12002        if crtt-update
 12003           perform 2150-accum    thru 2150-exit
 12004
 12005* EXEC CICS REWRITE
 12006*             DATASET   ('ELCRTT')
 12007*             FROM      (CERTIFICATE-TRAILERS)
 12008*          END-EXEC
 12009     MOVE LENGTH OF
 12010      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 221
* EL131.cbl
 12011       TO DFHEIV11
 12012     MOVE 'ELCRTT' TO DFHEIV1
 12013*    MOVE '&& L                  %   #00010757' TO DFHEIV0
 12014     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12015     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12016     MOVE X'2020233030303130373537' TO DFHEIV0(25:11)
 12017     CALL 'kxdfhei1' USING DFHEIV0,
 12018           DFHEIV1,
 12019           CERTIFICATE-TRAILERS,
 12020           DFHEIV11,
 12021           DFHEIV99
 12022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12023        else
 12024
 12025* exec cics unlock
 12026*             dataset   ('ELCRTT')
 12027*          end-exec
 12028     MOVE 'ELCRTT' TO DFHEIV1
 12029*    MOVE '&*                    #   #00010762' TO DFHEIV0
 12030     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12032     MOVE X'2020233030303130373632' TO DFHEIV0(25:11)
 12033     CALL 'kxdfhei1' USING DFHEIV0,
 12034           DFHEIV1,
 12035           DFHEIV99
 12036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12037        end-if
 12038     end-if
 12039     .
 12040 2140-exit.
 12041     exit.
 12042 2150-accum.
 12043     if not erpdef-found
 12044        perform 3997-get-erpdef  thru 3997-exit
 12045     end-if
 12046     if (erpdef-found)
 12047        and (ws-max-moben not = zeros)
 12048        and (ws-max-moben < cm-ah-benefit-amt)
 12049        continue
 12050     else
 12051        move cm-ah-benefit-amt   to ws-max-moben
 12052     end-if
 12053     move cm-ah-orig-term        to ws-max-bens
 12054     if cl-critical-period not = zeros and spaces
 12055        move cl-critical-period  to ws-max-bens
 12056     end-if
 12057     move zeros to ws-tot-days-paid ws-tot-amt-paid
 12058     perform varying s2 from +1 by +1 until
 12059        (s2 > +24)
 12060        or (cs-claim-no (s2) = spaces)
 12061        if (cs-benefit-period (s2) = ws-ben-per)
 12062           and (cs-claim-type (s2) = ws-claim-type)
 12063           and (cs-insured-type (s2) = cl-insured-type)
 12064*          compute ws-tot-days-paid =
 12065*             ws-tot-days-paid + cs-days-paid (s2)
 12066           compute ws-tot-amt-paid =
 12067              ws-tot-amt-paid + cs-total-paid (s2)
 12068        end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 222
* EL131.cbl
 12069     end-perform
 12070     if s2 < +25
 12071        compute ws-pd-bens rounded =
 12072           ws-tot-amt-paid / ws-max-moben
 12073        compute cs-remaining-bens (s1) =
 12074           ws-max-bens - ws-pd-bens
 12075        if cs-remaining-bens (s1) < zeros
 12076           move zeros            to cs-remaining-bens (s1)
 12077        end-if
 12078     end-if
 12079     .
 12080 2150-exit.
 12081     exit.
 12082 2200-MOVE-CERT.
 12083     IF CRTLNMEI GREATER THAN LOW-VALUES
 12084         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 12085
 12086     IF CRTFNMEI GREATER THAN LOW-VALUES
 12087         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 12088         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 12089
 12090     IF CRTINITI GREATER THAN LOW-VALUES
 12091         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 12092
 12093     IF CM-INSURED-INITIALS = SPACES
 12094         MOVE '**'               TO CM-INSURED-INITIALS.
 12095
 12096     IF ISSAGEI GREATER THAN LOW-VALUES
 12097         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 12098
 12099     IF JNTFNMEI GREATER THAN LOW-VALUES
 12100         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 12101
 12102     IF JNTLNMEI GREATER THAN LOW-VALUES
 12103         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 12104
 12105     IF JNTINITI GREATER THAN LOW-VALUES
 12106         MOVE JNTINITI           TO CM-JT-INITIAL.
 12107
 12108     IF JNTAGEI GREATER THAN LOW-VALUES
 12109         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 12110
 12111     IF ADDONDTI GREATER THAN LOW-VALUES
 12112        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 12113
 12114     IF LCVCDI GREATER THAN LOW-VALUES
 12115        IF LCVCDI = SPACES OR ZEROS
 12116           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 12117        ELSE
 12118           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 12119
 12120     IF LCVOTRMI GREATER THAN LOW-VALUES
 12121         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 12122
 12123     IF LCVRATEL GREATER THAN +0
 12124         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 12125
 12126     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 223
* EL131.cbl
 12127         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 12128
 12129     IF LCVFORMI GREATER THAN LOW-VALUES
 12130         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 12131
 12132     IF LCVCNDTI = LOW-VALUES
 12133        GO TO 2210-SET-STATUS.
 12134
 12135     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 12136        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 12137        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 12138        GO TO 2210-SET-STATUS.
 12139
 12140     IF CM-LF-CURRENT-STATUS = '7'
 12141        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12142        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12143        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12144                                    CM-LF-DEATH-DT
 12145        GO TO 2210-SET-STATUS.
 12146
 12147     IF CM-LF-CURRENT-STATUS = '8'
 12148        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12149        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12150                                    CM-LF-CANCEL-DT.
 12151
 12152 2210-SET-STATUS.
 12153
 12154     IF CM-LF-CURRENT-STATUS = SPACES
 12155         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12156
 12157     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12158         MOVE '6'                TO DC-OPTION-CODE
 12159         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12160         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12161         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12162         IF NO-CONVERSION-ERROR
 12163             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12164         ELSE
 12165             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12166     ELSE
 12167         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12168
 12169 2215-PROCESS-AH-SIDE.
 12170
 12171     IF ACVCDI GREATER THAN LOW-VALUES
 12172        IF ACVCDI = SPACES OR ZEROS
 12173           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12174        ELSE
 12175           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12176
 12177     IF ACVOTRMI GREATER THAN LOW-VALUES
 12178         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12179
 12180     IF ACVRATEL GREATER THAN +0
 12181         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12182
 12183     IF ACVBENEL GREATER THAN +0
 12184         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 224
* EL131.cbl
 12185                                    PI-PAYMENT-AMT.
 12186
 12187     IF ACVFORMI GREATER THAN LOW-VALUES
 12188         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12189
 12190     IF ACVCNDTI = LOW-VALUES
 12191        GO TO 2220-SET-STATUS.
 12192
 12193     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12194        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12195        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12196        GO TO 2220-SET-STATUS.
 12197
 12198     IF CM-AH-CURRENT-STATUS = '6'
 12199        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12200                                 TO CM-AH-CURRENT-STATUS
 12201        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12202        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12203                                    CM-AH-SETTLEMENT-DT
 12204        GO TO 2220-SET-STATUS.
 12205
 12206     IF CM-AH-CURRENT-STATUS = '8'
 12207        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12208        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12209                                    CM-AH-CANCEL-DT.
 12210
 12211 2220-SET-STATUS.
 12212     IF CM-AH-CURRENT-STATUS = SPACES
 12213         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12214
 12215     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12216         MOVE '6'                TO DC-OPTION-CODE
 12217         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12218         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12219         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12220         IF NO-CONVERSION-ERROR
 12221             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12222         ELSE
 12223             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12224     ELSE
 12225         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12226
 12227 2225-FINISH-CERT.
 12228     IF APRL GREATER THAN +0
 12229         MOVE HOLD-APR           TO CM-LOAN-APR.
 12230
 12231     IF PMTFREQI GREATER THAN LOW-VALUES
 12232         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12233
 12234     IF INDGRPI GREATER THAN LOW-VALUES
 12235         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12236
 12237*    IF LOANNOI GREATER THAN LOW-VALUES
 12238*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12239
 12240     IF LOANBALL GREATER THAN +0
 12241        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12242
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 225
* EL131.cbl
 12243     IF PREMTYPI GREATER THAN LOW-VALUES
 12244         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12245
 12246     IF REINCDI GREATER THAN LOW-VALUES
 12247         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12248                                    WS-REIN-1
 12249                                    WS-REIN-2
 12250                                    WS-REIN-3
 12251         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12252
 12253     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12254
 12255     MOVE ZEROS                  TO CM-LOAN-TERM
 12256                                    CM-LIFE-COMM-PCT
 12257                                    CM-AH-COMM-PCT.
 12258
 12259*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12260*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12261*         PI-NO-PMTS = ZEROS
 12262*          IF LOANBALL GREATER THAN +0          OR
 12263*             ACVBENEL GREATER THAN +0          OR
 12264*             APRL     GREATER THAN +0          OR
 12265*             LCVRATEL GREATER THAN +0          OR
 12266*             ACVRATEL GREATER THAN +0
 12267*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12268
 12269 2200-EXIT.
 12270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 226
* EL131.cbl
 12272 2300-UPDATE-TRLR.
 12273     MOVE ZERO                   TO TRLR-SEQ-NO.
 12274
 12275* EXEC CICS READ UPDATE
 12276*         DATASET  (TRLR-FILE-ID)
 12277*         RIDFLD   (TRLR-KEY)
 12278*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12279*    END-EXEC.
 12280*    MOVE '&"S        EU         (   #00011002' TO DFHEIV0
 12281     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12282     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12283     MOVE X'2020233030303131303032' TO DFHEIV0(25:11)
 12284     CALL 'kxdfhei1' USING DFHEIV0,
 12285           TRLR-FILE-ID,
 12286           DFHEIV20,
 12287           DFHEIV99,
 12288           TRLR-KEY,
 12289           DFHEIV99,
 12290           DFHEIV99,
 12291           DFHEIV99
 12292     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12293         DFHEIV20
 12294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12295
 12296
 12297     MOVE ZERO                   TO COUNT-2.
 12298
 12299     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12300         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12301
 12302     IF NOT UPDATE-MADE
 12303         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12304
 12305
 12306* EXEC CICS REWRITE
 12307*         DATASET  (TRLR-FILE-ID)
 12308*         FROM     (ACTIVITY-TRAILERS)
 12309*    END-EXEC.
 12310     MOVE LENGTH OF
 12311      ACTIVITY-TRAILERS
 12312       TO DFHEIV11
 12313*    MOVE '&& L                  %   #00011016' TO DFHEIV0
 12314     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12315     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12316     MOVE X'2020233030303131303136' TO DFHEIV0(25:11)
 12317     CALL 'kxdfhei1' USING DFHEIV0,
 12318           TRLR-FILE-ID,
 12319           ACTIVITY-TRAILERS,
 12320           DFHEIV11,
 12321           DFHEIV99
 12322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12323
 12324
 12325 2300-EXIT.
 12326     EXIT.
 12327
 12328 2310-INS-STATUS.
 12329     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 227
* EL131.cbl
 12330     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12331         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12332         MOVE 'Y'                TO TRLR-SWITCH.
 12333
 12334 2310-EXIT.
 12335     EXIT.
 12336
 12337 2320-SHIFT-STATUS.
 12338     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12339        MOVE 6                   TO COUNT-2
 12340        GO TO 2320-EXIT.
 12341
 12342     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12343     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12344     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12345     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12346     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12347     MOVE 6       TO COUNT-2.
 12348     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12349
 12350 2320-EXIT.
 12351     EXIT.
 12352
 12353 2330-ADD-UPDATE.
 12354
 12355     IF COUNT-2 GREATER THAN 1
 12356        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12357        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12358           GO TO 2330-EXIT.
 12359
 12360     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12361                                   AT-RESERVES-LAST-MAINT-DT
 12362
 12363     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12364     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12365     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12366     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12367
 12368 2330-EXIT.
 12369     EXIT.
 12370
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 228
* EL131.cbl
 12372 2400-UPDATE-TRLR.
 12373
 12374* EXEC CICS HANDLE CONDITION
 12375*         NOTFND    (2400-TRLR-NOTFND)
 12376*         ENDFILE   (2410-EXIT)
 12377*    END-EXEC.
 12378*    MOVE '"$I''                  ! 5 #00011069' TO DFHEIV0
 12379     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12381     MOVE X'3520233030303131303639' TO DFHEIV0(25:11)
 12382     CALL 'kxdfhei1' USING DFHEIV0
 12383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12384
 12385
 12386
 12387* EXEC CICS STARTBR
 12388*        DATASET (TRLR-FILE-ID)
 12389*        RIDFLD  (TRLR-KEY)
 12390*    END-EXEC.
 12391     MOVE 0
 12392       TO DFHEIV11
 12393*    MOVE '&,         G          &   #00011074' TO DFHEIV0
 12394     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12396     MOVE X'2020233030303131303734' TO DFHEIV0(25:11)
 12397     CALL 'kxdfhei1' USING DFHEIV0,
 12398           TRLR-FILE-ID,
 12399           TRLR-KEY,
 12400           DFHEIV99,
 12401           DFHEIV11,
 12402           DFHEIV99
 12403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12404
 12405
 12406
 12407* EXEC CICS GETMAIN
 12408*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12409*         LENGTH    (TRLR-LENGTH)
 12410*         INITIMG   (GETMAIN-SPACE)
 12411*    END-EXEC.
 12412*    MOVE ',"IL                  $   #00011079' TO DFHEIV0
 12413     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12415     MOVE X'2020233030303131303739' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0,
 12417           DFHEIV20,
 12418           TRLR-LENGTH,
 12419           GETMAIN-SPACE
 12420     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12421         DFHEIV20
 12422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12423
 12424
 12425     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12426
 12427
 12428* EXEC CICS ENDBR
 12429*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 229
* EL131.cbl
 12430*    END-EXEC.
 12431     MOVE 0
 12432       TO DFHEIV11
 12433*    MOVE '&2                    $   #00011087' TO DFHEIV0
 12434     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12435     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12436     MOVE X'2020233030303131303837' TO DFHEIV0(25:11)
 12437     CALL 'kxdfhei1' USING DFHEIV0,
 12438           TRLR-FILE-ID,
 12439           DFHEIV11,
 12440           DFHEIV99
 12441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12442
 12443
 12444     GO TO 2400-EXIT.
 12445
 12446 2400-TRLR-NOTFND.
 12447     MOVE ER-0205                TO EMI-ERROR.
 12448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12449     MOVE 'X'                    TO ERROR-SWITCH.
 12450
 12451 2400-EXIT.
 12452     EXIT.
 12453
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 230
* EL131.cbl
 12455 2410-CHANGE-TRLR.
 12456
 12457* EXEC CICS READNEXT
 12458*        DATASET (TRLR-FILE-ID)
 12459*        RIDFLD  (TRLR-KEY)
 12460*        INTO    (ACTIVITY-TRAILERS)
 12461*    END-EXEC.
 12462     MOVE LENGTH OF
 12463      ACTIVITY-TRAILERS
 12464       TO DFHEIV12
 12465     MOVE 0
 12466       TO DFHEIV11
 12467*    MOVE '&.IL                  )   #00011103' TO DFHEIV0
 12468     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12469     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12470     MOVE X'2020233030303131313033' TO DFHEIV0(25:11)
 12471     CALL 'kxdfhei1' USING DFHEIV0,
 12472           TRLR-FILE-ID,
 12473           ACTIVITY-TRAILERS,
 12474           DFHEIV12,
 12475           TRLR-KEY,
 12476           DFHEIV99,
 12477           DFHEIV11,
 12478           DFHEIV99,
 12479           DFHEIV99
 12480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12481
 12482
 12483     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12484        GO TO 2410-CHANGE-TRLR.
 12485
 12486     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12487                                    CHECK-KEY.
 12488
 12489     IF CHECK-KEY NOT = MSTR-KEY
 12490         GO TO 2410-EXIT.
 12491
 12492
 12493* EXEC CICS ENDBR
 12494*        DATASET (TRLR-FILE-ID)
 12495*    END-EXEC.
 12496     MOVE 0
 12497       TO DFHEIV11
 12498*    MOVE '&2                    $   #00011118' TO DFHEIV0
 12499     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12500     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12501     MOVE X'2020233030303131313138' TO DFHEIV0(25:11)
 12502     CALL 'kxdfhei1' USING DFHEIV0,
 12503           TRLR-FILE-ID,
 12504           DFHEIV11,
 12505           DFHEIV99
 12506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12507
 12508
 12509
 12510* EXEC CICS READ UPDATE
 12511*        DATASET (TRLR-FILE-ID)
 12512*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 231
* EL131.cbl
 12513*        INTO    (ACTIVITY-TRAILERS)
 12514*    END-EXEC.
 12515     MOVE LENGTH OF
 12516      ACTIVITY-TRAILERS
 12517       TO DFHEIV11
 12518*    MOVE '&"IL       EU         (   #00011122' TO DFHEIV0
 12519     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12520     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12521     MOVE X'2020233030303131313232' TO DFHEIV0(25:11)
 12522     CALL 'kxdfhei1' USING DFHEIV0,
 12523           TRLR-FILE-ID,
 12524           ACTIVITY-TRAILERS,
 12525           DFHEIV11,
 12526           TRLR-KEY,
 12527           DFHEIV99,
 12528           DFHEIV99,
 12529           DFHEIV99
 12530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12531
 12532
 12533
 12534* EXEC CICS DELETE
 12535*        DATASET (TRLR-FILE-ID)
 12536*    END-EXEC.
 12537*    MOVE '&(                    &   #00011128' TO DFHEIV0
 12538     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12540     MOVE X'2020233030303131313238' TO DFHEIV0(25:11)
 12541     CALL 'kxdfhei1' USING DFHEIV0,
 12542           TRLR-FILE-ID,
 12543           DFHEIV99,
 12544           DFHEIV99,
 12545           DFHEIV99,
 12546           DFHEIV99
 12547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12548
 12549
 12550     IF AT-SEQUENCE-NO = ZERO AND
 12551        TRLR-UPDATE-REQUIRED
 12552         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12553
 12554     IF CERTI GREATER THAN LOW-VALUES
 12555        MOVE CERTI               TO AT-CERT-PRIME.
 12556
 12557     IF SUFXI GREATER THAN LOW-VALUES
 12558        MOVE SUFXI               TO AT-CERT-SFX.
 12559
 12560     IF CERTCARI GREATER THAN LOW-VALUES
 12561        MOVE CERTCARI            TO AT-CARRIER.
 12562
 12563     IF PAYMENT-TR
 12564        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12565           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12566              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12567
 12568     IF CORRESPONDENCE-TR
 12569        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12570           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 232
* EL131.cbl
 12571
 12572
 12573* EXEC CICS WRITE
 12574*         DATASET  (TRLR-FILE-ID)
 12575*         RIDFLD   (AT-CONTROL-PRIMARY)
 12576*         FROM     (ACTIVITY-TRAILERS)
 12577*    END-EXEC.
 12578     MOVE LENGTH OF
 12579      ACTIVITY-TRAILERS
 12580       TO DFHEIV11
 12581*    MOVE '&$ L                  ''   #00011154' TO DFHEIV0
 12582     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12583     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12584     MOVE X'2020233030303131313534' TO DFHEIV0(25:11)
 12585     CALL 'kxdfhei1' USING DFHEIV0,
 12586           TRLR-FILE-ID,
 12587           ACTIVITY-TRAILERS,
 12588           DFHEIV11,
 12589           AT-CONTROL-PRIMARY,
 12590           DFHEIV99,
 12591           DFHEIV99
 12592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12593
 12594
 12595
 12596* EXEC CICS STARTBR
 12597*         DATASET  (TRLR-FILE-ID)
 12598*         RIDFLD   (TRLR-KEY)
 12599*    END-EXEC.
 12600     MOVE 0
 12601       TO DFHEIV11
 12602*    MOVE '&,         G          &   #00011160' TO DFHEIV0
 12603     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12605     MOVE X'2020233030303131313630' TO DFHEIV0(25:11)
 12606     CALL 'kxdfhei1' USING DFHEIV0,
 12607           TRLR-FILE-ID,
 12608           TRLR-KEY,
 12609           DFHEIV99,
 12610           DFHEIV11,
 12611           DFHEIV99
 12612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12613
 12614
 12615     GO TO 2410-CHANGE-TRLR.
 12616
 12617 2410-EXIT.
 12618     EXIT.
 12619
 12620 2420-UPDATE-TRLR.
 12621     MOVE ZERO TO COUNT-2.
 12622     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12623         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12624
 12625     IF NOT UPDATE-MADE
 12626         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12627
 12628 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 233
* EL131.cbl
 12629     EXIT.
 12630
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 234
* EL131.cbl
 12632 2425-UPDATE-NINETY-TRLR.
 12633
 12634     MOVE +90                    TO TRLR-SEQ-NO.
 12635
 12636
 12637* EXEC CICS HANDLE CONDITION
 12638*         NOTFND    (2425-NINETY-NOTFND)
 12639*         ENDFILE   (2425-NINETY-NOTFND)
 12640*    END-EXEC.
 12641*    MOVE '"$I''                  ! 6 #00011186' TO DFHEIV0
 12642     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12644     MOVE X'3620233030303131313836' TO DFHEIV0(25:11)
 12645     CALL 'kxdfhei1' USING DFHEIV0
 12646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12647
 12648
 12649
 12650* EXEC CICS READ UPDATE
 12651*        DATASET (TRLR-FILE-ID)
 12652*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12653*        RIDFLD  (TRLR-KEY)
 12654*    END-EXEC.
 12655*    MOVE '&"S        EU         (   #00011191' TO DFHEIV0
 12656     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12657     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12658     MOVE X'2020233030303131313931' TO DFHEIV0(25:11)
 12659     CALL 'kxdfhei1' USING DFHEIV0,
 12660           TRLR-FILE-ID,
 12661           DFHEIV20,
 12662           DFHEIV99,
 12663           TRLR-KEY,
 12664           DFHEIV99,
 12665           DFHEIV99,
 12666           DFHEIV99
 12667     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12668         DFHEIV20
 12669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12670
 12671     if (diagi > low-values)
 12672        and (diagi not = at-info-line-1)
 12673        and (cl-total-paid-amt > zeros)
 12674        move cl-cert-eff-dt      to dc-bin-date-1
 12675        move cl-paid-thru-dt     to dc-bin-date-2
 12676        move '1'                 to dc-option-code
 12677        perform 9800-convert-date
 12678                                 thru 9800-exit
 12679        if no-conversion-error
 12680           and dc-elapsed-months < +24
 12681           and (not emi-bypass-forcables)
 12682           move er-1581          to emi-error
 12683           perform 9900-error-format
 12684                                thru 9900-exit
 12685           move -1              to diagl
 12686           go to 8110-send-data
 12687        end-if
 12688     end-if
 12689     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 235
* EL131.cbl
 12690     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12691     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12692
 12693     IF DIAGI GREATER THAN LOW-VALUES
 12694         MOVE DIAGI             TO AT-INFO-LINE-1
 12695     END-IF.
 12696
 12697     IF ICD1I GREATER THAN LOW-VALUES
 12698         MOVE ICD1I             TO AT-ICD-CODE-1
 12699     END-IF.
 12700
 12701     IF ICD2I GREATER THAN LOW-VALUES
 12702         MOVE ICD2I             TO AT-ICD-CODE-2
 12703     END-IF.
 12704
 12705
 12706* EXEC CICS REWRITE
 12707*        DATASET (TRLR-FILE-ID)
 12708*        FROM    (ACTIVITY-TRAILERS)
 12709*    END-EXEC.
 12710     MOVE LENGTH OF
 12711      ACTIVITY-TRAILERS
 12712       TO DFHEIV11
 12713*    MOVE '&& L                  %   #00011230' TO DFHEIV0
 12714     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12715     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12716     MOVE X'2020233030303131323330' TO DFHEIV0(25:11)
 12717     CALL 'kxdfhei1' USING DFHEIV0,
 12718           TRLR-FILE-ID,
 12719           ACTIVITY-TRAILERS,
 12720           DFHEIV11,
 12721           DFHEIV99
 12722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12723
 12724
 12725     IF DIAGI GREATER THAN LOW-VALUES
 12726       AND DIAGI NOT = WS-DIAGNOSIS
 12727         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12728         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12729         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12730
 12731     IF ICD1I GREATER THAN LOW-VALUES
 12732       AND ICD1I NOT = WS-ICD-CODE-1
 12733         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12734         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12735         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12736     END-IF.
 12737
 12738     IF ICD2I GREATER THAN LOW-VALUES
 12739       AND ICD2I NOT = WS-ICD-CODE-2
 12740         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12741         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12742         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12743     END-IF.
 12744
 12745     GO TO 2425-EXIT.
 12746
 12747 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 236
* EL131.cbl
 12748
 12749
 12750* EXEC CICS GETMAIN
 12751*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12752*         LENGTH    (TRLR-LENGTH)
 12753*         INITIMG   (GETMAIN-SPACE)
 12754*    END-EXEC.
 12755*    MOVE ',"IL                  $   #00011259' TO DFHEIV0
 12756     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12757     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12758     MOVE X'2020233030303131323539' TO DFHEIV0(25:11)
 12759     CALL 'kxdfhei1' USING DFHEIV0,
 12760           DFHEIV20,
 12761           TRLR-LENGTH,
 12762           GETMAIN-SPACE
 12763     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12764         DFHEIV20
 12765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12766
 12767
 12768     MOVE +90                  TO TRLR-SEQ-NO.
 12769     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12770
 12771     MOVE 'AT'                 TO AT-RECORD-ID
 12772     MOVE '6'                  TO AT-TRAILER-TYPE
 12773     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12774                                  AT-GEN-INFO-LAST-MAINT-DT
 12775     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12776                                  AT-GEN-INFO-LAST-UPDATED-BY
 12777     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12778     MOVE DIAGI                TO AT-INFO-LINE-1.
 12779     MOVE ICD1I                TO AT-ICD-CODE-1.
 12780     MOVE ICD2I                TO AT-ICD-CODE-2.
 12781
 12782
 12783* EXEC CICS WRITE
 12784*        DATASET (TRLR-FILE-ID)
 12785*        FROM    (ACTIVITY-TRAILERS)
 12786*        RIDFLD  (TRLR-KEY)
 12787*    END-EXEC.
 12788     MOVE LENGTH OF
 12789      ACTIVITY-TRAILERS
 12790       TO DFHEIV11
 12791*    MOVE '&$ L                  ''   #00011279' TO DFHEIV0
 12792     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12794     MOVE X'2020233030303131323739' TO DFHEIV0(25:11)
 12795     CALL 'kxdfhei1' USING DFHEIV0,
 12796           TRLR-FILE-ID,
 12797           ACTIVITY-TRAILERS,
 12798           DFHEIV11,
 12799           TRLR-KEY,
 12800           DFHEIV99,
 12801           DFHEIV99
 12802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12803
 12804
 12805 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 237
* EL131.cbl
 12806     EXIT.
 12807
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 238
* EL131.cbl
 12809 2430-UPDATE-ACTQ.
 12810
 12811* EXEC CICS HANDLE CONDITION
 12812*         NOTFND    (2430-EXIT)
 12813*         ENDFILE   (2440-EXIT)
 12814*    END-EXEC.
 12815*    MOVE '"$I''                  ! 7 #00011290' TO DFHEIV0
 12816     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12818     MOVE X'3720233030303131323930' TO DFHEIV0(25:11)
 12819     CALL 'kxdfhei1' USING DFHEIV0
 12820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12821
 12822
 12823
 12824* EXEC CICS STARTBR
 12825*         DATASET  (ACTQ-FILE-ID)
 12826*         RIDFLD   (ACTQ-KEY)
 12827*    END-EXEC.
 12828     MOVE 0
 12829       TO DFHEIV11
 12830*    MOVE '&,         G          &   #00011295' TO DFHEIV0
 12831     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12832     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12833     MOVE X'2020233030303131323935' TO DFHEIV0(25:11)
 12834     CALL 'kxdfhei1' USING DFHEIV0,
 12835           ACTQ-FILE-ID,
 12836           ACTQ-KEY,
 12837           DFHEIV99,
 12838           DFHEIV11,
 12839           DFHEIV99
 12840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12841
 12842
 12843
 12844* EXEC CICS GETMAIN
 12845*         SET      (ADDRESS OF ACTIVITY-QUE)
 12846*         LENGTH   (ACTQ-LENGTH)
 12847*         INITIMG  (GETMAIN-SPACE)
 12848*    END-EXEC.
 12849*    MOVE ',"IL                  $   #00011300' TO DFHEIV0
 12850     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12851     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12852     MOVE X'2020233030303131333030' TO DFHEIV0(25:11)
 12853     CALL 'kxdfhei1' USING DFHEIV0,
 12854           DFHEIV20,
 12855           ACTQ-LENGTH,
 12856           GETMAIN-SPACE
 12857     SET ADDRESS OF ACTIVITY-QUE TO
 12858         DFHEIV20
 12859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12860
 12861
 12862     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12863
 12864 2430-EXIT.
 12865     EXIT.
 12866
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 239
* EL131.cbl
 12867 2440-CHANGE-ACTQ.
 12868
 12869
 12870* EXEC CICS READNEXT
 12871*         DATASET  (ACTQ-FILE-ID)
 12872*         RIDFLD   (ACTQ-KEY)
 12873*         INTO     (ACTIVITY-QUE)
 12874*    END-EXEC.
 12875     MOVE LENGTH OF
 12876      ACTIVITY-QUE
 12877       TO DFHEIV12
 12878     MOVE 0
 12879       TO DFHEIV11
 12880*    MOVE '&.IL                  )   #00011313' TO DFHEIV0
 12881     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12882     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12883     MOVE X'2020233030303131333133' TO DFHEIV0(25:11)
 12884     CALL 'kxdfhei1' USING DFHEIV0,
 12885           ACTQ-FILE-ID,
 12886           ACTIVITY-QUE,
 12887           DFHEIV12,
 12888           ACTQ-KEY,
 12889           DFHEIV99,
 12890           DFHEIV11,
 12891           DFHEIV99,
 12892           DFHEIV99
 12893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12894
 12895
 12896
 12897* EXEC CICS ENDBR
 12898*         DATASET (ACTQ-FILE-ID)
 12899*    END-EXEC.
 12900     MOVE 0
 12901       TO DFHEIV11
 12902*    MOVE '&2                    $   #00011319' TO DFHEIV0
 12903     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12904     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12905     MOVE X'2020233030303131333139' TO DFHEIV0(25:11)
 12906     CALL 'kxdfhei1' USING DFHEIV0,
 12907           ACTQ-FILE-ID,
 12908           DFHEIV11,
 12909           DFHEIV99
 12910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12911
 12912
 12913     IF ACTQ-KEY NOT = MSTR-KEY
 12914         GO TO 2440-EXIT.
 12915
 12916
 12917* EXEC CICS READ UPDATE
 12918*         DATASET  (ACTQ-FILE-ID)
 12919*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12920*         SET      (ADDRESS OF ACTIVITY-QUE)
 12921*    END-EXEC.
 12922*    MOVE '&"S        EU         (   #00011326' TO DFHEIV0
 12923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 240
* EL131.cbl
 12925     MOVE X'2020233030303131333236' TO DFHEIV0(25:11)
 12926     CALL 'kxdfhei1' USING DFHEIV0,
 12927           ACTQ-FILE-ID,
 12928           DFHEIV20,
 12929           DFHEIV99,
 12930           AQ-CONTROL-PRIMARY,
 12931           DFHEIV99,
 12932           DFHEIV99,
 12933           DFHEIV99
 12934     SET ADDRESS OF ACTIVITY-QUE TO
 12935         DFHEIV20
 12936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12937
 12938
 12939     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12940
 12941
 12942* EXEC CICS DELETE
 12943*         DATASET (ACTQ-FILE-ID)
 12944*    END-EXEC.
 12945*    MOVE '&(                    &   #00011334' TO DFHEIV0
 12946     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12948     MOVE X'2020233030303131333334' TO DFHEIV0(25:11)
 12949     CALL 'kxdfhei1' USING DFHEIV0,
 12950           ACTQ-FILE-ID,
 12951           DFHEIV99,
 12952           DFHEIV99,
 12953           DFHEIV99,
 12954           DFHEIV99
 12955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12956
 12957
 12958     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12959     IF CERTI GREATER THAN LOW-VALUES
 12960        MOVE CERTI               TO AQ-CERT-PRIME.
 12961     IF SUFXI GREATER THAN LOW-VALUES
 12962        MOVE SUFXI               TO AQ-CERT-SFX.
 12963     IF CERTCARI GREATER THAN LOW-VALUES
 12964        MOVE CERTCARI            TO AQ-CARRIER.
 12965
 12966
 12967* EXEC CICS HANDLE CONDITION
 12968*         DUPREC   (2440-EXIT)
 12969*    END-EXEC.
 12970*    MOVE '"$%                   ! 8 #00011346' TO DFHEIV0
 12971     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12973     MOVE X'3820233030303131333436' TO DFHEIV0(25:11)
 12974     CALL 'kxdfhei1' USING DFHEIV0
 12975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12976
 12977
 12978
 12979* EXEC CICS WRITE
 12980*         DATASET  (ACTQ-FILE-ID)
 12981*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12982*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 241
* EL131.cbl
 12983*    END-EXEC.
 12984     MOVE LENGTH OF
 12985      ACTIVITY-QUE
 12986       TO DFHEIV11
 12987*    MOVE '&$ L                  ''   #00011350' TO DFHEIV0
 12988     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12990     MOVE X'2020233030303131333530' TO DFHEIV0(25:11)
 12991     CALL 'kxdfhei1' USING DFHEIV0,
 12992           ACTQ-FILE-ID,
 12993           ACTIVITY-QUE,
 12994           DFHEIV11,
 12995           AQ-CONTROL-PRIMARY,
 12996           DFHEIV99,
 12997           DFHEIV99
 12998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12999
 13000
 13001 2440-EXIT.
 13002     EXIT.
 13003
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 242
* EL131.cbl
 13005 2460-UPDATE-CHECKQ.
 13006
 13007* EXEC CICS HANDLE CONDITION
 13008*         NOTFND   (2460-EXIT)
 13009*    END-EXEC.
 13010*    MOVE '"$I                   ! 9 #00011361' TO DFHEIV0
 13011     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13013     MOVE X'3920233030303131333631' TO DFHEIV0(25:11)
 13014     CALL 'kxdfhei1' USING DFHEIV0
 13015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13016
 13017
 13018     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 13019     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 13020     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 13021
 13022
 13023* EXEC CICS READ UPDATE
 13024*         DATASET   (CHKQ-FILE-ID)
 13025*         RIDFLD    (CHKQ-KEY)
 13026*         SET       (ADDRESS OF CHECK-QUE)
 13027*    END-EXEC.
 13028*    MOVE '&"S        EU         (   #00011369' TO DFHEIV0
 13029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13031     MOVE X'2020233030303131333639' TO DFHEIV0(25:11)
 13032     CALL 'kxdfhei1' USING DFHEIV0,
 13033           CHKQ-FILE-ID,
 13034           DFHEIV20,
 13035           DFHEIV99,
 13036           CHKQ-KEY,
 13037           DFHEIV99,
 13038           DFHEIV99,
 13039           DFHEIV99
 13040     SET ADDRESS OF CHECK-QUE TO
 13041         DFHEIV20
 13042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13043
 13044
 13045     IF CERTI GREATER THAN LOW-VALUES
 13046        MOVE CERTI               TO CQ-CERT-PRIME.
 13047     IF SUFXI GREATER THAN LOW-VALUES
 13048        MOVE SUFXI               TO CQ-CERT-SFX.
 13049     IF CERTCARI GREATER THAN LOW-VALUES
 13050        MOVE CERTCARI            TO CQ-CARRIER.
 13051
 13052
 13053* EXEC CICS REWRITE
 13054*         DATASET  (CHKQ-FILE-ID)
 13055*         FROM     (CHECK-QUE)
 13056*    END-EXEC.
 13057     MOVE LENGTH OF
 13058      CHECK-QUE
 13059       TO DFHEIV11
 13060*    MOVE '&& L                  %   #00011382' TO DFHEIV0
 13061     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13062     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 243
* EL131.cbl
 13063     MOVE X'2020233030303131333832' TO DFHEIV0(25:11)
 13064     CALL 'kxdfhei1' USING DFHEIV0,
 13065           CHKQ-FILE-ID,
 13066           CHECK-QUE,
 13067           DFHEIV11,
 13068           DFHEIV99
 13069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13070
 13071
 13072 2460-EXIT.
 13073     EXIT.
 13074
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 244
* EL131.cbl
 13076 2475-UPDATE-LETTER.
 13077
 13078* EXEC CICS HANDLE CONDITION
 13079*         NOTFND   (2475-EXIT)
 13080*    END-EXEC.
 13081*    MOVE '"$I                   ! : #00011392' TO DFHEIV0
 13082     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13084     MOVE X'3A20233030303131333932' TO DFHEIV0(25:11)
 13085     CALL 'kxdfhei1' USING DFHEIV0
 13086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13087
 13088
 13089     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 13090     MOVE '1'                    TO ARCH-RECORD-TYPE.
 13091     MOVE ZEROS                  TO ARCH-SEQ-NO.
 13092     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 13093
 13094
 13095* EXEC CICS READ UPDATE
 13096*         DATASET   (ARCH-FILE-ID)
 13097*         RIDFLD    (ARCH-KEY)
 13098*         SET       (ADDRESS OF LETTER-ARCHIVE)
 13099*    END-EXEC.
 13100*    MOVE '&"S        EU         (   #00011401' TO DFHEIV0
 13101     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13102     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13103     MOVE X'2020233030303131343031' TO DFHEIV0(25:11)
 13104     CALL 'kxdfhei1' USING DFHEIV0,
 13105           ARCH-FILE-ID,
 13106           DFHEIV20,
 13107           DFHEIV99,
 13108           ARCH-KEY,
 13109           DFHEIV99,
 13110           DFHEIV99,
 13111           DFHEIV99
 13112     SET ADDRESS OF LETTER-ARCHIVE TO
 13113         DFHEIV20
 13114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13115
 13116
 13117* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 13118* TO THIS MASTER-KEY INFORMATION.
 13119
 13120     IF LA-CARRIER  = CARRIER-CODE AND
 13121        LA-CLAIM-NO = CLAIM-NO     AND
 13122        LA-CERT-NO  = CERT-NO
 13123        NEXT SENTENCE
 13124     ELSE
 13125        GO TO 2475-UNLOCK.
 13126
 13127     IF CERTI GREATER THAN LOW-VALUES
 13128        MOVE CERTI               TO LA-CERT-PRIME.
 13129     IF SUFXI GREATER THAN LOW-VALUES
 13130        MOVE SUFXI               TO LA-CERT-SFX.
 13131     IF CERTCARI GREATER THAN LOW-VALUES
 13132        MOVE CERTCARI            TO LA-CARRIER.
 13133
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 245
* EL131.cbl
 13134
 13135* EXEC CICS REWRITE
 13136*         DATASET  (ARCH-FILE-ID)
 13137*         FROM     (LETTER-ARCHIVE)
 13138*    END-EXEC.
 13139     MOVE LENGTH OF
 13140      LETTER-ARCHIVE
 13141       TO DFHEIV11
 13142*    MOVE '&& L                  %   #00011424' TO DFHEIV0
 13143     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13144     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13145     MOVE X'2020233030303131343234' TO DFHEIV0(25:11)
 13146     CALL 'kxdfhei1' USING DFHEIV0,
 13147           ARCH-FILE-ID,
 13148           LETTER-ARCHIVE,
 13149           DFHEIV11,
 13150           DFHEIV99
 13151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13152
 13153
 13154     GO TO 2475-EXIT.
 13155
 13156 2475-UNLOCK.
 13157
 13158* EXEC CICS UNLOCK
 13159*         DATASET  (ARCH-FILE-ID)
 13160*    END-EXEC.
 13161*    MOVE '&*                    #   #00011432' TO DFHEIV0
 13162     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13163     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13164     MOVE X'2020233030303131343332' TO DFHEIV0(25:11)
 13165     CALL 'kxdfhei1' USING DFHEIV0,
 13166           ARCH-FILE-ID,
 13167           DFHEIV99
 13168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13169
 13170
 13171 2475-EXIT.
 13172     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 246
* EL131.cbl
 13174 2600-CREATE-MAINT-NOTE.
 13175     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13176     MOVE '1'                    TO CNTL-REC-TYPE.
 13177     MOVE SPACES                 TO CNTL-PROC-ID.
 13178     MOVE ZERO                   TO CNTL-SEQ-NO.
 13179
 13180
 13181* EXEC CICS READ
 13182*         SET        (ADDRESS OF CONTROL-FILE)
 13183*         DATASET    ('ELCNTL')
 13184*         RIDFLD     (CNTL-KEY)
 13185*    END-EXEC.
 13186     MOVE 'ELCNTL' TO DFHEIV1
 13187*    MOVE '&"S        E          (   #00011445' TO DFHEIV0
 13188     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13190     MOVE X'2020233030303131343435' TO DFHEIV0(25:11)
 13191     CALL 'kxdfhei1' USING DFHEIV0,
 13192           DFHEIV1,
 13193           DFHEIV20,
 13194           DFHEIV99,
 13195           CNTL-KEY,
 13196           DFHEIV99,
 13197           DFHEIV99,
 13198           DFHEIV99
 13199     SET ADDRESS OF CONTROL-FILE TO
 13200         DFHEIV20
 13201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13202
 13203
 13204     IF CO-NO-USE-AUDIT-CHANGES
 13205         GO TO 2600-EXIT.
 13206
 13207     IF PROCL GREATER ZERO
 13208     IF PROCI NOT = LOW-VALUES
 13209     IF PROCI NOT = CL-PROCESSOR-ID
 13210         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13211         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13212         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13213
 13214     IF SEXL GREATER ZERO
 13215     IF SEXI NOT = LOW-VALUES
 13216     IF SEXI NOT = CL-INSURED-SEX-CD
 13217         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13218         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13219         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13220
 13221     IF BIRTHL GREATER ZERO
 13222     IF HOLD-BIRTH NOT = LOW-VALUES
 13223     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13224         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13225         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13226         MOVE SPACES               TO DC-OPTION-CODE
 13227         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13228         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13229         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13230
 13231     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 247
* EL131.cbl
 13232     IF SOCIALI NOT = LOW-VALUES
 13233     IF SOCIALI NOT = CL-SOC-SEC-NO
 13234         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13235         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13236         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13237
 13238     IF OCCL GREATER ZERO
 13239     IF OCCI NOT = LOW-VALUES
 13240     IF OCCI NOT = CL-INSURED-OCC-CD
 13241         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13242         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13243         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13244
 13245     IF BENEL GREATER ZERO
 13246     IF BENEI NOT = LOW-VALUES
 13247     IF BENEI NOT = CL-BENEFICIARY
 13248         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13249         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13250         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13251
 13252     IF PREMTYPL GREATER ZERO
 13253     IF PREMTYPI NOT = LOW-VALUES
 13254     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13255         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13256         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13257         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13258
 13259*    IF CAUSEL GREATER ZERO
 13260*    IF CAUSEI NOT = LOW-VALUES
 13261*    IF CAUSEI NOT = CL-CAUSE-CD
 13262*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13263*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13264*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13265
 13266*    IF ENDL GREATER ZERO
 13267*    IF HOLD-END NOT = LOW-VALUES
 13268*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13269*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13270*        MOVE CL-EST-END-OF-DISAB-DT
 13271*                                  TO DC-BIN-DATE-1
 13272*        MOVE SPACES               TO DC-OPTION-CODE
 13273*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13274*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13275*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13276
 13277     IF PDTHRUL GREATER ZERO
 13278     IF HOLD-PDTHRU NOT = LOW-VALUES
 13279     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13280         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13281         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13282         MOVE SPACES               TO DC-OPTION-CODE
 13283         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13284         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13285         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13286
 13287     IF PDAMTL GREATER ZERO
 13288     IF HOLD-PDAMT NOT = ZEROS
 13289     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 248
* EL131.cbl
 13290         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13291         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13292         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13293         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13294
 13295     IF NODAYSL GREATER ZERO
 13296     IF HOLD-NODAYS NOT = ZEROS
 13297     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13298         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13299         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13300         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13301         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13302
 13303     IF NOPMTSL GREATER ZERO
 13304     IF HOLD-NOPMTS NOT = ZEROS
 13305     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13306         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13307         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13308         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13309         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13310
 13311     IF FORMTYPL GREATER ZERO
 13312     IF FORMTYPI NOT = LOW-VALUES
 13313     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13314         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13315         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13316         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13317
 13318     IF REPL GREATER ZERO
 13319     IF HOLD-REPORTED NOT = LOW-VALUES
 13320     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13321         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13322         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13323         MOVE SPACES               TO DC-OPTION-CODE
 13324         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13325         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13326         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13327
 13328     IF ADDONDTL GREATER ZERO
 13329     IF HOLD-ADDON NOT = LOW-VALUES
 13330     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13331         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13332         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13333         MOVE SPACES               TO DC-OPTION-CODE
 13334         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13335         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13336         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13337
 13338     IF PRICDL GREATER ZERO
 13339     IF PRICDI NOT = LOW-VALUES
 13340     IF PRICDI NOT = CL-PRIORITY-CD
 13341         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13342         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13343         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13344
 13345     IF FILETOL GREATER ZERO
 13346     IF FILETOI NOT = LOW-VALUES
 13347     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 249
* EL131.cbl
 13348         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13349         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13350         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13351
 13352     IF SUPVL GREATER ZERO
 13353     IF SUPVI NOT = LOW-VALUES
 13354     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13355         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13356         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13357         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13358*    IF (CRITPTL > ZERO)
 13359*       AND (CRITPTI NOT = LOW-VALUES)
 13360*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13361*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13362*       MOVE CL-CRIT-PER-RECURRENT
 13363*                                TO SPLIT-INFO-OLD
 13364*       PERFORM 2650-WRITE-MAINT-NOTE
 13365*                                THRU 2650-EXIT
 13366*    END-IF
 13367
 13368*    IF (RTWMOSL > ZERO)
 13369*       AND (RTWMOSI NOT = LOW-VALUES)
 13370*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13371*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13372*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13373*       PERFORM 2650-WRITE-MAINT-NOTE
 13374*                                THRU 2650-EXIT
 13375*    END-IF
 13376     IF MLNAMEL GREATER ZERO
 13377     IF MLNAMEI NOT = LOW-VALUES
 13378     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13379         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13380         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13381         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13382
 13383     IF MFNAMEL GREATER ZERO
 13384     IF MFNAMEI NOT = LOW-VALUES
 13385     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13386         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13387         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13388         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13389
 13390     IF MMINITL GREATER ZERO
 13391     IF MMINITI NOT = LOW-VALUES
 13392     IF MMINITI NOT = CL-INSURED-MID-INIT
 13393         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13394         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13395         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13396
 13397     IF CERTEFFL GREATER ZERO
 13398     IF HOLD-EFF NOT = LOW-VALUES
 13399     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13400         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13401         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13402         MOVE SPACES               TO DC-OPTION-CODE
 13403         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13404         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13405         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 250
* EL131.cbl
 13406
 13407     IF CERTACTL GREATER ZERO
 13408     IF CERTACTI NOT = LOW-VALUES
 13409     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13410         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13411         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13412         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13413
 13414     IF CERTSTL GREATER ZERO
 13415     IF CERTSTI NOT = LOW-VALUES
 13416     IF CERTSTI NOT = CL-CERT-STATE
 13417         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13418         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13419         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13420
 13421     IF CERTCARL GREATER ZERO
 13422     IF CERTCARI NOT = LOW-VALUES
 13423     IF CERTCARI NOT = CL-CERT-CARRIER
 13424         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13425         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13426         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13427
 13428     IF CERTGRPL GREATER ZERO
 13429     IF CERTGRPI NOT = LOW-VALUES
 13430     IF CERTGRPI NOT = CL-CERT-GROUPING
 13431         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13432         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13433         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13434
 13435     IF CERTL GREATER ZERO OR
 13436        SUFXL GREATER ZERO
 13437     IF (CERTI NOT = LOW-VALUES AND
 13438                     CL-CERT-PRIME)
 13439                OR
 13440        (SUFXI NOT = LOW-VALUES AND
 13441                     CL-CERT-SFX)
 13442         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13443         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13444         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13445     IF incl > zeros
 13446        IF (HOLD-INCUR NOT = LOW-VALUES)
 13447           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13448           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13449           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13450           MOVE SPACES           TO DC-OPTION-CODE
 13451           PERFORM 9800-CONVERT-DATE
 13452                                 THRU 9800-EXIT
 13453           MOVE DC-GREG-DATE-1-EDIT
 13454                                 TO SPLIT-INFO-OLD
 13455           PERFORM 2650-WRITE-MAINT-NOTE
 13456                                 THRU 2650-EXIT
 13457        END-IF
 13458     END-IF
 13459     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13460       IF (REPL GREATER ZERO
 13461         AND HOLD-REPORTED NOT = LOW-VALUES
 13462         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13463        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 251
* EL131.cbl
 13464          AND (HOLD-INCUR NOT = LOW-VALUES)
 13465             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13466          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13467       END-IF
 13468     END-IF
 13469*052918IF incl > zeros
 13470*052918  AND PI-COMPANY-ID = 'CID'
 13471*052918   IF (HOLD-INCUR NOT = LOW-VALUES)
 13472*052918      AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13473*052918      IF TYPEI = PI-AH-OVERRIDE-L1
 13474*052918         SET ELAPSED-BETWEEN-BIN TO TRUE
 13475*052918         MOVE ZERO               TO DC-ELAPSED-MONTHS
 13476*052918                                    DC-ELAPSED-DAYS
 13477*052918
 13478*052918         MOVE HOLD-INCUR  TO DC-BIN-DATE-1
 13479*052918         MOVE SAVE-BIN-DATE TO DC-BIN-DATE-2
 13480*052918         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13481*052918         IF DC-ODD-DAYS-OVER > ZERO
 13482*052918            ADD 1 TO DC-ELAPSED-MONTHS
 13483*052918         END-IF
 13484*052918
 13485*052918         IF PI-STATE = 'HI'
 13486*052918           AND DC-ELAPSED-MONTHS <= 18
 13487*052918            CONTINUE
 13488*052918         ELSE
 13489*052918            IF DC-ELAPSED-MONTHS > 15
 13490*052918               MOVE ER-7572            TO EMI-ERROR
 13491*052918               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13492*052918            END-IF
 13493*052918         END-IF
 13494*052918         PERFORM 2620-CHECK-TRLR THRU 2620-EXIT
 13495*052918      END-IF
 13496*052918   END-IF
 13497*052918END-IF
 13498     .
 13499 2600-EXIT.
 13500      EXIT.
 13501 2610-CHECK-2-YEAR-CONTESTABLE.
 13502     SET ELAPSED-BETWEEN-BIN TO TRUE
 13503     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13504                                DC-ELAPSED-DAYS
 13505
 13506     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13507     IF HOLD-INCUR > SPACES
 13508        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13509     ELSE
 13510        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13511     END-IF
 13512     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13513     IF DC-ODD-DAYS-OVER > ZERO
 13514        ADD 1 TO DC-ELAPSED-MONTHS
 13515     END-IF
 13516
 13517     IF DC-ELAPSED-MONTHS <= 24
 13518        IF HOLD-REPORTED > SPACES
 13519           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13520        ELSE
 13521           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 252
* EL131.cbl
 13522        END-IF
 13523        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13524                               DC-ELAPSED-DAYS
 13525        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13526        IF DC-ODD-DAYS-OVER > ZERO
 13527           ADD 1 TO DC-ELAPSED-MONTHS
 13528        END-IF
 13529        IF DC-ELAPSED-MONTHS > 24
 13530           MOVE ER-1679            TO EMI-ERROR
 13531           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13532        ELSE
 13533           MOVE 1                  TO EMI-ERROR
 13534        END-IF
 13535     END-IF.
 13536
 13537     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13538
 13539 2610-EXIT.
 13540     EXIT.
 13541 2615-CHECK-TRLR.
 13542
 13543     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13544     MOVE +96              TO TRLR-SEQ-NO
 13545
 13546* EXEC CICS READ
 13547*       UPDATE
 13548*       DATASET  ('ELTRLR')
 13549*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13550*       RIDFLD   (TRLR-KEY)
 13551*       RESP     (WS-RESPONSE)
 13552*    END-EXEC
 13553     MOVE 'ELTRLR' TO DFHEIV1
 13554*    MOVE '&"S        EU         (  N#00011792' TO DFHEIV0
 13555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13556     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13557     MOVE X'204E233030303131373932' TO DFHEIV0(25:11)
 13558     CALL 'kxdfhei1' USING DFHEIV0,
 13559           DFHEIV1,
 13560           DFHEIV20,
 13561           DFHEIV99,
 13562           TRLR-KEY,
 13563           DFHEIV99,
 13564           DFHEIV99,
 13565           DFHEIV99
 13566     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13567         DFHEIV20
 13568     MOVE EIBRESP  TO WS-RESPONSE
 13569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13570     IF WS-RESP-NORMAL
 13571        IF EMI-ERROR =  ER-1679
 13572           IF EMI-ERROR-NUMBER(1) = ER-1679
 13573              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13574           ELSE
 13575           IF EMI-ERROR-NUMBER(2) = ER-1679
 13576              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13577           ELSE
 13578           IF EMI-ERROR-NUMBER(3) = ER-1679
 13579              MOVE EMI-LINE3 TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 253
* EL131.cbl
 13580           END-IF
 13581           END-IF
 13582           END-IF
 13583
 13584* EXEC CICS REWRITE
 13585*             DATASET   ('ELTRLR')
 13586*             FROM      (ACTIVITY-TRAILERS)
 13587*          END-EXEC
 13588     MOVE LENGTH OF
 13589      ACTIVITY-TRAILERS
 13590       TO DFHEIV11
 13591     MOVE 'ELTRLR' TO DFHEIV1
 13592*    MOVE '&& L                  %   #00011812' TO DFHEIV0
 13593     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13594     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13595     MOVE X'2020233030303131383132' TO DFHEIV0(25:11)
 13596     CALL 'kxdfhei1' USING DFHEIV0,
 13597           DFHEIV1,
 13598           ACTIVITY-TRAILERS,
 13599           DFHEIV11,
 13600           DFHEIV99
 13601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13602        ELSE
 13603           IF EMI-ERROR = 1
 13604              MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13605              MOVE ZERO TO EMI-ERROR
 13606
 13607* EXEC CICS REWRITE
 13608*                DATASET   ('ELTRLR')
 13609*                FROM      (ACTIVITY-TRAILERS)
 13610*             END-EXEC
 13611     MOVE LENGTH OF
 13612      ACTIVITY-TRAILERS
 13613       TO DFHEIV11
 13614     MOVE 'ELTRLR' TO DFHEIV1
 13615*    MOVE '&& L                  %   #00011820' TO DFHEIV0
 13616     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13617     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13618     MOVE X'2020233030303131383230' TO DFHEIV0(25:11)
 13619     CALL 'kxdfhei1' USING DFHEIV0,
 13620           DFHEIV1,
 13621           ACTIVITY-TRAILERS,
 13622           DFHEIV11,
 13623           DFHEIV99
 13624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13625           ELSE
 13626
 13627* EXEC CICS DELETE
 13628*                DATASET   ('ELTRLR')
 13629*             END-EXEC
 13630     MOVE 'ELTRLR' TO DFHEIV1
 13631*    MOVE '&(                    &   #00011825' TO DFHEIV0
 13632     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13633     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13634     MOVE X'2020233030303131383235' TO DFHEIV0(25:11)
 13635     CALL 'kxdfhei1' USING DFHEIV0,
 13636           DFHEIV1,
 13637           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 254
* EL131.cbl
 13638           DFHEIV99,
 13639           DFHEIV99,
 13640           DFHEIV99
 13641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13642           END-IF
 13643        END-IF
 13644     ELSE
 13645     IF EMI-ERROR =  ER-1679
 13646
 13647* EXEC CICS GETMAIN
 13648*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13649*          LENGTH   (TRLR-LENGTH)
 13650*          INITIMG  (GETMAIN-SPACE)
 13651*       END-EXEC
 13652*    MOVE ',"IL                  $   #00011832' TO DFHEIV0
 13653     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13654     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13655     MOVE X'2020233030303131383332' TO DFHEIV0(25:11)
 13656     CALL 'kxdfhei1' USING DFHEIV0,
 13657           DFHEIV20,
 13658           TRLR-LENGTH,
 13659           GETMAIN-SPACE
 13660     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13661         DFHEIV20
 13662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13663        MOVE 'AT'          TO AT-RECORD-ID
 13664        MOVE CL-CONTROL-PRIMARY
 13665                           TO AT-CONTROL-PRIMARY
 13666        MOVE +96           TO AT-SEQUENCE-NO
 13667        MOVE '6'           TO AT-TRAILER-TYPE
 13668        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13669        INITIALIZE AT-GENERAL-INFO-TR
 13670        IF EMI-ERROR-NUMBER(1) = ER-1679
 13671           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13672        ELSE
 13673        IF EMI-ERROR-NUMBER(2) = ER-1679
 13674           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13675        ELSE
 13676        IF EMI-ERROR-NUMBER(3) = ER-1679
 13677           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13678        END-IF
 13679        END-IF
 13680        END-IF
 13681        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13682        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13683                              AT-GEN-INFO-LAST-MAINT-DT
 13684        MOVE PI-PROCESSOR-ID
 13685                           TO AT-RECORDED-BY
 13686                              AT-GEN-INFO-LAST-UPDATED-BY
 13687        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13688
 13689* EXEC CICS WRITE
 13690*          DATASET   ('ELTRLR')
 13691*          FROM      (ACTIVITY-TRAILERS)
 13692*          RIDFLD    (TRLR-KEY)
 13693*       END-EXEC
 13694     MOVE LENGTH OF
 13695      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 255
* EL131.cbl
 13696       TO DFHEIV11
 13697     MOVE 'ELTRLR' TO DFHEIV1
 13698*    MOVE '&$ L                  ''   #00011862' TO DFHEIV0
 13699     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13700     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13701     MOVE X'2020233030303131383632' TO DFHEIV0(25:11)
 13702     CALL 'kxdfhei1' USING DFHEIV0,
 13703           DFHEIV1,
 13704           ACTIVITY-TRAILERS,
 13705           DFHEIV11,
 13706           TRLR-KEY,
 13707           DFHEIV99,
 13708           DFHEIV99
 13709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13710     END-IF
 13711     END-IF
 13712     .
 13713 2615-EXIT.
 13714     EXIT.
 13715
 13716*0529182620-CHECK-TRLR.
 13717*052918
 13718*052918MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13719*052918MOVE +97                  TO TRLR-SEQ-NO
 13720*052918EXEC CICS READ
 13721*052918   UPDATE
 13722*052918   DATASET  ('ELTRLR')
 13723*052918   SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13724*052918   RIDFLD   (TRLR-KEY)
 13725*052918   RESP     (WS-RESPONSE)
 13726*052918END-EXEC
 13727*052918IF WS-RESP-NORMAL
 13728*052918   IF EMI-ERROR =  ER-7572
 13729*052918      MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13730*052918      EXEC CICS REWRITE
 13731*052918         DATASET   ('ELTRLR')
 13732*052918         FROM      (ACTIVITY-TRAILERS)
 13733*052918      END-EXEC
 13734*052918   ELSE
 13735*052918      MOVE WS-FILE-LIM-NOTE TO AT-INFO-LINE-1
 13736*052918         EXEC CICS REWRITE
 13737*052918            DATASET   ('ELTRLR')
 13738*052918            FROM      (ACTIVITY-TRAILERS)
 13739*052918         END-EXEC
 13740*052918   END-IF
 13741*052918ELSE
 13742*052918   IF EMI-ERROR =  ER-7572
 13743*052918      EXEC CICS GETMAIN
 13744*052918         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13745*052918         LENGTH   (TRLR-LENGTH)
 13746*052918         INITIMG  (GETMAIN-SPACE)
 13747*052918      END-EXEC
 13748*052918      MOVE 'AT'          TO AT-RECORD-ID
 13749*052918      MOVE CL-CONTROL-PRIMARY
 13750*052918                         TO AT-CONTROL-PRIMARY
 13751*052918      MOVE +97           TO AT-SEQUENCE-NO
 13752*052918      MOVE '6'           TO AT-TRAILER-TYPE
 13753*052918      MOVE SPACES             TO AT-GENERAL-INFO-TR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 256
* EL131.cbl
 13754*052918      INITIALIZE AT-GENERAL-INFO-TR
 13755*052918      MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13756*052918      MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13757*052918      MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13758*052918                            AT-GEN-INFO-LAST-MAINT-DT
 13759*052918      MOVE PI-PROCESSOR-ID
 13760*052918                         TO AT-RECORDED-BY
 13761*052918                            AT-GEN-INFO-LAST-UPDATED-BY
 13762*052918      MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13763*052918      EXEC CICS WRITE
 13764*052918         DATASET   ('ELTRLR')
 13765*052918         FROM      (ACTIVITY-TRAILERS)
 13766*052918         RIDFLD    (TRLR-KEY)
 13767*052918      END-EXEC
 13768*052918   END-IF
 13769*052918END-IF
 13770*052918.
 13771*0529182620-EXIT.
 13772*052918EXIT.
 13773
 13774 2650-WRITE-MAINT-NOTE.
 13775
 13776* EXEC CICS GETMAIN
 13777*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13778*         LENGTH   (TRLR-LENGTH)
 13779*         INITIMG  (GETMAIN-SPACE)
 13780*    END-EXEC.
 13781*    MOVE ',"IL                  $   #00011932' TO DFHEIV0
 13782     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13783     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13784     MOVE X'2020233030303131393332' TO DFHEIV0(25:11)
 13785     CALL 'kxdfhei1' USING DFHEIV0,
 13786           DFHEIV20,
 13787           TRLR-LENGTH,
 13788           GETMAIN-SPACE
 13789     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13790         DFHEIV20
 13791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13792
 13793
 13794
 13795* EXEC CICS HANDLE CONDITION
 13796*         DUPREC   (2650-EXIT)
 13797*    END-EXEC.
 13798*    MOVE '"$%                   ! ; #00011938' TO DFHEIV0
 13799     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13801     MOVE X'3B20233030303131393338' TO DFHEIV0(25:11)
 13802     CALL 'kxdfhei1' USING DFHEIV0
 13803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13804
 13805
 13806     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13807
 13808     IF CERTL GREATER ZERO
 13809         MOVE CERTI          TO CL-CERT-PRIME.
 13810
 13811     IF SUFXL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 257
* EL131.cbl
 13812         MOVE SUFXI          TO CL-CERT-SFX.
 13813
 13814     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13815
 13816     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13817     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13818
 13819     MOVE 'AT'               TO AT-RECORD-ID.
 13820
 13821     MOVE '6'                TO AT-TRAILER-TYPE.
 13822     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13823                                AT-GEN-INFO-LAST-MAINT-DT.
 13824     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13825                                AT-GEN-INFO-LAST-UPDATED-BY.
 13826     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13827     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13828     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13829
 13830
 13831* EXEC CICS WRITE
 13832*         DATASET  (TRLR-FILE-ID)
 13833*         RIDFLD   (AT-CONTROL-PRIMARY)
 13834*         FROM     (ACTIVITY-TRAILERS)
 13835*    END-EXEC.
 13836     MOVE LENGTH OF
 13837      ACTIVITY-TRAILERS
 13838       TO DFHEIV11
 13839*    MOVE '&$ L                  ''   #00011966' TO DFHEIV0
 13840     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13841     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13842     MOVE X'2020233030303131393636' TO DFHEIV0(25:11)
 13843     CALL 'kxdfhei1' USING DFHEIV0,
 13844           TRLR-FILE-ID,
 13845           ACTIVITY-TRAILERS,
 13846           DFHEIV11,
 13847           AT-CONTROL-PRIMARY,
 13848           DFHEIV99,
 13849           DFHEIV99
 13850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13851
 13852
 13853 2650-EXIT.
 13854      EXIT.
 13855
 13856 2800-CHECK-AUTO-PAY.
 13857
 13858     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13859     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13860     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13861     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13862     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13863
 13864
 13865* EXEC CICS HANDLE CONDITION
 13866*         NOTFND    (2800-EXIT)
 13867*         ENDFILE   (2800-EXIT)
 13868*    END-EXEC.
 13869*    MOVE '"$I''                  ! < #00011983' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 258
* EL131.cbl
 13870     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13872     MOVE X'3C20233030303131393833' TO DFHEIV0(25:11)
 13873     CALL 'kxdfhei1' USING DFHEIV0
 13874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13875
 13876
 13877
 13878* EXEC CICS READ
 13879*        DATASET (TRLR-FILE-ID)
 13880*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13881*        RIDFLD  (TRLR-KEY)
 13882*    END-EXEC.
 13883*    MOVE '&"S        E          (   #00011988' TO DFHEIV0
 13884     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13886     MOVE X'2020233030303131393838' TO DFHEIV0(25:11)
 13887     CALL 'kxdfhei1' USING DFHEIV0,
 13888           TRLR-FILE-ID,
 13889           DFHEIV20,
 13890           DFHEIV99,
 13891           TRLR-KEY,
 13892           DFHEIV99,
 13893           DFHEIV99,
 13894           DFHEIV99
 13895     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13896         DFHEIV20
 13897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13898
 13899
 13900     IF BENEFICIARY-PAID-AUTO
 13901         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13902     END-IF.
 13903
 13904 2800-EXIT.
 13905      EXIT.
 13906
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 259
* EL131.cbl
 13908 3000-DELETE-CLAIM.
 13909     IF  NOT MODIFY-CAP
 13910         MOVE ER-0070            TO EMI-ERROR
 13911         MOVE -1                 TO MAINTL
 13912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13913         GO TO 8110-SEND-DATA.
 13914
 13915
 13916* EXEC CICS READ
 13917*         SET      (ADDRESS OF CLAIM-MASTER)
 13918*         DATASET  (CLMS-FILE-ID)
 13919*         RIDFLD   (MSTR-KEY)
 13920*    END-EXEC.
 13921*    MOVE '&"S        E          (   #00012009' TO DFHEIV0
 13922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13924     MOVE X'2020233030303132303039' TO DFHEIV0(25:11)
 13925     CALL 'kxdfhei1' USING DFHEIV0,
 13926           CLMS-FILE-ID,
 13927           DFHEIV20,
 13928           DFHEIV99,
 13929           MSTR-KEY,
 13930           DFHEIV99,
 13931           DFHEIV99,
 13932           DFHEIV99
 13933     SET ADDRESS OF CLAIM-MASTER TO
 13934         DFHEIV20
 13935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13936
 13937
 13938     IF CL-1ST-TRL-AVAIL
 13939         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13940     ELSE
 13941        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13942        MOVE 0                   TO TRLR-SEQ-NO
 13943
 13944* EXEC CICS STARTBR
 13945*            DATASET (TRLR-FILE-ID)
 13946*            RIDFLD  (TRLR-KEY)
 13947*        END-EXEC
 13948     MOVE 0
 13949       TO DFHEIV11
 13950*    MOVE '&,         G          &   #00012020' TO DFHEIV0
 13951     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13952     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13953     MOVE X'2020233030303132303230' TO DFHEIV0(25:11)
 13954     CALL 'kxdfhei1' USING DFHEIV0,
 13955           TRLR-FILE-ID,
 13956           TRLR-KEY,
 13957           DFHEIV99,
 13958           DFHEIV11,
 13959           DFHEIV99
 13960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13961         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13962
 13963* EXEC CICS ENDBR
 13964*            DATASET (TRLR-FILE-ID)
 13965*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 260
* EL131.cbl
 13966     MOVE 0
 13967       TO DFHEIV11
 13968*    MOVE '&2                    $   #00012025' TO DFHEIV0
 13969     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13970     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13971     MOVE X'2020233030303132303235' TO DFHEIV0(25:11)
 13972     CALL 'kxdfhei1' USING DFHEIV0,
 13973           TRLR-FILE-ID,
 13974           DFHEIV11,
 13975           DFHEIV99
 13976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13977        IF SCREEN-ERROR
 13978            MOVE ER-0208         TO EMI-ERROR
 13979            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13980            MOVE -1              TO MAINTL
 13981            GO TO 8110-SEND-DATA
 13982        ELSE
 13983            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13984
 13985     IF SCREEN-ERROR
 13986         MOVE -1                 TO MAINTL
 13987         GO TO 8110-SEND-DATA.
 13988
 13989     MOVE -1                     TO ONE-OR-MIN1.
 13990     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13991
 13992     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13993         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13994                                    WS-SAVE-CLAIM-KEY
 13995         MOVE +1                 TO ONE-OR-MIN1
 13996         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13997
 13998     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13999
 14000     MOVE LOW-VALUES             TO EL131AO.
 14001     MOVE ER-0000                TO EMI-ERROR.
 14002     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14003     MOVE 'X'                    TO PI-RETURN-CD-1.
 14004     MOVE -1                     TO MAINTL.
 14005     GO TO 8100-SEND-MAP.
 14006
 14007 3010-DEL-MSTR-TRLR.
 14008
 14009* EXEC CICS READ UPDATE
 14010*         SET       (ADDRESS OF CLAIM-MASTER)
 14011*         DATASET   (CLMS-FILE-ID)
 14012*         RIDFLD    (MSTR-KEY)
 14013*    END-EXEC.
 14014*    MOVE '&"S        EU         (   #00012059' TO DFHEIV0
 14015     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14016     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14017     MOVE X'2020233030303132303539' TO DFHEIV0(25:11)
 14018     CALL 'kxdfhei1' USING DFHEIV0,
 14019           CLMS-FILE-ID,
 14020           DFHEIV20,
 14021           DFHEIV99,
 14022           MSTR-KEY,
 14023           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 261
* EL131.cbl
 14024           DFHEIV99,
 14025           DFHEIV99
 14026     SET ADDRESS OF CLAIM-MASTER TO
 14027         DFHEIV20
 14028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14029
 14030
 14031     if (cl-priority-cd = '8')
 14032        and (pi-processor-id not = 'PEMA' and 'JMS '
 14033             AND 'AMWA')
 14034        MOVE ER-8003             TO EMI-ERROR
 14035        PERFORM 9900-ERROR-FORMAT
 14036                                 THRU 9900-EXIT
 14037        MOVE -1                  TO MAINTL
 14038        GO TO 8110-SEND-DATA
 14039     end-if
 14040
 14041     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 14042     MOVE ZERO                   TO TRLR-SEQ-NO.
 14043
 14044
 14045* EXEC CICS HANDLE CONDITION
 14046*         NOTFND    (3010-DEL-ACTQ)
 14047*         ENDFILE   (3040-EXIT)
 14048*    END-EXEC.
 14049*    MOVE '"$I''                  ! = #00012078' TO DFHEIV0
 14050     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14052     MOVE X'3D20233030303132303738' TO DFHEIV0(25:11)
 14053     CALL 'kxdfhei1' USING DFHEIV0
 14054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14055
 14056
 14057     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 14058
 14059 3010-DEL-ACTQ.
 14060
 14061
 14062* EXEC CICS HANDLE CONDITION
 14063*         NOTFND    (3010-NO-ACTIVITY)
 14064*         ENDFILE   (3050-EXIT)
 14065*    END-EXEC.
 14066*    MOVE '"$I''                  ! > #00012087' TO DFHEIV0
 14067     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14069     MOVE X'3E20233030303132303837' TO DFHEIV0(25:11)
 14070     CALL 'kxdfhei1' USING DFHEIV0
 14071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14072
 14073
 14074
 14075* EXEC CICS STARTBR
 14076*         DATASET  (ACTQ-FILE-ID)
 14077*         RIDFLD   (ACTQ-KEY)
 14078*    END-EXEC.
 14079     MOVE 0
 14080       TO DFHEIV11
 14081*    MOVE '&,         G          &   #00012092' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 262
* EL131.cbl
 14082     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14083     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14084     MOVE X'2020233030303132303932' TO DFHEIV0(25:11)
 14085     CALL 'kxdfhei1' USING DFHEIV0,
 14086           ACTQ-FILE-ID,
 14087           ACTQ-KEY,
 14088           DFHEIV99,
 14089           DFHEIV11,
 14090           DFHEIV99
 14091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14092
 14093
 14094
 14095* EXEC CICS GETMAIN
 14096*         SET      (ADDRESS OF ACTIVITY-QUE)
 14097*         LENGTH   (ACTQ-LENGTH)
 14098*         INITIMG  (GETMAIN-SPACE)
 14099*    END-EXEC.
 14100*    MOVE ',"IL                  $   #00012097' TO DFHEIV0
 14101     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14102     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14103     MOVE X'2020233030303132303937' TO DFHEIV0(25:11)
 14104     CALL 'kxdfhei1' USING DFHEIV0,
 14105           DFHEIV20,
 14106           ACTQ-LENGTH,
 14107           GETMAIN-SPACE
 14108     SET ADDRESS OF ACTIVITY-QUE TO
 14109         DFHEIV20
 14110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14111
 14112
 14113     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 14114
 14115
 14116* EXEC CICS ENDBR
 14117*         DATASET (ACTQ-FILE-ID)
 14118*    END-EXEC.
 14119     MOVE 0
 14120       TO DFHEIV11
 14121*    MOVE '&2                    $   #00012105' TO DFHEIV0
 14122     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14123     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14124     MOVE X'2020233030303132313035' TO DFHEIV0(25:11)
 14125     CALL 'kxdfhei1' USING DFHEIV0,
 14126           ACTQ-FILE-ID,
 14127           DFHEIV11,
 14128           DFHEIV99
 14129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14130
 14131
 14132 3010-NO-ACTIVITY.
 14133
 14134
 14135* EXEC CICS HANDLE CONDITION
 14136*        NOTFND   (3010-CERT-NOT-FOUND)
 14137*    END-EXEC.
 14138*    MOVE '"$I                   ! ? #00012111' TO DFHEIV0
 14139     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 263
* EL131.cbl
 14140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14141     MOVE X'3F20233030303132313131' TO DFHEIV0(25:11)
 14142     CALL 'kxdfhei1' USING DFHEIV0
 14143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14144
 14145
 14146     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 14147     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 14148     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 14149     MOVE CL-CERT-STATE          TO CERT-STATE.
 14150     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 14151     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 14152     MOVE CL-CERT-NO             TO CERT-CERT.
 14153
 14154
 14155* EXEC CICS READ
 14156*        DATASET   (CERT-FILE-ID)
 14157*        RIDFLD    (CERT-KEY)
 14158*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14159*    END-EXEC.
 14160*    MOVE '&"S        E          (   #00012123' TO DFHEIV0
 14161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14163     MOVE X'2020233030303132313233' TO DFHEIV0(25:11)
 14164     CALL 'kxdfhei1' USING DFHEIV0,
 14165           CERT-FILE-ID,
 14166           DFHEIV20,
 14167           DFHEIV99,
 14168           CERT-KEY,
 14169           DFHEIV99,
 14170           DFHEIV99,
 14171           DFHEIV99
 14172     SET ADDRESS OF CERTIFICATE-MASTER TO
 14173         DFHEIV20
 14174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14175
 14176
 14177     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 14178       AND PI-COMPANY-ID NOT EQUAL 'AHL' AND 'FNL'
 14179         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 14180     ELSE
 14181         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 14182
 14183 3010-UPDATE-CERT-TRLR.
 14184
 14185     MOVE CERT-KEY               TO ELCRTT-KEY
 14186     MOVE 'B'                    TO CTRLR-REC-TYPE
 14187
 14188* EXEC CICS READ
 14189*       UPDATE
 14190*       DATASET   ('ELCRTT')
 14191*       RIDFLD    (ELCRTT-KEY)
 14192*       INTO      (CERTIFICATE-TRAILERS)
 14193*       RESP      (WS-RESPONSE)
 14194*    END-EXEC
 14195     MOVE LENGTH OF
 14196      CERTIFICATE-TRAILERS
 14197       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 264
* EL131.cbl
 14198     MOVE 'ELCRTT' TO DFHEIV1
 14199*    MOVE '&"IL       EU         (  N#00012139' TO DFHEIV0
 14200     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14201     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14202     MOVE X'204E233030303132313339' TO DFHEIV0(25:11)
 14203     CALL 'kxdfhei1' USING DFHEIV0,
 14204           DFHEIV1,
 14205           CERTIFICATE-TRAILERS,
 14206           DFHEIV11,
 14207           ELCRTT-KEY,
 14208           DFHEIV99,
 14209           DFHEIV99,
 14210           DFHEIV99
 14211     MOVE EIBRESP  TO WS-RESPONSE
 14212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14213     IF WS-RESP-NORMAL
 14214        perform varying s1 from +1 by +1 until
 14215           (s1 > +24)
 14216           or (cs-claim-no (s1) = cl-claim-no)
 14217        end-perform
 14218        if s1 < +25
 14219           move spaces           to cs-claim-no (s1)
 14220                                    cs-claim-type (s1)
 14221                                    cs-insured-type (s1)
 14222           move zeros            to cs-days-paid (s1)
 14223                                    cs-total-paid (s1)
 14224                                    cs-benefit-period (s1)
 14225           if s1 not = +24
 14226              compute s2 = s1 + +1
 14227              perform 3015-bump  thru 3015-exit
 14228           end-if
 14229
 14230* EXEC CICS REWRITE
 14231*             DATASET   ('ELCRTT')
 14232*             FROM      (CERTIFICATE-TRAILERS)
 14233*          END-EXEC
 14234     MOVE LENGTH OF
 14235      CERTIFICATE-TRAILERS
 14236       TO DFHEIV11
 14237     MOVE 'ELCRTT' TO DFHEIV1
 14238*    MOVE '&& L                  %   #00012162' TO DFHEIV0
 14239     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14240     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14241     MOVE X'2020233030303132313632' TO DFHEIV0(25:11)
 14242     CALL 'kxdfhei1' USING DFHEIV0,
 14243           DFHEIV1,
 14244           CERTIFICATE-TRAILERS,
 14245           DFHEIV11,
 14246           DFHEIV99
 14247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14248        end-if
 14249     end-if
 14250     .
 14251 3010-CERT-NOT-FOUND.
 14252
 14253
 14254* EXEC CICS DELETE
 14255*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 265
* EL131.cbl
 14256*    END-EXEC.
 14257*    MOVE '&(                    &   #00012171' TO DFHEIV0
 14258     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14259     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14260     MOVE X'2020233030303132313731' TO DFHEIV0(25:11)
 14261     CALL 'kxdfhei1' USING DFHEIV0,
 14262           CLMS-FILE-ID,
 14263           DFHEIV99,
 14264           DFHEIV99,
 14265           DFHEIV99,
 14266           DFHEIV99
 14267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14268
 14269
 14270 3010-EXIT.
 14271      EXIT.
 14272
 14273 3015-bump.
 14274     perform varying s2 from s2 by +1 until s2 > +24
 14275        move cs-mb-claim-data (s2)
 14276                                 to cs-mb-claim-data (s1)
 14277        move spaces              to cs-mb-claim-data (s2)
 14278        add +1 to s1
 14279     end-perform
 14280     .
 14281 3015-exit.
 14282     exit.
 14283 3020-UPDATE-CERT.
 14284
 14285* EXEC CICS READ UPDATE
 14286*         DATASET  (CERT-FILE-ID)
 14287*         RIDFLD   (CERT-KEY)
 14288*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14289*    END-EXEC.
 14290*    MOVE '&"S        EU         (   #00012189' TO DFHEIV0
 14291     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14292     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14293     MOVE X'2020233030303132313839' TO DFHEIV0(25:11)
 14294     CALL 'kxdfhei1' USING DFHEIV0,
 14295           CERT-FILE-ID,
 14296           DFHEIV20,
 14297           DFHEIV99,
 14298           CERT-KEY,
 14299           DFHEIV99,
 14300           DFHEIV99,
 14301           DFHEIV99
 14302     SET ADDRESS OF CERTIFICATE-MASTER TO
 14303         DFHEIV20
 14304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14305
 14306
 14307     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14308
 14309
 14310* EXEC CICS HANDLE CONDITION
 14311*         DUPKEY   (3020-EXIT)
 14312*    END-EXEC.
 14313*    MOVE '"$$                   ! @ #00012197' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 266
* EL131.cbl
 14314     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14316     MOVE X'4020233030303132313937' TO DFHEIV0(25:11)
 14317     CALL 'kxdfhei1' USING DFHEIV0
 14318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14319
 14320
 14321
 14322* EXEC CICS REWRITE
 14323*         DATASET  (CERT-FILE-ID)
 14324*         FROM     (CERTIFICATE-MASTER)
 14325*    END-EXEC.
 14326     MOVE LENGTH OF
 14327      CERTIFICATE-MASTER
 14328       TO DFHEIV11
 14329*    MOVE '&& L                  %   #00012201' TO DFHEIV0
 14330     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14331     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14332     MOVE X'2020233030303132323031' TO DFHEIV0(25:11)
 14333     CALL 'kxdfhei1' USING DFHEIV0,
 14334           CERT-FILE-ID,
 14335           CERTIFICATE-MASTER,
 14336           DFHEIV11,
 14337           DFHEIV99
 14338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14339
 14340
 14341 3020-EXIT.
 14342     EXIT.
 14343
 14344 3030-DELETE-CERT.
 14345
 14346* EXEC CICS READ UPDATE
 14347*         DATASET  (CERT-FILE-ID)
 14348*         RIDFLD   (CERT-KEY)
 14349*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14350*    END-EXEC.
 14351*    MOVE '&"S        EU         (   #00012210' TO DFHEIV0
 14352     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14353     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14354     MOVE X'2020233030303132323130' TO DFHEIV0(25:11)
 14355     CALL 'kxdfhei1' USING DFHEIV0,
 14356           CERT-FILE-ID,
 14357           DFHEIV20,
 14358           DFHEIV99,
 14359           CERT-KEY,
 14360           DFHEIV99,
 14361           DFHEIV99,
 14362           DFHEIV99
 14363     SET ADDRESS OF CERTIFICATE-MASTER TO
 14364         DFHEIV20
 14365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14366
 14367
 14368
 14369* EXEC CICS DELETE
 14370*         DATASET   (CERT-FILE-ID)
 14371*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 267
* EL131.cbl
 14372*    MOVE '&(                    &   #00012216' TO DFHEIV0
 14373     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14375     MOVE X'2020233030303132323136' TO DFHEIV0(25:11)
 14376     CALL 'kxdfhei1' USING DFHEIV0,
 14377           CERT-FILE-ID,
 14378           DFHEIV99,
 14379           DFHEIV99,
 14380           DFHEIV99,
 14381           DFHEIV99
 14382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14383
 14384
 14385 3030-EXIT.
 14386     EXIT.
 14387
 14388 3040-DELETE-TRLR.
 14389
 14390* EXEC CICS READ
 14391*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14392*         DATASET  (TRLR-FILE-ID)
 14393*         RIDFLD   (TRLR-KEY)
 14394*         GTEQ
 14395*    END-EXEC.
 14396*    MOVE '&"S        G          (   #00012224' TO DFHEIV0
 14397     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14399     MOVE X'2020233030303132323234' TO DFHEIV0(25:11)
 14400     CALL 'kxdfhei1' USING DFHEIV0,
 14401           TRLR-FILE-ID,
 14402           DFHEIV20,
 14403           DFHEIV99,
 14404           TRLR-KEY,
 14405           DFHEIV99,
 14406           DFHEIV99,
 14407           DFHEIV99
 14408     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14409         DFHEIV20
 14410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14411
 14412
 14413     IF PI-COMPANY-CD = AT-COMPANY-CD
 14414        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14415        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14416           GO TO 3040-EXIT
 14417        ELSE
 14418           NEXT SENTENCE
 14419     ELSE
 14420        GO TO 3040-EXIT.
 14421
 14422
 14423* EXEC CICS DELETE
 14424*         DATASET  (TRLR-FILE-ID)
 14425*         RIDFLD   (TRLR-KEY)
 14426*    END-EXEC.
 14427*    MOVE '&(  R                 &   #00012240' TO DFHEIV0
 14428     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14429     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 268
* EL131.cbl
 14430     MOVE X'2020233030303132323430' TO DFHEIV0(25:11)
 14431     CALL 'kxdfhei1' USING DFHEIV0,
 14432           TRLR-FILE-ID,
 14433           TRLR-KEY,
 14434           DFHEIV99,
 14435           DFHEIV99,
 14436           DFHEIV99
 14437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14438
 14439
 14440     GO TO 3040-DELETE-TRLR.
 14441
 14442 3040-EXIT.
 14443     EXIT.
 14444
 14445 3050-DELETE-ACTQ.
 14446
 14447* EXEC CICS READNEXT
 14448*         DATASET  (ACTQ-FILE-ID)
 14449*         RIDFLD   (ACTQ-KEY)
 14450*         INTO     (ACTIVITY-QUE)
 14451*    END-EXEC.
 14452     MOVE LENGTH OF
 14453      ACTIVITY-QUE
 14454       TO DFHEIV12
 14455     MOVE 0
 14456       TO DFHEIV11
 14457*    MOVE '&.IL                  )   #00012251' TO DFHEIV0
 14458     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14459     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14460     MOVE X'2020233030303132323531' TO DFHEIV0(25:11)
 14461     CALL 'kxdfhei1' USING DFHEIV0,
 14462           ACTQ-FILE-ID,
 14463           ACTIVITY-QUE,
 14464           DFHEIV12,
 14465           ACTQ-KEY,
 14466           DFHEIV99,
 14467           DFHEIV11,
 14468           DFHEIV99,
 14469           DFHEIV99
 14470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14471
 14472
 14473     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14474         GO TO 3050-EXIT.
 14475
 14476
 14477* EXEC CICS ENDBR
 14478*         DATASET  (ACTQ-FILE-ID)
 14479*    END-EXEC.
 14480     MOVE 0
 14481       TO DFHEIV11
 14482*    MOVE '&2                    $   #00012260' TO DFHEIV0
 14483     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14484     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14485     MOVE X'2020233030303132323630' TO DFHEIV0(25:11)
 14486     CALL 'kxdfhei1' USING DFHEIV0,
 14487           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 269
* EL131.cbl
 14488           DFHEIV11,
 14489           DFHEIV99
 14490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14491
 14492
 14493
 14494* EXEC CICS DELETE
 14495*         DATASET   (ACTQ-FILE-ID)
 14496*         RIDFLD    (ACTQ-KEY)
 14497*    END-EXEC.
 14498*    MOVE '&(  R                 &   #00012264' TO DFHEIV0
 14499     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14500     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14501     MOVE X'2020233030303132323634' TO DFHEIV0(25:11)
 14502     CALL 'kxdfhei1' USING DFHEIV0,
 14503           ACTQ-FILE-ID,
 14504           ACTQ-KEY,
 14505           DFHEIV99,
 14506           DFHEIV99,
 14507           DFHEIV99
 14508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14509
 14510
 14511
 14512* EXEC CICS STARTBR
 14513*         DATASET   (ACTQ-FILE-ID)
 14514*         RIDFLD    (ACTQ-KEY)
 14515*    END-EXEC.
 14516     MOVE 0
 14517       TO DFHEIV11
 14518*    MOVE '&,         G          &   #00012269' TO DFHEIV0
 14519     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14520     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14521     MOVE X'2020233030303132323639' TO DFHEIV0(25:11)
 14522     CALL 'kxdfhei1' USING DFHEIV0,
 14523           ACTQ-FILE-ID,
 14524           ACTQ-KEY,
 14525           DFHEIV99,
 14526           DFHEIV11,
 14527           DFHEIV99
 14528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14529
 14530
 14531     GO TO 3050-DELETE-ACTQ.
 14532
 14533 3050-EXIT.
 14534     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 270
* EL131.cbl
 14536 3060-READ-TRLR.
 14537
 14538* EXEC CICS HANDLE CONDITION
 14539*         NOTFND    (3060-EXIT)
 14540*         ENDFILE   (3060-EXIT)
 14541*    END-EXEC.
 14542*    MOVE '"$I''                  ! A #00012280' TO DFHEIV0
 14543     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14545     MOVE X'4120233030303132323830' TO DFHEIV0(25:11)
 14546     CALL 'kxdfhei1' USING DFHEIV0
 14547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14548
 14549
 14550 3060-LOOP.
 14551
 14552* EXEC CICS READNEXT
 14553*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14554*         DATASET  (TRLR-FILE-ID)
 14555*         RIDFLD   (TRLR-KEY)
 14556*    END-EXEC.
 14557     MOVE 0
 14558       TO DFHEIV11
 14559*    MOVE '&.S                   )   #00012286' TO DFHEIV0
 14560     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14561     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14562     MOVE X'2020233030303132323836' TO DFHEIV0(25:11)
 14563     CALL 'kxdfhei1' USING DFHEIV0,
 14564           TRLR-FILE-ID,
 14565           DFHEIV20,
 14566           DFHEIV99,
 14567           TRLR-KEY,
 14568           DFHEIV99,
 14569           DFHEIV11,
 14570           DFHEIV99,
 14571           DFHEIV99
 14572     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14573         DFHEIV20
 14574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14575
 14576
 14577     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14578         GO TO 3060-EXIT.
 14579
 14580     IF FORM-CONTROL-TR
 14581         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14582             NEXT SENTENCE
 14583         ELSE
 14584             MOVE 'X'            TO ERROR-SWITCH
 14585             GO TO 3060-EXIT
 14586     ELSE
 14587         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14588            MOVE 'X'                 TO ERROR-SWITCH
 14589            GO TO 3060-EXIT.
 14590
 14591     GO TO 3060-LOOP.
 14592
 14593 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 271
* EL131.cbl
 14594     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 272
* EL131.cbl
 14596 3997-GET-ERPDEF.
 14597
 14598     move cl-company-cd          to cert-company-code
 14599     move cl-cert-key-data       to cert-key (2:21)
 14600     move cl-cert-no             to cert-cert
 14601
 14602
 14603* EXEC CICS READ
 14604*        DATASET   (CERT-FILE-ID)
 14605*        RIDFLD    (CERT-KEY)
 14606*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14607*        resp      (ws-response)
 14608*    END-EXEC
 14609*    MOVE '&"S        E          (  N#00012317' TO DFHEIV0
 14610     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14612     MOVE X'204E233030303132333137' TO DFHEIV0(25:11)
 14613     CALL 'kxdfhei1' USING DFHEIV0,
 14614           CERT-FILE-ID,
 14615           DFHEIV20,
 14616           DFHEIV99,
 14617           CERT-KEY,
 14618           DFHEIV99,
 14619           DFHEIV99,
 14620           DFHEIV99
 14621     SET ADDRESS OF CERTIFICATE-MASTER TO
 14622         DFHEIV20
 14623     MOVE EIBRESP  TO ws-response
 14624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14625
 14626     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14627                                    WS-ERPDEF-SW
 14628     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14629                                    WS-CRIT-PER-RTW-MOS
 14630
 14631     if cm-clp-state = spaces or low-values or zeros
 14632        move cm-state            to cm-clp-state
 14633     end-if
 14634     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14635     MOVE CM-clp-state           TO ERPDEF-STATE
 14636     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14637     evaluate true
 14638        when (cl-claim-type = 'L' or 'P' OR 'O')
 14639           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14640             and 'CU')
 14641           move 'L'              to erpdef-ben-type
 14642           move cm-lf-benefit-cd to erpdef-ben-code
 14643        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14644           and (cm-ah-benefit-cd not = '00' and '  ')
 14645           move 'A'              to erpdef-ben-type
 14646           move cm-ah-benefit-cd to erpdef-ben-code
 14647        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14648           and (cm-ah-benefit-cd = '00' or '  ')
 14649           move 'L'              to erpdef-ben-type
 14650           move cm-lf-benefit-cd to erpdef-ben-code
 14651        when (cl-claim-type = 'L' or 'P' OR 'O')
 14652           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14653           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 273
* EL131.cbl
 14654           move cm-ah-benefit-cd to erpdef-ben-code
 14655        when other
 14656           move 'A'              to erpdef-ben-type
 14657           move cm-ah-benefit-cd to erpdef-ben-code
 14658     end-evaluate
 14659
 14660*    if (cl-claim-type = 'L' or 'P')
 14661*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14662*          and 'CU')
 14663*       move 'L'                 to erpdef-ben-type
 14664*       move cm-lf-benefit-cd    to erpdef-ben-code
 14665*    else
 14666*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14667*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14668*    end-if
 14669     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14670     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14671
 14672
 14673* EXEC CICS STARTBR
 14674*        DATASET  ('ERPDEF')
 14675*        RIDFLD   (ERPDEF-KEY)
 14676*        GTEQ
 14677*        RESP     (WS-RESPONSE)
 14678*    END-EXEC
 14679     MOVE 'ERPDEF' TO DFHEIV1
 14680     MOVE 0
 14681       TO DFHEIV11
 14682*    MOVE '&,         G          &  N#00012370' TO DFHEIV0
 14683     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14685     MOVE X'204E233030303132333730' TO DFHEIV0(25:11)
 14686     CALL 'kxdfhei1' USING DFHEIV0,
 14687           DFHEIV1,
 14688           ERPDEF-KEY,
 14689           DFHEIV99,
 14690           DFHEIV11,
 14691           DFHEIV99
 14692     MOVE EIBRESP  TO WS-RESPONSE
 14693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14694
 14695     IF WS-RESP-NORMAL
 14696
 14697* EXEC CICS READNEXT
 14698*          DATASET  ('ERPDEF')
 14699*          INTO     (PRODUCT-MASTER)
 14700*          RIDFLD   (ERPDEF-KEY)
 14701*          RESP     (WS-RESPONSE)
 14702*       END-EXEC
 14703     MOVE LENGTH OF
 14704      PRODUCT-MASTER
 14705       TO DFHEIV12
 14706     MOVE 'ERPDEF' TO DFHEIV1
 14707     MOVE 0
 14708       TO DFHEIV11
 14709*    MOVE '&.IL                  )  N#00012378' TO DFHEIV0
 14710     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14711     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 274
* EL131.cbl
 14712     MOVE X'204E233030303132333738' TO DFHEIV0(25:11)
 14713     CALL 'kxdfhei1' USING DFHEIV0,
 14714           DFHEIV1,
 14715           PRODUCT-MASTER,
 14716           DFHEIV12,
 14717           ERPDEF-KEY,
 14718           DFHEIV99,
 14719           DFHEIV11,
 14720           DFHEIV99,
 14721           DFHEIV99
 14722     MOVE EIBRESP  TO WS-RESPONSE
 14723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14724        IF WS-RESP-NORMAL
 14725           IF (ERPDEF-KEY-SAVE (1:16) =
 14726              PD-CONTROL-PRIMARY (1:16))
 14727              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14728              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14729                 (A1 > +8)
 14730                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14731              END-PERFORM
 14732              IF A1 < +9
 14733                 SET ERPDEF-FOUND TO TRUE
 14734                 MOVE PD-CRIT-PERIOD (A1)
 14735                              TO WS-CRITICAL-PERIOD
 14736                 MOVE PD-REC-CRIT-PERIOD (A1)
 14737                              TO WS-CRIT-PER-RECURRENT
 14738                 IF PD-RTW-MOS (A1) NUMERIC
 14739                    MOVE PD-RTW-MOS (A1)
 14740                              TO WS-CRIT-PER-RTW-MOS
 14741                 ELSE
 14742                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14743                 END-IF
 14744                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14745                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14746                                 TO WS-EXCL-PERIOD
 14747                 END-IF
 14748                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14749                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14750                                 TO WS-COV-ENDS
 14751                 END-IF
 14752                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14753                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14754                                 TO WS-ACC-PERIOD
 14755                 END-IF
 14756                 if pd-max-extension (a1) numeric
 14757                    move pd-max-extension (a1)
 14758                                 to ws-max-extension
 14759                 end-if
 14760                 if pd-max-amt (a1) numeric
 14761                    move pd-max-amt (a1)
 14762                                 to ws-max-moben
 14763                 end-if
 14764              END-IF
 14765           END-IF
 14766        END-IF
 14767     END-IF
 14768
 14769     .
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 275
* EL131.cbl
 14770 3997-EXIT.
 14771     EXIT.
 14772 4000-FORCE-ERRORS.
 14773     IF PI-RETURN-CD-1 = 'X'
 14774         MOVE ER-0311            TO EMI-ERROR
 14775         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14776         MOVE -1                 TO MAINTL
 14777         GO TO 8110-SEND-DATA.
 14778
 14779     IF NOT FORCE-CAP
 14780         MOVE ER-0416            TO EMI-ERROR
 14781         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14782         MOVE -1                 TO MAINTL
 14783         GO TO 8110-SEND-DATA.
 14784
 14785     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14786     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14787     IF EMI-FATAL-CTR GREATER THAN ZERO
 14788         GO TO 4000-FATAL-ERRORS.
 14789
 14790     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14791
 14792     IF EMI-FATAL-CTR GREATER THAN ZERO
 14793         GO TO 4000-FATAL-ERRORS.
 14794
 14795     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14796
 14797     IF EMI-FATAL-CTR GREATER THAN ZERO
 14798         GO TO 4000-FATAL-ERRORS.
 14799
 14800     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14801     MOVE AL-UANOF               TO CERTA.
 14802     MOVE ER-0000 TO EMI-ERROR.
 14803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14804
 14805 4000-FATAL-ERRORS.
 14806     MOVE -1                     TO MAINTL.
 14807     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 276
* EL131.cbl
 14809
 14810 4100-SAVE-CHANGES.
 14811     IF MAINTL > 0
 14812         MOVE MAINTI  TO WS-SAVE-MAINTI
 14813         MOVE MAINTL  TO WS-SAVE-MAINTL
 14814     END-IF
 14815     IF STATUSL > 0
 14816         MOVE STATUSI  TO WS-SAVE-STATUSI
 14817         MOVE STATUSL  TO WS-SAVE-STATUSL
 14818     END-IF
 14819     IF REPL > 0
 14820         MOVE REPI  TO WS-SAVE-REPI
 14821         MOVE REPL  TO WS-SAVE-REPL
 14822     END-IF
 14823*    IF CAUSEL > 0
 14824*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14825*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14826*    END-IF
 14827*    IF ENDL > 0
 14828*        MOVE ENDI  TO WS-SAVE-ENDI
 14829*        MOVE ENDL  TO WS-SAVE-ENDL
 14830*    END-IF
 14831     IF DIAGL > 0
 14832         MOVE DIAGI  TO WS-SAVE-DIAGI
 14833         MOVE DIAGL  TO WS-SAVE-DIAGL
 14834     END-IF
 14835     IF ICD1L > 0
 14836         MOVE ICD1I  TO WS-SAVE-ICD1I
 14837         MOVE ICD1L  TO WS-SAVE-ICD1L
 14838     END-IF
 14839     IF ICD2L > 0
 14840         MOVE ICD2I  TO WS-SAVE-ICD2I
 14841         MOVE ICD2L  TO WS-SAVE-ICD2L
 14842     END-IF
 14843     IF BENEL > 0
 14844         MOVE BENEI  TO WS-SAVE-BENEI
 14845         MOVE BENEL  TO WS-SAVE-BENEL
 14846     END-IF
 14847     IF BIRTHL > 0
 14848         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14849         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14850     END-IF
 14851     IF SOCIALL > 0
 14852         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14853         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14854     END-IF
 14855     IF SEXL > 0
 14856         MOVE SEXI  TO WS-SAVE-SEXI
 14857         MOVE SEXL  TO WS-SAVE-SEXL
 14858     END-IF
 14859     IF MLNAMEL > 0
 14860         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14861         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14862     END-IF
 14863     IF MFNAMEL > 0
 14864         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14865         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14866     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 277
* EL131.cbl
 14867     IF MMINITL > 0
 14868         MOVE MMINITI  TO WS-SAVE-MMINITI
 14869         MOVE MMINITL  TO WS-SAVE-MMINITL
 14870     END-IF
 14871*    IF LOANNOL > 0
 14872*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14873*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14874*    END-IF
 14875     IF LOANBALL > 0
 14876         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14877         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14878     END-IF
 14879     IF PROCL > 0
 14880         MOVE PROCI  TO WS-SAVE-PROCI
 14881         MOVE PROCL  TO WS-SAVE-PROCL
 14882     END-IF
 14883     IF SUPVL > 0
 14884         MOVE SUPVI  TO WS-SAVE-SUPVI
 14885         MOVE SUPVL  TO WS-SAVE-SUPVL
 14886     END-IF
 14887     IF PRICDL > 0
 14888         MOVE PRICDI  TO WS-SAVE-PRICDI
 14889         MOVE PRICDL  TO WS-SAVE-PRICDL
 14890     END-IF
 14891     IF FILETOL > 0
 14892         MOVE FILETOI  TO WS-SAVE-FILETOI
 14893         MOVE FILETOL  TO WS-SAVE-FILETOL
 14894     END-IF
 14895     IF PDTHRUL > 0
 14896         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14897         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14898     END-IF
 14899     IF PDAMTL > 0
 14900         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14901         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14902     END-IF
 14903     IF NODAYSL > 0
 14904         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14905         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14906     END-IF
 14907     IF NOPMTSL > 0
 14908         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14909         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14910     END-IF
 14911     IF FORMTYPL > 0
 14912         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14913         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14914     END-IF
 14915     IF OCCL > 0
 14916         MOVE OCCI  TO WS-SAVE-OCCI
 14917         MOVE OCCL  TO WS-SAVE-OCCL
 14918     END-IF.
 14919 4100-EXIT.
 14920      EXIT.
 14921
 14922 4200-LOAD-CHANGES.
 14923     IF WS-SAVE-MAINTL > 0
 14924         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 278
* EL131.cbl
 14925         MOVE WS-SAVE-MAINTL  TO MAINTL
 14926         MOVE AL-UANON        TO MAINTA
 14927     END-IF
 14928     IF WS-SAVE-STATUSL > 0
 14929         MOVE WS-SAVE-STATUSI  TO STATUSI
 14930         MOVE WS-SAVE-STATUSL  TO STATUSL
 14931         MOVE AL-UANON         TO STATUSA
 14932     END-IF
 14933     IF WS-SAVE-REPL > 0
 14934         MOVE WS-SAVE-REPI  TO REPI
 14935         MOVE WS-SAVE-REPL  TO REPL
 14936         MOVE AL-UANON      TO REPA
 14937     END-IF
 14938*    IF WS-SAVE-CAUSEL > 0
 14939*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14940*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14941*        MOVE AL-UANON        TO CAUSEA
 14942*    END-IF
 14943*    IF WS-SAVE-ENDL > 0
 14944*        MOVE WS-SAVE-ENDI  TO ENDI
 14945*        MOVE WS-SAVE-ENDL  TO ENDL
 14946*        MOVE AL-UANON      TO ENDA
 14947*    END-IF
 14948     IF WS-SAVE-DIAGL > 0
 14949         MOVE WS-SAVE-DIAGI  TO DIAGI
 14950         MOVE WS-SAVE-DIAGL  TO DIAGL
 14951         MOVE AL-UANON       TO DIAGA
 14952     END-IF
 14953     IF WS-SAVE-ICD1L > 0
 14954         MOVE WS-SAVE-ICD1I  TO ICD1I
 14955         MOVE WS-SAVE-ICD1L  TO ICD1L
 14956         MOVE AL-UANON       TO ICD1A
 14957     END-IF
 14958     IF WS-SAVE-ICD2L > 0
 14959         MOVE WS-SAVE-ICD2I  TO ICD2I
 14960         MOVE WS-SAVE-ICD2L  TO ICD2L
 14961         MOVE AL-UANON       TO ICD2A
 14962     END-IF
 14963     IF WS-SAVE-BENEL > 0
 14964         MOVE WS-SAVE-BENEI  TO BENEI
 14965         MOVE WS-SAVE-BENEL  TO BENEL
 14966         MOVE AL-UANON       TO BENEA
 14967     END-IF
 14968     IF WS-SAVE-BIRTHL > 0
 14969         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14970         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14971         MOVE AL-UANON        TO BIRTHA
 14972     END-IF
 14973     IF WS-SAVE-SOCIALL > 0
 14974         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14975         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14976         MOVE AL-UANON         TO SOCIALA
 14977     END-IF
 14978     IF WS-SAVE-SEXL > 0
 14979         MOVE WS-SAVE-SEXI  TO SEXI
 14980         MOVE WS-SAVE-SEXL  TO SEXL
 14981         MOVE AL-UANON      TO SEXA
 14982     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 279
* EL131.cbl
 14983     IF WS-SAVE-MLNAMEL > 0
 14984         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14985         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14986         MOVE AL-UANON         TO MLNAMEA
 14987     END-IF
 14988     IF WS-SAVE-MFNAMEL > 0
 14989         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14990         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14991         MOVE AL-UANON         TO MFNAMEA
 14992     END-IF
 14993     IF WS-SAVE-MMINITL > 0
 14994         MOVE WS-SAVE-MMINITI  TO MMINITI
 14995         MOVE WS-SAVE-MMINITL  TO MMINITL
 14996         MOVE AL-UANON         TO MMINITA
 14997     END-IF
 14998*    IF WS-SAVE-LOANNOL > 0
 14999*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 15000*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 15001*        MOVE AL-UANON         TO LOANNOA
 15002*    END-IF
 15003     IF WS-SAVE-LOANBALL > 0
 15004         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 15005         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 15006         MOVE AL-UANON          TO LOANBALA
 15007     END-IF
 15008     IF WS-SAVE-PROCL > 0
 15009         MOVE WS-SAVE-PROCI  TO PROCI
 15010         MOVE WS-SAVE-PROCL  TO PROCL
 15011         MOVE AL-UANON       TO PROCA
 15012     END-IF
 15013     IF WS-SAVE-SUPVL > 0
 15014         MOVE WS-SAVE-SUPVI  TO SUPVI
 15015         MOVE WS-SAVE-SUPVL  TO SUPVL
 15016         MOVE AL-UANON       TO SUPVA
 15017     END-IF
 15018     IF WS-SAVE-PRICDL > 0
 15019         MOVE WS-SAVE-PRICDI  TO PRICDI
 15020         MOVE WS-SAVE-PRICDL  TO PRICDL
 15021         MOVE AL-UANON        TO PRICDA
 15022     END-IF
 15023     IF WS-SAVE-FILETOL > 0
 15024         MOVE WS-SAVE-FILETOI  TO FILETOI
 15025         MOVE WS-SAVE-FILETOL  TO FILETOL
 15026         MOVE AL-UANON         TO FILETOA
 15027     END-IF
 15028     IF WS-SAVE-PDTHRUL > 0
 15029         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 15030         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 15031         MOVE AL-UANON         TO PDTHRUA
 15032     END-IF
 15033     IF WS-SAVE-PDAMTL > 0
 15034         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 15035         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 15036         MOVE AL-UANON        TO PDAMTA
 15037     END-IF
 15038     IF WS-SAVE-NODAYSL > 0
 15039         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 15040         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 280
* EL131.cbl
 15041         MOVE AL-UANON         TO NODAYSA
 15042     END-IF
 15043     IF WS-SAVE-NOPMTSL > 0
 15044         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 15045         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 15046         MOVE AL-UANON         TO NOPMTSA
 15047     END-IF
 15048     IF WS-SAVE-FORMTYPL > 0
 15049         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 15050         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 15051         MOVE AL-UANON          TO FORMTYPA
 15052     END-IF
 15053     IF WS-SAVE-OCCL > 0
 15054         MOVE WS-SAVE-OCCI  TO OCCI
 15055         MOVE WS-SAVE-OCCL  TO OCCL
 15056         MOVE AL-UANON      TO OCCA
 15057     END-IF.
 15058 4200-EXIT.
 15059      EXIT.
 15060
 15061 5000-BUILD-MAP.
 15062     IF PI-RETURN-CD-1 = SPACE
 15063         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 15064
 15065     MOVE SPACE                  TO PI-RETURN-CD-1.
 15066
 15067     MOVE LOW-VALUES             TO EL131AI.
 15068
 15069     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 15070     MOVE PI-CARRIER             TO CARRIER-CODE.
 15071     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 15072     MOVE PI-CERT-NO             TO CERT-NO.
 15073
 15074 5000-READ-CLAIM-MASTER.
 15075
 15076
 15077* EXEC CICS READ
 15078*         SET      (ADDRESS OF CLAIM-MASTER)
 15079*         DATASET  (CLMS-FILE-ID)
 15080*         RIDFLD   (MSTR-KEY)
 15081*    END-EXEC.
 15082*    MOVE '&"S        E          (   #00012736' TO DFHEIV0
 15083     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15084     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15085     MOVE X'2020233030303132373336' TO DFHEIV0(25:11)
 15086     CALL 'kxdfhei1' USING DFHEIV0,
 15087           CLMS-FILE-ID,
 15088           DFHEIV20,
 15089           DFHEIV99,
 15090           MSTR-KEY,
 15091           DFHEIV99,
 15092           DFHEIV99,
 15093           DFHEIV99
 15094     SET ADDRESS OF CLAIM-MASTER TO
 15095         DFHEIV20
 15096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15097
 15098
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 281
* EL131.cbl
 15099     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 15100
 15101 5000-READ-DIAGNOSIS-TRAILER.
 15102
 15103
 15104* EXEC CICS HANDLE CONDITION
 15105*         NOTFND (5000-TRLR-NOT-FOUND)
 15106*    END-EXEC.
 15107*    MOVE '"$I                   ! B #00012746' TO DFHEIV0
 15108     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15110     MOVE X'4220233030303132373436' TO DFHEIV0(25:11)
 15111     CALL 'kxdfhei1' USING DFHEIV0
 15112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15113
 15114
 15115     MOVE MSTR-KEY               TO TRLR-KEY.
 15116     MOVE NINETY                 TO TRLR-SEQ-NO.
 15117
 15118
 15119* EXEC CICS READ
 15120*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15121*         DATASET  (TRLR-FILE-ID)
 15122*         RIDFLD   (TRLR-KEY)
 15123*    END-EXEC.
 15124*    MOVE '&"S        E          (   #00012753' TO DFHEIV0
 15125     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15127     MOVE X'2020233030303132373533' TO DFHEIV0(25:11)
 15128     CALL 'kxdfhei1' USING DFHEIV0,
 15129           TRLR-FILE-ID,
 15130           DFHEIV20,
 15131           DFHEIV99,
 15132           TRLR-KEY,
 15133           DFHEIV99,
 15134           DFHEIV99,
 15135           DFHEIV99
 15136     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15137         DFHEIV20
 15138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15139
 15140
 15141     MOVE AT-INFO-LINE-1         TO DIAGO.
 15142     MOVE AT-ICD-CODE-1          TO ICD1O.
 15143     MOVE AT-ICD-CODE-2          TO ICD2O.
 15144
 15145 5000-READ-CERTIFICATE-MASTER.
 15146
 15147     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 15148     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 15149     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 15150     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 15151     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 15152     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 15153     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 15154
 15155
 15156* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 282
* EL131.cbl
 15157*         NOTFND (5000-CERT-NOT-FOUND)
 15158*    END-EXEC.
 15159*    MOVE '"$I                   ! C #00012773' TO DFHEIV0
 15160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15162     MOVE X'4320233030303132373733' TO DFHEIV0(25:11)
 15163     CALL 'kxdfhei1' USING DFHEIV0
 15164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15165
 15166
 15167
 15168* EXEC CICS READ
 15169*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15170*         DATASET  (CERT-FILE-ID)
 15171*         RIDFLD   (CERT-KEY)
 15172*    END-EXEC.
 15173*    MOVE '&"S        E          (   #00012777' TO DFHEIV0
 15174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15176     MOVE X'2020233030303132373737' TO DFHEIV0(25:11)
 15177     CALL 'kxdfhei1' USING DFHEIV0,
 15178           CERT-FILE-ID,
 15179           DFHEIV20,
 15180           DFHEIV99,
 15181           CERT-KEY,
 15182           DFHEIV99,
 15183           DFHEIV99,
 15184           DFHEIV99
 15185     SET ADDRESS OF CERTIFICATE-MASTER TO
 15186         DFHEIV20
 15187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15188
 15189
 15190     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 15191     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 15192     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 15193
 15194     GO TO 5000-EXIT.
 15195
 15196 5000-TRLR-NOT-FOUND.
 15197     MOVE ER-7687                TO EMI-ERROR.
 15198     MOVE -1                     TO DIAGL.
 15199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15200     GO TO 5000-EXIT.
 15201
 15202 5000-CERT-NOT-FOUND.
 15203     MOVE ER-0206                TO EMI-ERROR.
 15204     MOVE -1                     TO CERTL.
 15205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15206
 15207 5000-EXIT.
 15208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 283
* EL131.cbl
 15210 5010-RESET-PI-AREA.
 15211     IF CERTI GREATER THAN LOW-VALUES
 15212         MOVE CERTI              TO PI-CERT-PRIME.
 15213
 15214     IF SUFXI GREATER THAN LOW-VALUES
 15215         MOVE SUFXI              TO PI-CERT-SFX.
 15216
 15217     IF CERTEFFI GREATER THAN LOW-VALUES
 15218         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 15219
 15220     IF CERTACTI GREATER THAN LOW-VALUES
 15221         MOVE CERTACTI           TO PI-ACCOUNT.
 15222
 15223     IF CERTSTI GREATER THAN LOW-VALUES
 15224         MOVE CERTSTI            TO PI-STATE.
 15225
 15226     IF CERTCARI GREATER THAN LOW-VALUES
 15227         MOVE CERTCARI           TO PI-CARRIER.
 15228
 15229     IF CERTGRPI GREATER THAN LOW-VALUES
 15230         MOVE CERTGRPI           TO PI-GROUPING.
 15231
 15232 5010-EXIT.
 15233     EXIT.
 15234
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 284
* EL131.cbl
 15236 5020-MOVE-MSTR.
 15237
 15238     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 15239     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 15240     MOVE WS-CLAIM-SEQU          TO SEQUO.
 15241     MOVE AL-SABON               TO SEQUA.
 15242     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 15243     MOVE CL-CLAIM-TYPE          TO TYPEO
 15244                                    pi-claim-type
 15245
 15246     IF CL-TOTAL-PAID-AMT  = +0 AND
 15247        CL-LAST-PMT-AMT    = +0 AND
 15248        CL-NO-OF-PMTS-MADE = +0
 15249          MOVE AL-UANON          TO TYPEA.
 15250
 15251     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15252     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15253     MOVE CL-CERT-PRIME          TO CERTO.
 15254     MOVE CL-CERT-SFX            TO SUFXO.
 15255     MOVE CL-CERT-CARRIER        TO CARRO.
 15256
 15257     IF CL-CLAIM-STATUS = 'C'
 15258         MOVE 'CLOSED'           TO STATUSO
 15259     ELSE
 15260         MOVE 'OPEN  '           TO STATUSO.
 15261
 15262     move cl-accident-claim-sw   to accswo
 15263     if cl-benefit-period not numeric
 15264        move zeros               to cl-benefit-period
 15265     end-if
 15266     move cl-benefit-period      to benpero
 15267     move cl-insured-type        to instypeo
 15268     MOVE CL-PROCESSOR-ID        TO PROCO.
 15269
 15270     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15271     MOVE CL-CCN                 TO CCNOO.
 15272
 15273     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15274     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15275     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15276     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15277
 15278     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15279         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15280         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15281         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15282         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15283     ELSE
 15284         MOVE SPACES             TO BIRTHO.
 15285
 15286     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15287        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15288         NEXT SENTENCE
 15289       ELSE
 15290         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15291
 15292     IF PI-COMPANY-ID = 'DMD'
 15293       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 285
* EL131.cbl
 15294          IF SOCIALO = SPACES OR LOW-VALUES
 15295            MOVE ER-0885         TO EMI-ERROR
 15296            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15297
 15298     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15299*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15300
 15301*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15302*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15303*        MOVE SPACES                 TO DC-OPTION-CODE
 15304*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15305*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15306*    ELSE
 15307*        MOVE SPACES             TO ENDO.
 15308
 15309     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15310        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15311        MOVE SPACES             TO DC-OPTION-CODE
 15312        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15313        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15314        IF PI-USES-PAID-TO
 15315           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15316           MOVE '6'                TO DC-OPTION-CODE
 15317           MOVE +1                 TO DC-ELAPSED-DAYS
 15318           MOVE +0                 TO DC-ELAPSED-MONTHS
 15319           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15320           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15321        ELSE
 15322           NEXT SENTENCE
 15323     ELSE
 15324        MOVE SPACES             TO PDTHRUO.
 15325
 15326     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15327     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15328     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15329     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15330
 15331     IF MODIFY-CAP
 15332        MOVE AL-UNNOF            TO PDAMTA
 15333                                    NODAYSA
 15334                                    NOPMTSA
 15335        MOVE AL-UANOF            TO PDTHRUA.
 15336     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15337     MOVE '2'                    TO CNTL-REC-TYPE
 15338     MOVE +0                     TO CNTL-SEQ-NO
 15339     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15340
 15341
 15342* EXEC CICS READ
 15343*         DATASET  (CNTL-FILE-ID)
 15344*         SET      (ADDRESS OF CONTROL-FILE)
 15345*         RIDFLD   (CNTL-KEY)
 15346*         RESP     (WS-RESPONSE)
 15347*    END-EXEC
 15348*    MOVE '&"S        E          (  N#00012934' TO DFHEIV0
 15349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15351     MOVE X'204E233030303132393334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 286
* EL131.cbl
 15352     CALL 'kxdfhei1' USING DFHEIV0,
 15353           CNTL-FILE-ID,
 15354           DFHEIV20,
 15355           DFHEIV99,
 15356           CNTL-KEY,
 15357           DFHEIV99,
 15358           DFHEIV99,
 15359           DFHEIV99
 15360     SET ADDRESS OF CONTROL-FILE TO
 15361         DFHEIV20
 15362     MOVE EIBRESP  TO WS-RESPONSE
 15363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15364
 15365     IF WS-RESP-NORMAL
 15366        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15367     end-if
 15368     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15369         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15370         MOVE SPACES             TO DC-OPTION-CODE
 15371         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15372         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15373     ELSE
 15374         MOVE SPACES             TO INCO.
 15375
 15376     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15377        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15378        MOVE AL-UANOF            TO INCA
 15379     end-if
 15380     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15381
 15382     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15383         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15384         MOVE SPACES             TO DC-OPTION-CODE
 15385         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15386         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15387     ELSE
 15388         MOVE SPACES             TO REPO.
 15389
 15390     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15391         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15392         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15393         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15394         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15395     ELSE
 15396         MOVE SPACES             TO ESTO.
 15397
 15398     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15399         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15400         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15401         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15402         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15403     ELSE
 15404         MOVE SPACES             TO MNTDTO.
 15405
 15406
 15407     IF CL-LAST-MAINT-TYPE = SPACE
 15408         MOVE 'SET-UP'           TO MNTTYPEO
 15409     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 287
* EL131.cbl
 15410     IF CL-LAST-MAINT-TYPE = '1'
 15411         MOVE 'PAYMNT'           TO MNTTYPEO
 15412     ELSE
 15413     IF CL-LAST-MAINT-TYPE = '2'
 15414         MOVE 'LETTER'           TO MNTTYPEO
 15415     ELSE
 15416     IF CL-LAST-MAINT-TYPE = '3'
 15417         MOVE 'UPDATE'           TO MNTTYPEO
 15418     ELSE
 15419     IF CL-LAST-MAINT-TYPE = '4'
 15420         MOVE 'RESTOR'           TO MNTTYPEO
 15421     ELSE
 15422     IF CL-LAST-MAINT-TYPE = '5'
 15423         MOVE 'INC DT'           TO MNTTYPEO
 15424     ELSE
 15425     IF CL-LAST-MAINT-TYPE = '6'
 15426         MOVE ' CONV'            TO MNTTYPEO
 15427     ELSE
 15428     IF CL-LAST-MAINT-TYPE = 'C'
 15429         MOVE 'CHGBEN'           TO MNTTYPEO
 15430     ELSE
 15431     IF CL-LAST-MAINT-TYPE = 'E'
 15432         MOVE 'ERRCOR'           TO MNTTYPEO
 15433     ELSE
 15434         MOVE SPACES             TO MNTTYPEO.
 15435
 15436     MOVE CL-BENEFICIARY         TO BENEO.
 15437     MOVE CL-FILE-LOCATION       TO FILETOO.
 15438     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15439        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15440     END-IF
 15441     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15442     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15443        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15444     END-IF
 15445     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15446*    MOVE CL-CRIT-PER-RECURRENT
 15447*                                TO CRITPTO
 15448*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15449*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15450*    END-IF
 15451*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15452     MOVE CL-PRIORITY-CD         TO PRICDO.
 15453     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15454     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15455     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15456     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15457
 15458 5020-EXIT.
 15459     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 288
* EL131.cbl
 15461 5030-MOVE-CERT.
 15462
 15463     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15464         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15465         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15466         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15467         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15468       ELSE
 15469         MOVE SPACES             TO CERTEFFO
 15470         MOVE ZERO               TO HOLD-DATE.
 15471
 15472     MOVE CM-ACCOUNT             TO CERTACTO.
 15473     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15474     MOVE CM-GROUPING            TO CERTGRPO.
 15475     MOVE CM-CARRIER             TO CERTCARO.
 15476     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15477     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15478     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15479     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15480     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15481     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15482     MOVE CM-JT-INITIAL          TO JNTINITO.
 15483     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15484
 15485*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15486     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15487     MOVE '3'                    TO CNTL-REC-TYPE.
 15488     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15489     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15490     MOVE ZERO                   TO CNTL-SEQ-NO.
 15491
 15492
 15493* EXEC CICS READ
 15494*         SET        (ADDRESS OF CONTROL-FILE)
 15495*         DATASET    ('ELCNTL')
 15496*         RIDFLD     (CNTL-KEY)
 15497*         RESP       (WS-RESPONSE)
 15498*    END-EXEC.
 15499     MOVE 'ELCNTL' TO DFHEIV1
 15500*    MOVE '&"S        E          (  N#00013068' TO DFHEIV0
 15501     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15503     MOVE X'204E233030303133303638' TO DFHEIV0(25:11)
 15504     CALL 'kxdfhei1' USING DFHEIV0,
 15505           DFHEIV1,
 15506           DFHEIV20,
 15507           DFHEIV99,
 15508           CNTL-KEY,
 15509           DFHEIV99,
 15510           DFHEIV99,
 15511           DFHEIV99
 15512     SET ADDRESS OF CONTROL-FILE TO
 15513         DFHEIV20
 15514     MOVE EIBRESP  TO WS-RESPONSE
 15515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15516
 15517
 15518     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 289
* EL131.cbl
 15519        MOVE ZERO                TO CP-FREE-LOOK
 15520     ELSE
 15521        MOVE CF-ST-FREE-LOOK-PERIOD
 15522                                 TO CP-FREE-LOOK.
 15523
 15524     IF CM-LF-BENEFIT-CD = '00'
 15525        GO TO 5030-MOVE-CERT-AH.
 15526
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 290
* EL131.cbl
 15528     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15529     MOVE '5'                    TO DC-OPTION-CODE
 15530     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15531     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15532     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15533     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15534     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15535     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15536     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15537     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15538     MOVE '4'                    TO CP-REM-TERM-METHOD
 15539     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15540     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15541     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15542
 15543     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15544     IF CM-LF-PREMIUM-RATE NUMERIC
 15545         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15546     ELSE
 15547         MOVE ZEROS              TO LCVRATEO.
 15548
 15549     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15550         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15551
 15552     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15553
 15554     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15555
 15556     IF CM-LF-CURRENT-STATUS = '8'
 15557        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15558            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15559            MOVE ' '             TO DC-OPTION-CODE
 15560            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15561            IF NOT DATE-CONVERSION-ERROR
 15562                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15563
 15564     IF CM-LF-CURRENT-STATUS = '7'
 15565        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15566            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15567            MOVE ' '             TO DC-OPTION-CODE
 15568            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15569            IF NOT DATE-CONVERSION-ERROR
 15570                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15571
 15572     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15573         MOVE ' '                TO DC-OPTION-CODE
 15574         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15575         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15576         IF NOT DATE-CONVERSION-ERROR
 15577             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15578             MOVE HOLD-MONTH     TO WORK-MONTH
 15579             MOVE HOLD-YEAR      TO WORK-YEAR
 15580             MOVE WORK-DATE-MY   TO LCVEXITO.
 15581
 15582     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15583        IF CP-REMAINING-TERM-3 = ZEROS
 15584           MOVE 'EXPIRED'        TO LCVSTATO
 15585        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 291
* EL131.cbl
 15586           MOVE 'ACTIVE'         TO LCVSTATO.
 15587
 15588     IF CM-LF-CURRENT-STATUS = '2'
 15589        MOVE 'PEND   '           TO LCVSTATO.
 15590     IF CM-LF-CURRENT-STATUS = '3'
 15591        MOVE 'RESTORE'           TO LCVSTATO.
 15592     IF CM-LF-CURRENT-STATUS = '5'
 15593        MOVE 'REISSUE'           TO LCVSTATO.
 15594     IF CM-LF-CURRENT-STATUS = '6'
 15595        MOVE 'LMPBEN'            TO LCVSTATO.
 15596     IF CM-LF-CURRENT-STATUS = '7'
 15597        MOVE 'DEATH  '           TO LCVSTATO.
 15598     IF CM-LF-CURRENT-STATUS = '8'
 15599        MOVE 'CANCEL '           TO LCVSTATO.
 15600     IF CM-LF-CURRENT-STATUS = '9'
 15601        MOVE 'RE-ONLY'           TO LCVSTATO.
 15602     IF CM-LF-CURRENT-STATUS = 'V'
 15603        MOVE 'VOID   '           TO LCVSTATO.
 15604     IF CM-LF-CURRENT-STATUS = 'D'
 15605        MOVE 'DECLINE'           TO LCVSTATO.
 15606
 15607     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15608     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15609     MOVE '4'                    TO BEN-REC-TYPE.
 15610     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15611     MOVE ZERO                   TO BEN-SEQ-NO.
 15612
 15613
 15614* EXEC CICS READ GTEQ
 15615*         DATASET  (CNTL-FILE-ID)
 15616*         RIDFLD   (BENEFIT-KEY)
 15617*         SET      (ADDRESS OF CONTROL-FILE)
 15618*    END-EXEC.
 15619*    MOVE '&"S        G          (   #00013170' TO DFHEIV0
 15620     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15622     MOVE X'2020233030303133313730' TO DFHEIV0(25:11)
 15623     CALL 'kxdfhei1' USING DFHEIV0,
 15624           CNTL-FILE-ID,
 15625           DFHEIV20,
 15626           DFHEIV99,
 15627           BENEFIT-KEY,
 15628           DFHEIV99,
 15629           DFHEIV99,
 15630           DFHEIV99
 15631     SET ADDRESS OF CONTROL-FILE TO
 15632         DFHEIV20
 15633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15634
 15635
 15636     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15637        CF-RECORD-TYPE NOT = '4'
 15638         MOVE ER-0240            TO EMI-ERROR
 15639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15640         GO TO 5030-MOVE-CERT-FINISH.
 15641
 15642     MOVE ZERO                   TO COUNT-2.
 15643     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 292
* EL131.cbl
 15644
 15645     IF SCREEN-ERROR
 15646         MOVE ER-0282            TO EMI-ERROR
 15647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15648        ELSE
 15649         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15650
 15651 5030-MOVE-CERT-AH.
 15652
 15653     IF CM-LF-BENEFIT-CD = '00'
 15654         IF CM-AH-BENEFIT-CD = '00'
 15655             GO TO 5030-MOVE-CERT-FINISH.
 15656
 15657     IF CM-AH-BENEFIT-CD = '00'
 15658        MOVE SPACES             TO ACVKINDO
 15659        COMPUTE PI-PAYMENT-AMT =
 15660                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15661        GO TO 5030-MOVE-CERT-FINISH.
 15662
 15663     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15664     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15665     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15666     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15667     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15668     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15669     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15670     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15671
 15672**DMD **********************************************
 15673     IF PI-COMPANY-ID = 'DMD'
 15674         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15675                                   CM-PMT-EXTENSION-DAYS
 15676         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15677                                      CL-NO-OF-DAYS-PAID
 15678         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15679             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15680         MOVE WS-REM-MOS         TO ACVRTRMO
 15681                                    CP-REMAINING-TERM-3
 15682*        MOVE WS-REM-DAYS        TO DAYSPO
 15683         GO TO 5030-SKIP-RTRM.
 15684**DMD **********************************************
 15685
 15686     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15687     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15688     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15689     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15690
 15691 5030-SKIP-RTRM.
 15692     IF CM-AH-PREMIUM-RATE NUMERIC
 15693         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15694     ELSE
 15695         MOVE ZEROS              TO ACVRATEO.
 15696
 15697     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15698     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15699
 15700     IF CM-AH-CURRENT-STATUS = '8'
 15701        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 293
* EL131.cbl
 15702            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15703            MOVE ' '             TO DC-OPTION-CODE
 15704            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15705            IF NOT DATE-CONVERSION-ERROR
 15706                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15707
 15708     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15709        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15710            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15711            MOVE ' '             TO DC-OPTION-CODE
 15712            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15713            IF NOT DATE-CONVERSION-ERROR
 15714                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15715
 15716     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15717        IF CP-REMAINING-TERM-3 = ZEROS
 15718           MOVE 'EXPIRED'        TO ACVSTATO
 15719        ELSE
 15720           MOVE 'ACTIVE'         TO ACVSTATO.
 15721
 15722     IF CM-AH-CURRENT-STATUS = '2'
 15723        MOVE 'PEND   '           TO ACVSTATO.
 15724     IF CM-AH-CURRENT-STATUS = '3'
 15725        MOVE 'RESTORE'           TO ACVSTATO.
 15726     IF CM-AH-CURRENT-STATUS = '5'
 15727        MOVE 'REISSUE'           TO ACVSTATO.
 15728     IF CM-AH-CURRENT-STATUS = '6'
 15729        MOVE 'LMP DIS'           TO ACVSTATO.
 15730     IF CM-AH-CURRENT-STATUS = '7'
 15731        MOVE 'DEATH  '           TO ACVSTATO.
 15732     IF CM-AH-CURRENT-STATUS = '8'
 15733        MOVE 'CANCEL '           TO ACVSTATO.
 15734     IF CM-AH-CURRENT-STATUS = '9'
 15735        MOVE 'RE-ONLY'           TO ACVSTATO.
 15736     IF CM-AH-CURRENT-STATUS = 'V'
 15737        MOVE 'VOID   '           TO ACVSTATO.
 15738     IF CM-AH-CURRENT-STATUS = '9'
 15739        MOVE 'DECLINE'           TO ACVSTATO.
 15740
 15741     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15742         MOVE ' '                TO DC-OPTION-CODE
 15743         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15744         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15745         IF NOT DATE-CONVERSION-ERROR
 15746             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15747             MOVE HOLD-MONTH     TO WORK-MONTH
 15748             MOVE HOLD-YEAR      TO WORK-YEAR
 15749             MOVE WORK-DATE-MY   TO ACVEXITO.
 15750
 15751     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15752
 15753     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15754     MOVE '5'                    TO BEN-REC-TYPE.
 15755     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15756     MOVE ZERO                   TO BEN-SEQ-NO.
 15757
 15758
 15759* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 294
* EL131.cbl
 15760*         DATASET  (CNTL-FILE-ID)
 15761*         RIDFLD   (BENEFIT-KEY)
 15762*         SET      (ADDRESS OF CONTROL-FILE)
 15763*    END-EXEC.
 15764*    MOVE '&"S        G          (   #00013298' TO DFHEIV0
 15765     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15767     MOVE X'2020233030303133323938' TO DFHEIV0(25:11)
 15768     CALL 'kxdfhei1' USING DFHEIV0,
 15769           CNTL-FILE-ID,
 15770           DFHEIV20,
 15771           DFHEIV99,
 15772           BENEFIT-KEY,
 15773           DFHEIV99,
 15774           DFHEIV99,
 15775           DFHEIV99
 15776     SET ADDRESS OF CONTROL-FILE TO
 15777         DFHEIV20
 15778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15779
 15780
 15781     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15782        CF-RECORD-TYPE NOT = '5'
 15783         MOVE ER-0250            TO EMI-ERROR
 15784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15785         GO TO 5030-MOVE-CERT-FINISH.
 15786
 15787     MOVE ZERO                   TO COUNT-2.
 15788     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15789
 15790     IF SCREEN-ERROR
 15791         MOVE ER-0283            TO EMI-ERROR
 15792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15793       ELSE
 15794         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15795
 15796 5030-MOVE-CERT-FINISH.
 15797
 15798     MOVE CM-LOAN-APR            TO APRO.
 15799     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15800     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15801     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15802*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15803     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15804     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15805
 15806     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15807         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15808         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15809         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15810         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15811     ELSE
 15812         MOVE SPACES               TO ADDONDTO.
 15813
 15814     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15815
 15816 5030-EXIT.
 15817     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 295
* EL131.cbl
 15819 5040-FIND-BENEFIT.
 15820     ADD 1                       TO COUNT-2.
 15821     IF COUNT-2 GREATER THAN 8
 15822         GO TO 5050-BENEFIT-NOTFND.
 15823
 15824     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15825         GO TO 5060-EXIT.
 15826
 15827     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15828         GO TO 5050-BENEFIT-NOTFND.
 15829
 15830     GO TO 5040-FIND-BENEFIT.
 15831
 15832 5050-BENEFIT-NOTFND.
 15833     MOVE 'X'                    TO ERROR-SWITCH.
 15834
 15835 5060-EXIT.
 15836     EXIT.
 15837 5100-LOAD-CORR-TRLR.
 15838     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15839     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15840     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15841     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15842     MOVE 1000               TO TRLR-SEQ-NO.
 15843
 15844
 15845* EXEC CICS HANDLE CONDITION
 15846*         NOTFND    (1052-DONE)
 15847*         ENDFILE   (1052-DONE)
 15848*    END-EXEC.
 15849*    MOVE '"$I''                  ! D #00013367' TO DFHEIV0
 15850     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15852     MOVE X'4420233030303133333637' TO DFHEIV0(25:11)
 15853     CALL 'kxdfhei1' USING DFHEIV0
 15854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15855
 15856
 15857
 15858* EXEC CICS STARTBR
 15859*        DATASET (TRLR-FILE-ID)
 15860*        RIDFLD  (TRLR-KEY)
 15861*    END-EXEC
 15862     MOVE 0
 15863       TO DFHEIV11
 15864*    MOVE '&,         G          &   #00013372' TO DFHEIV0
 15865     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15866     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15867     MOVE X'2020233030303133333732' TO DFHEIV0(25:11)
 15868     CALL 'kxdfhei1' USING DFHEIV0,
 15869           TRLR-FILE-ID,
 15870           TRLR-KEY,
 15871           DFHEIV99,
 15872           DFHEIV11,
 15873           DFHEIV99
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15875
 15876
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 296
* EL131.cbl
 15877     MOVE SPACES TO WS-TRLR-FILE-EOF
 15878                    WS-AUTH-RCVD
 15879     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15880       UNTIL  TRLR-FILE-EOF
 15881         OR WS-AUTH-RCVD > SPACES.
 15882
 15883
 15884* EXEC CICS ENDBR
 15885*        DATASET (TRLR-FILE-ID)
 15886*    END-EXEC.
 15887     MOVE 0
 15888       TO DFHEIV11
 15889*    MOVE '&2                    $   #00013384' TO DFHEIV0
 15890     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15891     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15892     MOVE X'2020233030303133333834' TO DFHEIV0(25:11)
 15893     CALL 'kxdfhei1' USING DFHEIV0,
 15894           TRLR-FILE-ID,
 15895           DFHEIV11,
 15896           DFHEIV99
 15897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15898
 15899
 15900     IF AUTH-RCVD
 15901        MOVE 'Y' TO AUTHRCVO
 15902     ELSE
 15903        MOVE 'N' TO AUTHRCVO
 15904     END-IF.
 15905
 15906
 15907 5100-EXIT.
 15908     EXIT.
 15909
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 297
* EL131.cbl
 15911 6000-CALCULATE-CERT-TERM.
 15912
 15913     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15914         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15915     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15916         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15917     IF CM-LOAN-APR NOT NUMERIC
 15918         MOVE ZEROS              TO CM-LOAN-APR.
 15919
 15920*    IF WS-CALC-METHOD  = 'G'
 15921         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15922*     ELSE
 15923*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15924
 15925     IF N GREATER 120
 15926         MOVE 120                TO N.
 15927
 15928     MOVE '6'                    TO DC-OPTION-CODE.
 15929     MOVE N                      TO DC-ELAPSED-MONTHS.
 15930     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15931     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15932
 15933     IF CM-LF-BENEFIT-CD NOT = ZERO
 15934         MOVE N                  TO CM-LF-ORIG-TERM
 15935         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15936         IF NO-CONVERSION-ERROR
 15937             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15938
 15939     IF CM-AH-BENEFIT-CD NOT = ZERO
 15940         MOVE N                  TO CM-AH-ORIG-TERM
 15941         IF NO-CONVERSION-ERROR
 15942             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15943
 15944 6000-EXIT.
 15945      EXIT.
 15946
 15947 6100-CALC-GROSS-TERM.
 15948     MOVE CM-LOAN-BALANCE         TO L.
 15949     MOVE PI-PAYMENT-AMT          TO M.
 15950
 15951     COMPUTE N = L / M.
 15952     IF N LESS 1
 15953         MOVE 1  TO N.
 15954
 15955     IF CM-LF-BENEFIT-CD NOT = ZERO
 15956         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15957     ELSE
 15958         MOVE ZEROS               TO WS-LF-RATE.
 15959
 15960     IF CM-AH-BENEFIT-CD NOT = ZERO
 15961         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15962     ELSE
 15963         MOVE ZEROS               TO WS-AH-RATE.
 15964
 15965     COMPUTE I = CM-LOAN-APR / +1200.
 15966
 15967 6105-LOOP.
 15968     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 298
* EL131.cbl
 15969         GO TO 6200-EXIT.
 15970     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15971     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15972         ADD 1 TO N
 15973         GO TO 6105-LOOP.
 15974
 15975 6200-EXIT.
 15976      EXIT.
 15977
 15978 6210-CALC-LEFT-RIGHTONE.
 15979      MOVE L         TO LEFT-TOT-1.
 15980      SUBTRACT 1 FROM N.
 15981      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15982      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15983      ADD 1 TO N.
 15984 6211-CALC-TERM1.
 15985      MOVE N         TO TERM1.
 15986      MULTIPLY M BY TERM1.
 15987 6212-LOOP.
 15988      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15989      ADD 1 TO A-N.
 15990      MULTIPLY A-N BY TERM1.
 15991      SUBTRACT 1 FROM A-N.
 15992      ADD TERM1 TO LEFT-TOT-1.
 15993 6213-CALC-TERM2.
 15994      MOVE M         TO TERM2.
 15995      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15996      MULTIPLY IA-N BY TERM2.
 15997      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15998 6215-CALC-RIGHTONE.
 15999      MOVE M         TO RIGHT-TOT-1.
 16000      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16001      MULTIPLY A-N BY RIGHT-TOT-1.
 16002 6220-EXIT.
 16003      EXIT.
 16004
 16005 6300-CALC-A-N.
 16006     IF N LESS 1
 16007         MOVE 0     TO A-N
 16008         GO TO 6300-EXIT.
 16009     IF I = 0
 16010         MOVE .00001 TO I.
 16011     ADD 1 TO I.
 16012     DIVIDE I INTO 1 GIVING V.
 16013     SUBTRACT 1 FROM I.
 16014     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16015     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 16016     DIVIDE I INTO TERM3 GIVING A-N.
 16017 6300-EXIT.
 16018      EXIT.
 16019
 16020 6350-CALC-IA-N.
 16021     IF N LESS 1
 16022         MOVE 0      TO IA-N
 16023         GO TO 6400-EXIT.
 16024     ADD 1 TO N.
 16025     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16026     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 299
* EL131.cbl
 16027     MULTIPLY N BY V-EX-N GIVING TERM3.
 16028     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 16029     SUBTRACT V FROM 1 GIVING TERM4.
 16030     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 16031 6400-EXIT.
 16032      EXIT.
 16033
 16034 6450-CALC-V-EX-N.
 16035     IF N LESS 1
 16036         MOVE 1    TO V-EX-N
 16037         GO TO 6490-EXIT.
 16038     MOVE N        TO NV-STORE.
 16039     IF V-EX-ONETIME = 1  OR
 16040        V NOT = V-EXPONENT (1)
 16041          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 16042 6460-LOOP.
 16043     IF N GREATER 248
 16044         MOVE 248 TO N.
 16045     IF N = 1
 16046         MOVE V               TO V-EX-N
 16047      ELSE
 16048         MOVE V-EXPONENT (N)  TO V-EX-N.
 16049     GO TO 6490-EXIT.
 16050
 16051 6470-BUILD-V-EX-TABLE.
 16052     MOVE 2      TO N.
 16053     MOVE V      TO V-EXPONENT (1)
 16054                    V-EX-N.
 16055 6471-LOOP.
 16056     MULTIPLY V BY V-EX-N.
 16057     MOVE V-EX-N   TO V-EXPONENT (N).
 16058     ADD 1 TO N.
 16059     IF N LESS 248
 16060         GO TO 6471-LOOP.
 16061     MOVE NV-STORE     TO N.
 16062     MOVE 0            TO V-EX-ONETIME.
 16063 6480-EXIT.
 16064      EXIT.
 16065
 16066 6490-EXIT.
 16067      EXIT.
 16068
 16069 6500-CALC-NET-TERM.
 16070     MOVE CM-LOAN-BALANCE         TO L.
 16071     MOVE PI-PAYMENT-AMT          TO M.
 16072
 16073     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 16074     IF WS-REMAIN GREATER ZERO
 16075         ADD 1 TO N.
 16076     IF N = 0
 16077         MOVE 1 TO N.
 16078
 16079 6700-EXIT.
 16080      EXIT.
 16081
 16082 6999-CALC-TERM-EXIT.
 16083     EXIT.
 16084
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 300
* EL131.cbl
 16086 7000-RESET-ATTRIBUTE.
 16087
 16088     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 16089                                    CERTSTA   CERTCARA
 16090                                    CERTGRPA.
 16091     MOVE -1                     TO CERTCARL.
 16092
 16093 7000-EXIT.
 16094     EXIT.
 16095
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 301
* EL131.cbl
 16097 7600-BROWSE-CLAIM.
 16098
 16099
 16100* EXEC CICS READ
 16101*        DATASET(CLMS-FILE-ID)
 16102*        SET    (ADDRESS OF CLAIM-MASTER)
 16103*        RIDFLD (MSTR-KEY)
 16104*        GENERIC
 16105*        EQUAL
 16106*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16107*    END-EXEC.
 16108*    MOVE '&"S  KG    E          (   #00013587' TO DFHEIV0
 16109     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16111     MOVE X'2020233030303133353837' TO DFHEIV0(25:11)
 16112     CALL 'kxdfhei1' USING DFHEIV0,
 16113           CLMS-FILE-ID,
 16114           DFHEIV20,
 16115           DFHEIV99,
 16116           MSTR-KEY,
 16117           ELMSTR-GENERIC-LENGTH,
 16118           DFHEIV99,
 16119           DFHEIV99
 16120     SET ADDRESS OF CLAIM-MASTER TO
 16121         DFHEIV20
 16122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16123
 16124
 16125     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 16126
 16127     if cl-assoc-cert-total = 0
 16128        move 1 to cl-assoc-cert-total
 16129     end-if
 16130     IF CL-ASSOC-CERT-SEQU = 0
 16131        MOVE 1 TO CL-ASSOC-CERT-SEQU
 16132     END-IF
 16133
 16134     IF CL-ASSOC-CERT-TOTAL = 1
 16135         MOVE AL-SADOF           TO BCERT1A
 16136                                    BSUFX1A
 16137                                    BCERT2A
 16138                                    BSUFX2A
 16139                                    BCERT3A
 16140                                    BSUFX3A
 16141                                    BCERT4A
 16142                                    BSUFX4A
 16143                                    BCERT5A
 16144                                    BSUFX5A
 16145                                    PCERTNOA
 16146                                    PSUFXA
 16147                                    LABEL1A
 16148                                    LABEL2A
 16149         GO TO 7699-EXIT.
 16150
 16151 7610-BROWSE-CLAIM-LOOP.
 16152
 16153     MOVE LOW-VALUES             TO BCERT1O
 16154                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 302
* EL131.cbl
 16155                                    BCERT2O
 16156                                    BSUFX2O
 16157                                    BCERT3O
 16158                                    BSUFX3O
 16159                                    BCERT4O
 16160                                    BSUFX4O
 16161                                    BCERT5O
 16162                                    BSUFX5O.
 16163
 16164
 16165* EXEC CICS HANDLE CONDITION
 16166*        ENDFILE  (7630-END-BROWSE)
 16167*    END-EXEC.
 16168*    MOVE '"$''                   ! E #00013635' TO DFHEIV0
 16169     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16171     MOVE X'4520233030303133363335' TO DFHEIV0(25:11)
 16172     CALL 'kxdfhei1' USING DFHEIV0
 16173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16174
 16175
 16176
 16177* EXEC CICS STARTBR
 16178*        DATASET    (CLMS-FILE-ID)
 16179*        RIDFLD     (MSTR-KEY)
 16180*    END-EXEC.
 16181     MOVE 0
 16182       TO DFHEIV11
 16183*    MOVE '&,         G          &   #00013639' TO DFHEIV0
 16184     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16185     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16186     MOVE X'2020233030303133363339' TO DFHEIV0(25:11)
 16187     CALL 'kxdfhei1' USING DFHEIV0,
 16188           CLMS-FILE-ID,
 16189           MSTR-KEY,
 16190           DFHEIV99,
 16191           DFHEIV11,
 16192           DFHEIV99
 16193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16194
 16195
 16196     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 16197
 16198 7620-READ-CLAIM-LOOP.
 16199
 16200
 16201* EXEC CICS READNEXT
 16202*        DATASET   (CLMS-FILE-ID)
 16203*        SET       (ADDRESS OF CLAIM-MASTER)
 16204*        RIDFLD    (MSTR-KEY)
 16205*    END-EXEC.
 16206     MOVE 0
 16207       TO DFHEIV11
 16208*    MOVE '&.S                   )   #00013648' TO DFHEIV0
 16209     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16210     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16211     MOVE X'2020233030303133363438' TO DFHEIV0(25:11)
 16212     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 303
* EL131.cbl
 16213           CLMS-FILE-ID,
 16214           DFHEIV20,
 16215           DFHEIV99,
 16216           MSTR-KEY,
 16217           DFHEIV99,
 16218           DFHEIV11,
 16219           DFHEIV99,
 16220           DFHEIV99
 16221     SET ADDRESS OF CLAIM-MASTER TO
 16222         DFHEIV20
 16223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16224
 16225
 16226     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 16227        CL-CARRIER     NOT = CARRI           OR
 16228        CL-CLAIM-NO    NOT = CLAIMI
 16229        GO TO 7630-END-BROWSE.
 16230
 16231     IF WS-ASSOCIATED-CERTS = 1
 16232         MOVE CL-CERT-PRIME      TO BCERT1O
 16233         MOVE CL-CERT-SFX        TO BSUFX1O.
 16234
 16235     IF WS-ASSOCIATED-CERTS = 2
 16236         MOVE CL-CERT-PRIME      TO BCERT2O
 16237         MOVE CL-CERT-SFX        TO BSUFX2O.
 16238
 16239     IF WS-ASSOCIATED-CERTS = 3
 16240         MOVE CL-CERT-PRIME      TO BCERT3O
 16241         MOVE CL-CERT-SFX        TO BSUFX3O.
 16242
 16243     IF WS-ASSOCIATED-CERTS = 4
 16244         MOVE CL-CERT-PRIME      TO BCERT4O
 16245         MOVE CL-CERT-SFX        TO BSUFX4O.
 16246
 16247     IF WS-ASSOCIATED-CERTS = 5
 16248         MOVE CL-CERT-PRIME      TO BCERT5O
 16249         MOVE CL-CERT-SFX        TO BSUFX5O
 16250     ELSE
 16251         ADD +1                  TO WS-ASSOCIATED-CERTS
 16252         GO TO 7620-READ-CLAIM-LOOP.
 16253
 16254 7630-END-BROWSE.
 16255
 16256
 16257* EXEC CICS ENDBR
 16258*        DATASET   (CLMS-FILE-ID)
 16259*    END-EXEC.
 16260     MOVE 0
 16261       TO DFHEIV11
 16262*    MOVE '&2                    $   #00013684' TO DFHEIV0
 16263     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16264     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16265     MOVE X'2020233030303133363834' TO DFHEIV0(25:11)
 16266     CALL 'kxdfhei1' USING DFHEIV0,
 16267           CLMS-FILE-ID,
 16268           DFHEIV11,
 16269           DFHEIV99
 16270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 304
* EL131.cbl
 16271
 16272
 16273 7640-HIGHLIGHT-CERT-DISPLAYED.
 16274
 16275     MOVE AL-SANON               TO BCERT1A
 16276                                    BSUFX1A
 16277                                    BCERT2A
 16278                                    BSUFX2A
 16279                                    BCERT3A
 16280                                    BSUFX3A
 16281                                    BCERT4A
 16282                                    BSUFX4A
 16283                                    BCERT5A
 16284                                    BSUFX5A.
 16285
 16286     IF BCERT1O = CERTI AND
 16287        BSUFX1O = SUFXI
 16288            MOVE AL-SABON        TO BCERT1A
 16289                                    BSUFX1A.
 16290
 16291     IF BCERT2O = CERTI AND
 16292        BSUFX2O = SUFXI
 16293            MOVE AL-SABON        TO BCERT2A
 16294                                    BSUFX2A.
 16295
 16296     IF BCERT3O = CERTI AND
 16297        BSUFX3O = SUFXI
 16298            MOVE AL-SABON        TO BCERT3A
 16299                                    BSUFX3A.
 16300
 16301     IF BCERT4O = CERTI AND
 16302        BSUFX4O = SUFXI
 16303            MOVE AL-SABON        TO BCERT4A
 16304                                    BSUFX4A.
 16305
 16306     IF BCERT5O = CERTI AND
 16307        BSUFX5O = SUFXI
 16308            MOVE AL-SABON        TO BCERT5A
 16309                                    BSUFX5A.
 16310
 16311 7699-EXIT.
 16312     EXIT.
 16313
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 305
* EL131.cbl
 16315 7700-CHECK-SEQUENCE.
 16316
 16317
 16318* EXEC CICS HANDLE CONDITION
 16319*        ENDFILE  (7799-EXIT)
 16320*        NOTFND   (7799-EXIT)
 16321*    END-EXEC.
 16322*    MOVE '"$''I                  ! F #00013732' TO DFHEIV0
 16323     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16325     MOVE X'4620233030303133373332' TO DFHEIV0(25:11)
 16326     CALL 'kxdfhei1' USING DFHEIV0
 16327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16328
 16329
 16330
 16331* EXEC CICS READ
 16332*        DATASET(CLMS-FILE-ID)
 16333*        SET    (ADDRESS OF CLAIM-MASTER)
 16334*        RIDFLD (MSTR-KEY)
 16335*        GENERIC
 16336*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16337*    END-EXEC.
 16338*    MOVE '&"S  KG    E          (   #00013737' TO DFHEIV0
 16339     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16340     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16341     MOVE X'2020233030303133373337' TO DFHEIV0(25:11)
 16342     CALL 'kxdfhei1' USING DFHEIV0,
 16343           CLMS-FILE-ID,
 16344           DFHEIV20,
 16345           DFHEIV99,
 16346           MSTR-KEY,
 16347           ELMSTR-GENERIC-LENGTH,
 16348           DFHEIV99,
 16349           DFHEIV99
 16350     SET ADDRESS OF CLAIM-MASTER TO
 16351         DFHEIV20
 16352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16353
 16354
 16355     COMPUTE WS-ASSOC-CERT-TOTAL =
 16356             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16357
 16358     GO TO 7799-EXIT.
 16359
 16360 7710-RESEQUENCE-CLAIMS.
 16361
 16362
 16363* EXEC CICS HANDLE CONDITION
 16364*        ENDFILE  (7799-EXIT)
 16365*    END-EXEC.
 16366*    MOVE '"$''                   ! G #00013752' TO DFHEIV0
 16367     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16369     MOVE X'4720233030303133373532' TO DFHEIV0(25:11)
 16370     CALL 'kxdfhei1' USING DFHEIV0
 16371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16372
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 306
* EL131.cbl
 16373
 16374
 16375* EXEC CICS STARTBR
 16376*        DATASET(CLMS-FILE-ID)
 16377*        RIDFLD (MSTR-KEY)
 16378*    END-EXEC.
 16379     MOVE 0
 16380       TO DFHEIV11
 16381*    MOVE '&,         G          &   #00013756' TO DFHEIV0
 16382     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16383     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16384     MOVE X'2020233030303133373536' TO DFHEIV0(25:11)
 16385     CALL 'kxdfhei1' USING DFHEIV0,
 16386           CLMS-FILE-ID,
 16387           MSTR-KEY,
 16388           DFHEIV99,
 16389           DFHEIV11,
 16390           DFHEIV99
 16391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16392
 16393
 16394     COMPUTE WS-ASSOC-CERT-SEQU =
 16395             WS-ASSOC-CERT-SEQU + 1.
 16396
 16397     COMPUTE WS-READNEXT-SWITCH =
 16398             WS-READNEXT-SWITCH + 1.
 16399
 16400 7720-READ-CLAIM-LOOP.
 16401
 16402
 16403* EXEC CICS READNEXT
 16404*        DATASET(CLMS-FILE-ID)
 16405*        SET    (ADDRESS OF CLAIM-MASTER)
 16406*        RIDFLD (MSTR-KEY)
 16407*    END-EXEC.
 16408     MOVE 0
 16409       TO DFHEIV11
 16410*    MOVE '&.S                   )   #00013769' TO DFHEIV0
 16411     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16412     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16413     MOVE X'2020233030303133373639' TO DFHEIV0(25:11)
 16414     CALL 'kxdfhei1' USING DFHEIV0,
 16415           CLMS-FILE-ID,
 16416           DFHEIV20,
 16417           DFHEIV99,
 16418           MSTR-KEY,
 16419           DFHEIV99,
 16420           DFHEIV11,
 16421           DFHEIV99,
 16422           DFHEIV99
 16423     SET ADDRESS OF CLAIM-MASTER TO
 16424         DFHEIV20
 16425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16426
 16427
 16428     IF WS-READNEXT-SWITCH = 1
 16429         ADD 1                   TO WS-READNEXT-SWITCH
 16430         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 307
* EL131.cbl
 16431
 16432 7730-END-BROWSE.
 16433
 16434
 16435* EXEC CICS ENDBR
 16436*        DATASET(CLMS-FILE-ID)
 16437*    END-EXEC.
 16438     MOVE 0
 16439       TO DFHEIV11
 16440*    MOVE '&2                    $   #00013781' TO DFHEIV0
 16441     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16443     MOVE X'2020233030303133373831' TO DFHEIV0(25:11)
 16444     CALL 'kxdfhei1' USING DFHEIV0,
 16445           CLMS-FILE-ID,
 16446           DFHEIV11,
 16447           DFHEIV99
 16448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16449
 16450
 16451 7740-READ-CLAIM-UPDATE.
 16452
 16453     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16454        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16455        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16456        GO TO 7799-EXIT
 16457     ELSE
 16458        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16459
 16460
 16461* EXEC CICS READ
 16462*        DATASET(CLMS-FILE-ID)
 16463*        SET    (ADDRESS OF CLAIM-MASTER)
 16464*        RIDFLD (MSTR-KEY)
 16465*        UPDATE
 16466*    END-EXEC.
 16467*    MOVE '&"S        EU         (   #00013794' TO DFHEIV0
 16468     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16469     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16470     MOVE X'2020233030303133373934' TO DFHEIV0(25:11)
 16471     CALL 'kxdfhei1' USING DFHEIV0,
 16472           CLMS-FILE-ID,
 16473           DFHEIV20,
 16474           DFHEIV99,
 16475           MSTR-KEY,
 16476           DFHEIV99,
 16477           DFHEIV99,
 16478           DFHEIV99
 16479     SET ADDRESS OF CLAIM-MASTER TO
 16480         DFHEIV20
 16481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16482
 16483
 16484     if (cl-priority-cd = '8')
 16485        and (pi-processor-id not = 'PEMA' and 'JMS '
 16486             AND 'AMWA')
 16487        MOVE ER-8003             TO EMI-ERROR
 16488        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 308
* EL131.cbl
 16489                                 THRU 9900-EXIT
 16490        MOVE -1                  TO MAINTL
 16491        GO TO 8110-SEND-DATA
 16492     end-if
 16493
 16494     IF PI-COMPANY-ID = 'CID' or 'AHL' OR 'FNL'
 16495         MOVE 'Y'                TO CL-YESNOSW
 16496     END-IF.
 16497
 16498     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16499     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16500
 16501
 16502* EXEC CICS REWRITE
 16503*         DATASET(CLMS-FILE-ID)
 16504*         FROM   (CLAIM-MASTER)
 16505*    END-EXEC.
 16506     MOVE LENGTH OF
 16507      CLAIM-MASTER
 16508       TO DFHEIV11
 16509*    MOVE '&& L                  %   #00013818' TO DFHEIV0
 16510     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16511     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16512     MOVE X'2020233030303133383138' TO DFHEIV0(25:11)
 16513     CALL 'kxdfhei1' USING DFHEIV0,
 16514           CLMS-FILE-ID,
 16515           CLAIM-MASTER,
 16516           DFHEIV11,
 16517           DFHEIV99
 16518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16519
 16520
 16521     GO TO 7710-RESEQUENCE-CLAIMS.
 16522
 16523 7799-EXIT.
 16524     EXIT.
 16525
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 309
* EL131.cbl
 16527 7800-CHECK-AUTO-ACTIVITY.
 16528
 16529
 16530* EXEC CICS HANDLE CONDITION
 16531*        NOTFND   (7800-NOT-FOUND)
 16532*    END-EXEC.
 16533*    MOVE '"$I                   ! H #00013831' TO DFHEIV0
 16534     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16536     MOVE X'4820233030303133383331' TO DFHEIV0(25:11)
 16537     CALL 'kxdfhei1' USING DFHEIV0
 16538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16539
 16540
 16541     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16542     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16543     MOVE SPACES                     TO  CNTL-PROC-ID.
 16544     MOVE +0                         TO  CNTL-SEQ-NO.
 16545
 16546
 16547* EXEC CICS READ
 16548*        DATASET   (CNTL-FILE-ID)
 16549*        RIDFLD    (CNTL-KEY)
 16550*        SET       (ADDRESS OF CONTROL-FILE)
 16551*    END-EXEC.
 16552*    MOVE '&"S        E          (   #00013840' TO DFHEIV0
 16553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16555     MOVE X'2020233030303133383430' TO DFHEIV0(25:11)
 16556     CALL 'kxdfhei1' USING DFHEIV0,
 16557           CNTL-FILE-ID,
 16558           DFHEIV20,
 16559           DFHEIV99,
 16560           CNTL-KEY,
 16561           DFHEIV99,
 16562           DFHEIV99,
 16563           DFHEIV99
 16564     SET ADDRESS OF CONTROL-FILE TO
 16565         DFHEIV20
 16566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16567
 16568
 16569     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16570         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16571
 16572     IF CL-ACTIVITY-CODE NOT = ZEROS
 16573         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16574         IF MISC-SUB IS GREATER THAN +9
 16575             SUBTRACT +9 FROM MISC-SUB
 16576             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16577         ELSE
 16578             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16579     ELSE
 16580         MOVE 'Y'                              TO  WS-RESET-SW.
 16581
 16582     IF STATUSI = 'C' OR 'CLOSED'
 16583         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16584             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 310
* EL131.cbl
 16585                                         PI-LETTER-SW
 16586             GO TO 7800-EXIT.
 16587
 16588     IF STATUSI = 'C' OR 'CLOSED'
 16589         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16590             MOVE 'N'                TO  PI-LETTER-SW
 16591         ELSE
 16592             MOVE 'Y'                TO  PI-LETTER-SW.
 16593
 16594     IF STATUSI = 'O' OR 'OPEN'
 16595         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16596             MOVE 'N'                TO  PI-REC-FOUND-SW
 16597                                         PI-LETTER-SW
 16598             GO TO 7800-EXIT.
 16599
 16600     IF STATUSI = 'O' OR 'OPEN'
 16601         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16602             MOVE 'N'                TO  PI-LETTER-SW
 16603         ELSE
 16604             MOVE 'Y'                TO  PI-LETTER-SW.
 16605
 16606     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16607     GO TO 7800-EXIT.
 16608
 16609 7800-NOT-FOUND.
 16610
 16611     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16612                                         PI-LETTER-SW.
 16613
 16614 7800-EXIT.
 16615     EXIT.
 16616
 16617 7850-AUTO-LETTER-WRITER.
 16618
 16619     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16620     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16621
 16622     IF STATUSI = 'C' OR 'CLOSED'
 16623         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16624     ELSE
 16625         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16626
 16627     IF STATUSI = 'C' OR 'CLOSED'
 16628         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16629             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16630             MOVE '6'                TO  DC-OPTION-CODE
 16631             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16632             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16633             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16634             IF NO-CONVERSION-ERROR
 16635                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16636             ELSE
 16637                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16638
 16639     IF STATUSI = 'C' OR 'CLOSED'
 16640         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16641             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16642             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 311
* EL131.cbl
 16643             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16644             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16645             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16646             IF NO-CONVERSION-ERROR
 16647                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16648             ELSE
 16649                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16650
 16651     IF STATUSI = 'O' OR 'OPEN'
 16652         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16653             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16654             MOVE '6'                TO  DC-OPTION-CODE
 16655             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16656             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16657             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16658             IF NO-CONVERSION-ERROR
 16659                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16660             ELSE
 16661                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16662
 16663     IF STATUSI = 'O' OR 'OPEN'
 16664         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16665             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16666             MOVE '6'                TO  DC-OPTION-CODE
 16667             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16668             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16669             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16670             IF NO-CONVERSION-ERROR
 16671                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16672             ELSE
 16673                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16674
 16675
 16676* EXEC CICS LINK
 16677*        PROGRAM    (LINK-1523)
 16678*        COMMAREA   (W-1523-LINKDATA)
 16679*        LENGTH     (W-1523-COMM-LENGTH)
 16680*    END-EXEC.
 16681*    MOVE '."C                   (   #00013952' TO DFHEIV0
 16682     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16683     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16684     MOVE X'2020233030303133393532' TO DFHEIV0(25:11)
 16685     CALL 'kxdfhei1' USING DFHEIV0,
 16686           LINK-1523,
 16687           W-1523-LINKDATA,
 16688           W-1523-COMM-LENGTH,
 16689           DFHEIV99,
 16690           DFHEIV99,
 16691           DFHEIV99,
 16692           DFHEIV99
 16693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16694
 16695
 16696     IF W-1523-ERROR-CODE = ZEROS
 16697         GO TO 7850-EXIT.
 16698
 16699     IF W-1523-FATAL-ERROR
 16700         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 312
* EL131.cbl
 16701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16702
 16703     IF W-1523-ERROR-CODE = 0191
 16704         MOVE ER-0803                TO  EMI-ERROR
 16705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16706
 16707 7850-EXIT.
 16708     EXIT.
 16709
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 313
* EL131.cbl
 16711 8000-CREATE-DMO-REC.
 16712     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16713     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16714     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16715
 16716
 16717* EXEC CICS HANDLE CONDITION
 16718*         NOTFND   (8000-NOTE-NOT-FOUND)
 16719*    END-EXEC.
 16720*    MOVE '"$I                   ! I #00013978' TO DFHEIV0
 16721     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16723     MOVE X'4920233030303133393738' TO DFHEIV0(25:11)
 16724     CALL 'kxdfhei1' USING DFHEIV0
 16725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16726
 16727
 16728
 16729* EXEC CICS READ
 16730*         DATASET(NOTE-FILE-ID)
 16731*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16732*         RIDFLD (NOTE-KEY)
 16733*    END-EXEC.
 16734*    MOVE '&"S        E          (   #00013982' TO DFHEIV0
 16735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16737     MOVE X'2020233030303133393832' TO DFHEIV0(25:11)
 16738     CALL 'kxdfhei1' USING DFHEIV0,
 16739           NOTE-FILE-ID,
 16740           DFHEIV20,
 16741           DFHEIV99,
 16742           NOTE-KEY,
 16743           DFHEIV99,
 16744           DFHEIV99,
 16745           DFHEIV99
 16746     SET ADDRESS OF CERTIFICATE-NOTE TO
 16747         DFHEIV20
 16748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16749
 16750
 16751     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16752     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16753     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16754
 16755     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16756         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16757     ELSE
 16758         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16759
 16760     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16761     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16762
 16763
 16764* EXEC CICS LINK
 16765*        PROGRAM    ('DLO006')
 16766*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16767*        LENGTH     (WS-DCT-LENGTH)
 16768*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 314
* EL131.cbl
 16769     MOVE 'DLO006' TO DFHEIV1
 16770*    MOVE '."C                   (   #00014000' TO DFHEIV0
 16771     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16773     MOVE X'2020233030303134303030' TO DFHEIV0(25:11)
 16774     CALL 'kxdfhei1' USING DFHEIV0,
 16775           DFHEIV1,
 16776           DCT-COMMUNICATION-AREA,
 16777           WS-DCT-LENGTH,
 16778           DFHEIV99,
 16779           DFHEIV99,
 16780           DFHEIV99,
 16781           DFHEIV99
 16782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16783
 16784
 16785     IF  DCT-RETURN-CODE = 'OK'
 16786         GO TO 8000-CONT.
 16787
 16788     IF DCT-RETURN-CODE = '01' OR '02'
 16789         GO TO 8000-EXIT.
 16790
 16791     IF DCT-RETURN-CODE = '03'
 16792         MOVE ER-0951            TO EMI-ERROR
 16793         MOVE -1                 TO MAINTL
 16794         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16795         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16796         GO TO 8110-SEND-DATA.
 16797
 16798     IF DCT-RETURN-CODE = '04'
 16799         MOVE ER-0946            TO EMI-ERROR
 16800         MOVE -1                 TO MAINTL
 16801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16802         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16803         GO TO 8110-SEND-DATA.
 16804
 16805     IF DCT-RETURN-CODE = '05'
 16806         MOVE ER-0947            TO EMI-ERROR
 16807         MOVE -1                 TO MAINTL
 16808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16809         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16810         GO TO 8110-SEND-DATA.
 16811
 16812     IF DCT-RETURN-CODE = '06'
 16813         MOVE ER-0921            TO EMI-ERROR
 16814         MOVE -1                 TO MAINTL
 16815         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16816         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16817         GO TO 8110-SEND-DATA.
 16818
 16819     IF DCT-RETURN-CODE = '07'
 16820         MOVE ER-0919            TO EMI-ERROR
 16821         MOVE -1                 TO MAINTL
 16822         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16823         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16824         GO TO 8110-SEND-DATA.
 16825
 16826     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 315
* EL131.cbl
 16827         MOVE ER-0948            TO EMI-ERROR
 16828         MOVE -1                 TO MAINTL
 16829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16830         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16831         GO TO 8110-SEND-DATA.
 16832
 16833     IF DCT-RETURN-CODE = 'N1'
 16834         MOVE ER-0950            TO EMI-ERROR
 16835         MOVE -1                 TO MAINTL
 16836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16837         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16838         GO TO 8110-SEND-DATA.
 16839
 16840     IF DCT-RETURN-CODE = 'E1'
 16841         MOVE ER-0974            TO EMI-ERROR
 16842         MOVE -1                 TO MAINTL
 16843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16844         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16845         GO TO 8110-SEND-DATA.
 16846
 16847     IF DCT-RETURN-CODE = 'E2'
 16848         MOVE ER-0975            TO EMI-ERROR
 16849         MOVE -1                 TO MAINTL
 16850         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16851         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16852         GO TO 8110-SEND-DATA.
 16853
 16854     IF DCT-RETURN-CODE NOT = 'OK'
 16855         MOVE ER-0949            TO EMI-ERROR
 16856         MOVE -1                 TO MAINTL
 16857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16858         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16859         GO TO 8110-SEND-DATA.
 16860
 16861 8000-CONT.
 16862
 16863     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16864     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16865     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16866     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16867     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16868     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16869     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16870     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16871
 16872     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16873     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16874     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16875     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16876     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16877
 16878     IF STATUSI = 'OPEN' OR 'O'
 16879         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16880      ELSE
 16881         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16882
 16883     IF STATUSI = 'OPEN' OR 'O'
 16884        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 316
* EL131.cbl
 16885         MOVE '1'                TO DM-CLAIM-STATUS
 16886      ELSE
 16887         MOVE '2'                TO DM-CLAIM-STATUS.
 16888
 16889     IF STATUSI = 'CLOSED' OR 'C'
 16890        IF NOT FINAL-PAID
 16891         MOVE '3'                TO DM-CLAIM-STATUS
 16892      ELSE
 16893         MOVE '4'                TO DM-CLAIM-STATUS.
 16894
 16895     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16896
 16897
 16898* EXEC CICS LINK
 16899*        PROGRAM    ('DLO025')
 16900*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16901*        LENGTH     (WS-DMO-LENGTH)
 16902*    END-EXEC.
 16903     MOVE 'DLO025' TO DFHEIV1
 16904*    MOVE '."C                   (   #00014118' TO DFHEIV0
 16905     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16907     MOVE X'2020233030303134313138' TO DFHEIV0(25:11)
 16908     CALL 'kxdfhei1' USING DFHEIV0,
 16909           DFHEIV1,
 16910           DMO-COMMUNICATION-AREA,
 16911           WS-DMO-LENGTH,
 16912           DFHEIV99,
 16913           DFHEIV99,
 16914           DFHEIV99,
 16915           DFHEIV99
 16916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16917
 16918
 16919     IF  DM-RETURN-CODE = 'OK'
 16920         GO TO 8000-EXIT.
 16921
 16922     IF DM-RETURN-CODE = '01'
 16923         MOVE ER-8051            TO EMI-ERROR
 16924         MOVE -1                 TO MAINTL
 16925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16926         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16927         GO TO 8110-SEND-DATA.
 16928
 16929     IF DM-RETURN-CODE = '02'
 16930         MOVE ER-8052            TO EMI-ERROR
 16931         MOVE -1                 TO MAINTL
 16932         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16933         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16934         GO TO 8110-SEND-DATA.
 16935
 16936     IF DM-RETURN-CODE = '03'
 16937         MOVE ER-8053            TO EMI-ERROR
 16938         MOVE -1                 TO MAINTL
 16939         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16940         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16941         GO TO 8110-SEND-DATA.
 16942
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 317
* EL131.cbl
 16943     IF DM-RETURN-CODE = '04'
 16944         MOVE ER-8054            TO EMI-ERROR
 16945         MOVE -1                 TO MAINTL
 16946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16947         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16948         GO TO 8110-SEND-DATA.
 16949
 16950     IF DM-RETURN-CODE = '05'
 16951         MOVE ER-8055            TO EMI-ERROR
 16952         MOVE -1                 TO MAINTL
 16953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16954         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16955         GO TO 8110-SEND-DATA.
 16956
 16957     IF DM-RETURN-CODE = '06'
 16958         MOVE ER-8056            TO EMI-ERROR
 16959         MOVE -1                 TO MAINTL
 16960         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16961         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16962         GO TO 8110-SEND-DATA.
 16963
 16964     IF DM-RETURN-CODE = '07'
 16965         MOVE ER-8057            TO EMI-ERROR
 16966         MOVE -1                 TO MAINTL
 16967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16968         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16969         GO TO 8110-SEND-DATA.
 16970
 16971     IF DM-RETURN-CODE = '08'
 16972         MOVE ER-8058            TO EMI-ERROR
 16973         MOVE -1                 TO MAINTL
 16974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16975         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16976         GO TO 8110-SEND-DATA.
 16977
 16978     IF DM-RETURN-CODE = '09'
 16979         MOVE ER-8059            TO EMI-ERROR
 16980         MOVE -1                 TO MAINTL
 16981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16982         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16983         GO TO 8110-SEND-DATA.
 16984
 16985     IF DM-RETURN-CODE = '10'
 16986         MOVE ER-8060            TO EMI-ERROR
 16987         MOVE -1                 TO MAINTL
 16988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16989         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16990         GO TO 8110-SEND-DATA.
 16991
 16992     IF DM-RETURN-CODE = '11'
 16993         MOVE ER-8061            TO EMI-ERROR
 16994         MOVE -1                 TO MAINTL
 16995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16996         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16997         GO TO 8110-SEND-DATA.
 16998
 16999     IF DM-RETURN-CODE = '12'
 17000         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 318
* EL131.cbl
 17001         MOVE -1                 TO MAINTL
 17002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17003         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17004         GO TO 8110-SEND-DATA.
 17005
 17006     IF DM-RETURN-CODE = '13'
 17007         MOVE ER-8063            TO EMI-ERROR
 17008         MOVE -1                 TO MAINTL
 17009         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17010         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17011         GO TO 8110-SEND-DATA.
 17012
 17013     IF DM-RETURN-CODE = '14'
 17014         MOVE ER-8064            TO EMI-ERROR
 17015         MOVE -1                 TO MAINTL
 17016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17017         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17018         GO TO 8110-SEND-DATA.
 17019
 17020     IF DM-RETURN-CODE = '15'
 17021         MOVE ER-8065            TO EMI-ERROR
 17022         MOVE -1                 TO MAINTL
 17023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17024         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17025         GO TO 8110-SEND-DATA.
 17026
 17027     IF DM-RETURN-CODE = '16'
 17028         MOVE ER-8154            TO EMI-ERROR
 17029         MOVE -1                 TO MAINTL
 17030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17031         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17032         GO TO 8110-SEND-DATA.
 17033
 17034     IF DM-RETURN-CODE = '17'
 17035         MOVE ER-8155            TO EMI-ERROR
 17036         MOVE -1                 TO MAINTL
 17037         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17038         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17039         GO TO 8110-SEND-DATA.
 17040
 17041     IF DM-RETURN-CODE = 'N1'
 17042         MOVE ER-8152            TO EMI-ERROR
 17043         MOVE -1                 TO MAINTL
 17044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17045         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17046         GO TO 8110-SEND-DATA.
 17047
 17048     IF DM-RETURN-CODE = 'E1'
 17049         MOVE ER-8153            TO EMI-ERROR
 17050         MOVE -1                 TO MAINTL
 17051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17052         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17053         GO TO 8110-SEND-DATA.
 17054
 17055     MOVE ER-8066                TO EMI-ERROR.
 17056     MOVE -1                     TO MAINTL.
 17057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17058     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 319
* EL131.cbl
 17059     GO TO 8110-SEND-DATA.
 17060
 17061 8000-NOTE-NOT-FOUND.
 17062
 17063* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17064*    MOVE '6"R                   !   #00014267' TO DFHEIV0
 17065     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17067     MOVE X'2020233030303134323637' TO DFHEIV0(25:11)
 17068     CALL 'kxdfhei1' USING DFHEIV0
 17069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17070
 17071     MOVE ER-0954                TO EMI-ERROR.
 17072     MOVE -1                     TO MAINTL.
 17073     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17074     GO TO 8110-SEND-DATA.
 17075
 17076 8000-EXIT.
 17077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 320
* EL131.cbl
 17079 8050-FORMAT-LAST-NAME-1ST.
 17080*****************************************************************
 17081*             M O V E   N A M E   R O U T I N E                 *
 17082*                                                               *
 17083*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 17084*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 17085*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 17086*                                                               *
 17087*                  FIELD               VALUE                    *
 17088*                  -----               -----                    *
 17089*           W-NAME-LAST    (CL15)      SMITH                    *
 17090*           W-NAME-FIRST   (CL15)      JOHN                     *
 17091*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 17092*                                                               *
 17093*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 17094*                SMITH, JOHN ALLEN                              *
 17095*                     OR                                        *
 17096*                SMITH, JOHN A.                                 *
 17097*                                                               *
 17098*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 17099*     COPYBOOK, ELCNWA.                                         *
 17100*****************************************************************.
 17101
 17102     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 17103     MOVE ZERO                   TO WS-NAME-SW.
 17104     SET NWA-INDEX               TO +1.
 17105
 17106     IF W-NAME-LAST   = SPACES  AND
 17107        W-NAME-MIDDLE = SPACES
 17108          MOVE +1                TO WS-NAME-SW.
 17109
 17110     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 17111     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17112
 17113     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 17114     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17115
 17116     SET NWA-INDEX UP BY +1.
 17117
 17118     IF W-NAME-MIDDLE NOT = SPACES
 17119         IF W-NAME-MIDDLE-2 = SPACES
 17120             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 17121             SET NWA-INDEX UP BY +1
 17122             MOVE '.'            TO WS-NW (NWA-INDEX)
 17123             SET NWA-INDEX UP BY +2
 17124         ELSE
 17125             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 17126             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17127
 17128 8050-EXIT.
 17129     EXIT.
 17130
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 321
* EL131.cbl
 17132 8060-MOVE-NAME.
 17133     IF WS-NAME-SW GREATER THAN +1
 17134         GO TO 8060-EXIT.
 17135
 17136     IF WS-NAME-WORK2 = SPACES
 17137         GO TO 8060-EXIT.
 17138
 17139     SET NWA-INDEX2            TO +1.
 17140     SET NWA-INDEX3            TO +2.
 17141
 17142 8060-MOVE-NAME-CYCLE.
 17143     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 17144
 17145     IF NWA-INDEX LESS THAN +30
 17146         SET NWA-INDEX UP BY +1
 17147     ELSE
 17148         ADD +2 TO  WS-NAME-SW
 17149         GO TO 8060-EXIT.
 17150
 17151     IF NWA-INDEX2 LESS THAN +20
 17152         SET NWA-INDEX3 UP BY +1
 17153         SET NWA-INDEX2 UP BY +1.
 17154
 17155     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 17156        WS-NW2 (NWA-INDEX3) = SPACES
 17157         IF WS-NAME-SW = ZERO
 17158             MOVE ','            TO WS-NW (NWA-INDEX)
 17159             SET NWA-INDEX UP BY +2
 17160             MOVE +1             TO WS-NAME-SW
 17161             GO TO 8060-EXIT
 17162         ELSE
 17163             GO TO 8060-EXIT.
 17164
 17165     GO TO 8060-MOVE-NAME-CYCLE.
 17166
 17167 8060-EXIT.
 17168     EXIT.
 17169
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 322
* EL131.cbl
 17171
 17172 8070-UNLOCK-CLAIM-MSTR.
 17173
 17174* EXEC CICS UNLOCK
 17175*        DATASET   (CLMS-FILE-ID)
 17176*    END-EXEC.
 17177*    MOVE '&*                    #   #00014370' TO DFHEIV0
 17178     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 17179     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17180     MOVE X'2020233030303134333730' TO DFHEIV0(25:11)
 17181     CALL 'kxdfhei1' USING DFHEIV0,
 17182           CLMS-FILE-ID,
 17183           DFHEIV99
 17184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17185
 17186
 17187 8070-EXIT.
 17188      EXIT.
 17189
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 323
* EL131.cbl
 17191 8100-SEND-MAP.
 17192     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 17193
 17194     move al-uanon               to accswa
 17195     IF NOT PI-NO-CARRIER-SECURITY
 17196        MOVE AL-SANOF            TO CERTCARA.
 17197     IF NOT PI-NO-ACCOUNT-SECURITY
 17198        MOVE AL-SANOF            TO CERTACTA.
 17199
 17200     IF PI-PROCESSOR-ID = 'LGXX'
 17201        MOVE AL-UANON            TO CCNOA.
 17202
 17203     IF PI-COMPANY-ID = 'DMD'
 17204        NEXT SENTENCE
 17205     ELSE
 17206        MOVE AL-SADOF            TO PFKEY6A.
 17207     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 17208        MOVE AL-SANOF TO EXTENSA
 17209     END-IF
 17210
 17211     IF PI-USES-PAID-TO
 17212        MOVE 'PAID TO  :' TO PTHRHDGO.
 17213
 17214
 17215* EXEC CICS SEND
 17216*         MAP     ('EL131A')
 17217*         MAPSET  ('EL131S')
 17218*         ERASE
 17219*         FREEKB
 17220*         CURSOR
 17221*    END-EXEC.
 17222     MOVE 'EL131A' TO DFHEIV1
 17223     MOVE -1
 17224       TO DFHEIV11
 17225     MOVE 'EL131S' TO DFHEIV2
 17226*    MOVE '8$     CT  E F  H     ,   #00014401' TO DFHEIV0
 17227     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17228     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17229     MOVE X'2020233030303134343031' TO DFHEIV0(25:11)
 17230     CALL 'kxdfhei1' USING DFHEIV0,
 17231           DFHEIV1,
 17232           EL131AO,
 17233           DFHEIV99,
 17234           DFHEIV2,
 17235           DFHEIV99,
 17236           DFHEIV99,
 17237           DFHEIV99,
 17238           DFHEIV11,
 17239           DFHEIV99,
 17240           DFHEIV99,
 17241           DFHEIV99
 17242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17243
 17244
 17245     GO TO 9000-RETURN-TRANS.
 17246
 17247 8110-SEND-DATA.
 17248     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 324
* EL131.cbl
 17249
 17250     IF PI-USES-PAID-TO
 17251        MOVE 'PAID TO  :' TO PTHRHDGO.
 17252
 17253     IF PI-PROCESSOR-ID = 'LGXX'
 17254        MOVE AL-UANON            TO CCNOA.
 17255
 17256     IF PI-COMPANY-ID = 'DMD'
 17257        NEXT SENTENCE
 17258     ELSE
 17259        MOVE AL-SADOF            TO PFKEY6A.
 17260
 17261
 17262* EXEC CICS SEND
 17263*         MAP      ('EL131A')
 17264*         MAPSET   ('EL131S')
 17265*         DATAONLY
 17266*         FREEKB
 17267*         CURSOR
 17268*    END-EXEC.
 17269     MOVE 'EL131A' TO DFHEIV1
 17270     MOVE -1
 17271       TO DFHEIV11
 17272     MOVE 'EL131S' TO DFHEIV2
 17273*    MOVE '8$D    CT    F  H     ,   #00014425' TO DFHEIV0
 17274     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17275     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17276     MOVE X'2020233030303134343235' TO DFHEIV0(25:11)
 17277     CALL 'kxdfhei1' USING DFHEIV0,
 17278           DFHEIV1,
 17279           EL131AO,
 17280           DFHEIV99,
 17281           DFHEIV2,
 17282           DFHEIV99,
 17283           DFHEIV99,
 17284           DFHEIV99,
 17285           DFHEIV11,
 17286           DFHEIV99,
 17287           DFHEIV99,
 17288           DFHEIV99
 17289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17290
 17291
 17292     GO TO 9000-RETURN-TRANS.
 17293
 17294 8120-FORMAT-TIME-DATE.
 17295     perform 8140-check-for-prev-errors
 17296                                 thru 8140-exit
 17297     IF SKIP-ATTRIBUTE = 'Y'
 17298        MOVE SPACES              TO SKIP-ATTRIBUTE
 17299        MOVE ER-0598             TO EMI-ERROR
 17300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17301        GO TO 8125-SKIP-ATTRIBUTE.
 17302
 17303*     IF PI-COMPANY-ID = 'DMD'
 17304      IF PI-PROCESSOR-ID <> 'EMER'
 17305         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17306                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 325
* EL131.cbl
 17307
 17308     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17309                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17310                                    JNTINITA  JNTAGEA   APRA
 17311                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17312                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17313                                    LCVEXITA  LCVSTATA  LCVKINDA
 17314                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17315                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17316                                    ACVEXITA  ACVSTATA  ACVKINDA
 17317                                    PMTFREQA  INDGRPA   PREMTYPA
 17318                                    REINCDA   LCVRATEA  ACVRATEA
 17319                                    ADDONDTA.
 17320
 17321*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17322*       IF PI-COMPANY-ID = 'DMD'
 17323*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17324*                                   SUFXA
 17325*                                   PDAMTA    NODAYSA   NOPMTSA
 17326*                                   INCA      OCCA
 17327*          IF NOT SYSTEM-MODIFY-CAP
 17328*              MOVE AL-SANOF         TO PDTHRUA.
 17329
 17330     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17331         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17332
 17333 8125-SKIP-ATTRIBUTE.
 17334
 17335     MOVE SAVE-DATE              TO DATEO.
 17336
 17337* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17338*    END-EXEC
 17339*    MOVE '0"A                   "   #00014477' TO DFHEIV0
 17340     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17341     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17342     MOVE X'2020233030303134343737' TO DFHEIV0(25:11)
 17343     CALL 'kxdfhei1' USING DFHEIV0,
 17344           LCP-CICS-TIME
 17345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17346
 17347* EXEC CICS FORMATTIME
 17348*              ABSTIME(LCP-CICS-TIME)
 17349*              TIME(LCP-TIME-OF-DAY-XX)
 17350*    END-EXEC
 17351*    MOVE 'j$(     (             #   #00014479' TO DFHEIV0
 17352     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17353     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17354     MOVE X'2020233030303134343739' TO DFHEIV0(25:11)
 17355     CALL 'kxdfhei1' USING DFHEIV0,
 17356           LCP-CICS-TIME,
 17357           LCP-TIME-OF-DAY-XX
 17358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17359     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17360     MOVE UN-HOURS               TO FOR-HOURS.
 17361     MOVE UN-MINUTES             TO FOR-MINUTES.
 17362     MOVE TIME-OUT               TO TIMEO.
 17363     MOVE PI-COMPANY-ID          TO COMPO.
 17364     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 326
* EL131.cbl
 17365     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17366     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17367     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17368     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17369
 17370 8130-EXIT.
 17371     EXIT.
 17372
 17373 8140-check-for-prev-errors.
 17374
 17375     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17376     MOVE PI-CARRIER             TO trlr-carrier
 17377     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17378     MOVE PI-CERT-NO             TO trlr-cert-no
 17379     MOVE +95                    TO TRLR-SEQ-NO
 17380
 17381
 17382* EXEC CICS READ
 17383*       DATASET  ('ELTRLR')
 17384*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17385*       RIDFLD   (TRLR-KEY)
 17386*       RESP     (WS-RESPONSE)
 17387*    END-EXEC
 17388     MOVE 'ELTRLR' TO DFHEIV1
 17389*    MOVE '&"S        E          (  N#00014505' TO DFHEIV0
 17390     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17391     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17392     MOVE X'204E233030303134353035' TO DFHEIV0(25:11)
 17393     CALL 'kxdfhei1' USING DFHEIV0,
 17394           DFHEIV1,
 17395           DFHEIV20,
 17396           DFHEIV99,
 17397           TRLR-KEY,
 17398           DFHEIV99,
 17399           DFHEIV99,
 17400           DFHEIV99
 17401     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17402         DFHEIV20
 17403     MOVE EIBRESP  TO WS-RESPONSE
 17404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17405
 17406     if ws-resp-normal
 17407        perform varying s1 from +1 by +1 until
 17408           at-note-error-no (s1) = spaces
 17409           if at-note-error-no (s1) = '1652'
 17410              continue
 17411           else
 17412              move at-note-error-no (s1)
 17413                                 to emi-error
 17414              move -1 to maintl
 17415              if at-note-error-no (s1) = '1653'
 17416                 evaluate true
 17417                    when pi-claim-type = 'L'
 17418                       move '  LF  '
 17419                        to emi-claim-type
 17420                    when pi-claim-type = 'I'
 17421                       move '  IU  '
 17422                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 327
* EL131.cbl
 17423                    WHEN PI-CLAIM-TYPE = 'F'
 17424                       MOVE '  FL  '
 17425                        TO EMI-CLAIM-TYPE
 17426                    WHEN PI-CLAIM-TYPE = 'O'
 17427                       MOVE '  OT  '
 17428                        TO EMI-CLAIM-TYPE
 17429                    when other
 17430                       move '  AH  '
 17431                        to emi-claim-type
 17432                 end-evaluate
 17433              end-if
 17434              PERFORM 9900-ERROR-FORMAT
 17435                                 THRU 9900-EXIT
 17436           end-if
 17437*          if at-note-error-no (s1) = '1653'
 17438*             perform varying emi-sub from 1 by 1 until
 17439*                emi-sub > 3
 17440*                if emi-error-number (emi-sub) = '1653'
 17441*                   evaluate true
 17442*                      when pi-claim-type = 'L'
 17443*                         move '  LF  '
 17444*                          to emi-claim-type
 17445*                      when pi-claim-type = 'I'
 17446*                         move '  IU  '
 17447*                          to emi-claim-type
 17448*                      when other
 17449*                         move '  AH  '
 17450*                          to emi-claim-type
 17451*                   end-evaluate
 17452*                end-if
 17453*             end-perform
 17454*          end-if
 17455        end-perform
 17456     else
 17457        display ' resp not normal ' ws-response ' '
 17458        trlr-key (2:19)
 17459     end-if
 17460
 17461     .
 17462 8140-exit.
 17463     exit.
 17464 8150-ENTERED-CLAIM-NOTFOUND.
 17465
 17466     MOVE ER-0204                TO EMI-ERROR.
 17467     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17468     MOVE -1                     TO MAINTL.
 17469     GO TO 8100-SEND-MAP.
 17470
 17471 8200-RETURN-PRIOR.
 17472     MOVE SPACE                  TO PI-RETURN-CD-1.
 17473     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17474     GO TO 9200-XCTL.
 17475
 17476 8300-GET-HELP.
 17477     MOVE XCTL-EL010             TO CALL-PGM.
 17478     GO TO 9200-XCTL.
 17479
 17480 8400-RETURN-MASTER.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 328
* EL131.cbl
 17481     MOVE SPACE                  TO PI-RETURN-CD-1.
 17482     MOVE XCTL-EL126             TO CALL-PGM.
 17483     GO TO 9200-XCTL.
 17484
 17485 8500-TRLR-MNT.
 17486     IF PI-RETURN-CD-1 = 'X'
 17487         MOVE ER-0311            TO EMI-ERROR
 17488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17489         MOVE -1                 TO MAINTL
 17490         GO TO 8110-SEND-DATA.
 17491
 17492
 17493* EXEC CICS WRITEQ TS
 17494*         QUEUE     (PI-KEY)
 17495*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17496*         LENGTH    (PI-COMM-LENGTH)
 17497*    END-EXEC.
 17498*    MOVE '*"     L              ''   #00014598' TO DFHEIV0
 17499     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17501     MOVE X'2020233030303134353938' TO DFHEIV0(25:11)
 17502     CALL 'kxdfhei1' USING DFHEIV0,
 17503           PI-KEY,
 17504           PROGRAM-INTERFACE-BLOCK,
 17505           PI-COMM-LENGTH,
 17506           DFHEIV99,
 17507           DFHEIV99,
 17508           DFHEIV99
 17509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17510
 17511
 17512     MOVE XCTL-EL142             TO CALL-PGM.
 17513     GO TO 9200-XCTL.
 17514
 17515 8600-ADDR-MNT.
 17516     IF PI-RETURN-CD-1 = 'X'
 17517         MOVE ER-0311            TO EMI-ERROR
 17518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17519         MOVE -1                 TO MAINTL
 17520         GO TO 8110-SEND-DATA.
 17521
 17522
 17523* EXEC CICS WRITEQ TS
 17524*         QUEUE     (PI-KEY)
 17525*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17526*         LENGTH    (PI-COMM-LENGTH)
 17527*    END-EXEC.
 17528*    MOVE '*"     L              ''   #00014614' TO DFHEIV0
 17529     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17530     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17531     MOVE X'2020233030303134363134' TO DFHEIV0(25:11)
 17532     CALL 'kxdfhei1' USING DFHEIV0,
 17533           PI-KEY,
 17534           PROGRAM-INTERFACE-BLOCK,
 17535           PI-COMM-LENGTH,
 17536           DFHEIV99,
 17537           DFHEIV99,
 17538           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 329
* EL131.cbl
 17539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17540
 17541
 17542     MOVE XCTL-EL141             TO CALL-PGM.
 17543     GO TO 9200-XCTL.
 17544
 17545 8700-CERT-MNT.
 17546     IF PI-RETURN-CD-1 = 'X'
 17547         MOVE ER-7690            TO EMI-ERROR
 17548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17549         MOVE -1                 TO MAINTL
 17550         GO TO 8110-SEND-DATA.
 17551
 17552
 17553* EXEC CICS WRITEQ TS
 17554*         QUEUE     (PI-KEY)
 17555*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17556*         LENGTH    (PI-COMM-LENGTH)
 17557*    END-EXEC.
 17558*    MOVE '*"     L              ''   #00014630' TO DFHEIV0
 17559     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17560     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17561     MOVE X'2020233030303134363330' TO DFHEIV0(25:11)
 17562     CALL 'kxdfhei1' USING DFHEIV0,
 17563           PI-KEY,
 17564           PROGRAM-INTERFACE-BLOCK,
 17565           PI-COMM-LENGTH,
 17566           DFHEIV99,
 17567           DFHEIV99,
 17568           DFHEIV99
 17569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17570
 17571
 17572     MOVE XCTL-EL1273            TO CALL-PGM.
 17573     GO TO 9200-XCTL.
 17574
 17575 8725-BENEFICIARY-MNT.
 17576     IF PI-RETURN-CD-1 = 'X'
 17577         MOVE ER-0311            TO EMI-ERROR
 17578         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17579         MOVE -1                 TO MAINTL
 17580         GO TO 8110-SEND-DATA.
 17581
 17582
 17583* EXEC CICS WRITEQ TS
 17584*         QUEUE     (PI-KEY)
 17585*         FROM      (EL131AI)
 17586*         LENGTH    (MAP-LENGTH)
 17587*    END-EXEC.
 17588*    MOVE '*"     L              ''   #00014646' TO DFHEIV0
 17589     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17590     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17591     MOVE X'2020233030303134363436' TO DFHEIV0(25:11)
 17592     CALL 'kxdfhei1' USING DFHEIV0,
 17593           PI-KEY,
 17594           EL131AI,
 17595           MAP-LENGTH,
 17596           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 330
* EL131.cbl
 17597           DFHEIV99,
 17598           DFHEIV99
 17599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17600
 17601
 17602
 17603* EXEC CICS WRITEQ TS
 17604*         QUEUE     (PI-KEY)
 17605*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17606*         LENGTH    (PI-COMM-LENGTH)
 17607*    END-EXEC.
 17608*    MOVE '*"     L              ''   #00014652' TO DFHEIV0
 17609     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17610     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17611     MOVE X'2020233030303134363532' TO DFHEIV0(25:11)
 17612     CALL 'kxdfhei1' USING DFHEIV0,
 17613           PI-KEY,
 17614           PROGRAM-INTERFACE-BLOCK,
 17615           PI-COMM-LENGTH,
 17616           DFHEIV99,
 17617           DFHEIV99,
 17618           DFHEIV99
 17619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17620
 17621
 17622     MOVE XCTL-EL114             TO CALL-PGM.
 17623     GO TO 9200-XCTL.
 17624
 17625 8750-DMD-CLM-FIX.
 17626
 17627* EXEC CICS WRITEQ TS
 17628*         QUEUE     (PI-KEY)
 17629*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17630*         LENGTH    (PI-COMM-LENGTH)
 17631*    END-EXEC.
 17632*    MOVE '*"     L              ''   #00014662' TO DFHEIV0
 17633     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17635     MOVE X'2020233030303134363632' TO DFHEIV0(25:11)
 17636     CALL 'kxdfhei1' USING DFHEIV0,
 17637           PI-KEY,
 17638           PROGRAM-INTERFACE-BLOCK,
 17639           PI-COMM-LENGTH,
 17640           DFHEIV99,
 17641           DFHEIV99,
 17642           DFHEIV99
 17643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17644
 17645
 17646     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17647     GO TO 9200-XCTL.
 17648
 17649 8800-UNAUTHORIZED-ACCESS.
 17650     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17651     GO TO 8990-SEND-TEXT.
 17652
 17653 8810-PF23-ENTERED.
 17654     MOVE EIBAID                 TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 331
* EL131.cbl
 17655     MOVE XCTL-EL005             TO CALL-PGM.
 17656     GO TO 9200-XCTL.
 17657
 17658 8820-XCTL-ERROR.
 17659
 17660* EXEC CICS HANDLE CONDITION
 17661*        PGMIDERR (8990-SEND-TEXT)
 17662*    END-EXEC.
 17663*    MOVE '"$L                   ! J #00014681' TO DFHEIV0
 17664     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17666     MOVE X'4A20233030303134363831' TO DFHEIV0(25:11)
 17667     CALL 'kxdfhei1' USING DFHEIV0
 17668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17669
 17670
 17671     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17672     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17673     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17674     MOVE XCTL-EL005            TO CALL-PGM.
 17675     GO TO 9200-XCTL.
 17676
 17677 8990-SEND-TEXT.
 17678
 17679* EXEC CICS SEND TEXT
 17680*         FROM      (LOGOFF-TEXT)
 17681*         LENGTH    (LOGOFF-LENGTH)
 17682*         ERASE
 17683*         FREEKB
 17684*    END-EXEC.
 17685*    MOVE '8&      T  E F  H   F -   #00014692' TO DFHEIV0
 17686     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17687     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17688     MOVE X'2020233030303134363932' TO DFHEIV0(25:11)
 17689     CALL 'kxdfhei1' USING DFHEIV0,
 17690           LOGOFF-TEXT,
 17691           LOGOFF-LENGTH,
 17692           DFHEIV99,
 17693           DFHEIV99,
 17694           DFHEIV99,
 17695           DFHEIV99,
 17696           DFHEIV99,
 17697           DFHEIV99,
 17698           DFHEIV99,
 17699           DFHEIV99,
 17700           DFHEIV99,
 17701           DFHEIV99
 17702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17703
 17704
 17705     GO TO 9100-RETURN-CICS.
 17706
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 332
* EL131.cbl
 17708 9000-RETURN-TRANS.
 17709
 17710* EXEC CICS RETURN
 17711*         TRANSID   (TRANS-ID)
 17712*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17713*         LENGTH    (PI-COMM-LENGTH)
 17714*    END-EXEC.
 17715*    MOVE '.(CT                  ''   #00014703' TO DFHEIV0
 17716     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17718     MOVE X'2020233030303134373033' TO DFHEIV0(25:11)
 17719     CALL 'kxdfhei1' USING DFHEIV0,
 17720           TRANS-ID,
 17721           PROGRAM-INTERFACE-BLOCK,
 17722           PI-COMM-LENGTH,
 17723           DFHEIV99,
 17724           DFHEIV99,
 17725           DFHEIV99
 17726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17727
 17728
 17729
 17730* GOBACK.
 17731     MOVE '9%                    "   ' TO DFHEIV0
 17732     MOVE 'EL131' TO DFHEIV1
 17733     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17734     GOBACK.
 17735
 17736 9100-RETURN-CICS.
 17737
 17738* EXEC CICS RETURN
 17739*    END-EXEC.
 17740*    MOVE '.(                    ''   #00014712' TO DFHEIV0
 17741     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17742     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17743     MOVE X'2020233030303134373132' TO DFHEIV0(25:11)
 17744     CALL 'kxdfhei1' USING DFHEIV0,
 17745           DFHEIV99,
 17746           DFHEIV99,
 17747           DFHEIV99,
 17748           DFHEIV99,
 17749           DFHEIV99,
 17750           DFHEIV99
 17751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17752
 17753
 17754
 17755* GOBACK.
 17756     MOVE '9%                    "   ' TO DFHEIV0
 17757     MOVE 'EL131' TO DFHEIV1
 17758     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17759     GOBACK.
 17760
 17761 9200-XCTL.
 17762
 17763* EXEC CICS XCTL
 17764*         PROGRAM    (CALL-PGM)
 17765*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 333
* EL131.cbl
 17766*         LENGTH     (PI-COMM-LENGTH)
 17767*    END-EXEC.
 17768*    MOVE '.$C                   %   #00014718' TO DFHEIV0
 17769     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17770     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17771     MOVE X'2020233030303134373138' TO DFHEIV0(25:11)
 17772     CALL 'kxdfhei1' USING DFHEIV0,
 17773           CALL-PGM,
 17774           PROGRAM-INTERFACE-BLOCK,
 17775           PI-COMM-LENGTH,
 17776           DFHEIV99
 17777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17778
 17779
 17780 9700-LINK-RTRM-FILE-ID.
 17781
 17782* EXEC CICS LINK
 17783*        PROGRAM  (RTRM-FILE-ID)
 17784*        COMMAREA (CALCULATION-PASS-AREA)
 17785*        LENGTH   (CP-COMM-LENGTH)
 17786*    END-EXEC.
 17787*    MOVE '."C                   (   #00014725' TO DFHEIV0
 17788     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17790     MOVE X'2020233030303134373235' TO DFHEIV0(25:11)
 17791     CALL 'kxdfhei1' USING DFHEIV0,
 17792           RTRM-FILE-ID,
 17793           CALCULATION-PASS-AREA,
 17794           CP-COMM-LENGTH,
 17795           DFHEIV99,
 17796           DFHEIV99,
 17797           DFHEIV99,
 17798           DFHEIV99
 17799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17800
 17801
 17802 9700-EXIT.
 17803      EXIT.
 17804
 17805 9800-CONVERT-DATE.
 17806     MOVE SPACES TO DC-ERROR-CODE.
 17807
 17808* EXEC CICS LINK
 17809*         PROGRAM    (DATE-CONV)
 17810*         COMMAREA   (DATE-CONVERSION-DATA)
 17811*         LENGTH     (DC-COMM-LENGTH)
 17812*    END-EXEC.
 17813*    MOVE '."C                   (   #00014736' TO DFHEIV0
 17814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17816     MOVE X'2020233030303134373336' TO DFHEIV0(25:11)
 17817     CALL 'kxdfhei1' USING DFHEIV0,
 17818           DATE-CONV,
 17819           DATE-CONVERSION-DATA,
 17820           DC-COMM-LENGTH,
 17821           DFHEIV99,
 17822           DFHEIV99,
 17823           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 334
* EL131.cbl
 17824           DFHEIV99
 17825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17826
 17827
 17828 9800-EXIT.
 17829     EXIT.
 17830
 17831 9900-ERROR-FORMAT.
 17832
 17833* EXEC CICS LINK
 17834*         PROGRAM    (XCTL-EL001)
 17835*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17836*         LENGTH     (EMI-COMM-LENGTH)
 17837*    END-EXEC.
 17838*    MOVE '."C                   (   #00014746' TO DFHEIV0
 17839     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17841     MOVE X'2020233030303134373436' TO DFHEIV0(25:11)
 17842     CALL 'kxdfhei1' USING DFHEIV0,
 17843           XCTL-EL001,
 17844           ERROR-MESSAGE-INTERFACE-BLOCK,
 17845           EMI-COMM-LENGTH,
 17846           DFHEIV99,
 17847           DFHEIV99,
 17848           DFHEIV99,
 17849           DFHEIV99
 17850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17851
 17852
 17853 9900-EXIT.
 17854     EXIT.
 17855
 17856 9990-ABEND.
 17857     MOVE DFHEIBLK               TO EMI-LINE1.
 17858
 17859* EXEC CICS LINK
 17860*         PROGRAM   (XCTL-EL004)
 17861*         COMMAREA  (EMI-LINE1)
 17862*         LENGTH    (72)
 17863*     END-EXEC.
 17864     MOVE 72
 17865       TO DFHEIV11
 17866*    MOVE '."C                   (   #00014757' TO DFHEIV0
 17867     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17869     MOVE X'2020233030303134373537' TO DFHEIV0(25:11)
 17870     CALL 'kxdfhei1' USING DFHEIV0,
 17871           XCTL-EL004,
 17872           EMI-LINE1,
 17873           DFHEIV11,
 17874           DFHEIV99,
 17875           DFHEIV99,
 17876           DFHEIV99,
 17877           DFHEIV99
 17878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17879
 17880
 17881     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 335
* EL131.cbl
 17882
 17883     GO TO 8110-SEND-DATA.
 17884
 17885 9995-SECURITY-VIOLATION.
 17886*           COPY ELCSCTP.
 17887******************************************************************
 17888*                                                                *
 17889*                            ELCSCTP                             *
 17890*                            VMOD=2.001                          *
 17891*                                                                *
 17892*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17893******************************************************************
 17894
 17895
 17896     MOVE EIBDATE          TO SM-JUL-DATE.
 17897     MOVE EIBTRMID         TO SM-TERMID.
 17898     MOVE THIS-PGM         TO SM-PGM.
 17899     MOVE EIBTIME          TO TIME-IN.
 17900     MOVE TIME-OUT         TO SM-TIME.
 17901     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17902
 17903
 17904* EXEC CICS LINK
 17905*         PROGRAM  ('EL003')
 17906*         COMMAREA (SECURITY-MESSAGE)
 17907*         LENGTH   (80)
 17908*    END-EXEC.
 17909     MOVE 'EL003' TO DFHEIV1
 17910     MOVE 80
 17911       TO DFHEIV11
 17912*    MOVE '."C                   (   #00014785' TO DFHEIV0
 17913     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17915     MOVE X'2020233030303134373835' TO DFHEIV0(25:11)
 17916     CALL 'kxdfhei1' USING DFHEIV0,
 17917           DFHEIV1,
 17918           SECURITY-MESSAGE,
 17919           DFHEIV11,
 17920           DFHEIV99,
 17921           DFHEIV99,
 17922           DFHEIV99,
 17923           DFHEIV99
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17925
 17926
 17927******************************************************************
 17928
 17929
 17930
 17931 9999-DFHBACK SECTION.
 17932     MOVE '9%                    "   ' TO DFHEIV0
 17933     MOVE 'EL131' TO DFHEIV1
 17934     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17935     GOBACK.
 17936 9999-DFHEXIT.
 17937     IF DFHEIGDJ EQUAL 0001
 17938         NEXT SENTENCE
 17939     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 336
* EL131.cbl
 17940         GO TO 8820-XCTL-ERROR,
 17941               8150-ENTERED-CLAIM-NOTFOUND,
 17942               9990-ABEND
 17943         DEPENDING ON DFHEIGDI
 17944     ELSE IF DFHEIGDJ EQUAL 3
 17945         GO TO 0130-TS-ERROR,
 17946               0130-TS-ERROR
 17947         DEPENDING ON DFHEIGDI
 17948     ELSE IF DFHEIGDJ EQUAL 4
 17949         GO TO 0600-CONTINUE-NAME-UPDATE
 17950         DEPENDING ON DFHEIGDI
 17951     ELSE IF DFHEIGDJ EQUAL 5
 17952         GO TO 1004-BENE-NOT-FOUND
 17953         DEPENDING ON DFHEIGDI
 17954     ELSE IF DFHEIGDJ EQUAL 6
 17955         GO TO 1052-DONE,
 17956               1052-DONE
 17957         DEPENDING ON DFHEIGDI
 17958     ELSE IF DFHEIGDJ EQUAL 7
 17959         GO TO 1120-CNTL-NOTFND
 17960         DEPENDING ON DFHEIGDI
 17961     ELSE IF DFHEIGDJ EQUAL 8
 17962         GO TO 1150-NOTOPEN-ERROR,
 17963               1150-EXIT
 17964         DEPENDING ON DFHEIGDI
 17965     ELSE IF DFHEIGDJ EQUAL 9
 17966         GO TO 1490-STATE-NOTFND
 17967         DEPENDING ON DFHEIGDI
 17968     ELSE IF DFHEIGDJ EQUAL 10
 17969         GO TO 1500-CARR-NOTFND
 17970         DEPENDING ON DFHEIGDI
 17971     ELSE IF DFHEIGDJ EQUAL 11
 17972         GO TO 1620-ACCT-NOTFND
 17973         DEPENDING ON DFHEIGDI
 17974     ELSE IF DFHEIGDJ EQUAL 12
 17975         GO TO 2020-EXIT
 17976         DEPENDING ON DFHEIGDI
 17977     ELSE IF DFHEIGDJ EQUAL 13
 17978         GO TO 2030-EXIT
 17979         DEPENDING ON DFHEIGDI
 17980     ELSE IF DFHEIGDJ EQUAL 14
 17981         GO TO 2040-EXIT
 17982         DEPENDING ON DFHEIGDI
 17983     ELSE IF DFHEIGDJ EQUAL 15
 17984         GO TO 2050-EXIT
 17985         DEPENDING ON DFHEIGDI
 17986     ELSE IF DFHEIGDJ EQUAL 16
 17987         GO TO 2060-CERT-NOTFND
 17988         DEPENDING ON DFHEIGDI
 17989     ELSE IF DFHEIGDJ EQUAL 17
 17990         GO TO 2060-DUPKEY
 17991         DEPENDING ON DFHEIGDI
 17992     ELSE IF DFHEIGDJ EQUAL 18
 17993         GO TO 2070-NOT-FOUND
 17994         DEPENDING ON DFHEIGDI
 17995     ELSE IF DFHEIGDJ EQUAL 19
 17996         GO TO 2070-EXIT
 17997         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 337
* EL131.cbl
 17998     ELSE IF DFHEIGDJ EQUAL 20
 17999         GO TO 2080-EXIT
 18000         DEPENDING ON DFHEIGDI
 18001     ELSE IF DFHEIGDJ EQUAL 21
 18002         GO TO 2400-TRLR-NOTFND,
 18003               2410-EXIT
 18004         DEPENDING ON DFHEIGDI
 18005     ELSE IF DFHEIGDJ EQUAL 22
 18006         GO TO 2425-NINETY-NOTFND,
 18007               2425-NINETY-NOTFND
 18008         DEPENDING ON DFHEIGDI
 18009     ELSE IF DFHEIGDJ EQUAL 23
 18010         GO TO 2430-EXIT,
 18011               2440-EXIT
 18012         DEPENDING ON DFHEIGDI
 18013     ELSE IF DFHEIGDJ EQUAL 24
 18014         GO TO 2440-EXIT
 18015         DEPENDING ON DFHEIGDI
 18016     ELSE IF DFHEIGDJ EQUAL 25
 18017         GO TO 2460-EXIT
 18018         DEPENDING ON DFHEIGDI
 18019     ELSE IF DFHEIGDJ EQUAL 26
 18020         GO TO 2475-EXIT
 18021         DEPENDING ON DFHEIGDI
 18022     ELSE IF DFHEIGDJ EQUAL 27
 18023         GO TO 2650-EXIT
 18024         DEPENDING ON DFHEIGDI
 18025     ELSE IF DFHEIGDJ EQUAL 28
 18026         GO TO 2800-EXIT,
 18027               2800-EXIT
 18028         DEPENDING ON DFHEIGDI
 18029     ELSE IF DFHEIGDJ EQUAL 29
 18030         GO TO 3010-DEL-ACTQ,
 18031               3040-EXIT
 18032         DEPENDING ON DFHEIGDI
 18033     ELSE IF DFHEIGDJ EQUAL 30
 18034         GO TO 3010-NO-ACTIVITY,
 18035               3050-EXIT
 18036         DEPENDING ON DFHEIGDI
 18037     ELSE IF DFHEIGDJ EQUAL 31
 18038         GO TO 3010-CERT-NOT-FOUND
 18039         DEPENDING ON DFHEIGDI
 18040     ELSE IF DFHEIGDJ EQUAL 32
 18041         GO TO 3020-EXIT
 18042         DEPENDING ON DFHEIGDI
 18043     ELSE IF DFHEIGDJ EQUAL 33
 18044         GO TO 3060-EXIT,
 18045               3060-EXIT
 18046         DEPENDING ON DFHEIGDI
 18047     ELSE IF DFHEIGDJ EQUAL 34
 18048         GO TO 5000-TRLR-NOT-FOUND
 18049         DEPENDING ON DFHEIGDI
 18050     ELSE IF DFHEIGDJ EQUAL 35
 18051         GO TO 5000-CERT-NOT-FOUND
 18052         DEPENDING ON DFHEIGDI
 18053     ELSE IF DFHEIGDJ EQUAL 36
 18054         GO TO 1052-DONE,
 18055               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:12 Page 338
* EL131.cbl
 18056         DEPENDING ON DFHEIGDI
 18057     ELSE IF DFHEIGDJ EQUAL 37
 18058         GO TO 7630-END-BROWSE
 18059         DEPENDING ON DFHEIGDI
 18060     ELSE IF DFHEIGDJ EQUAL 38
 18061         GO TO 7799-EXIT,
 18062               7799-EXIT
 18063         DEPENDING ON DFHEIGDI
 18064     ELSE IF DFHEIGDJ EQUAL 39
 18065         GO TO 7799-EXIT
 18066         DEPENDING ON DFHEIGDI
 18067     ELSE IF DFHEIGDJ EQUAL 40
 18068         GO TO 7800-NOT-FOUND
 18069         DEPENDING ON DFHEIGDI
 18070     ELSE IF DFHEIGDJ EQUAL 41
 18071         GO TO 8000-NOTE-NOT-FOUND
 18072         DEPENDING ON DFHEIGDI
 18073     ELSE IF DFHEIGDJ EQUAL 42
 18074         GO TO 8990-SEND-TEXT
 18075         DEPENDING ON DFHEIGDI.
 18076     MOVE '9%                    "   ' TO DFHEIV0
 18077     MOVE 'EL131' TO DFHEIV1
 18078     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18079     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14268     Code:       63186
