* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30 environment division.
    31 INPUT-OUTPUT SECTION.
    32 FILE-CONTROL.
    33 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    34    FILE STATUS IS WRITTEN-STATUS
    35                            ORGANIZATION IS LINE SEQUENTIAL.
    36 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    37    FILE STATUS IS WRITRPT-STATUS
    38                            ORGANIZATION IS LINE SEQUENTIAL.
    39 data division.
    40 FILE SECTION.
    41 FD  CPS-WRITTEN-IN
    42     BLOCK CONTAINS 0
    43     RECORDING MODE F.
    44 01  CPS-WRITTEN-IN-REC          pic x(200).
    45 FD  CPS-WRITTEN-RPT
    46     BLOCK CONTAINS 0
    47     RECORDING MODE F.
    48 01  CPS-WRITTEN-RPT-REC         pic x(132).
    49 working-storage section.
    50 01  DFH-START PIC X(04).
    51 77  ws-process-sw               pic x value ' '.
    52     88  process-cashed            value 'C'.
    53     88  process-written           value 'W'.
    54 77  ws-writ-cnt                 pic 9(5) value zeros.
    55 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    56 77  s1                          pic s999 comp-3 value +0.
    57 77  s2                          pic s999 comp-3 value +0.
    58 77  i1                          pic s999 comp-3 value +0.
    59 77  o1                          pic s999 comp-3 value +0.
    60 77  ws-bin-cashed-dt            pic xx  value low-values.
    61 77  ws-bin-check-dt             pic xx  value low-values.
    62 77  ws-page-cntr                pic 999  value zeros.
    63 77  ws-line-cntr                pic 999  value 070.
    64 77  ws-max-lines                pic 999  value 060.
    65 77  ws-erchek-sw                pic x    value spaces.
    66     88  erchek-found              value 'Y'.
    67 77  ws-table-sw                 pic x    value spaces.
    68     88  table-found               value 'Y'.
    69 77  ws-continue-sw              pic x  value 'Y'.
    70     88  ok-to-continue            value 'Y'.
    71     88  not-ok-to-continue        value 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   3
* EL201.cbl
    72 77  ws-in-recs                  pic 9(5) value zeros.
    73 77  ws-eof-sw                   pic x  value spaces.
    74     88  end-of-input                  value 'Y'.
    75 77  ws-sql-code                 pic s9(7) value zeros.
    76 77  ws-dis-sql-code             pic -9999999 value zeros.
    77 01  ws-written-in.
    78     05  ws-writ-in-dir          pic x(15)  value
    79         '/data/seqfiles/'.
    80*    05  ws-writ-in-dir          pic x(26)  value
    81*        '/data/test/mdoff/seqfiles/'.
    82     05  ws-writ-in-name         pic x(16) value
    83         'miscpymts.csv   '.
    84 01  ws-written-rpt.
    85     05  ws-writ-rpt-dir         pic x(15)  value
    86         '/data/seqfiles/'.
    87*    05  ws-writ-rpt-dir         pic x(26)  value
    88*        '/data/test/mdoff/seqfiles/'.
    89     05  ws-writ-rpt-comp-id     pic xxx  value spaces.
    90     05  ws-writ-rpt-name        pic x(13) value
    91         'miscpymts.rpt'.
*   92 EXEC SQL
*   93    INCLUDE SQLDA
*   94 END-EXEC
    95 01 SQLDA sync.
    96    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    97    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    98    05 SQLN                  PIC S9(4) COMP-5 value 0.
    99    05 SQLD                  PIC S9(4) COMP-5 value 0.
   100    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   101       10 SQLTYPE            PIC S9(4) COMP-5.
   102       10 SQLLEN             PIC S9(4) COMP-5.
   103$IF P64 SET
   104X      *> For 64-bit environments, ensure that SQLDATA is
   105X      *> aligned on an 8-byte boundary.
   106X      10 FILLER             PIC S9(9) COMP-5.
   107$END
   108       10 SQLDATA            USAGE POINTER.
   109       10 SQLIND             USAGE POINTER.
   110       10 SQLNAME.
   111          15 SQLNAMEL        PIC S9(4) COMP-5.
   112          15 SQLNAMEC        PIC X(30).
   113
   114* Values for SQLTYPE
   115
   116 78  ESQL-DATE-CHAR              VALUE 384.
   117 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   118 78  ESQL-DATE-REC               VALUE 386.
   119 78  ESQL-DATE-REC-NULL          VALUE 387.
   120 78  ESQL-TIME-CHAR              VALUE 388.
   121 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   122 78  ESQL-TIME-REC               VALUE 390.
   123 78  ESQL-TIME-REC-NULL          VALUE 391.
   124 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   125 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   126 78  ESQL-TIMESTAMP-REC          VALUE 394.
   127 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   128 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   129 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TS-OFFSET-REC          VALUE 398.
   131 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   132 78  ESQL-LONGVARBINARY          VALUE 404.
   133 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   134 78  ESQL-LONGVARCHAR            VALUE 408.
   135 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   136 78  ESQL-BINARY                 VALUE 444.
   137 78  ESQL-BINARY-NULL            VALUE 445.
   138 78  ESQL-VARBINARY              VALUE 446.
   139 78  ESQL-VARBINARY-NULL         VALUE 447.
   140 78  ESQL-VARCHAR                VALUE 448.
   141 78  ESQL-VARCHAR-NULL           VALUE 449.
   142
   143 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   144 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   145
   146 78  ESQL-CHAR                   VALUE 452.
   147 78  ESQL-CHAR-NULL              VALUE 453.
   148
   149 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   150 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   151
   152 78  ESQL-DOUBLE                 VALUE 480.
   153 78  ESQL-DOUBLE-NULL            VALUE 481.
   154 78  ESQL-REAL                   VALUE 482.
   155 78  ESQL-REAL-NULL              VALUE 483.
   156 78  ESQL-DECIMAL                VALUE 484.
   157 78  ESQL-DECIMAL-NULL           VALUE 485.
   158 78  ESQL-INTEGER                VALUE 496.
   159 78  ESQL-INTEGER-NULL           VALUE 497.
   160 78  ESQL-SMALLINT               VALUE 500.
   161 78  ESQL-SMALLINT-NULL          VALUE 501.
   162 78  ESQL-TINYINT                VALUE 502.
   163 78  ESQL-TINYINT-NULL           VALUE 503.
*  164 EXEC SQL
*  165    INCLUDE SQLCA
*  166 END-EXEC
   167 01 SQLCA.
   168     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   169     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   170     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   171     05  SQLERRM.
   172         49  SQLERRML    PIC S9(4) COMP-5.
   173         49  SQLERRMC    PIC X(70).
   174     05  SQLERRP         PIC X(8).
   175     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   176     05  SQLWARN.
   177         10  SQLWARN0    PIC X.
   178         10  SQLWARN1    PIC X.
   179         10  SQLWARN2    PIC X.
   180         10  SQLWARN3    PIC X.
   181         10  SQLWARN4    PIC X.
   182         10  SQLWARN5    PIC X.
   183         10  SQLWARN6    PIC X.
   184         10  SQLWARN7    PIC X.
   185     05  SQLEXT.
   186         10  SQLWARN8    PIC X.
   187         10  SQLWARN9    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN10   PIC X.
   189         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   190     05  SQLSTATE    PIC X(5).
   191 EXEC SQL
   192    BEGIN DECLARE SECTION
   193 END-EXEC
   194 01  ws-key-stuff.
   195     05  ws-check-key            pic 9(7).
   196     05  ws-check-no             pic x(7).
   197     05  ws-compid               pic xxx.
   198     05  ws-carrier              pic x.
   199     05  ws-grouping             pic x(6).
   200     05  ws-state                pic xx.
   201     05  ws-account              pic x(10).
   202     05  ws-eff-date             pic x(10).
   203     05  ws-certificate          pic x(10).
   204     05  ws-cert-sfx             pic x.
   205     05  ws-seq-no               pic 999.
   206     05  ws-type                 pic 999.
   207 01  sqlcmd                      pic x(1024).
   208 01  WS-MOE-DATE                 pic x(10).
   209 01  svr                         pic x(32).
   210 01  usr                         pic x(32).
   211 01  pass                        pic x(32).
   212 01  usr-pass                    pic x(64).
   213 01  ws-disp-code                pic s9(11).
   214***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   215***                                                            ***
   216***  These indicators are used to determine if a variable      ***
   217***  is passed nulls from sql. The indicator will be -1        ***
   218***  if the value on sql is nulls and +0 if the value is       ***
   219***  something other than nulls. Here is an example on how     ***
   220***  to use the indicator variables.                           ***
   221***                                                            ***
   222***     EXEC SQL                                               ***
   223***        fetch checkapp into                                 ***
   224***           :db-app-status :nu-app-status,                   ***
   225***           :db-app-by     :nu-app-by,                       ***
   226***           :db-app-date   :nu-app-date,                     ***
   227***           :db-app-batch  :nu-app-batch                     ***
   228***     END-EXEC                                               ***
   229***                                                            ***
   230***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   231 01  indicator-vaiables-for-nulls.
   232     05  nu-app-status           pic s9(4) comp value +0.
   233     05  nu-app-by               pic s9(4) comp value +0.
   234     05  nu-app-date             pic s9(4) comp value +0.
   235     05  nu-app-batch            pic s9(4) comp value +0.
   236     05  nu-fincar               pic s9(4) comp value +0.
   237     05  nu-checkno              pic s9(4) comp value +0.
   238 01  daily-check-request-rec.
   239     05  db-checkkey             pic x(7).
   240     05  db-compid               pic xxx.
   241     05  db-carrier              pic x.
   242     05  db-grouping             pic x(6).
   243     05  db-state                pic xx.
   244     05  db-account              pic x(10).
   245     05  db-effdate              pic x(24).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   6
* EL201.cbl
   246     05  db-certificate          pic x(10).
   247     05  db-cert-sfx             pic x.
   248     05  db-seq-no               pic x(7).
   249     05  db-type                 pic x(7).
   250     05  db-amount               pic x(10).
   251     05  db-amount-n redefines
   252         db-amount               pic 9(7).99.
   253     05  db-checkno              pic x(15).
   254     05  db-checkdate            pic x(10).
   255     05  db-checkstatus          pic 9(5).
   256     05  db-releasebatch         pic 9(5).
   257     05  db-releasedt            pic x(10).
   258     05  db-releaseby            pic x(4).
   259     05  db-payeename1           pic x(30).
   260     05  db-payeename2           pic x(30).
   261     05  db-payeeaddr1           pic x(30).
   262     05  db-payeeaddr2           pic x(30).
   263     05  db-payeecity            pic x(30).
   264     05  db-payeest              pic xx.
   265     05  db-payeezip             pic x(10).
   266     05  db-fincar               pic x.
   267     05  db-fingrp               pic x(6).
   268     05  db-finresp              pic x(10).
   269     05  db-finacct              pic x(10).
   270     05  db-preparer             pic x(4).
   271     05  db-app-status           pic x(9).
   272     05  dp-app-status-n redefines db-app-status
   273                                 pic 9(9).
   274     05  db-app-by               pic x(20).
   275     05  db-app-date             pic x(30).
   276     05  db-app-batch            pic x(10).
   277     05  db-return-to            pic x(30).
   278 EXEC SQL
   279    END DECLARE SECTION
   280 END-EXEC
   281 01  FILE-KEYS.
   282     12  ELCNTL-KEY.
   283         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   284         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   285         16 ELCNTL-ACCESS.
   286             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   287             20  FILLER              PIC X       VALUE SPACES.
   288             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   289         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   290 01  f.
   291     05  ws-connect-sw               pic x  value ' '.
   292         88  connected-to-db             value 'Y'.
   293     05  written-status          pic xx.
   294     05  writrpt-status          pic xx.
   295     05  ws-comp-id              pic xxx.
   296     05  ws-comp-cd              pic x.
   297 01  ws-raw-record.
   298     05  raw-check-no            pic x(20).
   299     05  raw-check-dt            pic x(20).
   300     05  raw-check-amt           pic x(15).
   301     05  raw-vendor-id           pic x(20).
   302     05  raw-user-defined        pic x(30).
   303     05  raw-voucher-ref         pic x(35).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   7
* EL201.cbl
   304 01  ws-written-rec.
   305     05  wsw-check-no            pic x(20).
   306     05  wsw-check-dt            pic x(20).
   307     05  wsw-check-amt           pic x(15).
   308     05  wsw-vendor-id           pic x(20).
   309     05  wsw-user-defined        pic x(30).
   310     05  wsw-voucher-ref         pic x(35).
   311 01  filler.
   312     05  wsw-check-key           pic x(7).
   313     05  wsw-check-key-num redefines wsw-check-key
   314                                 pic 9(7).
   315 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   316     88  RESP-NORMAL                    VALUE +0.
   317     88  resp-file-notfnd               value +12.
   318     88  RESP-NOTFND                    VALUE +13.
   319     88  resp-duprec                    value +14.
   320     88  resp-dupkey                    value +15.
   321     88  resp-invreq                    value +16.
   322     88  RESP-NOTOPEN                   VALUE +19.
   323     88  RESP-ENDFILE                   VALUE +20.
   324     88  resp-lengtherr                 value +22.
   325 01  ws-work-amt-alpha           pic x(10).
   326 01  ws-work-amt-num redefines ws-work-amt-alpha
   327                                 pic 9(8)v99.
   328 01  ws-qry-string               pic x(80) value spaces.
   329 01  ws-qrystr-len               pic s9(8) comp value +60.
   330 01  ws-seq-alpha                pic x(5).
   331 01  ws-seq-no-num redefines ws-seq-alpha
   332                                 pic 9(5).
   333*                                copy ERCCHEK.
   334******************************************************************
   335*                                                                *
   336*                                                                *
   337*                            ERCCHEK                             *
   338*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   339*                            VMOD=2.008                          *
   340*                                                                *
   341*   FILE DESCRIPTION = CHECK RECORDS                             *
   342*                                                                *
   343*   FILE TYPE = VSAM,KSDS                                        *
   344*   RECORD SIZE = 600    RECFORM = FIXED                         *
   345*                                                                *
   346*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   347*       ALTERNATE INDEX = NONE                                   *
   348*                                                                *
   349*   LOG = YES                                                    *
   350*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   351******************************************************************
   352*                   C H A N G E   L O G
   353*
   354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   355*-----------------------------------------------------------------
   356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   357* EFFECTIVE    NUMBER
   358*-----------------------------------------------------------------
   359* 021414    2003053000001  PEMA  changes for auto chk request
   360******************************************************************
   361 01  CHECK-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   8
* EL201.cbl
   362     12  CH-RECORD-ID                      PIC XX.
   363         88  VALID-CH-ID                      VALUE 'CH'.
   364
   365     12  CH-CONTROL-PRIMARY.
   366         16  CH-COMPANY-CD                 PIC X.
   367         16  CH-CARRIER                    PIC X.
   368         16  CH-GROUPING                   PIC X(6).
   369         16  CH-STATE                      PIC XX.
   370         16  CH-ACCOUNT                    PIC X(10).
   371         16  CH-CERT-EFF-DT                PIC XX.
   372         16  CH-CERT-NO.
   373             20  CH-CERT-PRIME             PIC X(10).
   374             20  CH-CERT-SFX               PIC X.
   375         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   376
   377     12  CH-RECORDED-DT                    PIC XX.
   378     12  CH-RECORDED-BY                    PIC X(4).
   379     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   380
   381     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   382     12  CH-CHECK-NO                       PIC X(7).
   383     12  CH-REASON-FOR-CHECK               PIC X(25).
   384     12  CH-CHECK-WRITTEN-DT               PIC XX.
   385     12  FILLER                            PIC X.
   386
   387     12  CH-PAYEE-INFO.
   388         16  CH-PAYEE-NAME-1               PIC X(30).
   389         16  CH-PAYEE-NAME-2               PIC X(30).
   390         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   391         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   392         16  CH-PAYEE-CITY-ST.
   393             20  CH-PAYEE-CITY             PIC X(28).
   394             20  CH-PAYEE-STATE            PIC XX.
   395         16  CH-PAYEE-ZIP-CODE.
   396             20  CH-PAYEE-ZIP.
   397                 24  CH-ZIP-PRI-1ST        PIC X.
   398                     88  CH-CANADIAN-POST-CODE
   399                                           VALUES 'A' THRU 'Z'.
   400                 24  FILLER                PIC X(4).
   401             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   402         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   403             20  CH-CAN-POSTAL-1           PIC XXX.
   404             20  CH-CAN-POSTAL-2           PIC XXX.
   405             20  FILLER                    PIC XXX.
   406
   407     12  CH-CHECK-STUB-TEXT.
   408         16  CH-STUB-LINE-1                PIC X(30).
   409         16  CH-TEXT-LINE-1                PIC X(50).
   410         16  CH-TEXT-LINE-2                PIC X(50).
   411         16  CH-TEXT-LINE-3                PIC X(40).
   412     12  CH-RETURN-TO                      PIC X(30).
   413
   414     12  CH-COMPENSATION-CONTROL.
   415         16  CH-COMP-CARRIER               PIC X.
   416         16  CH-COMP-GROUPING              PIC X(6).
   417         16  CH-COMP-FIN-RESP              PIC X(10).
   418         16  CH-COMP-ACCOUNT               PIC X(10).
   419
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page   9
* EL201.cbl
   420     12  CH-CREDIT-SELECT-DT               PIC XX.
   421     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   422     12  CH-PAYEE-CODE                     PIC X(6).
   423
   424     12  CH-VOID-DATA.
   425         20  CH-VOID-DT                    PIC XX.
   426         20  CH-VOID-BY                    PIC X(4).
   427         20  CH-VOID-REASON                PIC X(25).
   428
   429     12  CH-APPROVAL-DATA.
   430         20  CH-APPROVAL-DT                PIC XX.
   431         20  CH-APPROVAL-STATUS            PIC X.
   432             88  CH-IN-LIMBO                  VALUE ' '.
   433             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   434             88  CH-APPROVED                  VALUE 'A'.
   435             88  CH-DENIED                    VALUE 'D'.
   436         20  CH-APPROVED-BY                PIC XXXX.
   437     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   438             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   439     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   440
   441     12  ch-released-dt                    pic xx.
   442     12  ch-check-cashed-dt                pic xx.
   443     12  FILLER                            PIC X.
   444*    12  CH-CHECK-REFERENCE                PIC X(12).
   445     12  CH-CHECK-ORIGIN-SW                PIC X.
   446             88  CH-REFUND-CHECK              VALUE 'R'.
   447             88  CH-MAINT-CHECK               VALUE 'M'.
   448
   449     12  CH-CANC-DT                        PIC XX.
   450     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   451     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   452
   453     12  CH-INSURED-NAME                   PIC X(28).
   454
   455     12  ch-released-by                    pic x(4).
   456     12  ch-csr                            pic x(4).
   457     12  ch-deduct-commission              pic x.
   458         88  ch-deduct-comm                  value 'Y'.
   459         88  ch-do-not-deduct-comm           value 'N'.
   460
   461     12  FILLER                            PIC X(11).
   462*    12  CH-LETTER-TABLE.
   463*        16  CH-LETTERS OCCURS 3 TIMES
   464*                       INDEXED BY CH-LT-NDX
   465*                                          PIC X(04).
   466
   467     12  FILLER                            PIC X(07).
   468
   469*                                copy ELCFUNDT.
   470*****************************************************************
   471*                                                               *
   472*                            ELCFUNDT.                          *
   473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   474*                            VMOD=2.001                         *
   475*                                                               *
   476*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   477*                                                               *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  10
* EL201.cbl
   478*****************************************************************
   479
   480
   481 01  FUNCTION-DATE.
   482     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   483     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   484         10  WS-FN-CCYR            PIC 9(4).
   485         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   486             15  WS-FN-CC          PIC 99.
   487             15  WS-FN-YR          PIC 99.
   488         10  WS-FN-MO              PIC 99.
   489         10  WS-FN-DA              PIC 99.
   490     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   491     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   492     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   493     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   494     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   495         88  WS-BEHIND-GMT                     VALUE '-'.
   496         88  WS-AFTER-GMT                      VALUE '+'.
   497         88  WS-NO-GMT                         VALUE ZERO.
   498     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   499     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   500*                                COPY ELCDATE.
   501******************************************************************
   502*                                                                *
   503*                                                                *
   504*                            ELCDATE.                            *
   505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   506*                            VMOD=2.003
   507*                                                                *
   508*                                                                *
   509*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   510*                 LENGTH = 200                                   *
   511******************************************************************
   512
   513 01  DATE-CONVERSION-DATA.
   514     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   515     12  DC-OPTION-CODE                PIC X.
   516         88  BIN-TO-GREG                VALUE ' '.
   517         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   518         88  EDIT-GREG-TO-BIN           VALUE '2'.
   519         88  YMD-GREG-TO-BIN            VALUE '3'.
   520         88  MDY-GREG-TO-BIN            VALUE '4'.
   521         88  JULIAN-TO-BIN              VALUE '5'.
   522         88  BIN-PLUS-ELAPSED           VALUE '6'.
   523         88  FIND-CENTURY               VALUE '7'.
   524         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   525         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   526         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   527         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   528         88  JULIAN-TO-BIN-3            VALUE 'C'.
   529         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   530         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   531         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   532         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   533         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   534         88  CHECK-LEAP-YEAR            VALUE 'H'.
   535         88  BIN-3-TO-GREG              VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  11
* EL201.cbl
   536         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   537         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   538         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   539         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   540         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   541         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   542         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   543         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   544         88  THREE-CHARACTER-BIN
   545                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   546         88  GREGORIAN-TO-BIN
   547                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   548         88  BIN-TO-GREGORIAN
   549                  VALUES ' ' '1' 'I' '8' 'G'.
   550         88  JULIAN-TO-BINARY
   551                  VALUES '5' 'C' 'E' 'F'.
   552     12  DC-ERROR-CODE                 PIC X.
   553         88  NO-CONVERSION-ERROR        VALUE ' '.
   554         88  DATE-CONVERSION-ERROR
   555                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   556         88  DATE-IS-ZERO               VALUE '1'.
   557         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   558         88  DATE-IS-INVALID            VALUE '3'.
   559         88  DATE1-GREATER-DATE2        VALUE '4'.
   560         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   561         88  DATE-INVALID-OPTION        VALUE '9'.
   562         88  INVALID-CENTURY            VALUE 'A'.
   563         88  ONLY-CENTURY               VALUE 'B'.
   564         88  ONLY-LEAP-YEAR             VALUE 'C'.
   565         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   566     12  DC-END-OF-MONTH               PIC X.
   567         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   568     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   569         88  USE-NORMAL-PROCESS         VALUE ' '.
   570         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   571         88  ADJUST-UP-100-YRS          VALUE '2'.
   572     12  FILLER                        PIC X.
   573     12  DC-CONVERSION-DATES.
   574         16  DC-BIN-DATE-1             PIC XX.
   575         16  DC-BIN-DATE-2             PIC XX.
   576         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   577         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   578                       DC-GREG-DATE-1-EDIT.
   579             20  DC-EDIT1-MONTH        PIC 99.
   580             20  SLASH1-1              PIC X.
   581             20  DC-EDIT1-DAY          PIC 99.
   582             20  SLASH1-2              PIC X.
   583             20  DC-EDIT1-YEAR         PIC 99.
   584         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   585         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   586                     DC-GREG-DATE-2-EDIT.
   587             20  DC-EDIT2-MONTH        PIC 99.
   588             20  SLASH2-1              PIC X.
   589             20  DC-EDIT2-DAY          PIC 99.
   590             20  SLASH2-2              PIC X.
   591             20  DC-EDIT2-YEAR         PIC 99.
   592         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   593         16  DC-GREG-DATE-1-YMD-R  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  12
* EL201.cbl
   594                     DC-GREG-DATE-1-YMD.
   595             20  DC-YMD-YEAR           PIC 99.
   596             20  DC-YMD-MONTH          PIC 99.
   597             20  DC-YMD-DAY            PIC 99.
   598         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   599         16  DC-GREG-DATE-1-MDY-R REDEFINES
   600                      DC-GREG-DATE-1-MDY.
   601             20  DC-MDY-MONTH          PIC 99.
   602             20  DC-MDY-DAY            PIC 99.
   603             20  DC-MDY-YEAR           PIC 99.
   604         16  DC-GREG-DATE-1-ALPHA.
   605             20  DC-ALPHA-MONTH        PIC X(10).
   606             20  DC-ALPHA-DAY          PIC 99.
   607             20  FILLER                PIC XX.
   608             20  DC-ALPHA-CENTURY.
   609                 24 DC-ALPHA-CEN-N     PIC 99.
   610             20  DC-ALPHA-YEAR         PIC 99.
   611         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   612         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   613         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   614         16  DC-JULIAN-DATE            PIC 9(05).
   615         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   616                                       PIC 9(05).
   617         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   618             20  DC-JULIAN-YEAR        PIC 99.
   619             20  DC-JULIAN-DAYS        PIC 999.
   620         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   621         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   622         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   623     12  DATE-CONVERSION-VARIBLES.
   624         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   625         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   626             20  FILLER                PIC 9(3).
   627             20  HOLD-CEN-1-CCYY.
   628                 24  HOLD-CEN-1-CC     PIC 99.
   629                 24  HOLD-CEN-1-YY     PIC 99.
   630             20  HOLD-CEN-1-MO         PIC 99.
   631             20  HOLD-CEN-1-DA         PIC 99.
   632         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   633             20  HOLD-CEN-1-R-MO       PIC 99.
   634             20  HOLD-CEN-1-R-DA       PIC 99.
   635             20  HOLD-CEN-1-R-CCYY.
   636                 24  HOLD-CEN-1-R-CC   PIC 99.
   637                 24  HOLD-CEN-1-R-YY   PIC 99.
   638             20  FILLER                PIC 9(3).
   639         16  HOLD-CENTURY-1-X.
   640             20  FILLER                PIC X(3)  VALUE SPACES.
   641             20  HOLD-CEN-1-X-CCYY.
   642                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   643                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   644             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   645             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   646         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   647             20  HOLD-CEN-1-R-X-MO     PIC XX.
   648             20  HOLD-CEN-1-R-X-DA     PIC XX.
   649             20  HOLD-CEN-1-R-X-CCYY.
   650                 24  HOLD-CEN-1-R-X-CC PIC XX.
   651                 24  HOLD-CEN-1-R-X-YY PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  13
* EL201.cbl
   652             20  FILLER                PIC XXX.
   653         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   654         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   655         16  DC-JULIAN-DATE-1          PIC 9(07).
   656         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   657             20  DC-JULIAN-1-CCYY.
   658                 24  DC-JULIAN-1-CC    PIC 99.
   659                 24  DC-JULIAN-1-YR    PIC 99.
   660             20  DC-JULIAN-DA-1        PIC 999.
   661         16  DC-JULIAN-DATE-2          PIC 9(07).
   662         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   663             20  DC-JULIAN-2-CCYY.
   664                 24  DC-JULIAN-2-CC    PIC 99.
   665                 24  DC-JULIAN-2-YR    PIC 99.
   666             20  DC-JULIAN-DA-2        PIC 999.
   667         16  DC-GREG-DATE-A-EDIT.
   668             20  DC-EDITA-MONTH        PIC 99.
   669             20  SLASHA-1              PIC X VALUE '/'.
   670             20  DC-EDITA-DAY          PIC 99.
   671             20  SLASHA-2              PIC X VALUE '/'.
   672             20  DC-EDITA-CCYY.
   673                 24  DC-EDITA-CENT     PIC 99.
   674                 24  DC-EDITA-YEAR     PIC 99.
   675         16  DC-GREG-DATE-B-EDIT.
   676             20  DC-EDITB-MONTH        PIC 99.
   677             20  SLASHB-1              PIC X VALUE '/'.
   678             20  DC-EDITB-DAY          PIC 99.
   679             20  SLASHB-2              PIC X VALUE '/'.
   680             20  DC-EDITB-CCYY.
   681                 24  DC-EDITB-CENT     PIC 99.
   682                 24  DC-EDITB-YEAR     PIC 99.
   683         16  DC-GREG-DATE-CYMD         PIC 9(08).
   684         16  DC-GREG-DATE-CYMD-R REDEFINES
   685                              DC-GREG-DATE-CYMD.
   686             20  DC-CYMD-CEN           PIC 99.
   687             20  DC-CYMD-YEAR          PIC 99.
   688             20  DC-CYMD-MONTH         PIC 99.
   689             20  DC-CYMD-DAY           PIC 99.
   690         16  DC-GREG-DATE-MDCY         PIC 9(08).
   691         16  DC-GREG-DATE-MDCY-R REDEFINES
   692                              DC-GREG-DATE-MDCY.
   693             20  DC-MDCY-MONTH         PIC 99.
   694             20  DC-MDCY-DAY           PIC 99.
   695             20  DC-MDCY-CEN           PIC 99.
   696             20  DC-MDCY-YEAR          PIC 99.
   697    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   698        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   699    12  DC-EL310-DATE                  PIC X(21).
   700    12  FILLER                         PIC X(28).
   701*                                COPY ELCCNTL.
   702******************************************************************
   703*                                                                *
   704*                                                                *
   705*                            ELCCNTL.                            *
   706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   707*                            VMOD=2.059                          *
   708*                                                                *
   709*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  14
* EL201.cbl
   710*                                                                *
   711*   FILE TYPE = VSAM,KSDS                                        *
   712*   RECORD SIZE = 750  RECFORM = FIXED                           *
   713*                                                                *
   714*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   715*       ALTERNATE INDEX = NONE                                   *
   716*                                                                *
   717*   LOG = YES                                                    *
   718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   719******************************************************************
   720*                   C H A N G E   L O G
   721*
   722* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   723*-----------------------------------------------------------------
   724*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   725* EFFECTIVE    NUMBER
   726*-----------------------------------------------------------------
   727* 082503                   PEMA  ADD BENEFIT GROUP
   728* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   729* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   730* 092705    2005050300006  PEMA  ADD SPP LEASES
   731* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   732* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   733* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   734* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   735* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   736* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   737* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   738* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   739* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   740* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   741******************************************************************
   742*
   743 01  CONTROL-FILE.
   744     12  CF-RECORD-ID                       PIC XX.
   745         88  VALID-CF-ID                        VALUE 'CF'.
   746
   747     12  CF-CONTROL-PRIMARY.
   748         16  CF-COMPANY-ID                  PIC XXX.
   749         16  CF-RECORD-TYPE                 PIC X.
   750             88  CF-COMPANY-MASTER              VALUE '1'.
   751             88  CF-PROCESSOR-MASTER            VALUE '2'.
   752             88  CF-STATE-MASTER                VALUE '3'.
   753             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   754             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   755             88  CF-CARRIER-MASTER              VALUE '6'.
   756             88  CF-MORTALITY-MASTER            VALUE '7'.
   757             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   758             88  CF-TERMINAL-MASTER             VALUE '9'.
   759             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   760             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   761             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   762             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   763             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   764             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   765             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   766             88  CF-REMINDERS-MASTER            VALUE 'R'.
   767             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  15
* EL201.cbl
   768         16  CF-ACCESS-CD-GENL              PIC X(4).
   769         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   770             20  CF-PROCESSOR               PIC X(4).
   771         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   772             20  CF-STATE-CODE              PIC XX.
   773             20  FILLER                     PIC XX.
   774         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   775             20  FILLER                     PIC XX.
   776             20  CF-HI-BEN-IN-REC           PIC XX.
   777         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   778             20  FILLER                     PIC XXX.
   779             20  CF-CARRIER-CNTL            PIC X.
   780         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   781             20  FILLER                     PIC XX.
   782             20  CF-HI-TYPE-IN-REC          PIC 99.
   783         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   784             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   785                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   786             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   787             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   788         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   789             20  FILLER                     PIC X.
   790             20  CF-CUSTOM-REPORT-NO        PIC 999.
   791         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   792             20  FILLER                     PIC XX.
   793             20  CF-MORTGAGE-PLAN           PIC XX.
   794         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   795
   796     12  CF-LAST-MAINT-DT                   PIC XX.
   797     12  CF-LAST-MAINT-BY                   PIC X(4).
   798     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   799
   800     12  CF-RECORD-BODY                     PIC X(728).
   801
   802
   803****************************************************************
   804*             COMPANY MASTER RECORD                            *
   805****************************************************************
   806
   807     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   808         16  CF-COMPANY-ADDRESS.
   809             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   810             20  CF-CL-IN-CARE-OF           PIC X(30).
   811             20  CF-CL-ADDR-LINE-1          PIC X(30).
   812             20  CF-CL-ADDR-LINE-2          PIC X(30).
   813             20  CF-CL-CITY-STATE           PIC X(30).
   814             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   815             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   816         16  CF-COMPANY-CD                  PIC X.
   817         16  CF-COMPANY-PASSWORD            PIC X(8).
   818         16  CF-SECURITY-OPTION             PIC X.
   819             88  ALL-SECURITY                   VALUE '1'.
   820             88  COMPANY-VERIFY                 VALUE '2'.
   821             88  PROCESSOR-VERIFY               VALUE '3'.
   822             88  NO-SECURITY                    VALUE '4'.
   823             88  ALL-BUT-TERM                   VALUE '5'.
   824         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   825             88  USE-ACTUAL-CARRIER             VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  16
* EL201.cbl
   826         16  CF-LGX-INTERFACE-CNTL          PIC X.
   827             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   828         16  CF-INFORCE-LOCATION            PIC X.
   829             88  CERTS-ARE-ONLINE               VALUE '1'.
   830             88  CERTS-ARE-OFFLINE              VALUE '2'.
   831             88  NO-CERTS-AVAILABLE             VALUE '3'.
   832         16  CF-LOWER-CASE-LETTERS          PIC X.
   833         16  CF-CERT-ACCESS-CONTROL         PIC X.
   834             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   835             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   836             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   837             88  CF-ACCNT-CNTL                  VALUE '3'.
   838             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   839
   840         16  CF-FORMS-PRINTER-ID            PIC X(4).
   841         16  CF-CHECK-PRINTER-ID            PIC X(4).
   842
   843         16  CF-LGX-CREDIT-USER             PIC X.
   844             88  CO-IS-NOT-USER                 VALUE 'N'.
   845             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   846
   847         16 CF-CREDIT-CALC-CODES.
   848             20  CF-CR-REM-TERM-CALC PIC X.
   849               88  CR-EARN-AFTER-15TH           VALUE '1'.
   850               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   851               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   852               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   853               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   854               88  CR-EARN-AFTER-14TH           VALUE '6'.
   855               88  CR-EARN-AFTER-16TH           VALUE '7'.
   856             20  CF-CR-R78-METHOD           PIC X.
   857               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   858               88  DONT-USE-PLUS-ONE            VALUE '1'.
   859
   860         16  CF-CLAIM-CONTROL-COUNTS.
   861             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   862                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   863
   864             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   865                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   866
   867             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   868                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   869
   870             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   871                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   872
   873         16  CF-CURRENT-MONTH-END           PIC XX.
   874
   875         16  CF-CO-CALC-QUOTE-TOLERANCE.
   876             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   877             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   878             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   879             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   880                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   881                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   882             20  CF-CO-PREM-REJECT-SW       PIC X.
   883                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  17
* EL201.cbl
   884                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   885             20  CF-CO-REF-REJECT-SW        PIC X.
   886                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   887                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   888
   889         16  CF-CO-REPORTING-DT             PIC XX.
   890         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   891         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   892           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   893           88  CF-CO-MONTH-END                  VALUE '1'.
   894
   895         16  CF-LGX-CLAIM-USER              PIC X.
   896             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   897             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   898
   899         16  CF-CREDIT-EDIT-CONTROLS.
   900             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   901             20  CF-MIN-AGE                 PIC 99.
   902             20  CF-DEFAULT-AGE             PIC 99.
   903             20  CF-MIN-TERM                PIC S999      COMP-3.
   904             20  CF-MAX-TERM                PIC S999      COMP-3.
   905             20  CF-DEFAULT-SEX             PIC X.
   906             20  CF-JOINT-AGE-INPUT         PIC X.
   907                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   908             20  CF-BIRTH-DATE-INPUT        PIC X.
   909                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   910             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   911                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   912                 88  CF-ZERO-CARRIER            VALUE '1'.
   913                 88  CF-ZERO-GROUPING           VALUE '2'.
   914                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   915             20  CF-EDIT-SW                 PIC X.
   916                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   917             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   918             20  CF-CR-PR-METHOD            PIC X.
   919               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   920               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   921             20  FILLER                     PIC X.
   922
   923         16  CF-CREDIT-MISC-CONTROLS.
   924             20  CF-REIN-TABLE-SW           PIC X.
   925                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   926             20  CF-COMP-TABLE-SW           PIC X.
   927                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   928             20  CF-EXPERIENCE-RETENTION-AGE
   929                                            PIC S9        COMP-3.
   930             20  CF-CONVERSION-DT           PIC XX.
   931             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   932             20  CF-RUN-FREQUENCY-SW        PIC X.
   933                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   934                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   935
   936             20  CF-CR-CHECK-NO-CONTROL.
   937                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   938                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   939                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   940                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   941                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  18
* EL201.cbl
   942                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   943
   944                 24  CF-CR-CHECK-COUNT       REDEFINES
   945                     CF-CR-CHECK-COUNTER      PIC X(4).
   946
   947                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   948                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   949
   950                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   951                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   952                 24  CF-MAIL-PROCESSING       PIC X.
   953                     88  MAIL-PROCESSING          VALUE 'Y'.
   954
   955         16  CF-MISC-SYSTEM-CONTROL.
   956             20  CF-SYSTEM-C                 PIC X.
   957                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   958             20  CF-SYSTEM-D                 PIC X.
   959                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   960             20  CF-SOC-SEC-NO-SW            PIC X.
   961                 88  SOC-SEC-NO-USED             VALUE '1'.
   962             20  CF-MEMBER-NO-SW             PIC X.
   963                 88  MEMBER-NO-USED              VALUE '1'.
   964             20  CF-TAX-ID-NUMBER            PIC X(11).
   965             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   966             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   967                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   968                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   969                 88  CF-ALL-APPROVED             VALUE 'Y'.
   970                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   971             20  CF-SYSTEM-E                 PIC X.
   972                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   973
   974         16  CF-LGX-LIFE-USER               PIC X.
   975             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   976             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   977
   978         16  CF-CR-MONTH-END-DT             PIC XX.
   979
   980         16  CF-FILE-MAINT-DATES.
   981             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   982                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   983             20  CF-LAST-BATCH       REDEFINES
   984                 CF-LAST-BATCH-NO               PIC X(4).
   985             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   986             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   987             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   988             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   989             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   990             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   991             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   992             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   993             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   994             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   995
   996         16  CF-NEXT-COMPANY-ID             PIC XXX.
   997         16  FILLER                         PIC X.
   998
   999         16  CF-ALT-MORT-CODE               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  19
* EL201.cbl
  1000         16  CF-MEMBER-CAPTION              PIC X(10).
  1001
  1002         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1003             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1004             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1005             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1006             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1007             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1008
  1009         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1010
  1011         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1012         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1013         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1014         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1015
  1016         16  CF-AH-OVERRIDE-L1              PIC X.
  1017         16  CF-AH-OVERRIDE-L2              PIC XX.
  1018         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1019         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1020
  1021         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1022         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1023
  1024         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1025         16  CF-AR-LAST-EL860-DT            PIC XX.
  1026         16  CF-MP-MONTH-END-DT             PIC XX.
  1027
  1028         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1029         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1030             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1031
  1032         16  CF-AR-MONTH-END-DT             PIC XX.
  1033
  1034         16  CF-CRDTCRD-USER                PIC X.
  1035             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1036             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1037
  1038         16  CF-CC-MONTH-END-DT             PIC XX.
  1039
  1040         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1041
  1042         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1043             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1044             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1045             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1046         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1047         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1048         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1049         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1050             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1051             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1052         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1053         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1054         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1055             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1056         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1057
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  20
* EL201.cbl
  1058         16  CF-CL-ZIP-CODE.
  1059             20  CF-CL-ZIP-PRIME.
  1060                 24  CF-CL-ZIP-1ST          PIC X.
  1061                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1062                 24  FILLER                 PIC X(4).
  1063             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1064         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1065             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1066             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1067             20  FILLER                     PIC XXX.
  1068
  1069         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1070         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1071         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1072         16  CF-CO-OPTION-START-DATE        PIC XX.
  1073         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1074           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1075                                                      '3' '4'.
  1076           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1077           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1078           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1079           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1080           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1081           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1082
  1083         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1084
  1085         16  CF-PAYMENT-APPROVAL-LEVELS.
  1086             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1087             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1088             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1089             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1090             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1091             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1092
  1093         16  CF-END-USER-REPORTING-USER     PIC X.
  1094             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1095             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1096
  1097         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1098             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1099             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1100
  1101         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1102
  1103         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1104         16  FILLER                         PIC X.
  1105
  1106         16  CF-CREDIT-ARCHIVE-CNTL.
  1107             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1108             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1109             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1110
  1111         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1112
  1113         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1114             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1115             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  21
* EL201.cbl
  1116
  1117         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1118             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1119             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1120
  1121         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1122
  1123         16  CF-CO-ACH-ID-CODE              PIC  X.
  1124             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1125             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1126             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1127         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1128         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1129         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1130         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1131         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1132         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1133         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1134         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1135         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1136                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1137         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1138                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1139
  1140         16  CF-CO-OVER-SHORT.
  1141             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1142             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1143
  1144*         16  FILLER                         PIC X(102).
  1145         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1146             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1147             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1148
  1149         16  CF-AH-APPROVAL-DAYS.
  1150             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1151             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1152             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1153             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1154
  1155         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1156
  1157         16  CF-APPROV-LEV-5.
  1158             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1159             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1160             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1161
  1162         16  FILLER                         PIC X(68).
  1163****************************************************************
  1164*             PROCESSOR/USER RECORD                            *
  1165****************************************************************
  1166
  1167     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1168         16  CF-PROCESSOR-NAME              PIC X(30).
  1169         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1170         16  CF-PROCESSOR-TITLE             PIC X(26).
  1171         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1172                 88  MESSAGE-YES                VALUE 'Y'.
  1173                 88  MESSAGE-NO                 VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  22
* EL201.cbl
  1174
  1175*****************************************************
  1176****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1177****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1178****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1179****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1180*****************************************************
  1181
  1182         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1183             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1184             20  CF-APPLICATION-FORCE       PIC X.
  1185             20  CF-INDIVIDUAL-APP.
  1186                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1187                     28  CF-BROWSE-APP      PIC X.
  1188                     28  CF-UPDATE-APP      PIC X.
  1189
  1190         16  CF-CURRENT-TERM-ON             PIC X(4).
  1191         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1192             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1193             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1194             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1195             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1196             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1197             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1198             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1199         16  CF-PROCESSOR-CARRIER           PIC X.
  1200             88  NO-CARRIER-SECURITY            VALUE ' '.
  1201         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1202             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1203         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1204             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1205         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1206             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1207
  1208         16  CF-PROC-SYS-ACCESS-SW.
  1209             20  CF-PROC-CREDIT-CLAIMS-SW.
  1210                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1211                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1212                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1213                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1214             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1215                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1216                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1217             20  CF-PROC-LIFE-GNRLDGR-SW.
  1218                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1219                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1220                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1221                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1222             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1223                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1224                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1225         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1226             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1227             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1228         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1229
  1230         16  CF-APPROVAL-LEVEL                  PIC X.
  1231             88  APPROVAL-LEVEL-1                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  23
* EL201.cbl
  1232             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1233             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1234             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1235             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1236
  1237         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1238
  1239         16  CF-LANGUAGE-TYPE                   PIC X.
  1240             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1241             88  CF-LANG-IS-FR                      VALUE 'F'.
  1242
  1243         16  CF-CSR-IND                         PIC X.
  1244         16  FILLER                             PIC X(239).
  1245
  1246****************************************************************
  1247*             PROCESSOR/REMINDERS RECORD                       *
  1248****************************************************************
  1249
  1250     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1251         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1252             20  CF-START-REMIND-DT         PIC XX.
  1253             20  CF-END-REMIND-DT           PIC XX.
  1254             20  CF-REMINDER-TEXT           PIC X(50).
  1255         16  FILLER                         PIC X(296).
  1256
  1257
  1258****************************************************************
  1259*             STATE MASTER RECORD                              *
  1260****************************************************************
  1261
  1262     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1263         16  CF-STATE-ABBREVIATION          PIC XX.
  1264         16  CF-STATE-NAME                  PIC X(25).
  1265         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1266         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1267             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1268             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1269             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1270             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1271                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1272                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1273             20  CF-ST-PREM-REJECT-SW       PIC X.
  1274                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1275                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1276             20  CF-ST-REF-REJECT-SW        PIC X.
  1277                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1278                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1279         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1280         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1281         16  CF-ST-REFUND-RULES.
  1282             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1283             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1284             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1285         16  CF-ST-FST-PMT-EXTENSION.
  1286             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1287             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1288                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1289                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  24
* EL201.cbl
  1290                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1291                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1292         16  CF-ST-STATE-CALL.
  1293             20  CF-ST-CALL-UNEARNED        PIC X.
  1294             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1295             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1296         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1297             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1298             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1299         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1300         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1301         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1302         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1303         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1304         16  FILLER                         PIC X.
  1305         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1306             20  CF-ST-BENEFIT-CD           PIC XX.
  1307             20  CF-ST-BENEFIT-KIND         PIC X.
  1308                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1309                 88  CF-ST-AH-KIND              VALUE 'A'.
  1310             20  CF-ST-REM-TERM-CALC        PIC X.
  1311                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1312                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1313                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1314                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1315                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1316                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1317                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1318                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1319
  1320             20  CF-ST-REFUND-CALC          PIC X.
  1321                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1322                 88  ST-REFD-BY-R78             VALUE '1'.
  1323                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1324                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1325                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1326                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1327                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1328                 88  ST-REFD-UTAH               VALUE '7'.
  1329                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1330                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1331                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1332
  1333             20  CF-ST-EARNING-CALC         PIC X.
  1334                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1335                 88  ST-EARN-BY-R78             VALUE '1'.
  1336                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1337                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1338                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1339                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1340                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1341                 88  ST-EARN-MEAN               VALUE '8'.
  1342                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1343
  1344             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1345                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1346                 88  ST-OVRD-BY-R78             VALUE '1'.
  1347                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  25
* EL201.cbl
  1348                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1349                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1350                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1351                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1352                 88  ST-OVRD-MEAN               VALUE '8'.
  1353                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1354             20  FILLER                     PIC X.
  1355
  1356         16  CF-ST-COMMISSION-CAPS.
  1357             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1358             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1359             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1360             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1361         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1362                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1363
  1364         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1365
  1366         16  CF-ST-STATUTORY-INTEREST.
  1367             20  CF-ST-STAT-DATE-FROM       PIC X.
  1368                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1369                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1370             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1371             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1372             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1373             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1374             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1375
  1376         16  CF-ST-OVER-SHORT.
  1377             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1378             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1379
  1380         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1381
  1382         16  CF-ST-RT-CALC                  PIC X.
  1383
  1384         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1385         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1386         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1387         16  CF-ST-RF-LR-CALC               PIC X.
  1388         16  CF-ST-RF-LL-CALC               PIC X.
  1389         16  CF-ST-RF-LN-CALC               PIC X.
  1390         16  CF-ST-RF-AH-CALC               PIC X.
  1391         16  CF-ST-RF-CP-CALC               PIC X.
  1392*        16  FILLER                         PIC X(206).
  1393*CIDMOD         16  FILLER                         PIC X(192).
  1394         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1395             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1396         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1397         16  CF-ST-VFY-2ND-BENE             PIC X.
  1398         16  CF-ST-CAUSAL-STATE             PIC X.
  1399         16  FILLER                         PIC X(185).
  1400
  1401****************************************************************
  1402*             BENEFIT MASTER RECORD                            *
  1403****************************************************************
  1404
  1405     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  26
* EL201.cbl
  1406         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1407             20  CF-BENEFIT-CODE            PIC XX.
  1408             20  CF-BENEFIT-NUMERIC  REDEFINES
  1409                 CF-BENEFIT-CODE            PIC XX.
  1410             20  CF-BENEFIT-ALPHA           PIC XXX.
  1411             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1412             20  CF-BENEFIT-COMMENT         PIC X(10).
  1413
  1414             20  CF-LF-COVERAGE-TYPE        PIC X.
  1415                 88  CF-REDUCING                VALUE 'R'.
  1416                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1417
  1418             20  CF-SPECIAL-CALC-CD         PIC X.
  1419                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1420                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1421                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1422                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1423                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1424                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1425                 88  CF-FARM-PLAN               VALUE 'F'.
  1426                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1427                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1428                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1429                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1430                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1431                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1432                 88  CF-PRUDENTIAL              VALUE 'P'.
  1433                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1434                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1435                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1436                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1437                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1438                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1439
  1440             20  CF-JOINT-INDICATOR         PIC X.
  1441                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1442
  1443*            20  FILLER                     PIC X(12).
  1444             20  cf-maximum-benefits        pic s999 comp-3.
  1445             20  FILLER                     PIC X(09).
  1446             20  CF-BENEFIT-CATEGORY        PIC X.
  1447             20  CF-LOAN-TYPE               PIC X(8).
  1448
  1449             20  CF-CO-REM-TERM-CALC        PIC X.
  1450                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1451                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1452                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1453                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1454                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1455
  1456             20  CF-CO-EARNINGS-CALC        PIC X.
  1457                 88  CO-EARN-BY-R78             VALUE '1'.
  1458                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1459                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1460                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1461                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1462                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1463                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  27
* EL201.cbl
  1464                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1465
  1466             20  CF-CO-REFUND-CALC          PIC X.
  1467                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1468                 88  CO-REFD-BY-R78             VALUE '1'.
  1469                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1470                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1471                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1472                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1473                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1474                 88  CO-REFD-MEAN               VALUE '8'.
  1475                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1476                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1477                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1478
  1479             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1480                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1481                 88  CO-OVRD-BY-R78             VALUE '1'.
  1482                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1483                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1484                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1485                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1486                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1487                 88  CO-OVRD-MEAN               VALUE '8'.
  1488                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1489
  1490             20  CF-CO-BEN-I-G-CD           PIC X.
  1491                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1492                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1493                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1494
  1495         16  FILLER                         PIC X(304).
  1496
  1497
  1498****************************************************************
  1499*             CARRIER MASTER RECORD                            *
  1500****************************************************************
  1501
  1502     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1503         16  CF-ADDRESS-DATA.
  1504             20  CF-MAIL-TO-NAME            PIC X(30).
  1505             20  CF-IN-CARE-OF              PIC X(30).
  1506             20  CF-ADDRESS-LINE-1          PIC X(30).
  1507             20  CF-ADDRESS-LINE-2          PIC X(30).
  1508             20  CF-CITY-STATE              PIC X(30).
  1509             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1510             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1511
  1512         16  CF-CLAIM-NO-CONTROL.
  1513             20  CF-CLAIM-NO-METHOD         PIC X.
  1514                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1515                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1516                 88  CLAIM-NO-SEQ               VALUE '3'.
  1517                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1518             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1519                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1520                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1521                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  28
* EL201.cbl
  1522
  1523         16  CF-CHECK-NO-CONTROL.
  1524             20  CF-CHECK-NO-METHOD         PIC X.
  1525                 88  CHECK-NO-MANUAL            VALUE '1'.
  1526                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1527                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1528                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1529             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1530                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1531
  1532         16  CF-DOMICILE-STATE              PIC XX.
  1533
  1534         16  CF-EXPENSE-CONTROLS.
  1535             20  CF-EXPENSE-METHOD          PIC X.
  1536                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1537                 88  DOLLARS-PER-PMT            VALUE '2'.
  1538                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1539                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1540             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1541             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1542
  1543         16  CF-CORRESPONDENCE-CONTROL.
  1544             20  CF-LETTER-RESEND-OPT       PIC X.
  1545                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1546                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1547             20  FILLER                     PIC X(4).
  1548
  1549         16  CF-RESERVE-CONTROLS.
  1550             20  CF-MANUAL-SW               PIC X.
  1551                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1552             20  CF-FUTURE-SW               PIC X.
  1553                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1554             20  CF-PTC-SW                  PIC X.
  1555                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1556             20  CF-IBNR-SW                 PIC X.
  1557                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1558             20  CF-PTC-LF-SW               PIC X.
  1559                 88  CF-LF-PTC-USED             VALUE '1'.
  1560             20  CF-CDT-ACCESS-METHOD       PIC X.
  1561                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1562                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1563                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1564             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1565
  1566         16  CF-CLAIM-CALC-METHOD           PIC X.
  1567             88  360-PLUS-MONTHS                VALUE '1'.
  1568             88  365-PLUS-MONTHS                VALUE '2'.
  1569             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1570             88  360-DAILY                      VALUE '4'.
  1571             88  365-DAILY                      VALUE '5'.
  1572
  1573         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1574         16  FILLER                         PIC X(11).
  1575
  1576         16  CF-LIMIT-AMOUNTS.
  1577             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1578             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1579             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  29
* EL201.cbl
  1580             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1581             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1582             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1583             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1584             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1585             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1586             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1587
  1588         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1589         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1590         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1591
  1592         16  CF-ZIP-CODE.
  1593             20  CF-ZIP-PRIME.
  1594                 24  CF-ZIP-1ST             PIC X.
  1595                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1596                 24  FILLER                 PIC X(4).
  1597             20  CF-ZIP-PLUS4               PIC X(4).
  1598         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1599             20  CF-CAN-POSTAL-1            PIC XXX.
  1600             20  CF-CAN-POSTAL-2            PIC XXX.
  1601             20  FILLER                     PIC XXX.
  1602
  1603         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1604         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1605         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1606
  1607         16  CF-RATING-SWITCH               PIC X.
  1608             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1609             88  CF-NO-RATING                   VALUE 'N'.
  1610
  1611         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1612
  1613         16  CF-CARRIER-OVER-SHORT.
  1614             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1615             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1616
  1617         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1618         16  CF-SECPAY-SWITCH               PIC X.
  1619             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1620             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1621         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1622         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1623         16  FILLER                         PIC X(444).
  1624*        16  FILLER                         PIC X(452).
  1625
  1626
  1627****************************************************************
  1628*             MORTALITY MASTER RECORD                          *
  1629****************************************************************
  1630
  1631     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1632         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1633                                INDEXED BY CF-MORT-NDX.
  1634             20  CF-MORT-TABLE              PIC X(5).
  1635             20  CF-MORT-TABLE-TYPE         PIC X.
  1636                 88  CF-MORT-JOINT              VALUE 'J'.
  1637                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  30
* EL201.cbl
  1638                 88  CF-MORT-COMBINED           VALUE 'C'.
  1639                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1640                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1641             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1642             20  CF-MORT-AGE-METHOD         PIC XX.
  1643                 88  CF-AGE-LAST                VALUE 'AL'.
  1644                 88  CF-AGE-NEAR                VALUE 'AN'.
  1645             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1646             20  CF-MORT-ADJUSTMENT-DIRECTION
  1647                                            PIC X.
  1648                 88  CF-MINUS                   VALUE '-'.
  1649                 88  CF-PLUS                    VALUE '+'.
  1650             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1651             20  CF-MORT-JOINT-CODE         PIC X.
  1652                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1653             20  CF-MORT-PC-Q               PIC X.
  1654                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1655             20  CF-MORT-TABLE-CODE         PIC X(4).
  1656             20  CF-MORT-COMMENTS           PIC X(15).
  1657             20  FILLER                     PIC X(14).
  1658
  1659         16  FILLER                         PIC X(251).
  1660
  1661
  1662****************************************************************
  1663*             BUSSINESS TYPE MASTER RECORD                     *
  1664****************************************************************
  1665
  1666     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1667* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1668* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1669* AND RECORD 05 IS TYPES 81-99
  1670         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1671             20  CF-BUSINESS-TITLE          PIC  X(19).
  1672             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1673                                            PIC S9V9(4) COMP-3.
  1674             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1675             20  FILLER                     PIC  X.
  1676         16  FILLER                         PIC  X(248).
  1677
  1678
  1679****************************************************************
  1680*             TERMINAL MASTER RECORD                           *
  1681****************************************************************
  1682
  1683     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1684
  1685         16  CF-COMPANY-TERMINALS.
  1686             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1687                                  PIC X(4).
  1688         16  FILLER               PIC X(248).
  1689
  1690
  1691****************************************************************
  1692*             LIFE EDIT MASTER RECORD                          *
  1693****************************************************************
  1694
  1695     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  31
* EL201.cbl
  1696         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1697             20  CF-LIFE-CODE-IN            PIC XX.
  1698             20  CF-LIFE-CODE-OUT           PIC XX.
  1699         16  FILLER                         PIC X(248).
  1700
  1701
  1702****************************************************************
  1703*             AH EDIT MASTER RECORD                            *
  1704****************************************************************
  1705
  1706     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1707         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1708             20  CF-AH-CODE-IN              PIC XXX.
  1709             20  CF-AH-CODE-OUT             PIC XX.
  1710         16  FILLER                         PIC X(248).
  1711
  1712
  1713****************************************************************
  1714*             CREDIBILITY TABLES                               *
  1715****************************************************************
  1716
  1717     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1718         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1719                             INDEXED BY CF-CRDB-NDX.
  1720             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1721             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1722             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1723         16  FILLER                         PIC  X(332).
  1724
  1725
  1726****************************************************************
  1727*             REPORT CUSTOMIZATION RECORD                      *
  1728****************************************************************
  1729
  1730     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1731         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1732             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1733             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1734             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1735**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1736****       A T-TRANSFER.                                   ****
  1737             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1738
  1739         16  FILLER                         PIC XX.
  1740
  1741         16  CF-CARRIER-CNTL-OPT.
  1742             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1743                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1744                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1745             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1746                                            PIC X.
  1747         16  CF-GROUP-CNTL-OPT.
  1748             20  CF-GROUP-OPT-SEQ           PIC 9.
  1749                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1750                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1751             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1752                                            PIC X(6).
  1753         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  32
* EL201.cbl
  1754             20  CF-STATE-OPT-SEQ           PIC 9.
  1755                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1756                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1757             20  CF-STATE-SELECT OCCURS 3 TIMES
  1758                                            PIC XX.
  1759         16  CF-ACCOUNT-CNTL-OPT.
  1760             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1761                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1762                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1763             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1764                                            PIC X(10).
  1765         16  CF-BUS-TYP-CNTL-OPT.
  1766             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1767                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1768                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1769             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1770                                            PIC XX.
  1771         16  CF-LF-TYP-CNTL-OPT.
  1772             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1773                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1774                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1775             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1776                                            PIC XX.
  1777         16  CF-AH-TYP-CNTL-OPT.
  1778             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1779                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1780                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1781             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1782                                            PIC XX.
  1783         16  CF-REPTCD1-CNTL-OPT.
  1784             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1785                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1786                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1787             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1788                                            PIC X(10).
  1789         16  CF-REPTCD2-CNTL-OPT.
  1790             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1791                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1792                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1793             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1794                                            PIC X(10).
  1795         16  CF-USER1-CNTL-OPT.
  1796             20  CF-USER1-OPT-SEQ           PIC 9.
  1797                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1798                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1799             20  CF-USER1-SELECT OCCURS 3 TIMES
  1800                                            PIC X(10).
  1801         16  CF-USER2-CNTL-OPT.
  1802             20  CF-USER2-OPT-SEQ           PIC 9.
  1803                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1804                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1805             20  CF-USER2-SELECT OCCURS 3 TIMES
  1806                                            PIC X(10).
  1807         16  CF-USER3-CNTL-OPT.
  1808             20  CF-USER3-OPT-SEQ           PIC 9.
  1809                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1810                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1811             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  33
* EL201.cbl
  1812                                            PIC X(10).
  1813         16  CF-USER4-CNTL-OPT.
  1814             20  CF-USER4-OPT-SEQ           PIC 9.
  1815                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1816                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1817             20  CF-USER4-SELECT OCCURS 3 TIMES
  1818                                            PIC X(10).
  1819         16  CF-USER5-CNTL-OPT.
  1820             20  CF-USER5-OPT-SEQ           PIC 9.
  1821                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1822                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1823             20  CF-USER5-SELECT OCCURS 3 TIMES
  1824                                            PIC X(10).
  1825         16  CF-REINS-CNTL-OPT.
  1826             20  CF-REINS-OPT-SEQ           PIC 9.
  1827                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1828                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1829             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1830                 24  CF-REINS-PRIME         PIC XXX.
  1831                 24  CF-REINS-SUB           PIC XXX.
  1832
  1833         16  CF-AGENT-CNTL-OPT.
  1834             20  CF-AGENT-OPT-SEQ           PIC 9.
  1835                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1836                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1837             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1838                                            PIC X(10).
  1839
  1840         16  FILLER                         PIC X(43).
  1841
  1842         16  CF-LOSS-RATIO-SELECT.
  1843             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1844             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1845         16  CF-ENTRY-DATE-SELECT.
  1846             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1847             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1848         16  CF-EFFECTIVE-DATE-SELECT.
  1849             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1850             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1851
  1852         16  CF-EXCEPTION-LIST-IND          PIC X.
  1853             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1854
  1855         16  FILLER                         PIC X(318).
  1856
  1857****************************************************************
  1858*                  EXCEPTION REPORTING RECORD                  *
  1859****************************************************************
  1860
  1861     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1862         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1863             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1864
  1865         16  CF-COMBINED-LIFE-AH-OPT.
  1866             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1867             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1868             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1869             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  34
* EL201.cbl
  1870
  1871         16  CF-LIFE-OPT.
  1872             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1873             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1874             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1875             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1876             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1877             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1878             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1879             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1880             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1881             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1882
  1883         16  CF-AH-OPT.
  1884             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1885             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1886             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1887             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1888             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1889             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1890             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1891             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1892             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1893             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1894
  1895         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1896             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1897             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1898             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1899
  1900         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1901
  1902         16  FILLER                         PIC X(673).
  1903
  1904
  1905****************************************************************
  1906*             MORTGAGE SYSTEM PLAN RECORD                      *
  1907****************************************************************
  1908
  1909     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1910         16  CF-PLAN-TYPE                   PIC X.
  1911             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1912             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1913             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1914         16  CF-PLAN-ABBREV                 PIC XXX.
  1915         16  CF-PLAN-DESCRIPT               PIC X(10).
  1916         16  CF-PLAN-NOTES                  PIC X(20).
  1917         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1918         16  CF-PLAN-UNDERWRITING.
  1919             20  CF-PLAN-TERM-DATA.
  1920                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1921                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1922             20  CF-PLAN-AGE-DATA.
  1923                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1924                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1925                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1926             20  CF-PLAN-BENEFIT-DATA.
  1927                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  35
* EL201.cbl
  1928                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1929                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1930                                            PIC S9(7)V99  COMP-3.
  1931         16  CF-PLAN-POLICY-FORMS.
  1932             20  CF-POLICY-FORM             PIC X(12).
  1933             20  CF-MASTER-APPLICATION      PIC X(12).
  1934             20  CF-MASTER-POLICY           PIC X(12).
  1935         16  CF-PLAN-RATING.
  1936             20  CF-RATE-CODE               PIC X(5).
  1937             20  CF-SEX-RATING              PIC X.
  1938                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1939                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1940             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1941             20  CF-SUB-STD-TYPE            PIC X.
  1942                 88  CF-PCT-OF-PREM            VALUE '1'.
  1943                 88  CF-PCT-OF-BENE            VALUE '2'.
  1944         16  CF-PLAN-PREM-TOLERANCES.
  1945             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1946             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1947         16  CF-PLAN-PYMT-TOLERANCES.
  1948             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1949             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1950         16  CF-PLAN-MISC-DATA.
  1951             20  FILLER                     PIC X.
  1952             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1953             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1954         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1955         16  CF-PLAN-IND-GRP                PIC X.
  1956             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1957                                                     '1'.
  1958             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1959                                                     '2'.
  1960         16  CF-MIB-SEARCH-SW               PIC X.
  1961             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1962             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1963             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1964             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1965         16  CF-ALPHA-SEARCH-SW             PIC X.
  1966             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1967             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1968             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1969             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1970             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1971             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1972             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1973             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1974             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1975             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1976                                                     'A' 'B' 'C'
  1977                                                     'X' 'Y' 'Z'.
  1978         16  CF-EFF-DT-RULE-SW              PIC X.
  1979             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1980             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1981             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1982             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1983             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1984         16  FILLER                         PIC X(4).
  1985         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  36
* EL201.cbl
  1986             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1987         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1988         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1989         16  CF-PLAN-SNGL-JNT               PIC X.
  1990             88  CF-COMBINED-PLAN              VALUE 'C'.
  1991             88  CF-JNT-PLAN                   VALUE 'J'.
  1992             88  CF-SNGL-PLAN                  VALUE 'S'.
  1993         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1994         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1995         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1996         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1997         16  CF-RERATE-CNTL                 PIC  X.
  1998             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1999             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2000             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2001             88  CF-AUTO-RECALC                 VALUE '4'.
  2002         16  CF-BENEFIT-TYPE                PIC  X.
  2003             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2004             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2005         16  CF-POLICY-FEE                  PIC S999V99
  2006                                                    COMP-3.
  2007         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2008         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2009         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2010         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2011         16  FILLER                         PIC  X(32).
  2012         16  CF-TERMINATION-FORM            PIC  X(04).
  2013         16  FILLER                         PIC  X(08).
  2014         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2015                                                       COMP-3.
  2016         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2017         16  CF-ISSUE-LETTER                PIC  X(4).
  2018         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2019         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2020             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2021             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2022         16  CF-MP-REFUND-CALC              PIC X.
  2023             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2024             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2025             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2026             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2027             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2028             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2029             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2030             88  CF-MP-REFD-MEAN                VALUE '8'.
  2031         16  CF-ALT-RATE-CODE               PIC  X(5).
  2032
  2033
  2034         16  FILLER                         PIC X(498).
  2035****************************************************************
  2036*             MORTGAGE COMPANY MASTER RECORD                   *
  2037****************************************************************
  2038
  2039     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2040         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2041         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2042             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2043             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  37
* EL201.cbl
  2044             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2045             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2046             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2047
  2048         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2049         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2050         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2051         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2052         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2053
  2054         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2055             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2056         16  CF-MP-RECON-USE-IND            PIC X(1).
  2057             88  CF-MP-USE-RECON             VALUE 'Y'.
  2058         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2059             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2060         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2061             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2062             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2063         16  FILLER                         PIC X(1).
  2064         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2065             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2066         16  CF-MORTG-MIB-VERSION           PIC X.
  2067             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2068             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2069             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2070         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2071             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2072                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2073             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2074                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2075             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2076                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2077             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2078                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2079             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2080                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2081             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2082                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2083         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2084         16  FILLER                         PIC X(7).
  2085         16  CF-MORTG-DESTINATION-SYMBOL.
  2086             20  CF-MORTG-MIB-COMM          PIC X(5).
  2087             20  CF-MORTG-MIB-TERM          PIC X(5).
  2088         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2089             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2090         16  FILLER                         PIC X(03).
  2091         16  CF-MP-CHECK-NO-CONTROL.
  2092             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2093                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2094                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2095                                                ' ' LOW-VALUES.
  2096                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2097                                               VALUE '3'.
  2098         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2099         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2100         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2101             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  38
* EL201.cbl
  2102                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2103             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2104                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2105             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2106                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2107             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2108                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2109             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2110                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2111             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2112                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2113         16  CF-MORTG-BILLING-AREA.
  2114             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2115                                            PIC X.
  2116         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2117         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2118         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2119         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2120             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2121             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2122         16  FILLER                         PIC X.
  2123         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2124             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2125             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2126         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2127         16  FILLER                         PIC X(8).
  2128         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2129         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2130         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2131         16  CF-ACH-COMPANY-ID.
  2132             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2133                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2134                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2135                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2136             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2137         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2138             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2139         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2140             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2141             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2142         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2143         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2144         16  FILLER                         PIC X(536).
  2145
  2146****************************************************************
  2147*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2148****************************************************************
  2149
  2150     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2151         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2152             20  CF-FEMALE-HEIGHT.
  2153                 24  CF-FEMALE-FT           PIC 99.
  2154                 24  CF-FEMALE-IN           PIC 99.
  2155             20  CF-FEMALE-MIN-WT           PIC 999.
  2156             20  CF-FEMALE-MAX-WT           PIC 999.
  2157         16  FILLER                         PIC X(428).
  2158
  2159     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  39
* EL201.cbl
  2160         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2161             20  CF-MALE-HEIGHT.
  2162                 24  CF-MALE-FT             PIC 99.
  2163                 24  CF-MALE-IN             PIC 99.
  2164             20  CF-MALE-MIN-WT             PIC 999.
  2165             20  CF-MALE-MAX-WT             PIC 999.
  2166         16  FILLER                         PIC X(428).
  2167******************************************************************
  2168*             AUTOMATIC ACTIVITY RECORD                          *
  2169******************************************************************
  2170     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2171         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2172             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2173             20  CF-SYS-LETTER-ID           PIC X(04).
  2174             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2175             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2176             20  CF-SYS-RESET-SW            PIC X(01).
  2177             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2178             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2179
  2180         16  FILLER                         PIC X(50).
  2181
  2182         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2183             20  CF-USER-ACTIVE-SW          PIC X(01).
  2184             20  CF-USER-LETTER-ID          PIC X(04).
  2185             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2186             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2187             20  CF-USER-RESET-SW           PIC X(01).
  2188             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2189             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2190             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2191
  2192         16  FILLER                         PIC X(246).
  2193 01  ws-heading1.
  2194     05  ws-head1                pic x(120)  value '
  2195-     '                                   DAILY CHECK RECONCILIATI
  2196-     'ON                                            '.
  2197     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2198 01  ws-heading2.
  2199     05  filler                  pic x(51) value spaces.
  2200     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2201     05  WS-H2-DATE              PIC X(10).
  2202     05  ws-h2-time              pic x(8).
  2203 01  ws-heading3.
  2204     05  filler                  pic x(53) value spaces.
  2205     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2206     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2207     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2208 01  ws-heading4.
  2209     05  filler                  pic x(117)   value ' CAR  GROUP
  2210-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2211-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2212 01  ws-hd1-written.
  2213     05  filler                  pic x(120)  value '
  2214-     '                                   DAILY WRITTEN CHECKS REP
  2215-     'ORT                                           '.
  2216 01  ws-hd4-written.
  2217     05  filler                  pic x(117)   value ' CAR  GROUP
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  40
* EL201.cbl
  2218-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2219-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2220 01  ws-detail1.
  2221     05  filler                  pic xx value '  '.
  2222     05  ws-d1-carr              pic x(4) value spaces.
  2223     05  ws-d1-grp               pic x(7) value spaces.
  2224     05  ws-d1-state             pic x(4) value spaces.
  2225     05  ws-d1-account           pic x(12) value spaces.
  2226     05  ws-d1-eff-dt            pic x(12) value spaces.
  2227     05  ws-d1-cert-no           pic x(14) value spaces.
  2228     05  ws-d1-chk-type          pic x(5) value spaces.
  2229     05  ws-d1-chk-no            pic x(12) value spaces.
  2230     05  f                       pic xx value spaces.
  2231     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2232     05  ws-d1-preparer          pic x(8) value spaces.
  2233     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2234     05  ws-d1-chk-amt redefines
  2235         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2236     05  filler                  pic xx value spaces.
  2237     05  ws-d1-message           pic x(20) value spaces.
  2238 01  ws-detail2.
  2239     05  filler                  pic x(12) value '    PAYEE - '.
  2240     05  ws-d2-addr-line         pic x(120) value spaces.
  2241 01  ws-total1.
  2242     05  filler                  pic x(5) value '     '.
  2243     05  ws-t1-cnt               pic zzzz9  value zeros.
  2244     05  ws-t1-chks              pic x(24)  value spaces.
  2245     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2246 01  w-doctoken                  pic x(16).
  2247 01 output-data.
  2248    05  filler                   pic x(6) value "TITLE=".
  2249    05  output-title             pic x(26) value 'Check Posting'.
  2250    05  filler                   pic x(8) value "&COMPID=".
  2251    05  out-comp-id              pic xxx.
  2252    05  filler                   pic x(5) value "&MSG=".
  2253    05  output-msg               pic x(50).
  2254 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2255     'cd /apps/prod/cid1p/jcl'.
  2256*    'cd /apps/test/mdoff/jcl'.
  2257 01  TRAN-DATA-LINE2.
  2258     05  filler                  pic x(10) value 'unikixjob '.
  2259     05  tdl2-job                pic x(8) value 'cilg201b'.
  2260     05  filler                  pic x(9) value ' -k cid1p'.
  2261*    05  filler                  pic x(9) value ' -k mdoff'.
  2262     05  filler                  pic x(51) value spaces.
  2263****************************************************************
  2264*
  2265* Copyright (c) 2007 by Clerity Solutions, Inc.
  2266* All rights reserved.
  2267*
  2268****************************************************************
  2269 01  DFHEIV.
  2270   02  DFHEIV0               PIC X(35).
  2271   02  DFHEIV1               PIC X(08).
  2272   02  DFHEIV2               PIC X(08).
  2273   02  DFHEIV3               PIC X(08).
  2274   02  DFHEIV4               PIC X(06).
  2275   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  41
* EL201.cbl
  2276   02  DFHEIV6               PIC X(04).
  2277   02  DFHEIV7               PIC X(02).
  2278   02  DFHEIV8               PIC X(02).
  2279   02  DFHEIV9               PIC X(01).
  2280   02  DFHEIV10              PIC S9(7) COMP-3.
  2281   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2282   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2283   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2284   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2285   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2286   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2287   02  DFHEIV17              PIC X(04).
  2288   02  DFHEIV18              PIC X(04).
  2289   02  DFHEIV19              PIC X(04).
  2290   02  DFHEIV20              USAGE IS POINTER.
  2291   02  DFHEIV21              USAGE IS POINTER.
  2292   02  DFHEIV22              USAGE IS POINTER.
  2293   02  DFHEIV23              USAGE IS POINTER.
  2294   02  DFHEIV24              USAGE IS POINTER.
  2295   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2296   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2297   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2298   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2299   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2300   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2301   02  FILLER                PIC X(02).
  2302   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2303   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2304   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2305   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2306   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2307 LINKAGE  SECTION.
  2308*****************************************************************
  2309*                                                               *
  2310* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2311* All rights reserved.                                          *
  2312*                                                               *
  2313*****************************************************************
  2314 01  dfheiblk.
  2315     02  eibtime          pic s9(7) comp-3.
  2316     02  eibdate          pic s9(7) comp-3.
  2317     02  eibtrnid         pic x(4).
  2318     02  eibtaskn         pic s9(7) comp-3.
  2319     02  eibtrmid         pic x(4).
  2320     02  dfheigdi         pic s9(4) comp.
  2321     02  eibcposn         pic s9(4) comp.
  2322     02  eibcalen         pic s9(4) comp.
  2323     02  eibaid           pic x(1).
  2324     02  eibfiller1       pic x(1).
  2325     02  eibfn            pic x(2).
  2326     02  eibfiller2       pic x(2).
  2327     02  eibrcode         pic x(6).
  2328     02  eibfiller3       pic x(2).
  2329     02  eibds            pic x(8).
  2330     02  eibreqid         pic x(8).
  2331     02  eibrsrce         pic x(8).
  2332     02  eibsync          pic x(1).
  2333     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  42
* EL201.cbl
  2334     02  eibrecv          pic x(1).
  2335     02  eibsend          pic x(1).
  2336     02  eibatt           pic x(1).
  2337     02  eibeoc           pic x(1).
  2338     02  eibfmh           pic x(1).
  2339     02  eibcompl         pic x(1).
  2340     02  eibsig           pic x(1).
  2341     02  eibconf          pic x(1).
  2342     02  eiberr           pic x(1).
  2343     02  eibrldbk         pic x(1).
  2344     02  eiberrcd         pic x(4).
  2345     02  eibsynrb         pic x(1).
  2346     02  eibnodat         pic x(1).
  2347     02  eibfiller5       pic x(2).
  2348     02  eibresp          pic 9(09) comp.
  2349     02  eibresp2         pic 9(09) comp.
  2350     02  dfheigdj         pic s9(4) comp.
  2351     02  dfheigdk         pic s9(4) comp.
  2352 01  DFHCOMMAREA       PIC X(01).
  2353 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2354 0000-DFHEXIT SECTION.
  2355     MOVE '9#                    $   ' TO DFHEIV0.
  2356     MOVE 'EL201' TO DFHEIV1.
  2357     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2358***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2359***                                                            ***
  2360***  Even though this program is using WEB Servies we don't    ***
  2361***  have any form fields to browse through, we are getting    ***
  2362***  the information we need through the variables that are    ***
  2363***  included in the URL. These variables are retrieved by     ***
  2364***  the           exec cics web extract                       ***
  2365***                   querystring  (data-value)                ***
  2366***                   querystrlen  (data-value)                ***
  2367***                end-exec                                    ***
  2368***  BTW, you must provide the length it isn't passed to you.  ***
  2369***  Allow for extra on the length or you will get a length    ***
  2370***  error instead of just truncation.                         ***
  2371***                                                            ***
  2372***  This program is expecting                                 ***
  2373*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2374*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2375***                                                            ***
  2376***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2377     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2378     move ws-fn-cymd             to dc-greg-date-cymd
  2379     move 'L'                    to dc-option-code
  2380     perform 9700-date-convert   thru 9700-exit
  2381     if no-conversion-error
  2382        move dc-greg-date-1-alpha to ws-h3-date
  2383        move dc-greg-date-1-edit to ws-h2-date
  2384     else
  2385        display ' error current dt invalid ' dc-error-code
  2386     end-if
  2387     string ws-fn-hours   ':'
  2388            ws-fn-minutes ':'
  2389            ws-fn-seconds
  2390        delimited by size into ws-h2-time
  2391     end-string
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  43
* EL201.cbl
  2392
  2393* exec cics web extract
  2394*       querystring  (ws-qry-string)
  2395*       querystrlen  (ws-qrystr-len)
  2396*    end-exec
  2397*    MOVE 'X0  QL                .   #00002295' TO DFHEIV0
  2398     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2399     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2400     MOVE X'2020233030303032323935' TO DFHEIV0(25:11)
  2401     CALL 'kxdfhei1' USING DFHEIV0,
  2402           DFHEIV99,
  2403           DFHEIV99,
  2404           ws-qry-string,
  2405           ws-qrystr-len,
  2406           DFHEIV99,
  2407           DFHEIV99,
  2408           DFHEIV99,
  2409           DFHEIV99,
  2410           DFHEIV99,
  2411           DFHEIV99,
  2412           DFHEIV99,
  2413           DFHEIV99,
  2414           DFHEIV99
  2415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2416     move ws-qry-string (6:3)    to ws-comp-id
  2417                                    out-comp-id
  2418     move 'Successful Run   '    to output-msg
  2419     move ws-comp-id             to elcntl-key
  2420     move '1'                    to elcntl-rec-type
  2421     move +0                     to elcntl-seq
  2422
  2423* exec cics read
  2424*       dataset  ('ELCNTL')
  2425*       into     (control-file)
  2426*       ridfld   (elcntl-key)
  2427*       resp     (ws-response)
  2428*    end-exec
  2429     MOVE LENGTH OF
  2430      control-file
  2431       TO DFHEIV11
  2432     MOVE 'ELCNTL' TO DFHEIV1
  2433*    MOVE '&"IL       E          (  N#00002305' TO DFHEIV0
  2434     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2436     MOVE X'204E233030303032333035' TO DFHEIV0(25:11)
  2437     CALL 'kxdfhei1' USING DFHEIV0,
  2438           DFHEIV1,
  2439           control-file,
  2440           DFHEIV11,
  2441           elcntl-key,
  2442           DFHEIV99,
  2443           DFHEIV99,
  2444           DFHEIV99
  2445     MOVE EIBRESP  TO ws-response
  2446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2447     if resp-normal
  2448        move cf-cl-mail-to-name  to ws-h2-client-name
  2449        move cf-company-cd       to ws-comp-cd
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  44
* EL201.cbl
  2450     else
  2451        move 'Company Rec not found ' to ws-h2-client-name
  2452                                         output-msg
  2453        display ' error elcntl read ' ws-response ' '
  2454           elcntl-key (1:8)
  2455        go to 0000-return
  2456     end-if
  2457     evaluate true
  2458        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2459           set process-written      to true
  2460           perform 2000-process-written
  2461                                 thru 2000-exit
  2462        when other
  2463           move 'Invalid File ' to output-msg
  2464     end-evaluate
  2465     if connected-to-db
  2466        EXEC SQL
  2467            commit work release
  2468        END-EXEC
  2469        if sqlcode not = 0
  2470           move ' Failed to Commit DB '
  2471                                 to output-msg
  2472           display "Error: commit release "
  2473           display ' sql return code ' sqlcode
  2474           display ' sql err mess    ' sqlerrmc
  2475        end-if
  2476     end-if
  2477     .
  2478 0000-return.
  2479     perform 1030-send-form      thru 1030-exit
  2480
  2481* exec cics
  2482*       return
  2483*    end-exec
  2484*    MOVE '.(                    ''   #00002344' TO DFHEIV0
  2485     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2486     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2487     MOVE X'2020233030303032333434' TO DFHEIV0(25:11)
  2488     CALL 'kxdfhei1' USING DFHEIV0,
  2489           DFHEIV99,
  2490           DFHEIV99,
  2491           DFHEIV99,
  2492           DFHEIV99,
  2493           DFHEIV99,
  2494           DFHEIV99
  2495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2496     .
  2497 1000-CONNECT-DB.
  2498     move 'NTCSO2_ChkApprv'      to svr
  2499     move 'sa'                   to usr
  2500     move 'ntcso2'               to pass
  2501     string
  2502         usr delimited space
  2503         "." delimited size
  2504         pass delimited space into usr-pass
  2505     end-string
  2506     EXEC SQL
  2507        CONNECT TO :svr USER :usr-pass
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  45
* EL201.cbl
  2508     END-EXEC
  2509     if sqlcode not = 0
  2510        display "Error: cannot connect "
  2511        display sqlcode
  2512        display sqlerrmc
  2513        move 'Failed to connect to DB'
  2514                                 to output-msg
  2515        go to 0000-return
  2516     else
  2517        set connected-to-db to true
  2518     end-if
  2519     .
  2520 1000-EXIT.
  2521     EXIT.
  2522 1020-read-erchek.
  2523     move ws-comp-cd             to ch-company-cd
  2524     move db-carrier             to ch-carrier
  2525     move db-grouping            to ch-grouping
  2526     move db-state               to ch-state
  2527     move db-account             to ch-account
  2528     move db-certificate         to ch-cert-prime
  2529     move db-cert-sfx            to ch-cert-sfx
  2530     string db-effdate (1:4)
  2531            db-effdate (6:2)
  2532            db-effdate (9:2)
  2533        delimited by size into dc-greg-date-cymd-r
  2534     end-string
  2535     move 'L'                    to dc-option-code
  2536     perform 9700-date-convert   thru 9700-exit
  2537     if no-conversion-error
  2538        move dc-bin-date-1       to ch-cert-eff-dt
  2539     else
  2540        display ' error cvtdte eff dt ' db-effdate ' '
  2541           dc-error-code
  2542     end-if
  2543     move zeros                  to ws-seq-alpha
  2544     move +5                     to s2
  2545     perform varying s1 from +5 by -1 until s1 < +1
  2546        if db-seq-no (s1:1) numeric
  2547           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2548           subtract +1 from s2
  2549        end-if
  2550     end-perform
  2551     move ws-seq-no-num          to ch-sequence-no
  2552*    display ' dte   **' db-effdate '**'
  2553*    display ' carrier ' ch-carrier
  2554*    display ' group   ' ch-grouping
  2555*    display ' state   ' ch-state
  2556*    display ' acct    ' ch-account
  2557*    display ' cert  **' ch-cert-no '**'
  2558*    display ' seq     ' ch-sequence-no
  2559
  2560* exec cics read
  2561*       update
  2562*       dataset    ('ERCHEK')
  2563*       into       (check-records)
  2564*       ridfld     (ch-control-primary)
  2565*       resp       (ws-response)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  46
* EL201.cbl
  2566*    end-exec
  2567     MOVE LENGTH OF
  2568      check-records
  2569       TO DFHEIV11
  2570     MOVE 'ERCHEK' TO DFHEIV1
  2571*    MOVE '&"IL       EU         (  N#00002410' TO DFHEIV0
  2572     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2573     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2574     MOVE X'204E233030303032343130' TO DFHEIV0(25:11)
  2575     CALL 'kxdfhei1' USING DFHEIV0,
  2576           DFHEIV1,
  2577           check-records,
  2578           DFHEIV11,
  2579           ch-control-primary,
  2580           DFHEIV99,
  2581           DFHEIV99,
  2582           DFHEIV99
  2583     MOVE EIBRESP  TO ws-response
  2584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2585     .
  2586 1020-exit.
  2587     exit.
  2588 1030-send-form.
  2589
  2590* exec cics document create
  2591*       doctoken   (w-doctoken)
  2592*       template   ('WCHECKS')
  2593*       symbollist (output-data)
  2594*       listlength (length of output-data)
  2595*    end-exec
  2596     MOVE 'WCHECKS'
  2597      TO DFHEIVL0
  2598     MOVE LENGTH OF
  2599      output-data TO DFHEIV16
  2600*    MOVE '\"D tSL               )   #00002421' TO DFHEIV0
  2601     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2602     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2603     MOVE X'2020233030303032343231' TO DFHEIV0(25:11)
  2604     CALL 'kxdfhei1' USING DFHEIV0,
  2605           w-doctoken,
  2606           DFHEIV99,
  2607           DFHEIVL0,
  2608           output-data,
  2609           DFHEIV16,
  2610           DFHEIV99,
  2611           DFHEIV99,
  2612           DFHEIV99
  2613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2614
  2615* exec cics web send
  2616*       doctoken(w-doctoken)
  2617*    end-exec
  2618*    MOVE 'X$D                   *   #00002427' TO DFHEIV0
  2619     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2620     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2621     MOVE X'2020233030303032343237' TO DFHEIV0(25:11)
  2622     CALL 'kxdfhei1' USING DFHEIV0,
  2623           w-doctoken,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  47
* EL201.cbl
  2624           DFHEIV99,
  2625           DFHEIV99,
  2626           DFHEIV99,
  2627           DFHEIV99,
  2628           DFHEIV99,
  2629           DFHEIV99,
  2630           DFHEIV99,
  2631           DFHEIV99
  2632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2633     .
  2634 1030-exit.
  2635     exit.
  2636 1050-disconnect.
  2637     if connected-to-db
  2638        EXEC SQL
  2639            disconnect all
  2640        END-EXEC
  2641        move ' ' to ws-connect-sw
  2642     end-if
  2643     .
  2644 1050-exit.
  2645     exit.
  2646 2000-process-written.
  2647     perform 2010-open-files     thru 2010-exit
  2648     perform 2020-init           thru 2020-exit
  2649     perform 2050-process-input  thru 2050-exit until
  2650        end-of-input
  2651     if ws-writ-cnt > zeros
  2652        move ws-writ-cnt         to ws-t1-cnt
  2653        move ' Written '         to ws-t1-chks
  2654        move ws-tot-writ-amt     to ws-t1-amount
  2655     else
  2656        perform 4010-write-headings
  2657                                 thru 4010-exit
  2658        move spaces              to ws-total1
  2659        string ' No checks for '
  2660           ws-writ-rpt-comp-id
  2661           ' today. ' delimited by size into ws-total1
  2662        end-string
  2663     end-if
  2664     move spaces                 to cps-written-rpt-rec
  2665     perform 4020-write-a-line   thru 4020-exit
  2666     move ws-total1              to cps-written-rpt-rec
  2667     perform 4020-write-a-line   thru 4020-exit
  2668     perform 2500-close-files    thru 2500-exit
  2669     perform 5000-submit-job     thru 5000-exit
  2670     .
  2671 2000-exit.
  2672     exit.
  2673 2010-open-files.
  2674     move function upper-case(ws-comp-id)
  2675                                 to ws-writ-rpt-comp-id
  2676     if ws-writ-rpt-comp-id = 'AHL'
  2677        move 'miscpymtsahl.csv'  to ws-writ-in-name
  2678     end-if
  2679     open input CPS-WRITTEN-IN
  2680         output CPS-WRITTEN-RPT
  2681     if written-status not = '00'
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  48
* EL201.cbl
  2682        display 'error written open ' written-status
  2683        move ' Invalid or missing file '
  2684                                 to output-msg
  2685        go to 0000-return
  2686     end-if
  2687     .
  2688 2010-exit.
  2689     exit.
  2690 2020-init.
  2691     move spaces                 to ws-detail1
  2692     move ws-hd1-written         to ws-head1
  2693     move 'EL201B'               to ws-h1-rpt-id
  2694     move ws-hd4-written         to ws-heading4
  2695     move 'Posting of Written Checks '
  2696                                 to output-title
  2697     if ws-comp-id = 'AHL'
  2698        move 'ahlg201b'          to tdl2-job
  2699     else
  2700        move 'cilg201b'          to tdl2-job
  2701     end-if
  2702     if not connected-to-db
  2703        perform 1000-connect-db  thru 1000-exit
  2704     end-if
  2705***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2706***                                                            ***
  2707**     I do 2 reads to bypass the header record                ***
  2708***                                                            ***
  2709***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2710     perform 2040-read-input     thru 2040-exit
  2711     perform 2040-read-input     thru 2040-exit
  2712     .
  2713 2020-exit.
  2714     exit.
  2715 2040-read-input.
  2716     read CPS-WRITTEN-IN at end
  2717        set end-of-input   to true
  2718     end-read
  2719     if not end-of-input
  2720        add 1 to ws-in-recs
  2721     end-if
  2722     .
  2723 2040-exit.
  2724     exit.
  2725 2050-process-input.
  2726     move spaces                 to ws-raw-record
  2727                                    ws-written-rec
  2728     unstring cps-written-in-rec
  2729        delimited by ',' into
  2730           raw-check-no
  2731           raw-check-dt
  2732           raw-check-amt
  2733           raw-vendor-id
  2734           raw-user-defined
  2735           raw-voucher-ref
  2736     end-unstring
  2737*    display ' chk no    **' wsw-check-no '**'
  2738*    display ' chk dt    **' wsw-check-dt '**'
  2739*    display ' chk amt   **' wsw-check-amt '**'
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  49
* EL201.cbl
  2740*    display ' vend id   **' wsw-vendor-id '**'
  2741*    display ' user def  **' wsw-user-defined '**'
  2742*    display ' vouch ref **' wsw-voucher-ref '**'
  2743***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2744***                                                            ***
  2745***    Every now and then I get bogus records with quotes      ***
  2746***  so I am just going to remove them.  These are normally    ***
  2747***  a result of a manual process that should not be included  ***
  2748***  in this file.                                             ***
  2749***                                                            ***
  2750***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2751
  2752     move +1                     to o1
  2753     perform varying i1 from +1 by +1 until i1 > +20
  2754        if raw-check-no (i1:1) <> '"'
  2755           move raw-check-no (i1:1)
  2756                                 to wsw-check-no (o1:1)
  2757           add +1 to o1
  2758        end-if
  2759     end-perform
  2760
  2761     move +1                     to o1
  2762     perform varying i1 from +1 by +1 until i1 > +20
  2763        if raw-check-dt (i1:1) <> '"'
  2764           move raw-check-dt (i1:1)
  2765                                 to wsw-check-dt (o1:1)
  2766           add +1 to o1
  2767        end-if
  2768     end-perform
  2769
  2770     move +1                     to o1
  2771     perform varying i1 from +1 by +1 until i1 > +15
  2772        if raw-check-amt (i1:1) <> '"'
  2773           move raw-check-amt (i1:1)
  2774                                 to wsw-check-amt (o1:1)
  2775           add +1 to o1
  2776        end-if
  2777     end-perform
  2778
  2779     move +1                     to o1
  2780     perform varying i1 from +1 by +1 until i1 > +20
  2781        if raw-vendor-id (i1:1) <> '"'
  2782           move raw-vendor-id (i1:1)
  2783                                 to wsw-vendor-id (o1:1)
  2784           add +1 to o1
  2785        end-if
  2786     end-perform
  2787
  2788     move +1                     to o1
  2789     perform varying i1 from +1 by +1 until i1 > +30
  2790        if raw-user-defined (i1:1) <> '"'
  2791           move raw-user-defined (i1:1)
  2792                                 to wsw-user-defined (o1:1)
  2793           add +1 to o1
  2794        end-if
  2795     end-perform
  2796
  2797     move +1                     to o1
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  50
* EL201.cbl
  2798     perform varying i1 from +1 by +1 until i1 > +35
  2799        if raw-voucher-ref (i1:1) <> '"'
  2800           move raw-voucher-ref (i1:1)
  2801                                 to wsw-voucher-ref (o1:1)
  2802           add +1 to o1
  2803        end-if
  2804     end-perform
  2805     if (wsw-check-no = spaces)
  2806        and (wsw-check-dt = spaces)
  2807        and (wsw-check-amt = spaces)
  2808        display ' empty record ' cps-written-in-rec
  2809        go to 2050-read
  2810     end-if
  2811     string wsw-check-dt (1:4)
  2812            wsw-check-dt (6:2)
  2813            wsw-check-dt (9:2)
  2814        delimited by size into dc-greg-date-cymd-r
  2815     end-string
  2816     move 'L'                    to dc-option-code
  2817     perform 9700-date-convert   thru 9700-exit
  2818     if no-conversion-error
  2819        move dc-bin-date-1       to ws-bin-check-dt
  2820     else
  2821        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2822           dc-error-code
  2823     end-if
  2824     perform varying s1 from +1 by +1 until
  2825        (s1 > +28)
  2826        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND')
  2827     end-perform
  2828     if s1 < +29
  2829        move 'Invalid Input REFDIR'    to ws-d1-message
  2830        move ' '                 to ws-table-sw
  2831        go to 2050-continue
  2832     end-if
  2833
  2834     move spaces                 to wsw-check-key
  2835     perform varying s1 from +30 by -1 until
  2836        (s1 < +1)
  2837        or (wsw-user-defined (s1:1) numeric)
  2838     end-perform
  2839     if s1 > +7
  2840        move wsw-user-defined (s1 - 6:7)
  2841                                 to wsw-check-key
  2842     else
  2843        move 'Invalid Input CK-KEY'    to ws-d1-message
  2844        go to 2050-continue
  2845     end-if
  2846*    go to 2050-read
  2847     move ' '                    to ws-erchek-sw
  2848                                    ws-table-sw
  2849     perform 2200-get-tbl-row    thru 2200-exit
  2850     if sqlcode = 0
  2851        set table-found          to true
  2852        perform 1020-read-erchek thru 1020-exit
  2853        if resp-normal
  2854           set erchek-found to true
  2855           perform 2310-upd-erchek
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  51
* EL201.cbl
  2856                                 thru 2310-exit
  2857           perform 2320-upd-table thru 2320-exit
  2858        else
  2859           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2860              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2861              ' ' ws-response
  2862           move ' chk rec not found ' to ws-d1-message
  2863        end-if
  2864     else
  2865        move ' tbl row not found ' to ws-d1-message
  2866     end-if
  2867     .
  2868 2050-continue.
  2869     perform 2400-build-print-line thru 2400-exit
  2870     .
  2871 2050-read.
  2872     perform 2040-read-input     thru 2040-exit
  2873     .
  2874 2050-exit.
  2875     exit.
  2876 2200-get-tbl-row.
  2877***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2878***                                                            ***
  2879***  I'm only expecting one row so no cursor is declared       ***
  2880***                                                            ***
  2881***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2882     move ws-comp-id             to ws-compid
  2883     move wsw-check-key-num      to ws-check-key
  2884     move 1                      to ws-type
  2885     exec sql
  2886        SELECT
  2887           CheckKey,
  2888           Company,
  2889           CertCarrier,
  2890           CertGroup,
  2891           CertState,
  2892           CertAccount,
  2893           CertEffDate,
  2894           CertNumber,
  2895           CertNumberSuf,
  2896           CheckSeqNbr,
  2897           CheckType,
  2898           CheckAmount,
  2899           Preparer
  2900        INTO
  2901           :db-checkkey,
  2902           :db-compid,
  2903           :db-carrier,
  2904           :db-grouping,
  2905           :db-state,
  2906           :db-account,
  2907           :db-effdate,
  2908           :db-certificate,
  2909           :db-cert-sfx,
  2910           :db-seq-no,
  2911           :db-type,
  2912           :db-amount,
  2913           :db-preparer
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  52
* EL201.cbl
  2914        FROM
  2915           ChkApp_Check
  2916        WHERE
  2917           (CheckKey    = :ws-check-key)
  2918           and (Company = :ws-compid)
  2919     end-exec
  2920     if sqlcode not = 0
  2921        move sqlcode to ws-sql-code
  2922        move ws-sql-code to ws-dis-sql-code
  2923        display ' dis sql code ' ws-dis-sql-code
  2924        display "Error: cannot read row "
  2925        display ' sql return code ' sqlcode
  2926        display ' sql err mess    ' sqlerrmc
  2927     end-if
  2928     .
  2929 2200-exit.
  2930     exit.
  2931 2310-upd-erchek.
  2932     move ws-bin-check-dt        to ch-check-written-dt
  2933     if wsw-check-no (1:1) = '"'
  2934        move wsw-check-no (5:7)  to ch-check-no
  2935     else
  2936        move wsw-check-no (4:7)  to ch-check-no
  2937     end-if
  2938*    move zeros                  to ws-response
  2939
  2940* exec cics rewrite
  2941*       dataset     ('ERCHEK')
  2942*       from        (check-records)
  2943*       resp        (ws-response)
  2944*    end-exec
  2945     MOVE LENGTH OF
  2946      check-records
  2947       TO DFHEIV11
  2948     MOVE 'ERCHEK' TO DFHEIV1
  2949*    MOVE '&& L                  %  N#00002736' TO DFHEIV0
  2950     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2951     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2952     MOVE X'204E233030303032373336' TO DFHEIV0(25:11)
  2953     CALL 'kxdfhei1' USING DFHEIV0,
  2954           DFHEIV1,
  2955           check-records,
  2956           DFHEIV11,
  2957           DFHEIV99
  2958     MOVE EIBRESP  TO ws-response
  2959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2960     if resp-normal
  2961        add 1 to ws-writ-cnt
  2962        compute ws-tot-writ-amt =
  2963           ws-tot-writ-amt + ch-amount-paid
  2964        move 'Successful Post '  to ws-d1-message
  2965     else
  2966        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  2967     end-if
  2968     .
  2969 2310-exit.
  2970     exit.
  2971 2320-upd-table.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  53
* EL201.cbl
  2972     string wsw-check-dt (6:2) '/'
  2973            wsw-check-dt (9:2) '/'
  2974            wsw-check-dt (1:4)
  2975        delimited by size into db-checkdate
  2976     move ch-check-no            to db-checkno
  2977*    move zeros to sqlcode
  2978     EXEC SQL
  2979        UPDATE
  2980           ChkApp_Check
  2981        SET
  2982           CheckNumber = :db-checkno,
  2983           CheckDate = :db-checkdate
  2984        WHERE
  2985           CheckKey = :db-checkkey
  2986     END-EXEC
  2987     if sqlcode not = 0
  2988        move 'Table not updated ' to ws-d1-message
  2989        display "Error: cannot update table   "
  2990        display ' sql retrun code ' sqlcode
  2991        display ' sql err mess    ' sqlerrmc
  2992     end-if
  2993     .
  2994 2320-exit.
  2995     exit.
  2996 2400-build-print-line.
  2997     if table-found
  2998        move db-carrier          to ws-d1-carr
  2999        move db-grouping         to ws-d1-grp
  3000        move db-state            to ws-d1-state
  3001        move db-account          to ws-d1-account
  3002        string
  3003           db-effdate (6:2)   '/'
  3004           db-effdate (9:2)   '/'
  3005           db-effdate (1:4)
  3006           delimited by size into ws-d1-eff-dt
  3007        end-string
  3008        move db-certificate      to ws-d1-cert-no
  3009        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3010        move 'REF'               to ws-d1-chk-type
  3011        move +10                 to s2
  3012        move zeros               to ws-work-amt-alpha
  3013        perform varying s1 from +10 by -1 until s1 < +1
  3014           if db-amount (s1:1) numeric
  3015              move db-amount (s1:1)
  3016                                 to ws-work-amt-alpha (s2:1)
  3017              subtract +1 from s2
  3018           end-if
  3019        end-perform
  3020        move ws-work-amt-num     to ws-d1-chk-amt
  3021        move db-preparer         to ws-d1-preparer
  3022        move db-checkno          to ws-d1-chk-no
  3023        move db-checkdate        to ws-d1-writ-cash-dt
  3024     else
  3025        move wsw-check-no        to ws-d1-chk-no
  3026     end-if
  3027     perform 4000-write-report   thru 4000-exit
  3028     move spaces                 to ws-detail1
  3029     .
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  54
* EL201.cbl
  3030 2400-exit.
  3031     exit.
  3032 2500-close-files.
  3033     close cps-written-in cps-written-rpt
  3034     .
  3035 2500-exit.
  3036     exit.
  3037 4000-write-report.
  3038     if ws-line-cntr > ws-max-lines
  3039        move zeros               to ws-line-cntr
  3040        perform 4010-write-headings thru 4010-exit
  3041     end-if
  3042     move ws-detail1             to cps-written-rpt-rec
  3043     perform 4020-write-a-line   thru 4020-exit
  3044     .
  3045 4000-exit.
  3046     exit.
  3047 4010-write-headings.
  3048     add 1 to ws-page-cntr
  3049     move ws-page-cntr           to ws-h3-page
  3050     move ws-heading1            to cps-written-rpt-rec
  3051     perform 4020-write-a-line   thru 4020-exit
  3052     move ws-heading2            to cps-written-rpt-rec
  3053     perform 4020-write-a-line   thru 4020-exit
  3054     move ws-heading3            to cps-written-rpt-rec
  3055     perform 4020-write-a-line   thru 4020-exit
  3056     move spaces                 to cps-written-rpt-rec
  3057     perform 4020-write-a-line   thru 4020-exit
  3058     move spaces                 to cps-written-rpt-rec
  3059     perform 4020-write-a-line   thru 4020-exit
  3060     move ws-heading4            to cps-written-rpt-rec
  3061     perform 4020-write-a-line   thru 4020-exit
  3062     move spaces                 to cps-written-rpt-rec
  3063     perform 4020-write-a-line   thru 4020-exit
  3064     .
  3065 4010-exit.
  3066     exit.
  3067 4020-write-a-line.
  3068     write cps-written-rpt-rec
  3069     add 1 to ws-line-cntr
  3070     .
  3071 4020-exit.
  3072     exit.
  3073 5000-submit-job.
  3074
  3075* EXEC CICS WRITEQ TD
  3076*       QUEUE ('BTCH')
  3077*       FROM (TRAN-DATA-LINE1)
  3078*       LENGTH (80)
  3079*    END-EXEC
  3080     MOVE 80
  3081       TO DFHEIV11
  3082     MOVE 'BTCH' TO DFHEIV5
  3083*    MOVE '(" L                  &   #00002855' TO DFHEIV0
  3084     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3085     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3086     MOVE X'2020233030303032383535' TO DFHEIV0(25:11)
  3087     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  55
* EL201.cbl
  3088           DFHEIV5,
  3089           TRAN-DATA-LINE1,
  3090           DFHEIV11,
  3091           DFHEIV99,
  3092           DFHEIV99
  3093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3094
  3095* EXEC CICS WRITEQ TD
  3096*       QUEUE ('BTCH')
  3097*       FROM (TRAN-DATA-LINE2)
  3098*       LENGTH (80)
  3099*    END-EXEC
  3100     MOVE 80
  3101       TO DFHEIV11
  3102     MOVE 'BTCH' TO DFHEIV5
  3103*    MOVE '(" L                  &   #00002860' TO DFHEIV0
  3104     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3105     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3106     MOVE X'2020233030303032383630' TO DFHEIV0(25:11)
  3107     CALL 'kxdfhei1' USING DFHEIV0,
  3108           DFHEIV5,
  3109           TRAN-DATA-LINE2,
  3110           DFHEIV11,
  3111           DFHEIV99,
  3112           DFHEIV99
  3113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3114     .
  3115 5000-exit.
  3116     exit.
  3117 9700-DATE-CONVERT.
  3118
  3119* EXEC CICS LINK
  3120*         PROGRAM  ('ELDATCV')
  3121*         COMMAREA (DATE-CONVERSION-DATA)
  3122*         LENGTH   (DC-COMM-LENGTH)
  3123*    END-EXEC.
  3124     MOVE 'ELDATCV' TO DFHEIV1
  3125*    MOVE '."C                   (   #00002869' TO DFHEIV0
  3126     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3128     MOVE X'2020233030303032383639' TO DFHEIV0(25:11)
  3129     CALL 'kxdfhei1' USING DFHEIV0,
  3130           DFHEIV1,
  3131           DATE-CONVERSION-DATA,
  3132           DC-COMM-LENGTH,
  3133           DFHEIV99,
  3134           DFHEIV99,
  3135           DFHEIV99,
  3136           DFHEIV99
  3137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3138
  3139 9700-EXIT.
  3140      EXIT.
  3141
  3142 9999-DFHBACK SECTION.
  3143     MOVE '9%                    "   ' TO DFHEIV0
  3144     MOVE 'EL201' TO DFHEIV1
  3145     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Aug-14 14:30 Page  56
* EL201.cbl
  3146     GOBACK.
  3147 9999-DFHEXIT.
  3148     IF DFHEIGDJ EQUAL 0001
  3149         NEXT SENTENCE.
  3150     MOVE '9%                    "   ' TO DFHEIV0
  3151     MOVE 'EL201' TO DFHEIV1
  3152     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3153     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      139428     Code:        9070
