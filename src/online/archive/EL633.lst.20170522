* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56* 110315  CR2015101400001  PEMA ADD NEW DCC G/L #'S FOR ACH
    57* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    58* 021716  CR2016021000003  PEMA  ADD NEW G/L FOR MACHENS ACCTS
    59* 111016  CR2016110900002  TANA  REPLACE GL NUMBERS FOR CCC
    60******************************************************************
    61
    62 ENVIRONMENT DIVISION.
    63 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   3
* EL633.cbl
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67 77  FILLER  PIC X(32)  VALUE '********************************'.
    68 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    69 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    70
    71*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    72*77  SV-COFA PIC X(42)  VALUE SPACES.
    73*77  K-SPACE PIC X(11)  VALUE SPACES.
    74
    75 01  DATE-WORK-AREAS.
    76     05  WS-GREG-STORE.
    77         10  WS-GS-MM  PIC XX.
    78         10  FILLER    PIC X.
    79         10  WS-GS-DD  PIC XX.
    80         10  FILLER    PIC X.
    81         10  WS-GS-YY  PIC XX.
    82     05  WS-SDTE-STORE.
    83         10  WS-SS-MM  PIC XX.
    84         10  WS-SS-DD  PIC XX.
    85         10  WS-SS-YY  PIC XX.
    86*                            COPY ELCSCTM.
    87******************************************************************
    88*                                                                *
    89*                                                                *
    90*                            ELCSCTM                             *
    91*                            VMOD=2.001                          *
    92*                                                                *
    93*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-MESSAGE.
    97     12  FILLER                          PIC X(30)
    98            VALUE '** LOGIC SECURITY VIOLATION -'.
    99     12  SM-READ                         PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' PGM='.
   102     12  SM-PGM                          PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' OPR='.
   105     12  SM-PROCESSOR-ID                 PIC X(4).
   106     12  FILLER                          PIC X(6)
   107            VALUE ' TERM='.
   108     12  SM-TERMID                       PIC X(4).
   109     12  FILLER                          PIC XX   VALUE SPACE.
   110     12  SM-JUL-DATE                     PIC 9(5).
   111     12  FILLER                          PIC X    VALUE SPACE.
   112     12  SM-TIME                         PIC 99.99.
   113
   114*                            COPY ELCSCRTY.
   115******************************************************************
   116*                                                                *
   117*                                                                *
   118*                            ELCSCRTY                            *
   119*                            VMOD=2.001                          *
   120*                                                                *
   121*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   122*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   4
* EL633.cbl
   123*        SAVED IN PI-SECURITY-ADDRESS.                           *
   124*                                                                *
   125******************************************************************
   126 01  SECURITY-CONTROL.
   127     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   128     12  FILLER                       PIC XX    VALUE 'SC'.
   129     12  SC-CREDIT-CODES.
   130         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   131             20  SC-CREDIT-DISPLAY    PIC X.
   132             20  SC-CREDIT-UPDATE     PIC X.
   133     12  SC-CLAIMS-CODES.
   134         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   135             20  SC-CLAIMS-DISPLAY    PIC X.
   136             20  SC-CLAIMS-UPDATE     PIC X.
   137
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   5
* EL633.cbl
   139
   140 01  STANDARD-AREAS.
   141     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   142     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   143     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   144     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   145     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   146     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   147     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   148     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   149     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   150     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   151     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   152     12  PGM-NAME            PIC  X(8).
   153     12  TIME-IN             PIC S9(7).
   154     12  TIME-OUT-R  REDEFINES  TIME-IN.
   155         16  FILLER          PIC  X.
   156         16  TIME-OUT        PIC  99V99.
   157         16  FILLER          PIC  X(2).
   158     12  EL640               PIC  X(8)       VALUE 'EL640'.
   159     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   160     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   161     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   162     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   163     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   164     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   165     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   166     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   167     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   168     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   169     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   170     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   171     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   172     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   173     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   174     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   175     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   176         88  PYAJ-1ST-READ                   VALUE 'Y'.
   177     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   178         88  FIRST-ADD                       VALUE 'Y'.
   179     12  ZERO-NDX            PIC  9          VALUE ZERO.
   180     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   181     12  WORK-SEQ-TIME       PIC  9(6).
   182     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   183         16  WORK-SEQ-HHMMS  PIC  9(5).
   184         16  FILLER          PIC  9.
   185     12  WORK-DATE-JULIAN.
   186         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   187         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   188     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   189     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   190         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   191                                                    'S' 'T' 'U'
   192                                                    'X' 'Y' 'Z'
   193                                                    'F'.
   194     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   195         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   196     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   6
* EL633.cbl
   197         88  FORCE-SHOW                      VALUE  'Y'.
   198
   199     12  WS-EOM-DTS OCCURS 13  TIMES
   200                              INDEXED BY PINDEX.
   201         16  WS-EOM-DT               PIC XX.
   202*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   203
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   7
* EL633.cbl
   205     12  WS-ERROR-CODES.
   206         16  ER-0000         PIC  X(4)       VALUE '0000'.
   207         16  ER-0008         PIC  X(4)       VALUE '0008'.
   208         16  ER-0023         PIC  X(4)       VALUE '0023'.
   209         16  ER-0029         PIC  X(4)       VALUE '0029'.
   210         16  ER-0070         PIC  X(4)       VALUE '0070'.
   211         16  ER-0587         PIC  X(4)       VALUE '0587'.
   212         16  ER-2056         PIC  X(4)       VALUE '2056'.
   213         16  ER-2230         PIC  X(4)       VALUE '2230'.
   214         16  ER-2231         PIC  X(4)       VALUE '2231'.
   215         16  ER-2232         PIC  X(4)       VALUE '2232'.
   216         16  ER-2233         PIC  X(4)       VALUE '2233'.
   217         16  ER-2234         PIC  X(4)       VALUE '2234'.
   218         16  ER-2235         PIC  X(4)       VALUE '2235'.
   219         16  ER-2236         PIC  X(4)       VALUE '2236'.
   220         16  ER-2237         PIC  X(4)       VALUE '2237'.
   221         16  ER-2238         PIC  X(4)       VALUE '2238'.
   222         16  ER-2239         PIC  X(4)       VALUE '2239'.
   223         16  ER-2244         PIC  X(4)       VALUE '2244'.
   224         16  ER-2245         PIC  X(4)       VALUE '2245'.
   225         16  ER-2246         PIC  X(4)       VALUE '2246'.
   226         16  ER-2370         PIC  X(4)       VALUE '2370'.
   227         16  ER-2432         PIC  X(4)       VALUE '2432'.
   228         16  ER-2449         PIC  X(4)       VALUE '2449'.
   229         16  ER-2587         PIC  X(4)       VALUE '2587'.
   230         16  ER-2588         PIC  X(4)       VALUE '2588'.
   231         16  ER-2595         PIC  X(4)       VALUE '2595'.
   232         16  ER-2596         PIC  X(4)       VALUE '2596'.
   233         16  ER-2763         PIC  X(4)       VALUE '2763'.
   234         16  ER-2929         PIC  X(4)       VALUE '2929'.
   235         16  ER-2957         PIC  X(4)       VALUE '2957'.
   236         16  ER-2958         PIC  X(4)       VALUE '2958'.
   237*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   238         16  ER-2960         PIC  X(4)       VALUE '2960'.
   239         16  ER-3020         PIC  X(4)       VALUE '3020'.
   240
   241*************************************************************
   242*                      TABLE OF STATE NAMES
   243*************************************************************
   244
   245 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   246     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   247                                   'CD' 'CO' 'CT' 'DC' 'DE'
   248                                   'FL' 'GA' 'GM' 'HI' 'IA'
   249                                   'ID' 'IL' 'IN' 'KS' 'KY'
   250                                   'LA' 'MA' 'MD' 'ME' 'MI'
   251                                   'MN' 'MO' 'MS' 'MT' 'MX'
   252                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   253                                   'NM' 'NV' 'NY' 'OF' 'OH'
   254                                   'OK' 'OR' 'PA' 'PI' 'PR'
   255                                   'RI' 'SC' 'SD' 'TN' 'TX'
   256                                   'UT' 'VA' 'VI' 'VT' 'WA'
   257                                   'WI' 'WV' 'WY'.
   258
   259 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   260     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   261                                 '1108124700'
   262                                 '1108125100'
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   8
* EL633.cbl
   263                                 '1721211400'
   264                                 '1825011200'
   265                                 '1825011300'
   266                                 '1825091000'
   267                                 '1825099050'
   268                                 '8505700033'
   269                                 '8506400030'
   270                                 '8507200020'
   271                                 '8507200010'
   272                                 '2725010160'.
   273     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   274                                     '2725040320'
   275                                     '2725040330'
   276                                     '2725040310'
   277                                     '8506400030'
   278                                     '8507200010'
   279                                     '1108121250'.
   280*    88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   281*                                    '2725040110'
   282*                                    '2725040120'
   283*                                    '2725040130'
   284*                                    '2725020400'.
   285     88  VALID-CSI-GL-ACCOUNT  VALUE '1108121010'
   286                                     '1825013200'
   287                                     '1825013300'
   288                                     '1825013400'.
   289
   290     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   291                                     '1825013200'
   292                                     '1825013300'
   293                                     '1825013400'
   294                                     '8506400030'
   295                                     '8507200010'
   296                                     '8507200020'
   297                                     '1108121010'.
   298
   299*01  WS-ACCT-BREAK.
   300*    05  WS-ACCT-1               PIC X.
   301*    05  FILLER                  PIC X(6).
   302*
   303 01  WORK-AREA.
   304     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   305     12  QID.
   306         16  QID-TERM        PIC X(04).
   307         16  FILLER          PIC X(04)       VALUE '633A'.
   308     12  DEEDIT-FIELD        PIC X(11).
   309     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   310     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   311     12  DATE-TEST-AREA      PIC  9(6).
   312     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   313         16  DATE-TEST-MM    PIC  99.
   314         16  DATE-TEST-DD    PIC  99.
   315         16  DATE-TEST-YY    PIC  99.
   316     12  DIVIDE-RESULT       PIC  99.
   317     12  DIVIDE-REMAINDER    PIC  9.
   318     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   319     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   320     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page   9
* EL633.cbl
   321     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   322     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   323     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   324     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   325     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   326
   327 01  ACCESS-KEYS.
   328     12  ERPYAJ-KEY.
   329         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   330         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   331         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   332         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   333         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   334         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   335         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   336
   337     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   338     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   339
   340     12  ERCHKQ-KEY.
   341         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   342         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   343         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   344     12  ERCOMP-KEY.
   345         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   346         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   347         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   348         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   349         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   350         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   351*    12  COFA-KEY-X.
   352*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   353*        16  COFA-ACCOUNT.
   354*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   355*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   356*
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  10
* EL633.cbl
   358*                                    COPY ELCDATE.
   359******************************************************************
   360*                                                                *
   361*                                                                *
   362*                            ELCDATE.                            *
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   364*                            VMOD=2.003
   365*                                                                *
   366*                                                                *
   367*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   368*                 LENGTH = 200                                   *
   369******************************************************************
   370
   371 01  DATE-CONVERSION-DATA.
   372     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   373     12  DC-OPTION-CODE                PIC X.
   374         88  BIN-TO-GREG                VALUE ' '.
   375         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   376         88  EDIT-GREG-TO-BIN           VALUE '2'.
   377         88  YMD-GREG-TO-BIN            VALUE '3'.
   378         88  MDY-GREG-TO-BIN            VALUE '4'.
   379         88  JULIAN-TO-BIN              VALUE '5'.
   380         88  BIN-PLUS-ELAPSED           VALUE '6'.
   381         88  FIND-CENTURY               VALUE '7'.
   382         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   383         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   384         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   385         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   386         88  JULIAN-TO-BIN-3            VALUE 'C'.
   387         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   388         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   389         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   390         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   391         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   392         88  CHECK-LEAP-YEAR            VALUE 'H'.
   393         88  BIN-3-TO-GREG              VALUE 'I'.
   394         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   395         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   396         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   397         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   398         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   399         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   400         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   401         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   402         88  THREE-CHARACTER-BIN
   403                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   404         88  GREGORIAN-TO-BIN
   405                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   406         88  BIN-TO-GREGORIAN
   407                  VALUES ' ' '1' 'I' '8' 'G'.
   408         88  JULIAN-TO-BINARY
   409                  VALUES '5' 'C' 'E' 'F'.
   410     12  DC-ERROR-CODE                 PIC X.
   411         88  NO-CONVERSION-ERROR        VALUE ' '.
   412         88  DATE-CONVERSION-ERROR
   413                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   414         88  DATE-IS-ZERO               VALUE '1'.
   415         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  11
* EL633.cbl
   416         88  DATE-IS-INVALID            VALUE '3'.
   417         88  DATE1-GREATER-DATE2        VALUE '4'.
   418         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   419         88  DATE-INVALID-OPTION        VALUE '9'.
   420         88  INVALID-CENTURY            VALUE 'A'.
   421         88  ONLY-CENTURY               VALUE 'B'.
   422         88  ONLY-LEAP-YEAR             VALUE 'C'.
   423         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   424     12  DC-END-OF-MONTH               PIC X.
   425         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   426     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   427         88  USE-NORMAL-PROCESS         VALUE ' '.
   428         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   429         88  ADJUST-UP-100-YRS          VALUE '2'.
   430     12  FILLER                        PIC X.
   431     12  DC-CONVERSION-DATES.
   432         16  DC-BIN-DATE-1             PIC XX.
   433         16  DC-BIN-DATE-2             PIC XX.
   434         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   435         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   436                       DC-GREG-DATE-1-EDIT.
   437             20  DC-EDIT1-MONTH        PIC 99.
   438             20  SLASH1-1              PIC X.
   439             20  DC-EDIT1-DAY          PIC 99.
   440             20  SLASH1-2              PIC X.
   441             20  DC-EDIT1-YEAR         PIC 99.
   442         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   443         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   444                     DC-GREG-DATE-2-EDIT.
   445             20  DC-EDIT2-MONTH        PIC 99.
   446             20  SLASH2-1              PIC X.
   447             20  DC-EDIT2-DAY          PIC 99.
   448             20  SLASH2-2              PIC X.
   449             20  DC-EDIT2-YEAR         PIC 99.
   450         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   451         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   452                     DC-GREG-DATE-1-YMD.
   453             20  DC-YMD-YEAR           PIC 99.
   454             20  DC-YMD-MONTH          PIC 99.
   455             20  DC-YMD-DAY            PIC 99.
   456         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   457         16  DC-GREG-DATE-1-MDY-R REDEFINES
   458                      DC-GREG-DATE-1-MDY.
   459             20  DC-MDY-MONTH          PIC 99.
   460             20  DC-MDY-DAY            PIC 99.
   461             20  DC-MDY-YEAR           PIC 99.
   462         16  DC-GREG-DATE-1-ALPHA.
   463             20  DC-ALPHA-MONTH        PIC X(10).
   464             20  DC-ALPHA-DAY          PIC 99.
   465             20  FILLER                PIC XX.
   466             20  DC-ALPHA-CENTURY.
   467                 24 DC-ALPHA-CEN-N     PIC 99.
   468             20  DC-ALPHA-YEAR         PIC 99.
   469         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   470         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   471         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   472         16  DC-JULIAN-DATE            PIC 9(05).
   473         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  12
* EL633.cbl
   474                                       PIC 9(05).
   475         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   476             20  DC-JULIAN-YEAR        PIC 99.
   477             20  DC-JULIAN-DAYS        PIC 999.
   478         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   479         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   480         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   481     12  DATE-CONVERSION-VARIBLES.
   482         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   483         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   484             20  FILLER                PIC 9(3).
   485             20  HOLD-CEN-1-CCYY.
   486                 24  HOLD-CEN-1-CC     PIC 99.
   487                 24  HOLD-CEN-1-YY     PIC 99.
   488             20  HOLD-CEN-1-MO         PIC 99.
   489             20  HOLD-CEN-1-DA         PIC 99.
   490         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   491             20  HOLD-CEN-1-R-MO       PIC 99.
   492             20  HOLD-CEN-1-R-DA       PIC 99.
   493             20  HOLD-CEN-1-R-CCYY.
   494                 24  HOLD-CEN-1-R-CC   PIC 99.
   495                 24  HOLD-CEN-1-R-YY   PIC 99.
   496             20  FILLER                PIC 9(3).
   497         16  HOLD-CENTURY-1-X.
   498             20  FILLER                PIC X(3)  VALUE SPACES.
   499             20  HOLD-CEN-1-X-CCYY.
   500                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   501                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   502             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   503             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   504         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   505             20  HOLD-CEN-1-R-X-MO     PIC XX.
   506             20  HOLD-CEN-1-R-X-DA     PIC XX.
   507             20  HOLD-CEN-1-R-X-CCYY.
   508                 24  HOLD-CEN-1-R-X-CC PIC XX.
   509                 24  HOLD-CEN-1-R-X-YY PIC XX.
   510             20  FILLER                PIC XXX.
   511         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   512         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   513         16  DC-JULIAN-DATE-1          PIC 9(07).
   514         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   515             20  DC-JULIAN-1-CCYY.
   516                 24  DC-JULIAN-1-CC    PIC 99.
   517                 24  DC-JULIAN-1-YR    PIC 99.
   518             20  DC-JULIAN-DA-1        PIC 999.
   519         16  DC-JULIAN-DATE-2          PIC 9(07).
   520         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   521             20  DC-JULIAN-2-CCYY.
   522                 24  DC-JULIAN-2-CC    PIC 99.
   523                 24  DC-JULIAN-2-YR    PIC 99.
   524             20  DC-JULIAN-DA-2        PIC 999.
   525         16  DC-GREG-DATE-A-EDIT.
   526             20  DC-EDITA-MONTH        PIC 99.
   527             20  SLASHA-1              PIC X VALUE '/'.
   528             20  DC-EDITA-DAY          PIC 99.
   529             20  SLASHA-2              PIC X VALUE '/'.
   530             20  DC-EDITA-CCYY.
   531                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  13
* EL633.cbl
   532                 24  DC-EDITA-YEAR     PIC 99.
   533         16  DC-GREG-DATE-B-EDIT.
   534             20  DC-EDITB-MONTH        PIC 99.
   535             20  SLASHB-1              PIC X VALUE '/'.
   536             20  DC-EDITB-DAY          PIC 99.
   537             20  SLASHB-2              PIC X VALUE '/'.
   538             20  DC-EDITB-CCYY.
   539                 24  DC-EDITB-CENT     PIC 99.
   540                 24  DC-EDITB-YEAR     PIC 99.
   541         16  DC-GREG-DATE-CYMD         PIC 9(08).
   542         16  DC-GREG-DATE-CYMD-R REDEFINES
   543                              DC-GREG-DATE-CYMD.
   544             20  DC-CYMD-CEN           PIC 99.
   545             20  DC-CYMD-YEAR          PIC 99.
   546             20  DC-CYMD-MONTH         PIC 99.
   547             20  DC-CYMD-DAY           PIC 99.
   548         16  DC-GREG-DATE-MDCY         PIC 9(08).
   549         16  DC-GREG-DATE-MDCY-R REDEFINES
   550                              DC-GREG-DATE-MDCY.
   551             20  DC-MDCY-MONTH         PIC 99.
   552             20  DC-MDCY-DAY           PIC 99.
   553             20  DC-MDCY-CEN           PIC 99.
   554             20  DC-MDCY-YEAR          PIC 99.
   555    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   556        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   557    12  DC-EL310-DATE                  PIC X(21).
   558    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  14
* EL633.cbl
   560*                                    COPY ELCLOGOF.
   561******************************************************************
   562*                                                                *
   563*                                                                *
   564*                            ELCLOGOF.                           *
   565*                            VMOD=2.001                          *
   566*                                                                *
   567*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   568*                                                                *
   569******************************************************************
   570 01  CLASIC-LOGOFF.
   571     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   572     12  LOGOFF-TEXT.
   573         16  FILLER          PIC X(5)    VALUE SPACES.
   574         16  LOGOFF-MSG.
   575             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   576             20  FILLER      PIC X       VALUE SPACES.
   577             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   578         16  FILLER          PIC X(80)
   579           VALUE '* YOU ARE NOW LOGGED OFF'.
   580         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   581         16  FILLER          PIC X       VALUE QUOTE.
   582         16  LOGOFF-SYS-MSG  PIC X(17)
   583           VALUE 'S CLAS-IC SYSTEM '.
   584     12  TEXT-MESSAGES.
   585         16  UNACCESS-MSG    PIC X(29)
   586             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   587         16  PGMIDERR-MSG    PIC X(17)
   588             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  15
* EL633.cbl
   590*                                    COPY ELCATTR.
   591******************************************************************
   592*                                                                *
   593*                            ELCATTR.                            *
   594*                            VMOD=2.001                          *
   595*                                                                *
   596*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   597*                                                                *
   598*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   599*                                                                *
   600*                   POS 1   P=PROTECTED                          *
   601*                           U=UNPROTECTED                        *
   602*                           S=ASKIP                              *
   603*                   POS 2   A=ALPHA/NUMERIC                      *
   604*                           N=NUMERIC                            *
   605*                   POS 3   N=NORMAL                             *
   606*                           B=BRIGHT                             *
   607*                           D=DARK                               *
   608*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   609*                           OF=MODIFIED DATA TAG OFF             *
   610*                                                                *
   611*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   612******************************************************************
   613 01  ATTRIBUTE-LIST.
   614     12  AL-PABOF            PIC X       VALUE 'Y'.
   615     12  AL-PABON            PIC X       VALUE 'Z'.
   616     12  AL-PADOF            PIC X       VALUE '%'.
   617     12  AL-PADON            PIC X       VALUE '_'.
   618     12  AL-PANOF            PIC X       VALUE '-'.
   619     12  AL-PANON            PIC X       VALUE '/'.
   620     12  AL-SABOF            PIC X       VALUE '8'.
   621     12  AL-SABON            PIC X       VALUE '9'.
   622     12  AL-SADOF            PIC X       VALUE '@'.
   623     12  AL-SADON            PIC X       VALUE QUOTE.
   624     12  AL-SANOF            PIC X       VALUE '0'.
   625     12  AL-SANON            PIC X       VALUE '1'.
   626     12  AL-UABOF            PIC X       VALUE 'H'.
   627     12  AL-UABON            PIC X       VALUE 'I'.
   628     12  AL-UADOF            PIC X       VALUE '<'.
   629     12  AL-UADON            PIC X       VALUE '('.
   630     12  AL-UANOF            PIC X       VALUE ' '.
   631     12  AL-UANON            PIC X       VALUE 'A'.
   632     12  AL-UNBOF            PIC X       VALUE 'Q'.
   633     12  AL-UNBON            PIC X       VALUE 'R'.
   634     12  AL-UNDOF            PIC X       VALUE '*'.
   635     12  AL-UNDON            PIC X       VALUE ')'.
   636     12  AL-UNNOF            PIC X       VALUE '&'.
   637     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  16
* EL633.cbl
   639*                                    COPY ELCEMIB.
   640******************************************************************
   641*                                                                *
   642*                                                                *
   643*                            ELCEMIB.                            *
   644*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   645*                            VMOD=2.005                          *
   646*                                                                *
   647*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   648*                                                                *
   649******************************************************************
   650 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   651     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   652     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   653     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   654     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   655     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   656     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   657     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   658     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   659     12  EMI-SWITCH1             PIC X        VALUE '1'.
   660         88  EMI-NO-ERRORS                    VALUE '1'.
   661         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   662         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   663     12  EMI-SWITCH2             PIC X        VALUE '1'.
   664         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   665     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   666         88  EMI-AREA1-EMPTY                  VALUE '1'.
   667         88  EMI-AREA1-FULL                   VALUE '2'.
   668     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   669         88  EMI-AREA2-EMPTY                  VALUE '1'.
   670         88  EMI-AREA2-FULL                   VALUE '2'.
   671     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   672         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   673         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   674         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   675         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   676         88  EMI-BYPASS-FATALS                VALUE 'X'.
   677     12  EMI-ERROR-LINES.
   678         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   679         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   680         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   681         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   682             20  EMI-ERR-CODES OCCURS 10 TIMES.
   683                 24  EMI-ERR-NUM         PIC X(4).
   684                 24  EMI-FILLER          PIC X.
   685                 24  EMI-SEV             PIC X.
   686                 24  FILLER              PIC X.
   687             20  FILLER                  PIC X(02).
   688     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   689         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   690             20  EMI-ERROR-NUMBER    PIC X(4).
   691             20  EMI-FILL            PIC X.
   692             20  EMI-SEVERITY        PIC X.
   693             20  FILLER              PIC X.
   694             20  EMI-ERROR-TEXT.
   695                 24  EMI-TEXT-VARIABLE   PIC X(10).
   696                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  17
* EL633.cbl
   697     12  EMI-SEVERITY-SAVE           PIC X.
   698         88  EMI-NOTE                    VALUE 'N'.
   699         88  EMI-WARNING                 VALUE 'W'.
   700         88  EMI-FORCABLE                VALUE 'F'.
   701         88  EMI-FATAL                   VALUE 'X'.
   702     12  EMI-MESSAGE-FLAG            PIC X.
   703         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   704         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   705     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   706     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   707         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   708         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   709         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   710     12  emi-claim-no                pic x(7).
   711     12  emi-claim-type              pic x(6).
   712     12  FILLER                      PIC X(124)  VALUE SPACES.
   713     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   714     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   715     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   716     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  18
* EL633.cbl
   718*                                    COPY ELCINTF.
   719******************************************************************
   720*                                                                *
   721*                                                                *
   722*                            ELCINTF.                            *
   723*                            VMOD=2.017                          *
   724*                                                                *
   725*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   726*                                                                *
   727*       LENGTH = 1024                                            *
   728*                                                                *
   729******************************************************************
   730*                   C H A N G E   L O G
   731*
   732* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   733*-----------------------------------------------------------------
   734*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   735* EFFECTIVE    NUMBER
   736*-----------------------------------------------------------------
   737* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   738******************************************************************
   739 01  PROGRAM-INTERFACE-BLOCK.
   740     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   741     12  PI-CALLING-PROGRAM              PIC X(8).
   742     12  PI-SAVED-PROGRAM-1              PIC X(8).
   743     12  PI-SAVED-PROGRAM-2              PIC X(8).
   744     12  PI-SAVED-PROGRAM-3              PIC X(8).
   745     12  PI-SAVED-PROGRAM-4              PIC X(8).
   746     12  PI-SAVED-PROGRAM-5              PIC X(8).
   747     12  PI-SAVED-PROGRAM-6              PIC X(8).
   748     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   749     12  PI-COMPANY-ID                   PIC XXX.
   750     12  PI-COMPANY-CD                   PIC X.
   751
   752     12  PI-COMPANY-PASSWORD             PIC X(8).
   753
   754     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   755
   756     12  PI-CONTROL-IN-PROGRESS.
   757         16  PI-CARRIER                  PIC X.
   758         16  PI-GROUPING                 PIC X(6).
   759         16  PI-STATE                    PIC XX.
   760         16  PI-ACCOUNT                  PIC X(10).
   761         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   762                                         PIC X(10).
   763         16  PI-CLAIM-CERT-GRP.
   764             20  PI-CLAIM-NO             PIC X(7).
   765             20  PI-CERT-NO.
   766                 25  PI-CERT-PRIME       PIC X(10).
   767                 25  PI-CERT-SFX         PIC X.
   768             20  PI-CERT-EFF-DT          PIC XX.
   769         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   770             20  PI-PLAN-CODE            PIC X(2).
   771             20  PI-REVISION-NUMBER      PIC X(3).
   772             20  PI-PLAN-EFF-DT          PIC X(2).
   773             20  PI-PLAN-EXP-DT          PIC X(2).
   774             20  FILLER                  PIC X(11).
   775         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  19
* EL633.cbl
   776             20  PI-OE-REFERENCE-1.
   777                 25  PI-OE-REF-1-PRIME   PIC X(18).
   778                 25  PI-OE-REF-1-SUFF    PIC XX.
   779
   780     12  PI-SESSION-IN-PROGRESS          PIC X.
   781         88  CLAIM-SESSION                   VALUE '1'.
   782         88  CREDIT-SESSION                  VALUE '2'.
   783         88  WARRANTY-SESSION                VALUE '3'.
   784         88  MORTGAGE-SESSION                VALUE '4'.
   785         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   786
   787
   788*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   789
   790     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   791     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   792
   793     12  PI-CREDIT-USER                  PIC X.
   794         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   795         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   796
   797     12  PI-CLAIM-USER                   PIC X.
   798         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   799         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   800
   801     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   802         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   803         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   804         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   805         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   806         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   807
   808     12  PI-PROCESSOR-ID                 PIC X(4).
   809
   810     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   811
   812     12  PI-MEMBER-CAPTION               PIC X(10).
   813
   814     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   815         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   816
   817     12  PI-LIFE-OVERRIDE-L1             PIC X.
   818     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   819     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   820     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   821
   822     12  PI-AH-OVERRIDE-L1               PIC X.
   823     12  PI-AH-OVERRIDE-L2               PIC XX.
   824     12  PI-AH-OVERRIDE-L6               PIC X(6).
   825     12  PI-AH-OVERRIDE-L12              PIC X(12).
   826
   827     12  PI-NEW-SYSTEM                   PIC X(2).
   828
   829     12  PI-PRIMARY-CERT-NO              PIC X(11).
   830     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   831         88  PI-USES-PAID-TO                 VALUE '1'.
   832     12  PI-CRDTCRD-SYSTEM.
   833         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  20
* EL633.cbl
   834             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   835             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   836         16  PI-CC-MONTH-END-DT          PIC XX.
   837     12  PI-PROCESSOR-PRINTER            PIC X(4).
   838
   839     12  PI-OE-REFERENCE-2.
   840         16  PI-OE-REF-2-PRIME           PIC X(10).
   841         16  PI-OE-REF-2-SUFF            PIC X.
   842
   843     12  PI-REM-TRM-CALC-OPTION          PIC X.
   844
   845     12  PI-LANGUAGE-TYPE                PIC X.
   846             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   847             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   848             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   849
   850     12  PI-POLICY-LINKAGE-IND           PIC X.
   851         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   852         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   853                                                   LOW-VALUES.
   854
   855     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   856     12  PI-CLAIM-PW-SESSION             PIC X(1).
   857         88  PI-CLAIM-CREDIT                 VALUE '1'.
   858         88  PI-CLAIM-CONVEN                 VALUE '2'.
   859
   860     12  PI-PROCESSOR-CSR-IND            PIC X.
   861         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   862         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   863
   864     12  FILLER                          PIC X(3).
   865
   866     12  PI-SYSTEM-LEVEL                 PIC X(145).
   867
   868     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   869         PI-SYSTEM-LEVEL.
   870
   871         16  PI-ENTRY-CODES.
   872             20  PI-ENTRY-CD-1           PIC X.
   873             20  PI-ENTRY-CD-2           PIC X.
   874
   875         16  PI-RETURN-CODES.
   876             20  PI-RETURN-CD-1          PIC X.
   877             20  PI-RETURN-CD-2          PIC X.
   878
   879         16  PI-UPDATE-STATUS-SAVE.
   880             20  PI-UPDATE-BY            PIC X(4).
   881             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   882
   883         16  PI-LOWER-CASE-LETTERS       PIC X.
   884             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   885
   886*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   887*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   888*            88  CARRIER-CLM-CNTL            VALUE '2'.
   889
   890         16  PI-CERT-ACCESS-CONTROL      PIC X.
   891             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  21
* EL633.cbl
   892             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   893             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   894             88  ACCNT-CNTL                  VALUE '3'.
   895             88  CARR-ACCNT-CNTL             VALUE '4'.
   896
   897         16  PI-PROCESSOR-CAP-LIST.
   898             20  PI-SYSTEM-CONTROLS.
   899                24 PI-SYSTEM-DISPLAY     PIC X.
   900                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   901                24 PI-SYSTEM-MODIFY      PIC X.
   902                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   903             20  FILLER                  PIC XX.
   904             20  PI-DISPLAY-CAP          PIC X.
   905                 88  DISPLAY-CAP             VALUE 'Y'.
   906             20  PI-MODIFY-CAP           PIC X.
   907                 88  MODIFY-CAP              VALUE 'Y'.
   908             20  PI-MSG-AT-LOGON-CAP     PIC X.
   909                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   910             20  PI-FORCE-CAP            PIC X.
   911                 88  FORCE-CAP               VALUE 'Y'.
   912
   913         16  PI-PROGRAM-CONTROLS.
   914             20  PI-PGM-PRINT-OPT        PIC X.
   915             20  PI-PGM-FORMAT-OPT       PIC X.
   916             20  PI-PGM-PROCESS-OPT      PIC X.
   917             20  PI-PGM-TOTALS-OPT       PIC X.
   918
   919         16  PI-HELP-INTERFACE.
   920             20  PI-LAST-ERROR-NO        PIC X(4).
   921             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   922
   923         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   924             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   925
   926         16  PI-CR-CONTROL-IN-PROGRESS.
   927             20  PI-CR-CARRIER           PIC X.
   928             20  PI-CR-GROUPING          PIC X(6).
   929             20  PI-CR-STATE             PIC XX.
   930             20  PI-CR-ACCOUNT           PIC X(10).
   931             20  PI-CR-FIN-RESP          PIC X(10).
   932             20  PI-CR-TYPE              PIC X.
   933
   934         16  PI-CR-BATCH-NUMBER          PIC X(6).
   935
   936         16  PI-CR-MONTH-END-DT          PIC XX.
   937
   938         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   939             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   940             88  PI-ZERO-CARRIER             VALUE '1'.
   941             88  PI-ZERO-GROUPING            VALUE '2'.
   942             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   943
   944         16  PI-CARRIER-SECURITY         PIC X.
   945             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   946
   947         16  PI-ACCOUNT-SECURITY         PIC X(10).
   948             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   949             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  22
* EL633.cbl
   950
   951         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   952             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   953                                         INDEXED BY PI-ACCESS-NDX
   954                                         PIC X.
   955
   956         16  PI-GA-BILLING-CONTROL       PIC X.
   957             88  PI-GA-BILLING               VALUE '1'.
   958
   959         16  PI-MAIL-PROCESSING          PIC X.
   960             88  PI-MAIL-YES                 VALUE 'Y'.
   961
   962         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   963
   964         16  PI-AR-SYSTEM.
   965             20  PI-AR-PROCESSING-CNTL   PIC X.
   966                 88  PI-AR-PROCESSING        VALUE 'Y'.
   967             20  PI-AR-SUMMARY-CODE      PIC X(6).
   968             20  PI-AR-MONTH-END-DT      PIC XX.
   969
   970         16  PI-MP-SYSTEM.
   971             20  PI-MORTGAGE-USER            PIC X.
   972                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   973                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   974             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   975                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   976                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   977                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   978                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   979                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   980             20  PI-MP-MONTH-END-DT          PIC XX.
   981             20  PI-MP-REFERENCE-NO.
   982                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   983                 24  PI-MP-REFERENCE-SFX     PIC XX.
   984
   985         16  PI-LABEL-CONTROL            PIC X(01).
   986             88  PI-CREATE-LABELS                    VALUE 'Y'.
   987             88  PI-BYPASS-LABELS                    VALUE 'N'.
   988
   989         16  PI-BILL-GROUPING-CODE       PIC X(01).
   990             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   991
   992         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   993             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   994             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   995
   996         16  FILLER                      PIC X(14).
   997
   998     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   999******************************************************************
  1000     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1001         16  PI-PYAJ-FILE-SW             PIC  X.
  1002             88  END-OF-ACCT                 VALUE 'A'.
  1003             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
  1004             88  END-OF-FILE                 VALUE 'X'.
  1005             88  TOP-OF-FILE                 VALUE 'T'.
  1006             88  PAGE-FULL                   VALUE 'F'.
  1007             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  23
* EL633.cbl
  1008             88  NOT-OPEN                    VALUE 'Z'.
  1009         16  PI-PREV-FUNCTION            PIC  X.
  1010         16  PI-SAV-FUNCTION             PIC  X.
  1011         16  PI-PREV-PFKEY               PIC  X.
  1012         16  PI-SEQ-NOS.
  1013             20  FILLER  OCCURS 13 TIMES
  1014                             INDEXED BY NDX.
  1015                 24  PI-REC-TYPE         PIC  X.
  1016                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1017         16  PI-SAV-ENDING-PYAJ-KEY.
  1018             20  PI-SAV-COMP-CD          PIC  X.
  1019             20  PI-SAV-COMP-CONTROL.
  1020                 24  PI-SAV-CARRIER      PIC  X.
  1021                 24  PI-SAV-GROUPING     PIC  X(6).
  1022                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1023                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1024                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1025                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1026         16  PI-START-PYAJ-KEY           PIC  X(33).
  1027         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1028         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1029         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1030         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1031         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1032             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1033         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1034         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1035         16  PI-FRST-RECORD-TYPE         PIC  X.
  1036         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1037         16  PI-PREV-RECORD-TYPE         PIC  X.
  1038         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1039         16  PI-LAST-RECORD-TYPE         PIC  X.
  1040         16  PI-PAGE-SW                  PIC  X.
  1041             88  FIRST-PAGE                          VALUE 'Y'.
  1042         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  24
* EL633.cbl
  1044*                            COPY ELCJPFX.
  1045******************************************************************
  1046*                                                                *
  1047*                                                                *
  1048*                            ELCJPFX.                            *
  1049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1050*                            VMOD=2.002                          *
  1051*                                                                *
  1052*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1053*                                                                *
  1054*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1055*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1056*        ELCNTL - CONTROL FILE                                   *
  1057*        ELMSTR - CLAIM MASTERS                                  *
  1058*        ELTRLR - ACTIVITY TRAILERS                              *
  1059*        ELCHKQ - CHECK QUE                                      *
  1060******************************************************************
  1061 01  JOURNAL-RECORD.
  1062     12  jp-date                     pic s9(5) comp-3.
  1063     12  jp-time                     pic s9(7) comp-3.
  1064     12  JP-USER-ID                  PIC X(4).
  1065     12  JP-FILE-ID                  PIC X(8).
  1066     12  JP-PROGRAM-ID               PIC X(8).
  1067     12  JP-RECORD-TYPE              PIC X.
  1068         88 JP-ADD              VALUE 'A'.
  1069         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1070         88 JP-AFTER-CHANGE     VALUE 'C'.
  1071         88 JP-DELETE           VALUE 'D'.
  1072         88 JP-GENERIC-DELETE   VALUE 'G'.
  1073         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1074         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1075     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1076     12  JP-RECORD-AREA
  1077
  1078
  1079                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  25
* EL633.cbl
  1081*                            COPY ELCAID.
  1082******************************************************************
  1083*                                                                *
  1084*                            ELCAID.                             *
  1085*                            VMOD=2.001                          *
  1086*                                                                *
  1087*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1088*                                                                *
  1089*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1090*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1091******************************************************************
  1092
  1093 01  DFHAID.
  1094   02  DFHNULL   PIC  X  VALUE  ' '.
  1095   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1096   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1097   02  DFHPEN    PIC  X  VALUE  '='.
  1098   02  DFHOPID   PIC  X  VALUE  'W'.
  1099   02  DFHPA1    PIC  X  VALUE  '%'.
  1100   02  DFHPA2    PIC  X  VALUE  '>'.
  1101   02  DFHPA3    PIC  X  VALUE  ','.
  1102   02  DFHPF1    PIC  X  VALUE  '1'.
  1103   02  DFHPF2    PIC  X  VALUE  '2'.
  1104   02  DFHPF3    PIC  X  VALUE  '3'.
  1105   02  DFHPF4    PIC  X  VALUE  '4'.
  1106   02  DFHPF5    PIC  X  VALUE  '5'.
  1107   02  DFHPF6    PIC  X  VALUE  '6'.
  1108   02  DFHPF7    PIC  X  VALUE  '7'.
  1109   02  DFHPF8    PIC  X  VALUE  '8'.
  1110   02  DFHPF9    PIC  X  VALUE  '9'.
  1111   02  DFHPF10   PIC  X  VALUE  ':'.
  1112   02  DFHPF11   PIC  X  VALUE  '#'.
  1113   02  DFHPF12   PIC  X  VALUE  '@'.
  1114   02  DFHPF13   PIC  X  VALUE  'A'.
  1115   02  DFHPF14   PIC  X  VALUE  'B'.
  1116   02  DFHPF15   PIC  X  VALUE  'C'.
  1117   02  DFHPF16   PIC  X  VALUE  'D'.
  1118   02  DFHPF17   PIC  X  VALUE  'E'.
  1119   02  DFHPF18   PIC  X  VALUE  'F'.
  1120   02  DFHPF19   PIC  X  VALUE  'G'.
  1121   02  DFHPF20   PIC  X  VALUE  'H'.
  1122   02  DFHPF21   PIC  X  VALUE  'I'.
  1123*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1124   02  DFHPF22   PIC  X  VALUE  '['.
  1125   02  DFHPF23   PIC  X  VALUE  '.'.
  1126   02  DFHPF24   PIC  X  VALUE  '<'.
  1127   02  DFHMSRE   PIC  X  VALUE  'X'.
  1128   02  DFHSTRF   PIC  X  VALUE  'h'.
  1129   02  DFHTRIG   PIC  X  VALUE  '"'.
  1130
  1131 01  FILLER  REDEFINES  DFHAID.
  1132     12  FILLER              PIC  X(8).
  1133     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  26
* EL633.cbl
  1135*                            COPY EL633S.
  1136 01  EL633AI.
  1137     05  FILLER            PIC  X(0012).
  1138*    -------------------------------
  1139     05  DATEL PIC S9(0004) COMP.
  1140     05  DATEF PIC  X(0001).
  1141     05  FILLER REDEFINES DATEF.
  1142         10  DATEA PIC  X(0001).
  1143     05  DATEI PIC  X(0008).
  1144*    -------------------------------
  1145     05  TIMEL PIC S9(0004) COMP.
  1146     05  TIMEF PIC  X(0001).
  1147     05  FILLER REDEFINES TIMEF.
  1148         10  TIMEA PIC  X(0001).
  1149     05  TIMEI PIC  X(0005).
  1150*    -------------------------------
  1151     05  CMPNYIDL PIC S9(0004) COMP.
  1152     05  CMPNYIDF PIC  X(0001).
  1153     05  FILLER REDEFINES CMPNYIDF.
  1154         10  CMPNYIDA PIC  X(0001).
  1155     05  CMPNYIDI PIC  X(0003).
  1156*    -------------------------------
  1157     05  USERIDL PIC S9(0004) COMP.
  1158     05  USERIDF PIC  X(0001).
  1159     05  FILLER REDEFINES USERIDF.
  1160         10  USERIDA PIC  X(0001).
  1161     05  USERIDI PIC  X(0004).
  1162*    -------------------------------
  1163     05  MAINTL PIC S9(0004) COMP.
  1164     05  MAINTF PIC  X(0001).
  1165     05  FILLER REDEFINES MAINTF.
  1166         10  MAINTA PIC  X(0001).
  1167     05  MAINTI PIC  X(0001).
  1168*    -------------------------------
  1169     05  CARRIERL PIC S9(0004) COMP.
  1170     05  CARRIERF PIC  X(0001).
  1171     05  FILLER REDEFINES CARRIERF.
  1172         10  CARRIERA PIC  X(0001).
  1173     05  CARRIERI PIC  X(0001).
  1174*    -------------------------------
  1175     05  GROUPL PIC S9(0004) COMP.
  1176     05  GROUPF PIC  X(0001).
  1177     05  FILLER REDEFINES GROUPF.
  1178         10  GROUPA PIC  X(0001).
  1179     05  GROUPI PIC  X(0006).
  1180*    -------------------------------
  1181     05  FINRESPL PIC S9(0004) COMP.
  1182     05  FINRESPF PIC  X(0001).
  1183     05  FILLER REDEFINES FINRESPF.
  1184         10  FINRESPA PIC  X(0001).
  1185     05  FINRESPI PIC  X(0010).
  1186*    -------------------------------
  1187     05  ACCTL PIC S9(0004) COMP.
  1188     05  ACCTF PIC  X(0001).
  1189     05  FILLER REDEFINES ACCTF.
  1190         10  ACCTA PIC  X(0001).
  1191     05  ACCTI PIC  X(0010).
  1192*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  27
* EL633.cbl
  1193     05  MSAAC1L PIC S9(0004) COMP.
  1194     05  MSAAC1F PIC  X(0001).
  1195     05  FILLER REDEFINES MSAAC1F.
  1196         10  MSAAC1A PIC  X(0001).
  1197     05  MSAAC1I PIC  X(0010).
  1198*    -------------------------------
  1199     05  MSAST1L PIC S9(0004) COMP.
  1200     05  MSAST1F PIC  X(0001).
  1201     05  FILLER REDEFINES MSAST1F.
  1202         10  MSAST1A PIC  X(0001).
  1203     05  MSAST1I PIC  X(0002).
  1204*    -------------------------------
  1205     05  MSACN1L PIC S9(0004) COMP.
  1206     05  MSACN1F PIC  X(0001).
  1207     05  FILLER REDEFINES MSACN1F.
  1208         10  MSACN1A PIC  X(0001).
  1209     05  MSACN1I PIC  X(0001).
  1210*    -------------------------------
  1211     05  MSACM1L PIC S9(0004) COMP.
  1212     05  MSACM1F PIC  X(0001).
  1213     05  FILLER REDEFINES MSACM1F.
  1214         10  MSACM1A PIC  X(0001).
  1215     05  MSACM1I PIC  X(0010).
  1216*    -------------------------------
  1217     05  TYPE1L PIC S9(0004) COMP.
  1218     05  TYPE1F PIC  X(0001).
  1219     05  FILLER REDEFINES TYPE1F.
  1220         10  TYPE1A PIC  X(0001).
  1221     05  TYPE1I PIC  X(0001).
  1222*    -------------------------------
  1223     05  AMT1L PIC S9(0004) COMP.
  1224     05  AMT1F PIC  X(0001).
  1225     05  FILLER REDEFINES AMT1F.
  1226         10  AMT1A PIC  X(0001).
  1227     05  AMT1I PIC  X(0011).
  1228*    -------------------------------
  1229     05  VOID1L PIC S9(0004) COMP.
  1230     05  VOID1F PIC  X(0001).
  1231     05  FILLER REDEFINES VOID1F.
  1232         10  VOID1A PIC  X(0001).
  1233     05  VOID1I PIC  X(0001).
  1234*    -------------------------------
  1235     05  MDT1L PIC S9(0004) COMP.
  1236     05  MDT1F PIC  X(0001).
  1237     05  FILLER REDEFINES MDT1F.
  1238         10  MDT1A PIC  X(0001).
  1239     05  MDT1I PIC  X(0006).
  1240*    -------------------------------
  1241     05  BDT1L PIC S9(0004) COMP.
  1242     05  BDT1F PIC  X(0001).
  1243     05  FILLER REDEFINES BDT1F.
  1244         10  BDT1A PIC  X(0001).
  1245     05  BDT1I PIC  X(0006).
  1246*    -------------------------------
  1247     05  SDT1L PIC S9(0004) COMP.
  1248     05  SDT1F PIC  X(0001).
  1249     05  FILLER REDEFINES SDT1F.
  1250         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  28
* EL633.cbl
  1251     05  SDT1I PIC  X(0006).
  1252*    -------------------------------
  1253     05  MSAAC2L PIC S9(0004) COMP.
  1254     05  MSAAC2F PIC  X(0001).
  1255     05  FILLER REDEFINES MSAAC2F.
  1256         10  MSAAC2A PIC  X(0001).
  1257     05  MSAAC2I PIC  X(0010).
  1258*    -------------------------------
  1259     05  MSAST2L PIC S9(0004) COMP.
  1260     05  MSAST2F PIC  X(0001).
  1261     05  FILLER REDEFINES MSAST2F.
  1262         10  MSAST2A PIC  X(0001).
  1263     05  MSAST2I PIC  X(0002).
  1264*    -------------------------------
  1265     05  MSACN2L PIC S9(0004) COMP.
  1266     05  MSACN2F PIC  X(0001).
  1267     05  FILLER REDEFINES MSACN2F.
  1268         10  MSACN2A PIC  X(0001).
  1269     05  MSACN2I PIC  X(0001).
  1270*    -------------------------------
  1271     05  MSACM2L PIC S9(0004) COMP.
  1272     05  MSACM2F PIC  X(0001).
  1273     05  FILLER REDEFINES MSACM2F.
  1274         10  MSACM2A PIC  X(0001).
  1275     05  MSACM2I PIC  X(0010).
  1276*    -------------------------------
  1277     05  TYPE2L PIC S9(0004) COMP.
  1278     05  TYPE2F PIC  X(0001).
  1279     05  FILLER REDEFINES TYPE2F.
  1280         10  TYPE2A PIC  X(0001).
  1281     05  TYPE2I PIC  X(0001).
  1282*    -------------------------------
  1283     05  AMT2L PIC S9(0004) COMP.
  1284     05  AMT2F PIC  X(0001).
  1285     05  FILLER REDEFINES AMT2F.
  1286         10  AMT2A PIC  X(0001).
  1287     05  AMT2I PIC  X(0011).
  1288*    -------------------------------
  1289     05  VOID2L PIC S9(0004) COMP.
  1290     05  VOID2F PIC  X(0001).
  1291     05  FILLER REDEFINES VOID2F.
  1292         10  VOID2A PIC  X(0001).
  1293     05  VOID2I PIC  X(0001).
  1294*    -------------------------------
  1295     05  MDT2L PIC S9(0004) COMP.
  1296     05  MDT2F PIC  X(0001).
  1297     05  FILLER REDEFINES MDT2F.
  1298         10  MDT2A PIC  X(0001).
  1299     05  MDT2I PIC  X(0006).
  1300*    -------------------------------
  1301     05  BDT2L PIC S9(0004) COMP.
  1302     05  BDT2F PIC  X(0001).
  1303     05  FILLER REDEFINES BDT2F.
  1304         10  BDT2A PIC  X(0001).
  1305     05  BDT2I PIC  X(0006).
  1306*    -------------------------------
  1307     05  SDT2L PIC S9(0004) COMP.
  1308     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  29
* EL633.cbl
  1309     05  FILLER REDEFINES SDT2F.
  1310         10  SDT2A PIC  X(0001).
  1311     05  SDT2I PIC  X(0006).
  1312*    -------------------------------
  1313     05  MSAAC3L PIC S9(0004) COMP.
  1314     05  MSAAC3F PIC  X(0001).
  1315     05  FILLER REDEFINES MSAAC3F.
  1316         10  MSAAC3A PIC  X(0001).
  1317     05  MSAAC3I PIC  X(0010).
  1318*    -------------------------------
  1319     05  MSAST3L PIC S9(0004) COMP.
  1320     05  MSAST3F PIC  X(0001).
  1321     05  FILLER REDEFINES MSAST3F.
  1322         10  MSAST3A PIC  X(0001).
  1323     05  MSAST3I PIC  X(0002).
  1324*    -------------------------------
  1325     05  MSACN3L PIC S9(0004) COMP.
  1326     05  MSACN3F PIC  X(0001).
  1327     05  FILLER REDEFINES MSACN3F.
  1328         10  MSACN3A PIC  X(0001).
  1329     05  MSACN3I PIC  X(0001).
  1330*    -------------------------------
  1331     05  MSACM3L PIC S9(0004) COMP.
  1332     05  MSACM3F PIC  X(0001).
  1333     05  FILLER REDEFINES MSACM3F.
  1334         10  MSACM3A PIC  X(0001).
  1335     05  MSACM3I PIC  X(0010).
  1336*    -------------------------------
  1337     05  TYPE3L PIC S9(0004) COMP.
  1338     05  TYPE3F PIC  X(0001).
  1339     05  FILLER REDEFINES TYPE3F.
  1340         10  TYPE3A PIC  X(0001).
  1341     05  TYPE3I PIC  X(0001).
  1342*    -------------------------------
  1343     05  AMT3L PIC S9(0004) COMP.
  1344     05  AMT3F PIC  X(0001).
  1345     05  FILLER REDEFINES AMT3F.
  1346         10  AMT3A PIC  X(0001).
  1347     05  AMT3I PIC  X(0011).
  1348*    -------------------------------
  1349     05  VOID3L PIC S9(0004) COMP.
  1350     05  VOID3F PIC  X(0001).
  1351     05  FILLER REDEFINES VOID3F.
  1352         10  VOID3A PIC  X(0001).
  1353     05  VOID3I PIC  X(0001).
  1354*    -------------------------------
  1355     05  MDT3L PIC S9(0004) COMP.
  1356     05  MDT3F PIC  X(0001).
  1357     05  FILLER REDEFINES MDT3F.
  1358         10  MDT3A PIC  X(0001).
  1359     05  MDT3I PIC  X(0006).
  1360*    -------------------------------
  1361     05  BDT3L PIC S9(0004) COMP.
  1362     05  BDT3F PIC  X(0001).
  1363     05  FILLER REDEFINES BDT3F.
  1364         10  BDT3A PIC  X(0001).
  1365     05  BDT3I PIC  X(0006).
  1366*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  30
* EL633.cbl
  1367     05  SDT3L PIC S9(0004) COMP.
  1368     05  SDT3F PIC  X(0001).
  1369     05  FILLER REDEFINES SDT3F.
  1370         10  SDT3A PIC  X(0001).
  1371     05  SDT3I PIC  X(0006).
  1372*    -------------------------------
  1373     05  MSAAC4L PIC S9(0004) COMP.
  1374     05  MSAAC4F PIC  X(0001).
  1375     05  FILLER REDEFINES MSAAC4F.
  1376         10  MSAAC4A PIC  X(0001).
  1377     05  MSAAC4I PIC  X(0010).
  1378*    -------------------------------
  1379     05  MSAST4L PIC S9(0004) COMP.
  1380     05  MSAST4F PIC  X(0001).
  1381     05  FILLER REDEFINES MSAST4F.
  1382         10  MSAST4A PIC  X(0001).
  1383     05  MSAST4I PIC  X(0002).
  1384*    -------------------------------
  1385     05  MSACN4L PIC S9(0004) COMP.
  1386     05  MSACN4F PIC  X(0001).
  1387     05  FILLER REDEFINES MSACN4F.
  1388         10  MSACN4A PIC  X(0001).
  1389     05  MSACN4I PIC  X(0001).
  1390*    -------------------------------
  1391     05  MSACM4L PIC S9(0004) COMP.
  1392     05  MSACM4F PIC  X(0001).
  1393     05  FILLER REDEFINES MSACM4F.
  1394         10  MSACM4A PIC  X(0001).
  1395     05  MSACM4I PIC  X(0010).
  1396*    -------------------------------
  1397     05  TYPE4L PIC S9(0004) COMP.
  1398     05  TYPE4F PIC  X(0001).
  1399     05  FILLER REDEFINES TYPE4F.
  1400         10  TYPE4A PIC  X(0001).
  1401     05  TYPE4I PIC  X(0001).
  1402*    -------------------------------
  1403     05  AMT4L PIC S9(0004) COMP.
  1404     05  AMT4F PIC  X(0001).
  1405     05  FILLER REDEFINES AMT4F.
  1406         10  AMT4A PIC  X(0001).
  1407     05  AMT4I PIC  X(0011).
  1408*    -------------------------------
  1409     05  VOID4L PIC S9(0004) COMP.
  1410     05  VOID4F PIC  X(0001).
  1411     05  FILLER REDEFINES VOID4F.
  1412         10  VOID4A PIC  X(0001).
  1413     05  VOID4I PIC  X(0001).
  1414*    -------------------------------
  1415     05  MDT4L PIC S9(0004) COMP.
  1416     05  MDT4F PIC  X(0001).
  1417     05  FILLER REDEFINES MDT4F.
  1418         10  MDT4A PIC  X(0001).
  1419     05  MDT4I PIC  X(0006).
  1420*    -------------------------------
  1421     05  BDT4L PIC S9(0004) COMP.
  1422     05  BDT4F PIC  X(0001).
  1423     05  FILLER REDEFINES BDT4F.
  1424         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  31
* EL633.cbl
  1425     05  BDT4I PIC  X(0006).
  1426*    -------------------------------
  1427     05  SDT4L PIC S9(0004) COMP.
  1428     05  SDT4F PIC  X(0001).
  1429     05  FILLER REDEFINES SDT4F.
  1430         10  SDT4A PIC  X(0001).
  1431     05  SDT4I PIC  X(0006).
  1432*    -------------------------------
  1433     05  MSAAC5L PIC S9(0004) COMP.
  1434     05  MSAAC5F PIC  X(0001).
  1435     05  FILLER REDEFINES MSAAC5F.
  1436         10  MSAAC5A PIC  X(0001).
  1437     05  MSAAC5I PIC  X(0010).
  1438*    -------------------------------
  1439     05  MSAST5L PIC S9(0004) COMP.
  1440     05  MSAST5F PIC  X(0001).
  1441     05  FILLER REDEFINES MSAST5F.
  1442         10  MSAST5A PIC  X(0001).
  1443     05  MSAST5I PIC  X(0002).
  1444*    -------------------------------
  1445     05  MSACN5L PIC S9(0004) COMP.
  1446     05  MSACN5F PIC  X(0001).
  1447     05  FILLER REDEFINES MSACN5F.
  1448         10  MSACN5A PIC  X(0001).
  1449     05  MSACN5I PIC  X(0001).
  1450*    -------------------------------
  1451     05  MSACM5L PIC S9(0004) COMP.
  1452     05  MSACM5F PIC  X(0001).
  1453     05  FILLER REDEFINES MSACM5F.
  1454         10  MSACM5A PIC  X(0001).
  1455     05  MSACM5I PIC  X(0010).
  1456*    -------------------------------
  1457     05  TYPE5L PIC S9(0004) COMP.
  1458     05  TYPE5F PIC  X(0001).
  1459     05  FILLER REDEFINES TYPE5F.
  1460         10  TYPE5A PIC  X(0001).
  1461     05  TYPE5I PIC  X(0001).
  1462*    -------------------------------
  1463     05  AMT5L PIC S9(0004) COMP.
  1464     05  AMT5F PIC  X(0001).
  1465     05  FILLER REDEFINES AMT5F.
  1466         10  AMT5A PIC  X(0001).
  1467     05  AMT5I PIC  X(0011).
  1468*    -------------------------------
  1469     05  VOID5L PIC S9(0004) COMP.
  1470     05  VOID5F PIC  X(0001).
  1471     05  FILLER REDEFINES VOID5F.
  1472         10  VOID5A PIC  X(0001).
  1473     05  VOID5I PIC  X(0001).
  1474*    -------------------------------
  1475     05  MDT5L PIC S9(0004) COMP.
  1476     05  MDT5F PIC  X(0001).
  1477     05  FILLER REDEFINES MDT5F.
  1478         10  MDT5A PIC  X(0001).
  1479     05  MDT5I PIC  X(0006).
  1480*    -------------------------------
  1481     05  BDT5L PIC S9(0004) COMP.
  1482     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  32
* EL633.cbl
  1483     05  FILLER REDEFINES BDT5F.
  1484         10  BDT5A PIC  X(0001).
  1485     05  BDT5I PIC  X(0006).
  1486*    -------------------------------
  1487     05  SDT5L PIC S9(0004) COMP.
  1488     05  SDT5F PIC  X(0001).
  1489     05  FILLER REDEFINES SDT5F.
  1490         10  SDT5A PIC  X(0001).
  1491     05  SDT5I PIC  X(0006).
  1492*    -------------------------------
  1493     05  MSAAC6L PIC S9(0004) COMP.
  1494     05  MSAAC6F PIC  X(0001).
  1495     05  FILLER REDEFINES MSAAC6F.
  1496         10  MSAAC6A PIC  X(0001).
  1497     05  MSAAC6I PIC  X(0010).
  1498*    -------------------------------
  1499     05  MSAST6L PIC S9(0004) COMP.
  1500     05  MSAST6F PIC  X(0001).
  1501     05  FILLER REDEFINES MSAST6F.
  1502         10  MSAST6A PIC  X(0001).
  1503     05  MSAST6I PIC  X(0002).
  1504*    -------------------------------
  1505     05  MSACN6L PIC S9(0004) COMP.
  1506     05  MSACN6F PIC  X(0001).
  1507     05  FILLER REDEFINES MSACN6F.
  1508         10  MSACN6A PIC  X(0001).
  1509     05  MSACN6I PIC  X(0001).
  1510*    -------------------------------
  1511     05  MSACM6L PIC S9(0004) COMP.
  1512     05  MSACM6F PIC  X(0001).
  1513     05  FILLER REDEFINES MSACM6F.
  1514         10  MSACM6A PIC  X(0001).
  1515     05  MSACM6I PIC  X(0010).
  1516*    -------------------------------
  1517     05  TYPE6L PIC S9(0004) COMP.
  1518     05  TYPE6F PIC  X(0001).
  1519     05  FILLER REDEFINES TYPE6F.
  1520         10  TYPE6A PIC  X(0001).
  1521     05  TYPE6I PIC  X(0001).
  1522*    -------------------------------
  1523     05  AMT6L PIC S9(0004) COMP.
  1524     05  AMT6F PIC  X(0001).
  1525     05  FILLER REDEFINES AMT6F.
  1526         10  AMT6A PIC  X(0001).
  1527     05  AMT6I PIC  X(0011).
  1528*    -------------------------------
  1529     05  VOID6L PIC S9(0004) COMP.
  1530     05  VOID6F PIC  X(0001).
  1531     05  FILLER REDEFINES VOID6F.
  1532         10  VOID6A PIC  X(0001).
  1533     05  VOID6I PIC  X(0001).
  1534*    -------------------------------
  1535     05  MDT6L PIC S9(0004) COMP.
  1536     05  MDT6F PIC  X(0001).
  1537     05  FILLER REDEFINES MDT6F.
  1538         10  MDT6A PIC  X(0001).
  1539     05  MDT6I PIC  X(0006).
  1540*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  33
* EL633.cbl
  1541     05  BDT6L PIC S9(0004) COMP.
  1542     05  BDT6F PIC  X(0001).
  1543     05  FILLER REDEFINES BDT6F.
  1544         10  BDT6A PIC  X(0001).
  1545     05  BDT6I PIC  X(0006).
  1546*    -------------------------------
  1547     05  SDT6L PIC S9(0004) COMP.
  1548     05  SDT6F PIC  X(0001).
  1549     05  FILLER REDEFINES SDT6F.
  1550         10  SDT6A PIC  X(0001).
  1551     05  SDT6I PIC  X(0006).
  1552*    -------------------------------
  1553     05  MSAAC7L PIC S9(0004) COMP.
  1554     05  MSAAC7F PIC  X(0001).
  1555     05  FILLER REDEFINES MSAAC7F.
  1556         10  MSAAC7A PIC  X(0001).
  1557     05  MSAAC7I PIC  X(0010).
  1558*    -------------------------------
  1559     05  MSAST7L PIC S9(0004) COMP.
  1560     05  MSAST7F PIC  X(0001).
  1561     05  FILLER REDEFINES MSAST7F.
  1562         10  MSAST7A PIC  X(0001).
  1563     05  MSAST7I PIC  X(0002).
  1564*    -------------------------------
  1565     05  MSACN7L PIC S9(0004) COMP.
  1566     05  MSACN7F PIC  X(0001).
  1567     05  FILLER REDEFINES MSACN7F.
  1568         10  MSACN7A PIC  X(0001).
  1569     05  MSACN7I PIC  X(0001).
  1570*    -------------------------------
  1571     05  MSACM7L PIC S9(0004) COMP.
  1572     05  MSACM7F PIC  X(0001).
  1573     05  FILLER REDEFINES MSACM7F.
  1574         10  MSACM7A PIC  X(0001).
  1575     05  MSACM7I PIC  X(0010).
  1576*    -------------------------------
  1577     05  TYPE7L PIC S9(0004) COMP.
  1578     05  TYPE7F PIC  X(0001).
  1579     05  FILLER REDEFINES TYPE7F.
  1580         10  TYPE7A PIC  X(0001).
  1581     05  TYPE7I PIC  X(0001).
  1582*    -------------------------------
  1583     05  AMT7L PIC S9(0004) COMP.
  1584     05  AMT7F PIC  X(0001).
  1585     05  FILLER REDEFINES AMT7F.
  1586         10  AMT7A PIC  X(0001).
  1587     05  AMT7I PIC  X(0011).
  1588*    -------------------------------
  1589     05  VOID7L PIC S9(0004) COMP.
  1590     05  VOID7F PIC  X(0001).
  1591     05  FILLER REDEFINES VOID7F.
  1592         10  VOID7A PIC  X(0001).
  1593     05  VOID7I PIC  X(0001).
  1594*    -------------------------------
  1595     05  MDT7L PIC S9(0004) COMP.
  1596     05  MDT7F PIC  X(0001).
  1597     05  FILLER REDEFINES MDT7F.
  1598         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  34
* EL633.cbl
  1599     05  MDT7I PIC  X(0006).
  1600*    -------------------------------
  1601     05  BDT7L PIC S9(0004) COMP.
  1602     05  BDT7F PIC  X(0001).
  1603     05  FILLER REDEFINES BDT7F.
  1604         10  BDT7A PIC  X(0001).
  1605     05  BDT7I PIC  X(0006).
  1606*    -------------------------------
  1607     05  SDT7L PIC S9(0004) COMP.
  1608     05  SDT7F PIC  X(0001).
  1609     05  FILLER REDEFINES SDT7F.
  1610         10  SDT7A PIC  X(0001).
  1611     05  SDT7I PIC  X(0006).
  1612*    -------------------------------
  1613     05  MSAAC8L PIC S9(0004) COMP.
  1614     05  MSAAC8F PIC  X(0001).
  1615     05  FILLER REDEFINES MSAAC8F.
  1616         10  MSAAC8A PIC  X(0001).
  1617     05  MSAAC8I PIC  X(0010).
  1618*    -------------------------------
  1619     05  MSAST8L PIC S9(0004) COMP.
  1620     05  MSAST8F PIC  X(0001).
  1621     05  FILLER REDEFINES MSAST8F.
  1622         10  MSAST8A PIC  X(0001).
  1623     05  MSAST8I PIC  X(0002).
  1624*    -------------------------------
  1625     05  MSACN8L PIC S9(0004) COMP.
  1626     05  MSACN8F PIC  X(0001).
  1627     05  FILLER REDEFINES MSACN8F.
  1628         10  MSACN8A PIC  X(0001).
  1629     05  MSACN8I PIC  X(0001).
  1630*    -------------------------------
  1631     05  MSACM8L PIC S9(0004) COMP.
  1632     05  MSACM8F PIC  X(0001).
  1633     05  FILLER REDEFINES MSACM8F.
  1634         10  MSACM8A PIC  X(0001).
  1635     05  MSACM8I PIC  X(0010).
  1636*    -------------------------------
  1637     05  TYPE8L PIC S9(0004) COMP.
  1638     05  TYPE8F PIC  X(0001).
  1639     05  FILLER REDEFINES TYPE8F.
  1640         10  TYPE8A PIC  X(0001).
  1641     05  TYPE8I PIC  X(0001).
  1642*    -------------------------------
  1643     05  AMT8L PIC S9(0004) COMP.
  1644     05  AMT8F PIC  X(0001).
  1645     05  FILLER REDEFINES AMT8F.
  1646         10  AMT8A PIC  X(0001).
  1647     05  AMT8I PIC  X(0011).
  1648*    -------------------------------
  1649     05  VOID8L PIC S9(0004) COMP.
  1650     05  VOID8F PIC  X(0001).
  1651     05  FILLER REDEFINES VOID8F.
  1652         10  VOID8A PIC  X(0001).
  1653     05  VOID8I PIC  X(0001).
  1654*    -------------------------------
  1655     05  MDT8L PIC S9(0004) COMP.
  1656     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  35
* EL633.cbl
  1657     05  FILLER REDEFINES MDT8F.
  1658         10  MDT8A PIC  X(0001).
  1659     05  MDT8I PIC  X(0006).
  1660*    -------------------------------
  1661     05  BDT8L PIC S9(0004) COMP.
  1662     05  BDT8F PIC  X(0001).
  1663     05  FILLER REDEFINES BDT8F.
  1664         10  BDT8A PIC  X(0001).
  1665     05  BDT8I PIC  X(0006).
  1666*    -------------------------------
  1667     05  SDT8L PIC S9(0004) COMP.
  1668     05  SDT8F PIC  X(0001).
  1669     05  FILLER REDEFINES SDT8F.
  1670         10  SDT8A PIC  X(0001).
  1671     05  SDT8I PIC  X(0006).
  1672*    -------------------------------
  1673     05  MSAAC9L PIC S9(0004) COMP.
  1674     05  MSAAC9F PIC  X(0001).
  1675     05  FILLER REDEFINES MSAAC9F.
  1676         10  MSAAC9A PIC  X(0001).
  1677     05  MSAAC9I PIC  X(0010).
  1678*    -------------------------------
  1679     05  MSAST9L PIC S9(0004) COMP.
  1680     05  MSAST9F PIC  X(0001).
  1681     05  FILLER REDEFINES MSAST9F.
  1682         10  MSAST9A PIC  X(0001).
  1683     05  MSAST9I PIC  X(0002).
  1684*    -------------------------------
  1685     05  MSACN9L PIC S9(0004) COMP.
  1686     05  MSACN9F PIC  X(0001).
  1687     05  FILLER REDEFINES MSACN9F.
  1688         10  MSACN9A PIC  X(0001).
  1689     05  MSACN9I PIC  X(0001).
  1690*    -------------------------------
  1691     05  MSACM9L PIC S9(0004) COMP.
  1692     05  MSACM9F PIC  X(0001).
  1693     05  FILLER REDEFINES MSACM9F.
  1694         10  MSACM9A PIC  X(0001).
  1695     05  MSACM9I PIC  X(0010).
  1696*    -------------------------------
  1697     05  TYPE9L PIC S9(0004) COMP.
  1698     05  TYPE9F PIC  X(0001).
  1699     05  FILLER REDEFINES TYPE9F.
  1700         10  TYPE9A PIC  X(0001).
  1701     05  TYPE9I PIC  X(0001).
  1702*    -------------------------------
  1703     05  AMT9L PIC S9(0004) COMP.
  1704     05  AMT9F PIC  X(0001).
  1705     05  FILLER REDEFINES AMT9F.
  1706         10  AMT9A PIC  X(0001).
  1707     05  AMT9I PIC  X(0011).
  1708*    -------------------------------
  1709     05  VOID9L PIC S9(0004) COMP.
  1710     05  VOID9F PIC  X(0001).
  1711     05  FILLER REDEFINES VOID9F.
  1712         10  VOID9A PIC  X(0001).
  1713     05  VOID9I PIC  X(0001).
  1714*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  36
* EL633.cbl
  1715     05  MDT9L PIC S9(0004) COMP.
  1716     05  MDT9F PIC  X(0001).
  1717     05  FILLER REDEFINES MDT9F.
  1718         10  MDT9A PIC  X(0001).
  1719     05  MDT9I PIC  X(0006).
  1720*    -------------------------------
  1721     05  BDT9L PIC S9(0004) COMP.
  1722     05  BDT9F PIC  X(0001).
  1723     05  FILLER REDEFINES BDT9F.
  1724         10  BDT9A PIC  X(0001).
  1725     05  BDT9I PIC  X(0006).
  1726*    -------------------------------
  1727     05  SDT9L PIC S9(0004) COMP.
  1728     05  SDT9F PIC  X(0001).
  1729     05  FILLER REDEFINES SDT9F.
  1730         10  SDT9A PIC  X(0001).
  1731     05  SDT9I PIC  X(0006).
  1732*    -------------------------------
  1733     05  MSAAC10L PIC S9(0004) COMP.
  1734     05  MSAAC10F PIC  X(0001).
  1735     05  FILLER REDEFINES MSAAC10F.
  1736         10  MSAAC10A PIC  X(0001).
  1737     05  MSAAC10I PIC  X(0010).
  1738*    -------------------------------
  1739     05  MSAST10L PIC S9(0004) COMP.
  1740     05  MSAST10F PIC  X(0001).
  1741     05  FILLER REDEFINES MSAST10F.
  1742         10  MSAST10A PIC  X(0001).
  1743     05  MSAST10I PIC  X(0002).
  1744*    -------------------------------
  1745     05  MSACN10L PIC S9(0004) COMP.
  1746     05  MSACN10F PIC  X(0001).
  1747     05  FILLER REDEFINES MSACN10F.
  1748         10  MSACN10A PIC  X(0001).
  1749     05  MSACN10I PIC  X(0001).
  1750*    -------------------------------
  1751     05  MSACM10L PIC S9(0004) COMP.
  1752     05  MSACM10F PIC  X(0001).
  1753     05  FILLER REDEFINES MSACM10F.
  1754         10  MSACM10A PIC  X(0001).
  1755     05  MSACM10I PIC  X(0010).
  1756*    -------------------------------
  1757     05  TYPE10L PIC S9(0004) COMP.
  1758     05  TYPE10F PIC  X(0001).
  1759     05  FILLER REDEFINES TYPE10F.
  1760         10  TYPE10A PIC  X(0001).
  1761     05  TYPE10I PIC  X(0001).
  1762*    -------------------------------
  1763     05  AMT10L PIC S9(0004) COMP.
  1764     05  AMT10F PIC  X(0001).
  1765     05  FILLER REDEFINES AMT10F.
  1766         10  AMT10A PIC  X(0001).
  1767     05  AMT10I PIC  X(0011).
  1768*    -------------------------------
  1769     05  VOID10L PIC S9(0004) COMP.
  1770     05  VOID10F PIC  X(0001).
  1771     05  FILLER REDEFINES VOID10F.
  1772         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  37
* EL633.cbl
  1773     05  VOID10I PIC  X(0001).
  1774*    -------------------------------
  1775     05  MDT10L PIC S9(0004) COMP.
  1776     05  MDT10F PIC  X(0001).
  1777     05  FILLER REDEFINES MDT10F.
  1778         10  MDT10A PIC  X(0001).
  1779     05  MDT10I PIC  X(0006).
  1780*    -------------------------------
  1781     05  BDT10L PIC S9(0004) COMP.
  1782     05  BDT10F PIC  X(0001).
  1783     05  FILLER REDEFINES BDT10F.
  1784         10  BDT10A PIC  X(0001).
  1785     05  BDT10I PIC  X(0006).
  1786*    -------------------------------
  1787     05  SDT10L PIC S9(0004) COMP.
  1788     05  SDT10F PIC  X(0001).
  1789     05  FILLER REDEFINES SDT10F.
  1790         10  SDT10A PIC  X(0001).
  1791     05  SDT10I PIC  X(0006).
  1792*    -------------------------------
  1793     05  MSAAC11L PIC S9(0004) COMP.
  1794     05  MSAAC11F PIC  X(0001).
  1795     05  FILLER REDEFINES MSAAC11F.
  1796         10  MSAAC11A PIC  X(0001).
  1797     05  MSAAC11I PIC  X(0010).
  1798*    -------------------------------
  1799     05  MSAST11L PIC S9(0004) COMP.
  1800     05  MSAST11F PIC  X(0001).
  1801     05  FILLER REDEFINES MSAST11F.
  1802         10  MSAST11A PIC  X(0001).
  1803     05  MSAST11I PIC  X(0002).
  1804*    -------------------------------
  1805     05  MSACN11L PIC S9(0004) COMP.
  1806     05  MSACN11F PIC  X(0001).
  1807     05  FILLER REDEFINES MSACN11F.
  1808         10  MSACN11A PIC  X(0001).
  1809     05  MSACN11I PIC  X(0001).
  1810*    -------------------------------
  1811     05  MSACM11L PIC S9(0004) COMP.
  1812     05  MSACM11F PIC  X(0001).
  1813     05  FILLER REDEFINES MSACM11F.
  1814         10  MSACM11A PIC  X(0001).
  1815     05  MSACM11I PIC  X(0010).
  1816*    -------------------------------
  1817     05  TYPE11L PIC S9(0004) COMP.
  1818     05  TYPE11F PIC  X(0001).
  1819     05  FILLER REDEFINES TYPE11F.
  1820         10  TYPE11A PIC  X(0001).
  1821     05  TYPE11I PIC  X(0001).
  1822*    -------------------------------
  1823     05  AMT11L PIC S9(0004) COMP.
  1824     05  AMT11F PIC  X(0001).
  1825     05  FILLER REDEFINES AMT11F.
  1826         10  AMT11A PIC  X(0001).
  1827     05  AMT11I PIC  X(0011).
  1828*    -------------------------------
  1829     05  VOID11L PIC S9(0004) COMP.
  1830     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  38
* EL633.cbl
  1831     05  FILLER REDEFINES VOID11F.
  1832         10  VOID11A PIC  X(0001).
  1833     05  VOID11I PIC  X(0001).
  1834*    -------------------------------
  1835     05  MDT11L PIC S9(0004) COMP.
  1836     05  MDT11F PIC  X(0001).
  1837     05  FILLER REDEFINES MDT11F.
  1838         10  MDT11A PIC  X(0001).
  1839     05  MDT11I PIC  X(0006).
  1840*    -------------------------------
  1841     05  BDT11L PIC S9(0004) COMP.
  1842     05  BDT11F PIC  X(0001).
  1843     05  FILLER REDEFINES BDT11F.
  1844         10  BDT11A PIC  X(0001).
  1845     05  BDT11I PIC  X(0006).
  1846*    -------------------------------
  1847     05  SDT11L PIC S9(0004) COMP.
  1848     05  SDT11F PIC  X(0001).
  1849     05  FILLER REDEFINES SDT11F.
  1850         10  SDT11A PIC  X(0001).
  1851     05  SDT11I PIC  X(0006).
  1852*    -------------------------------
  1853     05  MSAAC12L PIC S9(0004) COMP.
  1854     05  MSAAC12F PIC  X(0001).
  1855     05  FILLER REDEFINES MSAAC12F.
  1856         10  MSAAC12A PIC  X(0001).
  1857     05  MSAAC12I PIC  X(0010).
  1858*    -------------------------------
  1859     05  MSAST12L PIC S9(0004) COMP.
  1860     05  MSAST12F PIC  X(0001).
  1861     05  FILLER REDEFINES MSAST12F.
  1862         10  MSAST12A PIC  X(0001).
  1863     05  MSAST12I PIC  X(0002).
  1864*    -------------------------------
  1865     05  MSACN12L PIC S9(0004) COMP.
  1866     05  MSACN12F PIC  X(0001).
  1867     05  FILLER REDEFINES MSACN12F.
  1868         10  MSACN12A PIC  X(0001).
  1869     05  MSACN12I PIC  X(0001).
  1870*    -------------------------------
  1871     05  MSACM12L PIC S9(0004) COMP.
  1872     05  MSACM12F PIC  X(0001).
  1873     05  FILLER REDEFINES MSACM12F.
  1874         10  MSACM12A PIC  X(0001).
  1875     05  MSACM12I PIC  X(0010).
  1876*    -------------------------------
  1877     05  TYPE12L PIC S9(0004) COMP.
  1878     05  TYPE12F PIC  X(0001).
  1879     05  FILLER REDEFINES TYPE12F.
  1880         10  TYPE12A PIC  X(0001).
  1881     05  TYPE12I PIC  X(0001).
  1882*    -------------------------------
  1883     05  AMT12L PIC S9(0004) COMP.
  1884     05  AMT12F PIC  X(0001).
  1885     05  FILLER REDEFINES AMT12F.
  1886         10  AMT12A PIC  X(0001).
  1887     05  AMT12I PIC  X(0011).
  1888*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  39
* EL633.cbl
  1889     05  VOID12L PIC S9(0004) COMP.
  1890     05  VOID12F PIC  X(0001).
  1891     05  FILLER REDEFINES VOID12F.
  1892         10  VOID12A PIC  X(0001).
  1893     05  VOID12I PIC  X(0001).
  1894*    -------------------------------
  1895     05  MDT12L PIC S9(0004) COMP.
  1896     05  MDT12F PIC  X(0001).
  1897     05  FILLER REDEFINES MDT12F.
  1898         10  MDT12A PIC  X(0001).
  1899     05  MDT12I PIC  X(0006).
  1900*    -------------------------------
  1901     05  BDT12L PIC S9(0004) COMP.
  1902     05  BDT12F PIC  X(0001).
  1903     05  FILLER REDEFINES BDT12F.
  1904         10  BDT12A PIC  X(0001).
  1905     05  BDT12I PIC  X(0006).
  1906*    -------------------------------
  1907     05  SDT12L PIC S9(0004) COMP.
  1908     05  SDT12F PIC  X(0001).
  1909     05  FILLER REDEFINES SDT12F.
  1910         10  SDT12A PIC  X(0001).
  1911     05  SDT12I PIC  X(0006).
  1912*    -------------------------------
  1913     05  MSAAC13L PIC S9(0004) COMP.
  1914     05  MSAAC13F PIC  X(0001).
  1915     05  FILLER REDEFINES MSAAC13F.
  1916         10  MSAAC13A PIC  X(0001).
  1917     05  MSAAC13I PIC  X(0010).
  1918*    -------------------------------
  1919     05  MSAST13L PIC S9(0004) COMP.
  1920     05  MSAST13F PIC  X(0001).
  1921     05  FILLER REDEFINES MSAST13F.
  1922         10  MSAST13A PIC  X(0001).
  1923     05  MSAST13I PIC  X(0002).
  1924*    -------------------------------
  1925     05  MSACN13L PIC S9(0004) COMP.
  1926     05  MSACN13F PIC  X(0001).
  1927     05  FILLER REDEFINES MSACN13F.
  1928         10  MSACN13A PIC  X(0001).
  1929     05  MSACN13I PIC  X(0001).
  1930*    -------------------------------
  1931     05  MSACM13L PIC S9(0004) COMP.
  1932     05  MSACM13F PIC  X(0001).
  1933     05  FILLER REDEFINES MSACM13F.
  1934         10  MSACM13A PIC  X(0001).
  1935     05  MSACM13I PIC  X(0010).
  1936*    -------------------------------
  1937     05  TYPE13L PIC S9(0004) COMP.
  1938     05  TYPE13F PIC  X(0001).
  1939     05  FILLER REDEFINES TYPE13F.
  1940         10  TYPE13A PIC  X(0001).
  1941     05  TYPE13I PIC  X(0001).
  1942*    -------------------------------
  1943     05  AMT13L PIC S9(0004) COMP.
  1944     05  AMT13F PIC  X(0001).
  1945     05  FILLER REDEFINES AMT13F.
  1946         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  40
* EL633.cbl
  1947     05  AMT13I PIC  X(0011).
  1948*    -------------------------------
  1949     05  VOID13L PIC S9(0004) COMP.
  1950     05  VOID13F PIC  X(0001).
  1951     05  FILLER REDEFINES VOID13F.
  1952         10  VOID13A PIC  X(0001).
  1953     05  VOID13I PIC  X(0001).
  1954*    -------------------------------
  1955     05  MDT13L PIC S9(0004) COMP.
  1956     05  MDT13F PIC  X(0001).
  1957     05  FILLER REDEFINES MDT13F.
  1958         10  MDT13A PIC  X(0001).
  1959     05  MDT13I PIC  X(0006).
  1960*    -------------------------------
  1961     05  BDT13L PIC S9(0004) COMP.
  1962     05  BDT13F PIC  X(0001).
  1963     05  FILLER REDEFINES BDT13F.
  1964         10  BDT13A PIC  X(0001).
  1965     05  BDT13I PIC  X(0006).
  1966*    -------------------------------
  1967     05  SDT13L PIC S9(0004) COMP.
  1968     05  SDT13F PIC  X(0001).
  1969     05  FILLER REDEFINES SDT13F.
  1970         10  SDT13A PIC  X(0001).
  1971     05  SDT13I PIC  X(0006).
  1972*    -------------------------------
  1973     05  ERRMSG1L PIC S9(0004) COMP.
  1974     05  ERRMSG1F PIC  X(0001).
  1975     05  FILLER REDEFINES ERRMSG1F.
  1976         10  ERRMSG1A PIC  X(0001).
  1977     05  ERRMSG1I PIC  X(0079).
  1978*    -------------------------------
  1979     05  ERRMSG2L PIC S9(0004) COMP.
  1980     05  ERRMSG2F PIC  X(0001).
  1981     05  FILLER REDEFINES ERRMSG2F.
  1982         10  ERRMSG2A PIC  X(0001).
  1983     05  ERRMSG2I PIC  X(0079).
  1984*    -------------------------------
  1985     05  PFENTERL PIC S9(0004) COMP.
  1986     05  PFENTERF PIC  X(0001).
  1987     05  FILLER REDEFINES PFENTERF.
  1988         10  PFENTERA PIC  X(0001).
  1989     05  PFENTERI PIC  9(2).
  1990 01  EL633AO REDEFINES EL633AI.
  1991     05  FILLER            PIC  X(0012).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  DATEO PIC  X(0008).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  TIMEO PIC  99.99.
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  CMPNYIDO PIC  X(0003).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  USERIDO PIC  X(0004).
  2004*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  41
* EL633.cbl
  2005     05  FILLER            PIC  X(0003).
  2006     05  MAINTO PIC  X(0001).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  CARRIERO PIC  X(0001).
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  GROUPO PIC  X(0006).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  FINRESPO PIC  X(0010).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  ACCTO PIC  X(0010).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  MSAAC1O PIC  X(0010).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  MSAST1O PIC  X(0002).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  MSACN1O PIC  X(0001).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  MSACM1O PIC  X(0010).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  TYPE1O PIC  X(0001).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  AMT1O PIC  X(0011).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  VOID1O PIC  X(0001).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  MDT1O PIC  X(0006).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  BDT1O PIC  X(0006).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  SDT1O PIC  X(0006).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  MSAAC2O PIC  X(0010).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  MSAST2O PIC  X(0002).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  MSACN2O PIC  X(0001).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  MSACM2O PIC  X(0010).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  42
* EL633.cbl
  2063     05  TYPE2O PIC  X(0001).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  AMT2O PIC  X(0011).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  VOID2O PIC  X(0001).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  MDT2O PIC  X(0006).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  BDT2O PIC  X(0006).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  SDT2O PIC  X(0006).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  MSAAC3O PIC  X(0010).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  MSAST3O PIC  X(0002).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  MSACN3O PIC  X(0001).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  MSACM3O PIC  X(0010).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  TYPE3O PIC  X(0001).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  AMT3O PIC  X(0011).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  VOID3O PIC  X(0001).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  MDT3O PIC  X(0006).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  BDT3O PIC  X(0006).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  SDT3O PIC  X(0006).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  MSAAC4O PIC  X(0010).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  MSAST4O PIC  X(0002).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  MSACN4O PIC  X(0001).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  43
* EL633.cbl
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  TYPE4O PIC  X(0001).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  AMT4O PIC  X(0011).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  VOID4O PIC  X(0001).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  MDT4O PIC  X(0006).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  BDT4O PIC  X(0006).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  SDT4O PIC  X(0006).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  MSAAC5O PIC  X(0010).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  MSAST5O PIC  X(0002).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  MSACN5O PIC  X(0001).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  MSACM5O PIC  X(0010).
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  TYPE5O PIC  X(0001).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  AMT5O PIC  X(0011).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  VOID5O PIC  X(0001).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  MDT5O PIC  X(0006).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  BDT5O PIC  X(0006).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  SDT5O PIC  X(0006).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  MSAAC6O PIC  X(0010).
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  MSAST6O PIC  X(0002).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  MSACN6O PIC  X(0001).
  2178*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  44
* EL633.cbl
  2179     05  FILLER            PIC  X(0003).
  2180     05  MSACM6O PIC  X(0010).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  TYPE6O PIC  X(0001).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  AMT6O PIC  X(0011).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  VOID6O PIC  X(0001).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  MDT6O PIC  X(0006).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  BDT6O PIC  X(0006).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  SDT6O PIC  X(0006).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  MSAAC7O PIC  X(0010).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  MSAST7O PIC  X(0002).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  MSACN7O PIC  X(0001).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  MSACM7O PIC  X(0010).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  TYPE7O PIC  X(0001).
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  AMT7O PIC  X(0011).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
  2219     05  VOID7O PIC  X(0001).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  MDT7O PIC  X(0006).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  BDT7O PIC  X(0006).
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
  2228     05  SDT7O PIC  X(0006).
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
  2231     05  MSAAC8O PIC  X(0010).
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  MSAST8O PIC  X(0002).
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  45
* EL633.cbl
  2237     05  MSACN8O PIC  X(0001).
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  MSACM8O PIC  X(0010).
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
  2243     05  TYPE8O PIC  X(0001).
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  AMT8O PIC  X(0011).
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  VOID8O PIC  X(0001).
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  MDT8O PIC  X(0006).
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  BDT8O PIC  X(0006).
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  SDT8O PIC  X(0006).
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  MSAAC9O PIC  X(0010).
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  MSAST9O PIC  X(0002).
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  MSACN9O PIC  X(0001).
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  MSACM9O PIC  X(0010).
  2271*    -------------------------------
  2272     05  FILLER            PIC  X(0003).
  2273     05  TYPE9O PIC  X(0001).
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  AMT9O PIC  X(0011).
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  VOID9O PIC  X(0001).
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  MDT9O PIC  X(0006).
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  BDT9O PIC  X(0006).
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  SDT9O PIC  X(0006).
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  MSAAC10O PIC  X(0010).
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  46
* EL633.cbl
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  MSACN10O PIC  X(0001).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  MSACM10O PIC  X(0010).
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  TYPE10O PIC  X(0001).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  AMT10O PIC  X(0011).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  VOID10O PIC  X(0001).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  MDT10O PIC  X(0006).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  BDT10O PIC  X(0006).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  SDT10O PIC  X(0006).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  MSAAC11O PIC  X(0010).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  MSAST11O PIC  X(0002).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  MSACN11O PIC  X(0001).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  MSACM11O PIC  X(0010).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  TYPE11O PIC  X(0001).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  AMT11O PIC  X(0011).
  2337*    -------------------------------
  2338     05  FILLER            PIC  X(0003).
  2339     05  VOID11O PIC  X(0001).
  2340*    -------------------------------
  2341     05  FILLER            PIC  X(0003).
  2342     05  MDT11O PIC  X(0006).
  2343*    -------------------------------
  2344     05  FILLER            PIC  X(0003).
  2345     05  BDT11O PIC  X(0006).
  2346*    -------------------------------
  2347     05  FILLER            PIC  X(0003).
  2348     05  SDT11O PIC  X(0006).
  2349*    -------------------------------
  2350     05  FILLER            PIC  X(0003).
  2351     05  MSAAC12O PIC  X(0010).
  2352*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  47
* EL633.cbl
  2353     05  FILLER            PIC  X(0003).
  2354     05  MSAST12O PIC  X(0002).
  2355*    -------------------------------
  2356     05  FILLER            PIC  X(0003).
  2357     05  MSACN12O PIC  X(0001).
  2358*    -------------------------------
  2359     05  FILLER            PIC  X(0003).
  2360     05  MSACM12O PIC  X(0010).
  2361*    -------------------------------
  2362     05  FILLER            PIC  X(0003).
  2363     05  TYPE12O PIC  X(0001).
  2364*    -------------------------------
  2365     05  FILLER            PIC  X(0003).
  2366     05  AMT12O PIC  X(0011).
  2367*    -------------------------------
  2368     05  FILLER            PIC  X(0003).
  2369     05  VOID12O PIC  X(0001).
  2370*    -------------------------------
  2371     05  FILLER            PIC  X(0003).
  2372     05  MDT12O PIC  X(0006).
  2373*    -------------------------------
  2374     05  FILLER            PIC  X(0003).
  2375     05  BDT12O PIC  X(0006).
  2376*    -------------------------------
  2377     05  FILLER            PIC  X(0003).
  2378     05  SDT12O PIC  X(0006).
  2379*    -------------------------------
  2380     05  FILLER            PIC  X(0003).
  2381     05  MSAAC13O PIC  X(0010).
  2382*    -------------------------------
  2383     05  FILLER            PIC  X(0003).
  2384     05  MSAST13O PIC  X(0002).
  2385*    -------------------------------
  2386     05  FILLER            PIC  X(0003).
  2387     05  MSACN13O PIC  X(0001).
  2388*    -------------------------------
  2389     05  FILLER            PIC  X(0003).
  2390     05  MSACM13O PIC  X(0010).
  2391*    -------------------------------
  2392     05  FILLER            PIC  X(0003).
  2393     05  TYPE13O PIC  X(0001).
  2394*    -------------------------------
  2395     05  FILLER            PIC  X(0003).
  2396     05  AMT13O PIC  X(0011).
  2397*    -------------------------------
  2398     05  FILLER            PIC  X(0003).
  2399     05  VOID13O PIC  X(0001).
  2400*    -------------------------------
  2401     05  FILLER            PIC  X(0003).
  2402     05  MDT13O PIC  X(0006).
  2403*    -------------------------------
  2404     05  FILLER            PIC  X(0003).
  2405     05  BDT13O PIC  X(0006).
  2406*    -------------------------------
  2407     05  FILLER            PIC  X(0003).
  2408     05  SDT13O PIC  X(0006).
  2409*    -------------------------------
  2410     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  48
* EL633.cbl
  2411     05  ERRMSG1O PIC  X(0079).
  2412*    -------------------------------
  2413     05  FILLER            PIC  X(0003).
  2414     05  ERRMSG2O PIC  X(0079).
  2415*    -------------------------------
  2416     05  FILLER            PIC  X(0003).
  2417     05  PFENTERO PIC  X(0002).
  2418*    -------------------------------
  2419
  2420 01  MAP-EL633A  REDEFINES  EL633AI.
  2421     12  FILLER                  PIC  X(87).
  2422     12  DATA-AREA       OCCURS 13 TIMES
  2423                             INDEXED BY PINDX.
  2424         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2425         16  GL-ACCT-ATTRB       PIC  X.
  2426         16  GL-ACCT             PIC  X(10).
  2427         16  WSL-COMM  REDEFINES GL-ACCT.
  2428             20  WSL-COMM-DTE.
  2429                 24  WSL-MO      PIC  X(2).
  2430                 24  WSL-DA      PIC  X(2).
  2431                 24  WSL-YR      PIC  X(2).
  2432             20  WSL-COMM-REST   PIC  X(4).
  2433         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2434         16  GL-STATE-ATTRB      PIC  X.
  2435         16  GL-STATE            PIC  X(02).
  2436         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2437         16  GL-CANC-ATTRB       PIC  X.
  2438         16  GL-CANC             PIC  X.
  2439         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2440         16  GL-COMM-ATTRB       PIC  X.
  2441         16  GL-COMM             PIC  X(10).
  2442         16  RTYPE-LEN           PIC S9(4)              COMP.
  2443         16  RTYPE-ATTRB         PIC  X.
  2444         16  RTYPE               PIC  X.
  2445         16  AMT-LEN             PIC S9(4)              COMP.
  2446         16  AMT-ATTRB           PIC  X.
  2447         16  AMT                 PIC S9(9)V9(2).
  2448         16  AMTO  REDEFINES
  2449             AMT                 PIC Z(7).9(2)-.
  2450         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2451         16  VOID-SW-ATTRB       PIC  X.
  2452         16  VOID-SW             PIC  X.
  2453         16  MDTE-LEN            PIC S9(4)              COMP.
  2454         16  MDTE-ATTRB          PIC  X.
  2455         16  MDTE                PIC  X(6).
  2456         16  BDTE-LEN            PIC S9(4)              COMP.
  2457         16  BDTE-ATTRB          PIC  X.
  2458         16  BDTE                PIC  X(6).
  2459         16  SDTE-LEN            PIC S9(4)              COMP.
  2460         16  SDTE-ATTRB          PIC  X.
  2461         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  49
* EL633.cbl
  2463****************************************************************
  2464*
  2465* Copyright (c) 2007 by Clerity Solutions, Inc.
  2466* All rights reserved.
  2467*
  2468****************************************************************
  2469 01  DFHEIV.
  2470   02  DFHEIV0               PIC X(35).
  2471   02  DFHEIV1               PIC X(08).
  2472   02  DFHEIV2               PIC X(08).
  2473   02  DFHEIV3               PIC X(08).
  2474   02  DFHEIV4               PIC X(06).
  2475   02  DFHEIV5               PIC X(04).
  2476   02  DFHEIV6               PIC X(04).
  2477   02  DFHEIV7               PIC X(02).
  2478   02  DFHEIV8               PIC X(02).
  2479   02  DFHEIV9               PIC X(01).
  2480   02  DFHEIV10              PIC S9(7) COMP-3.
  2481   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2482   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2483   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2484   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2485   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2486   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2487   02  DFHEIV17              PIC X(04).
  2488   02  DFHEIV18              PIC X(04).
  2489   02  DFHEIV19              PIC X(04).
  2490   02  DFHEIV20              USAGE IS POINTER.
  2491   02  DFHEIV21              USAGE IS POINTER.
  2492   02  DFHEIV22              USAGE IS POINTER.
  2493   02  DFHEIV23              USAGE IS POINTER.
  2494   02  DFHEIV24              USAGE IS POINTER.
  2495   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2496   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2497   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2498   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2499   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2500   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2501   02  FILLER                PIC X(02).
  2502   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2503   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2504   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2505   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2506   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2507 LINKAGE  SECTION.
  2508*****************************************************************
  2509*                                                               *
  2510* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2511* All rights reserved.                                          *
  2512*                                                               *
  2513*****************************************************************
  2514 01  dfheiblk.
  2515     02  eibtime          pic s9(7) comp-3.
  2516     02  eibdate          pic s9(7) comp-3.
  2517     02  eibtrnid         pic x(4).
  2518     02  eibtaskn         pic s9(7) comp-3.
  2519     02  eibtrmid         pic x(4).
  2520     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  50
* EL633.cbl
  2521     02  eibcposn         pic s9(4) comp.
  2522     02  eibcalen         pic s9(4) comp.
  2523     02  eibaid           pic x(1).
  2524     02  eibfiller1       pic x(1).
  2525     02  eibfn            pic x(2).
  2526     02  eibfiller2       pic x(2).
  2527     02  eibrcode         pic x(6).
  2528     02  eibfiller3       pic x(2).
  2529     02  eibds            pic x(8).
  2530     02  eibreqid         pic x(8).
  2531     02  eibrsrce         pic x(8).
  2532     02  eibsync          pic x(1).
  2533     02  eibfree          pic x(1).
  2534     02  eibrecv          pic x(1).
  2535     02  eibsend          pic x(1).
  2536     02  eibatt           pic x(1).
  2537     02  eibeoc           pic x(1).
  2538     02  eibfmh           pic x(1).
  2539     02  eibcompl         pic x(1).
  2540     02  eibsig           pic x(1).
  2541     02  eibconf          pic x(1).
  2542     02  eiberr           pic x(1).
  2543     02  eibrldbk         pic x(1).
  2544     02  eiberrcd         pic x(4).
  2545     02  eibsynrb         pic x(1).
  2546     02  eibnodat         pic x(1).
  2547     02  eibfiller5       pic x(2).
  2548     02  eibresp          pic 9(09) comp.
  2549     02  eibresp2         pic 9(09) comp.
  2550     02  dfheigdj         pic s9(4) comp.
  2551     02  dfheigdk         pic s9(4) comp.
  2552 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  51
* EL633.cbl
  2553/
  2554*                            COPY ERCCHKQ.
  2555******************************************************************
  2556*                                                                *
  2557*                                                                *
  2558*                            ERCCHKQ                             *
  2559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2560*                            VMOD=2.005                          *
  2561*                                                                *
  2562*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2563*                                                                *
  2564*   FILE TYPE = VSAM,KSDS                                        *
  2565*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2566*                                                                *
  2567*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2568*       ALTERNATE PATH  = NONE                                   *
  2569*                                                                *
  2570*   LOG = YES                                                    *
  2571*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2572******************************************************************
  2573 01  CHECK-QUE.
  2574     12  CQ-RECORD-ID                PIC XX.
  2575         88  VALID-CQ-ID                     VALUE 'CQ'.
  2576
  2577     12  CQ-CONTROL-PRIMARY.
  2578         16  CQ-COMPANY-CD           PIC X.
  2579         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2580         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2581
  2582     12  CQ-ENTRY-TYPE               PIC X.
  2583             88  CHECK-ON-QUE           VALUE 'Q'.
  2584             88  ALIGNMENT-CHECK        VALUE 'A'.
  2585             88  MANUAL-CHECK           VALUE 'M'.
  2586             88  SPOILED-CHECK          VALUE 'S'.
  2587             88  VOIDED-CHECK           VALUE 'V'.
  2588             88  PAYMENT-ABORTED        VALUE 'X'.
  2589
  2590     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2591
  2592     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2593         CQ-CREDIT-MASTER-CNTL.
  2594         16  CQ-PYAJ-CARRIER         PIC X.
  2595         16  CQ-PYAJ-GROUPING        PIC X(6).
  2596         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2597         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2598         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2599         16  CQ-PYAJ-REC-TYPE        PIC X.
  2600         16  FILLER                  PIC X(18).
  2601
  2602     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2603         CQ-CREDIT-MASTER-CNTL.
  2604         16  CQ-CHEK-CARRIER         PIC X.
  2605         16  CQ-CHEK-GROUPING        PIC X(6).
  2606         16  CQ-CHEK-STATE           PIC XX.
  2607         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2608         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2609         16  CQ-CHEK-CERT-NO.
  2610             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  52
* EL633.cbl
  2611             20  CQ-CHEK-CERT-SFX    PIC X.
  2612         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2613         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2614         16  FILLER                  PIC X(06).
  2615
  2616     12  CQ-CHECK-NUMBER             PIC X(7).
  2617     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2618     12  CQ-PAYMENT-TYPE             PIC X.
  2619             88  CQ-BILLING-CREDIT         VALUE '1'.
  2620             88  CQ-REFUND-PMT             VALUE '2'.
  2621             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2622     12  CQ-VOID-INDICATOR           PIC X.
  2623             88  CHECK-IS-VOID             VALUE 'V'.
  2624     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2625     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2626     12  CQ-CHECK-BY-USER            PIC X(4).
  2627     12  CQ-PRE-NUMBERING-SW         PIC X.
  2628       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2629       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2630
  2631     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2632     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2633     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2634     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2635
  2636     12  CQ-LETTERS-IND              PIC X.
  2637         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2638
  2639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  53
* EL633.cbl
  2640/
  2641*                            COPY ERCPYAJ.
  2642******************************************************************
  2643*                                                                *
  2644*                            ERCPYAJ                             *
  2645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2646*                            VMOD=2.015                          *
  2647*                                                                *
  2648*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2649*                                                                *
  2650*                                                                *
  2651*   FILE TYPE = VSAM,KSDS                                        *
  2652*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2653*                                                                *
  2654*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2655*       ALTERNATE PATHS = NONE                                   *
  2656*                                                                *
  2657*   LOG = YES                                                    *
  2658*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2659******************************************************************
  2660******************************************************************
  2661*                   C H A N G E   L O G
  2662*
  2663* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2664*-----------------------------------------------------------------
  2665*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2666* EFFECTIVE    NUMBER
  2667*-----------------------------------------------------------------
  2668* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2669* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2670******************************************************************
  2671
  2672 01  PENDING-PAY-ADJ.
  2673     12  PY-RECORD-ID                     PIC XX.
  2674         88  VALID-PY-ID                        VALUE 'PY'.
  2675
  2676     12  PY-CONTROL-PRIMARY.
  2677         16  PY-COMPANY-CD                PIC X.
  2678         16  PY-CARRIER                   PIC X.
  2679         16  PY-GROUPING                  PIC X(6).
  2680         16  PY-FIN-RESP                  PIC X(10).
  2681         16  PY-ACCOUNT                   PIC X(10).
  2682         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2683                                          PIC X(10).
  2684         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2685         16  PY-RECORD-TYPE               PIC X.
  2686             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2687             88  PY-DEPOSIT                   VALUE 'D'.
  2688             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2689             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2690             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2691             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2692             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2693             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2694             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2695             88  PY-FICA-ENTRY                VALUE 'F'.
  2696             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2697             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  54
* EL633.cbl
  2698             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2699
  2700     12  PY-PYMT-TYPE                     PIC X.
  2701             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2702             88  PY-REINS-PYMT                VALUE 'R'.
  2703             88  PY-EXP-PYMT                  VALUE 'E'.
  2704
  2705     12  PY-BIL-INV                       PIC X(6).
  2706     12  PY-REF-NO                        PIC X(12).
  2707
  2708     12  PY-LAST-MAINT-DT                 PIC XX.
  2709     12  PY-LAST-MAINT-BY                 PIC X(4).
  2710     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2711
  2712     12  PY-PYADJ-RECORD.
  2713         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2714         16  PY-ENTRY-COMMENT             PIC X(30).
  2715         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2716             20  PY-GL-ACCOUNT            PIC X(10).
  2717             20  PY-GL-STATE              PIC X(02).
  2718             20  PY-GL-CANC-SW            PIC X(01).
  2719                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2720                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2721             20  PY-GL-COMMENT            PIC X(10).
  2722             20  FILLER      REDEFINES PY-GL-COMMENT.
  2723                 24  PY-GL-CHECK-NO       PIC 9(06).
  2724                 24  FILLER               PIC X(04).
  2725             20  FILLER                   PIC X(07).
  2726         16  PY-SAVE-ACCOUNT              PIC X(10).
  2727         16  PY-SAVE-TYPE                 PIC X(01).
  2728
  2729         16  PY-LETTERS.
  2730             20  PY-LETTER OCCURS 3 TIMES
  2731                           INDEXED BY PY-LET-NDX
  2732                                          PIC X(04).
  2733
  2734         16  PY-ERCOMP-TYPE               PIC X.
  2735             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2736             88  PY-GA-TYPE                   VALUE 'G'.
  2737             88  PY-BANK-TYPE                 VALUE 'B'.
  2738         16  FILLER                       PIC X(05).
  2739
  2740     12  PY-RECORD-STATUS.
  2741         16  PY-CREDIT-SELECT-DT          PIC XX.
  2742         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2743         16  PY-BILLED-DATE               PIC XX.
  2744         16  PY-REPORTED-DT               PIC XX.
  2745         16  PY-PMT-APPLIED               PIC X.
  2746             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2747             88  PY-GA-PMT                    VALUE 'G'.
  2748             88  PY-OVWRITE-PMT               VALUE 'O'.
  2749             88  PY-NON-AR-PMT                VALUE 'N'.
  2750         16  FILLER                       PIC X(5).
  2751         16  PY-INPUT-DT                  PIC XX.
  2752         16  PY-CHECK-NUMBER              PIC X(6).
  2753         16  PY-VOID-SW                   PIC X.
  2754             88  PY-CHECK-VOIDED              VALUE 'V'.
  2755         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  55
* EL633.cbl
  2756             88  PY-BILLING-CHECK             VALUE 'B'.
  2757             88  PY-REFUND-CHECK              VALUE 'R'.
  2758             88  PY-GA-CHECK                  VALUE 'G'.
  2759             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2760             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2761         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2762         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2763         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2764         16  PY-BILL-FLAG                 PIC X.
  2765             88  PY-BILLED                    VALUE 'B'.
  2766         16  PY-AR-FLAG                   PIC X.
  2767             88  PY-AR-CYCLE                  VALUE 'C'.
  2768             88  PY-AR-MONTH-END              VALUE 'M'.
  2769         16  PY-AR-DATE                   PIC XX.
  2770
  2771     12  PY-GL-CODES.
  2772         16  PY-GL-DB                     PIC X(14).
  2773         16  PY-GL-CR                     PIC X(14).
  2774         16  PY-GL-FLAG                   PIC X.
  2775         16  PY-GL-DATE                   PIC XX.
  2776
  2777     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2778     12  FILLER                           PIC X(3).
  2779******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  56
* EL633.cbl
  2780/
  2781*                            COPY ERCCOMP.
  2782******************************************************************
  2783*                                                                *
  2784*                                                                *
  2785*                            ERCCOMP                             *
  2786*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2787*                            VMOD=2.019                          *
  2788*                                                                *
  2789*   ONLINE CREDIT SYSTEM                                         *
  2790*                                                                *
  2791*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2792*                                                                *
  2793*   FILE TYPE = VSAM,KSDS                                        *
  2794*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2795*                                                                *
  2796*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2797*       ALTERNATE PATH = NONE                                    *
  2798*                                                                *
  2799*   LOG = NO                                                     *
  2800*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2801*                                                                *
  2802******************************************************************
  2803*                   C H A N G E   L O G
  2804*
  2805* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2806*-----------------------------------------------------------------
  2807*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2808* EFFECTIVE    NUMBER
  2809*-----------------------------------------------------------------
  2810* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2811* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2812* 092205    2005050300006  PEMA  ADD LEASE FEE
  2813* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2814* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2815* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2816* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2817* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2818* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2819******************************************************************
  2820
  2821 01  COMPENSATION-MASTER.
  2822     12  CO-RECORD-ID                          PIC XX.
  2823         88  VALID-CO-ID                          VALUE 'CO'.
  2824
  2825     12  CO-CONTROL-PRIMARY.
  2826         16  CO-COMPANY-CD                     PIC X.
  2827         16  CO-CONTROL.
  2828             20  CO-CTL-1.
  2829                 24  CO-CARR-GROUP.
  2830                     28  CO-CARRIER            PIC X.
  2831                     28  CO-GROUPING.
  2832                         32  CO-GROUP-PREFIX   PIC XXX.
  2833                         32  CO-GROUP-PRIME    PIC XXX.
  2834                 24  CO-RESP-NO.
  2835                     28  CO-RESP-PREFIX        PIC X(4).
  2836                     28  CO-RESP-PRIME         PIC X(6).
  2837             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  57
* EL633.cbl
  2838                 24  CO-ACCOUNT.
  2839                     28  CO-ACCT-PREFIX        PIC X(4).
  2840                     28  CO-ACCT-PRIME         PIC X(6).
  2841         16  CO-TYPE                           PIC X.
  2842             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2843             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2844             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2845
  2846     12  CO-MAINT-INFORMATION.
  2847         16  CO-LAST-MAINT-DT                  PIC XX.
  2848         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2849         16  CO-LAST-MAINT-USER                PIC X(4).
  2850     12  FILLER                                PIC XX.
  2851     12  CO-STMT-TYPE                          PIC XXX.
  2852     12  CO-COMP-TYPE                          PIC X.
  2853         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2854     12  CO-STMT-OWNER                         PIC X(4).
  2855     12  CO-BALANCE-CONTROL                    PIC X.
  2856         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2857         88  CO-NO-BALANCE                        VALUE 'N'.
  2858
  2859     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2860         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2861         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2862         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2863
  2864     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2865         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2866         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2867
  2868     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2869     12  CO-GA-DIRECT-DEP                      PIC X.
  2870     12  CO-FUTURE-SPACE                       PIC X.
  2871         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2872
  2873     12  CO-ACCT-NAME                          PIC X(30).
  2874     12  CO-MAIL-NAME                          PIC X(30).
  2875     12  CO-ADDR-1                             PIC X(30).
  2876     12  CO-ADDR-2                             PIC X(30).
  2877     12  CO-ADDR-3.
  2878         16  CO-ADDR-CITY                      PIC X(27).
  2879         16  CO-ADDR-STATE                     PIC XX.
  2880     12  CO-CSO-1099                           PIC X.
  2881     12  CO-ZIP.
  2882         16  CO-ZIP-PRIME.
  2883             20  CO-ZIP-PRI-1ST                PIC X.
  2884                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2885             20  FILLER                        PIC X(4).
  2886         16  CO-ZIP-PLUS4                      PIC X(4).
  2887     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2888         16  CO-CAN-POSTAL-1                   PIC XXX.
  2889         16  CO-CAN-POSTAL-2                   PIC XXX.
  2890         16  FILLER                            PIC XXX.
  2891     12  CO-SOC-SEC                            PIC X(13).
  2892     12  CO-TELEPHONE.
  2893         16  CO-AREA-CODE                      PIC XXX.
  2894         16  CO-PREFIX                         PIC XXX.
  2895         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  58
* EL633.cbl
  2896
  2897     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2898
  2899     12  CO-AR-BAL-LEVEL                       PIC X.
  2900         88  CO-AR-REF-LVL                        VALUE '1'.
  2901         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2902         88  CO-AR-BILL-LVL                       VALUE '2'.
  2903         88  CO-AR-AGT-LVL                        VALUE '3'.
  2904         88  CO-AR-FR-LVL                         VALUE '4'.
  2905
  2906     12  CO-AR-NORMAL-PRINT                    PIC X.
  2907         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2908         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2909
  2910     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2911
  2912     12  CO-AR-REPORTING                       PIC X.
  2913         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2914         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2915
  2916     12  CO-AR-PULL-CHECK                      PIC X.
  2917         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2918         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2919
  2920     12  CO-AR-BALANCE-PRINT                   PIC X.
  2921         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2922
  2923     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2924         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2925         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2926         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2927
  2928     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2929
  2930     12  CO-USER-CODE                          PIC X.
  2931     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2932
  2933******************************************************************
  2934*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2935*    THE LAST MONTH END RUN.
  2936******************************************************************
  2937
  2938     12  CO-LAST-ACTIVITY-DATE.
  2939         16  CO-ACT-YEAR                       PIC 99.
  2940         16  CO-ACT-MONTH                      PIC 99.
  2941         16  CO-ACT-DAY                        PIC 99.
  2942
  2943     12  CO-LAST-STMT-DT.
  2944         16  CO-LAST-STMT-YEAR                 PIC 99.
  2945         16  CO-LAST-STMT-MONTH                PIC 99.
  2946         16  CO-LAST-STMT-DAY                  PIC 99.
  2947
  2948     12  CO-MO-END-TOTALS.
  2949         16  CO-MONTHLY-TOTALS.
  2950             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2951             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2952             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2953             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  59
* EL633.cbl
  2954             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2955
  2956         16  CO-AGING-TOTALS.
  2957             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2958             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2959             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2960             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2961
  2962         16  CO-YTD-TOTALS.
  2963             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2964             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2965
  2966         16  CO-OVER-UNDER-TOTALS.
  2967             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2968             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2969
  2970     12  CO-MISCELLANEOUS-TOTALS.
  2971         16  CO-FICA-TOTALS.
  2972             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2973             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2974
  2975         16  CO-CLAIM-TOTALS.
  2976             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2977             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2978
  2979******************************************************************
  2980*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2981*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2982******************************************************************
  2983
  2984     12  CO-CURRENT-TOTALS.
  2985         16  CO-CURRENT-LAST-STMT-DT.
  2986             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2987             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2988             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2989
  2990         16  CO-CURRENT-MONTHLY-TOTALS.
  2991             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2992             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2993             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2994             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2995             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2996
  2997         16  CO-CURRENT-AGING-TOTALS.
  2998             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2999             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  3000             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  3001             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  3002
  3003         16  CO-CURRENT-YTD-TOTALS.
  3004             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3005             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3006
  3007     12  CO-PAID-COMM-TOTALS.
  3008         16  CO-YTD-PAID-COMMS.
  3009             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3010             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3011
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  60
* EL633.cbl
  3012     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3013         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3014         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3015
  3016     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3017         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3018         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3019         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3020         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3021         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3022         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3023         88  CO-FINAL-LETTER                  VALUE 'F'.
  3024         88  CO-RECONCILING                   VALUE 'R'.
  3025         88  CO-PHONE-CALL                    VALUE 'P'.
  3026         88  CO-LEGAL                         VALUE 'L'.
  3027         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3028         88  CO-WRITE-OFF                     VALUE 'W'.
  3029         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3030
  3031     12  CO-CSR-CODE                       PIC X(4).
  3032
  3033     12  CO-GA-STATUS-INFO.
  3034         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3035         16  CO-GA-TERMINATION-DT          PIC XX.
  3036         16  CO-GA-STATUS-CODE             PIC X.
  3037             88  CO-GA-ACTIVE                 VALUE 'A'.
  3038             88  CO-GA-INACTIVE               VALUE 'I'.
  3039             88  CO-GA-PENDING                VALUE 'P'.
  3040         16  CO-GA-COMMENTS.
  3041             20  CO-GA-COMMENT-1           PIC X(40).
  3042             20  CO-GA-COMMENT-2           PIC X(40).
  3043             20  CO-GA-COMMENT-3           PIC X(40).
  3044             20  CO-GA-COMMENT-4           PIC X(40).
  3045
  3046     12  CO-RPTCD2                         PIC X(10).
  3047     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3048         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3049         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3050
  3051     12  CO-TYPE-AGENT                     PIC X(01).
  3052         88  CO-CORPORATION                   VALUE 'C'.
  3053         88  CO-PARTNERSHIP                   VALUE 'P'.
  3054         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3055         88  CO-TRUST                         VALUE 'T'.
  3056         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3057
  3058     12  CO-FAXNO.
  3059         16  CO-FAX-AREA-CODE                  PIC XXX.
  3060         16  CO-FAX-PREFIX                     PIC XXX.
  3061         16  CO-FAX-PHONE                      PIC X(4).
  3062
  3063     12  CO-BANK-INFORMATION.
  3064         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3065         16  CO-BANK-TRANSIT-NON REDEFINES
  3066             CO-BANK-TRANSIT-NO                PIC 9(8).
  3067
  3068         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3069     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  61
* EL633.cbl
  3070                  CO-BANK-INFORMATION.
  3071         16  CO-MD-GL-ACCT                     PIC X(10).
  3072         16  CO-MD-DIV                         PIC XX.
  3073         16  CO-MD-CENTER                      PIC X(4).
  3074         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3075         16  CO-CREATE-AP-CHECK                PIC X.
  3076         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3077         16  FILLER                            PIC XXX.
  3078     12  CO-ACH-STATUS                         PIC X.
  3079         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3080         88  CO-ACH-PENDING                        VALUE 'P'.
  3081
  3082     12  CO-BILL-SW                            PIC X.
  3083     12  CO-CONTROL-NAME                       PIC X(30).
  3084     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3085     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3086     12  CO-CLP-STATE                          PIC XX.
  3087     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3088     12  CO-SPP-REFUND-EDIT                    PIC X.
  3089
  3090******************************************************************
  3091*
  3092*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  62
* EL633.cbl
  3093/
  3094 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3095                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3096 0000-DFHEXIT SECTION.
  3097     MOVE '9#                    $   ' TO DFHEIV0.
  3098     MOVE 'EL633' TO DFHEIV1.
  3099     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3100
  3101     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3102     MOVE EIBTRMID               TO  QID-TERM.
  3103     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3104
  3105     IF EIBCALEN = ZERO
  3106         GO TO 8800-UNAUTHORIZED-ACCESS.
  3107
  3108     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3109         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3110
  3111     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3112     MOVE '5'                    TO  DC-OPTION-CODE.
  3113
  3114     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3115
  3116     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3117     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3118
  3119     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3120         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3121             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3122             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3123             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3124             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3125             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3126             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3127             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3128             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3129         ELSE
  3130             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3131             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3132             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3133             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3134             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3135             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3136             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3137             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3138
  3139     MOVE LOW-VALUES             TO  EL633AI.
  3140
  3141     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3142     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3143     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3144     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3145
  3146     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3147                                     TOTAL-ACCT-NET.
  3148
  3149     IF RETURNED-FROM = XCTL-6331 OR
  3150                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  63
* EL633.cbl
  3151                        XCTL-642  OR
  3152                        XCTL-652
  3153         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3154
  3155     IF EIBTRNID NOT = TRANS-ID
  3156         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3157         MOVE 'Y'                TO  PI-PAGE-SW
  3158         MOVE ZEROS              TO  PI-SEQ-NOS
  3159         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3160                                     PI-SAV-ACCT-NET
  3161                                     PI-SAV-PREV-AMT
  3162                                     PI-SAV-PREV-NET
  3163         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3164             EIBTRNID NOT = EL642-TRANS-ID  AND
  3165             EIBTRNID NOT = EL652-TRANS-ID) OR
  3166             PI-CR-FIN-RESP = SPACES
  3167             GO TO 8100-SEND-INITIAL-MAP
  3168         ELSE
  3169             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3170                            EL640-TRANS-ID   OR
  3171                            EL642-TRANS-ID)  AND
  3172                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3173                GO TO 8100-SEND-INITIAL-MAP
  3174             ELSE
  3175                 MOVE DFHENTER   TO  EIBAID
  3176                 MOVE 'S'        TO  MAINTI
  3177                 MOVE PI-CR-CARRIER
  3178                                 TO  CARRIERI
  3179                 MOVE PI-CR-GROUPING
  3180                                 TO  GROUPI
  3181                 MOVE PI-CR-FIN-RESP
  3182                                 TO  FINRESPI
  3183                 MOVE PI-CR-ACCOUNT
  3184                                 TO  ACCTI
  3185                 MOVE 1          TO  CARRIERL  MAINTA
  3186                 MOVE 3          TO  GROUPL
  3187                 MOVE 6          TO  FINRESPL  ACCTL
  3188                 GO TO 0400-VALIDATE-KEY-DATA.
  3189
  3190
  3191* EXEC CICS HANDLE CONDITION
  3192*        PGMIDERR  (9600-PGMID-ERROR)
  3193*        ERROR     (9990-ABEND)
  3194*    END-EXEC.
  3195*    MOVE '"$L.                  ! " #00003186' TO DFHEIV0
  3196     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3198     MOVE X'2220233030303033313836' TO DFHEIV0(25:11)
  3199     CALL 'kxdfhei1' USING DFHEIV0
  3200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3201
  3202
  3203     IF EIBAID = DFHCLEAR
  3204         GO TO 9400-CLEAR.
  3205
  3206     IF PI-PROCESSOR-ID = 'LGXX'
  3207         GO TO 0200-RECEIVE.
  3208
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  64
* EL633.cbl
  3209
  3210* EXEC CICS READQ TS
  3211*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3212*        INTO   (SECURITY-CONTROL)
  3213*        LENGTH (SC-COMM-LENGTH)
  3214*        ITEM   (SC-ITEM)
  3215*    END-EXEC.
  3216*    MOVE '*$II   L              ''   #00003197' TO DFHEIV0
  3217     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3219     MOVE X'2020233030303033313937' TO DFHEIV0(25:11)
  3220     CALL 'kxdfhei1' USING DFHEIV0,
  3221           PI-SECURITY-TEMP-STORE-ID,
  3222           SECURITY-CONTROL,
  3223           SC-COMM-LENGTH,
  3224           SC-ITEM,
  3225           DFHEIV99,
  3226           DFHEIV99
  3227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3228
  3229
  3230     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3231     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3232
  3233     IF NOT DISPLAY-CAP
  3234         MOVE 'READ'          TO SM-READ
  3235         PERFORM 9995-SECURITY-VIOLATION
  3236         MOVE ER-0070         TO  EMI-ERROR
  3237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3238         GO TO 8100-SEND-INITIAL-MAP.
  3239
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  65
* EL633.cbl
  3241 0200-RECEIVE.
  3242
  3243     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3244         MOVE ER-0008            TO  EMI-ERROR
  3245         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3246         MOVE -1                 TO  MAINTL
  3247         GO TO 8200-SEND-DATAONLY.
  3248
  3249
  3250* EXEC CICS RECEIVE
  3251*        MAP     (MAP-NAME)
  3252*        MAPSET  (MAPSET-NAME)
  3253*        INTO    (EL633AI)
  3254*    END-EXEC.
  3255     MOVE LENGTH OF
  3256      EL633AI
  3257       TO DFHEIV11
  3258*    MOVE '8"T I  L              ''   #00003223' TO DFHEIV0
  3259     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3260     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3261     MOVE X'2020233030303033323233' TO DFHEIV0(25:11)
  3262     CALL 'kxdfhei1' USING DFHEIV0,
  3263           MAP-NAME,
  3264           EL633AI,
  3265           DFHEIV11,
  3266           MAPSET-NAME,
  3267           DFHEIV99,
  3268           DFHEIV99
  3269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3270
  3271
  3272     IF MAINTI = 'S' AND
  3273        EIBAID = DFHENTER
  3274         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3275                                     PI-SAV-ACCT-NET
  3276                                     PI-SAV-PREV-AMT
  3277                                     PI-SAV-PREV-NET
  3278                                     PI-FRST-FILE-SEQ-NO
  3279         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3280
  3281     IF PFENTERL = ZERO
  3282         GO TO 0300-CHECK-PFKEYS.
  3283
  3284     IF (PFENTERI  IS NUMERIC)
  3285       AND (PFENTERI GREATER 0 AND LESS 25)
  3286         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3287     ELSE
  3288         MOVE ER-0029               TO  EMI-ERROR
  3289         GO TO 0320-INPUT-ERROR.
  3290
  3291 0300-CHECK-PFKEYS.
  3292     IF EIBAID = DFHPF23
  3293         GO TO 8810-PF23.
  3294
  3295     IF EIBAID = DFHPF24
  3296         GO TO 9200-RETURN-MAIN-MENU.
  3297
  3298     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  66
* EL633.cbl
  3299         GO TO 9500-PF12.
  3300
  3301     IF EIBAID = DFHPF3
  3302         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3303             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3304             MOVE XCTL-652       TO  PGM-NAME
  3305             IF ERCOMP-KEY  NOT =      SPACES
  3306                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3307                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3308                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3309                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3310             END-IF
  3311
  3312             IF PI-CR-ACCOUNT = LOW-VALUES
  3313                 MOVE 'G'        TO  PI-CR-TYPE
  3314                 GO TO 9300-XCTL
  3315             ELSE
  3316                 MOVE 'A'        TO  PI-CR-TYPE
  3317                 GO TO 9300-XCTL
  3318         ELSE
  3319            MOVE ER-3020         TO  EMI-ERROR
  3320            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3321            GO TO 8100-SEND-INITIAL-MAP.
  3322
  3323     IF EIBAID = DFHPF4
  3324         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3325         MOVE XCTL-6331          TO  PGM-NAME
  3326         GO TO 9300-XCTL.
  3327
  3328     IF EIBAID = DFHPF5
  3329         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3330         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3331         MOVE XCTL-640           TO  PGM-NAME
  3332         IF PI-CR-ACCOUNT = LOW-VALUES
  3333             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3334             IF ACCTI = LOW-VALUES
  3335                MOVE 'G'         TO  PI-CR-TYPE
  3336             END-IF
  3337             GO TO 9300-XCTL
  3338         ELSE
  3339             MOVE 'A'        TO  PI-CR-TYPE
  3340             GO TO 9300-XCTL.
  3341
  3342     IF EIBAID = DFHPF6
  3343        IF PI-GA-BILLING
  3344            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3345            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3346            MOVE XCTL-642        TO  PGM-NAME
  3347            IF PI-CR-ACCOUNT = LOW-VALUES
  3348                 MOVE 'G'        TO  PI-CR-TYPE
  3349                 GO TO 9300-XCTL
  3350             ELSE
  3351                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3352                 GO TO 9300-XCTL
  3353        ELSE
  3354            MOVE ER-2929         TO  EMI-ERROR
  3355            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3356            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  67
* EL633.cbl
  3357            IF PFENTERL = ZERO
  3358                MOVE -1          TO  MAINTL
  3359                GO TO 8200-SEND-DATAONLY
  3360            ELSE
  3361                MOVE -1          TO  PFENTERL
  3362                GO TO 8200-SEND-DATAONLY.
  3363
  3364     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3365         GO TO 0400-VALIDATE-KEY-DATA.
  3366
  3367 0320-INPUT-ERROR.
  3368     MOVE ER-0029                TO  EMI-ERROR.
  3369
  3370     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3371
  3372     MOVE AL-UNBON               TO  PFENTERA.
  3373
  3374     IF PFENTERL = ZERO
  3375         MOVE -1                 TO  MAINTL
  3376     ELSE
  3377         MOVE -1                 TO  PFENTERL.
  3378
  3379     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  68
* EL633.cbl
  3381 0400-VALIDATE-KEY-DATA.
  3382     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3383         NEXT SENTENCE
  3384       ELSE
  3385        IF MAINTI NOT = 'S'
  3386         MOVE 'UPDATE'       TO SM-READ
  3387         PERFORM 9995-SECURITY-VIOLATION
  3388         MOVE ER-0070        TO EMI-ERROR
  3389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3390         GO TO 8100-SEND-INITIAL-MAP.
  3391
  3392     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3393
  3394     IF EIBAID = DFHPF1
  3395         GO TO 4000-BROWSE-FRWD.
  3396
  3397     IF EIBAID   = DFHPF1   AND
  3398        CARRIERL = ZEROS    AND
  3399        GROUPL   = ZEROS    AND
  3400        FINRESPL = ZEROS    AND
  3401        ACCTL    = ZEROS
  3402         GO TO 4000-BROWSE-FRWD.
  3403
  3404     IF PI-PROCESSOR-ID = 'LGXX'
  3405         IF MAINTI = 'C'
  3406             MOVE AL-UANON       TO MAINTA
  3407             MOVE MAINTI         TO PI-SAV-FUNCTION
  3408             GO TO CSO-BRANCH
  3409         END-IF
  3410     END-IF.
  3411
  3412     IF MAINTI = 'C' OR  'S'
  3413         MOVE AL-UANON           TO  MAINTA
  3414         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3415     ELSE
  3416         MOVE -1                 TO  MAINTL
  3417         MOVE ER-0023            TO  EMI-ERROR
  3418         MOVE AL-UABON           TO  MAINTA
  3419         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3420
  3421 CSO-BRANCH.
  3422
  3423     IF MAINTI = 'C'
  3424       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3425         MOVE -1                 TO  MAINTL
  3426         MOVE ER-2056            TO  EMI-ERROR
  3427         MOVE AL-UABON           TO  MAINTA
  3428         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3429
  3430     IF CARRIERL = ZEROS  AND
  3431        GROUPL   = ZEROS  AND
  3432        FINRESPL = ZEROS  AND
  3433        ACCTL    = ZEROS
  3434         MOVE -1                 TO  CARRIERL
  3435         MOVE ER-2231            TO  EMI-ERROR
  3436         MOVE AL-UABON           TO  CARRIERA
  3437                                     GROUPA
  3438                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  69
* EL633.cbl
  3439                                     ACCTA
  3440         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3441         GO TO 8200-SEND-DATAONLY.
  3442
  3443     IF CARRIERL NOT = ZEROS
  3444         MOVE AL-UANON           TO  CARRIERA
  3445         MOVE CARRIERI           TO  COMP-CARRIER
  3446                                     PI-SAV-CARRIER
  3447                                     PI-CR-CARRIER
  3448         IF CARRIERI NOT = ZEROS
  3449           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3450             MOVE ER-2587        TO  EMI-ERROR
  3451             MOVE -1             TO  CARRIERL
  3452             MOVE AL-UABON       TO  CARRIERA
  3453             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3454         ELSE
  3455             NEXT SENTENCE
  3456     ELSE
  3457         MOVE LOW-VALUES          TO  COMP-CARRIER
  3458                                      PI-SAV-CARRIER.
  3459
  3460     IF CARRIERL NOT = ZEROS
  3461         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3462             IF PI-CARRIER-SECURITY = CARRIERI
  3463                 NEXT SENTENCE
  3464             ELSE
  3465                 MOVE -1         TO  CARRIERL
  3466                 MOVE ER-2370    TO  EMI-ERROR
  3467                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3468
  3469     IF GROUPL NOT = ZEROS
  3470         MOVE AL-UANON           TO  GROUPA
  3471         MOVE GROUPI             TO  COMP-GROUPING
  3472                                     PI-SAV-GROUPING
  3473                                     PI-CR-GROUPING
  3474         IF GROUPI NOT = ZEROS
  3475           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3476             MOVE ER-2588        TO  EMI-ERROR
  3477             MOVE -1             TO  GROUPL
  3478             MOVE AL-UABON       TO  GROUPA
  3479             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3480         ELSE
  3481             NEXT SENTENCE
  3482     ELSE
  3483         MOVE LOW-VALUES         TO  COMP-GROUPING
  3484                                     PI-SAV-GROUPING.
  3485
  3486     IF FINRESPL NOT = ZEROS
  3487         MOVE AL-UANON           TO  FINRESPA
  3488         MOVE FINRESPI           TO  COMP-FIN-RESP
  3489                                     PI-SAV-FIN-RESP
  3490                                     PI-CR-FIN-RESP
  3491     ELSE
  3492         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3493                                     PI-SAV-FIN-RESP.
  3494
  3495     IF ACCTL NOT = ZEROS
  3496         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  70
* EL633.cbl
  3497         MOVE ACCTI              TO  COMP-ACCOUNT
  3498                                     PI-SAV-ACCOUNT
  3499                                     PI-CR-ACCOUNT
  3500     ELSE
  3501         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3502                                     PI-SAV-ACCOUNT
  3503                                     PI-CR-ACCOUNT.
  3504
  3505     IF EMI-ERROR = ZEROS
  3506         NEXT SENTENCE
  3507     ELSE
  3508         IF EIBTRNID = EL640-TRANS-ID OR
  3509            EIBTRNID = EL642-TRANS-ID OR
  3510            EIBTRNID = EL6331-TRANS-ID
  3511             GO TO 8100-SEND-INITIAL-MAP
  3512         ELSE
  3513             GO TO 8200-SEND-DATAONLY.
  3514
  3515     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3516
  3517     IF MAINTI = 'S'
  3518         IF EIBAID = DFHPF1              OR  DFHENTER
  3519             GO TO 4000-BROWSE-FRWD
  3520         ELSE
  3521             GO TO 4100-BROWSE-BKWD.
  3522
  3523     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3524     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3525
  3526
  3527* EXEC CICS HANDLE CONDITION
  3528*        NOTFND   (0410-NO-COMP-MSTR)
  3529*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3530*        END-EXEC.
  3531*    MOVE '"$IJ                  ! # #00003483' TO DFHEIV0
  3532     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3534     MOVE X'2320233030303033343833' TO DFHEIV0(25:11)
  3535     CALL 'kxdfhei1' USING DFHEIV0
  3536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3537
  3538
  3539
  3540* EXEC CICS READ
  3541*        DATASET  (COMP-FILE-ID)
  3542*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3543*        RIDFLD   (ERCOMP-KEY)
  3544*        GTEQ
  3545*        END-EXEC.
  3546*    MOVE '&"S        G          (   #00003488' TO DFHEIV0
  3547     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3549     MOVE X'2020233030303033343838' TO DFHEIV0(25:11)
  3550     CALL 'kxdfhei1' USING DFHEIV0,
  3551           COMP-FILE-ID,
  3552           DFHEIV20,
  3553           DFHEIV99,
  3554           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  71
* EL633.cbl
  3555           DFHEIV99,
  3556           DFHEIV99,
  3557           DFHEIV99
  3558     SET ADDRESS OF COMPENSATION-MASTER TO
  3559         DFHEIV20
  3560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3561
  3562
  3563     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3564        COMP-CARRIER  = CO-CARRIER     AND
  3565        COMP-GROUPING = CO-GROUPING    AND
  3566        COMP-FIN-RESP = CO-RESP-NO    AND
  3567        COMP-ACCOUNT  = CO-ACCOUNT
  3568         NEXT SENTENCE
  3569     ELSE
  3570         GO TO 0410-NO-COMP-MSTR.
  3571
  3572     IF PI-COMPANY-ID = 'NCL'
  3573         IF CO-GA-INACTIVE
  3574             GO TO 0420-INACTIVE-COMP.
  3575
  3576     IF MAINTI = 'C'
  3577         GO TO 1000-EDIT-DATA.
  3578
  3579     IF EIBAID = DFHPF1
  3580       OR DFHENTER
  3581         GO TO 4000-BROWSE-FRWD.
  3582
  3583     IF EIBAID = DFHPF2
  3584         GO TO 4100-BROWSE-BKWD.
  3585
  3586 0410-NO-COMP-MSTR.
  3587     MOVE ER-2230                TO  EMI-ERROR.
  3588     MOVE -1                     TO  CARRIERL.
  3589     MOVE AL-UABON               TO  CARRIERA
  3590                                     GROUPA
  3591                                     FINRESPA
  3592                                     ACCTA.
  3593
  3594     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3595
  3596     GO TO 8200-SEND-DATAONLY.
  3597
  3598 0420-INACTIVE-COMP.
  3599     MOVE ER-2763                TO  EMI-ERROR.
  3600     MOVE -1                     TO  CARRIERL.
  3601     MOVE AL-UABON               TO  CARRIERA
  3602                                     GROUPA
  3603                                     FINRESPA
  3604                                     ACCTA.
  3605
  3606     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3607
  3608     GO TO 8200-SEND-DATAONLY.
  3609
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  72
* EL633.cbl
  3611 0500-CREATE-TEMP-STORAGE.
  3612
  3613     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3614
  3615
  3616* EXEC CICS WRITEQ TS
  3617*        QUEUE  (QID)
  3618*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3619*        LENGTH (PI-COMM-LENGTH)
  3620*    END-EXEC.
  3621*    MOVE '*"                    ''   #00003547' TO DFHEIV0
  3622     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3623     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3624     MOVE X'2020233030303033353437' TO DFHEIV0(25:11)
  3625     CALL 'kxdfhei1' USING DFHEIV0,
  3626           QID,
  3627           PROGRAM-INTERFACE-BLOCK,
  3628           PI-COMM-LENGTH,
  3629           DFHEIV99,
  3630           DFHEIV99,
  3631           DFHEIV99
  3632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3633
  3634
  3635 0590-EXIT.
  3636      EXIT.
  3637
  3638 0600-RECOVER-TEMP-STORAGE.
  3639
  3640* EXEC CICS READQ TS
  3641*        QUEUE  (QID)
  3642*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3643*        LENGTH (PI-COMM-LENGTH)
  3644*    END-EXEC.
  3645*    MOVE '*$I    L              ''   #00003557' TO DFHEIV0
  3646     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3647     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3648     MOVE X'2020233030303033353537' TO DFHEIV0(25:11)
  3649     CALL 'kxdfhei1' USING DFHEIV0,
  3650           QID,
  3651           PROGRAM-INTERFACE-BLOCK,
  3652           PI-COMM-LENGTH,
  3653           DFHEIV99,
  3654           DFHEIV99,
  3655           DFHEIV99
  3656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3657
  3658
  3659     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3660
  3661 0690-EXIT.
  3662      EXIT.
  3663
  3664 0800-DELETE-TS.
  3665
  3666* EXEC CICS HANDLE CONDITION
  3667*        QIDERR (0890-EXIT)
  3668*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  73
* EL633.cbl
  3669*    MOVE '"$N                   ! $ #00003569' TO DFHEIV0
  3670     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3672     MOVE X'2420233030303033353639' TO DFHEIV0(25:11)
  3673     CALL 'kxdfhei1' USING DFHEIV0
  3674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3675
  3676
  3677
  3678* EXEC CICS DELETEQ TS
  3679*        QUEUE  (QID)
  3680*    END-EXEC.
  3681*    MOVE '*&                    #   #00003573' TO DFHEIV0
  3682     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3683     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3684     MOVE X'2020233030303033353733' TO DFHEIV0(25:11)
  3685     CALL 'kxdfhei1' USING DFHEIV0,
  3686           QID,
  3687           DFHEIV99
  3688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3689
  3690
  3691
  3692* EXEC CICS SYNCPOINT
  3693*    END-EXEC.
  3694*    MOVE '6"                    !   #00003577' TO DFHEIV0
  3695     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3697     MOVE X'2020233030303033353737' TO DFHEIV0(25:11)
  3698     CALL 'kxdfhei1' USING DFHEIV0
  3699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3700
  3701
  3702 0890-EXIT.
  3703      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  74
* EL633.cbl
  3705
  3706 1000-EDIT-DATA.
  3707     SET PINDX                   TO  1.
  3708
  3709     .
  3710 1010-EDIT-LOOP.
  3711     SET NDX                     TO  PINDX.
  3712     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3713        GL-STATE-LEN (PINDX) = ZEROS   AND
  3714        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3715        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3716        RTYPE-LEN (PINDX)     = ZEROS  AND
  3717        AMT-LEN (PINDX)       = ZEROS  AND
  3718        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3719        SDTE-LEN (PINDX)      = ZEROS
  3720         GO TO 1020-INCREMENT-PINDX.
  3721
  3722     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3723         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3724         IF PI-COMPANY-ID NOT = 'WSL'
  3725             NEXT SENTENCE
  3726         ELSE
  3727             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3728             MOVE '4'                   TO  DC-OPTION-CODE
  3729             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3730             IF NO-CONVERSION-ERROR
  3731                 NEXT SENTENCE
  3732             ELSE
  3733                 MOVE ER-2595    TO  EMI-ERROR
  3734                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3735                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3736                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3737     ELSE
  3738         IF PI-COMPANY-ID = 'WSL'
  3739           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3740             MOVE ER-2596        TO  EMI-ERROR
  3741             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3742             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3743             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3744
  3745
  3746     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3747*        MOVE K-SPACE            TO COFA-FILLER
  3748*        MOVE '0001'             TO COFA-COMPANY-X
  3749*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3750         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3751     ELSE
  3752         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3753             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3754             MOVE ER-2957        TO EMI-ERROR
  3755             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3756             PERFORM 9900-ERROR-FORMAT THRU
  3757                     9900-EXIT
  3758             GO TO 1040-CONTINUE-EDIT
  3759         ELSE
  3760             GO TO 1040-CONTINUE-EDIT
  3761         END-IF
  3762     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  75
* EL633.cbl
  3763
  3764     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3765        AND (RTYPE (PINDX) = 'P')
  3766        GO TO 1040-CONTINUE-EDIT
  3767     END-IF
  3768     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3769        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3770     ELSE
  3771        MOVE SPACES              TO CHECK-GL-ACCT
  3772     END-IF
  3773
  3774     EVALUATE TRUE
  3775        WHEN (PI-COMPANY-ID = 'DCC' or 'VPP')
  3776           AND (CO-CARRIER = '1' OR '2' or '9')
  3777           AND (VALID-DCC-GL-ACCOUNT)
  3778           GO TO 1040-CONTINUE-EDIT
  3779        WHEN (PI-COMPANY-ID = 'DCC' or 'VPP')
  3780           AND (CO-CARRIER = '3' OR '4')
  3781           AND VALID-CSI-GL-ACCOUNT
  3782           GO TO 1040-CONTINUE-EDIT
  3783        WHEN (PI-COMPANY-ID = 'DCC' or 'VPP')
  3784           AND (CO-CARRIER = '5' OR '6' or '7')
  3785           AND (VALID-CCC-GL-ACCOUNT)
  3786           GO TO 1040-CONTINUE-EDIT
  3787        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3788           AND (VALID-GL-ACCOUNT)
  3789           GO TO 1040-CONTINUE-EDIT
  3790     END-EVALUATE
  3791*    EXEC CICS HANDLE CONDITION
  3792*         NOTFND (1040-NO-COFA-MSTR)
  3793*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3794*    END-EXEC.
  3795*
  3796*    EXEC CICS READ
  3797*         DATASET (COFA-FILE-ID)
  3798*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3799*         RIDFLD  (COFA-KEY-X)
  3800*    END-EXEC.
  3801*
  3802*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3803*    GO TO 1040-CONTINUE-EDIT.
  3804*
  3805*1040-NO-COFA-MSTR.
  3806
  3807     MOVE ER-2960                TO EMI-ERROR.
  3808     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3809     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3810     PERFORM 9900-ERROR-FORMAT THRU
  3811             9900-EXIT.
  3812
  3813 1040-CONTINUE-EDIT.
  3814
  3815*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3816     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3817         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3818         IF NOT VALID-STATE-CODE
  3819             MOVE -1             TO GL-STATE-LEN (PINDX)
  3820             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  76
* EL633.cbl
  3821             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3822             PERFORM 9900-ERROR-FORMAT THRU
  3823                     9900-EXIT
  3824         ELSE
  3825             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3826         END-IF
  3827     END-IF.
  3828
  3829 1040-CSO-SKIP.
  3830
  3831     IF GL-CANC (PINDX) = LOW-VALUES
  3832         MOVE SPACES             TO GL-CANC (PINDX)
  3833     END-IF.
  3834
  3835     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3836         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3837         IF NOT VALID-CANC-TYPE
  3838             MOVE -1             TO GL-CANC-LEN (PINDX)
  3839             MOVE ER-2958        TO EMI-ERROR
  3840             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3841             PERFORM 9900-ERROR-FORMAT THRU
  3842                     9900-EXIT
  3843         ELSE
  3844             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3845         END-IF
  3846     END-IF.
  3847
  3848     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3849        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3850        IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3851           AND (RTYPE (PINDX) = 'P')
  3852           SET VALID-REC-TYPE   TO TRUE
  3853        END-IF
  3854         IF NOT VALID-REC-TYPE
  3855             MOVE -1             TO  RTYPE-LEN (PINDX)
  3856             MOVE ER-2234        TO  EMI-ERROR
  3857             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3858             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3859         ELSE
  3860             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3861     ELSE
  3862         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3863             MOVE -1             TO  RTYPE-LEN (PINDX)
  3864             MOVE ER-2235        TO  EMI-ERROR
  3865             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3866             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3867
  3868     IF AMT-LEN (PINDX) NOT = ZEROS
  3869
  3870* EXEC CICS BIF DEEDIT
  3871*           FIELD (AMT (PINDX))
  3872*           LENGTH (11)
  3873*       END-EXEC
  3874     MOVE 11
  3875       TO DFHEIV11
  3876*    MOVE '@"L                   #   #00003747' TO DFHEIV0
  3877     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3878     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  77
* EL633.cbl
  3879     MOVE X'2020233030303033373437' TO DFHEIV0(25:11)
  3880     CALL 'kxdfhei1' USING DFHEIV0,
  3881           AMT(PINDX),
  3882           DFHEIV11
  3883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3884         IF AMT (PINDX) = ZEROS
  3885             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3886                 NEXT SENTENCE
  3887             ELSE
  3888                 MOVE ER-2245    TO  EMI-ERROR
  3889                 MOVE -1         TO  AMT-LEN(PINDX)
  3890                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3891                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3892         ELSE
  3893             IF AMT (PINDX) NUMERIC
  3894                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3895             ELSE
  3896                 MOVE ER-2245    TO  EMI-ERROR
  3897                 MOVE -1         TO  AMT-LEN(PINDX)
  3898                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3899                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3900     ELSE
  3901         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3902             MOVE -1             TO  AMT-LEN (PINDX)
  3903             MOVE ER-2236        TO  EMI-ERROR
  3904             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3905             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3906
  3907     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3908         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3909           AND (PI-REC-TYPE (NDX) = 'C')
  3910             IF VOID-SW (PINDX) = 'V'
  3911                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3912             ELSE
  3913                 MOVE ER-2246    TO  EMI-ERROR
  3914                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3915                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3916                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3917         ELSE
  3918             MOVE ER-2449        TO  EMI-ERROR
  3919             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3920             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3921             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3922
  3923     IF SDTE-LEN (PINDX) = ZEROS
  3924        GO TO 1020-INCREMENT-PINDX.
  3925
  3926     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3927
  3928     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3929     PERFORM 8600-DEEDIT.
  3930
  3931     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3932        GO TO 1015-DAY-ERROR.
  3933
  3934     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3935     MOVE '4'                    TO  DC-OPTION-CODE.
  3936     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  78
* EL633.cbl
  3937
  3938     IF NO-CONVERSION-ERROR
  3939        SET PINDEX               TO  PINDX
  3940        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3941     ELSE
  3942        GO TO 1015-DAY-ERROR.
  3943
  3944     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3945
  3946     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3947         IF DATE-TEST-DD  NOT = 30
  3948             GO TO 1015-DAY-ERROR
  3949         ELSE
  3950             GO TO 1020-INCREMENT-PINDX.
  3951
  3952     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3953                             8  OR  10  OR  12
  3954         IF DATE-TEST-DD  NOT = 31
  3955             GO TO 1015-DAY-ERROR
  3956         ELSE
  3957             GO TO 1020-INCREMENT-PINDX.
  3958
  3959     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3960         REMAINDER  DIVIDE-REMAINDER.
  3961
  3962     IF (DATE-TEST-YY = ZERO)
  3963       OR (DIVIDE-REMAINDER NOT = ZERO)
  3964         IF DATE-TEST-DD  NOT = 28
  3965             GO TO 1015-DAY-ERROR
  3966         ELSE
  3967             GO TO 1020-INCREMENT-PINDX
  3968     ELSE
  3969         IF DATE-TEST-DD = 29
  3970             GO TO 1020-INCREMENT-PINDX.
  3971
  3972 1015-DAY-ERROR.
  3973     MOVE -1                     TO  SDTE-LEN (PINDX).
  3974     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3975     MOVE ER-0587                TO  EMI-ERROR.
  3976
  3977     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3978
  3979 1020-INCREMENT-PINDX.
  3980     SET PINDX  UP  BY  1.
  3981
  3982     IF PINDX  IS NOT GREATER THAN  13
  3983         GO TO 1010-EDIT-LOOP.
  3984
  3985     IF EMI-ERROR = ZEROS
  3986         NEXT SENTENCE
  3987     ELSE
  3988         MOVE 'S'                TO  PI-PREV-FUNCTION
  3989         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  79
* EL633.cbl
  3991 2000-UPDATE-THE-FILE.
  3992     SET PINDX                   TO  ZERO-NDX.
  3993*    SET NDX                     TO  ZERO-NDX.
  3994*    SET NDX  UP  BY  1.
  3995
  3996     IF PI-PYAJ-FILE-SW = 'B'
  3997         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3998         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3999     ELSE
  4000         MOVE PI-LAST-FILE-SEQ-NO
  4001                                 TO  PI-SAV-FILE-SEQ-NO
  4002         MOVE PI-LAST-RECORD-TYPE
  4003                                 TO  PI-SAV-RECORD-TYPE.
  4004
  4005 2100-UPDATE-LOOP.
  4006     SET PINDX  UP  BY  1.
  4007     SET NDX                     TO  PINDX.
  4008
  4009     IF PINDX  IS GREATER THAN  13
  4010         GO TO 2200-UPDATE-COMPLETE.
  4011
  4012     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4013        GL-STATE-LEN (PINDX) = ZEROS AND
  4014        GL-CANC-LEN (PINDX)   = ZEROS AND
  4015        GL-COMM-LEN (PINDX)   = ZEROS AND
  4016        RTYPE-LEN (PINDX)   = ZEROS  AND
  4017        AMT-LEN (PINDX)     = ZEROS  AND
  4018        VOID-SW-LEN (PINDX) = ZEROS  AND
  4019        SDTE-LEN (PINDX)    = ZEROS
  4020         GO TO 2100-UPDATE-LOOP.
  4021
  4022
  4023* EXEC CICS BIF DEEDIT
  4024*         FIELD (AMT (PINDX))
  4025*         LENGTH (11)
  4026*    END-EXEC.
  4027     MOVE 11
  4028       TO DFHEIV11
  4029*    MOVE '@"L                   #   #00003889' TO DFHEIV0
  4030     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4032     MOVE X'2020233030303033383839' TO DFHEIV0(25:11)
  4033     CALL 'kxdfhei1' USING DFHEIV0,
  4034           AMT(PINDX),
  4035           DFHEIV11
  4036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4037
  4038
  4039     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4040         NEXT SENTENCE
  4041     ELSE
  4042         GO TO 2110-ADD-RECORD.
  4043
  4044
  4045* EXEC CICS HANDLE CONDITION
  4046*        NOTFND  (2110-ADD-RECORD)
  4047*    END-EXEC.
  4048*    MOVE '"$I                   ! % #00003899' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  80
* EL633.cbl
  4049     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4051     MOVE X'2520233030303033383939' TO DFHEIV0(25:11)
  4052     CALL 'kxdfhei1' USING DFHEIV0
  4053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4054
  4055
  4056     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4057     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4058     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4059
  4060
  4061* EXEC CICS READ
  4062*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4063*        DATASET  (PYAJ-FILE-ID)
  4064*        RIDFLD   (ERPYAJ-KEY)
  4065*        UPDATE
  4066*    END-EXEC.
  4067*    MOVE '&"S        EU         (   #00003907' TO DFHEIV0
  4068     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4069     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4070     MOVE X'2020233030303033393037' TO DFHEIV0(25:11)
  4071     CALL 'kxdfhei1' USING DFHEIV0,
  4072           PYAJ-FILE-ID,
  4073           DFHEIV20,
  4074           DFHEIV99,
  4075           ERPYAJ-KEY,
  4076           DFHEIV99,
  4077           DFHEIV99,
  4078           DFHEIV99
  4079     SET ADDRESS OF PENDING-PAY-ADJ TO
  4080         DFHEIV20
  4081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4082
  4083
  4084
  4085     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4086        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4087            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4088            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4089            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4090
  4091     IF AMT-LEN (PINDX) NOT = ZEROS
  4092         IF AMT (PINDX) = ZEROS
  4093             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4094                 GO TO 2120-DELETE-RECORD
  4095             ELSE
  4096                 MOVE ER-2244       TO  EMI-ERROR
  4097                 MOVE -1            TO  AMT-LEN (PINDX)
  4098                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4099                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4100                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4101
  4102* EXEC CICS UNLOCK
  4103*                    DATASET  (PYAJ-FILE-ID)
  4104*                END-EXEC
  4105*    MOVE '&*                    #   #00003931' TO DFHEIV0
  4106     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  81
* EL633.cbl
  4107     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4108     MOVE X'2020233030303033393331' TO DFHEIV0(25:11)
  4109     CALL 'kxdfhei1' USING DFHEIV0,
  4110           PYAJ-FILE-ID,
  4111           DFHEIV99
  4112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4113                 GO TO 8200-SEND-DATAONLY.
  4114
  4115     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4116     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4117     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4118
  4119     PERFORM 8400-LOG-JOURNAL-RECORD.
  4120
  4121     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4122     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4123     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4124
  4125     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4126         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4127     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4128         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4129     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4130         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4131     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4132         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4133     IF AMT-LEN (PINDX) NOT = ZEROS
  4134         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4135
  4136     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4137         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4138
  4139     IF SDTE-LEN (PINDX) NOT = ZEROS
  4140        SET PINDEX               TO  PINDX
  4141        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4142
  4143     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4144     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4145     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4146
  4147
  4148* EXEC CICS REWRITE
  4149*        DATASET  (PYAJ-FILE-ID)
  4150*        FROM     (PENDING-PAY-ADJ)
  4151*    END-EXEC.
  4152     MOVE LENGTH OF
  4153      PENDING-PAY-ADJ
  4154       TO DFHEIV11
  4155*    MOVE '&& L                  %   #00003968' TO DFHEIV0
  4156     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4157     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4158     MOVE X'2020233030303033393638' TO DFHEIV0(25:11)
  4159     CALL 'kxdfhei1' USING DFHEIV0,
  4160           PYAJ-FILE-ID,
  4161           PENDING-PAY-ADJ,
  4162           DFHEIV11,
  4163           DFHEIV99
  4164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  82
* EL633.cbl
  4165
  4166
  4167     PERFORM 8400-LOG-JOURNAL-RECORD.
  4168
  4169     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  83
* EL633.cbl
  4171 2110-ADD-RECORD.
  4172
  4173* EXEC CICS GETMAIN
  4174*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4175*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4176*        INITIMG  (GETMAIN-SPACE)
  4177*    END-EXEC.
  4178*    MOVE ',"IL                  $   #00003978' TO DFHEIV0
  4179     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4180     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4181     MOVE X'2020233030303033393738' TO DFHEIV0(25:11)
  4182     CALL 'kxdfhei1' USING DFHEIV0,
  4183           DFHEIV20,
  4184           ERPYAJ-RECORD-LENGTH,
  4185           GETMAIN-SPACE
  4186     SET ADDRESS OF PENDING-PAY-ADJ TO
  4187         DFHEIV20
  4188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4189
  4190
  4191     MOVE 'PY'                   TO  PY-RECORD-ID.
  4192     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4193     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4194     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4195     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4196     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4197
  4198     ADD +1                      TO  WORK-SEQ-NO.
  4199     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4200
  4201     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4202     if gl-state-len (pindx) <> zeros
  4203        MOVE GL-STATE (PINDX)    TO  PY-GL-STATE
  4204     end-if
  4205     if gl-canc-len (pindx) <> zeros
  4206        MOVE GL-CANC (PINDX)     TO  PY-GL-CANC-SW
  4207     end-if
  4208     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4209
  4210     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4211     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4212     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4213        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4214     END-IF
  4215     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4216     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4217     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4218                                     PY-INPUT-DT.
  4219     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4220                                     PY-CHECK-QUE-SEQUENCE.
  4221     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4222                                     PY-BILLED-DATE
  4223                                     PY-AR-DATE
  4224                                     PY-REPORTED-DT
  4225                                     PY-CHECK-WRITTEN-DT.
  4226     IF SDTE-LEN (PINDX) = ZEROS
  4227         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4228         GO TO 2115-WRITE-REC
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  84
* EL633.cbl
  4229     END-IF.
  4230
  4231     IF SDTE (PINDX) IS NUMERIC
  4232         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
  4233         MOVE '4'            TO  DC-OPTION-CODE
  4234         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4235         IF DATE-CONVERSION-ERROR
  4236             MOVE PI-CR-MONTH-END-DT
  4237                             TO  PY-CREDIT-SELECT-DT
  4238         ELSE
  4239             MOVE DC-BIN-DATE-1
  4240                             TO  PY-CREDIT-SELECT-DT
  4241         END-IF
  4242     ELSE
  4243         MOVE PI-CR-MONTH-END-DT
  4244                             TO  PY-CREDIT-SELECT-DT
  4245     END-IF
  4246
  4247     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4248         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4249         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4250
  4251     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4252         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4253         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4254
  4255     MOVE 'N'                    TO  FIRST-ADD-SW.
  4256
  4257     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4258     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4259     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4260 2115-WRITE-REC.
  4261
  4262* EXEC CICS WRITE
  4263*        DATASET  (PYAJ-FILE-ID)
  4264*        FROM     (PENDING-PAY-ADJ)
  4265*        RIDFLD   (PY-CONTROL-PRIMARY)
  4266*    END-EXEC.
  4267     MOVE LENGTH OF
  4268      PENDING-PAY-ADJ
  4269       TO DFHEIV11
  4270*    MOVE '&$ L                  ''   #00004054' TO DFHEIV0
  4271     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4272     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4273     MOVE X'2020233030303034303534' TO DFHEIV0(25:11)
  4274     CALL 'kxdfhei1' USING DFHEIV0,
  4275           PYAJ-FILE-ID,
  4276           PENDING-PAY-ADJ,
  4277           DFHEIV11,
  4278           PY-CONTROL-PRIMARY,
  4279           DFHEIV99,
  4280           DFHEIV99
  4281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4282
  4283
  4284     PERFORM 8400-LOG-JOURNAL-RECORD.
  4285
  4286     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  85
* EL633.cbl
  4287
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  86
* EL633.cbl
  4289 2120-DELETE-RECORD.
  4290     IF PY-RECORD-TYPE NOT = 'C'
  4291         GO TO 2120-DELETE-CONT.
  4292
  4293     IF PY-CHECK-QUE-CONTROL = ZEROS
  4294       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4295         GO TO 2120-DELETE-CONT.
  4296
  4297
  4298* EXEC CICS HANDLE CONDITION
  4299*        NOTFND  (2120-DELETE-CONT)
  4300*    END-EXEC.
  4301*    MOVE '"$I                   ! & #00004073' TO DFHEIV0
  4302     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4304     MOVE X'2620233030303034303733' TO DFHEIV0(25:11)
  4305     CALL 'kxdfhei1' USING DFHEIV0
  4306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4307
  4308
  4309     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4310     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4311     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4312
  4313
  4314* EXEC CICS READ
  4315*        SET      (ADDRESS OF CHECK-QUE)
  4316*        DATASET  (CHKQ-FILE-ID)
  4317*        RIDFLD   (ERCHKQ-KEY)
  4318*        UPDATE
  4319*    END-EXEC.
  4320*    MOVE '&"S        EU         (   #00004081' TO DFHEIV0
  4321     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4322     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4323     MOVE X'2020233030303034303831' TO DFHEIV0(25:11)
  4324     CALL 'kxdfhei1' USING DFHEIV0,
  4325           CHKQ-FILE-ID,
  4326           DFHEIV20,
  4327           DFHEIV99,
  4328           ERCHKQ-KEY,
  4329           DFHEIV99,
  4330           DFHEIV99,
  4331           DFHEIV99
  4332     SET ADDRESS OF CHECK-QUE TO
  4333         DFHEIV20
  4334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4335
  4336
  4337*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4338*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4339*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4340*
  4341*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4342
  4343
  4344* EXEC CICS DELETE
  4345*        DATASET  (CHKQ-FILE-ID)
  4346*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  87
* EL633.cbl
  4347*    MOVE '&(                    &   #00004094' TO DFHEIV0
  4348     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4349     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4350     MOVE X'2020233030303034303934' TO DFHEIV0(25:11)
  4351     CALL 'kxdfhei1' USING DFHEIV0,
  4352           CHKQ-FILE-ID,
  4353           DFHEIV99,
  4354           DFHEIV99,
  4355           DFHEIV99,
  4356           DFHEIV99
  4357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4358
  4359
  4360 2120-DELETE-CONT.
  4361*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4362*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4363*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4364*
  4365*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4366
  4367     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4368         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4369         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4370         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4371                                     PI-SAV-ACCT-NET
  4372                                     PI-SAV-PREV-AMT
  4373                                     PI-SAV-PREV-NET.
  4374
  4375
  4376* EXEC CICS DELETE
  4377*        DATASET(PYAJ-FILE-ID)
  4378*    END-EXEC.
  4379*    MOVE '&(                    &   #00004113' TO DFHEIV0
  4380     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4381     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4382     MOVE X'2020233030303034313133' TO DFHEIV0(25:11)
  4383     CALL 'kxdfhei1' USING DFHEIV0,
  4384           PYAJ-FILE-ID,
  4385           DFHEIV99,
  4386           DFHEIV99,
  4387           DFHEIV99,
  4388           DFHEIV99
  4389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4390
  4391
  4392     GO TO 2100-UPDATE-LOOP.
  4393
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  88
* EL633.cbl
  4395
  4396 2190-CHANGE-RECORD-TYPE.
  4397
  4398*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4399*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4400*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4401*
  4402*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4403
  4404
  4405* EXEC CICS DELETE
  4406*        DATASET(PYAJ-FILE-ID)
  4407*    END-EXEC.
  4408*    MOVE '&(                    &   #00004129' TO DFHEIV0
  4409     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4410     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4411     MOVE X'2020233030303034313239' TO DFHEIV0(25:11)
  4412     CALL 'kxdfhei1' USING DFHEIV0,
  4413           PYAJ-FILE-ID,
  4414           DFHEIV99,
  4415           DFHEIV99,
  4416           DFHEIV99,
  4417           DFHEIV99
  4418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4419
  4420
  4421
  4422* EXEC CICS GETMAIN
  4423*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4424*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4425*        INITIMG  (GETMAIN-SPACE)
  4426*    END-EXEC.
  4427*    MOVE ',"IL                  $   #00004133' TO DFHEIV0
  4428     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4430     MOVE X'2020233030303034313333' TO DFHEIV0(25:11)
  4431     CALL 'kxdfhei1' USING DFHEIV0,
  4432           DFHEIV20,
  4433           ERPYAJ-RECORD-LENGTH,
  4434           GETMAIN-SPACE
  4435     SET ADDRESS OF PENDING-PAY-ADJ TO
  4436         DFHEIV20
  4437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4438
  4439
  4440*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4441*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4442
  4443     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4444     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4445                                    PYAJ-RECORD-TYPE.
  4446
  4447
  4448* EXEC CICS HANDLE CONDITION
  4449*        DUPREC (2190-DUP-RECORD)
  4450*    END-EXEC.
  4451*    MOVE '"$%                   ! '' #00004146' TO DFHEIV0
  4452     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  89
* EL633.cbl
  4453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4454     MOVE X'2720233030303034313436' TO DFHEIV0(25:11)
  4455     CALL 'kxdfhei1' USING DFHEIV0
  4456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4457
  4458
  4459*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4460*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4461*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4462
  4463 2190-RETRY-WRITE.
  4464
  4465
  4466* EXEC CICS WRITE
  4467*        DATASET  (PYAJ-FILE-ID)
  4468*        FROM     (PENDING-PAY-ADJ)
  4469*        RIDFLD   (PY-CONTROL-PRIMARY)
  4470*    END-EXEC.
  4471     MOVE LENGTH OF
  4472      PENDING-PAY-ADJ
  4473       TO DFHEIV11
  4474*    MOVE '&$ L                  ''   #00004156' TO DFHEIV0
  4475     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4476     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4477     MOVE X'2020233030303034313536' TO DFHEIV0(25:11)
  4478     CALL 'kxdfhei1' USING DFHEIV0,
  4479           PYAJ-FILE-ID,
  4480           PENDING-PAY-ADJ,
  4481           DFHEIV11,
  4482           PY-CONTROL-PRIMARY,
  4483           DFHEIV99,
  4484           DFHEIV99
  4485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4486
  4487
  4488*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4489
  4490
  4491* EXEC CICS READ
  4492*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4493*        DATASET  (PYAJ-FILE-ID)
  4494*        RIDFLD   (ERPYAJ-KEY)
  4495*        UPDATE
  4496*    END-EXEC.
  4497*    MOVE '&"S        EU         (   #00004164' TO DFHEIV0
  4498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4500     MOVE X'2020233030303034313634' TO DFHEIV0(25:11)
  4501     CALL 'kxdfhei1' USING DFHEIV0,
  4502           PYAJ-FILE-ID,
  4503           DFHEIV20,
  4504           DFHEIV99,
  4505           ERPYAJ-KEY,
  4506           DFHEIV99,
  4507           DFHEIV99,
  4508           DFHEIV99
  4509     SET ADDRESS OF PENDING-PAY-ADJ TO
  4510         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  90
* EL633.cbl
  4511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4512
  4513
  4514     GO TO 2190-EXIT.
  4515
  4516 2190-DUP-RECORD.
  4517
  4518     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4519
  4520     GO TO 2190-RETRY-WRITE.
  4521
  4522 2190-EXIT.
  4523     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  91
* EL633.cbl
  4525
  4526 2200-UPDATE-COMPLETE.
  4527     IF EIBAID = DFHPF1
  4528         GO TO 4000-BROWSE-FRWD.
  4529
  4530     IF EIBAID = DFHPF2
  4531         GO TO 4100-BROWSE-BKWD.
  4532
  4533     MOVE LOW-VALUES             TO  EL633AI.
  4534
  4535     MOVE ER-0000                TO  EMI-ERROR.
  4536     MOVE -1                     TO  MAINTL.
  4537
  4538     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4539
  4540     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4541     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4542
  4543*    GO TO 4000-BROWSE-FRWD.
  4544
  4545*    GO TO 8100-SEND-INITIAL-MAP.
  4546
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  92
* EL633.cbl
  4548 4000-BROWSE-FRWD.
  4549     MOVE '1'                     TO  PI-PREV-PFKEY.
  4550     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4551
  4552     IF EIBAID = DFHPF1
  4553         IF PAGE-FULL
  4554             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4555                                      TO  PYAJ-FILE-SEQ-NO
  4556             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4557             MOVE 'N'                 TO  PYAJ-READ-SW
  4558             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4559             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4560             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4561             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4562         ELSE
  4563             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4564                                          PI-SAV-ACCT-NET
  4565                                          PI-SAV-PREV-AMT
  4566                                          PI-SAV-PREV-NET
  4567             MOVE 'Y'                 TO  PI-PAGE-SW
  4568             IF NOT END-OF-FILE
  4569                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4570                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4571             END-IF
  4572             IF TOP-OF-FILE
  4573                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4574                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4575                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4576             ELSE
  4577                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4578                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4579     ELSE
  4580         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4581         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4582         IF MAINTI = 'S'
  4583             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4584             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4585
  4586
  4587     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4588
  4589     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4590         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4591
  4592 4000-BROWSE-FRWD-FOR-PREV.
  4593*    IF END-OF-FILE
  4594*        IF EIBAID = DFHPF1
  4595*           IF PI-TOTAL-DISPLAYED
  4596*              NEXT SENTENCE
  4597*           ELSE
  4598*              MOVE -1                 TO  MAINTL
  4599*              MOVE ER-2237            TO  EMI-ERROR
  4600*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4601*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4602*              SET PINDX               TO  +2
  4603*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4604*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4605*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  93
* EL633.cbl
  4606*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4607*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4608*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4609*                                          PI-SAV-ACCT-NET
  4610*              GO TO 8100-SEND-INITIAL-MAP.
  4611*
  4612*     IF END-OF-FILE
  4613*        IF EIBAID = DFHPF1
  4614*           MOVE -1             TO  MAINTL
  4615*           MOVE ER-2237        TO  EMI-ERROR
  4616*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4617*           GO TO 8200-SEND-DATAONLY.
  4618*
  4619     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4620
  4621     IF NO-RECORDS
  4622        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4623        MOVE LOW-VALUES         TO  EL633AO
  4624        MOVE ER-2239            TO  EMI-ERROR
  4625        MOVE -1                 TO  MAINTL
  4626        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4627        GO TO 8100-SEND-INITIAL-MAP.
  4628
  4629     IF NOT-OPEN
  4630         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4631
  4632     MOVE LOW-VALUES             TO  EL633AO.
  4633     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4634
  4635     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4636          VARYING  PINDX  FROM  1  BY  1
  4637             UNTIL  END-OF-ACCT
  4638                 OR  END-OF-FILE
  4639                     OR  PAGE-FULL
  4640                         OR  NO-RECORDS.
  4641
  4642     IF NO-RECORDS
  4643         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4644         MOVE LOW-VALUES         TO  EL633AO
  4645         MOVE ER-2239            TO  EMI-ERROR
  4646         MOVE -1                 TO  MAINTL
  4647         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4648         GO TO 8100-SEND-INITIAL-MAP.
  4649
  4650     IF END-OF-FILE
  4651         IF EIBAID = DFHPF2
  4652             MOVE ER-2238        TO  EMI-ERROR
  4653             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4654             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4655         ELSE
  4656             MOVE ER-2237        TO  EMI-ERROR
  4657             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4658
  4659     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4660                                     PI-SAV-FUNCTION.
  4661
  4662     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  94
* EL633.cbl
  4664 4100-BROWSE-BKWD.
  4665     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4666                                      PI-TOTAL-DISPLAYED-SW.
  4667     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4668     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4669     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4670     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4671                                      PI-SAV-ACCT-NET
  4672                                      PI-SAV-PREV-AMT
  4673                                      PI-SAV-PREV-NET.
  4674
  4675     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4676
  4677     IF NO-RECORDS
  4678         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4679         MOVE LOW-VALUES         TO  EL633AO
  4680         MOVE ER-2239            TO  EMI-ERROR
  4681         MOVE -1                 TO  MAINTL
  4682         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4683         GO TO 8100-SEND-INITIAL-MAP.
  4684
  4685     IF NOT-OPEN
  4686         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4687
  4688
  4689* EXEC CICS READNEXT
  4690*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4691*        DATASET  (PYAJ-FILE-ID)
  4692*        RIDFLD   (ERPYAJ-KEY)
  4693*    END-EXEC.
  4694     MOVE 0
  4695       TO DFHEIV11
  4696*    MOVE '&.S                   )   #00004345' TO DFHEIV0
  4697     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4698     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4699     MOVE X'2020233030303034333435' TO DFHEIV0(25:11)
  4700     CALL 'kxdfhei1' USING DFHEIV0,
  4701           PYAJ-FILE-ID,
  4702           DFHEIV20,
  4703           DFHEIV99,
  4704           ERPYAJ-KEY,
  4705           DFHEIV99,
  4706           DFHEIV11,
  4707           DFHEIV99,
  4708           DFHEIV99
  4709     SET ADDRESS OF PENDING-PAY-ADJ TO
  4710         DFHEIV20
  4711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4712
  4713
  4714     IF FIRST-PAGE OR
  4715        PI-PREV-PFKEY = '2'
  4716         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4717         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4718
  4719     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4720
  4721     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  95
* EL633.cbl
  4722     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4723     MOVE '2'                     TO  PI-PREV-PFKEY.
  4724
  4725     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  96
* EL633.cbl
  4727 5000-START-BROWSE.
  4728
  4729* EXEC CICS HANDLE CONDITION
  4730*        NOTOPEN  (5010-NOT-OPEN)
  4731*        NOTFND   (5020-NO-RECORDS)
  4732*        ENDFILE  (5020-NO-RECORDS)
  4733*    END-EXEC.
  4734*    MOVE '"$JI''                 ! ( #00004365' TO DFHEIV0
  4735     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4736     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4737     MOVE X'2820233030303034333635' TO DFHEIV0(25:11)
  4738     CALL 'kxdfhei1' USING DFHEIV0
  4739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4740
  4741
  4742
  4743* EXEC CICS STARTBR
  4744*        DATASET  (PYAJ-FILE-ID)
  4745*        RIDFLD   (ERPYAJ-KEY)
  4746*    END-EXEC.
  4747     MOVE 0
  4748       TO DFHEIV11
  4749*    MOVE '&,         G          &   #00004371' TO DFHEIV0
  4750     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4751     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4752     MOVE X'2020233030303034333731' TO DFHEIV0(25:11)
  4753     CALL 'kxdfhei1' USING DFHEIV0,
  4754           PYAJ-FILE-ID,
  4755           ERPYAJ-KEY,
  4756           DFHEIV99,
  4757           DFHEIV11,
  4758           DFHEIV99
  4759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4760
  4761
  4762     GO TO 5030-EXIT.
  4763
  4764 5010-NOT-OPEN.
  4765     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4766
  4767     GO TO 5030-EXIT.
  4768
  4769 5020-NO-RECORDS.
  4770     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4771     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4772
  4773 5030-EXIT.
  4774     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  97
* EL633.cbl
  4776 5100-READ-PREVIOUS.
  4777
  4778* EXEC CICS HANDLE CONDITION
  4779*        ENDFILE  (5110-END-OF-FILE)
  4780*        NOTFND   (5110-END-OF-FILE)
  4781*    END-EXEC.
  4782*    MOVE '"$''I                  ! ) #00004391' TO DFHEIV0
  4783     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4785     MOVE X'2920233030303034333931' TO DFHEIV0(25:11)
  4786     CALL 'kxdfhei1' USING DFHEIV0
  4787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4788
  4789
  4790
  4791* EXEC CICS READPREV
  4792*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4793*        DATASET  (PYAJ-FILE-ID)
  4794*        RIDFLD   (ERPYAJ-KEY)
  4795*    END-EXEC.
  4796     MOVE 0
  4797       TO DFHEIV11
  4798*    MOVE '&0S                   )   #00004396' TO DFHEIV0
  4799     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4800     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4801     MOVE X'2020233030303034333936' TO DFHEIV0(25:11)
  4802     CALL 'kxdfhei1' USING DFHEIV0,
  4803           PYAJ-FILE-ID,
  4804           DFHEIV20,
  4805           DFHEIV99,
  4806           ERPYAJ-KEY,
  4807           DFHEIV99,
  4808           DFHEIV11,
  4809           DFHEIV99,
  4810           DFHEIV99
  4811     SET ADDRESS OF PENDING-PAY-ADJ TO
  4812         DFHEIV20
  4813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4814
  4815
  4816     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4817         IF PI-CARRIER-SECURITY = PY-CARRIER
  4818             NEXT SENTENCE
  4819         ELSE
  4820             GO TO 5110-END-OF-FILE.
  4821
  4822     GO TO 5120-EXIT.
  4823
  4824 5110-END-OF-FILE.
  4825     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4826     MOVE ER-2238                TO  EMI-ERROR.
  4827     MOVE -1                     TO  PFENTERL.
  4828
  4829     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4830
  4831     GO TO 8200-SEND-DATAONLY.
  4832
  4833 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  98
* EL633.cbl
  4834     EXIT.
  4835
  4836 5200-END-BROWSE.
  4837
  4838* EXEC CICS ENDBR
  4839*        DATASET  (PYAJ-FILE-ID)
  4840*    END-EXEC.
  4841     MOVE 0
  4842       TO DFHEIV11
  4843*    MOVE '&2                    $   #00004423' TO DFHEIV0
  4844     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4846     MOVE X'2020233030303034343233' TO DFHEIV0(25:11)
  4847     CALL 'kxdfhei1' USING DFHEIV0,
  4848           PYAJ-FILE-ID,
  4849           DFHEIV11,
  4850           DFHEIV99
  4851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4852
  4853
  4854 5200-EXIT.
  4855     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page  99
* EL633.cbl
  4857 6000-READ-AND-FORMAT-SCREEN.
  4858
  4859* EXEC CICS HANDLE CONDITION
  4860*        ENDFILE  (6100-END-OF-FILE)
  4861*        NOTFND   (6100-END-OF-FILE)
  4862*    END-EXEC.
  4863*    MOVE '"$''I                  ! * #00004431' TO DFHEIV0
  4864     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4866     MOVE X'2A20233030303034343331' TO DFHEIV0(25:11)
  4867     CALL 'kxdfhei1' USING DFHEIV0
  4868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4869
  4870
  4871*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4872*    INITIALIZE  PI-SEQ-NOS.
  4873
  4874 6010-READ-NEXT.
  4875
  4876
  4877* EXEC CICS READNEXT
  4878*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4879*        DATASET  (PYAJ-FILE-ID)
  4880*        RIDFLD   (ERPYAJ-KEY)
  4881*    END-EXEC.
  4882     MOVE 0
  4883       TO DFHEIV11
  4884*    MOVE '&.S                   )   #00004441' TO DFHEIV0
  4885     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4886     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4887     MOVE X'2020233030303034343431' TO DFHEIV0(25:11)
  4888     CALL 'kxdfhei1' USING DFHEIV0,
  4889           PYAJ-FILE-ID,
  4890           DFHEIV20,
  4891           DFHEIV99,
  4892           ERPYAJ-KEY,
  4893           DFHEIV99,
  4894           DFHEIV11,
  4895           DFHEIV99,
  4896           DFHEIV99
  4897     SET ADDRESS OF PENDING-PAY-ADJ TO
  4898         DFHEIV20
  4899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4900
  4901
  4902     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4903       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4904         GO TO 6100-END-OF-FILE.
  4905
  4906     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4907         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4908             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4909                 GO TO 6100-END-OF-FILE.
  4910
  4911     IF PYAJ-1ST-READ
  4912       AND EIBAID NOT = DFHENTER
  4913       AND NOT PAGE-FULL
  4914         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 100
* EL633.cbl
  4915         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4916         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4917         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4918         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4919
  4920     IF PYAJ-1ST-READ
  4921         MOVE PI-SAV-ENDING-PYAJ-KEY
  4922                                 TO  PI-START-PYAJ-KEY.
  4923
  4924     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4925        PI-SAV-CARRIER  = PY-CARRIER     AND
  4926        PI-SAV-GROUPING = PY-GROUPING    AND
  4927        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4928        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4929         NEXT SENTENCE
  4930     ELSE
  4931         IF PYAJ-1ST-READ
  4932             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4933             MOVE SPACE          TO  PYAJ-READ-SW
  4934             GO TO 6200-EXIT
  4935         ELSE
  4936             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4937             IF PINDX  IS LESS THAN  12
  4938                 SET PINDX  UP  BY  1
  4939                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4940                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4941                 SET PINDX  UP  BY  1
  4942                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4943                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4944                     GO TO 6200-EXIT
  4945             ELSE
  4946                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4947                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4948                 SET PINDX  UP  BY  1
  4949                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4950                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4951                 GO TO 6200-EXIT.
  4952
  4953*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4954
  4955     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4956         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4957
  4958*    SET PINDX  UP  BY +1.
  4959
  4960     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4961
  4962     IF PINDX  IS GREATER THAN  13
  4963         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4964         MOVE +13                TO  PI-FULL-INDX
  4965         MOVE PI-FRST-FILE-SEQ-NO
  4966                                 TO  PI-LAST-FILE-SEQ-NO
  4967         MOVE PI-FRST-RECORD-TYPE
  4968                                 TO  PI-LAST-RECORD-TYPE
  4969         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4970         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4971         GO TO 6200-EXIT.
  4972
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 101
* EL633.cbl
  4973     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4974     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4975
  4976     IF PYAJ-1ST-READ
  4977         MOVE SPACE              TO  PYAJ-READ-SW.
  4978
  4979     IF PINDX = 1
  4980         MOVE PI-PREV-FILE-SEQ-NO
  4981                                 TO  PI-FRST-FILE-SEQ-NO
  4982         MOVE PI-PREV-RECORD-TYPE
  4983                                 TO  PI-FRST-RECORD-TYPE
  4984         MOVE PI-PREV-FILE-SEQ-NO
  4985                                 TO  PI-LAST-FILE-SEQ-NO
  4986         MOVE PI-PREV-RECORD-TYPE
  4987                                 TO  PI-LAST-RECORD-TYPE.
  4988
  4989     SET NDX                     TO  PINDX.
  4990     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4991
  4992     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4993
  4994     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4995     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4996     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4997     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4998     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4999
  5000     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  5001
  5002     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  5003         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  5004     ELSE
  5005         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  5006
  5007     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  5008                                     PI-REC-TYPE (NDX).
  5009
  5010     IF PY-VOID-SW NOT = SPACE
  5011         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  5012
  5013     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5014         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5015     ELSE
  5016         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5017                                     PREV-BIN-MAINT-DT
  5018         MOVE SPACE              TO  DC-OPTION-CODE
  5019         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5020* DAN    MOVE DC-GREG-DATE-1-EDIT
  5021         MOVE DC-GREG-DATE-1-MDY
  5022                                 TO  MDTE (PINDX)
  5023                                     PREV-MAINT-DT.
  5024
  5025*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5026     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5027         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5028         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5029*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5030*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 102
* EL633.cbl
  5031     END-IF.
  5032
  5033     IF PY-BILLED-DATE NOT = LOW-VALUES
  5034         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5035                                     AMT-ATTRB (PINDX)
  5036                                     VOID-SW-ATTRB (PINDX)
  5037         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5038             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5039         ELSE
  5040             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5041                                     PREV-BIN-BL-DT
  5042             MOVE SPACE          TO  DC-OPTION-CODE
  5043             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5044* DAN        MOVE DC-GREG-DATE-1-EDIT
  5045             MOVE DC-GREG-DATE-1-MDY
  5046                                 TO  BDTE (PINDX)
  5047                                     PREV-BL-DT.
  5048
  5049     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5050         NEXT SENTENCE
  5051     ELSE
  5052         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5053                                     AMT-ATTRB     (PINDX).
  5054
  5055     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5056         MOVE PY-CREDIT-SELECT-DT
  5057                                 TO  DC-BIN-DATE-1
  5058         MOVE SPACE              TO  DC-OPTION-CODE
  5059         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5060
  5061         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5062         MOVE WS-GS-MM             TO  WS-SS-MM
  5063         MOVE WS-GS-DD             TO  WS-SS-DD
  5064         MOVE WS-GS-YY             TO  WS-SS-YY
  5065         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5066     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5067        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5068         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5069                                    AMT-ATTRB      (PINDX)
  5070                                    GL-ACCT-ATTRB  (PINDX)
  5071                                    GL-COMM-ATTRB  (PINDX)
  5072                                    VOID-SW-ATTRB  (PINDX)
  5073                                    GL-STATE-ATTRB (PINDX)
  5074                                    GL-CANC-ATTRB  (PINDX)
  5075                                    SDTE-ATTRB     (PINDX)
  5076
  5077     END-IF
  5078
  5079*    GO TO 6010-READ-NEXT.
  5080     GO TO 6200-EXIT.
  5081
  5082 6100-END-OF-FILE.
  5083     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5084
  5085     IF PINDX  IS LESS THAN  12
  5086         SET PINDX  UP  BY  1
  5087         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5088         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 103
* EL633.cbl
  5089         SET PINDX  UP  BY  1
  5090         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5091         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5092         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5093     ELSE
  5094         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5095         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5096         SET PINDX  UP  BY  1
  5097         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5098         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5099
  5100 6200-EXIT.
  5101     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 104
* EL633.cbl
  5103 7000-PYAJ-FILE-NOTOPEN.
  5104     MOVE -1                     TO  MAINTL.
  5105     MOVE ER-2232                TO  EMI-ERROR.
  5106
  5107     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5108
  5109     GO TO 8200-SEND-DATAONLY.
  5110
  5111 7100-COMP-FILE-NOTOPEN.
  5112     MOVE -1                     TO  MAINTL.
  5113     MOVE ER-2233                TO  EMI-ERROR.
  5114
  5115     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5116
  5117     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 105
* EL633.cbl
  5119*
  5120*7100-COFA-FILE-NOTOPEN.
  5121*    MOVE -1                     TO PFENTERL.
  5122*    MOVE ER-2959                TO EMI-ERROR.
  5123*    PERFORM 9900-ERROR-FORMAT THRU
  5124*            9900-EXIT.
  5125*    GO TO 8200-SEND-DATAONLY.
  5126*
  5127 8100-SEND-INITIAL-MAP.
  5128     MOVE WS-CURRENT-DT          TO  DATEO.
  5129     MOVE EIBTIME                TO  TIME-IN.
  5130     MOVE TIME-OUT               TO  TIMEO.
  5131     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5132     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5133     MOVE -1                     TO  MAINTL.
  5134     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5135     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5136
  5137     IF EIBTRNID = TRANS-ID
  5138       OR EL640-TRANS-ID
  5139       OR EL642-TRANS-ID
  5140       OR EL652-TRANS-ID
  5141       OR EL6331-TRANS-ID
  5142         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5143             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5144             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5145             MOVE PI-SAV-GROUPING  TO  GROUPO
  5146             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5147             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5148             MOVE AL-UANON         TO  MAINTA
  5149                                       CARRIERA
  5150                                       GROUPA
  5151                                       FINRESPA
  5152                                       ACCTA
  5153         ELSE
  5154             NEXT SENTENCE.
  5155
  5156
  5157* EXEC CICS SEND
  5158*        MAP     (MAP-NAME)
  5159*        MAPSET  (MAPSET-NAME)
  5160*        FROM    (EL633AO)
  5161*        ERASE
  5162*        CURSOR
  5163*        END-EXEC.
  5164     MOVE LENGTH OF
  5165      EL633AO
  5166       TO DFHEIV12
  5167     MOVE -1
  5168       TO DFHEIV11
  5169*    MOVE '8$     CT  E    H L F ,   #00004701' TO DFHEIV0
  5170     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5171     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5172     MOVE X'2020233030303034373031' TO DFHEIV0(25:11)
  5173     CALL 'kxdfhei1' USING DFHEIV0,
  5174           MAP-NAME,
  5175           EL633AO,
  5176           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 106
* EL633.cbl
  5177           MAPSET-NAME,
  5178           DFHEIV99,
  5179           DFHEIV99,
  5180           DFHEIV99,
  5181           DFHEIV11,
  5182           DFHEIV99,
  5183           DFHEIV99,
  5184           DFHEIV99
  5185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5186
  5187
  5188     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 107
* EL633.cbl
  5190 8200-SEND-DATAONLY.
  5191     MOVE WS-CURRENT-DT          TO  DATEO.
  5192     MOVE EIBTIME                TO  TIME-IN.
  5193     MOVE TIME-OUT               TO  TIMEO.
  5194     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5195     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5196     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5197     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5198
  5199
  5200* EXEC CICS SEND
  5201*        MAP     (MAP-NAME)
  5202*        MAPSET  (MAPSET-NAME)
  5203*        FROM    (EL633AO)
  5204*        DATAONLY
  5205*        CURSOR
  5206*    END-EXEC.
  5207     MOVE LENGTH OF
  5208      EL633AO
  5209       TO DFHEIV12
  5210     MOVE -1
  5211       TO DFHEIV11
  5212*    MOVE '8$D    CT       H L F ,   #00004720' TO DFHEIV0
  5213     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5214     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5215     MOVE X'2020233030303034373230' TO DFHEIV0(25:11)
  5216     CALL 'kxdfhei1' USING DFHEIV0,
  5217           MAP-NAME,
  5218           EL633AO,
  5219           DFHEIV12,
  5220           MAPSET-NAME,
  5221           DFHEIV99,
  5222           DFHEIV99,
  5223           DFHEIV99,
  5224           DFHEIV11,
  5225           DFHEIV99,
  5226           DFHEIV99,
  5227           DFHEIV99
  5228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5229
  5230
  5231     GO TO 9100-RETURN-TRAN.
  5232
  5233 8300-SEND-TEXT.
  5234
  5235* EXEC CICS SEND TEXT
  5236*        FROM    (LOGOFF-TEXT)
  5237*        LENGTH  (LOGOFF-LENGTH)
  5238*        ERASE
  5239*        FREEKB
  5240*    END-EXEC.
  5241*    MOVE '8&      T  E F  H   F -   #00004731' TO DFHEIV0
  5242     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5243     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5244     MOVE X'2020233030303034373331' TO DFHEIV0(25:11)
  5245     CALL 'kxdfhei1' USING DFHEIV0,
  5246           LOGOFF-TEXT,
  5247           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 108
* EL633.cbl
  5248           DFHEIV99,
  5249           DFHEIV99,
  5250           DFHEIV99,
  5251           DFHEIV99,
  5252           DFHEIV99,
  5253           DFHEIV99,
  5254           DFHEIV99,
  5255           DFHEIV99,
  5256           DFHEIV99,
  5257           DFHEIV99
  5258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5259
  5260
  5261
  5262* EXEC CICS RETURN
  5263*    END-EXEC.
  5264*    MOVE '.(                    ''   #00004738' TO DFHEIV0
  5265     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5267     MOVE X'2020233030303034373338' TO DFHEIV0(25:11)
  5268     CALL 'kxdfhei1' USING DFHEIV0,
  5269           DFHEIV99,
  5270           DFHEIV99,
  5271           DFHEIV99,
  5272           DFHEIV99,
  5273           DFHEIV99,
  5274           DFHEIV99
  5275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5276
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 109
* EL633.cbl
  5278 8400-LOG-JOURNAL-RECORD.
  5279*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5280*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5281
  5282*    EXEC CICS JOURNAL
  5283*        JFILEID  (PI-JOURNAL-FILE-ID)
  5284*        JTYPEID  ('EL')
  5285*        FROM     (JOURNAL-RECORD)
  5286*        LENGTH   (223)
  5287*        END-EXEC.
  5288
  5289 8500-DATE-CONVERT.
  5290
  5291* EXEC CICS LINK
  5292*        PROGRAM   (LINK-CLDATCV)
  5293*        COMMAREA  (DATE-CONVERSION-DATA)
  5294*        LENGTH    (DC-COMM-LENGTH)
  5295*    END-EXEC.
  5296*    MOVE '."C                   (   #00004753' TO DFHEIV0
  5297     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5299     MOVE X'2020233030303034373533' TO DFHEIV0(25:11)
  5300     CALL 'kxdfhei1' USING DFHEIV0,
  5301           LINK-CLDATCV,
  5302           DATE-CONVERSION-DATA,
  5303           DC-COMM-LENGTH,
  5304           DFHEIV99,
  5305           DFHEIV99,
  5306           DFHEIV99,
  5307           DFHEIV99
  5308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5309
  5310
  5311 8500-EXIT.
  5312     EXIT.
  5313
  5314 8600-DEEDIT.
  5315
  5316* EXEC CICS BIF DEEDIT
  5317*        FIELD   (DEEDIT-FIELD)
  5318*        LENGTH  (11)
  5319*    END-EXEC.
  5320     MOVE 11
  5321       TO DFHEIV11
  5322*    MOVE '@"L                   #   #00004763' TO DFHEIV0
  5323     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5324     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5325     MOVE X'2020233030303034373633' TO DFHEIV0(25:11)
  5326     CALL 'kxdfhei1' USING DFHEIV0,
  5327           DEEDIT-FIELD,
  5328           DFHEIV11
  5329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5330
  5331
  5332 8600-EXIT.
  5333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 110
* EL633.cbl
  5335 8800-UNAUTHORIZED-ACCESS.
  5336     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5337
  5338     GO TO 8300-SEND-TEXT.
  5339
  5340 8810-PF23.
  5341     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5342     MOVE XCTL-005               TO  PGM-NAME.
  5343
  5344     GO TO 9300-XCTL.
  5345
  5346 9100-RETURN-TRAN.
  5347     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5348     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5349
  5350
  5351* EXEC CICS RETURN
  5352*        TRANSID   (TRANS-ID)
  5353*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5354*        LENGTH    (PI-COMM-LENGTH)
  5355*    END-EXEC.
  5356*    MOVE '.(CT                  ''   #00004786' TO DFHEIV0
  5357     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5358     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5359     MOVE X'2020233030303034373836' TO DFHEIV0(25:11)
  5360     CALL 'kxdfhei1' USING DFHEIV0,
  5361           TRANS-ID,
  5362           PROGRAM-INTERFACE-BLOCK,
  5363           PI-COMM-LENGTH,
  5364           DFHEIV99,
  5365           DFHEIV99,
  5366           DFHEIV99
  5367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5368
  5369
  5370 9200-RETURN-MAIN-MENU.
  5371     MOVE XCTL-626               TO  PGM-NAME.
  5372
  5373     GO TO 9300-XCTL.
  5374
  5375 9300-XCTL.
  5376
  5377* EXEC CICS XCTL
  5378*        PROGRAM   (PGM-NAME)
  5379*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5380*        LENGTH    (PI-COMM-LENGTH)
  5381*    END-EXEC.
  5382*    MOVE '.$C                   %   #00004798' TO DFHEIV0
  5383     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5384     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5385     MOVE X'2020233030303034373938' TO DFHEIV0(25:11)
  5386     CALL 'kxdfhei1' USING DFHEIV0,
  5387           PGM-NAME,
  5388           PROGRAM-INTERFACE-BLOCK,
  5389           PI-COMM-LENGTH,
  5390           DFHEIV99
  5391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5392
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 111
* EL633.cbl
  5393
  5394 9400-CLEAR.
  5395     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5396
  5397     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5398     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5399                                     PI-SAV-COMP-CONTROL.
  5400
  5401     GO TO 9300-XCTL.
  5402
  5403 9500-PF12.
  5404     MOVE XCTL-010               TO  PGM-NAME.
  5405
  5406     GO TO 9300-XCTL.
  5407
  5408 9600-PGMID-ERROR.
  5409
  5410* EXEC CICS HANDLE CONDITION
  5411*        PGMIDERR  (8300-SEND-TEXT)
  5412*    END-EXEC.
  5413*    MOVE '"$L                   ! + #00004819' TO DFHEIV0
  5414     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5416     MOVE X'2B20233030303034383139' TO DFHEIV0(25:11)
  5417     CALL 'kxdfhei1' USING DFHEIV0
  5418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5419
  5420
  5421     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5422     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5423     MOVE XCTL-005               TO  PGM-NAME.
  5424     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5425     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5426
  5427     GO TO 9300-XCTL.
  5428
  5429 9900-ERROR-FORMAT.
  5430     IF NOT EMI-ERRORS-COMPLETE
  5431         MOVE LINK-001           TO  PGM-NAME
  5432
  5433* EXEC CICS LINK
  5434*            PROGRAM   (PGM-NAME)
  5435*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5436*            LENGTH    (EMI-COMM-LENGTH)
  5437*        END-EXEC.
  5438*    MOVE '."C                   (   #00004834' TO DFHEIV0
  5439     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5441     MOVE X'2020233030303034383334' TO DFHEIV0(25:11)
  5442     CALL 'kxdfhei1' USING DFHEIV0,
  5443           PGM-NAME,
  5444           ERROR-MESSAGE-INTERFACE-BLOCK,
  5445           EMI-COMM-LENGTH,
  5446           DFHEIV99,
  5447           DFHEIV99,
  5448           DFHEIV99,
  5449           DFHEIV99
  5450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 112
* EL633.cbl
  5451
  5452
  5453 9900-EXIT.
  5454     EXIT.
  5455
  5456 9990-ABEND.
  5457     MOVE LINK-004               TO  PGM-NAME.
  5458     MOVE DFHEIBLK               TO  EMI-LINE1.
  5459
  5460
  5461* EXEC CICS LINK
  5462*        PROGRAM   (PGM-NAME)
  5463*        COMMAREA  (EMI-LINE1)
  5464*        LENGTH    (72)
  5465*    END-EXEC.
  5466     MOVE 72
  5467       TO DFHEIV11
  5468*    MOVE '."C                   (   #00004847' TO DFHEIV0
  5469     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5471     MOVE X'2020233030303034383437' TO DFHEIV0(25:11)
  5472     CALL 'kxdfhei1' USING DFHEIV0,
  5473           PGM-NAME,
  5474           EMI-LINE1,
  5475           DFHEIV11,
  5476           DFHEIV99,
  5477           DFHEIV99,
  5478           DFHEIV99,
  5479           DFHEIV99
  5480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5481
  5482
  5483     MOVE -1                     TO  PFENTERL.
  5484
  5485     GO TO 8200-SEND-DATAONLY.
  5486
  5487 9995-SECURITY-VIOLATION.
  5488*                            COPY ELCSCTP.
  5489******************************************************************
  5490*                                                                *
  5491*                            ELCSCTP                             *
  5492*                            VMOD=2.001                          *
  5493*                                                                *
  5494*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5495******************************************************************
  5496
  5497
  5498     MOVE EIBDATE          TO SM-JUL-DATE.
  5499     MOVE EIBTRMID         TO SM-TERMID.
  5500     MOVE THIS-PGM         TO SM-PGM.
  5501     MOVE EIBTIME          TO TIME-IN.
  5502     MOVE TIME-OUT         TO SM-TIME.
  5503     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5504
  5505
  5506* EXEC CICS LINK
  5507*         PROGRAM  ('EL003')
  5508*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 113
* EL633.cbl
  5509*         LENGTH   (80)
  5510*    END-EXEC.
  5511     MOVE 'EL003' TO DFHEIV1
  5512     MOVE 80
  5513       TO DFHEIV11
  5514*    MOVE '."C                   (   #00004875' TO DFHEIV0
  5515     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5517     MOVE X'2020233030303034383735' TO DFHEIV0(25:11)
  5518     CALL 'kxdfhei1' USING DFHEIV0,
  5519           DFHEIV1,
  5520           SECURITY-MESSAGE,
  5521           DFHEIV11,
  5522           DFHEIV99,
  5523           DFHEIV99,
  5524           DFHEIV99,
  5525           DFHEIV99
  5526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5527
  5528
  5529******************************************************************
  5530
  5531
  5532 9995-EXIT.
  5533     EXIT.
  5534
  5535
  5536 9999-DFHBACK SECTION.
  5537     MOVE '9%                    "   ' TO DFHEIV0
  5538     MOVE 'EL633' TO DFHEIV1
  5539     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5540     GOBACK.
  5541 9999-DFHEXIT.
  5542     IF DFHEIGDJ EQUAL 0001
  5543         NEXT SENTENCE
  5544     ELSE IF DFHEIGDJ EQUAL 2
  5545         GO TO 9600-PGMID-ERROR,
  5546               9990-ABEND
  5547         DEPENDING ON DFHEIGDI
  5548     ELSE IF DFHEIGDJ EQUAL 3
  5549         GO TO 0410-NO-COMP-MSTR,
  5550               7100-COMP-FILE-NOTOPEN
  5551         DEPENDING ON DFHEIGDI
  5552     ELSE IF DFHEIGDJ EQUAL 4
  5553         GO TO 0890-EXIT
  5554         DEPENDING ON DFHEIGDI
  5555     ELSE IF DFHEIGDJ EQUAL 5
  5556         GO TO 2110-ADD-RECORD
  5557         DEPENDING ON DFHEIGDI
  5558     ELSE IF DFHEIGDJ EQUAL 6
  5559         GO TO 2120-DELETE-CONT
  5560         DEPENDING ON DFHEIGDI
  5561     ELSE IF DFHEIGDJ EQUAL 7
  5562         GO TO 2190-DUP-RECORD
  5563         DEPENDING ON DFHEIGDI
  5564     ELSE IF DFHEIGDJ EQUAL 8
  5565         GO TO 5010-NOT-OPEN,
  5566               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 10-Nov-16 11:09 Page 114
* EL633.cbl
  5567               5020-NO-RECORDS
  5568         DEPENDING ON DFHEIGDI
  5569     ELSE IF DFHEIGDJ EQUAL 9
  5570         GO TO 5110-END-OF-FILE,
  5571               5110-END-OF-FILE
  5572         DEPENDING ON DFHEIGDI
  5573     ELSE IF DFHEIGDJ EQUAL 10
  5574         GO TO 6100-END-OF-FILE,
  5575               6100-END-OF-FILE
  5576         DEPENDING ON DFHEIGDI
  5577     ELSE IF DFHEIGDJ EQUAL 11
  5578         GO TO 8300-SEND-TEXT
  5579         DEPENDING ON DFHEIGDI.
  5580     MOVE '9%                    "   ' TO DFHEIV0
  5581     MOVE 'EL633' TO DFHEIV1
  5582     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5583     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5640     Code:       16867
