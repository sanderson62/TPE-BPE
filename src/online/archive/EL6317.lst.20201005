* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   1
* EL6317.cbl
* Options: int("EL6317.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6317.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6317.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6317.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6317.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   2
* EL6317.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 071712 CR2011022800001  AJRA  NAPERSOFT CANCELS
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 100412   2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121112   2012101700002  AJRA  CHANGE PF KEYS
    35* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    38* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    39* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    40*-----------------------------------------------------------------
    41*REMARKS.
    42*        TRANSACTION - EXBD - CERTIFICATE VERIFICATION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   3
* EL6317.cbl
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL6317 WORKING STORAGE    *'.
    50 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    51 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    52 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    53 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    54 77  s1                          pic s999 comp-3 value +0.
    55 77  s2                          pic s999 comp-3 value +0.
    56 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    57 77  WS-REASON-SW                PIC X  VALUE ' '.
    58     88  REASONS-FOUND                  VALUE 'Y'.
    59     88  REASONS-NOT-FOUND              VALUE 'N'.
    60 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    61     88  NO-CERT-RW                 VALUE 'N'.
    62     88  CERT-RW                    VALUE 'Y'.
    63 01  P pointer.
    64 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    65 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    66 01  var-ptr pointer.
    67 01  env-var-len                 pic 9(4)  binary.
    68 01  rc                          pic 9(9)  binary.
    69 01  WS-KIXHOST                  PIC X(10).
    70 01  WS-KIXSYS.
    71     05  WS-KIX-FIL1             PIC X(10).
    72     05  WS-KIX-APPS             PIC X(10).
    73     05  WS-KIX-ENV              PIC X(10).
    74     05  WS-KIX-MYENV            PIC X(10).
    75     05  WS-KIX-SYS              PIC X(10).
    76*                                COPY ELCSCTM.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCTM                             *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-MESSAGE.
    87     12  FILLER                          PIC X(30)
    88            VALUE '** LOGIC SECURITY VIOLATION -'.
    89     12  SM-READ                         PIC X(6).
    90     12  FILLER                          PIC X(5)
    91            VALUE ' PGM='.
    92     12  SM-PGM                          PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' OPR='.
    95     12  SM-PROCESSOR-ID                 PIC X(4).
    96     12  FILLER                          PIC X(6)
    97            VALUE ' TERM='.
    98     12  SM-TERMID                       PIC X(4).
    99     12  FILLER                          PIC XX   VALUE SPACE.
   100     12  SM-JUL-DATE                     PIC 9(5).
   101     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   4
* EL6317.cbl
   102     12  SM-TIME                         PIC 99.99.
   103
   104*                                COPY ELCSCRTY.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCSCRTY                            *
   109*                            VMOD=2.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   112*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   113*        SAVED IN PI-SECURITY-ADDRESS.                           *
   114*                                                                *
   115******************************************************************
   116 01  SECURITY-CONTROL.
   117     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   118     12  FILLER                       PIC XX    VALUE 'SC'.
   119     12  SC-CREDIT-CODES.
   120         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   121             20  SC-CREDIT-DISPLAY    PIC X.
   122             20  SC-CREDIT-UPDATE     PIC X.
   123     12  SC-CLAIMS-CODES.
   124         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   125             20  SC-CLAIMS-DISPLAY    PIC X.
   126             20  SC-CLAIMS-UPDATE     PIC X.
   127 01 srch-commarea.
   128*                                copy ELCADLTRSPI.
   129******************************************************************
   130*                   C H A N G E   L O G
   131*
   132* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   133*-----------------------------------------------------------------
   134*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   135* EFFECTIVE    NUMBER
   136*-----------------------------------------------------------------
   137* 060611    2011022800001  PEMA  NEW COPYBOOK
   138* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   139* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   140******************************************************************
   141****************************************
   142*  commarea for NaperSoft On Demand Admin services letters
   143*  (business logic input & output)
   144****************************************
   145     03  BL-INPUT.
   146         05  BL-DATA-SRCE        PIC X.
   147         05  BL-LETTER-ID        PIC XXXX.
   148         05  BL-CARRIER          PIC X.
   149         05  BL-GROUP            PIC X(6).
   150         05  BL-STATE            PIC XX.
   151         05  BL-ACCOUNT          PIC X(10).
   152         05  BL-EFF-DT           PIC X(10).
   153         05  BL-CERT-NO          PIC X(11).
   154         05  BL-BATCH-NO         PIC X(6).
   155         05  BL-BATCH-SEQ        PIC 9(8).
   156         05  BL-RESP-NO          PIC X(10).
   157         05  BL-NO-OF-COPIES     PIC 99.
   158         05  BL-PROC-ID          PIC XXXX.
   159         05  BL-COMP-ID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   5
* EL6317.cbl
   160         05  BL-PRINT-NOW-SW     PIC X.
   161         05  BL-ENC-CD           PIC XXX.
   162         05  BL-RESEND-DT        PIC X(10).
   163         05  BL-FOLLOW-UP-DT     PIC X(10).
   164         05  BL-ARCHIVE-NO       PIC 9(8).
   165         05  BL-FUNC             PIC X(8).
   166         05  BL-COMMENTS         PIC X(100).
   167         05  FILLER REDEFINES BL-COMMENTS.
   168             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   169             10  BL-LETTER-TO-ACCT PIC X.
   170             10  BL-LETTER-TO-BENE PIC X.
   171             10  BL-WRITE-ERARCH   PIC X.
   172                 88  ERARCH-QWS      VALUE 'Q'.
   173                 88  ERARCH-BATCH    VALUE 'B'.
   174                 88  ERARCH-TEMP     VALUE 'T'.
   175             10  BL-PROCESS-TYPE PIC X(07).
   176             10  BL-CERT-FORM-ID PIC X(05).
   177             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   178             10  BL-SOURCE-SCREEN PIC X(8).
   179             10  FILLER          PIC X(25).
   180     03  BL-OUTPUT.
   181         05  BL-STATUS                   PIC X.
   182             88  BL-OK                      VALUE "P".
   183             88  BL-FAIL                  VALUE "F".
   184         05  BL-MESSAGE          PIC X(50).
   185     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   186     03  FILLER                  PIC X(31).
   187
   188*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   189*                                COPY ELCZREC.
   190******************************************************************
   191*                                                                *
   192*                                                                *
   193*                            ELCZREC.                            *
   194*                                                                *
   195*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   196*                                                                *
   197******************************************************************
   198*-----------------------------------------------------------------
   199*                   C H A N G E   L O G
   200*
   201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   202*-----------------------------------------------------------------
   203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   204* EFFECTIVE    NUMBER
   205*-----------------------------------------------------------------
   206* 122011    2011022800001  AJRA  NEW FILE
   207* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   208* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   209* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   210* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   211*-----------------------------------------------------------------
   212 01  W-Z-CONTROL-DATA.
   213     05  W-NUMBER-OF-COPIES      PIC  9.
   214     05  FILLER                  PIC  X.
   215     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   216     05  FILLER                  PIC  X.
   217     05  W-DAYS-TO-RESEND        PIC  999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   6
* EL6317.cbl
   218     05  FILLER                  PIC  X.
   219     05  W-FORM-TO-RESEND        PIC  X(4).
   220     05  W-ADD-BAR-CODE          PIC  X.
   221     05  W-PROMPT-LETTER         PIC  X.
   222     05  W-HAS-RETURN-ENV        PIC  X.
   223     05  W-ENCLOSURE-CD          PIC  XXX.
   224     05  W-SIG-FLAG-DEFAULT      PIC  X.
   225     05  W-AUTO-CLOSE-IND        PIC  X.
   226     05  FILLER                  PIC  X.
   227     05  W-LETTER-TO-BENE        PIC  X.
   228     05  FILLER                  PIC  X.
   229     05  W-LETTER-TO-ACCT        PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-LETTER-TYPE           PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-PRINT-CERTIFICATE     PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-REFUND-REQUIRED       PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-ONBASE-CODE           PIC  XX.
   238     05  FILLER                  PIC  X.
   239     05  W-ACCT-SUMM             PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-CSO-SUMM              PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-REASONS-REQUIRED      PIC  X.
   244     05  FILLER                  PIC  X(29).
   245 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   246 01  STANDARD-AREAS.
   247     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   248     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   249                                 PIC  X(08).
   250     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   251     12  QID.
   252         16  QID-TERM        PIC X(4)    VALUE SPACES.
   253         16  FILLER          PIC X(4)    VALUE '631J'.
   254     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   255     12  TIME-MT                 PIC S9(7).
   256     12  TIME-MT-R  REDEFINES TIME-MT.
   257         16  FILLER              PIC X.
   258         16  TIME-LMT            PIC 99V99.
   259         16  FILLER              PIC X(2).
   260     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   261     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   262     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   263     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   264     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   265     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   266     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
   267     12  W-CNTL-KEY.
   268         16  W-CNTL-COMPANY-ID   PIC  X(03).
   269         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   270         16  W-CNTL-GENL.
   271             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   272             20  W-CNTL-GEN2.
   273                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   274                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   275         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   7
* EL6317.cbl
   276     12  WS-ELCERT-KEY.
   277         16  W-CERT-COMPANY-CD   PIC X.
   278         16  W-CERT-CARRIER      PIC X.
   279         16  W-CERT-GROUPING     PIC X(6).
   280         16  W-CERT-STATE        PIC XX.
   281         16  W-CERT-ACCOUNT      PIC X(10).
   282         16  W-CERT-CERT-EFF-DT  PIC XX.
   283         16  W-CERT-CERT-PRIME   PIC X(10).
   284         16  W-CERT-CERT-SFX     PIC X.
   285
   286     12  WS-ELCRTT-KEY.
   287         16  WS-ELCRTT-PRIMARY   PIC X(33).
   288         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   289     12  ELCRTT-RECORD-LENGTH    PIC S9(4) COMP VALUE +552.
   290     12  ELCRTT-JOURNAL-LENGTH   PIC S9(4) COMP VALUE +575.
   291
   292     12  WS-ELEOBC-KEY.
   293         16  WS-EOBC-COMPANY-CD  PIC X.
   294         16  WS-EOBC-REC-TYPE    PIC X.
   295         16  WS-EOBC-CODE        PIC X(4).
   296         16  FILLER              PIC X(9).
   297     12  WS-ERNOTE-KEY.
   298         16  W-NOTE-COMPANY-CD   PIC X.
   299         16  W-NOTE-CARRIER      PIC X.
   300         16  W-NOTE-GROUPING     PIC X(6).
   301         16  W-NOTE-STATE        PIC XX.
   302         16  W-NOTE-ACCOUNT      PIC X(10).
   303         16  W-NOTE-CERT-EFF-DT  PIC XX.
   304         16  W-NOTE-CERT-PRIME   PIC X(10).
   305         16  W-NOTE-CERT-SFX     PIC X.
   306     12  ELLETR-KEY.
   307         16  LETR-PART-KEY.
   308             20  LETR-COMPANY-CD PIC X.
   309             20  LETR-LETTER-ID  PIC X(4).
   310         16  LETR-FILLER         PIC X(8).
   311         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   312     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   313     12  ERPNDB2-KEY.
   314         16  PNDB2-COMPANY-CD    PIC X.
   315         16  PNDB2-CARRIER       PIC X.
   316         16  PNDB2-GROUPING      PIC X(6).
   317         16  PNDB2-STATE         PIC XX.
   318         16  PNDB2-ACCOUNT       PIC X(10).
   319         16  PNDB2-CERT-EFF-DT   PIC XX.
   320         16  PNDB2-CERT-PRIME    PIC X(10).
   321         16  PNDB2-CERT-SFX      PIC X.
   322         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   323         16  PNDB2-RECORD-TYPE   PIC X.
   324     12  ERPNDB-KEY.
   325         16  PNDB-COMPANY-CD     PIC X.
   326         16  PNDB-BATCH-NO       PIC X(6).
   327         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   328         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   329     12  ERENDT-KEY.
   330         16  ENDT-COMPANY-CD       PIC X.
   331         16  ENDT-CARRIER          PIC X.
   332         16  ENDT-GROUPING         PIC X(6).
   333         16  ENDT-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   8
* EL6317.cbl
   334         16  ENDT-ACCOUNT          PIC X(10).
   335         16  ENDT-CERT-EFF-DT      PIC XX.
   336         16  ENDT-CERT-PRIME       PIC X(10).
   337         16  ENDT-CERT-SFX         PIC X.
   338         16  ENDT-RECORD-TYPE      PIC X.
   339         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   340     12  ELCRTO-KEY.
   341         16  CRTO-COMPANY-CD     PIC X.
   342         16  CRTO-CARRIER        PIC X.
   343         16  CRTO-GROUPING       PIC X(6).
   344         16  CRTO-STATE          PIC XX.
   345         16  CRTO-ACCOUNT        PIC X(10).
   346         16  CRTO-CERT-EFF-DT    PIC XX.
   347         16  CRTO-CERT-PRIME     PIC X(10).
   348         16  CRTO-CERT-SFX       PIC X.
   349         16  CRTO-RECORD-TYPE    PIC X.
   350         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   351     12  WS-ERMAIL-KEY.
   352         16  MAIL-COMPANY-CD     PIC X.
   353         16  MAIL-CARRIER        PIC X.
   354         16  MAIL-GROUPING       PIC X(6).
   355         16  MAIL-STATE          PIC XX.
   356         16  MAIL-ACCOUNT        PIC X(10).
   357         16  MAIL-CERT-EFF-DT    PIC XX.
   358         16  MAIL-CERT-PRIME     PIC X(10).
   359         16  MAIL-CERT-SFX       PIC X.
   360
   361     12  WS-ELENCC-KEY.
   362         16  WS-ENCC-COMPANY-CD  PIC X.
   363         16  WS-ENCC-REC-TYPE    PIC X.
   364         16  WS-ENCC-ENC-CODE    PIC X(5).
   365         16  FILLER              PIC X(09).
   366
   367     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   368     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   369     12  WS-CURRENT-DT.
   370         16  FILLER              PIC X(6)    VALUE SPACES.
   371         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   372     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   373     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   374         88  CANCEL-REC            VALUE 'C'.
   375         88  ISSUE-REC             VALUE 'I'.
   376     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   377     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   378     12  ELCNTL-KEY.
   379         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   380         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   381         16  CNTL-ACCESS.
   382             20  CNTL-STATE      PIC XX    VALUE SPACES.
   383             20  FILLER          PIC X     VALUE SPACES.
   384             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   385         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   386     12  ERACCT-KEY.
   387         16  ERACCT-COMP-KEY.
   388             20  ACCT-CO         PIC X     VALUE SPACES.
   389             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   390             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   391             20  ACCT-STATE      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page   9
* EL6317.cbl
   392             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   393         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   394         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   395     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   396     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   397     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   398     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   399     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   400     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   401     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   402     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   403     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   404     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   405     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   406     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   407     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   408     12  WS-RESPONSE             PIC S9(8)   COMP.
   409         88  RESP-NORMAL                  VALUE +00.
   410         88  RESP-NOTFND                  VALUE +13.
   411         88  RESP-DUPREC                  VALUE +14.
   412         88  RESP-DUPKEY                  VALUE +15.
   413         88  RESP-NOTOPEN                 VALUE +19.
   414         88  RESP-ENDFILE                 VALUE +20.
   415     12  MAP-NAME            PIC X(8)    VALUE 'EL631J'.
   416     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6317S'.
   417     12  SCREEN-NUMBER       PIC X(4)    VALUE '631J'.
   418     12  TRANS-ID            PIC X(4)    VALUE 'EXBD'.
   419     12  THIS-PGM            PIC X(8)    VALUE 'EL6317'.
   420     12  PGM-NAME            PIC X(8).
   421     12  TIME-IN             PIC S9(7).
   422     12  TIME-OUT-R  REDEFINES TIME-IN.
   423         16  FILLER          PIC X.
   424         16  TIME-OUT        PIC 99V99.
   425         16  FILLER          PIC X(2).
   426     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   427     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   428     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   429     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   430     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   431     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   432     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   433     12  WS-PHONE.
   434         16  WS-PH1              PIC XXX.
   435         16  WS-PH2              PIC XXX.
   436         16  WS-PH3              PIC XXXX.
   437     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   438     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   439
   440     12  WS-BILLING-NOTE.
   441         16  WS-BN-NOTE          PIC X(25).
   442         16  WS-BN-LTRID         PIC X(4).
   443         16  FILLER              PIC X(3).
   444         16  WS-BN-DATE          PIC X(8).
   445         16  FILLER              PIC X(3).
   446         16  WS-BN-USERID        PIC X(4).
   447         16  FILLER              PIC X(30).
   448     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   449         16  WS-MAN-BN-NOTE      PIC X(63).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  10
* EL6317.cbl
   450         16  FILLER              PIC X(14).
   451     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   452
   453 01  NEW-ELCRTO-REC.
   454     12  NEW-ELCRTO-KEY.
   455         16  NCRTO-COMPANY-CD      PIC X.
   456         16  NCRTO-CARRIER         PIC X.
   457         16  NCRTO-GROUPING        PIC X(6).
   458         16  NCRTO-STATE           PIC XX.
   459         16  NCRTO-ACCOUNT         PIC X(10).
   460         16  NCRTO-CERT-EFF-DT     PIC XX.
   461         16  NCRTO-CERT-PRIME      PIC X(10).
   462         16  NCRTO-CERT-SFX        PIC X.
   463         16  NCRTO-RECORD-TYPE     PIC X.
   464         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   465     12  NEW-ORIG-REC.
   466         16  NCRTO-INS-LAST-NAME   PIC X(15).
   467         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   468         16  NCRTO-INS-MIDDLE-INIT PIC X.
   469         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   470         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   471         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   472         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   473         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   474         16  NCRTO-LF-BENCD        PIC XX.
   475         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   476         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   477         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   478         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   479         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   480         16  NCRTO-LF-EXP-DT       PIC XX.
   481         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   482         16  NCRTO-LF-CANCEL-DT    PIC XX.
   483         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   484         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   485         16  NCRTO-AH-BENCD        PIC XX.
   486         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   487         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   488         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   489         16  NCRTO-AH-EXP-DT       PIC XX.
   490         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   491         16  NCRTO-AH-CP           PIC 99.
   492         16  NCRTO-AH-CANCEL-DT    PIC XX.
   493         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   494         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   495         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   496         16  NCRTO-1ST-PMT-DT      PIC XX.
   497         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   498         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   499         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   500         16  NCRTO-CANCEL-TRAN-IND PIC X.
   501         16  FILLER                PIC X(235).
   502
   503 01  CERT-NOTE-ENTRIES.
   504     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   505         16  CERT-NT-TEXT                PIC X(63).
   506         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   507         16  CERT-NT-LAST-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  11
* EL6317.cbl
   508         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   509
   510 01  ERCNOT-AREA.
   511     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   512     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   513     12  ERCNOT-KEY.
   514         16  ERCNOT-PARTIAL-KEY.
   515             20 ERCNOT-COMPANY-CD    PIC X.
   516             20 ERCNOT-CARRIER       PIC X.
   517             20 ERCNOT-GROUPING      PIC X(06).
   518             20 ERCNOT-STATE         PIC XX.
   519             20 ERCNOT-ACCOUNT       PIC X(10).
   520             20 ERCNOT-EFF-DT        PIC XX.
   521             20 ERCNOT-CERT-NO.
   522                25 ERCNOT-CERT-PRIME PIC X(10).
   523                25 ERCNOT-CERT-SFX   PIC X.
   524             20 ERCNOT-REC-TYP       PIC X.
   525         16 ERCNOT-SEQ           PIC S9(4) COMP.
   526     12  SV-PARTIAL-KEY.
   527         20 SV-COMPANY-CD            PIC X.
   528         20 SV-CARRIER               PIC X.
   529         20 SV-GROUPING              PIC X(06).
   530         20 SV-STATE                 PIC XX.
   531         20 SV-ACCOUNT               PIC X(10).
   532         20 SV-EFF-DT                PIC XX.
   533         20 SV-CERT-NO.
   534            25 SV-CERT-PRIME         PIC X(10).
   535            25 SV-CERT-SFX           PIC X(1).
   536         20 SV-REC-TYP               PIC X.
   537 01  ERROR-MESSAGES.
   538     12  ER-0000                 PIC X(4)  VALUE '0000'.
   539     12  ER-0004                 PIC X(4)  VALUE '0004'.
   540     12  ER-0008                 PIC X(4)  VALUE '0008'.
   541     12  ER-0023                 PIC X(4)  VALUE '0023'.
   542     12  ER-0029                 PIC X(4)  VALUE '0029'.
   543     12  ER-0068                 PIC X(4)  VALUE '0068'.
   544     12  ER-0132                 PIC X(4)  VALUE '0132'.
   545     12  ER-0142                 PIC X(4)  VALUE '0142'.
   546     12  ER-0148                 PIC X(4)  VALUE '0148'.
   547     12  ER-0215                 PIC X(4)  VALUE '0215'.
   548     12  ER-0280                 PIC X(4)  VALUE '0280'.
   549     12  ER-0348                 PIC X(4)  VALUE '0348'.
   550     12  ER-0419                 PIC X(4)  VALUE '0419'.
   551     12  ER-0894                 PIC X(4)  VALUE '0894'.
   552     12  ER-1101                 PIC X(4)  VALUE '1101'.
   553     12  ER-1236                 PIC X(4)  VALUE '1236'.
   554     12  ER-1560                 PIC X(4)  VALUE '1560'.
   555     12  ER-1818                 PIC X(4)  VALUE '1818'.
   556     12  ER-1820                 PIC X(4)  VALUE '1820'.
   557     12  ER-2056                 PIC X(4)  VALUE '2056'.
   558     12  ER-2079                 PIC X(4)  VALUE '2079'.
   559     12  ER-2208                 PIC X(4)  VALUE '2208'.
   560     12  ER-2209                 PIC X(4)  VALUE '2209'.
   561     12  ER-2237                 PIC X(4)  VALUE '2237'.
   562     12  ER-2238                 PIC X(4)  VALUE '2238'.
   563     12  ER-2253                 PIC X(4)  VALUE '2253'.
   564     12  ER-2619                 PIC X(4)  VALUE '2619'.
   565     12  ER-2651                 PIC X(4)  VALUE '2651'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  12
* EL6317.cbl
   566     12  ER-2784                 PIC X(4)  VALUE '2784'.
   567     12  ER-2785                 PIC X(4)  VALUE '2785'.
   568     12  ER-2786                 PIC X(4)  VALUE '2786'.
   569     12  ER-2791                 PIC X(4)  VALUE '2791'.
   570     12  ER-2845                 PIC X(4)  VALUE '2845'.
   571     12  ER-2848                 PIC X(4)  VALUE '2848'.
   572     12  ER-2851                 PIC X(4)  VALUE '2851'.
   573     12  ER-3830                 PIC X(4)  VALUE '3830'.
   574     12  ER-3833                 PIC X(4)  VALUE '3833'.
   575     12  ER-7345                 PIC X(4)  VALUE '7345'.
   576     12  ER-7638                 PIC X(4)  VALUE '7638'.
   577     12  ER-8888                 PIC X(4)  VALUE '8888'.
   578     12  ER-9999                 PIC X(4)  VALUE '9999'.
   579*    COPY ELCDATE.
   580******************************************************************
   581*                                                                *
   582*                                                                *
   583*                            ELCDATE.                            *
   584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   585*                            VMOD=2.003
   586*                                                                *
   587*                                                                *
   588*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   589*                 LENGTH = 200                                   *
   590******************************************************************
   591
   592 01  DATE-CONVERSION-DATA.
   593     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   594     12  DC-OPTION-CODE                PIC X.
   595         88  BIN-TO-GREG                VALUE ' '.
   596         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   597         88  EDIT-GREG-TO-BIN           VALUE '2'.
   598         88  YMD-GREG-TO-BIN            VALUE '3'.
   599         88  MDY-GREG-TO-BIN            VALUE '4'.
   600         88  JULIAN-TO-BIN              VALUE '5'.
   601         88  BIN-PLUS-ELAPSED           VALUE '6'.
   602         88  FIND-CENTURY               VALUE '7'.
   603         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   604         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   605         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   606         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   607         88  JULIAN-TO-BIN-3            VALUE 'C'.
   608         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   609         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   610         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   611         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   612         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   613         88  CHECK-LEAP-YEAR            VALUE 'H'.
   614         88  BIN-3-TO-GREG              VALUE 'I'.
   615         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   616         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   617         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   618         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   619         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   620         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   621         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   622         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   623         88  THREE-CHARACTER-BIN
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  13
* EL6317.cbl
   624                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   625         88  GREGORIAN-TO-BIN
   626                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   627         88  BIN-TO-GREGORIAN
   628                  VALUES ' ' '1' 'I' '8' 'G'.
   629         88  JULIAN-TO-BINARY
   630                  VALUES '5' 'C' 'E' 'F'.
   631     12  DC-ERROR-CODE                 PIC X.
   632         88  NO-CONVERSION-ERROR        VALUE ' '.
   633         88  DATE-CONVERSION-ERROR
   634                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   635         88  DATE-IS-ZERO               VALUE '1'.
   636         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   637         88  DATE-IS-INVALID            VALUE '3'.
   638         88  DATE1-GREATER-DATE2        VALUE '4'.
   639         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   640         88  DATE-INVALID-OPTION        VALUE '9'.
   641         88  INVALID-CENTURY            VALUE 'A'.
   642         88  ONLY-CENTURY               VALUE 'B'.
   643         88  ONLY-LEAP-YEAR             VALUE 'C'.
   644         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   645     12  DC-END-OF-MONTH               PIC X.
   646         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   647     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   648         88  USE-NORMAL-PROCESS         VALUE ' '.
   649         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   650         88  ADJUST-UP-100-YRS          VALUE '2'.
   651     12  FILLER                        PIC X.
   652     12  DC-CONVERSION-DATES.
   653         16  DC-BIN-DATE-1             PIC XX.
   654         16  DC-BIN-DATE-2             PIC XX.
   655         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   656         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   657                       DC-GREG-DATE-1-EDIT.
   658             20  DC-EDIT1-MONTH        PIC 99.
   659             20  SLASH1-1              PIC X.
   660             20  DC-EDIT1-DAY          PIC 99.
   661             20  SLASH1-2              PIC X.
   662             20  DC-EDIT1-YEAR         PIC 99.
   663         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   664         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   665                     DC-GREG-DATE-2-EDIT.
   666             20  DC-EDIT2-MONTH        PIC 99.
   667             20  SLASH2-1              PIC X.
   668             20  DC-EDIT2-DAY          PIC 99.
   669             20  SLASH2-2              PIC X.
   670             20  DC-EDIT2-YEAR         PIC 99.
   671         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   672         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   673                     DC-GREG-DATE-1-YMD.
   674             20  DC-YMD-YEAR           PIC 99.
   675             20  DC-YMD-MONTH          PIC 99.
   676             20  DC-YMD-DAY            PIC 99.
   677         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   678         16  DC-GREG-DATE-1-MDY-R REDEFINES
   679                      DC-GREG-DATE-1-MDY.
   680             20  DC-MDY-MONTH          PIC 99.
   681             20  DC-MDY-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  14
* EL6317.cbl
   682             20  DC-MDY-YEAR           PIC 99.
   683         16  DC-GREG-DATE-1-ALPHA.
   684             20  DC-ALPHA-MONTH        PIC X(10).
   685             20  DC-ALPHA-DAY          PIC 99.
   686             20  FILLER                PIC XX.
   687             20  DC-ALPHA-CENTURY.
   688                 24 DC-ALPHA-CEN-N     PIC 99.
   689             20  DC-ALPHA-YEAR         PIC 99.
   690         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   691         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   692         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   693         16  DC-JULIAN-DATE            PIC 9(05).
   694         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   695                                       PIC 9(05).
   696         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   697             20  DC-JULIAN-YEAR        PIC 99.
   698             20  DC-JULIAN-DAYS        PIC 999.
   699         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   700         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   701         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   702     12  DATE-CONVERSION-VARIBLES.
   703         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   704         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   705             20  FILLER                PIC 9(3).
   706             20  HOLD-CEN-1-CCYY.
   707                 24  HOLD-CEN-1-CC     PIC 99.
   708                 24  HOLD-CEN-1-YY     PIC 99.
   709             20  HOLD-CEN-1-MO         PIC 99.
   710             20  HOLD-CEN-1-DA         PIC 99.
   711         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   712             20  HOLD-CEN-1-R-MO       PIC 99.
   713             20  HOLD-CEN-1-R-DA       PIC 99.
   714             20  HOLD-CEN-1-R-CCYY.
   715                 24  HOLD-CEN-1-R-CC   PIC 99.
   716                 24  HOLD-CEN-1-R-YY   PIC 99.
   717             20  FILLER                PIC 9(3).
   718         16  HOLD-CENTURY-1-X.
   719             20  FILLER                PIC X(3)  VALUE SPACES.
   720             20  HOLD-CEN-1-X-CCYY.
   721                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   722                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   723             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   724             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   725         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   726             20  HOLD-CEN-1-R-X-MO     PIC XX.
   727             20  HOLD-CEN-1-R-X-DA     PIC XX.
   728             20  HOLD-CEN-1-R-X-CCYY.
   729                 24  HOLD-CEN-1-R-X-CC PIC XX.
   730                 24  HOLD-CEN-1-R-X-YY PIC XX.
   731             20  FILLER                PIC XXX.
   732         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   733         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   734         16  DC-JULIAN-DATE-1          PIC 9(07).
   735         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   736             20  DC-JULIAN-1-CCYY.
   737                 24  DC-JULIAN-1-CC    PIC 99.
   738                 24  DC-JULIAN-1-YR    PIC 99.
   739             20  DC-JULIAN-DA-1        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  15
* EL6317.cbl
   740         16  DC-JULIAN-DATE-2          PIC 9(07).
   741         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   742             20  DC-JULIAN-2-CCYY.
   743                 24  DC-JULIAN-2-CC    PIC 99.
   744                 24  DC-JULIAN-2-YR    PIC 99.
   745             20  DC-JULIAN-DA-2        PIC 999.
   746         16  DC-GREG-DATE-A-EDIT.
   747             20  DC-EDITA-MONTH        PIC 99.
   748             20  SLASHA-1              PIC X VALUE '/'.
   749             20  DC-EDITA-DAY          PIC 99.
   750             20  SLASHA-2              PIC X VALUE '/'.
   751             20  DC-EDITA-CCYY.
   752                 24  DC-EDITA-CENT     PIC 99.
   753                 24  DC-EDITA-YEAR     PIC 99.
   754         16  DC-GREG-DATE-B-EDIT.
   755             20  DC-EDITB-MONTH        PIC 99.
   756             20  SLASHB-1              PIC X VALUE '/'.
   757             20  DC-EDITB-DAY          PIC 99.
   758             20  SLASHB-2              PIC X VALUE '/'.
   759             20  DC-EDITB-CCYY.
   760                 24  DC-EDITB-CENT     PIC 99.
   761                 24  DC-EDITB-YEAR     PIC 99.
   762         16  DC-GREG-DATE-CYMD         PIC 9(08).
   763         16  DC-GREG-DATE-CYMD-R REDEFINES
   764                              DC-GREG-DATE-CYMD.
   765             20  DC-CYMD-CEN           PIC 99.
   766             20  DC-CYMD-YEAR          PIC 99.
   767             20  DC-CYMD-MONTH         PIC 99.
   768             20  DC-CYMD-DAY           PIC 99.
   769         16  DC-GREG-DATE-MDCY         PIC 9(08).
   770         16  DC-GREG-DATE-MDCY-R REDEFINES
   771                              DC-GREG-DATE-MDCY.
   772             20  DC-MDCY-MONTH         PIC 99.
   773             20  DC-MDCY-DAY           PIC 99.
   774             20  DC-MDCY-CEN           PIC 99.
   775             20  DC-MDCY-YEAR          PIC 99.
   776    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   777        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   778    12  DC-EL310-DATE                  PIC X(21).
   779    12  FILLER                         PIC X(28).
   780*    COPY ELCTEXT.
   781******************************************************************
   782*                                                                *
   783*                                                                *
   784*                            ELCTEXT.                            *
   785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   786*                            VMOD=2.008                          *
   787*                                                                *
   788*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   789*                                     FORM LETTERS,              *
   790*                                     CERT FORM DISPLAY.
   791*                                                                *
   792*   FILE TYPE = VSAM,KSDS                                        *
   793*   RECORD SIZE = 100   RECFORM = FIXED                          *
   794*                                                                *
   795*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   796*       ALTERNATE INDEX = NONE                                   *
   797*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  16
* EL6317.cbl
   798*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   799*       ALTERNATE INDEX = NONE                                   *
   800*                                                                *
   801*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   802*       ALTERNATE INDEX = NONE                                   *
   803*                                                                *
   804*   LOG = NO                                                     *
   805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   806******************************************************************
   807 01  TEXT-FILES.
   808     12  TEXT-FILE-ID                PIC XX.
   809         88  FORMS-FILE-TEXT            VALUE 'TF'.
   810         88  LETTER-FILE-TEXT           VALUE 'TL'.
   811         88  HELP-FILE-TEXT             VALUE 'TH'.
   812
   813     12  TX-CONTROL-PRIMARY.
   814         16  TX-COMPANY-CD           PIC X.
   815             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   816         16  TX-ACCESS-CD-GENL       PIC X(12).
   817
   818         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   819             20  TX-LETTER-NO        PIC X(4).
   820             20  FILLER              PIC X(8).
   821
   822         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   823             20  TX-FORM-NO          PIC X(12).
   824
   825         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   826             20  TX-HELP-TYPE        PIC X.
   827                 88  HELP-FOR-GENERAL   VALUE ' '.
   828                 88  HELP-BY-SCREEN     VALUE 'S'.
   829                 88  HELP-BY-ERROR      VALUE 'E'.
   830             20  TX-SCREEN-OR-ERROR  PIC X(4).
   831                 88  GENERAL-INFO-HELP  VALUE '0000'.
   832             20  TX-HELP-FOR-COMPANY  PIC XXX.
   833                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   834             20  FILLER              PIC X(4).
   835
   836         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   837
   838     12  TX-PROCESS-CONTROL          PIC XX.
   839         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   840
   841     12  TX-TEXT-LINE                PIC X(70).
   842
   843     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   844         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   845         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   846         88  TX-VALID-FORM-SQUEEZE-VALUE
   847                                        VALUE 'Y' ' '.
   848
   849     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   850         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   851         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   852         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   853         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   854         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   855         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  17
* EL6317.cbl
   856         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   857                                              'K' 'N' ' '
   858                                              'Z'.
   859
   860     12  TX-ARCHIVE-SW               PIC X.
   861         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   862         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   863         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   864
   865     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   866     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   867
   868     12  TX-BSR-CODE                 PIC X.
   869         88  TX-BSR-LETTER              VALUE 'B'.
   870         88  TX-NON-BSR-LETTER          VALUE ' '.
   871
   872     12  FILLER                      PIC X.
   873*****************************************************************
   874*    COPY ELCLOGOF.
   875******************************************************************
   876*                                                                *
   877*                                                                *
   878*                            ELCLOGOF.                           *
   879*                            VMOD=2.001                          *
   880*                                                                *
   881*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   882*                                                                *
   883******************************************************************
   884 01  CLASIC-LOGOFF.
   885     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   886     12  LOGOFF-TEXT.
   887         16  FILLER          PIC X(5)    VALUE SPACES.
   888         16  LOGOFF-MSG.
   889             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   890             20  FILLER      PIC X       VALUE SPACES.
   891             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   892         16  FILLER          PIC X(80)
   893           VALUE '* YOU ARE NOW LOGGED OFF'.
   894         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   895         16  FILLER          PIC X       VALUE QUOTE.
   896         16  LOGOFF-SYS-MSG  PIC X(17)
   897           VALUE 'S CLAS-IC SYSTEM '.
   898     12  TEXT-MESSAGES.
   899         16  UNACCESS-MSG    PIC X(29)
   900             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   901         16  PGMIDERR-MSG    PIC X(17)
   902             VALUE 'PROGRAM NOT FOUND'.
   903*    COPY ELCATTR.
   904******************************************************************
   905*                                                                *
   906*                            ELCATTR.                            *
   907*                            VMOD=2.001                          *
   908*                                                                *
   909*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   910*                                                                *
   911*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   912*                                                                *
   913*                   POS 1   P=PROTECTED                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  18
* EL6317.cbl
   914*                           U=UNPROTECTED                        *
   915*                           S=ASKIP                              *
   916*                   POS 2   A=ALPHA/NUMERIC                      *
   917*                           N=NUMERIC                            *
   918*                   POS 3   N=NORMAL                             *
   919*                           B=BRIGHT                             *
   920*                           D=DARK                               *
   921*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   922*                           OF=MODIFIED DATA TAG OFF             *
   923*                                                                *
   924*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   925******************************************************************
   926 01  ATTRIBUTE-LIST.
   927     12  AL-PABOF            PIC X       VALUE 'Y'.
   928     12  AL-PABON            PIC X       VALUE 'Z'.
   929     12  AL-PADOF            PIC X       VALUE '%'.
   930     12  AL-PADON            PIC X       VALUE '_'.
   931     12  AL-PANOF            PIC X       VALUE '-'.
   932     12  AL-PANON            PIC X       VALUE '/'.
   933     12  AL-SABOF            PIC X       VALUE '8'.
   934     12  AL-SABON            PIC X       VALUE '9'.
   935     12  AL-SADOF            PIC X       VALUE '@'.
   936     12  AL-SADON            PIC X       VALUE QUOTE.
   937     12  AL-SANOF            PIC X       VALUE '0'.
   938     12  AL-SANON            PIC X       VALUE '1'.
   939     12  AL-UABOF            PIC X       VALUE 'H'.
   940     12  AL-UABON            PIC X       VALUE 'I'.
   941     12  AL-UADOF            PIC X       VALUE '<'.
   942     12  AL-UADON            PIC X       VALUE '('.
   943     12  AL-UANOF            PIC X       VALUE ' '.
   944     12  AL-UANON            PIC X       VALUE 'A'.
   945     12  AL-UNBOF            PIC X       VALUE 'Q'.
   946     12  AL-UNBON            PIC X       VALUE 'R'.
   947     12  AL-UNDOF            PIC X       VALUE '*'.
   948     12  AL-UNDON            PIC X       VALUE ')'.
   949     12  AL-UNNOF            PIC X       VALUE '&'.
   950     12  AL-UNNON            PIC X       VALUE 'J'.
   951*    COPY ELCEMIB.
   952******************************************************************
   953*                                                                *
   954*                                                                *
   955*                            ELCEMIB.                            *
   956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   957*                            VMOD=2.005                          *
   958*                                                                *
   959*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   960*                                                                *
   961******************************************************************
   962 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   963     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   964     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   965     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   966     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   967     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   968     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   969     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   970     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   971     12  EMI-SWITCH1             PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  19
* EL6317.cbl
   972         88  EMI-NO-ERRORS                    VALUE '1'.
   973         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   974         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   975     12  EMI-SWITCH2             PIC X        VALUE '1'.
   976         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   977     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   978         88  EMI-AREA1-EMPTY                  VALUE '1'.
   979         88  EMI-AREA1-FULL                   VALUE '2'.
   980     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   981         88  EMI-AREA2-EMPTY                  VALUE '1'.
   982         88  EMI-AREA2-FULL                   VALUE '2'.
   983     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   984         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   985         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   986         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   987         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   988         88  EMI-BYPASS-FATALS                VALUE 'X'.
   989     12  EMI-ERROR-LINES.
   990         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   991         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   992         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   993         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   994             20  EMI-ERR-CODES OCCURS 10 TIMES.
   995                 24  EMI-ERR-NUM         PIC X(4).
   996                 24  EMI-FILLER          PIC X.
   997                 24  EMI-SEV             PIC X.
   998                 24  FILLER              PIC X.
   999             20  FILLER                  PIC X(02).
  1000     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1001         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1002             20  EMI-ERROR-NUMBER    PIC X(4).
  1003             20  EMI-FILL            PIC X.
  1004             20  EMI-SEVERITY        PIC X.
  1005             20  FILLER              PIC X.
  1006             20  EMI-ERROR-TEXT.
  1007                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1008                 24  FILLER          PIC X(55).
  1009     12  EMI-SEVERITY-SAVE           PIC X.
  1010         88  EMI-NOTE                    VALUE 'N'.
  1011         88  EMI-WARNING                 VALUE 'W'.
  1012         88  EMI-FORCABLE                VALUE 'F'.
  1013         88  EMI-FATAL                   VALUE 'X'.
  1014     12  EMI-MESSAGE-FLAG            PIC X.
  1015         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1016         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1017     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1018     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1019         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1020         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1021         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1022     12  emi-claim-no                pic x(7).
  1023     12  emi-claim-type              pic x(6).
  1024     12  FILLER                      PIC X(124)  VALUE SPACES.
  1025     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1026     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1027     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1028     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1029*    COPY ELCINTF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  20
* EL6317.cbl
  1030******************************************************************
  1031*                                                                *
  1032*                                                                *
  1033*                            ELCINTF.                            *
  1034*                            VMOD=2.017                          *
  1035*                                                                *
  1036*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1037*                                                                *
  1038*       LENGTH = 1024                                            *
  1039*                                                                *
  1040******************************************************************
  1041*                   C H A N G E   L O G
  1042*
  1043* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1044*-----------------------------------------------------------------
  1045*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1046* EFFECTIVE    NUMBER
  1047*-----------------------------------------------------------------
  1048* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1049******************************************************************
  1050 01  PROGRAM-INTERFACE-BLOCK.
  1051     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1052     12  PI-CALLING-PROGRAM              PIC X(8).
  1053     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1054     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1055     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1056     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1057     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1058     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1059     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1060     12  PI-COMPANY-ID                   PIC XXX.
  1061     12  PI-COMPANY-CD                   PIC X.
  1062
  1063     12  PI-COMPANY-PASSWORD             PIC X(8).
  1064
  1065     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1066
  1067     12  PI-CONTROL-IN-PROGRESS.
  1068         16  PI-CARRIER                  PIC X.
  1069         16  PI-GROUPING                 PIC X(6).
  1070         16  PI-STATE                    PIC XX.
  1071         16  PI-ACCOUNT                  PIC X(10).
  1072         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1073                                         PIC X(10).
  1074         16  PI-CLAIM-CERT-GRP.
  1075             20  PI-CLAIM-NO             PIC X(7).
  1076             20  PI-CERT-NO.
  1077                 25  PI-CERT-PRIME       PIC X(10).
  1078                 25  PI-CERT-SFX         PIC X.
  1079             20  PI-CERT-EFF-DT          PIC XX.
  1080         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1081             20  PI-PLAN-CODE            PIC X(2).
  1082             20  PI-REVISION-NUMBER      PIC X(3).
  1083             20  PI-PLAN-EFF-DT          PIC X(2).
  1084             20  PI-PLAN-EXP-DT          PIC X(2).
  1085             20  FILLER                  PIC X(11).
  1086         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1087             20  PI-OE-REFERENCE-1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  21
* EL6317.cbl
  1088                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1089                 25  PI-OE-REF-1-SUFF    PIC XX.
  1090
  1091     12  PI-SESSION-IN-PROGRESS          PIC X.
  1092         88  CLAIM-SESSION                   VALUE '1'.
  1093         88  CREDIT-SESSION                  VALUE '2'.
  1094         88  WARRANTY-SESSION                VALUE '3'.
  1095         88  MORTGAGE-SESSION                VALUE '4'.
  1096         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1097
  1098
  1099*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1100
  1101     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1102     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1103
  1104     12  PI-CREDIT-USER                  PIC X.
  1105         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1106         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1107
  1108     12  PI-CLAIM-USER                   PIC X.
  1109         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1110         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1111
  1112     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1113         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1114         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1115         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1116         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1117         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1118
  1119     12  PI-PROCESSOR-ID                 PIC X(4).
  1120
  1121     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1122
  1123     12  PI-MEMBER-CAPTION               PIC X(10).
  1124
  1125     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1126         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1127
  1128     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1129     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1130     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1131     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1132
  1133     12  PI-AH-OVERRIDE-L1               PIC X.
  1134     12  PI-AH-OVERRIDE-L2               PIC XX.
  1135     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1136     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1137
  1138     12  PI-NEW-SYSTEM                   PIC X(2).
  1139
  1140     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1141     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1142         88  PI-USES-PAID-TO                 VALUE '1'.
  1143     12  PI-CRDTCRD-SYSTEM.
  1144         16  PI-CRDTCRD-USER             PIC X.
  1145             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  22
* EL6317.cbl
  1146             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1147         16  PI-CC-MONTH-END-DT          PIC XX.
  1148     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1149
  1150     12  PI-OE-REFERENCE-2.
  1151         16  PI-OE-REF-2-PRIME           PIC X(10).
  1152         16  PI-OE-REF-2-SUFF            PIC X.
  1153
  1154     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1155
  1156     12  PI-LANGUAGE-TYPE                PIC X.
  1157             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1158             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1159             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1160
  1161     12  PI-POLICY-LINKAGE-IND           PIC X.
  1162         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1163         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1164                                                   LOW-VALUES.
  1165
  1166     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1167     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1168         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1169         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1170
  1171     12  PI-PROCESSOR-CSR-IND            PIC X.
  1172         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1173         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1174
  1175     12  FILLER                          PIC X(3).
  1176
  1177     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1178
  1179     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1180         PI-SYSTEM-LEVEL.
  1181
  1182         16  PI-ENTRY-CODES.
  1183             20  PI-ENTRY-CD-1           PIC X.
  1184             20  PI-ENTRY-CD-2           PIC X.
  1185
  1186         16  PI-RETURN-CODES.
  1187             20  PI-RETURN-CD-1          PIC X.
  1188             20  PI-RETURN-CD-2          PIC X.
  1189
  1190         16  PI-UPDATE-STATUS-SAVE.
  1191             20  PI-UPDATE-BY            PIC X(4).
  1192             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1193
  1194         16  PI-LOWER-CASE-LETTERS       PIC X.
  1195             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1196
  1197*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1198*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1199*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1200
  1201         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1202             88  ST-ACCNT-CNTL               VALUE ' '.
  1203             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  23
* EL6317.cbl
  1204             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1205             88  ACCNT-CNTL                  VALUE '3'.
  1206             88  CARR-ACCNT-CNTL             VALUE '4'.
  1207
  1208         16  PI-PROCESSOR-CAP-LIST.
  1209             20  PI-SYSTEM-CONTROLS.
  1210                24 PI-SYSTEM-DISPLAY     PIC X.
  1211                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1212                24 PI-SYSTEM-MODIFY      PIC X.
  1213                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1214             20  FILLER                  PIC XX.
  1215             20  PI-DISPLAY-CAP          PIC X.
  1216                 88  DISPLAY-CAP             VALUE 'Y'.
  1217             20  PI-MODIFY-CAP           PIC X.
  1218                 88  MODIFY-CAP              VALUE 'Y'.
  1219             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1220                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1221             20  PI-FORCE-CAP            PIC X.
  1222                 88  FORCE-CAP               VALUE 'Y'.
  1223
  1224         16  PI-PROGRAM-CONTROLS.
  1225             20  PI-PGM-PRINT-OPT        PIC X.
  1226             20  PI-PGM-FORMAT-OPT       PIC X.
  1227             20  PI-PGM-PROCESS-OPT      PIC X.
  1228             20  PI-PGM-TOTALS-OPT       PIC X.
  1229
  1230         16  PI-HELP-INTERFACE.
  1231             20  PI-LAST-ERROR-NO        PIC X(4).
  1232             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1233
  1234         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1235             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1236
  1237         16  PI-CR-CONTROL-IN-PROGRESS.
  1238             20  PI-CR-CARRIER           PIC X.
  1239             20  PI-CR-GROUPING          PIC X(6).
  1240             20  PI-CR-STATE             PIC XX.
  1241             20  PI-CR-ACCOUNT           PIC X(10).
  1242             20  PI-CR-FIN-RESP          PIC X(10).
  1243             20  PI-CR-TYPE              PIC X.
  1244
  1245         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1246
  1247         16  PI-CR-MONTH-END-DT          PIC XX.
  1248
  1249         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1250             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1251             88  PI-ZERO-CARRIER             VALUE '1'.
  1252             88  PI-ZERO-GROUPING            VALUE '2'.
  1253             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1254
  1255         16  PI-CARRIER-SECURITY         PIC X.
  1256             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1257
  1258         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1259             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1260             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1261
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  24
* EL6317.cbl
  1262         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1263             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1264                                         INDEXED BY PI-ACCESS-NDX
  1265                                         PIC X.
  1266
  1267         16  PI-GA-BILLING-CONTROL       PIC X.
  1268             88  PI-GA-BILLING               VALUE '1'.
  1269
  1270         16  PI-MAIL-PROCESSING          PIC X.
  1271             88  PI-MAIL-YES                 VALUE 'Y'.
  1272
  1273         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1274
  1275         16  PI-AR-SYSTEM.
  1276             20  PI-AR-PROCESSING-CNTL   PIC X.
  1277                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1278             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1279             20  PI-AR-MONTH-END-DT      PIC XX.
  1280
  1281         16  PI-MP-SYSTEM.
  1282             20  PI-MORTGAGE-USER            PIC X.
  1283                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1284                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1285             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1286                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1287                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1288                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1289                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1290                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1291             20  PI-MP-MONTH-END-DT          PIC XX.
  1292             20  PI-MP-REFERENCE-NO.
  1293                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1294                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1295
  1296         16  PI-LABEL-CONTROL            PIC X(01).
  1297             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1298             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1299
  1300         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1301             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1302
  1303         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1304             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1305             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1306
  1307         16  FILLER                      PIC X(14).
  1308
  1309     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1310******************************************************************
  1311     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1312        16  PI-ISS-CAN-SW           PIC X.
  1313        16  PI-ERENDT-KEY.
  1314            20  PI-ENDT-COMPANY-CD  PIC X.
  1315            20  PI-ENDT-CARRIER     PIC X.
  1316            20  PI-ENDT-GROUPING    PIC X(6).
  1317            20  PI-ENDT-STATE       PIC XX.
  1318            20  PI-ENDT-ACCOUNT     PIC X(10).
  1319            20  PI-ENDT-CERT-EFF-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  25
* EL6317.cbl
  1320            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1321            20  PI-ENDT-CERT-SFX    PIC X.
  1322            20  PI-ENDT-RECORD-TYPE PIC X.
  1323            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1324        16  PI-ELCRTO-KEY.
  1325            20  PI-CRTO-COMPANY-CD  PIC X.
  1326            20  PI-CRTO-CARRIER     PIC X.
  1327            20  PI-CRTO-GROUPING    PIC X(6).
  1328            20  PI-CRTO-STATE       PIC XX.
  1329            20  PI-CRTO-ACCOUNT     PIC X(10).
  1330            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1331            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1332            20  PI-CRTO-CERT-SFX    PIC X.
  1333            20  PI-CRTO-RECORD-TYPE PIC X.
  1334            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1335        16  PI-ERPNDB-KEY           PIC X(11).
  1336        16  PI-DOCUMENT-PROCESSED   PIC X.
  1337            88  PI-VERI-PROCESSED      VALUE 'V'.
  1338            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1339        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1340        16  PI-RES-REF-CLM-TYPE     PIC X.
  1341        16  PI-CLM-REFORM-IND       PIC X.
  1342        16  PI-CLEAR-ERROR-SW       PIC X.
  1343            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1344        16  PI-PRINT-CERTIFICATE    PIC X.
  1345        16  PI-ENTERED.
  1346            20  PI-PRTSW-ENTERED    PIC X.
  1347            20  PI-SIGREQ-ENTERED   PIC X.
  1348            20  PI-MONEY-ENTERED    PIC X.
  1349            20  PI-LTRID-ENTERED    PIC X(4).
  1350            20  PI-REASONS-ENTERED  PIC X(84).
  1351            20  PI-CERTNT1-ENTERED  PIC X(63).
  1352            20  PI-CERTNT2-ENTERED  PIC X(63).
  1353        16  FILLER                  PIC X(17).
  1354        16  PI-FINALIZED-IND        PIC X.
  1355        16  PI-BILLNT1-ENTERED      PIC X(63).
  1356        16  PI-BILLNT2-ENTERED      PIC X(63).
  1357        16  PI-ENCCODE              PIC X(3).
  1358        16  FILLER                  PIC X(151).
  1359    12  FILLER                      PIC X(276).
  1360*    COPY ELCAID.
  1361******************************************************************
  1362*                                                                *
  1363*                            ELCAID.                             *
  1364*                            VMOD=2.001                          *
  1365*                                                                *
  1366*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1367*                                                                *
  1368*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1369*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1370******************************************************************
  1371
  1372 01  DFHAID.
  1373   02  DFHNULL   PIC  X  VALUE  ' '.
  1374   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1375   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1376   02  DFHPEN    PIC  X  VALUE  '='.
  1377   02  DFHOPID   PIC  X  VALUE  'W'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  26
* EL6317.cbl
  1378   02  DFHPA1    PIC  X  VALUE  '%'.
  1379   02  DFHPA2    PIC  X  VALUE  '>'.
  1380   02  DFHPA3    PIC  X  VALUE  ','.
  1381   02  DFHPF1    PIC  X  VALUE  '1'.
  1382   02  DFHPF2    PIC  X  VALUE  '2'.
  1383   02  DFHPF3    PIC  X  VALUE  '3'.
  1384   02  DFHPF4    PIC  X  VALUE  '4'.
  1385   02  DFHPF5    PIC  X  VALUE  '5'.
  1386   02  DFHPF6    PIC  X  VALUE  '6'.
  1387   02  DFHPF7    PIC  X  VALUE  '7'.
  1388   02  DFHPF8    PIC  X  VALUE  '8'.
  1389   02  DFHPF9    PIC  X  VALUE  '9'.
  1390   02  DFHPF10   PIC  X  VALUE  ':'.
  1391   02  DFHPF11   PIC  X  VALUE  '#'.
  1392   02  DFHPF12   PIC  X  VALUE  '@'.
  1393   02  DFHPF13   PIC  X  VALUE  'A'.
  1394   02  DFHPF14   PIC  X  VALUE  'B'.
  1395   02  DFHPF15   PIC  X  VALUE  'C'.
  1396   02  DFHPF16   PIC  X  VALUE  'D'.
  1397   02  DFHPF17   PIC  X  VALUE  'E'.
  1398   02  DFHPF18   PIC  X  VALUE  'F'.
  1399   02  DFHPF19   PIC  X  VALUE  'G'.
  1400   02  DFHPF20   PIC  X  VALUE  'H'.
  1401   02  DFHPF21   PIC  X  VALUE  'I'.
  1402*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1403   02  DFHPF22   PIC  X  VALUE  '['.
  1404   02  DFHPF23   PIC  X  VALUE  '.'.
  1405   02  DFHPF24   PIC  X  VALUE  '<'.
  1406   02  DFHMSRE   PIC  X  VALUE  'X'.
  1407   02  DFHSTRF   PIC  X  VALUE  'h'.
  1408   02  DFHTRIG   PIC  X  VALUE  '"'.
  1409 01  FILLER    REDEFINES DFHAID.
  1410     12  FILLER              PIC X(8).
  1411     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1412*   COPY EL6317S.
  1413 01  EL631JI.
  1414     05  FILLER            PIC  X(0012).
  1415*    -------------------------------
  1416     05  DATEL PIC S9(0004) COMP.
  1417     05  DATEF PIC  X(0001).
  1418     05  FILLER REDEFINES DATEF.
  1419         10  DATEA PIC  X(0001).
  1420     05  DATEI PIC  X(0008).
  1421*    -------------------------------
  1422     05  TIMEL PIC S9(0004) COMP.
  1423     05  TIMEF PIC  X(0001).
  1424     05  FILLER REDEFINES TIMEF.
  1425         10  TIMEA PIC  X(0001).
  1426     05  TIMEI PIC  X(0005).
  1427*    -------------------------------
  1428     05  PROCIDL PIC S9(0004) COMP.
  1429     05  PROCIDF PIC  X(0001).
  1430     05  FILLER REDEFINES PROCIDF.
  1431         10  PROCIDA PIC  X(0001).
  1432     05  PROCIDI PIC  X(0004).
  1433*    -------------------------------
  1434     05  HOSTL PIC S9(0004) COMP.
  1435     05  HOSTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  27
* EL6317.cbl
  1436     05  FILLER REDEFINES HOSTF.
  1437         10  HOSTA PIC  X(0001).
  1438     05  HOSTI PIC  X(0009).
  1439*    -------------------------------
  1440     05  SYSL PIC S9(0004) COMP.
  1441     05  SYSF PIC  X(0001).
  1442     05  FILLER REDEFINES SYSF.
  1443         10  SYSA PIC  X(0001).
  1444     05  SYSI PIC  X(0005).
  1445*    -------------------------------
  1446     05  COMPANYL PIC S9(0004) COMP.
  1447     05  COMPANYF PIC  X(0001).
  1448     05  FILLER REDEFINES COMPANYF.
  1449         10  COMPANYA PIC  X(0001).
  1450     05  COMPANYI PIC  X(0003).
  1451*    -------------------------------
  1452     05  DATASORL PIC S9(0004) COMP.
  1453     05  DATASORF PIC  X(0001).
  1454     05  FILLER REDEFINES DATASORF.
  1455         10  DATASORA PIC  X(0001).
  1456     05  DATASORI PIC  X(0001).
  1457*    -------------------------------
  1458     05  BATCHNOL PIC S9(0004) COMP.
  1459     05  BATCHNOF PIC  X(0001).
  1460     05  FILLER REDEFINES BATCHNOF.
  1461         10  BATCHNOA PIC  X(0001).
  1462     05  BATCHNOI PIC  X(0006).
  1463*    -------------------------------
  1464     05  BSEQNOL PIC S9(0004) COMP.
  1465     05  BSEQNOF PIC  X(0001).
  1466     05  FILLER REDEFINES BSEQNOF.
  1467         10  BSEQNOA PIC  X(0001).
  1468     05  BSEQNOI PIC  X(0008).
  1469*    -------------------------------
  1470     05  ARCHNOL PIC S9(0004) COMP.
  1471     05  ARCHNOF PIC  X(0001).
  1472     05  FILLER REDEFINES ARCHNOF.
  1473         10  ARCHNOA PIC  X(0001).
  1474     05  ARCHNOI PIC  X(0008).
  1475*    -------------------------------
  1476     05  PRTSWL PIC S9(0004) COMP.
  1477     05  PRTSWF PIC  X(0001).
  1478     05  FILLER REDEFINES PRTSWF.
  1479         10  PRTSWA PIC  X(0001).
  1480     05  PRTSWI PIC  X(0001).
  1481*    -------------------------------
  1482     05  CARRL PIC S9(0004) COMP.
  1483     05  CARRF PIC  X(0001).
  1484     05  FILLER REDEFINES CARRF.
  1485         10  CARRA PIC  X(0001).
  1486     05  CARRI PIC  X(0001).
  1487*    -------------------------------
  1488     05  GROUPL PIC S9(0004) COMP.
  1489     05  GROUPF PIC  X(0001).
  1490     05  FILLER REDEFINES GROUPF.
  1491         10  GROUPA PIC  X(0001).
  1492     05  GROUPI PIC  X(0006).
  1493*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  28
* EL6317.cbl
  1494     05  STATEL PIC S9(0004) COMP.
  1495     05  STATEF PIC  X(0001).
  1496     05  FILLER REDEFINES STATEF.
  1497         10  STATEA PIC  X(0001).
  1498     05  STATEI PIC  X(0002).
  1499*    -------------------------------
  1500     05  ACCTL PIC S9(0004) COMP.
  1501     05  ACCTF PIC  X(0001).
  1502     05  FILLER REDEFINES ACCTF.
  1503         10  ACCTA PIC  X(0001).
  1504     05  ACCTI PIC  X(0010).
  1505*    -------------------------------
  1506     05  EFFDTL PIC S9(0004) COMP.
  1507     05  EFFDTF PIC  X(0001).
  1508     05  FILLER REDEFINES EFFDTF.
  1509         10  EFFDTA PIC  X(0001).
  1510     05  EFFDTI PIC  X(0008).
  1511*    -------------------------------
  1512     05  CERTNOL PIC S9(0004) COMP.
  1513     05  CERTNOF PIC  X(0001).
  1514     05  FILLER REDEFINES CERTNOF.
  1515         10  CERTNOA PIC  X(0001).
  1516     05  CERTNOI PIC  X(0010).
  1517*    -------------------------------
  1518     05  CRTSFXL PIC S9(0004) COMP.
  1519     05  CRTSFXF PIC  X(0001).
  1520     05  FILLER REDEFINES CRTSFXF.
  1521         10  CRTSFXA PIC  X(0001).
  1522     05  CRTSFXI PIC  X(0001).
  1523*    -------------------------------
  1524     05  SEQNOL PIC S9(0004) COMP.
  1525     05  SEQNOF PIC  X(0001).
  1526     05  FILLER REDEFINES SEQNOF.
  1527         10  SEQNOA PIC  X(0001).
  1528     05  SEQNOI PIC  X(0006).
  1529*    -------------------------------
  1530     05  SIGREQL PIC S9(0004) COMP.
  1531     05  SIGREQF PIC  X(0001).
  1532     05  FILLER REDEFINES SIGREQF.
  1533         10  SIGREQA PIC  X(0001).
  1534     05  SIGREQI PIC  X(0001).
  1535*    -------------------------------
  1536     05  LTRIDL PIC S9(0004) COMP.
  1537     05  LTRIDF PIC  X(0001).
  1538     05  FILLER REDEFINES LTRIDF.
  1539         10  LTRIDA PIC  X(0001).
  1540     05  LTRIDI PIC  X(0004).
  1541*    -------------------------------
  1542     05  ENCCODEL PIC S9(0004) COMP.
  1543     05  ENCCODEF PIC  X(0001).
  1544     05  FILLER REDEFINES ENCCODEF.
  1545         10  ENCCODEA PIC  X(0001).
  1546     05  ENCCODEI PIC  X(0003).
  1547*    -------------------------------
  1548     05  RCD01L PIC S9(0004) COMP.
  1549     05  RCD01F PIC  X(0001).
  1550     05  FILLER REDEFINES RCD01F.
  1551         10  RCD01A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  29
* EL6317.cbl
  1552     05  RCD01I PIC  X(0004).
  1553*    -------------------------------
  1554     05  RCD02L PIC S9(0004) COMP.
  1555     05  RCD02F PIC  X(0001).
  1556     05  FILLER REDEFINES RCD02F.
  1557         10  RCD02A PIC  X(0001).
  1558     05  RCD02I PIC  X(0004).
  1559*    -------------------------------
  1560     05  RCD03L PIC S9(0004) COMP.
  1561     05  RCD03F PIC  X(0001).
  1562     05  FILLER REDEFINES RCD03F.
  1563         10  RCD03A PIC  X(0001).
  1564     05  RCD03I PIC  X(0004).
  1565*    -------------------------------
  1566     05  RCD04L PIC S9(0004) COMP.
  1567     05  RCD04F PIC  X(0001).
  1568     05  FILLER REDEFINES RCD04F.
  1569         10  RCD04A PIC  X(0001).
  1570     05  RCD04I PIC  X(0004).
  1571*    -------------------------------
  1572     05  RCD05L PIC S9(0004) COMP.
  1573     05  RCD05F PIC  X(0001).
  1574     05  FILLER REDEFINES RCD05F.
  1575         10  RCD05A PIC  X(0001).
  1576     05  RCD05I PIC  X(0004).
  1577*    -------------------------------
  1578     05  RCD06L PIC S9(0004) COMP.
  1579     05  RCD06F PIC  X(0001).
  1580     05  FILLER REDEFINES RCD06F.
  1581         10  RCD06A PIC  X(0001).
  1582     05  RCD06I PIC  X(0004).
  1583*    -------------------------------
  1584     05  RCD07L PIC S9(0004) COMP.
  1585     05  RCD07F PIC  X(0001).
  1586     05  FILLER REDEFINES RCD07F.
  1587         10  RCD07A PIC  X(0001).
  1588     05  RCD07I PIC  X(0004).
  1589*    -------------------------------
  1590     05  RCD08L PIC S9(0004) COMP.
  1591     05  RCD08F PIC  X(0001).
  1592     05  FILLER REDEFINES RCD08F.
  1593         10  RCD08A PIC  X(0001).
  1594     05  RCD08I PIC  X(0004).
  1595*    -------------------------------
  1596     05  RCD09L PIC S9(0004) COMP.
  1597     05  RCD09F PIC  X(0001).
  1598     05  FILLER REDEFINES RCD09F.
  1599         10  RCD09A PIC  X(0001).
  1600     05  RCD09I PIC  X(0004).
  1601*    -------------------------------
  1602     05  RCD10L PIC S9(0004) COMP.
  1603     05  RCD10F PIC  X(0001).
  1604     05  FILLER REDEFINES RCD10F.
  1605         10  RCD10A PIC  X(0001).
  1606     05  RCD10I PIC  X(0004).
  1607*    -------------------------------
  1608     05  RCD11L PIC S9(0004) COMP.
  1609     05  RCD11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  30
* EL6317.cbl
  1610     05  FILLER REDEFINES RCD11F.
  1611         10  RCD11A PIC  X(0001).
  1612     05  RCD11I PIC  X(0004).
  1613*    -------------------------------
  1614     05  RCD12L PIC S9(0004) COMP.
  1615     05  RCD12F PIC  X(0001).
  1616     05  FILLER REDEFINES RCD12F.
  1617         10  RCD12A PIC  X(0001).
  1618     05  RCD12I PIC  X(0004).
  1619*    -------------------------------
  1620     05  CRTNT1L PIC S9(0004) COMP.
  1621     05  CRTNT1F PIC  X(0001).
  1622     05  FILLER REDEFINES CRTNT1F.
  1623         10  CRTNT1A PIC  X(0001).
  1624     05  CRTNT1I PIC  X(0063).
  1625*    -------------------------------
  1626     05  CRTNT2L PIC S9(0004) COMP.
  1627     05  CRTNT2F PIC  X(0001).
  1628     05  FILLER REDEFINES CRTNT2F.
  1629         10  CRTNT2A PIC  X(0001).
  1630     05  CRTNT2I PIC  X(0063).
  1631*    -------------------------------
  1632     05  BILNT1L PIC S9(0004) COMP.
  1633     05  BILNT1F PIC  X(0001).
  1634     05  FILLER REDEFINES BILNT1F.
  1635         10  BILNT1A PIC  X(0001).
  1636     05  BILNT1I PIC  X(0063).
  1637*    -------------------------------
  1638     05  BILNT2L PIC S9(0004) COMP.
  1639     05  BILNT2F PIC  X(0001).
  1640     05  FILLER REDEFINES BILNT2F.
  1641         10  BILNT2A PIC  X(0001).
  1642     05  BILNT2I PIC  X(0063).
  1643*    -------------------------------
  1644     05  ERRMSG1L PIC S9(0004) COMP.
  1645     05  ERRMSG1F PIC  X(0001).
  1646     05  FILLER REDEFINES ERRMSG1F.
  1647         10  ERRMSG1A PIC  X(0001).
  1648     05  ERRMSG1I PIC  X(0075).
  1649*    -------------------------------
  1650     05  ERRMSG2L PIC S9(0004) COMP.
  1651     05  ERRMSG2F PIC  X(0001).
  1652     05  FILLER REDEFINES ERRMSG2F.
  1653         10  ERRMSG2A PIC  X(0001).
  1654     05  ERRMSG2I PIC  X(0075).
  1655*    -------------------------------
  1656     05  PFENTRL PIC S9(0004) COMP.
  1657     05  PFENTRF PIC  X(0001).
  1658     05  FILLER REDEFINES PFENTRF.
  1659         10  PFENTRA PIC  X(0001).
  1660     05  PFENTRI PIC  9(2).
  1661 01  EL631JO REDEFINES EL631JI.
  1662     05  FILLER            PIC  X(0012).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  DATEO PIC  X(0008).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  31
* EL6317.cbl
  1668     05  TIMEO PIC  99.99.
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  PROCIDO PIC  X(0004).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  HOSTO PIC  X(0009).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  SYSO PIC  X(0005).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  COMPANYO PIC  X(0003).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  DATASORO PIC  X(0001).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  BATCHNOO PIC  X(0006).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  BSEQNOO PIC  X(0008).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  ARCHNOO PIC  X(0008).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  PRTSWO PIC  X(0001).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  CARRO PIC  X(0001).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  GROUPO PIC  X(0006).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  STATEO PIC  X(0002).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  ACCTO PIC  X(0010).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  EFFDTO PIC  X(0008).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  CERTNOO PIC  X(0010).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  CRTSFXO PIC  X(0001).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  SEQNOO PIC  999999.
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  SIGREQO PIC  X(0001).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  LTRIDO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  32
* EL6317.cbl
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  ENCCODEO PIC  X(0003).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  RCD01O PIC  X(0004).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  RCD02O PIC  X(0004).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  RCD03O PIC  X(0004).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  RCD04O PIC  X(0004).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  RCD05O PIC  X(0004).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  RCD06O PIC  X(0004).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  RCD07O PIC  X(0004).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  RCD08O PIC  X(0004).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  RCD09O PIC  X(0004).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  RCD10O PIC  X(0004).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  RCD11O PIC  X(0004).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  RCD12O PIC  X(0004).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  CRTNT1O PIC  X(0063).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  CRTNT2O PIC  X(0063).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  BILNT1O PIC  X(0063).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  BILNT2O PIC  X(0063).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  ERRMSG1O PIC  X(0075).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  ERRMSG2O PIC  X(0075).
  1783*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  33
* EL6317.cbl
  1784     05  FILLER            PIC  X(0003).
  1785     05  PFENTRO PIC  X(0002).
  1786*    -------------------------------
  1787 01  filler redefines el631ji.
  1788     12  filler                   pic x(188).
  1789     12  REASONCDS.
  1790         16  filler occurs 12.
  1791             20  reacdl       pic s9(4) comp.
  1792             20  reacda       pic x.
  1793             20  reacd-in     pic x(4).
  1794    12  FILLER                   PIC X(293).
  1795****************************************************************
  1796*
  1797* Copyright (c) 2007-2013 Dell Inc.
  1798* All rights reserved.
  1799*
  1800****************************************************************
  1801 01  DFHEIV.
  1802   02  DFHEIV0               PIC X(35).
  1803   02  DFHEIV1               PIC X(08).
  1804   02  DFHEIV2               PIC X(08).
  1805   02  DFHEIV3               PIC X(08).
  1806   02  DFHEIV4               PIC X(06).
  1807   02  DFHEIV5               PIC X(04).
  1808   02  DFHEIV6               PIC X(04).
  1809   02  DFHEIV7               PIC X(02).
  1810   02  DFHEIV8               PIC X(02).
  1811   02  DFHEIV9               PIC X(01).
  1812   02  DFHEIV10              PIC S9(7) COMP-3.
  1813   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1814   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1815   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1816   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1817   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1818   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1819   02  DFHEIV17              PIC X(04).
  1820   02  DFHEIV18              PIC X(04).
  1821   02  DFHEIV19              PIC X(04).
  1822   02  DFHEIV20              USAGE IS POINTER.
  1823   02  DFHEIV21              USAGE IS POINTER.
  1824   02  DFHEIV22              USAGE IS POINTER.
  1825   02  DFHEIV23              USAGE IS POINTER.
  1826   02  DFHEIV24              USAGE IS POINTER.
  1827   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1828   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1829   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1830   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1831   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1832   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1833   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1834   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1835   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1836   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1837   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1838   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1839   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1840   02  FILLER                PIC X(02).
  1841   02  DFHEIV99              PIC X(08) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  34
* EL6317.cbl
  1842   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1843   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1844   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1845   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1846   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1847   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1848 LINKAGE  SECTION.
  1849*****************************************************************
  1850*                                                               *
  1851* Copyright (c) 2007-2013 Dell Inc.                             *
  1852* All rights reserved.                                          *
  1853*                                                               *
  1854*****************************************************************
  1855 01  dfheiblk.
  1856     02  eibtime          pic s9(7) comp-3.
  1857     02  eibdate          pic s9(7) comp-3.
  1858     02  eibtrnid         pic x(4).
  1859     02  eibtaskn         pic s9(7) comp-3.
  1860     02  eibtrmid         pic x(4).
  1861     02  dfheigdi         pic s9(4) comp.
  1862     02  eibcposn         pic s9(4) comp.
  1863     02  eibcalen         pic s9(4) comp.
  1864     02  eibaid           pic x(1).
  1865     02  eibfiller1       pic x(1).
  1866     02  eibfn            pic x(2).
  1867     02  eibfiller2       pic x(2).
  1868     02  eibrcode         pic x(6).
  1869     02  eibfiller3       pic x(2).
  1870     02  eibds            pic x(8).
  1871     02  eibreqid         pic x(8).
  1872     02  eibrsrce         pic x(8).
  1873     02  eibsync          pic x(1).
  1874     02  eibfree          pic x(1).
  1875     02  eibrecv          pic x(1).
  1876     02  eibsend          pic x(1).
  1877     02  eibatt           pic x(1).
  1878     02  eibeoc           pic x(1).
  1879     02  eibfmh           pic x(1).
  1880     02  eibcompl         pic x(1).
  1881     02  eibsig           pic x(1).
  1882     02  eibconf          pic x(1).
  1883     02  eiberr           pic x(1).
  1884     02  eibrldbk         pic x(1).
  1885     02  eiberrcd         pic x(4).
  1886     02  eibsynrb         pic x(1).
  1887     02  eibnodat         pic x(1).
  1888     02  eibfiller5       pic x(2).
  1889     02  eibresp          pic s9(8) comp.
  1890     02  eibresp2         pic s9(8) comp.
  1891     02  dfheigdj         pic s9(4) comp.
  1892     02  dfheigdk         pic s9(4) comp.
  1893 01  DFHCOMMAREA                 PIC X(1300).
  1894 01  var  pic x(30).
  1895*                                COPY ERCACCT.
  1896******************************************************************
  1897*                                                                *
  1898*                                                                *
  1899*                            ERCACCT                             *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  35
* EL6317.cbl
  1900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1901*                            VMOD=2.031                          *
  1902*                                                                *
  1903*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1904*                                                                *
  1905*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1906*   VSAM ACCOUNT MASTER FILES.                                   *
  1907*                                                                *
  1908*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1909*                                                                *
  1910*   FILE TYPE = VSAM,KSDS                                        *
  1911*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1912*                                                                *
  1913*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1914*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1915*                                                                *
  1916*   LOG = NO                                                     *
  1917*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1918*                                                                *
  1919*                                                                *
  1920******************************************************************
  1921*                   C H A N G E   L O G
  1922*
  1923* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1924*-----------------------------------------------------------------
  1925*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1926* EFFECTIVE    NUMBER
  1927*-----------------------------------------------------------------
  1928* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1929* 092705    2005050300006  PEMA  ADD SPP LEASES
  1930* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1931* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1932* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1933* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1934* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1935* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1936******************************************************************
  1937
  1938 01  ACCOUNT-MASTER.
  1939     12  AM-RECORD-ID                      PIC XX.
  1940         88  VALID-AM-ID                      VALUE 'AM'.
  1941
  1942     12  AM-CONTROL-PRIMARY.
  1943         16  AM-COMPANY-CD                 PIC X.
  1944         16  AM-MSTR-CNTRL.
  1945             20  AM-CONTROL-A.
  1946                 24  AM-CARRIER            PIC X.
  1947                 24  AM-GROUPING.
  1948                     28 AM-GROUPING-PREFIX PIC XXX.
  1949                     28 AM-GROUPING-PRIME  PIC XXX.
  1950                 24  AM-STATE              PIC XX.
  1951                 24  AM-ACCOUNT.
  1952                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1953                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1954             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1955                                           PIC X(19).
  1956             20  AM-CNTRL-B.
  1957                 24  AM-EXPIRATION-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  36
* EL6317.cbl
  1958                 24  FILLER                PIC X(4).
  1959             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1960                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1961
  1962     12  AM-CONTROL-BY-VAR-GRP.
  1963         16  AM-COMPANY-CD-A1              PIC X.
  1964         16  AM-VG-CARRIER                 PIC X.
  1965         16  AM-VG-GROUPING                PIC X(6).
  1966         16  AM-VG-STATE                   PIC XX.
  1967         16  AM-VG-ACCOUNT                 PIC X(10).
  1968         16  AM-VG-DATE.
  1969             20  AM-VG-EXPIRATION-DT       PIC XX.
  1970             20  FILLER                    PIC X(4).
  1971         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1972                                           PIC 9(11)      COMP-3.
  1973     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1974         16  FILLER                        PIC X(10).
  1975         16  AM-VG-KEY3.
  1976             20  AM-VG3-ACCOUNT            PIC X(10).
  1977             20  AM-VG3-EXP-DT             PIC XX.
  1978         16  FILLER                        PIC X(4).
  1979     12  AM-MAINT-INFORMATION.
  1980         16  AM-LAST-MAINT-DT              PIC XX.
  1981         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1982         16  AM-LAST-MAINT-USER            PIC X(4).
  1983         16  FILLER                        PIC XX.
  1984
  1985     12  AM-EFFECTIVE-DT                   PIC XX.
  1986     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1987
  1988     12  AM-PREV-DATES  COMP-3.
  1989         16  AM-PREV-EXP-DT                PIC 9(11).
  1990         16  AM-PREV-EFF-DT                PIC 9(11).
  1991
  1992     12  AM-REPORT-CODE-1                  PIC X(10).
  1993     12  AM-REPORT-CODE-2                  PIC X(10).
  1994
  1995     12  AM-CITY-CODE                      PIC X(4).
  1996     12  AM-COUNTY-PARISH                  PIC X(6).
  1997
  1998     12  AM-NAME                           PIC X(30).
  1999     12  AM-PERSON                         PIC X(30).
  2000     12  AM-ADDRS                          PIC X(30).
  2001     12  AM-CITY.
  2002         16  AM-ADDR-CITY                  PIC X(28).
  2003         16  AM-ADDR-STATE                 PIC XX.
  2004     12  AM-ZIP.
  2005         16  AM-ZIP-PRIME.
  2006             20  AM-ZIP-PRI-1ST            PIC X.
  2007                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2008             20  FILLER                    PIC X(4).
  2009         16  AM-ZIP-PLUS4                  PIC X(4).
  2010     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2011         16  AM-CAN-POSTAL-1               PIC XXX.
  2012         16  AM-CAN-POSTAL-2               PIC XXX.
  2013         16  FILLER                        PIC XXX.
  2014     12  AM-TEL-NO.
  2015         16  AM-AREA-CODE                  PIC 999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  37
* EL6317.cbl
  2016         16  AM-TEL-PRE                    PIC 999.
  2017         16  AM-TEL-NBR                    PIC 9(4).
  2018     12  AM-TEL-LOC                        PIC X.
  2019         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2020         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2021
  2022     12  AM-COMM-STRUCTURE.
  2023         16  AM-DEFN-1.
  2024             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2025                 24  AM-AGT.
  2026                     28  AM-AGT-PREFIX     PIC X(4).
  2027                     28  AM-AGT-PRIME      PIC X(6).
  2028                 24  AM-COM-TYP            PIC X.
  2029                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2030                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2031                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2032                 24  AM-RECALC-LV-INDIC    PIC X.
  2033                 24  AM-RETRO-LV-INDIC     PIC X.
  2034                 24  AM-GL-CODES           PIC X.
  2035                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2036                 24  FILLER                PIC X(01).
  2037         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2038             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2039                 24  FILLER                PIC X(11).
  2040                 24  AM-L-COMA             PIC XXX.
  2041                 24  AM-J-COMA             PIC XXX.
  2042                 24  AM-A-COMA             PIC XXX.
  2043                 24  FILLER                PIC X(6).
  2044
  2045     12  AM-COMM-CHANGE-STATUS             PIC X.
  2046         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2047
  2048     12  AM-CSR-CODE                       PIC X(4).
  2049
  2050     12  AM-BILLING-STATUS                 PIC X.
  2051         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2052         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2053     12  AM-AUTO-REFUND-SW                 PIC X.
  2054         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2055         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2056     12  AM-GPCD                           PIC 99.
  2057     12  AM-IG                             PIC X.
  2058         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2059         88  AM-HAS-GROUP                     VALUE '2'.
  2060     12  AM-STATUS                         PIC X.
  2061         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2062         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2063         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2064         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2065         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2066         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2067         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2068         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2069         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2070         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2071     12  AM-REMIT-TO                       PIC 99.
  2072     12  AM-ID-NO                          PIC X(11).
  2073
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  38
* EL6317.cbl
  2074     12  AM-CAL-TABLE                      PIC XX.
  2075     12  AM-LF-DEVIATION                   PIC XXX.
  2076     12  AM-AH-DEVIATION                   PIC XXX.
  2077     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2078     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2079     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2080     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2081     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2082     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2083
  2084     12  AM-USER-FIELDS.
  2085         16  AM-FLD-1                      PIC XX.
  2086         16  AM-FLD-2                      PIC XX.
  2087         16  AM-FLD-3                      PIC XX.
  2088         16  AM-FLD-4                      PIC XX.
  2089         16  AM-FLD-5                      PIC XX.
  2090
  2091     12  AM-1ST-PROD-DATE.
  2092         16  AM-1ST-PROD-YR                PIC XX.
  2093         16  AM-1ST-PROD-MO                PIC XX.
  2094         16  AM-1ST-PROD-DA                PIC XX.
  2095     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2096     12  AM-CERTS-PURGED-DATE.
  2097         16  AM-PUR-YR                     PIC XX.
  2098         16  AM-PUR-MO                     PIC XX.
  2099         16  AM-PUR-DA                     PIC XX.
  2100     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2101     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2102     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2103     12  AM-INACTIVE-DATE.
  2104         16  AM-INA-MO                     PIC 99.
  2105         16  AM-INA-DA                     PIC 99.
  2106         16  AM-INA-YR                     PIC 99.
  2107     12  AM-AR-HI-CERT-DATE                PIC XX.
  2108
  2109     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2110     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2111
  2112     12  AM-OB-PAYMENT-MODE                PIC X.
  2113         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2114         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2115         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2116         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2117
  2118     12  AM-AH-ONLY-INDICATOR              PIC X.
  2119         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2120         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2121
  2122     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2123
  2124     12  AM-OVER-SHORT.
  2125         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2126         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2127
  2128     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2129     12  AM-DCC-CLP-STATE                  PIC XX.
  2130
  2131     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  39
* EL6317.cbl
  2132     12  AM-RECALC-REIN                    PIC X.
  2133
  2134     12  AM-REI-TABLE                      PIC XXX.
  2135     12  AM-REI-ET-LF                      PIC X.
  2136     12  AM-REI-ET-AH                      PIC X.
  2137     12  AM-REI-PE-LF                      PIC X.
  2138     12  AM-REI-PE-AH                      PIC X.
  2139     12  AM-REI-PRT-ST                     PIC X.
  2140     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2141     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2142     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2143     12  AM-REI-GROUP-A                    PIC X(6).
  2144     12  AM-REI-MORT                       PIC X(4).
  2145     12  AM-REI-PRT-OW                     PIC X.
  2146     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2147     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2148     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2149     12  AM-REI-GROUP-B                    PIC X(6).
  2150
  2151     12  AM-TRUST-TYPE                     PIC X(2).
  2152
  2153     12  AM-EMPLOYER-STMT-USED             PIC X.
  2154     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2155
  2156     12  AM-STD-AH-TYPE                    PIC XX.
  2157     12  AM-EARN-METHODS.
  2158         16  AM-EARN-METHOD-R              PIC X.
  2159             88 AM-REF-RL-R78                 VALUE 'R'.
  2160             88 AM-REF-RL-PR                  VALUE 'P'.
  2161             88 AM-REF-RL-MEAN                VALUE 'M'.
  2162             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2163         16  AM-EARN-METHOD-L              PIC X.
  2164             88 AM-REF-LL-R78                 VALUE 'R'.
  2165             88 AM-REF-LL-PR                  VALUE 'P'.
  2166             88 AM-REF-LL-MEAN                VALUE 'M'.
  2167             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2168         16  AM-EARN-METHOD-A              PIC X.
  2169             88 AM-REF-AH-R78                 VALUE 'R'.
  2170             88 AM-REF-AH-PR                  VALUE 'P'.
  2171             88 AM-REF-AH-MEAN                VALUE 'M'.
  2172             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2173             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2174             88 AM-REF-AH-NET                 VALUE 'N'.
  2175
  2176     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2177     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2178     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2179
  2180     12  AM-RET-Y-N                        PIC X.
  2181     12  AM-RET-P-E                        PIC X.
  2182     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2183     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2184     12  AM-RET-GRP                        PIC X(6).
  2185     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2186         16  AM-POOL-PRIME                 PIC XXX.
  2187         16  AM-POOL-SUB                   PIC XXX.
  2188     12  AM-RETRO-EARNINGS.
  2189         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  40
* EL6317.cbl
  2190         16  AM-RET-EARN-L                 PIC X.
  2191         16  AM-RET-EARN-A                 PIC X.
  2192     12  AM-RET-ST-TAX-USE                 PIC X.
  2193         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2194         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2195     12  AM-RETRO-BEG-EARNINGS.
  2196         16  AM-RET-BEG-EARN-R             PIC X.
  2197         16  AM-RET-BEG-EARN-L             PIC X.
  2198         16  AM-RET-BEG-EARN-A             PIC X.
  2199     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2200     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2201
  2202     12  AM-USER-SELECT-OPTIONS.
  2203         16  AM-USER-SELECT-1              PIC X(10).
  2204         16  AM-USER-SELECT-2              PIC X(10).
  2205         16  AM-USER-SELECT-3              PIC X(10).
  2206         16  AM-USER-SELECT-4              PIC X(10).
  2207         16  AM-USER-SELECT-5              PIC X(10).
  2208
  2209     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2210
  2211     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2212
  2213     12  AM-RPT045A-SWITCH                 PIC X.
  2214         88  RPT045A-OFF                   VALUE 'N'.
  2215
  2216     12  AM-INSURANCE-LIMITS.
  2217         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2218         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2219
  2220     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2221         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2222
  2223     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2224         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2225         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2226
  2227     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2228
  2229     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2230     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2231     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2232     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2233     12  AM-DCC-UEF-STATE                  PIC XX.
  2234     12  FILLER                            PIC XXX.
  2235     12  AM-REPORT-CODE-3                  PIC X(10).
  2236*    12  FILLER                            PIC X(22).
  2237
  2238     12  AM-RESERVE-DATE.
  2239         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2240         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2241         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2242
  2243     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2244     12  AM-NOTIFICATION-TYPES.
  2245         16  AM-NOTIF-OF-LETTERS           PIC X.
  2246         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2247         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  41
* EL6317.cbl
  2248         16  AM-NOTIF-OF-STATUS            PIC X.
  2249
  2250     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2251         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2252         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2253         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2254         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2255
  2256     12  AM-BENEFIT-CONTROLS.
  2257         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2258             20  AM-BENEFIT-CODE           PIC XX.
  2259             20  AM-BENEFIT-TYPE           PIC X.
  2260             20  AM-BENEFIT-REVISION       PIC XXX.
  2261             20  AM-BENEFIT-REM-TERM       PIC X.
  2262             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2263             20  FILLER                    PIC XX.
  2264         16  FILLER                        PIC X(80).
  2265
  2266     12  AM-TRANSFER-DATA.
  2267         16  AM-TRANSFERRED-FROM.
  2268             20  AM-TRNFROM-CARRIER        PIC X.
  2269             20  AM-TRNFROM-GROUPING.
  2270                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2271                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2272             20  AM-TRNFROM-STATE          PIC XX.
  2273             20  AM-TRNFROM-ACCOUNT.
  2274                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2275                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2276             20  AM-TRNFROM-DTE            PIC XX.
  2277         16  AM-TRANSFERRED-TO.
  2278             20  AM-TRNTO-CARRIER          PIC X.
  2279             20  AM-TRNTO-GROUPING.
  2280                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2281                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2282             20  AM-TRNTO-STATE            PIC XX.
  2283             20  AM-TRNTO-ACCOUNT.
  2284                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2285                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2286             20  AM-TRNTO-DTE              PIC XX.
  2287         16  FILLER                        PIC X(10).
  2288
  2289     12  AM-SAVED-REMIT-TO                 PIC 99.
  2290
  2291     12  AM-COMM-STRUCTURE-SAVED.
  2292         16  AM-DEFN-1-SAVED.
  2293             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2294                 24  AM-AGT-SV             PIC X(10).
  2295                 24  AM-COM-TYP-SV         PIC X.
  2296                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2297                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2298                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2299                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2300                 24  FILLER                PIC X.
  2301                 24  AM-GL-CODES-SV        PIC X.
  2302                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2303                 24  FILLER                PIC X.
  2304         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2305             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  42
* EL6317.cbl
  2306                 24  FILLER                PIC X(11).
  2307                 24  AM-L-COMA-SV          PIC XXX.
  2308                 24  AM-J-COMA-SV          PIC XXX.
  2309                 24  AM-A-COMA-SV          PIC XXX.
  2310                 24  FILLER                PIC X(6).
  2311
  2312     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2313         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2314            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2315            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2316            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2317
  2318     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2319     12  FILLER                            PIC X(120).
  2320
  2321     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2322         16  AM-CONTROL-NAME               PIC X(30).
  2323         16  AM-EXECUTIVE-ONE.
  2324             20  AM-EXEC1-NAME             PIC X(15).
  2325             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2326                                                          COMP-3.
  2327             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2328                                                          COMP-3.
  2329         16  AM-EXECUTIVE-TWO.
  2330             20  AM-EXEC2-NAME             PIC X(15).
  2331             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2332                                                          COMP-3.
  2333             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2334                                                          COMP-3.
  2335
  2336     12  AM-RETRO-ADDITIONAL-DATA.
  2337         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2338         16  AM-RETRO-PREM-P-E             PIC X.
  2339         16  AM-RETRO-CLMS-P-I             PIC X.
  2340         16  AM-RETRO-RET-BRACKET-LF.
  2341             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2342                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2343                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2344             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2345                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2346                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2347             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2348                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2349                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2350         16  AM-RETRO-RET-BRACKET-AH.
  2351             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2352                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2353                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2354                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2355             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2356                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2357                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2358             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2359                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2360                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2361
  2362     12  AM-COMMENTS.
  2363         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  43
* EL6317.cbl
  2364
  2365     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2366         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2367         16  AM-FLI-BILLING-CODE           PIC X.
  2368         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2369         16  AM-FLI-UNITED-IDENT           PIC X.
  2370         16  AM-FLI-INTEREST-LOST-DATA.
  2371             20  AM-FLI-BANK-NO            PIC X(5).
  2372             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2373             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2374             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2375         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2376             20  AM-FLI-AGT                PIC X(9).
  2377             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2378             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2379         16  FILLER                        PIC X(102).
  2380
  2381     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2382         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2383             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2384             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2385             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2386             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2387             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2388         16  FILLER                          PIC X(10).
  2389******************************************************************
  2390*                                COPY ELCCNTL.
  2391******************************************************************
  2392*                                                                *
  2393*                                                                *
  2394*                            ELCCNTL.                            *
  2395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2396*                            VMOD=2.059                          *
  2397*                                                                *
  2398*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2399*                                                                *
  2400*   FILE TYPE = VSAM,KSDS                                        *
  2401*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2402*                                                                *
  2403*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2404*       ALTERNATE INDEX = NONE                                   *
  2405*                                                                *
  2406*   LOG = YES                                                    *
  2407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2408******************************************************************
  2409*                   C H A N G E   L O G
  2410*
  2411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2412*-----------------------------------------------------------------
  2413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2414* EFFECTIVE    NUMBER
  2415*-----------------------------------------------------------------
  2416* 082503                   PEMA  ADD BENEFIT GROUP
  2417* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2418* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2419* 092705    2005050300006  PEMA  ADD SPP LEASES
  2420* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2421* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  44
* EL6317.cbl
  2422* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2423* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2424* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2425* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2426* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2427* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2428* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2429* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2430******************************************************************
  2431*
  2432 01  CONTROL-FILE.
  2433     12  CF-RECORD-ID                       PIC XX.
  2434         88  VALID-CF-ID                        VALUE 'CF'.
  2435
  2436     12  CF-CONTROL-PRIMARY.
  2437         16  CF-COMPANY-ID                  PIC XXX.
  2438         16  CF-RECORD-TYPE                 PIC X.
  2439             88  CF-COMPANY-MASTER              VALUE '1'.
  2440             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2441             88  CF-STATE-MASTER                VALUE '3'.
  2442             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2443             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2444             88  CF-CARRIER-MASTER              VALUE '6'.
  2445             88  CF-MORTALITY-MASTER            VALUE '7'.
  2446             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2447             88  CF-TERMINAL-MASTER             VALUE '9'.
  2448             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2449             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2450             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2451             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2452             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2453             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2454             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2455             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2456             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2457         16  CF-ACCESS-CD-GENL              PIC X(4).
  2458         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2459             20  CF-PROCESSOR               PIC X(4).
  2460         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2461             20  CF-STATE-CODE              PIC XX.
  2462             20  FILLER                     PIC XX.
  2463         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2464             20  FILLER                     PIC XX.
  2465             20  CF-HI-BEN-IN-REC           PIC XX.
  2466         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2467             20  FILLER                     PIC XXX.
  2468             20  CF-CARRIER-CNTL            PIC X.
  2469         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2470             20  FILLER                     PIC XX.
  2471             20  CF-HI-TYPE-IN-REC          PIC 99.
  2472         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2473             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2474                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2475             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2476             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2477         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2478             20  FILLER                     PIC X.
  2479             20  CF-CUSTOM-REPORT-NO        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  45
* EL6317.cbl
  2480         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2481             20  FILLER                     PIC XX.
  2482             20  CF-MORTGAGE-PLAN           PIC XX.
  2483         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2484
  2485     12  CF-LAST-MAINT-DT                   PIC XX.
  2486     12  CF-LAST-MAINT-BY                   PIC X(4).
  2487     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2488
  2489     12  CF-RECORD-BODY                     PIC X(728).
  2490
  2491
  2492****************************************************************
  2493*             COMPANY MASTER RECORD                            *
  2494****************************************************************
  2495
  2496     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2497         16  CF-COMPANY-ADDRESS.
  2498             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2499             20  CF-CL-IN-CARE-OF           PIC X(30).
  2500             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2501             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2502             20  CF-CL-CITY-STATE           PIC X(30).
  2503             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2504             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2505         16  CF-COMPANY-CD                  PIC X.
  2506         16  CF-COMPANY-PASSWORD            PIC X(8).
  2507         16  CF-SECURITY-OPTION             PIC X.
  2508             88  ALL-SECURITY                   VALUE '1'.
  2509             88  COMPANY-VERIFY                 VALUE '2'.
  2510             88  PROCESSOR-VERIFY               VALUE '3'.
  2511             88  NO-SECURITY                    VALUE '4'.
  2512             88  ALL-BUT-TERM                   VALUE '5'.
  2513         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2514             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2515         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2516             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2517         16  CF-INFORCE-LOCATION            PIC X.
  2518             88  CERTS-ARE-ONLINE               VALUE '1'.
  2519             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2520             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2521         16  CF-LOWER-CASE-LETTERS          PIC X.
  2522         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2523             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2524             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2525             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2526             88  CF-ACCNT-CNTL                  VALUE '3'.
  2527             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2528
  2529         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2530         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2531
  2532         16  CF-LGX-CREDIT-USER             PIC X.
  2533             88  CO-IS-NOT-USER                 VALUE 'N'.
  2534             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2535
  2536         16 CF-CREDIT-CALC-CODES.
  2537             20  CF-CR-REM-TERM-CALC PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  46
* EL6317.cbl
  2538               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2539               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2540               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2541               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2542               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2543               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2544               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2545             20  CF-CR-R78-METHOD           PIC X.
  2546               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2547               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2548
  2549         16  CF-CLAIM-CONTROL-COUNTS.
  2550             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2551                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2552
  2553             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2554                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2555
  2556             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2557                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2558
  2559             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2560                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2561
  2562         16  CF-CURRENT-MONTH-END           PIC XX.
  2563
  2564         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2565             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2566             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2567             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2568             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2569                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2570                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2571             20  CF-CO-PREM-REJECT-SW       PIC X.
  2572                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2573                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2574             20  CF-CO-REF-REJECT-SW        PIC X.
  2575                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2576                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2577
  2578         16  CF-CO-REPORTING-DT             PIC XX.
  2579         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2580         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2581           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2582           88  CF-CO-MONTH-END                  VALUE '1'.
  2583
  2584         16  CF-LGX-CLAIM-USER              PIC X.
  2585             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2586             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2587
  2588         16  CF-CREDIT-EDIT-CONTROLS.
  2589             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2590             20  CF-MIN-AGE                 PIC 99.
  2591             20  CF-DEFAULT-AGE             PIC 99.
  2592             20  CF-MIN-TERM                PIC S999      COMP-3.
  2593             20  CF-MAX-TERM                PIC S999      COMP-3.
  2594             20  CF-DEFAULT-SEX             PIC X.
  2595             20  CF-JOINT-AGE-INPUT         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  47
* EL6317.cbl
  2596                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2597             20  CF-BIRTH-DATE-INPUT        PIC X.
  2598                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2599             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2600                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2601                 88  CF-ZERO-CARRIER            VALUE '1'.
  2602                 88  CF-ZERO-GROUPING           VALUE '2'.
  2603                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2604             20  CF-EDIT-SW                 PIC X.
  2605                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2606             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2607             20  CF-CR-PR-METHOD            PIC X.
  2608               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2609               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2610             20  FILLER                     PIC X.
  2611
  2612         16  CF-CREDIT-MISC-CONTROLS.
  2613             20  CF-REIN-TABLE-SW           PIC X.
  2614                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2615             20  CF-COMP-TABLE-SW           PIC X.
  2616                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2617             20  CF-EXPERIENCE-RETENTION-AGE
  2618                                            PIC S9        COMP-3.
  2619             20  CF-CONVERSION-DT           PIC XX.
  2620             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2621             20  CF-RUN-FREQUENCY-SW        PIC X.
  2622                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2623                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2624
  2625             20  CF-CR-CHECK-NO-CONTROL.
  2626                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2627                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2628                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2629                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2630                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2631                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2632
  2633                 24  CF-CR-CHECK-COUNT       REDEFINES
  2634                     CF-CR-CHECK-COUNTER      PIC X(4).
  2635
  2636                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2637                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2638
  2639                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2640                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2641                 24  CF-MAIL-PROCESSING       PIC X.
  2642                     88  MAIL-PROCESSING          VALUE 'Y'.
  2643
  2644         16  CF-MISC-SYSTEM-CONTROL.
  2645             20  CF-SYSTEM-C                 PIC X.
  2646                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2647             20  CF-SYSTEM-D                 PIC X.
  2648                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2649             20  CF-SOC-SEC-NO-SW            PIC X.
  2650                 88  SOC-SEC-NO-USED             VALUE '1'.
  2651             20  CF-MEMBER-NO-SW             PIC X.
  2652                 88  MEMBER-NO-USED              VALUE '1'.
  2653             20  CF-TAX-ID-NUMBER            PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  48
* EL6317.cbl
  2654             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2655             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2656                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2657                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2658                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2659                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2660             20  CF-SYSTEM-E                 PIC X.
  2661                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2662
  2663         16  CF-LGX-LIFE-USER               PIC X.
  2664             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2665             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2666
  2667         16  CF-CR-MONTH-END-DT             PIC XX.
  2668
  2669         16  CF-FILE-MAINT-DATES.
  2670             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2671                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2672             20  CF-LAST-BATCH       REDEFINES
  2673                 CF-LAST-BATCH-NO               PIC X(4).
  2674             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2675             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2676             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2677             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2678             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2679             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2680             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2681             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2682             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2683             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2684
  2685         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2686         16  FILLER                         PIC X.
  2687
  2688         16  CF-ALT-MORT-CODE               PIC X(4).
  2689         16  CF-MEMBER-CAPTION              PIC X(10).
  2690
  2691         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2692             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2693             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2694             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2695             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2696             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2697
  2698         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2699
  2700         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2701         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2702         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2703         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2704
  2705         16  CF-AH-OVERRIDE-L1              PIC X.
  2706         16  CF-AH-OVERRIDE-L2              PIC XX.
  2707         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2708         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2709
  2710         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2711         16  CF-REPORT-CD2-CAPTION          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  49
* EL6317.cbl
  2712
  2713         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2714         16  CF-AR-LAST-EL860-DT            PIC XX.
  2715         16  CF-MP-MONTH-END-DT             PIC XX.
  2716
  2717         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2718         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2719             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2720
  2721         16  CF-AR-MONTH-END-DT             PIC XX.
  2722
  2723         16  CF-CRDTCRD-USER                PIC X.
  2724             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2725             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2726
  2727         16  CF-CC-MONTH-END-DT             PIC XX.
  2728
  2729         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2730
  2731         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2732             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2733             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2734             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2735         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2736         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2737         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2738         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2739             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2740             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2741         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2742         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2743         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2744             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2745         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2746
  2747         16  CF-CL-ZIP-CODE.
  2748             20  CF-CL-ZIP-PRIME.
  2749                 24  CF-CL-ZIP-1ST          PIC X.
  2750                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2751                 24  FILLER                 PIC X(4).
  2752             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2753         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2754             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2755             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2756             20  FILLER                     PIC XXX.
  2757
  2758         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2759         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2760         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2761         16  CF-CO-OPTION-START-DATE        PIC XX.
  2762         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2763           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2764                                                      '3' '4'.
  2765           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2766           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2767           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2768           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2769           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  50
* EL6317.cbl
  2770           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2771
  2772         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2773
  2774         16  CF-PAYMENT-APPROVAL-LEVELS.
  2775             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2776             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2777             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2778             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2779             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2780             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2781
  2782         16  CF-END-USER-REPORTING-USER     PIC X.
  2783             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2784             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2785
  2786         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2787             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2788             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2789
  2790         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2791
  2792         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2793         16  FILLER                         PIC X.
  2794
  2795         16  CF-CREDIT-ARCHIVE-CNTL.
  2796             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2797             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2798             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2799
  2800         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2801
  2802         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2803             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2804             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2805
  2806         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2807             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2808             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2809
  2810         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2811
  2812         16  CF-CO-ACH-ID-CODE              PIC  X.
  2813             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2814             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2815             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2816         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2817         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2818         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2819         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2820         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2821         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2822         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2823         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2824         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2825                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2826         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2827                 CF-CO-ACH-TRACE-NO         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  51
* EL6317.cbl
  2828
  2829         16  CF-CO-OVER-SHORT.
  2830             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2831             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2832
  2833*         16  FILLER                         PIC X(102).
  2834         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2835             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2836             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2837
  2838         16  CF-AH-APPROVAL-DAYS.
  2839             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2840             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2841             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2842             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2843
  2844         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2845
  2846         16  CF-APPROV-LEV-5.
  2847             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2848             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2849             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2850
  2851         16  FILLER                         PIC X(68).
  2852****************************************************************
  2853*             PROCESSOR/USER RECORD                            *
  2854****************************************************************
  2855
  2856     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2857         16  CF-PROCESSOR-NAME              PIC X(30).
  2858         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2859         16  CF-PROCESSOR-TITLE             PIC X(26).
  2860         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2861                 88  MESSAGE-YES                VALUE 'Y'.
  2862                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2863
  2864*****************************************************
  2865****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2866****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2867****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2868****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2869*****************************************************
  2870
  2871         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2872             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2873             20  CF-APPLICATION-FORCE       PIC X.
  2874             20  CF-INDIVIDUAL-APP.
  2875                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2876                     28  CF-BROWSE-APP      PIC X.
  2877                     28  CF-UPDATE-APP      PIC X.
  2878
  2879         16  CF-CURRENT-TERM-ON             PIC X(4).
  2880         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2881             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2882             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2883             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2884             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2885             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  52
* EL6317.cbl
  2886             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2887             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2888         16  CF-PROCESSOR-CARRIER           PIC X.
  2889             88  NO-CARRIER-SECURITY            VALUE ' '.
  2890         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2891             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2892         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2893             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2894         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2895             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2896
  2897         16  CF-PROC-SYS-ACCESS-SW.
  2898             20  CF-PROC-CREDIT-CLAIMS-SW.
  2899                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2900                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2901                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2902                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2903             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2904                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2905                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2906             20  CF-PROC-LIFE-GNRLDGR-SW.
  2907                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2908                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2909                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2910                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2911             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2912                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2913                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2914         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2915             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2916             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2917         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2918
  2919         16  CF-APPROVAL-LEVEL                  PIC X.
  2920             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2921             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2922             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2923             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2924             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2925
  2926         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2927
  2928         16  CF-LANGUAGE-TYPE                   PIC X.
  2929             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2930             88  CF-LANG-IS-FR                      VALUE 'F'.
  2931
  2932         16  CF-CSR-IND                         PIC X.
  2933         16  FILLER                             PIC X(239).
  2934
  2935****************************************************************
  2936*             PROCESSOR/REMINDERS RECORD                       *
  2937****************************************************************
  2938
  2939     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2940         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2941             20  CF-START-REMIND-DT         PIC XX.
  2942             20  CF-END-REMIND-DT           PIC XX.
  2943             20  CF-REMINDER-TEXT           PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  53
* EL6317.cbl
  2944         16  FILLER                         PIC X(296).
  2945
  2946
  2947****************************************************************
  2948*             STATE MASTER RECORD                              *
  2949****************************************************************
  2950
  2951     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2952         16  CF-STATE-ABBREVIATION          PIC XX.
  2953         16  CF-STATE-NAME                  PIC X(25).
  2954         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2955         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2956             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2957             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2958             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2959             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2960                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2961                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2962             20  CF-ST-PREM-REJECT-SW       PIC X.
  2963                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2964                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2965             20  CF-ST-REF-REJECT-SW        PIC X.
  2966                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2967                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2968         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2969         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2970         16  CF-ST-REFUND-RULES.
  2971             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2972             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2973             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2974         16  CF-ST-FST-PMT-EXTENSION.
  2975             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2976             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2977                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2978                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2979                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2980                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2981         16  CF-ST-STATE-CALL.
  2982             20  CF-ST-CALL-UNEARNED        PIC X.
  2983             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2984             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2985         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2986             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2987             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2988         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2989         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2990         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2991         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2992         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2993         16  FILLER                         PIC X.
  2994         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2995             20  CF-ST-BENEFIT-CD           PIC XX.
  2996             20  CF-ST-BENEFIT-KIND         PIC X.
  2997                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2998                 88  CF-ST-AH-KIND              VALUE 'A'.
  2999             20  CF-ST-REM-TERM-CALC        PIC X.
  3000                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3001                 88  ST-EARN-AFTER-15TH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  54
* EL6317.cbl
  3002                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3003                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3004                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3005                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3006                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3007                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3008
  3009             20  CF-ST-REFUND-CALC          PIC X.
  3010                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3011                 88  ST-REFD-BY-R78             VALUE '1'.
  3012                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3013                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3014                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3015                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3016                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3017                 88  ST-REFD-UTAH               VALUE '7'.
  3018                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3019                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3020                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3021
  3022             20  CF-ST-EARNING-CALC         PIC X.
  3023                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3024                 88  ST-EARN-BY-R78             VALUE '1'.
  3025                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3026                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3027                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3028                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3029                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3030                 88  ST-EARN-MEAN               VALUE '8'.
  3031                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3032
  3033             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3034                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3035                 88  ST-OVRD-BY-R78             VALUE '1'.
  3036                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3037                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3038                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3039                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3040                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3041                 88  ST-OVRD-MEAN               VALUE '8'.
  3042                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3043             20  cf-st-extra-periods        pic 9.
  3044*            20  FILLER                     PIC X.
  3045
  3046         16  CF-ST-COMMISSION-CAPS.
  3047             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3048             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3049             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3050             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3051         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3052                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3053
  3054         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3055
  3056         16  CF-ST-STATUTORY-INTEREST.
  3057             20  CF-ST-STAT-DATE-FROM       PIC X.
  3058                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3059                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  55
* EL6317.cbl
  3060             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3061             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3062             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3063             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3064             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3065
  3066         16  CF-ST-OVER-SHORT.
  3067             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3068             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3069
  3070         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3071
  3072         16  CF-ST-RT-CALC                  PIC X.
  3073
  3074         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3075         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3076         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3077         16  CF-ST-RF-LR-CALC               PIC X.
  3078         16  CF-ST-RF-LL-CALC               PIC X.
  3079         16  CF-ST-RF-LN-CALC               PIC X.
  3080         16  CF-ST-RF-AH-CALC               PIC X.
  3081         16  CF-ST-RF-CP-CALC               PIC X.
  3082*        16  FILLER                         PIC X(206).
  3083*CIDMOD         16  FILLER                         PIC X(192).
  3084         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3085             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3086         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3087         16  CF-ST-VFY-2ND-BENE             PIC X.
  3088         16  CF-ST-CAUSAL-STATE             PIC X.
  3089         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3090         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3091         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3092             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3093         16  CF-ST-NET-ONLY-STATE           PIC X.
  3094             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3095         16  FILLER                         PIC X(181).
  3096
  3097****************************************************************
  3098*             BENEFIT MASTER RECORD                            *
  3099****************************************************************
  3100
  3101     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3102         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3103             20  CF-BENEFIT-CODE            PIC XX.
  3104             20  CF-BENEFIT-NUMERIC  REDEFINES
  3105                 CF-BENEFIT-CODE            PIC XX.
  3106             20  CF-BENEFIT-ALPHA           PIC XXX.
  3107             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3108             20  CF-BENEFIT-COMMENT         PIC X(10).
  3109
  3110             20  CF-LF-COVERAGE-TYPE        PIC X.
  3111                 88  CF-REDUCING                VALUE 'R'.
  3112                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3113
  3114             20  CF-SPECIAL-CALC-CD         PIC X.
  3115                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3116                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3117                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  56
* EL6317.cbl
  3118                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3119                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3120                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3121                 88  CF-FARM-PLAN               VALUE 'F'.
  3122                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3123                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3124                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3125                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3126                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3127                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3128                 88  CF-PRUDENTIAL              VALUE 'P'.
  3129                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3130                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3131                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3132                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3133                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3134                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3135
  3136             20  CF-JOINT-INDICATOR         PIC X.
  3137                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3138
  3139*            20  FILLER                     PIC X(12).
  3140             20  cf-maximum-benefits        pic s999 comp-3.
  3141             20  FILLER                     PIC X(09).
  3142             20  CF-BENEFIT-CATEGORY        PIC X.
  3143             20  CF-LOAN-TYPE               PIC X(8).
  3144
  3145             20  CF-CO-REM-TERM-CALC        PIC X.
  3146                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3147                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3148                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3149                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3150                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3151
  3152             20  CF-CO-EARNINGS-CALC        PIC X.
  3153                 88  CO-EARN-BY-R78             VALUE '1'.
  3154                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3155                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3156                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3157                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3158                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3159                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3160                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3161
  3162             20  CF-CO-REFUND-CALC          PIC X.
  3163                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3164                 88  CO-REFD-BY-R78             VALUE '1'.
  3165                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3166                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3167                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3168                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3169                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3170                 88  CO-REFD-MEAN               VALUE '8'.
  3171                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3172                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3173                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3174
  3175             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  57
* EL6317.cbl
  3176                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3177                 88  CO-OVRD-BY-R78             VALUE '1'.
  3178                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3179                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3180                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3181                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3182                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3183                 88  CO-OVRD-MEAN               VALUE '8'.
  3184                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3185
  3186             20  CF-CO-BEN-I-G-CD           PIC X.
  3187                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3188                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3189                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3190
  3191         16  FILLER                         PIC X(304).
  3192
  3193
  3194****************************************************************
  3195*             CARRIER MASTER RECORD                            *
  3196****************************************************************
  3197
  3198     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3199         16  CF-ADDRESS-DATA.
  3200             20  CF-MAIL-TO-NAME            PIC X(30).
  3201             20  CF-IN-CARE-OF              PIC X(30).
  3202             20  CF-ADDRESS-LINE-1          PIC X(30).
  3203             20  CF-ADDRESS-LINE-2          PIC X(30).
  3204             20  CF-CITY-STATE              PIC X(30).
  3205             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3206             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3207
  3208         16  CF-CLAIM-NO-CONTROL.
  3209             20  CF-CLAIM-NO-METHOD         PIC X.
  3210                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3211                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3212                 88  CLAIM-NO-SEQ               VALUE '3'.
  3213                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3214             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3215                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3216                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3217                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3218
  3219         16  CF-CHECK-NO-CONTROL.
  3220             20  CF-CHECK-NO-METHOD         PIC X.
  3221                 88  CHECK-NO-MANUAL            VALUE '1'.
  3222                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3223                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3224                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3225             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3226                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3227
  3228         16  CF-DOMICILE-STATE              PIC XX.
  3229
  3230         16  CF-EXPENSE-CONTROLS.
  3231             20  CF-EXPENSE-METHOD          PIC X.
  3232                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3233                 88  DOLLARS-PER-PMT            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  58
* EL6317.cbl
  3234                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3235                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3236             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3237             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3238
  3239         16  CF-CORRESPONDENCE-CONTROL.
  3240             20  CF-LETTER-RESEND-OPT       PIC X.
  3241                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3242                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3243             20  FILLER                     PIC X(4).
  3244
  3245         16  CF-RESERVE-CONTROLS.
  3246             20  CF-MANUAL-SW               PIC X.
  3247                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3248             20  CF-FUTURE-SW               PIC X.
  3249                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3250             20  CF-PTC-SW                  PIC X.
  3251                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3252             20  CF-IBNR-SW                 PIC X.
  3253                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3254             20  CF-PTC-LF-SW               PIC X.
  3255                 88  CF-LF-PTC-USED             VALUE '1'.
  3256             20  CF-CDT-ACCESS-METHOD       PIC X.
  3257                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3258                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3259                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3260             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3261
  3262         16  CF-CLAIM-CALC-METHOD           PIC X.
  3263             88  360-PLUS-MONTHS                VALUE '1'.
  3264             88  365-PLUS-MONTHS                VALUE '2'.
  3265             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3266             88  360-DAILY                      VALUE '4'.
  3267             88  365-DAILY                      VALUE '5'.
  3268
  3269         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3270         16  FILLER                         PIC X(11).
  3271
  3272         16  CF-LIMIT-AMOUNTS.
  3273             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3274             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3275             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3276             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3277             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3278             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3279             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3280             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3281             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3282             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3283
  3284         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3285         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3286         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3287
  3288         16  CF-ZIP-CODE.
  3289             20  CF-ZIP-PRIME.
  3290                 24  CF-ZIP-1ST             PIC X.
  3291                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  59
* EL6317.cbl
  3292                 24  FILLER                 PIC X(4).
  3293             20  CF-ZIP-PLUS4               PIC X(4).
  3294         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3295             20  CF-CAN-POSTAL-1            PIC XXX.
  3296             20  CF-CAN-POSTAL-2            PIC XXX.
  3297             20  FILLER                     PIC XXX.
  3298
  3299         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3300         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3301         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3302
  3303         16  CF-RATING-SWITCH               PIC X.
  3304             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3305             88  CF-NO-RATING                   VALUE 'N'.
  3306
  3307         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3308
  3309         16  CF-CARRIER-OVER-SHORT.
  3310             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3311             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3312
  3313         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3314         16  CF-SECPAY-SWITCH               PIC X.
  3315             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3316             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3317         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3318         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3319         16  FILLER                         PIC X(444).
  3320*        16  FILLER                         PIC X(452).
  3321
  3322
  3323****************************************************************
  3324*             MORTALITY MASTER RECORD                          *
  3325****************************************************************
  3326
  3327     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3328         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3329                                INDEXED BY CF-MORT-NDX.
  3330             20  CF-MORT-TABLE              PIC X(5).
  3331             20  CF-MORT-TABLE-TYPE         PIC X.
  3332                 88  CF-MORT-JOINT              VALUE 'J'.
  3333                 88  CF-MORT-SINGLE             VALUE 'S'.
  3334                 88  CF-MORT-COMBINED           VALUE 'C'.
  3335                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3336                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3337             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3338             20  CF-MORT-AGE-METHOD         PIC XX.
  3339                 88  CF-AGE-LAST                VALUE 'AL'.
  3340                 88  CF-AGE-NEAR                VALUE 'AN'.
  3341             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3342             20  CF-MORT-ADJUSTMENT-DIRECTION
  3343                                            PIC X.
  3344                 88  CF-MINUS                   VALUE '-'.
  3345                 88  CF-PLUS                    VALUE '+'.
  3346             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3347             20  CF-MORT-JOINT-CODE         PIC X.
  3348                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3349             20  CF-MORT-PC-Q               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  60
* EL6317.cbl
  3350                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3351             20  CF-MORT-TABLE-CODE         PIC X(4).
  3352             20  CF-MORT-COMMENTS           PIC X(15).
  3353             20  FILLER                     PIC X(14).
  3354
  3355         16  FILLER                         PIC X(251).
  3356
  3357
  3358****************************************************************
  3359*             BUSSINESS TYPE MASTER RECORD                     *
  3360****************************************************************
  3361
  3362     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3363* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3364* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3365* AND RECORD 05 IS TYPES 81-99
  3366         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3367             20  CF-BUSINESS-TITLE          PIC  X(19).
  3368             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3369                                            PIC S9V9(4) COMP-3.
  3370             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3371             20  FILLER                     PIC  X.
  3372         16  FILLER                         PIC  X(248).
  3373
  3374
  3375****************************************************************
  3376*             TERMINAL MASTER RECORD                           *
  3377****************************************************************
  3378
  3379     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3380
  3381         16  CF-COMPANY-TERMINALS.
  3382             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3383                                  PIC X(4).
  3384         16  FILLER               PIC X(248).
  3385
  3386
  3387****************************************************************
  3388*             LIFE EDIT MASTER RECORD                          *
  3389****************************************************************
  3390
  3391     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3392         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3393             20  CF-LIFE-CODE-IN            PIC XX.
  3394             20  CF-LIFE-CODE-OUT           PIC XX.
  3395         16  FILLER                         PIC X(248).
  3396
  3397
  3398****************************************************************
  3399*             AH EDIT MASTER RECORD                            *
  3400****************************************************************
  3401
  3402     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3403         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3404             20  CF-AH-CODE-IN              PIC XXX.
  3405             20  CF-AH-CODE-OUT             PIC XX.
  3406         16  FILLER                         PIC X(248).
  3407
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  61
* EL6317.cbl
  3408
  3409****************************************************************
  3410*             CREDIBILITY TABLES                               *
  3411****************************************************************
  3412
  3413     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3414         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3415                             INDEXED BY CF-CRDB-NDX.
  3416             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3417             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3418             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3419         16  FILLER                         PIC  X(332).
  3420
  3421
  3422****************************************************************
  3423*             REPORT CUSTOMIZATION RECORD                      *
  3424****************************************************************
  3425
  3426     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3427         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3428             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3429             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3430             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3431**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3432****       A T-TRANSFER.                                   ****
  3433             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3434
  3435         16  FILLER                         PIC XX.
  3436
  3437         16  CF-CARRIER-CNTL-OPT.
  3438             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3439                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3440                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3441             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3442                                            PIC X.
  3443         16  CF-GROUP-CNTL-OPT.
  3444             20  CF-GROUP-OPT-SEQ           PIC 9.
  3445                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3446                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3447             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3448                                            PIC X(6).
  3449         16  CF-STATE-CNTL-OPT.
  3450             20  CF-STATE-OPT-SEQ           PIC 9.
  3451                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3452                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3453             20  CF-STATE-SELECT OCCURS 3 TIMES
  3454                                            PIC XX.
  3455         16  CF-ACCOUNT-CNTL-OPT.
  3456             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3457                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3458                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3459             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3460                                            PIC X(10).
  3461         16  CF-BUS-TYP-CNTL-OPT.
  3462             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3463                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3464                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3465             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  62
* EL6317.cbl
  3466                                            PIC XX.
  3467         16  CF-LF-TYP-CNTL-OPT.
  3468             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3469                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3470                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3471             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3472                                            PIC XX.
  3473         16  CF-AH-TYP-CNTL-OPT.
  3474             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3475                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3476                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3477             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3478                                            PIC XX.
  3479         16  CF-REPTCD1-CNTL-OPT.
  3480             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3481                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3482                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3483             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3484                                            PIC X(10).
  3485         16  CF-REPTCD2-CNTL-OPT.
  3486             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3487                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3488                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3489             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3490                                            PIC X(10).
  3491         16  CF-USER1-CNTL-OPT.
  3492             20  CF-USER1-OPT-SEQ           PIC 9.
  3493                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3494                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3495             20  CF-USER1-SELECT OCCURS 3 TIMES
  3496                                            PIC X(10).
  3497         16  CF-USER2-CNTL-OPT.
  3498             20  CF-USER2-OPT-SEQ           PIC 9.
  3499                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3500                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3501             20  CF-USER2-SELECT OCCURS 3 TIMES
  3502                                            PIC X(10).
  3503         16  CF-USER3-CNTL-OPT.
  3504             20  CF-USER3-OPT-SEQ           PIC 9.
  3505                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3506                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3507             20  CF-USER3-SELECT OCCURS 3 TIMES
  3508                                            PIC X(10).
  3509         16  CF-USER4-CNTL-OPT.
  3510             20  CF-USER4-OPT-SEQ           PIC 9.
  3511                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3512                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3513             20  CF-USER4-SELECT OCCURS 3 TIMES
  3514                                            PIC X(10).
  3515         16  CF-USER5-CNTL-OPT.
  3516             20  CF-USER5-OPT-SEQ           PIC 9.
  3517                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3518                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3519             20  CF-USER5-SELECT OCCURS 3 TIMES
  3520                                            PIC X(10).
  3521         16  CF-REINS-CNTL-OPT.
  3522             20  CF-REINS-OPT-SEQ           PIC 9.
  3523                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  63
* EL6317.cbl
  3524                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3525             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3526                 24  CF-REINS-PRIME         PIC XXX.
  3527                 24  CF-REINS-SUB           PIC XXX.
  3528
  3529         16  CF-AGENT-CNTL-OPT.
  3530             20  CF-AGENT-OPT-SEQ           PIC 9.
  3531                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3532                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3533             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3534                                            PIC X(10).
  3535
  3536         16  FILLER                         PIC X(43).
  3537
  3538         16  CF-LOSS-RATIO-SELECT.
  3539             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3540             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3541         16  CF-ENTRY-DATE-SELECT.
  3542             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3543             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3544         16  CF-EFFECTIVE-DATE-SELECT.
  3545             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3546             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3547
  3548         16  CF-EXCEPTION-LIST-IND          PIC X.
  3549             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3550
  3551         16  FILLER                         PIC X(318).
  3552
  3553****************************************************************
  3554*                  EXCEPTION REPORTING RECORD                  *
  3555****************************************************************
  3556
  3557     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3558         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3559             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3560
  3561         16  CF-COMBINED-LIFE-AH-OPT.
  3562             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3563             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3564             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3565             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3566
  3567         16  CF-LIFE-OPT.
  3568             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3569             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3570             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3571             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3572             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3573             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3574             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3575             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3576             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3577             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3578
  3579         16  CF-AH-OPT.
  3580             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3581             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  64
* EL6317.cbl
  3582             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3583             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3584             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3585             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3586             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3587             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3588             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3589             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3590
  3591         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3592             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3593             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3594             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3595
  3596         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3597
  3598         16  FILLER                         PIC X(673).
  3599
  3600
  3601****************************************************************
  3602*             MORTGAGE SYSTEM PLAN RECORD                      *
  3603****************************************************************
  3604
  3605     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3606         16  CF-PLAN-TYPE                   PIC X.
  3607             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3608             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3609             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3610         16  CF-PLAN-ABBREV                 PIC XXX.
  3611         16  CF-PLAN-DESCRIPT               PIC X(10).
  3612         16  CF-PLAN-NOTES                  PIC X(20).
  3613         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3614         16  CF-PLAN-UNDERWRITING.
  3615             20  CF-PLAN-TERM-DATA.
  3616                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3617                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3618             20  CF-PLAN-AGE-DATA.
  3619                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3620                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3621                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3622             20  CF-PLAN-BENEFIT-DATA.
  3623                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3624                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3625                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3626                                            PIC S9(7)V99  COMP-3.
  3627         16  CF-PLAN-POLICY-FORMS.
  3628             20  CF-POLICY-FORM             PIC X(12).
  3629             20  CF-MASTER-APPLICATION      PIC X(12).
  3630             20  CF-MASTER-POLICY           PIC X(12).
  3631         16  CF-PLAN-RATING.
  3632             20  CF-RATE-CODE               PIC X(5).
  3633             20  CF-SEX-RATING              PIC X.
  3634                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3635                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3636             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3637             20  CF-SUB-STD-TYPE            PIC X.
  3638                 88  CF-PCT-OF-PREM            VALUE '1'.
  3639                 88  CF-PCT-OF-BENE            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  65
* EL6317.cbl
  3640         16  CF-PLAN-PREM-TOLERANCES.
  3641             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3642             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3643         16  CF-PLAN-PYMT-TOLERANCES.
  3644             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3645             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3646         16  CF-PLAN-MISC-DATA.
  3647             20  FILLER                     PIC X.
  3648             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3649             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3650         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3651         16  CF-PLAN-IND-GRP                PIC X.
  3652             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3653                                                     '1'.
  3654             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3655                                                     '2'.
  3656         16  CF-MIB-SEARCH-SW               PIC X.
  3657             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3658             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3659             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3660             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3661         16  CF-ALPHA-SEARCH-SW             PIC X.
  3662             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3663             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3664             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3665             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3666             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3667             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3668             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3669             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3670             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3671             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3672                                                     'A' 'B' 'C'
  3673                                                     'X' 'Y' 'Z'.
  3674         16  CF-EFF-DT-RULE-SW              PIC X.
  3675             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3676             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3677             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3678             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3679             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3680         16  FILLER                         PIC X(4).
  3681         16  CF-HEALTH-QUESTIONS            PIC X.
  3682             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3683         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3684         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3685         16  CF-PLAN-SNGL-JNT               PIC X.
  3686             88  CF-COMBINED-PLAN              VALUE 'C'.
  3687             88  CF-JNT-PLAN                   VALUE 'J'.
  3688             88  CF-SNGL-PLAN                  VALUE 'S'.
  3689         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3690         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3691         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3692         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3693         16  CF-RERATE-CNTL                 PIC  X.
  3694             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3695             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3696             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3697             88  CF-AUTO-RECALC                 VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  66
* EL6317.cbl
  3698         16  CF-BENEFIT-TYPE                PIC  X.
  3699             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3700             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3701         16  CF-POLICY-FEE                  PIC S999V99
  3702                                                    COMP-3.
  3703         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3704         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3705         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3706         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3707         16  FILLER                         PIC  X(32).
  3708         16  CF-TERMINATION-FORM            PIC  X(04).
  3709         16  FILLER                         PIC  X(08).
  3710         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3711                                                       COMP-3.
  3712         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3713         16  CF-ISSUE-LETTER                PIC  X(4).
  3714         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3715         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3716             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3717             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3718         16  CF-MP-REFUND-CALC              PIC X.
  3719             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3720             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3721             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3722             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3723             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3724             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3725             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3726             88  CF-MP-REFD-MEAN                VALUE '8'.
  3727         16  CF-ALT-RATE-CODE               PIC  X(5).
  3728
  3729
  3730         16  FILLER                         PIC X(498).
  3731****************************************************************
  3732*             MORTGAGE COMPANY MASTER RECORD                   *
  3733****************************************************************
  3734
  3735     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3736         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3737         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3738             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3739             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3740             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3741             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3742             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3743
  3744         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3745         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3746         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3747         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3748         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3749
  3750         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3751             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3752         16  CF-MP-RECON-USE-IND            PIC X(1).
  3753             88  CF-MP-USE-RECON             VALUE 'Y'.
  3754         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3755             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  67
* EL6317.cbl
  3756         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3757             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3758             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3759         16  FILLER                         PIC X(1).
  3760         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3761             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3762         16  CF-MORTG-MIB-VERSION           PIC X.
  3763             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3764             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3765             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3766         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3767             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3768                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3769             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3770                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3771             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3772                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3773             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3774                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3775             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3776                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3777             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3778                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3779         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3780         16  FILLER                         PIC X(7).
  3781         16  CF-MORTG-DESTINATION-SYMBOL.
  3782             20  CF-MORTG-MIB-COMM          PIC X(5).
  3783             20  CF-MORTG-MIB-TERM          PIC X(5).
  3784         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3785             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3786         16  FILLER                         PIC X(03).
  3787         16  CF-MP-CHECK-NO-CONTROL.
  3788             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3789                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3790                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3791                                                ' ' LOW-VALUES.
  3792                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3793                                               VALUE '3'.
  3794         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3795         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3796         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3797             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3798                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3799             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3800                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3801             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3802                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3803             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3804                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3805             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3806                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3807             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3808                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3809         16  CF-MORTG-BILLING-AREA.
  3810             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3811                                            PIC X.
  3812         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3813         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  68
* EL6317.cbl
  3814         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3815         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3816             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3817             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3818         16  FILLER                         PIC X.
  3819         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3820             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3821             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3822         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3823         16  FILLER                         PIC X(8).
  3824         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3825         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3826         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3827         16  CF-ACH-COMPANY-ID.
  3828             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3829                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3830                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3831                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3832             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3833         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3834             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3835         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3836             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3837             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3838         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3839         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3840         16  FILLER                         PIC X(536).
  3841
  3842****************************************************************
  3843*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3844****************************************************************
  3845
  3846     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3847         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3848             20  CF-FEMALE-HEIGHT.
  3849                 24  CF-FEMALE-FT           PIC 99.
  3850                 24  CF-FEMALE-IN           PIC 99.
  3851             20  CF-FEMALE-MIN-WT           PIC 999.
  3852             20  CF-FEMALE-MAX-WT           PIC 999.
  3853         16  FILLER                         PIC X(428).
  3854
  3855     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3856         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3857             20  CF-MALE-HEIGHT.
  3858                 24  CF-MALE-FT             PIC 99.
  3859                 24  CF-MALE-IN             PIC 99.
  3860             20  CF-MALE-MIN-WT             PIC 999.
  3861             20  CF-MALE-MAX-WT             PIC 999.
  3862         16  FILLER                         PIC X(428).
  3863******************************************************************
  3864*             AUTOMATIC ACTIVITY RECORD                          *
  3865******************************************************************
  3866     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3867         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3868             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3869             20  CF-SYS-LETTER-ID           PIC X(04).
  3870             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3871             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  69
* EL6317.cbl
  3872             20  CF-SYS-RESET-SW            PIC X(01).
  3873             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3874             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3875
  3876         16  FILLER                         PIC X(50).
  3877
  3878         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3879             20  CF-USER-ACTIVE-SW          PIC X(01).
  3880             20  CF-USER-LETTER-ID          PIC X(04).
  3881             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3882             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3883             20  CF-USER-RESET-SW           PIC X(01).
  3884             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3885             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3886             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3887
  3888         16  FILLER                         PIC X(246).
  3889*                                COPY ERCPNDB.
  3890******************************************************************
  3891*                                                                *
  3892*                                                                *
  3893*                            ERCPNDB.                            *
  3894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3895*                            VMOD=2.025                          *
  3896*                                                                *
  3897*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3898*                                                                *
  3899******************************************************************
  3900*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3901*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3902******************************************************************
  3903*                                                                *
  3904*                                                                *
  3905*   FILE TYPE = VSAM,KSDS                                        *
  3906*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3907*                                                                *
  3908*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3909*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3910*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3911*                                                 RKP=13,LEN=36  *
  3912*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3913*                                      AND CHG-SEQ.)             *
  3914*                                                RKP=49,LEN=11   *
  3915*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3916*                                      AND CHG-SEQ.)             *
  3917*                                                RKP=60,LEN=15   *
  3918*                                                                *
  3919*   LOG = NO                                                     *
  3920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3921******************************************************************
  3922******************************************************************
  3923*                   C H A N G E   L O G
  3924*
  3925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3926*-----------------------------------------------------------------
  3927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3928* EFFECTIVE    NUMBER
  3929*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  70
* EL6317.cbl
  3930* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3931* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3932* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3933* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3934* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3935* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3936* 032306                   PEMA  ADD BOW LOAN NUMBER
  3937* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3938* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3939* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3940* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3941* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3942* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3943* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3944* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3945* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3946* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3947* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  3948******************************************************************
  3949
  3950 01  PENDING-BUSINESS.
  3951     12  PB-RECORD-ID                     PIC XX.
  3952         88  VALID-PB-ID                        VALUE 'PB'.
  3953
  3954     12  PB-CONTROL-PRIMARY.
  3955         16  PB-COMPANY-CD                PIC X.
  3956         16  PB-ENTRY-BATCH               PIC X(6).
  3957         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3958         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3959
  3960     12  PB-CONTROL-BY-ACCOUNT.
  3961         16  PB-COMPANY-CD-A1             PIC X.
  3962         16  PB-CARRIER                   PIC X.
  3963         16  PB-GROUPING.
  3964             20  PB-GROUPING-PREFIX       PIC XXX.
  3965             20  PB-GROUPING-PRIME        PIC XXX.
  3966         16  PB-STATE                     PIC XX.
  3967         16  PB-ACCOUNT.
  3968             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3969             20  PB-ACCOUNT-PRIME         PIC X(6).
  3970         16  PB-CERT-EFF-DT               PIC XX.
  3971         16  PB-CERT-NO.
  3972             20  PB-CERT-PRIME            PIC X(10).
  3973             20  PB-CERT-SFX              PIC X.
  3974         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3975
  3976         16  PB-RECORD-TYPE               PIC X.
  3977             88  PB-MAILING-DATA                VALUE '0'.
  3978             88  PB-ISSUE                       VALUE '1'.
  3979             88  PB-CANCELLATION                VALUE '2'.
  3980             88  PB-BATCH-TRAILER               VALUE '9'.
  3981
  3982     12  PB-CONTROL-BY-ORIG-BATCH.
  3983         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3984         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3985         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3986         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3987
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  71
* EL6317.cbl
  3988     12  PB-CONTROL-BY-CSR.
  3989         16  PB-CSR-COMPANY-CD            PIC X.
  3990         16  PB-CSR-ID                    PIC X(4).
  3991         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3992         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3993         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3994******************************************************************
  3995*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3996******************************************************************
  3997
  3998     12  PB-LAST-MAINT-DT                 PIC XX.
  3999     12  PB-LAST-MAINT-BY                 PIC X(4).
  4000     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4001
  4002     12  PB-RECORD-BODY                   PIC X(375).
  4003
  4004     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4005         16  PB-CERT-ORIGIN               PIC X.
  4006             88  CLASIC-CREATED-CERT         VALUE '1'.
  4007         16  PB-I-NAME.
  4008             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4009             20  PB-I-INSURED-FIRST-NAME.
  4010                 24  PB-I-INSURED-1ST-INIT PIC X.
  4011                 24  FILLER                PIC X(9).
  4012             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4013         16  PB-I-AGE                     PIC S99   COMP-3.
  4014         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4015         16  PB-I-BIRTHDAY                PIC XX.
  4016         16  PB-I-INSURED-SEX             PIC X.
  4017             88  PB-SEX-MALE     VALUE 'M'.
  4018             88  PB-SEX-FEMALE   VALUE 'F'.
  4019
  4020         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4021         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4022         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4023         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4024         16  PB-I-SKIP-CODE               PIC X.
  4025             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4026             88  PB-SKIP-JULY              VALUE '1'.
  4027             88  PB-SKIP-AUGUST            VALUE '2'.
  4028             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4029             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4030             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4031             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4032             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4033             88  PB-SKIP-JUNE              VALUE '8'.
  4034             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4035             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4036             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4037         16  PB-I-TERM-TYPE               PIC X.
  4038             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4039             88  PB-PAID-WEEKLY            VALUE 'W'.
  4040             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4041             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4042             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4043         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4044         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4045         16  PB-I-DATA-ENTRY-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  72
* EL6317.cbl
  4046             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4047             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4048             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4049             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4050         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4051         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4052*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4053         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4054         16  FILLER                       PIC X.
  4055
  4056         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4057             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4058             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4059                                                   '90' THRU '99'.
  4060         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4061                                          PIC XX.
  4062         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4063         16  PB-I-AMOUNT-FINANCED REDEFINES
  4064                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4065         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4066         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4067                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4068         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4069         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4070         16  PB-I-CLP-AMOUNT REDEFINES
  4071                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4072         16  PB-I-LF-CALC-FLAG            PIC X.
  4073             88 PB-COMP-LF-PREM               VALUE '?'.
  4074         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4075         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4076         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4077         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4078         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4079         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4080         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4081         16  PB-I-LF-ABBR                 PIC XXX.
  4082         16  PB-I-LF-INPUT-CD             PIC XX.
  4083
  4084         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4085             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4086             88  PB-INVALID-AH               VALUE '  ' '00'
  4087                                                   '90' THRU '99'.
  4088         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4089         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4090         16  PB-I-AH-CALC-FLAG            PIC X.
  4091             88 PB-COMP-AH-PREM                  VALUE '?'.
  4092         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4093         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4094         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4095         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4096         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4097         16  PB-I-AH-ABBR                 PIC XXX.
  4098         16  PB-I-AH-INPUT-CD             PIC XXX.
  4099
  4100         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4101         16  PB-I-REIN-TABLE              PIC XXX.
  4102         16  PB-I-BUSINESS-TYPE           PIC 99.
  4103         16  PB-I-INDV-GRP-CD             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  73
* EL6317.cbl
  4104         16  PB-I-MORT-CODE.
  4105             20  PB-I-TABLE               PIC X.
  4106             20  PB-I-INTEREST            PIC XX.
  4107             20  PB-I-MORT-TYP            PIC X.
  4108         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4109         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4110         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4111         16  PB-I-INDV-GRP-OVRD           PIC X.
  4112         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4113         16  PB-I-SIG-SW                  PIC X.
  4114             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4115         16  PB-I-RATE-CLASS              PIC XX.
  4116         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4117         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4118         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4119         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4120         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4121         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4122         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4123         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4124         16  PB-I-OB-FLAG                 PIC X.
  4125             88  PB-I-OB                      VALUE 'B'.
  4126             88  PB-I-SUMMARY                 VALUE 'Z'.
  4127         16  PB-I-ENTRY-STATUS            PIC X.
  4128             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4129                                              'M' '5' '9' '2'.
  4130             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4131             88  PB-I-POLICY-PENDING          VALUE '2'.
  4132             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4133             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4134             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4135             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4136             88  PB-I-REIN-ONLY               VALUE '9'.
  4137             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4138             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4139             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4140             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4141         16  PB-I-INT-CODE                PIC X.
  4142             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4143             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4144         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4145         16  PB-I-SOC-SEC-NO              PIC X(11).
  4146         16  PB-I-MEMBER-NO               PIC X(12).
  4147         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4148*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4149         16  PB-I-OLD-LOF                 PIC XXX.
  4150         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4151         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4152         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4153         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4154         16  PB-I-LIFE-INDICATOR          PIC X.
  4155             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4156         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4157         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4158                                          PIC S9(5)V99    COMP-3.
  4159         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4160             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4161             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  74
* EL6317.cbl
  4162         16  PB-I-1ST-PMT-DT              PIC XX.
  4163         16  PB-I-JOINT-INSURED.
  4164             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4165             20 PB-I-JOINT-FIRST-NAME.
  4166                24  PB-I-JOINT-FIRST-INIT PIC X.
  4167                24  FILLER                PIC X(9).
  4168             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4169*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4170         16  PB-I-BENEFICIARY-NAME.
  4171             20  PB-I-BANK-NUMBER         PIC X(10).
  4172             20  FILLER                   PIC X(15).
  4173         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4174         16  PB-I-REFERENCE               PIC X(12).
  4175         16  FILLER REDEFINES PB-I-REFERENCE.
  4176             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4177             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4178             20  PB-I-CLP-STATE           PIC XX.
  4179         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4180             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4181             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4182             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4183         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4184         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4185         16  PB-I-RESIDENT-STATE          PIC XX.
  4186         16  PB-I-RATE-CODE               PIC X(4).
  4187         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4188         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4189         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4190         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4191         16  PB-I-BANK-NOCHRGB            PIC 99.
  4192         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4193         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4194
  4195     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4196         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4197             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4198         16  PB-C-CANCEL-ORIGIN           PIC X.
  4199             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4200         16  PB-C-LF-CANCEL-DT            PIC XX.
  4201         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4202         16  PB-C-LF-CALC-REQ             PIC X.
  4203             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4204         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4205         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4206         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4207             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4208         16  PB-C-AH-CANCEL-DT            PIC XX.
  4209         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4210         16  PB-C-AH-CALC-REQ             PIC X.
  4211             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4212         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4213         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4214         16  PB-C-LAST-NAME               PIC X(15).
  4215         16  PB-C-REFUND-SW               PIC X.
  4216             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4217             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4218         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4219         16  PB-C-PAYEE-CODE              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  75
* EL6317.cbl
  4220         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4221         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4222         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4223         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4224         16  PB-C-REFERENCE               PIC X(12).
  4225         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4226         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4227         16  PB-C-POST-CARD-IND           PIC X.
  4228         16  PB-C-CANCEL-REASON           PIC X.
  4229         16  PB-C-REF-INTERFACE-SW        PIC X.
  4230         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4231         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4232         16  FILLER                       PIC X(01).
  4233*        16  FILLER                       PIC X(18).
  4234         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4235*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4236         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4237         16  PB-CANCELED-CERT-DATA.
  4238             20  PB-CI-INSURED-NAME.
  4239                 24  PB-CI-LAST-NAME      PIC X(15).
  4240                 24  PB-CI-INITIALS       PIC XX.
  4241             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4242             20  PB-CI-INSURED-SEX        PIC X.
  4243             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4244             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4245             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4246             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4247             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4248             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4249             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4250             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4251             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4252             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4253             20  PB-CI-RATE-CLASS         PIC XX.
  4254             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4255             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4256             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4257             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4258             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4259             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4260             20  PB-CI-LF-ABBR            PIC X(3).
  4261             20  PB-CI-AH-ABBR            PIC X(3).
  4262             20  PB-CI-OB-FLAG            PIC X.
  4263                 88  PB-CI-OB                VALUE 'B'.
  4264             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4265                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4266                                           'M' '4' '5' '9' '2'.
  4267                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4268                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4269                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4270                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4271                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4272                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4273                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4274                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4275                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4276                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4277                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  76
* EL6317.cbl
  4278                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4279                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4280             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4281                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4282                                           'M' '4' '5' '9' '2'.
  4283                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4284                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4285                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4286                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4287                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4288                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4289                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4290                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4291                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4292                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4293                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4294                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4295                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4296             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4297             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4298             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4299             20  PB-CI-MEMBER-NO          PIC X(12).
  4300             20  PB-CI-INT-CODE           PIC X.
  4301                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4302                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4303             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4304             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4305             20  PB-CI-COMP-EXCP-SW       PIC X.
  4306                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4307                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4308             20  PB-CI-ENTRY-STATUS       PIC X.
  4309             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4310             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4311             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4312             20  PB-CI-DEATH-DT           PIC XX.
  4313             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4314             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4315             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4316             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4317             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4318             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4319             20  PB-CI-ENTRY-DT              PIC XX.
  4320             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4321             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4322             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4323             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4324             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4325             20  PB-CI-OLD-LOF               PIC XXX.
  4326*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4327             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4328             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4329             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4330             20  PB-CI-INDV-GRP-CD           PIC X.
  4331             20  PB-CI-BENEFICIARY-NAME.
  4332                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4333                 24  FILLER                  PIC X(15).
  4334             20  PB-CI-NOTE-SW               PIC X.
  4335             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  77
* EL6317.cbl
  4336             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4337             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4338             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4339             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4340             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4341             20  PB-CI-FIRST-NAME            PIC X(10).
  4342             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4343
  4344         16  FILLER                       PIC X(13).
  4345*032306  16  FILLER                       PIC X(27).
  4346*        16  FILLER                       PIC X(46).
  4347
  4348     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4349         16  FILLER                       PIC X(10).
  4350         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4351         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4352         16  PB-M-INSURED-MID-INIT        PIC X.
  4353         16  PB-M-INSURED-AGE             PIC 99.
  4354         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4355         16  PB-M-INSURED-SEX             PIC X.
  4356         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4357         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4358         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4359         16  PB-M-INSURED-CITY-STATE.
  4360             20  PB-M-INSURED-CITY        PIC X(28).
  4361             20  PB-M-INSURED-STATE       PIC XX.
  4362         16  PB-M-INSURED-ZIP-CODE.
  4363             20  PB-M-INSURED-ZIP-PRIME.
  4364                 24  PB-M-INSURED-ZIP-1   PIC X.
  4365                     88  PB-M-CANADIAN-POST-CODE
  4366                                             VALUE 'A' THRU 'Z'.
  4367                 24  FILLER               PIC X(4).
  4368             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4369         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4370                                        PB-M-INSURED-ZIP-CODE.
  4371             20  PM-M-INS-CAN-POST1       PIC XXX.
  4372             20  PM-M-INS-CAN-POST2       PIC XXX.
  4373             20  FILLER                   PIC XXX.
  4374         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4375         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4376         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4377         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4378         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4379         16  PB-M-CRED-BENE-CITYST.
  4380             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4381             20  PB-M-CRED-BENE-STATE     PIC XX.
  4382         16  FILLER                       PIC X(92).
  4383
  4384     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4385         16  FILLER                       PIC X(10).
  4386         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4387         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4388         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4389         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4390         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4391         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4392         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4393         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  78
* EL6317.cbl
  4394         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4395         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4396         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4397         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4398         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4399         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4400         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4401         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4402         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4403         16  PB-ACCOUNT-NAME              PIC X(30).
  4404         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4405         16  PB-REFERENCE                 PIC X(12).
  4406         16  PB-B-RECEIVED-DT             PIC XX.
  4407         16  FILLER                       PIC X(234).
  4408
  4409     12  PB-RECORD-STATUS.
  4410         16  PB-CREDIT-SELECT-DT          PIC XX.
  4411         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4412         16  PB-BILLED-DT                 PIC XX.
  4413         16  PB-BILLING-STATUS            PIC X.
  4414             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4415             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4416             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4417         16  PB-RECORD-BILL               PIC X.
  4418             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4419             88  PB-RECORD-RETURNED           VALUE 'R'.
  4420             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4421             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4422             88  PB-OVERRIDE-AH               VALUE 'A'.
  4423             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4424         16  PB-BATCH-ENTRY               PIC X.
  4425             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4426             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4427             88  PB-REISSUED-CERT             VALUE 'E'.
  4428             88  PB-CASH-CERT                 VALUE 'C'.
  4429             88  PB-MONTHLY-CERT              VALUE 'M'.
  4430             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4431             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4432             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4433         16  PB-FORCE-CODE                PIC X.
  4434             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4435             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4436             88  PB-CANCEL-FORCE              VALUE '8'.
  4437             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4438             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4439             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4440             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4441             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4442             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4443             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4444             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4445         16  PB-FATAL-FLAG                PIC X.
  4446             88  PB-FATAL-ERRORS              VALUE 'X'.
  4447         16  PB-FORCE-ER-CD               PIC X.
  4448             88  PB-FORCE-ERRORS              VALUE 'F'.
  4449             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4450         16  PB-WARN-ER-CD                PIC X.
  4451             88  PB-WARNING-ERRORS            VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  79
* EL6317.cbl
  4452         16  FILLER                       PIC X.
  4453         16  PB-OUT-BAL-CD                PIC X.
  4454             88  PB-OUT-OF-BAL                VALUE 'O'.
  4455         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4456         16  PB-AH-OVERRIDE-L1            PIC X.
  4457         16  PB-INPUT-DT                  PIC XX.
  4458         16  PB-INPUT-BY                  PIC X(4).
  4459         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4460         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4461         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4462         16  PB-LF-EARNING-METHOD         PIC X.
  4463         16  PB-AH-EARNING-METHOD         PIC X.
  4464         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4465         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4466         16  PB-REIN-CD                   PIC XXX.
  4467         16  PB-LF-REFUND-TYPE            PIC X.
  4468         16  PB-AH-REFUND-TYPE            PIC X.
  4469         16  PB-ACCT-EFF-DT               PIC XX.
  4470         16  PB-ACCT-EXP-DT               PIC XX.
  4471         16  PB-COMPANY-ID                PIC X(3).
  4472         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4473         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4474         16  PB-SV-CARRIER                PIC X.
  4475         16  PB-SV-GROUPING               PIC X(6).
  4476         16  PB-SV-STATE                  PIC XX.
  4477         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4478         16  PB-GA-BILLING-INFO.
  4479             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4480                                          PIC XX.
  4481         16  PB-SV-REMIT-TO  REDEFINES
  4482             PB-GA-BILLING-INFO           PIC X(10).
  4483         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4484         16  PB-I-LOAN-OFFICER            PIC X(5).
  4485         16  PB-I-VIN                     PIC X(17).
  4486
  4487         16  FILLER                       PIC X(04).
  4488         16  IMNET-BYPASS-SW              PIC X.
  4489
  4490******************************************************************
  4491*                COMMON EDIT ERRORS                              *
  4492******************************************************************
  4493
  4494     12  PB-COMMON-ERRORS.
  4495         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4496                                           PIC S9(4)     COMP.
  4497
  4498******************************************************************
  4499*                                COPY ELCCERT.
  4500******************************************************************
  4501*                                                                *
  4502*                            ELCCERT.                            *
  4503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4504*                            VMOD=2.013                          *
  4505*                                                                *
  4506*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4507*                                                                *
  4508*   FILE TYPE = VSAM,KSDS                                        *
  4509*   RECORD SIZE = 450  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  80
* EL6317.cbl
  4510*                                                                *
  4511*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4512*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4513*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4514*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4515*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4516*                                                                *
  4517*   LOG = YES                                                    *
  4518*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4519******************************************************************
  4520*                   C H A N G E   L O G
  4521*
  4522* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4523*-----------------------------------------------------------------
  4524*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4525* EFFECTIVE    NUMBER
  4526*-----------------------------------------------------------------
  4527* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4528* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4529* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4530* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4531* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4532* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4533* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4534* 032612  CR2011110200001  PEMA  AHL CHANGES
  4535* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4536* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4537******************************************************************
  4538
  4539 01  CERTIFICATE-MASTER.
  4540     12  CM-RECORD-ID                      PIC XX.
  4541         88  VALID-CM-ID                      VALUE 'CM'.
  4542
  4543     12  CM-CONTROL-PRIMARY.
  4544         16  CM-COMPANY-CD                 PIC X.
  4545         16  CM-CARRIER                    PIC X.
  4546         16  CM-GROUPING.
  4547             20  CM-GROUPING-PREFIX        PIC X(3).
  4548             20  CM-GROUPING-PRIME         PIC X(3).
  4549         16  CM-STATE                      PIC XX.
  4550         16  CM-ACCOUNT.
  4551             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4552             20  CM-ACCOUNT-PRIME          PIC X(6).
  4553         16  CM-CERT-EFF-DT                PIC XX.
  4554         16  CM-CERT-NO.
  4555             20  CM-CERT-PRIME             PIC X(10).
  4556             20  CM-CERT-SFX               PIC X.
  4557
  4558     12  CM-CONTROL-BY-NAME.
  4559         16  CM-COMPANY-CD-A1              PIC X.
  4560         16  CM-INSURED-LAST-NAME          PIC X(15).
  4561         16  CM-INSURED-INITIALS.
  4562             20  CM-INSURED-INITIAL1       PIC X.
  4563             20  CM-INSURED-INITIAL2       PIC X.
  4564
  4565     12  CM-CONTROL-BY-SSN.
  4566         16  CM-COMPANY-CD-A2              PIC X.
  4567         16  CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  81
* EL6317.cbl
  4568             20  CM-SSN-STATE              PIC XX.
  4569             20  CM-SSN-ACCOUNT            PIC X(6).
  4570             20  CM-SSN-LN3.
  4571                 25  CM-INSURED-INITIALS-A2.
  4572                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4573                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4574                 25 CM-PART-LAST-NAME-A2         PIC X.
  4575
  4576     12  CM-CONTROL-BY-CERT-NO.
  4577         16  CM-COMPANY-CD-A4              PIC X.
  4578         16  CM-CERT-NO-A4                 PIC X(11).
  4579
  4580     12  CM-CONTROL-BY-MEMB.
  4581         16  CM-COMPANY-CD-A5              PIC X.
  4582         16  CM-MEMBER-NO.
  4583             20  CM-MEMB-STATE             PIC XX.
  4584             20  CM-MEMB-ACCOUNT           PIC X(6).
  4585             20  CM-MEMB-LN4.
  4586                 25  CM-INSURED-INITIALS-A5.
  4587                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4588                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4589                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4590
  4591     12  CM-INSURED-PROFILE-DATA.
  4592         16  CM-INSURED-FIRST-NAME.
  4593             20  CM-INSURED-1ST-INIT       PIC X.
  4594             20  FILLER                    PIC X(9).
  4595         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4596         16  CM-INSURED-SEX                PIC X.
  4597             88  CM-SEX-MALE                  VALUE 'M'.
  4598             88  CM-SEX-FEMAL                 VALUE 'F'.
  4599         16  CM-INSURED-JOINT-AGE          PIC 99.
  4600         16  CM-JOINT-INSURED-NAME.
  4601             20  CM-JT-LAST-NAME           PIC X(15).
  4602             20  CM-JT-FIRST-NAME.
  4603                 24  CM-JT-1ST-INIT        PIC X.
  4604                 24  FILLER                PIC X(9).
  4605             20  CM-JT-INITIAL             PIC X.
  4606
  4607     12  CM-LIFE-DATA.
  4608         16  CM-LF-BENEFIT-CD              PIC XX.
  4609         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4610         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4611         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4612         16  CM-LF-DEV-CODE                PIC XXX.
  4613         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4614         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4615         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4616         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4617         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4618         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4619         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4620         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4621         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4622         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4623         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4624         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4625         16  cm-temp-epiq                  pic xx.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  82
* EL6317.cbl
  4626             88  EPIQ-CLASS                  value 'EQ'.
  4627*        16  FILLER                        PIC XX.
  4628
  4629     12  CM-AH-DATA.
  4630         16  CM-AH-BENEFIT-CD              PIC XX.
  4631         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4632         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4633         16  CM-AH-DEV-CODE                PIC XXX.
  4634         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4635         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4636         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4637         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4638         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4639         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4640         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4641         16  CM-AH-PAID-THRU-DT            PIC XX.
  4642             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4643         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4644         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4645         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4646         16  FILLER                        PIC X.
  4647
  4648     12  CM-LOAN-INFORMATION.
  4649         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4650         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4651                                           PIC S9(5)V99  COMP-3.
  4652         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4653         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4654         16  CM-PAY-FREQUENCY              PIC S99.
  4655         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4656         16  CM-RATE-CLASS                 PIC XX.
  4657         16  CM-BENEFICIARY                PIC X(25).
  4658         16  CM-POLICY-FORM-NO             PIC X(12).
  4659         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4660         16  CM-LAST-ADD-ON-DT             PIC XX.
  4661         16  CM-DEDUCTIBLE-AMOUNTS.
  4662             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4663             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4664         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4665             20  CM-RESIDENT-STATE         PIC XX.
  4666             20  CM-RATE-CODE              PIC X(4).
  4667             20  FILLER                    PIC XX.
  4668         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4669             20  CM-LOAN-OFFICER           PIC X(5).
  4670             20  FILLER                    PIC XXX.
  4671         16  CM-CSR-CODE                   PIC XXX.
  4672         16  CM-UNDERWRITING-CODE          PIC X.
  4673             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4674         16  CM-POST-CARD-IND              PIC X.
  4675         16  CM-NH-INTERFACE-SW            PIC X.
  4676         16  CM-PREMIUM-TYPE               PIC X.
  4677             88  CM-SING-PRM                  VALUE '1'.
  4678             88  CM-O-B-COVERAGE              VALUE '2'.
  4679             88  CM-OPEN-END                  VALUE '3'.
  4680         16  CM-IND-GRP-TYPE               PIC X.
  4681             88  CM-INDIVIDUAL                VALUE 'I'.
  4682             88  CM-GROUP                     VALUE 'G'.
  4683         16  CM-SKIP-CODE                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  83
* EL6317.cbl
  4684             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4685             88  SKIP-JULY                    VALUE '1'.
  4686             88  SKIP-AUGUST                  VALUE '2'.
  4687             88  SKIP-SEPTEMBER               VALUE '3'.
  4688             88  SKIP-JULY-AUG                VALUE '4'.
  4689             88  SKIP-AUG-SEPT                VALUE '5'.
  4690             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4691             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4692             88  SKIP-JUNE                    VALUE '8'.
  4693             88  SKIP-JUNE-JULY               VALUE '9'.
  4694             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4695             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4696         16  CM-PAYMENT-MODE               PIC X.
  4697             88  PAY-MONTHLY                  VALUE SPACE.
  4698             88  PAY-WEEKLY                   VALUE '1'.
  4699             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4700             88  PAY-BI-WEEKLY                VALUE '3'.
  4701             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4702         16  CM-LOAN-NUMBER                PIC X(8).
  4703         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4704         16  CM-OLD-LOF                    PIC XXX.
  4705*        16  CM-LOAN-OFFICER               PIC XXX.
  4706         16  CM-REIN-TABLE                 PIC XXX.
  4707         16  CM-SPECIAL-REIN-CODE          PIC X.
  4708         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4709         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4710         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4711
  4712     12  CM-STATUS-DATA.
  4713         16  CM-ENTRY-STATUS               PIC X.
  4714         16  CM-ENTRY-DT                   PIC XX.
  4715
  4716         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4717         16  CM-LF-CANCEL-DT               PIC XX.
  4718         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4719
  4720         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4721         16  CM-LF-DEATH-DT                PIC XX.
  4722         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4723
  4724         16  CM-LF-CURRENT-STATUS          PIC X.
  4725             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4726                                                'M' '4' '5' '9'.
  4727             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4728             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4729             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4730             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4731             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4732             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4733             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4734             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4735             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4736             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4737             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4738             88  CM-LF-DECLINED               VALUE 'D'.
  4739             88  CM-LF-VOIDED                 VALUE 'V'.
  4740
  4741         16  CM-AH-STATUS-AT-CANCEL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  84
* EL6317.cbl
  4742         16  CM-AH-CANCEL-DT               PIC XX.
  4743         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4744
  4745         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4746         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4747         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4748
  4749         16  CM-AH-CURRENT-STATUS          PIC X.
  4750             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4751                                                'M' '4' '5' '9'.
  4752             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4753             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4754             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4755             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4756             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4757             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4758             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4759             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4760             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4761             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4762             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4763             88  CM-AH-DECLINED               VALUE 'D'.
  4764             88  CM-AH-VOIDED                 VALUE 'V'.
  4765
  4766         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4767             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4768             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4769             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4770         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4771
  4772         16  CM-ENTRY-BATCH                PIC X(6).
  4773         16  CM-LF-EXIT-BATCH              PIC X(6).
  4774         16  CM-AH-EXIT-BATCH              PIC X(6).
  4775         16  CM-LAST-MONTH-END             PIC XX.
  4776
  4777     12  CM-NOTE-SW                        PIC X.
  4778         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4779         88  CERT-NOTES-PRESENT               VALUE '1'.
  4780         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4781         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4782         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4783         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4784         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4785         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4786     12  CM-COMP-EXCP-SW                   PIC X.
  4787         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4788         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4789     12  CM-INSURED-ADDRESS-SW             PIC X.
  4790         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4791         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4792
  4793*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4794     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4795     12  FILLER                            PIC X.
  4796
  4797*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4798     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4799     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  85
* EL6317.cbl
  4800*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4801     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4802
  4803     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4804         88  CERT-ADDED-BATCH                 VALUE ' '.
  4805         88  CERT-ADDED-ONLINE                VALUE '1'.
  4806         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4807         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4808         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4809     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4810         88  CERT-AS-LOADED                   VALUE ' '.
  4811         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4812         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4813         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4814         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4815         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4816         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4817         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4818
  4819     12  CM-ACCOUNT-COMM-PCTS.
  4820         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4821         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4822
  4823     12  CM-USER-FIELD                     PIC X.
  4824     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4825     12  CM-CLP-STATE                      PIC XX.
  4826     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4827     12  CM-USER-RESERVED                  PIC XXX.
  4828     12  FILLER REDEFINES CM-USER-RESERVED.
  4829         16  CM-AH-CLASS-CD                PIC XX.
  4830         16  F                             PIC X.
  4831******************************************************************
  4832*                                COPY ELCCRTO.
  4833******************************************************************
  4834*                                                                *
  4835*                            ELCCRTO.                            *
  4836*                                                                *
  4837*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4838*                                                                *
  4839*   FILE TYPE = VSAM,KSDS                                        *
  4840*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4841*                                                                *
  4842*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4843*                                                                *
  4844*   LOG = YES                                                    *
  4845*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4846******************************************************************
  4847*                   C H A N G E   L O G
  4848*
  4849* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4850*-----------------------------------------------------------------
  4851*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4852* EFFECTIVE    NUMBER
  4853*-----------------------------------------------------------------
  4854* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4855* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4856* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4857* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  86
* EL6317.cbl
  4858* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4859******************************************************************
  4860 01  ORIGINAL-CERTIFICATE.
  4861     12  OC-RECORD-ID                      PIC XX.
  4862         88  VALID-OC-ID                      VALUE 'OC'.
  4863     12  OC-CONTROL-PRIMARY.
  4864         16  OC-COMPANY-CD                 PIC X.
  4865         16  OC-CARRIER                    PIC X.
  4866         16  OC-GROUPING                   PIC X(6).
  4867         16  OC-STATE                      PIC XX.
  4868         16  OC-ACCOUNT                    PIC X(10).
  4869         16  OC-CERT-EFF-DT                PIC XX.
  4870         16  OC-CERT-NO.
  4871             20  OC-CERT-PRIME             PIC X(10).
  4872             20  OC-CERT-SFX               PIC X.
  4873         16  OC-RECORD-TYPE                PIC X.
  4874         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4875     12  OC-LAST-MAINT-DT                  PIC XX.
  4876     12  OC-LAST-MAINT-BY                  PIC X(4).
  4877     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4878     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4879     12  FILLER                            PIC X(49).
  4880     12  OC-ORIG-REC.
  4881         16  OC-INS-LAST-NAME              PIC X(15).
  4882         16  OC-INS-FIRST-NAME             PIC X(10).
  4883         16  OC-INS-MIDDLE-INIT            PIC X.
  4884         16  OC-INS-AGE                    PIC S999     COMP-3.
  4885         16  OC-JNT-LAST-NAME              PIC X(15).
  4886         16  OC-JNT-FIRST-NAME             PIC X(10).
  4887         16  OC-JNT-MIDDLE-INIT            PIC X.
  4888         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4889         16  OC-LF-BENCD                   PIC XX.
  4890         16  OC-LF-TERM                    PIC S999      COMP-3.
  4891         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4892         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4893         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4894         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4895         16  OC-LF-EXP-DT                  PIC XX.
  4896         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4897         16  OC-LF-CANCEL-DT               PIC XX.
  4898         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4899         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4900         16  OC-AH-BENCD                   PIC XX.
  4901         16  OC-AH-TERM                    PIC S999      COMP-3.
  4902         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4903         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4904         16  OC-AH-EXP-DT                  PIC XX.
  4905         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4906         16  OC-AH-CP                      PIC 99.
  4907         16  OC-AH-CANCEL-DT               PIC XX.
  4908         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4909         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4910         16  OC-CRED-BENE-NAME             PIC X(25).
  4911         16  OC-1ST-PMT-DT                 PIC XX.
  4912         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4913         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4914         16  OC-ISSUE-TRAN-IND             PIC X.
  4915         16  OC-CANCEL-TRAN-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  87
* EL6317.cbl
  4916         16  FILLER                        PIC X(211).
  4917
  4918     12  FILLER                            PIC X(50).
  4919******************************************************************
  4920*                                COPY ERCENDT.
  4921******************************************************************
  4922*                                                                *
  4923*                                                                *
  4924*                            ERCENDT.                            *
  4925*                            VMOD=2.001                          *
  4926*                                                                *
  4927*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4928*                                                                *
  4929*   FILE TYPE = VSAM,KSDS                                        *
  4930*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4931*                                                                *
  4932*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4933*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4934*                                                                *
  4935*   LOG = NO                                                     *
  4936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4937******************************************************************
  4938*-----------------------------------------------------------------
  4939*                   C H A N G E   L O G
  4940*
  4941* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4942*-----------------------------------------------------------------
  4943*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4944* EFFECTIVE    NUMBER
  4945*-----------------------------------------------------------------
  4946* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4947*                                WITH OPEN CLAIMS
  4948* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4949* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4950* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4951* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  4952*-----------------------------------------------------------------
  4953 01  ENDORSEMENT-RECORD.
  4954     12  EN-RECORD-ID                PIC XX.
  4955         88  VALID-EN-ID                VALUE 'EN'.
  4956     12  EN-CONTROL-PRIMARY.
  4957         16  EN-COMPANY-CD           PIC X.
  4958         16  EN-CARRIER              PIC X.
  4959         16  EN-GROUPING             PIC X(6).
  4960         16  EN-STATE                PIC XX.
  4961         16  EN-ACCOUNT              PIC X(10).
  4962         16  EN-CERT-EFF-DT          PIC XX.
  4963         16  EN-CERT-NO.
  4964             20  EN-CERT-PRIME       PIC X(10).
  4965             20  EN-CERT-SFX         PIC X.
  4966         16  EN-REC-TYPE             PIC X.
  4967             88  EN-ISSUE               VALUE 'I'.
  4968             88  EN-CANCELLATION        VALUE 'C'.
  4969         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4970     12  EN-CONTROL-BY-ARCH-NO.
  4971         16  EN-COMPANY-CD-A1              PIC X.
  4972         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4973     12  EN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  88
* EL6317.cbl
  4974     12  EN-LAST-MAINT-BY            PIC X(4).
  4975     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4976     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4977     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4978         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4979         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4980         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4981         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4982         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4983         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4984         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4985         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4986         16  EN-LF-ORIG-BENCD        PIC XX.
  4987         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4988         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4989         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4990         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4991         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4992         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4993*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4994         16  EN-ORIG-CRED-BENE       PIC X(25).
  4995         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4996         16  FILLER                  PIC X.
  4997         16  EN-AH-ORIG-BENCD        PIC XX.
  4998         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4999         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5000         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5001         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5002*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5003*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5004         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5005         16  F                       PIC X(09).
  5006         16  EN-AH-ORIG-CP           PIC 99.
  5007         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5008         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5009         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5010         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5011         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5012         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5013         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5014         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5015         16  EN-LF-NEW-BENCD         PIC XX.
  5016         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5017         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5018         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5019         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5020         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5021         16  EN-LF-NEW-EXP-DT        PIC XX.
  5022         16  EN-NEW-CRED-BENE        PIC X(25).
  5023         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5024         16  FILLER                  PIC X.
  5025         16  EN-AH-NEW-BENCD         PIC XX.
  5026         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5027         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5028         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5029         16  EN-AH-NEW-EXP-DT        PIC XX.
  5030*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5031*        16  EN-AH-NEW-WAIT-PER      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  89
* EL6317.cbl
  5032*        16  F                       PIC X(12).
  5033         16  EN-AH-NEW-CP            PIC 99.
  5034         16  EN-SIG-SW               PIC X.
  5035         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5036         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5037         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5038         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5039         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5040         16  FILLER                  PIC X(33).
  5041     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5042         16  EN-LF-ORIG-REF-DT       PIC XX.
  5043         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5044         16  EN-AH-ORIG-REF-DT       PIC XX.
  5045         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5046         16  EN-LF-NEW-REF-DT        PIC XX.
  5047         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5048         16  EN-AH-NEW-REF-DT        PIC XX.
  5049         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5050         16  EN-FLAG-CERT            PIC X.
  5051         16  EN-INS-LAST-NAME        PIC X(15).
  5052         16  EN-INS-FIRST-NAME       PIC X(10).
  5053         16  EN-INS-MIDDLE-INIT      PIC X.
  5054         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5055         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5056         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5057         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5058         16  FILLER                  PIC X(262).
  5059     12  EN-MONEY-SW             PIC X.
  5060     12  EN-HEALTH-APP           PIC X.
  5061     12  EN-VOUCHER-SW           PIC X.
  5062     12  EN-PAYEE                PIC X(14).
  5063     12  EN-INPUT-DT             PIC XX.
  5064     12  EN-PROCESS-DT           PIC XX.
  5065     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5066     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5067     12  EN-REASON-CODES.
  5068         16  F OCCURS 12.
  5069             20  EN-REASON-CODE  PIC X(4).
  5070     12  EN-TEMPLATE-USED        PIC X(8).
  5071     12  EN-DOCU-TYPE            PIC X.
  5072         88  EN-VERI-DOCU          VALUE 'V'.
  5073         88  EN-GCE-DOCU           VALUE 'G'.
  5074         88  EN-CANC-DOCU          VALUE 'C'.
  5075     12  EN-COMMENTS1            PIC X(13).
  5076     12  EN-COMMENTS2            PIC X(70).
  5077     12  EN-COMM-CHGBK           PIC X.
  5078         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5079         88  EN-CHG-ACCT           VALUE 'Y'.
  5080     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5081     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5082     12  EN-BATCH-NUMBER         PIC X(6).
  5083     12  EN-ACCT-SUMM            PIC X.
  5084     12  EN-CSO-SUMM             PIC X.
  5085     12  en-check-type           pic x.
  5086     12  FILLER                  PIC X(12).
  5087******************************************************************
  5088*                                COPY ERCNOTE.
  5089******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  90
* EL6317.cbl
  5090*                                                                *
  5091*                                                                *
  5092*                            ERCNOTE                             *
  5093*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5094*                            VMOD=2.003                          *
  5095*                                                                *
  5096*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5097*                                                                *
  5098*        FILE TYPE= VSAM,KSDS                                    *
  5099*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5100*                                                                *
  5101*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5102*                                                                *
  5103*        LOG = YES                                               *
  5104*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5105*                                                                *
  5106******************************************************************
  5107*                   C H A N G E   L O G
  5108*
  5109* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5110*-----------------------------------------------------------------
  5111*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5112* EFFECTIVE    NUMBER
  5113*-----------------------------------------------------------------
  5114* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5115*                                FILE WILL CONTAIN BILLING NOTES O
  5116******************************************************************
  5117
  5118 01  CERTIFICATE-NOTE.
  5119     12  CN-RECORD-ID                PIC  XX.
  5120         88  VALID-CN-ID                  VALUE 'CN'.
  5121
  5122     12  CN-CONTROL-PRIMARY.
  5123         16  CN-COMPANY-CD           PIC X.
  5124         16  CN-CARRIER              PIC X.
  5125         16  CN-GROUPING.
  5126             20 CN-GROUPING-PREFIX   PIC XXX.
  5127             20 CN-GROUPING-PRIME    PIC XXX.
  5128         16  CN-STATE                PIC XX.
  5129         16  CN-ACCOUNT.
  5130             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5131             20 CN-ACCOUNT-PRIME     PIC X(6).
  5132         16  CN-CERT-EFF-DT          PIC XX.
  5133         16  CN-CERT-NO.
  5134             20  CN-CERT-PRIME       PIC X(10).
  5135             20  CN-CERT-SFX         PIC X.
  5136
  5137     12  CN-BILLING-START-LINE-NO    PIC 99.
  5138     12  CN-BILLING-END-LINE-NO      PIC 99.
  5139
  5140     12  CN-LINES.
  5141         16  CN-LINE OCCURS 10       PIC X(77).
  5142
  5143     12  CN-LAST-MAINT-DT            PIC XX.
  5144     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5145     12  CN-LAST-MAINT-USER          PIC X(4).
  5146     12  FILLER                      PIC X(6).
  5147******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  91
* EL6317.cbl
  5148*                                COPY ERCMAIL.
  5149******************************************************************
  5150*                                                                *
  5151*                                                                *
  5152*                            ERCMAIL                             *
  5153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5154*                            VMOD=2.003                          *
  5155*                                                                *
  5156*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5157*                                                                *
  5158*   FILE TYPE = VSAM,KSDS                                        *
  5159*   RECORD SIZE = 374   RECFORM = FIX                            *
  5160*                                                                *
  5161*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5162*   ALTERNATE PATH    = NOT USED                                 *
  5163*                                                                *
  5164*   LOG = YES                                                    *
  5165*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5166******************************************************************
  5167*                   C H A N G E   L O G
  5168*
  5169* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5170*-----------------------------------------------------------------
  5171*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5172* EFFECTIVE    NUMBER
  5173*-----------------------------------------------------------------
  5174* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5175* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5176* 111108                   PEMA  ADD CRED BENE ADDR2
  5177******************************************************************
  5178
  5179 01  MAILING-DATA.
  5180     12  MA-RECORD-ID                      PIC XX.
  5181         88  VALID-MA-ID                       VALUE 'MA'.
  5182
  5183     12  MA-CONTROL-PRIMARY.
  5184         16  MA-COMPANY-CD                 PIC X.
  5185         16  MA-CARRIER                    PIC X.
  5186         16  MA-GROUPING.
  5187             20  MA-GROUPING-PREFIX        PIC XXX.
  5188             20  MA-GROUPING-PRIME         PIC XXX.
  5189         16  MA-STATE                      PIC XX.
  5190         16  MA-ACCOUNT.
  5191             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5192             20  MA-ACCOUNT-PRIME          PIC X(6).
  5193         16  MA-CERT-EFF-DT                PIC XX.
  5194         16  MA-CERT-NO.
  5195             20  MA-CERT-PRIME             PIC X(10).
  5196             20  MA-CERT-SFX               PIC X.
  5197
  5198     12  FILLER                            PIC XX.
  5199
  5200     12  MA-ACCESS-CONTROL.
  5201         16  MA-SOURCE-SYSTEM              PIC XX.
  5202             88  MA-FROM-CREDIT                VALUE 'CR'.
  5203             88  MA-FROM-VSI                   VALUE 'VS'.
  5204             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5205             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  92
* EL6317.cbl
  5206         16  MA-RECORD-ADD-DT              PIC XX.
  5207         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5208         16  MA-LAST-MAINT-DT              PIC XX.
  5209         16  MA-LAST-MAINT-BY              PIC XXXX.
  5210         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5211
  5212     12  MA-PROFILE-INFO.
  5213         16  MA-QUALIFY-CODE-1             PIC XX.
  5214         16  MA-QUALIFY-CODE-2             PIC XX.
  5215         16  MA-QUALIFY-CODE-3             PIC XX.
  5216         16  MA-QUALIFY-CODE-4             PIC XX.
  5217         16  MA-QUALIFY-CODE-5             PIC XX.
  5218
  5219         16  MA-INSURED-LAST-NAME          PIC X(15).
  5220         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5221         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5222         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5223         16  MA-INSURED-BIRTH-DT           PIC XX.
  5224         16  MA-INSURED-SEX                PIC X.
  5225             88  MA-SEX-MALE                   VALUE 'M'.
  5226             88  MA-SEX-FEMALE                 VALUE 'F'.
  5227         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5228
  5229         16  MA-ADDRESS-CORRECTED          PIC X.
  5230         16  MA-JOINT-BIRTH-DT             PIC XX.
  5231*        16  FILLER                        PIC X(12).
  5232
  5233         16  MA-ADDRESS-LINE-1             PIC X(30).
  5234         16  MA-ADDRESS-LINE-2             PIC X(30).
  5235         16  MA-CITY-STATE.
  5236             20  MA-CITY                   PIC X(28).
  5237             20  MA-ADDR-STATE             PIC XX.
  5238         16  MA-ZIP.
  5239             20  MA-ZIP-CODE.
  5240                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5241                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5242                 24  FILLER                PIC X(4).
  5243             20  MA-ZIP-PLUS4              PIC X(4).
  5244         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5245             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5246             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5247             20  FILLER                    PIC X(3).
  5248
  5249         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5250
  5251         16  FILLER                        PIC XXX.
  5252*        16  FILLER                        PIC X(10).
  5253
  5254     12  MA-CRED-BENE-INFO.
  5255         16  MA-CRED-BENE-NAME                 PIC X(25).
  5256         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5257         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5258         16  MA-CRED-BENE-CTYST.
  5259             20  MA-CRED-BENE-CITY             PIC X(28).
  5260             20  MA-CRED-BENE-STATE            PIC XX.
  5261         16  MA-CRED-BENE-ZIP.
  5262             20  MA-CB-ZIP-CODE.
  5263                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  93
* EL6317.cbl
  5264                     88  MA-CB-CANADIAN-POST-CODE
  5265                                           VALUE 'A' THRU 'Z'.
  5266                 24  FILLER                    PIC X(4).
  5267             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5268         16  MA-CB-CANADIAN-POSTAL-CODE
  5269                            REDEFINES MA-CRED-BENE-ZIP.
  5270             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5271             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5272             20  FILLER                        PIC X(3).
  5273     12  MA-POST-CARD-MAIL-DATA.
  5274         16  MA-MAIL-DATA OCCURS 7.
  5275             20  MA-MAIL-TYPE              PIC X.
  5276                 88  MA-12MO-MAILING           VALUE '1'.
  5277                 88  MA-EXP-MAILING            VALUE '2'.
  5278             20  MA-MAIL-STATUS            PIC X.
  5279                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5280                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5281                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5282             20  MA-MAIL-DATE              PIC XX.
  5283     12  FILLER                            PIC XX.
  5284     12  FILLER                            PIC XX.
  5285*    12  FILLER                            PIC X(30).
  5286******************************************************************
  5287*                                COPY ERCARCH.
  5288******************************************************************
  5289*                                                                *
  5290*                            ERCARCH.                            *
  5291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5292*                            VMOD=2.002                          *
  5293*                                                                *
  5294*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5295*                                                                *
  5296*   FILE TYPE = VSAM,KSDS                                        *
  5297*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5298*                                                                *
  5299*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5300*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5301*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5302*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5303*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5304*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5305*                                                                *
  5306*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5307******************************************************************
  5308*                   C H A N G E   L O G
  5309*
  5310* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5311*-----------------------------------------------------------------
  5312*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5313* EFFECTIVE    NUMBER
  5314*-----------------------------------------------------------------
  5315* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5316* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5317* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5318******************************************************************
  5319 01  LETTER-ARCHIVE.
  5320     12  LA-RECORD-ID                PIC  X(02).
  5321         88  LA-VALID-ID                VALUE 'LA'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  94
* EL6317.cbl
  5322
  5323     12  LA-CONTROL-PRIMARY.
  5324         16  LA-COMPANY-CD           PIC  X(01).
  5325         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5326
  5327     12  LA-CONTROL-BY-CERT-RESP.
  5328         16  LA-COMPANY-CD-A2        PIC  X(01).
  5329         16  LA-CERT-NO-A2.
  5330             20  LA-CERT-PRIME-A2    PIC  X(10).
  5331             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5332         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5333             20  LA-RESP-PERSON-A2   PIC  X(10).
  5334             20  LA-TYPE-A2          PIC  X(01).
  5335         16  LA-CARRIER-A2           PIC  X(01).
  5336         16  LA-GROUPING-A2          PIC  X(06).
  5337         16  LA-STATE-A2             PIC  X(02).
  5338         16  LA-ACCOUNT-A2           PIC  X(10).
  5339         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5340         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5341
  5342     12  LA-CONTROL-BY-FORM.
  5343         16  LA-COMPANY-CD-A3        PIC  X(01).
  5344         16  LA-FORM-A3              PIC  X(04).
  5345         16  LA-CARRIER-A3           PIC  X(01).
  5346         16  LA-GROUPING-A3          PIC  X(06).
  5347         16  LA-STATE-A3             PIC  X(02).
  5348         16  LA-ACCOUNT-A3           PIC  X(10).
  5349         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5350
  5351     12  LA-CONTROL-BY-PROCESSOR.
  5352         16  LA-COMPANY-CD-A4        PIC  X(01).
  5353         16  LA-PROCESSOR-CD         PIC  X(04).
  5354         16  LA-CARRIER-A4           PIC  X(01).
  5355         16  LA-GROUPING-A4          PIC  X(06).
  5356         16  LA-STATE-A4             PIC  X(02).
  5357         16  LA-ACCOUNT-A4           PIC  X(10).
  5358         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5359
  5360     12  LA-CONTROL-BY-KEY-FIELDS.
  5361         16  LA-COMPANY-CD-A5        PIC  X(01).
  5362         16  LA-CARRIER-A5           PIC  X(01).
  5363         16  LA-GROUPING-A5          PIC  X(06).
  5364         16  LA-STATE-A5             PIC  X(02).
  5365         16  LA-ACCOUNT-A5           PIC  X(10).
  5366         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5367
  5368     12  LA-CONTROL-BY-GROUP-CODE.
  5369         16  LA-COMPANY-CD-A6        PIC  X(01).
  5370         16  LA-ENTRY-A6.
  5371             20  LA-FILLER           PIC  X(02).
  5372             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5373         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5374
  5375     12  FILLER                      PIC  X(09).
  5376
  5377     12  LA-HEADER-RECORD.
  5378         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5379         16  LA-CREATION-DATE        PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  95
* EL6317.cbl
  5380         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5381         16  LA-FINAL-ACT-DATE       REDEFINES
  5382               LA-FOLLOW-UP-DATE     PIC  X(02).
  5383         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5384         16  LA-NO-OF-COPIES         PIC S9(01).
  5385         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5386         16  LA-REPLY-DATE           PIC  X(02).
  5387         16  LA-RESEND-DATES.
  5388             20  LA-RESEND-DATE      PIC  X(02).
  5389             20  LA-SENT-DATE        PIC  X(02).
  5390             20  FILLER              PIC  X(08).
  5391         16  LA-SOURCE-INFORMATION.
  5392             20  LA-DATA-SOURCE      PIC  X(01).
  5393             20  LA-ADDR-SOURCE      PIC  X(01).
  5394         16  LA-STATUS               PIC  X(01).
  5395             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5396             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5397             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5398             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5399             88  LA-STATUS-PURGED         VALUE 'P'.
  5400             88  LA-STATUS-VOIDED         VALUE 'V'.
  5401         16  LA-LAST-RESENT-PRINT-DATE
  5402                                     PIC  X(02).
  5403         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5404             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5405                                          VALUE 'C'.
  5406             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5407                                          VALUE 'F'.
  5408             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5409                                          VALUE 'P'.
  5410         16  LA-PURGED-DATE          PIC  X(02).
  5411         16  LA-VOIDED-DATE          PIC  X(02).
  5412         16  LA-RESEND-LETR          PIC  X(4).
  5413         16  FILLER                  PIC  X(08).
  5414*        16  LA-RESEND-LETR-2        PIC  X(4).
  5415*        16  LA-RESEND-LETR-3        PIC  X(4).
  5416*        16  FILLER                  PIC  X(59).
  5417         16  LA-ARCHIVE-STATUS       PIC  X.
  5418             88  LA-TEMP                VALUE 'T'.
  5419             88  LA-QWS                 VALUE 'Q'.
  5420             88  LA-BATCH               VALUE 'B'.
  5421         16  LA-FINAL-ACT-IND        PIC  X(1).
  5422         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5423         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5424         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5425                                     PIC X(4).
  5426         16  FILLER                  PIC  X(42).
  5427*        16  FILLER                  PIC  X(71).
  5428         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5429         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5430         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5431                                     PIC  X(4).
  5432         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5433
  5434******************************************************************
  5435*                                COPY ERCCNOT.
  5436******************************************************************
  5437*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  96
* EL6317.cbl
  5438*                            ERCCNOT                             *
  5439*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5440*                            VMOD=2.003                          *
  5441*                                                                *
  5442*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5443*                                                                *
  5444*        FILE TYPE= VSAM,KSDS                                    *
  5445*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5446*                                                                *
  5447*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5448*                                                                *
  5449*        LOG = YES                                               *
  5450*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5451*                                                                *
  5452******************************************************************
  5453*                   C H A N G E   L O G
  5454*
  5455* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5456*-----------------------------------------------------------------
  5457*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5458* EFFECTIVE    NUMBER
  5459*-----------------------------------------------------------------
  5460* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5461******************************************************************
  5462
  5463 01  CERT-NOTE-FILE.
  5464     12  CZ-RECORD-ID                PIC  XX.
  5465         88  VALID-CZ-ID                  VALUE 'CZ'.
  5466
  5467     12  CZ-CONTROL-PRIMARY.
  5468         16  CZ-COMPANY-CD           PIC X.
  5469         16  CZ-CARRIER              PIC X.
  5470         16  CZ-GROUPING.
  5471             20 CZ-GROUPING-PREFIX   PIC XXX.
  5472             20 CZ-GROUPING-PRIME    PIC XXX.
  5473         16  CZ-STATE                PIC XX.
  5474         16  CZ-ACCOUNT.
  5475             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5476             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5477         16  CZ-CERT-EFF-DT          PIC XX.
  5478         16  CZ-CERT-NO.
  5479             20  CZ-CERT-PRIME       PIC X(10).
  5480             20  CZ-CERT-SFX         PIC X.
  5481         16  CZ-RECORD-TYPE          PIC X.
  5482             88  CERT-NOTE           VALUE '1'.
  5483             88  CLAIM-CERT-NOTE     VALUE '2'.
  5484         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5485
  5486     12  CZ-LAST-MAINT-DT            PIC XX.
  5487     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5488     12  CZ-LAST-MAINT-USER          PIC X(4).
  5489
  5490     12  CZ-NOTE-INFORMATION.
  5491         16  CZ-NOTE                 PIC X(63).
  5492         16  FILLER                  PIC X(39).
  5493******************************************************************
  5494*                                COPY ELCEOBC.
  5495******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  97
* EL6317.cbl
  5496*                                                                *
  5497*                                                                *
  5498*                            ELCEOBC                             *
  5499*                            VMOD=2.001                          *
  5500*                                                                *
  5501*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5502*                                                                *
  5503*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5504*   VSAM EOB CODE TABLE                                          *
  5505*                                                                *
  5506*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5507*                                                                *
  5508*   FILE TYPE = VSAM,KSDS                                        *
  5509*   RECORD SIZE = 350   RECFORM = FIX                            *
  5510*                                                                *
  5511*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5512*                                                                *
  5513*   LOG = NO                                                     *
  5514*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5515*                                                                *
  5516*                                                                *
  5517******************************************************************
  5518*                   C H A N G E   L O G
  5519*
  5520* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5521*-----------------------------------------------------------------
  5522*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5523* EFFECTIVE    NUMBER
  5524*-----------------------------------------------------------------
  5525* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5526* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5527* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5528******************************************************************
  5529 01  EOB-CODES.
  5530     12  EO-RECORD-ID                      PIC XX.
  5531         88  VALID-DN-ID                      VALUE 'EO'.
  5532     12  EO-CONTROL-PRIMARY.
  5533         16  EO-COMPANY-CD                 PIC X.
  5534         16  EO-RECORD-TYPE                PIC X.
  5535             88  EO-EOB-RECS                  VALUE '1'.
  5536             88  EO-VERIF-RECS                VALUE '2'.
  5537             88  EO-GCE-RECS                  VALUE '3'.
  5538             88  EO-CANC-RECS                 VALUE '4'.
  5539             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5540         16  EO-EOB-CODE                   PIC X(4).
  5541         16  FILLER                        PIC X(9).
  5542     12  EO-MAINT-INFORMATION.
  5543         16  EO-LAST-MAINT-DT              PIC XX.
  5544         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5545         16  EO-LAST-MAINT-USER            PIC X(4).
  5546         16  FILLER                        PIC XX.
  5547     12  EO-DESCRIPTION                    PIC X(275).
  5548     12  FILLER                            PIC X(46).
  5549******************************************************************
  5550*                                COPY ELCCRTT.
  5551******************************************************************
  5552*                                                                *
  5553*                            ELCCRTT.                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  98
* EL6317.cbl
  5554*                                                                *
  5555*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5556*                                                                *
  5557*   FILE TYPE = VSAM,KSDS                                        *
  5558*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5559*                                                                *
  5560*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5561*                                                                *
  5562*   LOG = YES                                                    *
  5563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5564******************************************************************
  5565*                   C H A N G E   L O G
  5566*
  5567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5568*-----------------------------------------------------------------
  5569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5570* EFFECTIVE    NUMBER
  5571*-----------------------------------------------------------------
  5572* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5573* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5574* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5575* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5576* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5577* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5578* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5579* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5580* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5581******************************************************************
  5582
  5583 01  CERTIFICATE-TRAILERS.
  5584     12  CS-RECORD-ID                      PIC XX.
  5585         88  VALID-CS-ID                      VALUE 'CS'.
  5586
  5587     12  CS-CONTROL-PRIMARY.
  5588         16  CS-COMPANY-CD                 PIC X.
  5589         16  CS-CARRIER                    PIC X.
  5590         16  CS-GROUPING                   PIC X(6).
  5591         16  CS-STATE                      PIC XX.
  5592         16  CS-ACCOUNT                    PIC X(10).
  5593         16  CS-CERT-EFF-DT                PIC XX.
  5594         16  CS-CERT-NO.
  5595             20  CS-CERT-PRIME             PIC X(10).
  5596             20  CS-CERT-SFX               PIC X.
  5597         16  CS-TRAILER-TYPE               PIC X.
  5598             88  COMM-TRLR           VALUE 'A'.
  5599             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5600             88  CERT-DATA-TRLR      VALUE 'C'.
  5601
  5602     12  CS-DATA-AREA                      PIC X(516).
  5603
  5604     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5605         16  CS-BANK-COMMISSION-AREA.
  5606             20  CS-BANK-COMMS       OCCURS 10.
  5607                 24  CS-AGT                PIC X(10).
  5608                 24  CS-COM-TYP            PIC X.
  5609                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5610                 24  CS-RECALC-LV-INDIC    PIC X.
  5611                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page  99
* EL6317.cbl
  5612         16  FILLER                        PIC X(256).
  5613
  5614     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5615****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5616         16  CS-MB-CLAIM-DATA OCCURS 24.
  5617             20  CS-CLAIM-NO               PIC X(7).
  5618             20  CS-CLAIM-TYPE             PIC X.
  5619                 88  CS-AH-CLM               VALUE 'A'.
  5620                 88  CS-IU-CLM               VALUE 'I'.
  5621                 88  CS-GP-CLM               VALUE 'G'.
  5622                 88  CS-LF-CLM               VALUE 'L'.
  5623                 88  CS-PR-CLM               VALUE 'P'.
  5624                 88  CS-FL-CLM               VALUE 'F'.
  5625             20  CS-INSURED-TYPE           PIC X.
  5626                 88  CS-PRIM-INSURED          VALUE 'P'.
  5627                 88  CS-CO-BORROWER           VALUE 'C'.
  5628             20  CS-BENEFIT-PERIOD         PIC 99.
  5629             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5630             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5631             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5632         16  FILLER                        PIC X(12).
  5633     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5634         16  CS-VIN-NUMBER                 PIC X(17).
  5635         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5636         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5637         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5638         16  cs-agent-name.
  5639             20  cs-agent-fname            pic x(20).
  5640             20  cs-agent-mi               pic x.
  5641             20  cs-agent-lname            pic x(25).
  5642         16  cs-license-no                 pic x(15).
  5643         16  cs-npn-number                 pic x(10).
  5644         16  cs-agent-edit-status          pic x.
  5645             88  cs-ae-refer-to-manager      value 'M'.
  5646             88  cs-ae-cover-sheet           value 'C'.
  5647             88  cs-ae-sig-form              value 'S'.
  5648             88  cs-ae-verified              value 'V'.
  5649             88  cs-unidentified-signature   value 'U'.
  5650             88  cs-cert-returned            value 'R'.
  5651             88  cs-accept-no-commission     value 'N'.
  5652         16  cs-year                       pic 9999.
  5653         16  cs-make                       pic x(20).
  5654         16  cs-model                      pic x(20).
  5655         16  cs-future                     pic x(20).
  5656         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5657         16  FILLER                        PIC X(356). *> was 420
  5658*        16  FILLER                        PIC X(496).
  5659*                                COPY ELCENCC.
  5660******************************************************************
  5661*                                                                *
  5662*                                                                *
  5663*                            ELCENCC                             *
  5664*                            VMOD=2.001                          *
  5665*                                                                *
  5666*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5667*                                                                *
  5668*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5669*   A NAPERSOFT DOCUMENT                                         *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 100
* EL6317.cbl
  5670*                                                                *
  5671*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5672*                                                                *
  5673*   FILE TYPE = VSAM,KSDS                                        *
  5674*   RECORD SIZE = 400   RECFORM = FIX                            *
  5675*                                                                *
  5676*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5677*                                                                *
  5678*   LOG = NO                                                     *
  5679*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5680*                                                                *
  5681*                                                                *
  5682******************************************************************
  5683*                   C H A N G E   L O G
  5684*
  5685* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5686*-----------------------------------------------------------------
  5687*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5688* EFFECTIVE    NUMBER
  5689*-----------------------------------------------------------------
  5690* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5691* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5692******************************************************************
  5693 01  ENCLOSURE-CODES.
  5694     12  NC-RECORD-ID                      PIC XX.
  5695         88  VALID-NC-ID                      VALUE 'NC'.
  5696     12  NC-CONTROL-PRIMARY.
  5697         16  NC-COMPANY-CD                 PIC X.
  5698         16  NC-REC-TYPE                   PIC X.
  5699             88  NC-CLAIMS                   VALUE '1'.
  5700             88  NC-ADMIN                    VALUE '2'.
  5701         16  NC-ENC-CODE                   PIC X(5).
  5702         16  FILLER                        PIC X(09).
  5703     12  NC-MAINT-INFORMATION.
  5704         16  NC-LAST-MAINT-DT              PIC XX.
  5705         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5706         16  NC-LAST-MAINT-USER            PIC X(4).
  5707         16  FILLER                        PIC XX.
  5708     12  NC-OUTPUT-STACK                   PIC XXX.
  5709     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5710     12  NC-ATTACHMENTS                    PIC X(255).
  5711     12  NC-FUTURE                         PIC X(12).
  5712******************************************************************
  5713 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5714                          ACCOUNT-MASTER CONTROL-FILE
  5715                          PENDING-BUSINESS CERTIFICATE-MASTER
  5716                          ORIGINAL-CERTIFICATE
  5717                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5718                          MAILING-DATA LETTER-ARCHIVE
  5719                          CERT-NOTE-FILE EOB-CODES
  5720                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5721 0000-DFHEXIT SECTION.
  5722     MOVE '9#                    $   ' TO DFHEIV0.
  5723     MOVE 'EL6317' TO DFHEIV1.
  5724     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5725     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5726     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5727     MOVE '5'                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 101
* EL6317.cbl
  5728     PERFORM 9700-DATE-LINK
  5729     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5730     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5731     MOVE EIBTRMID               TO QID-TERM
  5732     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5733     IF EIBCALEN = 0
  5734        GO TO 8800-UNAUTHORIZED-ACCESS
  5735     END-IF
  5736     MOVE FUNCTION LENGTH(EL631JI) TO MAP-LENGTH
  5737     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5738        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5739           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5740           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5741           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5742           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5743           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5744           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5745           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5746           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5747           MOVE LOW-VALUES           TO EL631JI
  5748           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5749           GO TO 0350-BUILD-INIT-MAP
  5750        END-IF
  5751     END-IF
  5752     IF PI-CALLING-PROGRAM = 'EL614'
  5753        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5754                                 TO WS-PASSED-REASON-CODES
  5755        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5756        IF WS-PASSED-REASON-CODES NOT = SPACES
  5757           MOVE 'Y'              TO WS-SET-CODES-MDT
  5758        ELSE
  5759           MOVE 'N'              TO WS-SET-CODES-MDT
  5760        END-IF
  5761        PERFORM 0600-RECOVER-TEMP-STORAGE
  5762                                 THRU 0600-EXIT
  5763        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5764        GO TO 0350-BUILD-INIT-MAP
  5765     END-IF
  5766     IF EIBAID = DFHCLEAR
  5767        IF PI-CLEAR-ERROR
  5768           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5769           MOVE ER-3833           TO EMI-ERROR
  5770           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5771           GO TO 0350-BUILD-INIT-MAP
  5772        ELSE
  5773           GO TO 9400-CLEAR
  5774        END-IF
  5775     END-IF
  5776     .
  5777 0200-RECEIVE.
  5778     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5779        MOVE ER-0008             TO EMI-ERROR
  5780        PERFORM 9900-ERROR-FORMAT
  5781                                 THRU 9900-EXIT
  5782        MOVE -1                  TO PFENTRL
  5783        GO TO 8100-SEND-INITIAL-MAP
  5784     END-IF
  5785
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 102
* EL6317.cbl
  5786* EXEC CICS RECEIVE
  5787*        MAP      (MAP-NAME)
  5788*        MAPSET   (MAPSET-NAME)
  5789*        INTO     (EL631JI)
  5790*    END-EXEC
  5791     MOVE LENGTH OF
  5792      EL631JI
  5793       TO DFHEIV11
  5794*    MOVE '8"T I  L              ''   #00005781' TO DFHEIV0
  5795     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5796     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5797     MOVE X'2020233030303035373831' TO DFHEIV0(25:11)
  5798     CALL 'kxdfhei1' USING DFHEIV0,
  5799           MAP-NAME,
  5800           EL631JI,
  5801           DFHEIV11,
  5802           MAPSET-NAME,
  5803           DFHEIV99,
  5804           DFHEIV99
  5805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5806     IF PFENTRL = 0
  5807         GO TO 0300-CHECK-PFKEYS
  5808     END-IF
  5809     IF EIBAID NOT = DFHENTER
  5810         MOVE ER-0004            TO EMI-ERROR
  5811         GO TO 0320-INPUT-ERROR
  5812     END-IF
  5813     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5814        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5815     ELSE
  5816        MOVE ER-0029            TO EMI-ERROR
  5817        GO TO 0320-INPUT-ERROR
  5818     END-IF
  5819     .
  5820 0300-CHECK-PFKEYS.
  5821     IF EIBAID = DFHPF3
  5822        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5823        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5824        MOVE 'EL614'             TO PGM-NAME
  5825        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5826        move +1                  to s2
  5827        perform varying s1 from +1 by +1 until s1 > +12
  5828           if reacd-in (s1) not = spaces and low-values
  5829              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5830              add +5 to s2
  5831           end-if
  5832        END-perform
  5833        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5834        GO TO 9300-XCTL
  5835     END-IF
  5836     IF EIBAID = DFHPF4 OR DFHPF8
  5837        GO TO 0360-FINALIZE
  5838     END-IF
  5839     IF EIBAID = DFHPF23
  5840        IF PI-CLEAR-ERROR
  5841           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5842           MOVE ER-3833           TO EMI-ERROR
  5843           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 103
* EL6317.cbl
  5844           GO TO 0350-BUILD-INIT-MAP
  5845        ELSE
  5846           GO TO 8810-PF23
  5847        END-IF
  5848     END-IF
  5849     IF EIBAID = DFHPF24
  5850        IF PI-CLEAR-ERROR
  5851           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5852           MOVE ER-3833           TO EMI-ERROR
  5853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5854           GO TO 0350-BUILD-INIT-MAP
  5855        ELSE
  5856           GO TO 9200-RETURN-MAIN-MENU
  5857        END-IF
  5858     END-IF
  5859     IF EIBAID = DFHPF12
  5860        GO TO 9500-PF12
  5861     END-IF
  5862     IF EIBAID = DFHENTER
  5863        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5864        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5865        GO TO 0330-CHECK-ERRORS
  5866     END-IF
  5867     MOVE ER-0029                TO EMI-ERROR
  5868     .
  5869 0320-INPUT-ERROR.
  5870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5871     MOVE AL-UNBON               TO PFENTRA
  5872     MOVE -1                     TO PFENTRL
  5873     GO TO 8200-SEND-DATAONLY
  5874     .
  5875 0325-EDIT-SCREEN.
  5876     if prtswl > zeros
  5877        if prtswi = 'Y' OR 'N' OR 'P' OR ' '
  5878*          MOVE AL-UANON       TO PRTSWA
  5879*          IF PRTSWI = ' '
  5880              MOVE 'P'         TO PRTSWI
  5881*          END-IF
  5882*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5883        END-IF
  5884     END-IF
  5885     IF (SIGREQL > ZEROS)
  5886        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5887        MOVE AL-UANON         TO SIGREQA
  5888        IF SIGREQI = ' '
  5889           MOVE 'N'           TO SIGREQI
  5890        END-IF
  5891        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5892     ELSE
  5893        MOVE ER-2651          TO EMI-ERROR
  5894        MOVE -1               TO SIGREQL
  5895        MOVE AL-UABON         TO SIGREQA
  5896        PERFORM 9900-ERROR-FORMAT
  5897                                 THRU 9900-EXIT
  5898     END-IF
  5899     IF LTRIDL > ZEROS
  5900        AND LTRIDI > SPACES
  5901        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 104
* EL6317.cbl
  5902        MOVE LTRIDI              TO LETR-LETTER-ID
  5903                                    PI-LTRID-ENTERED
  5904        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5905        MOVE SPACES              TO LETR-FILLER
  5906        MOVE 0                   TO LETR-SEQ-NO
  5907        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5908     ELSE
  5909        MOVE ER-1236          TO EMI-ERROR
  5910        MOVE -1               TO LTRIDL
  5911        MOVE AL-UABON         TO LTRIDA
  5912        PERFORM 9900-ERROR-FORMAT
  5913                                 THRU 9900-EXIT
  5914     END-IF
  5915
  5916     IF W-PROMPT-LETTER EQUAL 'Y'
  5917         MOVE ER-0894            TO EMI-ERROR
  5918         MOVE -1                 TO LTRIDL
  5919         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5920     END-IF
  5921
  5922     IF ENCCODEL > ZEROS
  5923        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  5924                                              PI-ENCCODE
  5925        MOVE SPACES             TO WS-ELENCC-KEY
  5926        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  5927        MOVE '2'                TO WS-ENCC-REC-TYPE
  5928        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  5929
  5930
  5931* EXEC CICS READ
  5932*           DATASET    (WS-ELENCC-FILE-ID)
  5933*           SET        (ADDRESS OF ENCLOSURE-CODES)
  5934*           RIDFLD     (WS-ELENCC-KEY)
  5935*           RESP       (WS-RESPONSE)
  5936*       END-EXEC
  5937*    MOVE '&"S        E          (  N#00005910' TO DFHEIV0
  5938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5940     MOVE X'204E233030303035393130' TO DFHEIV0(25:11)
  5941     CALL 'kxdfhei1' USING DFHEIV0,
  5942           WS-ELENCC-FILE-ID,
  5943           DFHEIV20,
  5944           DFHEIV99,
  5945           WS-ELENCC-KEY,
  5946           DFHEIV99,
  5947           DFHEIV99,
  5948           DFHEIV99
  5949     SET ADDRESS OF ENCLOSURE-CODES TO
  5950         DFHEIV20
  5951     MOVE EIBRESP  TO WS-RESPONSE
  5952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5953
  5954        IF RESP-NORMAL
  5955           MOVE ENCCODEI         TO PI-ENCCODE
  5956                                    W-ENCLOSURE-CD
  5957           MOVE AL-UANON         TO ENCCODEA
  5958        ELSE
  5959           MOVE ER-1560          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 105
* EL6317.cbl
  5960           MOVE -1               TO ENCCODEL
  5961           MOVE AL-UABON         TO ENCCODEA
  5962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5963        END-IF
  5964     END-IF
  5965
  5966     SET REASONS-NOT-FOUND TO TRUE
  5967     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5968        IF REACDL (S1) = +4 OR
  5969          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5970              MOVE AL-SANON     TO REACDA (S1)
  5971              SET REASONS-FOUND TO TRUE
  5972        END-IF
  5973     END-PERFORM
  5974
  5975     IF REASONS-NOT-FOUND
  5976        MOVE ER-1820             TO EMI-ERROR
  5977        MOVE -1                  TO PFENTRL
  5978        PERFORM 9900-ERROR-FORMAT
  5979                                 THRU 9900-EXIT
  5980     ELSE
  5981        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5982     END-IF
  5983
  5984     IF CRTNT1L > ZEROS
  5985        IF CRTNT1I > SPACES
  5986           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5987        END-IF
  5988     END-IF
  5989
  5990     IF CRTNT2L > ZEROS
  5991        IF CRTNT2I > SPACES
  5992           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5993        END-IF
  5994     END-IF
  5995
  5996     IF BILNT1L > ZEROS
  5997        IF BILNT1I > SPACES
  5998           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5999        END-IF
  6000     END-IF
  6001
  6002     IF BILNT2L > ZEROS
  6003        IF BILNT2I > SPACES
  6004           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  6005        END-IF
  6006     END-IF
  6007
  6008     .
  6009 0325-EXIT.
  6010     EXIT.
  6011
  6012 0326-GET-Z-RECORD.
  6013
  6014     MOVE SPACES  TO W-Z-CONTROL-DATA
  6015
  6016
  6017* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 106
* EL6317.cbl
  6018*         DATASET    ('ELLETR')
  6019*         RIDFLD     (ELLETR-KEY)
  6020*         GTEQ
  6021*         RESP      (WS-RESPONSE)
  6022*    END-EXEC.
  6023     MOVE 'ELLETR' TO DFHEIV1
  6024     MOVE 0
  6025       TO DFHEIV11
  6026*    MOVE '&,         G          &  N#00005979' TO DFHEIV0
  6027     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6029     MOVE X'204E233030303035393739' TO DFHEIV0(25:11)
  6030     CALL 'kxdfhei1' USING DFHEIV0,
  6031           DFHEIV1,
  6032           ELLETR-KEY,
  6033           DFHEIV99,
  6034           DFHEIV11,
  6035           DFHEIV99
  6036     MOVE EIBRESP  TO WS-RESPONSE
  6037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6038
  6039     IF NOT RESP-NORMAL
  6040         MOVE ER-1236          TO EMI-ERROR
  6041         MOVE -1               TO LTRIDL
  6042         MOVE AL-UABON         TO LTRIDA
  6043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6044         GO TO 0326-ENDBR
  6045     END-IF.
  6046
  6047 0326-READNEXT.
  6048
  6049
  6050* EXEC CICS READNEXT
  6051*        DATASET   ('ELLETR')
  6052*        INTO      (TEXT-FILES)
  6053*        RIDFLD    (ELLETR-KEY)
  6054*        RESP      (WS-RESPONSE)
  6055*    END-EXEC
  6056     MOVE LENGTH OF
  6057      TEXT-FILES
  6058       TO DFHEIV12
  6059     MOVE 'ELLETR' TO DFHEIV1
  6060     MOVE 0
  6061       TO DFHEIV11
  6062*    MOVE '&.IL                  )  N#00005995' TO DFHEIV0
  6063     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6064     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6065     MOVE X'204E233030303035393935' TO DFHEIV0(25:11)
  6066     CALL 'kxdfhei1' USING DFHEIV0,
  6067           DFHEIV1,
  6068           TEXT-FILES,
  6069           DFHEIV12,
  6070           ELLETR-KEY,
  6071           DFHEIV99,
  6072           DFHEIV11,
  6073           DFHEIV99,
  6074           DFHEIV99
  6075     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 107
* EL6317.cbl
  6076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6077     IF RESP-NORMAL
  6078        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6079           MOVE ER-1236          TO EMI-ERROR
  6080           MOVE -1               TO LTRIDL
  6081           MOVE AL-UABON         TO LTRIDA
  6082           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6083           GO TO 0326-ENDBR
  6084        END-IF
  6085
  6086        MOVE AL-UANON         TO LTRIDA
  6087        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6088           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6089        ELSE
  6090           GO TO 0326-READNEXT
  6091        END-IF
  6092     ELSE
  6093        MOVE ER-1236          TO EMI-ERROR
  6094        MOVE -1               TO LTRIDL
  6095        MOVE AL-UABON         TO LTRIDA
  6096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6097        GO TO 0326-ENDBR
  6098     END-IF.
  6099
  6100     IF PI-ENCCODE NOT GREATER THAN SPACES
  6101         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6102                                           ENCCODEO
  6103         MOVE AL-UANON                  TO ENCCODEA
  6104         MOVE +3                        TO ENCCODEL
  6105     END-IF.
  6106
  6107 0326-ENDBR.
  6108
  6109
  6110* EXEC CICS ENDBR
  6111*        DATASET     ('ELLETR')
  6112*    END-EXEC.
  6113     MOVE 'ELLETR' TO DFHEIV1
  6114     MOVE 0
  6115       TO DFHEIV11
  6116*    MOVE '&2                    $   #00006033' TO DFHEIV0
  6117     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6118     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6119     MOVE X'2020233030303036303333' TO DFHEIV0(25:11)
  6120     CALL 'kxdfhei1' USING DFHEIV0,
  6121           DFHEIV1,
  6122           DFHEIV11,
  6123           DFHEIV99
  6124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6125
  6126
  6127 0326-EXIT.
  6128      EXIT.
  6129 0330-CHECK-ERRORS.
  6130     IF EMI-NO-ERRORS
  6131        GO TO 0350-BUILD-INIT-MAP
  6132     ELSE
  6133        GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 108
* EL6317.cbl
  6134     END-IF
  6135     .
  6136 0330-EXIT.
  6137     EXIT.
  6138 0350-BUILD-INIT-MAP.
  6139
  6140     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6141      OR 'EL6314'
  6142        display 'coming from ' PI-RETURN-TO-PROGRAM
  6143        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6144        MOVE PI-CARRIER             TO CRTO-CARRIER
  6145        MOVE PI-GROUPING            TO CRTO-GROUPING
  6146        MOVE PI-STATE               TO CRTO-STATE
  6147        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6148        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6149        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6150        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6151        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6152        MOVE ZEROS                  TO CRTO-SEQ-NO
  6153        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6154                                       PI-ERENDT-KEY
  6155     END-IF
  6156     MOVE PI-CRTO-CARRIER        TO CARRO
  6157     MOVE PI-CRTO-GROUPING       TO GROUPO
  6158     MOVE PI-CRTO-STATE          TO STATEO
  6159     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6160     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6161     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6162     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6163     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6164     MOVE ' '                    TO DC-OPTION-CODE
  6165     PERFORM 9700-DATE-LINK
  6166     IF NO-CONVERSION-ERROR
  6167        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6168     END-IF
  6169
  6170*    IF PI-PRTSW-ENTERED > SPACES
  6171*       MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6172*       MOVE AL-UANON            TO PRTSWA
  6173*       MOVE +1                  TO PRTSWL
  6174*    END-IF
  6175
  6176     IF PI-SIGREQ-ENTERED > SPACES
  6177        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6178        MOVE AL-UANON            TO SIGREQA
  6179        MOVE +1                  TO SIGREQL
  6180     END-IF
  6181
  6182     IF PI-LTRID-ENTERED > SPACES
  6183        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6184        MOVE AL-UANON            TO LTRIDA
  6185        MOVE +4                  TO LTRIDL
  6186     END-IF
  6187
  6188     IF PI-ENCCODE > SPACES
  6189        MOVE PI-ENCCODE          TO ENCCODEI
  6190        MOVE AL-UANON            TO ENCCODEA
  6191        MOVE +3                  TO ENCCODEL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 109
* EL6317.cbl
  6192     END-IF
  6193
  6194     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6195     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6196        IF REACDL (S1) = +4 OR
  6197          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6198              MOVE AL-SANON      TO REACDA (S1)
  6199              MOVE +4            TO REACDL (S1)
  6200              SET REASONS-FOUND  TO TRUE
  6201        END-IF
  6202     END-PERFORM
  6203
  6204     IF PI-CERTNT1-ENTERED > SPACES
  6205        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6206        MOVE AL-UANON            TO CRTNT1A
  6207        MOVE +63                 TO CRTNT1L
  6208     END-IF
  6209
  6210     IF PI-CERTNT2-ENTERED > SPACES
  6211        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6212        MOVE AL-UANON            TO CRTNT2A
  6213        MOVE +63                 TO CRTNT2L
  6214     END-IF
  6215
  6216     IF PI-BILLNT1-ENTERED > SPACES
  6217        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6218        MOVE AL-UANON            TO BILNT1A
  6219        MOVE +63                 TO BILNT1L
  6220     END-IF
  6221
  6222     IF PI-BILLNT2-ENTERED > SPACES
  6223        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6224        MOVE AL-UANON            TO BILNT2A
  6225        MOVE +63                 TO BILNT2L
  6226     END-IF
  6227
  6228     GO TO 8100-SEND-INITIAL-MAP
  6229     .
  6230 0360-FINALIZE.
  6231     display ' made it to 0360 '
  6232     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6233     IF NOT EMI-NO-ERRORS
  6234       AND EIBAID = DFHPF4
  6235        GO TO 8200-SEND-DATAONLY
  6236     END-IF
  6237     set P to address of KIXSYS
  6238     CALL "getenv" using by value P returning var-ptr
  6239     if var-ptr = null then
  6240        display ' kixsys not set '
  6241     else
  6242        set address of var to var-ptr
  6243        move 0 to env-var-len
  6244        inspect var tallying env-var-len
  6245          for characters before X'00'
  6246*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6247        unstring var (1:env-var-len) delimited by '/'
  6248           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6249              WS-KIX-SYS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 110
* EL6317.cbl
  6250        end-unstring
  6251*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6252*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6253     end-if
  6254     set P to address of KIXHOST
  6255     CALL "getenv" using by value P returning var-ptr
  6256     if var-ptr = null then
  6257        display ' kixhost not set '
  6258     else
  6259        set address of var to var-ptr
  6260        move 0 to env-var-len
  6261        inspect var tallying env-var-len
  6262          for characters before X'00'
  6263*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6264        MOVE var(1:env-var-len)  to ws-kixhost
  6265        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6266     end-if
  6267     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6268     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6269     IF RESP-NORMAL
  6270        AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6271        DISPLAY ' RESP NORMAL AND = '
  6272        MOVE OC-KEY-SEQ-NO  TO CRTO-SEQ-NO
  6273                               PI-CRTO-SEQ-NO
  6274        MOVE LOW-VALUES     TO NEW-ELCRTO-REC
  6275        MOVE PI-ELCRTO-KEY  TO NEW-ELCRTO-KEY
  6276        SUBTRACT +1         FROM NCRTO-SEQ-NO
  6277        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6278*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6279        PERFORM 1100-CALL-NS-BUS-LOGIC
  6280                                 THRU 1100-EXIT
  6281        IF BL-OK
  6282           CONTINUE
  6283        ELSE
  6284           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6285           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6286           MOVE -1               TO CARRL
  6287        END-IF
  6288     ELSE
  6289        MOVE ER-9999             TO EMI-ERROR
  6290        PERFORM 9900-ERROR-FORMAT
  6291                                 THRU 9900-EXIT
  6292        MOVE -1                  TO CARRL
  6293        GO TO 8100-SEND-INITIAL-MAP
  6294     END-IF
  6295     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6296                                 TO SYSO
  6297     MOVE WS-KIXHOST             TO HOSTO
  6298     MOVE PI-COMPANY-ID          TO COMPANYO
  6299     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6300       OR 'EL6314'
  6301         MOVE '2'                TO DATASORO
  6302     ELSE
  6303         MOVE '4'                TO DATASORO
  6304     END-IF
  6305     MOVE BL-BATCH-NO            TO BATCHNOO
  6306     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6307     MOVE BL-ARCHIVE-NO          TO ARCHNOO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 111
* EL6317.cbl
  6308     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6309*    MOVE -1                     TO PRTSWL
  6310*    MOVE AL-UANON               TO PRTSWA
  6311     MOVE -1                     TO SIGREQL
  6312     MOVE AL-UANON               TO SIGREQA
  6313     IF EIBAID = DFHPF4
  6314        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6315        MOVE ER-0280             TO EMI-ERROR
  6316        PERFORM 9900-ERROR-FORMAT
  6317                                 THRU 9900-EXIT
  6318        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6319        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6320        MOVE 'Y'                 TO PI-FINALIZED-IND
  6321        GO TO 9400-CLEAR
  6322     ELSE
  6323        MOVE ER-1818             TO EMI-ERROR
  6324        PERFORM 9900-ERROR-FORMAT
  6325                                 THRU 9900-EXIT
  6326     END-IF
  6327     GO TO 0350-BUILD-INIT-MAP
  6328     .
  6329 0360-EXIT.
  6330     EXIT.
  6331 0362-READ-ELCRTO.
  6332     display ' made it to 0362 '
  6333
  6334* EXEC CICS READ
  6335*        DATASET   (WS-ELCRTO-FILE-ID)
  6336*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6337*        RIDFLD    (ELCRTO-KEY)
  6338*        GTEQ
  6339*        RESP      (WS-RESPONSE)
  6340*    END-EXEC
  6341*    MOVE '&"S        G          (  N#00006243' TO DFHEIV0
  6342     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6344     MOVE X'204E233030303036323433' TO DFHEIV0(25:11)
  6345     CALL 'kxdfhei1' USING DFHEIV0,
  6346           WS-ELCRTO-FILE-ID,
  6347           DFHEIV20,
  6348           DFHEIV99,
  6349           ELCRTO-KEY,
  6350           DFHEIV99,
  6351           DFHEIV99,
  6352           DFHEIV99
  6353     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6354         DFHEIV20
  6355     MOVE EIBRESP  TO WS-RESPONSE
  6356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6357     .
  6358 0362-EXIT.
  6359     EXIT.
  6360 0363-READ-ELCRTO-UPD.
  6361     display ' made it to 0363 '
  6362
  6363* EXEC CICS READ
  6364*        DATASET   (WS-ELCRTO-FILE-ID)
  6365*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 112
* EL6317.cbl
  6366*        RIDFLD    (ELCRTO-KEY)
  6367*        UPDATE
  6368*        RESP      (WS-RESPONSE)
  6369*    END-EXEC
  6370*    MOVE '&"S        EU         (  N#00006255' TO DFHEIV0
  6371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6372     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6373     MOVE X'204E233030303036323535' TO DFHEIV0(25:11)
  6374     CALL 'kxdfhei1' USING DFHEIV0,
  6375           WS-ELCRTO-FILE-ID,
  6376           DFHEIV20,
  6377           DFHEIV99,
  6378           ELCRTO-KEY,
  6379           DFHEIV99,
  6380           DFHEIV99,
  6381           DFHEIV99
  6382     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6383         DFHEIV20
  6384     MOVE EIBRESP  TO WS-RESPONSE
  6385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6386     .
  6387 0363-EXIT.
  6388     EXIT.
  6389 0365-READ-ERENDT.
  6390
  6391* EXEC CICS READ
  6392*        DATASET   (WS-ERENDT-FILE-ID)
  6393*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6394*        RIDFLD    (ERENDT-KEY)
  6395*        RESP      (WS-RESPONSE)
  6396*    END-EXEC
  6397*    MOVE '&"S        E          (  N#00006266' TO DFHEIV0
  6398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6400     MOVE X'204E233030303036323636' TO DFHEIV0(25:11)
  6401     CALL 'kxdfhei1' USING DFHEIV0,
  6402           WS-ERENDT-FILE-ID,
  6403           DFHEIV20,
  6404           DFHEIV99,
  6405           ERENDT-KEY,
  6406           DFHEIV99,
  6407           DFHEIV99,
  6408           DFHEIV99
  6409     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6410         DFHEIV20
  6411     MOVE EIBRESP  TO WS-RESPONSE
  6412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6413     .
  6414 0365-EXIT.
  6415     EXIT.
  6416 0400-ADD-ERENDT.
  6417     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6418     display ' made it to 0400 '
  6419
  6420* EXEC CICS GETMAIN
  6421*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6422*         LENGTH   (ERENDT-LENGTH)
  6423*         INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 113
* EL6317.cbl
  6424*    END-EXEC
  6425*    MOVE ',"IL                  $   #00006278' TO DFHEIV0
  6426     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6427     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6428     MOVE X'2020233030303036323738' TO DFHEIV0(25:11)
  6429     CALL 'kxdfhei1' USING DFHEIV0,
  6430           DFHEIV20,
  6431           ERENDT-LENGTH,
  6432           GETMAIN-SPACE
  6433     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6434         DFHEIV20
  6435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6436     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6437     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6438     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6439     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6440                                    EN-INPUT-DT
  6441                                    EN-PROCESS-DT
  6442
  6443     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6444     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6445     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6446     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6447     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6448     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6449     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6450     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6451     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6452     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6453     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6454     IF OC-LF-BENCD NOT = '00' AND '  '
  6455        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6456        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6457        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6458        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6459        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6460        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6461        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6462     END-IF
  6463     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6464     IF OC-AH-BENCD NOT = '00' AND '  '
  6465        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6466        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6467        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6468        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6469        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6470        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6471     END-IF
  6472     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6473
  6474     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6475       OR 'EL6314'
  6476         display 'from ' PI-RETURN-TO-PROGRAM
  6477                 ', using crto for new crto'
  6478
  6479        MOVE OC-INS-FIRST-NAME    TO EN-INS-NEW-FIRST-NAME
  6480                                     NCRTO-INS-FIRST-NAME
  6481        MOVE OC-INS-MIDDLE-INIT   TO EN-INS-NEW-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 114
* EL6317.cbl
  6482                                     NCRTO-INS-MIDDLE-INIT
  6483        MOVE OC-INS-LAST-NAME     TO EN-INS-NEW-LAST-NAME
  6484                                     NCRTO-INS-LAST-NAME
  6485        MOVE OC-INS-AGE           TO EN-INS-NEW-AGE
  6486                                     NCRTO-INS-AGE
  6487        MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6488                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6489        MOVE OC-JNT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6490                                     NCRTO-JNT-FIRST-NAME
  6491        MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6492                                     NCRTO-JNT-MIDDLE-INIT
  6493        MOVE OC-JNT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6494                                     NCRTO-JNT-LAST-NAME
  6495        MOVE OC-JNT-AGE           TO EN-JNT-NEW-AGE
  6496                                     NCRTO-JNT-AGE
  6497        MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6498                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6499        MOVE OC-LF-BENCD          TO EN-LF-NEW-BENCD
  6500                                     NCRTO-LF-BENCD
  6501        IF OC-LF-BENCD NOT = '00' AND '  '
  6502           MOVE OC-LF-BEN-AMT       TO EN-LF-NEW-BEN-AMT
  6503                                       NCRTO-LF-BEN-AMT
  6504           MOVE OC-LF-PRM-AMT       TO EN-LF-NEW-PRM-AMT
  6505                                       NCRTO-LF-PRM-AMT
  6506           MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-NEW-ALT-BEN-AMT
  6507                                       NCRTO-LF-ALT-BEN-AMT
  6508           MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-NEW-ALT-PRM-AMT
  6509                                       NCRTO-LF-ALT-PRM-AMT
  6510           MOVE OC-LF-TERM          TO EN-LF-NEW-TERM
  6511                                       NCRTO-LF-TERM
  6512           MOVE OC-LF-EXP-DT        TO EN-LF-NEW-EXP-DT
  6513                                       NCRTO-LF-EXP-DT
  6514           MOVE OC-LF-COMM-PCT      TO EN-LF-NEW-COMM-PCT
  6515                                       NCRTO-LF-COMM-PCT
  6516           MOVE OC-LF-CANCEL-DT     TO NCRTO-LF-CANCEL-DT
  6517           MOVE OC-LF-CANCEL-AMT    TO NCRTO-LF-CANCEL-AMT
  6518           MOVE OC-LF-ITD-CANCEL-AMT TO NCRTO-LF-ITD-CANCEL-AMT
  6519        END-IF
  6520        MOVE OC-AH-BENCD          TO EN-AH-NEW-BENCD
  6521                                     NCRTO-AH-BENCD
  6522        IF OC-AH-BENCD NOT = '00' AND '  '
  6523           MOVE OC-AH-BEN-AMT       TO EN-AH-NEW-BEN-AMT
  6524                                       NCRTO-AH-BEN-AMT
  6525           MOVE OC-AH-PRM-AMT       TO EN-AH-NEW-PRM-AMT
  6526                                       NCRTO-AH-PRM-AMT
  6527           MOVE OC-AH-TERM          TO EN-AH-NEW-TERM
  6528                                       NCRTO-AH-TERM
  6529           MOVE OC-AH-EXP-DT        TO EN-AH-NEW-EXP-DT
  6530                                       NCRTO-AH-EXP-DT
  6531           MOVE OC-AH-CP            TO EN-AH-NEW-CP
  6532                                       NCRTO-AH-CP
  6533           MOVE OC-AH-COMM-PCT      TO EN-AH-NEW-COMM-PCT
  6534                                       NCRTO-AH-COMM-PCT
  6535           MOVE OC-AH-CANCEL-DT     TO NCRTO-AH-CANCEL-DT
  6536           MOVE OC-AH-CANCEL-AMT    TO NCRTO-AH-CANCEL-AMT
  6537           MOVE OC-AH-ITD-CANCEL-AMT TO NCRTO-AH-ITD-CANCEL-AMT
  6538        END-IF
  6539        MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 115
* EL6317.cbl
  6540                                       NCRTO-CRED-BENE-NAME
  6541
  6542        GO TO 0400-WRITE-ENDT
  6543     END-IF
  6544
  6545* EXEC CICS GETMAIN
  6546*         SET      (ADDRESS OF PENDING-BUSINESS)
  6547*         LENGTH   (ERPNDB-LENGTH)
  6548*         INITIMG  (GETMAIN-SPACE)
  6549*    END-EXEC
  6550*    MOVE ',"IL                  $   #00006391' TO DFHEIV0
  6551     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6552     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6553     MOVE X'2020233030303036333931' TO DFHEIV0(25:11)
  6554     CALL 'kxdfhei1' USING DFHEIV0,
  6555           DFHEIV20,
  6556           ERPNDB-LENGTH,
  6557           GETMAIN-SPACE
  6558     SET ADDRESS OF PENDING-BUSINESS TO
  6559         DFHEIV20
  6560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6561     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6562     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6563
  6564* EXEC CICS READ
  6565*        DATASET   (WS-ERPNDB-FILE-ID)
  6566*        INTO      (PENDING-BUSINESS)
  6567*        RIDFLD    (ERPNDB-KEY)
  6568*        RESP      (WS-RESPONSE)
  6569*    END-EXEC
  6570     MOVE LENGTH OF
  6571      PENDING-BUSINESS
  6572       TO DFHEIV11
  6573*    MOVE '&"IL       E          (  N#00006398' TO DFHEIV0
  6574     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6575     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6576     MOVE X'204E233030303036333938' TO DFHEIV0(25:11)
  6577     CALL 'kxdfhei1' USING DFHEIV0,
  6578           WS-ERPNDB-FILE-ID,
  6579           PENDING-BUSINESS,
  6580           DFHEIV11,
  6581           ERPNDB-KEY,
  6582           DFHEIV99,
  6583           DFHEIV99,
  6584           DFHEIV99
  6585     MOVE EIBRESP  TO WS-RESPONSE
  6586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6587     IF NOT RESP-NORMAL
  6588        GO TO 0400-EXIT
  6589     END-IF
  6590*    set found-pndb to true
  6591     display ' good read on erpndb '
  6592     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6593                                      NCRTO-INS-FIRST-NAME
  6594     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6595                                      NCRTO-INS-MIDDLE-INIT
  6596     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6597                                      NCRTO-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 116
* EL6317.cbl
  6598     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6599                                      NCRTO-INS-AGE
  6600     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6601                                      NCRTO-JNT-FIRST-NAME
  6602     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6603                                      NCRTO-JNT-MIDDLE-INIT
  6604     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6605                                      NCRTO-JNT-LAST-NAME
  6606     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6607                                      NCRTO-JNT-AGE
  6608     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6609                                      NCRTO-LF-BENCD
  6610     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6611        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6612                                      NCRTO-LF-BEN-AMT
  6613        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6614                                      NCRTO-LF-PRM-AMT
  6615        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6616                                      NCRTO-LF-ALT-BEN-AMT
  6617        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6618                                      NCRTO-LF-ALT-PRM-AMT
  6619        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6620                                      NCRTO-LF-TERM
  6621        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6622                                      NCRTO-LF-EXP-DT
  6623        IF PB-I-JOINT-COMMISSION > +0
  6624           MOVE PB-I-JOINT-COMMISSION
  6625                                   TO EN-LF-NEW-COMM-PCT
  6626                                      NCRTO-LF-COMM-PCT
  6627        ELSE
  6628           MOVE PB-I-LIFE-COMMISSION
  6629                                   TO EN-LF-NEW-COMM-PCT
  6630                                      NCRTO-LF-COMM-PCT
  6631        MOVE LOW-VALUES            TO NCRTO-LF-CANCEL-DT
  6632        MOVE +0                    TO NCRTO-LF-CANCEL-AMT
  6633                                      NCRTO-LF-ITD-CANCEL-AMT
  6634        END-IF
  6635     END-IF
  6636     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6637                                      NCRTO-AH-BENCD
  6638     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6639        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6640                                      NCRTO-AH-BEN-AMT
  6641        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6642                                      NCRTO-AH-PRM-AMT
  6643        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6644                                      NCRTO-AH-TERM
  6645        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6646                                      NCRTO-AH-EXP-DT
  6647        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6648                                      NCRTO-AH-CP
  6649        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6650                                      NCRTO-AH-COMM-PCT
  6651        MOVE LOW-VALUES            TO NCRTO-AH-CANCEL-DT
  6652        MOVE +0                    TO NCRTO-AH-CANCEL-AMT
  6653                                      NCRTO-AH-ITD-CANCEL-AMT
  6654     END-IF
  6655     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 117
* EL6317.cbl
  6656     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6657     move pb-control-by-account (1:33)
  6658                                 to ws-ermail-key
  6659
  6660* EXEC CICS READ
  6661*        DATASET   ('ERMAIL')
  6662*        SET       (ADDRESS OF MAILING-DATA)
  6663*        RIDFLD    (WS-ERMAIL-KEY)
  6664*        RESP      (WS-RESPONSE)
  6665*    END-EXEC
  6666     MOVE 'ERMAIL' TO DFHEIV1
  6667*    MOVE '&"S        E          (  N#00006476' TO DFHEIV0
  6668     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6670     MOVE X'204E233030303036343736' TO DFHEIV0(25:11)
  6671     CALL 'kxdfhei1' USING DFHEIV0,
  6672           DFHEIV1,
  6673           DFHEIV20,
  6674           DFHEIV99,
  6675           WS-ERMAIL-KEY,
  6676           DFHEIV99,
  6677           DFHEIV99,
  6678           DFHEIV99
  6679     SET ADDRESS OF MAILING-DATA TO
  6680         DFHEIV20
  6681     MOVE EIBRESP  TO WS-RESPONSE
  6682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6683     IF RESP-NORMAL
  6684        DISPLAY ' FOUND ERMAIL '
  6685        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6686                                    NCRTO-CRED-BENE-NAME
  6687     ELSE
  6688        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6689     END-IF
  6690
  6691     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6692     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6693
  6694
  6695* EXEC CICS READ
  6696*         DATASET  (WS-ELCRTT-FILE-ID)
  6697*         RIDFLD   (WS-ELCRTT-KEY)
  6698*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6699*         RESP     (WS-RESPONSE)
  6700*    END-EXEC
  6701*    MOVE '&"S        E          (  N#00006493' TO DFHEIV0
  6702     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6704     MOVE X'204E233030303036343933' TO DFHEIV0(25:11)
  6705     CALL 'kxdfhei1' USING DFHEIV0,
  6706           WS-ELCRTT-FILE-ID,
  6707           DFHEIV20,
  6708           DFHEIV99,
  6709           WS-ELCRTT-KEY,
  6710           DFHEIV99,
  6711           DFHEIV99,
  6712           DFHEIV99
  6713     SET ADDRESS OF CERTIFICATE-TRAILERS TO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 118
* EL6317.cbl
  6714         DFHEIV20
  6715     MOVE EIBRESP  TO WS-RESPONSE
  6716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6717
  6718     IF RESP-NORMAL
  6719        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6720                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6721        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6722                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6723     END-IF.
  6724      .
  6725 0400-WRITE-ENDT.
  6726
  6727     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6728        IF REACD-IN (S1) NOT = LOW-VALUES
  6729           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6730        END-IF
  6731     END-PERFORM
  6732     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6733     MOVE 'V'                    TO EN-DOCU-TYPE
  6734     MOVE ' '                    TO EN-MONEY-SW
  6735     MOVE SIGREQI                TO EN-SIG-SW
  6736     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6737     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6738     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6739*    IF NOT EMI-NO-ERRORS
  6740*       DISPLAY ' GOING TO 8200 FROM 0400 '
  6741*       GO TO 8200-SEND-DATAONLY
  6742*    END-IF
  6743     DISPLAY ' 0400 EXIT '
  6744     .
  6745 0400-EXIT.
  6746     EXIT.
  6747 0410-INIT-ERENDT.
  6748     display ' made it to 0410 '
  6749     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6750     MOVE ZEROS                  TO ENDT-SEQ-NO
  6751
  6752* EXEC CICS READ
  6753*        DATASET    (WS-ERENDT-FILE-ID)
  6754*        RIDFLD     (ERENDT-KEY)
  6755*        INTO       (ENDORSEMENT-RECORD)
  6756*        RESP       (WS-RESPONSE)
  6757*        GTEQ
  6758*    END-EXEC
  6759     MOVE LENGTH OF
  6760      ENDORSEMENT-RECORD
  6761       TO DFHEIV11
  6762*    MOVE '&"IL       G          (  N#00006533' TO DFHEIV0
  6763     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6764     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6765     MOVE X'204E233030303036353333' TO DFHEIV0(25:11)
  6766     CALL 'kxdfhei1' USING DFHEIV0,
  6767           WS-ERENDT-FILE-ID,
  6768           ENDORSEMENT-RECORD,
  6769           DFHEIV11,
  6770           ERENDT-KEY,
  6771           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 119
* EL6317.cbl
  6772           DFHEIV99,
  6773           DFHEIV99
  6774     MOVE EIBRESP  TO WS-RESPONSE
  6775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6776     IF RESP-NORMAL
  6777        AND (EN-CONTROL-PRIMARY (1:34) =
  6778           OC-CONTROL-PRIMARY (1:34))
  6779        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6780     ELSE
  6781        MOVE +4096               TO WS-SEQ-NO
  6782     END-IF
  6783     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6784     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6785     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6786     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6787     INITIALIZE EN-ISSUE-RECORD
  6788     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6789                                    EN-AH-ORIG-EXP-DT
  6790                                    EN-LF-NEW-EXP-DT
  6791                                    EN-AH-NEW-EXP-DT
  6792                                    EN-PROCESS-DT
  6793     .
  6794 0410-EXIT.
  6795     EXIT.
  6796 0420-UPDATE-ELCRTO.
  6797     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6798     IF RESP-NORMAL
  6799        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6800                                    OC-LAST-MAINT-DT
  6801        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6802        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6803
  6804* EXEC CICS REWRITE
  6805*          FROM     (ORIGINAL-CERTIFICATE)
  6806*          DATASET  ('ELCRTO')
  6807*       END-EXEC
  6808     MOVE LENGTH OF
  6809      ORIGINAL-CERTIFICATE
  6810       TO DFHEIV11
  6811     MOVE 'ELCRTO' TO DFHEIV1
  6812*    MOVE '&& L                  %   #00006567' TO DFHEIV0
  6813     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6814     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6815     MOVE X'2020233030303036353637' TO DFHEIV0(25:11)
  6816     CALL 'kxdfhei1' USING DFHEIV0,
  6817           DFHEIV1,
  6818           ORIGINAL-CERTIFICATE,
  6819           DFHEIV11,
  6820           DFHEIV99
  6821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6822     END-IF
  6823     .
  6824 0420-EXIT.
  6825     EXIT.
  6826
  6827 0425-ADD-NEW-ELCRTO.
  6828     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6829     MOVE 'OC'                   TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 120
* EL6317.cbl
  6830     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6831     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6832     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6833     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6834     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6835     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6836     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6837     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6838     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6839     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6840     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6841     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6842     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6843     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6844     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6845     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6846     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6847     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6848     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6849     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6850     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6851     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6852     MOVE NCRTO-LF-CANCEL-DT     TO OC-LF-CANCEL-DT
  6853     MOVE NCRTO-LF-CANCEL-AMT    TO OC-LF-CANCEL-AMT
  6854     MOVE NCRTO-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
  6855     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6856     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6857     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6858     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6859     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6860     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6861     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6862     MOVE NCRTO-AH-CANCEL-DT     TO OC-AH-CANCEL-DT
  6863     MOVE NCRTO-AH-CANCEL-AMT    TO OC-AH-CANCEL-AMT
  6864     MOVE NCRTO-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
  6865     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6866     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6867     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  6868     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  6869     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6870     .
  6871 0425-WRITE-ELCRTO.
  6872
  6873
  6874* EXEC CICS WRITE
  6875*       DATASET   ('ELCRTO')
  6876*       FROM      (ORIGINAL-CERTIFICATE)
  6877*       RIDFLD    (OC-CONTROL-PRIMARY)
  6878*       RESP      (WS-RESPONSE)
  6879*    END-EXEC
  6880     MOVE LENGTH OF
  6881      ORIGINAL-CERTIFICATE
  6882       TO DFHEIV11
  6883     MOVE 'ELCRTO' TO DFHEIV1
  6884*    MOVE '&$ L                  ''  N#00006622' TO DFHEIV0
  6885     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6887     MOVE X'204E233030303036363232' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 121
* EL6317.cbl
  6888     CALL 'kxdfhei1' USING DFHEIV0,
  6889           DFHEIV1,
  6890           ORIGINAL-CERTIFICATE,
  6891           DFHEIV11,
  6892           OC-CONTROL-PRIMARY,
  6893           DFHEIV99,
  6894           DFHEIV99
  6895     MOVE EIBRESP  TO WS-RESPONSE
  6896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6897
  6898     display ' just wrote new crto ' ws-response
  6899                           ' ' oc-key-seq-no
  6900     IF RESP-DUPKEY
  6901        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6902        GO TO 0425-WRITE-ELCRTO
  6903     ELSE
  6904        IF NOT RESP-NORMAL
  6905           MOVE -1               TO SIGREQL
  6906           MOVE ER-3830          TO EMI-ERROR
  6907           PERFORM 9900-ERROR-FORMAT
  6908                                 THRU 9900-EXIT
  6909        ELSE
  6910           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6911        END-IF
  6912     END-IF
  6913
  6914     .
  6915 0425-EXIT.
  6916     EXIT.
  6917
  6918 0426-ADD-CERT-NOTES.
  6919
  6920     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6921     SET TB-INDX TO 1
  6922
  6923     IF PI-CERTNT1-ENTERED > SPACES
  6924         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6925         MOVE PI-PROCESSOR-ID    TO
  6926                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6927         MOVE EIBTIME            TO
  6928                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6929         MOVE WS-CURRENT-BIN-DT  TO
  6930                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6931         SET TB-INDX UP BY +1
  6932     END-IF
  6933
  6934     IF PI-CERTNT2-ENTERED > SPACES
  6935         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6936         MOVE PI-PROCESSOR-ID    TO
  6937                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6938         MOVE EIBTIME            TO
  6939                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6940         MOVE WS-CURRENT-BIN-DT  TO
  6941                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6942         SET TB-INDX UP BY +1
  6943     END-IF
  6944
  6945     IF CERT-NOTE-ENTRIES > SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 122
* EL6317.cbl
  6946         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6947         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6948     END-IF
  6949
  6950     IF PI-BILLNT1-ENTERED > SPACES
  6951         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6952         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6953         MOVE +63 TO WS-LEN
  6954         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6955     END-IF
  6956
  6957     IF PI-BILLNT2-ENTERED > SPACES
  6958         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6959         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6960         MOVE +63 TO WS-LEN
  6961         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6962     END-IF
  6963
  6964     .
  6965 0426-EXIT.
  6966     EXIT.
  6967
  6968 0427-LOAD-CURRENT-CERT-NOTES.
  6969
  6970     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6971     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6972     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6973     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6974     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6975     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6976     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6977     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6978     MOVE '1'                 TO ERCNOT-REC-TYP
  6979     MOVE +0                  TO ERCNOT-SEQ
  6980     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6981
  6982
  6983* EXEC CICS STARTBR
  6984*         DATASET(WS-ERCNOT-FILE-ID)
  6985*         RIDFLD(ERCNOT-KEY)
  6986*         KEYLENGTH(ERCNOT-START-LENGTH)
  6987*         RESP      (WS-RESPONSE)
  6988*         GENERIC
  6989*         GTEQ
  6990*    END-EXEC.
  6991     MOVE 0
  6992       TO DFHEIV11
  6993*    MOVE '&,   KG    G          &  N#00006713' TO DFHEIV0
  6994     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6995     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6996     MOVE X'204E233030303036373133' TO DFHEIV0(25:11)
  6997     CALL 'kxdfhei1' USING DFHEIV0,
  6998           WS-ERCNOT-FILE-ID,
  6999           ERCNOT-KEY,
  7000           ERCNOT-START-LENGTH,
  7001           DFHEIV11,
  7002           DFHEIV99
  7003     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 123
* EL6317.cbl
  7004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7005
  7006
  7007     IF NOT RESP-NORMAL
  7008        GO TO 0427-ENDBR
  7009     END-IF.
  7010
  7011 0427-LOOP.
  7012
  7013* EXEC CICS READNEXT
  7014*         SET(ADDRESS OF CERT-NOTE-FILE)
  7015*         DATASET(WS-ERCNOT-FILE-ID)
  7016*         RIDFLD(ERCNOT-KEY)
  7017*    END-EXEC.
  7018     MOVE 0
  7019       TO DFHEIV11
  7020*    MOVE '&.S                   )   #00006727' TO DFHEIV0
  7021     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7022     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7023     MOVE X'2020233030303036373237' TO DFHEIV0(25:11)
  7024     CALL 'kxdfhei1' USING DFHEIV0,
  7025           WS-ERCNOT-FILE-ID,
  7026           DFHEIV20,
  7027           DFHEIV99,
  7028           ERCNOT-KEY,
  7029           DFHEIV99,
  7030           DFHEIV11,
  7031           DFHEIV99,
  7032           DFHEIV99
  7033     SET ADDRESS OF CERT-NOTE-FILE TO
  7034         DFHEIV20
  7035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7036
  7037
  7038     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7039         GO TO 0427-ENDBR
  7040     END-IF.
  7041
  7042     IF (CZ-CARRIER = SV-CARRIER)
  7043        AND (CZ-GROUPING = SV-GROUPING)
  7044        AND (CZ-STATE = SV-STATE)
  7045        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7046        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7047        AND (CZ-CERT-NO = SV-CERT-NO)
  7048        AND (CZ-RECORD-TYPE = '1')
  7049          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7050          MOVE CZ-LAST-MAINT-USER TO
  7051                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7052          MOVE CZ-LAST-MAINT-DT TO
  7053                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7054          MOVE CZ-LAST-MAINT-HHMMSS TO
  7055                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7056          SET TB-INDX UP BY 1
  7057          GO TO 0427-LOOP
  7058     END-IF.
  7059
  7060 0427-ENDBR.
  7061
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 124
* EL6317.cbl
  7062
  7063* EXEC CICS ENDBR
  7064*         DATASET(WS-ERCNOT-FILE-ID)
  7065*    END-EXEC.
  7066     MOVE 0
  7067       TO DFHEIV11
  7068*    MOVE '&2                    $   #00006757' TO DFHEIV0
  7069     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7070     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7071     MOVE X'2020233030303036373537' TO DFHEIV0(25:11)
  7072     CALL 'kxdfhei1' USING DFHEIV0,
  7073           WS-ERCNOT-FILE-ID,
  7074           DFHEIV11,
  7075           DFHEIV99
  7076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7077
  7078
  7079     .
  7080 0427-EXIT.
  7081     EXIT.
  7082
  7083 0430-WRITE-ERENDT.
  7084     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7085     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7086     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7087
  7088* EXEC CICS WRITE
  7089*         DATASET   (WS-ERENDT-FILE-ID)
  7090*         FROM      (ENDORSEMENT-RECORD)
  7091*         RIDFLD    (EN-CONTROL-PRIMARY)
  7092*         RESP      (WS-RESPONSE)
  7093*    END-EXEC
  7094     MOVE LENGTH OF
  7095      ENDORSEMENT-RECORD
  7096       TO DFHEIV11
  7097*    MOVE '&$ L                  ''  N#00006769' TO DFHEIV0
  7098     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7099     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7100     MOVE X'204E233030303036373639' TO DFHEIV0(25:11)
  7101     CALL 'kxdfhei1' USING DFHEIV0,
  7102           WS-ERENDT-FILE-ID,
  7103           ENDORSEMENT-RECORD,
  7104           DFHEIV11,
  7105           EN-CONTROL-PRIMARY,
  7106           DFHEIV99,
  7107           DFHEIV99
  7108     MOVE EIBRESP  TO WS-RESPONSE
  7109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7110     IF RESP-NORMAL
  7111        MOVE 'V'                 TO PI-DOCUMENT-PROCESSED
  7112        display ' good write erendt '
  7113        IF EIBAID = DFHPF4
  7114           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7115           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7116           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7117           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7118        END-IF
  7119     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 125
* EL6317.cbl
  7120        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7121        MOVE -1                  TO CARRL
  7122        MOVE ER-0132             TO EMI-ERROR
  7123        MOVE AL-UABON            TO CARRA
  7124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7125     END-IF
  7126     .
  7127 0430-EXIT.
  7128     EXIT.
  7129 0440-ADD-BILLING-NOTE.
  7130
  7131* EXEC CICS GETMAIN
  7132*         SET      (ADDRESS OF EOB-CODES)
  7133*         LENGTH   (ELEOBC-LENGTH)
  7134*         INITIMG  (GETMAIN-SPACE)
  7135*    END-EXEC
  7136*    MOVE ',"IL                  $   #00006795' TO DFHEIV0
  7137     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7138     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7139     MOVE X'2020233030303036373935' TO DFHEIV0(25:11)
  7140     CALL 'kxdfhei1' USING DFHEIV0,
  7141           DFHEIV20,
  7142           ELEOBC-LENGTH,
  7143           GETMAIN-SPACE
  7144     SET ADDRESS OF EOB-CODES TO
  7145         DFHEIV20
  7146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7147
  7148     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7149     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7150     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7151
  7152
  7153* EXEC CICS STARTBR
  7154*        DATASET   ('ELEOBC')
  7155*        RIDFLD    (WS-ELEOBC-KEY)
  7156*        GTEQ
  7157*        RESP      (WS-RESPONSE)
  7158*    END-EXEC
  7159     MOVE 'ELEOBC' TO DFHEIV1
  7160     MOVE 0
  7161       TO DFHEIV11
  7162*    MOVE '&,         G          &  N#00006805' TO DFHEIV0
  7163     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7164     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7165     MOVE X'204E233030303036383035' TO DFHEIV0(25:11)
  7166     CALL 'kxdfhei1' USING DFHEIV0,
  7167           DFHEIV1,
  7168           WS-ELEOBC-KEY,
  7169           DFHEIV99,
  7170           DFHEIV11,
  7171           DFHEIV99
  7172     MOVE EIBRESP  TO WS-RESPONSE
  7173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7174
  7175     IF NOT RESP-NORMAL
  7176        GO TO 0440-EXIT
  7177     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 126
* EL6317.cbl
  7178      .
  7179 0440-READNEXT-ELEOBC.
  7180
  7181
  7182* EXEC CICS READNEXT
  7183*       INTO    (EOB-CODES)
  7184*       DATASET ('ELEOBC')
  7185*       RIDFLD  (WS-ELEOBC-KEY)
  7186*       RESP    (WS-RESPONSE)
  7187*    END-EXEC
  7188     MOVE LENGTH OF
  7189      EOB-CODES
  7190       TO DFHEIV12
  7191     MOVE 'ELEOBC' TO DFHEIV1
  7192     MOVE 0
  7193       TO DFHEIV11
  7194*    MOVE '&.IL                  )  N#00006818' TO DFHEIV0
  7195     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7196     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7197     MOVE X'204E233030303036383138' TO DFHEIV0(25:11)
  7198     CALL 'kxdfhei1' USING DFHEIV0,
  7199           DFHEIV1,
  7200           EOB-CODES,
  7201           DFHEIV12,
  7202           WS-ELEOBC-KEY,
  7203           DFHEIV99,
  7204           DFHEIV11,
  7205           DFHEIV99,
  7206           DFHEIV99
  7207     MOVE EIBRESP  TO WS-RESPONSE
  7208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7209
  7210     IF RESP-NORMAL
  7211         IF EO-RECORD-TYPE NOT = '5'
  7212             GO TO 0440-EXIT
  7213         END-IF
  7214     ELSE
  7215         GO TO 0440-EXIT
  7216     END-IF
  7217
  7218     IF EO-RECORD-TYPE = '5' AND
  7219        EO-EOB-CODE = PI-LTRID-ENTERED
  7220           CONTINUE
  7221     ELSE
  7222         GO TO 0440-READNEXT-ELEOBC
  7223     END-IF
  7224
  7225     MOVE SPACES TO WS-BILLING-NOTE
  7226     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7227     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7228     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7229     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7230     MOVE +25 TO WS-LEN
  7231
  7232     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7233     .
  7234 0440-EXIT.
  7235     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 127
* EL6317.cbl
  7236
  7237 0441-UPDATE-BILLING-NOTE.
  7238
  7239
  7240* EXEC CICS GETMAIN
  7241*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7242*         LENGTH   (ERNOTE-LENGTH)
  7243*         INITIMG  (GETMAIN-SPACE)
  7244*    END-EXEC
  7245*    MOVE ',"IL                  $   #00006854' TO DFHEIV0
  7246     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7248     MOVE X'2020233030303036383534' TO DFHEIV0(25:11)
  7249     CALL 'kxdfhei1' USING DFHEIV0,
  7250           DFHEIV20,
  7251           ERNOTE-LENGTH,
  7252           GETMAIN-SPACE
  7253     SET ADDRESS OF CERTIFICATE-NOTE TO
  7254         DFHEIV20
  7255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7256
  7257     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7258
  7259
  7260* EXEC CICS READ
  7261*       DATASET    (WS-ERNOTE-FILE-ID)
  7262*       RIDFLD     (WS-ERNOTE-KEY)
  7263*       INTO       (CERTIFICATE-NOTE)
  7264*       RESP       (WS-RESPONSE)
  7265*       UPDATE
  7266*    END-EXEC
  7267     MOVE LENGTH OF
  7268      CERTIFICATE-NOTE
  7269       TO DFHEIV11
  7270*    MOVE '&"IL       EU         (  N#00006862' TO DFHEIV0
  7271     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7272     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7273     MOVE X'204E233030303036383632' TO DFHEIV0(25:11)
  7274     CALL 'kxdfhei1' USING DFHEIV0,
  7275           WS-ERNOTE-FILE-ID,
  7276           CERTIFICATE-NOTE,
  7277           DFHEIV11,
  7278           WS-ERNOTE-KEY,
  7279           DFHEIV99,
  7280           DFHEIV99,
  7281           DFHEIV99
  7282     MOVE EIBRESP  TO WS-RESPONSE
  7283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7284
  7285     IF RESP-NORMAL
  7286       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7287          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7288       END-IF
  7289       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7290          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7291       END-IF
  7292       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7293           (NOTE-SUB > +10) OR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 128
* EL6317.cbl
  7294           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7295                             WS-BILLING-NOTE (1:WS-LEN))
  7296       END-PERFORM
  7297       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7298                              WS-BILLING-NOTE (1:WS-LEN)
  7299
  7300* EXEC CICS UNLOCK
  7301*           DATASET    (WS-ERNOTE-FILE-ID)
  7302*        END-EXEC
  7303*    MOVE '&*                    #   #00006884' TO DFHEIV0
  7304     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7306     MOVE X'2020233030303036383834' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0,
  7308           WS-ERNOTE-FILE-ID,
  7309           DFHEIV99
  7310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7311       ELSE
  7312         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7313           (NOTE-SUB > +10) OR
  7314           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7315         END-PERFORM
  7316         IF (NOTE-SUB < +11)
  7317           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7318              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7319                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7320           ELSE
  7321             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7322              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7323                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7324                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7325             ELSE
  7326               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7327                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7328                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7329                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7330               ELSE
  7331                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7332                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7333                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7334                                       CN-BILLING-START-LINE-NO
  7335                 ELSE
  7336                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7337                 END-IF
  7338               END-IF
  7339             END-IF
  7340           END-IF
  7341           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7342           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7343           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7344
  7345* EXEC CICS REWRITE
  7346*             DATASET    (WS-ERNOTE-FILE-ID)
  7347*             FROM       (CERTIFICATE-NOTE)
  7348*             RESP       (WS-RESPONSE)
  7349*          END-EXEC
  7350     MOVE LENGTH OF
  7351      CERTIFICATE-NOTE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 129
* EL6317.cbl
  7352       TO DFHEIV11
  7353*    MOVE '&& L                  %  N#00006920' TO DFHEIV0
  7354     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7355     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7356     MOVE X'204E233030303036393230' TO DFHEIV0(25:11)
  7357     CALL 'kxdfhei1' USING DFHEIV0,
  7358           WS-ERNOTE-FILE-ID,
  7359           CERTIFICATE-NOTE,
  7360           DFHEIV11,
  7361           DFHEIV99
  7362     MOVE EIBRESP  TO WS-RESPONSE
  7363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7364           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7365         END-IF
  7366       END-IF
  7367     ELSE
  7368        MOVE SPACES              TO CERTIFICATE-NOTE
  7369        MOVE 'CN'                TO CN-RECORD-ID
  7370        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7371                                     WS-ERNOTE-KEY
  7372        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7373                                    CN-BILLING-END-LINE-NO
  7374        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7375        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7376        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7377        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7378
  7379* EXEC CICS WRITE
  7380*          DATASET    (WS-ERNOTE-FILE-ID)
  7381*          FROM       (CERTIFICATE-NOTE)
  7382*          RIDFLD     (WS-ERNOTE-KEY)
  7383*          RESP       (WS-RESPONSE)
  7384*       END-EXEC
  7385     MOVE LENGTH OF
  7386      CERTIFICATE-NOTE
  7387       TO DFHEIV11
  7388*    MOVE '&$ L                  ''  N#00006939' TO DFHEIV0
  7389     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7391     MOVE X'204E233030303036393339' TO DFHEIV0(25:11)
  7392     CALL 'kxdfhei1' USING DFHEIV0,
  7393           WS-ERNOTE-FILE-ID,
  7394           CERTIFICATE-NOTE,
  7395           DFHEIV11,
  7396           WS-ERNOTE-KEY,
  7397           DFHEIV99,
  7398           DFHEIV99
  7399     MOVE EIBRESP  TO WS-RESPONSE
  7400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7401
  7402        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7403     END-IF
  7404
  7405     .
  7406 0441-EXIT.
  7407     EXIT.
  7408
  7409
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 130
* EL6317.cbl
  7410 0442-SQUEEZE-IT-IN.
  7411
  7412     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7413        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7414           NOTE-SUB = +10
  7415           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7416           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7417             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7418             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7419             MOVE +9 TO NOTE-SUB
  7420           END-IF
  7421        END-PERFORM
  7422     ELSE
  7423        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7424           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7425             UNTIL NOTE-SUB = +1
  7426             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7427             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7428                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7429                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7430                MOVE +2          TO NOTE-SUB
  7431             END-IF
  7432           END-PERFORM
  7433        END-IF
  7434     END-IF
  7435
  7436     .
  7437 0442-EXIT.
  7438     EXIT.
  7439
  7440 0445-CERTIFICATE-UPDATE.
  7441    display 'billing note written, updating cert'
  7442     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7443     IF RESP-NORMAL
  7444        EVALUATE CM-NOTE-SW
  7445           WHEN '2'
  7446           WHEN '3'
  7447           WHEN '6'
  7448           WHEN '7'
  7449              SET NO-CERT-RW     TO TRUE
  7450           WHEN ' '
  7451              MOVE '2'           TO CM-NOTE-SW
  7452           WHEN '1'
  7453              MOVE '3'           TO CM-NOTE-SW
  7454           WHEN '4'
  7455              MOVE '6'           TO CM-NOTE-SW
  7456           WHEN '5'
  7457              MOVE '7'           TO CM-NOTE-SW
  7458        END-EVALUATE
  7459     END-IF
  7460     IF NOT NO-CERT-RW
  7461        PERFORM 1810-REWRITE-ELCERT
  7462                                 THRU 1810-EXIT
  7463     ELSE
  7464
  7465* EXEC CICS UNLOCK
  7466*          DATASET    (WS-ELCERT-FILE-ID)
  7467*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 131
* EL6317.cbl
  7468*    MOVE '&*                    #   #00007008' TO DFHEIV0
  7469     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7470     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7471     MOVE X'2020233030303037303038' TO DFHEIV0(25:11)
  7472     CALL 'kxdfhei1' USING DFHEIV0,
  7473           WS-ELCERT-FILE-ID,
  7474           DFHEIV99
  7475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7476     END-IF
  7477
  7478     .
  7479 0445-EXIT.
  7480     EXIT.
  7481
  7482 0500-CREATE-TEMP-STORAGE.
  7483     display ' about to write pi ' program-interface-block
  7484
  7485* EXEC CICS WRITEQ TS
  7486*        QUEUE (QID)
  7487*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7488*        LENGTH(PI-COMM-LENGTH)
  7489*    END-EXEC
  7490*    MOVE '*"     L              ''   #00007019' TO DFHEIV0
  7491     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7493     MOVE X'2020233030303037303139' TO DFHEIV0(25:11)
  7494     CALL 'kxdfhei1' USING DFHEIV0,
  7495           QID,
  7496           PROGRAM-INTERFACE-BLOCK,
  7497           PI-COMM-LENGTH,
  7498           DFHEIV99,
  7499           DFHEIV99,
  7500           DFHEIV99
  7501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7502     display ' about to write map ' el631ji
  7503
  7504* EXEC CICS WRITEQ TS
  7505*        QUEUE (QID)
  7506*        FROM  (EL631JI)
  7507*        LENGTH(MAP-LENGTH)
  7508*    END-EXEC.
  7509*    MOVE '*"     L              ''   #00007025' TO DFHEIV0
  7510     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7511     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7512     MOVE X'2020233030303037303235' TO DFHEIV0(25:11)
  7513     CALL 'kxdfhei1' USING DFHEIV0,
  7514           QID,
  7515           EL631JI,
  7516           MAP-LENGTH,
  7517           DFHEIV99,
  7518           DFHEIV99,
  7519           DFHEIV99
  7520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7521
  7522 0500-EXIT.
  7523      EXIT.
  7524 0600-RECOVER-TEMP-STORAGE.
  7525     display ' about to recover pi '
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 132
* EL6317.cbl
  7526
  7527* EXEC CICS READQ TS
  7528*        QUEUE (QID)
  7529*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7530*        LENGTH(PI-COMM-LENGTH)
  7531*    END-EXEC
  7532*    MOVE '*$I    L              ''   #00007034' TO DFHEIV0
  7533     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7535     MOVE X'2020233030303037303334' TO DFHEIV0(25:11)
  7536     CALL 'kxdfhei1' USING DFHEIV0,
  7537           QID,
  7538           PROGRAM-INTERFACE-BLOCK,
  7539           PI-COMM-LENGTH,
  7540           DFHEIV99,
  7541           DFHEIV99,
  7542           DFHEIV99
  7543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7544     display ' pi ' pi-program-work-area
  7545     display ' about to recover map '
  7546
  7547* EXEC CICS READQ TS
  7548*        QUEUE (QID)
  7549*        INTO  (EL631JI)
  7550*        LENGTH(MAP-LENGTH)
  7551*    END-EXEC
  7552*    MOVE '*$I    L              ''   #00007041' TO DFHEIV0
  7553     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7554     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7555     MOVE X'2020233030303037303431' TO DFHEIV0(25:11)
  7556     CALL 'kxdfhei1' USING DFHEIV0,
  7557           QID,
  7558           EL631JI,
  7559           MAP-LENGTH,
  7560           DFHEIV99,
  7561           DFHEIV99,
  7562           DFHEIV99
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7564     display ' map ' el631ji
  7565     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7566     MOVE AL-UANON            TO SIGREQA
  7567     MOVE AL-UANON            TO LTRIDA
  7568     IF WS-SET-CODES-MDT = 'Y'
  7569        move +1                  to s2
  7570        perform varying s1 from +1 by +5 until s1 > +60
  7571           MOVE WS-PASSED-REASON-CODES (s1:4)
  7572                                 TO reacd-in (s2)
  7573           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7574               MOVE AL-SANON     TO REACDA (S2)
  7575               MOVE +4           TO REACDL (S2)
  7576           END-IF
  7577           add +1                to s2
  7578        end-perform
  7579        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7580     END-IF
  7581
  7582     IF ENCCODEI > SPACES
  7583         MOVE AL-UANON       TO ENCCODEA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 133
* EL6317.cbl
  7584     END-IF
  7585
  7586     IF CRTNT1I > SPACES
  7587         MOVE AL-UANON       TO CRTNT1A
  7588     END-IF
  7589
  7590     IF CRTNT2I > SPACES
  7591         MOVE AL-UANON       TO CRTNT2A
  7592     END-IF
  7593
  7594     IF BILNT1I > SPACES
  7595         MOVE AL-UANON       TO BILNT1A
  7596     END-IF
  7597     .
  7598 0600-EXIT.
  7599      EXIT.
  7600 0800-DELETE-TS.
  7601
  7602* EXEC CICS DELETEQ TS
  7603*        QUEUE(QID)
  7604*    END-EXEC
  7605*    MOVE '*&                    #   #00007083' TO DFHEIV0
  7606     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7607     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7608     MOVE X'2020233030303037303833' TO DFHEIV0(25:11)
  7609     CALL 'kxdfhei1' USING DFHEIV0,
  7610           QID,
  7611           DFHEIV99
  7612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7613     .
  7614 0800-EXIT.
  7615      EXIT.
  7616 1000-BUILD-ERARCH.
  7617     display ' made it to 1000 '
  7618     MOVE SPACES                 TO W-CNTL-KEY
  7619     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7620     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7621     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7622
  7623* EXEC CICS READ
  7624*         DATASET    (WS-ELCNTL-FILE-ID)
  7625*         SET        (ADDRESS OF CONTROL-FILE)
  7626*         RIDFLD     (W-CNTL-KEY)
  7627*         UPDATE
  7628*         RESP       (WS-RESPONSE)
  7629*    END-EXEC
  7630*    MOVE '&"S        EU         (  N#00007095' TO DFHEIV0
  7631     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7632     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7633     MOVE X'204E233030303037303935' TO DFHEIV0(25:11)
  7634     CALL 'kxdfhei1' USING DFHEIV0,
  7635           WS-ELCNTL-FILE-ID,
  7636           DFHEIV20,
  7637           DFHEIV99,
  7638           W-CNTL-KEY,
  7639           DFHEIV99,
  7640           DFHEIV99,
  7641           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 134
* EL6317.cbl
  7642     SET ADDRESS OF CONTROL-FILE TO
  7643         DFHEIV20
  7644     MOVE EIBRESP  TO WS-RESPONSE
  7645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7646     IF RESP-NORMAL
  7647        display ' good read elcntl '
  7648        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7649           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7650        END-IF
  7651        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7652        MOVE CF-CREDIT-LAST-ARCH-NUM
  7653                                 TO W-ARCH-NUMBER
  7654
  7655* EXEC CICS REWRITE
  7656*          FROM      (CONTROL-FILE)
  7657*          DATASET   (WS-ELCNTL-FILE-ID)
  7658*       END-EXEC
  7659     MOVE LENGTH OF
  7660      CONTROL-FILE
  7661       TO DFHEIV11
  7662*    MOVE '&& L                  %   #00007110' TO DFHEIV0
  7663     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7664     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7665     MOVE X'2020233030303037313130' TO DFHEIV0(25:11)
  7666     CALL 'kxdfhei1' USING DFHEIV0,
  7667           WS-ELCNTL-FILE-ID,
  7668           CONTROL-FILE,
  7669           DFHEIV11,
  7670           DFHEIV99
  7671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7672     END-IF
  7673
  7674* EXEC CICS GETMAIN
  7675*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7676*       LENGTH   (W-ARCH-LENGTH)
  7677*    END-EXEC
  7678*    MOVE '," L                  $   #00007115' TO DFHEIV0
  7679     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7680     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7681     MOVE X'2020233030303037313135' TO DFHEIV0(25:11)
  7682     CALL 'kxdfhei1' USING DFHEIV0,
  7683           DFHEIV20,
  7684           W-ARCH-LENGTH,
  7685           DFHEIV99
  7686     SET ADDRESS OF LETTER-ARCHIVE TO
  7687         DFHEIV20
  7688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7689     MOVE 'LA'                   TO LETTER-ARCHIVE
  7690     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7691                                    LA-ARCHIVE-NO-A2
  7692                                    LA-ARCHIVE-NO-A3
  7693                                    LA-ARCHIVE-NO-A4
  7694                                    LA-ARCHIVE-NO-A5
  7695                                    LA-ARCHIVE-NO-A6
  7696     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7697                                    LA-COMPANY-CD-A2
  7698                                    LA-COMPANY-CD-A3
  7699                                    LA-COMPANY-CD-A4
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 135
* EL6317.cbl
  7700                                    LA-COMPANY-CD-A5
  7701                                    LA-COMPANY-CD-A6
  7702     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7703                                    LA-CARRIER-A3
  7704                                    LA-CARRIER-A4
  7705                                    LA-CARRIER-A5
  7706     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7707     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7708                                    LA-GROUPING-A3
  7709                                    LA-GROUPING-A4
  7710                                    LA-GROUPING-A5
  7711     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7712                                    LA-ACCOUNT-A3
  7713                                    LA-ACCOUNT-A4
  7714                                    LA-ACCOUNT-A5
  7715     MOVE PB-STATE               TO LA-STATE-A2
  7716                                    LA-STATE-A3
  7717                                    LA-STATE-A4
  7718                                    LA-STATE-A5
  7719     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7720     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7721     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7722     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7723     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7724                                    LA-INITIAL-PRINT-DATE
  7725                                    LA-SENT-DATE
  7726                                    LA-REPLY-DATE
  7727                                    LA-RESEND-DATE
  7728                                    LA-FOLLOW-UP-DATE
  7729     MOVE 'A'                    TO LA-STATUS
  7730     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7731     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7732     MOVE LTRIDI                 TO LA-FORM-A3
  7733     MOVE '4'                    TO LA-DATA-SOURCE
  7734     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7735     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7736                                    LA-NO-OF-TEXT-RECORDS
  7737
  7738* EXEC CICS WRITE
  7739*         DATASET   ('ERARCH')
  7740*         FROM      (LETTER-ARCHIVE)
  7741*         RIDFLD    (LA-CONTROL-PRIMARY)
  7742*         RESP      (WS-RESPONSE)
  7743*    END-EXEC
  7744     MOVE LENGTH OF
  7745      LETTER-ARCHIVE
  7746       TO DFHEIV11
  7747     MOVE 'ERARCH' TO DFHEIV1
  7748*    MOVE '&$ L                  ''  N#00007167' TO DFHEIV0
  7749     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7751     MOVE X'204E233030303037313637' TO DFHEIV0(25:11)
  7752     CALL 'kxdfhei1' USING DFHEIV0,
  7753           DFHEIV1,
  7754           LETTER-ARCHIVE,
  7755           DFHEIV11,
  7756           LA-CONTROL-PRIMARY,
  7757           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 136
* EL6317.cbl
  7758           DFHEIV99
  7759     MOVE EIBRESP  TO WS-RESPONSE
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7761     IF RESP-NORMAL
  7762        display ' good write erarch '
  7763        MOVE ER-0280             TO EMI-ERROR
  7764        MOVE -1                  TO SIGREQL
  7765        PERFORM 9900-ERROR-FORMAT
  7766                                 THRU 9900-EXIT
  7767        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7768        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7769     ELSE
  7770        MOVE ER-7345             TO EMI-ERROR
  7771        MOVE -1                  TO SIGREQL
  7772        PERFORM 9900-ERROR-FORMAT
  7773                                 THRU 9900-EXIT
  7774     END-IF
  7775     .
  7776 1000-EXIT.
  7777     EXIT.
  7778 1100-CALL-NS-BUS-LOGIC.
  7779     DISPLAY ' MADE IT TO 1100 '
  7780     MOVE SPACES                 TO BL-INPUT
  7781     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7782     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  7783       OR 'EL6314'
  7784         MOVE '2'                TO BL-DATA-SRCE
  7785         MOVE SPACES             TO BL-BATCH-NO
  7786         MOVE ZEROS              TO BL-BATCH-SEQ
  7787     ELSE
  7788         MOVE '4'                TO BL-DATA-SRCE
  7789         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  7790         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  7791     END-IF
  7792     MOVE PI-CARRIER             TO BL-CARRIER
  7793     MOVE PI-GROUPING            TO BL-GROUP
  7794     MOVE PI-STATE               TO BL-STATE
  7795     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  7796     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  7797        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  7798        MOVE ' '                 TO DC-OPTION-CODE
  7799        PERFORM 9700-date-link
  7800        IF NO-CONVERSION-ERROR
  7801           MOVE DC-GREG-DATE-1-EDIT
  7802                                 TO BL-EFF-DT
  7803        END-IF
  7804     END-IF
  7805     MOVE PI-CERT-NO             TO BL-CERT-NO
  7806     MOVE SPACES                 TO BL-RESP-NO
  7807     MOVE LTRIDI                 TO BL-LETTER-ID
  7808     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7809     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7810     MOVE 'CrtVerif'               TO BL-FUNC
  7811*    MOVE 'ALWA'                 TO BL-PROC-ID
  7812     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7813*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7814*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7815     MOVE PI-ENCCODE             TO BL-ENC-CD
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 137
* EL6317.cbl
  7816     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7817     MOVE 'VERIFY  '             TO BL-SOURCE-SCREEN
  7818     IF EIBAID = DFHPF4
  7819        MOVE 'B'                 TO BL-WRITE-ERARCH
  7820     ELSE
  7821        MOVE 'T'                 TO BL-WRITE-ERARCH
  7822     END-IF
  7823     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7824        MOVE REACD-IN (S1)       TO BL-REASON-CODE (S1)
  7825     END-PERFORM
  7826    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7827*****************************************
  7828* Invoke the LETTER business logic
  7829*****************************************
  7830
  7831* exec cics link
  7832*       program('NSRASBL')
  7833*       commarea(srch-commarea)
  7834*    end-exec.
  7835     MOVE LENGTH OF
  7836      srch-commarea
  7837       TO DFHEIV11
  7838     MOVE 'NSRASBL' TO DFHEIV1
  7839*    MOVE '."C                   (   #00007242' TO DFHEIV0
  7840     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7842     MOVE X'2020233030303037323432' TO DFHEIV0(25:11)
  7843     CALL 'kxdfhei1' USING DFHEIV0,
  7844           DFHEIV1,
  7845           srch-commarea,
  7846           DFHEIV11,
  7847           DFHEIV99,
  7848           DFHEIV99,
  7849           DFHEIV99,
  7850           DFHEIV99
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7852
  7853     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7854        BL-MESSAGE
  7855     .
  7856 1100-EXIT.
  7857     EXIT.
  7858 1500-GET-ARCH-NO.
  7859     display ' made it to 1500 '
  7860     MOVE SPACES                 TO ELCNTL-KEY
  7861     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7862     MOVE '1'                    TO CNTL-REC-TYPE
  7863     MOVE ZEROS                  TO CNTL-SEQ
  7864
  7865* EXEC CICS READ
  7866*         DATASET    (WS-ELCNTL-FILE-ID)
  7867*         SET        (ADDRESS OF CONTROL-FILE)
  7868*         RIDFLD     (ELCNTL-KEY)
  7869*         UPDATE
  7870*         RESP       (WS-RESPONSE)
  7871*    END-EXEC
  7872*    MOVE '&"S        EU         (  N#00007257' TO DFHEIV0
  7873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 138
* EL6317.cbl
  7874     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7875     MOVE X'204E233030303037323537' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           WS-ELCNTL-FILE-ID,
  7878           DFHEIV20,
  7879           DFHEIV99,
  7880           ELCNTL-KEY,
  7881           DFHEIV99,
  7882           DFHEIV99,
  7883           DFHEIV99
  7884     SET ADDRESS OF CONTROL-FILE TO
  7885         DFHEIV20
  7886     MOVE EIBRESP  TO WS-RESPONSE
  7887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7888     IF RESP-NORMAL
  7889        display ' good read elcntl '
  7890        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7891           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7892        END-IF
  7893        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7894        MOVE CF-CREDIT-LAST-ARCH-NUM
  7895                                 TO W-ARCH-NUMBER
  7896        display ' new arch number ' w-arch-number
  7897
  7898* EXEC CICS REWRITE
  7899*          FROM      (CONTROL-FILE)
  7900*          DATASET   (WS-ELCNTL-FILE-ID)
  7901*       END-EXEC
  7902     MOVE LENGTH OF
  7903      CONTROL-FILE
  7904       TO DFHEIV11
  7905*    MOVE '&& L                  %   #00007273' TO DFHEIV0
  7906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7908     MOVE X'2020233030303037323733' TO DFHEIV0(25:11)
  7909     CALL 'kxdfhei1' USING DFHEIV0,
  7910           WS-ELCNTL-FILE-ID,
  7911           CONTROL-FILE,
  7912           DFHEIV11,
  7913           DFHEIV99
  7914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7915     END-IF
  7916     .
  7917 1500-EXIT.
  7918     EXIT.
  7919
  7920
  7921 1700-WRITE-CERT-NOTE      SECTION.
  7922
  7923
  7924     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7925     MOVE ZERO           TO ERCNOT-SEQ.
  7926     SET TB-INDX         DOWN BY 1.
  7927     SET TB-INDX1        TO TB-INDX.
  7928
  7929****DELETE CURRENT CERT NOTES
  7930 1700-LOOP.
  7931
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 139
* EL6317.cbl
  7932* EXEC CICS READ
  7933*        DATASET (WS-ERCNOT-FILE-ID)
  7934*        RIDFLD  (ERCNOT-KEY)
  7935*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7936*        RESP    (WS-RESPONSE)
  7937*        GTEQ
  7938*    END-EXEC.
  7939*    MOVE '&"S        G          (  N#00007293' TO DFHEIV0
  7940     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7942     MOVE X'204E233030303037323933' TO DFHEIV0(25:11)
  7943     CALL 'kxdfhei1' USING DFHEIV0,
  7944           WS-ERCNOT-FILE-ID,
  7945           DFHEIV20,
  7946           DFHEIV99,
  7947           ERCNOT-KEY,
  7948           DFHEIV99,
  7949           DFHEIV99,
  7950           DFHEIV99
  7951     SET ADDRESS OF CERT-NOTE-FILE TO
  7952         DFHEIV20
  7953     MOVE EIBRESP  TO WS-RESPONSE
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7955
  7956
  7957     IF NOT RESP-NORMAL
  7958        GO TO 1700-ENDDEL
  7959     END-IF
  7960
  7961     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7962
  7963     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7964         GO TO 1700-ENDDEL
  7965     END-IF.
  7966
  7967
  7968* EXEC CICS DELETE
  7969*        DATASET (WS-ERCNOT-FILE-ID)
  7970*        RIDFLD  (ERCNOT-KEY)
  7971*    END-EXEC.
  7972*    MOVE '&(  R                 &   #00007311' TO DFHEIV0
  7973     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7974     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7975     MOVE X'2020233030303037333131' TO DFHEIV0(25:11)
  7976     CALL 'kxdfhei1' USING DFHEIV0,
  7977           WS-ERCNOT-FILE-ID,
  7978           ERCNOT-KEY,
  7979           DFHEIV99,
  7980           DFHEIV99,
  7981           DFHEIV99
  7982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7983
  7984
  7985     GO TO 1700-LOOP.
  7986
  7987 1700-ENDDEL.
  7988
  7989
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 140
* EL6317.cbl
  7990* EXEC CICS GETMAIN
  7991*         LENGTH(ERCNOT-LENGTH)
  7992*         SET(ADDRESS OF CERT-NOTE-FILE)
  7993*         INITIMG(GETMAIN-SPACE)
  7994*    END-EXEC.
  7995*    MOVE ',"IL                  $   #00007320' TO DFHEIV0
  7996     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7998     MOVE X'2020233030303037333230' TO DFHEIV0(25:11)
  7999     CALL 'kxdfhei1' USING DFHEIV0,
  8000           DFHEIV20,
  8001           ERCNOT-LENGTH,
  8002           GETMAIN-SPACE
  8003     SET ADDRESS OF CERT-NOTE-FILE TO
  8004         DFHEIV20
  8005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8006
  8007
  8008     SET TB-INDX TO 1.
  8009     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8010     MOVE +0             TO ERCNOT-SEQ
  8011
  8012     PERFORM VARYING TB-INDX FROM 1 BY 1
  8013             UNTIL TB-INDX > TB-INDX1
  8014        MOVE SPACES                 TO  CERT-NOTE-FILE
  8015        ADD 1                       TO  ERCNOT-SEQ
  8016        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8017        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8018        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8019        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8020                                    TO  CZ-LAST-MAINT-USER
  8021        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8022                                    TO  CZ-LAST-MAINT-HHMMSS
  8023        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8024                                    TO  CZ-LAST-MAINT-DT
  8025
  8026
  8027* EXEC CICS WRITE
  8028*            DATASET(WS-ERCNOT-FILE-ID)
  8029*            FROM(CERT-NOTE-FILE)
  8030*            RIDFLD(ERCNOT-KEY)
  8031*       END-EXEC
  8032     MOVE LENGTH OF
  8033      CERT-NOTE-FILE
  8034       TO DFHEIV11
  8035*    MOVE '&$ L                  ''   #00007344' TO DFHEIV0
  8036     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8037     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8038     MOVE X'2020233030303037333434' TO DFHEIV0(25:11)
  8039     CALL 'kxdfhei1' USING DFHEIV0,
  8040           WS-ERCNOT-FILE-ID,
  8041           CERT-NOTE-FILE,
  8042           DFHEIV11,
  8043           ERCNOT-KEY,
  8044           DFHEIV99,
  8045           DFHEIV99
  8046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8047     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 141
* EL6317.cbl
  8048
  8049     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8050     IF RESP-NORMAL
  8051        EVALUATE CM-NOTE-SW
  8052           WHEN '1'
  8053           WHEN '3'
  8054           WHEN '5'
  8055           WHEN '7'
  8056              SET NO-CERT-RW     TO TRUE
  8057           WHEN ' '
  8058              MOVE '1'           TO CM-NOTE-SW
  8059           WHEN '2'
  8060              MOVE '3'           TO CM-NOTE-SW
  8061           WHEN '4'
  8062              MOVE '5'           TO CM-NOTE-SW
  8063           WHEN '6'
  8064              MOVE '7'           TO CM-NOTE-SW
  8065        END-EVALUATE
  8066     END-IF
  8067     IF NOT NO-CERT-RW
  8068        PERFORM 1810-REWRITE-ELCERT
  8069                                 THRU 1810-EXIT
  8070     ELSE
  8071
  8072* EXEC CICS UNLOCK
  8073*          DATASET    (WS-ELCERT-FILE-ID)
  8074*       END-EXEC
  8075*    MOVE '&*                    #   #00007373' TO DFHEIV0
  8076     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8077     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8078     MOVE X'2020233030303037333733' TO DFHEIV0(25:11)
  8079     CALL 'kxdfhei1' USING DFHEIV0,
  8080           WS-ELCERT-FILE-ID,
  8081           DFHEIV99
  8082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8083     END-IF
  8084
  8085     .
  8086 1799-EXIT.
  8087     EXIT.
  8088
  8089 1800-READ-ELCERT-UPDATE.
  8090
  8091     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8092     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8093     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8094     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8095     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8096     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8097     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8098     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8099
  8100
  8101* EXEC CICS READ
  8102*        UPDATE
  8103*        DATASET  (WS-ELCERT-FILE-ID)
  8104*        RIDFLD   (WS-ELCERT-KEY)
  8105*        SET      (ADDRESS OF CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 142
* EL6317.cbl
  8106*        RESP     (WS-RESPONSE)
  8107*    END-EXEC
  8108*    MOVE '&"S        EU         (  N#00007393' TO DFHEIV0
  8109     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8110     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8111     MOVE X'204E233030303037333933' TO DFHEIV0(25:11)
  8112     CALL 'kxdfhei1' USING DFHEIV0,
  8113           WS-ELCERT-FILE-ID,
  8114           DFHEIV20,
  8115           DFHEIV99,
  8116           WS-ELCERT-KEY,
  8117           DFHEIV99,
  8118           DFHEIV99,
  8119           DFHEIV99
  8120     SET ADDRESS OF CERTIFICATE-MASTER TO
  8121         DFHEIV20
  8122     MOVE EIBRESP  TO WS-RESPONSE
  8123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8124
  8125     .
  8126 1800-EXIT.
  8127     EXIT.
  8128
  8129 1810-REWRITE-ELCERT.
  8130
  8131
  8132* EXEC CICS REWRITE
  8133*        FROM     (CERTIFICATE-MASTER)
  8134*        DATASET  (WS-ELCERT-FILE-ID)
  8135*        RESP     (WS-RESPONSE)
  8136*    END-EXEC.
  8137     MOVE LENGTH OF
  8138      CERTIFICATE-MASTER
  8139       TO DFHEIV11
  8140*    MOVE '&& L                  %  N#00007407' TO DFHEIV0
  8141     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8142     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8143     MOVE X'204E233030303037343037' TO DFHEIV0(25:11)
  8144     CALL 'kxdfhei1' USING DFHEIV0,
  8145           WS-ELCERT-FILE-ID,
  8146           CERTIFICATE-MASTER,
  8147           DFHEIV11,
  8148           DFHEIV99
  8149     MOVE EIBRESP  TO WS-RESPONSE
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8151
  8152
  8153     .
  8154 1810-EXIT.
  8155     EXIT.
  8156
  8157 8100-SEND-INITIAL-MAP.
  8158     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8159     MOVE '5'                    TO DC-OPTION-CODE.
  8160     PERFORM 9700-DATE-LINK.
  8161     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8162     MOVE EIBTIME                TO TIME-IN.
  8163     MOVE TIME-OUT               TO TIMEO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 143
* EL6317.cbl
  8164     MOVE -1                     TO SIGREQL.
  8165     IF PI-PROCESSOR-IS-CSR-SUPER
  8166        perform varying s1 from +1 by +1 until
  8167           s1 > +12
  8168           MOVE AL-UANON            TO reacda (s1)
  8169        end-perform
  8170     END-IF
  8171     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8172     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8173
  8174* EXEC CICS SEND
  8175*        MAP      (MAP-NAME)
  8176*        MAPSET   (MAPSET-NAME)
  8177*        FROM     (EL631JO)
  8178*        ERASE
  8179*        CURSOR
  8180*    END-EXEC.
  8181     MOVE LENGTH OF
  8182      EL631JO
  8183       TO DFHEIV12
  8184     MOVE -1
  8185       TO DFHEIV11
  8186*    MOVE '8$     CT  E    H L F ,   #00007433' TO DFHEIV0
  8187     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8188     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8189     MOVE X'2020233030303037343333' TO DFHEIV0(25:11)
  8190     CALL 'kxdfhei1' USING DFHEIV0,
  8191           MAP-NAME,
  8192           EL631JO,
  8193           DFHEIV12,
  8194           MAPSET-NAME,
  8195           DFHEIV99,
  8196           DFHEIV99,
  8197           DFHEIV99,
  8198           DFHEIV11,
  8199           DFHEIV99,
  8200           DFHEIV99,
  8201           DFHEIV99
  8202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8203
  8204     GO TO 9100-RETURN-TRAN.
  8205 8200-SEND-DATAONLY.
  8206     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8207     MOVE '5'                    TO DC-OPTION-CODE.
  8208     PERFORM 9700-DATE-LINK.
  8209     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8210     MOVE EIBTIME                TO TIME-IN.
  8211     MOVE TIME-OUT               TO TIMEO.
  8212     MOVE -1                     TO PFENTRL
  8213     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8214     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8215
  8216* EXEC CICS SEND
  8217*        MAP      (MAP-NAME)
  8218*        MAPSET   (MAPSET-NAME)
  8219*        FROM     (EL631JO)
  8220*        DATAONLY
  8221*        ERASEAUP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 144
* EL6317.cbl
  8222*        CURSOR
  8223*    END-EXEC.
  8224     MOVE LENGTH OF
  8225      EL631JO
  8226       TO DFHEIV12
  8227     MOVE -1
  8228       TO DFHEIV11
  8229*    MOVE '8$D    CT  A    H L F ,   #00007451' TO DFHEIV0
  8230     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8231     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8232     MOVE X'2020233030303037343531' TO DFHEIV0(25:11)
  8233     CALL 'kxdfhei1' USING DFHEIV0,
  8234           MAP-NAME,
  8235           EL631JO,
  8236           DFHEIV12,
  8237           MAPSET-NAME,
  8238           DFHEIV99,
  8239           DFHEIV99,
  8240           DFHEIV99,
  8241           DFHEIV11,
  8242           DFHEIV99,
  8243           DFHEIV99,
  8244           DFHEIV99
  8245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8246
  8247     GO TO 9100-RETURN-TRAN.
  8248 8300-SEND-TEXT.
  8249
  8250* EXEC CICS SEND TEXT
  8251*        FROM     (LOGOFF-TEXT)
  8252*        LENGTH   (LOGOFF-LENGTH)
  8253*        ERASE
  8254*        FREEKB
  8255*    END-EXEC.
  8256*    MOVE '8&      T  E F  H   F -   #00007461' TO DFHEIV0
  8257     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8258     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8259     MOVE X'2020233030303037343631' TO DFHEIV0(25:11)
  8260     CALL 'kxdfhei1' USING DFHEIV0,
  8261           LOGOFF-TEXT,
  8262           LOGOFF-LENGTH,
  8263           DFHEIV99,
  8264           DFHEIV99,
  8265           DFHEIV99,
  8266           DFHEIV99,
  8267           DFHEIV99,
  8268           DFHEIV99,
  8269           DFHEIV99,
  8270           DFHEIV99,
  8271           DFHEIV99,
  8272           DFHEIV99
  8273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8274
  8275
  8276* EXEC CICS RETURN
  8277*    END-EXEC.
  8278*    MOVE '.(                    ''   #00007467' TO DFHEIV0
  8279     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 145
* EL6317.cbl
  8280     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8281     MOVE X'2020233030303037343637' TO DFHEIV0(25:11)
  8282     CALL 'kxdfhei1' USING DFHEIV0,
  8283           DFHEIV99,
  8284           DFHEIV99,
  8285           DFHEIV99,
  8286           DFHEIV99,
  8287           DFHEIV99,
  8288           DFHEIV99
  8289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8290
  8291 8800-UNAUTHORIZED-ACCESS.
  8292     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8293     GO TO 8300-SEND-TEXT.
  8294 8810-PF23.
  8295     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8296     MOVE XCTL-005               TO PGM-NAME.
  8297     GO TO 9300-XCTL.
  8298 9000-RETURN-CICS.
  8299
  8300* EXEC CICS RETURN
  8301*    END-EXEC.
  8302*    MOVE '.(                    ''   #00007477' TO DFHEIV0
  8303     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8305     MOVE X'2020233030303037343737' TO DFHEIV0(25:11)
  8306     CALL 'kxdfhei1' USING DFHEIV0,
  8307           DFHEIV99,
  8308           DFHEIV99,
  8309           DFHEIV99,
  8310           DFHEIV99,
  8311           DFHEIV99,
  8312           DFHEIV99
  8313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8314
  8315 9100-RETURN-TRAN.
  8316     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8317     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8318
  8319* EXEC CICS RETURN
  8320*        TRANSID    (TRANS-ID)
  8321*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8322*        LENGTH     (PI-COMM-LENGTH)
  8323*    END-EXEC.
  8324*    MOVE '.(CT                  ''   #00007482' TO DFHEIV0
  8325     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8327     MOVE X'2020233030303037343832' TO DFHEIV0(25:11)
  8328     CALL 'kxdfhei1' USING DFHEIV0,
  8329           TRANS-ID,
  8330           PROGRAM-INTERFACE-BLOCK,
  8331           PI-COMM-LENGTH,
  8332           DFHEIV99,
  8333           DFHEIV99,
  8334           DFHEIV99
  8335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8336
  8337 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 146
* EL6317.cbl
  8338     MOVE XCTL-626               TO PGM-NAME.
  8339     GO TO 9300-XCTL.
  8340 9300-XCTL.
  8341
  8342* EXEC CICS XCTL
  8343*        PROGRAM    (PGM-NAME)
  8344*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8345*        LENGTH     (PI-COMM-LENGTH)
  8346*    END-EXEC.
  8347*    MOVE '.$C                   %   #00007491' TO DFHEIV0
  8348     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8349     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8350     MOVE X'2020233030303037343931' TO DFHEIV0(25:11)
  8351     CALL 'kxdfhei1' USING DFHEIV0,
  8352           PGM-NAME,
  8353           PROGRAM-INTERFACE-BLOCK,
  8354           PI-COMM-LENGTH,
  8355           DFHEIV99
  8356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8357
  8358 9400-CLEAR.
  8359     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8360
  8361* EXEC CICS XCTL
  8362*        PROGRAM    (PGM-NAME)
  8363*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8364*        LENGTH     (PI-COMM-LENGTH)
  8365*    END-EXEC.
  8366*    MOVE '.$C                   %   #00007498' TO DFHEIV0
  8367     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8368     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8369     MOVE X'2020233030303037343938' TO DFHEIV0(25:11)
  8370     CALL 'kxdfhei1' USING DFHEIV0,
  8371           PGM-NAME,
  8372           PROGRAM-INTERFACE-BLOCK,
  8373           PI-COMM-LENGTH,
  8374           DFHEIV99
  8375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8376
  8377 9500-PF12.
  8378     MOVE XCTL-010               TO PGM-NAME.
  8379     GO TO 9300-XCTL.
  8380 9600-PGMID-ERROR.
  8381
  8382* EXEC CICS HANDLE CONDITION
  8383*        PGMIDERR    (8300-SEND-TEXT)
  8384*    END-EXEC.
  8385*    MOVE '"$L                   ! " #00007507' TO DFHEIV0
  8386     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8388     MOVE X'2220233030303037353037' TO DFHEIV0(25:11)
  8389     CALL 'kxdfhei1' USING DFHEIV0
  8390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8391
  8392     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8393     MOVE ' '                    TO PI-ENTRY-CD-1.
  8394     MOVE XCTL-005               TO PGM-NAME.
  8395     MOVE PGM-NAME               TO LOGOFF-PGM.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 147
* EL6317.cbl
  8396     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8397     GO TO 9300-XCTL.
  8398 9700-DATE-LINK.
  8399     MOVE LINK-ELDATCV           TO PGM-NAME.
  8400
  8401* EXEC CICS LINK
  8402*        PROGRAM    (PGM-NAME)
  8403*        COMMAREA   (DATE-CONVERSION-DATA)
  8404*        LENGTH     (DC-COMM-LENGTH)
  8405*    END-EXEC.
  8406*    MOVE '."C                   (   #00007518' TO DFHEIV0
  8407     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8409     MOVE X'2020233030303037353138' TO DFHEIV0(25:11)
  8410     CALL 'kxdfhei1' USING DFHEIV0,
  8411           PGM-NAME,
  8412           DATE-CONVERSION-DATA,
  8413           DC-COMM-LENGTH,
  8414           DFHEIV99,
  8415           DFHEIV99,
  8416           DFHEIV99,
  8417           DFHEIV99
  8418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8419
  8420 9900-ERROR-FORMAT.
  8421     IF NOT EMI-ERRORS-COMPLETE
  8422        MOVE LINK-001            TO PGM-NAME
  8423
  8424* EXEC CICS LINK
  8425*           PROGRAM    (PGM-NAME)
  8426*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8427*           LENGTH     (EMI-COMM-LENGTH)
  8428*       END-EXEC
  8429*    MOVE '."C                   (   #00007526' TO DFHEIV0
  8430     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8432     MOVE X'2020233030303037353236' TO DFHEIV0(25:11)
  8433     CALL 'kxdfhei1' USING DFHEIV0,
  8434           PGM-NAME,
  8435           ERROR-MESSAGE-INTERFACE-BLOCK,
  8436           EMI-COMM-LENGTH,
  8437           DFHEIV99,
  8438           DFHEIV99,
  8439           DFHEIV99,
  8440           DFHEIV99
  8441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8442     END-IF
  8443     .
  8444 9900-EXIT.
  8445     EXIT.
  8446 9990-ABEND.
  8447     MOVE LINK-004               TO PGM-NAME.
  8448     MOVE DFHEIBLK               TO EMI-LINE1.
  8449
  8450* EXEC CICS LINK
  8451*        PROGRAM   (PGM-NAME)
  8452*        COMMAREA  (EMI-LINE1)
  8453*        LENGTH    (72)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 148
* EL6317.cbl
  8454*    END-EXEC.
  8455     MOVE 72
  8456       TO DFHEIV11
  8457*    MOVE '."C                   (   #00007538' TO DFHEIV0
  8458     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8460     MOVE X'2020233030303037353338' TO DFHEIV0(25:11)
  8461     CALL 'kxdfhei1' USING DFHEIV0,
  8462           PGM-NAME,
  8463           EMI-LINE1,
  8464           DFHEIV11,
  8465           DFHEIV99,
  8466           DFHEIV99,
  8467           DFHEIV99,
  8468           DFHEIV99
  8469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8470
  8471     GO TO 8200-SEND-DATAONLY.
  8472
  8473* GOBACK.
  8474     MOVE '9%                    "   ' TO DFHEIV0
  8475     MOVE 'EL6317' TO DFHEIV1
  8476     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8477     GOBACK.
  8478 9995-SECURITY-VIOLATION.
  8479*                            COPY ELCSCTP.
  8480******************************************************************
  8481*                                                                *
  8482*                            ELCSCTP                             *
  8483*                            VMOD=2.001                          *
  8484*                                                                *
  8485*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8486******************************************************************
  8487
  8488
  8489     MOVE EIBDATE          TO SM-JUL-DATE.
  8490     MOVE EIBTRMID         TO SM-TERMID.
  8491     MOVE THIS-PGM         TO SM-PGM.
  8492     MOVE EIBTIME          TO TIME-IN.
  8493     MOVE TIME-OUT         TO SM-TIME.
  8494     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8495
  8496
  8497* EXEC CICS LINK
  8498*         PROGRAM  ('EL003')
  8499*         COMMAREA (SECURITY-MESSAGE)
  8500*         LENGTH   (80)
  8501*    END-EXEC.
  8502     MOVE 'EL003' TO DFHEIV1
  8503     MOVE 80
  8504       TO DFHEIV11
  8505*    MOVE '."C                   (   #00007563' TO DFHEIV0
  8506     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8508     MOVE X'2020233030303037353633' TO DFHEIV0(25:11)
  8509     CALL 'kxdfhei1' USING DFHEIV0,
  8510           DFHEIV1,
  8511           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:21 Page 149
* EL6317.cbl
  8512           DFHEIV11,
  8513           DFHEIV99,
  8514           DFHEIV99,
  8515           DFHEIV99,
  8516           DFHEIV99
  8517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8518
  8519
  8520******************************************************************
  8521
  8522 9995-EXIT.
  8523     EXIT.
  8524
  8525 9999-DFHBACK SECTION.
  8526     MOVE '9%                    "   ' TO DFHEIV0
  8527     MOVE 'EL6317' TO DFHEIV1
  8528     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8529     GOBACK.
  8530 9999-DFHEXIT.
  8531     IF DFHEIGDJ EQUAL 0001
  8532         NEXT SENTENCE
  8533     ELSE IF DFHEIGDJ EQUAL 2
  8534         GO TO 8300-SEND-TEXT
  8535         DEPENDING ON DFHEIGDI.
  8536     MOVE '9%                    "   ' TO DFHEIV0
  8537     MOVE 'EL6317' TO DFHEIV1
  8538     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8539     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35116     Code:       19035
