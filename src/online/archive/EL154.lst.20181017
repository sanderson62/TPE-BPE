* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   1
* EL154.cbl
* Options: int("EL154.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL154.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL154.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL154.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL154.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/21/94 15:39:26.
     7*                            VMOD=2.022
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   2
* EL154.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EX28 - SET-UP AUTOMATIC PAYMENTS.
    26*        USED TO CREATE NEW AUTOMATIC PAYMENT SCHEDULES AND/OR
    27*        SIGN-OFF CURRENT SCHEDULES.  ONCE A SCHEDULE HAS BEEN
    28*        CREATED IT MAY ONLY BY REPLACED - NOT CHANGED
    29*        OR DELETED.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 090108    2007041300006  AJRA  ENTER LETTER FORM NUMBER ON SET U
    39* 031809    2009031600001  AJRA  ALLOW IU PAYMENT PAST EXP DATE
    40* 070909    2009060400001  AJRA  ADD AUTO PAY STOP LETTER
    41* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    42* 100713  IR2013092400001  PEMA  USE EXP DT IF NO CRIT PER - DCC
    43* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    44* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    45* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    46* 030515  IR2015030300002  PEMA  FIX CRIT PERIOD EDITS
    47* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    48* 031417  IR2017030200001  TANA  FIX DCC CRIT PERIOD EDITS
    49* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    50******************************************************************
    51
    52 ENVIRONMENT DIVISION.
    53
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   3
* EL154.cbl
    55 DATA DIVISION.
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58 77  FILLER  PIC X(32)  VALUE '********************************'.
    59 77  FILLER  PIC X(32)  VALUE '*    EL154 WORKING STORAGE     *'.
    60 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.022 *********'.
    61 77  P1                          PIC S999 COMP-3 VALUE +0.
    62 77  P2                          PIC S999 COMP-3 VALUE +0.
    63 77  s1                          PIC S999 COMP-3 VALUE +0.
    64 77  s2                          PIC S999 COMP-3 VALUE +0.
    65 77  ws-benefit-expiration-dt    pic xx value low-values.
    66 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    67 77  ws-proposed-benefits        pic s999 comp-3 value +0.
    68
    69*                            COPY ELCSCTM.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCTM                             *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    77*                                                                *
    78******************************************************************
    79 01  SECURITY-MESSAGE.
    80     12  FILLER                          PIC X(30)
    81            VALUE '** LOGIC SECURITY VIOLATION -'.
    82     12  SM-READ                         PIC X(6).
    83     12  FILLER                          PIC X(5)
    84            VALUE ' PGM='.
    85     12  SM-PGM                          PIC X(6).
    86     12  FILLER                          PIC X(5)
    87            VALUE ' OPR='.
    88     12  SM-PROCESSOR-ID                 PIC X(4).
    89     12  FILLER                          PIC X(6)
    90            VALUE ' TERM='.
    91     12  SM-TERMID                       PIC X(4).
    92     12  FILLER                          PIC XX   VALUE SPACE.
    93     12  SM-JUL-DATE                     PIC 9(5).
    94     12  FILLER                          PIC X    VALUE SPACE.
    95     12  SM-TIME                         PIC 99.99.
    96
    97
    98*                            COPY ELCSCRTY.
    99******************************************************************
   100*                                                                *
   101*                                                                *
   102*                            ELCSCRTY                            *
   103*                            VMOD=2.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   106*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   107*        SAVED IN PI-SECURITY-ADDRESS.                           *
   108*                                                                *
   109******************************************************************
   110 01  SECURITY-CONTROL.
   111     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   112     12  FILLER                       PIC XX    VALUE 'SC'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   4
* EL154.cbl
   113     12  SC-CREDIT-CODES.
   114         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   115             20  SC-CREDIT-DISPLAY    PIC X.
   116             20  SC-CREDIT-UPDATE     PIC X.
   117     12  SC-CLAIMS-CODES.
   118         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   119             20  SC-CLAIMS-DISPLAY    PIC X.
   120             20  SC-CLAIMS-UPDATE     PIC X.
   121
   122 01  WS-DATE-AREA.
   123     05  CURRENT-GREG-DATE   PIC X(8)    VALUE SPACES.
   124     05  CURRENT-BIN-DATE    PIC X(2)    VALUE SPACES.
   125     05  RETRO-ELIM-DATE     PIC XX      VALUE LOW-VALUES.
   126
   127 01  ws-dcc-product-code         pic xxx value spaces.
   128 01  ws-clp-state                pic xx  value spaces.
   129 01  ws-ah-benefit-cd            pic xx  value '00'.
   130 01  ws-edit-1st-pmt-amt         pic s9(9)v99 comp-3 value +0.
   131 01  ws-monthly-benefit          pic s9(9)v99 comp-3 value +0.
   132 01  ws-max-benefit-amt          pic s9(9)v99 comp-3 value +0.
   133 01  ws-max-benefit-pmts         pic s999 comp-3 value +0.
   134 01  ws-benefits-prev-paid       pic s999 comp-3 value +0.
   135 01  ws-total-paid               pic s9(9)v99 comp-3 value +0.
   136 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   137     88  PDEF-FOUND                   VALUE 'Y'.
   138 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   139     88  ACCT-FOUND                   VALUE 'Y'.
   140 01  ws-cert-trlr-sw             PIC X  VALUE ' '.
   141     88  cert-trlr-found              VALUE 'Y'.
   142 01  STANDARD-AREAS.
   143     12  WS-RESPONSE             PIC S9(8)   COMP.
   144         88  WS-RESP-NORMAL        VALUE +00.
   145         88  WS-RESP-ERROR         VALUE +01.
   146         88  WS-RESP-NOTFND        VALUE +13.
   147         88  WS-RESP-DUPREC        VALUE +14.
   148         88  WS-RESP-ENDFILE       VALUE +20.
   149     12  SC-ITEM             PIC S9(4)   VALUE +1  COMP.
   150     12  SUB-1               PIC S9(4)   VALUE +0  COMP.
   151     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   152     12  MAP-NAME.
   153         16  MAP-PRE         PIC XX      VALUE 'EL'.
   154         16  MAP-NUMBER      PIC X(4)    VALUE '154A'.
   155         16  FILLER          PIC XX      VALUE SPACES.
   156     12  MAPSET-NAME         PIC X(8)    VALUE 'EL154S'.
   157     12  TRANS-ID            PIC X(4)    VALUE 'EX28'.
   158     12  LGXX-ID             PIC X(4)    VALUE 'LGXX'.
   159     12  PGM-NAME            PIC X(8).
   160     12  TIME-IN             PIC S9(7).
   161     12  TIME-OUT-R  REDEFINES TIME-IN.
   162         16  FILLER          PIC X.
   163         16  TIME-OUT        PIC 99V99.
   164         16  FILLER          PIC X(2).
   165     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   166     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   167     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   168
   169     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   170     12  LINK-004            PIC X(8)    VALUE 'EL004'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   5
* EL154.cbl
   171     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   172     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   173     12  THIS-PGM            PIC X(8)    VALUE 'EL154'.
   174
   175     12  DEEDIT-FIELD            PIC X(15).
   176     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   177
   178     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   179     12  NEFFDTE-SAVE            PIC XX       VALUE LOW-VALUES.
   180     12  NFSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   181     12  NLSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   182     12  NFSTAMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   183     12  NREGPMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   184     12  CURRENT-SAVE            PIC XX       VALUE LOW-VALUES.
   185     12  LETTDTE-SAVE            PIC X(10)    VALUE SPACES.
   186     12  WS-WORK                 PIC S9(5)    VALUE ZERO COMP-3.
   187     12  WS-REMAINDER            PIC S9(5)    VALUE ZERO COMP-3.
   188     12  WS-DAYS-MINUS-TOL       PIC S9(5)    VALUE ZERO COMP-3.
   189     12  WS-DAYS-PLUS-TOL        PIC S9(5)    VALUE ZERO COMP-3.
   190     12  WS-DAILY-BEN-AMT        PIC S9(5)V99 VALUE ZERO COMP-3.
   191     12  WS-AMT-MINUS-TOL        PIC S9(7)V99 VALUE ZERO COMP-3.
   192     12  WS-AMT-PLUS-TOL         PIC S9(7)V99 VALUE ZERO COMP-3.
   193     12  WS-AMT-TOL              PIC S9(5)V99 VALUE ZERO COMP-3.
   194     12  WS-DAY-TOL              PIC S9(05)   VALUE ZERO COMP-3.
   195     12  WS-MAX-AUTO-PMT         PIC S9(7)V99 VALUE ZERO COMP-3.
   196     12  WS-MAX-AUTO-MOS         PIC S999     VALUE ZERO COMP-3.
   197     12  WS-ELAPSED-DAYS         PIC S9(04)   VALUE +0   COMP.
   198     12  WS-REG-PMT              PIC S9(7)V99 VALUE ZERO COMP-3.
   199     12  WS-EXP-DT               PIC XX       VALUE LOW-VALUES.
   200     12  WS-EXP-DT-PLUS7         PIC XX       VALUE LOW-VALUES.
   201     12  WS-CALC-METHOD          PIC X.
   202     12  WS-DAILY-RATE           PIC S9(3)V99.
   203     12  WS-CONFIRM-NEEDED       PIC X.
   204     12  WS-ELIMINATION-SW       PIC X        VALUE SPACES.
   205         88  NO-EFFDTE-ENTERED   VALUE 'N'.
   206     12  WS-BENEFIT-FOUND-SW     PIC X        VALUE SPACES.
   207         88  BENEFIT-FOUND       VALUE 'Y'.
   208     12  WS-ACT-REC-FOUND-SW     PIC X(01)    VALUE 'N'.
   209     12  WS-LETTER-SW            PIC X(01)    VALUE 'N'.
   210     12  WS-LETTER-FORM-NUM      PIC X(04)    VALUE SPACES.
   211     12  WS-END-LETTER-FORM-NUM  PIC X(04)    VALUE SPACES.
   212     12  WS-RESET-SW             PIC X(01)    VALUE 'N'.
   213     12  WS-PAYEE-CODE.
   214         16  WS-PAYEE-CD         PIC X(01).
   215         16  WS-PAYEE-SEQ        PIC X(01).
   216         16  WS-PAYEE-SEQ-NUM REDEFINES
   217             WS-PAYEE-SEQ        PIC 9(01).
   218     12  WS-ACCESS.
   219         16  FILLER              PIC XX       VALUE SPACES.
   220         16  WS-BEN-CD           PIC XX.
   221
   222     12  MISC-HEADING-AREAS.
   223         16  FIRST-PMT-HD1       PIC X(23)    VALUE
   224             'FIRST PAY THRU DATE   :'.
   225         16  FIRST-PMT-HD2       PIC X(23)    VALUE
   226             'FIRST PAY-TO DATE     :'.
   227         16  FIRST-PMT-HD3       PIC X(26)    VALUE
   228             '   FIRST PAY-THRU DATE   :'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   6
* EL154.cbl
   229         16  FIRST-PMT-HD4       PIC X(26)    VALUE
   230             '   FIRST PAY-TO DATE     :'.
   231         16  LAST-PMT-HD1        PIC X(24)    VALUE
   232             'LAST PAY-THRU DATE     :'.
   233         16  LAST-PMT-HD2        PIC X(24)    VALUE
   234             'LAST PAY-TO DATE       :'.
   235         16  LAST-PMT-HD3        PIC X(23)    VALUE
   236             'LAST PAY-THRU DATE    :'.
   237         16  LAST-PMT-HD4        PIC X(23)    VALUE
   238             'LAST PAY-TO DATE      :'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   7
* EL154.cbl
   240 01  ERROR-MESSAGES.
   241     12  ER-0000                 PIC X(4)     VALUE '0000'.
   242     12  ER-0004                 PIC X(4)     VALUE '0004'.
   243     12  ER-0008                 PIC X(4)     VALUE '0008'.
   244     12  ER-0029                 PIC X(4)     VALUE '0029'.
   245     12  ER-0042                 PIC X(4)     VALUE '0042'.
   246     12  ER-0050                 PIC X(4)     VALUE '0050'.
   247     12  ER-0070                 PIC X(4)     VALUE '0070'.
   248     12  ER-0130                 PIC X(4)     VALUE '0130'.
   249     12  ER-0154                 PIC X(4)     VALUE '0154'.
   250     12  ER-0169                 PIC X(4)     VALUE '0169'.
   251     12  ER-0172                 PIC X(4)     VALUE '0172'.
   252     12  ER-0186                 PIC X(4)     VALUE '0186'.
   253     12  ER-0206                 PIC X(4)     VALUE '0206'.
   254     12  ER-0283                 PIC X(4)     VALUE '0283'.
   255     12  ER-0346                 PIC X(4)     VALUE '0346'.
   256     12  ER-0347                 PIC X(4)     VALUE '0347'.
   257     12  ER-0348                 PIC X(4)     VALUE '0348'.
   258     12  ER-0349                 PIC X(4)     VALUE '0349'.
   259     12  ER-0350                 PIC X(4)     VALUE '0350'.
   260     12  ER-0351                 PIC X(4)     VALUE '0351'.
   261     12  ER-0352                 PIC X(4)     VALUE '0352'.
   262     12  ER-0353                 PIC X(4)     VALUE '0353'.
   263     12  ER-0354                 PIC X(4)     VALUE '0354'.
   264     12  ER-0357                 PIC X(4)     VALUE '0357'.
   265     12  ER-0358                 PIC X(4)     VALUE '0358'.
   266     12  ER-0372                 PIC X(4)     VALUE '0372'.
   267     12  ER-0396                 PIC X(4)     VALUE '0396'.
   268     12  ER-0397                 PIC X(4)     VALUE '0397'.
   269     12  ER-0398                 PIC X(4)     VALUE '0398'.
   270     12  ER-0399                 PIC X(4)     VALUE '0399'.
   271     12  ER-0401                 PIC X(4)     VALUE '0401'.
   272     12  ER-0402                 PIC X(4)     VALUE '0402'.
   273     12  ER-0403                 PIC X(4)     VALUE '0403'.
   274     12  ER-0404                 PIC X(4)     VALUE '0404'.
   275     12  ER-0450                 PIC X(4)     VALUE '0450'.
   276     12  ER-0541                 PIC X(4)     VALUE '0541'.
   277     12  ER-0559                 PIC X(4)     VALUE '0559'.
   278     12  ER-0563                 PIC X(4)     VALUE '0563'.
   279     12  ER-0597                 PIC X(4)     VALUE '0597'.
   280     12  ER-0632                 PIC X(4)     VALUE '0632'.
   281     12  ER-0670                 PIC X(4)     VALUE '0670'.
   282     12  ER-0802                 PIC X(4)     VALUE '0802'.
   283     12  ER-0803                 PIC X(4)     VALUE '0803'.
   284     12  ER-0815                 PIC X(4)     VALUE '0815'.
   285     12  ER-0826                 PIC X(4)     VALUE '0826'.
   286     12  ER-0839                 PIC X(4)     VALUE '0839'.
   287     12  ER-1599                 PIC X(4)     VALUE '1599'.
   288     12  er-1657                 pic x(4)     value '1657'.
   289     12  er-1658                 pic x(4)     value '1658'.
   290     12  er-1672                 pic x(4)     value '1672'.
   291     12  er-1674                 pic x(4)     value '1674'.
   292     12  ER-3396                 PIC X(4)     VALUE '3396'.
   293     12  ER-3397                 PIC X(4)     VALUE '3397'.
   294     12  ER-3537                 PIC X(4)     VALUE '3537'.
   295     12  ER-3801                 PIC X(4)     VALUE '3801'.
   296     12  ER-8200                 PIC X(4)     VALUE '8200'.
   297     12  ER-9483                 PIC X(4)     VALUE '9483'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   8
* EL154.cbl
   298     12  ER-9883                 PIC X(4)     VALUE '9883'.
   299
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page   9
* EL154.cbl
   301 01  ACCESS-KEYS.
   302     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   303     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   304     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   305     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   306     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   307     12  EMPLCY-ID                PIC X(8)    VALUE 'MPPLCY'.
   308
   309     12  CNTL-KEY.
   310         16  CNTL-CO              PIC X(3).
   311         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   312         16  CNTL-GENL.
   313           18 CNTL-GEN1           PIC X(2)    VALUE SPACES.
   314           18 CNTL-GEN2.
   315             20 CNTL-GEN3         PIC X       VALUE SPACES.
   316             20 CNTL-GEN4         PIC X       VALUE SPACES.
   317         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   318
   319     12  ELTRLR-KEY.
   320         16  TRLR-COMP-CD        PIC X.
   321         16  TRLR-CARRIER        PIC X.
   322         16  TRLR-CLAIM-NO       PIC X(7).
   323         16  TRLR-CERT-NO        PIC X(11).
   324         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   325     12  CLAM-KEY.
   326         16  CLAM-CO              PIC X.
   327         16  CLAM-CARRIER         PIC X.
   328         16  CLAM-CLAIM           PIC X(7).
   329         16  CLAM-CERT-NUM        PIC X(11).
   330
   331     12  CLAIM-SAVE-KEY           PIC X(20).
   332
   333     12  ACTV-KEY.
   334         16  ACTV-PARTIAL-KEY.
   335             20  ACTV-CO          PIC X.
   336             20  ACTV-CARRIER     PIC X.
   337             20  ACTV-CLAIM       PIC X(7).
   338             20  ACTV-CERT-NUM    PIC X(11).
   339         16  ACTV-SEQ             PIC S9(4)  COMP.
   340
   341     12  CERT-KEY.
   342         16  CERT-CO             PIC X.
   343         16  CERT-CARRIER        PIC X.
   344         16  CERT-GROUPING       PIC X(6).
   345         16  CERT-STATE          PIC XX.
   346         16  CERT-ACCOUNT        PIC X(10).
   347         16  CERT-EFF-DT         PIC XX.
   348         16  CERT-CERT-NUM       PIC X(11).
   349
   350     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   351     12  ERACCT-KEY.
   352         16  ERACCT-PARTIAL-KEY.
   353             20  ACCT-COMP-CD    PIC X.
   354             20  ACCT-CARRIER    PIC X.
   355             20  ACCT-GROUPING   PIC X(6).
   356             20  ACCT-STATE      PIC XX.
   357             20  ACCT-ACCOUNT    PIC X(10).
   358         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  10
* EL154.cbl
   359         16  FILLER              PIC X(4) VALUE SPACES.
   360     12  EMPLCY-KEY.
   361         16  EMPLCY-COMPANY-CD   PIC X(01).
   362         16  EMPLCY-CARRIER      PIC X(01).
   363         16  EMPLCY-GROUPING     PIC X(06).
   364         16  EMPLCY-STATE        PIC X(02).
   365         16  EMPLCY-PRODUCER     PIC X(10).
   366         16  EMPLCY-EFF-DT       PIC X(02).
   367         16  EMPLCY-REFERENCE-NO PIC X(20).
   368
   369     12  BENE-KEY.
   370         16  BENE-CO             PIC X(01).
   371         16  BENE-REC-TYPE       PIC X(01).
   372         16  BENE-CODE           PIC X(10).
   373 01  ERPDEF-KEY-SAVE             PIC X(18).
   374 01  ERPDEF-KEY.
   375     12  ERPDEF-COMPANY-CD       PIC X.
   376     12  ERPDEF-STATE            PIC XX.
   377     12  ERPDEF-PROD-CD          PIC XXX.
   378     12  F                       PIC X(7).
   379     12  ERPDEF-BEN-TYPE         PIC X.
   380     12  ERPDEF-BEN-CODE         PIC XX.
   381     12  ERPDEF-EXP-DT           PIC XX.
   382
   383 01  ELCRTT-KEY.
   384     05  CTRLR-COMP-CD       PIC X.
   385     05  CTRLR-CARRIER       PIC X.
   386     05  CTRLR-GROUPING      PIC X(6).
   387     05  CTRLR-STATE         PIC X(2).
   388     05  CTRLR-ACCOUNT       PIC X(10).
   389     05  CTRLR-EFF-DT        PIC XX.
   390     05  CTRLR-CERT-NO       PIC X(11).
   391     05  CTRLR-REC-TYPE      PIC X.
   392*                            COPY ELCCALC.
   393******************************************************************
   394*                                                                *
   395*                           ELCCALC.                            *
   396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   397*                            VMOD=2.025                          *
   398*                                                                *
   399*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   400*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   401*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   402*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   403*                                                                *
   404*  PASSED TO ELRTRM                                              *
   405*  -----------------                                             *
   406*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   407*  ORIGINAL TERM                                                 *
   408*  BEGINNING DATE                                                *
   409*  ENDING DATE                                                   *
   410*  COMPANY I.D.                                                  *
   411*  ACCOUNT MASTER USER FIELD                                     *
   412*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   413*  FREE LOOK DAYS                                                *
   414*                                                                *
   415*  RETURNED FROM ELRTRM                                          *
   416*  ---------------------                                         *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  11
* EL154.cbl
   417*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   418*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   419*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   420*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   421*----------------------------------------------------------------*
   422*  PASSED TO ELRAMT                                              *
   423*  ----------------                                              *
   424*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   425*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   426*  ORIGINAL AMOUNT                                               *
   427*  ALTERNATE BENEFIT (BALLON)                                    *
   428*  A.P.R. - NET PAY ONLY                                         *
   429*  METHOD
   430*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   431*  COMPANY I.D.                                                  *
   432*  BENEFIT TYPE                                                  *
   433*                                                                *
   434*  RETURNED FROM ELRAMT                                          *
   435*  --------------------                                          *
   436*  REMAINING AMOUNT 1 - CURRENT                                  *
   437*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   438*  REMAINING AMOUNT FACTOR
   439*----------------------------------------------------------------*
   440*  PASSED TO ELRESV                                              *
   441*  -----------------                                             *
   442*  CERTIFICATE EFFECTIVE DATE                                    *
   443*  VALUATION DATE                                                *
   444*  PAID THRU DATE                                                *
   445*  BENEFIT                                                       *
   446*  INCURRED DATE                                                 *
   447*  REPORTED DATE                                                 *
   448*  ISSUE AGE                                                     *
   449*  TERM                                                          *
   450*  CDT PERCENT                                                   *
   451*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   452* *CLAIM TYPE (LIFE, A/H)                                        *
   453* *REMAINING BENEFIT (FROM ELRAMT)                               *
   454* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   455*                                                                *
   456*  RETURNED FROM ELRESV                                          *
   457*  --------------------                                          *
   458*  CDT TABLE USED                                                *
   459*  CDT FACTOR USED                                               *
   460*  PAY TO CURRENT RESERVE                                        *
   461*  I.B.N.R. - A/H ONLY                                           *
   462*  FUTURE (ACCRUED) AH ONLY                                      *
   463*----------------------------------------------------------------*
   464*  PASSED TO ELRATE                                              *
   465*  ----------------                                              *
   466*  CERT ISSUE DATE                                               *
   467*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   468*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   469*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   470*  STATE CODE (CLIENT DEFINED)                                   *
   471*  STATE CODE (STANDARD P.O. ABBRV)                              *
   472*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   473*  DEVIATION CODE                                                *
   474*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  12
* EL154.cbl
   475*  ORIGINAL BENEFIT AMOUNT                                       *
   476*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   477*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   478*  BENEFIT KIND (LIFE OR A/H)                                    *
   479*  A.P.R.                                                        *
   480*  METHOD
   481*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   482*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   483*  COMPANY I.D. (3 CHARACTER)                                    *
   484*  BENEFIT CODE                                                  *
   485*  BENEFIT OVERRIDE CODE                                         *
   486*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   487*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   488*  JOINT INDICATOR (CSL ONLY)                                    *
   489*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   490*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   491*                                                                *
   492*  RETURNED FROM ELRATE                                          *
   493*  --------------------                                          *
   494*  CALCULATED PREMIUM                                            *
   495*  PREMIUM RATE                                                  *
   496*  MORTALITY CODE                                                *
   497*  MAX ATTAINED AGE                                              *
   498*  MAX AGE                                                       *
   499*  MAX TERM                                                      *
   500*  MAX MONTHLY BENEFIT                                           *
   501*  MAX TOTAL BENIFIT                                             *
   502*  COMPOSITE RATE (OPEN-END ONLY)                                *
   503*----------------------------------------------------------------*
   504*  PASSED TO ELRFND                                              *
   505*  ----------------                                              *
   506*  CERT ISSUE DATE                                               *
   507*  REFUND DATE                                                   *
   508*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   509*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   510*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   511*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   512*  STATE CODE (CLIENT DEFINED)                                   *
   513*  STATE CODE (STANDARD P.O. ABBRV)                              *
   514*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   515*  DEVIATION CODE                                                *
   516*  ISSUE AGE                                                     *
   517*  ORIGINAL BENEFIT AMOUNT                                       *
   518*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   519*  PROCESS TYPE (CANCEL)                                         *
   520*  BENEFIT KIND (LIFE OR A/H)                                    *
   521*  A.P.R.                                                        *
   522*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   523*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   524*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   525*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   526*  COMPANY I.D. (3 CHARACTER)                                    *
   527*  BENEFIT CODE                                                  *
   528*  BENEFIT OVERRIDE CODE                                         *
   529*                                                                *
   530*  RETURNED FROM ELRFND                                          *
   531*  --------------------                                          *
   532*  CALCULATED REFUND                                             *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  13
* EL154.cbl
   533*----------------------------------------------------------------*
   534*  PASSED TO ELEARN                                              *
   535*  ----------------                                              *
   536*  CERT ISSUE DATE                                               *
   537*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   538*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   539*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   540*  STATE CODE (CLIENT DEFINED)                                   *
   541*  STATE CODE (STANDARD P.O. ABBRV)                              *
   542*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   543*  DEVIATION CODE                                                *
   544*  ISSUE AGE                                                     *
   545*  ORIGINAL BENEFIT AMOUNT                                       *
   546*  BENEFIT KIND (LIFE OR A/H)                                    *
   547*  A.P.R.                                                        *
   548*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   549*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   550*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   551*  COMPANY I.D. (3 CHARACTER)                                    *
   552*  BENEFIT CODE                                                  *
   553*  BENEFIT OVERRIDE CODE                                         *
   554*                                                                *
   555*  RETURNED FROM ELEARN                                          *
   556*  --------------------                                          *
   557*  INDICATED  EARNINGS                                           *
   558*----------------------------------------------------------------*
   559*                 LENGTH = 450                                   *
   560*                                                                *
   561******************************************************************
   562******************************************************************
   563*                   C H A N G E   L O G
   564*
   565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   566*-----------------------------------------------------------------
   567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   568* EFFECTIVE    NUMBER
   569*-----------------------------------------------------------------
   570* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   571* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   572* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   573* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   574* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   575* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   576* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   577* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   578* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   579* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   580* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   581******************************************************************
   582
   583 01  CALCULATION-PASS-AREA.
   584     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   585                                     COMP.
   586
   587     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   588       88  NO-CP-ERROR                             VALUE ZERO.
   589       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   590                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  14
* EL154.cbl
   591       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   592       88  CP-ERROR-IN-DATES                       VALUE '2'.
   593       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   594       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   595       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   596       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   597       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   598       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   599       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   600       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   601       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   602       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   603       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   604       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   605       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   606       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   607       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   608
   609     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   610       88  NO-CP-ERROR-2                           VALUE ZERO.
   611***********************  INPUT AREAS ****************************
   612
   613     12  CP-CALCULATION-AREA.
   614         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   615         16  CP-CERT-EFF-DT        PIC XX.
   616         16  CP-VALUATION-DT       PIC XX.
   617         16  CP-PAID-THRU-DT       PIC XX.
   618         16  CP-BENEFIT-TYPE       PIC X.
   619           88  CP-AH                               VALUE 'A' 'D'
   620                                                   'I' 'U'.
   621           88  CP-REDUCING-LIFE                    VALUE 'R'.
   622           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   623         16  CP-INCURRED-DT        PIC XX.
   624         16  CP-REPORTED-DT        PIC XX.
   625         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   626         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   627         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   628                                     COMP-3.
   629         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   630                                     COMP-3.
   631         16  CP-CDT-METHOD         PIC X.
   632           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   633           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   634           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   635         16  CP-CLAIM-TYPE         PIC X.
   636           88  CP-AH-CLAIM                         VALUE 'A'.
   637           88  CP-LIFE-CLAIM                       VALUE 'L'.
   638         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   639                                     COMP-3.
   640         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   641                                     COMP-3.
   642         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   643                                     COMP-3.
   644         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   645                                     COMP-3.
   646         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   647                                     COMP-3.
   648         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  15
* EL154.cbl
   649                                     COMP-3.
   650         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   651                                     COMP-3.
   652         16  CP-REM-TERM-METHOD    PIC X.
   653           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   654           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   655           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   656           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   657           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   658           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   659           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   660         16  CP-EARNING-METHOD     PIC X.
   661           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   662           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   663           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   664           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   665           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   666           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   667           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   668           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   669           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   670           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   671           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   672           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   673           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   674           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   675         16  CP-PROCESS-TYPE       PIC X.
   676           88  CP-CLAIM                            VALUE '1'.
   677           88  CP-CANCEL                           VALUE '2'.
   678           88  CP-ISSUE                            VALUE '3'.
   679         16  CP-SPECIAL-CALC-CD    PIC X.
   680           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   681           88  CP-1-MTH-INTEREST               VALUE ' '.
   682           88  CP-0-MTH-INTEREST               VALUE 'A'.
   683           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   684           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   685           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   686           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   687           88  CP-FARM-PLAN                    VALUE 'F'.
   688           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   689           88  CP-2-MTH-INTEREST               VALUE 'I'.
   690           88  CP-3-MTH-INTEREST               VALUE 'J'.
   691           88  CP-4-MTH-INTEREST               VALUE 'K'.
   692           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   693           88  CP-MORTGAGE-REC                 VALUE 'M'.
   694           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   695           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   696           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   697           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   698                                                     'W' 'X'.
   699           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   700           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   701           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   702           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   703           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   704           88  CP-SUMMARY-REC                  VALUE 'Z'.
   705           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   706           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  16
* EL154.cbl
   707           88  CP-AD-D-BENEFIT                 VALUE '4'.
   708           88  CP-CSL-METH-1                   VALUE '5'.
   709           88  CP-CSL-METH-2                   VALUE '6'.
   710           88  CP-CSL-METH-3                   VALUE '7'.
   711           88  CP-CSL-METH-4                   VALUE '8'.
   712
   713         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   714                                     COMP-3.
   715         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   716         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   717         16  CP-STATE              PIC XX          VALUE SPACE.
   718         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   719         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   720           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   721               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   722         16  CP-R78-OPTION         PIC X.
   723           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   724           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   725
   726         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   727         16  CP-IBNR-RESERVE-SW    PIC X.
   728         16  CP-CLAIM-STATUS       PIC X.
   729         16  CP-RATE-FILE          PIC X.
   730         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   731                                     COMP-3.
   732
   733         16  CP-LIFE-OVERRIDE-CODE PIC X.
   734         16  CP-AH-OVERRIDE-CODE   PIC X.
   735
   736         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   737                                     COMP-3.
   738         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   739                                   PIC S9(5)V99 COMP-3.
   740         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   741                                     COMP-3.
   742         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   743                                     COMP-3.
   744         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   745                                     COMP-3.
   746         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   747                                  PIC S9(7)V99 COMP-3.
   748
   749         16  CP-PAID-FROM-DATE     PIC X(02).
   750         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   751         16  CP-EXT-DAYS-CALC      PIC X.
   752           88  CP-EXT-NO-CHG                   VALUE ' '.
   753           88  CP-EXT-CHG-LF                   VALUE '1'.
   754           88  CP-EXT-CHG-AH                   VALUE '2'.
   755           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   756         16  CP-DOMICILE-STATE     PIC XX.
   757         16  CP-CARRIER            PIC X.
   758         16  CP-REIN-FLAG          PIC X.
   759         16  CP-REM-TRM-CALC-OPTION PIC X.
   760           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   761                      '2' '3' '4' '5'.
   762           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   763           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   764           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  17
* EL154.cbl
   765           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   766           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   767           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   768           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   769           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   770         16  CP-SIG-SWITCH         PIC X.
   771         16  CP-RATING-METHOD      PIC X.
   772           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   773           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   774           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   775           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   776           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   777           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   778           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   779           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   780           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   781         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   782                                     COMP-3.
   783         16  CP-BEN-CATEGORY       PIC X.
   784         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   785         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   786                                   PIC S99V9(5) COMP-3.
   787         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   788         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   789                                   PIC S99V9(5) COMP-3.
   790         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   791         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   792         16  CP-EXPIRE-DT          PIC XX.
   793         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   794         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   795         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   796         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   797         16  CP-DDF-SPEC-CALC      PIC X.
   798             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   799             88  CP-CALC-CLP              VALUE 'C'.
   800         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   801         16  CP-CANCEL-REASON      PIC X.
   802         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   803         16  CP-PMT-MODE           PIC X.
   804         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   805         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   806         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   807         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   808         16  FILLER                PIC X.
   809
   810***************    OUTPUT FROM ELRESV   ************************
   811
   812         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   813
   814         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   815                                     COMP-3.
   816         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   817                                     COMP-3.
   818         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   819                                     COMP-3.
   820         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   821                                     COMP-3.
   822         16  FILLER                PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  18
* EL154.cbl
   823***************    OUTPUT FROM ELRTRM   *************************
   824
   825         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   826                                     COMP-3.
   827         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   828                                     COMP-3.
   829         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   830                                     COMP-3.
   831         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   832                                     COMP-3.
   833         16  FILLER                PIC X(12).
   834
   835***************    OUTPUT FROM ELRAMT   *************************
   836
   837         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   838                                     COMP-3.
   839         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   840                                     COMP-3.
   841         16  FILLER                PIC X(12).
   842
   843***************    OUTPUT FROM ELRATE   *************************
   844
   845         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   846                                     COMP-3.
   847         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   848                                     COMP-3.
   849         16  CP-MORTALITY-CODE     PIC X(4).
   850         16  CP-RATE-EDIT-FLAG     PIC X.
   851             88  CP-RATES-NEED-APR                  VALUE '1'.
   852         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   853                                     COMP-3.
   854         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   855         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   856         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   857                                   PIC S9(7)V99 COMP-3.
   858         16  FILLER                PIC X(07).
   859
   860***************    OUTPUT FROM ELRFND   *************************
   861
   862         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   863                                     COMP-3.
   864         16  CP-REFUND-TYPE-USED   PIC X.
   865           88  CP-R-AS-R78                         VALUE '1'.
   866           88  CP-R-AS-PRORATA                     VALUE '2'.
   867           88  CP-R-AS-CALIF                       VALUE '3'.
   868           88  CP-R-AS-TEXAS                       VALUE '4'.
   869           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   870           88  CP-R-AS-NET-PAY                     VALUE '5'.
   871           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   872           88  CP-R-AS-MEAN                        VALUE '8'.
   873           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   874           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   875           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   876           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   877           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   878           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   879         16  FILLER                PIC X(12).
   880
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  19
* EL154.cbl
   881***************    OUTPUT FROM ELEARN   *************************
   882
   883         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   884                                     COMP-3.
   885         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   886                                     COMP-3.
   887         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   888                                     COMP-3.
   889         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   890                                     COMP-3.
   891         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   892                                     COMP-3.
   893         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   894                                     COMP-3.
   895         16  CP-EARNING-TYPE-USED  PIC X.
   896           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   897           88  CP-E-AS-R78                         VALUE '1'.
   898           88  CP-E-AS-PRORATA                     VALUE '2'.
   899           88  CP-E-AS-TEXAS                       VALUE '4'.
   900           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   901           88  CP-E-AS-NET-PAY                     VALUE '5'.
   902           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   903           88  CP-E-AS-MEAN                        VALUE '8'.
   904           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   905         16  FILLER                PIC X(12).
   906
   907***************    OUTPUT FROM ELPMNT   *************************
   908
   909         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   910                                     COMP-3.
   911         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   912                                     COMP-3.
   913         16  FILLER                PIC X(12).
   914
   915***************   MISC WORK AREAS    *****************************
   916         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   917                                     COMP-3.
   918         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   919                                     COMP-3.
   920         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   921                                     COMP-3.
   922         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   923                                     COMP-3.
   924         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   925                                     COMP-3.
   926         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   927                                     COMP-3.
   928         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   929             88  OPEN-RATE-FILE                   VALUE 'O'.
   930             88  CLOSE-RATE-FILE                  VALUE 'C'.
   931             88  IO-ERROR                         VALUE 'E'.
   932
   933         16  CP-FIRST-PAY-DATE     PIC XX.
   934
   935         16  CP-JOINT-INDICATOR    PIC X.
   936
   937         16  CP-RESERVE-REMAINING-TERM
   938                                   PIC S9(4)V9    VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  20
* EL154.cbl
   939                                     COMP-3.
   940
   941         16  CP-INSURED-BIRTH-DT   PIC XX.
   942
   943         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   944                                     COMP-3.
   945
   946         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   947                                     COMP-3.
   948
   949         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   950                                     COMP-3.
   951
   952         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   953                                     COMP-3.
   954
   955         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   956                                     COMP-3.
   957
   958         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   959                                     COMP-3.
   960
   961         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   962                                     COMP-3.
   963
   964         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   965             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   966
   967         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   968                                     COMP-3.
   969         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   970                                     COMP-3.
   971         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   972         16  cp-extra-periods      pic 9 value zeros.
   973         16  cp-net-only-state     pic x value spaces.
   974         16  FILLER                PIC X(13).
   975******************************************************************
   976
   977
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  21
* EL154.cbl
   979*                            COPY ELCDATE.
   980******************************************************************
   981*                                                                *
   982*                                                                *
   983*                            ELCDATE.                            *
   984*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   985*                            VMOD=2.003
   986*                                                                *
   987*                                                                *
   988*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   989*                 LENGTH = 200                                   *
   990******************************************************************
   991
   992 01  DATE-CONVERSION-DATA.
   993     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   994     12  DC-OPTION-CODE                PIC X.
   995         88  BIN-TO-GREG                VALUE ' '.
   996         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   997         88  EDIT-GREG-TO-BIN           VALUE '2'.
   998         88  YMD-GREG-TO-BIN            VALUE '3'.
   999         88  MDY-GREG-TO-BIN            VALUE '4'.
  1000         88  JULIAN-TO-BIN              VALUE '5'.
  1001         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1002         88  FIND-CENTURY               VALUE '7'.
  1003         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1004         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1005         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1006         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1007         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1008         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1009         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1010         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1011         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1012         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1013         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1014         88  BIN-3-TO-GREG              VALUE 'I'.
  1015         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1016         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1017         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1018         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1019         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1020         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1021         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1022         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1023         88  THREE-CHARACTER-BIN
  1024                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1025         88  GREGORIAN-TO-BIN
  1026                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1027         88  BIN-TO-GREGORIAN
  1028                  VALUES ' ' '1' 'I' '8' 'G'.
  1029         88  JULIAN-TO-BINARY
  1030                  VALUES '5' 'C' 'E' 'F'.
  1031     12  DC-ERROR-CODE                 PIC X.
  1032         88  NO-CONVERSION-ERROR        VALUE ' '.
  1033         88  DATE-CONVERSION-ERROR
  1034                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1035         88  DATE-IS-ZERO               VALUE '1'.
  1036         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  22
* EL154.cbl
  1037         88  DATE-IS-INVALID            VALUE '3'.
  1038         88  DATE1-GREATER-DATE2        VALUE '4'.
  1039         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1040         88  DATE-INVALID-OPTION        VALUE '9'.
  1041         88  INVALID-CENTURY            VALUE 'A'.
  1042         88  ONLY-CENTURY               VALUE 'B'.
  1043         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1044         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1045     12  DC-END-OF-MONTH               PIC X.
  1046         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1047     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1048         88  USE-NORMAL-PROCESS         VALUE ' '.
  1049         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1050         88  ADJUST-UP-100-YRS          VALUE '2'.
  1051     12  FILLER                        PIC X.
  1052     12  DC-CONVERSION-DATES.
  1053         16  DC-BIN-DATE-1             PIC XX.
  1054         16  DC-BIN-DATE-2             PIC XX.
  1055         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1056         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1057                       DC-GREG-DATE-1-EDIT.
  1058             20  DC-EDIT1-MONTH        PIC 99.
  1059             20  SLASH1-1              PIC X.
  1060             20  DC-EDIT1-DAY          PIC 99.
  1061             20  SLASH1-2              PIC X.
  1062             20  DC-EDIT1-YEAR         PIC 99.
  1063         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1064         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1065                     DC-GREG-DATE-2-EDIT.
  1066             20  DC-EDIT2-MONTH        PIC 99.
  1067             20  SLASH2-1              PIC X.
  1068             20  DC-EDIT2-DAY          PIC 99.
  1069             20  SLASH2-2              PIC X.
  1070             20  DC-EDIT2-YEAR         PIC 99.
  1071         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1072         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1073                     DC-GREG-DATE-1-YMD.
  1074             20  DC-YMD-YEAR           PIC 99.
  1075             20  DC-YMD-MONTH          PIC 99.
  1076             20  DC-YMD-DAY            PIC 99.
  1077         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1078         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1079                      DC-GREG-DATE-1-MDY.
  1080             20  DC-MDY-MONTH          PIC 99.
  1081             20  DC-MDY-DAY            PIC 99.
  1082             20  DC-MDY-YEAR           PIC 99.
  1083         16  DC-GREG-DATE-1-ALPHA.
  1084             20  DC-ALPHA-MONTH        PIC X(10).
  1085             20  DC-ALPHA-DAY          PIC 99.
  1086             20  FILLER                PIC XX.
  1087             20  DC-ALPHA-CENTURY.
  1088                 24 DC-ALPHA-CEN-N     PIC 99.
  1089             20  DC-ALPHA-YEAR         PIC 99.
  1090         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1091         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1092         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1093         16  DC-JULIAN-DATE            PIC 9(05).
  1094         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  23
* EL154.cbl
  1095                                       PIC 9(05).
  1096         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1097             20  DC-JULIAN-YEAR        PIC 99.
  1098             20  DC-JULIAN-DAYS        PIC 999.
  1099         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1100         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1101         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1102     12  DATE-CONVERSION-VARIBLES.
  1103         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1104         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1105             20  FILLER                PIC 9(3).
  1106             20  HOLD-CEN-1-CCYY.
  1107                 24  HOLD-CEN-1-CC     PIC 99.
  1108                 24  HOLD-CEN-1-YY     PIC 99.
  1109             20  HOLD-CEN-1-MO         PIC 99.
  1110             20  HOLD-CEN-1-DA         PIC 99.
  1111         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1112             20  HOLD-CEN-1-R-MO       PIC 99.
  1113             20  HOLD-CEN-1-R-DA       PIC 99.
  1114             20  HOLD-CEN-1-R-CCYY.
  1115                 24  HOLD-CEN-1-R-CC   PIC 99.
  1116                 24  HOLD-CEN-1-R-YY   PIC 99.
  1117             20  FILLER                PIC 9(3).
  1118         16  HOLD-CENTURY-1-X.
  1119             20  FILLER                PIC X(3)  VALUE SPACES.
  1120             20  HOLD-CEN-1-X-CCYY.
  1121                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1122                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1123             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1124             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1125         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1126             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1127             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1128             20  HOLD-CEN-1-R-X-CCYY.
  1129                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1130                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1131             20  FILLER                PIC XXX.
  1132         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1133         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1134         16  DC-JULIAN-DATE-1          PIC 9(07).
  1135         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1136             20  DC-JULIAN-1-CCYY.
  1137                 24  DC-JULIAN-1-CC    PIC 99.
  1138                 24  DC-JULIAN-1-YR    PIC 99.
  1139             20  DC-JULIAN-DA-1        PIC 999.
  1140         16  DC-JULIAN-DATE-2          PIC 9(07).
  1141         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1142             20  DC-JULIAN-2-CCYY.
  1143                 24  DC-JULIAN-2-CC    PIC 99.
  1144                 24  DC-JULIAN-2-YR    PIC 99.
  1145             20  DC-JULIAN-DA-2        PIC 999.
  1146         16  DC-GREG-DATE-A-EDIT.
  1147             20  DC-EDITA-MONTH        PIC 99.
  1148             20  SLASHA-1              PIC X VALUE '/'.
  1149             20  DC-EDITA-DAY          PIC 99.
  1150             20  SLASHA-2              PIC X VALUE '/'.
  1151             20  DC-EDITA-CCYY.
  1152                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  24
* EL154.cbl
  1153                 24  DC-EDITA-YEAR     PIC 99.
  1154         16  DC-GREG-DATE-B-EDIT.
  1155             20  DC-EDITB-MONTH        PIC 99.
  1156             20  SLASHB-1              PIC X VALUE '/'.
  1157             20  DC-EDITB-DAY          PIC 99.
  1158             20  SLASHB-2              PIC X VALUE '/'.
  1159             20  DC-EDITB-CCYY.
  1160                 24  DC-EDITB-CENT     PIC 99.
  1161                 24  DC-EDITB-YEAR     PIC 99.
  1162         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1163         16  DC-GREG-DATE-CYMD-R REDEFINES
  1164                              DC-GREG-DATE-CYMD.
  1165             20  DC-CYMD-CEN           PIC 99.
  1166             20  DC-CYMD-YEAR          PIC 99.
  1167             20  DC-CYMD-MONTH         PIC 99.
  1168             20  DC-CYMD-DAY           PIC 99.
  1169         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1170         16  DC-GREG-DATE-MDCY-R REDEFINES
  1171                              DC-GREG-DATE-MDCY.
  1172             20  DC-MDCY-MONTH         PIC 99.
  1173             20  DC-MDCY-DAY           PIC 99.
  1174             20  DC-MDCY-CEN           PIC 99.
  1175             20  DC-MDCY-YEAR          PIC 99.
  1176    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1177        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1178    12  DC-EL310-DATE                  PIC X(21).
  1179    12  FILLER                         PIC X(28).
  1180
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  25
* EL154.cbl
  1182*                            COPY ELCLOGOF.
  1183******************************************************************
  1184*                                                                *
  1185*                                                                *
  1186*                            ELCLOGOF.                           *
  1187*                            VMOD=2.001                          *
  1188*                                                                *
  1189*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1190*                                                                *
  1191******************************************************************
  1192 01  CLASIC-LOGOFF.
  1193     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1194     12  LOGOFF-TEXT.
  1195         16  FILLER          PIC X(5)    VALUE SPACES.
  1196         16  LOGOFF-MSG.
  1197             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1198             20  FILLER      PIC X       VALUE SPACES.
  1199             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1200         16  FILLER          PIC X(80)
  1201           VALUE '* YOU ARE NOW LOGGED OFF'.
  1202         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1203         16  FILLER          PIC X       VALUE QUOTE.
  1204         16  LOGOFF-SYS-MSG  PIC X(17)
  1205           VALUE 'S CLAS-IC SYSTEM '.
  1206     12  TEXT-MESSAGES.
  1207         16  UNACCESS-MSG    PIC X(29)
  1208             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1209         16  PGMIDERR-MSG    PIC X(17)
  1210             VALUE 'PROGRAM NOT FOUND'.
  1211
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  26
* EL154.cbl
  1213*                            COPY ELCATTR.
  1214******************************************************************
  1215*                                                                *
  1216*                            ELCATTR.                            *
  1217*                            VMOD=2.001                          *
  1218*                                                                *
  1219*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1220*                                                                *
  1221*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1222*                                                                *
  1223*                   POS 1   P=PROTECTED                          *
  1224*                           U=UNPROTECTED                        *
  1225*                           S=ASKIP                              *
  1226*                   POS 2   A=ALPHA/NUMERIC                      *
  1227*                           N=NUMERIC                            *
  1228*                   POS 3   N=NORMAL                             *
  1229*                           B=BRIGHT                             *
  1230*                           D=DARK                               *
  1231*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1232*                           OF=MODIFIED DATA TAG OFF             *
  1233*                                                                *
  1234*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1235******************************************************************
  1236 01  ATTRIBUTE-LIST.
  1237     12  AL-PABOF            PIC X       VALUE 'Y'.
  1238     12  AL-PABON            PIC X       VALUE 'Z'.
  1239     12  AL-PADOF            PIC X       VALUE '%'.
  1240     12  AL-PADON            PIC X       VALUE '_'.
  1241     12  AL-PANOF            PIC X       VALUE '-'.
  1242     12  AL-PANON            PIC X       VALUE '/'.
  1243     12  AL-SABOF            PIC X       VALUE '8'.
  1244     12  AL-SABON            PIC X       VALUE '9'.
  1245     12  AL-SADOF            PIC X       VALUE '@'.
  1246     12  AL-SADON            PIC X       VALUE QUOTE.
  1247     12  AL-SANOF            PIC X       VALUE '0'.
  1248     12  AL-SANON            PIC X       VALUE '1'.
  1249     12  AL-UABOF            PIC X       VALUE 'H'.
  1250     12  AL-UABON            PIC X       VALUE 'I'.
  1251     12  AL-UADOF            PIC X       VALUE '<'.
  1252     12  AL-UADON            PIC X       VALUE '('.
  1253     12  AL-UANOF            PIC X       VALUE ' '.
  1254     12  AL-UANON            PIC X       VALUE 'A'.
  1255     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1256     12  AL-UNBON            PIC X       VALUE 'R'.
  1257     12  AL-UNDOF            PIC X       VALUE '*'.
  1258     12  AL-UNDON            PIC X       VALUE ')'.
  1259     12  AL-UNNOF            PIC X       VALUE '&'.
  1260     12  AL-UNNON            PIC X       VALUE 'J'.
  1261
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  27
* EL154.cbl
  1263*                            COPY ELCEMIB.
  1264******************************************************************
  1265*                                                                *
  1266*                                                                *
  1267*                            ELCEMIB.                            *
  1268*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1269*                            VMOD=2.005                          *
  1270*                                                                *
  1271*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1272*                                                                *
  1273******************************************************************
  1274 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1275     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1276     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1277     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1278     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1279     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1280     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1281     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1282     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1283     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1284         88  EMI-NO-ERRORS                    VALUE '1'.
  1285         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1286         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1287     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1288         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1289     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1290         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1291         88  EMI-AREA1-FULL                   VALUE '2'.
  1292     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1293         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1294         88  EMI-AREA2-FULL                   VALUE '2'.
  1295     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1296         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1297         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1298         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1299         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1300         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1301     12  EMI-ERROR-LINES.
  1302         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1303         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1304         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1305         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1306             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1307                 24  EMI-ERR-NUM         PIC X(4).
  1308                 24  EMI-FILLER          PIC X.
  1309                 24  EMI-SEV             PIC X.
  1310                 24  FILLER              PIC X.
  1311             20  FILLER                  PIC X(02).
  1312     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1313         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1314             20  EMI-ERROR-NUMBER    PIC X(4).
  1315             20  EMI-FILL            PIC X.
  1316             20  EMI-SEVERITY        PIC X.
  1317             20  FILLER              PIC X.
  1318             20  EMI-ERROR-TEXT.
  1319                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1320                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  28
* EL154.cbl
  1321     12  EMI-SEVERITY-SAVE           PIC X.
  1322         88  EMI-NOTE                    VALUE 'N'.
  1323         88  EMI-WARNING                 VALUE 'W'.
  1324         88  EMI-FORCABLE                VALUE 'F'.
  1325         88  EMI-FATAL                   VALUE 'X'.
  1326     12  EMI-MESSAGE-FLAG            PIC X.
  1327         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1328         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1329     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1330     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1331         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1332         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1333         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1334     12  emi-claim-no                pic x(7).
  1335     12  emi-claim-type              pic x(6).
  1336     12  FILLER                      PIC X(124)  VALUE SPACES.
  1337     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1338     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1339     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1340     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  29
* EL154.cbl
  1342*                            COPY ELCLNKLT.
  1343******************************************************************
  1344*                                                                *
  1345*                                                                *
  1346*                           ELCLNKLT                             *
  1347*                            VMOD=2.003                          *
  1348*                                                                *
  1349*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1350*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1351*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1352*                                                                *
  1353*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1354*   COMPLETING THE REQUIRED FIELDS.                              *
  1355*                                                                *
  1356*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1357*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1358*                              9999 INDICATES AN UNKNOWN ABEND   *
  1359*                                   WAS DETECTED.                *
  1360*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1361*                              CODES FOUND IN THE ERROR FILE.    *
  1362******************************************************************
  1363 01  W-1523-LINKDATA.
  1364     12  W-1523-COMMON-PI-DATA.
  1365         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1366         16  FILLER              PIC  X(67).
  1367         16  W-1523-COMPANY-CD   PIC  X(01).
  1368         16  FILLER              PIC  X(10).
  1369         16  W-1523-CONTROL-IN-PROGRESS.
  1370             20  W-1523-CARRIER  PIC  X(01).
  1371             20  W-1523-GROUPING PIC  X(06).
  1372             20  W-1523-STATE    PIC  X(02).
  1373             20  W-1523-ACCOUNT  PIC  X(10).
  1374             20  W-1523-CLAIM-CERT-GRP.
  1375                 24  W-1523-CLAIM-NO
  1376                                 PIC  X(07).
  1377                 24  W-1523-CERT-NO.
  1378                     28  W-1523-CERT-PRIME
  1379                                 PIC  X(10).
  1380                     28  W-1523-CERT-SFX
  1381                                 PIC  X(01).
  1382                 24  W-1523-CERT-EFF-DT
  1383                                 PIC  X(02).
  1384         16  FILLER              PIC X(265).
  1385
  1386     12  W-1523-WORK-AREA.
  1387         16  W-1523-FORM-NUMBER  PIC  X(04).
  1388         16  W-1523-NUMBER-COPIES
  1389                                 PIC  9(01).
  1390         16  W-1523-ADDR-TYPE    PIC  X(02).
  1391         16  W-1523-FOLLOW-UP-DATE
  1392                                 PIC  X(02).
  1393         16  W-1523-RESEND-DATE  PIC  X(02).
  1394         16  W-1523-ERROR-CODE   PIC  9(04).
  1395             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1396             88  W-1523-FATAL-ERROR
  1397                                    VALUES  0006 0013 0042
  1398                                            0154 0168 0169
  1399                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  30
* EL154.cbl
  1400                                            0179 0186 0281
  1401                                            0332 2055 3697
  1402                                            3698 3699 3770
  1403                                            3771 3772 7675
  1404                                            9106 9808 9883
  1405                                            9887.
  1406             88  W-1523-STOP-ERRORS
  1407                                    VALUES  0013 0042 0154
  1408                                            0168 0169 0172
  1409                                            0281 0332 2055
  1410                                            3698 3699 7675
  1411                                            9106 9808 9883
  1412                                            9999.
  1413         16  W-1523-REASON       PIC  X(70).
  1414         16  W-1523-ARCHIVE-NUMBER
  1415                                 PIC  9(08).
  1416     12  W-1523-POINTER-AREA.
  1417         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1418         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1419         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1420         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1421         16  W-1523-PROD-POINTER PIC S9(08) COMP.
  1422
  1423     12  W-1523-LETTER-DATE       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  31
* EL154.cbl
  1425*                            COPY ELCINTF.
  1426******************************************************************
  1427*                                                                *
  1428*                                                                *
  1429*                            ELCINTF.                            *
  1430*                            VMOD=2.017                          *
  1431*                                                                *
  1432*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1433*                                                                *
  1434*       LENGTH = 1024                                            *
  1435*                                                                *
  1436******************************************************************
  1437*                   C H A N G E   L O G
  1438*
  1439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1440*-----------------------------------------------------------------
  1441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1442* EFFECTIVE    NUMBER
  1443*-----------------------------------------------------------------
  1444* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1445******************************************************************
  1446 01  PROGRAM-INTERFACE-BLOCK.
  1447     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1448     12  PI-CALLING-PROGRAM              PIC X(8).
  1449     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1450     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1451     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1452     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1453     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1454     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1455     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1456     12  PI-COMPANY-ID                   PIC XXX.
  1457     12  PI-COMPANY-CD                   PIC X.
  1458
  1459     12  PI-COMPANY-PASSWORD             PIC X(8).
  1460
  1461     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1462
  1463     12  PI-CONTROL-IN-PROGRESS.
  1464         16  PI-CARRIER                  PIC X.
  1465         16  PI-GROUPING                 PIC X(6).
  1466         16  PI-STATE                    PIC XX.
  1467         16  PI-ACCOUNT                  PIC X(10).
  1468         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1469                                         PIC X(10).
  1470         16  PI-CLAIM-CERT-GRP.
  1471             20  PI-CLAIM-NO             PIC X(7).
  1472             20  PI-CERT-NO.
  1473                 25  PI-CERT-PRIME       PIC X(10).
  1474                 25  PI-CERT-SFX         PIC X.
  1475             20  PI-CERT-EFF-DT          PIC XX.
  1476         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1477             20  PI-PLAN-CODE            PIC X(2).
  1478             20  PI-REVISION-NUMBER      PIC X(3).
  1479             20  PI-PLAN-EFF-DT          PIC X(2).
  1480             20  PI-PLAN-EXP-DT          PIC X(2).
  1481             20  FILLER                  PIC X(11).
  1482         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  32
* EL154.cbl
  1483             20  PI-OE-REFERENCE-1.
  1484                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1485                 25  PI-OE-REF-1-SUFF    PIC XX.
  1486
  1487     12  PI-SESSION-IN-PROGRESS          PIC X.
  1488         88  CLAIM-SESSION                   VALUE '1'.
  1489         88  CREDIT-SESSION                  VALUE '2'.
  1490         88  WARRANTY-SESSION                VALUE '3'.
  1491         88  MORTGAGE-SESSION                VALUE '4'.
  1492         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1493
  1494
  1495*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1496
  1497     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1498     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1499
  1500     12  PI-CREDIT-USER                  PIC X.
  1501         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1502         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1503
  1504     12  PI-CLAIM-USER                   PIC X.
  1505         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1506         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1507
  1508     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1509         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1510         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1511         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1512         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1513         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1514
  1515     12  PI-PROCESSOR-ID                 PIC X(4).
  1516
  1517     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1518
  1519     12  PI-MEMBER-CAPTION               PIC X(10).
  1520
  1521     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1522         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1523
  1524     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1525     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1526     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1527     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1528
  1529     12  PI-AH-OVERRIDE-L1               PIC X.
  1530     12  PI-AH-OVERRIDE-L2               PIC XX.
  1531     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1532     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1533
  1534     12  PI-NEW-SYSTEM                   PIC X(2).
  1535
  1536     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1537     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1538         88  PI-USES-PAID-TO                 VALUE '1'.
  1539     12  PI-CRDTCRD-SYSTEM.
  1540         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  33
* EL154.cbl
  1541             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1542             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1543         16  PI-CC-MONTH-END-DT          PIC XX.
  1544     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1545
  1546     12  PI-OE-REFERENCE-2.
  1547         16  PI-OE-REF-2-PRIME           PIC X(10).
  1548         16  PI-OE-REF-2-SUFF            PIC X.
  1549
  1550     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1551
  1552     12  PI-LANGUAGE-TYPE                PIC X.
  1553             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1554             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1555             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1556
  1557     12  PI-POLICY-LINKAGE-IND           PIC X.
  1558         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1559         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1560                                                   LOW-VALUES.
  1561
  1562     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1563     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1564         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1565         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1566
  1567     12  PI-PROCESSOR-CSR-IND            PIC X.
  1568         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1569         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1570
  1571     12  FILLER                          PIC X(3).
  1572
  1573     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1574
  1575     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1576         PI-SYSTEM-LEVEL.
  1577
  1578         16  PI-ENTRY-CODES.
  1579             20  PI-ENTRY-CD-1           PIC X.
  1580             20  PI-ENTRY-CD-2           PIC X.
  1581
  1582         16  PI-RETURN-CODES.
  1583             20  PI-RETURN-CD-1          PIC X.
  1584             20  PI-RETURN-CD-2          PIC X.
  1585
  1586         16  PI-UPDATE-STATUS-SAVE.
  1587             20  PI-UPDATE-BY            PIC X(4).
  1588             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1589
  1590         16  PI-LOWER-CASE-LETTERS       PIC X.
  1591             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1592
  1593*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1594*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1595*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1596
  1597         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1598             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  34
* EL154.cbl
  1599             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1600             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1601             88  ACCNT-CNTL                  VALUE '3'.
  1602             88  CARR-ACCNT-CNTL             VALUE '4'.
  1603
  1604         16  PI-PROCESSOR-CAP-LIST.
  1605             20  PI-SYSTEM-CONTROLS.
  1606                24 PI-SYSTEM-DISPLAY     PIC X.
  1607                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1608                24 PI-SYSTEM-MODIFY      PIC X.
  1609                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1610             20  FILLER                  PIC XX.
  1611             20  PI-DISPLAY-CAP          PIC X.
  1612                 88  DISPLAY-CAP             VALUE 'Y'.
  1613             20  PI-MODIFY-CAP           PIC X.
  1614                 88  MODIFY-CAP              VALUE 'Y'.
  1615             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1616                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1617             20  PI-FORCE-CAP            PIC X.
  1618                 88  FORCE-CAP               VALUE 'Y'.
  1619
  1620         16  PI-PROGRAM-CONTROLS.
  1621             20  PI-PGM-PRINT-OPT        PIC X.
  1622             20  PI-PGM-FORMAT-OPT       PIC X.
  1623             20  PI-PGM-PROCESS-OPT      PIC X.
  1624             20  PI-PGM-TOTALS-OPT       PIC X.
  1625
  1626         16  PI-HELP-INTERFACE.
  1627             20  PI-LAST-ERROR-NO        PIC X(4).
  1628             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1629
  1630         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1631             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1632
  1633         16  PI-CR-CONTROL-IN-PROGRESS.
  1634             20  PI-CR-CARRIER           PIC X.
  1635             20  PI-CR-GROUPING          PIC X(6).
  1636             20  PI-CR-STATE             PIC XX.
  1637             20  PI-CR-ACCOUNT           PIC X(10).
  1638             20  PI-CR-FIN-RESP          PIC X(10).
  1639             20  PI-CR-TYPE              PIC X.
  1640
  1641         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1642
  1643         16  PI-CR-MONTH-END-DT          PIC XX.
  1644
  1645         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1646             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1647             88  PI-ZERO-CARRIER             VALUE '1'.
  1648             88  PI-ZERO-GROUPING            VALUE '2'.
  1649             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1650
  1651         16  PI-CARRIER-SECURITY         PIC X.
  1652             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1653
  1654         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1655             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1656             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  35
* EL154.cbl
  1657
  1658         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1659             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1660                                         INDEXED BY PI-ACCESS-NDX
  1661                                         PIC X.
  1662
  1663         16  PI-GA-BILLING-CONTROL       PIC X.
  1664             88  PI-GA-BILLING               VALUE '1'.
  1665
  1666         16  PI-MAIL-PROCESSING          PIC X.
  1667             88  PI-MAIL-YES                 VALUE 'Y'.
  1668
  1669         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1670
  1671         16  PI-AR-SYSTEM.
  1672             20  PI-AR-PROCESSING-CNTL   PIC X.
  1673                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1674             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1675             20  PI-AR-MONTH-END-DT      PIC XX.
  1676
  1677         16  PI-MP-SYSTEM.
  1678             20  PI-MORTGAGE-USER            PIC X.
  1679                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1680                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1681             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1682                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1683                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1684                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1685                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1686                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1687             20  PI-MP-MONTH-END-DT          PIC XX.
  1688             20  PI-MP-REFERENCE-NO.
  1689                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1690                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1691
  1692         16  PI-LABEL-CONTROL            PIC X(01).
  1693             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1694             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1695
  1696         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1697             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1698
  1699         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1700             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1701             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1702
  1703         16  FILLER                      PIC X(14).
  1704
  1705     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1706******************************************************************
  1707     12  PI-REDEF       REDEFINES PI-PROGRAM-WORK-AREA.
  1708         16  PI-BENEFIT-SAVE.
  1709             18  PI-BEN-DAYS      PIC 99.
  1710             18  PI-BEN-TYPE      PIC X.
  1711*00269   16  FILLER               PIC X(637).
  1712         16  PI-AUTO-END-LETTER   PIC X(04).
  1713         16  FILLER               PIC X(633).
  1714
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  36
* EL154.cbl
  1716*                            COPY ELCAID.
  1717******************************************************************
  1718*                                                                *
  1719*                            ELCAID.                             *
  1720*                            VMOD=2.001                          *
  1721*                                                                *
  1722*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1723*                                                                *
  1724*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1725*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1726******************************************************************
  1727
  1728 01  DFHAID.
  1729   02  DFHNULL   PIC  X  VALUE  ' '.
  1730   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1731   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1732   02  DFHPEN    PIC  X  VALUE  '='.
  1733   02  DFHOPID   PIC  X  VALUE  'W'.
  1734   02  DFHPA1    PIC  X  VALUE  '%'.
  1735   02  DFHPA2    PIC  X  VALUE  '>'.
  1736   02  DFHPA3    PIC  X  VALUE  ','.
  1737   02  DFHPF1    PIC  X  VALUE  '1'.
  1738   02  DFHPF2    PIC  X  VALUE  '2'.
  1739   02  DFHPF3    PIC  X  VALUE  '3'.
  1740   02  DFHPF4    PIC  X  VALUE  '4'.
  1741   02  DFHPF5    PIC  X  VALUE  '5'.
  1742   02  DFHPF6    PIC  X  VALUE  '6'.
  1743   02  DFHPF7    PIC  X  VALUE  '7'.
  1744   02  DFHPF8    PIC  X  VALUE  '8'.
  1745   02  DFHPF9    PIC  X  VALUE  '9'.
  1746   02  DFHPF10   PIC  X  VALUE  ':'.
  1747   02  DFHPF11   PIC  X  VALUE  '#'.
  1748   02  DFHPF12   PIC  X  VALUE  '@'.
  1749   02  DFHPF13   PIC  X  VALUE  'A'.
  1750   02  DFHPF14   PIC  X  VALUE  'B'.
  1751   02  DFHPF15   PIC  X  VALUE  'C'.
  1752   02  DFHPF16   PIC  X  VALUE  'D'.
  1753   02  DFHPF17   PIC  X  VALUE  'E'.
  1754   02  DFHPF18   PIC  X  VALUE  'F'.
  1755   02  DFHPF19   PIC  X  VALUE  'G'.
  1756   02  DFHPF20   PIC  X  VALUE  'H'.
  1757   02  DFHPF21   PIC  X  VALUE  'I'.
  1758*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1759   02  DFHPF22   PIC  X  VALUE  '['.
  1760   02  DFHPF23   PIC  X  VALUE  '.'.
  1761   02  DFHPF24   PIC  X  VALUE  '<'.
  1762   02  DFHMSRE   PIC  X  VALUE  'X'.
  1763   02  DFHSTRF   PIC  X  VALUE  'h'.
  1764   02  DFHTRIG   PIC  X  VALUE  '"'.
  1765 01  FILLER    REDEFINES DFHAID.
  1766     12  FILLER              PIC X(8).
  1767     12  PF-VALUES           PIC X       OCCURS 2.
  1768
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  37
* EL154.cbl
  1770*                            COPY EL154S.
  1771 01  EL154AI.
  1772     05  FILLER            PIC  X(0012).
  1773*    -------------------------------
  1774     05  RUNDTEL PIC S9(0004) COMP.
  1775     05  RUNDTEF PIC  X(0001).
  1776     05  FILLER REDEFINES RUNDTEF.
  1777         10  RUNDTEA PIC  X(0001).
  1778     05  RUNDTEI PIC  X(0008).
  1779*    -------------------------------
  1780     05  RUNTIMEL PIC S9(0004) COMP.
  1781     05  RUNTIMEF PIC  X(0001).
  1782     05  FILLER REDEFINES RUNTIMEF.
  1783         10  RUNTIMEA PIC  X(0001).
  1784     05  RUNTIMEI PIC  X(0005).
  1785*    -------------------------------
  1786     05  CLAIML PIC S9(0004) COMP.
  1787     05  CLAIMF PIC  X(0001).
  1788     05  FILLER REDEFINES CLAIMF.
  1789         10  CLAIMA PIC  X(0001).
  1790     05  CLAIMI PIC  X(0007).
  1791*    -------------------------------
  1792     05  CARRL PIC S9(0004) COMP.
  1793     05  CARRF PIC  X(0001).
  1794     05  FILLER REDEFINES CARRF.
  1795         10  CARRA PIC  X(0001).
  1796     05  CARRI PIC  X(0001).
  1797*    -------------------------------
  1798     05  CERTL PIC S9(0004) COMP.
  1799     05  CERTF PIC  X(0001).
  1800     05  FILLER REDEFINES CERTF.
  1801         10  CERTA PIC  X(0001).
  1802     05  CERTI PIC  X(0010).
  1803*    -------------------------------
  1804     05  SUFFIXL PIC S9(0004) COMP.
  1805     05  SUFFIXF PIC  X(0001).
  1806     05  FILLER REDEFINES SUFFIXF.
  1807         10  SUFFIXA PIC  X(0001).
  1808     05  SUFFIXI PIC  X(0001).
  1809*    -------------------------------
  1810     05  CESTDTEL PIC S9(0004) COMP.
  1811     05  CESTDTEF PIC  X(0001).
  1812     05  FILLER REDEFINES CESTDTEF.
  1813         10  CESTDTEA PIC  X(0001).
  1814     05  CESTDTEI PIC  X(0008).
  1815*    -------------------------------
  1816     05  CESTBYL PIC S9(0004) COMP.
  1817     05  CESTBYF PIC  X(0001).
  1818     05  FILLER REDEFINES CESTBYF.
  1819         10  CESTBYA PIC  X(0001).
  1820     05  CESTBYI PIC  X(0004).
  1821*    -------------------------------
  1822     05  FSTHD1L PIC S9(0004) COMP.
  1823     05  FSTHD1F PIC  X(0001).
  1824     05  FILLER REDEFINES FSTHD1F.
  1825         10  FSTHD1A PIC  X(0001).
  1826     05  FSTHD1I PIC  X(0023).
  1827*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  38
* EL154.cbl
  1828     05  CFSTPMTL PIC S9(0004) COMP.
  1829     05  CFSTPMTF PIC  X(0001).
  1830     05  FILLER REDEFINES CFSTPMTF.
  1831         10  CFSTPMTA PIC  X(0001).
  1832     05  CFSTPMTI PIC  X(0008).
  1833*    -------------------------------
  1834     05  CMONTHSL PIC S9(0004) COMP.
  1835     05  CMONTHSF PIC  X(0001).
  1836     05  FILLER REDEFINES CMONTHSF.
  1837         10  CMONTHSA PIC  X(0001).
  1838     05  CMONTHSI PIC  X(0002).
  1839*    -------------------------------
  1840     05  CFSTAMTL PIC S9(0004) COMP.
  1841     05  CFSTAMTF PIC  X(0001).
  1842     05  FILLER REDEFINES CFSTAMTF.
  1843         10  CFSTAMTA PIC  X(0001).
  1844     05  CFSTAMTI PIC  X(0009).
  1845*    -------------------------------
  1846     05  LSTHD1L PIC S9(0004) COMP.
  1847     05  LSTHD1F PIC  X(0001).
  1848     05  FILLER REDEFINES LSTHD1F.
  1849         10  LSTHD1A PIC  X(0001).
  1850     05  LSTHD1I PIC  X(0024).
  1851*    -------------------------------
  1852     05  CLSTPMTL PIC S9(0004) COMP.
  1853     05  CLSTPMTF PIC  X(0001).
  1854     05  FILLER REDEFINES CLSTPMTF.
  1855         10  CLSTPMTA PIC  X(0001).
  1856     05  CLSTPMTI PIC  X(0008).
  1857*    -------------------------------
  1858     05  CLASTL PIC S9(0004) COMP.
  1859     05  CLASTF PIC  X(0001).
  1860     05  FILLER REDEFINES CLASTF.
  1861         10  CLASTA PIC  X(0001).
  1862     05  CLASTI PIC  X(0001).
  1863*    -------------------------------
  1864     05  CREGPMTL PIC S9(0004) COMP.
  1865     05  CREGPMTF PIC  X(0001).
  1866     05  FILLER REDEFINES CREGPMTF.
  1867         10  CREGPMTA PIC  X(0001).
  1868     05  CREGPMTI PIC  X(0009).
  1869*    -------------------------------
  1870     05  CDAYSFL PIC S9(0004) COMP.
  1871     05  CDAYSFF PIC  X(0001).
  1872     05  FILLER REDEFINES CDAYSFF.
  1873         10  CDAYSFA PIC  X(0001).
  1874     05  CDAYSFI PIC  X(0003).
  1875*    -------------------------------
  1876     05  CPAYEEL PIC S9(0004) COMP.
  1877     05  CPAYEEF PIC  X(0001).
  1878     05  FILLER REDEFINES CPAYEEF.
  1879         10  CPAYEEA PIC  X(0001).
  1880     05  CPAYEEI PIC  X(0008).
  1881*    -------------------------------
  1882     05  DAY2PAYL PIC S9(0004) COMP.
  1883     05  DAY2PAYF PIC  X(0001).
  1884     05  FILLER REDEFINES DAY2PAYF.
  1885         10  DAY2PAYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  39
* EL154.cbl
  1886     05  DAY2PAYI PIC  99.
  1887*    -------------------------------
  1888     05  CEFFDTEL PIC S9(0004) COMP.
  1889     05  CEFFDTEF PIC  X(0001).
  1890     05  FILLER REDEFINES CEFFDTEF.
  1891         10  CEFFDTEA PIC  X(0001).
  1892     05  CEFFDTEI PIC  X(0008).
  1893*    -------------------------------
  1894     05  TERML PIC S9(0004) COMP.
  1895     05  TERMF PIC  X(0001).
  1896     05  FILLER REDEFINES TERMF.
  1897         10  TERMA PIC  X(0001).
  1898     05  TERMI PIC  X(0001).
  1899*    -------------------------------
  1900     05  CINDCTRL PIC S9(0004) COMP.
  1901     05  CINDCTRF PIC  X(0001).
  1902     05  FILLER REDEFINES CINDCTRF.
  1903         10  CINDCTRA PIC  X(0001).
  1904     05  CINDCTRI PIC  X(0001).
  1905*    -------------------------------
  1906     05  PRINTL PIC S9(0004) COMP.
  1907     05  PRINTF PIC  X(0001).
  1908     05  FILLER REDEFINES PRINTF.
  1909         10  PRINTA PIC  X(0001).
  1910     05  PRINTI PIC  X(0004).
  1911*    -------------------------------
  1912     05  FSTHD2L PIC S9(0004) COMP.
  1913     05  FSTHD2F PIC  X(0001).
  1914     05  FILLER REDEFINES FSTHD2F.
  1915         10  FSTHD2A PIC  X(0001).
  1916     05  FSTHD2I PIC  X(0023).
  1917*    -------------------------------
  1918     05  NFSTPMTL PIC S9(0004) COMP.
  1919     05  NFSTPMTF PIC  X(0001).
  1920     05  FILLER REDEFINES NFSTPMTF.
  1921         10  NFSTPMTA PIC  X(0001).
  1922     05  NFSTPMTI PIC  X(0008).
  1923*    -------------------------------
  1924     05  NFSTAMTL PIC S9(0004) COMP.
  1925     05  NFSTAMTF PIC  X(0001).
  1926     05  FILLER REDEFINES NFSTAMTF.
  1927         10  NFSTAMTA PIC  X(0001).
  1928     05  NFSTAMTI PIC  S9(8)V99.
  1929*    -------------------------------
  1930     05  LSTHD2L PIC S9(0004) COMP.
  1931     05  LSTHD2F PIC  X(0001).
  1932     05  FILLER REDEFINES LSTHD2F.
  1933         10  LSTHD2A PIC  X(0001).
  1934     05  LSTHD2I PIC  X(0023).
  1935*    -------------------------------
  1936     05  NLSTPMTL PIC S9(0004) COMP.
  1937     05  NLSTPMTF PIC  X(0001).
  1938     05  FILLER REDEFINES NLSTPMTF.
  1939         10  NLSTPMTA PIC  X(0001).
  1940     05  NLSTPMTI PIC  X(0008).
  1941*    -------------------------------
  1942     05  NEFFDTEL PIC S9(0004) COMP.
  1943     05  NEFFDTEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  40
* EL154.cbl
  1944     05  FILLER REDEFINES NEFFDTEF.
  1945         10  NEFFDTEA PIC  X(0001).
  1946     05  NEFFDTEI PIC  X(0008).
  1947*    -------------------------------
  1948     05  NMONTHSL PIC S9(0004) COMP.
  1949     05  NMONTHSF PIC  X(0001).
  1950     05  FILLER REDEFINES NMONTHSF.
  1951         10  NMONTHSA PIC  X(0001).
  1952     05  NMONTHSI PIC  99.
  1953*    -------------------------------
  1954     05  NDAYSFL PIC S9(0004) COMP.
  1955     05  NDAYSFF PIC  X(0001).
  1956     05  FILLER REDEFINES NDAYSFF.
  1957         10  NDAYSFA PIC  X(0001).
  1958     05  NDAYSFI PIC  999.
  1959*    -------------------------------
  1960     05  NPAYEEL PIC S9(0004) COMP.
  1961     05  NPAYEEF PIC  X(0001).
  1962     05  FILLER REDEFINES NPAYEEF.
  1963         10  NPAYEEA PIC  X(0001).
  1964     05  NPAYEEI PIC  X(0002).
  1965*    -------------------------------
  1966     05  NREGAMTL PIC S9(0004) COMP.
  1967     05  NREGAMTF PIC  X(0001).
  1968     05  FILLER REDEFINES NREGAMTF.
  1969         10  NREGAMTA PIC  X(0001).
  1970     05  NREGAMTI PIC  X(0010).
  1971*    -------------------------------
  1972     05  NLASTL PIC S9(0004) COMP.
  1973     05  NLASTF PIC  X(0001).
  1974     05  FILLER REDEFINES NLASTF.
  1975         10  NLASTA PIC  X(0001).
  1976     05  NLASTI PIC  X(0001).
  1977*    -------------------------------
  1978     05  NINDCTRL PIC S9(0004) COMP.
  1979     05  NINDCTRF PIC  X(0001).
  1980     05  FILLER REDEFINES NINDCTRF.
  1981         10  NINDCTRA PIC  X(0001).
  1982     05  NINDCTRI PIC  X(0001).
  1983*    -------------------------------
  1984     05  DAYPAYL PIC S9(0004) COMP.
  1985     05  DAYPAYF PIC  X(0001).
  1986     05  FILLER REDEFINES DAYPAYF.
  1987         10  DAYPAYA PIC  X(0001).
  1988     05  DAYPAYI PIC  99.
  1989*    -------------------------------
  1990     05  NPRINTL PIC S9(0004) COMP.
  1991     05  NPRINTF PIC  X(0001).
  1992     05  FILLER REDEFINES NPRINTF.
  1993         10  NPRINTA PIC  X(0001).
  1994     05  NPRINTI PIC  X(0004).
  1995*    -------------------------------
  1996     05  LETTDTEL PIC S9(0004) COMP.
  1997     05  LETTDTEF PIC  X(0001).
  1998     05  FILLER REDEFINES LETTDTEF.
  1999         10  LETTDTEA PIC  X(0001).
  2000     05  LETTDTEI PIC  X(0008).
  2001*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  41
* EL154.cbl
  2002     05  ENDLETTL PIC S9(0004) COMP.
  2003     05  ENDLETTF PIC  X(0001).
  2004     05  FILLER REDEFINES ENDLETTF.
  2005         10  ENDLETTA PIC  X(0001).
  2006     05  ENDLETTI PIC  X(0004).
  2007*    -------------------------------
  2008     05  ERRMSG1L PIC S9(0004) COMP.
  2009     05  ERRMSG1F PIC  X(0001).
  2010     05  FILLER REDEFINES ERRMSG1F.
  2011         10  ERRMSG1A PIC  X(0001).
  2012     05  ERRMSG1I PIC  X(0079).
  2013*    -------------------------------
  2014     05  ERRMSG2L PIC S9(0004) COMP.
  2015     05  ERRMSG2F PIC  X(0001).
  2016     05  FILLER REDEFINES ERRMSG2F.
  2017         10  ERRMSG2A PIC  X(0001).
  2018     05  ERRMSG2I PIC  X(0079).
  2019*    -------------------------------
  2020     05  ENTERPFL PIC S9(0004) COMP.
  2021     05  ENTERPFF PIC  X(0001).
  2022     05  FILLER REDEFINES ENTERPFF.
  2023         10  ENTERPFA PIC  X(0001).
  2024     05  ENTERPFI PIC  99.
  2025 01  EL154AO REDEFINES EL154AI.
  2026     05  FILLER            PIC  X(0012).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  RUNDTEO PIC  X(0008).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  RUNTIMEO PIC  99.99.
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  CLAIMO PIC  X(0007).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  CARRO PIC  X(0001).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  CERTO PIC  X(0010).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  SUFFIXO PIC  X(0001).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  CESTDTEO PIC  X(0008).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  CESTBYO PIC  X(0004).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  FSTHD1O PIC  X(0023).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  CFSTPMTO PIC  X(0008).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  CMONTHSO PIC  99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  42
* EL154.cbl
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  CFSTAMTO PIC  ZZ,ZZ9.99.
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  LSTHD1O PIC  X(0024).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  CLSTPMTO PIC  X(0008).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  CLASTO PIC  X(0001).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  CREGPMTO PIC  ZZ,ZZ9.99.
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  CDAYSFO PIC  ZZ9.
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  CPAYEEO PIC  X(0008).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  DAY2PAYO PIC  X(0002).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  CEFFDTEO PIC  X(0008).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  TERMO PIC  X(0001).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  CINDCTRO PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  PRINTO PIC  X(0004).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  FSTHD2O PIC  X(0023).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  NFSTPMTO PIC  99B99B99.
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  NFSTAMTO PIC  ZZ,ZZZ.99-.
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  LSTHD2O PIC  X(0023).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  NLSTPMTO PIC  99B99B99.
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  NEFFDTEO PIC  99B99B99.
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  NMONTHSO PIC  X(0002).
  2117*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  43
* EL154.cbl
  2118     05  FILLER            PIC  X(0003).
  2119     05  NDAYSFO PIC  X(0003).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  NPAYEEO PIC  X(0002).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  NREGAMTO PIC  ZZ,ZZZ.99-.
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  NLASTO PIC  X(0001).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  NINDCTRO PIC  X(0001).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  DAYPAYO PIC  X(0002).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  NPRINTO PIC  X(0004).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  LETTDTEO PIC  99B99B99.
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  ENDLETTO PIC  X(0004).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  ERRMSG1O PIC  X(0079).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  ERRMSG2O PIC  X(0079).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  ENTERPFO PIC  X(0002).
  2153*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  44
* EL154.cbl
  2155****************************************************************
  2156*
  2157* Copyright (c) 2007-2013 Dell Inc.
  2158* All rights reserved.
  2159*
  2160****************************************************************
  2161 01  DFHEIV.
  2162   02  DFHEIV0               PIC X(35).
  2163   02  DFHEIV1               PIC X(08).
  2164   02  DFHEIV2               PIC X(08).
  2165   02  DFHEIV3               PIC X(08).
  2166   02  DFHEIV4               PIC X(06).
  2167   02  DFHEIV5               PIC X(04).
  2168   02  DFHEIV6               PIC X(04).
  2169   02  DFHEIV7               PIC X(02).
  2170   02  DFHEIV8               PIC X(02).
  2171   02  DFHEIV9               PIC X(01).
  2172   02  DFHEIV10              PIC S9(7) COMP-3.
  2173   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2174   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2175   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2176   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2177   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2178   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2179   02  DFHEIV17              PIC X(04).
  2180   02  DFHEIV18              PIC X(04).
  2181   02  DFHEIV19              PIC X(04).
  2182   02  DFHEIV20              USAGE IS POINTER.
  2183   02  DFHEIV21              USAGE IS POINTER.
  2184   02  DFHEIV22              USAGE IS POINTER.
  2185   02  DFHEIV23              USAGE IS POINTER.
  2186   02  DFHEIV24              USAGE IS POINTER.
  2187   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2188   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2189   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2190   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2191   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2192   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2193   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2194   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2195   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2196   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2197   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2198   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2199   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2200   02  FILLER                PIC X(02).
  2201   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2202   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2203   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2204   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2205   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2206   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2207   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2208 LINKAGE  SECTION.
  2209*****************************************************************
  2210*                                                               *
  2211* Copyright (c) 2007-2013 Dell Inc.                             *
  2212* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  45
* EL154.cbl
  2213*                                                               *
  2214*****************************************************************
  2215 01  dfheiblk.
  2216     02  eibtime          pic s9(7) comp-3.
  2217     02  eibdate          pic s9(7) comp-3.
  2218     02  eibtrnid         pic x(4).
  2219     02  eibtaskn         pic s9(7) comp-3.
  2220     02  eibtrmid         pic x(4).
  2221     02  dfheigdi         pic s9(4) comp.
  2222     02  eibcposn         pic s9(4) comp.
  2223     02  eibcalen         pic s9(4) comp.
  2224     02  eibaid           pic x(1).
  2225     02  eibfiller1       pic x(1).
  2226     02  eibfn            pic x(2).
  2227     02  eibfiller2       pic x(2).
  2228     02  eibrcode         pic x(6).
  2229     02  eibfiller3       pic x(2).
  2230     02  eibds            pic x(8).
  2231     02  eibreqid         pic x(8).
  2232     02  eibrsrce         pic x(8).
  2233     02  eibsync          pic x(1).
  2234     02  eibfree          pic x(1).
  2235     02  eibrecv          pic x(1).
  2236     02  eibsend          pic x(1).
  2237     02  eibatt           pic x(1).
  2238     02  eibeoc           pic x(1).
  2239     02  eibfmh           pic x(1).
  2240     02  eibcompl         pic x(1).
  2241     02  eibsig           pic x(1).
  2242     02  eibconf          pic x(1).
  2243     02  eiberr           pic x(1).
  2244     02  eibrldbk         pic x(1).
  2245     02  eiberrcd         pic x(4).
  2246     02  eibsynrb         pic x(1).
  2247     02  eibnodat         pic x(1).
  2248     02  eibfiller5       pic x(2).
  2249     02  eibresp          pic s9(8) comp.
  2250     02  eibresp2         pic s9(8) comp.
  2251     02  dfheigdj         pic s9(4) comp.
  2252     02  dfheigdk         pic s9(4) comp.
  2253 01  DFHCOMMAREA             PIC X(1024).
  2254
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  46
* EL154.cbl
  2256*                            COPY ELCCNTL.
  2257******************************************************************
  2258*                                                                *
  2259*                                                                *
  2260*                            ELCCNTL.                            *
  2261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2262*                            VMOD=2.059                          *
  2263*                                                                *
  2264*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2265*                                                                *
  2266*   FILE TYPE = VSAM,KSDS                                        *
  2267*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2268*                                                                *
  2269*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2270*       ALTERNATE INDEX = NONE                                   *
  2271*                                                                *
  2272*   LOG = YES                                                    *
  2273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2274******************************************************************
  2275*                   C H A N G E   L O G
  2276*
  2277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2278*-----------------------------------------------------------------
  2279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2280* EFFECTIVE    NUMBER
  2281*-----------------------------------------------------------------
  2282* 082503                   PEMA  ADD BENEFIT GROUP
  2283* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2284* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2285* 092705    2005050300006  PEMA  ADD SPP LEASES
  2286* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2287* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2288* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2289* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2290* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2291* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2292* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2293* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2294* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2295* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2296* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2297******************************************************************
  2298*
  2299 01  CONTROL-FILE.
  2300     12  CF-RECORD-ID                       PIC XX.
  2301         88  VALID-CF-ID                        VALUE 'CF'.
  2302
  2303     12  CF-CONTROL-PRIMARY.
  2304         16  CF-COMPANY-ID                  PIC XXX.
  2305         16  CF-RECORD-TYPE                 PIC X.
  2306             88  CF-COMPANY-MASTER              VALUE '1'.
  2307             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2308             88  CF-STATE-MASTER                VALUE '3'.
  2309             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2310             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2311             88  CF-CARRIER-MASTER              VALUE '6'.
  2312             88  CF-MORTALITY-MASTER            VALUE '7'.
  2313             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  47
* EL154.cbl
  2314             88  CF-TERMINAL-MASTER             VALUE '9'.
  2315             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2316             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2317             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2318             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2319             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2320             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2321             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2322             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2323             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2324         16  CF-ACCESS-CD-GENL              PIC X(4).
  2325         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2326             20  CF-PROCESSOR               PIC X(4).
  2327         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2328             20  CF-STATE-CODE              PIC XX.
  2329             20  FILLER                     PIC XX.
  2330         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2331             20  FILLER                     PIC XX.
  2332             20  CF-HI-BEN-IN-REC           PIC XX.
  2333         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2334             20  FILLER                     PIC XXX.
  2335             20  CF-CARRIER-CNTL            PIC X.
  2336         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2337             20  FILLER                     PIC XX.
  2338             20  CF-HI-TYPE-IN-REC          PIC 99.
  2339         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2340             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2341                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2342             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2343             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2344         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2345             20  FILLER                     PIC X.
  2346             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2347         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2348             20  FILLER                     PIC XX.
  2349             20  CF-MORTGAGE-PLAN           PIC XX.
  2350         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2351
  2352     12  CF-LAST-MAINT-DT                   PIC XX.
  2353     12  CF-LAST-MAINT-BY                   PIC X(4).
  2354     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2355
  2356     12  CF-RECORD-BODY                     PIC X(728).
  2357
  2358
  2359****************************************************************
  2360*             COMPANY MASTER RECORD                            *
  2361****************************************************************
  2362
  2363     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2364         16  CF-COMPANY-ADDRESS.
  2365             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2366             20  CF-CL-IN-CARE-OF           PIC X(30).
  2367             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2368             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2369             20  CF-CL-CITY-STATE           PIC X(30).
  2370             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2371             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  48
* EL154.cbl
  2372         16  CF-COMPANY-CD                  PIC X.
  2373         16  CF-COMPANY-PASSWORD            PIC X(8).
  2374         16  CF-SECURITY-OPTION             PIC X.
  2375             88  ALL-SECURITY                   VALUE '1'.
  2376             88  COMPANY-VERIFY                 VALUE '2'.
  2377             88  PROCESSOR-VERIFY               VALUE '3'.
  2378             88  NO-SECURITY                    VALUE '4'.
  2379             88  ALL-BUT-TERM                   VALUE '5'.
  2380         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2381             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2382         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2383             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2384         16  CF-INFORCE-LOCATION            PIC X.
  2385             88  CERTS-ARE-ONLINE               VALUE '1'.
  2386             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2387             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2388         16  CF-LOWER-CASE-LETTERS          PIC X.
  2389         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2390             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2391             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2392             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2393             88  CF-ACCNT-CNTL                  VALUE '3'.
  2394             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2395
  2396         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2397         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2398
  2399         16  CF-LGX-CREDIT-USER             PIC X.
  2400             88  CO-IS-NOT-USER                 VALUE 'N'.
  2401             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2402
  2403         16 CF-CREDIT-CALC-CODES.
  2404             20  CF-CR-REM-TERM-CALC PIC X.
  2405               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2406               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2407               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2408               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2409               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2410               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2411               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2412             20  CF-CR-R78-METHOD           PIC X.
  2413               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2414               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2415
  2416         16  CF-CLAIM-CONTROL-COUNTS.
  2417             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2418                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2419
  2420             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2421                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2422
  2423             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2424                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2425
  2426             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2427                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2428
  2429         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  49
* EL154.cbl
  2430
  2431         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2432             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2433             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2434             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2435             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2436                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2437                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2438             20  CF-CO-PREM-REJECT-SW       PIC X.
  2439                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2440                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2441             20  CF-CO-REF-REJECT-SW        PIC X.
  2442                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2443                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2444
  2445         16  CF-CO-REPORTING-DT             PIC XX.
  2446         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2447         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2448           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2449           88  CF-CO-MONTH-END                  VALUE '1'.
  2450
  2451         16  CF-LGX-CLAIM-USER              PIC X.
  2452             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2453             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2454
  2455         16  CF-CREDIT-EDIT-CONTROLS.
  2456             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2457             20  CF-MIN-AGE                 PIC 99.
  2458             20  CF-DEFAULT-AGE             PIC 99.
  2459             20  CF-MIN-TERM                PIC S999      COMP-3.
  2460             20  CF-MAX-TERM                PIC S999      COMP-3.
  2461             20  CF-DEFAULT-SEX             PIC X.
  2462             20  CF-JOINT-AGE-INPUT         PIC X.
  2463                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2464             20  CF-BIRTH-DATE-INPUT        PIC X.
  2465                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2466             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2467                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2468                 88  CF-ZERO-CARRIER            VALUE '1'.
  2469                 88  CF-ZERO-GROUPING           VALUE '2'.
  2470                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2471             20  CF-EDIT-SW                 PIC X.
  2472                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2473             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2474             20  CF-CR-PR-METHOD            PIC X.
  2475               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2476               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2477             20  FILLER                     PIC X.
  2478
  2479         16  CF-CREDIT-MISC-CONTROLS.
  2480             20  CF-REIN-TABLE-SW           PIC X.
  2481                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2482             20  CF-COMP-TABLE-SW           PIC X.
  2483                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2484             20  CF-EXPERIENCE-RETENTION-AGE
  2485                                            PIC S9        COMP-3.
  2486             20  CF-CONVERSION-DT           PIC XX.
  2487             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  50
* EL154.cbl
  2488             20  CF-RUN-FREQUENCY-SW        PIC X.
  2489                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2490                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2491
  2492             20  CF-CR-CHECK-NO-CONTROL.
  2493                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2494                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2495                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2496                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2497                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2498                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2499
  2500                 24  CF-CR-CHECK-COUNT       REDEFINES
  2501                     CF-CR-CHECK-COUNTER      PIC X(4).
  2502
  2503                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2504                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2505
  2506                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2507                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2508                 24  CF-MAIL-PROCESSING       PIC X.
  2509                     88  MAIL-PROCESSING          VALUE 'Y'.
  2510
  2511         16  CF-MISC-SYSTEM-CONTROL.
  2512             20  CF-SYSTEM-C                 PIC X.
  2513                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2514             20  CF-SYSTEM-D                 PIC X.
  2515                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2516             20  CF-SOC-SEC-NO-SW            PIC X.
  2517                 88  SOC-SEC-NO-USED             VALUE '1'.
  2518             20  CF-MEMBER-NO-SW             PIC X.
  2519                 88  MEMBER-NO-USED              VALUE '1'.
  2520             20  CF-TAX-ID-NUMBER            PIC X(11).
  2521             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2522             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2523                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2524                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2525                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2526                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2527             20  CF-SYSTEM-E                 PIC X.
  2528                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2529
  2530         16  CF-LGX-LIFE-USER               PIC X.
  2531             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2532             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2533
  2534         16  CF-CR-MONTH-END-DT             PIC XX.
  2535
  2536         16  CF-FILE-MAINT-DATES.
  2537             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2538                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2539             20  CF-LAST-BATCH       REDEFINES
  2540                 CF-LAST-BATCH-NO               PIC X(4).
  2541             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2542             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2543             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2544             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2545             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  51
* EL154.cbl
  2546             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2547             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2548             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2549             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2550             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2551
  2552         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2553         16  FILLER                         PIC X.
  2554
  2555         16  CF-ALT-MORT-CODE               PIC X(4).
  2556         16  CF-MEMBER-CAPTION              PIC X(10).
  2557
  2558         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2559             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2560             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2561             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2562             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2563             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2564
  2565         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2566
  2567         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2568         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2569         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2570         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2571
  2572         16  CF-AH-OVERRIDE-L1              PIC X.
  2573         16  CF-AH-OVERRIDE-L2              PIC XX.
  2574         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2575         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2576
  2577         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2578         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2579
  2580         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2581         16  CF-AR-LAST-EL860-DT            PIC XX.
  2582         16  CF-MP-MONTH-END-DT             PIC XX.
  2583
  2584         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2585         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2586             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2587
  2588         16  CF-AR-MONTH-END-DT             PIC XX.
  2589
  2590         16  CF-CRDTCRD-USER                PIC X.
  2591             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2592             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2593
  2594         16  CF-CC-MONTH-END-DT             PIC XX.
  2595
  2596         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2597
  2598         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2599             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2600             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2601             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2602         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2603         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  52
* EL154.cbl
  2604         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2605         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2606             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2607             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2608         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2609         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2610         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2611             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2612         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2613
  2614         16  CF-CL-ZIP-CODE.
  2615             20  CF-CL-ZIP-PRIME.
  2616                 24  CF-CL-ZIP-1ST          PIC X.
  2617                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2618                 24  FILLER                 PIC X(4).
  2619             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2620         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2621             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2622             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2623             20  FILLER                     PIC XXX.
  2624
  2625         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2626         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2627         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2628         16  CF-CO-OPTION-START-DATE        PIC XX.
  2629         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2630           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2631                                                      '3' '4'.
  2632           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2633           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2634           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2635           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2636           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2637           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2638
  2639         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2640
  2641         16  CF-PAYMENT-APPROVAL-LEVELS.
  2642             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2643             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2644             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2645             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2646             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2647             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2648
  2649         16  CF-END-USER-REPORTING-USER     PIC X.
  2650             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2651             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2652
  2653         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2654             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2655             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2656
  2657         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2658
  2659         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2660         16  FILLER                         PIC X.
  2661
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  53
* EL154.cbl
  2662         16  CF-CREDIT-ARCHIVE-CNTL.
  2663             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2664             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2665             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2666
  2667         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2668
  2669         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2670             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2671             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2672
  2673         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2674             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2675             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2676
  2677         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2678
  2679         16  CF-CO-ACH-ID-CODE              PIC  X.
  2680             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2681             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2682             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2683         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2684         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2685         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2686         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2687         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2688         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2689         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2690         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2691         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2692                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2693         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2694                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2695
  2696         16  CF-CO-OVER-SHORT.
  2697             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2698             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2699
  2700*         16  FILLER                         PIC X(102).
  2701         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2702             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2703             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2704
  2705         16  CF-AH-APPROVAL-DAYS.
  2706             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2707             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2708             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2709             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2710
  2711         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2712
  2713         16  CF-APPROV-LEV-5.
  2714             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2715             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2716             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2717
  2718         16  FILLER                         PIC X(68).
  2719****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  54
* EL154.cbl
  2720*             PROCESSOR/USER RECORD                            *
  2721****************************************************************
  2722
  2723     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2724         16  CF-PROCESSOR-NAME              PIC X(30).
  2725         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2726         16  CF-PROCESSOR-TITLE             PIC X(26).
  2727         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2728                 88  MESSAGE-YES                VALUE 'Y'.
  2729                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2730
  2731*****************************************************
  2732****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2733****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2734****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2735****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2736*****************************************************
  2737
  2738         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2739             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2740             20  CF-APPLICATION-FORCE       PIC X.
  2741             20  CF-INDIVIDUAL-APP.
  2742                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2743                     28  CF-BROWSE-APP      PIC X.
  2744                     28  CF-UPDATE-APP      PIC X.
  2745
  2746         16  CF-CURRENT-TERM-ON             PIC X(4).
  2747         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2748             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2749             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2750             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2751             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2752             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2753             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2754             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2755         16  CF-PROCESSOR-CARRIER           PIC X.
  2756             88  NO-CARRIER-SECURITY            VALUE ' '.
  2757         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2758             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2759         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2760             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2761         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2762             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2763
  2764         16  CF-PROC-SYS-ACCESS-SW.
  2765             20  CF-PROC-CREDIT-CLAIMS-SW.
  2766                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2767                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2768                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2769                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2770             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2771                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2772                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2773             20  CF-PROC-LIFE-GNRLDGR-SW.
  2774                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2775                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2776                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2777                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  55
* EL154.cbl
  2778             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2779                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2780                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2781         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2782             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2783             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2784         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2785
  2786         16  CF-APPROVAL-LEVEL                  PIC X.
  2787             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2788             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2789             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2790             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2791             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2792
  2793         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2794
  2795         16  CF-LANGUAGE-TYPE                   PIC X.
  2796             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2797             88  CF-LANG-IS-FR                      VALUE 'F'.
  2798
  2799         16  CF-CSR-IND                         PIC X.
  2800         16  FILLER                             PIC X(239).
  2801
  2802****************************************************************
  2803*             PROCESSOR/REMINDERS RECORD                       *
  2804****************************************************************
  2805
  2806     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2807         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2808             20  CF-START-REMIND-DT         PIC XX.
  2809             20  CF-END-REMIND-DT           PIC XX.
  2810             20  CF-REMINDER-TEXT           PIC X(50).
  2811         16  FILLER                         PIC X(296).
  2812
  2813
  2814****************************************************************
  2815*             STATE MASTER RECORD                              *
  2816****************************************************************
  2817
  2818     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2819         16  CF-STATE-ABBREVIATION          PIC XX.
  2820         16  CF-STATE-NAME                  PIC X(25).
  2821         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2822         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2823             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2824             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2825             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2826             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2827                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2828                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2829             20  CF-ST-PREM-REJECT-SW       PIC X.
  2830                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2831                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2832             20  CF-ST-REF-REJECT-SW        PIC X.
  2833                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2834                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2835         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  56
* EL154.cbl
  2836         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2837         16  CF-ST-REFUND-RULES.
  2838             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2839             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2840             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2841         16  CF-ST-FST-PMT-EXTENSION.
  2842             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2843             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2844                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2845                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2846                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2847                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2848         16  CF-ST-STATE-CALL.
  2849             20  CF-ST-CALL-UNEARNED        PIC X.
  2850             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2851             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2852         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2853             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2854             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2855         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2856         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2857         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2858         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2859         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2860         16  FILLER                         PIC X.
  2861         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2862             20  CF-ST-BENEFIT-CD           PIC XX.
  2863             20  CF-ST-BENEFIT-KIND         PIC X.
  2864                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2865                 88  CF-ST-AH-KIND              VALUE 'A'.
  2866             20  CF-ST-REM-TERM-CALC        PIC X.
  2867                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2868                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2869                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2870                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2871                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2872                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2873                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2874                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2875
  2876             20  CF-ST-REFUND-CALC          PIC X.
  2877                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2878                 88  ST-REFD-BY-R78             VALUE '1'.
  2879                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2880                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2881                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2882                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2883                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2884                 88  ST-REFD-UTAH               VALUE '7'.
  2885                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2886                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2887                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2888
  2889             20  CF-ST-EARNING-CALC         PIC X.
  2890                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2891                 88  ST-EARN-BY-R78             VALUE '1'.
  2892                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2893                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  57
* EL154.cbl
  2894                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2895                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2896                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2897                 88  ST-EARN-MEAN               VALUE '8'.
  2898                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2899
  2900             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2901                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2902                 88  ST-OVRD-BY-R78             VALUE '1'.
  2903                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2904                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2905                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2906                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2907                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2908                 88  ST-OVRD-MEAN               VALUE '8'.
  2909                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2910             20  cf-st-extra-periods        pic 9.
  2911*            20  FILLER                     PIC X.
  2912
  2913         16  CF-ST-COMMISSION-CAPS.
  2914             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2915             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2916             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2917             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2918         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2919                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2920                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2921                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2922
  2923         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2924
  2925         16  CF-ST-STATUTORY-INTEREST.
  2926             20  CF-ST-STAT-DATE-FROM       PIC X.
  2927                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2928                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2929             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2930             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2931             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2932             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2933             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2934
  2935         16  CF-ST-OVER-SHORT.
  2936             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2937             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2938
  2939         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2940
  2941         16  CF-ST-RT-CALC                  PIC X.
  2942
  2943         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2944         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2945         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2946         16  CF-ST-RF-LR-CALC               PIC X.
  2947         16  CF-ST-RF-LL-CALC               PIC X.
  2948         16  CF-ST-RF-LN-CALC               PIC X.
  2949         16  CF-ST-RF-AH-CALC               PIC X.
  2950         16  CF-ST-RF-CP-CALC               PIC X.
  2951*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  58
* EL154.cbl
  2952*CIDMOD         16  FILLER                         PIC X(192).
  2953         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2954             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2955         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2956         16  CF-ST-VFY-2ND-BENE             PIC X.
  2957         16  CF-ST-CAUSAL-STATE             PIC X.
  2958         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2959         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2960         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2961             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2962         16  CF-ST-NET-ONLY-STATE           PIC X.
  2963             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2964         16  cf-commission-cap-required     pic x.
  2965         16  CF-ST-GA-COMMISSION-CAPS.
  2966             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2967             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2968             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2969             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2970         16  CF-ST-TOT-COMMISSION-CAPS.
  2971             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2972             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2973             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2974             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2975         16  FILLER                         PIC X(156).
  2976
  2977****************************************************************
  2978*             BENEFIT MASTER RECORD                            *
  2979****************************************************************
  2980
  2981     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2982         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2983             20  CF-BENEFIT-CODE            PIC XX.
  2984             20  CF-BENEFIT-NUMERIC  REDEFINES
  2985                 CF-BENEFIT-CODE            PIC XX.
  2986             20  CF-BENEFIT-ALPHA           PIC XXX.
  2987             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2988             20  CF-BENEFIT-COMMENT         PIC X(10).
  2989
  2990             20  CF-LF-COVERAGE-TYPE        PIC X.
  2991                 88  CF-REDUCING                VALUE 'R'.
  2992                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2993
  2994             20  CF-SPECIAL-CALC-CD         PIC X.
  2995                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2996                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2997                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2998                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2999                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3000                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3001                 88  CF-FARM-PLAN               VALUE 'F'.
  3002                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3003                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3004                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3005                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3006                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3007                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3008                 88  CF-PRUDENTIAL              VALUE 'P'.
  3009                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  59
* EL154.cbl
  3010                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3011                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3012                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3013                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3014                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3015
  3016             20  CF-JOINT-INDICATOR         PIC X.
  3017                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3018
  3019*            20  FILLER                     PIC X(12).
  3020             20  cf-maximum-benefits        pic s999 comp-3.
  3021             20  FILLER                     PIC X(09).
  3022             20  CF-BENEFIT-CATEGORY        PIC X.
  3023             20  CF-LOAN-TYPE               PIC X(8).
  3024
  3025             20  CF-CO-REM-TERM-CALC        PIC X.
  3026                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3027                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3028                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3029                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3030                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3031
  3032             20  CF-CO-EARNINGS-CALC        PIC X.
  3033                 88  CO-EARN-BY-R78             VALUE '1'.
  3034                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3035                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3036                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3037                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3038                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3039                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3040                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3041
  3042             20  CF-CO-REFUND-CALC          PIC X.
  3043                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3044                 88  CO-REFD-BY-R78             VALUE '1'.
  3045                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3046                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3047                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3048                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3049                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3050                 88  CO-REFD-MEAN               VALUE '8'.
  3051                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3052                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3053                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3054
  3055             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3056                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3057                 88  CO-OVRD-BY-R78             VALUE '1'.
  3058                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3059                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3060                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3061                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3062                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3063                 88  CO-OVRD-MEAN               VALUE '8'.
  3064                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3065
  3066             20  CF-CO-BEN-I-G-CD           PIC X.
  3067                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  60
* EL154.cbl
  3068                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3069                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3070
  3071         16  FILLER                         PIC X(304).
  3072
  3073
  3074****************************************************************
  3075*             CARRIER MASTER RECORD                            *
  3076****************************************************************
  3077
  3078     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3079         16  CF-ADDRESS-DATA.
  3080             20  CF-MAIL-TO-NAME            PIC X(30).
  3081             20  CF-IN-CARE-OF              PIC X(30).
  3082             20  CF-ADDRESS-LINE-1          PIC X(30).
  3083             20  CF-ADDRESS-LINE-2          PIC X(30).
  3084             20  CF-CITY-STATE              PIC X(30).
  3085             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3086             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3087
  3088         16  CF-CLAIM-NO-CONTROL.
  3089             20  CF-CLAIM-NO-METHOD         PIC X.
  3090                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3091                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3092                 88  CLAIM-NO-SEQ               VALUE '3'.
  3093                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3094             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3095                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3096                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3097                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3098
  3099         16  CF-CHECK-NO-CONTROL.
  3100             20  CF-CHECK-NO-METHOD         PIC X.
  3101                 88  CHECK-NO-MANUAL            VALUE '1'.
  3102                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3103                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3104                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3105             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3106                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3107
  3108         16  CF-DOMICILE-STATE              PIC XX.
  3109
  3110         16  CF-EXPENSE-CONTROLS.
  3111             20  CF-EXPENSE-METHOD          PIC X.
  3112                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3113                 88  DOLLARS-PER-PMT            VALUE '2'.
  3114                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3115                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3116             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3117             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3118
  3119         16  CF-CORRESPONDENCE-CONTROL.
  3120             20  CF-LETTER-RESEND-OPT       PIC X.
  3121                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3122                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3123             20  FILLER                     PIC X(4).
  3124
  3125         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  61
* EL154.cbl
  3126             20  CF-MANUAL-SW               PIC X.
  3127                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3128             20  CF-FUTURE-SW               PIC X.
  3129                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3130             20  CF-PTC-SW                  PIC X.
  3131                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3132             20  CF-IBNR-SW                 PIC X.
  3133                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3134             20  CF-PTC-LF-SW               PIC X.
  3135                 88  CF-LF-PTC-USED             VALUE '1'.
  3136             20  CF-CDT-ACCESS-METHOD       PIC X.
  3137                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3138                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3139                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3140             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3141
  3142         16  CF-CLAIM-CALC-METHOD           PIC X.
  3143             88  360-PLUS-MONTHS                VALUE '1'.
  3144             88  365-PLUS-MONTHS                VALUE '2'.
  3145             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3146             88  360-DAILY                      VALUE '4'.
  3147             88  365-DAILY                      VALUE '5'.
  3148
  3149         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3150         16  FILLER                         PIC X(11).
  3151
  3152         16  CF-LIMIT-AMOUNTS.
  3153             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3154             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3155             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3156             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3157             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3158             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3159             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3160             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3161             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3162             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3163
  3164         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3165         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3166         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3167
  3168         16  CF-ZIP-CODE.
  3169             20  CF-ZIP-PRIME.
  3170                 24  CF-ZIP-1ST             PIC X.
  3171                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3172                 24  FILLER                 PIC X(4).
  3173             20  CF-ZIP-PLUS4               PIC X(4).
  3174         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3175             20  CF-CAN-POSTAL-1            PIC XXX.
  3176             20  CF-CAN-POSTAL-2            PIC XXX.
  3177             20  FILLER                     PIC XXX.
  3178
  3179         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3180         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3181         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3182
  3183         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  62
* EL154.cbl
  3184             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3185             88  CF-NO-RATING                   VALUE 'N'.
  3186
  3187         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3188
  3189         16  CF-CARRIER-OVER-SHORT.
  3190             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3191             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3192
  3193         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3194         16  CF-SECPAY-SWITCH               PIC X.
  3195             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3196             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3197         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3198         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3199         16  FILLER                         PIC X(444).
  3200*        16  FILLER                         PIC X(452).
  3201
  3202
  3203****************************************************************
  3204*             MORTALITY MASTER RECORD                          *
  3205****************************************************************
  3206
  3207     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3208         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3209                                INDEXED BY CF-MORT-NDX.
  3210             20  CF-MORT-TABLE              PIC X(5).
  3211             20  CF-MORT-TABLE-TYPE         PIC X.
  3212                 88  CF-MORT-JOINT              VALUE 'J'.
  3213                 88  CF-MORT-SINGLE             VALUE 'S'.
  3214                 88  CF-MORT-COMBINED           VALUE 'C'.
  3215                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3216                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3217             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3218             20  CF-MORT-AGE-METHOD         PIC XX.
  3219                 88  CF-AGE-LAST                VALUE 'AL'.
  3220                 88  CF-AGE-NEAR                VALUE 'AN'.
  3221             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3222             20  CF-MORT-ADJUSTMENT-DIRECTION
  3223                                            PIC X.
  3224                 88  CF-MINUS                   VALUE '-'.
  3225                 88  CF-PLUS                    VALUE '+'.
  3226             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3227             20  CF-MORT-JOINT-CODE         PIC X.
  3228                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3229             20  CF-MORT-PC-Q               PIC X.
  3230                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3231             20  CF-MORT-TABLE-CODE         PIC X(4).
  3232             20  CF-MORT-COMMENTS           PIC X(15).
  3233             20  FILLER                     PIC X(14).
  3234
  3235         16  FILLER                         PIC X(251).
  3236
  3237
  3238****************************************************************
  3239*             BUSSINESS TYPE MASTER RECORD                     *
  3240****************************************************************
  3241
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  63
* EL154.cbl
  3242     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3243* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3244* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3245* AND RECORD 05 IS TYPES 81-99
  3246         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3247             20  CF-BUSINESS-TITLE          PIC  X(19).
  3248             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3249                                            PIC S9V9(4) COMP-3.
  3250             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3251             20  FILLER                     PIC  X.
  3252         16  FILLER                         PIC  X(248).
  3253
  3254
  3255****************************************************************
  3256*             TERMINAL MASTER RECORD                           *
  3257****************************************************************
  3258
  3259     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3260
  3261         16  CF-COMPANY-TERMINALS.
  3262             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3263                                  PIC X(4).
  3264         16  FILLER               PIC X(248).
  3265
  3266
  3267****************************************************************
  3268*             LIFE EDIT MASTER RECORD                          *
  3269****************************************************************
  3270
  3271     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3272         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3273             20  CF-LIFE-CODE-IN            PIC XX.
  3274             20  CF-LIFE-CODE-OUT           PIC XX.
  3275         16  FILLER                         PIC X(248).
  3276
  3277
  3278****************************************************************
  3279*             AH EDIT MASTER RECORD                            *
  3280****************************************************************
  3281
  3282     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3283         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3284             20  CF-AH-CODE-IN              PIC XXX.
  3285             20  CF-AH-CODE-OUT             PIC XX.
  3286         16  FILLER                         PIC X(248).
  3287
  3288
  3289****************************************************************
  3290*             CREDIBILITY TABLES                               *
  3291****************************************************************
  3292
  3293     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3294         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3295                             INDEXED BY CF-CRDB-NDX.
  3296             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3297             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3298             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3299         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  64
* EL154.cbl
  3300
  3301
  3302****************************************************************
  3303*             REPORT CUSTOMIZATION RECORD                      *
  3304****************************************************************
  3305
  3306     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3307         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3308             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3309             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3310             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3311**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3312****       A T-TRANSFER.                                   ****
  3313             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3314
  3315         16  FILLER                         PIC XX.
  3316
  3317         16  CF-CARRIER-CNTL-OPT.
  3318             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3319                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3320                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3321             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3322                                            PIC X.
  3323         16  CF-GROUP-CNTL-OPT.
  3324             20  CF-GROUP-OPT-SEQ           PIC 9.
  3325                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3326                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3327             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3328                                            PIC X(6).
  3329         16  CF-STATE-CNTL-OPT.
  3330             20  CF-STATE-OPT-SEQ           PIC 9.
  3331                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3332                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3333             20  CF-STATE-SELECT OCCURS 3 TIMES
  3334                                            PIC XX.
  3335         16  CF-ACCOUNT-CNTL-OPT.
  3336             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3337                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3338                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3339             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3340                                            PIC X(10).
  3341         16  CF-BUS-TYP-CNTL-OPT.
  3342             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3343                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3344                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3345             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3346                                            PIC XX.
  3347         16  CF-LF-TYP-CNTL-OPT.
  3348             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3349                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3350                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3351             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3352                                            PIC XX.
  3353         16  CF-AH-TYP-CNTL-OPT.
  3354             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3355                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3356                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3357             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  65
* EL154.cbl
  3358                                            PIC XX.
  3359         16  CF-REPTCD1-CNTL-OPT.
  3360             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3361                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3362                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3363             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3364                                            PIC X(10).
  3365         16  CF-REPTCD2-CNTL-OPT.
  3366             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3367                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3368                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3369             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3370                                            PIC X(10).
  3371         16  CF-USER1-CNTL-OPT.
  3372             20  CF-USER1-OPT-SEQ           PIC 9.
  3373                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3374                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3375             20  CF-USER1-SELECT OCCURS 3 TIMES
  3376                                            PIC X(10).
  3377         16  CF-USER2-CNTL-OPT.
  3378             20  CF-USER2-OPT-SEQ           PIC 9.
  3379                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3380                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3381             20  CF-USER2-SELECT OCCURS 3 TIMES
  3382                                            PIC X(10).
  3383         16  CF-USER3-CNTL-OPT.
  3384             20  CF-USER3-OPT-SEQ           PIC 9.
  3385                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3386                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3387             20  CF-USER3-SELECT OCCURS 3 TIMES
  3388                                            PIC X(10).
  3389         16  CF-USER4-CNTL-OPT.
  3390             20  CF-USER4-OPT-SEQ           PIC 9.
  3391                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3392                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3393             20  CF-USER4-SELECT OCCURS 3 TIMES
  3394                                            PIC X(10).
  3395         16  CF-USER5-CNTL-OPT.
  3396             20  CF-USER5-OPT-SEQ           PIC 9.
  3397                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3398                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3399             20  CF-USER5-SELECT OCCURS 3 TIMES
  3400                                            PIC X(10).
  3401         16  CF-REINS-CNTL-OPT.
  3402             20  CF-REINS-OPT-SEQ           PIC 9.
  3403                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3404                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3405             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3406                 24  CF-REINS-PRIME         PIC XXX.
  3407                 24  CF-REINS-SUB           PIC XXX.
  3408
  3409         16  CF-AGENT-CNTL-OPT.
  3410             20  CF-AGENT-OPT-SEQ           PIC 9.
  3411                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3412                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3413             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3414                                            PIC X(10).
  3415
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  66
* EL154.cbl
  3416         16  FILLER                         PIC X(43).
  3417
  3418         16  CF-LOSS-RATIO-SELECT.
  3419             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3420             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3421         16  CF-ENTRY-DATE-SELECT.
  3422             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3423             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3424         16  CF-EFFECTIVE-DATE-SELECT.
  3425             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3426             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3427
  3428         16  CF-EXCEPTION-LIST-IND          PIC X.
  3429             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3430
  3431         16  FILLER                         PIC X(318).
  3432
  3433****************************************************************
  3434*                  EXCEPTION REPORTING RECORD                  *
  3435****************************************************************
  3436
  3437     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3438         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3439             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3440
  3441         16  CF-COMBINED-LIFE-AH-OPT.
  3442             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3443             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3444             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3445             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3446
  3447         16  CF-LIFE-OPT.
  3448             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3449             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3450             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3451             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3452             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3453             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3454             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3455             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3456             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3457             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3458
  3459         16  CF-AH-OPT.
  3460             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3461             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3462             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3463             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3464             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3465             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3466             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3467             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3468             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3469             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3470
  3471         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3472             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3473             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  67
* EL154.cbl
  3474             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3475
  3476         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3477
  3478         16  FILLER                         PIC X(673).
  3479
  3480
  3481****************************************************************
  3482*             MORTGAGE SYSTEM PLAN RECORD                      *
  3483****************************************************************
  3484
  3485     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3486         16  CF-PLAN-TYPE                   PIC X.
  3487             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3488             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3489             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3490         16  CF-PLAN-ABBREV                 PIC XXX.
  3491         16  CF-PLAN-DESCRIPT               PIC X(10).
  3492         16  CF-PLAN-NOTES                  PIC X(20).
  3493         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3494         16  CF-PLAN-UNDERWRITING.
  3495             20  CF-PLAN-TERM-DATA.
  3496                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3497                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3498             20  CF-PLAN-AGE-DATA.
  3499                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3500                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3501                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3502             20  CF-PLAN-BENEFIT-DATA.
  3503                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3504                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3505                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3506                                            PIC S9(7)V99  COMP-3.
  3507         16  CF-PLAN-POLICY-FORMS.
  3508             20  CF-POLICY-FORM             PIC X(12).
  3509             20  CF-MASTER-APPLICATION      PIC X(12).
  3510             20  CF-MASTER-POLICY           PIC X(12).
  3511         16  CF-PLAN-RATING.
  3512             20  CF-RATE-CODE               PIC X(5).
  3513             20  CF-SEX-RATING              PIC X.
  3514                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3515                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3516             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3517             20  CF-SUB-STD-TYPE            PIC X.
  3518                 88  CF-PCT-OF-PREM            VALUE '1'.
  3519                 88  CF-PCT-OF-BENE            VALUE '2'.
  3520         16  CF-PLAN-PREM-TOLERANCES.
  3521             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3522             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3523         16  CF-PLAN-PYMT-TOLERANCES.
  3524             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3525             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3526         16  CF-PLAN-MISC-DATA.
  3527             20  FILLER                     PIC X.
  3528             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3529             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3530         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3531         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  68
* EL154.cbl
  3532             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3533                                                     '1'.
  3534             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3535                                                     '2'.
  3536         16  CF-MIB-SEARCH-SW               PIC X.
  3537             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3538             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3539             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3540             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3541         16  CF-ALPHA-SEARCH-SW             PIC X.
  3542             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3543             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3544             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3545             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3546             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3547             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3548             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3549             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3550             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3551             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3552                                                     'A' 'B' 'C'
  3553                                                     'X' 'Y' 'Z'.
  3554         16  CF-EFF-DT-RULE-SW              PIC X.
  3555             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3556             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3557             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3558             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3559             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3560         16  FILLER                         PIC X(4).
  3561         16  CF-HEALTH-QUESTIONS            PIC X.
  3562             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3563         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3564         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3565         16  CF-PLAN-SNGL-JNT               PIC X.
  3566             88  CF-COMBINED-PLAN              VALUE 'C'.
  3567             88  CF-JNT-PLAN                   VALUE 'J'.
  3568             88  CF-SNGL-PLAN                  VALUE 'S'.
  3569         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3570         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3571         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3572         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3573         16  CF-RERATE-CNTL                 PIC  X.
  3574             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3575             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3576             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3577             88  CF-AUTO-RECALC                 VALUE '4'.
  3578         16  CF-BENEFIT-TYPE                PIC  X.
  3579             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3580             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3581         16  CF-POLICY-FEE                  PIC S999V99
  3582                                                    COMP-3.
  3583         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3584         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3585         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3586         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3587         16  FILLER                         PIC  X(32).
  3588         16  CF-TERMINATION-FORM            PIC  X(04).
  3589         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  69
* EL154.cbl
  3590         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3591                                                       COMP-3.
  3592         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3593         16  CF-ISSUE-LETTER                PIC  X(4).
  3594         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3595         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3596             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3597             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3598         16  CF-MP-REFUND-CALC              PIC X.
  3599             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3600             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3601             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3602             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3603             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3604             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3605             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3606             88  CF-MP-REFD-MEAN                VALUE '8'.
  3607         16  CF-ALT-RATE-CODE               PIC  X(5).
  3608
  3609
  3610         16  FILLER                         PIC X(498).
  3611****************************************************************
  3612*             MORTGAGE COMPANY MASTER RECORD                   *
  3613****************************************************************
  3614
  3615     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3616         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3617         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3618             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3619             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3620             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3621             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3622             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3623
  3624         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3625         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3626         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3627         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3628         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3629
  3630         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3631             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3632         16  CF-MP-RECON-USE-IND            PIC X(1).
  3633             88  CF-MP-USE-RECON             VALUE 'Y'.
  3634         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3635             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3636         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3637             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3638             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3639         16  FILLER                         PIC X(1).
  3640         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3641             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3642         16  CF-MORTG-MIB-VERSION           PIC X.
  3643             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3644             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3645             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3646         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3647             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  70
* EL154.cbl
  3648                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3649             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3650                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3651             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3652                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3653             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3654                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3655             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3656                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3657             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3658                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3659         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3660         16  FILLER                         PIC X(7).
  3661         16  CF-MORTG-DESTINATION-SYMBOL.
  3662             20  CF-MORTG-MIB-COMM          PIC X(5).
  3663             20  CF-MORTG-MIB-TERM          PIC X(5).
  3664         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3665             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3666         16  FILLER                         PIC X(03).
  3667         16  CF-MP-CHECK-NO-CONTROL.
  3668             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3669                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3670                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3671                                                ' ' LOW-VALUES.
  3672                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3673                                               VALUE '3'.
  3674         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3675         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3676         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3677             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3678                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3679             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3680                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3681             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3682                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3683             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3684                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3685             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3686                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3687             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3688                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3689         16  CF-MORTG-BILLING-AREA.
  3690             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3691                                            PIC X.
  3692         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3693         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3694         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3695         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3696             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3697             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3698         16  FILLER                         PIC X.
  3699         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3700             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3701             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3702         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3703         16  FILLER                         PIC X(8).
  3704         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3705         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  71
* EL154.cbl
  3706         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3707         16  CF-ACH-COMPANY-ID.
  3708             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3709                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3710                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3711                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3712             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3713         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3714             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3715         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3716             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3717             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3718         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3719         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3720         16  FILLER                         PIC X(536).
  3721
  3722****************************************************************
  3723*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3724****************************************************************
  3725
  3726     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3727         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3728             20  CF-FEMALE-HEIGHT.
  3729                 24  CF-FEMALE-FT           PIC 99.
  3730                 24  CF-FEMALE-IN           PIC 99.
  3731             20  CF-FEMALE-MIN-WT           PIC 999.
  3732             20  CF-FEMALE-MAX-WT           PIC 999.
  3733         16  FILLER                         PIC X(428).
  3734
  3735     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3736         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3737             20  CF-MALE-HEIGHT.
  3738                 24  CF-MALE-FT             PIC 99.
  3739                 24  CF-MALE-IN             PIC 99.
  3740             20  CF-MALE-MIN-WT             PIC 999.
  3741             20  CF-MALE-MAX-WT             PIC 999.
  3742         16  FILLER                         PIC X(428).
  3743******************************************************************
  3744*             AUTOMATIC ACTIVITY RECORD                          *
  3745******************************************************************
  3746     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3747         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3748             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3749             20  CF-SYS-LETTER-ID           PIC X(04).
  3750             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3751             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3752             20  CF-SYS-RESET-SW            PIC X(01).
  3753             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3754             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3755
  3756         16  FILLER                         PIC X(50).
  3757
  3758         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3759             20  CF-USER-ACTIVE-SW          PIC X(01).
  3760             20  CF-USER-LETTER-ID          PIC X(04).
  3761             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3762             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3763             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  72
* EL154.cbl
  3764             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3765             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3766             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3767
  3768         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  73
* EL154.cbl
  3770*                            COPY ELCMSTR.
  3771******************************************************************
  3772*                                                                *
  3773*                            ELCMSTR.                            *
  3774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3775*                            VMOD=2.012                          *
  3776*                                                                *
  3777*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3778*                                                                *
  3779*   FILE TYPE = VSAM,KSDS                                        *
  3780*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3781*                                                                *
  3782*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3783*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3784*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3785*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3786*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3787*                                                 RKP=75,LEN=21  *
  3788*                                                                *
  3789*   **** NOTE ****                                               *
  3790*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3791*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3792*                                                                *
  3793*   LOG = YES                                                    *
  3794*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3795******************************************************************
  3796*                   C H A N G E   L O G
  3797*
  3798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3799*-----------------------------------------------------------------
  3800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3801* EFFECTIVE    NUMBER
  3802*-----------------------------------------------------------------
  3803* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3804* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3805* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3806* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3807* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3808* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3809* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3810******************************************************************
  3811 01  CLAIM-MASTER.
  3812     12  CL-RECORD-ID                PIC XX.
  3813         88  VALID-CL-ID         VALUE 'CL'.
  3814
  3815     12  CL-CONTROL-PRIMARY.
  3816         16  CL-COMPANY-CD           PIC X.
  3817         16  CL-CARRIER              PIC X.
  3818         16  CL-CLAIM-NO             PIC X(7).
  3819         16  CL-CERT-NO.
  3820             20  CL-CERT-PRIME       PIC X(10).
  3821             20  CL-CERT-SFX         PIC X.
  3822
  3823     12  CL-CONTROL-BY-NAME.
  3824         16  CL-COMPANY-CD-A1        PIC X.
  3825         16  CL-INSURED-LAST-NAME    PIC X(15).
  3826         16  CL-INSURED-NAME.
  3827             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  74
* EL154.cbl
  3828             20  CL-INSURED-MID-INIT PIC X.
  3829
  3830     12  CL-CONTROL-BY-SSN.
  3831         16  CL-COMPANY-CD-A2        PIC X.
  3832         16  CL-SOC-SEC-NO.
  3833             20  CL-SSN-STATE        PIC XX.
  3834             20  CL-SSN-ACCOUNT      PIC X(6).
  3835             20  CL-SSN-LN3          PIC X(3).
  3836
  3837     12  CL-CONTROL-BY-CERT-NO.
  3838         16  CL-COMPANY-CD-A4        PIC X.
  3839         16  CL-CERT-NO-A4.
  3840             20  CL-CERT-A4-PRIME    PIC X(10).
  3841             20  CL-CERT-A4-SFX      PIC X.
  3842
  3843     12  CL-CONTROL-BY-CCN.
  3844         16  CL-COMPANY-CD-A5        PIC X.
  3845         16  CL-CCN-A5.
  3846             20  CL-CCN.
  3847                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3848                 24  CL-CCN-PRIME-A5 PIC X(12).
  3849             20  CL-CCN-FILLER-A5    PIC X(4).
  3850
  3851     12  CL-INSURED-PROFILE-DATA.
  3852         16  CL-INSURED-BIRTH-DT     PIC XX.
  3853         16  CL-INSURED-SEX-CD       PIC X.
  3854             88  INSURED-IS-MALE        VALUE 'M'.
  3855             88  INSURED-IS-FEMALE      VALUE 'F'.
  3856             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3857         16  CL-INSURED-OCC-CD       PIC X(6).
  3858         16  FILLER                  PIC X(5).
  3859
  3860     12  CL-PROCESSING-INFO.
  3861         16  CL-PROCESSOR-ID         PIC X(4).
  3862         16  CL-CLAIM-STATUS         PIC X.
  3863             88  CLAIM-IS-OPEN          VALUE 'O'.
  3864             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3865         16  CL-CLAIM-TYPE           PIC X.
  3866*            88  AH-CLAIM               VALUE 'A'.
  3867*            88  LIFE-CLAIM             VALUE 'L'.
  3868*            88  PROPERTY-CLAIM         VALUE 'P'.
  3869*            88  IUI-CLAIM              VALUE 'I'.
  3870*            88  GAP-CLAIM              VALUE 'G'.
  3871*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3872*            88  OTHER-CLAIM            VALUE 'O'.
  3873         16  CL-CLAIM-PREM-TYPE      PIC X.
  3874             88  SINGLE-PREMIUM         VALUE '1'.
  3875             88  O-B-COVERAGE           VALUE '2'.
  3876             88  OPEN-END-COVERAGE      VALUE '3'.
  3877         16  CL-INCURRED-DT          PIC XX.
  3878         16  CL-REPORTED-DT          PIC XX.
  3879         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3880         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3881         16  CL-LAST-PMT-DT          PIC XX.
  3882         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3883         16  CL-PAID-THRU-DT         PIC XX.
  3884         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3885         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  75
* EL154.cbl
  3886         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3887         16  CL-PMT-CALC-METHOD      PIC X.
  3888             88  CL-360-DAY-YR          VALUE '1'.
  3889             88  CL-365-DAY-YR          VALUE '2'.
  3890             88  CL-FULL-MONTHS         VALUE '3'.
  3891         16  CL-CAUSE-CD             PIC X(6).
  3892
  3893         16  CL-PRIME-CERT-NO.
  3894             20  CL-PRIME-CERT-PRIME PIC X(10).
  3895             20  CL-PRIME-CERT-SFX   PIC X.
  3896
  3897         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3898             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3899             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3900
  3901         16  CL-MICROFILM-NO         PIC X(10).
  3902         16  FILLER REDEFINES CL-MICROFILM-NO.
  3903             20  CL-BENEFIT-PERIOD   PIC 99.
  3904             20  FILLER              PIC X(8).
  3905         16  CL-PROG-FORM-TYPE       PIC X.
  3906         16  CL-LAST-ADD-ON-DT       PIC XX.
  3907
  3908         16  CL-LAST-REOPEN-DT       PIC XX.
  3909         16  CL-LAST-CLOSE-DT        PIC XX.
  3910         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3911             88  FINAL-PAID             VALUE '1'.
  3912             88  CLAIM-DENIED           VALUE '2'.
  3913             88  AUTO-CLOSE             VALUE '3'.
  3914             88  MANUAL-CLOSE           VALUE '4'.
  3915             88  BENEFITS-CHANGED       VALUE 'C'.
  3916             88  SETUP-ERRORS           VALUE 'E'.
  3917         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3918         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3919         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3920             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3921         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3922         16  FILLER                  PIC X.
  3923
  3924     12  CL-CERTIFICATE-DATA.
  3925         16  CL-CERT-ORIGIN          PIC X.
  3926             88  CERT-WAS-ONLINE        VALUE '1'.
  3927             88  CERT-WAS-CREATED       VALUE '2'.
  3928             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3929         16  CL-CERT-KEY-DATA.
  3930             20  CL-CERT-CARRIER     PIC X.
  3931             20  CL-CERT-GROUPING    PIC X(6).
  3932             20  CL-CERT-STATE       PIC XX.
  3933             20  CL-CERT-ACCOUNT.
  3934                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3935                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3936             20  CL-CERT-EFF-DT      PIC XX.
  3937
  3938     12  CL-STATUS-CONTROLS.
  3939         16  CL-PRIORITY-CD          PIC X.
  3940             88  CONFIDENTIAL-DATA      VALUE '8'.
  3941             88  HIGHEST-PRIORITY       VALUE '9'.
  3942         16  CL-SUPV-ATTN-CD         PIC X.
  3943             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  76
* EL154.cbl
  3944             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3945         16  CL-PURGED-DT            PIC XX.
  3946         16  CL-RESTORED-DT          PIC XX.
  3947         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3948         16  CL-NEXT-RESEND-DT       PIC XX.
  3949         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3950         16  CL-CRITICAL-PERIOD      PIC 99.
  3951*        16  FILLER                  PIC XX.
  3952         16  CL-LAST-MAINT-DT        PIC XX.
  3953         16  CL-LAST-MAINT-USER      PIC X(4).
  3954         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3955         16  CL-LAST-MAINT-TYPE      PIC X.
  3956             88  CLAIM-SET-UP           VALUE ' '.
  3957             88  PAYMENT-MADE           VALUE '1'.
  3958             88  LETTER-SENT            VALUE '2'.
  3959             88  MASTER-WAS-ALTERED     VALUE '3'.
  3960             88  MASTER-WAS-RESTORED    VALUE '4'.
  3961             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3962             88  FILE-CONVERTED         VALUE '6'.
  3963             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3964             88  ERROR-CORRECTION       VALUE 'E'.
  3965         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3966         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3967         16  CL-BENEFICIARY          PIC X(10).
  3968         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3969         16  CL-DENIAL-TYPE          PIC X.
  3970             88  CL-TYPE-DENIAL          VALUE '1'.
  3971             88  CL-TYPE-RESCISSION      VALUE '2'.
  3972             88  CL-TYPE-REFORMATION     VALUE '3'.
  3973             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3974             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3975         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3976         16  filler                  pic x(3).
  3977*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3978*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3979*        16  CL-RTW-DT               PIC XX.
  3980
  3981     12  CL-TRAILER-CONTROLS.
  3982         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3983             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3984             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3985             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3986         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3987         16  FILLER                  PIC XX.
  3988         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3989         16  CL-ADDRESS-TRAILER-CNT.
  3990             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3991                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3992             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3993                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3994             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3995                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3996             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3997                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3998             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3999                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4000             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4001                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  77
* EL154.cbl
  4002             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4003                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4004
  4005     12  CL-CV-REFERENCE-NO.
  4006         16  CL-CV-REFNO-PRIME       PIC X(18).
  4007         16  CL-CV-REFNO-SFX         PIC XX.
  4008
  4009     12  CL-FILE-LOCATION            PIC X(4).
  4010
  4011     12  CL-PROCESS-ERRORS.
  4012         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4013             88  NO-FATAL-ERRORS        VALUE ZERO.
  4014         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4015             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4016
  4017     12  CL-PRODUCT-CD               PIC X.
  4018
  4019     12  CL-CURRENT-KEY-DATA.
  4020         16  CL-CURRENT-CARRIER      PIC X.
  4021         16  CL-CURRENT-GROUPING     PIC X(6).
  4022         16  CL-CURRENT-STATE        PIC XX.
  4023         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4024
  4025     12  CL-ASSOCIATES               PIC X.
  4026         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4027         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4028         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4029         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4030
  4031     12  CL-ACTIVITY-CODE            PIC 99.
  4032     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4033     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4034
  4035     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4036     12  CL-LAG-REPORT-CODE          PIC 9.
  4037     12  CL-LOAN-TYPE                PIC XX.
  4038     12  CL-LEGAL-STATE              PIC XX.
  4039
  4040     12  CL-YESNOSW                  PIC X.
  4041     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4042         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4043         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4044         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4045     12  cl-insured-type             pic x.
  4046         88  cl-claim-on-primary         value 'P'.
  4047         88  cl-claim-on-co-borrower     value 'C'.
  4048     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  78
* EL154.cbl
  4050*                            COPY ELCTRLR.
  4051******************************************************************
  4052*                                                                *
  4053*                            ELCTRLR.                            *
  4054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4055*                            VMOD=2.014                          *
  4056*                                                                *
  4057*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4058*                                                                *
  4059*   FILE TYPE = VSAM,KSDS                                        *
  4060*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4061*                                                                *
  4062*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4063*       ALTERNATE INDEX = NONE                                   *
  4064*                                                                *
  4065*   LOG = YES                                                    *
  4066*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4067******************************************************************
  4068*                   C H A N G E   L O G
  4069*
  4070* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4071*-----------------------------------------------------------------
  4072*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4073* EFFECTIVE    NUMBER
  4074*-----------------------------------------------------------------
  4075* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4076* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4077* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4078* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4079* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4080* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4081* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4082* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4083* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4084* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4085* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4086* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4087* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4088* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4089* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4090* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4091* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4092* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4093* 040814    2014030500002  AJRA  ADD ICD CODES
  4094* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4095* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4096* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4097* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4098******************************************************************
  4099 01  ACTIVITY-TRAILERS.
  4100     12  AT-RECORD-ID                    PIC XX.
  4101         88  VALID-AT-ID                       VALUE 'AT'.
  4102
  4103     12  AT-CONTROL-PRIMARY.
  4104         16  AT-COMPANY-CD               PIC X.
  4105         16  AT-CARRIER                  PIC X.
  4106         16  AT-CLAIM-NO                 PIC X(7).
  4107         16  AT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  79
* EL154.cbl
  4108             20  AT-CERT-PRIME           PIC X(10).
  4109             20  AT-CERT-SFX             PIC X.
  4110         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4111             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4112             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4113             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4114             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4115             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4116             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4117             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4118             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4119             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4120             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4121             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4122             88  AT-BENEFICIARY-TRL           VALUE +91.
  4123             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4124             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4125             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4126             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4127
  4128     12  AT-TRAILER-TYPE                 PIC X.
  4129         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4130         88  PAYMENT-TR                       VALUE '2'.
  4131         88  AUTO-PAY-TR                      VALUE '3'.
  4132         88  CORRESPONDENCE-TR                VALUE '4'.
  4133         88  ADDRESS-TR                       VALUE '5'.
  4134         88  GENERAL-INFO-TR                  VALUE '6'.
  4135         88  AUTO-PROMPT-TR                   VALUE '7'.
  4136         88  DENIAL-TR                        VALUE '8'.
  4137         88  INCURRED-CHG-TR                  VALUE '9'.
  4138         88  FORM-CONTROL-TR                  VALUE 'A'.
  4139
  4140     12  AT-RECORDED-DT                  PIC XX.
  4141     12  AT-RECORDED-BY                  PIC X(4).
  4142     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4143
  4144     12  AT-TRAILER-BODY                 PIC X(165).
  4145
  4146     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4147         16  AT-RESERVE-CONTROLS.
  4148             20  AT-MANUAL-SW            PIC X.
  4149                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4150             20  AT-FUTURE-SW            PIC X.
  4151                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4152             20  AT-PTC-SW               PIC X.
  4153                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4154             20  AT-IBNR-SW              PIC X.
  4155                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4156             20  AT-PTC-LF-SW            PIC X.
  4157                 88  AT-LF-PTC-USED          VALUE '1'.
  4158             20  AT-CDT-ACCESS-METHOD    PIC X.
  4159                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4160                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4161                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4162             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4163         16  AT-LAST-COMPUTED-DT         PIC XX.
  4164         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4165         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  80
* EL154.cbl
  4166         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4167         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4168         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4169         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4170         16  AT-EXPENSE-CONTROLS.
  4171             20  AT-EXPENSE-METHOD       PIC X.
  4172                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4173                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4174                 88  PERCENT-OF-PMT           VALUE '3'.
  4175                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4176             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4177             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4178         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4179         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4180
  4181         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4182         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4183
  4184*        16  FILLER                      PIC X(53).
  4185         16  FILLER                      PIC X(47).
  4186
  4187         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4188         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4189
  4190         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4191             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4192             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4193*                    C = CLOSED
  4194*                    O = OPEN
  4195             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4196*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4197
  4198     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4199         16  AT-PAYMENT-TYPE             PIC X.
  4200             88  PARTIAL-PAYMENT                VALUE '1'.
  4201             88  FINAL-PAYMENT                  VALUE '2'.
  4202             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4203             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4204             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4205             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4206             88  VOIDED-PAYMENT                 VALUE '9'.
  4207             88  TRANSFER                       VALUE 'T'.
  4208             88  LIFE-INTEREST                  VALUE 'I'.
  4209
  4210         16  AT-CLAIM-TYPE               PIC X.
  4211             88  PAID-FOR-AH                    VALUE 'A'.
  4212             88  PAID-FOR-LIFE                  VALUE 'L'.
  4213             88  PAID-FOR-IUI                   VALUE 'I'.
  4214             88  PAID-FOR-GAP                   VALUE 'G'.
  4215             88  PAID-FOR-FAM                   VALUE 'F'.
  4216             88  PAID-FOR-OTH                   VALUE 'O'.
  4217         16  AT-CLAIM-PREM-TYPE          PIC X.
  4218             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4219             88  AT-O-B-COVERAGE                VALUE '2'.
  4220             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4221         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4222         16  AT-CHECK-NO                 PIC X(7).
  4223         16  AT-PAID-FROM-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  81
* EL154.cbl
  4224         16  AT-PAID-THRU-DT             PIC XX.
  4225         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4226         16  AT-ACH-PAYMENT              PIC X.
  4227*        16  FILLER                      PIC X.
  4228         16  AT-PAYEES-NAME              PIC X(30).
  4229         16  AT-PAYMENT-ORIGIN           PIC X.
  4230             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4231             88  ONLINE-AUTO-PMT                VALUE '2'.
  4232             88  OFFLINE-PMT                    VALUE '3'.
  4233         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4234         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4235         16  AT-VOID-DATA.
  4236             20  AT-VOID-DT              PIC XX.
  4237*00144       20  AT-VOID-REASON          PIC X(30).
  4238             20  AT-VOID-REASON          PIC X(26).
  4239         16  AT-PMT-APPROVED-BY          PIC X(04).
  4240         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4241         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4242         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4243                                         PIC S99V9(5)  COMP-3.
  4244         16  AT-CREDIT-INTERFACE.
  4245             20  AT-PMT-SELECT-DT        PIC XX.
  4246                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4247             20  AT-PMT-ACCEPT-DT        PIC XX.
  4248                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4249             20  AT-VOID-SELECT-DT       PIC XX.
  4250                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4251             20  AT-VOID-ACCEPT-DT       PIC XX.
  4252                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4253
  4254         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4255                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4256                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4257         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4258
  4259         16  AT-FORCE-CONTROL            PIC X.
  4260             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4261         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4262         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4263         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4264         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4265         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4266         16  AT-BENEFIT-TYPE             PIC X.
  4267
  4268         16  AT-EXPENSE-TYPE             PIC X.
  4269         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4270
  4271         16  AT-PAYEE-TYPE-CD.
  4272             20  AT-PAYEE-TYPE           PIC X.
  4273                 88  INSURED-PAID           VALUE 'I'.
  4274                 88  BENEFICIARY-PAID       VALUE 'B'.
  4275                 88  ACCOUNT-PAID           VALUE 'A'.
  4276                 88  OTHER-1-PAID           VALUE 'O'.
  4277                 88  OTHER-2-PAID           VALUE 'Q'.
  4278                 88  DOCTOR-PAID            VALUE 'P'.
  4279                 88  EMPLOYER-PAID          VALUE 'E'.
  4280             20  AT-PAYEE-SEQ            PIC X.
  4281
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  82
* EL154.cbl
  4282         16  AT-CASH-PAYMENT             PIC X.
  4283         16  AT-GROUPED-PAYMENT          PIC X.
  4284         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4285         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4286         16  AT-APPROVED-LEVEL           PIC X.
  4287         16  AT-VOID-TYPE                PIC X.
  4288             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4289             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4290         16  AT-AIG-UNEMP-IND            PIC X.
  4291             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4292         16  AT-ASSOCIATES               PIC X.
  4293             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4294             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4295
  4296         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4297         16  AT-CV-PMT-CODE              PIC X.
  4298             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4299             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4300             88  FULL-ADD-PAYMENT           VALUE '3'.
  4301             88  HALF-ADD-PAYMENT           VALUE '4'.
  4302             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4303             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4304             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4305             88  ADDL-PAYMENT               VALUE '8'.
  4306
  4307         16  AT-EOB-CODE1                PIC XXX.
  4308         16  AT-EOB-CODE2                PIC XXX.
  4309         16  AT-EOB-CODE3                PIC XXX.
  4310         16  FILLER REDEFINES AT-EOB-CODE3.
  4311             20  AT-PRINT-CLM-FORM       PIC X.
  4312             20  AT-PRINT-SURVEY         PIC X.
  4313             20  AT-SPECIAL-RELEASE      PIC X.
  4314         16  AT-EOB-CODE4                PIC XXX.
  4315         16  FILLER REDEFINES AT-EOB-CODE4.
  4316             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4317             20  FILLER                  PIC X.
  4318         16  AT-EOB-CODE5                PIC XXX.
  4319         16  FILLER REDEFINES AT-EOB-CODE5.
  4320             20  AT-PMT-PROOF-DT         PIC XX.
  4321             20  FILLER                  PIC X.
  4322
  4323         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4324             88  AT-PRINT-EOB            VALUE 'Y'.
  4325
  4326         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4327         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4328
  4329     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4330         16  AT-SCHEDULE-START-DT        PIC XX.
  4331         16  AT-SCHEDULE-END-DT          PIC XX.
  4332         16  AT-TERMINATED-DT            PIC XX.
  4333         16  AT-LAST-PMT-TYPE            PIC X.
  4334             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4335             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4336         16  AT-FIRST-PMT-DATA.
  4337             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4338             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4339             20  AT-1ST-PAY-THRU-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  83
* EL154.cbl
  4340         16  AT-REGULAR-PMT-DATA.
  4341             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4342             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4343             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4344         16  AT-AUTO-PAYEE-CD.
  4345             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4346                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4347                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4348                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4349                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4350                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4351             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4352         16  AT-AUTO-PAY-DAY             PIC 99.
  4353         16  AT-AUTO-CASH                PIC X.
  4354             88  AT-CASH                      VALUE 'Y'.
  4355             88  AT-NON-CASH                  VALUE 'N'.
  4356*        16  FILLER                      PIC X(129).
  4357         16  AT-AUTO-END-LETTER          PIC X(4).
  4358         16  FILLER                      PIC X(125).
  4359
  4360         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4361         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4362
  4363     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4364         16  AT-LETTER-SENT-DT           PIC XX.
  4365         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4366         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4367         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4368         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4369         16  AT-LETTER-ORIGIN            PIC X.
  4370             88  ONLINE-CREATION              VALUE '1' '3'.
  4371             88  OFFLINE-CREATION             VALUE '2' '4'.
  4372             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4373             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4374         16  AT-STD-LETTER-FORM          PIC X(4).
  4375         16  AT-REASON-TEXT              PIC X(70).
  4376         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4377         16  AT-ADDRESEE-TYPE            PIC X.
  4378              88  INSURED-ADDRESEE            VALUE 'I'.
  4379              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4380              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4381              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4382              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4383              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4384              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4385         16  AT-ADDRESSEE-NAME           PIC X(30).
  4386         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4387         16  AT-RESEND-PRINT-DATE        PIC XX.
  4388         16  AT-CORR-SOL-UNSOL           PIC X.
  4389         16  AT-LETTER-PURGED-DT         PIC XX.
  4390*
  4391*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4392*
  4393         16  AT-CSO-REDEFINITION.
  4394             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4395             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4396             20  AT-LETTER-TO-BENE       PIC X(1).
  4397             20  AT-STOP-LETTER-DT       PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  84
* EL154.cbl
  4398             20  AT-AUTH-RCVD            PIC X(1).
  4399             20  FILLER                  PIC X(18).
  4400*             20  FILLER                  PIC X(27).
  4401             20  AT-CSO-LETTER-STATUS    PIC X.
  4402                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4403                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4404                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4405             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4406             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4407*
  4408*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4409*
  4410*        16  FILLER                      PIC X(26).
  4411*
  4412*        16  AT-DMD-BSR-CODE             PIC X.
  4413*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4414*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4415*
  4416*        16  AT-DMD-LETTER-STATUS        PIC X.
  4417*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4418*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4419*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4420*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4421*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4422
  4423         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4424         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4425
  4426     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4427         16  AT-ADDRESS-TYPE             PIC X.
  4428             88  INSURED-ADDRESS               VALUE 'I'.
  4429             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4430             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4431             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4432             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4433             88  OTHER-ADDRESS-1               VALUE 'O'.
  4434             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4435         16  AT-MAIL-TO-NAME             PIC X(30).
  4436         16  AT-ADDRESS-LINE-1           PIC X(30).
  4437         16  AT-ADDRESS-LINE-2           PIC X(30).
  4438         16  AT-CITY-STATE.
  4439             20  AT-CITY                 PIC X(28).
  4440             20  AT-STATE                PIC XX.
  4441         16  AT-ZIP.
  4442             20  AT-ZIP-CODE.
  4443                 24  AT-ZIP-1ST          PIC X.
  4444                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4445                 24  FILLER              PIC X(4).
  4446             20  AT-ZIP-PLUS4            PIC X(4).
  4447         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4448             20  AT-CAN-POSTAL-1         PIC XXX.
  4449             20  AT-CAN-POSTAL-2         PIC XXX.
  4450             20  FILLER                  PIC XXX.
  4451         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4452*         16  FILLER                      PIC X(23).
  4453         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4454         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4455         16  FILLER                      PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  85
* EL154.cbl
  4456         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4457         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4458
  4459     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4460         16  AT-INFO-LINE-1              PIC X(60).
  4461         16  FILLER REDEFINES AT-INFO-LINE-1.
  4462             20  AT-NOTE-ERROR-NO OCCURS 15
  4463                                         PIC X(4).
  4464         16  AT-INFO-LINE-2              PIC X(60).
  4465         16  FILLER REDEFINES AT-INFO-LINE-2.
  4466             20  AT-ICD-CODE-1           PIC X(8).
  4467             20  AT-ICD-CODE-2           PIC X(8).
  4468             20  FILLER                  PIC X(44).
  4469         16  AT-INFO-TRAILER-TYPE        PIC X.
  4470             88  AT-ERRORS-NOTE          VALUE 'E'.
  4471             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4472             88  AT-CALL-NOTE            VALUE 'C'.
  4473             88  AT-MAINT-NOTE           VALUE 'M'.
  4474             88  AT-CERT-CHANGE          VALUE 'X'.
  4475             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4476             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4477             88  AT-CERT-CANCELLED       VALUE 'T'.
  4478         16  AT-CALL-TYPE                PIC X.
  4479             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4480             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4481         16  AT-NOTE-CONTINUATION        PIC X.
  4482             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4483         16  AT-EOB-CODES-EXIST          PIC X.
  4484             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4485         16  FILLER                      PIC X(35).
  4486         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4487         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4488
  4489     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4490         16  AT-PROMPT-LINE-1            PIC X(60).
  4491         16  AT-PROMPT-LINE-2            PIC X(60).
  4492         16  AT-PROMPT-START-DT          PIC XX.
  4493         16  AT-PROMPT-END-DT            PIC XX.
  4494         16  FILLER                      PIC X(35).
  4495         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4496         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4497
  4498     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4499         16  AT-DENIAL-INFO-1            PIC X(60).
  4500         16  AT-DENIAL-INFO-2            PIC X(60).
  4501         16  AT-DENIAL-DT                PIC XX.
  4502         16  AT-RETRACTION-DT            PIC XX.
  4503         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4504*         16  FILLER                      PIC X(31).
  4505         16  AT-DENIAL-PROOF-DT          PIC XX.
  4506         16  FILLER                      PIC X(29).
  4507         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4508         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4509
  4510     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4511         16  AT-OLD-INCURRED-DT          PIC XX.
  4512         16  AT-OLD-REPORTED-DT          PIC XX.
  4513         16  AT-OLD-ESTABLISHED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  86
* EL154.cbl
  4514         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4515         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4516         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4517         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4518         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4519         16  FILLER                      PIC X(26).
  4520         16  AT-OLD-DIAG-CODE            PIC X(6).
  4521         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4522         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4523         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4524         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4525         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4526         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4527         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4528         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4529         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4530         16  FILLER                      PIC X(9).
  4531         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4532
  4533     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4534         16  AT-FORM-SEND-ON-DT          PIC XX.
  4535         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4536         16  AT-FORM-RE-SEND-DT          PIC XX.
  4537         16  AT-FORM-ANSWERED-DT         PIC XX.
  4538         16  AT-FORM-PRINTED-DT          PIC XX.
  4539         16  AT-FORM-REPRINT-DT          PIC XX.
  4540         16  AT-FORM-TYPE                PIC X.
  4541             88  INITIAL-FORM                  VALUE '1'.
  4542             88  PROGRESS-FORM                 VALUE '2'.
  4543         16  AT-INSTRUCT-LN-1            PIC X(28).
  4544         16  AT-INSTRUCT-LN-2            PIC X(28).
  4545         16  AT-INSTRUCT-LN-3            PIC X(28).
  4546         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4547         16  AT-FORM-ADDRESS             PIC X.
  4548             88  FORM-TO-INSURED              VALUE 'I'.
  4549             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4550             88  FORM-TO-OTHER-1              VALUE 'O'.
  4551             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4552         16  AT-RELATED-1.
  4553             20 AT-REL-CARR-1            PIC X.
  4554             20 AT-REL-CLAIM-1           PIC X(7).
  4555             20 AT-REL-CERT-1            PIC X(11).
  4556         16  AT-RELATED-2.
  4557             20 AT-REL-CARR-2            PIC X.
  4558             20 AT-REL-CLAIM-2           PIC X(7).
  4559             20 AT-REL-CERT-2            PIC X(11).
  4560         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4561         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4562         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4563         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4564         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4565         16  AT-STOP-FORM-DT             PIC X(2).
  4566
  4567         16  FILLER                      PIC X(09).
  4568         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4569         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4570******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  87
* EL154.cbl
  4572*                            COPY ELCCERT.
  4573******************************************************************
  4574*                                                                *
  4575*                            ELCCERT.                            *
  4576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4577*                            VMOD=2.013                          *
  4578*                                                                *
  4579*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4580*                                                                *
  4581*   FILE TYPE = VSAM,KSDS                                        *
  4582*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4583*                                                                *
  4584*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4585*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4586*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4587*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4588*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4589*                                                                *
  4590*   LOG = YES                                                    *
  4591*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4592******************************************************************
  4593*                   C H A N G E   L O G
  4594*
  4595* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4596*-----------------------------------------------------------------
  4597*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4598* EFFECTIVE    NUMBER
  4599*-----------------------------------------------------------------
  4600* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4601* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4602* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4603* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4604* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4605* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4606* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4607* 032612  CR2011110200001  PEMA  AHL CHANGES
  4608* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4609* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4610* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4611******************************************************************
  4612
  4613 01  CERTIFICATE-MASTER.
  4614     12  CM-RECORD-ID                      PIC XX.
  4615         88  VALID-CM-ID                      VALUE 'CM'.
  4616
  4617     12  CM-CONTROL-PRIMARY.
  4618         16  CM-COMPANY-CD                 PIC X.
  4619         16  CM-CARRIER                    PIC X.
  4620         16  CM-GROUPING.
  4621             20  CM-GROUPING-PREFIX        PIC X(3).
  4622             20  CM-GROUPING-PRIME         PIC X(3).
  4623         16  CM-STATE                      PIC XX.
  4624         16  CM-ACCOUNT.
  4625             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4626             20  CM-ACCOUNT-PRIME          PIC X(6).
  4627         16  CM-CERT-EFF-DT                PIC XX.
  4628         16  CM-CERT-NO.
  4629             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  88
* EL154.cbl
  4630             20  CM-CERT-SFX               PIC X.
  4631
  4632     12  CM-CONTROL-BY-NAME.
  4633         16  CM-COMPANY-CD-A1              PIC X.
  4634         16  CM-INSURED-LAST-NAME          PIC X(15).
  4635         16  CM-INSURED-INITIALS.
  4636             20  CM-INSURED-INITIAL1       PIC X.
  4637             20  CM-INSURED-INITIAL2       PIC X.
  4638
  4639     12  CM-CONTROL-BY-SSN.
  4640         16  CM-COMPANY-CD-A2              PIC X.
  4641         16  CM-SOC-SEC-NO.
  4642             20  CM-SSN-STATE              PIC XX.
  4643             20  CM-SSN-ACCOUNT            PIC X(6).
  4644             20  CM-SSN-LN3.
  4645                 25  CM-INSURED-INITIALS-A2.
  4646                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4647                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4648                 25 CM-PART-LAST-NAME-A2         PIC X.
  4649
  4650     12  CM-CONTROL-BY-CERT-NO.
  4651         16  CM-COMPANY-CD-A4              PIC X.
  4652         16  CM-CERT-NO-A4                 PIC X(11).
  4653
  4654     12  CM-CONTROL-BY-MEMB.
  4655         16  CM-COMPANY-CD-A5              PIC X.
  4656         16  CM-MEMBER-NO.
  4657             20  CM-MEMB-STATE             PIC XX.
  4658             20  CM-MEMB-ACCOUNT           PIC X(6).
  4659             20  CM-MEMB-LN4.
  4660                 25  CM-INSURED-INITIALS-A5.
  4661                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4662                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4663                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4664
  4665     12  CM-INSURED-PROFILE-DATA.
  4666         16  CM-INSURED-FIRST-NAME.
  4667             20  CM-INSURED-1ST-INIT       PIC X.
  4668             20  FILLER                    PIC X(9).
  4669         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4670         16  CM-INSURED-SEX                PIC X.
  4671             88  CM-SEX-MALE                  VALUE 'M'.
  4672             88  CM-SEX-FEMAL                 VALUE 'F'.
  4673         16  CM-INSURED-JOINT-AGE          PIC 99.
  4674         16  CM-JOINT-INSURED-NAME.
  4675             20  CM-JT-LAST-NAME           PIC X(15).
  4676             20  CM-JT-FIRST-NAME.
  4677                 24  CM-JT-1ST-INIT        PIC X.
  4678                 24  FILLER                PIC X(9).
  4679             20  CM-JT-INITIAL             PIC X.
  4680
  4681     12  CM-LIFE-DATA.
  4682         16  CM-LF-BENEFIT-CD              PIC XX.
  4683         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4684         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4685         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4686         16  CM-LF-DEV-CODE                PIC XXX.
  4687         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  89
* EL154.cbl
  4688         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4689         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4690         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4691         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4692         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4693         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4694         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4695         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4696         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4697         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4698         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4699         16  cm-temp-epiq                  pic xx.
  4700             88  EPIQ-CLASS                  value 'EQ'.
  4701*        16  FILLER                        PIC XX.
  4702
  4703     12  CM-AH-DATA.
  4704         16  CM-AH-BENEFIT-CD              PIC XX.
  4705         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4706         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4707         16  CM-AH-DEV-CODE                PIC XXX.
  4708         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4709         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4710         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4711         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4712         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4713         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4714         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4715         16  CM-AH-PAID-THRU-DT            PIC XX.
  4716             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4717         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4718         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4719         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4720         16  FILLER                        PIC X.
  4721
  4722     12  CM-LOAN-INFORMATION.
  4723         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4724         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4725                                           PIC S9(5)V99  COMP-3.
  4726         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4727         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4728         16  CM-PAY-FREQUENCY              PIC S99.
  4729         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4730         16  CM-RATE-CLASS                 PIC XX.
  4731         16  CM-BENEFICIARY                PIC X(25).
  4732         16  CM-POLICY-FORM-NO             PIC X(12).
  4733         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4734         16  CM-LAST-ADD-ON-DT             PIC XX.
  4735         16  CM-DEDUCTIBLE-AMOUNTS.
  4736             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4737             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4738         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4739             20  CM-RESIDENT-STATE         PIC XX.
  4740             20  CM-RATE-CODE              PIC X(4).
  4741             20  FILLER                    PIC XX.
  4742         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4743             20  CM-LOAN-OFFICER           PIC X(5).
  4744             20  FILLER                    PIC XXX.
  4745         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  90
* EL154.cbl
  4746         16  CM-UNDERWRITING-CODE          PIC X.
  4747             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4748         16  CM-POST-CARD-IND              PIC X.
  4749         16  CM-REF-INTERFACE-SW           PIC X.
  4750         16  CM-PREMIUM-TYPE               PIC X.
  4751             88  CM-SING-PRM                  VALUE '1'.
  4752             88  CM-O-B-COVERAGE              VALUE '2'.
  4753             88  CM-OPEN-END                  VALUE '3'.
  4754         16  CM-IND-GRP-TYPE               PIC X.
  4755             88  CM-INDIVIDUAL                VALUE 'I'.
  4756             88  CM-GROUP                     VALUE 'G'.
  4757         16  CM-SKIP-CODE                  PIC X.
  4758             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4759             88  SKIP-JULY                    VALUE '1'.
  4760             88  SKIP-AUGUST                  VALUE '2'.
  4761             88  SKIP-SEPTEMBER               VALUE '3'.
  4762             88  SKIP-JULY-AUG                VALUE '4'.
  4763             88  SKIP-AUG-SEPT                VALUE '5'.
  4764             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4765             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4766             88  SKIP-JUNE                    VALUE '8'.
  4767             88  SKIP-JUNE-JULY               VALUE '9'.
  4768             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4769             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4770         16  CM-PAYMENT-MODE               PIC X.
  4771             88  PAY-MONTHLY                  VALUE SPACE.
  4772             88  PAY-WEEKLY                   VALUE '1'.
  4773             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4774             88  PAY-BI-WEEKLY                VALUE '3'.
  4775             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4776         16  CM-LOAN-NUMBER                PIC X(8).
  4777         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4778         16  CM-OLD-LOF                    PIC XXX.
  4779*        16  CM-LOAN-OFFICER               PIC XXX.
  4780         16  CM-REIN-TABLE                 PIC XXX.
  4781         16  CM-SPECIAL-REIN-CODE          PIC X.
  4782         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4783         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4784         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4785
  4786     12  CM-STATUS-DATA.
  4787         16  CM-ENTRY-STATUS               PIC X.
  4788         16  CM-ENTRY-DT                   PIC XX.
  4789
  4790         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4791         16  CM-LF-CANCEL-DT               PIC XX.
  4792         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4793
  4794         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4795         16  CM-LF-DEATH-DT                PIC XX.
  4796         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4797
  4798         16  CM-LF-CURRENT-STATUS          PIC X.
  4799             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4800                                                'M' '4' '5' '9'.
  4801             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4802             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4803             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  91
* EL154.cbl
  4804             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4805             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4806             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4807             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4808             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4809             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4810             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4811             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4812             88  CM-LF-DECLINED               VALUE 'D'.
  4813             88  CM-LF-VOIDED                 VALUE 'V'.
  4814
  4815         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4816         16  CM-AH-CANCEL-DT               PIC XX.
  4817         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4818
  4819         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4820         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4821         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4822
  4823         16  CM-AH-CURRENT-STATUS          PIC X.
  4824             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4825                                                'M' '4' '5' '9'.
  4826             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4827             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4828             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4829             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4830             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4831             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4832             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4833             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4834             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4835             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4836             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4837             88  CM-AH-DECLINED               VALUE 'D'.
  4838             88  CM-AH-VOIDED                 VALUE 'V'.
  4839
  4840         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4841             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4842             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4843             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4844         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4845
  4846         16  CM-ENTRY-BATCH                PIC X(6).
  4847         16  CM-LF-EXIT-BATCH              PIC X(6).
  4848         16  CM-AH-EXIT-BATCH              PIC X(6).
  4849         16  CM-LAST-MONTH-END             PIC XX.
  4850
  4851     12  CM-NOTE-SW                        PIC X.
  4852         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4853         88  CERT-NOTES-PRESENT               VALUE '1'.
  4854         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4855         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4856         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4857         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4858         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4859         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4860     12  CM-COMP-EXCP-SW                   PIC X.
  4861         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  92
* EL154.cbl
  4862         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4863     12  CM-INSURED-ADDRESS-SW             PIC X.
  4864         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4865         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4866
  4867*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4868     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4869     12  FILLER                            PIC X.
  4870
  4871*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4872     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4873     12  FILLER                            PIC X.
  4874*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4875     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4876
  4877     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4878         88  CERT-ADDED-BATCH                 VALUE ' '.
  4879         88  CERT-ADDED-ONLINE                VALUE '1'.
  4880         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4881         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4882         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4883     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4884         88  CERT-AS-LOADED                   VALUE ' '.
  4885         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4886         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4887         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4888         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4889         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4890         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4891         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4892
  4893     12  CM-ACCOUNT-COMM-PCTS.
  4894         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4895         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4896
  4897     12  CM-USER-FIELD                     PIC X.
  4898     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4899     12  CM-CLP-STATE                      PIC XX.
  4900     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4901     12  CM-USER-RESERVED                  PIC XXX.
  4902     12  FILLER REDEFINES CM-USER-RESERVED.
  4903         16  CM-AH-CLASS-CD                PIC XX.
  4904         16  F                             PIC X.
  4905******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  93
* EL154.cbl
  4907*                            COPY ELCBENE.
  4908******************************************************************
  4909*                                                                *
  4910*                            ELCBENE.                            *
  4911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4912*                            VMOD=2.006                          *
  4913*                                                                *
  4914*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  4915*                                                                *
  4916*   FILE TYPE = VSAM,KSDS                                        *
  4917*   RECORD SIZE = 500   RECFORM = FIX                            *
  4918*                                                                *
  4919*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  4920*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  4921*                                                                *
  4922*   LOG = YES                                                    *
  4923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4924*                                                                *
  4925*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  4926******************************************************************
  4927*                   C H A N G E   L O G
  4928*
  4929* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4930*-----------------------------------------------------------------
  4931*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4932* EFFECTIVE    NUMBER
  4933*-----------------------------------------------------------------
  4934* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4935* 082317  CR2017082100003  PEMA  Add sub type
  4936******************************************************************
  4937
  4938 01  BENEFICIARY-MASTER.
  4939     12  BE-RECORD-ID                PIC XX.
  4940         88  VALID-BE-ID                VALUE 'BE'.
  4941
  4942     12  BE-CONTROL-PRIMARY.
  4943         16  BE-COMPANY-CD           PIC X.
  4944         16  BE-RECORD-TYPE          PIC X.
  4945             88  BENEFICIARY-RECORD  VALUE 'B'.
  4946             88  ADJUSTOR-RECORD     VALUE 'A'.
  4947         16  BE-BENEFICIARY          PIC X(10).
  4948     12  BE-CONTROL-BY-NAME.
  4949         16  BE-COMPANY-CD-A1        PIC X.
  4950         16  BE-RECORD-TYPE-A1       PIC X.
  4951         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  4952         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  4953
  4954     12  BE-LAST-MAINT-DT            PIC XX.
  4955     12  BE-LAST-MAINT-BY            PIC X(4).
  4956     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4957
  4958     12  BE-ADDRESS-DATA.
  4959         16  BE-MAIL-TO-NAME         PIC X(30).
  4960         16  BE-ADDRESS-LINE-1       PIC X(30).
  4961         16  BE-ADDRESS-LINE-2       PIC X(30).
  4962         16  BE-ADDRESS-LINE-3       PIC X(30).
  4963         16  BE-CITY-STATE.
  4964             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  94
* EL154.cbl
  4965             20  BE-STATE            PIC XX.
  4966         16  BE-ZIP-CODE.
  4967             20  BE-ZIP-PRIME.
  4968                 24  BE-ZIP-1ST      PIC X.
  4969                     88  BE-CANADIAN-POST-CODE
  4970                                         VALUE 'A' THRU 'Z'.
  4971                 24  FILLER          PIC X(4).
  4972             20  BE-ZIP-PLUS4        PIC X(4).
  4973         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  4974             20  BE-CAN-POSTAL-1     PIC XXX.
  4975             20  BE-CAN-POSTAL-2     PIC XXX.
  4976             20  FILLER              PIC XXX.
  4977         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  4978         16  BE-GROUP-CHECKS-Y-N     PIC X.
  4979
  4980******************************************************************
  4981*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  4982*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  4983******************************************************************
  4984     12  BE-CARRIER                  PIC X.
  4985
  4986     12  BE-ADDRESS-DATA2.
  4987         16  BE-MAIL-TO-NAME2        PIC X(30).
  4988         16  BE-ADDRESS-LINE-12      PIC X(30).
  4989         16  BE-ADDRESS-LINE-22      PIC X(30).
  4990         16  BE-ADDRESS-LINE-32      PIC X(30).
  4991         16  BE-CITY-STATE2.
  4992             20  BE-CITY2            PIC X(28).
  4993             20  BE-STATE2           PIC XX.
  4994         16  BE-ZIP-CODE2.
  4995             20  BE-ZIP-PRIME2.
  4996                 24  BE-ZIP-1ST2     PIC X.
  4997                     88  BE-CANADIAN-POST-CODE2
  4998                                         VALUE 'A' THRU 'Z'.
  4999                 24  FILLER          PIC X(4).
  5000             20  BE-ZIP-PLUS42       PIC X(4).
  5001         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  5002             20  BE-CAN-POSTAL-12    PIC XXX.
  5003             20  BE-CAN-POSTAL-22    PIC XXX.
  5004             20  FILLER              PIC XXX.
  5005         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  5006         16  BE-ACH-DATA.
  5007             20  BE-ACH-YES-OR-NO    PIC X.
  5008                 88  BE-ON-ACH       VALUE 'Y'.
  5009                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  5010             20  BE-ACH-ABA-ROUTING-NUMBER
  5011                                     PIC X(15).
  5012             20  BE-ACH-BANK-ACCOUNT-NUMBER
  5013                                     PIC X(20).
  5014             20  BE-ACH-SUB-TYPE     PIC XX.
  5015             20  FILLER              PIC X(23).
  5016         16  BE-BILLING-STMT-DATA.
  5017*            20  BE-BSR              PIC X.
  5018*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  5019*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  5020*            20  BE-BSR-FROM         PIC X(30).
  5021*            20  BE-BSR-DEPT         PIC X(30).
  5022             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  95
* EL154.cbl
  5023             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  5024             20  BE-OUTPUT-TYPE      PIC X.
  5025                 88  BE-FAX-OUTPUT         VALUE 'F'.
  5026                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  5027
  5028     12  FILLER                      PIC X(28).
  5029******************************************************************
  5030*                            COPY ERCACCT.
  5031******************************************************************
  5032*                                                                *
  5033*                                                                *
  5034*                            ERCACCT                             *
  5035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5036*                            VMOD=2.031                          *
  5037*                                                                *
  5038*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5039*                                                                *
  5040*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5041*   VSAM ACCOUNT MASTER FILES.                                   *
  5042*                                                                *
  5043*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5044*                                                                *
  5045*   FILE TYPE = VSAM,KSDS                                        *
  5046*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5047*                                                                *
  5048*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5049*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5050*                                                                *
  5051*   LOG = NO                                                     *
  5052*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5053*                                                                *
  5054*                                                                *
  5055******************************************************************
  5056*                   C H A N G E   L O G
  5057*
  5058* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5059*-----------------------------------------------------------------
  5060*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5061* EFFECTIVE    NUMBER
  5062*-----------------------------------------------------------------
  5063* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5064* 092705    2005050300006  PEMA  ADD SPP LEASES
  5065* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5066* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5067* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5068* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5069* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5070* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5071******************************************************************
  5072
  5073 01  ACCOUNT-MASTER.
  5074     12  AM-RECORD-ID                      PIC XX.
  5075         88  VALID-AM-ID                      VALUE 'AM'.
  5076
  5077     12  AM-CONTROL-PRIMARY.
  5078         16  AM-COMPANY-CD                 PIC X.
  5079         16  AM-MSTR-CNTRL.
  5080             20  AM-CONTROL-A.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  96
* EL154.cbl
  5081                 24  AM-CARRIER            PIC X.
  5082                 24  AM-GROUPING.
  5083                     28 AM-GROUPING-PREFIX PIC XXX.
  5084                     28 AM-GROUPING-PRIME  PIC XXX.
  5085                 24  AM-STATE              PIC XX.
  5086                 24  AM-ACCOUNT.
  5087                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5088                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5089             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5090                                           PIC X(19).
  5091             20  AM-CNTRL-B.
  5092                 24  AM-EXPIRATION-DT      PIC XX.
  5093                 24  FILLER                PIC X(4).
  5094             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5095                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5096
  5097     12  AM-CONTROL-BY-VAR-GRP.
  5098         16  AM-COMPANY-CD-A1              PIC X.
  5099         16  AM-VG-CARRIER                 PIC X.
  5100         16  AM-VG-GROUPING                PIC X(6).
  5101         16  AM-VG-STATE                   PIC XX.
  5102         16  AM-VG-ACCOUNT                 PIC X(10).
  5103         16  AM-VG-DATE.
  5104             20  AM-VG-EXPIRATION-DT       PIC XX.
  5105             20  FILLER                    PIC X(4).
  5106         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5107                                           PIC 9(11)      COMP-3.
  5108     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5109         16  FILLER                        PIC X(10).
  5110         16  AM-VG-KEY3.
  5111             20  AM-VG3-ACCOUNT            PIC X(10).
  5112             20  AM-VG3-EXP-DT             PIC XX.
  5113         16  FILLER                        PIC X(4).
  5114     12  AM-MAINT-INFORMATION.
  5115         16  AM-LAST-MAINT-DT              PIC XX.
  5116         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5117         16  AM-LAST-MAINT-USER            PIC X(4).
  5118         16  FILLER                        PIC XX.
  5119
  5120     12  AM-EFFECTIVE-DT                   PIC XX.
  5121     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5122
  5123     12  AM-PREV-DATES  COMP-3.
  5124         16  AM-PREV-EXP-DT                PIC 9(11).
  5125         16  AM-PREV-EFF-DT                PIC 9(11).
  5126
  5127     12  AM-REPORT-CODE-1                  PIC X(10).
  5128     12  AM-REPORT-CODE-2                  PIC X(10).
  5129
  5130     12  AM-CITY-CODE                      PIC X(4).
  5131     12  AM-COUNTY-PARISH                  PIC X(6).
  5132
  5133     12  AM-NAME                           PIC X(30).
  5134     12  AM-PERSON                         PIC X(30).
  5135     12  AM-ADDRS                          PIC X(30).
  5136     12  AM-CITY.
  5137         16  AM-ADDR-CITY                  PIC X(28).
  5138         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  97
* EL154.cbl
  5139     12  AM-ZIP.
  5140         16  AM-ZIP-PRIME.
  5141             20  AM-ZIP-PRI-1ST            PIC X.
  5142                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5143             20  FILLER                    PIC X(4).
  5144         16  AM-ZIP-PLUS4                  PIC X(4).
  5145     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5146         16  AM-CAN-POSTAL-1               PIC XXX.
  5147         16  AM-CAN-POSTAL-2               PIC XXX.
  5148         16  FILLER                        PIC XXX.
  5149     12  AM-TEL-NO.
  5150         16  AM-AREA-CODE                  PIC 999.
  5151         16  AM-TEL-PRE                    PIC 999.
  5152         16  AM-TEL-NBR                    PIC 9(4).
  5153     12  AM-TEL-LOC                        PIC X.
  5154         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5155         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5156
  5157     12  AM-COMM-STRUCTURE.
  5158         16  AM-DEFN-1.
  5159             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5160                 24  AM-AGT.
  5161                     28  AM-AGT-PREFIX     PIC X(4).
  5162                     28  AM-AGT-PRIME      PIC X(6).
  5163                 24  AM-COM-TYP            PIC X.
  5164                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5165                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5166                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5167                 24  AM-RECALC-LV-INDIC    PIC X.
  5168                 24  AM-RETRO-LV-INDIC     PIC X.
  5169                 24  AM-GL-CODES           PIC X.
  5170                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5171                 24  FILLER                PIC X(01).
  5172         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5173             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5174                 24  FILLER                PIC X(11).
  5175                 24  AM-L-COMA             PIC XXX.
  5176                 24  AM-J-COMA             PIC XXX.
  5177                 24  AM-A-COMA             PIC XXX.
  5178                 24  FILLER                PIC X(6).
  5179
  5180     12  AM-COMM-CHANGE-STATUS             PIC X.
  5181         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5182
  5183     12  AM-CSR-CODE                       PIC X(4).
  5184
  5185     12  AM-BILLING-STATUS                 PIC X.
  5186         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5187         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5188     12  AM-AUTO-REFUND-SW                 PIC X.
  5189         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5190         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5191     12  AM-GPCD                           PIC 99.
  5192     12  AM-IG                             PIC X.
  5193         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5194         88  AM-HAS-GROUP                     VALUE '2'.
  5195     12  AM-STATUS                         PIC X.
  5196         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  98
* EL154.cbl
  5197         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5198         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5199         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5200         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5201         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5202         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5203         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  5204         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5205         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5206     12  AM-REMIT-TO                       PIC 99.
  5207     12  AM-ID-NO                          PIC X(11).
  5208
  5209     12  AM-CAL-TABLE                      PIC XX.
  5210     12  AM-LF-DEVIATION                   PIC XXX.
  5211     12  AM-AH-DEVIATION                   PIC XXX.
  5212     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5213     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5214     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5215     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5216     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5217     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5218
  5219     12  AM-USER-FIELDS.
  5220         16  AM-FLD-1                      PIC XX.
  5221         16  AM-FLD-2                      PIC XX.
  5222         16  AM-FLD-3                      PIC XX.
  5223         16  AM-FLD-4                      PIC XX.
  5224         16  AM-FLD-5                      PIC XX.
  5225
  5226     12  AM-1ST-PROD-DATE.
  5227         16  AM-1ST-PROD-YR                PIC XX.
  5228         16  AM-1ST-PROD-MO                PIC XX.
  5229         16  AM-1ST-PROD-DA                PIC XX.
  5230     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5231     12  AM-CERTS-PURGED-DATE.
  5232         16  AM-PUR-YR                     PIC XX.
  5233         16  AM-PUR-MO                     PIC XX.
  5234         16  AM-PUR-DA                     PIC XX.
  5235     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5236     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5237     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5238     12  AM-INACTIVE-DATE.
  5239         16  AM-INA-MO                     PIC 99.
  5240         16  AM-INA-DA                     PIC 99.
  5241         16  AM-INA-YR                     PIC 99.
  5242     12  AM-AR-HI-CERT-DATE                PIC XX.
  5243
  5244     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5245     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5246
  5247     12  AM-OB-PAYMENT-MODE                PIC X.
  5248         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5249         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5250         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5251         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5252
  5253     12  AM-AH-ONLY-INDICATOR              PIC X.
  5254         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page  99
* EL154.cbl
  5255         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5256
  5257     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5258
  5259     12  AM-OVER-SHORT.
  5260         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5261         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5262
  5263     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5264     12  AM-DCC-CLP-STATE                  PIC XX.
  5265
  5266     12  AM-RECALC-COMM                    PIC X.
  5267     12  AM-RECALC-REIN                    PIC X.
  5268
  5269     12  AM-REI-TABLE                      PIC XXX.
  5270     12  AM-REI-ET-LF                      PIC X.
  5271     12  AM-REI-ET-AH                      PIC X.
  5272     12  AM-REI-PE-LF                      PIC X.
  5273     12  AM-REI-PE-AH                      PIC X.
  5274     12  AM-REI-PRT-ST                     PIC X.
  5275     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5276     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5277     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5278     12  AM-REI-GROUP-A                    PIC X(6).
  5279     12  AM-REI-MORT                       PIC X(4).
  5280     12  AM-REI-PRT-OW                     PIC X.
  5281     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5282     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5283     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5284     12  AM-REI-GROUP-B                    PIC X(6).
  5285
  5286     12  AM-TRUST-TYPE                     PIC X(2).
  5287
  5288     12  AM-EMPLOYER-STMT-USED             PIC X.
  5289     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5290
  5291     12  AM-STD-AH-TYPE                    PIC XX.
  5292     12  AM-EARN-METHODS.
  5293         16  AM-EARN-METHOD-R              PIC X.
  5294             88 AM-REF-RL-R78                 VALUE 'R'.
  5295             88 AM-REF-RL-PR                  VALUE 'P'.
  5296             88 AM-REF-RL-MEAN                VALUE 'M'.
  5297             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5298         16  AM-EARN-METHOD-L              PIC X.
  5299             88 AM-REF-LL-R78                 VALUE 'R'.
  5300             88 AM-REF-LL-PR                  VALUE 'P'.
  5301             88 AM-REF-LL-MEAN                VALUE 'M'.
  5302             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5303         16  AM-EARN-METHOD-A              PIC X.
  5304             88 AM-REF-AH-R78                 VALUE 'R'.
  5305             88 AM-REF-AH-PR                  VALUE 'P'.
  5306             88 AM-REF-AH-MEAN                VALUE 'M'.
  5307             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5308             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5309             88 AM-REF-AH-NET                 VALUE 'N'.
  5310
  5311     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5312     12  AM-TOL-REF                        PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 100
* EL154.cbl
  5313     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5314
  5315     12  AM-RET-Y-N                        PIC X.
  5316     12  AM-RET-P-E                        PIC X.
  5317     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5318     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5319     12  AM-RET-GRP                        PIC X(6).
  5320     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5321         16  AM-POOL-PRIME                 PIC XXX.
  5322         16  AM-POOL-SUB                   PIC XXX.
  5323     12  AM-RETRO-EARNINGS.
  5324         16  AM-RET-EARN-R                 PIC X.
  5325         16  AM-RET-EARN-L                 PIC X.
  5326         16  AM-RET-EARN-A                 PIC X.
  5327     12  AM-RET-ST-TAX-USE                 PIC X.
  5328         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5329         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5330     12  AM-RETRO-BEG-EARNINGS.
  5331         16  AM-RET-BEG-EARN-R             PIC X.
  5332         16  AM-RET-BEG-EARN-L             PIC X.
  5333         16  AM-RET-BEG-EARN-A             PIC X.
  5334     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5335     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5336
  5337     12  AM-USER-SELECT-OPTIONS.
  5338         16  AM-USER-SELECT-1              PIC X(10).
  5339         16  AM-USER-SELECT-2              PIC X(10).
  5340         16  AM-USER-SELECT-3              PIC X(10).
  5341         16  AM-USER-SELECT-4              PIC X(10).
  5342         16  AM-USER-SELECT-5              PIC X(10).
  5343
  5344     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5345
  5346     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5347
  5348     12  AM-RPT045A-SWITCH                 PIC X.
  5349         88  RPT045A-OFF                   VALUE 'N'.
  5350
  5351     12  AM-INSURANCE-LIMITS.
  5352         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5353         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5354
  5355     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5356         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5357
  5358     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5359         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5360         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5361
  5362     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5363
  5364     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5365     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5366     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5367     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5368     12  AM-DCC-UEF-STATE                  PIC XX.
  5369     12  FILLER                            PIC XXX.
  5370     12  AM-REPORT-CODE-3                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 101
* EL154.cbl
  5371*    12  FILLER                            PIC X(22).
  5372
  5373     12  AM-RESERVE-DATE.
  5374         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5375         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5376         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5377
  5378     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5379     12  AM-NOTIFICATION-TYPES.
  5380         16  AM-NOTIF-OF-LETTERS           PIC X.
  5381         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5382         16  AM-NOTIF-OF-REPORTS           PIC X.
  5383         16  AM-NOTIF-OF-STATUS            PIC X.
  5384
  5385     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5386         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5387         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5388         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5389         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5390
  5391     12  AM-BENEFIT-CONTROLS.
  5392         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5393             20  AM-BENEFIT-CODE           PIC XX.
  5394             20  AM-BENEFIT-TYPE           PIC X.
  5395             20  AM-BENEFIT-REVISION       PIC XXX.
  5396             20  AM-BENEFIT-REM-TERM       PIC X.
  5397             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5398             20  FILLER                    PIC XX.
  5399         16  FILLER                        PIC X(80).
  5400
  5401     12  AM-TRANSFER-DATA.
  5402         16  AM-TRANSFERRED-FROM.
  5403             20  AM-TRNFROM-CARRIER        PIC X.
  5404             20  AM-TRNFROM-GROUPING.
  5405                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5406                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5407             20  AM-TRNFROM-STATE          PIC XX.
  5408             20  AM-TRNFROM-ACCOUNT.
  5409                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5410                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5411             20  AM-TRNFROM-DTE            PIC XX.
  5412         16  AM-TRANSFERRED-TO.
  5413             20  AM-TRNTO-CARRIER          PIC X.
  5414             20  AM-TRNTO-GROUPING.
  5415                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5416                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5417             20  AM-TRNTO-STATE            PIC XX.
  5418             20  AM-TRNTO-ACCOUNT.
  5419                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5420                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5421             20  AM-TRNTO-DTE              PIC XX.
  5422         16  FILLER                        PIC X(10).
  5423
  5424     12  AM-SAVED-REMIT-TO                 PIC 99.
  5425
  5426     12  AM-COMM-STRUCTURE-SAVED.
  5427         16  AM-DEFN-1-SAVED.
  5428             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 102
* EL154.cbl
  5429                 24  AM-AGT-SV             PIC X(10).
  5430                 24  AM-COM-TYP-SV         PIC X.
  5431                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5432                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5433                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5434                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5435                 24  FILLER                PIC X.
  5436                 24  AM-GL-CODES-SV        PIC X.
  5437                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5438                 24  FILLER                PIC X.
  5439         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5440             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5441                 24  FILLER                PIC X(11).
  5442                 24  AM-L-COMA-SV          PIC XXX.
  5443                 24  AM-J-COMA-SV          PIC XXX.
  5444                 24  AM-A-COMA-SV          PIC XXX.
  5445                 24  FILLER                PIC X(6).
  5446
  5447     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5448         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5449            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5450            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5451            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5452
  5453     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5454     12  FILLER                            PIC X(120).
  5455
  5456     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5457         16  AM-CONTROL-NAME               PIC X(30).
  5458         16  AM-EXECUTIVE-ONE.
  5459             20  AM-EXEC1-NAME             PIC X(15).
  5460             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5461                                                          COMP-3.
  5462             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5463                                                          COMP-3.
  5464         16  AM-EXECUTIVE-TWO.
  5465             20  AM-EXEC2-NAME             PIC X(15).
  5466             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5467                                                          COMP-3.
  5468             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5469                                                          COMP-3.
  5470
  5471     12  AM-RETRO-ADDITIONAL-DATA.
  5472         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5473         16  AM-RETRO-PREM-P-E             PIC X.
  5474         16  AM-RETRO-CLMS-P-I             PIC X.
  5475         16  AM-RETRO-RET-BRACKET-LF.
  5476             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5477                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5478                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5479             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5480                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5481                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5482             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5483                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5484                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5485         16  AM-RETRO-RET-BRACKET-AH.
  5486             20  AM-RETRO-RET-METHOD-AH    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 103
* EL154.cbl
  5487                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5488                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5489                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5490             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5491                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5492                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5493             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5494                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5495                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5496
  5497     12  AM-COMMENTS.
  5498         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5499
  5500     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5501         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5502         16  AM-FLI-BILLING-CODE           PIC X.
  5503         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5504         16  AM-FLI-UNITED-IDENT           PIC X.
  5505         16  AM-FLI-INTEREST-LOST-DATA.
  5506             20  AM-FLI-BANK-NO            PIC X(5).
  5507             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5508             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5509             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5510         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5511             20  AM-FLI-AGT                PIC X(9).
  5512             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5513             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5514         16  FILLER                        PIC X(102).
  5515
  5516     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5517         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5518             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5519             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5520             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5521             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5522             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5523         16  FILLER                          PIC X(10).
  5524******************************************************************
  5525*                            COPY ERCPDEF.
  5526******************************************************************
  5527*                                                                *
  5528*                                                                *
  5529*                            ERCPDEF.                            *
  5530*                                                                *
  5531*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5532*                                                                *
  5533*    FILE TYPE = VSAM,KSDS                                       *
  5534*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5535*                                                                *
  5536*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5537*                                                                *
  5538*    LOG = YES                                                   *
  5539*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5540******************************************************************
  5541*                   C H A N G E   L O G
  5542*
  5543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5544*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 104
* EL154.cbl
  5545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5546* EFFECTIVE    NUMBER
  5547*-----------------------------------------------------------------
  5548* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5549* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5550* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  5551* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5552******************************************************************
  5553 01  PRODUCT-MASTER.
  5554    12  PD-RECORD-ID                 PIC X(02).
  5555        88  VALID-PD-ID                  VALUE 'PD'.
  5556    12  PD-CONTROL-PRIMARY.
  5557        16  PD-COMPANY-CD            PIC X.
  5558        16  PD-STATE                 PIC XX.
  5559        16  PD-PRODUCT-CD            PIC XXX.
  5560        16  PD-FILLER                PIC X(7).
  5561        16  PD-BEN-TYPE              PIC X.
  5562        16  PD-BEN-CODE              PIC XX.
  5563        16  PD-PROD-EXP-DT           PIC XX.
  5564    12  FILLER                       PIC X(50).
  5565    12  PD-PRODUCT-DATA OCCURS 8.
  5566        16  PD-PROD-CODE             PIC X.
  5567            88  PD-PROD-LIFE           VALUE 'L'.
  5568            88  PD-PROD-PROP           VALUE 'P'.
  5569            88  PD-PROD-AH             VALUE 'A'.
  5570            88  PD-PROD-IU             VALUE 'I'.
  5571            88  PD-PROD-GAP            VALUE 'G'.
  5572            88  PD-PROD-FAML           VALUE 'F'.
  5573            88  PD-PROD-OTH            VALUE 'O'.
  5574        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5575        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5576        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5577        16  PD-MAX-TERM              PIC S999        COMP-3.
  5578        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5579        16  FILLER                   PIC X.
  5580        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5581        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5582        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5583        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5584        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5585        16  PD-REC-CRIT-PERIOD       PIC 99.
  5586        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5587            20  PD-RECURRING-YN      PIC X.
  5588            20  FILLER               PIC X.
  5589        16  PD-RTW-MOS               PIC 99.
  5590        16  PD-MAX-EXTENSION         PIC 99.
  5591        16  pd-ben-pct               pic sv999 comp-3.
  5592*       16  FILLER                   PIC XX.
  5593    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5594    12  PD-TERM-LIMITS OCCURS 15.
  5595        16  PD-LOW-TERM              PIC S999        COMP-3.
  5596        16  PD-HI-TERM               PIC S999        COMP-3.
  5597*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5598    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5599        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5600        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5601    12  PD-EARN-FACTORS.
  5602        16  FILLER OCCURS 15.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 105
* EL154.cbl
  5603            20  FILLER OCCURS 15.
  5604                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5605    12  PD-PRODUCT-DESC              PIC X(80).
  5606    12  PD-TRUNCATED                 PIC X.
  5607    12  FILLER                       PIC X(59).
  5608    12  PD-MAINT-INFORMATION.
  5609        16  PD-LAST-MAINT-DT         PIC X(02).
  5610        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5611        16  PD-LAST-MAINT-BY         PIC X(04).
  5612*                            copy ELCCRTT.
  5613******************************************************************
  5614*                                                                *
  5615*                            ELCCRTT.                            *
  5616*                                                                *
  5617*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5618*                                                                *
  5619*   FILE TYPE = VSAM,KSDS                                        *
  5620*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5621*                                                                *
  5622*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5623*                                                                *
  5624*   LOG = YES                                                    *
  5625*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5626******************************************************************
  5627*                   C H A N G E   L O G
  5628*
  5629* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5630*-----------------------------------------------------------------
  5631*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5632* EFFECTIVE    NUMBER
  5633*-----------------------------------------------------------------
  5634* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5635* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5636* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5637* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5638* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5639* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5640* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5641* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5642* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5643* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5644* 091318  CR2018073000001  PEMA  ADD Refund methods
  5645* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5646******************************************************************
  5647
  5648 01  CERTIFICATE-TRAILERS.
  5649     12  CS-RECORD-ID                      PIC XX.
  5650         88  VALID-CS-ID                      VALUE 'CS'.
  5651
  5652     12  CS-CONTROL-PRIMARY.
  5653         16  CS-COMPANY-CD                 PIC X.
  5654         16  CS-CARRIER                    PIC X.
  5655         16  CS-GROUPING                   PIC X(6).
  5656         16  CS-STATE                      PIC XX.
  5657         16  CS-ACCOUNT                    PIC X(10).
  5658         16  CS-CERT-EFF-DT                PIC XX.
  5659         16  CS-CERT-NO.
  5660             20  CS-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 106
* EL154.cbl
  5661             20  CS-CERT-SFX               PIC X.
  5662         16  CS-TRAILER-TYPE               PIC X.
  5663             88  COMM-TRLR           VALUE 'A'.
  5664             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5665             88  CERT-DATA-TRLR      VALUE 'C'.
  5666
  5667     12  CS-DATA-AREA                      PIC X(516).
  5668
  5669     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5670         16  CS-BANK-COMMISSION-AREA.
  5671             20  CS-BANK-COMMS       OCCURS 10.
  5672                 24  CS-AGT                PIC X(10).
  5673                 24  CS-COM-TYP            PIC X.
  5674                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5675                 24  CS-RECALC-LV-INDIC    PIC X.
  5676                 24  FILLER                PIC X(10).
  5677         16  FILLER                        PIC X(256).
  5678
  5679     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5680****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5681         16  CS-MB-CLAIM-DATA OCCURS 24.
  5682             20  CS-CLAIM-NO               PIC X(7).
  5683             20  CS-CLAIM-TYPE             PIC X.
  5684                 88  CS-AH-CLM               VALUE 'A'.
  5685                 88  CS-IU-CLM               VALUE 'I'.
  5686                 88  CS-GP-CLM               VALUE 'G'.
  5687                 88  CS-LF-CLM               VALUE 'L'.
  5688                 88  CS-PR-CLM               VALUE 'P'.
  5689                 88  CS-FL-CLM               VALUE 'F'.
  5690                 88  CS-OT-CLM               VALUE 'O'.
  5691             20  CS-INSURED-TYPE           PIC X.
  5692                 88  CS-PRIM-INSURED          VALUE 'P'.
  5693                 88  CS-CO-BORROWER           VALUE 'C'.
  5694             20  CS-BENEFIT-PERIOD         PIC 99.
  5695             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5696             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5697             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5698         16  FILLER                        PIC X(12).
  5699     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5700         16  CS-VIN-NUMBER                 PIC X(17).
  5701         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5702         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5703         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5704         16  cs-agent-name.
  5705             20  cs-agent-fname            pic x(20).
  5706             20  cs-agent-mi               pic x.
  5707             20  cs-agent-lname            pic x(25).
  5708         16  cs-license-no                 pic x(15).
  5709         16  cs-npn-number                 pic x(10).
  5710         16  cs-agent-edit-status          pic x.
  5711             88  cs-ae-refer-to-manager      value 'M'.
  5712             88  cs-ae-cover-sheet           value 'C'.
  5713             88  cs-ae-sig-form              value 'S'.
  5714             88  cs-ae-verified              value 'V'.
  5715             88  cs-unidentified-signature   value 'U'.
  5716             88  cs-cert-returned            value 'R'.
  5717             88  cs-accept-no-commission     value 'N'.
  5718         16  cs-year                       pic 9999.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 107
* EL154.cbl
  5719         16  cs-make                       pic x(20).
  5720         16  cs-model                      pic x(20).
  5721         16  cs-future                     pic x(20).
  5722         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5723         16  cs-claim-verification-status  pic x.
  5724             88  cs-clm-ver-eligible         value 'A'.
  5725             88  cs-clm-ver-partial-elig     value 'B'.
  5726             88  cs-clm-ver-not-eligible     value 'C'.
  5727             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5728             88  cs-clm-ver-not-part-elig-rw value 'E'.
  5729             88  cs-clm-ver-ND-CERT          value 'F'.
  5730             88  cs-clm-ver-spec-other       value 'G'.
  5731             88  cs-clam-ver-pratial-corrected
  5732                                             value 'H'.
  5733             88  cs-clm-ver-no-matches       value 'I'.
  5734             88  cs-clm-ver-not-elig-corrected
  5735                                             value 'J'.
  5736             88  cs-clm-ver-needs-review     value 'R'.
  5737             88  cs-clm-ver-sent-to-claims   value 'W'.
  5738         16  CS-LF-REFUND-METHOD           PIC X.
  5739         16  CS-AH-REFUND-METHOD           PIC X.
  5740         16  FILLER                        PIC X(353). *> was 420
  5741*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 108
* EL154.cbl
  5743*                            COPY MPCPLCY.
  5744******************************************************************
  5745*                                                                *
  5746*                           MPCPLCY                              *
  5747*                            VMOD=1.024                          *
  5748*                                                                *
  5749*   FILE DESCRIPTION = POLICY MASTER                             *
  5750*                                                                *
  5751*   FILE TYPE = VSAM,KSDS                                        *
  5752*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5753*                                                                *
  5754*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5755*       ALTERNATE PATH2 = ** NOT USED **                         *
  5756*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5757*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5758*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5759*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5760*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5761*                                                                *
  5762*   LOG = YES                                                    *
  5763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5764******************************************************************
  5765**WARNING*********************************************************
  5766**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  5767**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  5768**                             MPCPHSTD                          *
  5769**                             MPCPHSTC                          *
  5770**                             MPCPHSTT                          *
  5771**                                                               *
  5772******************************************************************
  5773
  5774 01  POLICY-MASTER.
  5775     12  PM-RECORD-ID                      PIC XX.
  5776         88  VALID-PM-ID                      VALUE 'PM'.
  5777
  5778******************************************************************
  5779*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  5780******************************************************************
  5781
  5782     12  PM-CONTROL-PRIMARY.
  5783         16  PM-PRODUCER-PRIMARY.
  5784             20  PM-PROD-PRIMARY.
  5785                 24  PM-COMPANY-CD         PIC X.
  5786                 24  PM-CGSP-KEY.
  5787                     28  PM-CARRIER        PIC X.
  5788                     28  PM-GROUPING.
  5789                         32  PM-GROUPING-PREFIX
  5790                                           PIC X(3).
  5791                         32  PM-GROUPING-PRIME
  5792                                           PIC X(3).
  5793                     28  PM-STATE          PIC X(2).
  5794                     28  PM-PRODUCER.
  5795                         32  PM-PRODUCER-PREFIX
  5796                                           PIC X(4).
  5797                         32  PM-PRODUCER-PRIME
  5798                                           PIC X(6).
  5799             20  PM-POLICY-EFF-DT              PIC XX.
  5800         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 109
* EL154.cbl
  5801             20  PM-REFNO-PRIME            PIC X(18).
  5802             20  PM-REFNO-SFX              PIC XX.
  5803
  5804******************************************************************
  5805*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5806******************************************************************
  5807
  5808     12  PM-CONTROL-BY-SSN.
  5809         16  PM-COMPANY-CD-A3              PIC X.
  5810         16  PM-SOC-SEC-NO.
  5811             20  PM-SSN-STATE              PIC XX.
  5812             20  PM-SSN-PRODUCER           PIC X(6).
  5813             20  PM-SSN-LN3.
  5814                 25  PM-INSURED-INITIALS-A3.
  5815                     30 PM-INSURED-INITIAL1-A3 PIC X.
  5816                     30 PM-INSURED-INITIAL2-A3 PIC X.
  5817                 25 PM-PART-LAST-NAME-A3         PIC X.
  5818         16  PM-DATE-A3                     PIC XX.
  5819         16  PM-TIME-A3                     PIC S9(04)   COMP.
  5820
  5821******************************************************************
  5822*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  5823******************************************************************
  5824
  5825     12  PM-CONTROL-BY-POLICY-NO.
  5826         16  PM-COMPANY-CD-A4              PIC X.
  5827         16  PM-POLICY-NO-A4.
  5828             20  PM-POLICY-PRIME-A4        PIC X(18).
  5829             20  PM-POLICY-SFX-A4          PIC XX.
  5830         16  PM-DATE-A4                    PIC XX.
  5831         16  PM-TIME-A4                    PIC S9(04)   COMP.
  5832
  5833******************************************************************
  5834*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  5835******************************************************************
  5836
  5837     12  PM-CONTROL-BY-ACCOUNT.
  5838         16  PM-COMPANY-CD-A5              PIC X.
  5839         16  PM-BANK-ACCOUNT-NUMBER        PIC X(20).
  5840         16  PM-DATE-A5                    PIC XX.
  5841         16  PM-TIME-A5                    PIC S9(07)   COMP.
  5842
  5843******************************************************************
  5844*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  5845******************************************************************
  5846
  5847     12  PM-CONTROL-BY-TRANSIT.
  5848         16  PM-COMPANY-CD-A6              PIC X.
  5849         16  PM-BANK-TRANSIT-NUMBER.
  5850             20  PM-FEDERAL-NUMBER         PIC X(4).
  5851             20  PM-BANK-NUMBER            PIC X(4).
  5852         16  PM-DATE-A6                    PIC XX.
  5853         16  PM-TIME-A6                    PIC S9(07)   COMP.
  5854
  5855******************************************************************
  5856*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  5857******************************************************************
  5858
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 110
* EL154.cbl
  5859     12  PM-CONTROL-BY-LOAN-NO.
  5860         16  PM-COMPANY-CD-A7              PIC X.
  5861         16  PM-LOAN-NUMBER                PIC X(20).
  5862         16  PM-DATE-A7                    PIC XX.
  5863         16  PM-TIME-A7                    PIC S9(07)   COMP.
  5864
  5865******************************************************************
  5866*                 FILE SYNCHRONIZATION DATA                      *
  5867******************************************************************
  5868
  5869     12  FILLER                            PIC X(05).
  5870     12  PM-FILE-SYNCH-DATA.
  5871         16  PM-LAST-CHANGE-DT             PIC XX.
  5872         16  PM-LAST-CHANGE-TIME           PIC S9(7)    COMP.
  5873         16  PM-LAST-CHANGE-PROCESSOR      PIC X(4).
  5874     12  FILLER                            PIC X(05).
  5875
  5876******************************************************************
  5877*                    INSUREDS PROFILE DATA                       *
  5878******************************************************************
  5879
  5880     12  PM-INSURED-PROFILE-DATA.
  5881         16  PM-INSURED-NAME.
  5882             20  PM-INSURED-LAST-NAME     PIC X(15).
  5883             20  PM-INSURED-FIRST-NAME.
  5884                 24  PM-INSURED-1ST-INIT PIC X.
  5885                 24  FILLER               PIC X(9).
  5886             20  PM-INSURED-MIDDLE-INIT PIC X.
  5887         16  PM-INSURED-ADDRESS.
  5888             20  PM-ADDRESS-LINE-1         PIC X(30).
  5889             20  PM-ADDRESS-LINE-2         PIC X(30).
  5890             20  PM-CITY                   PIC X(25).
  5891             20  PM-RESIDENT-STATE         PIC XX.
  5892             20  PM-ZIP-CD.
  5893                 24  PM-ZIP-FIRST-FIVE     PIC X(5).
  5894                 24  PM-ZIP-PLUS-FOUR      PIC X(4).
  5895         16  PM-INSURED-PERSONAL.
  5896             20  PM-INSURED-OCC-CLASS      PIC X.
  5897                 88  PM-PREFERRED            VALUE '1'.
  5898                 88  PM-STANDARD             VALUE '2'.
  5899                 88  PM-HAZARDOUS            VALUE '3'.
  5900                 88  PM-VERY-HAZARDOUS       VALUE '4'.
  5901                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  5902                 88  PM-NOT-OCC              VALUE '6'.
  5903                 88  PM-OCC-UNKNOWN          VALUE '9'.
  5904             20  PM-INSURED-OCC-CD         PIC X(3).
  5905             20  PM-INSURED-OCC-CD-NUM REDEFINES
  5906                 PM-INSURED-OCC-CD         PIC 9(3).
  5907             20  PM-INSURED-SEX            PIC X.
  5908                 88  PM-INSURED-SEX-MALE      VALUE 'M'.
  5909                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  5910             20  PM-INSURED-BIRTH-DT       PIC XX.
  5911             20  PM-INSURED-ISSUE-AGE      PIC S9(3)     COMP-3.
  5912             20  PM-INSURED-HEIGHT-FT      PIC S9(3)     COMP-3.
  5913             20  PM-INSURED-HEIGHT-IN      PIC S9(3)     COMP-3.
  5914             20  PM-INSURED-WEIGHT         PIC S9(3)     COMP-3.
  5915             20  PM-INSURED-BIRTH-STATE PIC XX.
  5916             20  PM-INSURED-PHONE-NO       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 111
* EL154.cbl
  5917             20  PM-INSURED-RATED-AGE      PIC S9(3)     COMP-3.
  5918         16  PM-INS-LANGUAGE-IND           PIC X(01).
  5919             88  PM-ENGLISH                           VALUE 'E'.
  5920             88  PM-FRENCH                            VALUE 'F'.
  5921             88  PM-SPANISH                           VALUE 'S'.
  5922         16  PM-INSURED-TOT-BENEFIT        PIC S9(7)V99  COMP-3.
  5923
  5924         16  PM-INSURED-AGE-IND            PIC X(01).
  5925             88  PM-INSURED-AGE-75-REACHED            VALUE 'Y'.
  5926     12  FILLER                            PIC X(13).
  5927
  5928******************************************************************
  5929*                JOINT INSUREDS PROFILE DATA                     *
  5930******************************************************************
  5931
  5932     12  PM-JOINT-PROFILE-DATA.
  5933         16  PM-JOINT-NAME.
  5934             20  PM-JOINT-LAST-NAME        PIC X(15).
  5935             20  PM-JOINT-FIRST-NAME.
  5936                 24  PM-JOINT-1ST-INIT     PIC X.
  5937                 24  FILLER                PIC X(9).
  5938             20  PM-JOINT-MIDDLE-INIT      PIC X.
  5939         16  PM-JOINT-SOC-SEC-NO.
  5940             20  PM-JT-SSN-STATE           PIC XX.
  5941             20  PM-JT-SSN-PRODUCER        PIC X(6).
  5942             20  PM-JT-SSN-LN3.
  5943                 25  PM-JT-INSURED-INITIALS-A3.
  5944                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  5945                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  5946                 25 PM-JT-PART-LAST-NAME-A3        PIC X.
  5947         16  PM-JOINT-PERSONAL.
  5948             20  PM-JOINT-OCC-CLASS        PIC X.
  5949                 88 PM-JNT-PREFERRED          VALUE '1'.
  5950                 88 PM-JNT-STANDARD           VALUE '2'.
  5951                 88 PM-JNT-HAZARDOUS          VALUE '3'.
  5952                 88 PM-JNT-VERY-HAZARDOUS     VALUE '4'.
  5953                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  5954                 88 PM-JNT-NOT-OCC            VALUE '6'.
  5955                 88 PM-JNT-OCC-UNKNOWN        VALUE '9'.
  5956             20  PM-JOINT-OCC-CD           PIC X(3).
  5957             20  PM-JOINT-SEX              PIC X.
  5958                 88  PM-JOINT-SEX-MALE        VALUE 'M'.
  5959                 88  PM-JOINT-SEX-FEMALE      VALUE 'F'.
  5960             20  PM-JOINT-BIRTH-DT         PIC XX.
  5961             20  PM-JOINT-ISSUE-AGE        PIC S9(3)     COMP-3.
  5962             20  PM-JOINT-HEIGHT-FT        PIC S9(3)     COMP-3.
  5963             20  PM-JOINT-HEIGHT-IN        PIC S9(3)     COMP-3.
  5964             20  PM-JOINT-WEIGHT           PIC S9(3)     COMP-3.
  5965             20  PM-JOINT-BIRTH-STATE      PIC XX.
  5966             20  PM-JOINT-RATED-AGE        PIC S9(3)     COMP-3.
  5967         16  PM-JOINT-TOT-BENEFIT          PIC S9(7)V99  COMP-3.
  5968         16  PM-JOINT-AGE-IND              PIC X(01).
  5969             88  PM-JOINT-AGE-75-REACHED              VALUE 'Y'.
  5970
  5971     12  FILLER                            PIC X(12).
  5972
  5973******************************************************************
  5974*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 112
* EL154.cbl
  5975******************************************************************
  5976
  5977     12  PM-INS-COVERAGE-DATA.
  5978         16  PM-FREE-PERIOD                PIC S9(03)    COMP-3.
  5979         16  PM-LOAN-TERM                  PIC S9(3)     COMP-3.
  5980         16  PM-LOAN-APR                   PIC S9V9999   COMP-3.
  5981         16  PM-LOAN-DT                    PIC XX.
  5982         16  PM-LOAN-PYMT                  PIC S9(5)V99  COMP-3.
  5983         16  PM-LOAN-BALC                  PIC S9(7)V99  COMP-3.
  5984         16  PM-INS-BENEFIT-MONTHS         PIC S9(3)     COMP-3.
  5985         16  PM-INS-MONTH-BENEFIT          PIC S9(7)V99  COMP-3.
  5986         16  PM-INS-TOTAL-BENEFIT          PIC S9(7)V99  COMP-3.
  5987         16  PM-INS-PLAN-TYPE              PIC X.
  5988             88  PM-AH-MORT-PLAN              VALUE 'A'.
  5989             88  PM-AD-D-MORT-PLAN            VALUE 'E'.
  5990             88  PM-DISMEM-MORT-PLAN          VALUE 'D'.
  5991             88  PM-LIFE-MORT-PLAN            VALUE 'L'.
  5992         16  PM-INS-PLAN-CD                PIC XX.
  5993         16  PM-INS-PLAN-REVISION          PIC X(3).
  5994         16  PM-INS-POLICY-FORM            PIC X(12).
  5995         16  PM-INS-MSTR-POLICY.
  5996             20  PM-FREE-TYPE              PIC X(04).
  5997             20  FILLER                    PIC X(08).
  5998         16  PM-INS-MSTR-APP.
  5999             20  FILLER                    PIC X(11).
  6000             20  PM-INS-B-C-TYPE           PIC X(01).
  6001         16  PM-INS-RATE-CD                PIC X(5).
  6002         16  PM-INS-SEX-RATING             PIC X.
  6003             88  PM-NOT-SEX-RATED              VALUE '1'.
  6004             88  PM-SEX-RATED                  VALUE '2'.
  6005         16  PM-INS-SUBSTANDARD-PCT        PIC S9V9999   COMP-3.
  6006         16  PM-INS-SUBSTANDARD-TYPE       PIC X.
  6007         16  PM-INS-TERMINATION-DT         PIC XX.
  6008         16  PM-INS-MONTH-PREMIUM      PIC S9(5)V999999  COMP-3.
  6009         16  PM-INS-CALC-MO-PREM       PIC S9(5)V999999  COMP-3.
  6010         16  PM-REINSURANCE-TABLE          PIC X(3).
  6011         16  PM-MORTALITY-CD               PIC X(4).
  6012         16  PM-INS-TYPE                   PIC X.
  6013             88  PM-INDIVIDUAL                VALUES ARE '1' 'I'.
  6014             88  PM-GROUP                     VALUES ARE '2' 'G'.
  6015         16  PM-LOAN-OFFICER               PIC X(5).
  6016         16  PM-POLICY-FEE                 PIC S9(3)V99 COMP-3.
  6017         16  PM-DEPENDENT-COUNT            PIC S99      COMP-3.
  6018         16  PM-CWA-AMOUNT                 PIC S9(5)V99  COMP-3.
  6019         16  PM-LAST-AUTO-RERATE-DT        PIC XX.
  6020         16  PM-PREM-FINANCED-SW           PIC X.
  6021             88  PM-PREM-FINANCED              VALUE 'Y'.
  6022             88  PM-PREM-NOT-FINANCED          VALUE 'N'.
  6023
  6024         16  PM-INS-TERM-LETTER-IND        PIC X.
  6025             88  PM-TERM-INITIALIZED           VALUE 'Y'.
  6026         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99     COMP-3.
  6027     12  FILLER                            PIC X(11).
  6028
  6029******************************************************************
  6030*                    POLICY BILLING DATA                         *
  6031******************************************************************
  6032
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 113
* EL154.cbl
  6033     12  PM-BILLING-DATA.
  6034         16  PM-BILLING-MODE               PIC X(1).
  6035             88  PM-ANNUAL                    VALUE '1'.
  6036             88  PM-SEMI-ANNUAL               VALUE '2'.
  6037             88  PM-QUARTERLY                 VALUE '3'.
  6038             88  PM-MONTHLY                   VALUE '4'.
  6039             88  PM-BI-MONTHLY                VALUE '5'.
  6040             88  PM-SINGLE-PREM               VALUE '6'.
  6041         16  PM-BILLING-SCHEDULE           PIC X(1).
  6042         16  PM-BILLING-SW                 PIC X(1).
  6043             88  PM-FIRST-BILLING             VALUE 'Y'.
  6044             88  PM-PAID-IN-ADVANCE           VALUE 'A'.
  6045             88  PM-POLICY-FEE-REFUNDED       VALUE 'F'.
  6046         16  PM-BILLING-TYPE               PIC X(1).
  6047             88  PM-LIST-BILL                 VALUE '1'.
  6048             88  PM-TAPE-BILL                 VALUE '2'.
  6049             88  PM-TAPE-LIST-BILL            VALUE '3'.
  6050             88  PM-GROUP-BILL          VALUE ARE '1' '2' '3'.
  6051             88  PM-DIRECT-BILL               VALUE '4'.
  6052             88  PM-PAC-BILL            VALUE ARE '5' 'C' 'S'.
  6053             88  PM-CHARGE-CARD-BILL          VALUE '6'.
  6054             88  PM-INDIV-BILL
  6055                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  6056             88  PM-GRP-PLCY-BILL             VALUE '7'.
  6057             88  PM-GRP-PLCY-PAC              VALUE '8'.
  6058             88  PM-GRP-PLCY-CR-CRD           VALUE '9'.
  6059             88  PM-GRP-PLCY            VALUE ARE '7' '8' '9'.
  6060             88  PM-GRP-PROD                  VALUE 'A'.
  6061             88  PM-EFT-CHECKING              VALUE 'C'.
  6062             88  PM-EFT-SAVINGS               VALUE 'S'.
  6063         16  PM-PAYMENT-AMT                PIC S9(5)V99  COMP-3.
  6064         16  PM-OVER-SHORT-AMT             PIC S9(5)V99  COMP-3.
  6065         16  PM-LAST-BILL-DT               PIC XX.
  6066         16  PM-LAST-BILL-AMT              PIC S9(5)V99  COMP-3.
  6067         16  PM-BILL-TO-DT                 PIC XX.
  6068         16  PM-LAST-PYMT-DT               PIC XX.
  6069         16  PM-PAID-TO-DT                 PIC XX.
  6070         16  PM-PYMT-INVOICE-NUMBER        PIC X(6).
  6071         16  PM-MONTHS-PAID                PIC S9(3)     COMP-3.
  6072         16  PM-TOTAL-PREM-RECVD           PIC S9(7)V99  COMP-3.
  6073         16  PM-BILLING-GROUPING-CODE      PIC X(6).
  6074         16  PM-CHARGE-CARD-EXP-DT         PIC X(2).
  6075         16  PM-CHARGE-CARD-TYPE           PIC X(2).
  6076             88  PM-VISA                      VALUE 'VI'.
  6077             88  PM-MSTR-CARD                 VALUE 'MC'.
  6078             88  PM-DINERS-CLUB               VALUE 'DN'.
  6079             88  PM-DISCOVER                  VALUE 'DS'.
  6080             88  PM-CARTE-BLANCHE             VALUE 'CB'.
  6081             88  PM-AMERICAN-EXPRESS          VALUE 'AE'.
  6082         16  PM-BILL-INVOICE-NUMBER        PIC X(6).
  6083         16  PM-BILL-DAY                   PIC S99       COMP-3.
  6084         16  PM-RES-PREM-TAX           PIC S9(3)V999999  COMP-3.
  6085     12  FILLER                            PIC X(15).
  6086
  6087******************************************************************
  6088*                     CLAIM PAYMENT DATA                         *
  6089******************************************************************
  6090
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 114
* EL154.cbl
  6091     12  PM-CLAIM-PAYMENT-DATA.
  6092         16  PM-CLAIM-BENEFICIARY-NAME     PIC X(25).
  6093         16  PM-CLAIM-INTERFACE-SW         PIC X.
  6094             88  PM-NO-CLAIM-ATTACHED         VALUE SPACE.
  6095             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  6096             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  6097             88  PM-CLAIM-CLOSED              VALUE '3'.
  6098             88  PM-ACTIVE-CLAIM              VALUE '1' '2'.
  6099             88  PM-CLAIM-ATTACHED            VALUE '1' '2' '3'.
  6100         16  PM-CLAIM-INCURRED-DT          PIC XX.
  6101         16  PM-CLAIM-PAID-TO-DT           PIC XX.
  6102         16  PM-CLAIM-PAYMENT-CNT          PIC S9(3)     COMP-3.
  6103         16  PM-CLAIM-LAST-PAYMENT-AMT     PIC S9(7)V99  COMP-3.
  6104         16  PM-CLAIM-EXPENSES-ITD         PIC S9(7)V99  COMP-3.
  6105         16  PM-CLAIM-PAYMENTS-ITD         PIC S9(7)V99  COMP-3.
  6106         16  PM-CLAIM-ACCUMULATOR          PIC S9(7)V99  COMP-3.
  6107         16  PM-CLAIM-ATTACH-CNT           PIC S9(3)     COMP-3.
  6108         16  PM-CLAIM-LIFE-ITD             PIC S9(7)V99  COMP-3.
  6109         16  PM-CLAIM-AH-ITD               PIC S9(7)V99  COMP-3.
  6110         16  PM-CLAIM-RIDER-ITD            PIC S9(7)V99  COMP-3.
  6111
  6112     12  FILLER                            PIC X(03).
  6113
  6114******************************************************************
  6115*                POLICY STATUS AND DISPOSITION                   *
  6116******************************************************************
  6117
  6118     12  PM-STATUS-DISPOSITION-DATA.
  6119         16  PM-ISSUE-EOM-DT               PIC XX.
  6120         16  PM-REPLACEMENT-SWITCH         PIC X.
  6121         16  PM-APPL-SIGN-DT               PIC XX.
  6122         16  PM-UNDERWRITER                PIC X(3).
  6123         16  PM-ENTRY-PROCESSOR            PIC X(4).
  6124         16  PM-ENTRY-STATUS               PIC X.
  6125             88  PM-NORMAL                    VALUE '1'.
  6126             88  PM-TAKE-OVER                 VALUE '2'.
  6127             88  PM-CONVERSION                VALUE '4'.
  6128             88  PM-RE-ISSUE                  VALUE '5'.
  6129             88  PM-REINSURANCE-ONLY          VALUE '9'.
  6130         16  PM-ENTRY-DT                   PIC XX.
  6131         16  PM-ENTRY-TIME                 PIC S9(7) COMP-3.
  6132         16  PM-EXIT-DT                    PIC XX.
  6133         16  PM-CURRENT-STATUS             PIC X.
  6134             88  PM-LAPSE                     VALUE '0'.
  6135             88  PM-ACTIVE                    VALUE '1'.
  6136             88  PM-PENDING-ISSUE             VALUE '2'.
  6137             88  PM-DECLINED                  VALUE '3'.
  6138             88  PM-PENDING-CANCEL            VALUE '4'.
  6139             88  PM-PENDING-ISSUE-ERROR       VALUE '5'.
  6140             88  PM-CLAIM-APPLIED             VALUE '6'.
  6141             88  PM-CANCEL                    VALUE '7'.
  6142             88  PM-PENDING-UNWTR-REVW        VALUE '8'.
  6143             88  PM-PENDING-CANCEL-ERROR      VALUE '9'.
  6144             88  PM-CANCEL-TRANSFER           VALUE 'C'.
  6145             88  PM-CLAIM-SETTLEMENT          VALUE 'F'.
  6146             88  PM-TERMINATE                 VALUE 'T'.
  6147** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  6148** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 115
* EL154.cbl
  6149** THESE GROUPS.
  6150             88  PM-TYPE-STAT-1
  6151                     VALUES ARE '0' '1' '4' '6' '7' '9'
  6152                                'C' 'F' 'T'.
  6153             88  PM-TYPE-STAT-2
  6154                     VALUES ARE '2' '3' '5' '8'.
  6155             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  6156             88  PM-PENDING-STATUS
  6157                                VALUES ARE '2' '4' '5' '8' '9'.
  6158             88  PM-PENDING-ISSUE-STATUS
  6159                                VALUES ARE '2' '5' '8'.
  6160             88  PM-CANCEL-STATUS
  6161                                VALUES ARE '4' '7' '9' 'C'.
  6162         16  PM-CANCEL-CAUSE-CD            PIC X(3).
  6163         16  PM-CANCEL-DT                  PIC XX.
  6164         16  PM-REFUND-AMT                 PIC S9(5)V99  COMP-3.
  6165         16  PM-CALC-REFUND-AMT            PIC S9(5)V99  COMP-3.
  6166         16  PM-DECLINE-CD                 PIC X(3).
  6167         16  PM-DECLINE-DT                 PIC XX.
  6168         16  PM-LAST-LAPSE-DT              PIC XX.
  6169         16  PM-LAST-REINSTATE-DT          PIC XX.
  6170         16  PM-SECURITY-ACCESS-CODE       PIC X.
  6171         16  PM-PREV-CONTROL-PRIMARY.
  6172             20  PM-PREV-COMPANY-CD             PIC X.
  6173             20  PM-PREV-CARRIER                PIC X.
  6174             20  PM-PREV-GROUPING.
  6175                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  6176                 24  PM-PREV-GROUPING-PRIME     PIC X(3).
  6177             20  PM-PREV-STATE                  PIC XX.
  6178             20  PM-PREV-PRODUCER.
  6179                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6180                 24  PM-PREV-PRODUCER-PRIME     PIC X(6).
  6181             20  PM-PREV-POLICY-EFF-DT          PIC XX.
  6182             20  PM-PREV-REFERENCE-NUMBER.
  6183                 24  PM-PREV-REFNO-PRIME        PIC X(18).
  6184                 24  PM-PREV-REFNO-SFX          PIC XX.
  6185         16  PM-ACTION-DT                  PIC XX.
  6186         16  PM-ACTION-CODE                PIC X(3).
  6187         16  PM-ACTION-DT-2                PIC XX.
  6188         16  PM-ACTION-CODE-2              PIC X(3).
  6189         16  PM-ACTION-DT-3                PIC XX.
  6190         16  PM-ACTION-CODE-3              PIC X(3).
  6191         16  PM-ACTION-DT-4                PIC XX.
  6192         16  PM-ACTION-CODE-4              PIC X(3).
  6193         16  PM-ACTION-DT-5                PIC XX.
  6194         16  PM-ACTION-CODE-5              PIC X(3).
  6195
  6196         16  PM-KEY-CHANGE                 PIC X.
  6197                 88  PM-NO-KEY-CHG      VALUES ARE ' ' 'N'.
  6198                 88  PM-KEY-CHG              VALUE 'Y'.
  6199         16  PM-KEY-CHANGE-DT              PIC XX.
  6200
  6201         16  PM-RTI-INDICATOR              PIC X.
  6202         16  PM-REASON-CODE                PIC X(3).
  6203         16  PM-IN-OUT-PROCESSING-IND      PIC X(1).
  6204             88  PM-IN-OUT-PROCESSING      VALUE 'Y'.
  6205             88  PM-NOT-IN-OUT-PROCESSING  VALUE SPACES.
  6206
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 116
* EL154.cbl
  6207     12  FILLER                            PIC X(12).
  6208
  6209******************************************************************
  6210*                 AGENT AND COMMISSION DATA                      *
  6211******************************************************************
  6212
  6213     12  PM-COMMISSION-DATA.
  6214         16  PM-REMIT-TO                   PIC S9(3) COMP-3.
  6215         16  PM-COMM-CHANGE-SW             PIC X.
  6216                 88  PM-COMMISSION-CHANGE     VALUE 'Y'.
  6217         16  PM-AGENT-INFORMATION OCCURS     5 TIMES.
  6218             20  PM-AGENT-NUMBER           PIC X(10).
  6219             20  PM-AGENT-TYPE             PIC X.
  6220                 88  PM-PRODUCER-LEVEL-AGENT
  6221                                              VALUES ARE 'C' 'D'.
  6222                 88  PM-AGENT-GROSS           VALUE 'C'.
  6223                 88  PM-AGENT-REINS           VALUE 'R'.
  6224                 88  PM-AGENT-GROSS-REINS     VALUE 'D'.
  6225                 88  PM-OVERWRITE-GROSS       VALUE 'O'.
  6226                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6227                 88  PM-OVERWRITE-REINS       VALUE 'T'.
  6228                 88  PM-REINS-ONLY            VALUE 'W'.
  6229             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6230                 88  PM-GENERATE-BILL         VALUE 'B'.
  6231                 88  PM-GENERATE-PAID         VALUE 'P'.
  6232             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6233             20  PM-COMP-1ST-YEAR-TYPE     PIC X(1).
  6234                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6235                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6236                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6237             20  PM-RENEWAL-DATA.
  6238                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6239                     28  PM-RENEW-MONTHS     PIC S999    COMP-3.
  6240                     28  PM-RENEW-COMMISSION
  6241                                             PIC S99V999 COMP-3.
  6242                     28  PM-RENEW-TYPE       PIC X(1).
  6243                         88  PM-COMP-RENEW-PERCENT      VALUE '1'.
  6244                         88  PM-COMP-RENEW-DOLLARS      VALUE '2'.
  6245                         88  PM-COMP-RENEW-NOT-USED     VALUE '3'.
  6246             20  PM-COMP-RECALC-FLAG       PIC X(1).
  6247                 88  PM-BYPASS-RECALC         VALUE 'N'.
  6248     12  FILLER                            PIC X(20).
  6249******************************************************************
  6250*             CUSTOMER DATA                                      *
  6251******************************************************************
  6252     12  PM-CUSTOMER-ID                    PIC X(20).
  6253******************************************************************
  6254     12  FILLER                            PIC X(43).
  6255******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 117
* EL154.cbl
  6257 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  6258                          CLAIM-MASTER ACTIVITY-TRAILERS
  6259                          CERTIFICATE-MASTER BENEFICIARY-MASTER
  6260                          ACCOUNT-MASTER PRODUCT-MASTER
  6261                          CERTIFICATE-TRAILERS POLICY-MASTER.
  6262 0000-DFHEXIT SECTION.
  6263     MOVE '9#                    $   ' TO DFHEIV0.
  6264     MOVE 'EL154' TO DFHEIV1.
  6265     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6266     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6267     MOVE '5'                   TO DC-OPTION-CODE.
  6268     PERFORM 9700-DATE-LINK.
  6269     MOVE DC-GREG-DATE-1-EDIT   TO  CURRENT-GREG-DATE.
  6270     MOVE DC-BIN-DATE-1         TO  CURRENT-BIN-DATE.
  6271
  6272
  6273     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6274     MOVE 2 TO EMI-NUMBER-OF-LINES.
  6275     IF EIBCALEN = 0
  6276         GO TO 8800-UNAUTHORIZED-ACCESS.
  6277
  6278     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6279         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6280             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6281             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6282             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6283             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6284             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6285             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6286             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6287             MOVE THIS-PGM  TO PI-CALLING-PROGRAM
  6288             MOVE LOW-VALUES TO EL154AO
  6289             GO TO 7000-BUILD-SCREEN.
  6290
  6291
  6292* EXEC CICS HANDLE CONDITION
  6293*        NOTOPEN(8860-CLAM-NOT-OPEN)
  6294*        PGMIDERR(9600-PGMID-ERROR)
  6295*        ERROR(9990-ABEND)
  6296*        END-EXEC.
  6297*    MOVE '"$JL.                 ! " #00006287' TO DFHEIV0
  6298     MOVE X'22244A4C2E20202020202020' TO DFHEIV0(1:12)
  6299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6300     MOVE X'2220233030303036323837' TO DFHEIV0(25:11)
  6301     CALL 'kxdfhei1' USING DFHEIV0
  6302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6303
  6304
  6305     IF EIBAID = DFHCLEAR
  6306         GO TO 9400-CLEAR.
  6307
  6308     IF PI-PROCESSOR-ID = 'LGXX'
  6309         GO TO 0200-RECEIVE.
  6310
  6311
  6312* EXEC CICS READQ TS
  6313*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6314*        INTO    (SECURITY-CONTROL)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 118
* EL154.cbl
  6315*        LENGTH  (SC-COMM-LENGTH)
  6316*        ITEM    (SC-ITEM)
  6317*    END-EXEC.
  6318*    MOVE '*$II   L              ''   #00006299' TO DFHEIV0
  6319     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6321     MOVE X'2020233030303036323939' TO DFHEIV0(25:11)
  6322     CALL 'kxdfhei1' USING DFHEIV0,
  6323           PI-SECURITY-TEMP-STORE-ID,
  6324           SECURITY-CONTROL,
  6325           SC-COMM-LENGTH,
  6326           SC-ITEM,
  6327           DFHEIV99,
  6328           DFHEIV99
  6329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6330
  6331
  6332     MOVE SC-CLAIMS-DISPLAY (9)   TO  PI-DISPLAY-CAP.
  6333     MOVE SC-CLAIMS-UPDATE  (9)   TO  PI-MODIFY-CAP.
  6334
  6335     IF NOT MODIFY-CAP
  6336         MOVE 'UPDATE'            TO  SM-READ
  6337         PERFORM 9995-SECURITY-VIOLATION
  6338         MOVE ER-0070             TO  EMI-ERROR
  6339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6340         GO TO 8100-SEND-INITIAL-MAP.
  6341
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 119
* EL154.cbl
  6343 0200-RECEIVE.
  6344     MOVE LOW-VALUES TO EL154AI.
  6345     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6346         MOVE ER-0008 TO EMI-ERROR
  6347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6348         GO TO 8200-SEND-DATAONLY.
  6349
  6350
  6351* EXEC CICS RECEIVE
  6352*        MAP(MAP-NAME)
  6353*        MAPSET(MAPSET-NAME)
  6354*        INTO(EL154AI)
  6355*        END-EXEC.
  6356     MOVE LENGTH OF
  6357      EL154AI
  6358       TO DFHEIV11
  6359*    MOVE '8"T I  L              ''   #00006324' TO DFHEIV0
  6360     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6362     MOVE X'2020233030303036333234' TO DFHEIV0(25:11)
  6363     CALL 'kxdfhei1' USING DFHEIV0,
  6364           MAP-NAME,
  6365           EL154AI,
  6366           DFHEIV11,
  6367           MAPSET-NAME,
  6368           DFHEIV99,
  6369           DFHEIV99
  6370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6371
  6372
  6373     IF ENTERPFL = 0
  6374         GO TO 0300-CHECK-PFKEYS.
  6375     IF EIBAID NOT = DFHENTER
  6376         MOVE ER-0004 TO EMI-ERROR
  6377         GO TO 0320-INPUT-ERROR.
  6378
  6379     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  6380         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6381     ELSE
  6382         MOVE ER-0029 TO EMI-ERROR
  6383         GO TO 0320-INPUT-ERROR.
  6384
  6385 0300-CHECK-PFKEYS.
  6386
  6387     IF EIBAID = DFHPF23
  6388         GO TO 8810-PF23.
  6389     IF EIBAID = DFHPF24
  6390         GO TO 9200-RETURN-MAIN-MENU.
  6391     IF EIBAID = DFHPF12
  6392         GO TO 9500-PF12.
  6393     IF EIBAID EQUAL DFHPF1
  6394        GO TO 0400-PAGE-FORWARD.
  6395     IF EIBAID EQUAL DFHPF2
  6396        GO TO 0700-PAGE-BACKWARD.
  6397     IF EIBAID EQUAL DFHPF3
  6398        MOVE CURRENT-BIN-DATE TO CURRENT-SAVE
  6399        IF TERMI = 'A'
  6400            GO TO 2000-ADD-ONLY
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 120
* EL154.cbl
  6401        ELSE
  6402        IF TERMI = 'N'
  6403            GO TO 3000-TERMINATE-AND-GENERATE.
  6404     IF (TERML NOT = 0) AND (EIBAID NOT = DFHENTER)
  6405         MOVE ER-0050 TO EMI-ERROR
  6406         GO TO 0320-INPUT-ERROR.
  6407     IF EIBAID = DFHENTER
  6408         GO TO 0330-EDIT-DATA.
  6409
  6410     MOVE ER-0029 TO EMI-ERROR.
  6411 0320-INPUT-ERROR.
  6412     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6413     MOVE AL-UNBON TO ENTERPFA.
  6414     IF ENTERPFL = 0
  6415         MOVE -1 TO TERML
  6416     ELSE
  6417         MOVE -1 TO ENTERPFL.
  6418
  6419     GO TO 8200-SEND-DATAONLY.
  6420
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 121
* EL154.cbl
  6422 0330-EDIT-DATA.
  6423     IF NOT MODIFY-CAP
  6424           MOVE ER-0070          TO EMI-ERROR
  6425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6426           MOVE LOW-VALUES       TO EL154AO
  6427           GO TO 8100-SEND-INITIAL-MAP.
  6428
  6429     MOVE CURRENT-BIN-DATE       TO CURRENT-SAVE
  6430
  6431     IF TERMI = 'Y'
  6432         GO TO 1000-DELETE-CURRENT.
  6433     IF TERMI = 'A'
  6434         GO TO 2000-ADD-ONLY.
  6435     IF TERMI = 'N'
  6436         GO TO 3000-TERMINATE-AND-GENERATE.
  6437     MOVE ER-0347                TO EMI-ERROR.
  6438     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6439     MOVE -1                     TO TERML.
  6440     MOVE AL-UABON               TO TERMA.
  6441     GO TO 8200-SEND-DATAONLY.
  6442
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 122
* EL154.cbl
  6444 0400-PAGE-FORWARD.
  6445
  6446* EXEC CICS HANDLE CONDITION
  6447*         NOTFND    (8850-CLAM-END-FILE)
  6448*         ENDFILE   (8850-CLAM-END-FILE)
  6449*    END-EXEC.
  6450*    MOVE '"$I''                  ! # #00006402' TO DFHEIV0
  6451     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6453     MOVE X'2320233030303036343032' TO DFHEIV0(25:11)
  6454     CALL 'kxdfhei1' USING DFHEIV0
  6455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6456
  6457
  6458     MOVE PI-CARRIER      TO CLAM-CARRIER
  6459     MOVE PI-COMPANY-CD   TO CLAM-CO
  6460     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6461     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6462     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6463
  6464
  6465* EXEC CICS STARTBR
  6466*         DATASET   ('ELMSTR')
  6467*         RIDFLD    (CLAM-KEY)
  6468*    END-EXEC.
  6469     MOVE 'ELMSTR' TO DFHEIV1
  6470     MOVE 0
  6471       TO DFHEIV11
  6472*    MOVE '&,         G          &   #00006413' TO DFHEIV0
  6473     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6474     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6475     MOVE X'2020233030303036343133' TO DFHEIV0(25:11)
  6476     CALL 'kxdfhei1' USING DFHEIV0,
  6477           DFHEIV1,
  6478           CLAM-KEY,
  6479           DFHEIV99,
  6480           DFHEIV11,
  6481           DFHEIV99
  6482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6483
  6484
  6485 0450-READ-NEXT-CLAIM.
  6486
  6487
  6488* EXEC CICS READNEXT
  6489*         DATASET   ('ELMSTR')
  6490*         RIDFLD    (CLAM-KEY)
  6491*         SET       (ADDRESS OF CLAIM-MASTER)
  6492*    END-EXEC.
  6493     MOVE 'ELMSTR' TO DFHEIV1
  6494     MOVE 0
  6495       TO DFHEIV11
  6496*    MOVE '&.S                   )   #00006420' TO DFHEIV0
  6497     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6498     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6499     MOVE X'2020233030303036343230' TO DFHEIV0(25:11)
  6500     CALL 'kxdfhei1' USING DFHEIV0,
  6501           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 123
* EL154.cbl
  6502           DFHEIV20,
  6503           DFHEIV99,
  6504           CLAM-KEY,
  6505           DFHEIV99,
  6506           DFHEIV11,
  6507           DFHEIV99,
  6508           DFHEIV99
  6509     SET ADDRESS OF CLAIM-MASTER TO
  6510         DFHEIV20
  6511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6512
  6513
  6514     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6515        GO TO 8850-CLAM-END-FILE.
  6516
  6517     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6518        GO TO 0450-READ-NEXT-CLAIM.
  6519
  6520     IF PI-CARRIER-SECURITY GREATER SPACES
  6521         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6522             GO TO 0450-READ-NEXT-CLAIM.
  6523
  6524     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6525         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6526             GO TO 0450-READ-NEXT-CLAIM.
  6527
  6528     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6529         GO TO 0450-READ-NEXT-CLAIM.
  6530
  6531     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6532     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6533     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6534     MOVE CL-CERT-STATE       TO PI-STATE
  6535     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6536     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6537     MOVE CL-CERT-NO          TO PI-CERT-NO
  6538
  6539     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6540         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6541
  6542
  6543* EXEC CICS ENDBR
  6544*         DATASET    ('ELMSTR')
  6545*    END-EXEC.
  6546     MOVE 'ELMSTR' TO DFHEIV1
  6547     MOVE 0
  6548       TO DFHEIV11
  6549*    MOVE '&2                    $   #00006454' TO DFHEIV0
  6550     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6551     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6552     MOVE X'2020233030303036343534' TO DFHEIV0(25:11)
  6553     CALL 'kxdfhei1' USING DFHEIV0,
  6554           DFHEIV1,
  6555           DFHEIV11,
  6556           DFHEIV99
  6557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6558
  6559
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 124
* EL154.cbl
  6560     MOVE LOW-VALUES TO EL154AO.
  6561     GO TO 7000-BUILD-SCREEN.
  6562
  6563 0700-PAGE-BACKWARD.
  6564
  6565
  6566* EXEC CICS HANDLE CONDITION
  6567*         NOTFND    (8850-CLAM-END-FILE)
  6568*         ENDFILE   (8850-CLAM-END-FILE)
  6569*    END-EXEC.
  6570*    MOVE '"$I''                  ! $ #00006463' TO DFHEIV0
  6571     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6573     MOVE X'2420233030303036343633' TO DFHEIV0(25:11)
  6574     CALL 'kxdfhei1' USING DFHEIV0
  6575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6576
  6577
  6578     MOVE PI-CARRIER      TO CLAM-CARRIER
  6579     MOVE PI-COMPANY-CD   TO CLAM-CO
  6580     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6581     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6582     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6583
  6584
  6585* EXEC CICS STARTBR
  6586*         DATASET   ('ELMSTR')
  6587*         RIDFLD    (CLAM-KEY)
  6588*    END-EXEC.
  6589     MOVE 'ELMSTR' TO DFHEIV1
  6590     MOVE 0
  6591       TO DFHEIV11
  6592*    MOVE '&,         G          &   #00006474' TO DFHEIV0
  6593     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6594     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6595     MOVE X'2020233030303036343734' TO DFHEIV0(25:11)
  6596     CALL 'kxdfhei1' USING DFHEIV0,
  6597           DFHEIV1,
  6598           CLAM-KEY,
  6599           DFHEIV99,
  6600           DFHEIV11,
  6601           DFHEIV99
  6602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6603
  6604
  6605 0750-READ-PREV-CLAIM.
  6606
  6607
  6608* EXEC CICS READPREV
  6609*         DATASET   ('ELMSTR')
  6610*         RIDFLD    (CLAM-KEY)
  6611*         SET       (ADDRESS OF CLAIM-MASTER)
  6612*    END-EXEC.
  6613     MOVE 'ELMSTR' TO DFHEIV1
  6614     MOVE 0
  6615       TO DFHEIV11
  6616*    MOVE '&0S                   )   #00006481' TO DFHEIV0
  6617     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 125
* EL154.cbl
  6618     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6619     MOVE X'2020233030303036343831' TO DFHEIV0(25:11)
  6620     CALL 'kxdfhei1' USING DFHEIV0,
  6621           DFHEIV1,
  6622           DFHEIV20,
  6623           DFHEIV99,
  6624           CLAM-KEY,
  6625           DFHEIV99,
  6626           DFHEIV11,
  6627           DFHEIV99,
  6628           DFHEIV99
  6629     SET ADDRESS OF CLAIM-MASTER TO
  6630         DFHEIV20
  6631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6632
  6633
  6634     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6635        GO TO 8850-CLAM-END-FILE.
  6636
  6637     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6638        GO TO 0750-READ-PREV-CLAIM.
  6639
  6640     IF PI-CARRIER-SECURITY GREATER SPACES
  6641         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6642             GO TO 0750-READ-PREV-CLAIM.
  6643
  6644     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6645         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6646             GO TO 0750-READ-PREV-CLAIM.
  6647
  6648     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6649         GO TO 0750-READ-PREV-CLAIM.
  6650
  6651     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6652     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6653     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6654     MOVE CL-CERT-STATE       TO PI-STATE
  6655     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6656     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6657     MOVE CL-CERT-NO          TO PI-CERT-NO
  6658
  6659     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6660         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6661
  6662
  6663* EXEC CICS ENDBR
  6664*         DATASET    ('ELMSTR')
  6665*    END-EXEC.
  6666     MOVE 'ELMSTR' TO DFHEIV1
  6667     MOVE 0
  6668       TO DFHEIV11
  6669*    MOVE '&2                    $   #00006515' TO DFHEIV0
  6670     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6672     MOVE X'2020233030303036353135' TO DFHEIV0(25:11)
  6673     CALL 'kxdfhei1' USING DFHEIV0,
  6674           DFHEIV1,
  6675           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 126
* EL154.cbl
  6676           DFHEIV99
  6677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6678
  6679
  6680     MOVE LOW-VALUES TO EL154AO.
  6681     GO TO 7000-BUILD-SCREEN.
  6682
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 127
* EL154.cbl
  6684 1000-DELETE-CURRENT.
  6685     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6686     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6687
  6688     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6689     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6690     MOVE ZEROS                  TO CL-AUTO-PAY-SEQ.
  6691     MOVE LOW-VALUES             TO CL-NEXT-AUTO-PAY-DT.
  6692
  6693     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6694
  6695     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6696
  6697     MOVE SPACES TO WS-END-LETTER-FORM-NUM.
  6698*    IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6699     IF PRINTL IS GREATER THAN +0
  6700         MOVE PRINTI   TO PI-AUTO-END-LETTER
  6701     END-IF.
  6702     IF PI-AUTO-END-LETTER IS GREATER THAN SPACES
  6703         IF PI-AUTO-END-LETTER IS EQUAL TO 'N   '
  6704             GO TO 1000-FINISH-DELETE
  6705         ELSE
  6706             MOVE PI-AUTO-END-LETTER TO WS-END-LETTER-FORM-NUM
  6707             MOVE 'Y'    TO WS-ACT-REC-FOUND-SW
  6708                            WS-LETTER-SW
  6709         END-IF
  6710     END-IF.
  6711
  6712     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6713         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6714             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6715
  6716 1000-FINISH-DELETE.
  6717
  6718     IF EMI-NO-ERRORS
  6719         GO TO 8200-SEND-DATAONLY.
  6720
  6721     MOVE LOW-VALUES             TO EL154AO.
  6722     MOVE -1                     TO TERML.
  6723     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 128
* EL154.cbl
  6725 2000-ADD-ONLY.
  6726     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6727     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6728     IF NOT EMI-NO-ERRORS
  6729        GO TO 8200-SEND-DATAONLY.
  6730
  6731     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6732     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6733     IF NOT EMI-NO-ERRORS
  6734         GO TO 8200-SEND-DATAONLY.
  6735
  6736     IF CL-AUTO-PAY-SEQ  NOT = ZEROS
  6737        MOVE ER-0372             TO EMI-ERROR
  6738        MOVE -1                  TO NEFFDTEL
  6739        MOVE AL-UABON            TO NEFFDTEA
  6740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6741        GO TO 8200-SEND-DATAONLY.
  6742
  6743     PERFORM 6400-PAYMENT-CALCULATION  THRU 6499-EXIT.
  6744
  6745     IF NFSTAMT-SAVE IS EQUAL TO +0
  6746         MOVE ER-0350            TO  EMI-ERROR
  6747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6748         MOVE -1                 TO  NFSTAMTL
  6749         MOVE AL-UNBON           TO  NFSTAMTA
  6750         GO TO 8200-SEND-DATAONLY.
  6751
  6752     IF EIBAID NOT = DFHPF3
  6753         GO TO 3500-CONFIRM-DATA.
  6754
  6755
  6756* EXEC CICS HANDLE CONDITION
  6757*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6758*        END-EXEC.
  6759*    MOVE '"$J                   ! % #00006594' TO DFHEIV0
  6760     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  6761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6762     MOVE X'2520233030303036353934' TO DFHEIV0(25:11)
  6763     CALL 'kxdfhei1' USING DFHEIV0
  6764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6765
  6766
  6767     PERFORM 4100-BUILD-AUTO-PAY THRU 4199-EXIT.
  6768
  6769     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6770
  6771     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6772
  6773     MOVE SPACES TO WS-LETTER-FORM-NUM.
  6774*     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6775         IF NPRINTL IS GREATER THAN +0
  6776            IF NPRINTI IS EQUAL TO 'N   '
  6777                GO TO 2000-FINISH-ADD
  6778            ELSE
  6779                MOVE NPRINTI TO WS-LETTER-FORM-NUM
  6780                MOVE 'Y' TO WS-ACT-REC-FOUND-SW
  6781                            WS-LETTER-SW.
  6782
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 129
* EL154.cbl
  6783     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6784         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6785             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6786
  6787 2000-FINISH-ADD.
  6788
  6789     IF EMI-NO-ERRORS
  6790         GO TO 8200-SEND-DATAONLY.
  6791
  6792     MOVE LOW-VALUES             TO EL154AO.
  6793     GO TO 7000-BUILD-SCREEN.
  6794
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 130
* EL154.cbl
  6796 3000-TERMINATE-AND-GENERATE.
  6797     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6798     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6799     IF NOT EMI-NO-ERRORS
  6800         GO TO 8200-SEND-DATAONLY.
  6801
  6802     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6803     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6804     IF NOT EMI-NO-ERRORS
  6805         GO TO 8200-SEND-DATAONLY.
  6806
  6807     PERFORM 6400-PAYMENT-CALCULATION THRU 6499-EXIT.
  6808
  6809     IF EIBAID NOT = DFHPF3
  6810         GO TO 3500-CONFIRM-DATA.
  6811
  6812     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6813     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6814
  6815     PERFORM 4100-BUILD-AUTO-PAY  THRU 4199-EXIT.
  6816
  6817     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6818
  6819     IF EMI-NO-ERRORS
  6820         GO TO 8200-SEND-DATAONLY.
  6821
  6822     MOVE LOW-VALUES TO EL154AO.
  6823     GO TO 7000-BUILD-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 131
* EL154.cbl
  6825 3500-CONFIRM-DATA.
  6826
  6827     MOVE -1                     TO  ENTERPFL.
  6828     MOVE ER-0670                TO  EMI-ERROR.
  6829     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6830     GO TO 8200-SEND-DATAONLY.
  6831
  6832 4000-DELETE-AUTO-PAY.
  6833
  6834* EXEC CICS HANDLE CONDITION
  6835*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6836*        NOTFND(4099-EXIT)
  6837*        END-EXEC.
  6838*    MOVE '"$JI                  ! & #00006664' TO DFHEIV0
  6839     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  6840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6841     MOVE X'2620233030303036363634' TO DFHEIV0(25:11)
  6842     CALL 'kxdfhei1' USING DFHEIV0
  6843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6844
  6845
  6846
  6847* EXEC CICS READ
  6848*        UPDATE
  6849*        DATASET(ACTV-ID)
  6850*        SET(ADDRESS OF ACTIVITY-TRAILERS)
  6851*        RIDFLD(ACTV-KEY)
  6852*        END-EXEC.
  6853*    MOVE '&"S        EU         (   #00006669' TO DFHEIV0
  6854     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6855     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6856     MOVE X'2020233030303036363639' TO DFHEIV0(25:11)
  6857     CALL 'kxdfhei1' USING DFHEIV0,
  6858           ACTV-ID,
  6859           DFHEIV20,
  6860           DFHEIV99,
  6861           ACTV-KEY,
  6862           DFHEIV99,
  6863           DFHEIV99,
  6864           DFHEIV99
  6865     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6866         DFHEIV20
  6867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6868
  6869
  6870     IF PRINTL > ZEROS
  6871         MOVE PRINTI             TO AT-AUTO-END-LETTER
  6872     END-IF.
  6873
  6874     MOVE CURRENT-SAVE           TO AT-TERMINATED-DT
  6875                                    AT-AUTO-PAY-LAST-MAINT-DT
  6876     MOVE PI-PROCESSOR-ID        TO AT-AUTO-PAY-LAST-UPDATED-BY
  6877     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  6878
  6879* EXEC CICS REWRITE
  6880*        DATASET(ACTV-ID)
  6881*        FROM(ACTIVITY-TRAILERS)
  6882*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 132
* EL154.cbl
  6883     MOVE LENGTH OF
  6884      ACTIVITY-TRAILERS
  6885       TO DFHEIV11
  6886*    MOVE '&& L                  %   #00006684' TO DFHEIV0
  6887     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6888     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6889     MOVE X'2020233030303036363834' TO DFHEIV0(25:11)
  6890     CALL 'kxdfhei1' USING DFHEIV0,
  6891           ACTV-ID,
  6892           ACTIVITY-TRAILERS,
  6893           DFHEIV11,
  6894           DFHEIV99
  6895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6896
  6897
  6898 4099-EXIT.
  6899      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 133
* EL154.cbl
  6901 4100-BUILD-AUTO-PAY.
  6902******************************************************************
  6903*               CREATE AUTO PAY TRAILER
  6904******************************************************************
  6905
  6906     SUBTRACT 1                  FROM CL-TRAILER-SEQ-CNT.
  6907     MOVE CL-TRAILER-SEQ-CNT     TO ACTV-SEQ
  6908                                    CL-AUTO-PAY-SEQ.
  6909
  6910* EXEC CICS GETMAIN
  6911*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  6912*         LENGTH    (TRLR-LENGTH)
  6913*         INITIMG   (GETMAIN-SPACE)
  6914*    END-EXEC.
  6915*    MOVE ',"IL                  $   #00006700' TO DFHEIV0
  6916     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6917     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6918     MOVE X'2020233030303036373030' TO DFHEIV0(25:11)
  6919     CALL 'kxdfhei1' USING DFHEIV0,
  6920           DFHEIV20,
  6921           TRLR-LENGTH,
  6922           GETMAIN-SPACE
  6923     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6924         DFHEIV20
  6925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6926
  6927
  6928     MOVE ZEROS                  TO AT-DAYS-IN-REG-PMT.
  6929     MOVE NEFFDTE-SAVE           TO AT-SCHEDULE-START-DT.
  6930     MOVE NFSTPMT-SAVE           TO AT-1ST-PAY-THRU-DT
  6931                                    CL-NEXT-AUTO-PAY-DT.
  6932     MOVE DAYPAYI                TO AT-AUTO-PAY-DAY.
  6933     MOVE NLSTPMT-SAVE           TO AT-SCHEDULE-END-DT.
  6934     MOVE NFSTAMT-SAVE           TO AT-FIRST-PMT-AMT.
  6935     MOVE NDAYSFI                TO AT-DAYS-IN-1ST-PMT.
  6936
  6937*    IF PI-USES-PAID-TO
  6938*        MOVE NFSTPMT-SAVE       TO  DC-BIN-DATE-1
  6939*        MOVE '6'                TO  DC-OPTION-CODE
  6940*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6941*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6942*        PERFORM 9700-DATE-LINK
  6943*        IF NO-CONVERSION-ERROR
  6944*            MOVE DC-BIN-DATE-2  TO  AT-1ST-PAY-THRU-DT
  6945*                                    CL-NEXT-AUTO-PAY-DT
  6946*        ELSE
  6947*            MOVE LOW-VALUES     TO  AT-1ST-PAY-THRU-DT
  6948*                                    CL-NEXT-AUTO-PAY-DT
  6949*    ELSE
  6950*        MOVE NFSTPMT-SAVE       TO  AT-1ST-PAY-THRU-DT
  6951*                                    CL-NEXT-AUTO-PAY-DT.
  6952
  6953*    IF PI-USES-PAID-TO
  6954*        MOVE NLSTPMT-SAVE       TO  DC-BIN-DATE-1
  6955*        MOVE '6'                TO  DC-OPTION-CODE
  6956*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6957*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6958*        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 134
* EL154.cbl
  6959*        IF NO-CONVERSION-ERROR
  6960*            MOVE DC-BIN-DATE-2  TO  AT-SCHEDULE-END-DT
  6961*        ELSE
  6962*            MOVE LOW-VALUES     TO  AT-SCHEDULE-END-DT
  6963*    ELSE
  6964*        MOVE NLSTPMT-SAVE       TO  AT-SCHEDULE-END-DT.
  6965
  6966     IF NLASTI = 'Y'
  6967        MOVE 'F'                 TO AT-LAST-PMT-TYPE
  6968     ELSE
  6969        MOVE 'P'                 TO AT-LAST-PMT-TYPE.
  6970
  6971     MOVE NMONTHSI               TO AT-INTERVAL-MONTHS.
  6972     MOVE NREGPMT-SAVE           TO AT-REGULAR-PMT-AMT.
  6973
  6974     MOVE WS-PAYEE-CODE          TO AT-AUTO-PAYEE-CD.
  6975
  6976     IF NINDCTRI    IS EQUAL TO  'N'
  6977         MOVE 'N'                TO AT-AUTO-CASH
  6978     ELSE
  6979         MOVE 'Y'                TO AT-AUTO-CASH.
  6980
  6981     MOVE ENDLETTI               TO AT-AUTO-END-LETTER.
  6982
  6983     IF PI-COMPANY-ID = 'CSL'
  6984        IF PI-CARRIER = 'A' OR 'B' OR 'C' OR '1' OR '2' OR
  6985                        '3' OR '4'
  6986         INSPECT AT-AUTO-PAYEE-CD CONVERTING 'IBA' TO 'IOA'.
  6987
  6988     MOVE LOW-VALUE              TO AT-TERMINATED-DT.
  6989     MOVE 'AT'                   TO AT-RECORD-ID.
  6990     MOVE  3                     TO AT-TRAILER-TYPE.
  6991     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  6992                                    AT-AUTO-PAY-LAST-MAINT-DT
  6993     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  6994                                    AT-AUTO-PAY-LAST-UPDATED-BY
  6995     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  6996     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  6997
  6998
  6999* EXEC CICS WRITE
  7000*         DATASET(ACTV-ID)
  7001*         FROM   (ACTIVITY-TRAILERS)
  7002*         RIDFLD (AT-CONTROL-PRIMARY)
  7003*         END-EXEC.
  7004     MOVE LENGTH OF
  7005      ACTIVITY-TRAILERS
  7006       TO DFHEIV11
  7007*    MOVE '&$ L                  ''   #00006776' TO DFHEIV0
  7008     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7010     MOVE X'2020233030303036373736' TO DFHEIV0(25:11)
  7011     CALL 'kxdfhei1' USING DFHEIV0,
  7012           ACTV-ID,
  7013           ACTIVITY-TRAILERS,
  7014           DFHEIV11,
  7015           AT-CONTROL-PRIMARY,
  7016           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 135
* EL154.cbl
  7017           DFHEIV99
  7018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7019
  7020
  7021 4199-EXIT.
  7022      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 136
* EL154.cbl
  7024 5000-READ-CLAIM.
  7025
  7026* EXEC CICS READ
  7027*        UPDATE
  7028*        DATASET(CLAM-ID)
  7029*        SET    (ADDRESS OF CLAIM-MASTER)
  7030*        RIDFLD (CLAM-KEY)
  7031*        END-EXEC.
  7032*    MOVE '&"S        EU         (   #00006786' TO DFHEIV0
  7033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7035     MOVE X'2020233030303036373836' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           CLAM-ID,
  7038           DFHEIV20,
  7039           DFHEIV99,
  7040           CLAM-KEY,
  7041           DFHEIV99,
  7042           DFHEIV99,
  7043           DFHEIV99
  7044     SET ADDRESS OF CLAIM-MASTER TO
  7045         DFHEIV20
  7046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7047
  7048
  7049 5099-EXIT.
  7050      EXIT.
  7051
  7052 5200-REWRITE.
  7053
  7054* EXEC CICS HANDLE CONDITION
  7055*        DUPKEY
  7056*        END-EXEC.
  7057*    MOVE '"$                   ! '' #00006797' TO DFHEIV0
  7058     MOVE X'222494202020202020202020' TO DFHEIV0(1:12)
  7059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7060     MOVE X'2720233030303036373937' TO DFHEIV0(25:11)
  7061     CALL 'kxdfhei1' USING DFHEIV0
  7062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7063
  7064
  7065     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
  7066     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
  7067     MOVE CURRENT-SAVE           TO CL-LAST-MAINT-DT.
  7068
  7069* EXEC CICS REWRITE
  7070*        DATASET(CLAM-ID)
  7071*        FROM   (CLAIM-MASTER)
  7072*        END-EXEC.
  7073     MOVE LENGTH OF
  7074      CLAIM-MASTER
  7075       TO DFHEIV11
  7076*    MOVE '&& L                  %   #00006804' TO DFHEIV0
  7077     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7078     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7079     MOVE X'2020233030303036383034' TO DFHEIV0(25:11)
  7080     CALL 'kxdfhei1' USING DFHEIV0,
  7081           CLAM-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 137
* EL154.cbl
  7082           CLAIM-MASTER,
  7083           DFHEIV11,
  7084           DFHEIV99
  7085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7086
  7087
  7088*    MOVE 1                      TO EMI-NUMBER-OF-LINES.
  7089     MOVE ER-0000                TO EMI-ERROR.
  7090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7091
  7092 5299-EXIT.
  7093      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 138
* EL154.cbl
  7095 5900-VERIFY-ALL-FIELDS.
  7096******************************************************************
  7097*       PRELIMINARY EDITS TO VERIFY THAT THE REQUIRED FIELDS     *
  7098*       HAVE DATA ENTERED IN THEM                                *
  7099******************************************************************
  7100
  7101     IF DAYPAYL EQUAL +0
  7102        MOVE ZEROS TO DAYPAYI.
  7103
  7104     IF NEFFDTEL EQUAL +0
  7105        MOVE LOW-VALUES TO NEFFDTEI.
  7106
  7107     IF NFSTAMTL EQUAL +0
  7108        MOVE ZEROS TO NFSTAMTI
  7109                      NFSTAMTO.
  7110
  7111     IF NDAYSFL EQUAL +0
  7112        MOVE ZEROS TO NDAYSFI.
  7113
  7114     IF NFSTAMTL EQUAL +0
  7115        IF NDAYSFL NOT EQUAL +0
  7116           MOVE +0        TO NDAYSFL
  7117           MOVE ZEROS     TO NDAYSFI.
  7118
  7119     IF NMONTHSL = ZEROS
  7120        MOVE -1                  TO NMONTHSL
  7121        GO TO 5910-REQUIRED-ERROR.
  7122
  7123     IF NFSTPMTL = ZEROS
  7124        MOVE -1                  TO NFSTPMTL
  7125        GO TO 5910-REQUIRED-ERROR.
  7126
  7127     IF NLSTPMTL = ZEROS
  7128        MOVE -1                  TO NLSTPMTL
  7129        GO TO 5910-REQUIRED-ERROR.
  7130
  7131     IF NLASTL = ZEROS
  7132        MOVE -1                  TO NLASTL
  7133        GO TO 5910-REQUIRED-ERROR.
  7134
  7135     IF NPAYEEL = ZEROS
  7136        MOVE -1                  TO NPAYEEL
  7137        GO TO 5910-REQUIRED-ERROR.
  7138
  7139     IF LETTDTEL EQUAL +0
  7140        MOVE LOW-VALUES TO LETTDTEI.
  7141
  7142     IF (PI-COMPANY-ID  =  'AIG' OR  'AUK') AND
  7143        (NINDCTRL =  ZEROS)
  7144           MOVE -1               TO NINDCTRL
  7145           GO TO 5910-REQUIRED-ERROR.
  7146
  7147     GO TO 5999-EXIT.
  7148
  7149 5910-REQUIRED-ERROR.
  7150     MOVE ER-0358                TO EMI-ERROR.
  7151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7152
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 139
* EL154.cbl
  7153 5999-EXIT.
  7154      EXIT.
  7155
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 140
* EL154.cbl
  7157 6000-EDIT-INPUT-DATA.
  7158******************************************************
  7159*    IF THE EFFECTIVE OR "PAID FROM" WAS NOT         *
  7160*    ENTERED, THEN USE THE INCURRED OR LAST PAID     *
  7161*    THRU DATE                                       *
  7162******************************************************
  7163
  7164     MOVE SPACES TO WS-ELIMINATION-SW.
  7165
  7166     IF NEFFDTEL NOT = ZEROS
  7167        MOVE NEFFDTEI            TO DEEDIT-FIELD
  7168        PERFORM 8600-DEEDIT
  7169        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7170        MOVE '4'                 TO DC-OPTION-CODE
  7171        PERFORM 9700-DATE-LINK
  7172        IF DATE-CONVERSION-ERROR
  7173           MOVE ER-0348          TO EMI-ERROR
  7174           MOVE -1               TO NEFFDTEL
  7175           MOVE AL-UABON         TO NEFFDTEA
  7176           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7177        ELSE
  7178           MOVE DEEDIT-FIELD-V0  TO NEFFDTEO
  7179           INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7180           MOVE AL-UANON         TO NEFFDTEA
  7181           MOVE DC-BIN-DATE-1    TO NEFFDTE-SAVE
  7182     ELSE
  7183        IF CL-PAID-THRU-DT EQUAL LOW-VALUES
  7184           MOVE 'N' TO WS-ELIMINATION-SW
  7185           MOVE CL-INCURRED-DT TO NEFFDTE-SAVE
  7186                                  DC-BIN-DATE-1
  7187           MOVE ' ' TO DC-OPTION-CODE
  7188           PERFORM 9700-DATE-LINK
  7189           IF NO-CONVERSION-ERROR
  7190              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7191              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7192           ELSE
  7193              MOVE LOW-VALUES TO NEFFDTE-SAVE
  7194        ELSE
  7195           MOVE CL-PAID-THRU-DT TO DC-BIN-DATE-1
  7196           MOVE +1 TO DC-ELAPSED-DAYS
  7197           MOVE +0 TO DC-ELAPSED-MONTHS
  7198           MOVE '6' TO DC-OPTION-CODE
  7199           PERFORM 9700-DATE-LINK
  7200           IF NO-CONVERSION-ERROR
  7201              MOVE DC-BIN-DATE-2 TO NEFFDTE-SAVE
  7202              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7203              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7204           ELSE
  7205              MOVE LOW-VALUES TO NEFFDTE-SAVE.
  7206
  7207******************************************************************
  7208*       EDIT FIRST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7209*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7210*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7211******************************************************************
  7212
  7213     IF NFSTPMTL NOT = ZEROS
  7214        MOVE NFSTPMTI            TO DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 141
* EL154.cbl
  7215        PERFORM 8600-DEEDIT
  7216        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7217        MOVE '4'                 TO DC-OPTION-CODE
  7218        PERFORM 9700-DATE-LINK
  7219        IF DATE-CONVERSION-ERROR
  7220           MOVE ER-0349          TO EMI-ERROR
  7221           MOVE -1               TO NFSTPMTL
  7222           MOVE AL-UABON         TO NFSTPMTA
  7223           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7224          ELSE
  7225           MOVE DEEDIT-FIELD-V0  TO NFSTPMTO
  7226           INSPECT NFSTPMTI CONVERTING SPACES TO '/'
  7227           MOVE AL-UANON         TO NFSTPMTA.
  7228*          MOVE DC-BIN-DATE-1    TO NFSTPMT-SAVE.
  7229
  7230     IF PI-USES-PAID-TO
  7231         MOVE '6'                TO  DC-OPTION-CODE
  7232         MOVE -1                 TO  DC-ELAPSED-DAYS
  7233         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7234         PERFORM 9700-DATE-LINK
  7235         IF NO-CONVERSION-ERROR
  7236             MOVE DC-BIN-DATE-2  TO  NFSTPMT-SAVE
  7237         ELSE
  7238             MOVE ER-0349        TO  EMI-ERROR
  7239             MOVE -1             TO  NFSTPMTL
  7240             MOVE AL-UABON       TO  NFSTPMTA
  7241             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7242     ELSE
  7243         MOVE DC-BIN-DATE-1      TO  NFSTPMT-SAVE.
  7244
  7245******************************************************************
  7246*       EDIT LAST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7247*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7248*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7249******************************************************************
  7250
  7251     IF NLSTPMTL NOT = ZEROS
  7252        MOVE NLSTPMTI            TO DEEDIT-FIELD
  7253        PERFORM 8600-DEEDIT
  7254        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7255        MOVE '4'                 TO DC-OPTION-CODE
  7256        PERFORM 9700-DATE-LINK
  7257        IF DATE-CONVERSION-ERROR
  7258           MOVE ER-0354          TO EMI-ERROR
  7259           MOVE -1               TO NLSTPMTL
  7260           MOVE AL-UABON         TO NLSTPMTA
  7261           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7262          ELSE
  7263           MOVE DEEDIT-FIELD-V0  TO NLSTPMTO
  7264           INSPECT NLSTPMTI CONVERTING SPACES TO '/'
  7265           MOVE AL-UANON         TO NLSTPMTA.
  7266
  7267     IF PI-USES-PAID-TO
  7268         MOVE '6'                TO  DC-OPTION-CODE
  7269         MOVE -1                 TO  DC-ELAPSED-DAYS
  7270         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7271         PERFORM 9700-DATE-LINK
  7272         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 142
* EL154.cbl
  7273             MOVE DC-BIN-DATE-2  TO  NLSTPMT-SAVE
  7274         ELSE
  7275             MOVE ER-0354        TO  EMI-ERROR
  7276             MOVE -1             TO  NLSTPMTL
  7277             MOVE AL-UABON       TO  NLSTPMTA
  7278             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7279     ELSE
  7280         MOVE DC-BIN-DATE-1      TO  NLSTPMT-SAVE.
  7281
  7282******************************************************************
  7283*       EDIT FIRST PAYMENT AMOUNT
  7284******************************************************************
  7285
  7286     IF NFSTAMTL NOT = ZEROS
  7287
  7288* EXEC CICS BIF DEEDIT
  7289*          FIELD (NFSTAMTI)
  7290*          LENGTH(10)
  7291*       END-EXEC
  7292     MOVE 10
  7293       TO DFHEIV11
  7294*    MOVE '@"L                   #   #00007008' TO DFHEIV0
  7295     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7296     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7297     MOVE X'2020233030303037303038' TO DFHEIV0(25:11)
  7298     CALL 'kxdfhei1' USING DFHEIV0,
  7299           NFSTAMTI,
  7300           DFHEIV11
  7301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7302        IF NFSTAMTI NOT NUMERIC
  7303           MOVE ER-0350          TO EMI-ERROR
  7304           MOVE -1               TO NFSTAMTL
  7305           MOVE AL-UNBON         TO NFSTAMTA
  7306           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7307        ELSE
  7308           MOVE NFSTAMTI         TO NFSTAMT-SAVE
  7309                                    NFSTAMTO
  7310           MOVE AL-UNNON         TO NFSTAMTA
  7311        end-if
  7312     end-if
  7313******************************************************************
  7314*       EDIT DAY TO PAY
  7315******************************************************************
  7316
  7317     IF DAYPAYL NOT EQUAL +0
  7318        IF DAYPAYI NUMERIC AND
  7319           DAYPAYI LESS THAN 32
  7320           MOVE AL-UNNON         TO DAYPAYA
  7321        ELSE
  7322           MOVE ER-0632          TO EMI-ERROR
  7323           MOVE -1               TO DAYPAYL
  7324           MOVE AL-UNBON         TO DAYPAYA
  7325           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7326
  7327******************************************************************
  7328*       EDIT NUMBER OF DAYS IN FIRST PAYMENT PERIOD
  7329******************************************************************
  7330
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 143
* EL154.cbl
  7331     IF NDAYSFL NOT = ZEROS
  7332        IF NDAYSFI NOT NUMERIC
  7333           MOVE ER-0351          TO EMI-ERROR
  7334           MOVE -1               TO NDAYSFL
  7335           MOVE AL-UNBON         TO NDAYSFA
  7336           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7337        ELSE
  7338           MOVE AL-UNNON         TO NDAYSFA.
  7339
  7340******************************************************************
  7341*       EDIT NUMBER OF MONTHS BETWEEN PAYMENTS
  7342******************************************************************
  7343
  7344     IF NMONTHSL EQUAL +0
  7345        MOVE +1                  TO NMONTHSL
  7346        MOVE 1                   TO NMONTHSI.
  7347
  7348     IF NMONTHSL NOT = ZEROS
  7349        IF NMONTHSI NOT NUMERIC
  7350           MOVE ER-0353          TO EMI-ERROR
  7351           MOVE -1               TO NMONTHSL
  7352           MOVE AL-UNBON         TO NMONTHSA
  7353           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7354        ELSE
  7355           IF NMONTHSI NOT GREATER THAN ZERO
  7356              MOVE ER-0353          TO EMI-ERROR
  7357              MOVE -1               TO NMONTHSL
  7358              MOVE AL-UNBON         TO NMONTHSA
  7359              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7360              ELSE
  7361              MOVE AL-UNNON         TO NMONTHSA.
  7362
  7363******************************************************************
  7364*       EDIT PAYEE CODE
  7365******************************************************************
  7366
  7367     MOVE NPAYEEI TO WS-PAYEE-CODE.
  7368
  7369     IF WS-PAYEE-SEQ NOT NUMERIC
  7370        MOVE ER-0357          TO EMI-ERROR
  7371        MOVE -1               TO NPAYEEL
  7372        MOVE AL-UNBON         TO NPAYEEA
  7373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7374        GO TO 6300-EXIT.
  7375
  7376     IF WS-PAYEE-CD EQUAL 'I' AND
  7377        WS-PAYEE-SEQ-NUM EQUAL 0
  7378        MOVE ER-0357          TO EMI-ERROR
  7379        MOVE -1               TO NPAYEEL
  7380        MOVE AL-UNBON         TO NPAYEEA
  7381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7382
  7383     IF WS-PAYEE-SEQ-NUM GREATER THAN 9
  7384        MOVE ER-0357          TO EMI-ERROR
  7385        MOVE -1               TO NPAYEEL
  7386        MOVE AL-UNBON         TO NPAYEEA
  7387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7388
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 144
* EL154.cbl
  7389     IF NPAYEEL NOT EQUAL +0
  7390        IF WS-PAYEE-CD = ('I' OR 'B' OR 'A')
  7391           MOVE AL-UNNON         TO NPAYEEA
  7392        ELSE
  7393           MOVE ER-0357          TO EMI-ERROR
  7394           MOVE -1               TO NPAYEEL
  7395           MOVE AL-UNBON         TO NPAYEEA
  7396           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7397
  7398******************************************************************
  7399*       EDIT LAST PAYMENT TYPE
  7400******************************************************************
  7401
  7402     IF NLASTL NOT = ZEROS
  7403        IF NLASTI = 'Y' OR 'N'
  7404           MOVE AL-UANON         TO NLASTA
  7405        ELSE
  7406           MOVE ER-0352          TO EMI-ERROR
  7407           MOVE -1               TO NLASTL
  7408           MOVE AL-UABON         TO NLASTA
  7409           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7410
  7411******************************************************************
  7412*       EDIT CASH / NON CASH INDICATOR
  7413******************************************************************
  7414
  7415     IF NINDCTRL NOT =  ZEROS
  7416        IF NINDCTRI  = 'Y' OR 'N'
  7417           MOVE AL-UANON         TO NINDCTRA
  7418        ELSE
  7419           MOVE ER-0815          TO EMI-ERROR
  7420           MOVE -1               TO NINDCTRL
  7421           MOVE AL-UABON         TO NINDCTRA
  7422           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7423
  7424     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7425         IF (CL-ASSOCIATES IS EQUAL TO 'A' OR 'N')
  7426             IF NINDCTRI IS EQUAL TO 'N'
  7427                 MOVE ER-3537    TO  EMI-ERROR
  7428                 MOVE -1         TO  NINDCTRL
  7429                 MOVE AL-UABON   TO  NINDCTRA
  7430                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7431
  7432******************************************************************
  7433*       EDIT LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7434******************************************************************
  7435
  7436     IF NPRINTL IS NOT EQUAL TO +0
  7437*01157         IF NPRINTI IS EQUAL TO 'N'
  7438           MOVE AL-UANON         TO  NPRINTA
  7439*01159         ELSE
  7440*01160            MOVE ER-0826          TO  EMI-ERROR
  7441*01161            MOVE -1               TO  NPRINTL
  7442*01162            MOVE AL-UABON         TO  NPRINTA
  7443*01163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7444     END-IF.
  7445
  7446******************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 145
* EL154.cbl
  7447*    IF THE AUTO LETTER DATE IS ENTERED IT IS USED   *
  7448*    TO RESOLVE VAIABLE @@AUTOPYDT IN THE LETTER     *
  7449*    FORM THAT IS ENTERED IN THE PRINT LETTER FIELD. *
  7450******************************************************
  7451
  7452     IF LETTDTEL NOT = ZEROS
  7453        MOVE LETTDTEI            TO DEEDIT-FIELD
  7454        PERFORM 8600-DEEDIT
  7455        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7456        MOVE '4'                 TO DC-OPTION-CODE
  7457        PERFORM 9700-DATE-LINK
  7458        IF DATE-CONVERSION-ERROR
  7459           MOVE ER-3801          TO EMI-ERROR
  7460           MOVE -1               TO LETTDTEL
  7461           MOVE AL-UABON         TO LETTDTEA
  7462           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7463        ELSE
  7464           MOVE DEEDIT-FIELD-V0  TO LETTDTEO
  7465           INSPECT LETTDTEI CONVERTING SPACES TO '/'
  7466           MOVE AL-UANON         TO LETTDTEA
  7467           MOVE DC-GREG-DATE-A-EDIT TO LETTDTE-SAVE
  7468        END-IF
  7469     ELSE
  7470         MOVE SPACES TO LETTDTE-SAVE
  7471     END-IF.
  7472
  7473******************************************************************
  7474*       EDIT END LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7475******************************************************************
  7476     IF ENDLETTL NOT = ZEROS
  7477             MOVE AL-UANON          TO ENDLETTA
  7478     ELSE
  7479         IF NPRINTL NOT = ZEROS
  7480             IF NPRINTI NOT = 'N   '
  7481                 MOVE ER-3397    TO EMI-ERROR
  7482                 MOVE -1         TO ENDLETTL
  7483                 MOVE AL-UABON   TO ENDLETTA
  7484                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7485             END-IF
  7486         END-IF
  7487     END-IF.
  7488
  7489     IF NOT EMI-NO-ERRORS
  7490        GO TO 6300-EXIT.
  7491
  7492     IF PI-PROCESSOR-ID  =  LGXX-ID
  7493        GO TO 6150-READ-CARRIER.
  7494
  7495******************************************************************
  7496*       READ PROCESSOR RECORD ON THE CONTROL FILE TO GET THE
  7497*       PROCESSOR LIMITS
  7498******************************************************************
  7499
  7500
  7501* EXEC CICS HANDLE CONDITION
  7502*         NOTFND (6150-READ-CARRIER)
  7503*         NOTOPEN(8890-CNTL-NOT-OPEN)
  7504*         END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 146
* EL154.cbl
  7505*    MOVE '"$IJ                  ! ( #00007210' TO DFHEIV0
  7506     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7508     MOVE X'2820233030303037323130' TO DFHEIV0(25:11)
  7509     CALL 'kxdfhei1' USING DFHEIV0
  7510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7511
  7512
  7513
  7514* EXEC CICS READ
  7515*         DATASET(CNTL-ID)
  7516*         RIDFLD (CNTL-KEY)
  7517*         SET    (ADDRESS OF CONTROL-FILE)
  7518*         END-EXEC.
  7519*    MOVE '&"S        E          (   #00007215' TO DFHEIV0
  7520     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7522     MOVE X'2020233030303037323135' TO DFHEIV0(25:11)
  7523     CALL 'kxdfhei1' USING DFHEIV0,
  7524           CNTL-ID,
  7525           DFHEIV20,
  7526           DFHEIV99,
  7527           CNTL-KEY,
  7528           DFHEIV99,
  7529           DFHEIV99,
  7530           DFHEIV99
  7531     SET ADDRESS OF CONTROL-FILE TO
  7532         DFHEIV20
  7533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7534
  7535
  7536     MOVE CF-PROC-CALC-AMT-TOL       TO WS-AMT-TOL.
  7537     MOVE CF-PROC-CALC-DAYS-TOL      TO WS-DAY-TOL.
  7538     MOVE CF-PROC-MAX-AUTO-PMT       TO WS-MAX-AUTO-PMT.
  7539     MOVE CF-PROC-MAX-AUTO-MOS       TO WS-MAX-AUTO-MOS.
  7540     MOVE CF-PROC-MAX-REG-PMT        TO WS-REG-PMT.
  7541
  7542  6150-READ-CARRIER.
  7543******************************************************************
  7544*       READ THE CARRIER RECORD TO GET PAYMENT TOLERANCES
  7545******************************************************************
  7546
  7547     MOVE '6'                    TO CNTL-RECORD-TYPE.
  7548     MOVE SPACES                 TO CNTL-GENL.
  7549
  7550     IF CONTROL-IS-ACTUAL-CARRIER
  7551         MOVE PI-CARRIER                 TO CNTL-GEN4
  7552     ELSE
  7553         MOVE PI-CARRIER-CONTROL-LEVEL   TO CNTL-GEN4.
  7554
  7555
  7556* EXEC CICS HANDLE CONDITION
  7557*         NOTFND(6180-READ-CERT)
  7558*         END-EXEC.
  7559*    MOVE '"$I                   ! ) #00007240' TO DFHEIV0
  7560     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7562     MOVE X'2920233030303037323430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 147
* EL154.cbl
  7563     CALL 'kxdfhei1' USING DFHEIV0
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7565
  7566
  7567
  7568* EXEC CICS READ
  7569*         DATASET(CNTL-ID)
  7570*         RIDFLD (CNTL-KEY)
  7571*         SET    (ADDRESS OF CONTROL-FILE)
  7572*         END-EXEC.
  7573*    MOVE '&"S        E          (   #00007244' TO DFHEIV0
  7574     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7575     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7576     MOVE X'2020233030303037323434' TO DFHEIV0(25:11)
  7577     CALL 'kxdfhei1' USING DFHEIV0,
  7578           CNTL-ID,
  7579           DFHEIV20,
  7580           DFHEIV99,
  7581           CNTL-KEY,
  7582           DFHEIV99,
  7583           DFHEIV99,
  7584           DFHEIV99
  7585     SET ADDRESS OF CONTROL-FILE TO
  7586         DFHEIV20
  7587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7588
  7589
  7590     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
  7591
  7592     IF WS-AMT-TOL = ZERO
  7593        MOVE CF-CALC-AMT-TOL     TO WS-AMT-TOL.
  7594
  7595     IF WS-DAY-TOL = ZEROS
  7596        MOVE CF-CALC-DAYS-TOL    TO WS-DAY-TOL.
  7597
  7598     IF WS-MAX-AUTO-PMT = ZEROS
  7599        MOVE CF-MAX-AUTO-PMT     TO WS-MAX-AUTO-PMT.
  7600
  7601     IF WS-MAX-AUTO-MOS = ZEROS
  7602        MOVE CF-MAX-AUTO-MOS     TO WS-MAX-AUTO-MOS.
  7603
  7604     IF WS-REG-PMT = ZEROS
  7605        MOVE CF-MAX-REG-PMT      TO WS-REG-PMT.
  7606
  7607 6180-READ-CERT.
  7608
  7609     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7610         GO TO 6190-READ-EMPLCY.
  7611
  7612
  7613* EXEC CICS HANDLE CONDITION
  7614*         NOTOPEN   (8880-CERT-NOT-OPEN)
  7615*         NOTFND    (6185-CERT-NOT-FOUND)
  7616*         END-EXEC.
  7617*    MOVE '"$JI                  ! * #00007272' TO DFHEIV0
  7618     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7619     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7620     MOVE X'2A20233030303037323732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 148
* EL154.cbl
  7621     CALL 'kxdfhei1' USING DFHEIV0
  7622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7623
  7624
  7625
  7626* EXEC CICS READ
  7627*         DATASET(CERT-ID)
  7628*         RIDFLD (CERT-KEY)
  7629*         SET    (ADDRESS OF CERTIFICATE-MASTER)
  7630*         END-EXEC.
  7631*    MOVE '&"S        E          (   #00007277' TO DFHEIV0
  7632     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7633     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7634     MOVE X'2020233030303037323737' TO DFHEIV0(25:11)
  7635     CALL 'kxdfhei1' USING DFHEIV0,
  7636           CERT-ID,
  7637           DFHEIV20,
  7638           DFHEIV99,
  7639           CERT-KEY,
  7640           DFHEIV99,
  7641           DFHEIV99,
  7642           DFHEIV99
  7643     SET ADDRESS OF CERTIFICATE-MASTER TO
  7644         DFHEIV20
  7645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7646
  7647
  7648     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7649         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  7650         MOVE '6'                    TO  DC-OPTION-CODE
  7651         MOVE '1'                    TO  DC-END-OF-MONTH
  7652         MOVE +0                     TO  DC-ELAPSED-DAYS
  7653                                         DC-ODD-DAYS-OVER
  7654         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  7655         PERFORM 9700-DATE-LINK
  7656         IF NO-CONVERSION-ERROR
  7657             MOVE DC-BIN-DATE-2      TO  WS-EXP-DT
  7658         ELSE
  7659             MOVE LOW-VALUES         TO  WS-EXP-DT
  7660     ELSE
  7661         MOVE CM-AH-LOAN-EXPIRE-DT   TO  WS-EXP-DT.
  7662
  7663     move cm-ah-benefit-amt      to ws-monthly-benefit
  7664     move cm-ah-benefit-cd       to ws-ah-benefit-cd
  7665     GO TO 6200-START-FINAL-EDITS.
  7666
  7667 6185-CERT-NOT-FOUND.
  7668     MOVE ER-0206                TO EMI-ERROR.
  7669     MOVE -1                     TO NEFFDTEL.
  7670     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7671     GO TO 6300-EXIT.
  7672
  7673 6190-READ-EMPLCY.
  7674
  7675
  7676* EXEC CICS HANDLE CONDITION
  7677*        NOTOPEN   (8885-EMPLCY-NOT-OPEN)
  7678*        NOTFND    (6195-EMPLCY-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 149
* EL154.cbl
  7679*    END-EXEC.
  7680*    MOVE '"$JI                  ! + #00007310' TO DFHEIV0
  7681     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7683     MOVE X'2B20233030303037333130' TO DFHEIV0(25:11)
  7684     CALL 'kxdfhei1' USING DFHEIV0
  7685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7686
  7687
  7688     MOVE CL-CV-REFERENCE-NO     TO  EMPLCY-REFERENCE-NO.
  7689
  7690
  7691* EXEC CICS READ
  7692*        DATASET   (EMPLCY-ID)
  7693*        RIDFLD    (EMPLCY-KEY)
  7694*        SET       (ADDRESS OF POLICY-MASTER)
  7695*    END-EXEC.
  7696*    MOVE '&"S        E          (   #00007317' TO DFHEIV0
  7697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7699     MOVE X'2020233030303037333137' TO DFHEIV0(25:11)
  7700     CALL 'kxdfhei1' USING DFHEIV0,
  7701           EMPLCY-ID,
  7702           DFHEIV20,
  7703           DFHEIV99,
  7704           EMPLCY-KEY,
  7705           DFHEIV99,
  7706           DFHEIV99,
  7707           DFHEIV99
  7708     SET ADDRESS OF POLICY-MASTER TO
  7709         DFHEIV20
  7710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7711
  7712
  7713     MOVE PM-INS-TERMINATION-DT  TO  WS-EXP-DT.
  7714     GO TO 6200-START-FINAL-EDITS.
  7715
  7716 6195-EMPLCY-NOT-FOUND.
  7717
  7718     MOVE ER-9483                TO  EMI-ERROR.
  7719     MOVE -1                     TO  NEFFDTEL.
  7720     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7721     GO TO 6300-EXIT.
  7722
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 150
* EL154.cbl
  7724 6200-START-FINAL-EDITS.
  7725
  7726******************************************************************
  7727****** VERIFY ELIMINATION PERIOD
  7728******************************************************************
  7729
  7730     IF CL-PAID-THRU-DT NOT EQUAL LOW-VALUES
  7731          GO TO 6225-CONTINUE-EDIT.
  7732
  7733     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7734         GO TO 6225-CONTINUE-EDIT.
  7735
  7736     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  7737     MOVE WS-ACCESS              TO CNTL-GENL.
  7738     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7739     MOVE '5'                    TO CNTL-RECORD-TYPE.
  7740     MOVE ZEROS                  TO CNTL-SEQ.
  7741
  7742     IF WS-BEN-CD = ZEROS
  7743         MOVE ER-0283            TO EMI-ERROR
  7744         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7745         MOVE -1                 TO NFSTPMTL
  7746         MOVE AL-UNBON           TO NFSTPMTA
  7747         GO TO 6300-EXIT.
  7748
  7749     PERFORM 7200-LOCATE-BENEFIT THRU 7200-EXIT.
  7750
  7751     IF NOT BENEFIT-FOUND
  7752         MOVE ER-0283            TO EMI-ERROR
  7753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7754         MOVE -1                 TO NFSTPMTL
  7755         MOVE AL-UNBON           TO NFSTPMTA
  7756         GO TO 6300-EXIT.
  7757
  7758     MOVE CF-BENEFIT-ALPHA (SUB-1) TO PI-BENEFIT-SAVE.
  7759
  7760     IF PI-BEN-DAYS NOT NUMERIC
  7761        MOVE ZEROS               TO PI-BEN-DAYS.
  7762
  7763     IF PI-BEN-TYPE = 'R'
  7764         IF PI-BEN-DAYS IS EQUAL TO ZEROS
  7765             NEXT SENTENCE
  7766         ELSE
  7767             SUBTRACT 1 FROM PI-BEN-DAYS.
  7768
  7769     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  7770     MOVE PI-BEN-DAYS            TO DC-ELAPSED-DAYS.
  7771     MOVE +0                     TO DC-ELAPSED-MONTHS.
  7772     MOVE '6'                    TO DC-OPTION-CODE.
  7773     PERFORM 9700-DATE-LINK.
  7774     MOVE DC-BIN-DATE-2          TO RETRO-ELIM-DATE.
  7775     IF NO-EFFDTE-ENTERED
  7776        IF PI-BEN-TYPE EQUAL 'E'
  7777          MOVE  SPACES              TO  WS-ELIMINATION-SW
  7778          MOVE  DC-BIN-DATE-2       TO  NEFFDTE-SAVE
  7779          MOVE  DC-GREG-DATE-1-MDY  TO  NEFFDTEO
  7780          INSPECT NEFFDTEI CONVERTING SPACES TO '/'.
  7781
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 151
* EL154.cbl
  7782     IF PI-BEN-TYPE = 'E'
  7783         IF RETRO-ELIM-DATE GREATER THAN NEFFDTE-SAVE
  7784             MOVE ER-0541            TO EMI-ERROR
  7785             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7786             MOVE -1                 TO NEFFDTEL
  7787             MOVE AL-UNBON           TO NEFFDTEA.
  7788
  7789     IF PI-BEN-TYPE = 'R'
  7790         IF RETRO-ELIM-DATE GREATER THAN NFSTPMT-SAVE
  7791             MOVE ER-0541            TO EMI-ERROR
  7792             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7793             MOVE -1                 TO NEFFDTEL
  7794             MOVE AL-UNBON           TO NEFFDTEA.
  7795
  7796
  7797 6225-CONTINUE-EDIT.
  7798******************************************************
  7799*VERIFY THAT THE LAST PAYMENT DATE IS NOT BEYOND     *
  7800*THE EXPIRATION DATE.                                *
  7801******************************************************
  7802* FOR BIU ALLOW PAYMENT PAST EXP + 7 MONTHS
  7803     MOVE WS-EXP-DT TO DC-BIN-DATE-1.
  7804     MOVE 6         TO DC-OPTION-CODE.
  7805     MOVE 0         TO DC-ELAPSED-DAYS.
  7806     MOVE 7         TO DC-ELAPSED-MONTHS.
  7807     PERFORM 9700-DATE-LINK.
  7808     IF NO-CONVERSION-ERROR
  7809         MOVE DC-BIN-DATE-2 TO WS-EXP-DT-PLUS7
  7810     ELSE
  7811         MOVE WS-EXP-DT     TO WS-EXP-DT-PLUS7
  7812     END-IF.
  7813
  7814     IF NLSTPMT-SAVE GREATER THAN WS-EXP-DT
  7815       IF CL-CERT-ACCOUNT (9:2) = 'BI' AND
  7816                      NLSTPMT-SAVE <= WS-EXP-DT-PLUS7
  7817         IF PI-LAST-ERROR-NO EQUAL ER-3396 OR ER-0670
  7818             CONTINUE
  7819         ELSE
  7820             MOVE ER-3396             TO EMI-ERROR
  7821             MOVE AL-UABON            TO NLSTPMTA
  7822             MOVE -1                  TO NLSTPMTL
  7823             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7824         END-IF
  7825       ELSE
  7826        MOVE ER-0396             TO EMI-ERROR
  7827        MOVE AL-UABON            TO NLSTPMTA
  7828        MOVE -1                  TO NLSTPMTL
  7829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7830        GO TO 6300-EXIT.
  7831
  7832******************************************************
  7833*VERIFY THAT THE LAST PAYMENT DATE IS GREATER THAN   *
  7834*THE FIRST PAYMENT DATE.                             *
  7835******************************************************
  7836
  7837     IF NLSTPMT-SAVE NOT GREATER THAN NFSTPMT-SAVE
  7838        MOVE ER-0559             TO EMI-ERROR
  7839        MOVE AL-UABON            TO NLSTPMTA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 152
* EL154.cbl
  7840        MOVE -1                  TO NLSTPMTL
  7841        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7842        GO TO 6300-EXIT.
  7843
  7844******************************************************
  7845*    MAKE SURE THE DIFFERENCE BETWEEN THE FIRST      *
  7846*    PAYMENT DATE AND LAST PAYMENT DATE IS           *
  7847*    DIVISABLE BY THE INTERVAL OF MONTHS,            *
  7848*    AND THE DURATION IS IN FULL MONTH PMTS.         *
  7849******************************************************
  7850     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  7851     MOVE NLSTPMT-SAVE           TO DC-BIN-DATE-2.
  7852     MOVE '1'                    TO DC-OPTION-CODE.
  7853     PERFORM 9700-DATE-LINK.
  7854     move dc-elapsed-months      to ws-proposed-benefits
  7855     if dc-elapsed-days > 0
  7856        add 1 to ws-proposed-benefits
  7857     end-if
  7858     DIVIDE DC-ELAPSED-MONTHS BY NMONTHSI GIVING WS-WORK
  7859            REMAINDER WS-REMAINDER.
  7860     IF WS-REMAINDER NOT = 0
  7861        MOVE ER-0397             TO EMI-ERROR
  7862        MOVE -1                  TO NMONTHSL
  7863        MOVE AL-UNBON            TO NMONTHSA
  7864        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7865        GO TO 6300-EXIT.
  7866
  7867     IF DC-ODD-DAYS-OVER GREATER THAN +0
  7868        MOVE ER-0597             TO EMI-ERROR
  7869        MOVE -1                  TO NLSTPMTL
  7870        MOVE AL-UNBON            TO NLSTPMTA
  7871                                    NFSTPMTA
  7872        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7873        GO TO 6300-EXIT.
  7874
  7875******************************************************
  7876*    VERIFY THAT FIRST PAYMENT DATE IS NOT LESS      *
  7877*    THAN THE CURRENT DATE.                          *
  7878******************************************************
  7879     IF NFSTPMT-SAVE LESS THAN CURRENT-SAVE
  7880        MOVE ER-0563             TO EMI-ERROR
  7881        MOVE -1                  TO NFSTPMTL
  7882        MOVE AL-UNBON            TO NFSTPMTA
  7883        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7884        GO TO 6300-EXIT.
  7885
  7886******************************************************
  7887*                                                    *
  7888*    EDIT THE NUMBER OF DAYS IN FIRST PAYMENT        *
  7889*                                                    *
  7890******************************************************
  7891
  7892     MOVE NEFFDTE-SAVE       TO DC-BIN-DATE-1
  7893     MOVE -1                 TO DC-ELAPSED-DAYS
  7894     MOVE +0                 TO DC-ELAPSED-MONTHS
  7895     MOVE '6'                TO DC-OPTION-CODE
  7896     PERFORM 9700-DATE-LINK
  7897     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 153
* EL154.cbl
  7898        MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1.
  7899
  7900     MOVE NFSTPMT-SAVE       TO DC-BIN-DATE-2
  7901     MOVE +0                 TO DC-ELAPSED-MONTHS
  7902                                DC-ELAPSED-DAYS
  7903     MOVE '1'                TO DC-OPTION-CODE
  7904     PERFORM 9700-DATE-LINK
  7905     IF NO-CONVERSION-ERROR
  7906        MOVE DC-ELAPSED-DAYS  TO WS-ELAPSED-DAYS.
  7907
  7908     IF NDAYSFL EQUAL +0
  7909       OR
  7910        NDAYSFI NOT NUMERIC
  7911       OR
  7912        NDAYSFI EQUAL ZEROS
  7913        MOVE DC-ELAPSED-DAYS  TO NDAYSFI.
  7914
  7915     IF DATE1-GREATER-DATE2
  7916        MOVE ER-0450 TO EMI-ERROR
  7917        MOVE -1      TO NEFFDTEL
  7918        MOVE AL-UABON TO NEFFDTEA
  7919        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7920        GO TO 6300-EXIT.
  7921
  7922     ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL
  7923     SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL
  7924     IF WS-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7925        WS-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7926        NDAYSFI = ZEROS
  7927         MOVE ER-0398             TO EMI-ERROR
  7928         MOVE -1                  TO NDAYSFL
  7929         MOVE AL-UNBON            TO NDAYSFA
  7930         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7931         GO TO 6300-EXIT.
  7932
  7933******************************************************
  7934*                                                    *
  7935*    VERIFY OR CALCULATE THE FIRST PAYMENT AMOUNT    *
  7936*                                                    *
  7937******************************************************
  7938
  7939     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  7940     MOVE NEFFDTE-SAVE          TO CP-PAID-FROM-DATE.
  7941     MOVE NFSTPMT-SAVE          TO CP-PAID-THRU-DT.
  7942     MOVE WS-CALC-METHOD        TO CP-CLAIM-CALC-METHOD.
  7943
  7944     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7945         MOVE PM-PRODUCER           TO CP-ACCOUNT-NUMBER
  7946         MOVE PM-INS-MONTH-BENEFIT  TO  CP-ORIGINAL-BENEFIT
  7947     ELSE
  7948         MOVE CM-AH-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  7949         MOVE CM-ACCOUNT            TO CP-ACCOUNT-NUMBER.
  7950
  7951
  7952* EXEC CICS LINK
  7953*         PROGRAM   ('ELPMNT')
  7954*         COMMAREA  (CALCULATION-PASS-AREA)
  7955*         LENGTH    (CP-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 154
* EL154.cbl
  7956*    END-EXEC.
  7957     MOVE 'ELPMNT' TO DFHEIV1
  7958*    MOVE '."C                   (   #00007561' TO DFHEIV0
  7959     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7960     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7961     MOVE X'2020233030303037353631' TO DFHEIV0(25:11)
  7962     CALL 'kxdfhei1' USING DFHEIV0,
  7963           DFHEIV1,
  7964           CALCULATION-PASS-AREA,
  7965           CP-COMM-LENGTH,
  7966           DFHEIV99,
  7967           DFHEIV99,
  7968           DFHEIV99,
  7969           DFHEIV99
  7970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7971
  7972
  7973     IF CP-CLAIM-PAYMENT NOT NUMERIC
  7974        MOVE +0 TO CP-CLAIM-PAYMENT.
  7975
  7976     IF CP-ACTUAL-DAYS NOT NUMERIC
  7977        MOVE +0 TO CP-ACTUAL-DAYS.
  7978
  7979     IF NFSTAMT-SAVE EQUAL +0
  7980        MOVE CP-CLAIM-PAYMENT TO NFSTAMT-SAVE
  7981                                 NFSTAMTO.
  7982
  7983     IF NDAYSFI EQUAL ZEROS
  7984        MOVE CP-ACTUAL-DAYS   TO NDAYSFI.
  7985
  7986
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 155
* EL154.cbl
  7988******************************************************
  7989*    VERIFY THAT DAYS IN FIRST PAY PERIOD IS REALLY  *
  7990*    THE DIFFERENCE BETWEEN THE IST PAYMENT DATE     *
  7991*    AND THE EFFECTIVE DATE                          *
  7992******************************************************
  7993*    MOVE NEFFDTE-SAVE           TO DC-BIN-DATE-1.
  7994*    MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-2.
  7995*    MOVE '1'                    TO DC-OPTION-CODE.
  7996*    PERFORM 9700-DATE-LINK.
  7997*    IF DATE1-GREATER-DATE2
  7998*       MOVE ER-0450 TO EMI-ERROR
  7999*       MOVE -1      TO NEFFDTEL
  8000*       MOVE AL-UABON TO NEFFDTEA
  8001*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8002*       GO TO 6300-EXIT.
  8003*
  8004*    ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL.
  8005*    SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL.
  8006*    IF DC-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  8007*       DC-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  8008*       NDAYSFI = ZEROS
  8009*        MOVE ER-0398             TO EMI-ERROR
  8010*        MOVE -1                  TO NDAYSFL
  8011*        MOVE AL-UNBON            TO NDAYSFA
  8012*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8013*        GO TO 6300-EXIT.
  8014*
  8015******************************************************
  8016*   VERIFY THAT THE FIRST PAYMENT AMOUNT IS WITHIN   *
  8017*   THE TOLERANCE OF THE DAILY BENEFITS              *
  8018******************************************************
  8019*    IF CL-PMT-CALC-METHOD = '2' OR '5'
  8020*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 365
  8021*    ELSE
  8022*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 360.
  8023
  8024     IF WS-AMT-TOL NOT = ZEROS
  8025        COMPUTE WS-AMT-PLUS-TOL = (NFSTAMT-SAVE + WS-AMT-TOL)
  8026        COMPUTE WS-AMT-MINUS-TOL = (NFSTAMT-SAVE - WS-AMT-TOL)
  8027        IF CP-CLAIM-PAYMENT LESS THAN WS-AMT-MINUS-TOL OR
  8028           CP-CLAIM-PAYMENT GREATER THAN WS-AMT-PLUS-TOL OR
  8029           NFSTAMT-SAVE = +0
  8030           MOVE ER-0399          TO EMI-ERROR
  8031           MOVE -1               TO NFSTAMTL
  8032           MOVE AL-UNBON         TO NFSTAMTA
  8033           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8034           GO TO 6300-EXIT.
  8035
  8036******************************************************
  8037*   VERIFY THERE IS AN ADDR TRAILER AVAILABLE        *
  8038*   FOR THE PAYEE CODE SPECIFIED                     *
  8039******************************************************
  8040     IF (WS-PAYEE-CD EQUAL 'I' AND
  8041        WS-PAYEE-SEQ-NUM GREATER THAN CL-INSURED-ADDR-CNT)
  8042       OR
  8043        (WS-PAYEE-CD EQUAL 'B' AND
  8044        WS-PAYEE-SEQ-NUM GREATER THAN CL-BENIF-ADDR-CNT)
  8045       OR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 156
* EL154.cbl
  8046        (WS-PAYEE-CD EQUAL 'A' AND
  8047        WS-PAYEE-SEQ-NUM GREATER THAN CL-ACCOUNT-ADDR-CNT)
  8048        GO TO 6250-ADDR-ERROR.
  8049
  8050     IF (WS-PAYEE-CD EQUAL 'I')
  8051       OR
  8052        ((WS-PAYEE-CD EQUAL 'B' OR 'A') AND
  8053        (WS-PAYEE-SEQ-NUM GREATER THAN 0))
  8054        GO TO 6260-CONT.
  8055
  8056     IF WS-PAYEE-CD EQUAL 'A'
  8057        GO TO 6260-CONT.
  8058
  8059     IF (WS-PAYEE-CD EQUAL 'B' AND
  8060        CL-BENEFICIARY EQUAL SPACES)
  8061        GO TO 6250-ADDR-ERROR.
  8062
  8063     MOVE PI-COMPANY-CD          TO BENE-CO.
  8064     MOVE 'B'                    TO BENE-REC-TYPE.
  8065     MOVE CL-BENEFICIARY         TO BENE-CODE.
  8066
  8067
  8068* EXEC CICS HANDLE CONDITION
  8069*         NOTFND   (6250-ADDR-ERROR)
  8070*         END-EXEC.
  8071*    MOVE '"$I                   ! , #00007661' TO DFHEIV0
  8072     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8074     MOVE X'2C20233030303037363631' TO DFHEIV0(25:11)
  8075     CALL 'kxdfhei1' USING DFHEIV0
  8076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8077
  8078
  8079
  8080* EXEC CICS READ
  8081*         DATASET     (BENE-ID)
  8082*         SET         (ADDRESS OF BENEFICIARY-MASTER)
  8083*         RIDFLD      (BENE-KEY)
  8084*         END-EXEC.
  8085*    MOVE '&"S        E          (   #00007665' TO DFHEIV0
  8086     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8087     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8088     MOVE X'2020233030303037363635' TO DFHEIV0(25:11)
  8089     CALL 'kxdfhei1' USING DFHEIV0,
  8090           BENE-ID,
  8091           DFHEIV20,
  8092           DFHEIV99,
  8093           BENE-KEY,
  8094           DFHEIV99,
  8095           DFHEIV99,
  8096           DFHEIV99
  8097     SET ADDRESS OF BENEFICIARY-MASTER TO
  8098         DFHEIV20
  8099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8100
  8101
  8102     GO TO 6260-CONT.
  8103
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 157
* EL154.cbl
  8104 6250-ADDR-ERROR.
  8105     IF (PI-COMPANY-ID EQUAL 'AIG' OR 'AUK' OR 'CIG' OR 'CUK')
  8106         IF (WS-PAYEE-CD EQUAL 'B')   AND
  8107            (WS-PAYEE-SEQ-NUM EQUAL 9)
  8108             GO TO 6260-CONT.
  8109
  8110     MOVE ER-0401         TO EMI-ERROR.
  8111     MOVE -1              TO NPAYEEL.
  8112     MOVE AL-UNBON        TO NPAYEEA.
  8113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8114
  8115 6260-CONT.
  8116******************************************************
  8117*   VERIFY THAT THE EFFECTIVE DATE IS NOT            *
  8118*   BEFORE THE INCURRED DATE                         *
  8119******************************************************
  8120     IF NEFFDTE-SAVE LESS THAN CL-INCURRED-DT
  8121        MOVE ER-0402             TO EMI-ERROR
  8122        MOVE -1                  TO NEFFDTEL
  8123        MOVE AL-UABON            TO NEFFDTEA
  8124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8125
  8126******************************************************
  8127*   VERIFY THAT THE CLAIM HAS NOT BEEN CLOSED.       *
  8128******************************************************
  8129     IF CLAIM-IS-CLOSED
  8130        MOVE ER-1599            TO EMI-ERROR
  8131        MOVE -1                  TO TERML
  8132        MOVE AL-UABON            TO TERMA
  8133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8134
  8135******************************************************
  8136*  VERIFY THAT THE EFFECTIVE DATE IS                 *
  8137*  SUBSEQUENT TO THE PAID-THRU DATE                  *
  8138******************************************************
  8139     IF NEFFDTE-SAVE NOT GREATER THAN CL-PAID-THRU-DT
  8140        MOVE ER-0403             TO EMI-ERROR
  8141        MOVE -1                  TO NEFFDTEL
  8142        MOVE AL-UABON            TO NEFFDTEA
  8143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8144
  8145******************************************************
  8146*  VERIFY THAT THE NUMBER OF MONTHS BETWEEN          *
  8147*  THE EFFECTIVE DATE AND THE LAST PAYMENT DATE      *
  8148*  IS NOT GREATER THAN THE MAXIMUM ALLOWED           *
  8149******************************************************
  8150     IF WS-MAX-AUTO-MOS NOT = ZEROS
  8151        MOVE NEFFDTE-SAVE        TO DC-BIN-DATE-1
  8152        MOVE NLSTPMT-SAVE        TO DC-BIN-DATE-2
  8153        MOVE '1'                 TO DC-OPTION-CODE
  8154        PERFORM 9700-DATE-LINK
  8155        IF DC-ELAPSED-MONTHS GREATER THAN WS-MAX-AUTO-MOS
  8156           MOVE ER-0404             TO EMI-ERROR
  8157           MOVE -1                  TO NEFFDTEL
  8158           MOVE AL-UABON            TO NEFFDTEA NLSTPMTA
  8159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8160
  8161******************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 158
* EL154.cbl
  8162*  VERIFY THAT THE CERTIFICATE DOES NOT HAVE A       *
  8163*  CURRENT STATUS OF '8' (CANCEL APPLIED)            *
  8164******************************************************
  8165
  8166     IF PI-COMPANY-ID IS EQUAL TO 'HAN' OR 'LGX'
  8167         IF CM-AH-CANCEL-APPLIED
  8168             MOVE ER-0839            TO  EMI-ERROR
  8169             MOVE -1                 TO  ENTERPFL
  8170             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8171******************************************************************
  8172*   check to see if the pd thru dates are past the benefit exp dt
  8173******************************************************************
  8174
  8175     if pi-company-id not = 'DCC' and 'VPP'
  8176        GO TO 6300-bypass-dcc
  8177     END-IF
  8178
  8179     move zeros                  to ws-max-benefit-amt
  8180                                    ws-max-benefit-pmts
  8181     perform 6320-read-acct      thru 6320-exit
  8182     if ws-dcc-product-code not = spaces
  8183        perform 6340-GET-DDF-LIMITS
  8184                                 thru 6340-exit
  8185        if pdef-found
  8186           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8187              (P1 > +8)
  8188              OR (PD-PROD-CODE (P1) = cl-claim-type)
  8189           END-PERFORM
  8190           IF P1 < +9
  8191              if pd-ben-pct (p1) not numeric
  8192                 move zeros      to pd-ben-pct (p1)
  8193              end-if
  8194              if pd-ben-pct (p1) = zeros
  8195                 move +1         to ws-work-ben-pct
  8196              else
  8197                 move pd-ben-pct (p1)
  8198                                 to ws-work-ben-pct
  8199              end-if
  8200              MOVE PD-MAX-AMT (P1)
  8201                                 TO ws-max-benefit-amt
  8202              compute ws-monthly-benefit =
  8203                 ws-monthly-benefit * ws-work-ben-pct
  8204              if ws-monthly-benefit > pd-max-amt (p1)
  8205                 move pd-max-amt (p1) to ws-monthly-benefit
  8206              end-if
  8207              move pd-crit-period (p1)
  8208                                 to ws-max-benefit-pmts
  8209           else
  8210              move er-1674       to emi-error
  8211              PERFORM 9900-ERROR-FORMAT
  8212                                 THRU 9900-EXIT
  8213           END-IF
  8214        else
  8215           move er-1672          to emi-error
  8216           PERFORM 9900-ERROR-FORMAT
  8217                                 THRU 9900-EXIT
  8218        END-IF
  8219     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 159
* EL154.cbl
  8220*    if (ws-max-benefit-amt not = zeros)
  8221*       and (ws-max-benefit-amt < ws-monthly-benefit)
  8222*       move ws-max-benefit-amt  to ws-monthly-benefit
  8223*    end-if
  8224     perform 6350-get-cert-trlr  thru 6350-exit
  8225
  8226     if (nfstamt-save = zeros)
  8227        or (nfstamt-save = cp-claim-payment)
  8228        move ws-monthly-benefit  to nfstamt-save
  8229                                    nfstamto
  8230     end-if
  8231
  8232*    compute ws-edit-1st-pmt-amt rounded =
  8233*       ws-monthly-benefit * (ndaysfi / 30)
  8234*061013if nfstamt-save > ws-edit-1st-pmt-amt
  8235*061013   move er-1657             to emi-error
  8236*061013   move -1                  to nfstamtl
  8237*061013   move al-unbon            to nfstamta
  8238*061013   perform 9900-error-format
  8239*061013                            thru 9900-exit
  8240*061013end-if
  8241
  8242     if nfstamt-save = zeros
  8243        move ws-monthly-benefit to nfstamt-save
  8244     end-if
  8245
  8246     MOVE DC-ELAPSED-MONTHS      TO WS-PROPOSED-BENEFITS
  8247     COMPUTE WS-BENEFITS-PREV-PAID = WS-BENEFITS-PREV-PAID +
  8248        (NFSTAMT-SAVE / WS-MONTHLY-BENEFIT)
  8249     IF CL-CRITICAL-PERIOD > ZEROS
  8250        IF (WS-BENEFITS-PREV-PAID + WS-PROPOSED-BENEFITS) >
  8251           CL-CRITICAL-PERIOD
  8252              MOVE ER-1657             TO EMI-ERROR
  8253              MOVE -1                  TO NFSTAMTL
  8254              MOVE AL-UNBON            TO NFSTAMTA
  8255              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8256        END-IF
  8257     END-IF
  8258     move cm-ah-loan-expire-dt   to ws-benefit-expiration-dt
  8259     IF CL-CRITICAL-PERIOD NOT = ZEROS and spaces
  8260        move cl-critical-period  to dc-elapsed-months
  8261        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  8262        MOVE ZEROS               TO DC-ELAPSED-DAYS
  8263        MOVE '6'                 TO DC-OPTION-CODE
  8264        PERFORM 9700-DATE-LINK
  8265        MOVE DC-BIN-DATE-2       TO ws-BENEFIT-EXPIRATION-DT
  8266     END-IF
  8267
  8268     if nlstpmt-save > ws-benefit-expiration-dt
  8269        move er-1658             to emi-error
  8270        move -1                  to nlstpmtl
  8271        move al-uabon            to nlstpmta
  8272        perform 9900-error-format thru 9900-exit
  8273     end-if
  8274
  8275     MOVE cl-control-primary     TO ELTRLR-KEY
  8276     MOVE +95                    TO TRLR-SEQ-NO
  8277
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 160
* EL154.cbl
  8278* EXEC CICS READ
  8279*       DATASET  ('ELTRLR')
  8280*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8281*       RIDFLD   (ELTRLR-KEY)
  8282*       RESP     (WS-RESPONSE)
  8283*    END-EXEC
  8284     MOVE 'ELTRLR' TO DFHEIV1
  8285*    MOVE '&"S        E          (  N#00007846' TO DFHEIV0
  8286     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8288     MOVE X'204E233030303037383436' TO DFHEIV0(25:11)
  8289     CALL 'kxdfhei1' USING DFHEIV0,
  8290           DFHEIV1,
  8291           DFHEIV20,
  8292           DFHEIV99,
  8293           ELTRLR-KEY,
  8294           DFHEIV99,
  8295           DFHEIV99,
  8296           DFHEIV99
  8297     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8298         DFHEIV20
  8299     MOVE EIBRESP  TO WS-RESPONSE
  8300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8301
  8302     if ws-resp-normal
  8303        perform varying s1 from +1 by +1 until
  8304           at-note-error-no (s1) = spaces
  8305           if at-note-error-no (s1) not = '1661' and '1662'
  8306           move at-note-error-no (s1)
  8307                                 to emi-error
  8308           if at-note-error-no (s1) = '1653'
  8309              evaluate true
  8310                 when cl-claim-type = 'L'
  8311                    move '  LF  '
  8312                                 to emi-claim-type
  8313                 when cl-claim-type = 'I'
  8314                    move '  IU  '
  8315                                 to emi-claim-type
  8316                 when cl-claim-type = 'F'
  8317                    move '  FL  '
  8318                                 to emi-claim-type
  8319                 when cl-claim-type = 'O'
  8320                    move '  OT  '
  8321                                 to emi-claim-type
  8322                 when other
  8323                    move '  AH  '
  8324                                 to emi-claim-type
  8325              end-evaluate
  8326           end-if
  8327           move -1               to nlstpmtl
  8328           PERFORM 9900-ERROR-FORMAT
  8329                                 THRU 9900-EXIT
  8330           end-if
  8331        end-perform
  8332     end-if
  8333     go to 6300-exit
  8334     .
  8335 6300-bypass-dcc.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 161
* EL154.cbl
  8336
  8337
  8338     perform 6350-get-cert-trlr  thru 6350-exit
  8339
  8340     compute ws-benefits-prev-paid = ws-benefits-prev-paid +
  8341        (nfstamt-save / ws-monthly-benefit)
  8342     if cl-critical-period > zeros
  8343        if (ws-benefits-prev-paid + ws-proposed-benefits) >
  8344           cl-critical-period
  8345           move er-1658          to emi-error
  8346           move -1               to nlstpmtl
  8347           move al-uabon         to nlstpmta
  8348           perform 9900-error-format
  8349                                 thru 9900-exit
  8350        end-if
  8351     end-if
  8352     .
  8353 6300-EXIT.
  8354      EXIT.
  8355 6320-read-acct.
  8356
  8357     move spaces              to WS-ACCT-RECORD-SW
  8358                                 ws-dcc-product-code
  8359                                 ws-clp-state
  8360
  8361     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
  8362     MOVE PI-CARRIER          TO ACCT-CARRIER
  8363     MOVE PI-GROUPING         TO ACCT-GROUPING
  8364     MOVE PI-STATE            TO ACCT-STATE
  8365     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
  8366     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
  8367     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
  8368
  8369
  8370* EXEC CICS READ
  8371*       DATASET ('ERACCT')
  8372*       RIDFLD  (ERACCT-KEY)
  8373*       SET     (ADDRESS OF ACCOUNT-MASTER)
  8374*       GTEQ
  8375*       resp    (WS-RESPONSE)
  8376*    END-EXEC
  8377     MOVE 'ERACCT' TO DFHEIV1
  8378*    MOVE '&"S        G          (  N#00007920' TO DFHEIV0
  8379     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8381     MOVE X'204E233030303037393230' TO DFHEIV0(25:11)
  8382     CALL 'kxdfhei1' USING DFHEIV0,
  8383           DFHEIV1,
  8384           DFHEIV20,
  8385           DFHEIV99,
  8386           ERACCT-KEY,
  8387           DFHEIV99,
  8388           DFHEIV99,
  8389           DFHEIV99
  8390     SET ADDRESS OF ACCOUNT-MASTER TO
  8391         DFHEIV20
  8392     MOVE EIBRESP  TO WS-RESPONSE
  8393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 162
* EL154.cbl
  8394     IF WS-RESP-NORMAL
  8395        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
  8396        and pi-cert-eff-dt < am-expiration-dt
  8397        and pi-cert-eff-dt >= am-effective-dt
  8398        move am-dcc-product-code to ws-dcc-product-code
  8399        move am-dcc-clp-state    to ws-clp-state
  8400        set acct-found           to true
  8401     end-if
  8402
  8403     .
  8404 6320-exit.
  8405     exit.
  8406
  8407 6340-GET-DDF-LIMITS.
  8408
  8409     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8410     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8411     MOVE pi-state               TO ERPDEF-STATE
  8412     if ws-clp-state not = pi-state and spaces and zeros
  8413        move ws-clp-state        to erpdef-state
  8414     end-if
  8415     MOVE WS-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8416     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8417     MOVE ws-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8418     MOVE pi-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8419
  8420     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8421
  8422
  8423* EXEC CICS STARTBR
  8424*        DATASET  ('ERPDEF')
  8425*        RIDFLD   (ERPDEF-KEY)
  8426*        GTEQ
  8427*        RESP     (WS-RESPONSE)
  8428*    END-EXEC
  8429     MOVE 'ERPDEF' TO DFHEIV1
  8430     MOVE 0
  8431       TO DFHEIV11
  8432*    MOVE '&,         G          &  N#00007955' TO DFHEIV0
  8433     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8434     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8435     MOVE X'204E233030303037393535' TO DFHEIV0(25:11)
  8436     CALL 'kxdfhei1' USING DFHEIV0,
  8437           DFHEIV1,
  8438           ERPDEF-KEY,
  8439           DFHEIV99,
  8440           DFHEIV11,
  8441           DFHEIV99
  8442     MOVE EIBRESP  TO WS-RESPONSE
  8443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8444
  8445     IF NOT WS-RESP-NORMAL
  8446        GO TO 6340-EXIT
  8447     END-IF
  8448
  8449     .
  8450 6340-READNEXT.
  8451
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 163
* EL154.cbl
  8452
  8453* EXEC CICS READNEXT
  8454*       DATASET  ('ERPDEF')
  8455*       SET      (ADDRESS OF PRODUCT-MASTER)
  8456*       RIDFLD   (ERPDEF-KEY)
  8457*       RESP     (WS-RESPONSE)
  8458*    END-EXEC
  8459     MOVE 'ERPDEF' TO DFHEIV1
  8460     MOVE 0
  8461       TO DFHEIV11
  8462*    MOVE '&.S                   )  N#00007969' TO DFHEIV0
  8463     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8464     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8465     MOVE X'204E233030303037393639' TO DFHEIV0(25:11)
  8466     CALL 'kxdfhei1' USING DFHEIV0,
  8467           DFHEIV1,
  8468           DFHEIV20,
  8469           DFHEIV99,
  8470           ERPDEF-KEY,
  8471           DFHEIV99,
  8472           DFHEIV11,
  8473           DFHEIV99,
  8474           DFHEIV99
  8475     SET ADDRESS OF PRODUCT-MASTER TO
  8476         DFHEIV20
  8477     MOVE EIBRESP  TO WS-RESPONSE
  8478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8479
  8480     IF NOT WS-RESP-NORMAL
  8481        GO TO 6340-ENDBR
  8482     END-IF
  8483
  8484     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8485        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8486           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8487        ELSE
  8488           GO TO 6340-READNEXT
  8489        END-IF
  8490     ELSE
  8491        GO TO 6340-ENDBR
  8492     END-IF
  8493     .
  8494 6340-ENDBR.
  8495
  8496
  8497* EXEC CICS ENDBR
  8498*       DATASET  ('ERPDEF')
  8499*    END-EXEC
  8500     MOVE 'ERPDEF' TO DFHEIV1
  8501     MOVE 0
  8502       TO DFHEIV11
  8503*    MOVE '&2                    $   #00007992' TO DFHEIV0
  8504     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8505     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8506     MOVE X'2020233030303037393932' TO DFHEIV0(25:11)
  8507     CALL 'kxdfhei1' USING DFHEIV0,
  8508           DFHEIV1,
  8509           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 164
* EL154.cbl
  8510           DFHEIV99
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8512
  8513     .
  8514 6340-EXIT.
  8515     EXIT.
  8516
  8517 6350-get-cert-trlr.
  8518
  8519     move spaces                 to ws-cert-trlr-sw
  8520     move zeros                  to ws-benefits-prev-paid
  8521                                    ws-total-paid
  8522     move cl-cert-key-data       to elcrtt-key (2:21)
  8523     move cl-company-cd          to ctrlr-comp-cd
  8524     move cl-cert-no             to ctrlr-cert-no
  8525     move 'B'                    to ctrlr-rec-type
  8526
  8527
  8528* EXEC CICS READ
  8529*       DATASET  ('ELCRTT')
  8530*       set      (address of CERTIFICATE-TRAILERS)
  8531*       RIDFLD   (ELCRTT-KEY)
  8532*       RESP     (WS-RESPONSE)
  8533*    END-EXEC
  8534     MOVE 'ELCRTT' TO DFHEIV1
  8535*    MOVE '&"S        E          (  N#00008010' TO DFHEIV0
  8536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8538     MOVE X'204E233030303038303130' TO DFHEIV0(25:11)
  8539     CALL 'kxdfhei1' USING DFHEIV0,
  8540           DFHEIV1,
  8541           DFHEIV20,
  8542           DFHEIV99,
  8543           ELCRTT-KEY,
  8544           DFHEIV99,
  8545           DFHEIV99,
  8546           DFHEIV99
  8547     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8548         DFHEIV20
  8549     MOVE EIBRESP  TO WS-RESPONSE
  8550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8551     IF not WS-RESP-NORMAL
  8552        go to 6350-exit
  8553     end-if
  8554
  8555     set cert-trlr-found         to true
  8556     perform varying s1 from +1 by +1 until
  8557        (s1 > +24)
  8558        or (cs-claim-no (s1) = spaces)
  8559        if (cs-benefit-period (s1) = cl-benefit-period)
  8560           and (cs-claim-type (s1) = cl-claim-type)
  8561           and (cs-insured-type (s1) = cl-insured-type)
  8562           compute ws-total-paid =
  8563              ws-total-paid + cs-total-paid (s1)
  8564        end-if
  8565     end-perform
  8566     compute ws-benefits-prev-paid =
  8567        (ws-total-paid / ws-monthly-benefit)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 165
* EL154.cbl
  8568     .
  8569 6350-exit.
  8570     exit.
  8571 6400-PAYMENT-CALCULATION.
  8572
  8573     IF WS-CALC-METHOD = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  8574         IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  8575             COMPUTE NREGPMT-SAVE ROUNDED =
  8576                 (PM-INS-MONTH-BENEFIT * NMONTHSI)
  8577             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8578             GO TO 6499-EXIT
  8579         ELSE
  8580             COMPUTE NREGPMT-SAVE ROUNDED =
  8581                 (ws-monthly-benefit * NMONTHSI)
  8582             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8583             GO TO 6499-EXIT.
  8584
  8585     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8586     MOVE +0                     TO DC-ELAPSED-DAYS.
  8587     MOVE NMONTHSI               TO DC-ELAPSED-MONTHS.
  8588     MOVE '6'                    TO DC-OPTION-CODE.
  8589     PERFORM 9700-DATE-LINK.
  8590
  8591     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8592     MOVE '1'                    TO DC-OPTION-CODE.
  8593     PERFORM 9700-DATE-LINK.
  8594
  8595     IF (PI-COMPANY-ID  = 'FIA' AND
  8596        CL-CERT-ACCOUNT = '0000011043')
  8597        COMPUTE WS-DAILY-RATE ROUNDED =
  8598                             (CM-AH-BENEFIT-AMT * 13) / 365
  8599        COMPUTE NREGPMT-SAVE ROUNDED =
  8600                             WS-DAILY-RATE * DC-ELAPSED-DAYS
  8601        MOVE NREGPMT-SAVE  TO  NREGAMTO
  8602        GO TO 6499-EXIT.
  8603
  8604*    IF WS-CALC-METHOD = '4'
  8605*       COMPUTE WS-DAILY-RATE ROUNDED =
  8606*                            (CM-AH-BENEFIT-AMT / 30)
  8607*       COMPUTE NREGPMT-SAVE ROUNDED =
  8608*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8609*
  8610*    IF WS-CALC-METHOD = '5'
  8611*       COMPUTE WS-DAILY-RATE ROUNDED =
  8612*                            (CM-AH-BENEFIT-AMT * 12) / 365
  8613*       COMPUTE NREGPMT-SAVE ROUNDED =
  8614*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8615
  8616 6499-EXIT.
  8617      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 166
* EL154.cbl
  8619 6900-SET-CODES.
  8620     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  8621                                    ACTV-CLAIM.
  8622
  8623     MOVE PI-COMPANY-ID          TO CNTL-CO.
  8624
  8625     MOVE PI-COMPANY-CD          TO CLAM-CO
  8626                                    ACTV-CO
  8627                                    CERT-CO
  8628                                    EMPLCY-COMPANY-CD.
  8629
  8630     MOVE PI-CARRIER             TO CLAM-CARRIER
  8631                                    ACTV-CARRIER
  8632                                    CERT-CARRIER
  8633                                    EMPLCY-CARRIER.
  8634
  8635     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  8636                                    ACTV-CERT-NUM
  8637                                    CERT-CERT-NUM.
  8638
  8639     MOVE PI-GROUPING            TO CERT-GROUPING
  8640                                    EMPLCY-GROUPING.
  8641     MOVE PI-STATE               TO CERT-STATE
  8642                                    EMPLCY-STATE.
  8643     MOVE PI-ACCOUNT             TO CERT-ACCOUNT
  8644                                    EMPLCY-PRODUCER.
  8645     MOVE PI-CERT-EFF-DT         TO CERT-EFF-DT
  8646                                    EMPLCY-EFF-DT.
  8647     MOVE '2'                    TO CNTL-RECORD-TYPE.
  8648     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
  8649     MOVE ZEROS                  TO CNTL-SEQ.
  8650
  8651 6999-EXIT.
  8652      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 167
* EL154.cbl
  8654 7000-BUILD-SCREEN.
  8655     PERFORM 6900-SET-CODES.
  8656
  8657
  8658* EXEC CICS HANDLE CONDITION
  8659*         NOTOPEN(8860-CLAM-NOT-OPEN)
  8660*         NOTFND (7090-CLAIM-NOT-FOUND)
  8661*         END-EXEC.
  8662*    MOVE '"$JI                  ! - #00008122' TO DFHEIV0
  8663     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8665     MOVE X'2D20233030303038313232' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670
  8671* EXEC CICS READ
  8672*         DATASET(CLAM-ID)
  8673*         SET    (ADDRESS OF CLAIM-MASTER)
  8674*         RIDFLD (CLAM-KEY)
  8675*         END-EXEC.
  8676*    MOVE '&"S        E          (   #00008127' TO DFHEIV0
  8677     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8678     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8679     MOVE X'2020233030303038313237' TO DFHEIV0(25:11)
  8680     CALL 'kxdfhei1' USING DFHEIV0,
  8681           CLAM-ID,
  8682           DFHEIV20,
  8683           DFHEIV99,
  8684           CLAM-KEY,
  8685           DFHEIV99,
  8686           DFHEIV99,
  8687           DFHEIV99
  8688     SET ADDRESS OF CLAIM-MASTER TO
  8689         DFHEIV20
  8690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8691
  8692
  8693     MOVE CL-CLAIM-NO            TO CLAIMO
  8694     MOVE CL-CERT-PRIME          TO CERTO
  8695     MOVE CL-CERT-SFX            TO SUFFIXO
  8696     MOVE CL-CARRIER             TO CARRO
  8697     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  8698
  8699     IF ACTV-SEQ = ZEROS
  8700        GO TO 7080-NO-TRAILER.
  8701
  8702
  8703* EXEC CICS HANDLE CONDITION
  8704*         NOTOPEN(8870-ACTV-NOT-OPEN)
  8705*         NOTFND (7080-NO-TRAILER)
  8706*         END-EXEC.
  8707*    MOVE '"$JI                  ! . #00008142' TO DFHEIV0
  8708     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8710     MOVE X'2E20233030303038313432' TO DFHEIV0(25:11)
  8711     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 168
* EL154.cbl
  8712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8713
  8714
  8715
  8716* EXEC CICS READ
  8717*         DATASET(ACTV-ID)
  8718*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  8719*         RIDFLD (ACTV-KEY)
  8720*    END-EXEC.
  8721*    MOVE '&"S        E          (   #00008147' TO DFHEIV0
  8722     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8724     MOVE X'2020233030303038313437' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0,
  8726           ACTV-ID,
  8727           DFHEIV20,
  8728           DFHEIV99,
  8729           ACTV-KEY,
  8730           DFHEIV99,
  8731           DFHEIV99,
  8732           DFHEIV99
  8733     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8734         DFHEIV20
  8735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8736
  8737
  8738     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
  8739     MOVE SPACE                  TO DC-OPTION-CODE.
  8740     PERFORM 9700-DATE-LINK.
  8741     MOVE DC-GREG-DATE-1-EDIT    TO CESTDTEI.
  8742
  8743
  8744     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
  8745     MOVE SPACE                  TO DC-OPTION-CODE.
  8746     PERFORM 9700-DATE-LINK.
  8747     MOVE DC-GREG-DATE-1-EDIT    TO CEFFDTEI.
  8748
  8749     IF AT-AUTO-PAY-DAY NUMERIC
  8750         MOVE AT-AUTO-PAY-DAY    TO DAY2PAYI
  8751     ELSE
  8752         MOVE ZEROS              TO DAY2PAYI.
  8753
  8754     IF PI-USES-PAID-TO
  8755         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8756         MOVE '6'                     TO  DC-OPTION-CODE
  8757         MOVE +1                      TO  DC-ELAPSED-DAYS
  8758         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8759         PERFORM 9700-DATE-LINK
  8760         IF NO-CONVERSION-ERROR
  8761             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
  8762         ELSE
  8763             MOVE LOW-VALUES          TO  CFSTPMTI
  8764     ELSE
  8765         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8766         MOVE SPACE                   TO  DC-OPTION-CODE
  8767         PERFORM 9700-DATE-LINK
  8768         IF NO-CONVERSION-ERROR
  8769             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 169
* EL154.cbl
  8770         ELSE
  8771             MOVE LOW-VALUES          TO  CFSTPMTI.
  8772
  8773     IF PI-USES-PAID-TO
  8774         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8775         MOVE '6'                     TO  DC-OPTION-CODE
  8776         MOVE +1                      TO  DC-ELAPSED-DAYS
  8777         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8778         PERFORM 9700-DATE-LINK
  8779         IF NO-CONVERSION-ERROR
  8780             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8781         ELSE
  8782             MOVE LOW-VALUES          TO  CLSTPMTI
  8783     ELSE
  8784         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8785         MOVE SPACE                   TO  DC-OPTION-CODE
  8786         MOVE +0                      TO  DC-ELAPSED-DAYS
  8787                                          DC-ELAPSED-MONTHS
  8788         PERFORM 9700-DATE-LINK
  8789         IF NO-CONVERSION-ERROR
  8790             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8791         ELSE
  8792             MOVE LOW-VALUES          TO  CLSTPMTI.
  8793
  8794     MOVE AT-FIRST-PMT-AMT       TO CFSTAMTO.
  8795     MOVE AT-DAYS-IN-1ST-PMT     TO CDAYSFO.
  8796
  8797     IF AT-LAST-PMT-TYPE = 'F'
  8798        MOVE 'Y'                 TO CLASTO
  8799     ELSE
  8800        MOVE 'N'                 TO CLASTO.
  8801
  8802     MOVE AT-RECORDED-BY         TO CESTBYO.
  8803     MOVE AT-REGULAR-PMT-AMT     TO CREGPMTO.
  8804     MOVE AT-AUTO-CASH           TO CINDCTRO.
  8805
  8806     MOVE AT-AUTO-END-LETTER     TO PRINTI
  8807                                    PI-AUTO-END-LETTER.
  8808
  8809     IF AT-AUTO-PAYEE-TYPE EQUAL 'I'
  8810        MOVE 'INSURED'           TO CPAYEEO
  8811     ELSE
  8812     IF AT-AUTO-PAYEE-TYPE EQUAL 'B'
  8813        MOVE 'BENEFIC'           TO CPAYEEO
  8814     ELSE
  8815     IF AT-AUTO-PAYEE-TYPE EQUAL 'A'
  8816        MOVE 'ACCOUNT'           TO CPAYEEO.
  8817
  8818     MOVE AT-INTERVAL-MONTHS     TO CMONTHSO.
  8819     MOVE -1                     TO TERML.
  8820     GO TO 8100-SEND-INITIAL-MAP.
  8821
  8822 7080-NO-TRAILER.
  8823     MOVE 'A'                    TO TERMI.
  8824     MOVE AL-PADON               TO TERMA
  8825                                    PRINTA.
  8826     MOVE -1                     TO NFSTPMTL.
  8827     MOVE ER-0346                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 170
* EL154.cbl
  8828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8829     GO TO 8100-SEND-INITIAL-MAP.
  8830
  8831 7090-CLAIM-NOT-FOUND.
  8832     MOVE ER-0186                TO EMI-ERROR.
  8833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8834     GO TO 8100-SEND-INITIAL-MAP.
  8835
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 171
* EL154.cbl
  8837 7100-CHECK-AUTO-ACTIVITY.
  8838
  8839
  8840* EXEC CICS HANDLE CONDITION
  8841*        NOTFND   (7100-NOT-FOUND)
  8842*    END-EXEC.
  8843*    MOVE '"$I                   ! / #00008254' TO DFHEIV0
  8844     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8846     MOVE X'2F20233030303038323534' TO DFHEIV0(25:11)
  8847     CALL 'kxdfhei1' USING DFHEIV0
  8848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8849
  8850
  8851     MOVE PI-COMPANY-ID          TO  CNTL-CO.
  8852     MOVE 'T'                    TO  CNTL-RECORD-TYPE.
  8853     MOVE SPACES                 TO  CNTL-GENL.
  8854     MOVE +0                     TO  CNTL-SEQ.
  8855
  8856
  8857* EXEC CICS READ
  8858*        DATASET   (CNTL-ID)
  8859*        RIDFLD    (CNTL-KEY)
  8860*        SET       (ADDRESS OF CONTROL-FILE)
  8861*    END-EXEC.
  8862*    MOVE '&"S        E          (   #00008263' TO DFHEIV0
  8863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8865     MOVE X'2020233030303038323633' TO DFHEIV0(25:11)
  8866     CALL 'kxdfhei1' USING DFHEIV0,
  8867           CNTL-ID,
  8868           DFHEIV20,
  8869           DFHEIV99,
  8870           CNTL-KEY,
  8871           DFHEIV99,
  8872           DFHEIV99,
  8873           DFHEIV99
  8874     SET ADDRESS OF CONTROL-FILE TO
  8875         DFHEIV20
  8876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8877
  8878
  8879     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
  8880
  8881 7100-CHECK-SYSTEM-ACTIVITY.
  8882
  8883     IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  8884         MOVE CL-ACTIVITY-CODE             TO  SUB-1
  8885         IF SUB-1 IS GREATER THAN +9
  8886             SUBTRACT +9 FROM SUB-1
  8887             MOVE CF-USER-RESET-SW (SUB-1) TO  WS-RESET-SW
  8888         ELSE
  8889             MOVE CF-SYS-RESET-SW  (SUB-1) TO  WS-RESET-SW
  8890     ELSE
  8891         MOVE 'Y'                          TO  WS-RESET-SW.
  8892
  8893     IF TERMI IS EQUAL TO 'A'
  8894         IF (CF-SYS-ACTIVE-SW (5) IS EQUAL TO 'N' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 172
* EL154.cbl
  8895             MOVE 'N'                TO  WS-LETTER-SW
  8896                                         WS-RESET-SW
  8897             GO TO 7100-EXIT.
  8898
  8899     IF TERMI IS EQUAL TO 'A'
  8900         IF (CF-SYS-LETTER-ID (5) EQUAL SPACES OR LOW-VALUES)
  8901             MOVE 'N'                TO  WS-LETTER-SW
  8902         ELSE
  8903             MOVE 'Y'                TO  WS-LETTER-SW.
  8904
  8905     IF TERMI IS EQUAL TO 'Y'
  8906         IF (CF-SYS-ACTIVE-SW (6) IS EQUAL TO 'N' OR ' ')
  8907             MOVE 'N'                TO  WS-LETTER-SW
  8908                                         WS-RESET-SW
  8909             GO TO 7100-EXIT.
  8910
  8911     IF TERMI IS EQUAL TO 'Y'
  8912         IF (CF-SYS-LETTER-ID (6) EQUAL SPACES OR LOW-VALUES)
  8913             MOVE 'N'                TO  WS-LETTER-SW
  8914         ELSE
  8915             MOVE 'Y'                TO  WS-LETTER-SW.
  8916
  8917     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  8918         GO TO 7100-EXIT.
  8919
  8920     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  8921        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  8922         GO TO 7100-EXIT.
  8923
  8924     IF WS-RESET-SW IS EQUAL TO 'N'
  8925         GO TO 7100-EXIT.
  8926
  8927     MOVE CURRENT-BIN-DATE           TO  CL-ACTIVITY-MAINT-DT.
  8928
  8929     IF TERMI IS EQUAL TO 'A'
  8930         MOVE 05                     TO  CL-ACTIVITY-CODE
  8931         MOVE 'AUTO'                 TO  CL-ACTIVITY-MAINT-TYPE
  8932     ELSE
  8933         MOVE 06                     TO  CL-ACTIVITY-CODE
  8934         MOVE 'TERM'                 TO  CL-ACTIVITY-MAINT-TYPE.
  8935
  8936     GO TO 7100-EXIT.
  8937
  8938 7100-NOT-FOUND.
  8939
  8940     MOVE 'N'                        TO  WS-ACT-REC-FOUND-SW
  8941                                         WS-LETTER-SW.
  8942
  8943 7100-EXIT.
  8944     EXIT.
  8945
  8946 7150-CREATE-AUTO-LETTER.
  8947
  8948     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
  8949     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
  8950
  8951     IF TERMI IS EQUAL TO 'A'
  8952         IF WS-LETTER-FORM-NUM > SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 173
* EL154.cbl
  8953            MOVE WS-LETTER-FORM-NUM     TO  W-1523-FORM-NUMBER
  8954         ELSE
  8955         MOVE CF-SYS-LETTER-ID (5)   TO  W-1523-FORM-NUMBER
  8956         END-IF
  8957     ELSE
  8958         IF WS-END-LETTER-FORM-NUM > SPACES
  8959             MOVE WS-END-LETTER-FORM-NUM TO W-1523-FORM-NUMBER
  8960         ELSE
  8961         MOVE CF-SYS-LETTER-ID (6)   TO  W-1523-FORM-NUMBER.
  8962
  8963     IF TERMI IS EQUAL TO 'A'
  8964       IF CF-SYS-RESEND-DAYS (5) IS NOT EQUAL TO ZEROS
  8965         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8966         MOVE '6'                    TO  DC-OPTION-CODE
  8967         MOVE CF-SYS-RESEND-DAYS (5) TO  DC-ELAPSED-DAYS
  8968         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8969         PERFORM 9700-DATE-LINK
  8970         IF NO-CONVERSION-ERROR
  8971             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8972         ELSE
  8973             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8974
  8975
  8976     IF TERMI IS EQUAL TO 'A'
  8977       IF CF-SYS-FOLLOW-UP-DAYS (5) IS NOT EQUAL TO ZEROS
  8978         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8979         MOVE '6'                    TO  DC-OPTION-CODE
  8980         MOVE CF-SYS-FOLLOW-UP-DAYS (5)  TO  DC-ELAPSED-DAYS
  8981         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8982         PERFORM 9700-DATE-LINK
  8983         IF NO-CONVERSION-ERROR
  8984             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8985         ELSE
  8986             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8987
  8988     IF TERMI IS EQUAL TO 'Y'
  8989       IF CF-SYS-RESEND-DAYS (6) IS NOT EQUAL TO ZEROS
  8990         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8991         MOVE '6'                    TO  DC-OPTION-CODE
  8992         MOVE CF-SYS-RESEND-DAYS (6) TO  DC-ELAPSED-DAYS
  8993         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8994         PERFORM 9700-DATE-LINK
  8995         IF NO-CONVERSION-ERROR
  8996             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8997         ELSE
  8998             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8999
  9000
  9001     IF TERMI IS EQUAL TO 'Y'
  9002       IF CF-SYS-FOLLOW-UP-DAYS (6) IS NOT EQUAL TO ZEROS
  9003         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  9004         MOVE '6'                    TO  DC-OPTION-CODE
  9005         MOVE CF-SYS-FOLLOW-UP-DAYS (6)  TO  DC-ELAPSED-DAYS
  9006         MOVE +0                     TO  DC-ELAPSED-MONTHS
  9007         PERFORM 9700-DATE-LINK
  9008         IF NO-CONVERSION-ERROR
  9009             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  9010         ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 174
* EL154.cbl
  9011             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  9012
  9013     MOVE LETTDTE-SAVE               TO W-1523-LETTER-DATE.
  9014
  9015
  9016* EXEC CICS LINK
  9017*        PROGRAM    (LINK-1523)
  9018*        COMMAREA   (W-1523-LINKDATA)
  9019*        LENGTH     (W-1523-COMM-LENGTH)
  9020*    END-EXEC.
  9021*    MOVE '."C                   (   #00008405' TO DFHEIV0
  9022     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9024     MOVE X'2020233030303038343035' TO DFHEIV0(25:11)
  9025     CALL 'kxdfhei1' USING DFHEIV0,
  9026           LINK-1523,
  9027           W-1523-LINKDATA,
  9028           W-1523-COMM-LENGTH,
  9029           DFHEIV99,
  9030           DFHEIV99,
  9031           DFHEIV99,
  9032           DFHEIV99
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9034
  9035
  9036     IF W-1523-ERROR-CODE IS EQUAL TO ZEROS
  9037         GO TO 7150-EXIT.
  9038
  9039     IF W-1523-FATAL-ERROR
  9040         MOVE ER-0802                TO  EMI-ERROR
  9041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9042         GO TO 7150-EXIT.
  9043
  9044     IF W-1523-ERROR-CODE IS EQUAL TO 0191
  9045         MOVE ER-0803                TO  EMI-ERROR
  9046         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9047
  9048 7150-EXIT.
  9049     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 175
* EL154.cbl
  9051 7200-LOCATE-BENEFIT.
  9052     MOVE SPACES TO WS-BENEFIT-FOUND-SW.
  9053
  9054
  9055* EXEC CICS HANDLE CONDITION
  9056*        ENDFILE(7200-EXIT)
  9057*        NOTFND(7200-EXIT)
  9058*        END-EXEC.
  9059*    MOVE '"$''I                  ! 0 #00008429' TO DFHEIV0
  9060     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9062     MOVE X'3020233030303038343239' TO DFHEIV0(25:11)
  9063     CALL 'kxdfhei1' USING DFHEIV0
  9064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9065
  9066
  9067
  9068* EXEC CICS READ
  9069*        DATASET(CNTL-ID)
  9070*        SET(ADDRESS OF CONTROL-FILE)
  9071*        RIDFLD(CNTL-KEY)
  9072*        GTEQ
  9073*        END-EXEC.
  9074*    MOVE '&"S        G          (   #00008434' TO DFHEIV0
  9075     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9077     MOVE X'2020233030303038343334' TO DFHEIV0(25:11)
  9078     CALL 'kxdfhei1' USING DFHEIV0,
  9079           CNTL-ID,
  9080           DFHEIV20,
  9081           DFHEIV99,
  9082           CNTL-KEY,
  9083           DFHEIV99,
  9084           DFHEIV99,
  9085           DFHEIV99
  9086     SET ADDRESS OF CONTROL-FILE TO
  9087         DFHEIV20
  9088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9089
  9090
  9091     IF (CNTL-CO NOT = CF-COMPANY-ID)   OR
  9092        (CNTL-RECORD-TYPE NOT = CF-RECORD-TYPE)
  9093           GO TO 7200-EXIT.
  9094
  9095     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  9096         VARYING SUB-1 FROM 1 BY 1 UNTIL
  9097            ((SUB-1 GREATER 8) OR
  9098            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  9099
  9100     IF SUB-1 NOT = 9
  9101         MOVE 'Y' TO WS-BENEFIT-FOUND-SW.
  9102
  9103     GO TO 7200-EXIT.
  9104
  9105 7200-BENEFIT-DUMMY.
  9106
  9107 7200-DUMMY-EXIT.
  9108     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 176
* EL154.cbl
  9109
  9110 7200-EXIT.
  9111     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 177
* EL154.cbl
  9113 8100-SEND-INITIAL-MAP.
  9114     MOVE CURRENT-GREG-DATE      TO RUNDTEO.
  9115     MOVE EIBTIME                TO TIME-IN.
  9116     MOVE TIME-OUT               TO RUNTIMEO.
  9117     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  9118     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  9119
  9120     IF PI-USES-PAID-TO
  9121         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  9122                                     FSTHD2O
  9123         MOVE LAST-PMT-HD2       TO  LSTHD1O
  9124         MOVE LAST-PMT-HD4       TO  LSTHD2O
  9125     ELSE
  9126         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  9127                                     FSTHD2O
  9128         MOVE LAST-PMT-HD1       TO  LSTHD1O
  9129         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  9130
  9131
  9132* EXEC CICS SEND
  9133*        MAP(MAP-NAME)
  9134*        MAPSET(MAPSET-NAME)
  9135*        FROM(EL154AO)
  9136*        ERASE
  9137*        CURSOR
  9138*        END-EXEC.
  9139     MOVE LENGTH OF
  9140      EL154AO
  9141       TO DFHEIV12
  9142     MOVE -1
  9143       TO DFHEIV11
  9144*    MOVE '8$     CT  E    H L F ,   #00008481' TO DFHEIV0
  9145     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9146     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9147     MOVE X'2020233030303038343831' TO DFHEIV0(25:11)
  9148     CALL 'kxdfhei1' USING DFHEIV0,
  9149           MAP-NAME,
  9150           EL154AO,
  9151           DFHEIV12,
  9152           MAPSET-NAME,
  9153           DFHEIV99,
  9154           DFHEIV99,
  9155           DFHEIV99,
  9156           DFHEIV11,
  9157           DFHEIV99,
  9158           DFHEIV99,
  9159           DFHEIV99
  9160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9161
  9162
  9163     MOVE 'EL154   ' TO PI-CALLING-PROGRAM.
  9164     GO TO 9100-RETURN-TRAN.
  9165
  9166 8200-SEND-DATAONLY.
  9167     MOVE CURRENT-GREG-DATE TO RUNDTEO.
  9168     MOVE EIBTIME           TO TIME-IN.
  9169     MOVE TIME-OUT          TO RUNTIMEO.
  9170     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 178
* EL154.cbl
  9171     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  9172
  9173     IF PI-USES-PAID-TO
  9174         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  9175                                     FSTHD2O
  9176         MOVE LAST-PMT-HD2       TO  LSTHD1O
  9177         MOVE LAST-PMT-HD4       TO  LSTHD2O
  9178     ELSE
  9179         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  9180                                     FSTHD2O
  9181         MOVE LAST-PMT-HD1       TO  LSTHD1O
  9182         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  9183
  9184
  9185* EXEC CICS SEND
  9186*        MAP(MAP-NAME)
  9187*        MAPSET(MAPSET-NAME)
  9188*        FROM(EL154AO)
  9189*        DATAONLY
  9190*        ERASEAUP
  9191*        CURSOR
  9192*        END-EXEC.
  9193     MOVE LENGTH OF
  9194      EL154AO
  9195       TO DFHEIV12
  9196     MOVE -1
  9197       TO DFHEIV11
  9198*    MOVE '8$D    CT  A    H L F ,   #00008510' TO DFHEIV0
  9199     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9200     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9201     MOVE X'2020233030303038353130' TO DFHEIV0(25:11)
  9202     CALL 'kxdfhei1' USING DFHEIV0,
  9203           MAP-NAME,
  9204           EL154AO,
  9205           DFHEIV12,
  9206           MAPSET-NAME,
  9207           DFHEIV99,
  9208           DFHEIV99,
  9209           DFHEIV99,
  9210           DFHEIV11,
  9211           DFHEIV99,
  9212           DFHEIV99,
  9213           DFHEIV99
  9214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9215
  9216
  9217     GO TO 9100-RETURN-TRAN.
  9218
  9219 8300-SEND-TEXT.
  9220
  9221* EXEC CICS SEND TEXT
  9222*        FROM(LOGOFF-TEXT)
  9223*        LENGTH(LOGOFF-LENGTH)
  9224*        ERASE
  9225*        FREEKB
  9226*        END-EXEC.
  9227*    MOVE '8&      T  E F  H   F -   #00008522' TO DFHEIV0
  9228     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 179
* EL154.cbl
  9229     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9230     MOVE X'2020233030303038353232' TO DFHEIV0(25:11)
  9231     CALL 'kxdfhei1' USING DFHEIV0,
  9232           LOGOFF-TEXT,
  9233           LOGOFF-LENGTH,
  9234           DFHEIV99,
  9235           DFHEIV99,
  9236           DFHEIV99,
  9237           DFHEIV99,
  9238           DFHEIV99,
  9239           DFHEIV99,
  9240           DFHEIV99,
  9241           DFHEIV99,
  9242           DFHEIV99,
  9243           DFHEIV99
  9244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9245
  9246
  9247
  9248* EXEC CICS RETURN
  9249*        END-EXEC.
  9250*    MOVE '.(                    ''   #00008529' TO DFHEIV0
  9251     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9252     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9253     MOVE X'2020233030303038353239' TO DFHEIV0(25:11)
  9254     CALL 'kxdfhei1' USING DFHEIV0,
  9255           DFHEIV99,
  9256           DFHEIV99,
  9257           DFHEIV99,
  9258           DFHEIV99,
  9259           DFHEIV99,
  9260           DFHEIV99
  9261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9262
  9263
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 180
* EL154.cbl
  9265 8600-DEEDIT.
  9266
  9267* EXEC CICS BIF DEEDIT
  9268*         FIELD(DEEDIT-FIELD)
  9269*         LENGTH(15)
  9270*         END-EXEC.
  9271     MOVE 15
  9272       TO DFHEIV11
  9273*    MOVE '@"L                   #   #00008534' TO DFHEIV0
  9274     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9275     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9276     MOVE X'2020233030303038353334' TO DFHEIV0(25:11)
  9277     CALL 'kxdfhei1' USING DFHEIV0,
  9278           DEEDIT-FIELD,
  9279           DFHEIV11
  9280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9281
  9282
  9283 8800-UNAUTHORIZED-ACCESS.
  9284     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  9285     GO TO 8300-SEND-TEXT.
  9286
  9287 8810-PF23.
  9288     MOVE EIBAID TO PI-ENTRY-CD-1.
  9289     MOVE XCTL-005 TO PGM-NAME.
  9290     GO TO 9300-XCTL.
  9291
  9292
  9293 8850-CLAM-END-FILE.
  9294     MOVE -1                     TO  ENTERPFL.
  9295     MOVE ER-0130 TO EMI-ERROR.
  9296     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9297     GO TO 8200-SEND-DATAONLY.
  9298
  9299 8860-CLAM-NOT-OPEN.
  9300     MOVE -1                     TO  ENTERPFL.
  9301     MOVE ER-0154 TO EMI-ERROR.
  9302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9303     GO TO 8200-SEND-DATAONLY.
  9304
  9305 8870-ACTV-NOT-OPEN.
  9306     MOVE -1                     TO  ENTERPFL.
  9307     MOVE ER-0172 TO EMI-ERROR.
  9308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309     GO TO 8200-SEND-DATAONLY.
  9310
  9311 8880-CERT-NOT-OPEN.
  9312     MOVE -1                     TO  ENTERPFL.
  9313     MOVE ER-0169                TO EMI-ERROR.
  9314     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9315     GO TO 8200-SEND-DATAONLY.
  9316
  9317 8885-EMPLCY-NOT-OPEN.
  9318     MOVE -1                     TO  ENTERPFL.
  9319     MOVE ER-9883                TO  EMI-ERROR.
  9320     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9321     GO TO 8200-SEND-DATAONLY.
  9322
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 181
* EL154.cbl
  9323 8890-CNTL-NOT-OPEN.
  9324     MOVE -1                     TO  ENTERPFL.
  9325     MOVE ER-0042                TO EMI-ERROR.
  9326     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9327     GO TO 8200-SEND-DATAONLY.
  9328
  9329 9000-RETURN-CICS.
  9330
  9331* EXEC CICS RETURN
  9332*        END-EXEC.
  9333*    MOVE '.(                    ''   #00008586' TO DFHEIV0
  9334     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9336     MOVE X'2020233030303038353836' TO DFHEIV0(25:11)
  9337     CALL 'kxdfhei1' USING DFHEIV0,
  9338           DFHEIV99,
  9339           DFHEIV99,
  9340           DFHEIV99,
  9341           DFHEIV99,
  9342           DFHEIV99,
  9343           DFHEIV99
  9344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9345
  9346
  9347 9100-RETURN-TRAN.
  9348     MOVE    EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  9349     MOVE '154A' TO PI-CURRENT-SCREEN-NO.
  9350
  9351* EXEC CICS RETURN
  9352*        TRANSID(TRANS-ID)
  9353*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9354*        LENGTH(PI-COMM-LENGTH)
  9355*        END-EXEC.
  9356*    MOVE '.(CT                  ''   #00008592' TO DFHEIV0
  9357     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9358     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9359     MOVE X'2020233030303038353932' TO DFHEIV0(25:11)
  9360     CALL 'kxdfhei1' USING DFHEIV0,
  9361           TRANS-ID,
  9362           PROGRAM-INTERFACE-BLOCK,
  9363           PI-COMM-LENGTH,
  9364           DFHEIV99,
  9365           DFHEIV99,
  9366           DFHEIV99
  9367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9368
  9369
  9370 9200-RETURN-MAIN-MENU.
  9371     MOVE XCTL-126 TO PGM-NAME.
  9372     GO TO 9300-XCTL.
  9373
  9374 9300-XCTL.
  9375
  9376* EXEC CICS XCTL
  9377*        PROGRAM(PGM-NAME)
  9378*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9379*        LENGTH(PI-COMM-LENGTH)
  9380*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 182
* EL154.cbl
  9381*    MOVE '.$C                   %   #00008603' TO DFHEIV0
  9382     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9383     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9384     MOVE X'2020233030303038363033' TO DFHEIV0(25:11)
  9385     CALL 'kxdfhei1' USING DFHEIV0,
  9386           PGM-NAME,
  9387           PROGRAM-INTERFACE-BLOCK,
  9388           PI-COMM-LENGTH,
  9389           DFHEIV99
  9390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9391
  9392
  9393 9400-CLEAR.
  9394     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  9395     GO TO 9300-XCTL.
  9396
  9397 9500-PF12.
  9398     MOVE XCTL-010 TO PGM-NAME.
  9399     GO TO 9300-XCTL.
  9400
  9401 9600-PGMID-ERROR.
  9402
  9403* EXEC CICS HANDLE CONDITION
  9404*        PGMIDERR(8300-SEND-TEXT)
  9405*        END-EXEC.
  9406*    MOVE '"$L                   ! 1 #00008618' TO DFHEIV0
  9407     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9409     MOVE X'3120233030303038363138' TO DFHEIV0(25:11)
  9410     CALL 'kxdfhei1' USING DFHEIV0
  9411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9412
  9413
  9414     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  9415     MOVE ' '          TO PI-ENTRY-CD-1.
  9416     MOVE XCTL-005     TO PGM-NAME.
  9417     MOVE PGM-NAME     TO LOGOFF-PGM.
  9418     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  9419     GO TO 9300-XCTL.
  9420
  9421 9700-DATE-LINK.
  9422     MOVE LINK-ELDATCV TO PGM-NAME
  9423
  9424* EXEC CICS LINK
  9425*        PROGRAM    (PGM-NAME)
  9426*        COMMAREA   (DATE-CONVERSION-DATA)
  9427*        LENGTH     (DC-COMM-LENGTH)
  9428*        END-EXEC.
  9429*    MOVE '."C                   (   #00008631' TO DFHEIV0
  9430     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9432     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  9433     CALL 'kxdfhei1' USING DFHEIV0,
  9434           PGM-NAME,
  9435           DATE-CONVERSION-DATA,
  9436           DC-COMM-LENGTH,
  9437           DFHEIV99,
  9438           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 183
* EL154.cbl
  9439           DFHEIV99,
  9440           DFHEIV99
  9441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9442
  9443
  9444 9900-ERROR-FORMAT.
  9445     IF NOT EMI-ERRORS-COMPLETE
  9446         MOVE LINK-001 TO PGM-NAME
  9447
  9448* EXEC CICS LINK
  9449*            PROGRAM(PGM-NAME)
  9450*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  9451*            LENGTH(EMI-COMM-LENGTH)
  9452*            END-EXEC.
  9453*    MOVE '."C                   (   #00008640' TO DFHEIV0
  9454     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9456     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
  9457     CALL 'kxdfhei1' USING DFHEIV0,
  9458           PGM-NAME,
  9459           ERROR-MESSAGE-INTERFACE-BLOCK,
  9460           EMI-COMM-LENGTH,
  9461           DFHEIV99,
  9462           DFHEIV99,
  9463           DFHEIV99,
  9464           DFHEIV99
  9465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9466
  9467
  9468 9900-EXIT.
  9469     EXIT.
  9470
  9471 9990-ABEND.
  9472     MOVE LINK-004 TO PGM-NAME.
  9473     MOVE DFHEIBLK TO EMI-LINE1.
  9474
  9475* EXEC CICS LINK
  9476*        PROGRAM(PGM-NAME)
  9477*        COMMAREA(EMI-LINE1)
  9478*        LENGTH(72)
  9479*        END-EXEC.
  9480     MOVE 72
  9481       TO DFHEIV11
  9482*    MOVE '."C                   (   #00008652' TO DFHEIV0
  9483     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9485     MOVE X'2020233030303038363532' TO DFHEIV0(25:11)
  9486     CALL 'kxdfhei1' USING DFHEIV0,
  9487           PGM-NAME,
  9488           EMI-LINE1,
  9489           DFHEIV11,
  9490           DFHEIV99,
  9491           DFHEIV99,
  9492           DFHEIV99,
  9493           DFHEIV99
  9494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9495
  9496
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 184
* EL154.cbl
  9497     GO TO 8200-SEND-DATAONLY.
  9498
  9499* GOBACK.
  9500     MOVE '9%                    "   ' TO DFHEIV0
  9501     MOVE 'EL154' TO DFHEIV1
  9502     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9503     GOBACK.
  9504
  9505 9995-SECURITY-VIOLATION.
  9506*                            COPY ELCSCTP.
  9507******************************************************************
  9508*                                                                *
  9509*                            ELCSCTP                             *
  9510*                            VMOD=2.001                          *
  9511*                                                                *
  9512*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9513******************************************************************
  9514
  9515
  9516     MOVE EIBDATE          TO SM-JUL-DATE.
  9517     MOVE EIBTRMID         TO SM-TERMID.
  9518     MOVE THIS-PGM         TO SM-PGM.
  9519     MOVE EIBTIME          TO TIME-IN.
  9520     MOVE TIME-OUT         TO SM-TIME.
  9521     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9522
  9523
  9524* EXEC CICS LINK
  9525*         PROGRAM  ('EL003')
  9526*         COMMAREA (SECURITY-MESSAGE)
  9527*         LENGTH   (80)
  9528*    END-EXEC.
  9529     MOVE 'EL003' TO DFHEIV1
  9530     MOVE 80
  9531       TO DFHEIV11
  9532*    MOVE '."C                   (   #00008679' TO DFHEIV0
  9533     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9534     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9535     MOVE X'2020233030303038363739' TO DFHEIV0(25:11)
  9536     CALL 'kxdfhei1' USING DFHEIV0,
  9537           DFHEIV1,
  9538           SECURITY-MESSAGE,
  9539           DFHEIV11,
  9540           DFHEIV99,
  9541           DFHEIV99,
  9542           DFHEIV99,
  9543           DFHEIV99
  9544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9545
  9546
  9547******************************************************************
  9548
  9549
  9550 9995-EXIT.
  9551     EXIT.
  9552
  9553
  9554 9999-DFHBACK SECTION.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 185
* EL154.cbl
  9555     MOVE '9%                    "   ' TO DFHEIV0
  9556     MOVE 'EL154' TO DFHEIV1
  9557     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9558     GOBACK.
  9559 9999-DFHEXIT.
  9560     IF DFHEIGDJ EQUAL 0001
  9561         NEXT SENTENCE
  9562     ELSE IF DFHEIGDJ EQUAL 2
  9563         GO TO 8860-CLAM-NOT-OPEN,
  9564               9600-PGMID-ERROR,
  9565               9990-ABEND
  9566         DEPENDING ON DFHEIGDI
  9567     ELSE IF DFHEIGDJ EQUAL 3
  9568         GO TO 8850-CLAM-END-FILE,
  9569               8850-CLAM-END-FILE
  9570         DEPENDING ON DFHEIGDI
  9571     ELSE IF DFHEIGDJ EQUAL 4
  9572         GO TO 8850-CLAM-END-FILE,
  9573               8850-CLAM-END-FILE
  9574         DEPENDING ON DFHEIGDI
  9575     ELSE IF DFHEIGDJ EQUAL 5
  9576         GO TO 8870-ACTV-NOT-OPEN
  9577         DEPENDING ON DFHEIGDI
  9578     ELSE IF DFHEIGDJ EQUAL 6
  9579         GO TO 8870-ACTV-NOT-OPEN,
  9580               4099-EXIT
  9581         DEPENDING ON DFHEIGDI
  9582     ELSE IF DFHEIGDJ EQUAL 7
  9583         GO TO 9999-DFHBACK
  9584         DEPENDING ON DFHEIGDI
  9585     ELSE IF DFHEIGDJ EQUAL 8
  9586         GO TO 6150-READ-CARRIER,
  9587               8890-CNTL-NOT-OPEN
  9588         DEPENDING ON DFHEIGDI
  9589     ELSE IF DFHEIGDJ EQUAL 9
  9590         GO TO 6180-READ-CERT
  9591         DEPENDING ON DFHEIGDI
  9592     ELSE IF DFHEIGDJ EQUAL 10
  9593         GO TO 8880-CERT-NOT-OPEN,
  9594               6185-CERT-NOT-FOUND
  9595         DEPENDING ON DFHEIGDI
  9596     ELSE IF DFHEIGDJ EQUAL 11
  9597         GO TO 8885-EMPLCY-NOT-OPEN,
  9598               6195-EMPLCY-NOT-FOUND
  9599         DEPENDING ON DFHEIGDI
  9600     ELSE IF DFHEIGDJ EQUAL 12
  9601         GO TO 6250-ADDR-ERROR
  9602         DEPENDING ON DFHEIGDI
  9603     ELSE IF DFHEIGDJ EQUAL 13
  9604         GO TO 8860-CLAM-NOT-OPEN,
  9605               7090-CLAIM-NOT-FOUND
  9606         DEPENDING ON DFHEIGDI
  9607     ELSE IF DFHEIGDJ EQUAL 14
  9608         GO TO 8870-ACTV-NOT-OPEN,
  9609               7080-NO-TRAILER
  9610         DEPENDING ON DFHEIGDI
  9611     ELSE IF DFHEIGDJ EQUAL 15
  9612         GO TO 7100-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 11:32 Page 186
* EL154.cbl
  9613         DEPENDING ON DFHEIGDI
  9614     ELSE IF DFHEIGDJ EQUAL 16
  9615         GO TO 7200-EXIT,
  9616               7200-EXIT
  9617         DEPENDING ON DFHEIGDI
  9618     ELSE IF DFHEIGDJ EQUAL 17
  9619         GO TO 8300-SEND-TEXT
  9620         DEPENDING ON DFHEIGDI.
  9621     MOVE '9%                    "   ' TO DFHEIV0
  9622     MOVE 'EL154' TO DFHEIV1
  9623     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9624     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6548     Code:       19444
