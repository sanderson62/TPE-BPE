* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31* 092215  IR2015092200001  PEMA  modify determination of manual ch
    32* 091615  CR2015082000001  PEMA  Add Endorsement check processing
    33* 020816  IR2016020500001  PEMA  Add env to unikix cmd for cid1p
    34 environment division.
    35 INPUT-OUTPUT SECTION.
    36 FILE-CONTROL.
    37 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    38    FILE STATUS IS WRITTEN-STATUS
    39                            ORGANIZATION IS LINE SEQUENTIAL.
    40 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    41    FILE STATUS IS WRITRPT-STATUS
    42                            ORGANIZATION IS LINE SEQUENTIAL.
    43 data division.
    44 FILE SECTION.
    45 FD  CPS-WRITTEN-IN
    46     BLOCK CONTAINS 0
    47     RECORDING MODE F.
    48 01  CPS-WRITTEN-IN-REC          pic x(200).
    49 FD  CPS-WRITTEN-RPT
    50     BLOCK CONTAINS 0
    51     RECORDING MODE F.
    52 01  CPS-WRITTEN-RPT-REC         pic x(132).
    53 working-storage section.
    54 01  DFH-START PIC X(04).
    55 77  ws-process-sw               pic x value ' '.
    56     88  process-cashed            value 'C'.
    57     88  process-written           value 'W'.
    58 77  ws-writ-cnt                 pic 9(5) value zeros.
    59 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    60 77  s1                          pic s999 comp-3 value +0.
    61 77  s2                          pic s999 comp-3 value +0.
    62 77  i1                          pic s999 comp-3 value +0.
    63 77  o1                          pic s999 comp-3 value +0.
    64 77  ws-bin-cashed-dt            pic xx  value low-values.
    65 77  ws-bin-check-dt             pic xx  value low-values.
    66 77  ws-page-cntr                pic 999  value zeros.
    67 77  ws-line-cntr                pic 999  value 070.
    68 77  ws-max-lines                pic 999  value 060.
    69 77  ws-erchek-sw                pic x    value spaces.
    70     88  erchek-found              value 'Y'.
    71 77  ws-table-sw                 pic x    value spaces.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   3
* EL201.cbl
    72     88  table-found               value 'Y'.
    73 77  ws-continue-sw              pic x  value 'Y'.
    74     88  ok-to-continue            value 'Y'.
    75     88  not-ok-to-continue        value 'N'.
    76 77  ws-in-recs                  pic 9(5) value zeros.
    77 77  ws-eof-sw                   pic x  value spaces.
    78     88  end-of-input                  value 'Y'.
    79 77  ws-sql-code                 pic s9(7) value zeros.
    80 77  ws-dis-sql-code             pic -9999999 value zeros.
    81 01  ws-work-dynamic.
    82     05  ws-work-dir             pic x(27) value spaces.
    83     05  ws-work-env             pic x(8)  value spaces.
    84     05  ws-work-comp-id         pic xxx   value spaces.
    85     05  ws-work-file-in         pic x(16) value spaces.
    86     05  ws-work-rpt-out         pic x(13) value spaces.
    87     05  ws-work-job-name        pic x(8)  value spaces.
    88 01  ws-written-in               pic x(58).
    89 01  ws-written-rpt              pic x(58).
    90 01  P pointer.
    91 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    92 01  var-ptr pointer.
    93 01  env-var-len                 pic 9(4)  binary.
    94 01  rc                          pic 9(9)  binary.
    95
    96 01  WS-KIXSYS.
    97     05  WS-KIX-FIL1             PIC X(10).
    98     05  WS-KIX-APPS             PIC X(10).
    99     05  WS-KIX-ENV              PIC X(10).
   100     05  WS-KIX-MYENV            PIC X(10).
   101     05  WS-KIX-SYS              PIC X(10).
*  102 EXEC SQL
*  103    INCLUDE SQLDA
*  104 END-EXEC
   105 01 SQLDA sync.
   106    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   107    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   108    05 SQLN                  PIC S9(4) COMP-5 value 0.
   109    05 SQLD                  PIC S9(4) COMP-5 value 0.
   110    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   111       10 SQLTYPE            PIC S9(4) COMP-5.
   112       10 SQLLEN             PIC S9(4) COMP-5.
   113$IF P64 SET
   114X      *> For 64-bit environments, ensure that SQLDATA is
   115X      *> aligned on an 8-byte boundary.
   116X      10 FILLER             PIC S9(9) COMP-5.
   117$END
   118       10 SQLDATA            USAGE POINTER.
   119       10 SQLIND             USAGE POINTER.
   120       10 SQLNAME.
   121          15 SQLNAMEL        PIC S9(4) COMP-5.
   122          15 SQLNAMEC        PIC X(30).
   123
   124* Values for SQLTYPE
   125
   126 78  ESQL-DATE-CHAR              VALUE 384.
   127 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   128 78  ESQL-DATE-REC               VALUE 386.
   129 78  ESQL-DATE-REC-NULL          VALUE 387.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TIME-CHAR              VALUE 388.
   131 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   132 78  ESQL-TIME-REC               VALUE 390.
   133 78  ESQL-TIME-REC-NULL          VALUE 391.
   134 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   135 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   136 78  ESQL-TIMESTAMP-REC          VALUE 394.
   137 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   138 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   139 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   140 78  ESQL-TS-OFFSET-REC          VALUE 398.
   141 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   142 78  ESQL-LONGVARBINARY          VALUE 404.
   143 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   144 78  ESQL-LONGVARCHAR            VALUE 408.
   145 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   146 78  ESQL-BINARY                 VALUE 444.
   147 78  ESQL-BINARY-NULL            VALUE 445.
   148 78  ESQL-VARBINARY              VALUE 446.
   149 78  ESQL-VARBINARY-NULL         VALUE 447.
   150 78  ESQL-VARCHAR                VALUE 448.
   151 78  ESQL-VARCHAR-NULL           VALUE 449.
   152
   153 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   154 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   155
   156 78  ESQL-CHAR                   VALUE 452.
   157 78  ESQL-CHAR-NULL              VALUE 453.
   158
   159 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   160 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   161
   162 78  ESQL-DOUBLE                 VALUE 480.
   163 78  ESQL-DOUBLE-NULL            VALUE 481.
   164 78  ESQL-REAL                   VALUE 482.
   165 78  ESQL-REAL-NULL              VALUE 483.
   166 78  ESQL-DECIMAL                VALUE 484.
   167 78  ESQL-DECIMAL-NULL           VALUE 485.
   168 78  ESQL-INTEGER                VALUE 496.
   169 78  ESQL-INTEGER-NULL           VALUE 497.
   170 78  ESQL-SMALLINT               VALUE 500.
   171 78  ESQL-SMALLINT-NULL          VALUE 501.
   172 78  ESQL-TINYINT                VALUE 502.
   173 78  ESQL-TINYINT-NULL           VALUE 503.
*  174 EXEC SQL
*  175    INCLUDE SQLCA
*  176 END-EXEC
   177 01 SQLCA.
   178     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   179     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   180     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   181     05  SQLERRM.
   182         49  SQLERRML    PIC S9(4) COMP-5.
   183         49  SQLERRMC    PIC X(70).
   184     05  SQLERRP         PIC X(8).
   185     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   186     05  SQLWARN.
   187         10  SQLWARN0    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN1    PIC X.
   189         10  SQLWARN2    PIC X.
   190         10  SQLWARN3    PIC X.
   191         10  SQLWARN4    PIC X.
   192         10  SQLWARN5    PIC X.
   193         10  SQLWARN6    PIC X.
   194         10  SQLWARN7    PIC X.
   195     05  SQLEXT.
   196         10  SQLWARN8    PIC X.
   197         10  SQLWARN9    PIC X.
   198         10  SQLWARN10   PIC X.
   199         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   200     05  SQLSTATE    PIC X(5).
   201 EXEC SQL
   202    BEGIN DECLARE SECTION
   203 END-EXEC
   204 01  ws-key-stuff.
   205     05  ws-check-key            pic 9(7).
   206     05  ws-check-no             pic x(7).
   207     05  ws-compid               pic xxx.
   208     05  ws-carrier              pic x.
   209     05  ws-grouping             pic x(6).
   210     05  ws-state                pic xx.
   211     05  ws-account              pic x(10).
   212     05  ws-eff-date             pic x(10).
   213     05  ws-certificate          pic x(10).
   214     05  ws-cert-sfx             pic x.
   215     05  ws-seq-no               pic 999.
   216     05  ws-type                 pic 999.
   217 01  sqlcmd                      pic x(1024).
   218 01  WS-MOE-DATE                 pic x(10).
   219 01  svr                         pic x(32).
   220 01  usr                         pic x(32).
   221 01  pass                        pic x(32).
   222 01  usr-pass                    pic x(64).
   223 01  ws-disp-code                pic s9(11).
   224***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   225***                                                            ***
   226***  These indicators are used to determine if a variable      ***
   227***  is passed nulls from sql. The indicator will be -1        ***
   228***  if the value on sql is nulls and +0 if the value is       ***
   229***  something other than nulls. Here is an example on how     ***
   230***  to use the indicator variables.                           ***
   231***                                                            ***
   232***     EXEC SQL                                               ***
   233***        fetch checkapp into                                 ***
   234***           :db-app-status :nu-app-status,                   ***
   235***           :db-app-by     :nu-app-by,                       ***
   236***           :db-app-date   :nu-app-date,                     ***
   237***           :db-app-batch  :nu-app-batch                     ***
   238***     END-EXEC                                               ***
   239***                                                            ***
   240***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   241 01  indicator-vaiables-for-nulls.
   242     05  nu-app-status           pic s9(4) comp value +0.
   243     05  nu-app-by               pic s9(4) comp value +0.
   244     05  nu-app-date             pic s9(4) comp value +0.
   245     05  nu-app-batch            pic s9(4) comp value +0.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   6
* EL201.cbl
   246     05  nu-fincar               pic s9(4) comp value +0.
   247     05  nu-checkno              pic s9(4) comp value +0.
   248 01  daily-check-request-rec.
   249     05  db-checkkey             pic x(7).
   250     05  db-compid               pic xxx.
   251     05  db-carrier              pic x.
   252     05  db-grouping             pic x(6).
   253     05  db-state                pic xx.
   254     05  db-account              pic x(10).
   255     05  db-effdate              pic x(24).
   256     05  db-certificate          pic x(10).
   257     05  db-cert-sfx             pic x.
   258     05  db-seq-no               pic x(7).
   259     05  db-type                 pic x(7).
   260     05  db-amount               pic x(10).
   261     05  db-amount-n redefines
   262         db-amount               pic 9(7).99.
   263     05  db-checkno              pic x(15).
   264     05  db-checkdate            pic x(10).
   265     05  db-checkstatus          pic 9(5).
   266     05  db-releasebatch         pic 9(5).
   267     05  db-releasedt            pic x(10).
   268     05  db-releaseby            pic x(4).
   269     05  db-payeename1           pic x(30).
   270     05  db-payeename2           pic x(30).
   271     05  db-payeeaddr1           pic x(30).
   272     05  db-payeeaddr2           pic x(30).
   273     05  db-payeecity            pic x(30).
   274     05  db-payeest              pic xx.
   275     05  db-payeezip             pic x(10).
   276     05  db-fincar               pic x.
   277     05  db-fingrp               pic x(6).
   278     05  db-finresp              pic x(10).
   279     05  db-finacct              pic x(10).
   280     05  db-preparer             pic x(4).
   281     05  db-app-status           pic x(9).
   282     05  dp-app-status-n redefines db-app-status
   283                                 pic 9(9).
   284     05  db-app-by               pic x(20).
   285     05  db-app-date             pic x(30).
   286     05  db-app-batch            pic x(10).
   287     05  db-return-to            pic x(30).
   288     05  db-check-sub-type       pic x.
   289 EXEC SQL
   290    END DECLARE SECTION
   291 END-EXEC
   292 01  FILE-KEYS.
   293     12  ELCNTL-KEY.
   294         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   295         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   296         16 ELCNTL-ACCESS.
   297             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   298             20  FILLER              PIC X       VALUE SPACES.
   299             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   300         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   301 01  f.
   302     05  ws-connect-sw               pic x  value ' '.
   303         88  connected-to-db             value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   7
* EL201.cbl
   304     05  written-status          pic xx.
   305     05  writrpt-status          pic xx.
   306     05  ws-comp-id              pic xxx.
   307     05  ws-comp-cd              pic x.
   308 01  ws-raw-record.
   309     05  raw-check-no            pic x(20).
   310     05  raw-check-dt            pic x(20).
   311     05  raw-check-amt           pic x(15).
   312     05  raw-vendor-id           pic x(20).
   313     05  raw-user-defined        pic x(30).
   314     05  raw-voucher-ref         pic x(35).
   315 01  ws-written-rec.
   316     05  wsw-check-no            pic x(20).
   317     05  wsw-check-dt            pic x(20).
   318     05  wsw-check-amt           pic x(15).
   319     05  wsw-vendor-id           pic x(20).
   320     05  wsw-user-defined        pic x(30).
   321     05  wsw-voucher-ref         pic x(35).
   322 01  filler.
   323     05  wsw-check-key           pic x(7).
   324     05  wsw-check-key-num redefines wsw-check-key
   325                                 pic 9(7).
   326 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   327     88  RESP-NORMAL                    VALUE +0.
   328     88  resp-file-notfnd               value +12.
   329     88  RESP-NOTFND                    VALUE +13.
   330     88  resp-duprec                    value +14.
   331     88  resp-dupkey                    value +15.
   332     88  resp-invreq                    value +16.
   333     88  RESP-NOTOPEN                   VALUE +19.
   334     88  RESP-ENDFILE                   VALUE +20.
   335     88  resp-lengtherr                 value +22.
   336 01  ws-work-amt-alpha           pic x(10).
   337 01  ws-work-amt-num redefines ws-work-amt-alpha
   338                                 pic 9(8)v99.
   339 01  ws-qry-string               pic x(80) value spaces.
   340 01  ws-qrystr-len               pic s9(8) comp value +60.
   341 01  ws-seq-alpha                pic x(5).
   342 01  ws-seq-no-num redefines ws-seq-alpha
   343                                 pic 9(5).
   344*                                copy ERCCHEK.
   345******************************************************************
   346*                                                                *
   347*                                                                *
   348*                            ERCCHEK                             *
   349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   350*                            VMOD=2.008                          *
   351*                                                                *
   352*   FILE DESCRIPTION = CHECK RECORDS                             *
   353*                                                                *
   354*   FILE TYPE = VSAM,KSDS                                        *
   355*   RECORD SIZE = 600    RECFORM = FIXED                         *
   356*                                                                *
   357*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   358*       ALTERNATE INDEX = NONE                                   *
   359*                                                                *
   360*   LOG = YES                                                    *
   361*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   8
* EL201.cbl
   362******************************************************************
   363*                   C H A N G E   L O G
   364*
   365* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   366*-----------------------------------------------------------------
   367*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   368* EFFECTIVE    NUMBER
   369*-----------------------------------------------------------------
   370* 021414    2003053000001  PEMA  changes for auto chk request
   371******************************************************************
   372 01  CHECK-RECORDS.
   373     12  CH-RECORD-ID                      PIC XX.
   374         88  VALID-CH-ID                      VALUE 'CH'.
   375
   376     12  CH-CONTROL-PRIMARY.
   377         16  CH-COMPANY-CD                 PIC X.
   378         16  CH-CARRIER                    PIC X.
   379         16  CH-GROUPING                   PIC X(6).
   380         16  CH-STATE                      PIC XX.
   381         16  CH-ACCOUNT                    PIC X(10).
   382         16  CH-CERT-EFF-DT                PIC XX.
   383         16  CH-CERT-NO.
   384             20  CH-CERT-PRIME             PIC X(10).
   385             20  CH-CERT-SFX               PIC X.
   386         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   387
   388     12  CH-RECORDED-DT                    PIC XX.
   389     12  CH-RECORDED-BY                    PIC X(4).
   390     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   391
   392     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   393     12  CH-CHECK-NO                       PIC X(7).
   394     12  CH-REASON-FOR-CHECK               PIC X(25).
   395     12  CH-CHECK-WRITTEN-DT               PIC XX.
   396     12  FILLER                            PIC X.
   397
   398     12  CH-PAYEE-INFO.
   399         16  CH-PAYEE-NAME-1               PIC X(30).
   400         16  CH-PAYEE-NAME-2               PIC X(30).
   401         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   402         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   403         16  CH-PAYEE-CITY-ST.
   404             20  CH-PAYEE-CITY             PIC X(28).
   405             20  CH-PAYEE-STATE            PIC XX.
   406         16  CH-PAYEE-ZIP-CODE.
   407             20  CH-PAYEE-ZIP.
   408                 24  CH-ZIP-PRI-1ST        PIC X.
   409                     88  CH-CANADIAN-POST-CODE
   410                                           VALUES 'A' THRU 'Z'.
   411                 24  FILLER                PIC X(4).
   412             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   413         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   414             20  CH-CAN-POSTAL-1           PIC XXX.
   415             20  CH-CAN-POSTAL-2           PIC XXX.
   416             20  FILLER                    PIC XXX.
   417
   418     12  CH-CHECK-STUB-TEXT.
   419         16  CH-STUB-LINE-1                PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page   9
* EL201.cbl
   420         16  CH-TEXT-LINE-1                PIC X(50).
   421         16  CH-TEXT-LINE-2                PIC X(50).
   422         16  CH-TEXT-LINE-3                PIC X(40).
   423     12  CH-RETURN-TO                      PIC X(30).
   424
   425     12  CH-COMPENSATION-CONTROL.
   426         16  CH-COMP-CARRIER               PIC X.
   427         16  CH-COMP-GROUPING              PIC X(6).
   428         16  CH-COMP-FIN-RESP              PIC X(10).
   429         16  CH-COMP-ACCOUNT               PIC X(10).
   430
   431     12  CH-CREDIT-SELECT-DT               PIC XX.
   432     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   433     12  CH-PAYEE-CODE                     PIC X(6).
   434
   435     12  CH-VOID-DATA.
   436         20  CH-VOID-DT                    PIC XX.
   437         20  CH-VOID-BY                    PIC X(4).
   438         20  CH-VOID-REASON                PIC X(25).
   439
   440     12  CH-APPROVAL-DATA.
   441         20  CH-APPROVAL-DT                PIC XX.
   442         20  CH-APPROVAL-STATUS            PIC X.
   443             88  CH-IN-LIMBO                  VALUE ' '.
   444             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   445             88  CH-APPROVED                  VALUE 'A'.
   446             88  CH-DENIED                    VALUE 'D'.
   447         20  CH-APPROVED-BY                PIC XXXX.
   448     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   449             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   450     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   451
   452     12  ch-released-dt                    pic xx.
   453     12  ch-check-cashed-dt                pic xx.
   454     12  FILLER                            PIC X.
   455*    12  CH-CHECK-REFERENCE                PIC X(12).
   456     12  CH-CHECK-ORIGIN-SW                PIC X.
   457             88  CH-REFUND-CHECK              VALUE 'R'.
   458             88  CH-MAINT-CHECK               VALUE 'M'.
   459
   460     12  CH-CANC-DT                        PIC XX.
   461     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   462     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   463
   464     12  CH-INSURED-NAME                   PIC X(28).
   465
   466     12  ch-released-by                    pic x(4).
   467     12  ch-csr                            pic x(4).
   468     12  ch-deduct-commission              pic x.
   469         88  ch-deduct-comm                  value 'Y'.
   470         88  ch-do-not-deduct-comm           value 'N'.
   471
   472     12  FILLER                            PIC X(11).
   473*    12  CH-LETTER-TABLE.
   474*        16  CH-LETTERS OCCURS 3 TIMES
   475*                       INDEXED BY CH-LT-NDX
   476*                                          PIC X(04).
   477
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  10
* EL201.cbl
   478     12  FILLER                            PIC X(07).
   479
   480*                                copy ELCFUNDT.
   481*****************************************************************
   482*                                                               *
   483*                            ELCFUNDT.                          *
   484*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   485*                            VMOD=2.001                         *
   486*                                                               *
   487*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   488*                                                               *
   489*****************************************************************
   490
   491
   492 01  FUNCTION-DATE.
   493     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   494     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   495         10  WS-FN-CCYR            PIC 9(4).
   496         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   497             15  WS-FN-CC          PIC 99.
   498             15  WS-FN-YR          PIC 99.
   499         10  WS-FN-MO              PIC 99.
   500         10  WS-FN-DA              PIC 99.
   501     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   502     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   503     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   504     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   505     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   506         88  WS-BEHIND-GMT                     VALUE '-'.
   507         88  WS-AFTER-GMT                      VALUE '+'.
   508         88  WS-NO-GMT                         VALUE ZERO.
   509     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   510     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   511*                                COPY ELCDATE.
   512******************************************************************
   513*                                                                *
   514*                                                                *
   515*                            ELCDATE.                            *
   516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   517*                            VMOD=2.003
   518*                                                                *
   519*                                                                *
   520*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   521*                 LENGTH = 200                                   *
   522******************************************************************
   523
   524 01  DATE-CONVERSION-DATA.
   525     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   526     12  DC-OPTION-CODE                PIC X.
   527         88  BIN-TO-GREG                VALUE ' '.
   528         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   529         88  EDIT-GREG-TO-BIN           VALUE '2'.
   530         88  YMD-GREG-TO-BIN            VALUE '3'.
   531         88  MDY-GREG-TO-BIN            VALUE '4'.
   532         88  JULIAN-TO-BIN              VALUE '5'.
   533         88  BIN-PLUS-ELAPSED           VALUE '6'.
   534         88  FIND-CENTURY               VALUE '7'.
   535         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  11
* EL201.cbl
   536         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   537         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   538         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   539         88  JULIAN-TO-BIN-3            VALUE 'C'.
   540         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   541         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   542         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   543         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   544         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   545         88  CHECK-LEAP-YEAR            VALUE 'H'.
   546         88  BIN-3-TO-GREG              VALUE 'I'.
   547         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   548         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   549         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   550         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   551         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   552         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   553         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   554         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   555         88  THREE-CHARACTER-BIN
   556                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   557         88  GREGORIAN-TO-BIN
   558                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   559         88  BIN-TO-GREGORIAN
   560                  VALUES ' ' '1' 'I' '8' 'G'.
   561         88  JULIAN-TO-BINARY
   562                  VALUES '5' 'C' 'E' 'F'.
   563     12  DC-ERROR-CODE                 PIC X.
   564         88  NO-CONVERSION-ERROR        VALUE ' '.
   565         88  DATE-CONVERSION-ERROR
   566                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   567         88  DATE-IS-ZERO               VALUE '1'.
   568         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   569         88  DATE-IS-INVALID            VALUE '3'.
   570         88  DATE1-GREATER-DATE2        VALUE '4'.
   571         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   572         88  DATE-INVALID-OPTION        VALUE '9'.
   573         88  INVALID-CENTURY            VALUE 'A'.
   574         88  ONLY-CENTURY               VALUE 'B'.
   575         88  ONLY-LEAP-YEAR             VALUE 'C'.
   576         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   577     12  DC-END-OF-MONTH               PIC X.
   578         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   579     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   580         88  USE-NORMAL-PROCESS         VALUE ' '.
   581         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   582         88  ADJUST-UP-100-YRS          VALUE '2'.
   583     12  FILLER                        PIC X.
   584     12  DC-CONVERSION-DATES.
   585         16  DC-BIN-DATE-1             PIC XX.
   586         16  DC-BIN-DATE-2             PIC XX.
   587         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   588         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   589                       DC-GREG-DATE-1-EDIT.
   590             20  DC-EDIT1-MONTH        PIC 99.
   591             20  SLASH1-1              PIC X.
   592             20  DC-EDIT1-DAY          PIC 99.
   593             20  SLASH1-2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  12
* EL201.cbl
   594             20  DC-EDIT1-YEAR         PIC 99.
   595         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   596         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   597                     DC-GREG-DATE-2-EDIT.
   598             20  DC-EDIT2-MONTH        PIC 99.
   599             20  SLASH2-1              PIC X.
   600             20  DC-EDIT2-DAY          PIC 99.
   601             20  SLASH2-2              PIC X.
   602             20  DC-EDIT2-YEAR         PIC 99.
   603         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   604         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   605                     DC-GREG-DATE-1-YMD.
   606             20  DC-YMD-YEAR           PIC 99.
   607             20  DC-YMD-MONTH          PIC 99.
   608             20  DC-YMD-DAY            PIC 99.
   609         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   610         16  DC-GREG-DATE-1-MDY-R REDEFINES
   611                      DC-GREG-DATE-1-MDY.
   612             20  DC-MDY-MONTH          PIC 99.
   613             20  DC-MDY-DAY            PIC 99.
   614             20  DC-MDY-YEAR           PIC 99.
   615         16  DC-GREG-DATE-1-ALPHA.
   616             20  DC-ALPHA-MONTH        PIC X(10).
   617             20  DC-ALPHA-DAY          PIC 99.
   618             20  FILLER                PIC XX.
   619             20  DC-ALPHA-CENTURY.
   620                 24 DC-ALPHA-CEN-N     PIC 99.
   621             20  DC-ALPHA-YEAR         PIC 99.
   622         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   623         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   624         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   625         16  DC-JULIAN-DATE            PIC 9(05).
   626         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   627                                       PIC 9(05).
   628         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   629             20  DC-JULIAN-YEAR        PIC 99.
   630             20  DC-JULIAN-DAYS        PIC 999.
   631         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   632         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   633         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   634     12  DATE-CONVERSION-VARIBLES.
   635         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   636         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   637             20  FILLER                PIC 9(3).
   638             20  HOLD-CEN-1-CCYY.
   639                 24  HOLD-CEN-1-CC     PIC 99.
   640                 24  HOLD-CEN-1-YY     PIC 99.
   641             20  HOLD-CEN-1-MO         PIC 99.
   642             20  HOLD-CEN-1-DA         PIC 99.
   643         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   644             20  HOLD-CEN-1-R-MO       PIC 99.
   645             20  HOLD-CEN-1-R-DA       PIC 99.
   646             20  HOLD-CEN-1-R-CCYY.
   647                 24  HOLD-CEN-1-R-CC   PIC 99.
   648                 24  HOLD-CEN-1-R-YY   PIC 99.
   649             20  FILLER                PIC 9(3).
   650         16  HOLD-CENTURY-1-X.
   651             20  FILLER                PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  13
* EL201.cbl
   652             20  HOLD-CEN-1-X-CCYY.
   653                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   654                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   655             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   656             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   657         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   658             20  HOLD-CEN-1-R-X-MO     PIC XX.
   659             20  HOLD-CEN-1-R-X-DA     PIC XX.
   660             20  HOLD-CEN-1-R-X-CCYY.
   661                 24  HOLD-CEN-1-R-X-CC PIC XX.
   662                 24  HOLD-CEN-1-R-X-YY PIC XX.
   663             20  FILLER                PIC XXX.
   664         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   665         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   666         16  DC-JULIAN-DATE-1          PIC 9(07).
   667         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   668             20  DC-JULIAN-1-CCYY.
   669                 24  DC-JULIAN-1-CC    PIC 99.
   670                 24  DC-JULIAN-1-YR    PIC 99.
   671             20  DC-JULIAN-DA-1        PIC 999.
   672         16  DC-JULIAN-DATE-2          PIC 9(07).
   673         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   674             20  DC-JULIAN-2-CCYY.
   675                 24  DC-JULIAN-2-CC    PIC 99.
   676                 24  DC-JULIAN-2-YR    PIC 99.
   677             20  DC-JULIAN-DA-2        PIC 999.
   678         16  DC-GREG-DATE-A-EDIT.
   679             20  DC-EDITA-MONTH        PIC 99.
   680             20  SLASHA-1              PIC X VALUE '/'.
   681             20  DC-EDITA-DAY          PIC 99.
   682             20  SLASHA-2              PIC X VALUE '/'.
   683             20  DC-EDITA-CCYY.
   684                 24  DC-EDITA-CENT     PIC 99.
   685                 24  DC-EDITA-YEAR     PIC 99.
   686         16  DC-GREG-DATE-B-EDIT.
   687             20  DC-EDITB-MONTH        PIC 99.
   688             20  SLASHB-1              PIC X VALUE '/'.
   689             20  DC-EDITB-DAY          PIC 99.
   690             20  SLASHB-2              PIC X VALUE '/'.
   691             20  DC-EDITB-CCYY.
   692                 24  DC-EDITB-CENT     PIC 99.
   693                 24  DC-EDITB-YEAR     PIC 99.
   694         16  DC-GREG-DATE-CYMD         PIC 9(08).
   695         16  DC-GREG-DATE-CYMD-R REDEFINES
   696                              DC-GREG-DATE-CYMD.
   697             20  DC-CYMD-CEN           PIC 99.
   698             20  DC-CYMD-YEAR          PIC 99.
   699             20  DC-CYMD-MONTH         PIC 99.
   700             20  DC-CYMD-DAY           PIC 99.
   701         16  DC-GREG-DATE-MDCY         PIC 9(08).
   702         16  DC-GREG-DATE-MDCY-R REDEFINES
   703                              DC-GREG-DATE-MDCY.
   704             20  DC-MDCY-MONTH         PIC 99.
   705             20  DC-MDCY-DAY           PIC 99.
   706             20  DC-MDCY-CEN           PIC 99.
   707             20  DC-MDCY-YEAR          PIC 99.
   708    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   709        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  14
* EL201.cbl
   710    12  DC-EL310-DATE                  PIC X(21).
   711    12  FILLER                         PIC X(28).
   712*                                COPY ELCCNTL.
   713******************************************************************
   714*                                                                *
   715*                                                                *
   716*                            ELCCNTL.                            *
   717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   718*                            VMOD=2.059                          *
   719*                                                                *
   720*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   721*                                                                *
   722*   FILE TYPE = VSAM,KSDS                                        *
   723*   RECORD SIZE = 750  RECFORM = FIXED                           *
   724*                                                                *
   725*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   726*       ALTERNATE INDEX = NONE                                   *
   727*                                                                *
   728*   LOG = YES                                                    *
   729*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   730******************************************************************
   731*                   C H A N G E   L O G
   732*
   733* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   734*-----------------------------------------------------------------
   735*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   736* EFFECTIVE    NUMBER
   737*-----------------------------------------------------------------
   738* 082503                   PEMA  ADD BENEFIT GROUP
   739* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   740* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   741* 092705    2005050300006  PEMA  ADD SPP LEASES
   742* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   743* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   744* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   745* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   746* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   747* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   748* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   749* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   750* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   751* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   752******************************************************************
   753*
   754 01  CONTROL-FILE.
   755     12  CF-RECORD-ID                       PIC XX.
   756         88  VALID-CF-ID                        VALUE 'CF'.
   757
   758     12  CF-CONTROL-PRIMARY.
   759         16  CF-COMPANY-ID                  PIC XXX.
   760         16  CF-RECORD-TYPE                 PIC X.
   761             88  CF-COMPANY-MASTER              VALUE '1'.
   762             88  CF-PROCESSOR-MASTER            VALUE '2'.
   763             88  CF-STATE-MASTER                VALUE '3'.
   764             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   765             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   766             88  CF-CARRIER-MASTER              VALUE '6'.
   767             88  CF-MORTALITY-MASTER            VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  15
* EL201.cbl
   768             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   769             88  CF-TERMINAL-MASTER             VALUE '9'.
   770             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   771             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   772             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   773             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   774             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   775             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   776             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   777             88  CF-REMINDERS-MASTER            VALUE 'R'.
   778             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   779         16  CF-ACCESS-CD-GENL              PIC X(4).
   780         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   781             20  CF-PROCESSOR               PIC X(4).
   782         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   783             20  CF-STATE-CODE              PIC XX.
   784             20  FILLER                     PIC XX.
   785         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   786             20  FILLER                     PIC XX.
   787             20  CF-HI-BEN-IN-REC           PIC XX.
   788         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   789             20  FILLER                     PIC XXX.
   790             20  CF-CARRIER-CNTL            PIC X.
   791         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   792             20  FILLER                     PIC XX.
   793             20  CF-HI-TYPE-IN-REC          PIC 99.
   794         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   795             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   796                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   797             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   798             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   799         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   800             20  FILLER                     PIC X.
   801             20  CF-CUSTOM-REPORT-NO        PIC 999.
   802         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   803             20  FILLER                     PIC XX.
   804             20  CF-MORTGAGE-PLAN           PIC XX.
   805         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   806
   807     12  CF-LAST-MAINT-DT                   PIC XX.
   808     12  CF-LAST-MAINT-BY                   PIC X(4).
   809     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   810
   811     12  CF-RECORD-BODY                     PIC X(728).
   812
   813
   814****************************************************************
   815*             COMPANY MASTER RECORD                            *
   816****************************************************************
   817
   818     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   819         16  CF-COMPANY-ADDRESS.
   820             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   821             20  CF-CL-IN-CARE-OF           PIC X(30).
   822             20  CF-CL-ADDR-LINE-1          PIC X(30).
   823             20  CF-CL-ADDR-LINE-2          PIC X(30).
   824             20  CF-CL-CITY-STATE           PIC X(30).
   825             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  16
* EL201.cbl
   826             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   827         16  CF-COMPANY-CD                  PIC X.
   828         16  CF-COMPANY-PASSWORD            PIC X(8).
   829         16  CF-SECURITY-OPTION             PIC X.
   830             88  ALL-SECURITY                   VALUE '1'.
   831             88  COMPANY-VERIFY                 VALUE '2'.
   832             88  PROCESSOR-VERIFY               VALUE '3'.
   833             88  NO-SECURITY                    VALUE '4'.
   834             88  ALL-BUT-TERM                   VALUE '5'.
   835         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   836             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   837         16  CF-LGX-INTERFACE-CNTL          PIC X.
   838             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   839         16  CF-INFORCE-LOCATION            PIC X.
   840             88  CERTS-ARE-ONLINE               VALUE '1'.
   841             88  CERTS-ARE-OFFLINE              VALUE '2'.
   842             88  NO-CERTS-AVAILABLE             VALUE '3'.
   843         16  CF-LOWER-CASE-LETTERS          PIC X.
   844         16  CF-CERT-ACCESS-CONTROL         PIC X.
   845             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   846             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   847             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   848             88  CF-ACCNT-CNTL                  VALUE '3'.
   849             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   850
   851         16  CF-FORMS-PRINTER-ID            PIC X(4).
   852         16  CF-CHECK-PRINTER-ID            PIC X(4).
   853
   854         16  CF-LGX-CREDIT-USER             PIC X.
   855             88  CO-IS-NOT-USER                 VALUE 'N'.
   856             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   857
   858         16 CF-CREDIT-CALC-CODES.
   859             20  CF-CR-REM-TERM-CALC PIC X.
   860               88  CR-EARN-AFTER-15TH           VALUE '1'.
   861               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   862               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   863               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   864               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   865               88  CR-EARN-AFTER-14TH           VALUE '6'.
   866               88  CR-EARN-AFTER-16TH           VALUE '7'.
   867             20  CF-CR-R78-METHOD           PIC X.
   868               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   869               88  DONT-USE-PLUS-ONE            VALUE '1'.
   870
   871         16  CF-CLAIM-CONTROL-COUNTS.
   872             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   873                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   874
   875             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   876                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   877
   878             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   879                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   880
   881             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   882                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   883
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  17
* EL201.cbl
   884         16  CF-CURRENT-MONTH-END           PIC XX.
   885
   886         16  CF-CO-CALC-QUOTE-TOLERANCE.
   887             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   888             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   889             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   890             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   891                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   892                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   893             20  CF-CO-PREM-REJECT-SW       PIC X.
   894                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   895                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   896             20  CF-CO-REF-REJECT-SW        PIC X.
   897                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   898                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   899
   900         16  CF-CO-REPORTING-DT             PIC XX.
   901         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   902         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   903           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   904           88  CF-CO-MONTH-END                  VALUE '1'.
   905
   906         16  CF-LGX-CLAIM-USER              PIC X.
   907             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   908             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   909
   910         16  CF-CREDIT-EDIT-CONTROLS.
   911             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   912             20  CF-MIN-AGE                 PIC 99.
   913             20  CF-DEFAULT-AGE             PIC 99.
   914             20  CF-MIN-TERM                PIC S999      COMP-3.
   915             20  CF-MAX-TERM                PIC S999      COMP-3.
   916             20  CF-DEFAULT-SEX             PIC X.
   917             20  CF-JOINT-AGE-INPUT         PIC X.
   918                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   919             20  CF-BIRTH-DATE-INPUT        PIC X.
   920                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   921             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   922                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   923                 88  CF-ZERO-CARRIER            VALUE '1'.
   924                 88  CF-ZERO-GROUPING           VALUE '2'.
   925                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   926             20  CF-EDIT-SW                 PIC X.
   927                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   928             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   929             20  CF-CR-PR-METHOD            PIC X.
   930               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   931               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   932             20  FILLER                     PIC X.
   933
   934         16  CF-CREDIT-MISC-CONTROLS.
   935             20  CF-REIN-TABLE-SW           PIC X.
   936                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   937             20  CF-COMP-TABLE-SW           PIC X.
   938                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   939             20  CF-EXPERIENCE-RETENTION-AGE
   940                                            PIC S9        COMP-3.
   941             20  CF-CONVERSION-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  18
* EL201.cbl
   942             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   943             20  CF-RUN-FREQUENCY-SW        PIC X.
   944                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   945                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   946
   947             20  CF-CR-CHECK-NO-CONTROL.
   948                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   949                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   950                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   951                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   952                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   953                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   954
   955                 24  CF-CR-CHECK-COUNT       REDEFINES
   956                     CF-CR-CHECK-COUNTER      PIC X(4).
   957
   958                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   959                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   960
   961                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   962                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   963                 24  CF-MAIL-PROCESSING       PIC X.
   964                     88  MAIL-PROCESSING          VALUE 'Y'.
   965
   966         16  CF-MISC-SYSTEM-CONTROL.
   967             20  CF-SYSTEM-C                 PIC X.
   968                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   969             20  CF-SYSTEM-D                 PIC X.
   970                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   971             20  CF-SOC-SEC-NO-SW            PIC X.
   972                 88  SOC-SEC-NO-USED             VALUE '1'.
   973             20  CF-MEMBER-NO-SW             PIC X.
   974                 88  MEMBER-NO-USED              VALUE '1'.
   975             20  CF-TAX-ID-NUMBER            PIC X(11).
   976             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   977             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   978                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   979                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   980                 88  CF-ALL-APPROVED             VALUE 'Y'.
   981                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   982             20  CF-SYSTEM-E                 PIC X.
   983                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   984
   985         16  CF-LGX-LIFE-USER               PIC X.
   986             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   987             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   988
   989         16  CF-CR-MONTH-END-DT             PIC XX.
   990
   991         16  CF-FILE-MAINT-DATES.
   992             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   993                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   994             20  CF-LAST-BATCH       REDEFINES
   995                 CF-LAST-BATCH-NO               PIC X(4).
   996             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   997             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   998             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   999             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  19
* EL201.cbl
  1000             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1001             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1002             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1003             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1004             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1005             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1006
  1007         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1008         16  FILLER                         PIC X.
  1009
  1010         16  CF-ALT-MORT-CODE               PIC X(4).
  1011         16  CF-MEMBER-CAPTION              PIC X(10).
  1012
  1013         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1014             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1015             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1016             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1017             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1018             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1019
  1020         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1021
  1022         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1023         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1024         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1025         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1026
  1027         16  CF-AH-OVERRIDE-L1              PIC X.
  1028         16  CF-AH-OVERRIDE-L2              PIC XX.
  1029         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1030         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1031
  1032         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1033         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1034
  1035         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1036         16  CF-AR-LAST-EL860-DT            PIC XX.
  1037         16  CF-MP-MONTH-END-DT             PIC XX.
  1038
  1039         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1040         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1041             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1042
  1043         16  CF-AR-MONTH-END-DT             PIC XX.
  1044
  1045         16  CF-CRDTCRD-USER                PIC X.
  1046             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1047             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1048
  1049         16  CF-CC-MONTH-END-DT             PIC XX.
  1050
  1051         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1052
  1053         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1054             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1055             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1056             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1057         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  20
* EL201.cbl
  1058         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1059         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1060         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1061             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1062             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1063         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1064         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1065         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1066             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1067         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1068
  1069         16  CF-CL-ZIP-CODE.
  1070             20  CF-CL-ZIP-PRIME.
  1071                 24  CF-CL-ZIP-1ST          PIC X.
  1072                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1073                 24  FILLER                 PIC X(4).
  1074             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1075         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1076             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1077             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1078             20  FILLER                     PIC XXX.
  1079
  1080         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1081         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1082         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1083         16  CF-CO-OPTION-START-DATE        PIC XX.
  1084         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1085           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1086                                                      '3' '4'.
  1087           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1088           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1089           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1090           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1091           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1092           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1093
  1094         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1095
  1096         16  CF-PAYMENT-APPROVAL-LEVELS.
  1097             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1098             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1099             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1100             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1101             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1102             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1103
  1104         16  CF-END-USER-REPORTING-USER     PIC X.
  1105             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1106             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1107
  1108         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1109             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1110             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1111
  1112         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1113
  1114         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1115         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  21
* EL201.cbl
  1116
  1117         16  CF-CREDIT-ARCHIVE-CNTL.
  1118             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1119             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1120             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1121
  1122         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1123
  1124         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1125             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1126             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1127
  1128         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1129             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1130             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1131
  1132         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1133
  1134         16  CF-CO-ACH-ID-CODE              PIC  X.
  1135             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1136             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1137             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1138         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1139         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1140         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1141         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1142         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1143         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1144         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1145         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1146         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1147                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1148         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1149                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1150
  1151         16  CF-CO-OVER-SHORT.
  1152             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1153             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1154
  1155*         16  FILLER                         PIC X(102).
  1156         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1157             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1158             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1159
  1160         16  CF-AH-APPROVAL-DAYS.
  1161             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1162             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1163             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1164             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1165
  1166         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1167
  1168         16  CF-APPROV-LEV-5.
  1169             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1170             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1171             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1172
  1173         16  FILLER                         PIC X(68).
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  22
* EL201.cbl
  1174****************************************************************
  1175*             PROCESSOR/USER RECORD                            *
  1176****************************************************************
  1177
  1178     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1179         16  CF-PROCESSOR-NAME              PIC X(30).
  1180         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1181         16  CF-PROCESSOR-TITLE             PIC X(26).
  1182         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1183                 88  MESSAGE-YES                VALUE 'Y'.
  1184                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1185
  1186*****************************************************
  1187****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1188****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1189****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1190****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1191*****************************************************
  1192
  1193         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1194             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1195             20  CF-APPLICATION-FORCE       PIC X.
  1196             20  CF-INDIVIDUAL-APP.
  1197                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1198                     28  CF-BROWSE-APP      PIC X.
  1199                     28  CF-UPDATE-APP      PIC X.
  1200
  1201         16  CF-CURRENT-TERM-ON             PIC X(4).
  1202         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1203             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1204             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1205             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1206             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1207             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1208             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1209             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1210         16  CF-PROCESSOR-CARRIER           PIC X.
  1211             88  NO-CARRIER-SECURITY            VALUE ' '.
  1212         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1213             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1214         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1215             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1216         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1217             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1218
  1219         16  CF-PROC-SYS-ACCESS-SW.
  1220             20  CF-PROC-CREDIT-CLAIMS-SW.
  1221                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1222                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1223                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1224                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1225             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1226                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1227                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1228             20  CF-PROC-LIFE-GNRLDGR-SW.
  1229                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1230                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1231                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  23
* EL201.cbl
  1232                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1233             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1234                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1235                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1236         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1237             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1238             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1239         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1240
  1241         16  CF-APPROVAL-LEVEL                  PIC X.
  1242             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1243             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1244             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1245             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1246             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1247
  1248         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1249
  1250         16  CF-LANGUAGE-TYPE                   PIC X.
  1251             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1252             88  CF-LANG-IS-FR                      VALUE 'F'.
  1253
  1254         16  CF-CSR-IND                         PIC X.
  1255         16  FILLER                             PIC X(239).
  1256
  1257****************************************************************
  1258*             PROCESSOR/REMINDERS RECORD                       *
  1259****************************************************************
  1260
  1261     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1262         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1263             20  CF-START-REMIND-DT         PIC XX.
  1264             20  CF-END-REMIND-DT           PIC XX.
  1265             20  CF-REMINDER-TEXT           PIC X(50).
  1266         16  FILLER                         PIC X(296).
  1267
  1268
  1269****************************************************************
  1270*             STATE MASTER RECORD                              *
  1271****************************************************************
  1272
  1273     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1274         16  CF-STATE-ABBREVIATION          PIC XX.
  1275         16  CF-STATE-NAME                  PIC X(25).
  1276         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1277         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1278             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1279             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1280             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1281             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1282                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1283                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1284             20  CF-ST-PREM-REJECT-SW       PIC X.
  1285                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1286                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1287             20  CF-ST-REF-REJECT-SW        PIC X.
  1288                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1289                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  24
* EL201.cbl
  1290         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1291         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1292         16  CF-ST-REFUND-RULES.
  1293             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1294             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1295             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1296         16  CF-ST-FST-PMT-EXTENSION.
  1297             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1298             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1299                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1300                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1301                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1302                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1303         16  CF-ST-STATE-CALL.
  1304             20  CF-ST-CALL-UNEARNED        PIC X.
  1305             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1306             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1307         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1308             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1309             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1310         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1311         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1312         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1313         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1314         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1315         16  FILLER                         PIC X.
  1316         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1317             20  CF-ST-BENEFIT-CD           PIC XX.
  1318             20  CF-ST-BENEFIT-KIND         PIC X.
  1319                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1320                 88  CF-ST-AH-KIND              VALUE 'A'.
  1321             20  CF-ST-REM-TERM-CALC        PIC X.
  1322                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1323                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1324                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1325                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1326                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1327                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1328                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1329                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1330
  1331             20  CF-ST-REFUND-CALC          PIC X.
  1332                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1333                 88  ST-REFD-BY-R78             VALUE '1'.
  1334                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1335                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1336                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1337                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1338                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1339                 88  ST-REFD-UTAH               VALUE '7'.
  1340                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1341                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1342                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1343
  1344             20  CF-ST-EARNING-CALC         PIC X.
  1345                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1346                 88  ST-EARN-BY-R78             VALUE '1'.
  1347                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  25
* EL201.cbl
  1348                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1349                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1350                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1351                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1352                 88  ST-EARN-MEAN               VALUE '8'.
  1353                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1354
  1355             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1356                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1357                 88  ST-OVRD-BY-R78             VALUE '1'.
  1358                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1359                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1360                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1361                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1362                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1363                 88  ST-OVRD-MEAN               VALUE '8'.
  1364                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1365             20  cf-st-extra-periods        pic 9.
  1366*            20  FILLER                     PIC X.
  1367
  1368         16  CF-ST-COMMISSION-CAPS.
  1369             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1370             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1371             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1372             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1373         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1374                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1375
  1376         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1377
  1378         16  CF-ST-STATUTORY-INTEREST.
  1379             20  CF-ST-STAT-DATE-FROM       PIC X.
  1380                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1381                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1382             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1383             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1384             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1385             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1386             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1387
  1388         16  CF-ST-OVER-SHORT.
  1389             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1390             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1391
  1392         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1393
  1394         16  CF-ST-RT-CALC                  PIC X.
  1395
  1396         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1397         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1398         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1399         16  CF-ST-RF-LR-CALC               PIC X.
  1400         16  CF-ST-RF-LL-CALC               PIC X.
  1401         16  CF-ST-RF-LN-CALC               PIC X.
  1402         16  CF-ST-RF-AH-CALC               PIC X.
  1403         16  CF-ST-RF-CP-CALC               PIC X.
  1404*        16  FILLER                         PIC X(206).
  1405*CIDMOD         16  FILLER                         PIC X(192).
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  26
* EL201.cbl
  1406         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1407             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1408         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1409         16  CF-ST-VFY-2ND-BENE             PIC X.
  1410         16  CF-ST-CAUSAL-STATE             PIC X.
  1411         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1412         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1413         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1414             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1415         16  CF-ST-NET-ONLY-STATE           PIC X.
  1416             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1417         16  FILLER                         PIC X(181).
  1418
  1419****************************************************************
  1420*             BENEFIT MASTER RECORD                            *
  1421****************************************************************
  1422
  1423     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1424         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1425             20  CF-BENEFIT-CODE            PIC XX.
  1426             20  CF-BENEFIT-NUMERIC  REDEFINES
  1427                 CF-BENEFIT-CODE            PIC XX.
  1428             20  CF-BENEFIT-ALPHA           PIC XXX.
  1429             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1430             20  CF-BENEFIT-COMMENT         PIC X(10).
  1431
  1432             20  CF-LF-COVERAGE-TYPE        PIC X.
  1433                 88  CF-REDUCING                VALUE 'R'.
  1434                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1435
  1436             20  CF-SPECIAL-CALC-CD         PIC X.
  1437                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1438                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1439                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1440                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1441                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1442                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1443                 88  CF-FARM-PLAN               VALUE 'F'.
  1444                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1445                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1446                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1447                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1448                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1449                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1450                 88  CF-PRUDENTIAL              VALUE 'P'.
  1451                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1452                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1453                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1454                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1455                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1456                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1457
  1458             20  CF-JOINT-INDICATOR         PIC X.
  1459                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1460
  1461*            20  FILLER                     PIC X(12).
  1462             20  cf-maximum-benefits        pic s999 comp-3.
  1463             20  FILLER                     PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  27
* EL201.cbl
  1464             20  CF-BENEFIT-CATEGORY        PIC X.
  1465             20  CF-LOAN-TYPE               PIC X(8).
  1466
  1467             20  CF-CO-REM-TERM-CALC        PIC X.
  1468                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1469                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1470                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1471                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1472                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1473
  1474             20  CF-CO-EARNINGS-CALC        PIC X.
  1475                 88  CO-EARN-BY-R78             VALUE '1'.
  1476                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1477                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1478                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1479                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1480                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1481                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1482                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1483
  1484             20  CF-CO-REFUND-CALC          PIC X.
  1485                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1486                 88  CO-REFD-BY-R78             VALUE '1'.
  1487                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1488                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1489                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1490                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1491                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1492                 88  CO-REFD-MEAN               VALUE '8'.
  1493                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1494                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1495                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1496
  1497             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1498                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1499                 88  CO-OVRD-BY-R78             VALUE '1'.
  1500                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1501                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1502                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1503                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1504                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1505                 88  CO-OVRD-MEAN               VALUE '8'.
  1506                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1507
  1508             20  CF-CO-BEN-I-G-CD           PIC X.
  1509                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1510                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1511                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1512
  1513         16  FILLER                         PIC X(304).
  1514
  1515
  1516****************************************************************
  1517*             CARRIER MASTER RECORD                            *
  1518****************************************************************
  1519
  1520     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1521         16  CF-ADDRESS-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  28
* EL201.cbl
  1522             20  CF-MAIL-TO-NAME            PIC X(30).
  1523             20  CF-IN-CARE-OF              PIC X(30).
  1524             20  CF-ADDRESS-LINE-1          PIC X(30).
  1525             20  CF-ADDRESS-LINE-2          PIC X(30).
  1526             20  CF-CITY-STATE              PIC X(30).
  1527             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1528             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1529
  1530         16  CF-CLAIM-NO-CONTROL.
  1531             20  CF-CLAIM-NO-METHOD         PIC X.
  1532                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1533                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1534                 88  CLAIM-NO-SEQ               VALUE '3'.
  1535                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1536             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1537                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1538                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1539                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1540
  1541         16  CF-CHECK-NO-CONTROL.
  1542             20  CF-CHECK-NO-METHOD         PIC X.
  1543                 88  CHECK-NO-MANUAL            VALUE '1'.
  1544                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1545                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1546                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1547             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1548                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1549
  1550         16  CF-DOMICILE-STATE              PIC XX.
  1551
  1552         16  CF-EXPENSE-CONTROLS.
  1553             20  CF-EXPENSE-METHOD          PIC X.
  1554                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1555                 88  DOLLARS-PER-PMT            VALUE '2'.
  1556                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1557                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1558             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1559             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1560
  1561         16  CF-CORRESPONDENCE-CONTROL.
  1562             20  CF-LETTER-RESEND-OPT       PIC X.
  1563                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1564                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1565             20  FILLER                     PIC X(4).
  1566
  1567         16  CF-RESERVE-CONTROLS.
  1568             20  CF-MANUAL-SW               PIC X.
  1569                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1570             20  CF-FUTURE-SW               PIC X.
  1571                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1572             20  CF-PTC-SW                  PIC X.
  1573                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1574             20  CF-IBNR-SW                 PIC X.
  1575                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1576             20  CF-PTC-LF-SW               PIC X.
  1577                 88  CF-LF-PTC-USED             VALUE '1'.
  1578             20  CF-CDT-ACCESS-METHOD       PIC X.
  1579                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  29
* EL201.cbl
  1580                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1581                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1582             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1583
  1584         16  CF-CLAIM-CALC-METHOD           PIC X.
  1585             88  360-PLUS-MONTHS                VALUE '1'.
  1586             88  365-PLUS-MONTHS                VALUE '2'.
  1587             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1588             88  360-DAILY                      VALUE '4'.
  1589             88  365-DAILY                      VALUE '5'.
  1590
  1591         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1592         16  FILLER                         PIC X(11).
  1593
  1594         16  CF-LIMIT-AMOUNTS.
  1595             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1596             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1597             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1598             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1599             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1600             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1601             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1602             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1603             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1604             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1605
  1606         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1607         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1608         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1609
  1610         16  CF-ZIP-CODE.
  1611             20  CF-ZIP-PRIME.
  1612                 24  CF-ZIP-1ST             PIC X.
  1613                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1614                 24  FILLER                 PIC X(4).
  1615             20  CF-ZIP-PLUS4               PIC X(4).
  1616         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1617             20  CF-CAN-POSTAL-1            PIC XXX.
  1618             20  CF-CAN-POSTAL-2            PIC XXX.
  1619             20  FILLER                     PIC XXX.
  1620
  1621         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1622         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1623         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1624
  1625         16  CF-RATING-SWITCH               PIC X.
  1626             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1627             88  CF-NO-RATING                   VALUE 'N'.
  1628
  1629         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1630
  1631         16  CF-CARRIER-OVER-SHORT.
  1632             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1633             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1634
  1635         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1636         16  CF-SECPAY-SWITCH               PIC X.
  1637             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  30
* EL201.cbl
  1638             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1639         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1640         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1641         16  FILLER                         PIC X(444).
  1642*        16  FILLER                         PIC X(452).
  1643
  1644
  1645****************************************************************
  1646*             MORTALITY MASTER RECORD                          *
  1647****************************************************************
  1648
  1649     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1650         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1651                                INDEXED BY CF-MORT-NDX.
  1652             20  CF-MORT-TABLE              PIC X(5).
  1653             20  CF-MORT-TABLE-TYPE         PIC X.
  1654                 88  CF-MORT-JOINT              VALUE 'J'.
  1655                 88  CF-MORT-SINGLE             VALUE 'S'.
  1656                 88  CF-MORT-COMBINED           VALUE 'C'.
  1657                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1658                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1659             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1660             20  CF-MORT-AGE-METHOD         PIC XX.
  1661                 88  CF-AGE-LAST                VALUE 'AL'.
  1662                 88  CF-AGE-NEAR                VALUE 'AN'.
  1663             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1664             20  CF-MORT-ADJUSTMENT-DIRECTION
  1665                                            PIC X.
  1666                 88  CF-MINUS                   VALUE '-'.
  1667                 88  CF-PLUS                    VALUE '+'.
  1668             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1669             20  CF-MORT-JOINT-CODE         PIC X.
  1670                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1671             20  CF-MORT-PC-Q               PIC X.
  1672                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1673             20  CF-MORT-TABLE-CODE         PIC X(4).
  1674             20  CF-MORT-COMMENTS           PIC X(15).
  1675             20  FILLER                     PIC X(14).
  1676
  1677         16  FILLER                         PIC X(251).
  1678
  1679
  1680****************************************************************
  1681*             BUSSINESS TYPE MASTER RECORD                     *
  1682****************************************************************
  1683
  1684     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1685* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1686* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1687* AND RECORD 05 IS TYPES 81-99
  1688         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1689             20  CF-BUSINESS-TITLE          PIC  X(19).
  1690             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1691                                            PIC S9V9(4) COMP-3.
  1692             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1693             20  FILLER                     PIC  X.
  1694         16  FILLER                         PIC  X(248).
  1695
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  31
* EL201.cbl
  1696
  1697****************************************************************
  1698*             TERMINAL MASTER RECORD                           *
  1699****************************************************************
  1700
  1701     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1702
  1703         16  CF-COMPANY-TERMINALS.
  1704             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1705                                  PIC X(4).
  1706         16  FILLER               PIC X(248).
  1707
  1708
  1709****************************************************************
  1710*             LIFE EDIT MASTER RECORD                          *
  1711****************************************************************
  1712
  1713     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1714         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1715             20  CF-LIFE-CODE-IN            PIC XX.
  1716             20  CF-LIFE-CODE-OUT           PIC XX.
  1717         16  FILLER                         PIC X(248).
  1718
  1719
  1720****************************************************************
  1721*             AH EDIT MASTER RECORD                            *
  1722****************************************************************
  1723
  1724     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1725         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1726             20  CF-AH-CODE-IN              PIC XXX.
  1727             20  CF-AH-CODE-OUT             PIC XX.
  1728         16  FILLER                         PIC X(248).
  1729
  1730
  1731****************************************************************
  1732*             CREDIBILITY TABLES                               *
  1733****************************************************************
  1734
  1735     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1736         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1737                             INDEXED BY CF-CRDB-NDX.
  1738             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1739             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1740             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1741         16  FILLER                         PIC  X(332).
  1742
  1743
  1744****************************************************************
  1745*             REPORT CUSTOMIZATION RECORD                      *
  1746****************************************************************
  1747
  1748     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1749         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1750             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1751             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1752             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1753**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  32
* EL201.cbl
  1754****       A T-TRANSFER.                                   ****
  1755             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1756
  1757         16  FILLER                         PIC XX.
  1758
  1759         16  CF-CARRIER-CNTL-OPT.
  1760             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1761                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1762                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1763             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1764                                            PIC X.
  1765         16  CF-GROUP-CNTL-OPT.
  1766             20  CF-GROUP-OPT-SEQ           PIC 9.
  1767                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1768                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1769             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1770                                            PIC X(6).
  1771         16  CF-STATE-CNTL-OPT.
  1772             20  CF-STATE-OPT-SEQ           PIC 9.
  1773                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1774                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1775             20  CF-STATE-SELECT OCCURS 3 TIMES
  1776                                            PIC XX.
  1777         16  CF-ACCOUNT-CNTL-OPT.
  1778             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1779                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1780                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1781             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1782                                            PIC X(10).
  1783         16  CF-BUS-TYP-CNTL-OPT.
  1784             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1785                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1786                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1787             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1788                                            PIC XX.
  1789         16  CF-LF-TYP-CNTL-OPT.
  1790             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1791                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1792                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1793             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1794                                            PIC XX.
  1795         16  CF-AH-TYP-CNTL-OPT.
  1796             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1797                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1798                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1799             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1800                                            PIC XX.
  1801         16  CF-REPTCD1-CNTL-OPT.
  1802             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1803                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1804                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1805             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1806                                            PIC X(10).
  1807         16  CF-REPTCD2-CNTL-OPT.
  1808             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1809                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1810                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1811             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  33
* EL201.cbl
  1812                                            PIC X(10).
  1813         16  CF-USER1-CNTL-OPT.
  1814             20  CF-USER1-OPT-SEQ           PIC 9.
  1815                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1816                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1817             20  CF-USER1-SELECT OCCURS 3 TIMES
  1818                                            PIC X(10).
  1819         16  CF-USER2-CNTL-OPT.
  1820             20  CF-USER2-OPT-SEQ           PIC 9.
  1821                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1822                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1823             20  CF-USER2-SELECT OCCURS 3 TIMES
  1824                                            PIC X(10).
  1825         16  CF-USER3-CNTL-OPT.
  1826             20  CF-USER3-OPT-SEQ           PIC 9.
  1827                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1828                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1829             20  CF-USER3-SELECT OCCURS 3 TIMES
  1830                                            PIC X(10).
  1831         16  CF-USER4-CNTL-OPT.
  1832             20  CF-USER4-OPT-SEQ           PIC 9.
  1833                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1834                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1835             20  CF-USER4-SELECT OCCURS 3 TIMES
  1836                                            PIC X(10).
  1837         16  CF-USER5-CNTL-OPT.
  1838             20  CF-USER5-OPT-SEQ           PIC 9.
  1839                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1840                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1841             20  CF-USER5-SELECT OCCURS 3 TIMES
  1842                                            PIC X(10).
  1843         16  CF-REINS-CNTL-OPT.
  1844             20  CF-REINS-OPT-SEQ           PIC 9.
  1845                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1846                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1847             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1848                 24  CF-REINS-PRIME         PIC XXX.
  1849                 24  CF-REINS-SUB           PIC XXX.
  1850
  1851         16  CF-AGENT-CNTL-OPT.
  1852             20  CF-AGENT-OPT-SEQ           PIC 9.
  1853                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1854                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1855             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1856                                            PIC X(10).
  1857
  1858         16  FILLER                         PIC X(43).
  1859
  1860         16  CF-LOSS-RATIO-SELECT.
  1861             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1862             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1863         16  CF-ENTRY-DATE-SELECT.
  1864             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1865             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1866         16  CF-EFFECTIVE-DATE-SELECT.
  1867             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1868             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1869
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  34
* EL201.cbl
  1870         16  CF-EXCEPTION-LIST-IND          PIC X.
  1871             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1872
  1873         16  FILLER                         PIC X(318).
  1874
  1875****************************************************************
  1876*                  EXCEPTION REPORTING RECORD                  *
  1877****************************************************************
  1878
  1879     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1880         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1881             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1882
  1883         16  CF-COMBINED-LIFE-AH-OPT.
  1884             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1885             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1886             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1887             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1888
  1889         16  CF-LIFE-OPT.
  1890             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1891             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1892             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1893             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1894             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1895             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1896             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1897             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1898             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1899             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1900
  1901         16  CF-AH-OPT.
  1902             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1903             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1904             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1905             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1906             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1907             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1908             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1909             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1910             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1911             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1912
  1913         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1914             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1915             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1916             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1917
  1918         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1919
  1920         16  FILLER                         PIC X(673).
  1921
  1922
  1923****************************************************************
  1924*             MORTGAGE SYSTEM PLAN RECORD                      *
  1925****************************************************************
  1926
  1927     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  35
* EL201.cbl
  1928         16  CF-PLAN-TYPE                   PIC X.
  1929             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1930             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1931             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1932         16  CF-PLAN-ABBREV                 PIC XXX.
  1933         16  CF-PLAN-DESCRIPT               PIC X(10).
  1934         16  CF-PLAN-NOTES                  PIC X(20).
  1935         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1936         16  CF-PLAN-UNDERWRITING.
  1937             20  CF-PLAN-TERM-DATA.
  1938                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1939                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1940             20  CF-PLAN-AGE-DATA.
  1941                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1942                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1943                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1944             20  CF-PLAN-BENEFIT-DATA.
  1945                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1946                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1947                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1948                                            PIC S9(7)V99  COMP-3.
  1949         16  CF-PLAN-POLICY-FORMS.
  1950             20  CF-POLICY-FORM             PIC X(12).
  1951             20  CF-MASTER-APPLICATION      PIC X(12).
  1952             20  CF-MASTER-POLICY           PIC X(12).
  1953         16  CF-PLAN-RATING.
  1954             20  CF-RATE-CODE               PIC X(5).
  1955             20  CF-SEX-RATING              PIC X.
  1956                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1957                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1958             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1959             20  CF-SUB-STD-TYPE            PIC X.
  1960                 88  CF-PCT-OF-PREM            VALUE '1'.
  1961                 88  CF-PCT-OF-BENE            VALUE '2'.
  1962         16  CF-PLAN-PREM-TOLERANCES.
  1963             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1964             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1965         16  CF-PLAN-PYMT-TOLERANCES.
  1966             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1967             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1968         16  CF-PLAN-MISC-DATA.
  1969             20  FILLER                     PIC X.
  1970             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1971             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1972         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1973         16  CF-PLAN-IND-GRP                PIC X.
  1974             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1975                                                     '1'.
  1976             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1977                                                     '2'.
  1978         16  CF-MIB-SEARCH-SW               PIC X.
  1979             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1980             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1981             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1982             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1983         16  CF-ALPHA-SEARCH-SW             PIC X.
  1984             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1985             88  CF-MIB-ALPHA-NONE             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  36
* EL201.cbl
  1986             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1987             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1988             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1989             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1990             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1991             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1992             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1993             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1994                                                     'A' 'B' 'C'
  1995                                                     'X' 'Y' 'Z'.
  1996         16  CF-EFF-DT-RULE-SW              PIC X.
  1997             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1998             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1999             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2000             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2001             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2002         16  FILLER                         PIC X(4).
  2003         16  CF-HEALTH-QUESTIONS            PIC X.
  2004             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2005         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2006         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2007         16  CF-PLAN-SNGL-JNT               PIC X.
  2008             88  CF-COMBINED-PLAN              VALUE 'C'.
  2009             88  CF-JNT-PLAN                   VALUE 'J'.
  2010             88  CF-SNGL-PLAN                  VALUE 'S'.
  2011         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2012         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2013         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2014         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2015         16  CF-RERATE-CNTL                 PIC  X.
  2016             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2017             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2018             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2019             88  CF-AUTO-RECALC                 VALUE '4'.
  2020         16  CF-BENEFIT-TYPE                PIC  X.
  2021             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2022             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2023         16  CF-POLICY-FEE                  PIC S999V99
  2024                                                    COMP-3.
  2025         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2026         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2027         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2028         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2029         16  FILLER                         PIC  X(32).
  2030         16  CF-TERMINATION-FORM            PIC  X(04).
  2031         16  FILLER                         PIC  X(08).
  2032         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2033                                                       COMP-3.
  2034         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2035         16  CF-ISSUE-LETTER                PIC  X(4).
  2036         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2037         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2038             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2039             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2040         16  CF-MP-REFUND-CALC              PIC X.
  2041             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2042             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2043             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  37
* EL201.cbl
  2044             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2045             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2046             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2047             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2048             88  CF-MP-REFD-MEAN                VALUE '8'.
  2049         16  CF-ALT-RATE-CODE               PIC  X(5).
  2050
  2051
  2052         16  FILLER                         PIC X(498).
  2053****************************************************************
  2054*             MORTGAGE COMPANY MASTER RECORD                   *
  2055****************************************************************
  2056
  2057     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2058         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2059         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2060             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2061             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2062             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2063             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2064             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2065
  2066         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2067         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2068         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2069         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2070         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2071
  2072         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2073             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2074         16  CF-MP-RECON-USE-IND            PIC X(1).
  2075             88  CF-MP-USE-RECON             VALUE 'Y'.
  2076         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2077             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2078         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2079             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2080             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2081         16  FILLER                         PIC X(1).
  2082         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2083             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2084         16  CF-MORTG-MIB-VERSION           PIC X.
  2085             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2086             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2087             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2088         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2089             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2090                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2091             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2092                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2093             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2094                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2095             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2096                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2097             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2098                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2099             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2100                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2101         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  38
* EL201.cbl
  2102         16  FILLER                         PIC X(7).
  2103         16  CF-MORTG-DESTINATION-SYMBOL.
  2104             20  CF-MORTG-MIB-COMM          PIC X(5).
  2105             20  CF-MORTG-MIB-TERM          PIC X(5).
  2106         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2107             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2108         16  FILLER                         PIC X(03).
  2109         16  CF-MP-CHECK-NO-CONTROL.
  2110             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2111                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2112                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2113                                                ' ' LOW-VALUES.
  2114                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2115                                               VALUE '3'.
  2116         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2117         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2118         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2119             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2120                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2121             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2122                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2123             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2124                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2125             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2126                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2127             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2128                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2129             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2130                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2131         16  CF-MORTG-BILLING-AREA.
  2132             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2133                                            PIC X.
  2134         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2135         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2136         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2137         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2138             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2139             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2140         16  FILLER                         PIC X.
  2141         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2142             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2143             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2144         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2145         16  FILLER                         PIC X(8).
  2146         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2147         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2148         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2149         16  CF-ACH-COMPANY-ID.
  2150             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2151                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2152                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2153                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2154             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2155         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2156             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2157         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2158             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2159             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  39
* EL201.cbl
  2160         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2161         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2162         16  FILLER                         PIC X(536).
  2163
  2164****************************************************************
  2165*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2166****************************************************************
  2167
  2168     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2169         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2170             20  CF-FEMALE-HEIGHT.
  2171                 24  CF-FEMALE-FT           PIC 99.
  2172                 24  CF-FEMALE-IN           PIC 99.
  2173             20  CF-FEMALE-MIN-WT           PIC 999.
  2174             20  CF-FEMALE-MAX-WT           PIC 999.
  2175         16  FILLER                         PIC X(428).
  2176
  2177     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2178         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2179             20  CF-MALE-HEIGHT.
  2180                 24  CF-MALE-FT             PIC 99.
  2181                 24  CF-MALE-IN             PIC 99.
  2182             20  CF-MALE-MIN-WT             PIC 999.
  2183             20  CF-MALE-MAX-WT             PIC 999.
  2184         16  FILLER                         PIC X(428).
  2185******************************************************************
  2186*             AUTOMATIC ACTIVITY RECORD                          *
  2187******************************************************************
  2188     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2189         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2190             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2191             20  CF-SYS-LETTER-ID           PIC X(04).
  2192             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2193             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2194             20  CF-SYS-RESET-SW            PIC X(01).
  2195             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2196             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2197
  2198         16  FILLER                         PIC X(50).
  2199
  2200         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2201             20  CF-USER-ACTIVE-SW          PIC X(01).
  2202             20  CF-USER-LETTER-ID          PIC X(04).
  2203             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2204             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2205             20  CF-USER-RESET-SW           PIC X(01).
  2206             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2207             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2208             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2209
  2210         16  FILLER                         PIC X(246).
  2211 01  ws-heading1.
  2212     05  ws-head1                pic x(120)  value '
  2213-     '                                   DAILY CHECK RECONCILIATI
  2214-     'ON                                            '.
  2215     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2216 01  ws-heading2.
  2217     05  filler                  pic x(51) value spaces.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  40
* EL201.cbl
  2218     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2219     05  WS-H2-DATE              PIC X(10).
  2220     05  ws-h2-time              pic x(8).
  2221 01  ws-heading3.
  2222     05  filler                  pic x(53) value spaces.
  2223     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2224     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2225     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2226 01  ws-heading4.
  2227     05  filler                  pic x(117)   value ' CAR  GROUP
  2228-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2229-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2230 01  ws-hd1-written.
  2231     05  filler                  pic x(120)  value '
  2232-     '                                   DAILY WRITTEN CHECKS REP
  2233-     'ORT                                           '.
  2234 01  ws-hd4-written.
  2235     05  filler                  pic x(117)   value ' CAR  GROUP
  2236-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2237-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2238 01  ws-detail1.
  2239     05  filler                  pic xx value '  '.
  2240     05  ws-d1-carr              pic x(4) value spaces.
  2241     05  ws-d1-grp               pic x(7) value spaces.
  2242     05  ws-d1-state             pic x(4) value spaces.
  2243     05  ws-d1-account           pic x(12) value spaces.
  2244     05  ws-d1-eff-dt            pic x(12) value spaces.
  2245     05  ws-d1-cert-no           pic x(14) value spaces.
  2246     05  ws-d1-chk-type          pic x(5) value spaces.
  2247     05  ws-d1-chk-no            pic x(12) value spaces.
  2248     05  f                       pic xx value spaces.
  2249     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2250     05  ws-d1-preparer          pic x(8) value spaces.
  2251     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2252     05  ws-d1-chk-amt redefines
  2253         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2254     05  filler                  pic xx value spaces.
  2255     05  ws-d1-message           pic x(20) value spaces.
  2256 01  ws-detail2.
  2257     05  filler                  pic x(12) value '    PAYEE - '.
  2258     05  ws-d2-addr-line         pic x(120) value spaces.
  2259 01  ws-total1.
  2260     05  filler                  pic x(5) value '     '.
  2261     05  ws-t1-cnt               pic zzzz9  value zeros.
  2262     05  ws-t1-chks              pic x(24)  value spaces.
  2263     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2264 01  w-doctoken                  pic x(16).
  2265 01 output-data.
  2266    05  filler                   pic x(6) value "TITLE=".
  2267    05  output-title             pic x(26) value 'Check Posting'.
  2268    05  filler                   pic x(8) value "&COMPID=".
  2269    05  out-comp-id              pic xxx.
  2270    05  filler                   pic x(5) value "&MSG=".
  2271    05  output-msg               pic x(50).
  2272 01  tran-data-line1             pic x(80) value spaces.
  2273 01  tran-data-line2             pic x(80) value spaces.
  2274* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2275**    'cd /apps/prod/cid1p/jcl'.
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  41
* EL201.cbl
  2276*      'cd /apps/test/ahltst/jcl'.
  2277* 01  TRAN-DATA-LINE2.
  2278*     05  filler                  pic x(10) value 'unikixjob '.
  2279*     05  tdl2-job                pic x(8) value 'cilg201b'.
  2280**    05  filler                  pic x(9) value ' -k cid1p'.
  2281*     05  filler                  pic x(10) value ' -k ahltst'.
  2282*     05  filler                  pic x(50) value spaces.
  2283****************************************************************
  2284*
  2285* Copyright (c) 2007 by Clerity Solutions, Inc.
  2286* All rights reserved.
  2287*
  2288****************************************************************
  2289 01  DFHEIV.
  2290   02  DFHEIV0               PIC X(35).
  2291   02  DFHEIV1               PIC X(08).
  2292   02  DFHEIV2               PIC X(08).
  2293   02  DFHEIV3               PIC X(08).
  2294   02  DFHEIV4               PIC X(06).
  2295   02  DFHEIV5               PIC X(04).
  2296   02  DFHEIV6               PIC X(04).
  2297   02  DFHEIV7               PIC X(02).
  2298   02  DFHEIV8               PIC X(02).
  2299   02  DFHEIV9               PIC X(01).
  2300   02  DFHEIV10              PIC S9(7) COMP-3.
  2301   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2302   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2303   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2304   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2305   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2306   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2307   02  DFHEIV17              PIC X(04).
  2308   02  DFHEIV18              PIC X(04).
  2309   02  DFHEIV19              PIC X(04).
  2310   02  DFHEIV20              USAGE IS POINTER.
  2311   02  DFHEIV21              USAGE IS POINTER.
  2312   02  DFHEIV22              USAGE IS POINTER.
  2313   02  DFHEIV23              USAGE IS POINTER.
  2314   02  DFHEIV24              USAGE IS POINTER.
  2315   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2316   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2317   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2318   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2319   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2320   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2321   02  FILLER                PIC X(02).
  2322   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2323   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2324   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2325   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2326   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2327 LINKAGE  SECTION.
  2328*****************************************************************
  2329*                                                               *
  2330* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2331* All rights reserved.                                          *
  2332*                                                               *
  2333*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  42
* EL201.cbl
  2334 01  dfheiblk.
  2335     02  eibtime          pic s9(7) comp-3.
  2336     02  eibdate          pic s9(7) comp-3.
  2337     02  eibtrnid         pic x(4).
  2338     02  eibtaskn         pic s9(7) comp-3.
  2339     02  eibtrmid         pic x(4).
  2340     02  dfheigdi         pic s9(4) comp.
  2341     02  eibcposn         pic s9(4) comp.
  2342     02  eibcalen         pic s9(4) comp.
  2343     02  eibaid           pic x(1).
  2344     02  eibfiller1       pic x(1).
  2345     02  eibfn            pic x(2).
  2346     02  eibfiller2       pic x(2).
  2347     02  eibrcode         pic x(6).
  2348     02  eibfiller3       pic x(2).
  2349     02  eibds            pic x(8).
  2350     02  eibreqid         pic x(8).
  2351     02  eibrsrce         pic x(8).
  2352     02  eibsync          pic x(1).
  2353     02  eibfree          pic x(1).
  2354     02  eibrecv          pic x(1).
  2355     02  eibsend          pic x(1).
  2356     02  eibatt           pic x(1).
  2357     02  eibeoc           pic x(1).
  2358     02  eibfmh           pic x(1).
  2359     02  eibcompl         pic x(1).
  2360     02  eibsig           pic x(1).
  2361     02  eibconf          pic x(1).
  2362     02  eiberr           pic x(1).
  2363     02  eibrldbk         pic x(1).
  2364     02  eiberrcd         pic x(4).
  2365     02  eibsynrb         pic x(1).
  2366     02  eibnodat         pic x(1).
  2367     02  eibfiller5       pic x(2).
  2368     02  eibresp          pic 9(09) comp.
  2369     02  eibresp2         pic 9(09) comp.
  2370     02  dfheigdj         pic s9(4) comp.
  2371     02  dfheigdk         pic s9(4) comp.
  2372 01  DFHCOMMAREA       PIC X(01).
  2373 01  VAR                         PIC X(30).
  2374 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2375 0000-DFHEXIT SECTION.
  2376     MOVE '9#                    $   ' TO DFHEIV0.
  2377     MOVE 'EL201' TO DFHEIV1.
  2378     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2379***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2380***                                                            ***
  2381***  Even though this program is using WEB Servies we don't    ***
  2382***  have any form fields to browse through, we are getting    ***
  2383***  the information we need through the variables that are    ***
  2384***  included in the URL. These variables are retrieved by     ***
  2385***  the           exec cics web extract                       ***
  2386***                   querystring  (data-value)                ***
  2387***                   querystrlen  (data-value)                ***
  2388***                end-exec                                    ***
  2389***  BTW, you must provide the length it isn't passed to you.  ***
  2390***  Allow for extra on the length or you will get a length    ***
  2391***  error instead of just truncation.                         ***
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  43
* EL201.cbl
  2392***                                                            ***
  2393***  This program is expecting                                 ***
  2394*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2395*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2396*** http://logictest:6007/cics/cwba/EL201?comp=CID&file=written***
  2397***                                                            ***
  2398***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2399     set P to address of KIXSYS
  2400     CALL "getenv" using by value P returning var-ptr
  2401     if var-ptr = null then
  2402        display ' kixsys not set '
  2403     else
  2404        set address of var to var-ptr
  2405        move 0 to env-var-len
  2406        inspect var tallying env-var-len
  2407          for characters before X'00'
  2408        unstring var (1:env-var-len) delimited by '/'
  2409           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2410              WS-KIX-SYS
  2411        end-unstring
  2412     end-if
  2413     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2414     move ws-fn-cymd             to dc-greg-date-cymd
  2415     move 'L'                    to dc-option-code
  2416     perform 9700-date-convert   thru 9700-exit
  2417     if no-conversion-error
  2418        move dc-greg-date-1-alpha to ws-h3-date
  2419        move dc-greg-date-1-edit to ws-h2-date
  2420     else
  2421        display ' error current dt invalid ' dc-error-code
  2422     end-if
  2423     string ws-fn-hours   ':'
  2424            ws-fn-minutes ':'
  2425            ws-fn-seconds
  2426        delimited by size into ws-h2-time
  2427     end-string
  2428
  2429* exec cics web extract
  2430*       querystring  (ws-qry-string)
  2431*       querystrlen  (ws-qrystr-len)
  2432*    end-exec
  2433*    MOVE 'X0  QL                .   #00002331' TO DFHEIV0
  2434     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2435     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2436     MOVE X'2020233030303032333331' TO DFHEIV0(25:11)
  2437     CALL 'kxdfhei1' USING DFHEIV0,
  2438           DFHEIV99,
  2439           DFHEIV99,
  2440           ws-qry-string,
  2441           ws-qrystr-len,
  2442           DFHEIV99,
  2443           DFHEIV99,
  2444           DFHEIV99,
  2445           DFHEIV99,
  2446           DFHEIV99,
  2447           DFHEIV99,
  2448           DFHEIV99,
  2449           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  44
* EL201.cbl
  2450           DFHEIV99
  2451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2452     move ws-qry-string (6:3)    to ws-comp-id
  2453                                    out-comp-id
  2454     move 'Successful Run   '    to output-msg
  2455     move ws-comp-id             to elcntl-key
  2456     move '1'                    to elcntl-rec-type
  2457     move +0                     to elcntl-seq
  2458
  2459* exec cics read
  2460*       dataset  ('ELCNTL')
  2461*       into     (control-file)
  2462*       ridfld   (elcntl-key)
  2463*       resp     (ws-response)
  2464*    end-exec
  2465     MOVE LENGTH OF
  2466      control-file
  2467       TO DFHEIV11
  2468     MOVE 'ELCNTL' TO DFHEIV1
  2469*    MOVE '&"IL       E          (  N#00002341' TO DFHEIV0
  2470     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2472     MOVE X'204E233030303032333431' TO DFHEIV0(25:11)
  2473     CALL 'kxdfhei1' USING DFHEIV0,
  2474           DFHEIV1,
  2475           control-file,
  2476           DFHEIV11,
  2477           elcntl-key,
  2478           DFHEIV99,
  2479           DFHEIV99,
  2480           DFHEIV99
  2481     MOVE EIBRESP  TO ws-response
  2482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2483     if resp-normal
  2484        move cf-cl-mail-to-name  to ws-h2-client-name
  2485        move cf-company-cd       to ws-comp-cd
  2486     else
  2487        move 'Company Rec not found ' to ws-h2-client-name
  2488                                         output-msg
  2489        display ' error elcntl read ' ws-response ' '
  2490           elcntl-key (1:8)
  2491        go to 0000-return
  2492     end-if
  2493     evaluate true
  2494        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2495           set process-written      to true
  2496           perform 2000-process-written
  2497                                 thru 2000-exit
  2498        when other
  2499           move 'Invalid File ' to output-msg
  2500     end-evaluate
  2501     if connected-to-db
  2502        EXEC SQL
  2503            commit work release
  2504        END-EXEC
  2505        if sqlcode not = 0
  2506           move ' Failed to Commit DB '
  2507                                 to output-msg
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  45
* EL201.cbl
  2508           display "Error: commit release "
  2509           display ' sql return code ' sqlcode
  2510           display ' sql err mess    ' sqlerrmc
  2511        end-if
  2512     end-if
  2513     .
  2514 0000-return.
  2515     perform 1030-send-form      thru 1030-exit
  2516
  2517* exec cics
  2518*       return
  2519*    end-exec
  2520*    MOVE '.(                    ''   #00002380' TO DFHEIV0
  2521     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2522     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2523     MOVE X'2020233030303032333830' TO DFHEIV0(25:11)
  2524     CALL 'kxdfhei1' USING DFHEIV0,
  2525           DFHEIV99,
  2526           DFHEIV99,
  2527           DFHEIV99,
  2528           DFHEIV99,
  2529           DFHEIV99,
  2530           DFHEIV99
  2531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2532     .
  2533 1000-CONNECT-DB.
  2534     string
  2535         usr delimited space
  2536         "." delimited size
  2537         pass delimited space into usr-pass
  2538     end-string
  2539     EXEC SQL
  2540        CONNECT TO :svr USER :usr-pass
  2541     END-EXEC
  2542     if sqlcode not = 0
  2543        display "Error: cannot connect "
  2544        display sqlcode
  2545        display sqlerrmc
  2546        move 'Failed to connect to DB'
  2547                                 to output-msg
  2548        go to 0000-return
  2549     else
  2550        set connected-to-db to true
  2551     end-if
  2552     .
  2553 1000-EXIT.
  2554     EXIT.
  2555 1020-read-erchek.
  2556     move ws-comp-cd             to ch-company-cd
  2557     move db-carrier             to ch-carrier
  2558     move db-grouping            to ch-grouping
  2559     move db-state               to ch-state
  2560     move db-account             to ch-account
  2561     move db-certificate         to ch-cert-prime
  2562     move db-cert-sfx            to ch-cert-sfx
  2563     string db-effdate (1:4)
  2564            db-effdate (6:2)
  2565            db-effdate (9:2)
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  46
* EL201.cbl
  2566        delimited by size into dc-greg-date-cymd-r
  2567     end-string
  2568     move 'L'                    to dc-option-code
  2569     perform 9700-date-convert   thru 9700-exit
  2570     if no-conversion-error
  2571        move dc-bin-date-1       to ch-cert-eff-dt
  2572     else
  2573        display ' error cvtdte eff dt ' db-effdate ' '
  2574           dc-error-code
  2575     end-if
  2576     move zeros                  to ws-seq-alpha
  2577     move +5                     to s2
  2578     perform varying s1 from +5 by -1 until s1 < +1
  2579        if db-seq-no (s1:1) numeric
  2580           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2581           subtract +1 from s2
  2582        end-if
  2583     end-perform
  2584     move ws-seq-no-num          to ch-sequence-no
  2585*    display ' dte   **' db-effdate '**'
  2586*    display ' carrier ' ch-carrier
  2587*    display ' group   ' ch-grouping
  2588*    display ' state   ' ch-state
  2589*    display ' acct    ' ch-account
  2590*    display ' cert  **' ch-cert-no '**'
  2591*    display ' seq     ' ch-sequence-no
  2592
  2593* exec cics read
  2594*       update
  2595*       dataset    ('ERCHEK')
  2596*       into       (check-records)
  2597*       ridfld     (ch-control-primary)
  2598*       resp       (ws-response)
  2599*    end-exec
  2600     MOVE LENGTH OF
  2601      check-records
  2602       TO DFHEIV11
  2603     MOVE 'ERCHEK' TO DFHEIV1
  2604*    MOVE '&"IL       EU         (  N#00002443' TO DFHEIV0
  2605     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2606     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2607     MOVE X'204E233030303032343433' TO DFHEIV0(25:11)
  2608     CALL 'kxdfhei1' USING DFHEIV0,
  2609           DFHEIV1,
  2610           check-records,
  2611           DFHEIV11,
  2612           ch-control-primary,
  2613           DFHEIV99,
  2614           DFHEIV99,
  2615           DFHEIV99
  2616     MOVE EIBRESP  TO ws-response
  2617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2618     .
  2619 1020-exit.
  2620     exit.
  2621 1030-send-form.
  2622
  2623* exec cics document create
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  47
* EL201.cbl
  2624*       doctoken   (w-doctoken)
  2625*       template   ('WCHECKS')
  2626*       symbollist (output-data)
  2627*       listlength (length of output-data)
  2628*    end-exec
  2629     MOVE 'WCHECKS'
  2630      TO DFHEIVL0
  2631     MOVE LENGTH OF
  2632      output-data TO DFHEIV16
  2633*    MOVE '\"D tSL               )   #00002454' TO DFHEIV0
  2634     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2635     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2636     MOVE X'2020233030303032343534' TO DFHEIV0(25:11)
  2637     CALL 'kxdfhei1' USING DFHEIV0,
  2638           w-doctoken,
  2639           DFHEIV99,
  2640           DFHEIVL0,
  2641           output-data,
  2642           DFHEIV16,
  2643           DFHEIV99,
  2644           DFHEIV99,
  2645           DFHEIV99
  2646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2647
  2648* exec cics web send
  2649*       doctoken(w-doctoken)
  2650*    end-exec
  2651*    MOVE 'X$D                   *   #00002460' TO DFHEIV0
  2652     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2653     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2654     MOVE X'2020233030303032343630' TO DFHEIV0(25:11)
  2655     CALL 'kxdfhei1' USING DFHEIV0,
  2656           w-doctoken,
  2657           DFHEIV99,
  2658           DFHEIV99,
  2659           DFHEIV99,
  2660           DFHEIV99,
  2661           DFHEIV99,
  2662           DFHEIV99,
  2663           DFHEIV99,
  2664           DFHEIV99
  2665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2666     .
  2667 1030-exit.
  2668     exit.
  2669 1050-disconnect.
  2670     if connected-to-db
  2671        EXEC SQL
  2672            disconnect all
  2673        END-EXEC
  2674        move ' ' to ws-connect-sw
  2675     end-if
  2676     .
  2677 1050-exit.
  2678     exit.
  2679 2000-process-written.
  2680     perform 2010-open-files     thru 2010-exit
  2681     perform 2020-init           thru 2020-exit
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  48
* EL201.cbl
  2682     perform 2050-process-input  thru 2050-exit until
  2683        end-of-input
  2684     if ws-writ-cnt > zeros
  2685        move ws-writ-cnt         to ws-t1-cnt
  2686        move ' Written '         to ws-t1-chks
  2687        move ws-tot-writ-amt     to ws-t1-amount
  2688     else
  2689        perform 4010-write-headings
  2690                                 thru 4010-exit
  2691        move spaces              to ws-total1
  2692        string ' No checks for '
  2693           ws-work-comp-id
  2694           ' today. ' delimited by size into ws-total1
  2695        end-string
  2696     end-if
  2697     move spaces                 to cps-written-rpt-rec
  2698     perform 4020-write-a-line   thru 4020-exit
  2699     move ws-total1              to cps-written-rpt-rec
  2700     perform 4020-write-a-line   thru 4020-exit
  2701     perform 2500-close-files    thru 2500-exit
  2702     perform 5000-submit-job     thru 5000-exit
  2703     .
  2704 2000-exit.
  2705     exit.
  2706 2010-open-files.
  2707     if ws-kix-myenv = 'cid1p'
  2708        move 'NTCSO2_ChkApprv'   to svr
  2709        move 'sa'                to usr
  2710        move 'ntcso2'            to pass
  2711        move '/data/seqfiles/'   to ws-work-dir
  2712        move 'cd /apps/prod/cid1p/jcl'
  2713                                 to tran-data-line1
  2714        move ws-kix-myenv        to ws-work-env
  2715     else
  2716        move 'NTSQLTST2_Logic'   to svr
  2717        move 'sa'                to usr
  2718        move 'sql2008r2'         to pass
  2719        move ws-kix-myenv        to ws-work-env
  2720        string
  2721           '/data/test/' delimited by size
  2722           ws-work-env   delimited by space
  2723           '/seqfiles/'  delimited by size
  2724              into ws-work-dir
  2725        end-string
  2726        string
  2727           'cd /apps/test/' delimited by size
  2728           ws-work-env      delimited by space
  2729           '/jcl'           delimited by size
  2730              into tran-data-line1
  2731        end-string
  2732     end-if
  2733     move function upper-case(ws-comp-id)
  2734                                 to ws-work-comp-id
  2735     move 'miscpymts.csv'        to ws-work-file-in
  2736     move 'cilg201b'             to ws-work-job-name
  2737     if ws-work-comp-id = 'AHL'
  2738        move 'miscpymtsahl.csv'  to ws-work-file-in
  2739        move 'ahlg201b'          to ws-work-job-name
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  49
* EL201.cbl
  2740     end-if
  2741     move spaces                 to ws-written-in
  2742                                    ws-written-rpt
  2743     string
  2744        ws-work-dir delimited by space
  2745        ws-work-file-in delimited by space
  2746           into ws-written-in
  2747     end-string
  2748     move 'miscpymts.rpt'        to ws-work-rpt-out
  2749     string
  2750        ws-work-dir delimited by space
  2751        ws-work-comp-id delimited by size
  2752        ws-work-rpt-out delimited by size
  2753           into ws-written-rpt
  2754     end-string
  2755     string
  2756        'unikixjob '     delimited by size
  2757        ws-work-job-name delimited by size
  2758        ' -k '           delimited by size
  2759        ws-work-env      delimited by space
  2760           into tran-data-line2
  2761     end-string
  2762*     display ' svr    ' svr
  2763*     display ' user   ' usr
  2764*     display ' pw     ' pass
  2765*     display ' input  ' ws-written-in
  2766*     display ' output ' ws-written-rpt
  2767*     display '        '
  2768*     display ' line 1 ' tran-data-line1
  2769*     display ' line 2 ' tran-data-line2
  2770     open input CPS-WRITTEN-IN
  2771         output CPS-WRITTEN-RPT
  2772     if written-status not = '00'
  2773        display 'error written open ' written-status
  2774        move ' Invalid or missing file '
  2775                                 to output-msg
  2776        go to 0000-return
  2777     end-if
  2778     .
  2779 2010-exit.
  2780     exit.
  2781 2020-init.
  2782     move spaces                 to ws-detail1
  2783     move ws-hd1-written         to ws-head1
  2784     move 'EL201B'               to ws-h1-rpt-id
  2785     move ws-hd4-written         to ws-heading4
  2786     move 'Posting of Written Checks '
  2787                                 to output-title
  2788*    if ws-comp-id = 'AHL'
  2789*       move 'ahlg201b'          to tdl2-job
  2790*    else
  2791*       move 'cilg201b'          to tdl2-job
  2792*    end-if
  2793     if not connected-to-db
  2794        perform 1000-connect-db  thru 1000-exit
  2795     end-if
  2796***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2797***                                                            ***
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  50
* EL201.cbl
  2798**     I do 2 reads to bypass the header record                ***
  2799***                                                            ***
  2800***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2801     perform 2040-read-input     thru 2040-exit
  2802     perform 2040-read-input     thru 2040-exit
  2803     .
  2804 2020-exit.
  2805     exit.
  2806 2040-read-input.
  2807     read CPS-WRITTEN-IN at end
  2808        set end-of-input   to true
  2809     end-read
  2810     if not end-of-input
  2811        add 1 to ws-in-recs
  2812     end-if
  2813     .
  2814 2040-exit.
  2815     exit.
  2816 2050-process-input.
  2817     move spaces                 to ws-raw-record
  2818                                    ws-written-rec
  2819     unstring cps-written-in-rec
  2820        delimited by ',' into
  2821           raw-check-no
  2822           raw-check-dt
  2823           raw-check-amt
  2824           raw-vendor-id
  2825           raw-user-defined
  2826           raw-voucher-ref
  2827     end-unstring
  2828*    display ' chk no    **' wsw-check-no '**'
  2829*    display ' chk dt    **' wsw-check-dt '**'
  2830*    display ' chk amt   **' wsw-check-amt '**'
  2831*    display ' vend id   **' wsw-vendor-id '**'
  2832*    display ' user def  **' wsw-user-defined '**'
  2833*    display ' vouch ref **' wsw-voucher-ref '**'
  2834***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2835***                                                            ***
  2836***    Every now and then I get bogus records with quotes      ***
  2837***  so I am just going to remove them.  These are normally    ***
  2838***  a result of a manual process that should not be included  ***
  2839***  in this file.                                             ***
  2840***                                                            ***
  2841***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2842
  2843     move +1                     to o1
  2844     perform varying i1 from +1 by +1 until i1 > +20
  2845        if raw-check-no (i1:1) <> '"'
  2846           move raw-check-no (i1:1)
  2847                                 to wsw-check-no (o1:1)
  2848           add +1 to o1
  2849        end-if
  2850     end-perform
  2851
  2852     move +1                     to o1
  2853     perform varying i1 from +1 by +1 until i1 > +20
  2854        if raw-check-dt (i1:1) <> '"'
  2855           move raw-check-dt (i1:1)
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  51
* EL201.cbl
  2856                                 to wsw-check-dt (o1:1)
  2857           add +1 to o1
  2858        end-if
  2859     end-perform
  2860
  2861     move +1                     to o1
  2862     perform varying i1 from +1 by +1 until i1 > +15
  2863        if raw-check-amt (i1:1) <> '"'
  2864           move raw-check-amt (i1:1)
  2865                                 to wsw-check-amt (o1:1)
  2866           add +1 to o1
  2867        end-if
  2868     end-perform
  2869
  2870     move +1                     to o1
  2871     perform varying i1 from +1 by +1 until i1 > +20
  2872        if raw-vendor-id (i1:1) <> '"'
  2873           move raw-vendor-id (i1:1)
  2874                                 to wsw-vendor-id (o1:1)
  2875           add +1 to o1
  2876        end-if
  2877     end-perform
  2878
  2879     move +1                     to o1
  2880     perform varying i1 from +1 by +1 until i1 > +30
  2881        if raw-user-defined (i1:1) <> '"'
  2882           move raw-user-defined (i1:1)
  2883                                 to wsw-user-defined (o1:1)
  2884           add +1 to o1
  2885        end-if
  2886     end-perform
  2887
  2888     move +1                     to o1
  2889     perform varying i1 from +1 by +1 until i1 > +35
  2890        if raw-voucher-ref (i1:1) <> '"'
  2891           move raw-voucher-ref (i1:1)
  2892                                 to wsw-voucher-ref (o1:1)
  2893           add +1 to o1
  2894        end-if
  2895     end-perform
  2896     if (wsw-check-no = spaces)
  2897        and (wsw-check-dt = spaces)
  2898        and (wsw-check-amt = spaces)
  2899        display ' empty record ' cps-written-in-rec
  2900        go to 2050-read
  2901     end-if
  2902     string wsw-check-dt (1:4)
  2903            wsw-check-dt (6:2)
  2904            wsw-check-dt (9:2)
  2905        delimited by size into dc-greg-date-cymd-r
  2906     end-string
  2907     move 'L'                    to dc-option-code
  2908     perform 9700-date-convert   thru 9700-exit
  2909     if no-conversion-error
  2910        move dc-bin-date-1       to ws-bin-check-dt
  2911     else
  2912        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2913           dc-error-code
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  52
* EL201.cbl
  2914     end-if
  2915     perform varying s1 from +1 by +1 until
  2916        (s1 > +28)
  2917        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2918          'CANCEL')
  2919     end-perform
  2920     if s1 < +29
  2921        move 'Bypass- Manual Entry'    to ws-d1-message
  2922        move ' '                 to ws-table-sw
  2923        go to 2050-continue
  2924     end-if
  2925*    if wsw-user-defined (1:3) not numeric
  2926*       move 'Bypass- Manual Entry'
  2927*                                to ws-d1-message
  2928*       move ' '                 to ws-table-sw
  2929*       go to 2050-continue
  2930*    end-if
  2931     perform varying s1 from +1 by +1 until
  2932        (s1 > +30)
  2933        or (wsw-user-defined (s1:1) = ' ')
  2934     end-perform
  2935     if (s1 < +12)
  2936        and (s1 > +8)
  2937        continue
  2938     else
  2939        move 'Bypass- Manual Entry'
  2940                                 to ws-d1-message
  2941        move ' '                 to ws-table-sw
  2942        go to 2050-continue
  2943     end-if
  2944     move spaces                 to wsw-check-key
  2945     perform varying s1 from +30 by -1 until
  2946        (s1 < +1)
  2947        or (wsw-user-defined (s1:1) numeric)
  2948     end-perform
  2949     if s1 > +7
  2950        move wsw-user-defined (s1 - 6:7)
  2951                                 to wsw-check-key
  2952     else
  2953        move 'Invalid Input CK-KEY'    to ws-d1-message
  2954        go to 2050-continue
  2955     end-if
  2956*    go to 2050-read
  2957     move ' '                    to ws-erchek-sw
  2958                                    ws-table-sw
  2959     perform 2200-get-tbl-row    thru 2200-exit
  2960     if sqlcode = 0
  2961        set table-found          to true
  2962        perform 1020-read-erchek thru 1020-exit
  2963        if resp-normal
  2964           set erchek-found to true
  2965           perform 2310-upd-erchek
  2966                                 thru 2310-exit
  2967           perform 2320-upd-table thru 2320-exit
  2968        else
  2969           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2970              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2971              ' ' ws-response
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  53
* EL201.cbl
  2972           move ' chk rec not found ' to ws-d1-message
  2973        end-if
  2974     else
  2975        move ' tbl row not found ' to ws-d1-message
  2976     end-if
  2977     .
  2978 2050-continue.
  2979     perform 2400-build-print-line thru 2400-exit
  2980     .
  2981 2050-read.
  2982     perform 2040-read-input     thru 2040-exit
  2983     .
  2984 2050-exit.
  2985     exit.
  2986 2200-get-tbl-row.
  2987***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2988***                                                            ***
  2989***  I'm only expecting one row so no cursor is declared       ***
  2990***                                                            ***
  2991***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2992     move ws-comp-id             to ws-compid
  2993     move wsw-check-key-num      to ws-check-key
  2994     move 1                      to ws-type
  2995     exec sql
  2996        SELECT
  2997           CheckKey,
  2998           Company,
  2999           CertCarrier,
  3000           CertGroup,
  3001           CertState,
  3002           CertAccount,
  3003           CertEffDate,
  3004           CertNumber,
  3005           CertNumberSuf,
  3006           CheckSeqNbr,
  3007           CheckType,
  3008           CheckAmount,
  3009           Preparer,
  3010           CheckSubType
  3011        INTO
  3012           :db-checkkey,
  3013           :db-compid,
  3014           :db-carrier,
  3015           :db-grouping,
  3016           :db-state,
  3017           :db-account,
  3018           :db-effdate,
  3019           :db-certificate,
  3020           :db-cert-sfx,
  3021           :db-seq-no,
  3022           :db-type,
  3023           :db-amount,
  3024           :db-preparer,
  3025           :db-check-sub-type
  3026        FROM
  3027           ChkApp_Check
  3028        WHERE
  3029           (CheckKey    = :ws-check-key)
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  54
* EL201.cbl
  3030           and (Company = :ws-compid)
  3031     end-exec
  3032     if sqlcode not = 0
  3033        move sqlcode to ws-sql-code
  3034        move ws-sql-code to ws-dis-sql-code
  3035        display ' dis sql code ' ws-dis-sql-code
  3036        display "Error: cannot read row "
  3037        display ' sql return code ' sqlcode
  3038        display ' sql err mess    ' sqlerrmc
  3039     end-if
  3040     .
  3041 2200-exit.
  3042     exit.
  3043 2310-upd-erchek.
  3044     move ws-bin-check-dt        to ch-check-written-dt
  3045     if wsw-check-no (1:1) = '"'
  3046        move wsw-check-no (5:7)  to ch-check-no
  3047     else
  3048        move wsw-check-no (4:7)  to ch-check-no
  3049     end-if
  3050*    move zeros                  to ws-response
  3051
  3052* exec cics rewrite
  3053*       dataset     ('ERCHEK')
  3054*       from        (check-records)
  3055*       resp        (ws-response)
  3056*    end-exec
  3057     MOVE LENGTH OF
  3058      check-records
  3059       TO DFHEIV11
  3060     MOVE 'ERCHEK' TO DFHEIV1
  3061*    MOVE '&& L                  %  N#00002848' TO DFHEIV0
  3062     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3063     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3064     MOVE X'204E233030303032383438' TO DFHEIV0(25:11)
  3065     CALL 'kxdfhei1' USING DFHEIV0,
  3066           DFHEIV1,
  3067           check-records,
  3068           DFHEIV11,
  3069           DFHEIV99
  3070     MOVE EIBRESP  TO ws-response
  3071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3072     if resp-normal
  3073        add 1 to ws-writ-cnt
  3074        compute ws-tot-writ-amt =
  3075           ws-tot-writ-amt + ch-amount-paid
  3076        move 'Successful Post '  to ws-d1-message
  3077     else
  3078        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  3079     end-if
  3080     .
  3081 2310-exit.
  3082     exit.
  3083 2320-upd-table.
  3084     string wsw-check-dt (6:2) '/'
  3085            wsw-check-dt (9:2) '/'
  3086            wsw-check-dt (1:4)
  3087        delimited by size into db-checkdate
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  55
* EL201.cbl
  3088     move ch-check-no            to db-checkno
  3089*    move zeros to sqlcode
  3090     EXEC SQL
  3091        UPDATE
  3092           ChkApp_Check
  3093        SET
  3094           CheckNumber = :db-checkno,
  3095           CheckDate = :db-checkdate
  3096        WHERE
  3097           CheckKey = :db-checkkey
  3098     END-EXEC
  3099     if sqlcode not = 0
  3100        move 'Table not updated ' to ws-d1-message
  3101        display "Error: cannot update table   "
  3102        display ' sql retrun code ' sqlcode
  3103        display ' sql err mess    ' sqlerrmc
  3104     end-if
  3105     .
  3106 2320-exit.
  3107     exit.
  3108 2400-build-print-line.
  3109     if table-found
  3110        move db-carrier          to ws-d1-carr
  3111        move db-grouping         to ws-d1-grp
  3112        move db-state            to ws-d1-state
  3113        move db-account          to ws-d1-account
  3114        string
  3115           db-effdate (6:2)   '/'
  3116           db-effdate (9:2)   '/'
  3117           db-effdate (1:4)
  3118           delimited by size into ws-d1-eff-dt
  3119        end-string
  3120        move db-certificate      to ws-d1-cert-no
  3121        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3122        if db-check-sub-type = '2'
  3123           move 'COR'            to ws-d1-chk-type
  3124        else
  3125           move 'REF'            to ws-d1-chk-type
  3126        end-if
  3127        move +10                 to s2
  3128        move zeros               to ws-work-amt-alpha
  3129        perform varying s1 from +10 by -1 until s1 < +1
  3130           if db-amount (s1:1) numeric
  3131              move db-amount (s1:1)
  3132                                 to ws-work-amt-alpha (s2:1)
  3133              subtract +1 from s2
  3134           end-if
  3135        end-perform
  3136        move ws-work-amt-num     to ws-d1-chk-amt
  3137        move db-preparer         to ws-d1-preparer
  3138        move db-checkno          to ws-d1-chk-no
  3139        move db-checkdate        to ws-d1-writ-cash-dt
  3140     else
  3141        move wsw-check-no        to ws-d1-chk-no
  3142     end-if
  3143     perform 4000-write-report   thru 4000-exit
  3144     move spaces                 to ws-detail1
  3145     .
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  56
* EL201.cbl
  3146 2400-exit.
  3147     exit.
  3148 2500-close-files.
  3149     close cps-written-in cps-written-rpt
  3150     .
  3151 2500-exit.
  3152     exit.
  3153 4000-write-report.
  3154     if ws-line-cntr > ws-max-lines
  3155        move zeros               to ws-line-cntr
  3156        perform 4010-write-headings thru 4010-exit
  3157     end-if
  3158     move ws-detail1             to cps-written-rpt-rec
  3159     perform 4020-write-a-line   thru 4020-exit
  3160     .
  3161 4000-exit.
  3162     exit.
  3163 4010-write-headings.
  3164     add 1 to ws-page-cntr
  3165     move ws-page-cntr           to ws-h3-page
  3166     move ws-heading1            to cps-written-rpt-rec
  3167     perform 4020-write-a-line   thru 4020-exit
  3168     move ws-heading2            to cps-written-rpt-rec
  3169     perform 4020-write-a-line   thru 4020-exit
  3170     move ws-heading3            to cps-written-rpt-rec
  3171     perform 4020-write-a-line   thru 4020-exit
  3172     move spaces                 to cps-written-rpt-rec
  3173     perform 4020-write-a-line   thru 4020-exit
  3174     move spaces                 to cps-written-rpt-rec
  3175     perform 4020-write-a-line   thru 4020-exit
  3176     move ws-heading4            to cps-written-rpt-rec
  3177     perform 4020-write-a-line   thru 4020-exit
  3178     move spaces                 to cps-written-rpt-rec
  3179     perform 4020-write-a-line   thru 4020-exit
  3180     .
  3181 4010-exit.
  3182     exit.
  3183 4020-write-a-line.
  3184     write cps-written-rpt-rec
  3185     add 1 to ws-line-cntr
  3186     .
  3187 4020-exit.
  3188     exit.
  3189 5000-submit-job.
  3190
  3191* EXEC CICS WRITEQ TD
  3192*       QUEUE ('BTCH')
  3193*       FROM (TRAN-DATA-LINE1)
  3194*       LENGTH (80)
  3195*    END-EXEC
  3196     MOVE 80
  3197       TO DFHEIV11
  3198     MOVE 'BTCH' TO DFHEIV5
  3199*    MOVE '(" L                  &   #00002971' TO DFHEIV0
  3200     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3201     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3202     MOVE X'2020233030303032393731' TO DFHEIV0(25:11)
  3203     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  57
* EL201.cbl
  3204           DFHEIV5,
  3205           TRAN-DATA-LINE1,
  3206           DFHEIV11,
  3207           DFHEIV99,
  3208           DFHEIV99
  3209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3210
  3211* EXEC CICS WRITEQ TD
  3212*       QUEUE ('BTCH')
  3213*       FROM (TRAN-DATA-LINE2)
  3214*       LENGTH (80)
  3215*    END-EXEC
  3216     MOVE 80
  3217       TO DFHEIV11
  3218     MOVE 'BTCH' TO DFHEIV5
  3219*    MOVE '(" L                  &   #00002976' TO DFHEIV0
  3220     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3222     MOVE X'2020233030303032393736' TO DFHEIV0(25:11)
  3223     CALL 'kxdfhei1' USING DFHEIV0,
  3224           DFHEIV5,
  3225           TRAN-DATA-LINE2,
  3226           DFHEIV11,
  3227           DFHEIV99,
  3228           DFHEIV99
  3229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3230     .
  3231 5000-exit.
  3232     exit.
  3233 9700-DATE-CONVERT.
  3234
  3235* EXEC CICS LINK
  3236*         PROGRAM  ('ELDATCV')
  3237*         COMMAREA (DATE-CONVERSION-DATA)
  3238*         LENGTH   (DC-COMM-LENGTH)
  3239*    END-EXEC.
  3240     MOVE 'ELDATCV' TO DFHEIV1
  3241*    MOVE '."C                   (   #00002985' TO DFHEIV0
  3242     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3244     MOVE X'2020233030303032393835' TO DFHEIV0(25:11)
  3245     CALL 'kxdfhei1' USING DFHEIV0,
  3246           DFHEIV1,
  3247           DATE-CONVERSION-DATA,
  3248           DC-COMM-LENGTH,
  3249           DFHEIV99,
  3250           DFHEIV99,
  3251           DFHEIV99,
  3252           DFHEIV99
  3253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3254
  3255 9700-EXIT.
  3256      EXIT.
  3257
  3258 9999-DFHBACK SECTION.
  3259     MOVE '9%                    "   ' TO DFHEIV0
  3260     MOVE 'EL201' TO DFHEIV1
  3261     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 08-Feb-16 13:43 Page  58
* EL201.cbl
  3262     GOBACK.
  3263 9999-DFHEXIT.
  3264     IF DFHEIGDJ EQUAL 0001
  3265         NEXT SENTENCE.
  3266     MOVE '9%                    "   ' TO DFHEIV0
  3267     MOVE 'EL201' TO DFHEIV1
  3268     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3269     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      139676     Code:       10667
