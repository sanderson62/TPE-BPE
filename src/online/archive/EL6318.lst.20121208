* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29*-----------------------------------------------------------------
    30*REMARKS.
    31*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6318.cbl
    33 ENVIRONMENT DIVISION.
    34 DATA DIVISION.
    35 WORKING-STORAGE SECTION.
    36 01  DFH-START PIC X(04).
    37 77  FILLER  PIC X(32)  VALUE '********************************'.
    38 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    39 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    40 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    41 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    42 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    43 77  s1                          pic s999 comp-3 value +0.
    44 77  s2                          pic s999 comp-3 value +0.
    45 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    46 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    47     88  ACCT-FOUND                 VALUE 'Y'.
    48 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    49 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    50 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    51 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    52 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    53 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    54 77  WS-REASON-SW                PIC X  VALUE ' '.
    55     88  REASONS-FOUND                  VALUE 'Y'.
    56     88  REASONS-NOT-FOUND              VALUE 'N'.
    57 77  WS-STOP-SW                  PIC X  VALUE ' '.
    58     88  I-SAY-TO-STOP      VALUE 'Y'.
    59 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    60     88  NO-CERT-RW                 VALUE 'N'.
    61     88  CERT-RW                    VALUE 'Y'.
    62 01  P pointer.
    63 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    64 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    65 01  var-ptr pointer.
    66 01  env-var-len                 pic 9(4)  binary.
    67 01  rc                          pic 9(9)  binary.
    68 01  WS-KIXHOST                  PIC X(10).
    69 01  WS-KIXSYS.
    70     05  WS-KIX-FIL1             PIC X(10).
    71     05  WS-KIX-APPS             PIC X(10).
    72     05  WS-KIX-ENV              PIC X(10).
    73     05  WS-KIX-MYENV            PIC X(10).
    74     05  WS-KIX-SYS              PIC X(10).
    75*                                COPY ELCSCTM.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ELCSCTM                             *
    80*                            VMOD=2.001                          *
    81*                                                                *
    82*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    83*                                                                *
    84******************************************************************
    85 01  SECURITY-MESSAGE.
    86     12  FILLER                          PIC X(30)
    87            VALUE '** LOGIC SECURITY VIOLATION -'.
    88     12  SM-READ                         PIC X(6).
    89     12  FILLER                          PIC X(5)
    90            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6318.cbl
    91     12  SM-PGM                          PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' OPR='.
    94     12  SM-PROCESSOR-ID                 PIC X(4).
    95     12  FILLER                          PIC X(6)
    96            VALUE ' TERM='.
    97     12  SM-TERMID                       PIC X(4).
    98     12  FILLER                          PIC XX   VALUE SPACE.
    99     12  SM-JUL-DATE                     PIC 9(5).
   100     12  FILLER                          PIC X    VALUE SPACE.
   101     12  SM-TIME                         PIC 99.99.
   102
   103*                                COPY ELCSCRTY.
   104******************************************************************
   105*                                                                *
   106*                                                                *
   107*                            ELCSCRTY                            *
   108*                            VMOD=2.001                          *
   109*                                                                *
   110*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   111*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   112*        SAVED IN PI-SECURITY-ADDRESS.                           *
   113*                                                                *
   114******************************************************************
   115 01  SECURITY-CONTROL.
   116     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   117     12  FILLER                       PIC XX    VALUE 'SC'.
   118     12  SC-CREDIT-CODES.
   119         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   120             20  SC-CREDIT-DISPLAY    PIC X.
   121             20  SC-CREDIT-UPDATE     PIC X.
   122     12  SC-CLAIMS-CODES.
   123         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   124             20  SC-CLAIMS-DISPLAY    PIC X.
   125             20  SC-CLAIMS-UPDATE     PIC X.
   126 01 srch-commarea.
   127*                                copy ELCADLTRSPI.
   128******************************************************************
   129*                   C H A N G E   L O G
   130*
   131* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   132*-----------------------------------------------------------------
   133*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   134* EFFECTIVE    NUMBER
   135*-----------------------------------------------------------------
   136* 060611    2011022800001  PEMA  NEW COPYBOOK
   137******************************************************************
   138****************************************
   139*  commarea for NaperSoft On Demand Admin services letters
   140*  (business logic input & output)
   141****************************************
   142     03  BL-INPUT.
   143         05  BL-DATA-SRCE        PIC X.
   144         05  BL-LETTER-ID        PIC XXXX.
   145         05  BL-CARRIER          PIC X.
   146         05  BL-GROUP            PIC X(6).
   147         05  BL-STATE            PIC XX.
   148         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6318.cbl
   149         05  BL-EFF-DT           PIC X(10).
   150         05  BL-CERT-NO          PIC X(11).
   151         05  BL-BATCH-NO         PIC X(6).
   152         05  BL-BATCH-SEQ        PIC 9(8).
   153         05  BL-RESP-NO          PIC X(10).
   154         05  BL-NO-OF-COPIES     PIC 99.
   155         05  BL-PROC-ID          PIC XXXX.
   156         05  BL-COMP-ID          PIC XXX.
   157         05  BL-PRINT-NOW-SW     PIC X.
   158         05  BL-ENC-CD           PIC XXX.
   159         05  BL-RESEND-DT        PIC X(10).
   160         05  BL-FOLLOW-UP-DT     PIC X(10).
   161         05  BL-ARCHIVE-NO       PIC 9(8).
   162         05  BL-FUNC             PIC X(8).
   163         05  BL-COMMENTS         PIC X(70).
   164         05  FILLER REDEFINES BL-COMMENTS.
   165             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   166             10  BL-LETTER-TO-ACCT PIC X.
   167             10  BL-LETTER-TO-BENE PIC X.
   168             10  BL-WRITE-ERARCH   PIC X.
   169                 88  ERARCH-QWS      VALUE 'Q'.
   170                 88  ERARCH-BATCH    VALUE 'B'.
   171                 88  ERARCH-TEMP     VALUE 'T'.
   172             10  BL-PROCESS-TYPE PIC X(07).
   173             10  BL-CERT-FORM-ID PIC X(05).
   174             10  FILLER          PIC X(07).
   175     03  BL-OUTPUT.
   176         05  BL-STATUS                   PIC X.
   177             88  BL-OK                      VALUE "P".
   178             88  BL-FAIL                  VALUE "F".
   179         05  BL-MESSAGE          PIC X(50).
   180     03  BL-RECORD-PASSED-DATA   PIC X(4754).
   181
   182*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   183*                                COPY ELCZREC.
   184******************************************************************
   185*                                                                *
   186*                                                                *
   187*                            ELCZREC.                            *
   188*                                                                *
   189*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   190*                                                                *
   191******************************************************************
   192*-----------------------------------------------------------------
   193*                   C H A N G E   L O G
   194*
   195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   196*-----------------------------------------------------------------
   197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   198* EFFECTIVE    NUMBER
   199*-----------------------------------------------------------------
   200* 122011    2011022800001  AJRA  NEW FILE
   201* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   202*-----------------------------------------------------------------
   203 01  W-Z-CONTROL-DATA.
   204     05  W-NUMBER-OF-COPIES      PIC  9.
   205     05  FILLER                  PIC  X.
   206     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6318.cbl
   207     05  FILLER                  PIC  X.
   208     05  W-DAYS-TO-RESEND        PIC  999.
   209     05  FILLER                  PIC  X.
   210     05  W-FORM-TO-RESEND        PIC  X(4).
   211     05  FILLER                  PIC  X.
   212     05  W-PROMPT-LETTER         PIC  X.
   213     05  FILLER                  PIC  X.
   214     05  W-ENCLOSURE-CD          PIC  XXX.
   215     05  FILLER                  PIC  X.
   216     05  W-AUTO-CLOSE-IND        PIC  X.
   217     05  FILLER                  PIC  X.
   218     05  W-LETTER-TO-BENE        PIC  X.
   219     05  FILLER                  PIC  X.
   220     05  W-LETTER-TO-ACCT        PIC  X.
   221     05  FILLER                  PIC  X.
   222     05  W-LETTER-TYPE           PIC  X.
   223     05  FILLER                  PIC  X.
   224     05  W-PRINT-CERTIFICATE     PIC  X.
   225     05  FILLER                  PIC  X.
   226     05  W-REFUND-REQUIRED       PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-ONBASE-CODE           PIC  XX.
   229     05  FILLER                  PIC  X.
   230     05  W-ACCT-SUMM             PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-CSO-SUMM              PIC  X.
   233     05  FILLER                  PIC  X(31).
   234 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   235 01  STANDARD-AREAS.
   236     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   237     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   238                                 PIC  X(08).
   239     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   240     12  QID.
   241         16  QID-TERM        PIC X(4)    VALUE SPACES.
   242         16  FILLER          PIC X(4)    VALUE '631K'.
   243     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   244     12  TIME-MT                 PIC S9(7).
   245     12  TIME-MT-R  REDEFINES TIME-MT.
   246         16  FILLER              PIC X.
   247         16  TIME-LMT            PIC 99V99.
   248         16  FILLER              PIC X(2).
   249     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   250     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   251     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   252     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   253     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   254     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   255     12  W-CNTL-KEY.
   256         16  W-CNTL-COMPANY-ID   PIC  X(03).
   257         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   258         16  W-CNTL-GENL.
   259             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   260             20  W-CNTL-GEN2.
   261                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   262                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   263         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   264     12  WS-ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6318.cbl
   265         16  W-CERT-COMPANY-CD   PIC X.
   266         16  W-CERT-CARRIER      PIC X.
   267         16  W-CERT-GROUPING     PIC X(6).
   268         16  W-CERT-STATE        PIC XX.
   269         16  W-CERT-ACCOUNT      PIC X(10).
   270         16  W-CERT-CERT-EFF-DT  PIC XX.
   271         16  W-CERT-CERT-PRIME   PIC X(10).
   272         16  W-CERT-CERT-SFX     PIC X.
   273     12  WS-ELEOBC-KEY.
   274         16  WS-EOBC-COMPANY-CD  PIC X.
   275         16  WS-EOBC-REC-TYPE    PIC X.
   276         16  WS-EOBC-CODE        PIC X(4).
   277         16  FILLER              PIC X(9).
   278     12  WS-ERNOTE-KEY.
   279         16  W-NOTE-COMPANY-CD   PIC X.
   280         16  W-NOTE-CARRIER      PIC X.
   281         16  W-NOTE-GROUPING     PIC X(6).
   282         16  W-NOTE-STATE        PIC XX.
   283         16  W-NOTE-ACCOUNT      PIC X(10).
   284         16  W-NOTE-CERT-EFF-DT  PIC XX.
   285         16  W-NOTE-CERT-PRIME   PIC X(10).
   286         16  W-NOTE-CERT-SFX     PIC X.
   287     12  ELLETR-KEY.
   288         16  LETR-COMPANY-CD     PIC X.
   289         16  LETR-LETTER-ID      PIC X(4).
   290         16  LETR-FILLER         PIC X(8).
   291         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   292     12  ERPNDB2-KEY.
   293         16  PNDB2-COMPANY-CD    PIC X.
   294         16  PNDB2-CARRIER       PIC X.
   295         16  PNDB2-GROUPING      PIC X(6).
   296         16  PNDB2-STATE         PIC XX.
   297         16  PNDB2-ACCOUNT       PIC X(10).
   298         16  PNDB2-CERT-EFF-DT   PIC XX.
   299         16  PNDB2-CERT-PRIME    PIC X(10).
   300         16  PNDB2-CERT-SFX      PIC X.
   301         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   302         16  PNDB2-RECORD-TYPE   PIC X.
   303     12  ERPNDB-KEY.
   304         16  PNDB-COMPANY-CD     PIC X.
   305         16  PNDB-BATCH-NO       PIC X(6).
   306         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   307         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   308     12  ERENDT-KEY.
   309         16  ENDT-COMPANY-CD       PIC X.
   310         16  ENDT-CARRIER          PIC X.
   311         16  ENDT-GROUPING         PIC X(6).
   312         16  ENDT-STATE            PIC XX.
   313         16  ENDT-ACCOUNT          PIC X(10).
   314         16  ENDT-CERT-EFF-DT      PIC XX.
   315         16  ENDT-CERT-PRIME       PIC X(10).
   316         16  ENDT-CERT-SFX         PIC X.
   317         16  ENDT-RECORD-TYPE      PIC X.
   318         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   319     12  ELCRTO-KEY.
   320         16  CRTO-COMPANY-CD     PIC X.
   321         16  CRTO-CARRIER        PIC X.
   322         16  CRTO-GROUPING       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6318.cbl
   323         16  CRTO-STATE          PIC XX.
   324         16  CRTO-ACCOUNT        PIC X(10).
   325         16  CRTO-CERT-EFF-DT    PIC XX.
   326         16  CRTO-CERT-PRIME     PIC X(10).
   327         16  CRTO-CERT-SFX       PIC X.
   328         16  CRTO-RECORD-TYPE    PIC X.
   329         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   330     12  WS-ERMAIL-KEY.
   331         16  MAIL-COMPANY-CD     PIC X.
   332         16  MAIL-CARRIER        PIC X.
   333         16  MAIL-GROUPING       PIC X(6).
   334         16  MAIL-STATE          PIC XX.
   335         16  MAIL-ACCOUNT        PIC X(10).
   336         16  MAIL-CERT-EFF-DT    PIC XX.
   337         16  MAIL-CERT-PRIME     PIC X(10).
   338         16  MAIL-CERT-SFX       PIC X.
   339     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   340     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   341     12  WS-CURRENT-DT.
   342         16  FILLER              PIC X(6)    VALUE SPACES.
   343         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   344     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   345     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   346         88  CANCEL-REC            VALUE 'C'.
   347         88  ISSUE-REC             VALUE 'I'.
   348     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   349     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   350     12  ELCNTL-KEY.
   351         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   352         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   353         16  CNTL-ACCESS.
   354             20  CNTL-STATE      PIC XX    VALUE SPACES.
   355             20  FILLER          PIC X     VALUE SPACES.
   356             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   357         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   358     12  WS-ERACCT-KEY.
   359         16  ACCT-COMPANY-CD     PIC X.
   360         16  ACCT-CARRIER        PIC X.
   361         16  ACCT-GROUPING       PIC X(6).
   362         16  ACCT-STATE          PIC XX.
   363         16  ACCT-ACCOUNT        PIC X(10).
   364         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   365         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   366     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   367     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   368     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   369     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   370     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   371     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   372     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   373     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   374     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   375     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   376     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   377     12  WS-RESPONSE             PIC S9(8)   COMP.
   378         88  RESP-NORMAL                  VALUE +00.
   379         88  RESP-NOTFND                  VALUE +13.
   380         88  RESP-DUPREC                  VALUE +14.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6318.cbl
   381         88  RESP-DUPKEY                  VALUE +15.
   382         88  RESP-NOTOPEN                 VALUE +19.
   383         88  RESP-ENDFILE                 VALUE +20.
   384     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   385     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   386     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   387     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   388     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   389     12  PGM-NAME            PIC X(8).
   390     12  TIME-IN             PIC S9(7).
   391     12  TIME-OUT-R  REDEFINES TIME-IN.
   392         16  FILLER          PIC X.
   393         16  TIME-OUT        PIC 99V99.
   394         16  FILLER          PIC X(2).
   395     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   396     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   397     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   398     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   399     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   400     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   401     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   402     12  WS-PHONE.
   403         16  WS-PH1              PIC XXX.
   404         16  WS-PH2              PIC XXX.
   405         16  WS-PH3              PIC XXXX.
   406     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   407     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   408     12  WS-CERT-NOTE            PIC X(63).
   409
   410     12  WS-BILLING-NOTE.
   411         16  WS-BN-NOTE          PIC X(25).
   412         16  WS-BN-LTRID         PIC X(4).
   413         16  FILLER              PIC X(3).
   414         16  WS-BN-DATE          PIC X(8).
   415         16  FILLER              PIC X(3).
   416         16  WS-BN-USERID        PIC X(4).
   417         16  FILLER              PIC X(30).
   418
   419 01  NEW-ELCRTO-REC.
   420     12  NEW-ELCRTO-KEY.
   421         16  NCRTO-COMPANY-CD      PIC X.
   422         16  NCRTO-CARRIER         PIC X.
   423         16  NCRTO-GROUPING        PIC X(6).
   424         16  NCRTO-STATE           PIC XX.
   425         16  NCRTO-ACCOUNT         PIC X(10).
   426         16  NCRTO-CERT-EFF-DT     PIC XX.
   427         16  NCRTO-CERT-PRIME      PIC X(10).
   428         16  NCRTO-CERT-SFX        PIC X.
   429         16  NCRTO-RECORD-TYPE     PIC X.
   430         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   431     12  NEW-ORIG-REC.
   432         16  NCRTO-INS-LAST-NAME   PIC X(15).
   433         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   434         16  NCRTO-INS-MIDDLE-INIT PIC X.
   435         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   436         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   437         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   438         16  NCRTO-JNT-MIDDLE-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6318.cbl
   439         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   440         16  NCRTO-LF-BENCD        PIC XX.
   441         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   442         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   443         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   444         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   445         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   446         16  NCRTO-LF-EXP-DT       PIC XX.
   447         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   448         16  NCRTO-LF-CANCEL-DT    PIC XX.
   449         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   450         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   451         16  NCRTO-AH-BENCD        PIC XX.
   452         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   453         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   454         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   455         16  NCRTO-AH-EXP-DT       PIC XX.
   456         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   457         16  NCRTO-AH-CP           PIC 99.
   458         16  NCRTO-AH-CANCEL-DT    PIC XX.
   459         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   460         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   461         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   462         16  NCRTO-1ST-PMT-DT      PIC XX.
   463         16  FILLER                PIC X(239).
   464 01  ERROR-MESSAGES.
   465     12  ER-0000                 PIC X(4)  VALUE '0000'.
   466     12  ER-0004                 PIC X(4)  VALUE '0004'.
   467     12  ER-0008                 PIC X(4)  VALUE '0008'.
   468     12  ER-0023                 PIC X(4)  VALUE '0023'.
   469     12  ER-0029                 PIC X(4)  VALUE '0029'.
   470     12  ER-0068                 PIC X(4)  VALUE '0068'.
   471     12  ER-0132                 PIC X(4)  VALUE '0132'.
   472     12  ER-0142                 PIC X(4)  VALUE '0142'.
   473     12  ER-0148                 PIC X(4)  VALUE '0148'.
   474     12  ER-0215                 PIC X(4)  VALUE '0215'.
   475     12  ER-0280                 PIC X(4)  VALUE '0280'.
   476     12  ER-0348                 PIC X(4)  VALUE '0348'.
   477     12  ER-0419                 PIC X(4)  VALUE '0419'.
   478     12  ER-0715                 PIC X(4)  VALUE '0715'.
   479     12  ER-1101                 PIC X(4)  VALUE '1101'.
   480     12  ER-1236                 PIC X(4)  VALUE '1236'.
   481     12  ER-1778                 PIC X(4)  VALUE '1778'.
   482     12  ER-1818                 PIC X(4)  VALUE '1818'.
   483     12  ER-1820                 PIC X(4)  VALUE '1820'.
   484     12  ER-1821                 PIC X(4)  VALUE '1821'.
   485     12  ER-2056                 PIC X(4)  VALUE '2056'.
   486     12  ER-2079                 PIC X(4)  VALUE '2079'.
   487     12  ER-2208                 PIC X(4)  VALUE '2208'.
   488     12  ER-2209                 PIC X(4)  VALUE '2209'.
   489     12  ER-2237                 PIC X(4)  VALUE '2237'.
   490     12  ER-2238                 PIC X(4)  VALUE '2238'.
   491     12  ER-2253                 PIC X(4)  VALUE '2253'.
   492     12  ER-2619                 PIC X(4)  VALUE '2619'.
   493     12  ER-2651                 PIC X(4)  VALUE '2651'.
   494     12  ER-2784                 PIC X(4)  VALUE '2784'.
   495     12  ER-2785                 PIC X(4)  VALUE '2785'.
   496     12  ER-2786                 PIC X(4)  VALUE '2786'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6318.cbl
   497     12  ER-2791                 PIC X(4)  VALUE '2791'.
   498     12  ER-2845                 PIC X(4)  VALUE '2845'.
   499     12  ER-2848                 PIC X(4)  VALUE '2848'.
   500     12  ER-2851                 PIC X(4)  VALUE '2851'.
   501     12  ER-3830                 PIC X(4)  VALUE '3830'.
   502     12  ER-3832                 PIC X(4)  VALUE '3832'.
   503     12  ER-7345                 PIC X(4)  VALUE '7345'.
   504     12  ER-7638                 PIC X(4)  VALUE '7638'.
   505     12  ER-8888                 PIC X(4)  VALUE '8888'.
   506     12  ER-9999                 PIC X(4)  VALUE '9999'.
   507*    COPY ELCDATE.
   508******************************************************************
   509*                                                                *
   510*                                                                *
   511*                            ELCDATE.                            *
   512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   513*                            VMOD=2.003
   514*                                                                *
   515*                                                                *
   516*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   517*                 LENGTH = 200                                   *
   518******************************************************************
   519
   520 01  DATE-CONVERSION-DATA.
   521     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   522     12  DC-OPTION-CODE                PIC X.
   523         88  BIN-TO-GREG                VALUE ' '.
   524         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   525         88  EDIT-GREG-TO-BIN           VALUE '2'.
   526         88  YMD-GREG-TO-BIN            VALUE '3'.
   527         88  MDY-GREG-TO-BIN            VALUE '4'.
   528         88  JULIAN-TO-BIN              VALUE '5'.
   529         88  BIN-PLUS-ELAPSED           VALUE '6'.
   530         88  FIND-CENTURY               VALUE '7'.
   531         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   532         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   533         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   534         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   535         88  JULIAN-TO-BIN-3            VALUE 'C'.
   536         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   537         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   538         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   539         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   540         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   541         88  CHECK-LEAP-YEAR            VALUE 'H'.
   542         88  BIN-3-TO-GREG              VALUE 'I'.
   543         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   544         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   545         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   546         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   547         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   548         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   549         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   550         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   551         88  THREE-CHARACTER-BIN
   552                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   553         88  GREGORIAN-TO-BIN
   554                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6318.cbl
   555         88  BIN-TO-GREGORIAN
   556                  VALUES ' ' '1' 'I' '8' 'G'.
   557         88  JULIAN-TO-BINARY
   558                  VALUES '5' 'C' 'E' 'F'.
   559     12  DC-ERROR-CODE                 PIC X.
   560         88  NO-CONVERSION-ERROR        VALUE ' '.
   561         88  DATE-CONVERSION-ERROR
   562                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   563         88  DATE-IS-ZERO               VALUE '1'.
   564         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   565         88  DATE-IS-INVALID            VALUE '3'.
   566         88  DATE1-GREATER-DATE2        VALUE '4'.
   567         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   568         88  DATE-INVALID-OPTION        VALUE '9'.
   569         88  INVALID-CENTURY            VALUE 'A'.
   570         88  ONLY-CENTURY               VALUE 'B'.
   571         88  ONLY-LEAP-YEAR             VALUE 'C'.
   572         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   573     12  DC-END-OF-MONTH               PIC X.
   574         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   575     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   576         88  USE-NORMAL-PROCESS         VALUE ' '.
   577         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   578         88  ADJUST-UP-100-YRS          VALUE '2'.
   579     12  FILLER                        PIC X.
   580     12  DC-CONVERSION-DATES.
   581         16  DC-BIN-DATE-1             PIC XX.
   582         16  DC-BIN-DATE-2             PIC XX.
   583         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   584         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   585                       DC-GREG-DATE-1-EDIT.
   586             20  DC-EDIT1-MONTH        PIC 99.
   587             20  SLASH1-1              PIC X.
   588             20  DC-EDIT1-DAY          PIC 99.
   589             20  SLASH1-2              PIC X.
   590             20  DC-EDIT1-YEAR         PIC 99.
   591         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   592         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   593                     DC-GREG-DATE-2-EDIT.
   594             20  DC-EDIT2-MONTH        PIC 99.
   595             20  SLASH2-1              PIC X.
   596             20  DC-EDIT2-DAY          PIC 99.
   597             20  SLASH2-2              PIC X.
   598             20  DC-EDIT2-YEAR         PIC 99.
   599         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   600         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   601                     DC-GREG-DATE-1-YMD.
   602             20  DC-YMD-YEAR           PIC 99.
   603             20  DC-YMD-MONTH          PIC 99.
   604             20  DC-YMD-DAY            PIC 99.
   605         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   606         16  DC-GREG-DATE-1-MDY-R REDEFINES
   607                      DC-GREG-DATE-1-MDY.
   608             20  DC-MDY-MONTH          PIC 99.
   609             20  DC-MDY-DAY            PIC 99.
   610             20  DC-MDY-YEAR           PIC 99.
   611         16  DC-GREG-DATE-1-ALPHA.
   612             20  DC-ALPHA-MONTH        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6318.cbl
   613             20  DC-ALPHA-DAY          PIC 99.
   614             20  FILLER                PIC XX.
   615             20  DC-ALPHA-CENTURY.
   616                 24 DC-ALPHA-CEN-N     PIC 99.
   617             20  DC-ALPHA-YEAR         PIC 99.
   618         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   619         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   620         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   621         16  DC-JULIAN-DATE            PIC 9(05).
   622         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   623                                       PIC 9(05).
   624         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   625             20  DC-JULIAN-YEAR        PIC 99.
   626             20  DC-JULIAN-DAYS        PIC 999.
   627         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   628         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   629         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   630     12  DATE-CONVERSION-VARIBLES.
   631         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   632         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   633             20  FILLER                PIC 9(3).
   634             20  HOLD-CEN-1-CCYY.
   635                 24  HOLD-CEN-1-CC     PIC 99.
   636                 24  HOLD-CEN-1-YY     PIC 99.
   637             20  HOLD-CEN-1-MO         PIC 99.
   638             20  HOLD-CEN-1-DA         PIC 99.
   639         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   640             20  HOLD-CEN-1-R-MO       PIC 99.
   641             20  HOLD-CEN-1-R-DA       PIC 99.
   642             20  HOLD-CEN-1-R-CCYY.
   643                 24  HOLD-CEN-1-R-CC   PIC 99.
   644                 24  HOLD-CEN-1-R-YY   PIC 99.
   645             20  FILLER                PIC 9(3).
   646         16  HOLD-CENTURY-1-X.
   647             20  FILLER                PIC X(3)  VALUE SPACES.
   648             20  HOLD-CEN-1-X-CCYY.
   649                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   650                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   651             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   652             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   653         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   654             20  HOLD-CEN-1-R-X-MO     PIC XX.
   655             20  HOLD-CEN-1-R-X-DA     PIC XX.
   656             20  HOLD-CEN-1-R-X-CCYY.
   657                 24  HOLD-CEN-1-R-X-CC PIC XX.
   658                 24  HOLD-CEN-1-R-X-YY PIC XX.
   659             20  FILLER                PIC XXX.
   660         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   661         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   662         16  DC-JULIAN-DATE-1          PIC 9(07).
   663         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   664             20  DC-JULIAN-1-CCYY.
   665                 24  DC-JULIAN-1-CC    PIC 99.
   666                 24  DC-JULIAN-1-YR    PIC 99.
   667             20  DC-JULIAN-DA-1        PIC 999.
   668         16  DC-JULIAN-DATE-2          PIC 9(07).
   669         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   670             20  DC-JULIAN-2-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6318.cbl
   671                 24  DC-JULIAN-2-CC    PIC 99.
   672                 24  DC-JULIAN-2-YR    PIC 99.
   673             20  DC-JULIAN-DA-2        PIC 999.
   674         16  DC-GREG-DATE-A-EDIT.
   675             20  DC-EDITA-MONTH        PIC 99.
   676             20  SLASHA-1              PIC X VALUE '/'.
   677             20  DC-EDITA-DAY          PIC 99.
   678             20  SLASHA-2              PIC X VALUE '/'.
   679             20  DC-EDITA-CCYY.
   680                 24  DC-EDITA-CENT     PIC 99.
   681                 24  DC-EDITA-YEAR     PIC 99.
   682         16  DC-GREG-DATE-B-EDIT.
   683             20  DC-EDITB-MONTH        PIC 99.
   684             20  SLASHB-1              PIC X VALUE '/'.
   685             20  DC-EDITB-DAY          PIC 99.
   686             20  SLASHB-2              PIC X VALUE '/'.
   687             20  DC-EDITB-CCYY.
   688                 24  DC-EDITB-CENT     PIC 99.
   689                 24  DC-EDITB-YEAR     PIC 99.
   690         16  DC-GREG-DATE-CYMD         PIC 9(08).
   691         16  DC-GREG-DATE-CYMD-R REDEFINES
   692                              DC-GREG-DATE-CYMD.
   693             20  DC-CYMD-CEN           PIC 99.
   694             20  DC-CYMD-YEAR          PIC 99.
   695             20  DC-CYMD-MONTH         PIC 99.
   696             20  DC-CYMD-DAY           PIC 99.
   697         16  DC-GREG-DATE-MDCY         PIC 9(08).
   698         16  DC-GREG-DATE-MDCY-R REDEFINES
   699                              DC-GREG-DATE-MDCY.
   700             20  DC-MDCY-MONTH         PIC 99.
   701             20  DC-MDCY-DAY           PIC 99.
   702             20  DC-MDCY-CEN           PIC 99.
   703             20  DC-MDCY-YEAR          PIC 99.
   704    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   705        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   706    12  DC-EL310-DATE                  PIC X(21).
   707    12  FILLER                         PIC X(28).
   708*    COPY ELCTEXT.
   709******************************************************************
   710*                                                                *
   711*                                                                *
   712*                            ELCTEXT.                            *
   713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   714*                            VMOD=2.008                          *
   715*                                                                *
   716*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   717*                                     FORM LETTERS,              *
   718*                                     CERT FORM DISPLAY.
   719*                                                                *
   720*   FILE TYPE = VSAM,KSDS                                        *
   721*   RECORD SIZE = 100   RECFORM = FIXED                          *
   722*                                                                *
   723*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   724*       ALTERNATE INDEX = NONE                                   *
   725*                                                                *
   726*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   727*       ALTERNATE INDEX = NONE                                   *
   728*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6318.cbl
   729*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   730*       ALTERNATE INDEX = NONE                                   *
   731*                                                                *
   732*   LOG = NO                                                     *
   733*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   734******************************************************************
   735 01  TEXT-FILES.
   736     12  TEXT-FILE-ID                PIC XX.
   737         88  FORMS-FILE-TEXT            VALUE 'TF'.
   738         88  LETTER-FILE-TEXT           VALUE 'TL'.
   739         88  HELP-FILE-TEXT             VALUE 'TH'.
   740
   741     12  TX-CONTROL-PRIMARY.
   742         16  TX-COMPANY-CD           PIC X.
   743             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   744         16  TX-ACCESS-CD-GENL       PIC X(12).
   745
   746         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   747             20  TX-LETTER-NO        PIC X(4).
   748             20  FILLER              PIC X(8).
   749
   750         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   751             20  TX-FORM-NO          PIC X(12).
   752
   753         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   754             20  TX-HELP-TYPE        PIC X.
   755                 88  HELP-FOR-GENERAL   VALUE ' '.
   756                 88  HELP-BY-SCREEN     VALUE 'S'.
   757                 88  HELP-BY-ERROR      VALUE 'E'.
   758             20  TX-SCREEN-OR-ERROR  PIC X(4).
   759                 88  GENERAL-INFO-HELP  VALUE '0000'.
   760             20  TX-HELP-FOR-COMPANY  PIC XXX.
   761                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   762             20  FILLER              PIC X(4).
   763
   764         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   765
   766     12  TX-PROCESS-CONTROL          PIC XX.
   767         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   768
   769     12  TX-TEXT-LINE                PIC X(70).
   770
   771     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   772         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   773         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   774         88  TX-VALID-FORM-SQUEEZE-VALUE
   775                                        VALUE 'Y' ' '.
   776
   777     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   778         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   779         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   780         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   781         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   782         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   783         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   784         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   785                                              'K' 'N' ' '
   786                                              'Z'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6318.cbl
   787
   788     12  TX-ARCHIVE-SW               PIC X.
   789         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   790         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   791         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   792
   793     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   794     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   795
   796     12  TX-BSR-CODE                 PIC X.
   797         88  TX-BSR-LETTER              VALUE 'B'.
   798         88  TX-NON-BSR-LETTER          VALUE ' '.
   799
   800     12  FILLER                      PIC X.
   801*****************************************************************
   802*    COPY ELCLOGOF.
   803******************************************************************
   804*                                                                *
   805*                                                                *
   806*                            ELCLOGOF.                           *
   807*                            VMOD=2.001                          *
   808*                                                                *
   809*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   810*                                                                *
   811******************************************************************
   812 01  CLASIC-LOGOFF.
   813     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   814     12  LOGOFF-TEXT.
   815         16  FILLER          PIC X(5)    VALUE SPACES.
   816         16  LOGOFF-MSG.
   817             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   818             20  FILLER      PIC X       VALUE SPACES.
   819             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   820         16  FILLER          PIC X(80)
   821           VALUE '* YOU ARE NOW LOGGED OFF'.
   822         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   823         16  FILLER          PIC X       VALUE QUOTE.
   824         16  LOGOFF-SYS-MSG  PIC X(17)
   825           VALUE 'S CLAS-IC SYSTEM '.
   826     12  TEXT-MESSAGES.
   827         16  UNACCESS-MSG    PIC X(29)
   828             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   829         16  PGMIDERR-MSG    PIC X(17)
   830             VALUE 'PROGRAM NOT FOUND'.
   831*    COPY ELCATTR.
   832******************************************************************
   833*                                                                *
   834*                            ELCATTR.                            *
   835*                            VMOD=2.001                          *
   836*                                                                *
   837*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   838*                                                                *
   839*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   840*                                                                *
   841*                   POS 1   P=PROTECTED                          *
   842*                           U=UNPROTECTED                        *
   843*                           S=ASKIP                              *
   844*                   POS 2   A=ALPHA/NUMERIC                      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6318.cbl
   845*                           N=NUMERIC                            *
   846*                   POS 3   N=NORMAL                             *
   847*                           B=BRIGHT                             *
   848*                           D=DARK                               *
   849*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   850*                           OF=MODIFIED DATA TAG OFF             *
   851*                                                                *
   852*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   853******************************************************************
   854 01  ATTRIBUTE-LIST.
   855     12  AL-PABOF            PIC X       VALUE 'Y'.
   856     12  AL-PABON            PIC X       VALUE 'Z'.
   857     12  AL-PADOF            PIC X       VALUE '%'.
   858     12  AL-PADON            PIC X       VALUE '_'.
   859     12  AL-PANOF            PIC X       VALUE '-'.
   860     12  AL-PANON            PIC X       VALUE '/'.
   861     12  AL-SABOF            PIC X       VALUE '8'.
   862     12  AL-SABON            PIC X       VALUE '9'.
   863     12  AL-SADOF            PIC X       VALUE '@'.
   864     12  AL-SADON            PIC X       VALUE QUOTE.
   865     12  AL-SANOF            PIC X       VALUE '0'.
   866     12  AL-SANON            PIC X       VALUE '1'.
   867     12  AL-UABOF            PIC X       VALUE 'H'.
   868     12  AL-UABON            PIC X       VALUE 'I'.
   869     12  AL-UADOF            PIC X       VALUE '<'.
   870     12  AL-UADON            PIC X       VALUE '('.
   871     12  AL-UANOF            PIC X       VALUE ' '.
   872     12  AL-UANON            PIC X       VALUE 'A'.
   873     12  AL-UNBOF            PIC X       VALUE 'Q'.
   874     12  AL-UNBON            PIC X       VALUE 'R'.
   875     12  AL-UNDOF            PIC X       VALUE '*'.
   876     12  AL-UNDON            PIC X       VALUE ')'.
   877     12  AL-UNNOF            PIC X       VALUE '&'.
   878     12  AL-UNNON            PIC X       VALUE 'J'.
   879*    COPY ELCEMIB.
   880******************************************************************
   881*                                                                *
   882*                                                                *
   883*                            ELCEMIB.                            *
   884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   885*                            VMOD=2.005                          *
   886*                                                                *
   887*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   888*                                                                *
   889******************************************************************
   890 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   891     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   892     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   893     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   894     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   895     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   896     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   897     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   898     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   899     12  EMI-SWITCH1             PIC X        VALUE '1'.
   900         88  EMI-NO-ERRORS                    VALUE '1'.
   901         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   902         88  EMI-ERRORS-COMPLETE              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6318.cbl
   903     12  EMI-SWITCH2             PIC X        VALUE '1'.
   904         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   905     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   906         88  EMI-AREA1-EMPTY                  VALUE '1'.
   907         88  EMI-AREA1-FULL                   VALUE '2'.
   908     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   909         88  EMI-AREA2-EMPTY                  VALUE '1'.
   910         88  EMI-AREA2-FULL                   VALUE '2'.
   911     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   912         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   913         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   914         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   915         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   916         88  EMI-BYPASS-FATALS                VALUE 'X'.
   917     12  EMI-ERROR-LINES.
   918         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   919         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   920         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   921         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   922             20  EMI-ERR-CODES OCCURS 10 TIMES.
   923                 24  EMI-ERR-NUM         PIC X(4).
   924                 24  EMI-FILLER          PIC X.
   925                 24  EMI-SEV             PIC X.
   926                 24  FILLER              PIC X.
   927             20  FILLER                  PIC X(02).
   928     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   929         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   930             20  EMI-ERROR-NUMBER    PIC X(4).
   931             20  EMI-FILL            PIC X.
   932             20  EMI-SEVERITY        PIC X.
   933             20  FILLER              PIC X.
   934             20  EMI-ERROR-TEXT.
   935                 24  EMI-TEXT-VARIABLE   PIC X(10).
   936                 24  FILLER          PIC X(55).
   937     12  EMI-SEVERITY-SAVE           PIC X.
   938         88  EMI-NOTE                    VALUE 'N'.
   939         88  EMI-WARNING                 VALUE 'W'.
   940         88  EMI-FORCABLE                VALUE 'F'.
   941         88  EMI-FATAL                   VALUE 'X'.
   942     12  EMI-MESSAGE-FLAG            PIC X.
   943         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   944         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   945     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   946     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   947         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   948         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   949         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   950     12  FILLER                      PIC X(137)  VALUE SPACES.
   951     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   952     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   953     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   954     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   955*    COPY ELCINTF.
   956******************************************************************
   957*                                                                *
   958*                                                                *
   959*                            ELCINTF.                            *
   960*                            VMOD=2.017                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6318.cbl
   961*                                                                *
   962*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   963*                                                                *
   964*       LENGTH = 1024                                            *
   965*                                                                *
   966******************************************************************
   967*                   C H A N G E   L O G
   968*
   969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   970*-----------------------------------------------------------------
   971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   972* EFFECTIVE    NUMBER
   973*-----------------------------------------------------------------
   974* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   975******************************************************************
   976 01  PROGRAM-INTERFACE-BLOCK.
   977     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   978     12  PI-CALLING-PROGRAM              PIC X(8).
   979     12  PI-SAVED-PROGRAM-1              PIC X(8).
   980     12  PI-SAVED-PROGRAM-2              PIC X(8).
   981     12  PI-SAVED-PROGRAM-3              PIC X(8).
   982     12  PI-SAVED-PROGRAM-4              PIC X(8).
   983     12  PI-SAVED-PROGRAM-5              PIC X(8).
   984     12  PI-SAVED-PROGRAM-6              PIC X(8).
   985     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   986     12  PI-COMPANY-ID                   PIC XXX.
   987     12  PI-COMPANY-CD                   PIC X.
   988
   989     12  PI-COMPANY-PASSWORD             PIC X(8).
   990
   991     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   992
   993     12  PI-CONTROL-IN-PROGRESS.
   994         16  PI-CARRIER                  PIC X.
   995         16  PI-GROUPING                 PIC X(6).
   996         16  PI-STATE                    PIC XX.
   997         16  PI-ACCOUNT                  PIC X(10).
   998         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   999                                         PIC X(10).
  1000         16  PI-CLAIM-CERT-GRP.
  1001             20  PI-CLAIM-NO             PIC X(7).
  1002             20  PI-CERT-NO.
  1003                 25  PI-CERT-PRIME       PIC X(10).
  1004                 25  PI-CERT-SFX         PIC X.
  1005             20  PI-CERT-EFF-DT          PIC XX.
  1006         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1007             20  PI-PLAN-CODE            PIC X(2).
  1008             20  PI-REVISION-NUMBER      PIC X(3).
  1009             20  PI-PLAN-EFF-DT          PIC X(2).
  1010             20  PI-PLAN-EXP-DT          PIC X(2).
  1011             20  FILLER                  PIC X(11).
  1012         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1013             20  PI-OE-REFERENCE-1.
  1014                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1015                 25  PI-OE-REF-1-SUFF    PIC XX.
  1016
  1017     12  PI-SESSION-IN-PROGRESS          PIC X.
  1018         88  CLAIM-SESSION                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6318.cbl
  1019         88  CREDIT-SESSION                  VALUE '2'.
  1020         88  WARRANTY-SESSION                VALUE '3'.
  1021         88  MORTGAGE-SESSION                VALUE '4'.
  1022         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1023
  1024
  1025*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1026
  1027     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1028     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1029
  1030     12  PI-CREDIT-USER                  PIC X.
  1031         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1032         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1033
  1034     12  PI-CLAIM-USER                   PIC X.
  1035         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1036         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1037
  1038     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1039         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1040         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1041         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1042         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1043         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1044
  1045     12  PI-PROCESSOR-ID                 PIC X(4).
  1046
  1047     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1048
  1049     12  PI-MEMBER-CAPTION               PIC X(10).
  1050
  1051     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1052         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1053
  1054     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1055     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1056     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1057     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1058
  1059     12  PI-AH-OVERRIDE-L1               PIC X.
  1060     12  PI-AH-OVERRIDE-L2               PIC XX.
  1061     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1062     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1063
  1064     12  PI-NEW-SYSTEM                   PIC X(2).
  1065
  1066     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1067     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1068         88  PI-USES-PAID-TO                 VALUE '1'.
  1069     12  PI-CRDTCRD-SYSTEM.
  1070         16  PI-CRDTCRD-USER             PIC X.
  1071             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1072             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1073         16  PI-CC-MONTH-END-DT          PIC XX.
  1074     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1075
  1076     12  PI-OE-REFERENCE-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6318.cbl
  1077         16  PI-OE-REF-2-PRIME           PIC X(10).
  1078         16  PI-OE-REF-2-SUFF            PIC X.
  1079
  1080     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1081
  1082     12  PI-LANGUAGE-TYPE                PIC X.
  1083             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1084             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1085             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1086
  1087     12  PI-POLICY-LINKAGE-IND           PIC X.
  1088         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1089         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1090                                                   LOW-VALUES.
  1091
  1092     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1093     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1094         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1095         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1096
  1097     12  PI-PROCESSOR-CSR-IND            PIC X.
  1098         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1099         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1100
  1101     12  FILLER                          PIC X(3).
  1102
  1103     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1104
  1105     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1106         PI-SYSTEM-LEVEL.
  1107
  1108         16  PI-ENTRY-CODES.
  1109             20  PI-ENTRY-CD-1           PIC X.
  1110             20  PI-ENTRY-CD-2           PIC X.
  1111
  1112         16  PI-RETURN-CODES.
  1113             20  PI-RETURN-CD-1          PIC X.
  1114             20  PI-RETURN-CD-2          PIC X.
  1115
  1116         16  PI-UPDATE-STATUS-SAVE.
  1117             20  PI-UPDATE-BY            PIC X(4).
  1118             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1119
  1120         16  PI-LOWER-CASE-LETTERS       PIC X.
  1121             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1122
  1123*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1124*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1125*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1126
  1127         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1128             88  ST-ACCNT-CNTL               VALUE ' '.
  1129             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1130             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1131             88  ACCNT-CNTL                  VALUE '3'.
  1132             88  CARR-ACCNT-CNTL             VALUE '4'.
  1133
  1134         16  PI-PROCESSOR-CAP-LIST.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6318.cbl
  1135             20  PI-SYSTEM-CONTROLS.
  1136                24 PI-SYSTEM-DISPLAY     PIC X.
  1137                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1138                24 PI-SYSTEM-MODIFY      PIC X.
  1139                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1140             20  FILLER                  PIC XX.
  1141             20  PI-DISPLAY-CAP          PIC X.
  1142                 88  DISPLAY-CAP             VALUE 'Y'.
  1143             20  PI-MODIFY-CAP           PIC X.
  1144                 88  MODIFY-CAP              VALUE 'Y'.
  1145             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1146                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1147             20  PI-FORCE-CAP            PIC X.
  1148                 88  FORCE-CAP               VALUE 'Y'.
  1149
  1150         16  PI-PROGRAM-CONTROLS.
  1151             20  PI-PGM-PRINT-OPT        PIC X.
  1152             20  PI-PGM-FORMAT-OPT       PIC X.
  1153             20  PI-PGM-PROCESS-OPT      PIC X.
  1154             20  PI-PGM-TOTALS-OPT       PIC X.
  1155
  1156         16  PI-HELP-INTERFACE.
  1157             20  PI-LAST-ERROR-NO        PIC X(4).
  1158             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1159
  1160         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1161             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1162
  1163         16  PI-CR-CONTROL-IN-PROGRESS.
  1164             20  PI-CR-CARRIER           PIC X.
  1165             20  PI-CR-GROUPING          PIC X(6).
  1166             20  PI-CR-STATE             PIC XX.
  1167             20  PI-CR-ACCOUNT           PIC X(10).
  1168             20  PI-CR-FIN-RESP          PIC X(10).
  1169             20  PI-CR-TYPE              PIC X.
  1170
  1171         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1172
  1173         16  PI-CR-MONTH-END-DT          PIC XX.
  1174
  1175         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1176             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1177             88  PI-ZERO-CARRIER             VALUE '1'.
  1178             88  PI-ZERO-GROUPING            VALUE '2'.
  1179             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1180
  1181         16  PI-CARRIER-SECURITY         PIC X.
  1182             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1183
  1184         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1185             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1186             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1187
  1188         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1189             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1190                                         INDEXED BY PI-ACCESS-NDX
  1191                                         PIC X.
  1192
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6318.cbl
  1193         16  PI-GA-BILLING-CONTROL       PIC X.
  1194             88  PI-GA-BILLING               VALUE '1'.
  1195
  1196         16  PI-MAIL-PROCESSING          PIC X.
  1197             88  PI-MAIL-YES                 VALUE 'Y'.
  1198
  1199         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1200
  1201         16  PI-AR-SYSTEM.
  1202             20  PI-AR-PROCESSING-CNTL   PIC X.
  1203                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1204             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1205             20  PI-AR-MONTH-END-DT      PIC XX.
  1206
  1207         16  PI-MP-SYSTEM.
  1208             20  PI-MORTGAGE-USER            PIC X.
  1209                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1210                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1211             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1212                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1213                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1214                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1215                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1216                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1217             20  PI-MP-MONTH-END-DT          PIC XX.
  1218             20  PI-MP-REFERENCE-NO.
  1219                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1220                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1221
  1222         16  PI-LABEL-CONTROL            PIC X(01).
  1223             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1224             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1225
  1226         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1227             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1228
  1229         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1230             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1231             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1232
  1233         16  FILLER                      PIC X(14).
  1234
  1235     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1236******************************************************************
  1237     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1238        16  PI-ISS-CAN-SW           PIC X.
  1239        16  PI-ERENDT-KEY.
  1240            20  PI-ENDT-COMPANY-CD  PIC X.
  1241            20  PI-ENDT-CARRIER     PIC X.
  1242            20  PI-ENDT-GROUPING    PIC X(6).
  1243            20  PI-ENDT-STATE       PIC XX.
  1244            20  PI-ENDT-ACCOUNT     PIC X(10).
  1245            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1246            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1247            20  PI-ENDT-CERT-SFX    PIC X.
  1248            20  PI-ENDT-RECORD-TYPE PIC X.
  1249            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1250        16  PI-ELCRTO-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6318.cbl
  1251            20  PI-CRTO-COMPANY-CD  PIC X.
  1252            20  PI-CRTO-CARRIER     PIC X.
  1253            20  PI-CRTO-GROUPING    PIC X(6).
  1254            20  PI-CRTO-STATE       PIC XX.
  1255            20  PI-CRTO-ACCOUNT     PIC X(10).
  1256            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1257            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1258            20  PI-CRTO-CERT-SFX    PIC X.
  1259            20  PI-CRTO-RECORD-TYPE PIC X.
  1260            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1261        16  PI-ERPNDB-KEY           PIC X(11).
  1262        16  PI-DOCUMENT-PROCESSED   PIC X.
  1263            88  PI-VERI-PROCESSED      VALUE 'V'.
  1264            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1265        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1266        16  PI-RES-REF-CLM-TYPE     PIC X.
  1267        16  PI-CLM-REFORM-IND       PIC X.
  1268            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1269        16  PI-CLEAR-ERROR-SW       PIC X.
  1270            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1271        16  PI-PRINT-CERTIFICATE    PIC X.
  1272        16  PI-ENTERED.
  1273            20  PI-PRTSW-ENTERED    PIC X.
  1274            20  PI-SIGREQ-ENTERED   PIC X.
  1275            20  PI-MONEY-ENTERED    PIC X.
  1276            20  PI-LTRID-ENTERED    PIC X(4).
  1277            20  PI-VOUCHER-ENTERED  PIC X.
  1278            20  PI-HLTHAPP-ENTERED  PIC X.
  1279            20  PI-PAYEE-ENTERED    PIC X(10).
  1280            20  PI-CERTID-ENTERED   PIC X(5).
  1281            20  PI-REASONS-ENTERED  PIC X(84).
  1282            20  PI-CERTNT1-ENTERED  PIC X(63).
  1283            20  PI-CERTNT2-ENTERED  PIC X(63).
  1284        16  PI-FINALIZED-IND        PIC X.
  1285        16  PI-CERTNT3-ENTERED      PIC X(63).
  1286        16  PI-CERTNT4-ENTERED      PIC X(63).
  1287        16  PI-CERTNT5-ENTERED      PIC X(63).
  1288        16  PI-CERTNT6-ENTERED      PIC X(63).
  1289        16  FILLER                  PIC X(28).
  1290    12  FILLER                      PIC X(276).
  1291*    COPY ELCAID.
  1292******************************************************************
  1293*                                                                *
  1294*                            ELCAID.                             *
  1295*                            VMOD=2.001                          *
  1296*                                                                *
  1297*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1298*                                                                *
  1299*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1300*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1301******************************************************************
  1302
  1303 01  DFHAID.
  1304   02  DFHNULL   PIC  X  VALUE  ' '.
  1305   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1306   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1307   02  DFHPEN    PIC  X  VALUE  '='.
  1308   02  DFHOPID   PIC  X  VALUE  'W'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6318.cbl
  1309   02  DFHPA1    PIC  X  VALUE  '%'.
  1310   02  DFHPA2    PIC  X  VALUE  '>'.
  1311   02  DFHPA3    PIC  X  VALUE  ','.
  1312   02  DFHPF1    PIC  X  VALUE  '1'.
  1313   02  DFHPF2    PIC  X  VALUE  '2'.
  1314   02  DFHPF3    PIC  X  VALUE  '3'.
  1315   02  DFHPF4    PIC  X  VALUE  '4'.
  1316   02  DFHPF5    PIC  X  VALUE  '5'.
  1317   02  DFHPF6    PIC  X  VALUE  '6'.
  1318   02  DFHPF7    PIC  X  VALUE  '7'.
  1319   02  DFHPF8    PIC  X  VALUE  '8'.
  1320   02  DFHPF9    PIC  X  VALUE  '9'.
  1321   02  DFHPF10   PIC  X  VALUE  ':'.
  1322   02  DFHPF11   PIC  X  VALUE  '#'.
  1323   02  DFHPF12   PIC  X  VALUE  '@'.
  1324   02  DFHPF13   PIC  X  VALUE  'A'.
  1325   02  DFHPF14   PIC  X  VALUE  'B'.
  1326   02  DFHPF15   PIC  X  VALUE  'C'.
  1327   02  DFHPF16   PIC  X  VALUE  'D'.
  1328   02  DFHPF17   PIC  X  VALUE  'E'.
  1329   02  DFHPF18   PIC  X  VALUE  'F'.
  1330   02  DFHPF19   PIC  X  VALUE  'G'.
  1331   02  DFHPF20   PIC  X  VALUE  'H'.
  1332   02  DFHPF21   PIC  X  VALUE  'I'.
  1333*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1334   02  DFHPF22   PIC  X  VALUE  '['.
  1335   02  DFHPF23   PIC  X  VALUE  '.'.
  1336   02  DFHPF24   PIC  X  VALUE  '<'.
  1337   02  DFHMSRE   PIC  X  VALUE  'X'.
  1338   02  DFHSTRF   PIC  X  VALUE  'h'.
  1339   02  DFHTRIG   PIC  X  VALUE  '"'.
  1340 01  FILLER    REDEFINES DFHAID.
  1341     12  FILLER              PIC X(8).
  1342     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1343     12  FILLER              PIC X(3).
  1344*   COPY EL6318S.
  1345 01  EL631KI.
  1346     05  FILLER            PIC  X(0012).
  1347*    -------------------------------
  1348     05  DATEL PIC S9(0004) COMP.
  1349     05  DATEF PIC  X(0001).
  1350     05  FILLER REDEFINES DATEF.
  1351         10  DATEA PIC  X(0001).
  1352     05  DATEI PIC  X(0008).
  1353*    -------------------------------
  1354     05  TIMEL PIC S9(0004) COMP.
  1355     05  TIMEF PIC  X(0001).
  1356     05  FILLER REDEFINES TIMEF.
  1357         10  TIMEA PIC  X(0001).
  1358     05  TIMEI PIC  X(0005).
  1359*    -------------------------------
  1360     05  PROCIDL PIC S9(0004) COMP.
  1361     05  PROCIDF PIC  X(0001).
  1362     05  FILLER REDEFINES PROCIDF.
  1363         10  PROCIDA PIC  X(0001).
  1364     05  PROCIDI PIC  X(0004).
  1365*    -------------------------------
  1366     05  HOSTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6318.cbl
  1367     05  HOSTF PIC  X(0001).
  1368     05  FILLER REDEFINES HOSTF.
  1369         10  HOSTA PIC  X(0001).
  1370     05  HOSTI PIC  X(0009).
  1371*    -------------------------------
  1372     05  SYSL PIC S9(0004) COMP.
  1373     05  SYSF PIC  X(0001).
  1374     05  FILLER REDEFINES SYSF.
  1375         10  SYSA PIC  X(0001).
  1376     05  SYSI PIC  X(0005).
  1377*    -------------------------------
  1378     05  COMPANYL PIC S9(0004) COMP.
  1379     05  COMPANYF PIC  X(0001).
  1380     05  FILLER REDEFINES COMPANYF.
  1381         10  COMPANYA PIC  X(0001).
  1382     05  COMPANYI PIC  X(0003).
  1383*    -------------------------------
  1384     05  DATASORL PIC S9(0004) COMP.
  1385     05  DATASORF PIC  X(0001).
  1386     05  FILLER REDEFINES DATASORF.
  1387         10  DATASORA PIC  X(0001).
  1388     05  DATASORI PIC  X(0001).
  1389*    -------------------------------
  1390     05  BATCHNOL PIC S9(0004) COMP.
  1391     05  BATCHNOF PIC  X(0001).
  1392     05  FILLER REDEFINES BATCHNOF.
  1393         10  BATCHNOA PIC  X(0001).
  1394     05  BATCHNOI PIC  X(0006).
  1395*    -------------------------------
  1396     05  BSEQNOL PIC S9(0004) COMP.
  1397     05  BSEQNOF PIC  X(0001).
  1398     05  FILLER REDEFINES BSEQNOF.
  1399         10  BSEQNOA PIC  X(0001).
  1400     05  BSEQNOI PIC  X(0008).
  1401*    -------------------------------
  1402     05  ARCHNOL PIC S9(0004) COMP.
  1403     05  ARCHNOF PIC  X(0001).
  1404     05  FILLER REDEFINES ARCHNOF.
  1405         10  ARCHNOA PIC  X(0001).
  1406     05  ARCHNOI PIC  X(0008).
  1407*    -------------------------------
  1408     05  PRTSWL PIC S9(0004) COMP.
  1409     05  PRTSWF PIC  X(0001).
  1410     05  FILLER REDEFINES PRTSWF.
  1411         10  PRTSWA PIC  X(0001).
  1412     05  PRTSWI PIC  X(0001).
  1413*    -------------------------------
  1414     05  CARRL PIC S9(0004) COMP.
  1415     05  CARRF PIC  X(0001).
  1416     05  FILLER REDEFINES CARRF.
  1417         10  CARRA PIC  X(0001).
  1418     05  CARRI PIC  X(0001).
  1419*    -------------------------------
  1420     05  GROUPL PIC S9(0004) COMP.
  1421     05  GROUPF PIC  X(0001).
  1422     05  FILLER REDEFINES GROUPF.
  1423         10  GROUPA PIC  X(0001).
  1424     05  GROUPI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6318.cbl
  1425*    -------------------------------
  1426     05  STATEL PIC S9(0004) COMP.
  1427     05  STATEF PIC  X(0001).
  1428     05  FILLER REDEFINES STATEF.
  1429         10  STATEA PIC  X(0001).
  1430     05  STATEI PIC  X(0002).
  1431*    -------------------------------
  1432     05  ACCTL PIC S9(0004) COMP.
  1433     05  ACCTF PIC  X(0001).
  1434     05  FILLER REDEFINES ACCTF.
  1435         10  ACCTA PIC  X(0001).
  1436     05  ACCTI PIC  X(0010).
  1437*    -------------------------------
  1438     05  EFFDTL PIC S9(0004) COMP.
  1439     05  EFFDTF PIC  X(0001).
  1440     05  FILLER REDEFINES EFFDTF.
  1441         10  EFFDTA PIC  X(0001).
  1442     05  EFFDTI PIC  X(0008).
  1443*    -------------------------------
  1444     05  CERTNOL PIC S9(0004) COMP.
  1445     05  CERTNOF PIC  X(0001).
  1446     05  FILLER REDEFINES CERTNOF.
  1447         10  CERTNOA PIC  X(0001).
  1448     05  CERTNOI PIC  X(0010).
  1449*    -------------------------------
  1450     05  CRTSFXL PIC S9(0004) COMP.
  1451     05  CRTSFXF PIC  X(0001).
  1452     05  FILLER REDEFINES CRTSFXF.
  1453         10  CRTSFXA PIC  X(0001).
  1454     05  CRTSFXI PIC  X(0001).
  1455*    -------------------------------
  1456     05  SEQNOL PIC S9(0004) COMP.
  1457     05  SEQNOF PIC  X(0001).
  1458     05  FILLER REDEFINES SEQNOF.
  1459         10  SEQNOA PIC  X(0001).
  1460     05  SEQNOI PIC  X(0006).
  1461*    -------------------------------
  1462     05  SIGREQL PIC S9(0004) COMP.
  1463     05  SIGREQF PIC  X(0001).
  1464     05  FILLER REDEFINES SIGREQF.
  1465         10  SIGREQA PIC  X(0001).
  1466     05  SIGREQI PIC  X(0001).
  1467*    -------------------------------
  1468     05  LTRIDL PIC S9(0004) COMP.
  1469     05  LTRIDF PIC  X(0001).
  1470     05  FILLER REDEFINES LTRIDF.
  1471         10  LTRIDA PIC  X(0001).
  1472     05  LTRIDI PIC  X(0004).
  1473*    -------------------------------
  1474     05  HLTHAPPL PIC S9(0004) COMP.
  1475     05  HLTHAPPF PIC  X(0001).
  1476     05  FILLER REDEFINES HLTHAPPF.
  1477         10  HLTHAPPA PIC  X(0001).
  1478     05  HLTHAPPI PIC  X(0001).
  1479*    -------------------------------
  1480     05  VOUCHL PIC S9(0004) COMP.
  1481     05  VOUCHF PIC  X(0001).
  1482     05  FILLER REDEFINES VOUCHF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6318.cbl
  1483         10  VOUCHA PIC  X(0001).
  1484     05  VOUCHI PIC  X(0001).
  1485*    -------------------------------
  1486     05  PAYEEL PIC S9(0004) COMP.
  1487     05  PAYEEF PIC  X(0001).
  1488     05  FILLER REDEFINES PAYEEF.
  1489         10  PAYEEA PIC  X(0001).
  1490     05  PAYEEI PIC  X(0010).
  1491*    -------------------------------
  1492     05  CERTIDL PIC S9(0004) COMP.
  1493     05  CERTIDF PIC  X(0001).
  1494     05  FILLER REDEFINES CERTIDF.
  1495         10  CERTIDA PIC  X(0001).
  1496     05  CERTIDI PIC  X(0005).
  1497*    -------------------------------
  1498     05  RCD01L PIC S9(0004) COMP.
  1499     05  RCD01F PIC  X(0001).
  1500     05  FILLER REDEFINES RCD01F.
  1501         10  RCD01A PIC  X(0001).
  1502     05  RCD01I PIC  X(0004).
  1503*    -------------------------------
  1504     05  RCD02L PIC S9(0004) COMP.
  1505     05  RCD02F PIC  X(0001).
  1506     05  FILLER REDEFINES RCD02F.
  1507         10  RCD02A PIC  X(0001).
  1508     05  RCD02I PIC  X(0004).
  1509*    -------------------------------
  1510     05  RCD03L PIC S9(0004) COMP.
  1511     05  RCD03F PIC  X(0001).
  1512     05  FILLER REDEFINES RCD03F.
  1513         10  RCD03A PIC  X(0001).
  1514     05  RCD03I PIC  X(0004).
  1515*    -------------------------------
  1516     05  RCD04L PIC S9(0004) COMP.
  1517     05  RCD04F PIC  X(0001).
  1518     05  FILLER REDEFINES RCD04F.
  1519         10  RCD04A PIC  X(0001).
  1520     05  RCD04I PIC  X(0004).
  1521*    -------------------------------
  1522     05  RCD05L PIC S9(0004) COMP.
  1523     05  RCD05F PIC  X(0001).
  1524     05  FILLER REDEFINES RCD05F.
  1525         10  RCD05A PIC  X(0001).
  1526     05  RCD05I PIC  X(0004).
  1527*    -------------------------------
  1528     05  RCD06L PIC S9(0004) COMP.
  1529     05  RCD06F PIC  X(0001).
  1530     05  FILLER REDEFINES RCD06F.
  1531         10  RCD06A PIC  X(0001).
  1532     05  RCD06I PIC  X(0004).
  1533*    -------------------------------
  1534     05  RCD07L PIC S9(0004) COMP.
  1535     05  RCD07F PIC  X(0001).
  1536     05  FILLER REDEFINES RCD07F.
  1537         10  RCD07A PIC  X(0001).
  1538     05  RCD07I PIC  X(0004).
  1539*    -------------------------------
  1540     05  RCD08L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6318.cbl
  1541     05  RCD08F PIC  X(0001).
  1542     05  FILLER REDEFINES RCD08F.
  1543         10  RCD08A PIC  X(0001).
  1544     05  RCD08I PIC  X(0004).
  1545*    -------------------------------
  1546     05  RCD09L PIC S9(0004) COMP.
  1547     05  RCD09F PIC  X(0001).
  1548     05  FILLER REDEFINES RCD09F.
  1549         10  RCD09A PIC  X(0001).
  1550     05  RCD09I PIC  X(0004).
  1551*    -------------------------------
  1552     05  RCD10L PIC S9(0004) COMP.
  1553     05  RCD10F PIC  X(0001).
  1554     05  FILLER REDEFINES RCD10F.
  1555         10  RCD10A PIC  X(0001).
  1556     05  RCD10I PIC  X(0004).
  1557*    -------------------------------
  1558     05  RCD11L PIC S9(0004) COMP.
  1559     05  RCD11F PIC  X(0001).
  1560     05  FILLER REDEFINES RCD11F.
  1561         10  RCD11A PIC  X(0001).
  1562     05  RCD11I PIC  X(0004).
  1563*    -------------------------------
  1564     05  RCD12L PIC S9(0004) COMP.
  1565     05  RCD12F PIC  X(0001).
  1566     05  FILLER REDEFINES RCD12F.
  1567         10  RCD12A PIC  X(0001).
  1568     05  RCD12I PIC  X(0004).
  1569*    -------------------------------
  1570     05  CRTNT1L PIC S9(0004) COMP.
  1571     05  CRTNT1F PIC  X(0001).
  1572     05  FILLER REDEFINES CRTNT1F.
  1573         10  CRTNT1A PIC  X(0001).
  1574     05  CRTNT1I PIC  X(0063).
  1575*    -------------------------------
  1576     05  CRTNT2L PIC S9(0004) COMP.
  1577     05  CRTNT2F PIC  X(0001).
  1578     05  FILLER REDEFINES CRTNT2F.
  1579         10  CRTNT2A PIC  X(0001).
  1580     05  CRTNT2I PIC  X(0063).
  1581*    -------------------------------
  1582     05  CRTNT3L PIC S9(0004) COMP.
  1583     05  CRTNT3F PIC  X(0001).
  1584     05  FILLER REDEFINES CRTNT3F.
  1585         10  CRTNT3A PIC  X(0001).
  1586     05  CRTNT3I PIC  X(0063).
  1587*    -------------------------------
  1588     05  CRTNT4L PIC S9(0004) COMP.
  1589     05  CRTNT4F PIC  X(0001).
  1590     05  FILLER REDEFINES CRTNT4F.
  1591         10  CRTNT4A PIC  X(0001).
  1592     05  CRTNT4I PIC  X(0063).
  1593*    -------------------------------
  1594     05  CRTNT5L PIC S9(0004) COMP.
  1595     05  CRTNT5F PIC  X(0001).
  1596     05  FILLER REDEFINES CRTNT5F.
  1597         10  CRTNT5A PIC  X(0001).
  1598     05  CRTNT5I PIC  X(0063).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6318.cbl
  1599*    -------------------------------
  1600     05  CRTNT6L PIC S9(0004) COMP.
  1601     05  CRTNT6F PIC  X(0001).
  1602     05  FILLER REDEFINES CRTNT6F.
  1603         10  CRTNT6A PIC  X(0001).
  1604     05  CRTNT6I PIC  X(0063).
  1605*    -------------------------------
  1606     05  ERRMSG1L PIC S9(0004) COMP.
  1607     05  ERRMSG1F PIC  X(0001).
  1608     05  FILLER REDEFINES ERRMSG1F.
  1609         10  ERRMSG1A PIC  X(0001).
  1610     05  ERRMSG1I PIC  X(0075).
  1611*    -------------------------------
  1612     05  ERRMSG2L PIC S9(0004) COMP.
  1613     05  ERRMSG2F PIC  X(0001).
  1614     05  FILLER REDEFINES ERRMSG2F.
  1615         10  ERRMSG2A PIC  X(0001).
  1616     05  ERRMSG2I PIC  X(0075).
  1617*    -------------------------------
  1618     05  PFENTRL PIC S9(0004) COMP.
  1619     05  PFENTRF PIC  X(0001).
  1620     05  FILLER REDEFINES PFENTRF.
  1621         10  PFENTRA PIC  X(0001).
  1622     05  PFENTRI PIC  9(2).
  1623 01  EL631KO REDEFINES EL631KI.
  1624     05  FILLER            PIC  X(0012).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  DATEO PIC  X(0008).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  TIMEO PIC  99.99.
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  PROCIDO PIC  X(0004).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  HOSTO PIC  X(0009).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  SYSO PIC  X(0005).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  COMPANYO PIC  X(0003).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  DATASORO PIC  X(0001).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  BATCHNOO PIC  X(0006).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  BSEQNOO PIC  X(0008).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  ARCHNOO PIC  X(0008).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6318.cbl
  1657     05  PRTSWO PIC  X(0001).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  CARRO PIC  X(0001).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  GROUPO PIC  X(0006).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  STATEO PIC  X(0002).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  ACCTO PIC  X(0010).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  EFFDTO PIC  X(0008).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  CERTNOO PIC  X(0010).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  CRTSFXO PIC  X(0001).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  SEQNOO PIC  999999.
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  SIGREQO PIC  X(0001).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  LTRIDO PIC  X(0004).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  HLTHAPPO PIC  X(0001).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  VOUCHO PIC  X(0001).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  PAYEEO PIC  X(0010).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  CERTIDO PIC  X(0005).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  RCD01O PIC  X(0004).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  RCD02O PIC  X(0004).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  RCD03O PIC  X(0004).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  RCD04O PIC  X(0004).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  RCD05O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6318.cbl
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  RCD06O PIC  X(0004).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  RCD07O PIC  X(0004).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  RCD08O PIC  X(0004).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  RCD09O PIC  X(0004).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  RCD10O PIC  X(0004).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  RCD11O PIC  X(0004).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  RCD12O PIC  X(0004).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  CRTNT1O PIC  X(0063).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  CRTNT2O PIC  X(0063).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  CRTNT3O PIC  X(0063).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  CRTNT4O PIC  X(0063).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  CRTNT5O PIC  X(0063).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  CRTNT6O PIC  X(0063).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  ERRMSG1O PIC  X(0075).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  ERRMSG2O PIC  X(0075).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  PFENTRO PIC  X(0002).
  1763*    -------------------------------
  1764 01  FILLER REDEFINES EL631KI.
  1765     12  FILLER             PIC X(211).
  1766     12  REASONCDS.
  1767         16  FILLER OCCURS 12.
  1768           20  REACDL       PIC S9(4) COMP.
  1769           20  REACDA       PIC X.
  1770           20  REACD-IN     PIC X(4).
  1771     12  FILLER             PIC X(293).
  1772****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6318.cbl
  1773*
  1774* Copyright (c) 2007 by Clerity Solutions, Inc.
  1775* All rights reserved.
  1776*
  1777****************************************************************
  1778 01  DFHEIV.
  1779   02  DFHEIV0               PIC X(35).
  1780   02  DFHEIV1               PIC X(08).
  1781   02  DFHEIV2               PIC X(08).
  1782   02  DFHEIV3               PIC X(08).
  1783   02  DFHEIV4               PIC X(06).
  1784   02  DFHEIV5               PIC X(04).
  1785   02  DFHEIV6               PIC X(04).
  1786   02  DFHEIV7               PIC X(02).
  1787   02  DFHEIV8               PIC X(02).
  1788   02  DFHEIV9               PIC X(01).
  1789   02  DFHEIV10              PIC S9(7) COMP-3.
  1790   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1791   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1792   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1793   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1794   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1795   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1796   02  DFHEIV17              PIC X(04).
  1797   02  DFHEIV18              PIC X(04).
  1798   02  DFHEIV19              PIC X(04).
  1799   02  DFHEIV20              USAGE IS POINTER.
  1800   02  DFHEIV21              USAGE IS POINTER.
  1801   02  DFHEIV22              USAGE IS POINTER.
  1802   02  DFHEIV23              USAGE IS POINTER.
  1803   02  DFHEIV24              USAGE IS POINTER.
  1804   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1805   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1806   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1807   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1808   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1809   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1810   02  FILLER                PIC X(02).
  1811   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1812   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1813   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1814   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1815   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1816 LINKAGE  SECTION.
  1817*****************************************************************
  1818*                                                               *
  1819* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1820* All rights reserved.                                          *
  1821*                                                               *
  1822*****************************************************************
  1823 01  dfheiblk.
  1824     02  eibtime          pic s9(7) comp-3.
  1825     02  eibdate          pic s9(7) comp-3.
  1826     02  eibtrnid         pic x(4).
  1827     02  eibtaskn         pic s9(7) comp-3.
  1828     02  eibtrmid         pic x(4).
  1829     02  dfheigdi         pic s9(4) comp.
  1830     02  eibcposn         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6318.cbl
  1831     02  eibcalen         pic s9(4) comp.
  1832     02  eibaid           pic x(1).
  1833     02  eibfiller1       pic x(1).
  1834     02  eibfn            pic x(2).
  1835     02  eibfiller2       pic x(2).
  1836     02  eibrcode         pic x(6).
  1837     02  eibfiller3       pic x(2).
  1838     02  eibds            pic x(8).
  1839     02  eibreqid         pic x(8).
  1840     02  eibrsrce         pic x(8).
  1841     02  eibsync          pic x(1).
  1842     02  eibfree          pic x(1).
  1843     02  eibrecv          pic x(1).
  1844     02  eibsend          pic x(1).
  1845     02  eibatt           pic x(1).
  1846     02  eibeoc           pic x(1).
  1847     02  eibfmh           pic x(1).
  1848     02  eibcompl         pic x(1).
  1849     02  eibsig           pic x(1).
  1850     02  eibconf          pic x(1).
  1851     02  eiberr           pic x(1).
  1852     02  eibrldbk         pic x(1).
  1853     02  eiberrcd         pic x(4).
  1854     02  eibsynrb         pic x(1).
  1855     02  eibnodat         pic x(1).
  1856     02  eibfiller5       pic x(2).
  1857     02  eibresp          pic 9(09) comp.
  1858     02  eibresp2         pic 9(09) comp.
  1859     02  dfheigdj         pic s9(4) comp.
  1860     02  dfheigdk         pic s9(4) comp.
  1861 01  DFHCOMMAREA                 PIC X(1300).
  1862 01  var  pic x(30).
  1863*                                COPY ERCACCT.
  1864******************************************************************
  1865*                                                                *
  1866*                                                                *
  1867*                            ERCACCT                             *
  1868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1869*                            VMOD=2.031                          *
  1870*                                                                *
  1871*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1872*                                                                *
  1873*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1874*   VSAM ACCOUNT MASTER FILES.                                   *
  1875*                                                                *
  1876*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1877*                                                                *
  1878*   FILE TYPE = VSAM,KSDS                                        *
  1879*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1880*                                                                *
  1881*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1882*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1883*                                                                *
  1884*   LOG = NO                                                     *
  1885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1886*                                                                *
  1887*                                                                *
  1888******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6318.cbl
  1889*                   C H A N G E   L O G
  1890*
  1891* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1892*-----------------------------------------------------------------
  1893*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1894* EFFECTIVE    NUMBER
  1895*-----------------------------------------------------------------
  1896* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1897* 092705    2005050300006  PEMA  ADD SPP LEASES
  1898* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1899* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1900* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1901* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1902* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1903******************************************************************
  1904
  1905 01  ACCOUNT-MASTER.
  1906     12  AM-RECORD-ID                      PIC XX.
  1907         88  VALID-AM-ID                      VALUE 'AM'.
  1908
  1909     12  AM-CONTROL-PRIMARY.
  1910         16  AM-COMPANY-CD                 PIC X.
  1911         16  AM-MSTR-CNTRL.
  1912             20  AM-CONTROL-A.
  1913                 24  AM-CARRIER            PIC X.
  1914                 24  AM-GROUPING.
  1915                     28 AM-GROUPING-PREFIX PIC XXX.
  1916                     28 AM-GROUPING-PRIME  PIC XXX.
  1917                 24  AM-STATE              PIC XX.
  1918                 24  AM-ACCOUNT.
  1919                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1920                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1921             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1922                                           PIC X(19).
  1923             20  AM-CNTRL-B.
  1924                 24  AM-EXPIRATION-DT      PIC XX.
  1925                 24  FILLER                PIC X(4).
  1926             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1927                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1928
  1929     12  AM-CONTROL-BY-VAR-GRP.
  1930         16  AM-COMPANY-CD-A1              PIC X.
  1931         16  AM-VG-CARRIER                 PIC X.
  1932         16  AM-VG-GROUPING                PIC X(6).
  1933         16  AM-VG-STATE                   PIC XX.
  1934         16  AM-VG-ACCOUNT                 PIC X(10).
  1935         16  AM-VG-DATE.
  1936             20  AM-VG-EXPIRATION-DT       PIC XX.
  1937             20  FILLER                    PIC X(4).
  1938         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1939                                           PIC 9(11)      COMP-3.
  1940     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1941         16  FILLER                        PIC X(10).
  1942         16  AM-VG-KEY3.
  1943             20  AM-VG3-ACCOUNT            PIC X(10).
  1944             20  AM-VG3-EXP-DT             PIC XX.
  1945         16  FILLER                        PIC X(4).
  1946     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6318.cbl
  1947         16  AM-LAST-MAINT-DT              PIC XX.
  1948         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1949         16  AM-LAST-MAINT-USER            PIC X(4).
  1950         16  FILLER                        PIC XX.
  1951
  1952     12  AM-EFFECTIVE-DT                   PIC XX.
  1953     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1954
  1955     12  AM-PREV-DATES  COMP-3.
  1956         16  AM-PREV-EXP-DT                PIC 9(11).
  1957         16  AM-PREV-EFF-DT                PIC 9(11).
  1958
  1959     12  AM-REPORT-CODE-1                  PIC X(10).
  1960     12  AM-REPORT-CODE-2                  PIC X(10).
  1961
  1962     12  AM-CITY-CODE                      PIC X(4).
  1963     12  AM-COUNTY-PARISH                  PIC X(6).
  1964
  1965     12  AM-NAME                           PIC X(30).
  1966     12  AM-PERSON                         PIC X(30).
  1967     12  AM-ADDRS                          PIC X(30).
  1968     12  AM-CITY.
  1969         16  AM-ADDR-CITY                  PIC X(28).
  1970         16  AM-ADDR-STATE                 PIC XX.
  1971     12  AM-ZIP.
  1972         16  AM-ZIP-PRIME.
  1973             20  AM-ZIP-PRI-1ST            PIC X.
  1974                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1975             20  FILLER                    PIC X(4).
  1976         16  AM-ZIP-PLUS4                  PIC X(4).
  1977     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1978         16  AM-CAN-POSTAL-1               PIC XXX.
  1979         16  AM-CAN-POSTAL-2               PIC XXX.
  1980         16  FILLER                        PIC XXX.
  1981     12  AM-TEL-NO.
  1982         16  AM-AREA-CODE                  PIC 999.
  1983         16  AM-TEL-PRE                    PIC 999.
  1984         16  AM-TEL-NBR                    PIC 9(4).
  1985     12  AM-TEL-LOC                        PIC X.
  1986         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1987         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1988
  1989     12  AM-COMM-STRUCTURE.
  1990         16  AM-DEFN-1.
  1991             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1992                 24  AM-AGT.
  1993                     28  AM-AGT-PREFIX     PIC X(4).
  1994                     28  AM-AGT-PRIME      PIC X(6).
  1995                 24  AM-COM-TYP            PIC X.
  1996                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1997                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1998                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1999                 24  AM-RECALC-LV-INDIC    PIC X.
  2000                 24  AM-RETRO-LV-INDIC     PIC X.
  2001                 24  AM-GL-CODES           PIC X.
  2002                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2003                 24  FILLER                PIC X(01).
  2004         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6318.cbl
  2005             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2006                 24  FILLER                PIC X(11).
  2007                 24  AM-L-COMA             PIC XXX.
  2008                 24  AM-J-COMA             PIC XXX.
  2009                 24  AM-A-COMA             PIC XXX.
  2010                 24  FILLER                PIC X(6).
  2011
  2012     12  AM-COMM-CHANGE-STATUS             PIC X.
  2013         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2014
  2015     12  AM-CSR-CODE                       PIC X(4).
  2016
  2017     12  AM-BILLING-STATUS                 PIC X.
  2018         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2019         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2020     12  AM-AUTO-REFUND-SW                 PIC X.
  2021         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2022         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2023     12  AM-GPCD                           PIC 99.
  2024     12  AM-IG                             PIC X.
  2025         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2026         88  AM-HAS-GROUP                     VALUE '2'.
  2027     12  AM-STATUS                         PIC X.
  2028         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2029         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2030         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2031         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2032         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2033         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2034     12  AM-REMIT-TO                       PIC 99.
  2035     12  AM-ID-NO                          PIC X(11).
  2036
  2037     12  AM-CAL-TABLE                      PIC XX.
  2038     12  AM-LF-DEVIATION                   PIC XXX.
  2039     12  AM-AH-DEVIATION                   PIC XXX.
  2040     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2041     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2042     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2043     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2044     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2045     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2046
  2047     12  AM-USER-FIELDS.
  2048         16  AM-FLD-1                      PIC XX.
  2049         16  AM-FLD-2                      PIC XX.
  2050         16  AM-FLD-3                      PIC XX.
  2051         16  AM-FLD-4                      PIC XX.
  2052         16  AM-FLD-5                      PIC XX.
  2053
  2054     12  AM-1ST-PROD-DATE.
  2055         16  AM-1ST-PROD-YR                PIC XX.
  2056         16  AM-1ST-PROD-MO                PIC XX.
  2057         16  AM-1ST-PROD-DA                PIC XX.
  2058     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2059     12  AM-CERTS-PURGED-DATE.
  2060         16  AM-PUR-YR                     PIC XX.
  2061         16  AM-PUR-MO                     PIC XX.
  2062         16  AM-PUR-DA                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6318.cbl
  2063     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2064     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2065     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2066     12  AM-INACTIVE-DATE.
  2067         16  AM-INA-MO                     PIC 99.
  2068         16  AM-INA-DA                     PIC 99.
  2069         16  AM-INA-YR                     PIC 99.
  2070     12  AM-AR-HI-CERT-DATE                PIC XX.
  2071
  2072     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2073     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2074
  2075     12  AM-OB-PAYMENT-MODE                PIC X.
  2076         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2077         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2078         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2079         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2080
  2081     12  AM-AH-ONLY-INDICATOR              PIC X.
  2082         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2083         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2084
  2085     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2086
  2087     12  AM-OVER-SHORT.
  2088         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2089         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2090
  2091     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2092     12  AM-DCC-CLP-STATE                  PIC XX.
  2093
  2094     12  AM-RECALC-COMM                    PIC X.
  2095     12  AM-RECALC-REIN                    PIC X.
  2096
  2097     12  AM-REI-TABLE                      PIC XXX.
  2098     12  AM-REI-ET-LF                      PIC X.
  2099     12  AM-REI-ET-AH                      PIC X.
  2100     12  AM-REI-PE-LF                      PIC X.
  2101     12  AM-REI-PE-AH                      PIC X.
  2102     12  AM-REI-PRT-ST                     PIC X.
  2103     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2104     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2105     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2106     12  AM-REI-GROUP-A                    PIC X(6).
  2107     12  AM-REI-MORT                       PIC X(4).
  2108     12  AM-REI-PRT-OW                     PIC X.
  2109     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2110     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2111     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2112     12  AM-REI-GROUP-B                    PIC X(6).
  2113
  2114     12  AM-TRUST-TYPE                     PIC X(2).
  2115
  2116     12  AM-EMPLOYER-STMT-USED             PIC X.
  2117     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2118
  2119     12  AM-STD-AH-TYPE                    PIC XX.
  2120     12  AM-EARN-METHODS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6318.cbl
  2121         16  AM-EARN-METHOD-R              PIC X.
  2122             88 AM-REF-RL-R78                 VALUE 'R'.
  2123             88 AM-REF-RL-PR                  VALUE 'P'.
  2124             88 AM-REF-RL-MEAN                VALUE 'M'.
  2125             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2126         16  AM-EARN-METHOD-L              PIC X.
  2127             88 AM-REF-LL-R78                 VALUE 'R'.
  2128             88 AM-REF-LL-PR                  VALUE 'P'.
  2129             88 AM-REF-LL-MEAN                VALUE 'M'.
  2130             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2131         16  AM-EARN-METHOD-A              PIC X.
  2132             88 AM-REF-AH-R78                 VALUE 'R'.
  2133             88 AM-REF-AH-PR                  VALUE 'P'.
  2134             88 AM-REF-AH-MEAN                VALUE 'M'.
  2135             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2136             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2137             88 AM-REF-AH-NET                 VALUE 'N'.
  2138
  2139     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2140     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2141     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2142
  2143     12  AM-RET-Y-N                        PIC X.
  2144     12  AM-RET-P-E                        PIC X.
  2145     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2146     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2147     12  AM-RET-GRP                        PIC X(6).
  2148     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2149         16  AM-POOL-PRIME                 PIC XXX.
  2150         16  AM-POOL-SUB                   PIC XXX.
  2151     12  AM-RETRO-EARNINGS.
  2152         16  AM-RET-EARN-R                 PIC X.
  2153         16  AM-RET-EARN-L                 PIC X.
  2154         16  AM-RET-EARN-A                 PIC X.
  2155     12  AM-RET-ST-TAX-USE                 PIC X.
  2156         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2157         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2158     12  AM-RETRO-BEG-EARNINGS.
  2159         16  AM-RET-BEG-EARN-R             PIC X.
  2160         16  AM-RET-BEG-EARN-L             PIC X.
  2161         16  AM-RET-BEG-EARN-A             PIC X.
  2162     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2163     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2164
  2165     12  AM-USER-SELECT-OPTIONS.
  2166         16  AM-USER-SELECT-1              PIC X(10).
  2167         16  AM-USER-SELECT-2              PIC X(10).
  2168         16  AM-USER-SELECT-3              PIC X(10).
  2169         16  AM-USER-SELECT-4              PIC X(10).
  2170         16  AM-USER-SELECT-5              PIC X(10).
  2171
  2172     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2173
  2174     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2175
  2176     12  AM-RPT045A-SWITCH                 PIC X.
  2177         88  RPT045A-OFF                   VALUE 'N'.
  2178
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6318.cbl
  2179     12  AM-INSURANCE-LIMITS.
  2180         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2181         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2182
  2183     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2184         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2185
  2186     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2187         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2188         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2189
  2190     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2191
  2192     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2193     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2194     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2195     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2196     12  AM-DCC-UEF-STATE                  PIC XX.
  2197     12  FILLER                            PIC XXX.
  2198     12  AM-REPORT-CODE-3                  PIC X(10).
  2199*    12  FILLER                            PIC X(22).
  2200
  2201     12  AM-RESERVE-DATE.
  2202         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2203         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2204         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2205
  2206     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2207     12  AM-NOTIFICATION-TYPES.
  2208         16  AM-NOTIF-OF-LETTERS           PIC X.
  2209         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2210         16  AM-NOTIF-OF-REPORTS           PIC X.
  2211         16  AM-NOTIF-OF-STATUS            PIC X.
  2212
  2213     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2214         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2215         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2216         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2217         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2218
  2219     12  AM-BENEFIT-CONTROLS.
  2220         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2221             20  AM-BENEFIT-CODE           PIC XX.
  2222             20  AM-BENEFIT-TYPE           PIC X.
  2223             20  AM-BENEFIT-REVISION       PIC XXX.
  2224             20  AM-BENEFIT-REM-TERM       PIC X.
  2225             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2226             20  FILLER                    PIC XX.
  2227         16  FILLER                        PIC X(80).
  2228
  2229     12  AM-TRANSFER-DATA.
  2230         16  AM-TRANSFERRED-FROM.
  2231             20  AM-TRNFROM-CARRIER        PIC X.
  2232             20  AM-TRNFROM-GROUPING.
  2233                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2234                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2235             20  AM-TRNFROM-STATE          PIC XX.
  2236             20  AM-TRNFROM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6318.cbl
  2237                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2238                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2239             20  AM-TRNFROM-DTE            PIC XX.
  2240         16  AM-TRANSFERRED-TO.
  2241             20  AM-TRNTO-CARRIER          PIC X.
  2242             20  AM-TRNTO-GROUPING.
  2243                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2244                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2245             20  AM-TRNTO-STATE            PIC XX.
  2246             20  AM-TRNTO-ACCOUNT.
  2247                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2248                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2249             20  AM-TRNTO-DTE              PIC XX.
  2250         16  FILLER                        PIC X(10).
  2251
  2252     12  AM-SAVED-REMIT-TO                 PIC 99.
  2253
  2254     12  AM-COMM-STRUCTURE-SAVED.
  2255         16  AM-DEFN-1-SAVED.
  2256             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2257                 24  AM-AGT-SV             PIC X(10).
  2258                 24  AM-COM-TYP-SV         PIC X.
  2259                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2260                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2261                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2262                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2263                 24  FILLER                PIC X.
  2264                 24  AM-GL-CODES-SV        PIC X.
  2265                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2266                 24  FILLER                PIC X.
  2267         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2268             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2269                 24  FILLER                PIC X(11).
  2270                 24  AM-L-COMA-SV          PIC XXX.
  2271                 24  AM-J-COMA-SV          PIC XXX.
  2272                 24  AM-A-COMA-SV          PIC XXX.
  2273                 24  FILLER                PIC X(6).
  2274
  2275     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2276         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2277            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2278            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2279            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2280
  2281     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2282     12  FILLER                            PIC X(120).
  2283
  2284     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2285         16  AM-CONTROL-NAME               PIC X(30).
  2286         16  AM-EXECUTIVE-ONE.
  2287             20  AM-EXEC1-NAME             PIC X(15).
  2288             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2289                                                          COMP-3.
  2290             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2291                                                          COMP-3.
  2292         16  AM-EXECUTIVE-TWO.
  2293             20  AM-EXEC2-NAME             PIC X(15).
  2294             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6318.cbl
  2295                                                          COMP-3.
  2296             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2297                                                          COMP-3.
  2298
  2299     12  AM-RETRO-ADDITIONAL-DATA.
  2300         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2301         16  AM-RETRO-PREM-P-E             PIC X.
  2302         16  AM-RETRO-CLMS-P-I             PIC X.
  2303         16  AM-RETRO-RET-BRACKET-LF.
  2304             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2305                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2306                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2307             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2308                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2309                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2310             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2311                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2312                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2313         16  AM-RETRO-RET-BRACKET-AH.
  2314             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2315                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2316                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2317                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2318             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2319                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2320                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2321             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2322                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2323                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2324
  2325     12  AM-COMMENTS.
  2326         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2327
  2328     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2329         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2330         16  AM-FLI-BILLING-CODE           PIC X.
  2331         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2332         16  AM-FLI-UNITED-IDENT           PIC X.
  2333         16  AM-FLI-INTEREST-LOST-DATA.
  2334             20  AM-FLI-BANK-NO            PIC X(5).
  2335             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2336             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2337             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2338         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2339             20  AM-FLI-AGT                PIC X(9).
  2340             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2341             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2342         16  FILLER                        PIC X(102).
  2343
  2344     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2345         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2346             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2347             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2348             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2349             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2350             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2351         16  FILLER                          PIC X(10).
  2352******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6318.cbl
  2353*                                COPY ELCCNTL.
  2354******************************************************************
  2355*                                                                *
  2356*                                                                *
  2357*                            ELCCNTL.                            *
  2358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2359*                            VMOD=2.059                          *
  2360*                                                                *
  2361*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2362*                                                                *
  2363*   FILE TYPE = VSAM,KSDS                                        *
  2364*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2365*                                                                *
  2366*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2367*       ALTERNATE INDEX = NONE                                   *
  2368*                                                                *
  2369*   LOG = YES                                                    *
  2370*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2371******************************************************************
  2372*                   C H A N G E   L O G
  2373*
  2374* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2375*-----------------------------------------------------------------
  2376*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2377* EFFECTIVE    NUMBER
  2378*-----------------------------------------------------------------
  2379* 082503                   PEMA  ADD BENEFIT GROUP
  2380* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2381* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2382* 092705    2005050300006  PEMA  ADD SPP LEASES
  2383* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2384* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2385* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2386* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2387* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2388* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2389******************************************************************
  2390*
  2391 01  CONTROL-FILE.
  2392     12  CF-RECORD-ID                       PIC XX.
  2393         88  VALID-CF-ID                        VALUE 'CF'.
  2394
  2395     12  CF-CONTROL-PRIMARY.
  2396         16  CF-COMPANY-ID                  PIC XXX.
  2397         16  CF-RECORD-TYPE                 PIC X.
  2398             88  CF-COMPANY-MASTER              VALUE '1'.
  2399             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2400             88  CF-STATE-MASTER                VALUE '3'.
  2401             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2402             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2403             88  CF-CARRIER-MASTER              VALUE '6'.
  2404             88  CF-MORTALITY-MASTER            VALUE '7'.
  2405             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2406             88  CF-TERMINAL-MASTER             VALUE '9'.
  2407             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2408             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2409             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2410             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6318.cbl
  2411             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2412             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2413             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2414             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2415             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2416         16  CF-ACCESS-CD-GENL              PIC X(4).
  2417         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2418             20  CF-PROCESSOR               PIC X(4).
  2419         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2420             20  CF-STATE-CODE              PIC XX.
  2421             20  FILLER                     PIC XX.
  2422         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2423             20  FILLER                     PIC XX.
  2424             20  CF-HI-BEN-IN-REC           PIC XX.
  2425         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2426             20  FILLER                     PIC XXX.
  2427             20  CF-CARRIER-CNTL            PIC X.
  2428         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2429             20  FILLER                     PIC XX.
  2430             20  CF-HI-TYPE-IN-REC          PIC 99.
  2431         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2432             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2433                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2434             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2435             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2436         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2437             20  FILLER                     PIC X.
  2438             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2439         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2440             20  FILLER                     PIC XX.
  2441             20  CF-MORTGAGE-PLAN           PIC XX.
  2442         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2443
  2444     12  CF-LAST-MAINT-DT                   PIC XX.
  2445     12  CF-LAST-MAINT-BY                   PIC X(4).
  2446     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2447
  2448     12  CF-RECORD-BODY                     PIC X(728).
  2449
  2450
  2451****************************************************************
  2452*             COMPANY MASTER RECORD                            *
  2453****************************************************************
  2454
  2455     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2456         16  CF-COMPANY-ADDRESS.
  2457             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2458             20  CF-CL-IN-CARE-OF           PIC X(30).
  2459             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2460             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2461             20  CF-CL-CITY-STATE           PIC X(30).
  2462             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2463             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2464         16  CF-COMPANY-CD                  PIC X.
  2465         16  CF-COMPANY-PASSWORD            PIC X(8).
  2466         16  CF-SECURITY-OPTION             PIC X.
  2467             88  ALL-SECURITY                   VALUE '1'.
  2468             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6318.cbl
  2469             88  PROCESSOR-VERIFY               VALUE '3'.
  2470             88  NO-SECURITY                    VALUE '4'.
  2471             88  ALL-BUT-TERM                   VALUE '5'.
  2472         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2473             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2474         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2475             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2476         16  CF-INFORCE-LOCATION            PIC X.
  2477             88  CERTS-ARE-ONLINE               VALUE '1'.
  2478             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2479             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2480         16  CF-LOWER-CASE-LETTERS          PIC X.
  2481         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2482             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2483             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2484             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2485             88  CF-ACCNT-CNTL                  VALUE '3'.
  2486             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2487
  2488         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2489         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2490
  2491         16  CF-LGX-CREDIT-USER             PIC X.
  2492             88  CO-IS-NOT-USER                 VALUE 'N'.
  2493             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2494
  2495         16 CF-CREDIT-CALC-CODES.
  2496             20  CF-CR-REM-TERM-CALC PIC X.
  2497               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2498               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2499               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2500               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2501               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2502               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2503               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2504             20  CF-CR-R78-METHOD           PIC X.
  2505               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2506               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2507
  2508         16  CF-CLAIM-CONTROL-COUNTS.
  2509             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2510                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2511
  2512             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2513                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2514
  2515             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2516                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2517
  2518             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2519                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2520
  2521         16  CF-CURRENT-MONTH-END           PIC XX.
  2522
  2523         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2524             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2525             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2526             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6318.cbl
  2527             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2528                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2529                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2530             20  CF-CO-PREM-REJECT-SW       PIC X.
  2531                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2532                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2533             20  CF-CO-REF-REJECT-SW        PIC X.
  2534                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2535                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2536
  2537         16  CF-CO-REPORTING-DT             PIC XX.
  2538         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2539         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2540           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2541           88  CF-CO-MONTH-END                  VALUE '1'.
  2542
  2543         16  CF-LGX-CLAIM-USER              PIC X.
  2544             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2545             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2546
  2547         16  CF-CREDIT-EDIT-CONTROLS.
  2548             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2549             20  CF-MIN-AGE                 PIC 99.
  2550             20  CF-DEFAULT-AGE             PIC 99.
  2551             20  CF-MIN-TERM                PIC S999      COMP-3.
  2552             20  CF-MAX-TERM                PIC S999      COMP-3.
  2553             20  CF-DEFAULT-SEX             PIC X.
  2554             20  CF-JOINT-AGE-INPUT         PIC X.
  2555                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2556             20  CF-BIRTH-DATE-INPUT        PIC X.
  2557                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2558             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2559                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2560                 88  CF-ZERO-CARRIER            VALUE '1'.
  2561                 88  CF-ZERO-GROUPING           VALUE '2'.
  2562                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2563             20  CF-EDIT-SW                 PIC X.
  2564                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2565             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2566             20  CF-CR-PR-METHOD            PIC X.
  2567               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2568               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2569             20  FILLER                     PIC X.
  2570
  2571         16  CF-CREDIT-MISC-CONTROLS.
  2572             20  CF-REIN-TABLE-SW           PIC X.
  2573                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2574             20  CF-COMP-TABLE-SW           PIC X.
  2575                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2576             20  CF-EXPERIENCE-RETENTION-AGE
  2577                                            PIC S9        COMP-3.
  2578             20  CF-CONVERSION-DT           PIC XX.
  2579             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2580             20  CF-RUN-FREQUENCY-SW        PIC X.
  2581                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2582                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2583
  2584             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6318.cbl
  2585                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2586                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2587                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2588                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2589                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2590                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2591
  2592                 24  CF-CR-CHECK-COUNT       REDEFINES
  2593                     CF-CR-CHECK-COUNTER      PIC X(4).
  2594
  2595                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2596                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2597
  2598                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2599                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2600                 24  CF-MAIL-PROCESSING       PIC X.
  2601                     88  MAIL-PROCESSING          VALUE 'Y'.
  2602
  2603         16  CF-MISC-SYSTEM-CONTROL.
  2604             20  CF-SYSTEM-C                 PIC X.
  2605                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2606             20  CF-SYSTEM-D                 PIC X.
  2607                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2608             20  CF-SOC-SEC-NO-SW            PIC X.
  2609                 88  SOC-SEC-NO-USED             VALUE '1'.
  2610             20  CF-MEMBER-NO-SW             PIC X.
  2611                 88  MEMBER-NO-USED              VALUE '1'.
  2612             20  CF-TAX-ID-NUMBER            PIC X(11).
  2613             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2614             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2615                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2616                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2617                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2618                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2619             20  CF-SYSTEM-E                 PIC X.
  2620                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2621
  2622         16  CF-LGX-LIFE-USER               PIC X.
  2623             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2624             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2625
  2626         16  CF-CR-MONTH-END-DT             PIC XX.
  2627
  2628         16  CF-FILE-MAINT-DATES.
  2629             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2630                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2631             20  CF-LAST-BATCH       REDEFINES
  2632                 CF-LAST-BATCH-NO               PIC X(4).
  2633             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2634             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2635             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2636             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2637             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2638             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2639             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2640             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2641             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2642             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6318.cbl
  2643
  2644         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2645         16  FILLER                         PIC X.
  2646
  2647         16  CF-ALT-MORT-CODE               PIC X(4).
  2648         16  CF-MEMBER-CAPTION              PIC X(10).
  2649
  2650         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2651             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2652             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2653             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2654             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2655             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2656
  2657         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2658
  2659         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2660         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2661         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2662         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2663
  2664         16  CF-AH-OVERRIDE-L1              PIC X.
  2665         16  CF-AH-OVERRIDE-L2              PIC XX.
  2666         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2667         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2668
  2669         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2670         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2671
  2672         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2673         16  CF-AR-LAST-EL860-DT            PIC XX.
  2674         16  CF-MP-MONTH-END-DT             PIC XX.
  2675
  2676         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2677         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2678             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2679
  2680         16  CF-AR-MONTH-END-DT             PIC XX.
  2681
  2682         16  CF-CRDTCRD-USER                PIC X.
  2683             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2684             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2685
  2686         16  CF-CC-MONTH-END-DT             PIC XX.
  2687
  2688         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2689
  2690         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2691             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2692             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2693             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2694         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2695         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2696         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2697         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2698             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2699             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2700         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6318.cbl
  2701         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2702         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2703             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2704         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2705
  2706         16  CF-CL-ZIP-CODE.
  2707             20  CF-CL-ZIP-PRIME.
  2708                 24  CF-CL-ZIP-1ST          PIC X.
  2709                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2710                 24  FILLER                 PIC X(4).
  2711             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2712         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2713             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2714             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2715             20  FILLER                     PIC XXX.
  2716
  2717         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2718         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2719         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2720         16  CF-CO-OPTION-START-DATE        PIC XX.
  2721         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2722           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2723                                                      '3' '4'.
  2724           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2725           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2726           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2727           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2728           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2729           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2730
  2731         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2732
  2733         16  CF-PAYMENT-APPROVAL-LEVELS.
  2734             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2735             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2736             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2737             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2738             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2739             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2740
  2741         16  CF-END-USER-REPORTING-USER     PIC X.
  2742             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2743             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2744
  2745         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2746             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2747             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2748
  2749         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2750
  2751         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2752         16  FILLER                         PIC X.
  2753
  2754         16  CF-CREDIT-ARCHIVE-CNTL.
  2755             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2756             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2757             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2758
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6318.cbl
  2759         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2760
  2761         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2762             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2763             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2764
  2765         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2766             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2767             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2768
  2769         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2770
  2771         16  CF-CO-ACH-ID-CODE              PIC  X.
  2772             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2773             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2774             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2775         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2776         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2777         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2778         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2779         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2780         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2781         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2782         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2783         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2784                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2785         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2786                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2787
  2788         16  CF-CO-OVER-SHORT.
  2789             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2790             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2791
  2792*         16  FILLER                         PIC X(102).
  2793         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2794             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2795             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2796
  2797         16  CF-AH-APPROVAL-DAYS.
  2798             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2799             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2800             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2801             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2802
  2803         16  FILLER                         PIC X(82).
  2804****************************************************************
  2805*             PROCESSOR/USER RECORD                            *
  2806****************************************************************
  2807
  2808     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2809         16  CF-PROCESSOR-NAME              PIC X(30).
  2810         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2811         16  CF-PROCESSOR-TITLE             PIC X(26).
  2812         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2813                 88  MESSAGE-YES                VALUE 'Y'.
  2814                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2815
  2816*****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6318.cbl
  2817****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2818****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2819****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2820****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2821*****************************************************
  2822
  2823         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2824             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2825             20  CF-APPLICATION-FORCE       PIC X.
  2826             20  CF-INDIVIDUAL-APP.
  2827                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2828                     28  CF-BROWSE-APP      PIC X.
  2829                     28  CF-UPDATE-APP      PIC X.
  2830
  2831         16  CF-CURRENT-TERM-ON             PIC X(4).
  2832         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2833             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2834             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2835             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2836             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2837             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2838             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2839             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2840         16  CF-PROCESSOR-CARRIER           PIC X.
  2841             88  NO-CARRIER-SECURITY            VALUE ' '.
  2842         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2843             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2844         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2845             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2846         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2847             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2848
  2849         16  CF-PROC-SYS-ACCESS-SW.
  2850             20  CF-PROC-CREDIT-CLAIMS-SW.
  2851                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2852                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2853                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2854                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2855             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2856                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2857                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2858             20  CF-PROC-LIFE-GNRLDGR-SW.
  2859                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2860                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2861                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2862                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2863             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2864                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2865                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2866         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2867             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2868             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2869         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2870
  2871         16  CF-APPROVAL-LEVEL                  PIC X.
  2872             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2873             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2874             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6318.cbl
  2875             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2876
  2877         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2878
  2879         16  CF-LANGUAGE-TYPE                   PIC X.
  2880             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2881             88  CF-LANG-IS-FR                      VALUE 'F'.
  2882
  2883         16  CF-CSR-IND                         PIC X.
  2884         16  FILLER                             PIC X(239).
  2885
  2886****************************************************************
  2887*             PROCESSOR/REMINDERS RECORD                       *
  2888****************************************************************
  2889
  2890     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2891         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2892             20  CF-START-REMIND-DT         PIC XX.
  2893             20  CF-END-REMIND-DT           PIC XX.
  2894             20  CF-REMINDER-TEXT           PIC X(50).
  2895         16  FILLER                         PIC X(296).
  2896
  2897
  2898****************************************************************
  2899*             STATE MASTER RECORD                              *
  2900****************************************************************
  2901
  2902     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2903         16  CF-STATE-ABBREVIATION          PIC XX.
  2904         16  CF-STATE-NAME                  PIC X(25).
  2905         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2906         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2907             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2908             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2909             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2910             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2911                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2912                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2913             20  CF-ST-PREM-REJECT-SW       PIC X.
  2914                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2915                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2916             20  CF-ST-REF-REJECT-SW        PIC X.
  2917                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2918                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2919         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2920         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2921         16  CF-ST-REFUND-RULES.
  2922             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2923             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2924             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2925         16  CF-ST-FST-PMT-EXTENSION.
  2926             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2927             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2928                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2929                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2930                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2931                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2932         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6318.cbl
  2933             20  CF-ST-CALL-UNEARNED        PIC X.
  2934             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2935             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2936         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2937             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2938             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2939         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2940         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2941         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2942         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2943         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2944         16  FILLER                         PIC X.
  2945         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2946             20  CF-ST-BENEFIT-CD           PIC XX.
  2947             20  CF-ST-BENEFIT-KIND         PIC X.
  2948                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2949                 88  CF-ST-AH-KIND              VALUE 'A'.
  2950             20  CF-ST-REM-TERM-CALC        PIC X.
  2951                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2952                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2953                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2954                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2955                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2956                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2957                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2958                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2959
  2960             20  CF-ST-REFUND-CALC          PIC X.
  2961                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2962                 88  ST-REFD-BY-R78             VALUE '1'.
  2963                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2964                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2965                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2966                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2967                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2968                 88  ST-REFD-UTAH               VALUE '7'.
  2969                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2970                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2971                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2972
  2973             20  CF-ST-EARNING-CALC         PIC X.
  2974                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2975                 88  ST-EARN-BY-R78             VALUE '1'.
  2976                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2977                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2978                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2979                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2980                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2981                 88  ST-EARN-MEAN               VALUE '8'.
  2982                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2983
  2984             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2985                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2986                 88  ST-OVRD-BY-R78             VALUE '1'.
  2987                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2988                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2989                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2990                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6318.cbl
  2991                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2992                 88  ST-OVRD-MEAN               VALUE '8'.
  2993                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2994             20  FILLER                     PIC X.
  2995
  2996         16  CF-ST-COMMISSION-CAPS.
  2997             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2998             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2999             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3000             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3001         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3002                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3003
  3004         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3005
  3006         16  CF-ST-STATUTORY-INTEREST.
  3007             20  CF-ST-STAT-DATE-FROM       PIC X.
  3008                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3009                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3010             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3011             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3012             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3013             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3014             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3015
  3016         16  CF-ST-OVER-SHORT.
  3017             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3018             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3019
  3020         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3021
  3022         16  CF-ST-RT-CALC                  PIC X.
  3023
  3024         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3025         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3026         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3027         16  CF-ST-RF-LR-CALC               PIC X.
  3028         16  CF-ST-RF-LL-CALC               PIC X.
  3029         16  CF-ST-RF-LN-CALC               PIC X.
  3030         16  CF-ST-RF-AH-CALC               PIC X.
  3031         16  CF-ST-RF-CP-CALC               PIC X.
  3032*        16  FILLER                         PIC X(206).
  3033*CIDMOD         16  FILLER                         PIC X(192).
  3034         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3035             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3036         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3037         16  CF-ST-VFY-2ND-BENE             PIC X.
  3038         16  FILLER                         PIC X(186).
  3039
  3040****************************************************************
  3041*             BENEFIT MASTER RECORD                            *
  3042****************************************************************
  3043
  3044     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3045         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3046             20  CF-BENEFIT-CODE            PIC XX.
  3047             20  CF-BENEFIT-NUMERIC  REDEFINES
  3048                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6318.cbl
  3049             20  CF-BENEFIT-ALPHA           PIC XXX.
  3050             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3051             20  CF-BENEFIT-COMMENT         PIC X(10).
  3052
  3053             20  CF-LF-COVERAGE-TYPE        PIC X.
  3054                 88  CF-REDUCING                VALUE 'R'.
  3055                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3056
  3057             20  CF-SPECIAL-CALC-CD         PIC X.
  3058                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3059                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3060                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3061                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3062                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3063                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3064                 88  CF-FARM-PLAN               VALUE 'F'.
  3065                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3066                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3067                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3068                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3069                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3070                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3071                 88  CF-PRUDENTIAL              VALUE 'P'.
  3072                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3073                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3074                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3075                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3076                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3077                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3078
  3079             20  CF-JOINT-INDICATOR         PIC X.
  3080                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3081
  3082*            20  FILLER                     PIC X(12).
  3083             20  FILLER                     PIC X(11).
  3084             20  CF-BENEFIT-CATEGORY        PIC X.
  3085             20  CF-LOAN-TYPE               PIC X(8).
  3086
  3087             20  CF-CO-REM-TERM-CALC        PIC X.
  3088                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3089                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3090                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3091                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3092                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3093
  3094             20  CF-CO-EARNINGS-CALC        PIC X.
  3095                 88  CO-EARN-BY-R78             VALUE '1'.
  3096                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3097                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3098                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3099                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3100                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3101                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3102                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3103
  3104             20  CF-CO-REFUND-CALC          PIC X.
  3105                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3106                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6318.cbl
  3107                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3108                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3109                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3110                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3111                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3112                 88  CO-REFD-MEAN               VALUE '8'.
  3113                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3114                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3115                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3116
  3117             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3118                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3119                 88  CO-OVRD-BY-R78             VALUE '1'.
  3120                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3121                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3122                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3123                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3124                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3125                 88  CO-OVRD-MEAN               VALUE '8'.
  3126                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3127
  3128             20  CF-CO-BEN-I-G-CD           PIC X.
  3129                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3130                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3131                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3132
  3133         16  FILLER                         PIC X(304).
  3134
  3135
  3136****************************************************************
  3137*             CARRIER MASTER RECORD                            *
  3138****************************************************************
  3139
  3140     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3141         16  CF-ADDRESS-DATA.
  3142             20  CF-MAIL-TO-NAME            PIC X(30).
  3143             20  CF-IN-CARE-OF              PIC X(30).
  3144             20  CF-ADDRESS-LINE-1          PIC X(30).
  3145             20  CF-ADDRESS-LINE-2          PIC X(30).
  3146             20  CF-CITY-STATE              PIC X(30).
  3147             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3148             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3149
  3150         16  CF-CLAIM-NO-CONTROL.
  3151             20  CF-CLAIM-NO-METHOD         PIC X.
  3152                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3153                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3154                 88  CLAIM-NO-SEQ               VALUE '3'.
  3155                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3156             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3157                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3158                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3159                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3160
  3161         16  CF-CHECK-NO-CONTROL.
  3162             20  CF-CHECK-NO-METHOD         PIC X.
  3163                 88  CHECK-NO-MANUAL            VALUE '1'.
  3164                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6318.cbl
  3165                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3166                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3167             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3168                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3169
  3170         16  CF-DOMICILE-STATE              PIC XX.
  3171
  3172         16  CF-EXPENSE-CONTROLS.
  3173             20  CF-EXPENSE-METHOD          PIC X.
  3174                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3175                 88  DOLLARS-PER-PMT            VALUE '2'.
  3176                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3177                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3178             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3179             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3180
  3181         16  CF-CORRESPONDENCE-CONTROL.
  3182             20  CF-LETTER-RESEND-OPT       PIC X.
  3183                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3184                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3185             20  FILLER                     PIC X(4).
  3186
  3187         16  CF-RESERVE-CONTROLS.
  3188             20  CF-MANUAL-SW               PIC X.
  3189                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3190             20  CF-FUTURE-SW               PIC X.
  3191                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3192             20  CF-PTC-SW                  PIC X.
  3193                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3194             20  CF-IBNR-SW                 PIC X.
  3195                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3196             20  CF-PTC-LF-SW               PIC X.
  3197                 88  CF-LF-PTC-USED             VALUE '1'.
  3198             20  CF-CDT-ACCESS-METHOD       PIC X.
  3199                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3200                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3201                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3202             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3203
  3204         16  CF-CLAIM-CALC-METHOD           PIC X.
  3205             88  360-PLUS-MONTHS                VALUE '1'.
  3206             88  365-PLUS-MONTHS                VALUE '2'.
  3207             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3208             88  360-DAILY                      VALUE '4'.
  3209             88  365-DAILY                      VALUE '5'.
  3210
  3211         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3212         16  FILLER                         PIC X(11).
  3213
  3214         16  CF-LIMIT-AMOUNTS.
  3215             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3216             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3217             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3218             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3219             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3220             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3221             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3222             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6318.cbl
  3223             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3224             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3225
  3226         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3227         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3228         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3229
  3230         16  CF-ZIP-CODE.
  3231             20  CF-ZIP-PRIME.
  3232                 24  CF-ZIP-1ST             PIC X.
  3233                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3234                 24  FILLER                 PIC X(4).
  3235             20  CF-ZIP-PLUS4               PIC X(4).
  3236         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3237             20  CF-CAN-POSTAL-1            PIC XXX.
  3238             20  CF-CAN-POSTAL-2            PIC XXX.
  3239             20  FILLER                     PIC XXX.
  3240
  3241         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3242         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3243         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3244
  3245         16  CF-RATING-SWITCH               PIC X.
  3246             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3247             88  CF-NO-RATING                   VALUE 'N'.
  3248
  3249         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3250
  3251         16  CF-CARRIER-OVER-SHORT.
  3252             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3253             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3254
  3255         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3256         16  CF-SECPAY-SWITCH               PIC X.
  3257             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3258             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3259         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3260         16  FILLER                         PIC X(448).
  3261*        16  FILLER                         PIC X(452).
  3262
  3263
  3264****************************************************************
  3265*             MORTALITY MASTER RECORD                          *
  3266****************************************************************
  3267
  3268     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3269         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3270                                INDEXED BY CF-MORT-NDX.
  3271             20  CF-MORT-TABLE              PIC X(5).
  3272             20  CF-MORT-TABLE-TYPE         PIC X.
  3273                 88  CF-MORT-JOINT              VALUE 'J'.
  3274                 88  CF-MORT-SINGLE             VALUE 'S'.
  3275                 88  CF-MORT-COMBINED           VALUE 'C'.
  3276                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3277                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3278             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3279             20  CF-MORT-AGE-METHOD         PIC XX.
  3280                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6318.cbl
  3281                 88  CF-AGE-NEAR                VALUE 'AN'.
  3282             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3283             20  CF-MORT-ADJUSTMENT-DIRECTION
  3284                                            PIC X.
  3285                 88  CF-MINUS                   VALUE '-'.
  3286                 88  CF-PLUS                    VALUE '+'.
  3287             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3288             20  CF-MORT-JOINT-CODE         PIC X.
  3289                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3290             20  CF-MORT-PC-Q               PIC X.
  3291                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3292             20  CF-MORT-TABLE-CODE         PIC X(4).
  3293             20  CF-MORT-COMMENTS           PIC X(15).
  3294             20  FILLER                     PIC X(14).
  3295
  3296         16  FILLER                         PIC X(251).
  3297
  3298
  3299****************************************************************
  3300*             BUSSINESS TYPE MASTER RECORD                     *
  3301****************************************************************
  3302
  3303     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3304* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3305* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3306* AND RECORD 05 IS TYPES 81-99
  3307         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3308             20  CF-BUSINESS-TITLE          PIC  X(19).
  3309             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3310                                            PIC S9V9(4) COMP-3.
  3311             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3312             20  FILLER                     PIC  X.
  3313         16  FILLER                         PIC  X(248).
  3314
  3315
  3316****************************************************************
  3317*             TERMINAL MASTER RECORD                           *
  3318****************************************************************
  3319
  3320     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3321
  3322         16  CF-COMPANY-TERMINALS.
  3323             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3324                                  PIC X(4).
  3325         16  FILLER               PIC X(248).
  3326
  3327
  3328****************************************************************
  3329*             LIFE EDIT MASTER RECORD                          *
  3330****************************************************************
  3331
  3332     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3333         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3334             20  CF-LIFE-CODE-IN            PIC XX.
  3335             20  CF-LIFE-CODE-OUT           PIC XX.
  3336         16  FILLER                         PIC X(248).
  3337
  3338
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6318.cbl
  3339****************************************************************
  3340*             AH EDIT MASTER RECORD                            *
  3341****************************************************************
  3342
  3343     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3344         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3345             20  CF-AH-CODE-IN              PIC XXX.
  3346             20  CF-AH-CODE-OUT             PIC XX.
  3347         16  FILLER                         PIC X(248).
  3348
  3349
  3350****************************************************************
  3351*             CREDIBILITY TABLES                               *
  3352****************************************************************
  3353
  3354     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3355         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3356                             INDEXED BY CF-CRDB-NDX.
  3357             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3358             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3359             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3360         16  FILLER                         PIC  X(332).
  3361
  3362
  3363****************************************************************
  3364*             REPORT CUSTOMIZATION RECORD                      *
  3365****************************************************************
  3366
  3367     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3368         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3369             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3370             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3371             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3372**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3373****       A T-TRANSFER.                                   ****
  3374             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3375
  3376         16  FILLER                         PIC XX.
  3377
  3378         16  CF-CARRIER-CNTL-OPT.
  3379             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3380                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3381                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3382             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3383                                            PIC X.
  3384         16  CF-GROUP-CNTL-OPT.
  3385             20  CF-GROUP-OPT-SEQ           PIC 9.
  3386                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3387                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3388             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3389                                            PIC X(6).
  3390         16  CF-STATE-CNTL-OPT.
  3391             20  CF-STATE-OPT-SEQ           PIC 9.
  3392                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3393                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3394             20  CF-STATE-SELECT OCCURS 3 TIMES
  3395                                            PIC XX.
  3396         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6318.cbl
  3397             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3398                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3399                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3400             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3401                                            PIC X(10).
  3402         16  CF-BUS-TYP-CNTL-OPT.
  3403             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3404                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3405                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3406             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3407                                            PIC XX.
  3408         16  CF-LF-TYP-CNTL-OPT.
  3409             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3410                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3411                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3412             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3413                                            PIC XX.
  3414         16  CF-AH-TYP-CNTL-OPT.
  3415             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3416                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3417                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3418             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3419                                            PIC XX.
  3420         16  CF-REPTCD1-CNTL-OPT.
  3421             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3422                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3423                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3424             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3425                                            PIC X(10).
  3426         16  CF-REPTCD2-CNTL-OPT.
  3427             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3428                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3429                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3430             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3431                                            PIC X(10).
  3432         16  CF-USER1-CNTL-OPT.
  3433             20  CF-USER1-OPT-SEQ           PIC 9.
  3434                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3435                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3436             20  CF-USER1-SELECT OCCURS 3 TIMES
  3437                                            PIC X(10).
  3438         16  CF-USER2-CNTL-OPT.
  3439             20  CF-USER2-OPT-SEQ           PIC 9.
  3440                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3441                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3442             20  CF-USER2-SELECT OCCURS 3 TIMES
  3443                                            PIC X(10).
  3444         16  CF-USER3-CNTL-OPT.
  3445             20  CF-USER3-OPT-SEQ           PIC 9.
  3446                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3447                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3448             20  CF-USER3-SELECT OCCURS 3 TIMES
  3449                                            PIC X(10).
  3450         16  CF-USER4-CNTL-OPT.
  3451             20  CF-USER4-OPT-SEQ           PIC 9.
  3452                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3453                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3454             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6318.cbl
  3455                                            PIC X(10).
  3456         16  CF-USER5-CNTL-OPT.
  3457             20  CF-USER5-OPT-SEQ           PIC 9.
  3458                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3459                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3460             20  CF-USER5-SELECT OCCURS 3 TIMES
  3461                                            PIC X(10).
  3462         16  CF-REINS-CNTL-OPT.
  3463             20  CF-REINS-OPT-SEQ           PIC 9.
  3464                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3465                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3466             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3467                 24  CF-REINS-PRIME         PIC XXX.
  3468                 24  CF-REINS-SUB           PIC XXX.
  3469
  3470         16  CF-AGENT-CNTL-OPT.
  3471             20  CF-AGENT-OPT-SEQ           PIC 9.
  3472                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3473                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3474             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3475                                            PIC X(10).
  3476
  3477         16  FILLER                         PIC X(43).
  3478
  3479         16  CF-LOSS-RATIO-SELECT.
  3480             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3481             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3482         16  CF-ENTRY-DATE-SELECT.
  3483             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3484             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3485         16  CF-EFFECTIVE-DATE-SELECT.
  3486             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3487             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3488
  3489         16  CF-EXCEPTION-LIST-IND          PIC X.
  3490             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3491
  3492         16  FILLER                         PIC X(318).
  3493
  3494****************************************************************
  3495*                  EXCEPTION REPORTING RECORD                  *
  3496****************************************************************
  3497
  3498     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3499         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3500             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3501
  3502         16  CF-COMBINED-LIFE-AH-OPT.
  3503             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3504             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3505             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3506             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3507
  3508         16  CF-LIFE-OPT.
  3509             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3510             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3511             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3512             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6318.cbl
  3513             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3514             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3515             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3516             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3517             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3518             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3519
  3520         16  CF-AH-OPT.
  3521             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3522             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3523             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3524             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3525             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3526             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3527             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3528             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3529             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3530             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3531
  3532         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3533             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3534             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3535             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3536
  3537         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3538
  3539         16  FILLER                         PIC X(673).
  3540
  3541
  3542****************************************************************
  3543*             MORTGAGE SYSTEM PLAN RECORD                      *
  3544****************************************************************
  3545
  3546     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3547         16  CF-PLAN-TYPE                   PIC X.
  3548             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3549             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3550             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3551         16  CF-PLAN-ABBREV                 PIC XXX.
  3552         16  CF-PLAN-DESCRIPT               PIC X(10).
  3553         16  CF-PLAN-NOTES                  PIC X(20).
  3554         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3555         16  CF-PLAN-UNDERWRITING.
  3556             20  CF-PLAN-TERM-DATA.
  3557                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3558                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3559             20  CF-PLAN-AGE-DATA.
  3560                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3561                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3562                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3563             20  CF-PLAN-BENEFIT-DATA.
  3564                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3565                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3566                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3567                                            PIC S9(7)V99  COMP-3.
  3568         16  CF-PLAN-POLICY-FORMS.
  3569             20  CF-POLICY-FORM             PIC X(12).
  3570             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6318.cbl
  3571             20  CF-MASTER-POLICY           PIC X(12).
  3572         16  CF-PLAN-RATING.
  3573             20  CF-RATE-CODE               PIC X(5).
  3574             20  CF-SEX-RATING              PIC X.
  3575                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3576                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3577             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3578             20  CF-SUB-STD-TYPE            PIC X.
  3579                 88  CF-PCT-OF-PREM            VALUE '1'.
  3580                 88  CF-PCT-OF-BENE            VALUE '2'.
  3581         16  CF-PLAN-PREM-TOLERANCES.
  3582             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3583             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3584         16  CF-PLAN-PYMT-TOLERANCES.
  3585             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3586             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3587         16  CF-PLAN-MISC-DATA.
  3588             20  FILLER                     PIC X.
  3589             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3590             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3591         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3592         16  CF-PLAN-IND-GRP                PIC X.
  3593             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3594                                                     '1'.
  3595             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3596                                                     '2'.
  3597         16  CF-MIB-SEARCH-SW               PIC X.
  3598             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3599             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3600             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3601             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3602         16  CF-ALPHA-SEARCH-SW             PIC X.
  3603             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3604             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3605             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3606             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3607             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3608             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3609             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3610             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3611             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3612             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3613                                                     'A' 'B' 'C'
  3614                                                     'X' 'Y' 'Z'.
  3615         16  CF-EFF-DT-RULE-SW              PIC X.
  3616             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3617             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3618             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3619             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3620             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3621         16  FILLER                         PIC X(4).
  3622         16  CF-HEALTH-QUESTIONS            PIC X.
  3623             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3624         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3625         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3626         16  CF-PLAN-SNGL-JNT               PIC X.
  3627             88  CF-COMBINED-PLAN              VALUE 'C'.
  3628             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6318.cbl
  3629             88  CF-SNGL-PLAN                  VALUE 'S'.
  3630         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3631         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3632         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3633         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3634         16  CF-RERATE-CNTL                 PIC  X.
  3635             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3636             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3637             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3638             88  CF-AUTO-RECALC                 VALUE '4'.
  3639         16  CF-BENEFIT-TYPE                PIC  X.
  3640             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3641             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3642         16  CF-POLICY-FEE                  PIC S999V99
  3643                                                    COMP-3.
  3644         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3645         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3646         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3647         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3648         16  FILLER                         PIC  X(32).
  3649         16  CF-TERMINATION-FORM            PIC  X(04).
  3650         16  FILLER                         PIC  X(08).
  3651         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3652                                                       COMP-3.
  3653         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3654         16  CF-ISSUE-LETTER                PIC  X(4).
  3655         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3656         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3657             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3658             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3659         16  CF-MP-REFUND-CALC              PIC X.
  3660             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3661             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3662             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3663             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3664             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3665             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3666             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3667             88  CF-MP-REFD-MEAN                VALUE '8'.
  3668         16  CF-ALT-RATE-CODE               PIC  X(5).
  3669
  3670
  3671         16  FILLER                         PIC X(498).
  3672****************************************************************
  3673*             MORTGAGE COMPANY MASTER RECORD                   *
  3674****************************************************************
  3675
  3676     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3677         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3678         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3679             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3680             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3681             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3682             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3683             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3684
  3685         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3686         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6318.cbl
  3687         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3688         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3689         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3690
  3691         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3692             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3693         16  CF-MP-RECON-USE-IND            PIC X(1).
  3694             88  CF-MP-USE-RECON             VALUE 'Y'.
  3695         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3696             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3697         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3698             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3699             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3700         16  FILLER                         PIC X(1).
  3701         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3702             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3703         16  CF-MORTG-MIB-VERSION           PIC X.
  3704             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3705             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3706             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3707         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3708             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3709                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3710             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3711                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3712             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3713                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3714             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3715                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3716             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3717                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3718             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3719                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3720         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3721         16  FILLER                         PIC X(7).
  3722         16  CF-MORTG-DESTINATION-SYMBOL.
  3723             20  CF-MORTG-MIB-COMM          PIC X(5).
  3724             20  CF-MORTG-MIB-TERM          PIC X(5).
  3725         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3726             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3727         16  FILLER                         PIC X(03).
  3728         16  CF-MP-CHECK-NO-CONTROL.
  3729             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3730                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3731                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3732                                                ' ' LOW-VALUES.
  3733                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3734                                               VALUE '3'.
  3735         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3736         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3737         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3738             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3739                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3740             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3741                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3742             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3743                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3744             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6318.cbl
  3745                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3746             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3747                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3748             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3749                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3750         16  CF-MORTG-BILLING-AREA.
  3751             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3752                                            PIC X.
  3753         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3754         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3755         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3756         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3757             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3758             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3759         16  FILLER                         PIC X.
  3760         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3761             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3762             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3763         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3764         16  FILLER                         PIC X(8).
  3765         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3766         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3767         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3768         16  CF-ACH-COMPANY-ID.
  3769             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3770                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3771                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3772                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3773             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3774         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3775             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3776         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3777             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3778             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3779         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3780         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3781         16  FILLER                         PIC X(536).
  3782
  3783****************************************************************
  3784*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3785****************************************************************
  3786
  3787     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3788         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3789             20  CF-FEMALE-HEIGHT.
  3790                 24  CF-FEMALE-FT           PIC 99.
  3791                 24  CF-FEMALE-IN           PIC 99.
  3792             20  CF-FEMALE-MIN-WT           PIC 999.
  3793             20  CF-FEMALE-MAX-WT           PIC 999.
  3794         16  FILLER                         PIC X(428).
  3795
  3796     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3797         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3798             20  CF-MALE-HEIGHT.
  3799                 24  CF-MALE-FT             PIC 99.
  3800                 24  CF-MALE-IN             PIC 99.
  3801             20  CF-MALE-MIN-WT             PIC 999.
  3802             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6318.cbl
  3803         16  FILLER                         PIC X(428).
  3804******************************************************************
  3805*             AUTOMATIC ACTIVITY RECORD                          *
  3806******************************************************************
  3807     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3808         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3809             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3810             20  CF-SYS-LETTER-ID           PIC X(04).
  3811             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3812             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3813             20  CF-SYS-RESET-SW            PIC X(01).
  3814             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3815             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3816
  3817         16  FILLER                         PIC X(50).
  3818
  3819         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3820             20  CF-USER-ACTIVE-SW          PIC X(01).
  3821             20  CF-USER-LETTER-ID          PIC X(04).
  3822             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3823             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3824             20  CF-USER-RESET-SW           PIC X(01).
  3825             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3826             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3827             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3828
  3829         16  FILLER                         PIC X(246).
  3830*                                COPY ERCPNDB.
  3831******************************************************************
  3832*                                                                *
  3833*                                                                *
  3834*                            ERCPNDB.                            *
  3835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3836*                            VMOD=2.025                          *
  3837*                                                                *
  3838*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3839*                                                                *
  3840******************************************************************
  3841*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3842*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3843******************************************************************
  3844*                                                                *
  3845*                                                                *
  3846*   FILE TYPE = VSAM,KSDS                                        *
  3847*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3848*                                                                *
  3849*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3850*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3851*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3852*                                                 RKP=13,LEN=36  *
  3853*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3854*                                      AND CHG-SEQ.)             *
  3855*                                                RKP=49,LEN=11   *
  3856*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3857*                                      AND CHG-SEQ.)             *
  3858*                                                RKP=60,LEN=15   *
  3859*                                                                *
  3860*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6318.cbl
  3861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3862******************************************************************
  3863******************************************************************
  3864*                   C H A N G E   L O G
  3865*
  3866* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3867*-----------------------------------------------------------------
  3868*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3869* EFFECTIVE    NUMBER
  3870*-----------------------------------------------------------------
  3871* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3872* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3873* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3874* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3875* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3876* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3877* 032306                   PEMA  ADD BOW LOAN NUMBER
  3878* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3879* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3880* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3881* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3882* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3883* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3884* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3885* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3886******************************************************************
  3887
  3888 01  PENDING-BUSINESS.
  3889     12  PB-RECORD-ID                     PIC XX.
  3890         88  VALID-PB-ID                        VALUE 'PB'.
  3891
  3892     12  PB-CONTROL-PRIMARY.
  3893         16  PB-COMPANY-CD                PIC X.
  3894         16  PB-ENTRY-BATCH               PIC X(6).
  3895         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3896         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3897
  3898     12  PB-CONTROL-BY-ACCOUNT.
  3899         16  PB-COMPANY-CD-A1             PIC X.
  3900         16  PB-CARRIER                   PIC X.
  3901         16  PB-GROUPING.
  3902             20  PB-GROUPING-PREFIX       PIC XXX.
  3903             20  PB-GROUPING-PRIME        PIC XXX.
  3904         16  PB-STATE                     PIC XX.
  3905         16  PB-ACCOUNT.
  3906             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3907             20  PB-ACCOUNT-PRIME         PIC X(6).
  3908         16  PB-CERT-EFF-DT               PIC XX.
  3909         16  PB-CERT-NO.
  3910             20  PB-CERT-PRIME            PIC X(10).
  3911             20  PB-CERT-SFX              PIC X.
  3912         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3913
  3914         16  PB-RECORD-TYPE               PIC X.
  3915             88  PB-MAILING-DATA                VALUE '0'.
  3916             88  PB-ISSUE                       VALUE '1'.
  3917             88  PB-CANCELLATION                VALUE '2'.
  3918             88  PB-BATCH-TRAILER               VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6318.cbl
  3919
  3920     12  PB-CONTROL-BY-ORIG-BATCH.
  3921         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3922         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3923         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3924         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3925
  3926     12  PB-CONTROL-BY-CSR.
  3927         16  PB-CSR-COMPANY-CD            PIC X.
  3928         16  PB-CSR-ID                    PIC X(4).
  3929         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3930         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3931         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3932******************************************************************
  3933*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3934******************************************************************
  3935
  3936     12  PB-LAST-MAINT-DT                 PIC XX.
  3937     12  PB-LAST-MAINT-BY                 PIC X(4).
  3938     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3939
  3940     12  PB-RECORD-BODY                   PIC X(375).
  3941
  3942     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3943         16  PB-CERT-ORIGIN               PIC X.
  3944             88  CLASIC-CREATED-CERT         VALUE '1'.
  3945         16  PB-I-NAME.
  3946             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3947             20  PB-I-INSURED-FIRST-NAME.
  3948                 24  PB-I-INSURED-1ST-INIT PIC X.
  3949                 24  FILLER                PIC X(9).
  3950             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3951         16  PB-I-AGE                     PIC S99   COMP-3.
  3952         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3953         16  PB-I-BIRTHDAY                PIC XX.
  3954         16  PB-I-INSURED-SEX             PIC X.
  3955             88  PB-SEX-MALE     VALUE 'M'.
  3956             88  PB-SEX-FEMALE   VALUE 'F'.
  3957
  3958         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3959         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3960         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3961         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3962         16  PB-I-SKIP-CODE               PIC X.
  3963             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3964             88  PB-SKIP-JULY              VALUE '1'.
  3965             88  PB-SKIP-AUGUST            VALUE '2'.
  3966             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3967             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3968             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3969             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3970             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3971             88  PB-SKIP-JUNE              VALUE '8'.
  3972             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3973             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3974             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3975         16  PB-I-TERM-TYPE               PIC X.
  3976             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6318.cbl
  3977             88  PB-PAID-WEEKLY            VALUE 'W'.
  3978             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3979             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3980             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3981         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3982         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3983         16  PB-I-DATA-ENTRY-SW           PIC X.
  3984             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3985             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3986             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3987             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3988         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3989         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3990*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3991         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3992         16  FILLER                       PIC X.
  3993
  3994         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3995             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3996             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3997                                                   '90' THRU '99'.
  3998         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3999                                          PIC XX.
  4000         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4001         16  PB-I-AMOUNT-FINANCED REDEFINES
  4002                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4003         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4004         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4005                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4006         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4007         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4008         16  PB-I-CLP-AMOUNT REDEFINES
  4009                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4010         16  PB-I-LF-CALC-FLAG            PIC X.
  4011             88 PB-COMP-LF-PREM               VALUE '?'.
  4012         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4013         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4014         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4015         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4016         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4017         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4018         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4019         16  PB-I-LF-ABBR                 PIC XXX.
  4020         16  PB-I-LF-INPUT-CD             PIC XX.
  4021
  4022         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4023             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4024             88  PB-INVALID-AH               VALUE '  ' '00'
  4025                                                   '90' THRU '99'.
  4026         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4027         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4028         16  PB-I-AH-CALC-FLAG            PIC X.
  4029             88 PB-COMP-AH-PREM                  VALUE '?'.
  4030         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4031         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4032         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4033         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4034         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6318.cbl
  4035         16  PB-I-AH-ABBR                 PIC XXX.
  4036         16  PB-I-AH-INPUT-CD             PIC XXX.
  4037
  4038         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4039         16  PB-I-REIN-TABLE              PIC XXX.
  4040         16  PB-I-BUSINESS-TYPE           PIC 99.
  4041         16  PB-I-INDV-GRP-CD             PIC X.
  4042         16  PB-I-MORT-CODE.
  4043             20  PB-I-TABLE               PIC X.
  4044             20  PB-I-INTEREST            PIC XX.
  4045             20  PB-I-MORT-TYP            PIC X.
  4046         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4047         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4048         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4049         16  PB-I-INDV-GRP-OVRD           PIC X.
  4050         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4051         16  PB-I-SIG-SW                  PIC X.
  4052             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4053         16  PB-I-RATE-CLASS              PIC XX.
  4054         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4055         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4056         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4057         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4058         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4059         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4060         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4061         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4062         16  PB-I-OB-FLAG                 PIC X.
  4063             88  PB-I-OB                      VALUE 'B'.
  4064             88  PB-I-SUMMARY                 VALUE 'Z'.
  4065         16  PB-I-ENTRY-STATUS            PIC X.
  4066             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4067                                              'M' '5' '9' '2'.
  4068             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4069             88  PB-I-POLICY-PENDING          VALUE '2'.
  4070             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4071             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4072             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4073             88  PB-I-REIN-ONLY               VALUE '9'.
  4074             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4075             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4076             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4077             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4078         16  PB-I-INT-CODE                PIC X.
  4079             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4080             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4081         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4082         16  PB-I-SOC-SEC-NO              PIC X(11).
  4083         16  PB-I-MEMBER-NO               PIC X(12).
  4084         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4085*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4086         16  PB-I-OLD-LOF                 PIC XXX.
  4087         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4088         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4089         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4090         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4091         16  PB-I-LIFE-INDICATOR          PIC X.
  4092             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6318.cbl
  4093         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4094         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4095                                          PIC S9(5)V99    COMP-3.
  4096         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4097             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4098             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4099         16  PB-I-1ST-PMT-DT              PIC XX.
  4100         16  PB-I-JOINT-INSURED.
  4101             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4102             20 PB-I-JOINT-FIRST-NAME.
  4103                24  PB-I-JOINT-FIRST-INIT PIC X.
  4104                24  FILLER                PIC X(9).
  4105             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4106*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4107         16  PB-I-BENEFICIARY-NAME.
  4108             20  PB-I-BANK-NUMBER         PIC X(10).
  4109             20  FILLER                   PIC X(15).
  4110         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4111         16  PB-I-REFERENCE               PIC X(12).
  4112         16  FILLER REDEFINES PB-I-REFERENCE.
  4113             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4114             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4115             20  PB-I-CLP-STATE           PIC XX.
  4116         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4117             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4118             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4119             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4120         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4121         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4122         16  PB-I-RESIDENT-STATE          PIC XX.
  4123         16  PB-I-RATE-CODE               PIC X(4).
  4124         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4125         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4126         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4127         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4128         16  PB-I-BANK-NOCHRGB            PIC 99.
  4129         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4130         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4131
  4132     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4133         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4134             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4135         16  PB-C-CANCEL-ORIGIN           PIC X.
  4136             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4137         16  PB-C-LF-CANCEL-DT            PIC XX.
  4138         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4139         16  PB-C-LF-CALC-REQ             PIC X.
  4140             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4141         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4142         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4143         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4144             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4145         16  PB-C-AH-CANCEL-DT            PIC XX.
  4146         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4147         16  PB-C-AH-CALC-REQ             PIC X.
  4148             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4149         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4150         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6318.cbl
  4151         16  PB-C-LAST-NAME               PIC X(15).
  4152         16  PB-C-REFUND-SW               PIC X.
  4153             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4154             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4155         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4156         16  PB-C-PAYEE-CODE              PIC X(6).
  4157         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4158         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4159         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4160         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4161         16  PB-C-REFERENCE               PIC X(12).
  4162         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4163         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4164         16  PB-C-POST-CARD-IND           PIC X.
  4165         16  PB-C-CANCEL-REASON           PIC X.
  4166         16  PB-C-REF-INTERFACE-SW        PIC X.
  4167         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4168         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4169         16  FILLER                       PIC X(01).
  4170*        16  FILLER                       PIC X(18).
  4171         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4172*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4173         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4174         16  PB-CANCELED-CERT-DATA.
  4175             20  PB-CI-INSURED-NAME.
  4176                 24  PB-CI-LAST-NAME      PIC X(15).
  4177                 24  PB-CI-INITIALS       PIC XX.
  4178             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4179             20  PB-CI-INSURED-SEX        PIC X.
  4180             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4181             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4182             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4183             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4184             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4185             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4186             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4187             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4188             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4189             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4190             20  PB-CI-RATE-CLASS         PIC XX.
  4191             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4192             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4193             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4194             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4195             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4196             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4197             20  PB-CI-LF-ABBR            PIC X(3).
  4198             20  PB-CI-AH-ABBR            PIC X(3).
  4199             20  PB-CI-OB-FLAG            PIC X.
  4200                 88  PB-CI-OB                VALUE 'B'.
  4201             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4202                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4203                                           'M' '4' '5' '9' '2'.
  4204                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4205                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4206                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4207                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4208                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6318.cbl
  4209                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4210                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4211                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4212                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4213                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4214                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4215                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4216             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4217                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4218                                           'M' '4' '5' '9' '2'.
  4219                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4220                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4221                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4222                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4223                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4224                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4225                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4226                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4227                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4228                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4229                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4230                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4231             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4232             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4233             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4234             20  PB-CI-MEMBER-NO          PIC X(12).
  4235             20  PB-CI-INT-CODE           PIC X.
  4236                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4237                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4238             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4239             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4240             20  PB-CI-COMP-EXCP-SW       PIC X.
  4241                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4242                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4243             20  PB-CI-ENTRY-STATUS       PIC X.
  4244             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4245             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4246             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4247             20  PB-CI-DEATH-DT           PIC XX.
  4248             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4249             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4250             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4251             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4252             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4253             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4254             20  PB-CI-ENTRY-DT              PIC XX.
  4255             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4256             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4257             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4258             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4259             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4260             20  PB-CI-OLD-LOF               PIC XXX.
  4261*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4262             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4263             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4264             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4265             20  PB-CI-INDV-GRP-CD           PIC X.
  4266             20  PB-CI-BENEFICIARY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6318.cbl
  4267                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4268                 24  FILLER                  PIC X(15).
  4269             20  PB-CI-NOTE-SW               PIC X.
  4270             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4271             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4272             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4273             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4274             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4275             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4276             20  PB-CI-FIRST-NAME            PIC X(10).
  4277             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4278
  4279         16  FILLER                       PIC X(13).
  4280*032306  16  FILLER                       PIC X(27).
  4281*        16  FILLER                       PIC X(46).
  4282
  4283     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4284         16  FILLER                       PIC X(10).
  4285         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4286         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4287         16  PB-M-INSURED-MID-INIT        PIC X.
  4288         16  PB-M-INSURED-AGE             PIC 99.
  4289         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4290         16  PB-M-INSURED-SEX             PIC X.
  4291         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4292         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4293         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4294         16  PB-M-INSURED-CITY-STATE.
  4295             20  PB-M-INSURED-CITY        PIC X(28).
  4296             20  PB-M-INSURED-STATE       PIC XX.
  4297         16  PB-M-INSURED-ZIP-CODE.
  4298             20  PB-M-INSURED-ZIP-PRIME.
  4299                 24  PB-M-INSURED-ZIP-1   PIC X.
  4300                     88  PB-M-CANADIAN-POST-CODE
  4301                                             VALUE 'A' THRU 'Z'.
  4302                 24  FILLER               PIC X(4).
  4303             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4304         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4305                                        PB-M-INSURED-ZIP-CODE.
  4306             20  PM-M-INS-CAN-POST1       PIC XXX.
  4307             20  PM-M-INS-CAN-POST2       PIC XXX.
  4308             20  FILLER                   PIC XXX.
  4309         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4310         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4311         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4312         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4313         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4314         16  PB-M-CRED-BENE-CITYST.
  4315             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4316             20  PB-M-CRED-BENE-STATE     PIC XX.
  4317         16  FILLER                       PIC X(92).
  4318
  4319     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4320         16  FILLER                       PIC X(10).
  4321         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4322         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4323         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4324         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6318.cbl
  4325         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4326         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4327         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4328         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4329         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4330         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4331         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4332         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4333         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4334         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4335         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4336         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4337         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4338         16  PB-ACCOUNT-NAME              PIC X(30).
  4339         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4340         16  PB-REFERENCE                 PIC X(12).
  4341         16  PB-B-RECEIVED-DT             PIC XX.
  4342         16  FILLER                       PIC X(234).
  4343
  4344     12  PB-RECORD-STATUS.
  4345         16  PB-CREDIT-SELECT-DT          PIC XX.
  4346         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4347         16  PB-BILLED-DT                 PIC XX.
  4348         16  PB-BILLING-STATUS            PIC X.
  4349             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4350             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4351             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4352         16  PB-RECORD-BILL               PIC X.
  4353             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4354             88  PB-RECORD-RETURNED           VALUE 'R'.
  4355             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4356             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4357             88  PB-OVERRIDE-AH               VALUE 'A'.
  4358             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4359         16  PB-BATCH-ENTRY               PIC X.
  4360             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4361             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4362             88  PB-REISSUED-CERT             VALUE 'E'.
  4363             88  PB-MONTHLY-CERT              VALUE 'M'.
  4364             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4365             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4366             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4367         16  PB-FORCE-CODE                PIC X.
  4368             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4369             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4370             88  PB-CANCEL-FORCE              VALUE '8'.
  4371             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4372             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4373             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4374             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4375             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4376             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4377             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4378         16  PB-FATAL-FLAG                PIC X.
  4379             88  PB-FATAL-ERRORS              VALUE 'X'.
  4380         16  PB-FORCE-ER-CD               PIC X.
  4381             88  PB-FORCE-ERRORS              VALUE 'F'.
  4382             88  PB-UNFORCED-ERRORS           VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6318.cbl
  4383         16  PB-WARN-ER-CD                PIC X.
  4384             88  PB-WARNING-ERRORS            VALUE 'W'.
  4385         16  FILLER                       PIC X.
  4386         16  PB-OUT-BAL-CD                PIC X.
  4387             88  PB-OUT-OF-BAL                VALUE 'O'.
  4388         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4389         16  PB-AH-OVERRIDE-L1            PIC X.
  4390         16  PB-INPUT-DT                  PIC XX.
  4391         16  PB-INPUT-BY                  PIC X(4).
  4392         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4393         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4394         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4395         16  PB-LF-EARNING-METHOD         PIC X.
  4396         16  PB-AH-EARNING-METHOD         PIC X.
  4397         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4398         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4399         16  PB-REIN-CD                   PIC XXX.
  4400         16  PB-LF-REFUND-TYPE            PIC X.
  4401         16  PB-AH-REFUND-TYPE            PIC X.
  4402         16  PB-ACCT-EFF-DT               PIC XX.
  4403         16  PB-ACCT-EXP-DT               PIC XX.
  4404         16  PB-COMPANY-ID                PIC X(3).
  4405         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4406         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4407         16  PB-SV-CARRIER                PIC X.
  4408         16  PB-SV-GROUPING               PIC X(6).
  4409         16  PB-SV-STATE                  PIC XX.
  4410         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4411         16  PB-GA-BILLING-INFO.
  4412             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4413                                          PIC XX.
  4414         16  PB-SV-REMIT-TO  REDEFINES
  4415             PB-GA-BILLING-INFO           PIC X(10).
  4416         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4417         16  PB-I-LOAN-OFFICER            PIC X(5).
  4418         16  PB-I-VIN                     PIC X(17).
  4419
  4420         16  FILLER                       PIC X(04).
  4421         16  IMNET-BYPASS-SW              PIC X.
  4422
  4423******************************************************************
  4424*                COMMON EDIT ERRORS                              *
  4425******************************************************************
  4426
  4427     12  PB-COMMON-ERRORS.
  4428         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4429                                           PIC S9(4)     COMP.
  4430
  4431******************************************************************
  4432*                                COPY ELCCERT.
  4433******************************************************************
  4434*                                                                *
  4435*                            ELCCERT.                            *
  4436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4437*                            VMOD=2.013                          *
  4438*                                                                *
  4439*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4440*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6318.cbl
  4441*   FILE TYPE = VSAM,KSDS                                        *
  4442*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4443*                                                                *
  4444*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4445*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4446*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4447*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4448*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4449*                                                                *
  4450*   LOG = YES                                                    *
  4451*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4452******************************************************************
  4453*                   C H A N G E   L O G
  4454*
  4455* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4456*-----------------------------------------------------------------
  4457*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4458* EFFECTIVE    NUMBER
  4459*-----------------------------------------------------------------
  4460* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4461* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4462* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4463* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4464* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4465* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4466* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4467* 032612  CR2011110200001  PEMA  AHL CHANGES
  4468******************************************************************
  4469
  4470 01  CERTIFICATE-MASTER.
  4471     12  CM-RECORD-ID                      PIC XX.
  4472         88  VALID-CM-ID                      VALUE 'CM'.
  4473
  4474     12  CM-CONTROL-PRIMARY.
  4475         16  CM-COMPANY-CD                 PIC X.
  4476         16  CM-CARRIER                    PIC X.
  4477         16  CM-GROUPING.
  4478             20  CM-GROUPING-PREFIX        PIC X(3).
  4479             20  CM-GROUPING-PRIME         PIC X(3).
  4480         16  CM-STATE                      PIC XX.
  4481         16  CM-ACCOUNT.
  4482             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4483             20  CM-ACCOUNT-PRIME          PIC X(6).
  4484         16  CM-CERT-EFF-DT                PIC XX.
  4485         16  CM-CERT-NO.
  4486             20  CM-CERT-PRIME             PIC X(10).
  4487             20  CM-CERT-SFX               PIC X.
  4488
  4489     12  CM-CONTROL-BY-NAME.
  4490         16  CM-COMPANY-CD-A1              PIC X.
  4491         16  CM-INSURED-LAST-NAME          PIC X(15).
  4492         16  CM-INSURED-INITIALS.
  4493             20  CM-INSURED-INITIAL1       PIC X.
  4494             20  CM-INSURED-INITIAL2       PIC X.
  4495
  4496     12  CM-CONTROL-BY-SSN.
  4497         16  CM-COMPANY-CD-A2              PIC X.
  4498         16  CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6318.cbl
  4499             20  CM-SSN-STATE              PIC XX.
  4500             20  CM-SSN-ACCOUNT            PIC X(6).
  4501             20  CM-SSN-LN3.
  4502                 25  CM-INSURED-INITIALS-A2.
  4503                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4504                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4505                 25 CM-PART-LAST-NAME-A2         PIC X.
  4506
  4507     12  CM-CONTROL-BY-CERT-NO.
  4508         16  CM-COMPANY-CD-A4              PIC X.
  4509         16  CM-CERT-NO-A4                 PIC X(11).
  4510
  4511     12  CM-CONTROL-BY-MEMB.
  4512         16  CM-COMPANY-CD-A5              PIC X.
  4513         16  CM-MEMBER-NO.
  4514             20  CM-MEMB-STATE             PIC XX.
  4515             20  CM-MEMB-ACCOUNT           PIC X(6).
  4516             20  CM-MEMB-LN4.
  4517                 25  CM-INSURED-INITIALS-A5.
  4518                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4519                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4520                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4521
  4522     12  CM-INSURED-PROFILE-DATA.
  4523         16  CM-INSURED-FIRST-NAME.
  4524             20  CM-INSURED-1ST-INIT       PIC X.
  4525             20  FILLER                    PIC X(9).
  4526         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4527         16  CM-INSURED-SEX                PIC X.
  4528             88  CM-SEX-MALE                  VALUE 'M'.
  4529             88  CM-SEX-FEMAL                 VALUE 'F'.
  4530         16  CM-INSURED-JOINT-AGE          PIC 99.
  4531         16  CM-JOINT-INSURED-NAME.
  4532             20  CM-JT-LAST-NAME           PIC X(15).
  4533             20  CM-JT-FIRST-NAME.
  4534                 24  CM-JT-1ST-INIT        PIC X.
  4535                 24  FILLER                PIC X(9).
  4536             20  CM-JT-INITIAL             PIC X.
  4537
  4538     12  CM-LIFE-DATA.
  4539         16  CM-LF-BENEFIT-CD              PIC XX.
  4540         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4541         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4542         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4543         16  CM-LF-DEV-CODE                PIC XXX.
  4544         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4545         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4546         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4547         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4548         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4549         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4550         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4551         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4552         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4553         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4554         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4555         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4556         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6318.cbl
  4557
  4558     12  CM-AH-DATA.
  4559         16  CM-AH-BENEFIT-CD              PIC XX.
  4560         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4561         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4562         16  CM-AH-DEV-CODE                PIC XXX.
  4563         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4564         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4565         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4566         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4567         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4568         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4569         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4570         16  CM-AH-PAID-THRU-DT            PIC XX.
  4571             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4572         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4573         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4574         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4575         16  FILLER                        PIC X.
  4576
  4577     12  CM-LOAN-INFORMATION.
  4578         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4579         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4580                                           PIC S9(5)V99  COMP-3.
  4581         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4582         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4583         16  CM-PAY-FREQUENCY              PIC S99.
  4584         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4585         16  CM-RATE-CLASS                 PIC XX.
  4586         16  CM-BENEFICIARY                PIC X(25).
  4587         16  CM-POLICY-FORM-NO             PIC X(12).
  4588         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4589         16  CM-LAST-ADD-ON-DT             PIC XX.
  4590         16  CM-DEDUCTIBLE-AMOUNTS.
  4591             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4592             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4593         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4594             20  CM-RESIDENT-STATE         PIC XX.
  4595             20  CM-RATE-CODE              PIC X(4).
  4596             20  FILLER                    PIC XX.
  4597         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4598             20  CM-LOAN-OFFICER           PIC X(5).
  4599             20  FILLER                    PIC XXX.
  4600         16  CM-CSR-CODE                   PIC XXX.
  4601         16  CM-UNDERWRITING-CODE          PIC X.
  4602             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4603         16  CM-POST-CARD-IND              PIC X.
  4604         16  CM-NH-INTERFACE-SW            PIC X.
  4605         16  CM-PREMIUM-TYPE               PIC X.
  4606             88  CM-SING-PRM                  VALUE '1'.
  4607             88  CM-O-B-COVERAGE              VALUE '2'.
  4608             88  CM-OPEN-END                  VALUE '3'.
  4609         16  CM-IND-GRP-TYPE               PIC X.
  4610             88  CM-INDIVIDUAL                VALUE 'I'.
  4611             88  CM-GROUP                     VALUE 'G'.
  4612         16  CM-SKIP-CODE                  PIC X.
  4613             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4614             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6318.cbl
  4615             88  SKIP-AUGUST                  VALUE '2'.
  4616             88  SKIP-SEPTEMBER               VALUE '3'.
  4617             88  SKIP-JULY-AUG                VALUE '4'.
  4618             88  SKIP-AUG-SEPT                VALUE '5'.
  4619             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4620             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4621             88  SKIP-JUNE                    VALUE '8'.
  4622             88  SKIP-JUNE-JULY               VALUE '9'.
  4623             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4624             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4625         16  CM-PAYMENT-MODE               PIC X.
  4626             88  PAY-MONTHLY                  VALUE SPACE.
  4627             88  PAY-WEEKLY                   VALUE '1'.
  4628             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4629             88  PAY-BI-WEEKLY                VALUE '3'.
  4630             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4631         16  CM-LOAN-NUMBER                PIC X(8).
  4632         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4633         16  CM-OLD-LOF                    PIC XXX.
  4634*        16  CM-LOAN-OFFICER               PIC XXX.
  4635         16  CM-REIN-TABLE                 PIC XXX.
  4636         16  CM-SPECIAL-REIN-CODE          PIC X.
  4637         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4638         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4639         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4640
  4641     12  CM-STATUS-DATA.
  4642         16  CM-ENTRY-STATUS               PIC X.
  4643         16  CM-ENTRY-DT                   PIC XX.
  4644
  4645         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4646         16  CM-LF-CANCEL-DT               PIC XX.
  4647         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4648
  4649         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4650         16  CM-LF-DEATH-DT                PIC XX.
  4651         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4652
  4653         16  CM-LF-CURRENT-STATUS          PIC X.
  4654             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4655                                                'M' '4' '5' '9'.
  4656             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4657             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4658             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4659             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4660             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4661             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4662             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4663             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4664             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4665             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4666             88  CM-LF-DECLINED               VALUE 'D'.
  4667             88  CM-LF-VOIDED                 VALUE 'V'.
  4668
  4669         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4670         16  CM-AH-CANCEL-DT               PIC XX.
  4671         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4672
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6318.cbl
  4673         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4674         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4675         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4676
  4677         16  CM-AH-CURRENT-STATUS          PIC X.
  4678             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4679                                                'M' '4' '5' '9'.
  4680             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4681             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4682             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4683             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4684             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4685             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4686             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4687             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4688             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4689             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4690             88  CM-AH-DECLINED               VALUE 'D'.
  4691             88  CM-AH-VOIDED                 VALUE 'V'.
  4692
  4693         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4694             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4695             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4696             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4697         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4698
  4699         16  CM-ENTRY-BATCH                PIC X(6).
  4700         16  CM-LF-EXIT-BATCH              PIC X(6).
  4701         16  CM-AH-EXIT-BATCH              PIC X(6).
  4702         16  CM-LAST-MONTH-END             PIC XX.
  4703
  4704     12  CM-NOTE-SW                        PIC X.
  4705         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4706         88  CERT-NOTES-PRESENT               VALUE '1'.
  4707         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4708         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4709         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4710         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4711         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4712         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4713     12  CM-COMP-EXCP-SW                   PIC X.
  4714         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4715         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4716     12  CM-INSURED-ADDRESS-SW             PIC X.
  4717         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4718         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4719
  4720*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4721     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4722     12  FILLER                            PIC X.
  4723
  4724*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4725     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4726     12  FILLER                            PIC X.
  4727*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4728     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4729
  4730     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6318.cbl
  4731         88  CERT-ADDED-BATCH                 VALUE ' '.
  4732         88  CERT-ADDED-ONLINE                VALUE '1'.
  4733         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4734         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4735         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4736     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4737         88  CERT-AS-LOADED                   VALUE ' '.
  4738         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4739         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4740         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4741         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4742         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4743         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4744         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4745
  4746     12  CM-ACCOUNT-COMM-PCTS.
  4747         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4748         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4749
  4750     12  CM-USER-FIELD                     PIC X.
  4751     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4752     12  CM-CLP-STATE                      PIC XX.
  4753     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4754     12  CM-USER-RESERVED                  PIC XXX.
  4755     12  FILLER REDEFINES CM-USER-RESERVED.
  4756         16  CM-AH-CLASS-CD                PIC XX.
  4757         16  F                             PIC X.
  4758******************************************************************
  4759*                                COPY ELCCRTO.
  4760******************************************************************
  4761*                                                                *
  4762*                            ELCCRTO.                            *
  4763*                                                                *
  4764*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4765*                                                                *
  4766*   FILE TYPE = VSAM,KSDS                                        *
  4767*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4768*                                                                *
  4769*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4770*                                                                *
  4771*   LOG = YES                                                    *
  4772*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4773******************************************************************
  4774*                   C H A N G E   L O G
  4775*
  4776* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4777*-----------------------------------------------------------------
  4778*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4779* EFFECTIVE    NUMBER
  4780*-----------------------------------------------------------------
  4781* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4782* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4783* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4784******************************************************************
  4785 01  ORIGINAL-CERTIFICATE.
  4786     12  OC-RECORD-ID                      PIC XX.
  4787         88  VALID-OC-ID                      VALUE 'OC'.
  4788     12  OC-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6318.cbl
  4789         16  OC-COMPANY-CD                 PIC X.
  4790         16  OC-CARRIER                    PIC X.
  4791         16  OC-GROUPING                   PIC X(6).
  4792         16  OC-STATE                      PIC XX.
  4793         16  OC-ACCOUNT                    PIC X(10).
  4794         16  OC-CERT-EFF-DT                PIC XX.
  4795         16  OC-CERT-NO.
  4796             20  OC-CERT-PRIME             PIC X(10).
  4797             20  OC-CERT-SFX               PIC X.
  4798         16  OC-RECORD-TYPE                PIC X.
  4799         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4800     12  OC-LAST-MAINT-DT                  PIC XX.
  4801     12  OC-LAST-MAINT-BY                  PIC X(4).
  4802     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4803     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4804     12  FILLER                            PIC X(49).
  4805     12  OC-ORIG-REC.
  4806         16  OC-INS-LAST-NAME              PIC X(15).
  4807         16  OC-INS-FIRST-NAME             PIC X(10).
  4808         16  OC-INS-MIDDLE-INIT            PIC X.
  4809         16  OC-INS-AGE                    PIC S999     COMP-3.
  4810         16  OC-JNT-LAST-NAME              PIC X(15).
  4811         16  OC-JNT-FIRST-NAME             PIC X(10).
  4812         16  OC-JNT-MIDDLE-INIT            PIC X.
  4813         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4814         16  OC-LF-BENCD                   PIC XX.
  4815         16  OC-LF-TERM                    PIC S999      COMP-3.
  4816         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4817         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4818         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4819         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4820         16  OC-LF-EXP-DT                  PIC XX.
  4821         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4822         16  OC-LF-CANCEL-DT               PIC XX.
  4823         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4824         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4825         16  OC-AH-BENCD                   PIC XX.
  4826         16  OC-AH-TERM                    PIC S999      COMP-3.
  4827         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4828         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4829         16  OC-AH-EXP-DT                  PIC XX.
  4830         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4831         16  OC-AH-CP                      PIC 99.
  4832         16  OC-AH-CANCEL-DT               PIC XX.
  4833         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4834         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4835         16  OC-CRED-BENE-NAME             PIC X(25).
  4836         16  OC-1ST-PMT-DT                 PIC XX.
  4837         16  FILLER                        PIC X(215).
  4838
  4839     12  FILLER                            PIC X(50).
  4840******************************************************************
  4841*                                COPY ERCENDT.
  4842******************************************************************
  4843*                                                                *
  4844*                                                                *
  4845*                            ERCENDT.                            *
  4846*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6318.cbl
  4847*                                                                *
  4848*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4849*                                                                *
  4850*   FILE TYPE = VSAM,KSDS                                        *
  4851*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4852*                                                                *
  4853*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4854*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4855*                                                                *
  4856*   LOG = NO                                                     *
  4857*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4858******************************************************************
  4859*-----------------------------------------------------------------
  4860*                   C H A N G E   L O G
  4861*
  4862* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4863*-----------------------------------------------------------------
  4864*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4865* EFFECTIVE    NUMBER
  4866*-----------------------------------------------------------------
  4867* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4868*                                WITH OPEN CLAIMS
  4869* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4870*-----------------------------------------------------------------
  4871 01  ENDORSEMENT-RECORD.
  4872     12  EN-RECORD-ID                PIC XX.
  4873         88  VALID-EN-ID                VALUE 'EN'.
  4874     12  EN-CONTROL-PRIMARY.
  4875         16  EN-COMPANY-CD           PIC X.
  4876         16  EN-CARRIER              PIC X.
  4877         16  EN-GROUPING             PIC X(6).
  4878         16  EN-STATE                PIC XX.
  4879         16  EN-ACCOUNT              PIC X(10).
  4880         16  EN-CERT-EFF-DT          PIC XX.
  4881         16  EN-CERT-NO.
  4882             20  EN-CERT-PRIME       PIC X(10).
  4883             20  EN-CERT-SFX         PIC X.
  4884         16  EN-REC-TYPE             PIC X.
  4885             88  EN-ISSUE               VALUE 'I'.
  4886             88  EN-CANCELLATION        VALUE 'C'.
  4887         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4888     12  EN-CONTROL-BY-ARCH-NO.
  4889         16  EN-COMPANY-CD-A1              PIC X.
  4890         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4891     12  EN-LAST-MAINT-DT            PIC XX.
  4892     12  EN-LAST-MAINT-BY            PIC X(4).
  4893     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4894     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4895     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4896         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4897         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4898         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4899         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4900         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4901         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4902         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4903         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4904         16  EN-LF-ORIG-BENCD        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6318.cbl
  4905         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4906         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4907         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4908         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4909         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4910         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4911*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4912         16  EN-ORIG-CRED-BENE       PIC X(25).
  4913         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4914         16  FILLER                  PIC X.
  4915         16  EN-AH-ORIG-BENCD        PIC XX.
  4916         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4917         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4918         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4919         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4920*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4921*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4922         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4923         16  F                       PIC X(09).
  4924         16  EN-AH-ORIG-CP           PIC 99.
  4925         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4926         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4927         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4928         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4929         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4930         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4931         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4932         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4933         16  EN-LF-NEW-BENCD         PIC XX.
  4934         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4935         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4936         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4937         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4938         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4939         16  EN-LF-NEW-EXP-DT        PIC XX.
  4940         16  EN-NEW-CRED-BENE        PIC X(25).
  4941         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4942         16  FILLER                  PIC X.
  4943         16  EN-AH-NEW-BENCD         PIC XX.
  4944         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4945         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4946         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4947         16  EN-AH-NEW-EXP-DT        PIC XX.
  4948*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4949*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4950*        16  F                       PIC X(12).
  4951         16  EN-AH-NEW-CP            PIC 99.
  4952         16  EN-SIG-SW               PIC X.
  4953         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4954         16  FILLER                  PIC X(37).
  4955     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4956         16  EN-LF-ORIG-REF-DT       PIC XX.
  4957         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4958         16  EN-AH-ORIG-REF-DT       PIC XX.
  4959         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4960         16  EN-LF-NEW-REF-DT        PIC XX.
  4961         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4962         16  EN-AH-NEW-REF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6318.cbl
  4963         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4964         16  EN-FLAG-CERT            PIC X.
  4965         16  EN-INS-LAST-NAME        PIC X(15).
  4966         16  EN-INS-FIRST-NAME       PIC X(10).
  4967         16  EN-INS-MIDDLE-INIT      PIC X.
  4968         16  FILLER                  PIC X(274).
  4969     12  EN-MONEY-SW             PIC X.
  4970     12  EN-HEALTH-APP           PIC X.
  4971     12  EN-VOUCHER-SW           PIC X.
  4972     12  EN-PAYEE                PIC X(14).
  4973     12  EN-INPUT-DT             PIC XX.
  4974     12  EN-PROCESS-DT           PIC XX.
  4975     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  4976     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  4977     12  EN-REASON-CODES.
  4978         16  F OCCURS 12.
  4979             20  EN-REASON-CODE  PIC X(4).
  4980     12  EN-TEMPLATE-USED        PIC X(8).
  4981     12  EN-DOCU-TYPE            PIC X.
  4982         88  EN-VERI-DOCU          VALUE 'V'.
  4983         88  EN-GCE-DOCU           VALUE 'G'.
  4984         88  EN-CANC-DOCU          VALUE 'C'.
  4985     12  EN-COMMENTS1            PIC X(13).
  4986     12  EN-COMMENTS2            PIC X(70).
  4987     12  EN-COMM-CHGBK           PIC X.
  4988         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  4989         88  EN-CHG-ACCT           VALUE 'Y'.
  4990     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  4991     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  4992     12  EN-BATCH-NUMBER         PIC X(6).
  4993     12  EN-ACCT-SUMM            PIC X.
  4994     12  EN-CSO-SUMM             PIC X.
  4995     12  FILLER                  PIC X(13).
  4996******************************************************************
  4997*                                COPY ERCNOTE.
  4998******************************************************************
  4999*                                                                *
  5000*                                                                *
  5001*                            ERCNOTE                             *
  5002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5003*                            VMOD=2.003                          *
  5004*                                                                *
  5005*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5006*                                                                *
  5007*        FILE TYPE= VSAM,KSDS                                    *
  5008*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5009*                                                                *
  5010*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5011*                                                                *
  5012*        LOG = YES                                               *
  5013*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5014*                                                                *
  5015******************************************************************
  5016*                   C H A N G E   L O G
  5017*
  5018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5019*-----------------------------------------------------------------
  5020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6318.cbl
  5021* EFFECTIVE    NUMBER
  5022*-----------------------------------------------------------------
  5023* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5024*                                FILE WILL CONTAIN BILLING NOTES O
  5025******************************************************************
  5026
  5027 01  CERTIFICATE-NOTE.
  5028     12  CN-RECORD-ID                PIC  XX.
  5029         88  VALID-CN-ID                  VALUE 'CN'.
  5030
  5031     12  CN-CONTROL-PRIMARY.
  5032         16  CN-COMPANY-CD           PIC X.
  5033         16  CN-CARRIER              PIC X.
  5034         16  CN-GROUPING.
  5035             20 CN-GROUPING-PREFIX   PIC XXX.
  5036             20 CN-GROUPING-PRIME    PIC XXX.
  5037         16  CN-STATE                PIC XX.
  5038         16  CN-ACCOUNT.
  5039             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5040             20 CN-ACCOUNT-PRIME     PIC X(6).
  5041         16  CN-CERT-EFF-DT          PIC XX.
  5042         16  CN-CERT-NO.
  5043             20  CN-CERT-PRIME       PIC X(10).
  5044             20  CN-CERT-SFX         PIC X.
  5045
  5046     12  CN-BILLING-START-LINE-NO    PIC 99.
  5047     12  CN-BILLING-END-LINE-NO      PIC 99.
  5048
  5049     12  CN-LINES.
  5050         16  CN-LINE OCCURS 10       PIC X(77).
  5051
  5052     12  CN-LAST-MAINT-DT            PIC XX.
  5053     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5054     12  CN-LAST-MAINT-USER          PIC X(4).
  5055     12  FILLER                      PIC X(6).
  5056******************************************************************
  5057*                                COPY ERCMAIL.
  5058******************************************************************
  5059*                                                                *
  5060*                                                                *
  5061*                            ERCMAIL                             *
  5062*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5063*                            VMOD=2.003                          *
  5064*                                                                *
  5065*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5066*                                                                *
  5067*   FILE TYPE = VSAM,KSDS                                        *
  5068*   RECORD SIZE = 374   RECFORM = FIX                            *
  5069*                                                                *
  5070*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5071*   ALTERNATE PATH    = NOT USED                                 *
  5072*                                                                *
  5073*   LOG = YES                                                    *
  5074*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5075******************************************************************
  5076*                   C H A N G E   L O G
  5077*
  5078* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6318.cbl
  5079*-----------------------------------------------------------------
  5080*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5081* EFFECTIVE    NUMBER
  5082*-----------------------------------------------------------------
  5083* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5084* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5085* 111108                   PEMA  ADD CRED BENE ADDR2
  5086******************************************************************
  5087
  5088 01  MAILING-DATA.
  5089     12  MA-RECORD-ID                      PIC XX.
  5090         88  VALID-MA-ID                       VALUE 'MA'.
  5091
  5092     12  MA-CONTROL-PRIMARY.
  5093         16  MA-COMPANY-CD                 PIC X.
  5094         16  MA-CARRIER                    PIC X.
  5095         16  MA-GROUPING.
  5096             20  MA-GROUPING-PREFIX        PIC XXX.
  5097             20  MA-GROUPING-PRIME         PIC XXX.
  5098         16  MA-STATE                      PIC XX.
  5099         16  MA-ACCOUNT.
  5100             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5101             20  MA-ACCOUNT-PRIME          PIC X(6).
  5102         16  MA-CERT-EFF-DT                PIC XX.
  5103         16  MA-CERT-NO.
  5104             20  MA-CERT-PRIME             PIC X(10).
  5105             20  MA-CERT-SFX               PIC X.
  5106
  5107     12  FILLER                            PIC XX.
  5108
  5109     12  MA-ACCESS-CONTROL.
  5110         16  MA-SOURCE-SYSTEM              PIC XX.
  5111             88  MA-FROM-CREDIT                VALUE 'CR'.
  5112             88  MA-FROM-VSI                   VALUE 'VS'.
  5113             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5114             88  MA-FROM-OTHER                 VALUE 'OT'.
  5115         16  MA-RECORD-ADD-DT              PIC XX.
  5116         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5117         16  MA-LAST-MAINT-DT              PIC XX.
  5118         16  MA-LAST-MAINT-BY              PIC XXXX.
  5119         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5120
  5121     12  MA-PROFILE-INFO.
  5122         16  MA-QUALIFY-CODE-1             PIC XX.
  5123         16  MA-QUALIFY-CODE-2             PIC XX.
  5124         16  MA-QUALIFY-CODE-3             PIC XX.
  5125         16  MA-QUALIFY-CODE-4             PIC XX.
  5126         16  MA-QUALIFY-CODE-5             PIC XX.
  5127
  5128         16  MA-INSURED-LAST-NAME          PIC X(15).
  5129         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5130         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5131         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5132         16  MA-INSURED-BIRTH-DT           PIC XX.
  5133         16  MA-INSURED-SEX                PIC X.
  5134             88  MA-SEX-MALE                   VALUE 'M'.
  5135             88  MA-SEX-FEMALE                 VALUE 'F'.
  5136         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6318.cbl
  5137
  5138         16  MA-ADDRESS-CORRECTED          PIC X.
  5139         16  MA-JOINT-BIRTH-DT             PIC XX.
  5140*        16  FILLER                        PIC X(12).
  5141
  5142         16  MA-ADDRESS-LINE-1             PIC X(30).
  5143         16  MA-ADDRESS-LINE-2             PIC X(30).
  5144         16  MA-CITY-STATE.
  5145             20  MA-CITY                   PIC X(28).
  5146             20  MA-ADDR-STATE             PIC XX.
  5147         16  MA-ZIP.
  5148             20  MA-ZIP-CODE.
  5149                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5150                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5151                 24  FILLER                PIC X(4).
  5152             20  MA-ZIP-PLUS4              PIC X(4).
  5153         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5154             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5155             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5156             20  FILLER                    PIC X(3).
  5157
  5158         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5159
  5160         16  FILLER                        PIC XXX.
  5161*        16  FILLER                        PIC X(10).
  5162
  5163     12  MA-CRED-BENE-INFO.
  5164         16  MA-CRED-BENE-NAME                 PIC X(25).
  5165         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5166         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5167         16  MA-CRED-BENE-CTYST.
  5168             20  MA-CRED-BENE-CITY             PIC X(28).
  5169             20  MA-CRED-BENE-STATE            PIC XX.
  5170         16  MA-CRED-BENE-ZIP.
  5171             20  MA-CB-ZIP-CODE.
  5172                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5173                     88  MA-CB-CANADIAN-POST-CODE
  5174                                           VALUE 'A' THRU 'Z'.
  5175                 24  FILLER                    PIC X(4).
  5176             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5177         16  MA-CB-CANADIAN-POSTAL-CODE
  5178                            REDEFINES MA-CRED-BENE-ZIP.
  5179             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5180             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5181             20  FILLER                        PIC X(3).
  5182     12  MA-POST-CARD-MAIL-DATA.
  5183         16  MA-MAIL-DATA OCCURS 7.
  5184             20  MA-MAIL-TYPE              PIC X.
  5185                 88  MA-12MO-MAILING           VALUE '1'.
  5186                 88  MA-EXP-MAILING            VALUE '2'.
  5187             20  MA-MAIL-STATUS            PIC X.
  5188                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5189                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5190                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5191             20  MA-MAIL-DATE              PIC XX.
  5192     12  FILLER                            PIC XX.
  5193     12  FILLER                            PIC XX.
  5194*    12  FILLER                            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6318.cbl
  5195******************************************************************
  5196*                                COPY ERCARCH.
  5197******************************************************************
  5198*                                                                *
  5199*                            ERCARCH.                            *
  5200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5201*                            VMOD=2.002                          *
  5202*                                                                *
  5203*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5204*                                                                *
  5205*   FILE TYPE = VSAM,KSDS                                        *
  5206*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5207*                                                                *
  5208*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5209*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5210*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5211*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5212*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5213*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5214*                                                                *
  5215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5216******************************************************************
  5217*                   C H A N G E   L O G
  5218*
  5219* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5220*-----------------------------------------------------------------
  5221*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5222* EFFECTIVE    NUMBER
  5223*-----------------------------------------------------------------
  5224* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5225* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5226******************************************************************
  5227 01  LETTER-ARCHIVE.
  5228     12  LA-RECORD-ID                PIC  X(02).
  5229         88  LA-VALID-ID                VALUE 'LA'.
  5230
  5231     12  LA-CONTROL-PRIMARY.
  5232         16  LA-COMPANY-CD           PIC  X(01).
  5233         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5234
  5235     12  LA-CONTROL-BY-CERT-RESP.
  5236         16  LA-COMPANY-CD-A2        PIC  X(01).
  5237         16  LA-CERT-NO-A2.
  5238             20  LA-CERT-PRIME-A2    PIC  X(10).
  5239             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5240         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5241             20  LA-RESP-PERSON-A2   PIC  X(10).
  5242             20  LA-TYPE-A2          PIC  X(01).
  5243         16  LA-CARRIER-A2           PIC  X(01).
  5244         16  LA-GROUPING-A2          PIC  X(06).
  5245         16  LA-STATE-A2             PIC  X(02).
  5246         16  LA-ACCOUNT-A2           PIC  X(10).
  5247         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5248         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5249
  5250     12  LA-CONTROL-BY-FORM.
  5251         16  LA-COMPANY-CD-A3        PIC  X(01).
  5252         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6318.cbl
  5253         16  LA-CARRIER-A3           PIC  X(01).
  5254         16  LA-GROUPING-A3          PIC  X(06).
  5255         16  LA-STATE-A3             PIC  X(02).
  5256         16  LA-ACCOUNT-A3           PIC  X(10).
  5257         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5258
  5259     12  LA-CONTROL-BY-PROCESSOR.
  5260         16  LA-COMPANY-CD-A4        PIC  X(01).
  5261         16  LA-PROCESSOR-CD         PIC  X(04).
  5262         16  LA-CARRIER-A4           PIC  X(01).
  5263         16  LA-GROUPING-A4          PIC  X(06).
  5264         16  LA-STATE-A4             PIC  X(02).
  5265         16  LA-ACCOUNT-A4           PIC  X(10).
  5266         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5267
  5268     12  LA-CONTROL-BY-KEY-FIELDS.
  5269         16  LA-COMPANY-CD-A5        PIC  X(01).
  5270         16  LA-CARRIER-A5           PIC  X(01).
  5271         16  LA-GROUPING-A5          PIC  X(06).
  5272         16  LA-STATE-A5             PIC  X(02).
  5273         16  LA-ACCOUNT-A5           PIC  X(10).
  5274         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5275
  5276     12  LA-CONTROL-BY-GROUP-CODE.
  5277         16  LA-COMPANY-CD-A6        PIC  X(01).
  5278         16  LA-ENTRY-A6.
  5279             20  LA-FILLER           PIC  X(02).
  5280             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5281         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5282
  5283     12  FILLER                      PIC  X(09).
  5284
  5285     12  LA-HEADER-RECORD.
  5286         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5287         16  LA-CREATION-DATE        PIC  X(02).
  5288         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5289         16  LA-FINAL-ACT-DATE       REDEFINES
  5290               LA-FOLLOW-UP-DATE     PIC  X(02).
  5291         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5292         16  LA-NO-OF-COPIES         PIC S9(01).
  5293         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5294         16  LA-REPLY-DATE           PIC  X(02).
  5295         16  LA-RESEND-DATES.
  5296             20  LA-RESEND-DATE      PIC  X(02).
  5297             20  LA-SENT-DATE        PIC  X(02).
  5298             20  FILLER              PIC  X(08).
  5299         16  LA-SOURCE-INFORMATION.
  5300             20  LA-DATA-SOURCE      PIC  X(01).
  5301             20  LA-ADDR-SOURCE      PIC  X(01).
  5302         16  LA-STATUS               PIC  X(01).
  5303             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5304             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5305             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5306             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5307             88  LA-STATUS-PURGED         VALUE 'P'.
  5308             88  LA-STATUS-VOIDED         VALUE 'V'.
  5309         16  LA-LAST-RESENT-PRINT-DATE
  5310                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6318.cbl
  5311         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5312             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5313                                          VALUE 'C'.
  5314             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5315                                          VALUE 'F'.
  5316             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5317                                          VALUE 'P'.
  5318         16  LA-PURGED-DATE          PIC  X(02).
  5319         16  LA-VOIDED-DATE          PIC  X(02).
  5320         16  LA-RESEND-LETR          PIC  X(4).
  5321         16  FILLER                  PIC  X(08).
  5322*        16  LA-RESEND-LETR-2        PIC  X(4).
  5323*        16  LA-RESEND-LETR-3        PIC  X(4).
  5324*        16  FILLER                  PIC  X(59).
  5325         16  LA-ARCHIVE-STATUS       PIC  X.
  5326             88  LA-TEMP                VALUE 'T'.
  5327             88  LA-QWS                 VALUE 'Q'.
  5328             88  LA-BATCH               VALUE 'B'.
  5329         16  LA-FINAL-ACT-IND        PIC  X(1).
  5330         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5331         16  FILLER                  PIC  X(46).
  5332*        16  FILLER                  PIC  X(71).
  5333         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5334         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5335         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5336                                     PIC  X(4).
  5337         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5338
  5339******************************************************************
  5340*                                COPY ERCCNOT.
  5341******************************************************************
  5342*                                                                *
  5343*                            ERCCNOT                             *
  5344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5345*                            VMOD=2.003                          *
  5346*                                                                *
  5347*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5348*                                                                *
  5349*        FILE TYPE= VSAM,KSDS                                    *
  5350*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5351*                                                                *
  5352*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5353*                                                                *
  5354*        LOG = YES                                               *
  5355*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5356*                                                                *
  5357******************************************************************
  5358*                   C H A N G E   L O G
  5359*
  5360* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5361*-----------------------------------------------------------------
  5362*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5363* EFFECTIVE    NUMBER
  5364*-----------------------------------------------------------------
  5365* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5366******************************************************************
  5367
  5368 01  CERT-NOTE-FILE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6318.cbl
  5369     12  CZ-RECORD-ID                PIC  XX.
  5370         88  VALID-CZ-ID                  VALUE 'CZ'.
  5371
  5372     12  CZ-CONTROL-PRIMARY.
  5373         16  CZ-COMPANY-CD           PIC X.
  5374         16  CZ-CARRIER              PIC X.
  5375         16  CZ-GROUPING.
  5376             20 CZ-GROUPING-PREFIX   PIC XXX.
  5377             20 CZ-GROUPING-PRIME    PIC XXX.
  5378         16  CZ-STATE                PIC XX.
  5379         16  CZ-ACCOUNT.
  5380             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5381             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5382         16  CZ-CERT-EFF-DT          PIC XX.
  5383         16  CZ-CERT-NO.
  5384             20  CZ-CERT-PRIME       PIC X(10).
  5385             20  CZ-CERT-SFX         PIC X.
  5386         16  CZ-RECORD-TYPE          PIC X.
  5387             88  CERT-NOTE           VALUE '1'.
  5388             88  CLAIM-CERT-NOTE     VALUE '2'.
  5389         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5390
  5391     12  CZ-LAST-MAINT-DT            PIC XX.
  5392     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5393     12  CZ-LAST-MAINT-USER          PIC X(4).
  5394
  5395     12  CZ-NOTE-INFORMATION.
  5396         16  CZ-NOTE                 PIC X(63).
  5397         16  FILLER                  PIC X(39).
  5398******************************************************************
  5399*                                COPY ELCEOBC.
  5400******************************************************************
  5401*                                                                *
  5402*                                                                *
  5403*                            ELCEOBC                             *
  5404*                            VMOD=2.001                          *
  5405*                                                                *
  5406*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5407*                                                                *
  5408*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5409*   VSAM EOB CODE TABLE                                          *
  5410*                                                                *
  5411*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5412*                                                                *
  5413*   FILE TYPE = VSAM,KSDS                                        *
  5414*   RECORD SIZE = 350   RECFORM = FIX                            *
  5415*                                                                *
  5416*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5417*                                                                *
  5418*   LOG = NO                                                     *
  5419*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5420*                                                                *
  5421*                                                                *
  5422******************************************************************
  5423*                   C H A N G E   L O G
  5424*
  5425* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5426*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6318.cbl
  5427*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5428* EFFECTIVE    NUMBER
  5429*-----------------------------------------------------------------
  5430* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5431* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5432******************************************************************
  5433 01  EOB-CODES.
  5434     12  EO-RECORD-ID                      PIC XX.
  5435         88  VALID-DN-ID                      VALUE 'EO'.
  5436     12  EO-CONTROL-PRIMARY.
  5437         16  EO-COMPANY-CD                 PIC X.
  5438         16  EO-RECORD-TYPE                PIC X.
  5439             88  EO-EOB-RECS                  VALUE '1'.
  5440             88  EO-VERIF-RECS                VALUE '2'.
  5441             88  EO-GCE-RECS                  VALUE '3'.
  5442         16  EO-EOB-CODE                   PIC X(4).
  5443         16  FILLER                        PIC X(9).
  5444     12  EO-MAINT-INFORMATION.
  5445         16  EO-LAST-MAINT-DT              PIC XX.
  5446         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5447         16  EO-LAST-MAINT-USER            PIC X(4).
  5448         16  FILLER                        PIC XX.
  5449     12  EO-DESCRIPTION                    PIC X(275).
  5450     12  FILLER                            PIC X(46).
  5451******************************************************************
  5452 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5453                          ACCOUNT-MASTER CONTROL-FILE
  5454                          PENDING-BUSINESS CERTIFICATE-MASTER
  5455                          ORIGINAL-CERTIFICATE
  5456                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5457                          MAILING-DATA LETTER-ARCHIVE
  5458                          CERT-NOTE-FILE EOB-CODES.
  5459 0000-DFHEXIT SECTION.
  5460     MOVE '9#                    $   ' TO DFHEIV0.
  5461     MOVE 'EL6318' TO DFHEIV1.
  5462     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5463     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5464     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5465     MOVE '5'                    TO DC-OPTION-CODE
  5466     PERFORM 9700-DATE-LINK
  5467     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5468     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5469     MOVE EIBTRMID               TO QID-TERM
  5470     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5471     IF EIBCALEN = 0
  5472        GO TO 8800-UNAUTHORIZED-ACCESS
  5473     END-IF
  5474     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5475     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5476        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5477           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5478           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5479           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5480           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5481           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5482           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5483           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5484           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6318.cbl
  5485           MOVE LOW-VALUES           TO EL631KI
  5486           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5487           GO TO 0350-BUILD-INIT-MAP
  5488        END-IF
  5489     END-IF
  5490     IF PI-CALLING-PROGRAM = 'EL614'
  5491        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5492                                 TO WS-PASSED-REASON-CODES
  5493        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5494        IF WS-PASSED-REASON-CODES NOT = SPACES
  5495           MOVE 'Y'                TO WS-SET-CODES-MDT
  5496        ELSE
  5497           MOVE 'N'                TO WS-SET-CODES-MDT
  5498        END-IF
  5499        PERFORM 0600-RECOVER-TEMP-STORAGE
  5500                                 THRU 0600-EXIT
  5501        GO TO 0350-BUILD-INIT-MAP
  5502     END-IF
  5503     IF EIBAID = DFHCLEAR
  5504        IF PI-CLEAR-ERROR
  5505           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5506           MOVE ER-3832           TO EMI-ERROR
  5507           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5508           GO TO 0350-BUILD-INIT-MAP
  5509        ELSE
  5510           GO TO 9400-CLEAR
  5511        END-IF
  5512     END-IF
  5513     .
  5514 0200-RECEIVE.
  5515     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5516        MOVE ER-0008             TO EMI-ERROR
  5517        PERFORM 9900-ERROR-FORMAT
  5518                                 THRU 9900-EXIT
  5519        MOVE -1                  TO PFENTRL
  5520        GO TO 8100-SEND-INITIAL-MAP
  5521     END-IF
  5522
  5523* EXEC CICS RECEIVE
  5524*        MAP      (MAP-NAME)
  5525*        MAPSET   (MAPSET-NAME)
  5526*        INTO     (EL631KI)
  5527*    END-EXEC
  5528     MOVE LENGTH OF
  5529      EL631KI
  5530       TO DFHEIV11
  5531*    MOVE '8"T I  L              ''   #00005518' TO DFHEIV0
  5532     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5533     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5534     MOVE X'2020233030303035353138' TO DFHEIV0(25:11)
  5535     CALL 'kxdfhei1' USING DFHEIV0,
  5536           MAP-NAME,
  5537           EL631KI,
  5538           DFHEIV11,
  5539           MAPSET-NAME,
  5540           DFHEIV99,
  5541           DFHEIV99
  5542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6318.cbl
  5543     IF PFENTRL = 0
  5544         GO TO 0300-CHECK-PFKEYS
  5545     END-IF
  5546     IF EIBAID NOT = DFHENTER
  5547         MOVE ER-0004            TO EMI-ERROR
  5548         GO TO 0320-INPUT-ERROR
  5549     END-IF
  5550     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5551        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5552     ELSE
  5553        MOVE ER-0029            TO EMI-ERROR
  5554        GO TO 0320-INPUT-ERROR
  5555     END-IF
  5556     .
  5557 0300-CHECK-PFKEYS.
  5558     IF EIBAID = DFHPF1
  5559        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5560        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5561        MOVE 'EL614'             TO PGM-NAME
  5562        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5563        move +1                  to s2
  5564        perform varying s1 from +1 by +1 until s1 > +12
  5565           if reacd-in (s1) not = spaces and low-values
  5566              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5567              add +5 to s2
  5568           end-if
  5569        END-perform
  5570        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5571        GO TO 9300-XCTL
  5572     END-IF
  5573     IF EIBAID = DFHPF2 OR DFHPF8
  5574        GO TO 0360-FINALIZE
  5575     END-IF
  5576     IF EIBAID = DFHPF23
  5577        IF PI-CLEAR-ERROR
  5578           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5579           MOVE ER-3832           TO EMI-ERROR
  5580           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5581           GO TO 0350-BUILD-INIT-MAP
  5582        ELSE
  5583           GO TO 8810-PF23
  5584        END-IF
  5585     END-IF
  5586     IF EIBAID = DFHPF24
  5587        IF PI-CLEAR-ERROR
  5588           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5589           MOVE ER-3832           TO EMI-ERROR
  5590           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5591           GO TO 0350-BUILD-INIT-MAP
  5592        ELSE
  5593           GO TO 9200-RETURN-MAIN-MENU
  5594        END-IF
  5595     END-IF
  5596     IF EIBAID = DFHPF12
  5597        GO TO 9500-PF12
  5598     END-IF
  5599     IF EIBAID = DFHENTER
  5600        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6318.cbl
  5601        GO TO 0325-EDIT-SCREEN
  5602     END-IF
  5603     MOVE ER-0029                TO EMI-ERROR
  5604     .
  5605 0320-INPUT-ERROR.
  5606     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5607     MOVE AL-UNBON               TO PFENTRA
  5608     MOVE -1                     TO PFENTRL
  5609     GO TO 8200-SEND-DATAONLY
  5610     .
  5611 0325-EDIT-SCREEN.
  5612     IF PRTSWL > ZEROS
  5613       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5614*          MOVE AL-UANON       TO PRTSWA
  5615*          IF PRTSWI = ' '
  5616*             MOVE 'N'         TO PRTSWI
  5617              MOVE 'P'         TO PRTSWI
  5618*          END-IF
  5619*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5620        END-IF
  5621     END-IF
  5622     IF (SIGREQL > ZEROS)
  5623        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5624        MOVE AL-UANON         TO SIGREQA
  5625        IF SIGREQI = ' '
  5626           MOVE 'N'           TO SIGREQI
  5627        END-IF
  5628        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5629     ELSE
  5630        MOVE ER-2651          TO EMI-ERROR
  5631        MOVE -1               TO SIGREQL
  5632        MOVE AL-UABON         TO SIGREQA
  5633        PERFORM 9900-ERROR-FORMAT
  5634                                 THRU 9900-EXIT
  5635     END-IF
  5636     IF LTRIDL > ZEROS
  5637        AND LTRIDI > SPACES
  5638        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5639        MOVE LTRIDI              TO LETR-LETTER-ID
  5640                                    PI-LTRID-ENTERED
  5641        MOVE SPACES              TO LETR-FILLER
  5642        MOVE 1                   TO LETR-SEQ-NO
  5643
  5644* EXEC CICS READ
  5645*           DATASET   ('ELLETR')
  5646*           INTO      (TEXT-FILES)
  5647*           RIDFLD    (ELLETR-KEY)
  5648*           RESP      (WS-RESPONSE)
  5649*       END-EXEC
  5650     MOVE LENGTH OF
  5651      TEXT-FILES
  5652       TO DFHEIV11
  5653     MOVE 'ELLETR' TO DFHEIV1
  5654*    MOVE '&"IL       E          (  N#00005623' TO DFHEIV0
  5655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5657     MOVE X'204E233030303035363233' TO DFHEIV0(25:11)
  5658     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6318.cbl
  5659           DFHEIV1,
  5660           TEXT-FILES,
  5661           DFHEIV11,
  5662           ELLETR-KEY,
  5663           DFHEIV99,
  5664           DFHEIV99,
  5665           DFHEIV99
  5666     MOVE EIBRESP  TO WS-RESPONSE
  5667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5668        IF RESP-NORMAL
  5669           MOVE AL-UANON         TO LTRIDA
  5670           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5671              MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5672           ELSE
  5673              MOVE SPACES        TO W-Z-CONTROL-DATA
  5674           END-IF
  5675           MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE
  5676        ELSE
  5677           MOVE ER-1236          TO EMI-ERROR
  5678           MOVE -1               TO LTRIDL
  5679           MOVE AL-UABON         TO LTRIDA
  5680           PERFORM 9900-ERROR-FORMAT
  5681                                 THRU 9900-EXIT
  5682        END-IF
  5683     ELSE
  5684        MOVE ER-1236          TO EMI-ERROR
  5685        MOVE -1               TO LTRIDL
  5686        MOVE AL-UABON         TO LTRIDA
  5687        PERFORM 9900-ERROR-FORMAT
  5688                                 THRU 9900-EXIT
  5689     END-IF
  5690     IF VOUCHL > ZEROS
  5691        IF VOUCHI = 'Y' OR 'N'
  5692           MOVE AL-UANON         TO VOUCHA
  5693           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5694        ELSE
  5695           MOVE ER-9999          TO EMI-ERROR
  5696           MOVE -1               TO VOUCHL
  5697           MOVE AL-UABON         TO VOUCHA
  5698           PERFORM 9900-ERROR-FORMAT
  5699                                 THRU 9900-EXIT
  5700        END-IF
  5701     END-IF
  5702     IF HLTHAPPL > ZEROS
  5703        IF HLTHAPPI = 'Y' OR 'N'
  5704           MOVE AL-UANON         TO HLTHAPPA
  5705           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  5706        ELSE
  5707           MOVE ER-9999          TO EMI-ERROR
  5708           MOVE -1               TO HLTHAPPL
  5709           MOVE AL-UABON         TO HLTHAPPA
  5710           PERFORM 9900-ERROR-FORMAT
  5711                                 THRU 9900-EXIT
  5712        END-IF
  5713     END-IF
  5714     IF PAYEEL > ZEROS
  5715        IF PAYEEI > SPACES
  5716           MOVE AL-UANON         TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6318.cbl
  5717           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5718        ELSE
  5719           MOVE ER-9999          TO EMI-ERROR
  5720           MOVE -1               TO PAYEEL
  5721           MOVE AL-UABON         TO PAYEEA
  5722           PERFORM 9900-ERROR-FORMAT
  5723                                 THRU 9900-EXIT
  5724        END-IF
  5725     END-IF
  5726     IF CERTIDL > ZEROS
  5727         IF CERTIDI NUMERIC
  5728            MOVE AL-UANON      TO CERTIDA
  5729            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5730         ELSE
  5731            MOVE ER-1778       TO EMI-ERROR
  5732            MOVE -1            TO CERTIDL
  5733            MOVE AL-UABON      TO CERTIDA
  5734            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5735        END-IF
  5736     ELSE
  5737        IF PI-PRINT-CERTIFICATE = 'Y'
  5738            MOVE ER-0715       TO EMI-ERROR
  5739            MOVE -1            TO CERTIDL
  5740            MOVE AL-UABON      TO CERTIDA
  5741            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5742        END-IF
  5743     END-IF
  5744     SET REASONS-NOT-FOUND TO TRUE
  5745     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5746        IF REACDL (S1) = +4 OR
  5747          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5748              MOVE AL-SANON     TO REACDA (S1)
  5749              SET REASONS-FOUND TO TRUE
  5750        END-IF
  5751     END-PERFORM
  5752
  5753     IF REASONS-NOT-FOUND
  5754        MOVE ER-1820             TO EMI-ERROR
  5755        MOVE -1                  TO PFENTRL
  5756        PERFORM 9900-ERROR-FORMAT
  5757                                 THRU 9900-EXIT
  5758     ELSE
  5759        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5760     END-IF
  5761
  5762     IF CRTNT1L > ZEROS
  5763        IF CRTNT1I > SPACES
  5764           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5765        END-IF
  5766     END-IF
  5767
  5768     IF CRTNT2L > ZEROS
  5769        IF CRTNT2I > SPACES
  5770           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5771        END-IF
  5772     END-IF
  5773
  5774     IF CRTNT3L > ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6318.cbl
  5775        IF CRTNT3I > SPACES
  5776           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  5777        END-IF
  5778     END-IF
  5779
  5780     IF CRTNT4L > ZEROS
  5781        IF CRTNT4I > SPACES
  5782           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  5783        END-IF
  5784     END-IF
  5785
  5786     IF CRTNT5L > ZEROS
  5787        IF CRTNT5I > SPACES
  5788           MOVE CRTNT5I          TO PI-CERTNT5-ENTERED
  5789        END-IF
  5790     END-IF
  5791
  5792     IF CRTNT6L > ZEROS
  5793        IF CRTNT6I > SPACES
  5794           MOVE CRTNT6I          TO PI-CERTNT6-ENTERED
  5795        END-IF
  5796     END-IF
  5797
  5798     .
  5799 0325-EXIT.
  5800     EXIT.
  5801 0330-CHECK-ERRORS.
  5802     IF EMI-NO-ERRORS
  5803        GO TO 0350-BUILD-INIT-MAP
  5804     ELSE
  5805        GO TO 8200-SEND-DATAONLY
  5806     END-IF
  5807     .
  5808 0330-EXIT.
  5809     EXIT.
  5810 0350-BUILD-INIT-MAP.
  5811     MOVE PI-CRTO-CARRIER        TO CARRO
  5812     MOVE PI-CRTO-GROUPING       TO GROUPO
  5813     MOVE PI-CRTO-STATE          TO STATEO
  5814     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5815     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5816     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5817     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5818     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5819     MOVE ' '                    TO DC-OPTION-CODE
  5820     PERFORM 9700-DATE-LINK
  5821     IF NO-CONVERSION-ERROR
  5822        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5823     END-IF
  5824*     IF PI-PRTSW-ENTERED > SPACES
  5825*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5826*        MOVE AL-UANON            TO PRTSWA
  5827*        MOVE +1                  TO PRTSWL
  5828*     END-IF
  5829
  5830     IF PI-SIGREQ-ENTERED > SPACES
  5831        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5832        MOVE AL-UANON            TO SIGREQA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6318.cbl
  5833        MOVE +1                  TO SIGREQL
  5834     ELSE
  5835        IF PI-CLAIM-REFORMATION
  5836            MOVE 'Y'             TO SIGREQI
  5837            MOVE AL-UANON        TO SIGREQA
  5838            MOVE +1              TO SIGREQL
  5839        END-IF
  5840     END-IF
  5841
  5842     IF PI-LTRID-ENTERED > SPACES
  5843        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5844        MOVE AL-UANON            TO LTRIDA
  5845        MOVE +4                  TO LTRIDL
  5846     ELSE
  5847        IF PI-CLAIM-REFORMATION
  5848            MOVE 'CLRF'          TO LTRIDI
  5849            MOVE AL-UANON        TO LTRIDA
  5850            MOVE +4              TO LTRIDL
  5851        END-IF
  5852     END-IF
  5853
  5854     IF PI-VOUCHER-ENTERED > SPACES
  5855        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  5856        MOVE AL-UANON            TO VOUCHA
  5857        MOVE +1                  TO VOUCHL
  5858     END-IF
  5859
  5860     IF PI-HLTHAPP-ENTERED > SPACES
  5861        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  5862        MOVE AL-UANON            TO HLTHAPPA
  5863        MOVE +1                  TO HLTHAPPL
  5864     END-IF
  5865
  5866     IF PI-PAYEE-ENTERED > SPACES
  5867        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  5868        MOVE AL-UANON            TO PAYEEA
  5869        MOVE +10                 TO PAYEEL
  5870     END-IF
  5871
  5872     IF PI-CERTID-ENTERED > SPACES
  5873        MOVE PI-CERTID-ENTERED   TO CERTIDI
  5874        MOVE AL-UANON            TO CERTIDA
  5875        MOVE +5                  TO CERTIDL
  5876     END-IF
  5877
  5878     SET REASONS-NOT-FOUND TO TRUE
  5879     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5880     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5881        IF REACDL (S1) = +4 OR
  5882          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5883              MOVE AL-SANON      TO REACDA (S1)
  5884              MOVE +4            TO REACDL (S1)
  5885              SET REASONS-FOUND  TO TRUE
  5886        END-IF
  5887     END-PERFORM
  5888
  5889     IF REASONS-NOT-FOUND
  5890         IF PI-CLAIM-REFORMATION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6318.cbl
  5891            MOVE 'CRNA'          TO REACD-IN (1)
  5892            MOVE AL-SANON        TO REACDA (1)
  5893            MOVE +4              TO REACDL (1)
  5894            SET REASONS-FOUND    TO TRUE
  5895        END-IF
  5896     END-IF
  5897
  5898     IF PI-CERTNT1-ENTERED > SPACES
  5899        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5900        MOVE AL-UANON            TO CRTNT1A
  5901        MOVE +63                 TO CRTNT1L
  5902     END-IF
  5903
  5904     IF PI-CERTNT2-ENTERED > SPACES
  5905        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5906        MOVE AL-UANON            TO CRTNT2A
  5907        MOVE +63                 TO CRTNT2L
  5908     END-IF
  5909
  5910     IF PI-CERTNT3-ENTERED > SPACES
  5911        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  5912        MOVE AL-UANON            TO CRTNT3A
  5913        MOVE +63                 TO CRTNT3L
  5914     END-IF
  5915
  5916     IF PI-CERTNT4-ENTERED > SPACES
  5917        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  5918        MOVE AL-UANON            TO CRTNT4A
  5919        MOVE +63                 TO CRTNT4L
  5920     END-IF
  5921
  5922     IF PI-CERTNT5-ENTERED > SPACES
  5923        MOVE PI-CERTNT5-ENTERED  TO CRTNT5I
  5924        MOVE AL-UANON            TO CRTNT5A
  5925        MOVE +63                 TO CRTNT5L
  5926     END-IF
  5927
  5928     IF PI-CERTNT6-ENTERED > SPACES
  5929        MOVE PI-CERTNT6-ENTERED  TO CRTNT6I
  5930        MOVE AL-UANON            TO CRTNT6A
  5931        MOVE +63                 TO CRTNT6L
  5932     END-IF
  5933
  5934     GO TO 8100-SEND-INITIAL-MAP
  5935     .
  5936 0360-FINALIZE.
  5937     display ' made it to 0360 '
  5938     set P to address of KIXSYS
  5939     CALL "getenv" using by value P returning var-ptr
  5940     if var-ptr = null then
  5941        display ' kixsys not set '
  5942     else
  5943        set address of var to var-ptr
  5944        move 0 to env-var-len
  5945        inspect var tallying env-var-len
  5946          for characters before X'00'
  5947*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  5948        unstring var (1:env-var-len) delimited by '/'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6318.cbl
  5949           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5950              WS-KIX-SYS
  5951        end-unstring
  5952*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  5953*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  5954     end-if
  5955     set P to address of KIXHOST
  5956     CALL "getenv" using by value P returning var-ptr
  5957     if var-ptr = null then
  5958        display ' kixhost not set '
  5959     else
  5960        set address of var to var-ptr
  5961        move 0 to env-var-len
  5962        inspect var tallying env-var-len
  5963          for characters before X'00'
  5964*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  5965        MOVE var(1:env-var-len)  to ws-kixhost
  5966        DISPLAY ' WS KIX HOST ' WS-KIXhost
  5967     end-if
  5968     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  5969     IF NOT EMI-NO-ERRORS
  5970        GO TO 8200-SEND-DATAONLY
  5971     END-IF
  5972     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  5973     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  5974                                    NEW-ELCRTO-KEY
  5975     SUBTRACT +1               FROM NCRTO-SEQ-NO
  5976     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5977     IF RESP-NORMAL
  5978        AND (PI-ELCRTO-KEY = OC-CONTROL-PRIMARY)
  5979        DISPLAY ' RESP NORMAL AND = '
  5980        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  5981*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  5982        PERFORM 1100-CALL-NS-BUS-LOGIC
  5983                                 THRU 1100-EXIT
  5984        IF BL-OK
  5985           CONTINUE
  5986        ELSE
  5987           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  5988           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  5989           MOVE -1               TO SIGREQL
  5990        END-IF
  5991     ELSE
  5992        MOVE ER-9999             TO EMI-ERROR
  5993        PERFORM 9900-ERROR-FORMAT
  5994                                 THRU 9900-EXIT
  5995        MOVE -1                  TO SIGREQL
  5996        GO TO 8100-SEND-INITIAL-MAP
  5997     END-IF
  5998     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  5999                                 TO SYSO
  6000     MOVE WS-KIXHOST             TO HOSTO
  6001     MOVE PI-COMPANY-ID          TO COMPANYO
  6002     MOVE '4'                    TO DATASORO
  6003     MOVE BL-BATCH-NO            TO BATCHNOO
  6004     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6005     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6006     MOVE PI-PROCESSOR-ID        TO PROCIDO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6318.cbl
  6007*    MOVE 'N'                    TO PRTSWO
  6008*    MOVE -1                     TO PRTSWL
  6009*    MOVE AL-UANON               TO PRTSWA
  6010     MOVE -1                     TO SIGREQL
  6011     MOVE AL-UANON               TO SIGREQA
  6012     IF EIBAID = DFHPF2
  6013        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6014        MOVE ER-0280             TO EMI-ERROR
  6015        PERFORM 9900-ERROR-FORMAT
  6016                                 THRU 9900-EXIT
  6017        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6018        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6019        MOVE 'Y'                 TO PI-FINALIZED-IND
  6020        GO TO 9400-CLEAR
  6021     ELSE
  6022        MOVE ER-1818             TO EMI-ERROR
  6023        PERFORM 9900-ERROR-FORMAT
  6024                                 THRU 9900-EXIT
  6025     END-IF
  6026     GO TO 0350-BUILD-INIT-MAP
  6027     .
  6028 0360-EXIT.
  6029     EXIT.
  6030 0362-READ-ELCRTO.
  6031     display ' made it to 0362 '
  6032
  6033* EXEC CICS READ
  6034*        DATASET   (WS-ELCRTO-FILE-ID)
  6035*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6036*        RIDFLD    (ELCRTO-KEY)
  6037*        RESP      (WS-RESPONSE)
  6038*    END-EXEC
  6039*    MOVE '&"S        E          (  N#00005993' TO DFHEIV0
  6040     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6042     MOVE X'204E233030303035393933' TO DFHEIV0(25:11)
  6043     CALL 'kxdfhei1' USING DFHEIV0,
  6044           WS-ELCRTO-FILE-ID,
  6045           DFHEIV20,
  6046           DFHEIV99,
  6047           ELCRTO-KEY,
  6048           DFHEIV99,
  6049           DFHEIV99,
  6050           DFHEIV99
  6051     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6052         DFHEIV20
  6053     MOVE EIBRESP  TO WS-RESPONSE
  6054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6055     .
  6056 0362-EXIT.
  6057     EXIT.
  6058 0363-READ-ELCRTO-UPD.
  6059     display ' made it to 0363 '
  6060
  6061* EXEC CICS READ
  6062*        DATASET   (WS-ELCRTO-FILE-ID)
  6063*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6064*        RIDFLD    (ELCRTO-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL6318.cbl
  6065*        UPDATE
  6066*        RESP      (WS-RESPONSE)
  6067*    END-EXEC
  6068*    MOVE '&"S        EU         (  N#00006004' TO DFHEIV0
  6069     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6070     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6071     MOVE X'204E233030303036303034' TO DFHEIV0(25:11)
  6072     CALL 'kxdfhei1' USING DFHEIV0,
  6073           WS-ELCRTO-FILE-ID,
  6074           DFHEIV20,
  6075           DFHEIV99,
  6076           ELCRTO-KEY,
  6077           DFHEIV99,
  6078           DFHEIV99,
  6079           DFHEIV99
  6080     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6081         DFHEIV20
  6082     MOVE EIBRESP  TO WS-RESPONSE
  6083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6084     .
  6085 0363-EXIT.
  6086     EXIT.
  6087 0365-READ-ERENDT.
  6088
  6089* EXEC CICS READ
  6090*        DATASET   (WS-ERENDT-FILE-ID)
  6091*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6092*        RIDFLD    (ERENDT-KEY)
  6093*        RESP      (WS-RESPONSE)
  6094*    END-EXEC
  6095*    MOVE '&"S        E          (  N#00006015' TO DFHEIV0
  6096     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6098     MOVE X'204E233030303036303135' TO DFHEIV0(25:11)
  6099     CALL 'kxdfhei1' USING DFHEIV0,
  6100           WS-ERENDT-FILE-ID,
  6101           DFHEIV20,
  6102           DFHEIV99,
  6103           ERENDT-KEY,
  6104           DFHEIV99,
  6105           DFHEIV99,
  6106           DFHEIV99
  6107     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6108         DFHEIV20
  6109     MOVE EIBRESP  TO WS-RESPONSE
  6110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6111     .
  6112 0365-EXIT.
  6113     EXIT.
  6114 0400-ADD-ERENDT.
  6115     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6116     display ' made it to 0400 '
  6117
  6118* EXEC CICS GETMAIN
  6119*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6120*         LENGTH   (ERENDT-LENGTH)
  6121*         INITIMG  (GETMAIN-SPACE)
  6122*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL6318.cbl
  6123*    MOVE ',"IL                  $   #00006027' TO DFHEIV0
  6124     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6125     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6126     MOVE X'2020233030303036303237' TO DFHEIV0(25:11)
  6127     CALL 'kxdfhei1' USING DFHEIV0,
  6128           DFHEIV20,
  6129           ERENDT-LENGTH,
  6130           GETMAIN-SPACE
  6131     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6132         DFHEIV20
  6133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6134     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6135     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6136     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6137     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6138                                    EN-INPUT-DT
  6139                                    EN-PROCESS-DT
  6140
  6141     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6142     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6143     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6144     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6145     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6146     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6147     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6148     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6149     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6150     IF OC-LF-BENCD NOT = '00' AND '  '
  6151        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6152        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6153        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6154        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6155        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6156        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6157        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6158     END-IF
  6159     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6160     IF OC-AH-BENCD NOT = '00' AND '  '
  6161        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6162        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6163        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6164        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6165        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6166        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6167     END-IF
  6168     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6169
  6170* EXEC CICS GETMAIN
  6171*         SET      (ADDRESS OF PENDING-BUSINESS)
  6172*         LENGTH   (ERPNDB-LENGTH)
  6173*         INITIMG  (GETMAIN-SPACE)
  6174*    END-EXEC
  6175*    MOVE ',"IL                  $   #00006067' TO DFHEIV0
  6176     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6178     MOVE X'2020233030303036303637' TO DFHEIV0(25:11)
  6179     CALL 'kxdfhei1' USING DFHEIV0,
  6180           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL6318.cbl
  6181           ERPNDB-LENGTH,
  6182           GETMAIN-SPACE
  6183     SET ADDRESS OF PENDING-BUSINESS TO
  6184         DFHEIV20
  6185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6186     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6187     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6188
  6189* EXEC CICS READ
  6190*        DATASET   (WS-ERPNDB-FILE-ID)
  6191*        INTO      (PENDING-BUSINESS)
  6192*        RIDFLD    (ERPNDB-KEY)
  6193*        RESP      (WS-RESPONSE)
  6194*    END-EXEC
  6195     MOVE LENGTH OF
  6196      PENDING-BUSINESS
  6197       TO DFHEIV11
  6198*    MOVE '&"IL       E          (  N#00006074' TO DFHEIV0
  6199     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6201     MOVE X'204E233030303036303734' TO DFHEIV0(25:11)
  6202     CALL 'kxdfhei1' USING DFHEIV0,
  6203           WS-ERPNDB-FILE-ID,
  6204           PENDING-BUSINESS,
  6205           DFHEIV11,
  6206           ERPNDB-KEY,
  6207           DFHEIV99,
  6208           DFHEIV99,
  6209           DFHEIV99
  6210     MOVE EIBRESP  TO WS-RESPONSE
  6211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6212     IF NOT RESP-NORMAL
  6213        GO TO 0400-EXIT
  6214     END-IF
  6215*    set found-pndb to true
  6216     display ' good read on erpndb '
  6217     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6218                                      NCRTO-INS-FIRST-NAME
  6219     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6220                                      NCRTO-INS-MIDDLE-INIT
  6221     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6222                                      NCRTO-INS-LAST-NAME
  6223     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6224                                      NCRTO-INS-AGE
  6225     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6226                                      NCRTO-JNT-FIRST-NAME
  6227     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6228                                      NCRTO-JNT-MIDDLE-INIT
  6229     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6230                                      NCRTO-JNT-LAST-NAME
  6231     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6232                                      NCRTO-JNT-AGE
  6233     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6234                                      NCRTO-LF-BENCD
  6235     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6236        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6237                                      NCRTO-LF-BEN-AMT
  6238        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL6318.cbl
  6239                                      NCRTO-LF-PRM-AMT
  6240        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6241                                      NCRTO-LF-ALT-BEN-AMT
  6242        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6243                                      NCRTO-LF-ALT-PRM-AMT
  6244        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6245                                      NCRTO-LF-TERM
  6246        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6247                                      NCRTO-LF-EXP-DT
  6248        IF PB-I-JOINT-COMMISSION > +0
  6249           MOVE PB-I-JOINT-COMMISSION
  6250                                   TO EN-LF-NEW-COMM-PCT
  6251                                      NCRTO-LF-COMM-PCT
  6252        ELSE
  6253           MOVE PB-I-LIFE-COMMISSION
  6254                                   TO EN-LF-NEW-COMM-PCT
  6255                                      NCRTO-LF-COMM-PCT
  6256        END-IF
  6257     END-IF
  6258     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6259                                      NCRTO-AH-BENCD
  6260     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6261        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6262                                      NCRTO-AH-BEN-AMT
  6263        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6264                                      NCRTO-AH-PRM-AMT
  6265        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6266                                      NCRTO-AH-TERM
  6267        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6268                                      NCRTO-AH-EXP-DT
  6269        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6270                                      NCRTO-AH-CP
  6271        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6272                                      NCRTO-AH-COMM-PCT
  6273     END-IF
  6274     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6275     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6276     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6277     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6278*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6279     MOVE 'Y'                    TO EN-COMM-CHGBK
  6280
  6281     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6282        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6283        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6284        EN-AH-NEW-PRM-AMT)
  6285     COMPUTE EN-ACCT-PORTION ROUNDED =
  6286        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6287        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6288        * EN-LF-NEW-COMM-PCT)
  6289                       +
  6290        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6291        * EN-AH-NEW-COMM-PCT)
  6292     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6293        EN-ACCT-PORTION
  6294     move pb-control-by-account (1:33)
  6295                                 to ws-ermail-key
  6296
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL6318.cbl
  6297* EXEC CICS READ
  6298*        DATASET   ('ERMAIL')
  6299*        SET       (ADDRESS OF MAILING-DATA)
  6300*        RIDFLD    (WS-ERMAIL-KEY)
  6301*        RESP      (WS-RESPONSE)
  6302*    END-EXEC
  6303     MOVE 'ERMAIL' TO DFHEIV1
  6304*    MOVE '&"S        E          (  N#00006164' TO DFHEIV0
  6305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6307     MOVE X'204E233030303036313634' TO DFHEIV0(25:11)
  6308     CALL 'kxdfhei1' USING DFHEIV0,
  6309           DFHEIV1,
  6310           DFHEIV20,
  6311           DFHEIV99,
  6312           WS-ERMAIL-KEY,
  6313           DFHEIV99,
  6314           DFHEIV99,
  6315           DFHEIV99
  6316     SET ADDRESS OF MAILING-DATA TO
  6317         DFHEIV20
  6318     MOVE EIBRESP  TO WS-RESPONSE
  6319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6320     IF RESP-NORMAL
  6321        DISPLAY ' FOUND ERMAIL '
  6322        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6323                                    NCRTO-CRED-BENE-NAME
  6324     ELSE
  6325        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6326     END-IF
  6327     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6328        IF REACD-IN (S1) NOT = LOW-VALUES
  6329           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6330        END-IF
  6331     END-PERFORM
  6332     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6333     MOVE 'G'                    TO EN-DOCU-TYPE
  6334     MOVE 'Y'                    TO EN-MONEY-SW
  6335     MOVE SIGREQI                TO EN-SIG-SW
  6336     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6337     MOVE PAYEEI                 TO EN-PAYEE
  6338     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6339     DISPLAY ' 0400 EXIT '
  6340     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6341     .
  6342 0400-EXIT.
  6343     EXIT.
  6344 0410-INIT-ERENDT.
  6345     display ' made it to 0410 '
  6346     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6347     MOVE ZEROS                  TO ENDT-SEQ-NO
  6348
  6349* EXEC CICS READ
  6350*        DATASET    (WS-ERENDT-FILE-ID)
  6351*        RIDFLD     (ERENDT-KEY)
  6352*        INTO       (ENDORSEMENT-RECORD)
  6353*        RESP       (WS-RESPONSE)
  6354*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL6318.cbl
  6355*    END-EXEC
  6356     MOVE LENGTH OF
  6357      ENDORSEMENT-RECORD
  6358       TO DFHEIV11
  6359*    MOVE '&"IL       G          (  N#00006198' TO DFHEIV0
  6360     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6361     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6362     MOVE X'204E233030303036313938' TO DFHEIV0(25:11)
  6363     CALL 'kxdfhei1' USING DFHEIV0,
  6364           WS-ERENDT-FILE-ID,
  6365           ENDORSEMENT-RECORD,
  6366           DFHEIV11,
  6367           ERENDT-KEY,
  6368           DFHEIV99,
  6369           DFHEIV99,
  6370           DFHEIV99
  6371     MOVE EIBRESP  TO WS-RESPONSE
  6372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6373     IF RESP-NORMAL
  6374        AND (EN-CONTROL-PRIMARY (1:34) =
  6375           OC-CONTROL-PRIMARY (1:34))
  6376        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6377     ELSE
  6378        MOVE +4096               TO WS-SEQ-NO
  6379     END-IF
  6380     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6381     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6382     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6383     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6384     INITIALIZE EN-ISSUE-RECORD
  6385     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6386                                    EN-AH-ORIG-EXP-DT
  6387                                    EN-LF-NEW-EXP-DT
  6388                                    EN-AH-NEW-EXP-DT
  6389                                    EN-PROCESS-DT
  6390     .
  6391 0410-EXIT.
  6392     EXIT.
  6393 0420-UPDATE-ELCRTO.
  6394     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6395     IF RESP-NORMAL
  6396        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6397                                    OC-LAST-MAINT-DT
  6398        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6399        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6400
  6401* EXEC CICS REWRITE
  6402*          FROM     (ORIGINAL-CERTIFICATE)
  6403*          DATASET  ('ELCRTO')
  6404*       END-EXEC
  6405     MOVE LENGTH OF
  6406      ORIGINAL-CERTIFICATE
  6407       TO DFHEIV11
  6408     MOVE 'ELCRTO' TO DFHEIV1
  6409*    MOVE '&& L                  %   #00006232' TO DFHEIV0
  6410     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6411     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6412     MOVE X'2020233030303036323332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL6318.cbl
  6413     CALL 'kxdfhei1' USING DFHEIV0,
  6414           DFHEIV1,
  6415           ORIGINAL-CERTIFICATE,
  6416           DFHEIV11,
  6417           DFHEIV99
  6418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6419     END-IF
  6420     .
  6421 0420-EXIT.
  6422     EXIT.
  6423
  6424 0425-ADD-NEW-ELCRTO.
  6425     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6426     MOVE 'OC'                   TO OC-RECORD-ID
  6427     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6428     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6429     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6430     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6431     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6432     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6433     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6434     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6435     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6436     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6437     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6438     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6439     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6440     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6441     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6442     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6443     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6444     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6445     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6446     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6447     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  6448     MOVE +0                     TO OC-LF-CANCEL-AMT
  6449                                    OC-LF-ITD-CANCEL-AMT
  6450     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6451     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6452     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6453     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6454     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6455     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6456     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6457     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  6458     MOVE +0                     TO OC-AH-CANCEL-AMT
  6459                                    OC-AH-ITD-CANCEL-AMT
  6460     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6461     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6462     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6463     .
  6464 0425-WRITE-ELCRTO.
  6465
  6466
  6467* EXEC CICS WRITE
  6468*       DATASET   ('ELCRTO')
  6469*       FROM      (ORIGINAL-CERTIFICATE)
  6470*       RIDFLD    (OC-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL6318.cbl
  6471*       RESP      (WS-RESPONSE)
  6472*    END-EXEC
  6473     MOVE LENGTH OF
  6474      ORIGINAL-CERTIFICATE
  6475       TO DFHEIV11
  6476     MOVE 'ELCRTO' TO DFHEIV1
  6477*    MOVE '&$ L                  ''  N#00006283' TO DFHEIV0
  6478     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6479     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6480     MOVE X'204E233030303036323833' TO DFHEIV0(25:11)
  6481     CALL 'kxdfhei1' USING DFHEIV0,
  6482           DFHEIV1,
  6483           ORIGINAL-CERTIFICATE,
  6484           DFHEIV11,
  6485           OC-CONTROL-PRIMARY,
  6486           DFHEIV99,
  6487           DFHEIV99
  6488     MOVE EIBRESP  TO WS-RESPONSE
  6489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6490
  6491     display ' just wrote new crto ' ws-response
  6492     IF RESP-DUPKEY
  6493        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6494        GO TO 0425-WRITE-ELCRTO
  6495     ELSE
  6496        IF NOT RESP-NORMAL
  6497           MOVE -1               TO SIGREQL
  6498           MOVE ER-3830          TO EMI-ERROR
  6499           PERFORM 9900-ERROR-FORMAT
  6500                                 THRU 9900-EXIT
  6501        ELSE
  6502           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6503        END-IF
  6504     END-IF
  6505
  6506     .
  6507 0425-EXIT.
  6508     EXIT.
  6509
  6510 0426-ADD-CERT-NOTES.
  6511
  6512
  6513* EXEC CICS GETMAIN
  6514*         SET      (ADDRESS OF CERT-NOTE-FILE)
  6515*         LENGTH   (ERCNOT-LENGTH)
  6516*         INITIMG  (GETMAIN-SPACE)
  6517*    END-EXEC
  6518*    MOVE ',"IL                  $   #00006311' TO DFHEIV0
  6519     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6520     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6521     MOVE X'2020233030303036333131' TO DFHEIV0(25:11)
  6522     CALL 'kxdfhei1' USING DFHEIV0,
  6523           DFHEIV20,
  6524           ERCNOT-LENGTH,
  6525           GETMAIN-SPACE
  6526     SET ADDRESS OF CERT-NOTE-FILE TO
  6527         DFHEIV20
  6528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL6318.cbl
  6529
  6530     MOVE LOW-VALUES TO WS-CERT-NOTE
  6531     IF PI-CERTNT1-ENTERED > SPACES
  6532         MOVE PI-CERTNT1-ENTERED TO WS-CERT-NOTE
  6533         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6534     END-IF
  6535
  6536     MOVE LOW-VALUES TO WS-CERT-NOTE
  6537     IF PI-CERTNT2-ENTERED > SPACES
  6538         MOVE PI-CERTNT2-ENTERED TO WS-CERT-NOTE
  6539         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6540     END-IF
  6541
  6542     MOVE LOW-VALUES TO WS-CERT-NOTE
  6543     IF PI-CERTNT3-ENTERED > SPACES
  6544         MOVE PI-CERTNT3-ENTERED TO WS-CERT-NOTE
  6545         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6546     END-IF
  6547
  6548     MOVE LOW-VALUES TO WS-CERT-NOTE
  6549     IF PI-CERTNT4-ENTERED > SPACES
  6550         MOVE PI-CERTNT4-ENTERED TO WS-CERT-NOTE
  6551         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6552     END-IF
  6553
  6554     MOVE LOW-VALUES TO WS-CERT-NOTE
  6555     IF PI-CERTNT5-ENTERED > SPACES
  6556         MOVE PI-CERTNT5-ENTERED TO WS-CERT-NOTE
  6557         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6558     END-IF
  6559
  6560     MOVE LOW-VALUES TO WS-CERT-NOTE
  6561     IF PI-CERTNT6-ENTERED > SPACES
  6562         MOVE PI-CERTNT6-ENTERED TO WS-CERT-NOTE
  6563         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6564     END-IF
  6565
  6566     .
  6567 0426-EXIT.
  6568     EXIT.
  6569
  6570 0430-WRITE-ERENDT.
  6571     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6572     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6573     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6574
  6575* EXEC CICS WRITE
  6576*         DATASET   (WS-ERENDT-FILE-ID)
  6577*         FROM      (ENDORSEMENT-RECORD)
  6578*         RIDFLD    (EN-CONTROL-PRIMARY)
  6579*         RESP      (WS-RESPONSE)
  6580*    END-EXEC
  6581     MOVE LENGTH OF
  6582      ENDORSEMENT-RECORD
  6583       TO DFHEIV11
  6584*    MOVE '&$ L                  ''  N#00006361' TO DFHEIV0
  6585     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6586     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL6318.cbl
  6587     MOVE X'204E233030303036333631' TO DFHEIV0(25:11)
  6588     CALL 'kxdfhei1' USING DFHEIV0,
  6589           WS-ERENDT-FILE-ID,
  6590           ENDORSEMENT-RECORD,
  6591           DFHEIV11,
  6592           EN-CONTROL-PRIMARY,
  6593           DFHEIV99,
  6594           DFHEIV99
  6595     MOVE EIBRESP  TO WS-RESPONSE
  6596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6597     IF RESP-NORMAL
  6598        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  6599        display ' good write erendt '
  6600        IF EIBAID = DFHPF2
  6601           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6602           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6603           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6604           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6605        END-IF
  6606     ELSE
  6607        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6608        MOVE -1                  TO SIGREQL
  6609        MOVE ER-0132             TO EMI-ERROR
  6610        MOVE AL-UABON            TO SIGREQA
  6611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6612     END-IF
  6613     .
  6614 0430-EXIT.
  6615     EXIT.
  6616
  6617 0440-ADD-BILLING-NOTE.
  6618     DISPLAY 'ADD BILLING NOTE'
  6619
  6620* EXEC CICS GETMAIN
  6621*         SET      (ADDRESS OF EOB-CODES)
  6622*         LENGTH   (ELEOBC-LENGTH)
  6623*         INITIMG  (GETMAIN-SPACE)
  6624*    END-EXEC
  6625*    MOVE ',"IL                  $   #00006389' TO DFHEIV0
  6626     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6627     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6628     MOVE X'2020233030303036333839' TO DFHEIV0(25:11)
  6629     CALL 'kxdfhei1' USING DFHEIV0,
  6630           DFHEIV20,
  6631           ELEOBC-LENGTH,
  6632           GETMAIN-SPACE
  6633     SET ADDRESS OF EOB-CODES TO
  6634         DFHEIV20
  6635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6636
  6637     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6638     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6639     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6640
  6641
  6642* EXEC CICS STARTBR
  6643*        DATASET   ('ELEOBC')
  6644*        RIDFLD    (WS-ELEOBC-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL6318.cbl
  6645*        GTEQ
  6646*        RESP      (WS-RESPONSE)
  6647*    END-EXEC
  6648     MOVE 'ELEOBC' TO DFHEIV1
  6649     MOVE 0
  6650       TO DFHEIV11
  6651*    MOVE '&,         G          &  N#00006399' TO DFHEIV0
  6652     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6653     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6654     MOVE X'204E233030303036333939' TO DFHEIV0(25:11)
  6655     CALL 'kxdfhei1' USING DFHEIV0,
  6656           DFHEIV1,
  6657           WS-ELEOBC-KEY,
  6658           DFHEIV99,
  6659           DFHEIV11,
  6660           DFHEIV99
  6661     MOVE EIBRESP  TO WS-RESPONSE
  6662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6663
  6664     IF NOT RESP-NORMAL
  6665        GO TO 0440-EXIT
  6666     END-IF
  6667      .
  6668 0440-READNEXT-ELEOBC.
  6669
  6670
  6671* EXEC CICS READNEXT
  6672*       INTO    (EOB-CODES)
  6673*       DATASET ('ELEOBC')
  6674*       RIDFLD  (WS-ELEOBC-KEY)
  6675*       RESP    (WS-RESPONSE)
  6676*    END-EXEC
  6677     MOVE LENGTH OF
  6678      EOB-CODES
  6679       TO DFHEIV12
  6680     MOVE 'ELEOBC' TO DFHEIV1
  6681     MOVE 0
  6682       TO DFHEIV11
  6683*    MOVE '&.IL                  )  N#00006412' TO DFHEIV0
  6684     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6685     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6686     MOVE X'204E233030303036343132' TO DFHEIV0(25:11)
  6687     CALL 'kxdfhei1' USING DFHEIV0,
  6688           DFHEIV1,
  6689           EOB-CODES,
  6690           DFHEIV12,
  6691           WS-ELEOBC-KEY,
  6692           DFHEIV99,
  6693           DFHEIV11,
  6694           DFHEIV99,
  6695           DFHEIV99
  6696     MOVE EIBRESP  TO WS-RESPONSE
  6697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6698
  6699     IF RESP-NORMAL
  6700         IF EO-RECORD-TYPE NOT = '5'
  6701             GO TO 0440-EXIT
  6702         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL6318.cbl
  6703     ELSE
  6704         GO TO 0440-EXIT
  6705     END-IF
  6706
  6707     IF EO-RECORD-TYPE = '5' AND
  6708        EO-EOB-CODE = PI-LTRID-ENTERED
  6709           CONTINUE
  6710     ELSE
  6711         GO TO 0440-READNEXT-ELEOBC
  6712     END-IF
  6713
  6714     DISPLAY 'FOUND BILL NOTE ' EOB-CODES
  6715     MOVE SPACES TO WS-BILLING-NOTE
  6716     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6717     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6718     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6719     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6720
  6721
  6722* EXEC CICS GETMAIN
  6723*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6724*         LENGTH   (ERNOTE-LENGTH)
  6725*         INITIMG  (GETMAIN-SPACE)
  6726*    END-EXEC
  6727*    MOVE ',"IL                  $   #00006441' TO DFHEIV0
  6728     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6729     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6730     MOVE X'2020233030303036343431' TO DFHEIV0(25:11)
  6731     CALL 'kxdfhei1' USING DFHEIV0,
  6732           DFHEIV20,
  6733           ERNOTE-LENGTH,
  6734           GETMAIN-SPACE
  6735     SET ADDRESS OF CERTIFICATE-NOTE TO
  6736         DFHEIV20
  6737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6738
  6739     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6740
  6741
  6742* EXEC CICS READ
  6743*       DATASET    (WS-ERNOTE-FILE-ID)
  6744*       RIDFLD     (WS-ERNOTE-KEY)
  6745*       INTO       (CERTIFICATE-NOTE)
  6746*       RESP       (WS-RESPONSE)
  6747*       UPDATE
  6748*    END-EXEC
  6749     MOVE LENGTH OF
  6750      CERTIFICATE-NOTE
  6751       TO DFHEIV11
  6752*    MOVE '&"IL       EU         (  N#00006449' TO DFHEIV0
  6753     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6754     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6755     MOVE X'204E233030303036343439' TO DFHEIV0(25:11)
  6756     CALL 'kxdfhei1' USING DFHEIV0,
  6757           WS-ERNOTE-FILE-ID,
  6758           CERTIFICATE-NOTE,
  6759           DFHEIV11,
  6760           WS-ERNOTE-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL6318.cbl
  6761           DFHEIV99,
  6762           DFHEIV99,
  6763           DFHEIV99
  6764     MOVE EIBRESP  TO WS-RESPONSE
  6765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6766
  6767     IF RESP-NORMAL
  6768       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  6769          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6770       END-IF
  6771       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6772          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6773       END-IF
  6774       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6775           (NOTE-SUB > +10) OR
  6776           (CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE)
  6777       END-PERFORM
  6778       IF CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE
  6779
  6780* EXEC CICS UNLOCK
  6781*           DATASET    (WS-ERNOTE-FILE-ID)
  6782*        END-EXEC
  6783*    MOVE '&*                    #   #00006469' TO DFHEIV0
  6784     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6785     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6786     MOVE X'2020233030303036343639' TO DFHEIV0(25:11)
  6787     CALL 'kxdfhei1' USING DFHEIV0,
  6788           WS-ERNOTE-FILE-ID,
  6789           DFHEIV99
  6790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6791       ELSE
  6792         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6793           (NOTE-SUB > +10) OR
  6794           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6795         END-PERFORM
  6796         IF (NOTE-SUB < +11)
  6797           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6798              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6799                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6800           ELSE
  6801             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6802              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  6803                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6804                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6805             ELSE
  6806               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6807                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6808                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6809                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6810               ELSE
  6811                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6812                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6813                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6814                                       CN-BILLING-START-LINE-NO
  6815                 ELSE
  6816                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6817                 END-IF
  6818               END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL6318.cbl
  6819             END-IF
  6820           END-IF
  6821           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6822           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6823           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6824
  6825* EXEC CICS REWRITE
  6826*             DATASET    (WS-ERNOTE-FILE-ID)
  6827*             FROM       (CERTIFICATE-NOTE)
  6828*             RESP       (WS-RESPONSE)
  6829*          END-EXEC
  6830     MOVE LENGTH OF
  6831      CERTIFICATE-NOTE
  6832       TO DFHEIV11
  6833*    MOVE '&& L                  %  N#00006505' TO DFHEIV0
  6834     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6835     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6836     MOVE X'204E233030303036353035' TO DFHEIV0(25:11)
  6837     CALL 'kxdfhei1' USING DFHEIV0,
  6838           WS-ERNOTE-FILE-ID,
  6839           CERTIFICATE-NOTE,
  6840           DFHEIV11,
  6841           DFHEIV99
  6842     MOVE EIBRESP  TO WS-RESPONSE
  6843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6844           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6845         END-IF
  6846       END-IF
  6847     ELSE
  6848        MOVE SPACES              TO CERTIFICATE-NOTE
  6849        MOVE 'CN'                TO CN-RECORD-ID
  6850        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6851                                     WS-ERNOTE-KEY
  6852        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6853                                    CN-BILLING-END-LINE-NO
  6854        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  6855        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6856        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6857        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6858
  6859* EXEC CICS WRITE
  6860*          DATASET    (WS-ERNOTE-FILE-ID)
  6861*          FROM       (CERTIFICATE-NOTE)
  6862*          RIDFLD     (WS-ERNOTE-KEY)
  6863*          RESP       (WS-RESPONSE)
  6864*       END-EXEC
  6865     MOVE LENGTH OF
  6866      CERTIFICATE-NOTE
  6867       TO DFHEIV11
  6868*    MOVE '&$ L                  ''  N#00006524' TO DFHEIV0
  6869     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6870     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6871     MOVE X'204E233030303036353234' TO DFHEIV0(25:11)
  6872     CALL 'kxdfhei1' USING DFHEIV0,
  6873           WS-ERNOTE-FILE-ID,
  6874           CERTIFICATE-NOTE,
  6875           DFHEIV11,
  6876           WS-ERNOTE-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL6318.cbl
  6877           DFHEIV99,
  6878           DFHEIV99
  6879     MOVE EIBRESP  TO WS-RESPONSE
  6880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6881
  6882        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6883     END-IF
  6884
  6885     .
  6886 0440-EXIT.
  6887     EXIT.
  6888
  6889
  6890 0442-SQUEEZE-IT-IN.
  6891
  6892     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  6893        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  6894           NOTE-SUB = +10
  6895           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  6896           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  6897             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  6898             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  6899             MOVE +9 TO NOTE-SUB
  6900           END-IF
  6901        END-PERFORM
  6902     ELSE
  6903        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  6904           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  6905             UNTIL NOTE-SUB = +1
  6906             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  6907             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  6908                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  6909                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  6910                MOVE +2          TO NOTE-SUB
  6911             END-IF
  6912           END-PERFORM
  6913        END-IF
  6914     END-IF
  6915
  6916     .
  6917 0442-EXIT.
  6918     EXIT.
  6919
  6920 0445-CERTIFICATE-UPDATE.
  6921    display 'billing note written, updating cert'
  6922     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  6923     IF RESP-NORMAL
  6924        EVALUATE CM-NOTE-SW
  6925           WHEN '2'
  6926           WHEN '3'
  6927           WHEN '6'
  6928           WHEN '7'
  6929              SET NO-CERT-RW     TO TRUE
  6930           WHEN ' '
  6931              MOVE '2'           TO CM-NOTE-SW
  6932           WHEN '1'
  6933              MOVE '3'           TO CM-NOTE-SW
  6934           WHEN '4'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL6318.cbl
  6935              MOVE '6'           TO CM-NOTE-SW
  6936           WHEN '5'
  6937              MOVE '7'           TO CM-NOTE-SW
  6938        END-EVALUATE
  6939     END-IF
  6940     IF NOT NO-CERT-RW
  6941        PERFORM 1810-REWRITE-ELCERT
  6942                                 THRU 1810-EXIT
  6943     ELSE
  6944
  6945* EXEC CICS UNLOCK
  6946*          DATASET    (WS-ELCERT-FILE-ID)
  6947*       END-EXEC
  6948*    MOVE '&*                    #   #00006593' TO DFHEIV0
  6949     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6950     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6951     MOVE X'2020233030303036353933' TO DFHEIV0(25:11)
  6952     CALL 'kxdfhei1' USING DFHEIV0,
  6953           WS-ELCERT-FILE-ID,
  6954           DFHEIV99
  6955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6956     END-IF
  6957
  6958     .
  6959 0445-EXIT.
  6960     EXIT.
  6961
  6962 0450-GET-ERACCT.
  6963     MOVE ' '                    TO WS-ERACCT-SW
  6964     MOVE ZEROS                  TO WS-CHGBACK
  6965                                    WS-CSO-PORTION
  6966                                    WS-ACCT-PORTION
  6967                                    WS-DIFF
  6968     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  6969     IF RESP-NORMAL
  6970        PERFORM 0470-READNEXT-ERACCT
  6971                                 THRU 0470-EXIT
  6972     END-IF
  6973     IF RESP-NORMAL
  6974        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  6975           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  6976              AND >= AM-EFFECTIVE-DT
  6977              SET ACCT-FOUND TO TRUE
  6978           ELSE
  6979              PERFORM 0470-READNEXT-ERACCT
  6980                                 THRU 0470-EXIT
  6981              IF RESP-NORMAL
  6982                 IF AM-CONTROL-PRIMARY (1:20)
  6983                    = EN-CONTROL-PRIMARY (1:20)
  6984                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  6985                       AND >= AM-EFFECTIVE-DT
  6986                       SET ACCT-FOUND TO TRUE
  6987                    END-IF
  6988                 END-IF
  6989              END-IF
  6990           END-IF
  6991        END-IF
  6992     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL6318.cbl
  6993     IF ACCT-FOUND
  6994        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6995           (AM-COM-TYP (S1) = 'C' OR 'D')
  6996           OR (S1 > +10)
  6997        END-PERFORM
  6998        IF S1 < +11
  6999           MOVE AM-COMM-CHARGEBACK (S1)
  7000                                 TO WS-CHGBACK
  7001        END-IF
  7002     END-IF
  7003    .
  7004 0450-EXIT.
  7005     EXIT.
  7006 0460-STARTBR-ERACCT.
  7007     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7008     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7009     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7010
  7011* EXEC CICS STARTBR
  7012*        DATASET   ('ERACCT')
  7013*        RIDFLD    (WS-ERACCT-KEY)
  7014*        GTEQ
  7015*        RESP      (WS-RESPONSE)
  7016*    END-EXEC
  7017     MOVE 'ERACCT' TO DFHEIV1
  7018     MOVE 0
  7019       TO DFHEIV11
  7020*    MOVE '&,         G          &  N#00006650' TO DFHEIV0
  7021     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7022     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7023     MOVE X'204E233030303036363530' TO DFHEIV0(25:11)
  7024     CALL 'kxdfhei1' USING DFHEIV0,
  7025           DFHEIV1,
  7026           WS-ERACCT-KEY,
  7027           DFHEIV99,
  7028           DFHEIV11,
  7029           DFHEIV99
  7030     MOVE EIBRESP  TO WS-RESPONSE
  7031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7032     .
  7033 0460-EXIT.
  7034     EXIT.
  7035 0470-READNEXT-ERACCT.
  7036
  7037* EXEC CICS READNEXT
  7038*       INTO    (ACCOUNT-MASTER)
  7039*       DATASET ('ERACCT')
  7040*       RIDFLD  (WS-ERACCT-KEY)
  7041*       RESP    (WS-RESPONSE)
  7042*    END-EXEC
  7043     MOVE LENGTH OF
  7044      ACCOUNT-MASTER
  7045       TO DFHEIV12
  7046     MOVE 'ERACCT' TO DFHEIV1
  7047     MOVE 0
  7048       TO DFHEIV11
  7049*    MOVE '&.IL                  )  N#00006660' TO DFHEIV0
  7050     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL6318.cbl
  7051     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7052     MOVE X'204E233030303036363630' TO DFHEIV0(25:11)
  7053     CALL 'kxdfhei1' USING DFHEIV0,
  7054           DFHEIV1,
  7055           ACCOUNT-MASTER,
  7056           DFHEIV12,
  7057           WS-ERACCT-KEY,
  7058           DFHEIV99,
  7059           DFHEIV11,
  7060           DFHEIV99,
  7061           DFHEIV99
  7062     MOVE EIBRESP  TO WS-RESPONSE
  7063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7064     .
  7065 0470-EXIT.
  7066     EXIT.
  7067 0500-CREATE-TEMP-STORAGE.
  7068     display ' about to write pi ' program-interface-block
  7069
  7070* EXEC CICS WRITEQ TS
  7071*        QUEUE (QID)
  7072*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7073*        LENGTH(PI-COMM-LENGTH)
  7074*    END-EXEC
  7075*    MOVE '*"                    ''   #00006671' TO DFHEIV0
  7076     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7077     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7078     MOVE X'2020233030303036363731' TO DFHEIV0(25:11)
  7079     CALL 'kxdfhei1' USING DFHEIV0,
  7080           QID,
  7081           PROGRAM-INTERFACE-BLOCK,
  7082           PI-COMM-LENGTH,
  7083           DFHEIV99,
  7084           DFHEIV99,
  7085           DFHEIV99
  7086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7087     display ' about to write map ' el631ki
  7088
  7089* EXEC CICS WRITEQ TS
  7090*        QUEUE (QID)
  7091*        FROM  (EL631KI)
  7092*        LENGTH(MAP-LENGTH)
  7093*    END-EXEC.
  7094*    MOVE '*"                    ''   #00006677' TO DFHEIV0
  7095     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7096     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7097     MOVE X'2020233030303036363737' TO DFHEIV0(25:11)
  7098     CALL 'kxdfhei1' USING DFHEIV0,
  7099           QID,
  7100           EL631KI,
  7101           MAP-LENGTH,
  7102           DFHEIV99,
  7103           DFHEIV99,
  7104           DFHEIV99
  7105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7106
  7107 0500-EXIT.
  7108      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL6318.cbl
  7109 0600-RECOVER-TEMP-STORAGE.
  7110     display ' about to recover pi '
  7111
  7112* EXEC CICS READQ TS
  7113*        QUEUE (QID)
  7114*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7115*        LENGTH(PI-COMM-LENGTH)
  7116*    END-EXEC
  7117*    MOVE '*$I    L              ''   #00006686' TO DFHEIV0
  7118     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7119     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7120     MOVE X'2020233030303036363836' TO DFHEIV0(25:11)
  7121     CALL 'kxdfhei1' USING DFHEIV0,
  7122           QID,
  7123           PROGRAM-INTERFACE-BLOCK,
  7124           PI-COMM-LENGTH,
  7125           DFHEIV99,
  7126           DFHEIV99,
  7127           DFHEIV99
  7128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7129     display ' pi ' pi-program-work-area
  7130     display ' about to recover map '
  7131
  7132* EXEC CICS READQ TS
  7133*        QUEUE (QID)
  7134*        INTO  (EL631KI)
  7135*        LENGTH(MAP-LENGTH)
  7136*    END-EXEC
  7137*    MOVE '*$I    L              ''   #00006693' TO DFHEIV0
  7138     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7139     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7140     MOVE X'2020233030303036363933' TO DFHEIV0(25:11)
  7141     CALL 'kxdfhei1' USING DFHEIV0,
  7142           QID,
  7143           EL631KI,
  7144           MAP-LENGTH,
  7145           DFHEIV99,
  7146           DFHEIV99,
  7147           DFHEIV99
  7148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7149     display ' map ' el631ki
  7150     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7151     MOVE AL-UANON            TO SIGREQA
  7152     MOVE AL-UANON            TO LTRIDA
  7153     MOVE AL-UANON            TO VOUCHA
  7154     MOVE AL-UANON            TO HLTHAPPA
  7155     MOVE AL-UANON            TO PAYEEA
  7156     IF WS-SET-CODES-MDT = 'Y'
  7157        move +1                  to s2
  7158        perform varying s1 from +1 by +5 until s1 > +60
  7159           MOVE WS-PASSED-REASON-CODES (s1:4)
  7160                                 TO reacd-in (s2)
  7161           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7162               MOVE AL-SANON     TO REACDA (S2)
  7163               MOVE +4           TO REACDL (S2)
  7164           END-IF
  7165           add +1                to s2
  7166        end-perform
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL6318.cbl
  7167        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7168     END-IF
  7169     IF CERTIDI > SPACES
  7170         MOVE AL-UANON       TO CERTIDA
  7171     END-IF
  7172
  7173     IF CRTNT1I > SPACES
  7174         MOVE AL-UANON       TO CRTNT1A
  7175     END-IF
  7176
  7177     IF CRTNT2I > SPACES
  7178         MOVE AL-UANON       TO CRTNT2A
  7179     END-IF
  7180
  7181     IF CRTNT3I > SPACES
  7182         MOVE AL-UANON       TO CRTNT3A
  7183     END-IF
  7184
  7185     IF CRTNT4I > SPACES
  7186         MOVE AL-UANON       TO CRTNT4A
  7187     END-IF
  7188
  7189     IF CRTNT5I > SPACES
  7190         MOVE AL-UANON       TO CRTNT5A
  7191     END-IF
  7192
  7193     IF CRTNT6I > SPACES
  7194         MOVE AL-UANON       TO CRTNT6A
  7195     END-IF
  7196     .
  7197 0600-EXIT.
  7198      EXIT.
  7199 0800-DELETE-TS.
  7200
  7201* EXEC CICS DELETEQ TS
  7202*        QUEUE(QID)
  7203*    END-EXEC
  7204*    MOVE '*&                    #   #00006749' TO DFHEIV0
  7205     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7206     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7207     MOVE X'2020233030303036373439' TO DFHEIV0(25:11)
  7208     CALL 'kxdfhei1' USING DFHEIV0,
  7209           QID,
  7210           DFHEIV99
  7211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7212     .
  7213 0800-EXIT.
  7214      EXIT.
  7215 1000-BUILD-ERARCH.
  7216     display ' made it to 1000 '
  7217     MOVE SPACES                 TO W-CNTL-KEY
  7218     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7219     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7220     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7221
  7222* EXEC CICS READ
  7223*         DATASET    (WS-ELCNTL-FILE-ID)
  7224*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL6318.cbl
  7225*         RIDFLD     (W-CNTL-KEY)
  7226*         UPDATE
  7227*         RESP       (WS-RESPONSE)
  7228*    END-EXEC
  7229*    MOVE '&"S        EU         (  N#00006761' TO DFHEIV0
  7230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7231     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7232     MOVE X'204E233030303036373631' TO DFHEIV0(25:11)
  7233     CALL 'kxdfhei1' USING DFHEIV0,
  7234           WS-ELCNTL-FILE-ID,
  7235           DFHEIV20,
  7236           DFHEIV99,
  7237           W-CNTL-KEY,
  7238           DFHEIV99,
  7239           DFHEIV99,
  7240           DFHEIV99
  7241     SET ADDRESS OF CONTROL-FILE TO
  7242         DFHEIV20
  7243     MOVE EIBRESP  TO WS-RESPONSE
  7244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7245     IF RESP-NORMAL
  7246        display ' good read elcntl '
  7247        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7248           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7249        END-IF
  7250        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7251        MOVE CF-CREDIT-LAST-ARCH-NUM
  7252                                 TO W-ARCH-NUMBER
  7253
  7254* EXEC CICS REWRITE
  7255*          FROM      (CONTROL-FILE)
  7256*          DATASET   (WS-ELCNTL-FILE-ID)
  7257*       END-EXEC
  7258     MOVE LENGTH OF
  7259      CONTROL-FILE
  7260       TO DFHEIV11
  7261*    MOVE '&& L                  %   #00006776' TO DFHEIV0
  7262     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7263     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7264     MOVE X'2020233030303036373736' TO DFHEIV0(25:11)
  7265     CALL 'kxdfhei1' USING DFHEIV0,
  7266           WS-ELCNTL-FILE-ID,
  7267           CONTROL-FILE,
  7268           DFHEIV11,
  7269           DFHEIV99
  7270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7271     END-IF
  7272
  7273* EXEC CICS GETMAIN
  7274*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7275*       LENGTH   (W-ARCH-LENGTH)
  7276*    END-EXEC
  7277*    MOVE '," L                  $   #00006781' TO DFHEIV0
  7278     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7279     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7280     MOVE X'2020233030303036373831' TO DFHEIV0(25:11)
  7281     CALL 'kxdfhei1' USING DFHEIV0,
  7282           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL6318.cbl
  7283           W-ARCH-LENGTH,
  7284           DFHEIV99
  7285     SET ADDRESS OF LETTER-ARCHIVE TO
  7286         DFHEIV20
  7287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7288     MOVE 'LA'                   TO LETTER-ARCHIVE
  7289     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7290                                    LA-ARCHIVE-NO-A2
  7291                                    LA-ARCHIVE-NO-A3
  7292                                    LA-ARCHIVE-NO-A4
  7293                                    LA-ARCHIVE-NO-A5
  7294                                    LA-ARCHIVE-NO-A6
  7295     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7296                                    LA-COMPANY-CD-A2
  7297                                    LA-COMPANY-CD-A3
  7298                                    LA-COMPANY-CD-A4
  7299                                    LA-COMPANY-CD-A5
  7300                                    LA-COMPANY-CD-A6
  7301     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7302                                    LA-CARRIER-A3
  7303                                    LA-CARRIER-A4
  7304                                    LA-CARRIER-A5
  7305     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7306     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7307                                    LA-GROUPING-A3
  7308                                    LA-GROUPING-A4
  7309                                    LA-GROUPING-A5
  7310     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7311                                    LA-ACCOUNT-A3
  7312                                    LA-ACCOUNT-A4
  7313                                    LA-ACCOUNT-A5
  7314     MOVE PB-STATE               TO LA-STATE-A2
  7315                                    LA-STATE-A3
  7316                                    LA-STATE-A4
  7317                                    LA-STATE-A5
  7318     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7319     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7320     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7321     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7322     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7323                                    LA-INITIAL-PRINT-DATE
  7324                                    LA-SENT-DATE
  7325                                    LA-REPLY-DATE
  7326                                    LA-RESEND-DATE
  7327                                    LA-FOLLOW-UP-DATE
  7328     MOVE 'A'                    TO LA-STATUS
  7329     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7330     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7331     MOVE LTRIDI                 TO LA-FORM-A3
  7332     MOVE '4'                    TO LA-DATA-SOURCE
  7333     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7334     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7335                                    LA-NO-OF-TEXT-RECORDS
  7336
  7337* EXEC CICS WRITE
  7338*         DATASET   ('ERARCH')
  7339*         FROM      (LETTER-ARCHIVE)
  7340*         RIDFLD    (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL6318.cbl
  7341*         RESP      (WS-RESPONSE)
  7342*    END-EXEC
  7343     MOVE LENGTH OF
  7344      LETTER-ARCHIVE
  7345       TO DFHEIV11
  7346     MOVE 'ERARCH' TO DFHEIV1
  7347*    MOVE '&$ L                  ''  N#00006833' TO DFHEIV0
  7348     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7349     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7350     MOVE X'204E233030303036383333' TO DFHEIV0(25:11)
  7351     CALL 'kxdfhei1' USING DFHEIV0,
  7352           DFHEIV1,
  7353           LETTER-ARCHIVE,
  7354           DFHEIV11,
  7355           LA-CONTROL-PRIMARY,
  7356           DFHEIV99,
  7357           DFHEIV99
  7358     MOVE EIBRESP  TO WS-RESPONSE
  7359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7360     IF RESP-NORMAL
  7361        display ' good write erarch '
  7362        MOVE ER-0280             TO EMI-ERROR
  7363        MOVE -1                  TO SIGREQL
  7364        PERFORM 9900-ERROR-FORMAT
  7365                                 THRU 9900-EXIT
  7366        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7367        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7368     ELSE
  7369        MOVE ER-7345             TO EMI-ERROR
  7370        MOVE -1                  TO SIGREQL
  7371        PERFORM 9900-ERROR-FORMAT
  7372                                 THRU 9900-EXIT
  7373     END-IF
  7374     .
  7375 1000-EXIT.
  7376     EXIT.
  7377 1100-CALL-NS-BUS-LOGIC.
  7378     DISPLAY ' MADE IT TO 1100 '
  7379     MOVE SPACES                 TO BL-INPUT
  7380     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7381     MOVE '4'                    TO BL-DATA-SRCE
  7382     MOVE PB-CARRIER             TO BL-CARRIER
  7383     MOVE PB-GROUPING            TO BL-GROUP
  7384     MOVE PB-STATE               TO BL-STATE
  7385     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7386     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7387        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7388        MOVE ' '                 TO DC-OPTION-CODE
  7389        PERFORM 9700-date-link
  7390        IF NO-CONVERSION-ERROR
  7391           MOVE DC-GREG-DATE-B-EDIT
  7392                                 TO BL-EFF-DT
  7393        END-IF
  7394     END-IF
  7395     MOVE PB-CERT-NO             TO BL-CERT-NO
  7396     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7397     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7398     MOVE SPACES                 TO BL-RESP-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL6318.cbl
  7399     MOVE LTRIDI                 TO BL-LETTER-ID
  7400     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7401     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7402*    MOVE 'ALWA'                 TO BL-PROC-ID
  7403     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7404*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7405*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7406     IF EIBAID = DFHPF2
  7407        MOVE 'B'                 TO BL-WRITE-ERARCH
  7408     ELSE
  7409        MOVE 'T'                 TO BL-WRITE-ERARCH
  7410     END-IF
  7411     MOVE CERTIDI                TO BL-CERT-FORM-ID
  7412     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7413        IF REACD-IN (S1) NOT = LOW-VALUES
  7414           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7415        END-IF
  7416     END-PERFORM
  7417    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7418*****************************************
  7419* Invoke the LETTER business logic
  7420*****************************************
  7421
  7422* exec cics link
  7423*       program('NSRASBL')
  7424*       commarea(srch-commarea)
  7425*    end-exec.
  7426     MOVE LENGTH OF
  7427      srch-commarea
  7428       TO DFHEIV11
  7429     MOVE 'NSRASBL' TO DFHEIV1
  7430*    MOVE '."C                   ''   #00006900' TO DFHEIV0
  7431     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7432     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7433     MOVE X'2020233030303036393030' TO DFHEIV0(25:11)
  7434     CALL 'kxdfhei1' USING DFHEIV0,
  7435           DFHEIV1,
  7436           srch-commarea,
  7437           DFHEIV11,
  7438           DFHEIV99,
  7439           DFHEIV99,
  7440           DFHEIV99
  7441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7442
  7443     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7444        BL-MESSAGE
  7445     .
  7446 1100-EXIT.
  7447     EXIT.
  7448 1500-GET-ARCH-NO.
  7449     display ' made it to 1500 '
  7450     MOVE SPACES                 TO ELCNTL-KEY
  7451     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7452     MOVE '1'                    TO CNTL-REC-TYPE
  7453     MOVE ZEROS                  TO CNTL-SEQ
  7454
  7455* EXEC CICS READ
  7456*         DATASET    (WS-ELCNTL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL6318.cbl
  7457*         SET        (ADDRESS OF CONTROL-FILE)
  7458*         RIDFLD     (ELCNTL-KEY)
  7459*         UPDATE
  7460*         RESP       (WS-RESPONSE)
  7461*    END-EXEC
  7462*    MOVE '&"S        EU         (  N#00006915' TO DFHEIV0
  7463     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7464     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7465     MOVE X'204E233030303036393135' TO DFHEIV0(25:11)
  7466     CALL 'kxdfhei1' USING DFHEIV0,
  7467           WS-ELCNTL-FILE-ID,
  7468           DFHEIV20,
  7469           DFHEIV99,
  7470           ELCNTL-KEY,
  7471           DFHEIV99,
  7472           DFHEIV99,
  7473           DFHEIV99
  7474     SET ADDRESS OF CONTROL-FILE TO
  7475         DFHEIV20
  7476     MOVE EIBRESP  TO WS-RESPONSE
  7477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7478     IF RESP-NORMAL
  7479        display ' good read elcntl '
  7480        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7481           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7482        END-IF
  7483        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7484        MOVE CF-CREDIT-LAST-ARCH-NUM
  7485                                 TO W-ARCH-NUMBER
  7486        display ' new arch number ' w-arch-number
  7487
  7488* EXEC CICS REWRITE
  7489*          FROM      (CONTROL-FILE)
  7490*          DATASET   (WS-ELCNTL-FILE-ID)
  7491*       END-EXEC
  7492     MOVE LENGTH OF
  7493      CONTROL-FILE
  7494       TO DFHEIV11
  7495*    MOVE '&& L                  %   #00006931' TO DFHEIV0
  7496     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7498     MOVE X'2020233030303036393331' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0,
  7500           WS-ELCNTL-FILE-ID,
  7501           CONTROL-FILE,
  7502           DFHEIV11,
  7503           DFHEIV99
  7504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7505     END-IF
  7506     .
  7507 1500-EXIT.
  7508     EXIT.
  7509
  7510
  7511 1700-WRITE-CERT-NOTE      SECTION.
  7512
  7513     display 'made it to 1700-'
  7514     MOVE 'CZ'                   TO CERT-NOTE-FILE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL6318.cbl
  7515     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  7516     MOVE PI-CRTO-CARRIER        TO CZ-CARRIER
  7517     MOVE PI-CRTO-GROUPING       TO CZ-GROUPING
  7518     MOVE PI-CRTO-STATE          TO CZ-STATE
  7519     MOVE PI-CRTO-ACCOUNT        TO CZ-ACCOUNT
  7520     MOVE PI-CRTO-CERT-EFF-DT    TO CZ-CERT-EFF-DT
  7521     MOVE PI-CRTO-CERT-PRIME     TO CZ-CERT-PRIME
  7522     MOVE PI-CRTO-CERT-SFX       TO CZ-CERT-SFX
  7523     MOVE '1'                    TO CZ-RECORD-TYPE
  7524     MOVE +1                     TO CZ-NOTE-SEQUENCE
  7525
  7526     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  7527     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  7528     MOVE WS-CURRENT-BIN-DT      TO CZ-LAST-MAINT-DT
  7529     MOVE WS-CERT-NOTE           TO CZ-NOTE
  7530
  7531     MOVE ' '                    TO WS-STOP-SW
  7532    display 'about to write cert note ' cert-note-file
  7533     PERFORM UNTIL I-SAY-TO-STOP
  7534
  7535* EXEC CICS WRITE
  7536*           FROM      (CERT-NOTE-FILE)
  7537*           DATASET   (WS-ERCNOT-FILE-ID)
  7538*           RIDFLD    (CZ-CONTROL-PRIMARY)
  7539*           RESP      (WS-RESPONSE)
  7540*       END-EXEC
  7541     MOVE LENGTH OF
  7542      CERT-NOTE-FILE
  7543       TO DFHEIV11
  7544*    MOVE '&$ L                  ''  N#00006964' TO DFHEIV0
  7545     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7546     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7547     MOVE X'204E233030303036393634' TO DFHEIV0(25:11)
  7548     CALL 'kxdfhei1' USING DFHEIV0,
  7549           WS-ERCNOT-FILE-ID,
  7550           CERT-NOTE-FILE,
  7551           DFHEIV11,
  7552           CZ-CONTROL-PRIMARY,
  7553           DFHEIV99,
  7554           DFHEIV99
  7555     MOVE EIBRESP  TO WS-RESPONSE
  7556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7557        IF RESP-DUPREC
  7558           ADD +1                TO CZ-NOTE-SEQUENCE
  7559        ELSE
  7560           SET I-SAY-TO-STOP     TO TRUE
  7561        END-IF
  7562     END-PERFORM
  7563
  7564     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7565     IF RESP-NORMAL
  7566        EVALUATE CM-NOTE-SW
  7567           WHEN '1'
  7568           WHEN '3'
  7569           WHEN '5'
  7570           WHEN '7'
  7571              SET NO-CERT-RW     TO TRUE
  7572           WHEN ' '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL6318.cbl
  7573              MOVE '1'           TO CM-NOTE-SW
  7574           WHEN '2'
  7575              MOVE '3'           TO CM-NOTE-SW
  7576           WHEN '4'
  7577              MOVE '5'           TO CM-NOTE-SW
  7578           WHEN '6'
  7579              MOVE '7'           TO CM-NOTE-SW
  7580        END-EVALUATE
  7581     END-IF
  7582     IF NOT NO-CERT-RW
  7583        PERFORM 1810-REWRITE-ELCERT
  7584                                 THRU 1810-EXIT
  7585     ELSE
  7586
  7587* EXEC CICS UNLOCK
  7588*          DATASET    (WS-ELCERT-FILE-ID)
  7589*       END-EXEC
  7590*    MOVE '&*                    #   #00006999' TO DFHEIV0
  7591     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7592     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7593     MOVE X'2020233030303036393939' TO DFHEIV0(25:11)
  7594     CALL 'kxdfhei1' USING DFHEIV0,
  7595           WS-ELCERT-FILE-ID,
  7596           DFHEIV99
  7597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7598     END-IF
  7599
  7600     .
  7601 1799-EXIT.
  7602     EXIT.
  7603
  7604 1800-READ-ELCERT-UPDATE.
  7605
  7606     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7607     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7608     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7609     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7610     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7611     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7612     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7613     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7614
  7615
  7616* EXEC CICS READ
  7617*        UPDATE
  7618*        DATASET  (WS-ELCERT-FILE-ID)
  7619*        RIDFLD   (WS-ELCERT-KEY)
  7620*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7621*        RESP     (WS-RESPONSE)
  7622*    END-EXEC
  7623*    MOVE '&"S        EU         (  N#00007019' TO DFHEIV0
  7624     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7625     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7626     MOVE X'204E233030303037303139' TO DFHEIV0(25:11)
  7627     CALL 'kxdfhei1' USING DFHEIV0,
  7628           WS-ELCERT-FILE-ID,
  7629           DFHEIV20,
  7630           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL6318.cbl
  7631           WS-ELCERT-KEY,
  7632           DFHEIV99,
  7633           DFHEIV99,
  7634           DFHEIV99
  7635     SET ADDRESS OF CERTIFICATE-MASTER TO
  7636         DFHEIV20
  7637     MOVE EIBRESP  TO WS-RESPONSE
  7638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7639
  7640     .
  7641 1800-EXIT.
  7642     EXIT.
  7643
  7644 1810-REWRITE-ELCERT.
  7645
  7646
  7647* EXEC CICS REWRITE
  7648*        FROM     (CERTIFICATE-MASTER)
  7649*        DATASET  (WS-ELCERT-FILE-ID)
  7650*        RESP     (WS-RESPONSE)
  7651*    END-EXEC.
  7652     MOVE LENGTH OF
  7653      CERTIFICATE-MASTER
  7654       TO DFHEIV11
  7655*    MOVE '&& L                  %  N#00007033' TO DFHEIV0
  7656     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7657     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7658     MOVE X'204E233030303037303333' TO DFHEIV0(25:11)
  7659     CALL 'kxdfhei1' USING DFHEIV0,
  7660           WS-ELCERT-FILE-ID,
  7661           CERTIFICATE-MASTER,
  7662           DFHEIV11,
  7663           DFHEIV99
  7664     MOVE EIBRESP  TO WS-RESPONSE
  7665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7666
  7667
  7668     .
  7669 1810-EXIT.
  7670     EXIT.
  7671
  7672 8100-SEND-INITIAL-MAP.
  7673     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7674     MOVE '5'                    TO DC-OPTION-CODE.
  7675     PERFORM 9700-DATE-LINK.
  7676     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7677     MOVE EIBTIME                TO TIME-IN.
  7678     MOVE TIME-OUT               TO TIMEO.
  7679     MOVE -1                     TO SIGREQL
  7680     IF PI-PROCESSOR-IS-CSR-SUPER
  7681        perform varying s1 from +1 by +1 until
  7682           s1 > +12
  7683           MOVE AL-UANON            TO reacda (s1)
  7684        end-perform
  7685     END-IF
  7686     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  7687     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  7688
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL6318.cbl
  7689* EXEC CICS SEND
  7690*        MAP      (MAP-NAME)
  7691*        MAPSET   (MAPSET-NAME)
  7692*        FROM     (EL631KO)
  7693*        ERASE
  7694*        CURSOR
  7695*    END-EXEC.
  7696     MOVE LENGTH OF
  7697      EL631KO
  7698       TO DFHEIV12
  7699     MOVE -1
  7700       TO DFHEIV11
  7701*    MOVE '8$     CT  E    H L F ,   #00007059' TO DFHEIV0
  7702     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7703     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7704     MOVE X'2020233030303037303539' TO DFHEIV0(25:11)
  7705     CALL 'kxdfhei1' USING DFHEIV0,
  7706           MAP-NAME,
  7707           EL631KO,
  7708           DFHEIV12,
  7709           MAPSET-NAME,
  7710           DFHEIV99,
  7711           DFHEIV99,
  7712           DFHEIV99,
  7713           DFHEIV11,
  7714           DFHEIV99,
  7715           DFHEIV99,
  7716           DFHEIV99
  7717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7718
  7719     GO TO 9100-RETURN-TRAN.
  7720 8200-SEND-DATAONLY.
  7721     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7722     MOVE '5'                    TO DC-OPTION-CODE.
  7723     PERFORM 9700-DATE-LINK.
  7724     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7725     MOVE EIBTIME                TO TIME-IN.
  7726     MOVE TIME-OUT               TO TIMEO.
  7727     MOVE -1                     TO PFENTRL
  7728     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  7729     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  7730
  7731* EXEC CICS SEND
  7732*        MAP      (MAP-NAME)
  7733*        MAPSET   (MAPSET-NAME)
  7734*        FROM     (EL631KO)
  7735*        DATAONLY
  7736*        ERASEAUP
  7737*        CURSOR
  7738*    END-EXEC.
  7739     MOVE LENGTH OF
  7740      EL631KO
  7741       TO DFHEIV12
  7742     MOVE -1
  7743       TO DFHEIV11
  7744*    MOVE '8$D    CT  A    H L F ,   #00007077' TO DFHEIV0
  7745     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  7746     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL6318.cbl
  7747     MOVE X'2020233030303037303737' TO DFHEIV0(25:11)
  7748     CALL 'kxdfhei1' USING DFHEIV0,
  7749           MAP-NAME,
  7750           EL631KO,
  7751           DFHEIV12,
  7752           MAPSET-NAME,
  7753           DFHEIV99,
  7754           DFHEIV99,
  7755           DFHEIV99,
  7756           DFHEIV11,
  7757           DFHEIV99,
  7758           DFHEIV99,
  7759           DFHEIV99
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7761
  7762     GO TO 9100-RETURN-TRAN.
  7763 8300-SEND-TEXT.
  7764
  7765* EXEC CICS SEND TEXT
  7766*        FROM     (LOGOFF-TEXT)
  7767*        LENGTH   (LOGOFF-LENGTH)
  7768*        ERASE
  7769*        FREEKB
  7770*    END-EXEC.
  7771*    MOVE '8&      T  E F  H   F -   #00007087' TO DFHEIV0
  7772     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  7773     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  7774     MOVE X'2020233030303037303837' TO DFHEIV0(25:11)
  7775     CALL 'kxdfhei1' USING DFHEIV0,
  7776           LOGOFF-TEXT,
  7777           LOGOFF-LENGTH,
  7778           DFHEIV99,
  7779           DFHEIV99,
  7780           DFHEIV99,
  7781           DFHEIV99,
  7782           DFHEIV99,
  7783           DFHEIV99,
  7784           DFHEIV99,
  7785           DFHEIV99,
  7786           DFHEIV99,
  7787           DFHEIV99
  7788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7789
  7790
  7791* EXEC CICS RETURN
  7792*    END-EXEC.
  7793*    MOVE '.(                    &   #00007093' TO DFHEIV0
  7794     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7795     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7796     MOVE X'2020233030303037303933' TO DFHEIV0(25:11)
  7797     CALL 'kxdfhei1' USING DFHEIV0,
  7798           DFHEIV99,
  7799           DFHEIV99,
  7800           DFHEIV99,
  7801           DFHEIV99,
  7802           DFHEIV99
  7803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7804
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL6318.cbl
  7805 8800-UNAUTHORIZED-ACCESS.
  7806     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  7807     GO TO 8300-SEND-TEXT.
  7808 8810-PF23.
  7809     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  7810     MOVE XCTL-005               TO PGM-NAME.
  7811     GO TO 9300-XCTL.
  7812 9000-RETURN-CICS.
  7813
  7814* EXEC CICS RETURN
  7815*    END-EXEC.
  7816*    MOVE '.(                    &   #00007103' TO DFHEIV0
  7817     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7819     MOVE X'2020233030303037313033' TO DFHEIV0(25:11)
  7820     CALL 'kxdfhei1' USING DFHEIV0,
  7821           DFHEIV99,
  7822           DFHEIV99,
  7823           DFHEIV99,
  7824           DFHEIV99,
  7825           DFHEIV99
  7826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7827
  7828 9100-RETURN-TRAN.
  7829     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  7830     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  7831
  7832* EXEC CICS RETURN
  7833*        TRANSID    (TRANS-ID)
  7834*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7835*        LENGTH     (PI-COMM-LENGTH)
  7836*    END-EXEC.
  7837*    MOVE '.(CT                  &   #00007108' TO DFHEIV0
  7838     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  7839     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7840     MOVE X'2020233030303037313038' TO DFHEIV0(25:11)
  7841     CALL 'kxdfhei1' USING DFHEIV0,
  7842           TRANS-ID,
  7843           PROGRAM-INTERFACE-BLOCK,
  7844           PI-COMM-LENGTH,
  7845           DFHEIV99,
  7846           DFHEIV99
  7847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7848
  7849 9200-RETURN-MAIN-MENU.
  7850     MOVE XCTL-626               TO PGM-NAME.
  7851     GO TO 9300-XCTL.
  7852 9300-XCTL.
  7853
  7854* EXEC CICS XCTL
  7855*        PROGRAM    (PGM-NAME)
  7856*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7857*        LENGTH     (PI-COMM-LENGTH)
  7858*    END-EXEC.
  7859*    MOVE '.$C                   $   #00007117' TO DFHEIV0
  7860     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7861     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7862     MOVE X'2020233030303037313137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL6318.cbl
  7863     CALL 'kxdfhei1' USING DFHEIV0,
  7864           PGM-NAME,
  7865           PROGRAM-INTERFACE-BLOCK,
  7866           PI-COMM-LENGTH
  7867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7868
  7869 9400-CLEAR.
  7870     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  7871
  7872* EXEC CICS XCTL
  7873*        PROGRAM    (PGM-NAME)
  7874*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7875*        LENGTH     (PI-COMM-LENGTH)
  7876*    END-EXEC.
  7877*    MOVE '.$C                   $   #00007124' TO DFHEIV0
  7878     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7880     MOVE X'2020233030303037313234' TO DFHEIV0(25:11)
  7881     CALL 'kxdfhei1' USING DFHEIV0,
  7882           PGM-NAME,
  7883           PROGRAM-INTERFACE-BLOCK,
  7884           PI-COMM-LENGTH
  7885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7886
  7887 9500-PF12.
  7888     MOVE XCTL-010               TO PGM-NAME.
  7889     GO TO 9300-XCTL.
  7890 9600-PGMID-ERROR.
  7891
  7892* EXEC CICS HANDLE CONDITION
  7893*        PGMIDERR    (8300-SEND-TEXT)
  7894*    END-EXEC.
  7895*    MOVE '"$L                   ! " #00007133' TO DFHEIV0
  7896     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  7897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7898     MOVE X'2220233030303037313333' TO DFHEIV0(25:11)
  7899     CALL 'kxdfhei1' USING DFHEIV0
  7900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7901
  7902     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  7903     MOVE ' '                    TO PI-ENTRY-CD-1.
  7904     MOVE XCTL-005               TO PGM-NAME.
  7905     MOVE PGM-NAME               TO LOGOFF-PGM.
  7906     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  7907     GO TO 9300-XCTL.
  7908 9700-DATE-LINK.
  7909     MOVE LINK-ELDATCV           TO PGM-NAME.
  7910
  7911* EXEC CICS LINK
  7912*        PROGRAM    (PGM-NAME)
  7913*        COMMAREA   (DATE-CONVERSION-DATA)
  7914*        LENGTH     (DC-COMM-LENGTH)
  7915*    END-EXEC.
  7916*    MOVE '."C                   ''   #00007144' TO DFHEIV0
  7917     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7918     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7919     MOVE X'2020233030303037313434' TO DFHEIV0(25:11)
  7920     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL6318.cbl
  7921           PGM-NAME,
  7922           DATE-CONVERSION-DATA,
  7923           DC-COMM-LENGTH,
  7924           DFHEIV99,
  7925           DFHEIV99,
  7926           DFHEIV99
  7927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7928
  7929 9900-ERROR-FORMAT.
  7930     IF NOT EMI-ERRORS-COMPLETE
  7931        MOVE LINK-001            TO PGM-NAME
  7932
  7933* EXEC CICS LINK
  7934*           PROGRAM    (PGM-NAME)
  7935*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  7936*           LENGTH     (EMI-COMM-LENGTH)
  7937*       END-EXEC
  7938*    MOVE '."C                   ''   #00007152' TO DFHEIV0
  7939     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7940     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7941     MOVE X'2020233030303037313532' TO DFHEIV0(25:11)
  7942     CALL 'kxdfhei1' USING DFHEIV0,
  7943           PGM-NAME,
  7944           ERROR-MESSAGE-INTERFACE-BLOCK,
  7945           EMI-COMM-LENGTH,
  7946           DFHEIV99,
  7947           DFHEIV99,
  7948           DFHEIV99
  7949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7950     END-IF
  7951     .
  7952 9900-EXIT.
  7953     EXIT.
  7954 9990-ABEND.
  7955     MOVE LINK-004               TO PGM-NAME.
  7956     MOVE DFHEIBLK               TO EMI-LINE1.
  7957
  7958* EXEC CICS LINK
  7959*        PROGRAM   (PGM-NAME)
  7960*        COMMAREA  (EMI-LINE1)
  7961*        LENGTH    (72)
  7962*    END-EXEC.
  7963     MOVE 72
  7964       TO DFHEIV11
  7965*    MOVE '."C                   ''   #00007164' TO DFHEIV0
  7966     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7967     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7968     MOVE X'2020233030303037313634' TO DFHEIV0(25:11)
  7969     CALL 'kxdfhei1' USING DFHEIV0,
  7970           PGM-NAME,
  7971           EMI-LINE1,
  7972           DFHEIV11,
  7973           DFHEIV99,
  7974           DFHEIV99,
  7975           DFHEIV99
  7976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7977
  7978     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL6318.cbl
  7979
  7980* GOBACK.
  7981     MOVE '9%                    "   ' TO DFHEIV0
  7982     MOVE 'EL6318' TO DFHEIV1
  7983     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7984     GOBACK.
  7985 9995-SECURITY-VIOLATION.
  7986*                            COPY ELCSCTP.
  7987******************************************************************
  7988*                                                                *
  7989*                            ELCSCTP                             *
  7990*                            VMOD=2.001                          *
  7991*                                                                *
  7992*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  7993******************************************************************
  7994
  7995
  7996     MOVE EIBDATE          TO SM-JUL-DATE.
  7997     MOVE EIBTRMID         TO SM-TERMID.
  7998     MOVE THIS-PGM         TO SM-PGM.
  7999     MOVE EIBTIME          TO TIME-IN.
  8000     MOVE TIME-OUT         TO SM-TIME.
  8001     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8002
  8003
  8004* EXEC CICS LINK
  8005*         PROGRAM  ('EL003')
  8006*         COMMAREA (SECURITY-MESSAGE)
  8007*         LENGTH   (80)
  8008*    END-EXEC.
  8009     MOVE 'EL003' TO DFHEIV1
  8010     MOVE 80
  8011       TO DFHEIV11
  8012*    MOVE '."C                   ''   #00007189' TO DFHEIV0
  8013     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8014     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8015     MOVE X'2020233030303037313839' TO DFHEIV0(25:11)
  8016     CALL 'kxdfhei1' USING DFHEIV0,
  8017           DFHEIV1,
  8018           SECURITY-MESSAGE,
  8019           DFHEIV11,
  8020           DFHEIV99,
  8021           DFHEIV99,
  8022           DFHEIV99
  8023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8024
  8025
  8026******************************************************************
  8027
  8028 9995-EXIT.
  8029     EXIT.
  8030
  8031 9999-DFHBACK SECTION.
  8032     MOVE '9%                    "   ' TO DFHEIV0
  8033     MOVE 'EL6318' TO DFHEIV1
  8034     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8035     GOBACK.
  8036 9999-DFHEXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL6318.cbl
  8037     IF DFHEIGDJ EQUAL 0001
  8038         NEXT SENTENCE
  8039     ELSE IF DFHEIGDJ EQUAL 2
  8040         GO TO 8300-SEND-TEXT
  8041         DEPENDING ON DFHEIGDI.
  8042     MOVE '9%                    "   ' TO DFHEIV0
  8043     MOVE 'EL6318' TO DFHEIV1
  8044     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8045     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       11284     Code:       17421
