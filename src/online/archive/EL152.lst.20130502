* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL152.cbl
* Options: int("EL152.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL152.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL152.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL152.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL152 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/14/94 08:03:40.
     7*                            VMOD=2.055.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX27 - CLAIMS LETTER WRITER.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL152.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23*                                REMOVE OBSOLETE CODE
    24* 102703                   SMVA  MOD COPY MEMBER ELCNAMET TO LEAVE
    25*                                CERTIFICATION DESIGNATION ON
    26*                                PROCESSOR NAME LINE IN CAPS
    27* 121203                   SMVA  ADD PROCESSING FOR NEW CLM TYP G
    28* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    29* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    30* 010407    2006111300003  PEMA  ADD PROCESSING FOR CARRIER 8
    31* 060109  CR2008102800002  PEMA  ADD VAR 16.1
    32* 033110  CR2009122800001  AJRA  NAPERSOFT
    33* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    34* 011212  IR2012011100002  AJRA  FIX DCC PROMPT LETTER
    35* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    36******************************************************************
    37 ENVIRONMENT DIVISION.
    38
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL152.cbl
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*    EL152 WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    46
    47*77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    48*77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    49*                                  USAGE POINTER.
    50 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    51 77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    52                                   USAGE POINTER.
    53 77  B1                          PIC S9(5) COMP-3 VALUE +0.
    54 77  S1                          PIC S9 VALUE +0.
    55 77  S2                          PIC S9 VALUE +0.
    56 01  P pointer.
    57 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    58 01  var-ptr pointer.
    59 01  env-var-len                 pic 9(4)  binary.
    60 01  rc                          pic 9(9)  binary.
    61 01  WS-KIXSYS.
    62     05  WS-KIX-FIL1             PIC X(10).
    63     05  WS-KIX-APPS             PIC X(10).
    64     05  WS-KIX-ENV              PIC X(10).
    65     05  WS-KIX-MYENV            PIC X(10).
    66     05  WS-KIX-SYS              PIC X(10).
    67 01  WS-HOLDING-ZIPS.
    68     05  FILLER              PIC X(10)  VALUE '--AM-ZIP--'.
    69     05  WS-AM-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    70     05  FILLER              PIC X(10)  VALUE '--AT-ZIP--'.
    71     05  WS-AT-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    72     05  FILLER              PIC X(10)  VALUE '--BE-ZIP--'.
    73     05  WS-BE-ZIP-CODE      PIC X(9)   VALUE 'XXXXXXXXX'.
    74     05  FILLER              PIC X(10)  VALUE '--CO-ZIP--'.
    75     05  WS-CO-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    76     05  FILLER              PIC X(17)  VALUE '--AM-ZIP-BEFORE--'.
    77     05  WS-AM-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    78     05  FILLER              PIC X(17)  VALUE '--AT-ZIP-BEFORE--'.
    79     05  WS-AT-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    80     05  FILLER              PIC X(17)  VALUE '--BE-ZIP-BEFORE--'.
    81     05  WS-BE-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    82     05  FILLER              PIC X(17)  VALUE '--CO-ZIP-BEFORE--'.
    83     05  WS-CO-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    84     05  FILLER              PIC X(17)  VALUE '-----------------'.
    85
    86*                            COPY ELCSCTM.
    87******************************************************************
    88*                                                                *
    89*                                                                *
    90*                            ELCSCTM                             *
    91*                            VMOD=2.001                          *
    92*                                                                *
    93*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-MESSAGE.
    97     12  FILLER                          PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL152.cbl
    98            VALUE '** LOGIC SECURITY VIOLATION -'.
    99     12  SM-READ                         PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' PGM='.
   102     12  SM-PGM                          PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' OPR='.
   105     12  SM-PROCESSOR-ID                 PIC X(4).
   106     12  FILLER                          PIC X(6)
   107            VALUE ' TERM='.
   108     12  SM-TERMID                       PIC X(4).
   109     12  FILLER                          PIC XX   VALUE SPACE.
   110     12  SM-JUL-DATE                     PIC 9(5).
   111     12  FILLER                          PIC X    VALUE SPACE.
   112     12  SM-TIME                         PIC 99.99.
   113
   114
   115*                            COPY ELCSCRTY.
   116******************************************************************
   117*                                                                *
   118*                                                                *
   119*                            ELCSCRTY                            *
   120*                            VMOD=2.001                          *
   121*                                                                *
   122*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   123*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   124*        SAVED IN PI-SECURITY-ADDRESS.                           *
   125*                                                                *
   126******************************************************************
   127 01  SECURITY-CONTROL.
   128     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   129     12  FILLER                       PIC XX    VALUE 'SC'.
   130     12  SC-CREDIT-CODES.
   131         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   132             20  SC-CREDIT-DISPLAY    PIC X.
   133             20  SC-CREDIT-UPDATE     PIC X.
   134     12  SC-CLAIMS-CODES.
   135         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   136             20  SC-CLAIMS-DISPLAY    PIC X.
   137             20  SC-CLAIMS-UPDATE     PIC X.
   138
   139 01  WS-DATE-AREA.
   140     12  SAVE-DATE               PIC X(08)    VALUE SPACES.
   141     12  SAVE-BIN-DATE           PIC XX       VALUE SPACES.
   142     12  W-REVERSE-DATE-SW       PIC X        VALUE SPACES.
   143         88  W-REVERSE-DATE                   VALUE 'Y'.
   144     12  W-EDIT-DATE-1.
   145         16  W-ED1-MM            PIC XX.
   146         16  FILLER              PIC X        VALUE '/'.
   147         16  W-ED1-DD            PIC XX.
   148         16  FILLER              PIC X        VALUE '/'.
   149         16  W-ED1-YY            PIC XX.
   150     12  W-EDIT-DATE-2.
   151         16  W-ED2-DD            PIC XX.
   152         16  FILLER              PIC X        VALUE '/'.
   153         16  W-ED2-MM            PIC XX.
   154         16  FILLER              PIC X        VALUE '/'.
   155         16  W-ED2-YY            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL152.cbl
   156 01  FILLER.
   157     05  WS-WORK-INT-RATE        PIC 99.999.
   158     05  WS-WORK-INT REDEFINES WS-WORK-INT-RATE
   159                                 PIC X(6).
   160 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   161     'BEGINJOB mode=''MVS'''.
   162 01  TRAN-DATA-LINE2.
   163*     05  FILLER                  PIC X(39)    VALUE
   164*     '"smtp -f EL152cl2 -t pema,kmsb,jmsb -s '.
   165     05  FILLER                  PIC X(29)    VALUE
   166     '"smtp -f EL152cl2 -t ajra -s '.
   167     05  TRAN-DETAIL.
   168         10  FILLER              PIC XX       VALUE
   169         ''' '.
   170         10  TRAN-DL2-USER       PIC X(05)    VALUE SPACES.
   171         10  TRAN-DL2-ARCHNO     PIC ZZZZ999  VALUE ZEROS.
   172         10  FILLER              PIC X        VALUE SPACES.
   173         10  TRAN-DL2-CCC        PIC X(22)    VALUE SPACES.
   174     05  FILLER                  PIC XX       VALUE '''"'.
   175     05  FILLER                  PIC X(30)    VALUE SPACES.
   176 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   177     'ENDJOB            '.
   178
   179 01  WS-PRINTER-ID               PIC X(4)    VALUE SPACES.
   180 01  STANDARD-AREAS.
   181     12  WS-ACCT-READ-SW         PIC X       VALUE ' '.
   182     12  WS-COMP-READ-SW         PIC X       VALUE ' '.
   183     12  WS-PROD-READ-SW         PIC X       VALUE ' '.
   184     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   185     12  MAP-NAME.
   186         16  MAP-PREFIX          PIC XX      VALUE 'EL'.
   187         16  MAP-NUMBER          PIC X(4)    VALUE '152A'.
   188         16  MAP-FILLER          PIC XX      VALUE SPACES.
   189     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   190     12  MAPSET-NAME             PIC X(8)    VALUE 'EL152S'.
   191     12  TRANS-ID                PIC X(4)    VALUE 'EX27'.
   192     12  PRINT-TRANS             PIC X(4)    VALUE 'EX57'.
   193     12  LGXX-ID                 PIC X(4)    VALUE 'LGXX'.
   194     12  PGM-NAME                PIC X(8).
   195     12  TIME-IN                 PIC S9(7).
   196     12  TIME-OUT-R  REDEFINES TIME-IN.
   197         16  FILLER              PIC X.
   198         16  TIME-OUT            PIC 99V99.
   199         16  FILLER              PIC XX.
   200     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   201     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   202     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   203     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   204     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   205     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   206     12  THIS-PGM                PIC X(8)    VALUE 'EL152'.
   207     12  LINK-EL1522             PIC X(8)    VALUE 'EL1522'.
   208     12  PGM-EL126               PIC X(8)    VALUE 'EL126'.
   209     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   210     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   211     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   212     12  SUB                     PIC 99.
   213     12  WS-LABELS-SW            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL152.cbl
   214
   215     12  WS-PI-QID.
   216         16  QID-TERM            PIC X(4)    VALUE SPACES.
   217         16  FILLER              PIC X(4)    VALUE '152A'.
   218
   219     12  W-LETTER-ADDRESS-TYPE.
   220         16  W-LETTER-ADDR-TYPE  PIC  X VALUE SPACES.
   221         16  W-LETTER-ADDR-SEQ   PIC  9 VALUE ZEROS.
   222
   223     12  W-ADDRESS-SELECTION.
   224         16  W-ACCOUNT           PIC  9 VALUE ZEROS.
   225         16  W-BENEFICIARY       PIC  9 VALUE ZEROS.
   226         16  W-EMPLOYER          PIC  9 VALUE ZEROS.
   227         16  W-INSURED           PIC  9 VALUE ZEROS.
   228         16  W-OTHER-1           PIC  9 VALUE ZEROS.
   229         16  W-OTHER-2           PIC  9 VALUE ZEROS.
   230         16  W-PHYSICIAN         PIC  9 VALUE ZEROS.
   231
   232     12  W-Z-CONTROL-DATA.
   233         16  W-NUMBER-OF-COPIES  PIC  9.
   234         16  FILLER              PIC  X.
   235         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   236         16  FILLER              PIC  X.
   237         16  W-DAYS-TO-RESEND-1  PIC  999.
   238         16  FILLER              PIC  X.
   239         16  W-FORM-TO-RESEND    PIC  X(4).
   240         16  FILLER              PIC  X(1).
   241         16  W-PROMPT-LETTER     PIC  X(1).
   242         16  FILLER              PIC  X(1).
   243         16  W-ENCLOSURE-CD      PIC  X(3).
   244         16  FILLER              PIC  X(1).
   245         16  W-AUTO-CLOSE-IND    PIC  X(1).
   246         16  FILLER              PIC  X(1).
   247         16  W-LETTER-TO-BENE    PIC  X(1).
   248
   249     12  W-CREDIT-CARD-LOAN-NO.
   250         16  W-LOAN-NO           PIC  X(08).
   251         16  W-CURRENT-LOAN-NO   PIC  X(12).
   252
   253     12  W-GROUPING.
   254         16  W-GROUP-3           PIC  XXX.
   255         16  FILLER              PIC  XXX.
   256
   257     12  W-NAME.
   258         16  W-FIRST-NAME        PIC  X(12).
   259         16  W-MIDDLE-NAME       PIC  X(12).
   260         16  W-LAST-NAME         PIC  X(15).
   261
   262     12  WS-PHONE-IN             PIC 9(11)   VALUE ZEROS.
   263     12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   264         16  FILLER              PIC 9.
   265         16  WSPI-AREA           PIC 9(3).
   266         16  WSPI-PFX            PIC 9(3).
   267         16  WSPI-SFX            PIC 9(4).
   268     12  WS-PHONE-OUT.
   269         16  WSPO-AREA           PIC X(3).
   270         16  FILLER              PIC X       VALUE '-'.
   271         16  WSPO-PFX            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL152.cbl
   272         16  FILLER              PIC X       VALUE '-'.
   273         16  WSPO-SFX            PIC X(4).
   274
   275     12  WS-ZIP-NUMERIC          PIC 9(9).
   276     12  WS-ZIP-NONNUM  REDEFINES  WS-ZIP-NUMERIC
   277                                 PIC X(9).
   278
   279     12  WS-ZIP-CODE.
   280         16  WS-AM-ZIP-CODE      PIC X(5).
   281         16  WS-AM-ZIP-DASH      PIC X.
   282         16  WS-AM-ZIP-PLUS4     PIC X(4).
   283     12  WS-ZIP-CODE-CANADIAN  REDEFINES  WS-ZIP-CODE.
   284         16  WS-CAN-POSTAL-1     PIC XXX.
   285         16  FILLER              PIC X.
   286         16  WS-CAN-POSTAL-2     PIC XXX.
   287         16  FILLER              PIC XXX.
   288
   289     12  WS-LABEL-HOLD-AREA.
   290         16  WS-LABEL-LINES OCCURS 6 TIMES
   291                            INDEXED BY WS-NDX  WS-NDX2.
   292             20  WS-LABEL-ZIP.
   293                 24  WS-LABEL-1ST-ZIP  PIC X(5).
   294                 24  FILLER            PIC X.
   295                 24  WS-LABEL-2ND-ZIP  PIC X(4).
   296             20  FILLER                PIC X(9).
   297             20  WS-LAST-DIGIT         PIC X.
   298             20  WS-LAST-ZIP.
   299                 24  WS-LAST-1ST-ZIP   PIC X(5).
   300                 24  FILLER            PIC X.
   301                 24  WS-LAST-2ND-ZIP   PIC X(4).
   302
   303     12  WS-DATA-FOUND-SW            PIC X.
   304         88  NO-CHARACTERS-FOUND           VALUE 'N'.
   305
   306     12  WS-SKIP-EMAIL           PIC X       VALUE 'N'.
   307     12  WS-STATE-LINE           PIC X       VALUE 'N'.
   308     12  WS-PROCESSOR-LINE       PIC X(01)   VALUE 'N'.
   309     12  WS-CAPS-SW              PIC X(01)   VALUE 'N'.
   310         88  THE-REST-R-CAPS                 VALUE 'Y'.
   311     12  WS-POSITION2            PIC S9(4)   COMP.
   312     12  WS-POSITION21           PIC S9(4)   COMP.
   313     12  WS-WORD-LENGTH          PIC S9(4)   COMP-3.
   314
   315     12  WS-TEMP-AREA1.
   316         16  WS-TEMP-1           PIC X OCCURS 29
   317                                       INDEXED BY TA1.
   318     12  WS-TEMP-AREA2.
   319         16  WS-TEMP-2           PIC X OCCURS 30
   320                                       INDEXED BY TA2
   321                                                  TA21
   322                                                  MOVE-INDX.
   323
   324     12  WS-SAVE-TEMP-AREA2      PIC X(30)   VALUE SPACES.
   325
   326     12  ACCT-BROWSE-STARTED     PIC X       VALUE 'N'.
   327     12  TEXT-BROWSE-STARTED     PIC X       VALUE 'N'.
   328     12  ARCH-BROWSE-STARTED     PIC X       VALUE 'N'.
   329     12  ACTV-BROWSE-STARTED     PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL152.cbl
   330     12  PROD-BROWSE-STARTED     PIC X       VALUE 'N'.
   331     12  INDX-WORK               PIC 99.
   332     12  TEMP-CURR-LINE          PIC S9(3)    COMP-3.
   333
   334     12  DATE-WORK               PIC 9(7).
   335     12  DT-REDEF REDEFINES DATE-WORK.
   336         16  FILLER              PIC XX.
   337         16  DT-WORK             PIC 9(5).
   338
   339     12  BEN-HOLD                PIC XX.
   340
   341     12  BENEFIT-WORK            PIC XXX.
   342     12  BEN-R REDEFINES BENEFIT-WORK.
   343         16  ELIM-DAYS           PIC XX.
   344         16  FILLER              PIC X.
   345
   346     12  GETMAIN-SWITCH          PIC 9        VALUE 0.
   347         88  NO-GETMAIN-DONE-YET              VALUE 0.
   348         88  REFRESH-GETMAIN-AREA             VALUE 1.
   349
   350     12  WORK-AMOUNT             PIC S9(9)V99 VALUE +0.
   351     12  CURRENT-SAVE            PIC XX.
   352     12  CURRENT-PLUS3-SAVE      PIC XX.
   353     12  RESEND-SAVE             PIC XX    VALUE LOW-VALUE.
   354     12  FOLLOW-UP-SAVE          PIC XX    VALUE LOW-VALUE.
   355     12  SEQ-COUNTER             PIC S9(4) COMP.
   356     12  CORR-TRLR-SEQ           PIC S9(4) COMP.
   357     12  DEEDIT-FIELD            PIC X(15).
   358     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   359
   360     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   361     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   362
   363     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   364     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   365
   366     12  WS-CCN-12               PIC X(12).
   367
   368     12  WS-ADDR-TYPE-CD.
   369         16  WS-ADDR-TYPE        PIC X.
   370         16  WS-ADDR-SEQ         PIC X.
   371         16  WS-ADDR-SEQ-NUM REDEFINES
   372             WS-ADDR-SEQ         PIC 9.
   373
   374     12  WS-DMD-CERT-STATE       PIC XX.
   375     12  WS-DMD-CERT-GROUPING    PIC XX.
   376     12  WS-DMD-BEN-CODE         PIC XX.
   377     12  WS-DMD-CORR-TRLR-SEQ    PIC S9(4) COMP.
   378     12  WS-DMD-LETTER-FORM      PIC X(4).
   379     12  WS-DMD-RES-ST           PIC XX.
   380
   381     12  WS-DMD-UND-STATEMENT    PIC X(50)  VALUE
   382          'Central States provides plan administration for'.
   383
   384     12  WS-DMD-UND-COMPANYA     PIC X(50)  VALUE
   385          'Central States Health and Life Co.'.
   386
   387     12  WS-DMD-UND-COMPANYB     PIC X(50)  VALUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL152.cbl
   388          'Central States Indemnity Co.'.
   389
   390* DLO023
   391 01  DL23-COMM-LENGTH            PIC S9(4) COMP VALUE +132.
   392 01  WS-DLO-CODES-TABLE.
   393     12  DL23-SYSTEM-ID          PIC XX.
   394     12  DL23-RECORD-TYPE        PIC XX.
   395     12  DL23-RECORD-KEY         PIC X(6).
   396     12  DL23-RETURN-CODE        PIC XX.
   397     12  DL23-CODE-DESC          PIC X(60).
   398     12  DL23-GEN-DESC-1         PIC X(20).
   399     12  DL23-GEN-DESC-2         PIC X(20).
   400     12  DL23-GEN-DESC-3         PIC X(20).
   401     12  WS-LETTER-STATUS        PIC X        VALUE ' '.
   402     12  WS-BLANK                PIC X        VALUE ' '.
   403
   404 01  WS-SAVE-ACCT-RECORD         PIC X(2000)  VALUE SPACES.
   405 01  WS-SAVE-PRODUCER-RECORD     PIC X(2000)  VALUE SPACES.
   406
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL152.cbl
   408 01  ACCESS-KEYS-AND-FILE-IDS.
   409     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   410     12  ACCT-ID                  PIC X(8)    VALUE 'ERACCT'.
   411     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   412     12  ARCH-ID                  PIC X(8)    VALUE 'ELARCH'.
   413     12  ARCT-ID                  PIC X(8)    VALUE 'ELARCT'.
   414     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   415     12  TEXT-ID                  PIC X(8)    VALUE 'ELLETR'.
   416     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   417     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   418     12  PROD-ID                  PIC X(8)    VALUE 'MPPROD'.
   419     12  PLCY-ID                  PIC X(8)    VALUE 'MPPLCY'.
   420     12  PLAN-ID                  PIC X(8)    VALUE 'MPPLAN'.
   421     12  NAPS-ID                  PIC X(8)    VALUE 'ELNAPS'.
   422
   423     12  CNTL-KEY.
   424         16  CNTL-CO              PIC X(3).
   425         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   426         16  CNTL-GENL.
   427           18 CNTL-GEN1           PIC XX      VALUE SPACES.
   428           18 CNTL-GEN2.
   429             20 CNTL-GEN3         PIC X       VALUE SPACES.
   430             20 CNTL-GEN4         PIC X       VALUE SPACES.
   431         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   432
   433      12  WS-ERCOMP-KEY.
   434          16  WS-ERCOMP-COMPANY-CD PIC X.
   435          16  WS-ERCOMP-CARRIER    PIC X.
   436          16  WS-ERCOMP-GROUPING   PIC X(6).
   437          16  WS-ERCOMP-RESP-NO    PIC X(10).
   438          16  WS-ERCOMP-ACCOUNT    PIC X(10).
   439          16  WS-ERCOMP-TYPE       PIC X.
   440
   441     12  CLAM-KEY.
   442         16  CLAM-CO              PIC X.
   443         16  CLAM-CARRIER         PIC X.
   444         16  CLAM-CLAIM           PIC X(7).
   445         16  CLAM-CERT-NUM        PIC X(11).
   446
   447     12  TEXT-KEY.
   448         16  TEXT-PARTIAL-KEY.
   449             20  TEXT-CO          PIC X.
   450             20  TEXT-LETTER      PIC X(4).
   451         16  TEXT-FILLER          PIC X(8)    VALUE SPACES.
   452         16  TEXT-SEQ             PIC S9(4)   VALUE +0    COMP.
   453
   454     12  ACTV-KEY.
   455         16  ACTV-PARTIAL-KEY.
   456             20  ACTV-CO          PIC X.
   457             20  ACTV-CARRIER     PIC X.
   458             20  ACTV-CLAIM       PIC X(7).
   459             20  ACTV-CERT-NUM    PIC X(11).
   460         16  ACTV-SEQ             PIC S9(4)   VALUE +0    COMP.
   461
   462     12  CERT-KEY.
   463         16  CERT-CO              PIC X.
   464         16  CERT-CARRIER         PIC X.
   465         16  CERT-GROUPING        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL152.cbl
   466         16  CERT-STATE           PIC XX.
   467         16  CERT-ACCOUNT         PIC X(10).
   468         16  CERT-EFF-DT          PIC XX.
   469         16  CERT-CERT-NUM        PIC X(11).
   470
   471     12  ACCT-KEY.
   472         16  ACCT-PARTIAL-KEY.
   473             20  ACCT-CO              PIC X.
   474             20  ACCT-CARRIER         PIC X.
   475             20  ACCT-GROUPING        PIC X(6).
   476             20  ACCT-STATE           PIC XX.
   477             20  ACCT-ACCOUNT         PIC X(10).
   478         16  ACCT-EXP-DATE            PIC XX.
   479
   480     12  ARCH-KEY.
   481         16  ARCH-PARTIAL-KEY.
   482             20  ARCH-CO          PIC X.
   483             20  ARCH-NUMBER      PIC S9(8)      COMP.
   484         16  ARCH-REC-TYPE        PIC X.
   485         16  ARCH-SEQ             PIC S9(4)      COMP VALUE +0.
   486
   487     12  BENE-KEY.
   488         16  BENE-COMP-CD         PIC X.
   489         16  BENE-REC-TYPE        PIC X.
   490         16  BENE-NUMBER.
   491             20  BENE-CREDITOR    PIC XXX.
   492             20  FILLER           PIC X(7).
   493
   494     12  PROD-KEY.
   495         16  PROD-PARTIAL-KEY.
   496             20  PROD-CO          PIC X.
   497             20  PROD-CARRIER     PIC X.
   498             20  PROD-GROUPING    PIC X(6).
   499             20  PROD-STATE       PIC XX.
   500             20  PROD-PRODUCER    PIC X(10).
   501         16  PROD-EXP-DATE        PIC XX.
   502
   503     12  PLCY-KEY.
   504         16  PLCY-CO              PIC X.
   505         16  PLCY-CARRIER         PIC X.
   506         16  PLCY-GROUPING        PIC X(06).
   507         16  PLCY-STATE           PIC XX.
   508         16  PLCY-PRODUCER        PIC X(10).
   509         16  PLCY-EFF-DT          PIC XX.
   510         16  PLCY-REFERENCE-NO    PIC X(20).
   511
   512     12  PLAN-KEY.
   513         16  PLAN-CO              PIC X.
   514         16  PLAN-CARRIER         PIC X.
   515         16  PLAN-GROUPING        PIC X(6).
   516         16  PLAN-STATE           PIC XX.
   517         16  PLAN-PRODUCER        PIC X(10).
   518         16  PLAN-CODE            PIC XX.
   519         16  PLAN-REV-NO          PIC 999.
   520
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL152.cbl
   522     12  ARCH-SAVE-KEY           PIC X(5).
   523     12  ACTV-SAVE-KEY           PIC X(20).
   524     12  ACCT-SAVE-KEY           PIC X(20).
   525     12  PROD-SAVE-KEY           PIC X(20).
   526     12  ACCT-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   527     12  ARCH-LENGTH             PIC S9(4)  COMP  VALUE +90.
   528     12  ARCT-LENGTH             PIC S9(4)  COMP  VALUE +90.
   529     12  ACTV-LENGTH             PIC S9(4)  COMP  VALUE +200.
   530     12  PROD-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   531     12  NAPS-LENGTH             PIC S9(4)  COMP  VALUE +150.
   532     12  TEXT-SAVE-KEY           PIC X(5).
   533     12  SAVE-VARIABLE-POINTER   PIC S9(8)   COMP.
   534     12  VAR-HOLD.
   535         16  V1                  PIC X.
   536         16  V2                  PIC X.
   537         16  V3                  PIC X.
   538         16  V4                  PIC X.
   539     12  V-HOLD REDEFINES VAR-HOLD.
   540         16  V-NUM               PIC 99.
   541         16  V-PERIOD            PIC X.
   542         16  V-DECIMAL           PIC 9.
   543
   544     12  MAX-LINES               PIC 999     VALUE 300.
   545     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 13.
   546     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   547     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0     COMP-3.
   548     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   549     12  TS-ITEM                 PIC S9(4)   VALUE +0    COMP.
   550     12  TS-MAP-LENGTH           PIC S9(4)   VALUE +1343 COMP.
   551     12  ROLL-COUNTER            PIC S999    VALUE +0    COMP-3.
   552     12  TS-NAME-TEXT.
   553         16  TS-ID-TEXT          PIC X(4)    VALUE '104A'.
   554         16  TS-ID-TIME REDEFINES TS-ID-TEXT  PIC S9(7) COMP-3.
   555         16  TS-TERM-TEXT.
   556          17 TS-TERM-PREFIX      PIC XX.
   557          17 FILLER              PIC XX.
   558     12  TS-NAME-SCREEN.
   559         16  FILLER              PIC X(4)    VALUE '152X'.
   560         16  TS-TERM-SCREEN      PIC X(4).
   561
   562     12  LINE-NUM.
   563         16  LINE1               PIC X.
   564         16  LINE23              PIC 99.
   565     12  LIN-NUM REDEFINES LINE-NUM  PIC 999.
   566     12  TOP-FORM                PIC X(70)
   567         VALUE '*****TOP OF FORM *****'.
   568     12  SINGLE-LINE             PIC X(70).
   569     12  SINGLE-LINE-BY-1 REDEFINES SINGLE-LINE.
   570         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY INDX1 INDX2
   571                                 PIC X.
   572     12  NAPERSOFT-LETTER        PIC X(16)
   573         VALUE 'Napersoft letter'.
   574
   575 01  HAN-LETTER-REASON-DATA.
   576     12  WS-REASON-TEXT.
   577         16  WS-RE-NDX           PIC 99.
   578         16  FILLER              PIC X(68).
   579
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL152.cbl
   580     12  HAN-REASON-TABLE.
   581         16  FILLER              PIC X(50) VALUE
   582           'ADDITIONAL INFO REQUESTED FROM PHYSICIAN          '.
   583         16  FILLER              PIC X(50) VALUE
   584           'CHECKING PRE-EXISTING CONDITION                   '.
   585         16  FILLER              PIC X(50) VALUE
   586           'ADDITIONAL INFO RECEIVED / CLAIM REOPENED         '.
   587         16  FILLER              PIC X(50) VALUE
   588           'LETTER TO INSURED                                 '.
   589         16  FILLER              PIC X(50) VALUE
   590           'LETTER TO CREDITOR                                '.
   591         16  FILLER              PIC X(50) VALUE
   592           'LETTER TO EMPLOYER                                '.
   593         16  FILLER              PIC X(50) VALUE
   594           'LETTER TO INSURED / 2ND REQUEST                   '.
   595         16  FILLER              PIC X(50) VALUE
   596           'LETTER TO CREDITOR / 2ND REQUEST                  '.
   597         16  FILLER              PIC X(50) VALUE
   598           'LETTER TO EMPLOYER / 2ND REQUEST                  '.
   599         16  FILLER              PIC X(50) VALUE
   600           'AWAITING INITIAL CLAIM FORM                       '.
   601         16  FILLER              PIC X(50) VALUE
   602           'AWAITING SUPPLEMENTAL INFORMATION                 '.
   603         16  FILLER              PIC X(50) VALUE
   604           'DENIED / PRE-EXISTING CONDITION                   '.
   605         16  FILLER              PIC X(50) VALUE
   606           'DENIED / WAITING PERIOD NOT MET                   '.
   607         16  FILLER              PIC X(50) VALUE
   608           'DENIED / NORMAL PREGNANCY                         '.
   609         16  FILLER              PIC X(50) VALUE
   610           'DENIED / ACT OF WAR                               '.
   611         16  FILLER              PIC X(50) VALUE
   612           'DENIED / NOT TOTALLY DISABLED                     '.
   613         16  FILLER              PIC X(50) VALUE
   614           'DENIED / NOT UNDER CARE & TREATMENT OF PHYSICIAN  '.
   615         16  FILLER              PIC X(50) VALUE
   616           'DENIED / NO COVERAGE INFORCE                      '.
   617         16  FILLER              PIC X(50) VALUE
   618           'DENIED / DISABLED ON DATE OF LOAN                 '.
   619         16  FILLER              PIC X(50) VALUE
   620           'DENIED / OVER MAXIMUM AGE                         '.
   621         16  FILLER              PIC X(50) VALUE
   622           'CLOSED / CLAIM INFO NOT PROVIDED                  '.
   623         16  FILLER              PIC X(50) VALUE
   624           'PHYSICIAN INFORMATION INCOMPLETE                  '.
   625         16  FILLER              PIC X(50) VALUE
   626           'ACKNOWLEDGEMENT LETTER TO INSURED                 '.
   627         16  FILLER              PIC X(50) VALUE
   628           'DENIED/SUICIDE EXCLUSION                          '.
   629         16  FILLER              PIC X(50) VALUE
   630           'DENIED/LOAN EFFECTIVE BEFORE POLICY EFFECTIVE DATE'.
   631         16  FILLER              PIC X(50) VALUE
   632           'DENIED/JOINT DEBTORS NOT COVERED                  '.
   633         16  FILLER              PIC X(50) VALUE
   634           'DENIED/GROUP POLICY LAPSED                        '.
   635         16  FILLER              PIC X(50) VALUE
   636           'DENIED/DECEASED PRIOR TO POLICY EFFECTIVE DATE    '.
   637         16  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL152.cbl
   638           'DENIED/LOAN TERM IN EXCESS OF MAXIMUM LOAN TERM   '.
   639         16  FILLER              PIC X(50) VALUE
   640           'DENIED/INSURED NOT PERMANENTLY & TOTALLY DISABLED '.
   641         16  FILLER              PIC X(50) VALUE
   642           'DENIED/IME EXAM DOES NOT SUPPORT CONT. DISABILITY '.
   643         16  FILLER              PIC X(50) VALUE
   644           'DENIED/INSURED DID NOT APPEAR FOR IME EXAM        '.
   645
   646     12  HAN-LETTER-REASON-TABLE  REDEFINES  HAN-REASON-TABLE.
   647         16  HAN-TABLE-ENTRIES  OCCURS  32  TIMES.
   648             20  HAN-REASON-TEXT PIC X(50).
   649
   650 01  ERROR-MESSAGES.
   651     12  ER-0000                 PIC X(4)  VALUE '0000'.
   652     12  ER-0004                 PIC X(4)  VALUE '0004'.
   653     12  ER-0006                 PIC X(4)  VALUE '0006'.
   654     12  ER-0008                 PIC X(4)  VALUE '0008'.
   655     12  ER-0013                 PIC X(4)  VALUE '0013'.
   656     12  ER-0023                 PIC X(4)  VALUE '0023'.
   657     12  ER-0029                 PIC X(4)  VALUE '0029'.
   658     12  ER-0033                 PIC X(4)  VALUE '0033'.
   659     12  ER-0042                 PIC X(4)  VALUE '0042'.
   660     12  ER-0047                 PIC X(4)  VALUE '0047'.
   661     12  ER-0051                 PIC X(4)  VALUE '0051'.
   662     12  ER-0066                 PIC X(4)  VALUE '0066'.
   663     12  ER-0067                 PIC X(4)  VALUE '0067'.
   664     12  ER-0070                 PIC X(4)  VALUE '0070'.
   665     12  ER-0133                 PIC X(4)  VALUE '0133'.
   666     12  ER-0154                 PIC X(4)  VALUE '0154'.
   667     12  ER-0168                 PIC X(4)  VALUE '0168'.
   668     12  ER-0169                 PIC X(4)  VALUE '0169'.
   669     12  ER-0172                 PIC X(4)  VALUE '0172'.
   670     12  ER-0174                 PIC X(4)  VALUE '0174'.
   671     12  ER-0175                 PIC X(4)  VALUE '0175'.
   672     12  ER-0176                 PIC X(4)  VALUE '0176'.
   673     12  ER-0177                 PIC X(4)  VALUE '0177'.
   674     12  ER-0178                 PIC X(4)  VALUE '0178'.
   675     12  ER-0179                 PIC X(4)  VALUE '0179'.
   676     12  ER-0180                 PIC X(4)  VALUE '0180'.
   677     12  ER-0181                 PIC X(4)  VALUE '0181'.
   678     12  ER-0182                 PIC X(4)  VALUE '0182'.
   679     12  ER-0183                 PIC X(4)  VALUE '0183'.
   680     12  ER-0184                 PIC X(4)  VALUE '0184'.
   681     12  ER-0185                 PIC X(4)  VALUE '0185'.
   682     12  ER-0186                 PIC X(4)  VALUE '0186'.
   683     12  ER-0187                 PIC X(4)  VALUE '0187'.
   684     12  ER-0188                 PIC X(4)  VALUE '0188'.
   685     12  ER-0189                 PIC X(4)  VALUE '0189'.
   686     12  ER-0190                 PIC X(4)  VALUE '0190'.
   687     12  ER-0191                 PIC X(4)  VALUE '0191'.
   688     12  ER-0206                 PIC X(4)  VALUE '0206'.
   689     12  ER-0211                 PIC X(4)  VALUE '0211'.
   690     12  ER-0279                 PIC X(4)  VALUE '0279'.
   691     12  ER-0280                 PIC X(4)  VALUE '0280'.
   692     12  ER-0281                 PIC X(4)  VALUE '0281'.
   693     12  ER-0332                 PIC X(4)  VALUE '0332'.
   694     12  ER-0343                 PIC X(4)  VALUE '0343'.
   695     12  ER-0373                 PIC X(4)  VALUE '0373'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL152.cbl
   696     12  ER-0374                 PIC X(4)  VALUE '0374'.
   697     12  ER-0412                 PIC X(4)  VALUE '0412'.
   698     12  ER-0413                 PIC X(4)  VALUE '0413'.
   699     12  ER-0533                 PIC X(4)  VALUE '0533'.
   700     12  ER-0537                 PIC X(4)  VALUE '0537'.
   701     12  ER-0716                 PIC X(4)  VALUE '0716'.
   702     12  ER-0861                 PIC X(4)  VALUE '0861'.
   703     12  ER-0894                 PIC X(4)  VALUE '0894'.
   704     12  ER-0900                 PIC X(4)  VALUE '0900'.
   705     12  ER-0909                 PIC X(4)  VALUE '0909'.
   706     12  ER-0911                 PIC X(4)  VALUE '0911'.
   707     12  ER-0912                 PIC X(4)  VALUE '0912'.
   708     12  ER-1236                 PIC X(4)  VALUE '1236'.
   709     12  ER-1560                 PIC X(4)  VALUE '1560'.
   710     12  ER-2055                 PIC X(4)  VALUE '2055'.
   711     12  ER-2397                 PIC X(4)  VALUE '2397'.
   712     12  ER-2398                 PIC X(4)  VALUE '2398'.
   713     12  ER-3547                 PIC X(4)  VALUE '3547'.
   714     12  ER-3770                 PIC X(4)  VALUE '3770'.
   715     12  ER-3771                 PIC X(4)  VALUE '3771'.
   716     12  ER-3772                 PIC X(4)  VALUE '3772'.
   717     12  ER-7675                 PIC X(4)  VALUE '7675'.
   718     12  ER-7840                 PIC X(4)  VALUE '7840'.
   719     12  ER-7842                 PIC X(4)  VALUE '7842'.
   720     12  ER-7843                 PIC X(4)  VALUE '7843'.
   721     12  ER-8158                 PIC X(4)  VALUE '8158'.
   722     12  ER-9106                 PIC X(4)  VALUE '9106'.
   723     12  ER-9483                 PIC X(4)  VALUE '9483'.
   724     12  ER-9808                 PIC X(4)  VALUE '9808'.
   725     12  ER-9883                 PIC X(4)  VALUE '9883'.
   726     12  ER-9887                 PIC X(4)  VALUE '9887'.
   727
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL152.cbl
   729****************************************************
   730*       WHEN ADDING OR DELETING ENTRIES TO         *
   731*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
   732*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
   733*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
   734*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
   735*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
   736*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
   737*                                                  *
   738*   3 FIELDS TO CHANGE:                            *
   739*      1 - SS-NUM-ENTRIES........(NO.OF ENTRIES)   *
   740*      2 - SS-WORK-AREA-LENGTH...(TOTAL LENGTH)    *
   741*      3 - SYSTEM-VARIABLES......( "      "   )    *
   742****************************************************
   743
   744*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
   745*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
   746
   747     12  SS-NUM-ENTRIES          PIC 999    VALUE 130      COMP-3.
   748     12  SS-COUNTER              PIC 999                   COMP-3.
   749     12  SS-WORK-AREA-LENGTH     PIC S9(4)  VALUE +3865    COMP.
   750
   751 01  VARIABLE-WORK-AREA.
   752     12  VAR-CODE                PIC X(4).
   753     12  VAR-LEN                 PIC 99.
   754     12  VAR-DATA                PIC X(100).
   755     12  VAR-DATA-R REDEFINES VAR-DATA.
   756       16  VAR-ONE-CHAR OCCURS 100 TIMES INDEXED BY INDXV PIC X.
   757
   758 01  SYSTEM-SUPPORTED-VARIABLES.
   759*****COMPANY NAME
   760     12  SS01                    PIC X(4)  VALUE     '01.0'.
   761     12  SS01L                   PIC 99    VALUE 36.
   762     12  SS01D                   PIC X(30) VALUE ALL '*'.
   763*****FULL COMPANY ADDRESS
   764     12  SS02-1                  PIC X(4)  VALUE     '02.1'.
   765     12  SS02-1L                 PIC 99    VALUE 36.
   766     12  SS02-1D                 PIC X(30) VALUE ALL '*'.
   767     12  SS02-2                  PIC X(4)  VALUE     '02.2'.
   768     12  SS02-2L                 PIC 99    VALUE 36.
   769     12  SS02-2D                 PIC X(30) VALUE ALL '*'.
   770     12  SS02-3                  PIC X(4)  VALUE     '02.3'.
   771     12  SS02-3L                 PIC 99    VALUE 36.
   772     12  SS02-3D                 PIC X(30) VALUE ALL '*'.
   773     12  SS02-4                  PIC X(4)  VALUE     '02.4'.
   774     12  SS02-4L                 PIC 99    VALUE 36.
   775     12  SS02-4D                 PIC X(30) VALUE ALL '*'.
   776     12  SS02-5                  PIC X(4)  VALUE     '02.5'.
   777     12  SS02-5L                 PIC 99    VALUE 36.
   778     12  SS02-5D                 PIC X(30) VALUE ALL '*'.
   779*****CARRIER NAME
   780     12  SS03                    PIC X(4)  VALUE     '03.0'.
   781     12  SS03L                   PIC 99    VALUE 36.
   782     12  SS03D                   PIC X(30) VALUE ALL '*'.
   783*****INVESTORS HERITAGE
   784* as Administrator for Investors Heritage Life Insurance Company
   785     12  SS03-1                  PIC X(4)  VALUE     '03.1'.
   786     12  SS03-1L                 PIC 99    VALUE 68.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL152.cbl
   787     12  SS03-1D                 PIC X(62) VALUE ALL '*'.
   788*****FULL CARRIER ADDRESS
   789     12  SS04-1                  PIC X(4)  VALUE     '04.1'.
   790     12  SS04-1L                 PIC 99    VALUE 36.
   791     12  SS04-1D                 PIC X(30) VALUE ALL '*'.
   792     12  SS04-2                  PIC X(4)  VALUE     '04.2'.
   793     12  SS04-2L                 PIC 99    VALUE 36.
   794     12  SS04-2D                 PIC X(30) VALUE ALL '*'.
   795     12  SS04-3                  PIC X(4)  VALUE     '04.3'.
   796     12  SS04-3L                 PIC 99    VALUE 36.
   797     12  SS04-3D                 PIC X(30) VALUE ALL '*'.
   798     12  SS04-4                  PIC X(4)  VALUE     '04.4'.
   799     12  SS04-4L                 PIC 99    VALUE 36.
   800     12  SS04-4D                 PIC X(30) VALUE ALL '*'.
   801     12  SS04-5                  PIC X(4)  VALUE     '04.5'.
   802     12  SS04-5L                 PIC 99    VALUE 36.
   803     12  SS04-5D                 PIC X(30) VALUE ALL '*'.
   804*****CARRIER PHONE NUMBER
   805     12  SS04-6                  PIC X(4)  VALUE     '04.6'.
   806     12  SS04-6L                 PIC 99    VALUE 18.
   807     12  SS04-6D                 PIC X(12) VALUE ALL '*'.
   808*****FULL ADDRESEE LABEL
   809     12  SS05-1                  PIC X(4)  VALUE     '05.1'.
   810     12  SS05-1L                 PIC 99    VALUE 36.
   811     12  SS05-1D                 PIC X(30) VALUE ALL '*'.
   812     12  SS05-2                  PIC X(4)  VALUE     '05.2'.
   813     12  SS05-2L                 PIC 99    VALUE 36.
   814     12  SS05-2D                 PIC X(30) VALUE ALL '*'.
   815     12  SS05-3                  PIC X(4)  VALUE     '05.3'.
   816     12  SS05-3L                 PIC 99    VALUE 36.
   817     12  SS05-3D                 PIC X(30) VALUE ALL '*'.
   818     12  SS05-4                  PIC X(4)  VALUE     '05.4'.
   819     12  SS05-4L                 PIC 99    VALUE 36.
   820     12  SS05-4D                 PIC X(30) VALUE ALL '*'.
   821     12  SS05-5                  PIC X(4)  VALUE     '05.5'.
   822     12  SS05-5L                 PIC 99    VALUE 36.
   823     12  SS05-5D                 PIC X(30) VALUE ALL '*'.
   824     12  SS05-6                  PIC X(4)  VALUE     '05.6'.
   825     12  SS05-6L                 PIC 99    VALUE 36.
   826     12  SS05-6D                 PIC X(30) VALUE ALL '*'.
   827*****ACCOUNT NAME
   828     12  SS06                    PIC X(4)  VALUE     '06.0'.
   829     12  SS06L                   PIC 99    VALUE 36.
   830     12  SS06D                   PIC X(30) VALUE ALL '*'.
   831*****FULL ACCOUNT ADDRESS
   832     12  SS07-1                  PIC X(4)  VALUE     '07.1'.
   833     12  SS07-1L                 PIC 99    VALUE 36.
   834     12  SS07-1D                 PIC X(30) VALUE ALL '*'.
   835     12  SS07-2                  PIC X(4)  VALUE     '07.2'.
   836     12  SS07-2L                 PIC 99    VALUE 36.
   837     12  SS07-2D                 PIC X(30) VALUE ALL '*'.
   838     12  SS07-3                  PIC X(4)  VALUE     '07.3'.
   839     12  SS07-3L                 PIC 99    VALUE 36.
   840     12  SS07-3D                 PIC X(30) VALUE ALL '*'.
   841     12  SS07-4                  PIC X(4)  VALUE     '07.4'.
   842     12  SS07-4L                 PIC 99    VALUE 36.
   843     12  SS07-4D                 PIC X(30) VALUE ALL '*'.
   844     12  SS07-5                  PIC X(4)  VALUE     '07.5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL152.cbl
   845     12  SS07-5L                 PIC 99    VALUE 36.
   846     12  SS07-5D                 PIC X(30) VALUE ALL '*'.
   847*****ACCOUNT PHONE NUMBER
   848     12  SS07-6                  PIC X(4)  VALUE     '07.6'.
   849     12  SS07-6L                 PIC 99    VALUE 18.
   850     12  SS07-6D                 PIC X(12) VALUE ALL '*'.
   851*****EXECUTING PROCESSOR NAME
   852     12  SS08                    PIC X(4)  VALUE     '08.0'.
   853     12  SS08L                   PIC 99    VALUE 36.
   854     12  SS08D                   PIC X(30) VALUE ALL '*'.
   855*****PROCESSOR TITLE
   856     12  SS09                    PIC X(4)  VALUE     '09.0'.
   857     12  SS09L                   PIC 99    VALUE 32.
   858     12  SS09D                   PIC X(26) VALUE ALL '*'.
   859*****INSUREDS NAME
   860     12  SS10                    PIC X(4)  VALUE     '10.0'.
   861     12  SS10L                   PIC 99    VALUE 36.
   862     12  SS10D                   PIC X(30) VALUE ALL '*'.
   863*****INSUREDS ADDRESS
   864     12  SS11-1                  PIC X(4)  VALUE     '11.1'.
   865     12  SS11-1L                 PIC 99    VALUE 36.
   866     12  SS11-1D                 PIC X(30) VALUE ALL '*'.
   867     12  SS11-2                  PIC X(4)  VALUE     '11.2'.
   868     12  SS11-2L                 PIC 99    VALUE 36.
   869     12  SS11-2D                 PIC X(30) VALUE ALL '*'.
   870     12  SS11-3                  PIC X(4)  VALUE     '11.3'.
   871     12  SS11-3L                 PIC 99    VALUE 36.
   872     12  SS11-3D                 PIC X(30) VALUE ALL '*'.
   873     12  SS11-4                  PIC X(4)  VALUE     '11.4'.
   874     12  SS11-4L                 PIC 99    VALUE 36.
   875     12  SS11-4D                 PIC X(30) VALUE ALL '*'.
   876*****INSUREDS NAME FROM ADDR TRAILER
   877     12  SS11-5                  PIC X(4)  VALUE     '11.5'.
   878     12  SS11-5L                 PIC 99    VALUE 36.
   879     12  SS11-5D                 PIC X(30) VALUE ALL '*'.
   880*****INSUREDS PHONE NUMBER FROM ADDR TRAILER
   881     12  SS11-6                  PIC X(4)  VALUE     '11.6'.
   882     12  SS11-6L                 PIC 99    VALUE 18.
   883     12  SS11-6D                 PIC X(12) VALUE ALL '*'.
   884*****CLAIM TYPE NAME
   885     12  SS12                    PIC X(4)  VALUE     '12.0'.
   886     12  SS12L                   PIC 99    VALUE 12.
   887     12  SS12D                   PIC X(6)  VALUE ALL '*'.
   888*****CLAIM INCURRED DATE
   889     12  SS13                    PIC X(4)  VALUE     '13.0'.
   890     12  SS13L                   PIC 99    VALUE 14.
   891     12  SS13D                   PIC X(8)  VALUE ALL '*'.
   892*****CLAIM REPORTED DATE
   893     12  SS14                    PIC X(4)  VALUE     '14.0'.
   894     12  SS14L                   PIC 99    VALUE 14.
   895     12  SS14D                   PIC X(8)  VALUE ALL '*'.
   896*****LAST PAYMENT DATE
   897     12  SS15                    PIC X(4)  VALUE     '15.0'.
   898     12  SS15L                   PIC 99    VALUE 14.
   899     12  SS15D                   PIC X(8)  VALUE ALL '*'.
   900*****LAST PAYMENT AMOUNT
   901     12  SS16                    PIC X(4)  VALUE     '16.0'.
   902     12  SS16L                   PIC 99    VALUE 17.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL152.cbl
   903     12  SS16D                   PIC $$$$,$$$.99 VALUE ZEROS.
   904*****CLAIM INTEREST RATE
   905     12  SS16-1                  PIC X(4)  VALUE     '16.1'.
   906     12  SS16-1L                 PIC 99    VALUE 13.
   907     12  SS16-1D                 PIC X(7)        VALUE SPACE.
   908*****CLAIM PAID THRU/TO DATE
   909     12  SS17                    PIC X(4)  VALUE     '17.0'.
   910     12  SS17L                   PIC 99    VALUE 14.
   911     12  SS17D                   PIC X(8)  VALUE ALL '*'.
   912*****TOTAL PAID TO DATE
   913     12  SS18                    PIC X(4)  VALUE     '18.0'.
   914     12  SS18L                   PIC 99    VALUE 17.
   915     12  SS18D                   PIC $$$$,$$$.99 VALUE ZEROS.
   916*****DIAGNOSIS OR CAUSE
   917     12  SS19                    PIC X(4)  VALUE     '19.0'.
   918     12  SS19L                   PIC 99    VALUE 32.
   919     12  SS19D                   PIC X(26) VALUE ALL '*'.
   920*****CAUSE CODE
   921     12  SS19-1                  PIC X(4)  VALUE     '19.1'.
   922     12  SS19-1L                 PIC 99    VALUE 12.
   923     12  SS19-1D                 PIC X(6)  VALUE ALL '*'.
   924*****CID LOAN NUMBER
   925     12  SS19-2                  PIC X(4)  VALUE     '19.2'.
   926     12  SS19-2L                 PIC 99    VALUE 31.
   927     12  SS19-2D                 PIC X(25) VALUE ALL '*'.
   928*****CURRENT DATE
   929     12  SS20                    PIC X(4)  VALUE     '20.0'.
   930     12  SS20L                   PIC 99    VALUE 14.
   931     12  SS20D                   PIC X(8)  VALUE ALL '*'.
   932*****FULL CURRENT DATE
   933     12  SS21                    PIC X(4)  VALUE     '21.0'.
   934     12  SS21L                   PIC 99    VALUE 24.
   935     12  SS21D                   PIC X(18) VALUE ALL '*'.
   936*****BENEFIT DESCRIPTION
   937     12  SS22                    PIC X(4)  VALUE     '22.0'.
   938     12  SS22L                   PIC 99    VALUE 16.
   939     12  SS22D                   PIC X(10) VALUE ALL '*'.
   940*****CARRIER CODE IN CERT
   941     12  SS23                    PIC X(4)  VALUE     '23.0'.
   942     12  SS23L                   PIC 99    VALUE 9.
   943     12  SS23D                   PIC XXX   VALUE ALL '*'.
   944*****GROUPING CODE IN CERT
   945     12  SS24                    PIC X(4)  VALUE     '24.0'.
   946     12  SS24L                   PIC 99    VALUE 12.
   947     12  SS24D                   PIC X(6)  VALUE ALL '*'.
   948*****ACCOUNT NUMBER IN CERT
   949     12  SS25                    PIC X(4)  VALUE     '25.0'.
   950     12  SS25L                   PIC 99    VALUE 16.
   951     12  SS25D                   PIC X(10) VALUE ALL '*'.
   952*****CERTIFICATE NUMBER
   953     12  SS26                    PIC X(4)  VALUE     '26.0'.
   954     12  SS26L                   PIC 99    VALUE 17.
   955     12  SS26D                   PIC X(11) VALUE ALL '*'.
   956*****CERT EFFECTIVE DATE
   957     12  SS27                    PIC X(4)  VALUE     '27.0'.
   958     12  SS27L                   PIC 99    VALUE 14.
   959     12  SS27D                   PIC X(8)  VALUE ALL '*'.
   960*****CERT EXPIRATION DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL152.cbl
   961     12  SS28                    PIC X(4)  VALUE     '28.0'.
   962     12  SS28L                   PIC 99    VALUE 14.
   963     12  SS28D                   PIC X(8)  VALUE ALL '*'.
   964*****APPLICABLE COVERAGE TERM
   965     12  SS29                    PIC X(4)  VALUE     '29.0'.
   966     12  SS29L                   PIC 99    VALUE 9.
   967     12  SS29D                   PIC XXX   VALUE ALL '*'.
   968*****APPLICABLE COVERAGE AMOUNT
   969     12  SS30                    PIC X(4)  VALUE     '30.0'.
   970     12  SS30L                   PIC 99    VALUE 18.
   971     12  SS30D                   PIC $$$$$,$$$.99  VALUE ZEROS.
   972*****APPLICABLE COVERAGE CANCEL DATE
   973     12  SS31                    PIC X(4)  VALUE     '31.0'.
   974     12  SS31L                   PIC 99    VALUE 14.
   975     12  SS31D                   PIC X(8)  VALUE ALL '*'.
   976*****APPLICABLE COVERAGE FORM NUMBER
   977     12  SS32                    PIC X(4)  VALUE     '32.0'.
   978     12  SS32L                   PIC 99    VALUE 18.
   979     12  SS32D                   PIC X(12) VALUE ALL '*'.
   980*****INSURES AGE AT POLICY ISSUE
   981     12  SS33                    PIC X(4)  VALUE     '33.0'.
   982     12  SS33L                   PIC 99    VALUE 9.
   983     12  SS33D                   PIC XXX   VALUE ALL '*'.
   984*****CLAIM NUMBER
   985     12  SS34                    PIC X(4)  VALUE     '34.0'.
   986     12  SS34L                   PIC 99    VALUE 13.
   987     12  SS34D                   PIC X(7)  VALUE ALL '*'.
   988*****LAST DENIAL TEXT
   989     12  SS35-1                  PIC X(4)  VALUE     '35.1'.
   990     12  SS35-1L                 PIC 99    VALUE 66.
   991     12  SS35-1D                 PIC X(60) VALUE ALL '*'.
   992     12  SS35-2                  PIC X(4)  VALUE     '35.2'.
   993     12  SS35-2L                 PIC 99    VALUE 66.
   994     12  SS35-2D                 PIC X(60) VALUE ALL '*'.
   995*****LOAN NUMBER
   996     12  SS36                    PIC X(4)  VALUE     '36.0'.
   997     12  SS36L                   PIC 99    VALUE 14.
   998     12  SS36D                   PIC X(8)  VALUE ALL '*'.
   999*****CURRENT LOAN NUMBER
  1000     12  SS36-1                  PIC X(4)  VALUE     '36.1'.
  1001     12  SS36-1L                 PIC 99    VALUE 26.
  1002     12  SS36-1D                 PIC X(20) VALUE ALL '*'.
  1003*****LOAN BALANCE
  1004     12  SS37                    PIC X(4)  VALUE     '37.0'.
  1005     12  SS37L                   PIC 99    VALUE 18.
  1006     12  SS37D                   PIC $$$$$,$$$.99  VALUE ZEROS.
  1007*****MEMBER NUMBER
  1008     12  SS38                    PIC X(4)  VALUE     '38.0'.
  1009     12  SS38L                   PIC 99    VALUE 18.
  1010     12  SS38D                   PIC X(12) VALUE ALL '*'.
  1011*****INSURED NAME (FIRST M LAST)
  1012     12  SS39                    PIC X(4)  VALUE     '39.0'.
  1013     12  SS39L                   PIC 99    VALUE 36.
  1014     12  SS39D                   PIC X(30) VALUE ALL '*'.
  1015*****INSURED LAST NAME ONLY
  1016     12  SS40                    PIC X(4)  VALUE     '40.0'.
  1017     12  SS40L                   PIC 99    VALUE 21.
  1018     12  SS40D                   PIC X(15) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL152.cbl
  1019*****TITLE (MR/MS)
  1020     12  SS41                    PIC X(4)  VALUE     '41.0'.
  1021     12  SS41L                   PIC 99    VALUE 9.
  1022     12  SS41D                   PIC X(3)  VALUE ALL '*'.
  1023*****ELIMINATION PERIOD
  1024     12  SS42                    PIC X(4)  VALUE     '42.0'.
  1025     12  SS42L                   PIC 99    VALUE 9.
  1026     12  SS42D                   PIC X(3)  VALUE ALL '*'.
  1027*****BENEFICIARY NAME
  1028     12  SS43                    PIC X(4)  VALUE     '43.0'.
  1029     12  SS43L                   PIC 99    VALUE 36.
  1030     12  SS43D                   PIC X(30) VALUE ALL '*'.
  1031*****BENEFICIARY ADDRESS
  1032     12  SS44-1                  PIC X(4)  VALUE     '44.1'.
  1033     12  SS44-1L                 PIC 99    VALUE 36.
  1034     12  SS44-1D                 PIC X(30) VALUE ALL '*'.
  1035     12  SS44-2                  PIC X(4)  VALUE     '44.2'.
  1036     12  SS44-2L                 PIC 99    VALUE 36.
  1037     12  SS44-2D                 PIC X(30) VALUE ALL '*'.
  1038     12  SS44-3                  PIC X(4)  VALUE     '44.3'.
  1039     12  SS44-3L                 PIC 99    VALUE 36.
  1040     12  SS44-3D                 PIC X(30) VALUE ALL '*'.
  1041     12  SS44-4                  PIC X(4)  VALUE     '44.4'.
  1042     12  SS44-4L                 PIC 99    VALUE 36.
  1043     12  SS44-4D                 PIC X(30) VALUE ALL '*'.
  1044     12  SS44-5                  PIC X(4)  VALUE     '44.5'.
  1045     12  SS44-5L                 PIC 99    VALUE 18.
  1046     12  SS44-5D                 PIC X(12) VALUE ALL '*'.
  1047     12  SS44-6                  PIC X(4)  VALUE     '44.6'.
  1048     12  SS44-6L                 PIC 99    VALUE 36.
  1049     12  SS44-6D                 PIC X(30) VALUE ALL '*'.
  1050*****INSUREDS DATE OF BIRTH
  1051     12  SS45                    PIC X(4)  VALUE     '45.0'.
  1052     12  SS45L                   PIC 99    VALUE 14.
  1053     12  SS45D                   PIC X(8)  VALUE ALL '*'.
  1054*****INSUREDS SOC SEC NUMBER
  1055     12  SS46                    PIC X(4)  VALUE     '46.0'.
  1056     12  SS46L                   PIC 99    VALUE 17.
  1057     12  SS46D                   PIC X(11) VALUE ALL '*'.
  1058*****PHYSICIANS  NAME
  1059     12  SS47                    PIC X(4)  VALUE     '47.0'.
  1060     12  SS47L                   PIC 99    VALUE 36.
  1061     12  SS47D                   PIC X(30) VALUE ALL '*'.
  1062*****PHYSICIANS  ADDRESS
  1063     12  SS47-1                  PIC X(4)  VALUE     '47.1'.
  1064     12  SS47-1L                 PIC 99    VALUE 36.
  1065     12  SS47-1D                 PIC X(30) VALUE ALL '*'.
  1066     12  SS47-2                  PIC X(4)  VALUE     '47.2'.
  1067     12  SS47-2L                 PIC 99    VALUE 36.
  1068     12  SS47-2D                 PIC X(30) VALUE ALL '*'.
  1069     12  SS47-3                  PIC X(4)  VALUE     '47.3'.
  1070     12  SS47-3L                 PIC 99    VALUE 36.
  1071     12  SS47-3D                 PIC X(30) VALUE ALL '*'.
  1072     12  SS47-4                  PIC X(4)  VALUE     '47.4'.
  1073     12  SS47-4L                 PIC 99    VALUE 36.
  1074     12  SS47-4D                 PIC X(30) VALUE ALL '*'.
  1075     12  SS47-5                  PIC X(4)  VALUE     '47.5'.
  1076     12  SS47-5L                 PIC 99    VALUE 18.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL152.cbl
  1077     12  SS47-5D                 PIC X(12) VALUE ALL '*'.
  1078*****EMPLOYERS   NAME
  1079     12  SS48                    PIC X(4)  VALUE     '48.0'.
  1080     12  SS48L                   PIC 99    VALUE 36.
  1081     12  SS48D                   PIC X(30) VALUE ALL '*'.
  1082*****EMPLOYERS   ADDRESS
  1083     12  SS48-1                  PIC X(4)  VALUE     '48.1'.
  1084     12  SS48-1L                 PIC 99    VALUE 36.
  1085     12  SS48-1D                 PIC X(30) VALUE ALL '*'.
  1086     12  SS48-2                  PIC X(4)  VALUE     '48.2'.
  1087     12  SS48-2L                 PIC 99    VALUE 36.
  1088     12  SS48-2D                 PIC X(30) VALUE ALL '*'.
  1089     12  SS48-3                  PIC X(4)  VALUE     '48.3'.
  1090     12  SS48-3L                 PIC 99    VALUE 36.
  1091     12  SS48-3D                 PIC X(30) VALUE ALL '*'.
  1092     12  SS48-4                  PIC X(4)  VALUE     '48.4'.
  1093     12  SS48-4L                 PIC 99    VALUE 36.
  1094     12  SS48-4D                 PIC X(30) VALUE ALL '*'.
  1095     12  SS48-5                  PIC X(4)  VALUE     '48.5'.
  1096     12  SS48-5L                 PIC 99    VALUE 18.
  1097     12  SS48-5D                 PIC X(12) VALUE ALL '*'.
  1098*****OTHER1      NAME
  1099     12  SS49                    PIC X(4)  VALUE     '49.0'.
  1100     12  SS49L                   PIC 99    VALUE 36.
  1101     12  SS49D                   PIC X(30) VALUE ALL '*'.
  1102*****OTHER1      ADDRESS
  1103     12  SS49-1                  PIC X(4)  VALUE     '49.1'.
  1104     12  SS49-1L                 PIC 99    VALUE 36.
  1105     12  SS49-1D                 PIC X(30) VALUE ALL '*'.
  1106     12  SS49-2                  PIC X(4)  VALUE     '49.2'.
  1107     12  SS49-2L                 PIC 99    VALUE 36.
  1108     12  SS49-2D                 PIC X(30) VALUE ALL '*'.
  1109     12  SS49-3                  PIC X(4)  VALUE     '49.3'.
  1110     12  SS49-3L                 PIC 99    VALUE 36.
  1111     12  SS49-3D                 PIC X(30) VALUE ALL '*'.
  1112     12  SS49-4                  PIC X(4)  VALUE     '49.4'.
  1113     12  SS49-4L                 PIC 99    VALUE 36.
  1114     12  SS49-4D                 PIC X(30) VALUE ALL '*'.
  1115     12  SS49-5                  PIC X(4)  VALUE     '49.5'.
  1116     12  SS49-5L                 PIC 99    VALUE 18.
  1117     12  SS49-5D                 PIC X(12) VALUE ALL '*'.
  1118*****OTHER2      NAME
  1119     12  SS50                    PIC X(4)  VALUE     '50.0'.
  1120     12  SS50L                   PIC 99    VALUE 36.
  1121     12  SS50D                   PIC X(30) VALUE ALL '*'.
  1122*****OTHER2      ADDRESS
  1123     12  SS50-1                  PIC X(4)  VALUE     '50.1'.
  1124     12  SS50-1L                 PIC 99    VALUE 36.
  1125     12  SS50-1D                 PIC X(30) VALUE ALL '*'.
  1126     12  SS50-2                  PIC X(4)  VALUE     '50.2'.
  1127     12  SS50-2L                 PIC 99    VALUE 36.
  1128     12  SS50-2D                 PIC X(30) VALUE ALL '*'.
  1129     12  SS50-3                  PIC X(4)  VALUE     '50.3'.
  1130     12  SS50-3L                 PIC 99    VALUE 36.
  1131     12  SS50-3D                 PIC X(30) VALUE ALL '*'.
  1132     12  SS50-4                  PIC X(4)  VALUE     '50.4'.
  1133     12  SS50-4L                 PIC 99    VALUE 36.
  1134     12  SS50-4D                 PIC X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL152.cbl
  1135     12  SS50-5                  PIC X(4)  VALUE     '50.5'.
  1136     12  SS50-5L                 PIC 99    VALUE 18.
  1137     12  SS50-5D                 PIC X(12) VALUE ALL '*'.
  1138*****A&H TERM TIMES MON. BEN.
  1139     12  SS51                    PIC X(4)  VALUE     '51.0'.
  1140     12  SS51L                   PIC 99    VALUE 17.
  1141     12  SS51D                   PIC $$$$,$$$.99 VALUE ZEROS.
  1142*****THIRD PARTY NAME
  1143     12  SS52                    PIC X(4)  VALUE     '52.0'.
  1144     12  SS52L                   PIC 99    VALUE 36.
  1145     12  SS52D                   PIC X(30) VALUE ALL '*'.
  1146*****THIRD PARTY ADDRESS
  1147     12  SS53-1                  PIC X(4)  VALUE     '53.1'.
  1148     12  SS53-1L                 PIC 99    VALUE 36.
  1149     12  SS53-1D                 PIC X(30) VALUE ALL '*'.
  1150     12  SS53-2                  PIC X(4)  VALUE     '53.2'.
  1151     12  SS53-2L                 PIC 99    VALUE 36.
  1152     12  SS53-2D                 PIC X(30) VALUE ALL '*'.
  1153     12  SS53-3                  PIC X(4)  VALUE     '53.3'.
  1154     12  SS53-3L                 PIC 99    VALUE 36.
  1155     12  SS53-3D                 PIC X(30) VALUE ALL '*'.
  1156     12  SS53-4                  PIC X(4)  VALUE     '53.4'.
  1157     12  SS53-4L                 PIC 99    VALUE 36.
  1158     12  SS53-4D                 PIC X(30) VALUE ALL '*'.
  1159     12  SS53-5                  PIC X(4)  VALUE     '53.5'.
  1160     12  SS53-5L                 PIC 99    VALUE 36.
  1161     12  SS53-5D                 PIC X(30) VALUE ALL '*'.
  1162*****THIRD PARTY PHONE NUMBER
  1163     12  SS53-6                  PIC X(4)  VALUE     '53.6'.
  1164     12  SS53-6L                 PIC 99    VALUE 18.
  1165     12  SS53-6D                 PIC X(12) VALUE ALL '*'.
  1166*****CERTIFICATE SEQUENCE
  1167     12  SS54                    PIC X(4)  VALUE     '54.0'.
  1168     12  SS54L                   PIC 99    VALUE 09.
  1169     12  SS54D                   PIC XXX VALUE ALL '*'.
  1170*****CERTIFICATE TOTAL  E
  1171     12  SS55                    PIC X(4)  VALUE     '55.0'.
  1172     12  SS55L                   PIC 99    VALUE 09.
  1173     12  SS55D                   PIC XXX VALUE ALL '*'.
  1174*****CREDITOR ID
  1175     12  SS56                    PIC  X(04) VALUE    '56.0'.
  1176     12  SS56L                   PIC  99 VALUE 36.
  1177     12  SS56D                   PIC  X(30) VALUE ALL '*'.
  1178*****INSUREDS NAME (CERTIFICATE)
  1179     12  SS57                    PIC X(4)  VALUE     '57.0'.
  1180     12  SS57L                   PIC 99    VALUE 36.
  1181     12  SS57D                   PIC X(30) VALUE ALL '*'.
  1182*****JOINT NAME (CERTIFICATE)
  1183     12  SS58                    PIC X(4)  VALUE     '58.0'.
  1184     12  SS58L                   PIC 99    VALUE 36.
  1185     12  SS58D                   PIC X(30) VALUE ALL '*'.
  1186*****POLICY REFERENCE NUMBER
  1187     12  SS59                    PIC X(4)  VALUE     '59.0'.
  1188     12  SS59L                   PIC 99    VALUE 26.
  1189     12  SS59D                   PIC X(20) VALUE ALL '*'.
  1190*****CREDIT CARD NUMBER (CLAIMS)
  1191     12  SS60                    PIC X(4)  VALUE     '60.0'.
  1192     12  SS60L                   PIC 99    VALUE 22.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL152.cbl
  1193     12  SS60D                   PIC X(16) VALUE ALL '*'.
  1194*****CORRESPONDENCE BENEFICIARY NAME
  1195     12  SS61                    PIC X(4)  VALUE     '61.0'.
  1196     12  SS61L                   PIC 99    VALUE 36.
  1197     12  SS61D                   PIC X(30) VALUE ALL '*'.
  1198*****CORRESPONDENCE BENEFICIARY ADDRESS
  1199     12  SS61-1                  PIC X(4)  VALUE     '61.1'.
  1200     12  SS61-1L                 PIC 99    VALUE 36.
  1201     12  SS61-1D                 PIC X(30) VALUE ALL '*'.
  1202     12  SS61-2                  PIC X(4)  VALUE     '61.2'.
  1203     12  SS61-2L                 PIC 99    VALUE 36.
  1204     12  SS61-2D                 PIC X(30) VALUE ALL '*'.
  1205     12  SS61-3                  PIC X(4)  VALUE     '61.3'.
  1206     12  SS61-3L                 PIC 99    VALUE 36.
  1207     12  SS61-3D                 PIC X(30) VALUE ALL '*'.
  1208     12  SS61-4                  PIC X(4)  VALUE     '61.4'.
  1209     12  SS61-4L                 PIC 99    VALUE 36.
  1210     12  SS61-4D                 PIC X(30) VALUE ALL '*'.
  1211     12  SS61-5                  PIC X(4)  VALUE     '61.5'.
  1212     12  SS61-5L                 PIC 99    VALUE 36.
  1213     12  SS61-5D                 PIC X(30) VALUE ALL '*'.
  1214     12  SS61-6                  PIC X(4)  VALUE     '61.6'.
  1215     12  SS61-6L                 PIC 99    VALUE 18.
  1216     12  SS61-6D                 PIC X(12) VALUE ALL '*'.
  1217
  1218*****DMD UNDERWRITER STATEMENT
  1219     12  SS62                    PIC X(4)  VALUE     '62.0'.
  1220     12  SS62L                   PIC 99    VALUE 56.
  1221     12  SS62D                   PIC X(50) VALUE ALL '*'.
  1222
  1223*****DMD UNDERWRITER NAME
  1224     12  SS63                    PIC X(4)  VALUE     '63.0'.
  1225     12  SS63L                   PIC 99    VALUE 66.
  1226     12  SS63D                   PIC X(60) VALUE ALL '*'.
  1227
  1228*****DMD UNDERWRITER NAME
  1229     12  SS64                    PIC X(4)  VALUE     '64.0'.
  1230     12  SS64L                   PIC 99    VALUE 66.
  1231     12  SS64D                   PIC X(60) VALUE ALL '*'.
  1232
  1233****************************************************
  1234*       WHEN ADDING OR DELETING ENTRIES TO         *
  1235*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
  1236*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
  1237*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
  1238*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
  1239*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
  1240*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
  1241****************************************************
  1242*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  1243*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  1244
  1245 01  SYSTEM-VARIABLES            PIC X(3865).
  1246 01  SYS-VAR-ENTRY.
  1247     12  SYS-VAR-CODE            PIC X(4).
  1248     12  SYS-VAR-LEN             PIC 99.
  1249     12  SYS-VAR-DATA            PIC X(100).
  1250
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL152.cbl
  1251*                                COPY ELCDATE.
  1252******************************************************************
  1253*                                                                *
  1254*                                                                *
  1255*                            ELCDATE.                            *
  1256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1257*                            VMOD=2.003
  1258*                                                                *
  1259*                                                                *
  1260*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1261*                 LENGTH = 200                                   *
  1262******************************************************************
  1263
  1264 01  DATE-CONVERSION-DATA.
  1265     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1266     12  DC-OPTION-CODE                PIC X.
  1267         88  BIN-TO-GREG                VALUE ' '.
  1268         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1269         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1270         88  YMD-GREG-TO-BIN            VALUE '3'.
  1271         88  MDY-GREG-TO-BIN            VALUE '4'.
  1272         88  JULIAN-TO-BIN              VALUE '5'.
  1273         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1274         88  FIND-CENTURY               VALUE '7'.
  1275         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1276         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1277         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1278         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1279         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1280         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1281         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1282         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1283         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1284         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1285         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1286         88  BIN-3-TO-GREG              VALUE 'I'.
  1287         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1288         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1289         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1290         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1291         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1292         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1293         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1294         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1295         88  THREE-CHARACTER-BIN
  1296                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1297         88  GREGORIAN-TO-BIN
  1298                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1299         88  BIN-TO-GREGORIAN
  1300                  VALUES ' ' '1' 'I' '8' 'G'.
  1301         88  JULIAN-TO-BINARY
  1302                  VALUES '5' 'C' 'E' 'F'.
  1303     12  DC-ERROR-CODE                 PIC X.
  1304         88  NO-CONVERSION-ERROR        VALUE ' '.
  1305         88  DATE-CONVERSION-ERROR
  1306                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1307         88  DATE-IS-ZERO               VALUE '1'.
  1308         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL152.cbl
  1309         88  DATE-IS-INVALID            VALUE '3'.
  1310         88  DATE1-GREATER-DATE2        VALUE '4'.
  1311         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1312         88  DATE-INVALID-OPTION        VALUE '9'.
  1313         88  INVALID-CENTURY            VALUE 'A'.
  1314         88  ONLY-CENTURY               VALUE 'B'.
  1315         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1316         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1317     12  DC-END-OF-MONTH               PIC X.
  1318         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1319     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1320         88  USE-NORMAL-PROCESS         VALUE ' '.
  1321         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1322         88  ADJUST-UP-100-YRS          VALUE '2'.
  1323     12  FILLER                        PIC X.
  1324     12  DC-CONVERSION-DATES.
  1325         16  DC-BIN-DATE-1             PIC XX.
  1326         16  DC-BIN-DATE-2             PIC XX.
  1327         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1328         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1329                       DC-GREG-DATE-1-EDIT.
  1330             20  DC-EDIT1-MONTH        PIC 99.
  1331             20  SLASH1-1              PIC X.
  1332             20  DC-EDIT1-DAY          PIC 99.
  1333             20  SLASH1-2              PIC X.
  1334             20  DC-EDIT1-YEAR         PIC 99.
  1335         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1336         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1337                     DC-GREG-DATE-2-EDIT.
  1338             20  DC-EDIT2-MONTH        PIC 99.
  1339             20  SLASH2-1              PIC X.
  1340             20  DC-EDIT2-DAY          PIC 99.
  1341             20  SLASH2-2              PIC X.
  1342             20  DC-EDIT2-YEAR         PIC 99.
  1343         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1344         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1345                     DC-GREG-DATE-1-YMD.
  1346             20  DC-YMD-YEAR           PIC 99.
  1347             20  DC-YMD-MONTH          PIC 99.
  1348             20  DC-YMD-DAY            PIC 99.
  1349         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1350         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1351                      DC-GREG-DATE-1-MDY.
  1352             20  DC-MDY-MONTH          PIC 99.
  1353             20  DC-MDY-DAY            PIC 99.
  1354             20  DC-MDY-YEAR           PIC 99.
  1355         16  DC-GREG-DATE-1-ALPHA.
  1356             20  DC-ALPHA-MONTH        PIC X(10).
  1357             20  DC-ALPHA-DAY          PIC 99.
  1358             20  FILLER                PIC XX.
  1359             20  DC-ALPHA-CENTURY.
  1360                 24 DC-ALPHA-CEN-N     PIC 99.
  1361             20  DC-ALPHA-YEAR         PIC 99.
  1362         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1363         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1364         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1365         16  DC-JULIAN-DATE            PIC 9(05).
  1366         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL152.cbl
  1367                                       PIC 9(05).
  1368         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1369             20  DC-JULIAN-YEAR        PIC 99.
  1370             20  DC-JULIAN-DAYS        PIC 999.
  1371         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1372         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1373         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1374     12  DATE-CONVERSION-VARIBLES.
  1375         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1376         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1377             20  FILLER                PIC 9(3).
  1378             20  HOLD-CEN-1-CCYY.
  1379                 24  HOLD-CEN-1-CC     PIC 99.
  1380                 24  HOLD-CEN-1-YY     PIC 99.
  1381             20  HOLD-CEN-1-MO         PIC 99.
  1382             20  HOLD-CEN-1-DA         PIC 99.
  1383         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1384             20  HOLD-CEN-1-R-MO       PIC 99.
  1385             20  HOLD-CEN-1-R-DA       PIC 99.
  1386             20  HOLD-CEN-1-R-CCYY.
  1387                 24  HOLD-CEN-1-R-CC   PIC 99.
  1388                 24  HOLD-CEN-1-R-YY   PIC 99.
  1389             20  FILLER                PIC 9(3).
  1390         16  HOLD-CENTURY-1-X.
  1391             20  FILLER                PIC X(3)  VALUE SPACES.
  1392             20  HOLD-CEN-1-X-CCYY.
  1393                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1394                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1395             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1396             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1397         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1398             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1399             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1400             20  HOLD-CEN-1-R-X-CCYY.
  1401                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1402                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1403             20  FILLER                PIC XXX.
  1404         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1405         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1406         16  DC-JULIAN-DATE-1          PIC 9(07).
  1407         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1408             20  DC-JULIAN-1-CCYY.
  1409                 24  DC-JULIAN-1-CC    PIC 99.
  1410                 24  DC-JULIAN-1-YR    PIC 99.
  1411             20  DC-JULIAN-DA-1        PIC 999.
  1412         16  DC-JULIAN-DATE-2          PIC 9(07).
  1413         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1414             20  DC-JULIAN-2-CCYY.
  1415                 24  DC-JULIAN-2-CC    PIC 99.
  1416                 24  DC-JULIAN-2-YR    PIC 99.
  1417             20  DC-JULIAN-DA-2        PIC 999.
  1418         16  DC-GREG-DATE-A-EDIT.
  1419             20  DC-EDITA-MONTH        PIC 99.
  1420             20  SLASHA-1              PIC X VALUE '/'.
  1421             20  DC-EDITA-DAY          PIC 99.
  1422             20  SLASHA-2              PIC X VALUE '/'.
  1423             20  DC-EDITA-CCYY.
  1424                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL152.cbl
  1425                 24  DC-EDITA-YEAR     PIC 99.
  1426         16  DC-GREG-DATE-B-EDIT.
  1427             20  DC-EDITB-MONTH        PIC 99.
  1428             20  SLASHB-1              PIC X VALUE '/'.
  1429             20  DC-EDITB-DAY          PIC 99.
  1430             20  SLASHB-2              PIC X VALUE '/'.
  1431             20  DC-EDITB-CCYY.
  1432                 24  DC-EDITB-CENT     PIC 99.
  1433                 24  DC-EDITB-YEAR     PIC 99.
  1434         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1435         16  DC-GREG-DATE-CYMD-R REDEFINES
  1436                              DC-GREG-DATE-CYMD.
  1437             20  DC-CYMD-CEN           PIC 99.
  1438             20  DC-CYMD-YEAR          PIC 99.
  1439             20  DC-CYMD-MONTH         PIC 99.
  1440             20  DC-CYMD-DAY           PIC 99.
  1441         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1442         16  DC-GREG-DATE-MDCY-R REDEFINES
  1443                              DC-GREG-DATE-MDCY.
  1444             20  DC-MDCY-MONTH         PIC 99.
  1445             20  DC-MDCY-DAY           PIC 99.
  1446             20  DC-MDCY-CEN           PIC 99.
  1447             20  DC-MDCY-YEAR          PIC 99.
  1448    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1449        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1450    12  DC-EL310-DATE                  PIC X(21).
  1451    12  FILLER                         PIC X(28).
  1452
  1453*                                COPY ELCLOGOF.
  1454******************************************************************
  1455*                                                                *
  1456*                                                                *
  1457*                            ELCLOGOF.                           *
  1458*                            VMOD=2.001                          *
  1459*                                                                *
  1460*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1461*                                                                *
  1462******************************************************************
  1463 01  CLASIC-LOGOFF.
  1464     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1465     12  LOGOFF-TEXT.
  1466         16  FILLER          PIC X(5)    VALUE SPACES.
  1467         16  LOGOFF-MSG.
  1468             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1469             20  FILLER      PIC X       VALUE SPACES.
  1470             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1471         16  FILLER          PIC X(80)
  1472           VALUE '* YOU ARE NOW LOGGED OFF'.
  1473         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1474         16  FILLER          PIC X       VALUE QUOTE.
  1475         16  LOGOFF-SYS-MSG  PIC X(17)
  1476           VALUE 'S CLAS-IC SYSTEM '.
  1477     12  TEXT-MESSAGES.
  1478         16  UNACCESS-MSG    PIC X(29)
  1479             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1480         16  PGMIDERR-MSG    PIC X(17)
  1481             VALUE 'PROGRAM NOT FOUND'.
  1482
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL152.cbl
  1484*                                COPY ELCNWA.
  1485*****************************************************************
  1486*                                                               *
  1487*                                                               *
  1488*                            ELCNWA.                            *
  1489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1490*                            VMOD=2.003                         *
  1491*                                                               *
  1492*            M O V E   N A M E   W O R K   A R E A.             *
  1493*                                                               *
  1494*****************************************************************.
  1495
  1496 01  WS-NAME-WORK-AREA.
  1497     05  WS-INSURED-LAST-NAME        PIC X(15).
  1498     05  WS-INSURED-1ST-NAME         PIC X(12).
  1499     05  WS-INSURED-MID-INIT         PIC X.
  1500
  1501     05  WS-NAME-WORK.
  1502         10  WS-NW                   PIC X
  1503             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1504
  1505     05  WS-NAME-WORK2.
  1506         10  WS-NW2                  PIC X
  1507             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1508                                        NWA-INDEX0.
  1509
  1510     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1511                                     COMP-3.
  1512
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL152.cbl
  1514*                                COPY ELCATTR.
  1515******************************************************************
  1516*                                                                *
  1517*                            ELCATTR.                            *
  1518*                            VMOD=2.001                          *
  1519*                                                                *
  1520*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1521*                                                                *
  1522*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1523*                                                                *
  1524*                   POS 1   P=PROTECTED                          *
  1525*                           U=UNPROTECTED                        *
  1526*                           S=ASKIP                              *
  1527*                   POS 2   A=ALPHA/NUMERIC                      *
  1528*                           N=NUMERIC                            *
  1529*                   POS 3   N=NORMAL                             *
  1530*                           B=BRIGHT                             *
  1531*                           D=DARK                               *
  1532*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1533*                           OF=MODIFIED DATA TAG OFF             *
  1534*                                                                *
  1535*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1536******************************************************************
  1537 01  ATTRIBUTE-LIST.
  1538     12  AL-PABOF            PIC X       VALUE 'Y'.
  1539     12  AL-PABON            PIC X       VALUE 'Z'.
  1540     12  AL-PADOF            PIC X       VALUE '%'.
  1541     12  AL-PADON            PIC X       VALUE '_'.
  1542     12  AL-PANOF            PIC X       VALUE '-'.
  1543     12  AL-PANON            PIC X       VALUE '/'.
  1544     12  AL-SABOF            PIC X       VALUE '8'.
  1545     12  AL-SABON            PIC X       VALUE '9'.
  1546     12  AL-SADOF            PIC X       VALUE '@'.
  1547     12  AL-SADON            PIC X       VALUE QUOTE.
  1548     12  AL-SANOF            PIC X       VALUE '0'.
  1549     12  AL-SANON            PIC X       VALUE '1'.
  1550     12  AL-UABOF            PIC X       VALUE 'H'.
  1551     12  AL-UABON            PIC X       VALUE 'I'.
  1552     12  AL-UADOF            PIC X       VALUE '<'.
  1553     12  AL-UADON            PIC X       VALUE '('.
  1554     12  AL-UANOF            PIC X       VALUE ' '.
  1555     12  AL-UANON            PIC X       VALUE 'A'.
  1556     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1557     12  AL-UNBON            PIC X       VALUE 'R'.
  1558     12  AL-UNDOF            PIC X       VALUE '*'.
  1559     12  AL-UNDON            PIC X       VALUE ')'.
  1560     12  AL-UNNOF            PIC X       VALUE '&'.
  1561     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL152.cbl
  1563*                                COPY ELCEMIB.
  1564******************************************************************
  1565*                                                                *
  1566*                                                                *
  1567*                            ELCEMIB.                            *
  1568*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1569*                            VMOD=2.005                          *
  1570*                                                                *
  1571*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1572*                                                                *
  1573******************************************************************
  1574 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1575     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1576     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1577     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1578     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1579     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1580     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1581     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1582     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1583     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1584         88  EMI-NO-ERRORS                    VALUE '1'.
  1585         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1586         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1587     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1588         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1589     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1590         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1591         88  EMI-AREA1-FULL                   VALUE '2'.
  1592     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1593         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1594         88  EMI-AREA2-FULL                   VALUE '2'.
  1595     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1596         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1597         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1598         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1599         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1600         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1601     12  EMI-ERROR-LINES.
  1602         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1603         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1604         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1605         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1606             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1607                 24  EMI-ERR-NUM         PIC X(4).
  1608                 24  EMI-FILLER          PIC X.
  1609                 24  EMI-SEV             PIC X.
  1610                 24  FILLER              PIC X.
  1611             20  FILLER                  PIC X(02).
  1612     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1613         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1614             20  EMI-ERROR-NUMBER    PIC X(4).
  1615             20  EMI-FILL            PIC X.
  1616             20  EMI-SEVERITY        PIC X.
  1617             20  FILLER              PIC X.
  1618             20  EMI-ERROR-TEXT.
  1619                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1620                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL152.cbl
  1621     12  EMI-SEVERITY-SAVE           PIC X.
  1622         88  EMI-NOTE                    VALUE 'N'.
  1623         88  EMI-WARNING                 VALUE 'W'.
  1624         88  EMI-FORCABLE                VALUE 'F'.
  1625         88  EMI-FATAL                   VALUE 'X'.
  1626     12  EMI-MESSAGE-FLAG            PIC X.
  1627         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1628         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1629     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1630     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1631         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1632         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1633         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1634     12  FILLER                      PIC X(137)  VALUE SPACES.
  1635     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1636     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1637     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1638     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1639 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL152.cbl
  1641*                                COPY ELCINTF.
  1642******************************************************************
  1643*                                                                *
  1644*                                                                *
  1645*                            ELCINTF.                            *
  1646*                            VMOD=2.017                          *
  1647*                                                                *
  1648*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1649*                                                                *
  1650*       LENGTH = 1024                                            *
  1651*                                                                *
  1652******************************************************************
  1653 01  PROGRAM-INTERFACE-BLOCK.
  1654     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1655     12  PI-CALLING-PROGRAM              PIC X(8).
  1656     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1657     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1658     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1659     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1660     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1661     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1662     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1663     12  PI-COMPANY-ID                   PIC XXX.
  1664     12  PI-COMPANY-CD                   PIC X.
  1665
  1666     12  PI-COMPANY-PASSWORD             PIC X(8).
  1667
  1668     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1669
  1670     12  PI-CONTROL-IN-PROGRESS.
  1671         16  PI-CARRIER                  PIC X.
  1672         16  PI-GROUPING                 PIC X(6).
  1673         16  PI-STATE                    PIC XX.
  1674         16  PI-ACCOUNT                  PIC X(10).
  1675         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1676                                         PIC X(10).
  1677         16  PI-CLAIM-CERT-GRP.
  1678             20  PI-CLAIM-NO             PIC X(7).
  1679             20  PI-CERT-NO.
  1680                 25  PI-CERT-PRIME       PIC X(10).
  1681                 25  PI-CERT-SFX         PIC X.
  1682             20  PI-CERT-EFF-DT          PIC XX.
  1683         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1684             20  PI-PLAN-CODE            PIC X(2).
  1685             20  PI-REVISION-NUMBER      PIC X(3).
  1686             20  PI-PLAN-EFF-DT          PIC X(2).
  1687             20  PI-PLAN-EXP-DT          PIC X(2).
  1688             20  FILLER                  PIC X(11).
  1689         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1690             20  PI-OE-REFERENCE-1.
  1691                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1692                 25  PI-OE-REF-1-SUFF    PIC XX.
  1693
  1694     12  PI-SESSION-IN-PROGRESS          PIC X.
  1695         88  CLAIM-SESSION                   VALUE '1'.
  1696         88  CREDIT-SESSION                  VALUE '2'.
  1697         88  WARRANTY-SESSION                VALUE '3'.
  1698         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL152.cbl
  1699         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1700
  1701
  1702*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1703
  1704     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1705     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1706
  1707     12  PI-CREDIT-USER                  PIC X.
  1708         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1709         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1710
  1711     12  PI-CLAIM-USER                   PIC X.
  1712         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1713         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1714
  1715     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1716         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1717         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1718         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1719         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1720         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1721
  1722     12  PI-PROCESSOR-ID                 PIC X(4).
  1723
  1724     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1725
  1726     12  PI-MEMBER-CAPTION               PIC X(10).
  1727
  1728     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1729         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1730
  1731     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1732     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1733     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1734     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1735
  1736     12  PI-AH-OVERRIDE-L1               PIC X.
  1737     12  PI-AH-OVERRIDE-L2               PIC XX.
  1738     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1739     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1740
  1741     12  PI-NEW-SYSTEM                   PIC X(2).
  1742
  1743     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1744     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1745         88  PI-USES-PAID-TO                 VALUE '1'.
  1746     12  PI-CRDTCRD-SYSTEM.
  1747         16  PI-CRDTCRD-USER             PIC X.
  1748             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1749             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1750         16  PI-CC-MONTH-END-DT          PIC XX.
  1751     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1752
  1753     12  PI-OE-REFERENCE-2.
  1754         16  PI-OE-REF-2-PRIME           PIC X(10).
  1755         16  PI-OE-REF-2-SUFF            PIC X.
  1756
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL152.cbl
  1757     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1758
  1759     12  PI-LANGUAGE-TYPE                PIC X.
  1760             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1761             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1762             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1763
  1764     12  PI-POLICY-LINKAGE-IND           PIC X.
  1765         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1766         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1767                                                   LOW-VALUES.
  1768
  1769     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1770     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1771         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1772         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1773     12  FILLER                          PIC X(4).
  1774
  1775     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1776
  1777     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1778         PI-SYSTEM-LEVEL.
  1779
  1780         16  PI-ENTRY-CODES.
  1781             20  PI-ENTRY-CD-1           PIC X.
  1782             20  PI-ENTRY-CD-2           PIC X.
  1783
  1784         16  PI-RETURN-CODES.
  1785             20  PI-RETURN-CD-1          PIC X.
  1786             20  PI-RETURN-CD-2          PIC X.
  1787
  1788         16  PI-UPDATE-STATUS-SAVE.
  1789             20  PI-UPDATE-BY            PIC X(4).
  1790             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1791
  1792         16  PI-LOWER-CASE-LETTERS       PIC X.
  1793             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1794
  1795*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1796*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1797*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1798
  1799         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1800             88  ST-ACCNT-CNTL               VALUE ' '.
  1801             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1802             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1803             88  ACCNT-CNTL                  VALUE '3'.
  1804             88  CARR-ACCNT-CNTL             VALUE '4'.
  1805
  1806         16  PI-PROCESSOR-CAP-LIST.
  1807             20  PI-SYSTEM-CONTROLS.
  1808                24 PI-SYSTEM-DISPLAY     PIC X.
  1809                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1810                24 PI-SYSTEM-MODIFY      PIC X.
  1811                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1812             20  FILLER                  PIC XX.
  1813             20  PI-DISPLAY-CAP          PIC X.
  1814                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL152.cbl
  1815             20  PI-MODIFY-CAP           PIC X.
  1816                 88  MODIFY-CAP              VALUE 'Y'.
  1817             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1818                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1819             20  PI-FORCE-CAP            PIC X.
  1820                 88  FORCE-CAP               VALUE 'Y'.
  1821
  1822         16  PI-PROGRAM-CONTROLS.
  1823             20  PI-PGM-PRINT-OPT        PIC X.
  1824             20  PI-PGM-FORMAT-OPT       PIC X.
  1825             20  PI-PGM-PROCESS-OPT      PIC X.
  1826             20  PI-PGM-TOTALS-OPT       PIC X.
  1827
  1828         16  PI-HELP-INTERFACE.
  1829             20  PI-LAST-ERROR-NO        PIC X(4).
  1830             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1831
  1832         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1833             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1834
  1835         16  PI-CR-CONTROL-IN-PROGRESS.
  1836             20  PI-CR-CARRIER           PIC X.
  1837             20  PI-CR-GROUPING          PIC X(6).
  1838             20  PI-CR-STATE             PIC XX.
  1839             20  PI-CR-ACCOUNT           PIC X(10).
  1840             20  PI-CR-FIN-RESP          PIC X(10).
  1841             20  PI-CR-TYPE              PIC X.
  1842
  1843         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1844
  1845         16  PI-CR-MONTH-END-DT          PIC XX.
  1846
  1847         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1848             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1849             88  PI-ZERO-CARRIER             VALUE '1'.
  1850             88  PI-ZERO-GROUPING            VALUE '2'.
  1851             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1852
  1853         16  PI-CARRIER-SECURITY         PIC X.
  1854             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1855
  1856         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1857             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1858             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1859
  1860         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1861             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1862                                         INDEXED BY PI-ACCESS-NDX
  1863                                         PIC X.
  1864
  1865         16  PI-GA-BILLING-CONTROL       PIC X.
  1866             88  PI-GA-BILLING               VALUE '1'.
  1867
  1868         16  PI-MAIL-PROCESSING          PIC X.
  1869             88  PI-MAIL-YES                 VALUE 'Y'.
  1870
  1871         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1872
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL152.cbl
  1873         16  PI-AR-SYSTEM.
  1874             20  PI-AR-PROCESSING-CNTL   PIC X.
  1875                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1876             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1877             20  PI-AR-MONTH-END-DT      PIC XX.
  1878
  1879         16  PI-MP-SYSTEM.
  1880             20  PI-MORTGAGE-USER            PIC X.
  1881                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1882                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1883             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1884                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1885                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1886                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1887                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1888                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1889             20  PI-MP-MONTH-END-DT          PIC XX.
  1890             20  PI-MP-REFERENCE-NO.
  1891                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1892                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1893
  1894         16  PI-LABEL-CONTROL            PIC X(01).
  1895             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1896             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1897
  1898         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1899             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1900
  1901         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1902             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1903             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1904
  1905         16  FILLER                      PIC X(14).
  1906
  1907     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1908******************************************************************
  1909     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1910*        COPY ELC1042.
  1911******************************************************************
  1912*                                                                *
  1913*                                                                *
  1914*                           ELC1042                              *
  1915*                            VMOD=2.002                          *
  1916*                                                                *
  1917*    NOTE                                                        *
  1918*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1919*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1920*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1921*        TO THESE PROGRAMS.                                      *
  1922*                                                                *
  1923*    NOTE                                                        *
  1924*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1925*        USE ONLY!                                               *
  1926*                                                                *
  1927******************************************************************
  1928
  1929         16  PI-1042-WA.
  1930             20  PI-ACTION       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL152.cbl
  1931                 88 PI-SHOW-MODE           VALUE '1'.
  1932                 88 PI-CLEAR-MODE          VALUE '2'.
  1933                 88 PI-CREATE-MODE         VALUE '3'.
  1934             20  PI-COMM-CONTROL PIC  X(12).
  1935             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1936             20  PI-EOF-SW       PIC  X(01).
  1937                 88  PI-FILE-EOF           VALUE 'Y'.
  1938             20  PI-FILETYP      PIC  X(01).
  1939             20  PI-FORM-SQUEEZE-CONTROL
  1940                                 PIC  X(01).
  1941                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1942                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1943             20  PI-LAST-CONTROL PIC  X(12).
  1944             20  PI-TEMP-STOR-ITEMS
  1945                                 PIC S9(04) COMP.
  1946             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1947             20  PI-UPDATE-SW    PIC  9(01).
  1948                 88 ANY-UPDATES            VALUE 1.
  1949             20  PI-104-SCREEN-SENT-IND
  1950                                 PIC  X(01).
  1951                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1952                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1953             20  PI-1042-SCREEN-SENT-IND
  1954                                 PIC  X(01).
  1955                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1956                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1957             20  PI-1042-ARCHIVE-IND
  1958                                 PIC  X(01).
  1959                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1960             20  FILLER          PIC  X(29).
  1961**********************************************************
  1962*    NOTE                                                *
  1963*        THE WORK AREA IS USED BY EL152 AND EL1522       *
  1964*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
  1965*        BOTH PROGRAMS.                                  *
  1966*                                                        *
  1967**********************************************************
  1968         16  PI-EL152-WA.
  1969             20  PI-ALT-PRINTER-ID        PIC X(4).
  1970             20  PI-ARCHIVE-NUMBER        PIC 9(8).
  1971             20  PI-FORM-NUMBER           PIC X(4).
  1972             20  PI-ADDR-TYPE             PIC XX.
  1973             20  PI-TEMP-STOR-ID          PIC X(8).
  1974             20  PI-NUM-PRINT-COPIES      PIC 9.
  1975             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
  1976             20  PI-PRINT-SW              PIC X.
  1977                 88 PRINT-PERFORMED  VALUE '1'.
  1978             20  PI-LETTER-ADDRESS-TYPE   PIC XX.
  1979             20  PI-RESEND-FORM-NUMBER    PIC X(4).
  1980             20  PI-PROMPT-LETTER         PIC X.
  1981             20  PI-ENCLOSURE-CD          PIC X(3).
  1982             20  PI-AUTO-CLOSE-IND        PIC X(1).
  1983             20  PI-LETTER-TO-BENE        PIC X(1).
  1984             20  PI-FILLER                PIC X(528).
  1985             20  PI-FORCE-7840            PIC X.
  1986                 88 FORCE-7840       VALUE '1'.
  1987
  1988             20  PI-BSR-LETTER-IND        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL152.cbl
  1989                 88  PI-BSR-AUTOMATED VALUE 'BA'.
  1990             20  FILLER REDEFINES PI-BSR-LETTER-IND.
  1991                 22  PI-ELLETR-BSR        PIC X.
  1992                 22  PI-ELBENE-BSR        PIC X.
  1993
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL152.cbl
  1995*                            COPY DFHBMSCA.
  1996*****************************************************************
  1997*                                                               *
  1998* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1999* All rights reserved.                                          *
  2000*                                                               *
  2001*****************************************************************
  2002 01    DFHBMSCA.
  2003*        VARIABLE  PROTECTION    INTENSITY    MODIFIED
  2004*                                             DATA TAG
  2005*
  2006*        DFHBMUNP  Unprotected   Normal       Off
  2007     02  DFHBMUNP PIC X VALUE SPACE.
  2008*        DFHBMUNN  Numeric       Normal       Off
  2009     02  DFHBMUNN PIC X VALUE "&".
  2010*        DFHBMPRO  Protected     Normal       Off
  2011     02  DFHBMPRO PIC X VALUE "-".
  2012*        DFHBMASK  Autoskip      Normal       Off
  2013     02  DFHBMASK PIC X VALUE "0".
  2014*************************************************
  2015*        DFHBMBRY  Unprotected   Bright       Off
  2016     02  DFHBMBRY PIC X VALUE "H".
  2017*        DFHPROTI  Protected     Bright       Off
  2018     02  DFHPROTI PIC X VALUE "Y".
  2019*        DFHBMASB  Autoskip      Bright       Off
  2020     02  DFHBMASB PIC X VALUE "8".
  2021*************************************************
  2022*        DFHBMDAR  Unprotected   Non-Display  Off
  2023     02  DFHBMDAR PIC X VALUE "<".
  2024*        DFHPROTN  Protected     Non-Display  Off
  2025     02  DFHPROTN PIC X VALUE "%".
  2026*************************************************
  2027*        DFHBMFSE  Unprotected   Normal       On
  2028     02  DFHBMFSE PIC X VALUE "A".
  2029*        DFHBMASF  Autoskip      Normal       On
  2030     02  DFHBMASF  PIC X VALUE "1".
  2031*        DFHUNNUM  Numeric       Normal       On
  2032     02  DFHUNNUM PIC X VALUE "J".
  2033*        DFHBMPRF  Protected     Normal       On
  2034     02  DFHBMPRF PIC X VALUE "/".
  2035*************************************************
  2036*        DFHUNIMD  Unprotected   Bright       On
  2037     02  DFHUNIMD PIC X VALUE "I".
  2038*        DFHUNINT  Numeric       Bright       On
  2039     02  DFHUNINT PIC X VALUE "R".
  2040*************************************************
  2041*        DFHUNNOD  Unprotected   Non-Display  On
  2042     02  DFHUNNOD PIC X VALUE "(".
  2043*        DFHUNNON  Numeric       Non-Display  On
  2044     02  DFHUNNON PIC X VALUE ")".
  2045*************************************************
  2046*
  2047*     COLOURS
  2048*
  2049     02  DFHDFCOL PIC X VALUE X"00".
  2050     02  DFHBLUE  PIC X VALUE "1".
  2051     02  DFHRED   PIC X VALUE "2".
  2052     02  DFHPINK  PIC X VALUE "3".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL152.cbl
  2053     02  DFHGREEN PIC X VALUE "4".
  2054     02  DFHTURQ  PIC X VALUE "5".
  2055     02  DFHYELLO PIC X VALUE "6".
  2056     02  DFHNEUTR PIC X VALUE "7".
  2057     02  DFH3270  PIC X VALUE "{".
  2058     02  DFHALL   PIC X VALUE LOW-VALUE.
  2059     02  DFHBASE  PIC X VALUE LOW-VALUE.
  2060     02  DFHBLINK PIC X VALUE "1".
  2061     02  DFHBMDET PIC X VALUE LOW-VALUE.
  2062     02  DFHBMEOF PIC X VALUE X"80".
  2063     02  DFHBMPEM PIC X VALUE X"19".
  2064* Newline, DFHBMPNL, is changed to be an ASCII 0x0A
  2065     02  DFHBMPNL PIC X VALUE X"0A".
  2066     02  DFHCOLOR PIC X VALUE "!".
  2067     02  DFHDFHI  PIC X VALUE LOW-VALUE.
  2068     02  DFHDFT   PIC X VALUE X"FF".
  2069     02  DFHERROR PIC X VALUE X"1A".
  2070     02  DFHHLT   PIC X VALUE " ".
  2071     02  DFHMENT  PIC X VALUE X"02".
  2072     02  DFHBMCUR  PIC X VALUE X"02".
  2073     02  DFHBMFLG  PIC X.
  2074         88 DFHCURSR VALUES ARE X"02" , X"82".
  2075     02  DFHMET   PIC X VALUE X"03".
  2076     02  DFHMFE   PIC X VALUE X"06".
  2077     02  DFHMFET  PIC X VALUE LOW-VALUE.
  2078     02  DFHMFIL  PIC X VALUE X"1C".
  2079     02  DFHMFT   PIC X VALUE X"09".
  2080     02  DFHMT    PIC X VALUE X"01".
  2081     02  DFHPS    PIC X VALUE '"'.
  2082     02  DFHREVRS PIC X VALUE "2".
  2083     02  DFHSA    PIC X VALUE X"08".
  2084     02  DFHUNDLN PIC X VALUE "4".
  2085     02  DFHVAL   PIC X VALUE "A".
  2086     02  DFHLEFT  PIC X VALUE X"97".
  2087     02  DFHOVER  PIC X VALUE X"9C".
  2088     02  DFHRIGHT PIC X VALUE X"02".
  2089     02  DFHUNDER PIC X VALUE X"01".
  2090     02  DFHBOX-BIN  PIC 9(4) COMP VALUE 15.
  2091     02  FILLER REDEFINES DFHBOX-BIN.
  2092         03  FILLER PIC X.
  2093         03  DFHBOX PIC X.
  2094     02  DFHSOSI  PIC X VALUE X"01".
  2095     02  DFHBMPSO-BIN    PIC 9(4) COMP VALUE 3599.
  2096     02  FILLER REDEFINES DFHBMPSO-BIN.
  2097         03 DFHBMPSO  PIC X.
  2098         03 DFHBMPSI  PIC X.
  2099     02  DFHBMEC  PIC X VALUE X"82".
  2100*    02  DFHDFFR  PIC X VALUE X"00".
  2101*    02  DFHOPAQ  PIC X VALUE X"00".
  2102*    02  DFHOUTLN PIC X VALUE X"00".
  2103*    02  DFHTRANS PIC X VALUE X"00".
  2104*    02  DFHBKTRN PIC X VALUE X"00".
  2105*                            COPY ELCAID.
  2106******************************************************************
  2107*                                                                *
  2108*                            ELCAID.                             *
  2109*                            VMOD=2.001                          *
  2110*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL152.cbl
  2111*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2112*                                                                *
  2113*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2114*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2115******************************************************************
  2116
  2117 01  DFHAID.
  2118   02  DFHNULL   PIC  X  VALUE  ' '.
  2119   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2120   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2121   02  DFHPEN    PIC  X  VALUE  '='.
  2122   02  DFHOPID   PIC  X  VALUE  'W'.
  2123   02  DFHPA1    PIC  X  VALUE  '%'.
  2124   02  DFHPA2    PIC  X  VALUE  '>'.
  2125   02  DFHPA3    PIC  X  VALUE  ','.
  2126   02  DFHPF1    PIC  X  VALUE  '1'.
  2127   02  DFHPF2    PIC  X  VALUE  '2'.
  2128   02  DFHPF3    PIC  X  VALUE  '3'.
  2129   02  DFHPF4    PIC  X  VALUE  '4'.
  2130   02  DFHPF5    PIC  X  VALUE  '5'.
  2131   02  DFHPF6    PIC  X  VALUE  '6'.
  2132   02  DFHPF7    PIC  X  VALUE  '7'.
  2133   02  DFHPF8    PIC  X  VALUE  '8'.
  2134   02  DFHPF9    PIC  X  VALUE  '9'.
  2135   02  DFHPF10   PIC  X  VALUE  ':'.
  2136   02  DFHPF11   PIC  X  VALUE  '#'.
  2137   02  DFHPF12   PIC  X  VALUE  '@'.
  2138   02  DFHPF13   PIC  X  VALUE  'A'.
  2139   02  DFHPF14   PIC  X  VALUE  'B'.
  2140   02  DFHPF15   PIC  X  VALUE  'C'.
  2141   02  DFHPF16   PIC  X  VALUE  'D'.
  2142   02  DFHPF17   PIC  X  VALUE  'E'.
  2143   02  DFHPF18   PIC  X  VALUE  'F'.
  2144   02  DFHPF19   PIC  X  VALUE  'G'.
  2145   02  DFHPF20   PIC  X  VALUE  'H'.
  2146   02  DFHPF21   PIC  X  VALUE  'I'.
  2147*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2148   02  DFHPF22   PIC  X  VALUE  '['.
  2149   02  DFHPF23   PIC  X  VALUE  '.'.
  2150   02  DFHPF24   PIC  X  VALUE  '<'.
  2151   02  DFHMSRE   PIC  X  VALUE  'X'.
  2152   02  DFHSTRF   PIC  X  VALUE  'h'.
  2153   02  DFHTRIG   PIC  X  VALUE  '"'.
  2154 01  FILLER    REDEFINES DFHAID.
  2155     12  FILLER              PIC X(8).
  2156     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL152.cbl
  2158*                            COPY EL152S.
  2159 01  EL152AI.
  2160     05  FILLER            PIC  X(0012).
  2161*    -------------------------------
  2162     05  DATEAL PIC S9(0004) COMP.
  2163     05  DATEAF PIC  X(0001).
  2164     05  FILLER REDEFINES DATEAF.
  2165         10  DATEAA PIC  X(0001).
  2166     05  DATEAI PIC  X(0008).
  2167*    -------------------------------
  2168     05  TIMEAL PIC S9(0004) COMP.
  2169     05  TIMEAF PIC  X(0001).
  2170     05  FILLER REDEFINES TIMEAF.
  2171         10  TIMEAA PIC  X(0001).
  2172     05  TIMEAI PIC  X(0005).
  2173*    -------------------------------
  2174     05  CARRL PIC S9(0004) COMP.
  2175     05  CARRF PIC  X(0001).
  2176     05  FILLER REDEFINES CARRF.
  2177         10  CARRA PIC  X(0001).
  2178     05  CARRI PIC  X(0001).
  2179*    -------------------------------
  2180     05  CLMNOL PIC S9(0004) COMP.
  2181     05  CLMNOF PIC  X(0001).
  2182     05  FILLER REDEFINES CLMNOF.
  2183         10  CLMNOA PIC  X(0001).
  2184     05  CLMNOI PIC  X(0007).
  2185*    -------------------------------
  2186     05  CRTNOL PIC S9(0004) COMP.
  2187     05  CRTNOF PIC  X(0001).
  2188     05  FILLER REDEFINES CRTNOF.
  2189         10  CRTNOA PIC  X(0001).
  2190     05  CRTNOI PIC  X(0011).
  2191*    -------------------------------
  2192     05  PROCL PIC S9(0004) COMP.
  2193     05  PROCF PIC  X(0001).
  2194     05  FILLER REDEFINES PROCF.
  2195         10  PROCA PIC  X(0001).
  2196     05  PROCI PIC  X(0004).
  2197*    -------------------------------
  2198     05  COMPIDL PIC S9(0004) COMP.
  2199     05  COMPIDF PIC  X(0001).
  2200     05  FILLER REDEFINES COMPIDF.
  2201         10  COMPIDA PIC  X(0001).
  2202     05  COMPIDI PIC  X(0003).
  2203*    -------------------------------
  2204     05  CLEANL PIC S9(0004) COMP.
  2205     05  CLEANF PIC  X(0001).
  2206     05  FILLER REDEFINES CLEANF.
  2207         10  CLEANA PIC  X(0001).
  2208     05  CLEANI PIC  X(0001).
  2209*    -------------------------------
  2210     05  SYSL PIC S9(0004) COMP.
  2211     05  SYSF PIC  X(0001).
  2212     05  FILLER REDEFINES SYSF.
  2213         10  SYSA PIC  X(0001).
  2214     05  SYSI PIC  X(0008).
  2215*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL152.cbl
  2216     05  MAINTL PIC S9(0004) COMP.
  2217     05  MAINTF PIC  X(0001).
  2218     05  FILLER REDEFINES MAINTF.
  2219         10  MAINTA PIC  X(0001).
  2220     05  MAINTI PIC  X(0001).
  2221*    -------------------------------
  2222     05  ARCHNUML PIC S9(0004) COMP.
  2223     05  ARCHNUMF PIC  X(0001).
  2224     05  FILLER REDEFINES ARCHNUMF.
  2225         10  ARCHNUMA PIC  X(0001).
  2226     05  ARCHNUMI PIC  99999999.
  2227*    -------------------------------
  2228     05  FORML PIC S9(0004) COMP.
  2229     05  FORMF PIC  X(0001).
  2230     05  FILLER REDEFINES FORMF.
  2231         10  FORMA PIC  X(0001).
  2232     05  FORMI PIC  X(0004).
  2233*    -------------------------------
  2234     05  FOLLOWL PIC S9(0004) COMP.
  2235     05  FOLLOWF PIC  X(0001).
  2236     05  FILLER REDEFINES FOLLOWF.
  2237         10  FOLLOWA PIC  X(0001).
  2238     05  FOLLOWI PIC  X(0008).
  2239*    -------------------------------
  2240     05  RESENDL PIC S9(0004) COMP.
  2241     05  RESENDF PIC  X(0001).
  2242     05  FILLER REDEFINES RESENDF.
  2243         10  RESENDA PIC  X(0001).
  2244     05  RESENDI PIC  X(0008).
  2245*    -------------------------------
  2246     05  PRINTL PIC S9(0004) COMP.
  2247     05  PRINTF PIC  X(0001).
  2248     05  FILLER REDEFINES PRINTF.
  2249         10  PRINTA PIC  X(0001).
  2250     05  PRINTI PIC  X(0001).
  2251*    -------------------------------
  2252     05  COPIESL PIC S9(0004) COMP.
  2253     05  COPIESF PIC  X(0001).
  2254     05  FILLER REDEFINES COPIESF.
  2255         10  COPIESA PIC  X(0001).
  2256     05  COPIESI PIC  X(0001).
  2257*    -------------------------------
  2258     05  ENCL PIC S9(0004) COMP.
  2259     05  ENCF PIC  X(0001).
  2260     05  FILLER REDEFINES ENCF.
  2261         10  ENCA PIC  X(0001).
  2262     05  ENCI PIC  X(0003).
  2263*    -------------------------------
  2264     05  ADDRL PIC S9(0004) COMP.
  2265     05  ADDRF PIC  X(0001).
  2266     05  FILLER REDEFINES ADDRF.
  2267         10  ADDRA PIC  X(0001).
  2268     05  ADDRI PIC  X(0002).
  2269*    -------------------------------
  2270     05  ACTL PIC S9(0004) COMP.
  2271     05  ACTF PIC  X(0001).
  2272     05  FILLER REDEFINES ACTF.
  2273         10  ACTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL152.cbl
  2274     05  ACTI PIC  X(0001).
  2275*    -------------------------------
  2276     05  BENL PIC S9(0004) COMP.
  2277     05  BENF PIC  X(0001).
  2278     05  FILLER REDEFINES BENF.
  2279         10  BENA PIC  X(0001).
  2280     05  BENI PIC  X(0001).
  2281*    -------------------------------
  2282     05  EMPL PIC S9(0004) COMP.
  2283     05  EMPF PIC  X(0001).
  2284     05  FILLER REDEFINES EMPF.
  2285         10  EMPA PIC  X(0001).
  2286     05  EMPI PIC  X(0001).
  2287*    -------------------------------
  2288     05  INSL PIC S9(0004) COMP.
  2289     05  INSF PIC  X(0001).
  2290     05  FILLER REDEFINES INSF.
  2291         10  INSA PIC  X(0001).
  2292     05  INSI PIC  X(0001).
  2293*    -------------------------------
  2294     05  PHYSL PIC S9(0004) COMP.
  2295     05  PHYSF PIC  X(0001).
  2296     05  FILLER REDEFINES PHYSF.
  2297         10  PHYSA PIC  X(0001).
  2298     05  PHYSI PIC  X(0001).
  2299*    -------------------------------
  2300     05  OTHR1L PIC S9(0004) COMP.
  2301     05  OTHR1F PIC  X(0001).
  2302     05  FILLER REDEFINES OTHR1F.
  2303         10  OTHR1A PIC  X(0001).
  2304     05  OTHR1I PIC  X(0001).
  2305*    -------------------------------
  2306     05  OTHR2L PIC S9(0004) COMP.
  2307     05  OTHR2F PIC  X(0001).
  2308     05  FILLER REDEFINES OTHR2F.
  2309         10  OTHR2A PIC  X(0001).
  2310     05  OTHR2I PIC  X(0001).
  2311*    -------------------------------
  2312     05  REL PIC S9(0004) COMP.
  2313     05  REF PIC  X(0001).
  2314     05  FILLER REDEFINES REF.
  2315         10  REA PIC  X(0001).
  2316     05  REI PIC  X(0070).
  2317*    -------------------------------
  2318     05  L1L PIC S9(0004) COMP.
  2319     05  L1F PIC  X(0001).
  2320     05  FILLER REDEFINES L1F.
  2321         10  L1A PIC  X(0001).
  2322     05  L1I PIC  X(0003).
  2323*    -------------------------------
  2324     05  TEXT1L PIC S9(0004) COMP.
  2325     05  TEXT1F PIC  X(0001).
  2326     05  FILLER REDEFINES TEXT1F.
  2327         10  TEXT1A PIC  X(0001).
  2328     05  TEXT1I PIC  X(0070).
  2329*    -------------------------------
  2330     05  L2L PIC S9(0004) COMP.
  2331     05  L2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL152.cbl
  2332     05  FILLER REDEFINES L2F.
  2333         10  L2A PIC  X(0001).
  2334     05  L2I PIC  X(0003).
  2335*    -------------------------------
  2336     05  TEXT2L PIC S9(0004) COMP.
  2337     05  TEXT2F PIC  X(0001).
  2338     05  FILLER REDEFINES TEXT2F.
  2339         10  TEXT2A PIC  X(0001).
  2340     05  TEXT2I PIC  X(0070).
  2341*    -------------------------------
  2342     05  L3L PIC S9(0004) COMP.
  2343     05  L3F PIC  X(0001).
  2344     05  FILLER REDEFINES L3F.
  2345         10  L3A PIC  X(0001).
  2346     05  L3I PIC  X(0003).
  2347*    -------------------------------
  2348     05  TEXT3L PIC S9(0004) COMP.
  2349     05  TEXT3F PIC  X(0001).
  2350     05  FILLER REDEFINES TEXT3F.
  2351         10  TEXT3A PIC  X(0001).
  2352     05  TEXT3I PIC  X(0070).
  2353*    -------------------------------
  2354     05  L4L PIC S9(0004) COMP.
  2355     05  L4F PIC  X(0001).
  2356     05  FILLER REDEFINES L4F.
  2357         10  L4A PIC  X(0001).
  2358     05  L4I PIC  X(0003).
  2359*    -------------------------------
  2360     05  TEXT4L PIC S9(0004) COMP.
  2361     05  TEXT4F PIC  X(0001).
  2362     05  FILLER REDEFINES TEXT4F.
  2363         10  TEXT4A PIC  X(0001).
  2364     05  TEXT4I PIC  X(0070).
  2365*    -------------------------------
  2366     05  L5L PIC S9(0004) COMP.
  2367     05  L5F PIC  X(0001).
  2368     05  FILLER REDEFINES L5F.
  2369         10  L5A PIC  X(0001).
  2370     05  L5I PIC  X(0003).
  2371*    -------------------------------
  2372     05  TEXT5L PIC S9(0004) COMP.
  2373     05  TEXT5F PIC  X(0001).
  2374     05  FILLER REDEFINES TEXT5F.
  2375         10  TEXT5A PIC  X(0001).
  2376     05  TEXT5I PIC  X(0070).
  2377*    -------------------------------
  2378     05  L6L PIC S9(0004) COMP.
  2379     05  L6F PIC  X(0001).
  2380     05  FILLER REDEFINES L6F.
  2381         10  L6A PIC  X(0001).
  2382     05  L6I PIC  X(0003).
  2383*    -------------------------------
  2384     05  TEXT6L PIC S9(0004) COMP.
  2385     05  TEXT6F PIC  X(0001).
  2386     05  FILLER REDEFINES TEXT6F.
  2387         10  TEXT6A PIC  X(0001).
  2388     05  TEXT6I PIC  X(0070).
  2389*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL152.cbl
  2390     05  L7L PIC S9(0004) COMP.
  2391     05  L7F PIC  X(0001).
  2392     05  FILLER REDEFINES L7F.
  2393         10  L7A PIC  X(0001).
  2394     05  L7I PIC  X(0003).
  2395*    -------------------------------
  2396     05  TEXT7L PIC S9(0004) COMP.
  2397     05  TEXT7F PIC  X(0001).
  2398     05  FILLER REDEFINES TEXT7F.
  2399         10  TEXT7A PIC  X(0001).
  2400     05  TEXT7I PIC  X(0070).
  2401*    -------------------------------
  2402     05  L8L PIC S9(0004) COMP.
  2403     05  L8F PIC  X(0001).
  2404     05  FILLER REDEFINES L8F.
  2405         10  L8A PIC  X(0001).
  2406     05  L8I PIC  X(0003).
  2407*    -------------------------------
  2408     05  TEXT8L PIC S9(0004) COMP.
  2409     05  TEXT8F PIC  X(0001).
  2410     05  FILLER REDEFINES TEXT8F.
  2411         10  TEXT8A PIC  X(0001).
  2412     05  TEXT8I PIC  X(0070).
  2413*    -------------------------------
  2414     05  L9L PIC S9(0004) COMP.
  2415     05  L9F PIC  X(0001).
  2416     05  FILLER REDEFINES L9F.
  2417         10  L9A PIC  X(0001).
  2418     05  L9I PIC  X(0003).
  2419*    -------------------------------
  2420     05  TEXT9L PIC S9(0004) COMP.
  2421     05  TEXT9F PIC  X(0001).
  2422     05  FILLER REDEFINES TEXT9F.
  2423         10  TEXT9A PIC  X(0001).
  2424     05  TEXT9I PIC  X(0070).
  2425*    -------------------------------
  2426     05  L10L PIC S9(0004) COMP.
  2427     05  L10F PIC  X(0001).
  2428     05  FILLER REDEFINES L10F.
  2429         10  L10A PIC  X(0001).
  2430     05  L10I PIC  X(0003).
  2431*    -------------------------------
  2432     05  TEXT10L PIC S9(0004) COMP.
  2433     05  TEXT10F PIC  X(0001).
  2434     05  FILLER REDEFINES TEXT10F.
  2435         10  TEXT10A PIC  X(0001).
  2436     05  TEXT10I PIC  X(0070).
  2437*    -------------------------------
  2438     05  L11L PIC S9(0004) COMP.
  2439     05  L11F PIC  X(0001).
  2440     05  FILLER REDEFINES L11F.
  2441         10  L11A PIC  X(0001).
  2442     05  L11I PIC  X(0003).
  2443*    -------------------------------
  2444     05  TEXT11L PIC S9(0004) COMP.
  2445     05  TEXT11F PIC  X(0001).
  2446     05  FILLER REDEFINES TEXT11F.
  2447         10  TEXT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL152.cbl
  2448     05  TEXT11I PIC  X(0070).
  2449*    -------------------------------
  2450     05  L12L PIC S9(0004) COMP.
  2451     05  L12F PIC  X(0001).
  2452     05  FILLER REDEFINES L12F.
  2453         10  L12A PIC  X(0001).
  2454     05  L12I PIC  X(0003).
  2455*    -------------------------------
  2456     05  TEXT12L PIC S9(0004) COMP.
  2457     05  TEXT12F PIC  X(0001).
  2458     05  FILLER REDEFINES TEXT12F.
  2459         10  TEXT12A PIC  X(0001).
  2460     05  TEXT12I PIC  X(0070).
  2461*    -------------------------------
  2462     05  L13L PIC S9(0004) COMP.
  2463     05  L13F PIC  X(0001).
  2464     05  FILLER REDEFINES L13F.
  2465         10  L13A PIC  X(0001).
  2466     05  L13I PIC  X(0003).
  2467*    -------------------------------
  2468     05  TEXT13L PIC S9(0004) COMP.
  2469     05  TEXT13F PIC  X(0001).
  2470     05  FILLER REDEFINES TEXT13F.
  2471         10  TEXT13A PIC  X(0001).
  2472     05  TEXT13I PIC  X(0070).
  2473*    -------------------------------
  2474     05  ERRMSGL PIC S9(0004) COMP.
  2475     05  ERRMSGF PIC  X(0001).
  2476     05  FILLER REDEFINES ERRMSGF.
  2477         10  ERRMSGA PIC  X(0001).
  2478     05  ERRMSGI PIC  X(0072).
  2479*    -------------------------------
  2480     05  ENTERPFL PIC S9(0004) COMP.
  2481     05  ENTERPFF PIC  X(0001).
  2482     05  FILLER REDEFINES ENTERPFF.
  2483         10  ENTERPFA PIC  X(0001).
  2484     05  ENTERPFI PIC  99.
  2485*    -------------------------------
  2486     05  PRINTERL PIC S9(0004) COMP.
  2487     05  PRINTERF PIC  X(0001).
  2488     05  FILLER REDEFINES PRINTERF.
  2489         10  PRINTERA PIC  X(0001).
  2490     05  PRINTERI PIC  X(0004).
  2491*    -------------------------------
  2492     05  PFKEY9L PIC S9(0004) COMP.
  2493     05  PFKEY9F PIC  X(0001).
  2494     05  FILLER REDEFINES PFKEY9F.
  2495         10  PFKEY9A PIC  X(0001).
  2496     05  PFKEY9I PIC  X(0014).
  2497 01  EL152AO REDEFINES EL152AI.
  2498     05  FILLER            PIC  X(0012).
  2499*    -------------------------------
  2500     05  FILLER            PIC  X(0003).
  2501     05  DATEAO PIC  X(0008).
  2502*    -------------------------------
  2503     05  FILLER            PIC  X(0003).
  2504     05  TIMEAO PIC  99.99.
  2505*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL152.cbl
  2506     05  FILLER            PIC  X(0003).
  2507     05  CARRO PIC  X(0001).
  2508*    -------------------------------
  2509     05  FILLER            PIC  X(0003).
  2510     05  CLMNOO PIC  X(0007).
  2511*    -------------------------------
  2512     05  FILLER            PIC  X(0003).
  2513     05  CRTNOO PIC  X(0011).
  2514*    -------------------------------
  2515     05  FILLER            PIC  X(0003).
  2516     05  PROCO PIC  X(0004).
  2517*    -------------------------------
  2518     05  FILLER            PIC  X(0003).
  2519     05  COMPIDO PIC  X(0003).
  2520*    -------------------------------
  2521     05  FILLER            PIC  X(0003).
  2522     05  CLEANO PIC  X(0001).
  2523*    -------------------------------
  2524     05  FILLER            PIC  X(0003).
  2525     05  SYSO PIC  X(0008).
  2526*    -------------------------------
  2527     05  FILLER            PIC  X(0003).
  2528     05  MAINTO PIC  X(0001).
  2529*    -------------------------------
  2530     05  FILLER            PIC  X(0003).
  2531     05  ARCHNUMO PIC  X(0008).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
  2534     05  FORMO PIC  X(0004).
  2535*    -------------------------------
  2536     05  FILLER            PIC  X(0003).
  2537     05  FOLLOWO PIC  X(0008).
  2538*    -------------------------------
  2539     05  FILLER            PIC  X(0003).
  2540     05  RESENDO PIC  X(0008).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  PRINTO PIC  X(0001).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  COPIESO PIC  X(0001).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  ENCO PIC  X(0003).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  ADDRO PIC  X(0002).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  ACTO PIC  X(0001).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  BENO PIC  X(0001).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  EMPO PIC  X(0001).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL152.cbl
  2564     05  INSO PIC  X(0001).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  PHYSO PIC  X(0001).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  OTHR1O PIC  X(0001).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  OTHR2O PIC  X(0001).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  REO PIC  X(0070).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  L1O PIC  X(0003).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  TEXT1O PIC  X(0070).
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  L2O PIC  X(0003).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  TEXT2O PIC  X(0070).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  L3O PIC  X(0003).
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
  2594     05  TEXT3O PIC  X(0070).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
  2597     05  L4O PIC  X(0003).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  TEXT4O PIC  X(0070).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  L5O PIC  X(0003).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  TEXT5O PIC  X(0070).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  L6O PIC  X(0003).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  TEXT6O PIC  X(0070).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  L7O PIC  X(0003).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  TEXT7O PIC  X(0070).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  L8O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL152.cbl
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  TEXT8O PIC  X(0070).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  L9O PIC  X(0003).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  TEXT9O PIC  X(0070).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  L10O PIC  X(0003).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  TEXT10O PIC  X(0070).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  L11O PIC  X(0003).
  2640*    -------------------------------
  2641     05  FILLER            PIC  X(0003).
  2642     05  TEXT11O PIC  X(0070).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  L12O PIC  X(0003).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  TEXT12O PIC  X(0070).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  L13O PIC  X(0003).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  TEXT13O PIC  X(0070).
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  ERRMSGO PIC  X(0072).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  ENTERPFO PIC  X(0002).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  PRINTERO PIC  X(0004).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  PFKEY9O PIC  X(0014).
  2667*    -------------------------------
  2668 01  MAP-REDEF REDEFINES EL152AI.
  2669     12  FILLER              PIC X(251).
  2670*    12  FILLER              PIC X(189).
  2671     12  EL152RI.
  2672       14  TEXT-LINES OCCURS 13 TIMES INDEXED BY SC-INDX.
  2673         16  SC-LINEL        PIC S9(4)  COMP.
  2674         16  SC-LINEA        PIC X.
  2675         16  SC-LINE         PIC XXX.
  2676         16  SC-TEXTL        PIC S9(4)  COMP.
  2677         16  SC-TEXTA        PIC X.
  2678         16  SC-TEXT         PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL152.cbl
  2680 01  RECORD-TABLE            PIC X(21900) VALUE SPACES.
  2681
  2682 01  REC-TABLE REDEFINES RECORD-TABLE.
  2683     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX
  2684                             PIC X(3650).
  2685
  2686 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2687     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2688         16  REC-TEXT        PIC X(70).
  2689         16  REC-PC          PIC 99.
  2690         16  FILLER          PIC X.
  2691
  2692 01  TS-WORK-AREA            PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL152.cbl
  2694****************************************************************
  2695*
  2696* Copyright (c) 2007 by Clerity Solutions, Inc.
  2697* All rights reserved.
  2698*
  2699****************************************************************
  2700 01  DFHEIV.
  2701   02  DFHEIV0               PIC X(35).
  2702   02  DFHEIV1               PIC X(08).
  2703   02  DFHEIV2               PIC X(08).
  2704   02  DFHEIV3               PIC X(08).
  2705   02  DFHEIV4               PIC X(06).
  2706   02  DFHEIV5               PIC X(04).
  2707   02  DFHEIV6               PIC X(04).
  2708   02  DFHEIV7               PIC X(02).
  2709   02  DFHEIV8               PIC X(02).
  2710   02  DFHEIV9               PIC X(01).
  2711   02  DFHEIV10              PIC S9(7) COMP-3.
  2712   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2713   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2714   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2715   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2716   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2717   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2718   02  DFHEIV17              PIC X(04).
  2719   02  DFHEIV18              PIC X(04).
  2720   02  DFHEIV19              PIC X(04).
  2721   02  DFHEIV20              USAGE IS POINTER.
  2722   02  DFHEIV21              USAGE IS POINTER.
  2723   02  DFHEIV22              USAGE IS POINTER.
  2724   02  DFHEIV23              USAGE IS POINTER.
  2725   02  DFHEIV24              USAGE IS POINTER.
  2726   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2727   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2728   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2729   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2730   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2731   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2732   02  FILLER                PIC X(02).
  2733   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2734   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2735   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2736   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2737   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2738 LINKAGE  SECTION.
  2739*****************************************************************
  2740*                                                               *
  2741* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2742* All rights reserved.                                          *
  2743*                                                               *
  2744*****************************************************************
  2745 01  dfheiblk.
  2746     02  eibtime          pic s9(7) comp-3.
  2747     02  eibdate          pic s9(7) comp-3.
  2748     02  eibtrnid         pic x(4).
  2749     02  eibtaskn         pic s9(7) comp-3.
  2750     02  eibtrmid         pic x(4).
  2751     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL152.cbl
  2752     02  eibcposn         pic s9(4) comp.
  2753     02  eibcalen         pic s9(4) comp.
  2754     02  eibaid           pic x(1).
  2755     02  eibfiller1       pic x(1).
  2756     02  eibfn            pic x(2).
  2757     02  eibfiller2       pic x(2).
  2758     02  eibrcode         pic x(6).
  2759     02  eibfiller3       pic x(2).
  2760     02  eibds            pic x(8).
  2761     02  eibreqid         pic x(8).
  2762     02  eibrsrce         pic x(8).
  2763     02  eibsync          pic x(1).
  2764     02  eibfree          pic x(1).
  2765     02  eibrecv          pic x(1).
  2766     02  eibsend          pic x(1).
  2767     02  eibatt           pic x(1).
  2768     02  eibeoc           pic x(1).
  2769     02  eibfmh           pic x(1).
  2770     02  eibcompl         pic x(1).
  2771     02  eibsig           pic x(1).
  2772     02  eibconf          pic x(1).
  2773     02  eiberr           pic x(1).
  2774     02  eibrldbk         pic x(1).
  2775     02  eiberrcd         pic x(4).
  2776     02  eibsynrb         pic x(1).
  2777     02  eibnodat         pic x(1).
  2778     02  eibfiller5       pic x(2).
  2779     02  eibresp          pic 9(09) comp.
  2780     02  eibresp2         pic 9(09) comp.
  2781     02  dfheigdj         pic s9(4) comp.
  2782     02  dfheigdk         pic s9(4) comp.
  2783 01  DFHCOMMAREA                 PIC X(1024).
  2784
  2785 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL152.cbl
  2787*                                COPY ELCMSTR.
  2788******************************************************************
  2789*                                                                *
  2790*                            ELCMSTR.                            *
  2791*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2792*                            VMOD=2.012                          *
  2793*                                                                *
  2794*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  2795*                                                                *
  2796*   FILE TYPE = VSAM,KSDS                                        *
  2797*   RECORD SIZE = 350  RECFORM = FIXED                           *
  2798*                                                                *
  2799*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  2800*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  2801*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  2802*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  2803*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  2804*                                                 RKP=75,LEN=21  *
  2805*                                                                *
  2806*   **** NOTE ****                                               *
  2807*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  2808*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  2809*                                                                *
  2810*   LOG = YES                                                    *
  2811*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2812******************************************************************
  2813*                   C H A N G E   L O G
  2814*
  2815* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2816*-----------------------------------------------------------------
  2817*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2818* EFFECTIVE    NUMBER
  2819*-----------------------------------------------------------------
  2820* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2821* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2822******************************************************************
  2823 01  CLAIM-MASTER.
  2824     12  CL-RECORD-ID                PIC XX.
  2825         88  VALID-CL-ID         VALUE 'CL'.
  2826
  2827     12  CL-CONTROL-PRIMARY.
  2828         16  CL-COMPANY-CD           PIC X.
  2829         16  CL-CARRIER              PIC X.
  2830         16  CL-CLAIM-NO             PIC X(7).
  2831         16  CL-CERT-NO.
  2832             20  CL-CERT-PRIME       PIC X(10).
  2833             20  CL-CERT-SFX         PIC X.
  2834
  2835     12  CL-CONTROL-BY-NAME.
  2836         16  CL-COMPANY-CD-A1        PIC X.
  2837         16  CL-INSURED-LAST-NAME    PIC X(15).
  2838         16  CL-INSURED-NAME.
  2839             20  CL-INSURED-1ST-NAME PIC X(12).
  2840             20  CL-INSURED-MID-INIT PIC X.
  2841
  2842     12  CL-CONTROL-BY-SSN.
  2843         16  CL-COMPANY-CD-A2        PIC X.
  2844         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL152.cbl
  2845             20  CL-SSN-STATE        PIC XX.
  2846             20  CL-SSN-ACCOUNT      PIC X(6).
  2847             20  CL-SSN-LN3          PIC X(3).
  2848
  2849     12  CL-CONTROL-BY-CERT-NO.
  2850         16  CL-COMPANY-CD-A4        PIC X.
  2851         16  CL-CERT-NO-A4.
  2852             20  CL-CERT-A4-PRIME    PIC X(10).
  2853             20  CL-CERT-A4-SFX      PIC X.
  2854
  2855     12  CL-CONTROL-BY-CCN.
  2856         16  CL-COMPANY-CD-A5        PIC X.
  2857         16  CL-CCN-A5.
  2858             20  CL-CCN.
  2859                 24  CL-CCN-PREFIX-A5 PIC X(4).
  2860                 24  CL-CCN-PRIME-A5 PIC X(12).
  2861             20  CL-CCN-FILLER-A5    PIC X(4).
  2862
  2863     12  CL-INSURED-PROFILE-DATA.
  2864         16  CL-INSURED-BIRTH-DT     PIC XX.
  2865         16  CL-INSURED-SEX-CD       PIC X.
  2866             88  INSURED-IS-MALE        VALUE 'M'.
  2867             88  INSURED-IS-FEMALE      VALUE 'F'.
  2868             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  2869         16  CL-INSURED-OCC-CD       PIC X(6).
  2870         16  FILLER                  PIC X(5).
  2871
  2872     12  CL-PROCESSING-INFO.
  2873         16  CL-PROCESSOR-ID         PIC X(4).
  2874         16  CL-CLAIM-STATUS         PIC X.
  2875             88  CLAIM-IS-OPEN          VALUE 'O'.
  2876             88  CLAIM-IS-CLOSED        VALUE 'C'.
  2877         16  CL-CLAIM-TYPE           PIC X.
  2878*            88  AH-CLAIM               VALUE 'A'.
  2879*            88  LIFE-CLAIM             VALUE 'L'.
  2880*            88  PROPERTY-CLAIM         VALUE 'P'.
  2881*            88  IUI-CLAIM              VALUE 'I'.
  2882*            88  GAP-CLAIM              VALUE 'G'.
  2883         16  CL-CLAIM-PREM-TYPE      PIC X.
  2884             88  SINGLE-PREMIUM         VALUE '1'.
  2885             88  O-B-COVERAGE           VALUE '2'.
  2886             88  OPEN-END-COVERAGE      VALUE '3'.
  2887         16  CL-INCURRED-DT          PIC XX.
  2888         16  CL-REPORTED-DT          PIC XX.
  2889         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2890         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2891         16  CL-LAST-PMT-DT          PIC XX.
  2892         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2893         16  CL-PAID-THRU-DT         PIC XX.
  2894         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2895         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2896         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2897         16  CL-PMT-CALC-METHOD      PIC X.
  2898             88  CL-360-DAY-YR          VALUE '1'.
  2899             88  CL-365-DAY-YR          VALUE '2'.
  2900             88  CL-FULL-MONTHS         VALUE '3'.
  2901         16  CL-CAUSE-CD             PIC X(6).
  2902
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL152.cbl
  2903         16  CL-PRIME-CERT-NO.
  2904             20  CL-PRIME-CERT-PRIME PIC X(10).
  2905             20  CL-PRIME-CERT-SFX   PIC X.
  2906
  2907         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2908             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2909             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2910
  2911         16  CL-MICROFILM-NO         PIC X(10).
  2912         16  CL-PROG-FORM-TYPE       PIC X.
  2913         16  CL-LAST-ADD-ON-DT       PIC XX.
  2914
  2915         16  CL-LAST-REOPEN-DT       PIC XX.
  2916         16  CL-LAST-CLOSE-DT        PIC XX.
  2917         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2918             88  FINAL-PAID             VALUE '1'.
  2919             88  CLAIM-DENIED           VALUE '2'.
  2920             88  AUTO-CLOSE             VALUE '3'.
  2921             88  MANUAL-CLOSE           VALUE '4'.
  2922             88  BENEFITS-CHANGED       VALUE 'C'.
  2923             88  SETUP-ERRORS           VALUE 'E'.
  2924         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2925         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2926         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2927             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2928         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2929         16  FILLER                  PIC X.
  2930
  2931     12  CL-CERTIFICATE-DATA.
  2932         16  CL-CERT-ORIGIN          PIC X.
  2933             88  CERT-WAS-ONLINE        VALUE '1'.
  2934             88  CERT-WAS-CREATED       VALUE '2'.
  2935             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2936         16  CL-CERT-KEY-DATA.
  2937             20  CL-CERT-CARRIER     PIC X.
  2938             20  CL-CERT-GROUPING    PIC X(6).
  2939             20  CL-CERT-STATE       PIC XX.
  2940             20  CL-CERT-ACCOUNT.
  2941                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2942                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2943             20  CL-CERT-EFF-DT      PIC XX.
  2944
  2945     12  CL-STATUS-CONTROLS.
  2946         16  CL-PRIORITY-CD          PIC X.
  2947             88  CONFIDENTIAL-DATA      VALUE '8'.
  2948             88  HIGHEST-PRIORITY       VALUE '9'.
  2949         16  CL-SUPV-ATTN-CD         PIC X.
  2950             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2951             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2952         16  CL-PURGED-DT            PIC XX.
  2953         16  CL-RESTORED-DT          PIC XX.
  2954         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2955         16  CL-NEXT-RESEND-DT       PIC XX.
  2956         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2957         16  FILLER                  PIC XX.
  2958         16  CL-LAST-MAINT-DT        PIC XX.
  2959         16  CL-LAST-MAINT-USER      PIC X(4).
  2960         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL152.cbl
  2961         16  CL-LAST-MAINT-TYPE      PIC X.
  2962             88  CLAIM-SET-UP           VALUE ' '.
  2963             88  PAYMENT-MADE           VALUE '1'.
  2964             88  LETTER-SENT            VALUE '2'.
  2965             88  MASTER-WAS-ALTERED     VALUE '3'.
  2966             88  MASTER-WAS-RESTORED    VALUE '4'.
  2967             88  INCURRED-DATE-CHANGED  VALUE '5'.
  2968             88  FILE-CONVERTED         VALUE '6'.
  2969             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  2970             88  ERROR-CORRECTION       VALUE 'E'.
  2971         16  CL-RELATED-CLAIM-NO     PIC X(7).
  2972         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  2973         16  CL-BENEFICIARY          PIC X(10).
  2974         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  2975         16  CL-DENIAL-TYPE          PIC X.
  2976             88  CL-TYPE-DENIAL          VALUE '1'.
  2977             88  CL-TYPE-RESCISSION      VALUE '2'.
  2978             88  CL-TYPE-REFORMATION     VALUE '3'.
  2979             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  2980             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  2981         16  FILLER                  PIC X(5).
  2982
  2983     12  CL-TRAILER-CONTROLS.
  2984         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  2985             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  2986             88  CL-LAST-TRL-AVAIL      VALUE +100.
  2987             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  2988         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  2989         16  FILLER                  PIC XX.
  2990         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  2991         16  CL-ADDRESS-TRAILER-CNT.
  2992             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  2993                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  2994             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  2995                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  2996             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  2997                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  2998             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  2999                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3000             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3001                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3002             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3003                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3004             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3005                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3006
  3007     12  CL-CV-REFERENCE-NO.
  3008         16  CL-CV-REFNO-PRIME       PIC X(18).
  3009         16  CL-CV-REFNO-SFX         PIC XX.
  3010
  3011     12  CL-FILE-LOCATION            PIC X(4).
  3012
  3013     12  CL-PROCESS-ERRORS.
  3014         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3015             88  NO-FATAL-ERRORS        VALUE ZERO.
  3016         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3017             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3018
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL152.cbl
  3019     12  CL-PRODUCT-CD               PIC X.
  3020
  3021     12  CL-CURRENT-KEY-DATA.
  3022         16  CL-CURRENT-CARRIER      PIC X.
  3023         16  CL-CURRENT-GROUPING     PIC X(6).
  3024         16  CL-CURRENT-STATE        PIC XX.
  3025         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3026
  3027     12  CL-ASSOCIATES               PIC X.
  3028         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3029         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3030         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3031         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3032
  3033     12  CL-ACTIVITY-CODE            PIC 99.
  3034     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3035     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3036
  3037     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3038     12  CL-LAG-REPORT-CODE          PIC 9.
  3039     12  CL-LOAN-TYPE                PIC XX.
  3040     12  CL-LEGAL-STATE              PIC XX.
  3041
  3042*    12  FILLER                      PIC X(5).
  3043     12  CL-YESNOSW                  PIC X.
  3044     12  FILLER                      PIC X(4).
  3045
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL152.cbl
  3047*                                COPY ELCCNTL.
  3048******************************************************************
  3049*                                                                *
  3050*                                                                *
  3051*                            ELCCNTL.                            *
  3052*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3053*                            VMOD=2.059                          *
  3054*                                                                *
  3055*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3056*                                                                *
  3057*   FILE TYPE = VSAM,KSDS                                        *
  3058*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3059*                                                                *
  3060*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3061*       ALTERNATE INDEX = NONE                                   *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 082503                   PEMA  ADD BENEFIT GROUP
  3074* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3075* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3076* 092705    2005050300006  PEMA  ADD SPP LEASES
  3077* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3078* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3079* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3080* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3081* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3082******************************************************************
  3083*
  3084 01  CONTROL-FILE.
  3085     12  CF-RECORD-ID                       PIC XX.
  3086         88  VALID-CF-ID                        VALUE 'CF'.
  3087
  3088     12  CF-CONTROL-PRIMARY.
  3089         16  CF-COMPANY-ID                  PIC XXX.
  3090         16  CF-RECORD-TYPE                 PIC X.
  3091             88  CF-COMPANY-MASTER              VALUE '1'.
  3092             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3093             88  CF-STATE-MASTER                VALUE '3'.
  3094             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3095             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3096             88  CF-CARRIER-MASTER              VALUE '6'.
  3097             88  CF-MORTALITY-MASTER            VALUE '7'.
  3098             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3099             88  CF-TERMINAL-MASTER             VALUE '9'.
  3100             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3101             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3102             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3103             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3104             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL152.cbl
  3105             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3106             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3107             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3108             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3109         16  CF-ACCESS-CD-GENL              PIC X(4).
  3110         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3111             20  CF-PROCESSOR               PIC X(4).
  3112         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3113             20  CF-STATE-CODE              PIC XX.
  3114             20  FILLER                     PIC XX.
  3115         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3116             20  FILLER                     PIC XX.
  3117             20  CF-HI-BEN-IN-REC           PIC XX.
  3118         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3119             20  FILLER                     PIC XXX.
  3120             20  CF-CARRIER-CNTL            PIC X.
  3121         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3122             20  FILLER                     PIC XX.
  3123             20  CF-HI-TYPE-IN-REC          PIC 99.
  3124         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3125             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3126                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3127             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3128             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3129         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3130             20  FILLER                     PIC X.
  3131             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3132         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3133             20  FILLER                     PIC XX.
  3134             20  CF-MORTGAGE-PLAN           PIC XX.
  3135         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3136
  3137     12  CF-LAST-MAINT-DT                   PIC XX.
  3138     12  CF-LAST-MAINT-BY                   PIC X(4).
  3139     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3140
  3141     12  CF-RECORD-BODY                     PIC X(728).
  3142
  3143
  3144****************************************************************
  3145*             COMPANY MASTER RECORD                            *
  3146****************************************************************
  3147
  3148     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3149         16  CF-COMPANY-ADDRESS.
  3150             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3151             20  CF-CL-IN-CARE-OF           PIC X(30).
  3152             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3153             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3154             20  CF-CL-CITY-STATE           PIC X(30).
  3155             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3156             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3157         16  CF-COMPANY-CD                  PIC X.
  3158         16  CF-COMPANY-PASSWORD            PIC X(8).
  3159         16  CF-SECURITY-OPTION             PIC X.
  3160             88  ALL-SECURITY                   VALUE '1'.
  3161             88  COMPANY-VERIFY                 VALUE '2'.
  3162             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL152.cbl
  3163             88  NO-SECURITY                    VALUE '4'.
  3164             88  ALL-BUT-TERM                   VALUE '5'.
  3165         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3166             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3167         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3168             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3169         16  CF-INFORCE-LOCATION            PIC X.
  3170             88  CERTS-ARE-ONLINE               VALUE '1'.
  3171             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3172             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3173         16  CF-LOWER-CASE-LETTERS          PIC X.
  3174         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3175             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3176             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3177             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3178             88  CF-ACCNT-CNTL                  VALUE '3'.
  3179             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3180
  3181         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3182         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3183
  3184         16  CF-LGX-CREDIT-USER             PIC X.
  3185             88  CO-IS-NOT-USER                 VALUE 'N'.
  3186             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3187
  3188         16 CF-CREDIT-CALC-CODES.
  3189             20  CF-CR-REM-TERM-CALC PIC X.
  3190               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3191               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3192               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3193               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3194               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3195               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3196               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3197             20  CF-CR-R78-METHOD           PIC X.
  3198               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3199               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3200
  3201         16  CF-CLAIM-CONTROL-COUNTS.
  3202             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3203                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3204
  3205             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3206                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3207
  3208             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3209                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3210
  3211             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3212                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3213
  3214         16  CF-CURRENT-MONTH-END           PIC XX.
  3215
  3216         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3217             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3218             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3219             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3220             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL152.cbl
  3221                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3222                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3223             20  CF-CO-PREM-REJECT-SW       PIC X.
  3224                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3225                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3226             20  CF-CO-REF-REJECT-SW        PIC X.
  3227                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3228                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3229
  3230         16  CF-CO-REPORTING-DT             PIC XX.
  3231         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3232         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3233           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3234           88  CF-CO-MONTH-END                  VALUE '1'.
  3235
  3236         16  CF-LGX-CLAIM-USER              PIC X.
  3237             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3238             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3239
  3240         16  CF-CREDIT-EDIT-CONTROLS.
  3241             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3242             20  CF-MIN-AGE                 PIC 99.
  3243             20  CF-DEFAULT-AGE             PIC 99.
  3244             20  CF-MIN-TERM                PIC S999      COMP-3.
  3245             20  CF-MAX-TERM                PIC S999      COMP-3.
  3246             20  CF-DEFAULT-SEX             PIC X.
  3247             20  CF-JOINT-AGE-INPUT         PIC X.
  3248                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3249             20  CF-BIRTH-DATE-INPUT        PIC X.
  3250                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3251             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3252                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3253                 88  CF-ZERO-CARRIER            VALUE '1'.
  3254                 88  CF-ZERO-GROUPING           VALUE '2'.
  3255                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3256             20  CF-EDIT-SW                 PIC X.
  3257                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3258             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3259             20  CF-CR-PR-METHOD            PIC X.
  3260               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3261               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3262             20  FILLER                     PIC X.
  3263
  3264         16  CF-CREDIT-MISC-CONTROLS.
  3265             20  CF-REIN-TABLE-SW           PIC X.
  3266                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3267             20  CF-COMP-TABLE-SW           PIC X.
  3268                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3269             20  CF-EXPERIENCE-RETENTION-AGE
  3270                                            PIC S9        COMP-3.
  3271             20  CF-CONVERSION-DT           PIC XX.
  3272             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3273             20  CF-RUN-FREQUENCY-SW        PIC X.
  3274                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3275                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3276
  3277             20  CF-CR-CHECK-NO-CONTROL.
  3278                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL152.cbl
  3279                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3280                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3281                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3282                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3283                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3284
  3285                 24  CF-CR-CHECK-COUNT       REDEFINES
  3286                     CF-CR-CHECK-COUNTER      PIC X(4).
  3287
  3288                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3289                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3290
  3291                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3292                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3293                 24  CF-MAIL-PROCESSING       PIC X.
  3294                     88  MAIL-PROCESSING          VALUE 'Y'.
  3295
  3296         16  CF-MISC-SYSTEM-CONTROL.
  3297             20  CF-SYSTEM-C                 PIC X.
  3298                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3299             20  CF-SYSTEM-D                 PIC X.
  3300                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3301             20  CF-SOC-SEC-NO-SW            PIC X.
  3302                 88  SOC-SEC-NO-USED             VALUE '1'.
  3303             20  CF-MEMBER-NO-SW             PIC X.
  3304                 88  MEMBER-NO-USED              VALUE '1'.
  3305             20  CF-TAX-ID-NUMBER            PIC X(11).
  3306             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3307             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3308                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3309                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3310                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3311                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3312             20  CF-SYSTEM-E                 PIC X.
  3313                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3314
  3315         16  CF-LGX-LIFE-USER               PIC X.
  3316             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3317             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3318
  3319         16  CF-CR-MONTH-END-DT             PIC XX.
  3320
  3321         16  CF-FILE-MAINT-DATES.
  3322             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3323                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3324             20  CF-LAST-BATCH       REDEFINES
  3325                 CF-LAST-BATCH-NO               PIC X(4).
  3326             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3327             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3328             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3329             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3330             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3331             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3332             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3333             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3334             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3335             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3336
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL152.cbl
  3337         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3338         16  FILLER                         PIC X.
  3339
  3340         16  CF-ALT-MORT-CODE               PIC X(4).
  3341         16  CF-MEMBER-CAPTION              PIC X(10).
  3342
  3343         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3344             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3345             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3346             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3347             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3348             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3349
  3350         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3351
  3352         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3353         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3354         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3355         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3356
  3357         16  CF-AH-OVERRIDE-L1              PIC X.
  3358         16  CF-AH-OVERRIDE-L2              PIC XX.
  3359         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3360         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3361
  3362         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3363         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3364
  3365         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3366         16  CF-AR-LAST-EL860-DT            PIC XX.
  3367         16  CF-MP-MONTH-END-DT             PIC XX.
  3368
  3369         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3370         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3371             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3372
  3373         16  CF-AR-MONTH-END-DT             PIC XX.
  3374
  3375         16  CF-CRDTCRD-USER                PIC X.
  3376             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3377             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3378
  3379         16  CF-CC-MONTH-END-DT             PIC XX.
  3380
  3381         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3382
  3383         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3384             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3385             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3386             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3387         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3388         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3389         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3390         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3391             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3392             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3393         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3394         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL152.cbl
  3395         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3396             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3397         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3398
  3399         16  CF-CL-ZIP-CODE.
  3400             20  CF-CL-ZIP-PRIME.
  3401                 24  CF-CL-ZIP-1ST          PIC X.
  3402                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3403                 24  FILLER                 PIC X(4).
  3404             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3405         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3406             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3407             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3408             20  FILLER                     PIC XXX.
  3409
  3410         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3411         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3412         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3413         16  CF-CO-OPTION-START-DATE        PIC XX.
  3414         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3415           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3416                                                      '3' '4'.
  3417           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3418           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3419           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3420           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3421           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3422           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3423
  3424         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3425
  3426         16  CF-PAYMENT-APPROVAL-LEVELS.
  3427             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3428             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3429             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3430             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3431             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3432             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3433
  3434         16  CF-END-USER-REPORTING-USER     PIC X.
  3435             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3436             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3437
  3438         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3439             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3440             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3441
  3442         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3443
  3444         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3445         16  FILLER                         PIC X.
  3446
  3447         16  CF-CREDIT-ARCHIVE-CNTL.
  3448             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3449             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3450             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3451
  3452         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL152.cbl
  3453
  3454         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3455             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3456             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3457
  3458         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3459             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3460             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3461
  3462         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3463
  3464         16  CF-CO-ACH-ID-CODE              PIC  X.
  3465             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3466             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3467             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3468         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3469         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3470         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3471         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3472         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3473         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3474         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3475         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3476         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3477                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3478         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3479                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3480
  3481         16  CF-CO-OVER-SHORT.
  3482             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3483             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3484
  3485*         16  FILLER                         PIC X(102).
  3486         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3487             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3488             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3489
  3490         16  CF-AH-APPROVAL-DAYS.
  3491             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3492             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3493             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3494             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3495
  3496         16  FILLER                         PIC X(82).
  3497****************************************************************
  3498*             PROCESSOR/USER RECORD                            *
  3499****************************************************************
  3500
  3501     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3502         16  CF-PROCESSOR-NAME              PIC X(30).
  3503         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3504         16  CF-PROCESSOR-TITLE             PIC X(26).
  3505         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3506                 88  MESSAGE-YES                VALUE 'Y'.
  3507                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3508
  3509*****************************************************
  3510****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL152.cbl
  3511****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3512****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3513****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3514*****************************************************
  3515
  3516         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3517             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3518             20  CF-APPLICATION-FORCE       PIC X.
  3519             20  CF-INDIVIDUAL-APP.
  3520                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3521                     28  CF-BROWSE-APP      PIC X.
  3522                     28  CF-UPDATE-APP      PIC X.
  3523
  3524         16  CF-CURRENT-TERM-ON             PIC X(4).
  3525         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3526             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3527             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3528             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3529             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3530             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3531             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3532             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3533         16  CF-PROCESSOR-CARRIER           PIC X.
  3534             88  NO-CARRIER-SECURITY            VALUE ' '.
  3535         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3536             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3537         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3538             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3539         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3540             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3541
  3542         16  CF-PROC-SYS-ACCESS-SW.
  3543             20  CF-PROC-CREDIT-CLAIMS-SW.
  3544                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3545                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3546                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3547                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3548             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3549                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3550                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3551             20  CF-PROC-LIFE-GNRLDGR-SW.
  3552                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3553                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3554                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3555                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3556             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3557                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3558                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3559         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3560             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3561             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3562         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3563
  3564         16  CF-APPROVAL-LEVEL                  PIC X.
  3565             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3566             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3567             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3568             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL152.cbl
  3569
  3570         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3571
  3572         16  CF-LANGUAGE-TYPE                   PIC X.
  3573             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3574             88  CF-LANG-IS-FR                      VALUE 'F'.
  3575         16  FILLER                             PIC  X(240).
  3576
  3577****************************************************************
  3578*             PROCESSOR/REMINDERS RECORD                       *
  3579****************************************************************
  3580
  3581     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3582         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3583             20  CF-START-REMIND-DT         PIC XX.
  3584             20  CF-END-REMIND-DT           PIC XX.
  3585             20  CF-REMINDER-TEXT           PIC X(50).
  3586         16  FILLER                         PIC X(296).
  3587
  3588
  3589****************************************************************
  3590*             STATE MASTER RECORD                              *
  3591****************************************************************
  3592
  3593     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3594         16  CF-STATE-ABBREVIATION          PIC XX.
  3595         16  CF-STATE-NAME                  PIC X(25).
  3596         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3597         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3598             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3599             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3600             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3601             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3602                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3603                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3604             20  CF-ST-PREM-REJECT-SW       PIC X.
  3605                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3606                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3607             20  CF-ST-REF-REJECT-SW        PIC X.
  3608                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3609                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3610         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3611         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3612         16  CF-ST-REFUND-RULES.
  3613             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3614             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3615             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3616         16  CF-ST-FST-PMT-EXTENSION.
  3617             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3618             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3619                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3620                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3621                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3622                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3623         16  CF-ST-STATE-CALL.
  3624             20  CF-ST-CALL-UNEARNED        PIC X.
  3625             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3626             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL152.cbl
  3627         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3628             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3629             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3630         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3631         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3632         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3633         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3634         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3635         16  FILLER                         PIC X.
  3636         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3637             20  CF-ST-BENEFIT-CD           PIC XX.
  3638             20  CF-ST-BENEFIT-KIND         PIC X.
  3639                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3640                 88  CF-ST-AH-KIND              VALUE 'A'.
  3641             20  CF-ST-REM-TERM-CALC        PIC X.
  3642                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3643                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3644                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3645                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3646                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3647                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3648                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3649                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3650
  3651             20  CF-ST-REFUND-CALC          PIC X.
  3652                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3653                 88  ST-REFD-BY-R78             VALUE '1'.
  3654                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3655                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3656                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3657                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3658                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3659                 88  ST-REFD-UTAH               VALUE '7'.
  3660                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3661                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3662                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3663
  3664             20  CF-ST-EARNING-CALC         PIC X.
  3665                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3666                 88  ST-EARN-BY-R78             VALUE '1'.
  3667                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3668                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3669                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3670                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3671                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3672                 88  ST-EARN-MEAN               VALUE '8'.
  3673                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3674
  3675             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3676                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3677                 88  ST-OVRD-BY-R78             VALUE '1'.
  3678                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3679                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3680                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3681                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3682                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3683                 88  ST-OVRD-MEAN               VALUE '8'.
  3684                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL152.cbl
  3685             20  FILLER                     PIC X.
  3686
  3687         16  CF-ST-COMMISSION-CAPS.
  3688             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3689             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3690             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3691             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3692         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3693                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3694
  3695         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3696
  3697         16  CF-ST-STATUTORY-INTEREST.
  3698             20  CF-ST-STAT-DATE-FROM       PIC X.
  3699                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3700                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3701             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3702             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3703             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3704             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3705             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3706
  3707         16  CF-ST-OVER-SHORT.
  3708             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3709             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3710
  3711         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3712
  3713         16  CF-ST-RT-CALC                  PIC X.
  3714
  3715         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3716         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3717         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3718         16  CF-ST-RF-LR-CALC               PIC X.
  3719         16  CF-ST-RF-LL-CALC               PIC X.
  3720         16  CF-ST-RF-LN-CALC               PIC X.
  3721         16  CF-ST-RF-AH-CALC               PIC X.
  3722         16  CF-ST-RF-CP-CALC               PIC X.
  3723*        16  FILLER                         PIC X(206).
  3724*CIDMOD         16  FILLER                         PIC X(192).
  3725         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3726             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3727         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3728         16  CF-ST-VFY-2ND-BENE             PIC X.
  3729         16  FILLER                         PIC X(186).
  3730
  3731****************************************************************
  3732*             BENEFIT MASTER RECORD                            *
  3733****************************************************************
  3734
  3735     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3736         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3737             20  CF-BENEFIT-CODE            PIC XX.
  3738             20  CF-BENEFIT-NUMERIC  REDEFINES
  3739                 CF-BENEFIT-CODE            PIC XX.
  3740             20  CF-BENEFIT-ALPHA           PIC XXX.
  3741             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3742             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL152.cbl
  3743
  3744             20  CF-LF-COVERAGE-TYPE        PIC X.
  3745                 88  CF-REDUCING                VALUE 'R'.
  3746                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3747
  3748             20  CF-SPECIAL-CALC-CD         PIC X.
  3749                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3750                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3751                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3752                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3753                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3754                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3755                 88  CF-FARM-PLAN               VALUE 'F'.
  3756                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3757                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3758                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3759                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3760                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3761                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3762                 88  CF-PRUDENTIAL              VALUE 'P'.
  3763                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3764                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3765                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3766                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3767                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3768                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3769
  3770             20  CF-JOINT-INDICATOR         PIC X.
  3771                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3772
  3773*            20  FILLER                     PIC X(12).
  3774             20  FILLER                     PIC X(11).
  3775             20  CF-BENEFIT-CATEGORY        PIC X.
  3776             20  CF-LOAN-TYPE               PIC X(8).
  3777
  3778             20  CF-CO-REM-TERM-CALC        PIC X.
  3779                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3780                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3781                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3782                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3783                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3784
  3785             20  CF-CO-EARNINGS-CALC        PIC X.
  3786                 88  CO-EARN-BY-R78             VALUE '1'.
  3787                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3788                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3789                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3790                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3791                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3792                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3793                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3794
  3795             20  CF-CO-REFUND-CALC          PIC X.
  3796                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3797                 88  CO-REFD-BY-R78             VALUE '1'.
  3798                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3799                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3800                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL152.cbl
  3801                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3802                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3803                 88  CO-REFD-MEAN               VALUE '8'.
  3804                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3805                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3806                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3807
  3808             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3809                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3810                 88  CO-OVRD-BY-R78             VALUE '1'.
  3811                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3812                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3813                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3814                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3815                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3816                 88  CO-OVRD-MEAN               VALUE '8'.
  3817                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3818
  3819             20  CF-CO-BEN-I-G-CD           PIC X.
  3820                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3821                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3822                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3823
  3824         16  FILLER                         PIC X(304).
  3825
  3826
  3827****************************************************************
  3828*             CARRIER MASTER RECORD                            *
  3829****************************************************************
  3830
  3831     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3832         16  CF-ADDRESS-DATA.
  3833             20  CF-MAIL-TO-NAME            PIC X(30).
  3834             20  CF-IN-CARE-OF              PIC X(30).
  3835             20  CF-ADDRESS-LINE-1          PIC X(30).
  3836             20  CF-ADDRESS-LINE-2          PIC X(30).
  3837             20  CF-CITY-STATE              PIC X(30).
  3838             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3839             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3840
  3841         16  CF-CLAIM-NO-CONTROL.
  3842             20  CF-CLAIM-NO-METHOD         PIC X.
  3843                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3844                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3845                 88  CLAIM-NO-SEQ               VALUE '3'.
  3846                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3847             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3848                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3849                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3850                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3851
  3852         16  CF-CHECK-NO-CONTROL.
  3853             20  CF-CHECK-NO-METHOD         PIC X.
  3854                 88  CHECK-NO-MANUAL            VALUE '1'.
  3855                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3856                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3857                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3858             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL152.cbl
  3859                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3860
  3861         16  CF-DOMICILE-STATE              PIC XX.
  3862
  3863         16  CF-EXPENSE-CONTROLS.
  3864             20  CF-EXPENSE-METHOD          PIC X.
  3865                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3866                 88  DOLLARS-PER-PMT            VALUE '2'.
  3867                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3868                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3869             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3870             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3871
  3872         16  CF-CORRESPONDENCE-CONTROL.
  3873             20  CF-LETTER-RESEND-OPT       PIC X.
  3874                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3875                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3876             20  FILLER                     PIC X(4).
  3877
  3878         16  CF-RESERVE-CONTROLS.
  3879             20  CF-MANUAL-SW               PIC X.
  3880                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3881             20  CF-FUTURE-SW               PIC X.
  3882                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3883             20  CF-PTC-SW                  PIC X.
  3884                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3885             20  CF-IBNR-SW                 PIC X.
  3886                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3887             20  CF-PTC-LF-SW               PIC X.
  3888                 88  CF-LF-PTC-USED             VALUE '1'.
  3889             20  CF-CDT-ACCESS-METHOD       PIC X.
  3890                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3891                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3892                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3893             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3894
  3895         16  CF-CLAIM-CALC-METHOD           PIC X.
  3896             88  360-PLUS-MONTHS                VALUE '1'.
  3897             88  365-PLUS-MONTHS                VALUE '2'.
  3898             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3899             88  360-DAILY                      VALUE '4'.
  3900             88  365-DAILY                      VALUE '5'.
  3901
  3902         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3903         16  FILLER                         PIC X(11).
  3904
  3905         16  CF-LIMIT-AMOUNTS.
  3906             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3907             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3908             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3909             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3910             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3911             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3912             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3913             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3914             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3915             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3916
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL152.cbl
  3917         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3918         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3919         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3920
  3921         16  CF-ZIP-CODE.
  3922             20  CF-ZIP-PRIME.
  3923                 24  CF-ZIP-1ST             PIC X.
  3924                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3925                 24  FILLER                 PIC X(4).
  3926             20  CF-ZIP-PLUS4               PIC X(4).
  3927         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3928             20  CF-CAN-POSTAL-1            PIC XXX.
  3929             20  CF-CAN-POSTAL-2            PIC XXX.
  3930             20  FILLER                     PIC XXX.
  3931
  3932         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3933         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3934         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3935
  3936         16  CF-RATING-SWITCH               PIC X.
  3937             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3938             88  CF-NO-RATING                   VALUE 'N'.
  3939
  3940         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3941
  3942         16  CF-CARRIER-OVER-SHORT.
  3943             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3944             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3945
  3946         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3947         16  CF-SECPAY-SWITCH               PIC X.
  3948             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3949             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3950         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3951         16  FILLER                         PIC X(448).
  3952*        16  FILLER                         PIC X(452).
  3953
  3954
  3955****************************************************************
  3956*             MORTALITY MASTER RECORD                          *
  3957****************************************************************
  3958
  3959     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3960         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3961                                INDEXED BY CF-MORT-NDX.
  3962             20  CF-MORT-TABLE              PIC X(5).
  3963             20  CF-MORT-TABLE-TYPE         PIC X.
  3964                 88  CF-MORT-JOINT              VALUE 'J'.
  3965                 88  CF-MORT-SINGLE             VALUE 'S'.
  3966                 88  CF-MORT-COMBINED           VALUE 'C'.
  3967                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3968                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3969             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3970             20  CF-MORT-AGE-METHOD         PIC XX.
  3971                 88  CF-AGE-LAST                VALUE 'AL'.
  3972                 88  CF-AGE-NEAR                VALUE 'AN'.
  3973             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3974             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL152.cbl
  3975                                            PIC X.
  3976                 88  CF-MINUS                   VALUE '-'.
  3977                 88  CF-PLUS                    VALUE '+'.
  3978             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3979             20  CF-MORT-JOINT-CODE         PIC X.
  3980                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3981             20  CF-MORT-PC-Q               PIC X.
  3982                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3983             20  CF-MORT-TABLE-CODE         PIC X(4).
  3984             20  CF-MORT-COMMENTS           PIC X(15).
  3985             20  FILLER                     PIC X(14).
  3986
  3987         16  FILLER                         PIC X(251).
  3988
  3989
  3990****************************************************************
  3991*             BUSSINESS TYPE MASTER RECORD                     *
  3992****************************************************************
  3993
  3994     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3995* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3996* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3997* AND RECORD 05 IS TYPES 81-99
  3998         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3999             20  CF-BUSINESS-TITLE          PIC  X(19).
  4000             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4001                                            PIC S9V9(4) COMP-3.
  4002             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4003             20  FILLER                     PIC  X.
  4004         16  FILLER                         PIC  X(248).
  4005
  4006
  4007****************************************************************
  4008*             TERMINAL MASTER RECORD                           *
  4009****************************************************************
  4010
  4011     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4012
  4013         16  CF-COMPANY-TERMINALS.
  4014             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4015                                  PIC X(4).
  4016         16  FILLER               PIC X(248).
  4017
  4018
  4019****************************************************************
  4020*             LIFE EDIT MASTER RECORD                          *
  4021****************************************************************
  4022
  4023     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4024         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4025             20  CF-LIFE-CODE-IN            PIC XX.
  4026             20  CF-LIFE-CODE-OUT           PIC XX.
  4027         16  FILLER                         PIC X(248).
  4028
  4029
  4030****************************************************************
  4031*             AH EDIT MASTER RECORD                            *
  4032****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL152.cbl
  4033
  4034     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4035         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4036             20  CF-AH-CODE-IN              PIC XXX.
  4037             20  CF-AH-CODE-OUT             PIC XX.
  4038         16  FILLER                         PIC X(248).
  4039
  4040
  4041****************************************************************
  4042*             CREDIBILITY TABLES                               *
  4043****************************************************************
  4044
  4045     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4046         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4047                             INDEXED BY CF-CRDB-NDX.
  4048             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4049             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4050             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4051         16  FILLER                         PIC  X(332).
  4052
  4053
  4054****************************************************************
  4055*             REPORT CUSTOMIZATION RECORD                      *
  4056****************************************************************
  4057
  4058     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4059         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4060             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4061             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4062             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4063**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4064****       A T-TRANSFER.                                   ****
  4065             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4066
  4067         16  FILLER                         PIC XX.
  4068
  4069         16  CF-CARRIER-CNTL-OPT.
  4070             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4071                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4072                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4073             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4074                                            PIC X.
  4075         16  CF-GROUP-CNTL-OPT.
  4076             20  CF-GROUP-OPT-SEQ           PIC 9.
  4077                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4078                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4079             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4080                                            PIC X(6).
  4081         16  CF-STATE-CNTL-OPT.
  4082             20  CF-STATE-OPT-SEQ           PIC 9.
  4083                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4084                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4085             20  CF-STATE-SELECT OCCURS 3 TIMES
  4086                                            PIC XX.
  4087         16  CF-ACCOUNT-CNTL-OPT.
  4088             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4089                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4090                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL152.cbl
  4091             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4092                                            PIC X(10).
  4093         16  CF-BUS-TYP-CNTL-OPT.
  4094             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4095                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4096                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4097             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4098                                            PIC XX.
  4099         16  CF-LF-TYP-CNTL-OPT.
  4100             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4101                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4102                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4103             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4104                                            PIC XX.
  4105         16  CF-AH-TYP-CNTL-OPT.
  4106             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4107                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4108                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4109             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4110                                            PIC XX.
  4111         16  CF-REPTCD1-CNTL-OPT.
  4112             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4113                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4114                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4115             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4116                                            PIC X(10).
  4117         16  CF-REPTCD2-CNTL-OPT.
  4118             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4119                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4120                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4121             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4122                                            PIC X(10).
  4123         16  CF-USER1-CNTL-OPT.
  4124             20  CF-USER1-OPT-SEQ           PIC 9.
  4125                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4126                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4127             20  CF-USER1-SELECT OCCURS 3 TIMES
  4128                                            PIC X(10).
  4129         16  CF-USER2-CNTL-OPT.
  4130             20  CF-USER2-OPT-SEQ           PIC 9.
  4131                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4132                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4133             20  CF-USER2-SELECT OCCURS 3 TIMES
  4134                                            PIC X(10).
  4135         16  CF-USER3-CNTL-OPT.
  4136             20  CF-USER3-OPT-SEQ           PIC 9.
  4137                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4138                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4139             20  CF-USER3-SELECT OCCURS 3 TIMES
  4140                                            PIC X(10).
  4141         16  CF-USER4-CNTL-OPT.
  4142             20  CF-USER4-OPT-SEQ           PIC 9.
  4143                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4144                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4145             20  CF-USER4-SELECT OCCURS 3 TIMES
  4146                                            PIC X(10).
  4147         16  CF-USER5-CNTL-OPT.
  4148             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL152.cbl
  4149                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4150                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4151             20  CF-USER5-SELECT OCCURS 3 TIMES
  4152                                            PIC X(10).
  4153         16  CF-REINS-CNTL-OPT.
  4154             20  CF-REINS-OPT-SEQ           PIC 9.
  4155                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4156                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4157             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4158                 24  CF-REINS-PRIME         PIC XXX.
  4159                 24  CF-REINS-SUB           PIC XXX.
  4160
  4161         16  CF-AGENT-CNTL-OPT.
  4162             20  CF-AGENT-OPT-SEQ           PIC 9.
  4163                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4164                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4165             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4166                                            PIC X(10).
  4167
  4168         16  FILLER                         PIC X(43).
  4169
  4170         16  CF-LOSS-RATIO-SELECT.
  4171             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4172             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4173         16  CF-ENTRY-DATE-SELECT.
  4174             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4175             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4176         16  CF-EFFECTIVE-DATE-SELECT.
  4177             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4178             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4179
  4180         16  CF-EXCEPTION-LIST-IND          PIC X.
  4181             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4182
  4183         16  FILLER                         PIC X(318).
  4184
  4185****************************************************************
  4186*                  EXCEPTION REPORTING RECORD                  *
  4187****************************************************************
  4188
  4189     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4190         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4191             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4192
  4193         16  CF-COMBINED-LIFE-AH-OPT.
  4194             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4195             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4196             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4197             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4198
  4199         16  CF-LIFE-OPT.
  4200             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4201             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4202             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4203             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4204             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4205             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4206             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL152.cbl
  4207             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4208             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4209             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4210
  4211         16  CF-AH-OPT.
  4212             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4213             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4214             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4215             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4216             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4217             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4218             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4219             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4220             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4221             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4222
  4223         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4224             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4225             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4226             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4227
  4228         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4229
  4230         16  FILLER                         PIC X(673).
  4231
  4232
  4233****************************************************************
  4234*             MORTGAGE SYSTEM PLAN RECORD                      *
  4235****************************************************************
  4236
  4237     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4238         16  CF-PLAN-TYPE                   PIC X.
  4239             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4240             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4241             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4242         16  CF-PLAN-ABBREV                 PIC XXX.
  4243         16  CF-PLAN-DESCRIPT               PIC X(10).
  4244         16  CF-PLAN-NOTES                  PIC X(20).
  4245         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4246         16  CF-PLAN-UNDERWRITING.
  4247             20  CF-PLAN-TERM-DATA.
  4248                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4249                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4250             20  CF-PLAN-AGE-DATA.
  4251                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4252                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4253                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4254             20  CF-PLAN-BENEFIT-DATA.
  4255                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4256                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4257                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4258                                            PIC S9(7)V99  COMP-3.
  4259         16  CF-PLAN-POLICY-FORMS.
  4260             20  CF-POLICY-FORM             PIC X(12).
  4261             20  CF-MASTER-APPLICATION      PIC X(12).
  4262             20  CF-MASTER-POLICY           PIC X(12).
  4263         16  CF-PLAN-RATING.
  4264             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL152.cbl
  4265             20  CF-SEX-RATING              PIC X.
  4266                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4267                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4268             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4269             20  CF-SUB-STD-TYPE            PIC X.
  4270                 88  CF-PCT-OF-PREM            VALUE '1'.
  4271                 88  CF-PCT-OF-BENE            VALUE '2'.
  4272         16  CF-PLAN-PREM-TOLERANCES.
  4273             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4274             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4275         16  CF-PLAN-PYMT-TOLERANCES.
  4276             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4277             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4278         16  CF-PLAN-MISC-DATA.
  4279             20  FILLER                     PIC X.
  4280             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4281             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4282         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4283         16  CF-PLAN-IND-GRP                PIC X.
  4284             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4285                                                     '1'.
  4286             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4287                                                     '2'.
  4288         16  CF-MIB-SEARCH-SW               PIC X.
  4289             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4290             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4291             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4292             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4293         16  CF-ALPHA-SEARCH-SW             PIC X.
  4294             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4295             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4296             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4297             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4298             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4299             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4300             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4301             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4302             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4303             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4304                                                     'A' 'B' 'C'
  4305                                                     'X' 'Y' 'Z'.
  4306         16  CF-EFF-DT-RULE-SW              PIC X.
  4307             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4308             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4309             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4310             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4311             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4312         16  FILLER                         PIC X(4).
  4313         16  CF-HEALTH-QUESTIONS            PIC X.
  4314             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4315         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4316         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4317         16  CF-PLAN-SNGL-JNT               PIC X.
  4318             88  CF-COMBINED-PLAN              VALUE 'C'.
  4319             88  CF-JNT-PLAN                   VALUE 'J'.
  4320             88  CF-SNGL-PLAN                  VALUE 'S'.
  4321         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4322         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL152.cbl
  4323         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4324         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4325         16  CF-RERATE-CNTL                 PIC  X.
  4326             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4327             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4328             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4329             88  CF-AUTO-RECALC                 VALUE '4'.
  4330         16  CF-BENEFIT-TYPE                PIC  X.
  4331             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4332             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4333         16  CF-POLICY-FEE                  PIC S999V99
  4334                                                    COMP-3.
  4335         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4336         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4337         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4338         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4339         16  FILLER                         PIC  X(32).
  4340         16  CF-TERMINATION-FORM            PIC  X(04).
  4341         16  FILLER                         PIC  X(08).
  4342         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4343                                                       COMP-3.
  4344         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4345         16  CF-ISSUE-LETTER                PIC  X(4).
  4346         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4347         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4348             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4349             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4350         16  CF-MP-REFUND-CALC              PIC X.
  4351             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4352             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4353             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4354             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4355             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4356             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4357             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4358             88  CF-MP-REFD-MEAN                VALUE '8'.
  4359         16  CF-ALT-RATE-CODE               PIC  X(5).
  4360
  4361
  4362         16  FILLER                         PIC X(498).
  4363****************************************************************
  4364*             MORTGAGE COMPANY MASTER RECORD                   *
  4365****************************************************************
  4366
  4367     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4368         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4369         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4370             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4371             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4372             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4373             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4374             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4375
  4376         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4377         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4378         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4379         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4380         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL152.cbl
  4381
  4382         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4383             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4384         16  CF-MP-RECON-USE-IND            PIC X(1).
  4385             88  CF-MP-USE-RECON             VALUE 'Y'.
  4386         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4387             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4388         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4389             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4390             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4391         16  FILLER                         PIC X(1).
  4392         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4393             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4394         16  CF-MORTG-MIB-VERSION           PIC X.
  4395             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4396             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4397             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4398         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4399             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4400                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4401             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4402                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4403             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4404                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4405             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4406                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4407             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4408                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4409             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4410                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4411         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4412         16  FILLER                         PIC X(7).
  4413         16  CF-MORTG-DESTINATION-SYMBOL.
  4414             20  CF-MORTG-MIB-COMM          PIC X(5).
  4415             20  CF-MORTG-MIB-TERM          PIC X(5).
  4416         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4417             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4418         16  FILLER                         PIC X(03).
  4419         16  CF-MP-CHECK-NO-CONTROL.
  4420             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4421                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4422                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4423                                                ' ' LOW-VALUES.
  4424                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4425                                               VALUE '3'.
  4426         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4427         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4428         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4429             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4430                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4431             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4432                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4433             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4434                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4435             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4436                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4437             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4438                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL152.cbl
  4439             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4440                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4441         16  CF-MORTG-BILLING-AREA.
  4442             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4443                                            PIC X.
  4444         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4445         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4446         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4447         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4448             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4449             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4450         16  FILLER                         PIC X.
  4451         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4452             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4453             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4454         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4455         16  FILLER                         PIC X(8).
  4456         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4457         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4458         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4459         16  CF-ACH-COMPANY-ID.
  4460             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4461                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4462                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4463                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4464             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4465         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4466             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4467         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4468             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4469             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4470         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4471         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4472         16  FILLER                         PIC X(536).
  4473
  4474****************************************************************
  4475*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4476****************************************************************
  4477
  4478     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4479         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4480             20  CF-FEMALE-HEIGHT.
  4481                 24  CF-FEMALE-FT           PIC 99.
  4482                 24  CF-FEMALE-IN           PIC 99.
  4483             20  CF-FEMALE-MIN-WT           PIC 999.
  4484             20  CF-FEMALE-MAX-WT           PIC 999.
  4485         16  FILLER                         PIC X(428).
  4486
  4487     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4488         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4489             20  CF-MALE-HEIGHT.
  4490                 24  CF-MALE-FT             PIC 99.
  4491                 24  CF-MALE-IN             PIC 99.
  4492             20  CF-MALE-MIN-WT             PIC 999.
  4493             20  CF-MALE-MAX-WT             PIC 999.
  4494         16  FILLER                         PIC X(428).
  4495******************************************************************
  4496*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL152.cbl
  4497******************************************************************
  4498     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4499         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4500             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4501             20  CF-SYS-LETTER-ID           PIC X(04).
  4502             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4503             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4504             20  CF-SYS-RESET-SW            PIC X(01).
  4505             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4506             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4507
  4508         16  FILLER                         PIC X(50).
  4509
  4510         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4511             20  CF-USER-ACTIVE-SW          PIC X(01).
  4512             20  CF-USER-LETTER-ID          PIC X(04).
  4513             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4514             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4515             20  CF-USER-RESET-SW           PIC X(01).
  4516             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4517             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4518             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4519
  4520         16  FILLER                         PIC X(246).
  4521
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL152.cbl
  4523*                                COPY ELCARCH.
  4524******************************************************************
  4525*                                                                *
  4526*                            ELCARCH.                            *
  4527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4528*                            VMOD=2.007                          *
  4529*                                                                *
  4530*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4531*                                                                *
  4532*   FILE TYPE = VSAM,KSDS                                        *
  4533*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4534*                                                                *
  4535*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  4536*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  4537*                                                                *
  4538*   LOG = NO                                                     *
  4539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4540*                                                                *
  4541*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  4542******************************************************************
  4543 01  LETTER-ARCHIVE.
  4544     12  LA-RECORD-ID                PIC XX.
  4545         88  VALID-LA-ID                VALUE 'LA'.
  4546
  4547     12  LA-CONTROL-PRIMARY.
  4548         16  LA-COMPANY-CD           PIC X.
  4549         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  4550         16  LA-RECORD-TYPE          PIC X.
  4551             88  LA-HEADER-DATA         VALUE '1'.
  4552             88  LA-ADDRESS-DATA        VALUE '2'.
  4553             88  LA-TEXT-DATA           VALUE '3'.
  4554             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  4555         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  4556
  4557     12  LA-CONTROL-BY-TYPE.
  4558         16  LA-COMPANY-CD-A1        PIC X.
  4559         16  LA-RECORD-TYPE-A1       PIC X.
  4560         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4561         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4562
  4563     12  LA-TEXT-RECORD.
  4564         16  LA-SKIP-CONTROL         PIC XX.
  4565             88  NO-LINES-SKIPPED       VALUE SPACES.
  4566             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  4567         16  LA-TEXT-LINE            PIC X(70).
  4568
  4569     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  4570         16  FILLER                  PIC XX.
  4571         16  LA-ADDRESS-LINE         PIC X(30).
  4572         16  FILLER                  PIC X(40).
  4573
  4574     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  4575         16  FILLER                  PIC XX.
  4576         16  LA-CARRIER              PIC X.
  4577         16  LA-CLAIM-NO             PIC X(7).
  4578         16  LA-CERT-NO.
  4579             20  LA-CERT-PRIME       PIC X(10).
  4580             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL152.cbl
  4581         16  LA-NO-OF-COPIES         PIC S9.
  4582         16  LA-RESEND-DATE          PIC XX.
  4583         16  LA-PROCESSOR-CD         PIC X(4).
  4584         16  LA-CREATION-DT          PIC XX.
  4585         16  LA-INITIAL-PRINT-DATE   PIC XX.
  4586         16  LA-RESEND-PRINT-DATE    PIC XX.
  4587         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4588         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  4589*
  4590* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  4591*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  4592*   I        20  LA-DMD-PROD-CODE        PIC XX.
  4593*   I        20  LA-DMD-RES-ST           PIC XX.
  4594*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4595*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  4596*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  4597*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  4598*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  4599*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  4600*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  4601*   I        20  LA-DMD-UND-CODE         PIC XX.
  4602*   I        20  LA-DMD-BEN-CODE         PIC XX.
  4603*   V    16  FILLER                  PIC X(15).
  4604* -----
  4605*
  4606* REINSERTED  CSO  MODS
  4607*
  4608         16  FILLER.
  4609             20  FILLER                  PIC X(29).
  4610             20  LA-CSO-LETTER-STATUS    PIC X.
  4611                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  4612                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  4613                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  4614             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  4615             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  4616*
  4617
  4618     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  4619         16  FILLER                  PIC XX.
  4620         16  LA4-CARRIER             PIC X.
  4621         16  LA4-CLAIM-NO            PIC X(7).
  4622         16  LA4-CERT-NO.
  4623             20  LA4-CERT-PRIME      PIC X(10).
  4624             20  LA4-CERT-SFX        PIC X.
  4625         16  LA4-NO-OF-COPIES        PIC S9.
  4626         16  LA4-RESEND-DATE         PIC XX.
  4627         16  LA4-PROCESSOR-CD        PIC X(4).
  4628         16  LA4-CREATION-DT         PIC XX.
  4629         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  4630         16  LA4-RESEND-PRINT-DATE   PIC XX.
  4631         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4632         16  LA4-FORM-TYPE           PIC X.
  4633             88  LA4-INITIAL-FORM    VALUE '1'.
  4634             88  LA4-PROGRESS-FORM   VALUE '2'.
  4635         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  4636         16  LA4-STATE               PIC X(02).
  4637         16  FILLER                  PIC X(31).
  4638******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL152.cbl
  4639
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL152.cbl
  4641*                                COPY ELCARCT.
  4642******************************************************************
  4643*                                                                *
  4644*                            ELCARCT.                            *
  4645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4646*                            VMOD=2.003                          *
  4647*                                                                *
  4648*   FILE DESCRIPTION = TEMPORARY LETTER ARCHIVE FILE             *
  4649*                                                                *
  4650*   FILE TYPE = VSAM,KSDS                                        *
  4651*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4652*                                                                *
  4653*   BASE CLUSTER = ELARCT                        RKP=2,LEN=8     *
  4654*       ALTERNATE PATH1 = ELARCT2  (RECORD TYPE) RKP=10,LEN=8    *
  4655*                                                                *
  4656*   LOG = NO                                                     *
  4657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4658*                                                                *
  4659*  NO  CID  MODS  IN  COPYBOOK  ELCARCT                          *
  4660******************************************************************
  4661 01  LETTER-ARCHIVE-TEMP.
  4662     12  LT-RECORD-ID                PIC XX.
  4663         88  VALID-LT-ID                VALUE 'LT'.
  4664
  4665     12  LT-CONTROL-PRIMARY.
  4666         16  LT-COMPANY-CD           PIC X.
  4667         16  LT-ARCHIVE-NO           PIC S9(8)     COMP.
  4668         16  LT-RECORD-TYPE          PIC X.
  4669             88  LT-HEADER-DATA         VALUE '1'.
  4670             88  LT-ADDRESS-DATA        VALUE '2'.
  4671             88  LT-TEXT-DATA           VALUE '3'.
  4672             88  LT-FORM-CONTROL-HDR    VALUE '4'.
  4673         16  LT-LINE-SEQ-NO          PIC S9(4)     COMP.
  4674
  4675     12  LT-CONTROL-BY-TYPE.
  4676         16  LT-COMPANY-CD-A1        PIC X.
  4677         16  LT-RECORD-TYPE-A1       PIC X.
  4678         16  LT-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4679         16  LT-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4680
  4681     12  LT-TEXT-RECORD.
  4682         16  LT-SKIP-CONTROL         PIC XX.
  4683         16  LT-TEXT-LINE            PIC X(70).
  4684
  4685     12  LT-ADDRESS-RECORD  REDEFINES  LT-TEXT-RECORD.
  4686         16  FILLER                  PIC XX.
  4687         16  LT-ADDRESS-LINE         PIC X(30).
  4688         16  FILLER                  PIC X(40).
  4689
  4690     12  LT-HEADER-RECORD  REDEFINES  LT-TEXT-RECORD.
  4691         16  FILLER                  PIC XX.
  4692         16  LT-CARRIER              PIC X.
  4693         16  LT-CLAIM-NO             PIC X(7).
  4694         16  LT-CERT-NO.
  4695             20  LT-CERT-PRIME       PIC X(10).
  4696             20  LT-CERT-SFX         PIC X.
  4697         16  LT-NO-OF-COPIES         PIC S9.
  4698         16  LT-RESEND-DATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL152.cbl
  4699         16  LT-PROCESSOR-CD         PIC X(4).
  4700         16  LT-CREATION-DT          PIC XX.
  4701         16  LT-INITIAL-PRINT-DATE   PIC XX.
  4702         16  LT-RESEND-PRINT-DATE    PIC XX.
  4703         16  LT-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4704         16  LT-1ST-RESEND-PRINT-DT  PIC XX.
  4705         16  LT-DMD-ADDITIONAL-FIELDS.
  4706             20  LT-DMD-LETTER-FORM      PIC X(4).
  4707             20  LT-DMD-PROD-CODE        PIC XX.
  4708             20  LT-DMD-RES-ST           PIC XX.
  4709             20  LT-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4710             20  LT-DMD-LETTER-STATUS    PIC X.
  4711                 88  LT-DMD-LETTER-ONLINE   VALUE '1'.
  4712                 88  LT-DMD-LETTER-PURGED   VALUE '2'.
  4713                 88  LT-DMD-LETTER-RELOADED VALUE '3'.
  4714             20  LT-DMD-LETTER-PURGE-DT  PIC XX.
  4715             20  LT-DMD-LETTER-RELOAD-DT PIC XX.
  4716             20  LT-DMD-UND-CODE         PIC XX.
  4717             20  LT-DMD-BEN-CODE         PIC XX.
  4718         16  FILLER                  PIC X(15).
  4719
  4720     12  LT-FORM-CONTROL-HEADER REDEFINES  LT-TEXT-RECORD.
  4721         16  FILLER                  PIC XX.
  4722         16  LT4-CARRIER             PIC X.
  4723         16  LT4-CLAIM-NO            PIC X(7).
  4724         16  LT4-CERT-NO.
  4725             20  LT4-CERT-PRIME      PIC X(10).
  4726             20  LT4-CERT-SFX        PIC X.
  4727         16  LT4-NO-OF-COPIES        PIC S9.
  4728         16  LT4-RESEND-DATE         PIC XX.
  4729         16  LT4-PROCESSOR-CD        PIC X(4).
  4730         16  LT4-CREATION-DT         PIC XX.
  4731         16  LT4-INITIAL-PRINT-DATE  PIC XX.
  4732         16  LT4-RESEND-PRINT-DATE   PIC XX.
  4733         16  LT4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4734         16  LT4-FORM-TYPE           PIC X.
  4735             88  LT4-INITIAL-FORM    VALUE '1'.
  4736             88  LT4-PROGRESS-FORM   VALUE '2'.
  4737         16  LT4-FORM-REM-PRINT-DT   PIC XX.
  4738         16  LT4-STATE               PIC XX.
  4739         16  FILLER                  PIC X(31).
  4740******************************************************************
  4741
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL152.cbl
  4743*                                COPY ELCCERT.
  4744******************************************************************
  4745*                                                                *
  4746*                            ELCCERT.                            *
  4747*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4748*                            VMOD=2.013                          *
  4749*                                                                *
  4750*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4751*                                                                *
  4752*   FILE TYPE = VSAM,KSDS                                        *
  4753*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4754*                                                                *
  4755*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4756*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4757*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4758*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4759*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4760*                                                                *
  4761*   LOG = YES                                                    *
  4762*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4763******************************************************************
  4764*                   C H A N G E   L O G
  4765*
  4766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4767*-----------------------------------------------------------------
  4768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4769* EFFECTIVE    NUMBER
  4770*-----------------------------------------------------------------
  4771* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4772* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4773* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4774* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4775* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4776* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4777* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4778* 032612  CR2011110200001  PEMA  AHL CHANGES
  4779******************************************************************
  4780
  4781 01  CERTIFICATE-MASTER.
  4782     12  CM-RECORD-ID                      PIC XX.
  4783         88  VALID-CM-ID                      VALUE 'CM'.
  4784
  4785     12  CM-CONTROL-PRIMARY.
  4786         16  CM-COMPANY-CD                 PIC X.
  4787         16  CM-CARRIER                    PIC X.
  4788         16  CM-GROUPING.
  4789             20  CM-GROUPING-PREFIX        PIC X(3).
  4790             20  CM-GROUPING-PRIME         PIC X(3).
  4791         16  CM-STATE                      PIC XX.
  4792         16  CM-ACCOUNT.
  4793             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4794             20  CM-ACCOUNT-PRIME          PIC X(6).
  4795         16  CM-CERT-EFF-DT                PIC XX.
  4796         16  CM-CERT-NO.
  4797             20  CM-CERT-PRIME             PIC X(10).
  4798             20  CM-CERT-SFX               PIC X.
  4799
  4800     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL152.cbl
  4801         16  CM-COMPANY-CD-A1              PIC X.
  4802         16  CM-INSURED-LAST-NAME          PIC X(15).
  4803         16  CM-INSURED-INITIALS.
  4804             20  CM-INSURED-INITIAL1       PIC X.
  4805             20  CM-INSURED-INITIAL2       PIC X.
  4806
  4807     12  CM-CONTROL-BY-SSN.
  4808         16  CM-COMPANY-CD-A2              PIC X.
  4809         16  CM-SOC-SEC-NO.
  4810             20  CM-SSN-STATE              PIC XX.
  4811             20  CM-SSN-ACCOUNT            PIC X(6).
  4812             20  CM-SSN-LN3.
  4813                 25  CM-INSURED-INITIALS-A2.
  4814                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4815                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4816                 25 CM-PART-LAST-NAME-A2         PIC X.
  4817
  4818     12  CM-CONTROL-BY-CERT-NO.
  4819         16  CM-COMPANY-CD-A4              PIC X.
  4820         16  CM-CERT-NO-A4                 PIC X(11).
  4821
  4822     12  CM-CONTROL-BY-MEMB.
  4823         16  CM-COMPANY-CD-A5              PIC X.
  4824         16  CM-MEMBER-NO.
  4825             20  CM-MEMB-STATE             PIC XX.
  4826             20  CM-MEMB-ACCOUNT           PIC X(6).
  4827             20  CM-MEMB-LN4.
  4828                 25  CM-INSURED-INITIALS-A5.
  4829                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4830                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4831                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4832
  4833     12  CM-INSURED-PROFILE-DATA.
  4834         16  CM-INSURED-FIRST-NAME.
  4835             20  CM-INSURED-1ST-INIT       PIC X.
  4836             20  FILLER                    PIC X(9).
  4837         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4838         16  CM-INSURED-SEX                PIC X.
  4839             88  CM-SEX-MALE                  VALUE 'M'.
  4840             88  CM-SEX-FEMAL                 VALUE 'F'.
  4841         16  CM-INSURED-JOINT-AGE          PIC 99.
  4842         16  CM-JOINT-INSURED-NAME.
  4843             20  CM-JT-LAST-NAME           PIC X(15).
  4844             20  CM-JT-FIRST-NAME.
  4845                 24  CM-JT-1ST-INIT        PIC X.
  4846                 24  FILLER                PIC X(9).
  4847             20  CM-JT-INITIAL             PIC X.
  4848
  4849     12  CM-LIFE-DATA.
  4850         16  CM-LF-BENEFIT-CD              PIC XX.
  4851         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4852         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4853         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4854         16  CM-LF-DEV-CODE                PIC XXX.
  4855         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4856         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4857         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4858         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL152.cbl
  4859         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4860         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4861         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4862         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4863         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4864         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4865         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4866         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4867         16  FILLER                        PIC XX.
  4868
  4869     12  CM-AH-DATA.
  4870         16  CM-AH-BENEFIT-CD              PIC XX.
  4871         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4872         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4873         16  CM-AH-DEV-CODE                PIC XXX.
  4874         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4875         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4876         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4877         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4878         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4879         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4880         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4881         16  CM-AH-PAID-THRU-DT            PIC XX.
  4882             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4883         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4884         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4885         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4886         16  FILLER                        PIC X.
  4887
  4888     12  CM-LOAN-INFORMATION.
  4889         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4890         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4891                                           PIC S9(5)V99  COMP-3.
  4892         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4893         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4894         16  CM-PAY-FREQUENCY              PIC S99.
  4895         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4896         16  CM-RATE-CLASS                 PIC XX.
  4897         16  CM-BENEFICIARY                PIC X(25).
  4898         16  CM-POLICY-FORM-NO             PIC X(12).
  4899         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4900         16  CM-LAST-ADD-ON-DT             PIC XX.
  4901         16  CM-DEDUCTIBLE-AMOUNTS.
  4902             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4903             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4904         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4905             20  CM-RESIDENT-STATE         PIC XX.
  4906             20  CM-RATE-CODE              PIC X(4).
  4907             20  FILLER                    PIC XX.
  4908         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4909             20  CM-LOAN-OFFICER           PIC X(5).
  4910             20  FILLER                    PIC XXX.
  4911         16  CM-CSR-CODE                   PIC XXX.
  4912         16  CM-UNDERWRITING-CODE          PIC X.
  4913             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4914         16  CM-POST-CARD-IND              PIC X.
  4915         16  CM-NH-INTERFACE-SW            PIC X.
  4916         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL152.cbl
  4917             88  CM-SING-PRM                  VALUE '1'.
  4918             88  CM-O-B-COVERAGE              VALUE '2'.
  4919             88  CM-OPEN-END                  VALUE '3'.
  4920         16  CM-IND-GRP-TYPE               PIC X.
  4921             88  CM-INDIVIDUAL                VALUE 'I'.
  4922             88  CM-GROUP                     VALUE 'G'.
  4923         16  CM-SKIP-CODE                  PIC X.
  4924             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4925             88  SKIP-JULY                    VALUE '1'.
  4926             88  SKIP-AUGUST                  VALUE '2'.
  4927             88  SKIP-SEPTEMBER               VALUE '3'.
  4928             88  SKIP-JULY-AUG                VALUE '4'.
  4929             88  SKIP-AUG-SEPT                VALUE '5'.
  4930             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4931             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4932             88  SKIP-JUNE                    VALUE '8'.
  4933             88  SKIP-JUNE-JULY               VALUE '9'.
  4934             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4935             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4936         16  CM-PAYMENT-MODE               PIC X.
  4937             88  PAY-MONTHLY                  VALUE SPACE.
  4938             88  PAY-WEEKLY                   VALUE '1'.
  4939             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4940             88  PAY-BI-WEEKLY                VALUE '3'.
  4941             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4942         16  CM-LOAN-NUMBER                PIC X(8).
  4943         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4944         16  CM-OLD-LOF                    PIC XXX.
  4945*        16  CM-LOAN-OFFICER               PIC XXX.
  4946         16  CM-REIN-TABLE                 PIC XXX.
  4947         16  CM-SPECIAL-REIN-CODE          PIC X.
  4948         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4949         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4950         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4951
  4952     12  CM-STATUS-DATA.
  4953         16  CM-ENTRY-STATUS               PIC X.
  4954         16  CM-ENTRY-DT                   PIC XX.
  4955
  4956         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4957         16  CM-LF-CANCEL-DT               PIC XX.
  4958         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4959
  4960         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4961         16  CM-LF-DEATH-DT                PIC XX.
  4962         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4963
  4964         16  CM-LF-CURRENT-STATUS          PIC X.
  4965             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4966                                                'M' '4' '5' '9'.
  4967             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4968             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4969             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4970             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4971             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4972             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4973             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4974             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL152.cbl
  4975             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4976             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4977             88  CM-LF-DECLINED               VALUE 'D'.
  4978             88  CM-LF-VOIDED                 VALUE 'V'.
  4979
  4980         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4981         16  CM-AH-CANCEL-DT               PIC XX.
  4982         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4983
  4984         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4985         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4986         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4987
  4988         16  CM-AH-CURRENT-STATUS          PIC X.
  4989             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4990                                                'M' '4' '5' '9'.
  4991             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4992             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4993             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4994             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4995             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4996             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4997             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4998             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4999             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5000             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5001             88  CM-AH-DECLINED               VALUE 'D'.
  5002             88  CM-AH-VOIDED                 VALUE 'V'.
  5003
  5004         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5005             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5006             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5007             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5008         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5009
  5010         16  CM-ENTRY-BATCH                PIC X(6).
  5011         16  CM-LF-EXIT-BATCH              PIC X(6).
  5012         16  CM-AH-EXIT-BATCH              PIC X(6).
  5013         16  CM-LAST-MONTH-END             PIC XX.
  5014
  5015     12  CM-NOTE-SW                        PIC X.
  5016         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5017         88  CERT-NOTES-PRESENT               VALUE '1'.
  5018         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5019         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5020         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5021         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5022         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5023         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5024     12  CM-COMP-EXCP-SW                   PIC X.
  5025         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5026         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5027     12  CM-INSURED-ADDRESS-SW             PIC X.
  5028         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5029         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5030
  5031*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5032     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL152.cbl
  5033     12  FILLER                            PIC X.
  5034
  5035*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5036     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5037     12  FILLER                            PIC X.
  5038*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5039     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5040
  5041     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5042         88  CERT-ADDED-BATCH                 VALUE ' '.
  5043         88  CERT-ADDED-ONLINE                VALUE '1'.
  5044         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5045         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5046         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5047     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5048         88  CERT-AS-LOADED                   VALUE ' '.
  5049         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5050         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5051         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5052         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5053         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5054         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5055         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5056
  5057     12  CM-ACCOUNT-COMM-PCTS.
  5058         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5059         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5060
  5061     12  CM-USER-FIELD                     PIC X.
  5062     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5063     12  CM-CLP-STATE                      PIC XX.
  5064     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5065     12  CM-USER-RESERVED                  PIC XXX.
  5066     12  FILLER REDEFINES CM-USER-RESERVED.
  5067         16  CM-AH-CLASS-CD                PIC XX.
  5068         16  F                             PIC X.
  5069******************************************************************
  5070
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL152.cbl
  5072*                                COPY ERCACCT.
  5073******************************************************************
  5074*                                                                *
  5075*                                                                *
  5076*                            ERCACCT                             *
  5077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5078*                            VMOD=2.031                          *
  5079*                                                                *
  5080*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5081*                                                                *
  5082*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5083*   VSAM ACCOUNT MASTER FILES.                                   *
  5084*                                                                *
  5085*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5086*                                                                *
  5087*   FILE TYPE = VSAM,KSDS                                        *
  5088*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5089*                                                                *
  5090*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5091*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5092*                                                                *
  5093*   LOG = NO                                                     *
  5094*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5095*                                                                *
  5096*                                                                *
  5097******************************************************************
  5098*                   C H A N G E   L O G
  5099*
  5100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5101*-----------------------------------------------------------------
  5102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5103* EFFECTIVE    NUMBER
  5104*-----------------------------------------------------------------
  5105* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5106* 092705    2005050300006  PEMA  ADD SPP LEASES
  5107* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5109* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5110* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5111* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5112******************************************************************
  5113
  5114 01  ACCOUNT-MASTER.
  5115     12  AM-RECORD-ID                      PIC XX.
  5116         88  VALID-AM-ID                      VALUE 'AM'.
  5117
  5118     12  AM-CONTROL-PRIMARY.
  5119         16  AM-COMPANY-CD                 PIC X.
  5120         16  AM-MSTR-CNTRL.
  5121             20  AM-CONTROL-A.
  5122                 24  AM-CARRIER            PIC X.
  5123                 24  AM-GROUPING.
  5124                     28 AM-GROUPING-PREFIX PIC XXX.
  5125                     28 AM-GROUPING-PRIME  PIC XXX.
  5126                 24  AM-STATE              PIC XX.
  5127                 24  AM-ACCOUNT.
  5128                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5129                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL152.cbl
  5130             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5131                                           PIC X(19).
  5132             20  AM-CNTRL-B.
  5133                 24  AM-EXPIRATION-DT      PIC XX.
  5134                 24  FILLER                PIC X(4).
  5135             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5136                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5137
  5138     12  AM-CONTROL-BY-VAR-GRP.
  5139         16  AM-COMPANY-CD-A1              PIC X.
  5140         16  AM-VG-CARRIER                 PIC X.
  5141         16  AM-VG-GROUPING                PIC X(6).
  5142         16  AM-VG-STATE                   PIC XX.
  5143         16  AM-VG-ACCOUNT                 PIC X(10).
  5144         16  AM-VG-DATE.
  5145             20  AM-VG-EXPIRATION-DT       PIC XX.
  5146             20  FILLER                    PIC X(4).
  5147         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5148                                           PIC 9(11)      COMP-3.
  5149     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5150         16  FILLER                        PIC X(10).
  5151         16  AM-VG-KEY3.
  5152             20  AM-VG3-ACCOUNT            PIC X(10).
  5153             20  AM-VG3-EXP-DT             PIC XX.
  5154         16  FILLER                        PIC X(4).
  5155     12  AM-MAINT-INFORMATION.
  5156         16  AM-LAST-MAINT-DT              PIC XX.
  5157         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5158         16  AM-LAST-MAINT-USER            PIC X(4).
  5159         16  FILLER                        PIC XX.
  5160
  5161     12  AM-EFFECTIVE-DT                   PIC XX.
  5162     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5163
  5164     12  AM-PREV-DATES  COMP-3.
  5165         16  AM-PREV-EXP-DT                PIC 9(11).
  5166         16  AM-PREV-EFF-DT                PIC 9(11).
  5167
  5168     12  AM-REPORT-CODE-1                  PIC X(10).
  5169     12  AM-REPORT-CODE-2                  PIC X(10).
  5170
  5171     12  AM-CITY-CODE                      PIC X(4).
  5172     12  AM-COUNTY-PARISH                  PIC X(6).
  5173
  5174     12  AM-NAME                           PIC X(30).
  5175     12  AM-PERSON                         PIC X(30).
  5176     12  AM-ADDRS                          PIC X(30).
  5177     12  AM-CITY.
  5178         16  AM-ADDR-CITY                  PIC X(28).
  5179         16  AM-ADDR-STATE                 PIC XX.
  5180     12  AM-ZIP.
  5181         16  AM-ZIP-PRIME.
  5182             20  AM-ZIP-PRI-1ST            PIC X.
  5183                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5184             20  FILLER                    PIC X(4).
  5185         16  AM-ZIP-PLUS4                  PIC X(4).
  5186     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5187         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL152.cbl
  5188         16  AM-CAN-POSTAL-2               PIC XXX.
  5189         16  FILLER                        PIC XXX.
  5190     12  AM-TEL-NO.
  5191         16  AM-AREA-CODE                  PIC 999.
  5192         16  AM-TEL-PRE                    PIC 999.
  5193         16  AM-TEL-NBR                    PIC 9(4).
  5194     12  AM-TEL-LOC                        PIC X.
  5195         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5196         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5197
  5198     12  AM-COMM-STRUCTURE.
  5199         16  AM-DEFN-1.
  5200             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5201                 24  AM-AGT.
  5202                     28  AM-AGT-PREFIX     PIC X(4).
  5203                     28  AM-AGT-PRIME      PIC X(6).
  5204                 24  AM-COM-TYP            PIC X.
  5205                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5206                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5207                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5208                 24  AM-RECALC-LV-INDIC    PIC X.
  5209                 24  AM-RETRO-LV-INDIC     PIC X.
  5210                 24  AM-GL-CODES           PIC X.
  5211                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5212                 24  FILLER                PIC X(01).
  5213         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5214             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5215                 24  FILLER                PIC X(11).
  5216                 24  AM-L-COMA             PIC XXX.
  5217                 24  AM-J-COMA             PIC XXX.
  5218                 24  AM-A-COMA             PIC XXX.
  5219                 24  FILLER                PIC X(6).
  5220
  5221     12  AM-COMM-CHANGE-STATUS             PIC X.
  5222         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5223
  5224     12  AM-CSR-CODE                       PIC X(4).
  5225
  5226     12  AM-BILLING-STATUS                 PIC X.
  5227         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5228         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5229     12  AM-AUTO-REFUND-SW                 PIC X.
  5230         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5231         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5232     12  AM-GPCD                           PIC 99.
  5233     12  AM-IG                             PIC X.
  5234         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5235         88  AM-HAS-GROUP                     VALUE '2'.
  5236     12  AM-STATUS                         PIC X.
  5237         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5238         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5239         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5240         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5241         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5242         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5243     12  AM-REMIT-TO                       PIC 99.
  5244     12  AM-ID-NO                          PIC X(11).
  5245
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL152.cbl
  5246     12  AM-CAL-TABLE                      PIC XX.
  5247     12  AM-LF-DEVIATION                   PIC XXX.
  5248     12  AM-AH-DEVIATION                   PIC XXX.
  5249     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5250     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5251     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5252     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5253     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5254     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5255
  5256     12  AM-USER-FIELDS.
  5257         16  AM-FLD-1                      PIC XX.
  5258         16  AM-FLD-2                      PIC XX.
  5259         16  AM-FLD-3                      PIC XX.
  5260         16  AM-FLD-4                      PIC XX.
  5261         16  AM-FLD-5                      PIC XX.
  5262
  5263     12  AM-1ST-PROD-DATE.
  5264         16  AM-1ST-PROD-YR                PIC XX.
  5265         16  AM-1ST-PROD-MO                PIC XX.
  5266         16  AM-1ST-PROD-DA                PIC XX.
  5267     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5268     12  AM-CERTS-PURGED-DATE.
  5269         16  AM-PUR-YR                     PIC XX.
  5270         16  AM-PUR-MO                     PIC XX.
  5271         16  AM-PUR-DA                     PIC XX.
  5272     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5273     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5274     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5275     12  AM-INACTIVE-DATE.
  5276         16  AM-INA-MO                     PIC 99.
  5277         16  AM-INA-DA                     PIC 99.
  5278         16  AM-INA-YR                     PIC 99.
  5279     12  AM-AR-HI-CERT-DATE                PIC XX.
  5280
  5281     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5282     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5283
  5284     12  AM-OB-PAYMENT-MODE                PIC X.
  5285         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5286         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5287         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5288         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5289
  5290     12  AM-AH-ONLY-INDICATOR              PIC X.
  5291         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5292         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5293
  5294     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5295
  5296     12  AM-OVER-SHORT.
  5297         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5298         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5299
  5300     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5301     12  AM-DCC-CLP-STATE                  PIC XX.
  5302
  5303     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL152.cbl
  5304     12  AM-RECALC-REIN                    PIC X.
  5305
  5306     12  AM-REI-TABLE                      PIC XXX.
  5307     12  AM-REI-ET-LF                      PIC X.
  5308     12  AM-REI-ET-AH                      PIC X.
  5309     12  AM-REI-PE-LF                      PIC X.
  5310     12  AM-REI-PE-AH                      PIC X.
  5311     12  AM-REI-PRT-ST                     PIC X.
  5312     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5313     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5314     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5315     12  AM-REI-GROUP-A                    PIC X(6).
  5316     12  AM-REI-MORT                       PIC X(4).
  5317     12  AM-REI-PRT-OW                     PIC X.
  5318     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5319     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5320     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5321     12  AM-REI-GROUP-B                    PIC X(6).
  5322
  5323     12  AM-TRUST-TYPE                     PIC X(2).
  5324
  5325     12  AM-EMPLOYER-STMT-USED             PIC X.
  5326     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5327
  5328     12  AM-STD-AH-TYPE                    PIC XX.
  5329     12  AM-EARN-METHODS.
  5330         16  AM-EARN-METHOD-R              PIC X.
  5331             88 AM-REF-RL-R78                 VALUE 'R'.
  5332             88 AM-REF-RL-PR                  VALUE 'P'.
  5333             88 AM-REF-RL-MEAN                VALUE 'M'.
  5334             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5335         16  AM-EARN-METHOD-L              PIC X.
  5336             88 AM-REF-LL-R78                 VALUE 'R'.
  5337             88 AM-REF-LL-PR                  VALUE 'P'.
  5338             88 AM-REF-LL-MEAN                VALUE 'M'.
  5339             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5340         16  AM-EARN-METHOD-A              PIC X.
  5341             88 AM-REF-AH-R78                 VALUE 'R'.
  5342             88 AM-REF-AH-PR                  VALUE 'P'.
  5343             88 AM-REF-AH-MEAN                VALUE 'M'.
  5344             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5345             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5346             88 AM-REF-AH-NET                 VALUE 'N'.
  5347
  5348     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5349     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5350     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5351
  5352     12  AM-RET-Y-N                        PIC X.
  5353     12  AM-RET-P-E                        PIC X.
  5354     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5355     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5356     12  AM-RET-GRP                        PIC X(6).
  5357     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5358         16  AM-POOL-PRIME                 PIC XXX.
  5359         16  AM-POOL-SUB                   PIC XXX.
  5360     12  AM-RETRO-EARNINGS.
  5361         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL152.cbl
  5362         16  AM-RET-EARN-L                 PIC X.
  5363         16  AM-RET-EARN-A                 PIC X.
  5364     12  AM-RET-ST-TAX-USE                 PIC X.
  5365         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5366         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5367     12  AM-RETRO-BEG-EARNINGS.
  5368         16  AM-RET-BEG-EARN-R             PIC X.
  5369         16  AM-RET-BEG-EARN-L             PIC X.
  5370         16  AM-RET-BEG-EARN-A             PIC X.
  5371     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5372     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5373
  5374     12  AM-USER-SELECT-OPTIONS.
  5375         16  AM-USER-SELECT-1              PIC X(10).
  5376         16  AM-USER-SELECT-2              PIC X(10).
  5377         16  AM-USER-SELECT-3              PIC X(10).
  5378         16  AM-USER-SELECT-4              PIC X(10).
  5379         16  AM-USER-SELECT-5              PIC X(10).
  5380
  5381     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5382
  5383     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5384
  5385     12  AM-RPT045A-SWITCH                 PIC X.
  5386         88  RPT045A-OFF                   VALUE 'N'.
  5387
  5388     12  AM-INSURANCE-LIMITS.
  5389         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5390         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5391
  5392     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5393         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5394
  5395     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5396         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5397         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5398
  5399     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5400
  5401     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5402     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5403     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5404     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5405     12  AM-DCC-UEF-STATE                  PIC XX.
  5406     12  FILLER                            PIC XXX.
  5407     12  AM-REPORT-CODE-3                  PIC X(10).
  5408*    12  FILLER                            PIC X(22).
  5409
  5410     12  AM-RESERVE-DATE.
  5411         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5412         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5413         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5414
  5415     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5416     12  AM-NOTIFICATION-TYPES.
  5417         16  AM-NOTIF-OF-LETTERS           PIC X.
  5418         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5419         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL152.cbl
  5420         16  AM-NOTIF-OF-STATUS            PIC X.
  5421
  5422     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5423         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5424         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5425         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5426         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5427
  5428     12  AM-BENEFIT-CONTROLS.
  5429         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5430             20  AM-BENEFIT-CODE           PIC XX.
  5431             20  AM-BENEFIT-TYPE           PIC X.
  5432             20  AM-BENEFIT-REVISION       PIC XXX.
  5433             20  AM-BENEFIT-REM-TERM       PIC X.
  5434             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5435             20  FILLER                    PIC XX.
  5436         16  FILLER                        PIC X(80).
  5437
  5438     12  AM-TRANSFER-DATA.
  5439         16  AM-TRANSFERRED-FROM.
  5440             20  AM-TRNFROM-CARRIER        PIC X.
  5441             20  AM-TRNFROM-GROUPING.
  5442                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5443                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5444             20  AM-TRNFROM-STATE          PIC XX.
  5445             20  AM-TRNFROM-ACCOUNT.
  5446                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5447                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5448             20  AM-TRNFROM-DTE            PIC XX.
  5449         16  AM-TRANSFERRED-TO.
  5450             20  AM-TRNTO-CARRIER          PIC X.
  5451             20  AM-TRNTO-GROUPING.
  5452                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5453                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5454             20  AM-TRNTO-STATE            PIC XX.
  5455             20  AM-TRNTO-ACCOUNT.
  5456                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5457                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5458             20  AM-TRNTO-DTE              PIC XX.
  5459         16  FILLER                        PIC X(10).
  5460
  5461     12  AM-SAVED-REMIT-TO                 PIC 99.
  5462
  5463     12  AM-COMM-STRUCTURE-SAVED.
  5464         16  AM-DEFN-1-SAVED.
  5465             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5466                 24  AM-AGT-SV             PIC X(10).
  5467                 24  AM-COM-TYP-SV         PIC X.
  5468                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5469                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5470                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5471                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5472                 24  FILLER                PIC X.
  5473                 24  AM-GL-CODES-SV        PIC X.
  5474                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5475                 24  FILLER                PIC X.
  5476         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5477             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL152.cbl
  5478                 24  FILLER                PIC X(11).
  5479                 24  AM-L-COMA-SV          PIC XXX.
  5480                 24  AM-J-COMA-SV          PIC XXX.
  5481                 24  AM-A-COMA-SV          PIC XXX.
  5482                 24  FILLER                PIC X(6).
  5483
  5484     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5485         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5486            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5487            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5488            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5489
  5490     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5491     12  FILLER                            PIC X(120).
  5492
  5493     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5494         16  AM-CONTROL-NAME               PIC X(30).
  5495         16  AM-EXECUTIVE-ONE.
  5496             20  AM-EXEC1-NAME             PIC X(15).
  5497             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5498                                                          COMP-3.
  5499             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5500                                                          COMP-3.
  5501         16  AM-EXECUTIVE-TWO.
  5502             20  AM-EXEC2-NAME             PIC X(15).
  5503             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5504                                                          COMP-3.
  5505             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5506                                                          COMP-3.
  5507
  5508     12  AM-RETRO-ADDITIONAL-DATA.
  5509         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5510         16  AM-RETRO-PREM-P-E             PIC X.
  5511         16  AM-RETRO-CLMS-P-I             PIC X.
  5512         16  AM-RETRO-RET-BRACKET-LF.
  5513             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5514                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5515                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5516             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5517                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5518                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5519             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5520                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5521                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5522         16  AM-RETRO-RET-BRACKET-AH.
  5523             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5524                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5525                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5526                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5527             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5528                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5529                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5530             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5531                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5532                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5533
  5534     12  AM-COMMENTS.
  5535         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL152.cbl
  5536
  5537     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5538         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5539         16  AM-FLI-BILLING-CODE           PIC X.
  5540         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5541         16  AM-FLI-UNITED-IDENT           PIC X.
  5542         16  AM-FLI-INTEREST-LOST-DATA.
  5543             20  AM-FLI-BANK-NO            PIC X(5).
  5544             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5545             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5546             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5547         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5548             20  AM-FLI-AGT                PIC X(9).
  5549             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5550             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5551         16  FILLER                        PIC X(102).
  5552
  5553     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5554         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5555             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5556             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5557             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5558             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5559             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5560         16  FILLER                          PIC X(10).
  5561******************************************************************
  5562
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL152.cbl
  5564*                                COPY ELCTEXT.
  5565******************************************************************
  5566*                                                                *
  5567*                                                                *
  5568*                            ELCTEXT.                            *
  5569*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5570*                            VMOD=2.008                          *
  5571*                                                                *
  5572*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5573*                                     FORM LETTERS,              *
  5574*                                     CERT FORM DISPLAY.
  5575*                                                                *
  5576*   FILE TYPE = VSAM,KSDS                                        *
  5577*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5578*                                                                *
  5579*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5580*       ALTERNATE INDEX = NONE                                   *
  5581*                                                                *
  5582*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5583*       ALTERNATE INDEX = NONE                                   *
  5584*                                                                *
  5585*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5586*       ALTERNATE INDEX = NONE                                   *
  5587*                                                                *
  5588*   LOG = NO                                                     *
  5589*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5590******************************************************************
  5591 01  TEXT-FILES.
  5592     12  TEXT-FILE-ID                PIC XX.
  5593         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5594         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5595         88  HELP-FILE-TEXT             VALUE 'TH'.
  5596
  5597     12  TX-CONTROL-PRIMARY.
  5598         16  TX-COMPANY-CD           PIC X.
  5599             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5600         16  TX-ACCESS-CD-GENL       PIC X(12).
  5601
  5602         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5603             20  TX-LETTER-NO        PIC X(4).
  5604             20  FILLER              PIC X(8).
  5605
  5606         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5607             20  TX-FORM-NO          PIC X(12).
  5608
  5609         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5610             20  TX-HELP-TYPE        PIC X.
  5611                 88  HELP-FOR-GENERAL   VALUE ' '.
  5612                 88  HELP-BY-SCREEN     VALUE 'S'.
  5613                 88  HELP-BY-ERROR      VALUE 'E'.
  5614             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5615                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5616             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5617                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5618             20  FILLER              PIC X(4).
  5619
  5620         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5621
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL152.cbl
  5622     12  TX-PROCESS-CONTROL          PIC XX.
  5623         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5624
  5625     12  TX-TEXT-LINE                PIC X(70).
  5626
  5627     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5628         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5629         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5630         88  TX-VALID-FORM-SQUEEZE-VALUE
  5631                                        VALUE 'Y' ' '.
  5632
  5633     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5634         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5635         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5636         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5637         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5638         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5639         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5640         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5641                                              'K' 'N' ' '
  5642                                              'Z'.
  5643
  5644     12  TX-ARCHIVE-SW               PIC X.
  5645         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5646         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5647         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5648
  5649     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5650     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5651
  5652     12  TX-BSR-CODE                 PIC X.
  5653         88  TX-BSR-LETTER              VALUE 'B'.
  5654         88  TX-NON-BSR-LETTER          VALUE ' '.
  5655
  5656     12  FILLER                      PIC X.
  5657*****************************************************************
  5658
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL152.cbl
  5660*                                COPY ELCTRLR.
  5661******************************************************************
  5662*                                                                *
  5663*                            ELCTRLR.                            *
  5664*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5665*                            VMOD=2.014                          *
  5666*                                                                *
  5667*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5668*                                                                *
  5669*   FILE TYPE = VSAM,KSDS                                        *
  5670*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5671*                                                                *
  5672*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5673*       ALTERNATE INDEX = NONE                                   *
  5674*                                                                *
  5675*   LOG = YES                                                    *
  5676*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5677******************************************************************
  5678*                   C H A N G E   L O G
  5679*
  5680* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5681*-----------------------------------------------------------------
  5682*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5683* EFFECTIVE    NUMBER
  5684*-----------------------------------------------------------------
  5685* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5686* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5687* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5688* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5689* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5690* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5691* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5692* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5693* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5694* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5695* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5696* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5697* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5698******************************************************************
  5699 01  ACTIVITY-TRAILERS.
  5700     12  AT-RECORD-ID                    PIC XX.
  5701         88  VALID-AT-ID                       VALUE 'AT'.
  5702
  5703     12  AT-CONTROL-PRIMARY.
  5704         16  AT-COMPANY-CD               PIC X.
  5705         16  AT-CARRIER                  PIC X.
  5706         16  AT-CLAIM-NO                 PIC X(7).
  5707         16  AT-CERT-NO.
  5708             20  AT-CERT-PRIME           PIC X(10).
  5709             20  AT-CERT-SFX             PIC X.
  5710         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5711             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5712             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5713             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5714             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5715             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5716             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5717             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL152.cbl
  5718             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5719             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5720             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5721             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5722             88  AT-BENEFICIARY-TRL           VALUE +91.
  5723             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5724             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5725
  5726     12  AT-TRAILER-TYPE                 PIC X.
  5727         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5728         88  PAYMENT-TR                       VALUE '2'.
  5729         88  AUTO-PAY-TR                      VALUE '3'.
  5730         88  CORRESPONDENCE-TR                VALUE '4'.
  5731         88  ADDRESS-TR                       VALUE '5'.
  5732         88  GENERAL-INFO-TR                  VALUE '6'.
  5733         88  AUTO-PROMPT-TR                   VALUE '7'.
  5734         88  DENIAL-TR                        VALUE '8'.
  5735         88  INCURRED-CHG-TR                  VALUE '9'.
  5736         88  FORM-CONTROL-TR                  VALUE 'A'.
  5737
  5738     12  AT-RECORDED-DT                  PIC XX.
  5739     12  AT-RECORDED-BY                  PIC X(4).
  5740     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5741
  5742     12  AT-TRAILER-BODY                 PIC X(165).
  5743
  5744     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5745         16  AT-RESERVE-CONTROLS.
  5746             20  AT-MANUAL-SW            PIC X.
  5747                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5748             20  AT-FUTURE-SW            PIC X.
  5749                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5750             20  AT-PTC-SW               PIC X.
  5751                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5752             20  AT-IBNR-SW              PIC X.
  5753                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5754             20  AT-PTC-LF-SW            PIC X.
  5755                 88  AT-LF-PTC-USED          VALUE '1'.
  5756             20  AT-CDT-ACCESS-METHOD    PIC X.
  5757                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5758                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5759                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5760             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5761         16  AT-LAST-COMPUTED-DT         PIC XX.
  5762         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5763         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5764         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5765         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5766         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5767         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5768         16  AT-EXPENSE-CONTROLS.
  5769             20  AT-EXPENSE-METHOD       PIC X.
  5770                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5771                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5772                 88  PERCENT-OF-PMT           VALUE '3'.
  5773                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5774             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5775             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL152.cbl
  5776         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5777         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5778
  5779         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5780         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5781
  5782*        16  FILLER                      PIC X(53).
  5783         16  FILLER                      PIC X(47).
  5784
  5785         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5786         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5787
  5788         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5789             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5790             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5791*                    C = CLOSED
  5792*                    O = OPEN
  5793             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5794*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5795
  5796     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5797         16  AT-PAYMENT-TYPE             PIC X.
  5798             88  PARTIAL-PAYMENT                VALUE '1'.
  5799             88  FINAL-PAYMENT                  VALUE '2'.
  5800             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5801             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5802             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5803             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5804             88  VOIDED-PAYMENT                 VALUE '9'.
  5805             88  TRANSFER                       VALUE 'T'.
  5806             88  LIFE-INTEREST                  VALUE 'I'.
  5807
  5808         16  AT-CLAIM-TYPE               PIC X.
  5809             88  PAID-FOR-AH                    VALUE 'A'.
  5810             88  PAID-FOR-LIFE                  VALUE 'L'.
  5811             88  PAID-FOR-IUI                   VALUE 'I'.
  5812             88  PAID-FOR-GAP                   VALUE 'G'.
  5813         16  AT-CLAIM-PREM-TYPE          PIC X.
  5814             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5815             88  AT-O-B-COVERAGE                VALUE '2'.
  5816             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5817         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5818         16  AT-CHECK-NO                 PIC X(7).
  5819         16  AT-PAID-FROM-DT             PIC XX.
  5820         16  AT-PAID-THRU-DT             PIC XX.
  5821         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5822         16  FILLER                      PIC X.
  5823         16  AT-PAYEES-NAME              PIC X(30).
  5824         16  AT-PAYMENT-ORIGIN           PIC X.
  5825             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5826             88  ONLINE-AUTO-PMT                VALUE '2'.
  5827             88  OFFLINE-PMT                    VALUE '3'.
  5828         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5829         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5830         16  AT-VOID-DATA.
  5831             20  AT-VOID-DT              PIC XX.
  5832*00144       20  AT-VOID-REASON          PIC X(30).
  5833             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL152.cbl
  5834         16  AT-PMT-APPROVED-BY          PIC X(04).
  5835         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5836         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5837         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5838                                         PIC S99V9(5)  COMP-3.
  5839         16  AT-CREDIT-INTERFACE.
  5840             20  AT-PMT-SELECT-DT        PIC XX.
  5841                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5842             20  AT-PMT-ACCEPT-DT        PIC XX.
  5843                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5844             20  AT-VOID-SELECT-DT       PIC XX.
  5845                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5846             20  AT-VOID-ACCEPT-DT       PIC XX.
  5847                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5848
  5849         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5850                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5851                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5852         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5853
  5854         16  AT-FORCE-CONTROL            PIC X.
  5855             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5856         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5857         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5858         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5859         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5860         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5861         16  AT-BENEFIT-TYPE             PIC X.
  5862
  5863         16  AT-EXPENSE-TYPE             PIC X.
  5864         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5865
  5866         16  AT-PAYEE-TYPE-CD.
  5867             20  AT-PAYEE-TYPE           PIC X.
  5868                 88  INSURED-PAID           VALUE 'I'.
  5869                 88  BENEFICIARY-PAID       VALUE 'B'.
  5870                 88  ACCOUNT-PAID           VALUE 'A'.
  5871                 88  OTHER-1-PAID           VALUE 'O'.
  5872                 88  OTHER-2-PAID           VALUE 'Q'.
  5873                 88  DOCTOR-PAID            VALUE 'P'.
  5874                 88  EMPLOYER-PAID          VALUE 'E'.
  5875             20  AT-PAYEE-SEQ            PIC X.
  5876
  5877         16  AT-CASH-PAYMENT             PIC X.
  5878         16  AT-GROUPED-PAYMENT          PIC X.
  5879         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5880         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5881         16  AT-APPROVED-LEVEL           PIC X.
  5882         16  AT-VOID-TYPE                PIC X.
  5883             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5884             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5885         16  AT-AIG-UNEMP-IND            PIC X.
  5886             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5887         16  AT-ASSOCIATES               PIC X.
  5888             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5889             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5890
  5891         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL152.cbl
  5892         16  AT-CV-PMT-CODE              PIC X.
  5893             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5894             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5895             88  FULL-ADD-PAYMENT           VALUE '3'.
  5896             88  HALF-ADD-PAYMENT           VALUE '4'.
  5897             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5898             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5899             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5900             88  ADDL-PAYMENT               VALUE '8'.
  5901
  5902         16  AT-EOB-CODE1                PIC XXX.
  5903         16  AT-EOB-CODE2                PIC XXX.
  5904         16  AT-EOB-CODE3                PIC XXX.
  5905         16  AT-EOB-CODE4                PIC XXX.
  5906         16  FILLER REDEFINES AT-EOB-CODE4.
  5907             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5908             20  FILLER                  PIC X.
  5909         16  AT-EOB-CODE5                PIC XXX.
  5910         16  FILLER REDEFINES AT-EOB-CODE5.
  5911             20  AT-PMT-PROOF-DT         PIC XX.
  5912             20  FILLER                  PIC X.
  5913
  5914         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5915             88  AT-PRINT-EOB            VALUE 'Y'.
  5916
  5917         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5918         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5919
  5920     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5921         16  AT-SCHEDULE-START-DT        PIC XX.
  5922         16  AT-SCHEDULE-END-DT          PIC XX.
  5923         16  AT-TERMINATED-DT            PIC XX.
  5924         16  AT-LAST-PMT-TYPE            PIC X.
  5925             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5926             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5927         16  AT-FIRST-PMT-DATA.
  5928             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5929             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5930             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5931         16  AT-REGULAR-PMT-DATA.
  5932             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5933             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5934             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5935         16  AT-AUTO-PAYEE-CD.
  5936             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5937                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5938                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5939                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5940                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5941                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5942             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5943         16  AT-AUTO-PAY-DAY             PIC 99.
  5944         16  AT-AUTO-CASH                PIC X.
  5945             88  AT-CASH                      VALUE 'Y'.
  5946             88  AT-NON-CASH                  VALUE 'N'.
  5947*        16  FILLER                      PIC X(129).
  5948         16  AT-AUTO-END-LETTER          PIC X(4).
  5949         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL152.cbl
  5950
  5951         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5952         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5953
  5954     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5955         16  AT-LETTER-SENT-DT           PIC XX.
  5956         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5957         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5958         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5959         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5960         16  AT-LETTER-ORIGIN            PIC X.
  5961             88  ONLINE-CREATION              VALUE '1' '3'.
  5962             88  OFFLINE-CREATION             VALUE '2' '4'.
  5963             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5964             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5965         16  AT-STD-LETTER-FORM          PIC X(4).
  5966         16  AT-REASON-TEXT              PIC X(70).
  5967         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5968         16  AT-ADDRESEE-TYPE            PIC X.
  5969              88  INSURED-ADDRESEE            VALUE 'I'.
  5970              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5971              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5972              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5973              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5974              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5975              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5976         16  AT-ADDRESSEE-NAME           PIC X(30).
  5977         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5978         16  AT-RESEND-PRINT-DATE        PIC XX.
  5979         16  AT-CORR-SOL-UNSOL           PIC X.
  5980         16  AT-LETTER-PURGED-DT         PIC XX.
  5981*
  5982*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5983*
  5984         16  AT-CSO-REDEFINITION.
  5985             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5986             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5987             20  AT-LETTER-TO-BENE       PIC X(1).
  5988             20  AT-STOP-LETTER-DT       PIC X(2).
  5989             20  FILLER                  PIC X(19).
  5990*             20  FILLER                  PIC X(27).
  5991             20  AT-CSO-LETTER-STATUS    PIC X.
  5992                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5993                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5994                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5995             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5996             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5997*
  5998*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5999*
  6000*        16  FILLER                      PIC X(26).
  6001*
  6002*        16  AT-DMD-BSR-CODE             PIC X.
  6003*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6004*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6005*
  6006*        16  AT-DMD-LETTER-STATUS        PIC X.
  6007*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL152.cbl
  6008*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6009*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6010*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6011*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6012
  6013         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6014         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6015
  6016     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6017         16  AT-ADDRESS-TYPE             PIC X.
  6018             88  INSURED-ADDRESS               VALUE 'I'.
  6019             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6020             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6021             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6022             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6023             88  OTHER-ADDRESS-1               VALUE 'O'.
  6024             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6025         16  AT-MAIL-TO-NAME             PIC X(30).
  6026         16  AT-ADDRESS-LINE-1           PIC X(30).
  6027         16  AT-ADDRESS-LINE-2           PIC X(30).
  6028         16  AT-CITY-STATE.
  6029             20  AT-CITY                 PIC X(28).
  6030             20  AT-STATE                PIC XX.
  6031         16  AT-ZIP.
  6032             20  AT-ZIP-CODE.
  6033                 24  AT-ZIP-1ST          PIC X.
  6034                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6035                 24  FILLER              PIC X(4).
  6036             20  AT-ZIP-PLUS4            PIC X(4).
  6037         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6038             20  AT-CAN-POSTAL-1         PIC XXX.
  6039             20  AT-CAN-POSTAL-2         PIC XXX.
  6040             20  FILLER                  PIC XXX.
  6041         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6042*         16  FILLER                      PIC X(23).
  6043         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6044         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6045         16  FILLER                      PIC X(13).
  6046         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6047         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6048
  6049     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6050         16  AT-INFO-LINE-1              PIC X(60).
  6051         16  AT-INFO-LINE-2              PIC X(60).
  6052         16  AT-INFO-TRAILER-TYPE        PIC X.
  6053             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6054             88  AT-CALL-NOTE            VALUE 'C'.
  6055             88  AT-MAINT-NOTE           VALUE 'M'.
  6056             88  AT-CERT-CHANGE          VALUE 'X'.
  6057             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6058             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6059         16  AT-CALL-TYPE                PIC X.
  6060             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6061             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6062         16  AT-NOTE-CONTINUATION        PIC X.
  6063             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6064         16  AT-EOB-CODES-EXIST          PIC X.
  6065             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL152.cbl
  6066         16  FILLER                      PIC X(35).
  6067         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6068         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6069
  6070     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6071         16  AT-PROMPT-LINE-1            PIC X(60).
  6072         16  AT-PROMPT-LINE-2            PIC X(60).
  6073         16  AT-PROMPT-START-DT          PIC XX.
  6074         16  AT-PROMPT-END-DT            PIC XX.
  6075         16  FILLER                      PIC X(35).
  6076         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6077         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6078
  6079     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6080         16  AT-DENIAL-INFO-1            PIC X(60).
  6081         16  AT-DENIAL-INFO-2            PIC X(60).
  6082         16  AT-DENIAL-DT                PIC XX.
  6083         16  AT-RETRACTION-DT            PIC XX.
  6084         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6085*         16  FILLER                      PIC X(31).
  6086         16  AT-DENIAL-PROOF-DT          PIC XX.
  6087         16  FILLER                      PIC X(29).
  6088         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6089         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6090
  6091     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6092         16  AT-OLD-INCURRED-DT          PIC XX.
  6093         16  AT-OLD-REPORTED-DT          PIC XX.
  6094         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6095         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6096         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6097         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6098         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6099         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6100         16  FILLER                      PIC X(26).
  6101         16  AT-OLD-DIAG-CODE            PIC X(6).
  6102         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6103         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6104         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6105         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6106         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6107         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6108         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6109         16  FILLER                      PIC X(25).
  6110         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6111
  6112     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6113         16  AT-FORM-SEND-ON-DT          PIC XX.
  6114         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6115         16  AT-FORM-RE-SEND-DT          PIC XX.
  6116         16  AT-FORM-ANSWERED-DT         PIC XX.
  6117         16  AT-FORM-PRINTED-DT          PIC XX.
  6118         16  AT-FORM-REPRINT-DT          PIC XX.
  6119         16  AT-FORM-TYPE                PIC X.
  6120             88  INITIAL-FORM                  VALUE '1'.
  6121             88  PROGRESS-FORM                 VALUE '2'.
  6122         16  AT-INSTRUCT-LN-1            PIC X(28).
  6123         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL152.cbl
  6124         16  AT-INSTRUCT-LN-3            PIC X(28).
  6125         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6126         16  AT-FORM-ADDRESS             PIC X.
  6127             88  FORM-TO-INSURED              VALUE 'I'.
  6128             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6129             88  FORM-TO-OTHER-1              VALUE 'O'.
  6130             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6131         16  AT-RELATED-1.
  6132             20 AT-REL-CARR-1            PIC X.
  6133             20 AT-REL-CLAIM-1           PIC X(7).
  6134             20 AT-REL-CERT-1            PIC X(11).
  6135         16  AT-RELATED-2.
  6136             20 AT-REL-CARR-2            PIC X.
  6137             20 AT-REL-CLAIM-2           PIC X(7).
  6138             20 AT-REL-CERT-2            PIC X(11).
  6139         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6140         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6141         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6142         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6143         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6144         16  AT-STOP-FORM-DT             PIC X(2).
  6145
  6146         16  FILLER                      PIC X(09).
  6147         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6148         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6149******************************************************************
  6150
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL152.cbl
  6152*                                COPY ELCBENE.
  6153******************************************************************
  6154*                                                                *
  6155*                            ELCBENE.                            *
  6156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6157*                            VMOD=2.006                          *
  6158*                                                                *
  6159*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6160*                                                                *
  6161*   FILE TYPE = VSAM,KSDS                                        *
  6162*   RECORD SIZE = 500   RECFORM = FIX                            *
  6163*                                                                *
  6164*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6165*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6166*                                                                *
  6167*   LOG = YES                                                    *
  6168*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6169*                                                                *
  6170*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6171******************************************************************
  6172
  6173 01  BENEFICIARY-MASTER.
  6174     12  BE-RECORD-ID                PIC XX.
  6175         88  VALID-BE-ID                VALUE 'BE'.
  6176
  6177     12  BE-CONTROL-PRIMARY.
  6178         16  BE-COMPANY-CD           PIC X.
  6179         16  BE-RECORD-TYPE          PIC X.
  6180             88  BENEFICIARY-RECORD  VALUE 'B'.
  6181             88  ADJUSTOR-RECORD     VALUE 'A'.
  6182         16  BE-BENEFICIARY          PIC X(10).
  6183     12  BE-CONTROL-BY-NAME.
  6184         16  BE-COMPANY-CD-A1        PIC X.
  6185         16  BE-RECORD-TYPE-A1       PIC X.
  6186         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6187         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6188
  6189     12  BE-LAST-MAINT-DT            PIC XX.
  6190     12  BE-LAST-MAINT-BY            PIC X(4).
  6191     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6192
  6193     12  BE-ADDRESS-DATA.
  6194         16  BE-MAIL-TO-NAME         PIC X(30).
  6195         16  BE-ADDRESS-LINE-1       PIC X(30).
  6196         16  BE-ADDRESS-LINE-2       PIC X(30).
  6197         16  BE-ADDRESS-LINE-3       PIC X(30).
  6198         16  BE-CITY-STATE.
  6199             20  BE-CITY             PIC X(28).
  6200             20  BE-STATE            PIC XX.
  6201         16  BE-ZIP-CODE.
  6202             20  BE-ZIP-PRIME.
  6203                 24  BE-ZIP-1ST      PIC X.
  6204                     88  BE-CANADIAN-POST-CODE
  6205                                         VALUE 'A' THRU 'Z'.
  6206                 24  FILLER          PIC X(4).
  6207             20  BE-ZIP-PLUS4        PIC X(4).
  6208         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6209             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL152.cbl
  6210             20  BE-CAN-POSTAL-2     PIC XXX.
  6211             20  FILLER              PIC XXX.
  6212         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6213         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6214
  6215******************************************************************
  6216*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6217*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6218******************************************************************
  6219     12  BE-CARRIER                  PIC X.
  6220
  6221     12  BE-ADDRESS-DATA2.
  6222         16  BE-MAIL-TO-NAME2        PIC X(30).
  6223         16  BE-ADDRESS-LINE-12      PIC X(30).
  6224         16  BE-ADDRESS-LINE-22      PIC X(30).
  6225         16  BE-ADDRESS-LINE-32      PIC X(30).
  6226         16  BE-CITY-STATE2.
  6227             20  BE-CITY2            PIC X(28).
  6228             20  BE-STATE2           PIC XX.
  6229         16  BE-ZIP-CODE2.
  6230             20  BE-ZIP-PRIME2.
  6231                 24  BE-ZIP-1ST2     PIC X.
  6232                     88  BE-CANADIAN-POST-CODE2
  6233                                         VALUE 'A' THRU 'Z'.
  6234                 24  FILLER          PIC X(4).
  6235             20  BE-ZIP-PLUS42       PIC X(4).
  6236         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6237             20  BE-CAN-POSTAL-12    PIC XXX.
  6238             20  BE-CAN-POSTAL-22    PIC XXX.
  6239             20  FILLER              PIC XXX.
  6240         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6241         16  BE-BILLING-STMT-DATA.
  6242             20  BE-BSR              PIC X.
  6243                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6244                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6245             20  BE-BSR-FROM         PIC X(30).
  6246             20  BE-BSR-DEPT         PIC X(30).
  6247             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6248             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6249             20  BE-OUTPUT-TYPE      PIC X.
  6250                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6251                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6252
  6253     12  FILLER                      PIC X(28).
  6254******************************************************************
  6255
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL152.cbl
  6257*                                COPY ERCCOMP.
  6258******************************************************************
  6259*                                                                *
  6260*                                                                *
  6261*                            ERCCOMP                             *
  6262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6263*                            VMOD=2.019                          *
  6264*                                                                *
  6265*   ONLINE CREDIT SYSTEM                                         *
  6266*                                                                *
  6267*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6268*                                                                *
  6269*   FILE TYPE = VSAM,KSDS                                        *
  6270*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6271*                                                                *
  6272*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6273*       ALTERNATE PATH = NONE                                    *
  6274*                                                                *
  6275*   LOG = NO                                                     *
  6276*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6277*                                                                *
  6278******************************************************************
  6279*                   C H A N G E   L O G
  6280*
  6281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6282*-----------------------------------------------------------------
  6283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6284* EFFECTIVE    NUMBER
  6285*-----------------------------------------------------------------
  6286* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6287* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6288* 092205    2005050300006  PEMA  ADD LEASE FEE
  6289* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6290* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6291* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6292* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6293* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6294******************************************************************
  6295
  6296 01  COMPENSATION-MASTER.
  6297     12  CO-RECORD-ID                          PIC XX.
  6298         88  VALID-CO-ID                          VALUE 'CO'.
  6299
  6300     12  CO-CONTROL-PRIMARY.
  6301         16  CO-COMPANY-CD                     PIC X.
  6302         16  CO-CONTROL.
  6303             20  CO-CTL-1.
  6304                 24  CO-CARR-GROUP.
  6305                     28  CO-CARRIER            PIC X.
  6306                     28  CO-GROUPING.
  6307                         32  CO-GROUP-PREFIX   PIC XXX.
  6308                         32  CO-GROUP-PRIME    PIC XXX.
  6309                 24  CO-RESP-NO.
  6310                     28  CO-RESP-PREFIX        PIC X(4).
  6311                     28  CO-RESP-PRIME         PIC X(6).
  6312             20  CO-CTL-2.
  6313                 24  CO-ACCOUNT.
  6314                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL152.cbl
  6315                     28  CO-ACCT-PRIME         PIC X(6).
  6316         16  CO-TYPE                           PIC X.
  6317             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6318             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6319             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6320
  6321     12  CO-MAINT-INFORMATION.
  6322         16  CO-LAST-MAINT-DT                  PIC XX.
  6323         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6324         16  CO-LAST-MAINT-USER                PIC X(4).
  6325     12  FILLER                                PIC XX.
  6326     12  CO-STMT-TYPE                          PIC XXX.
  6327     12  CO-COMP-TYPE                          PIC X.
  6328         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6329     12  CO-STMT-OWNER                         PIC X(4).
  6330     12  CO-BALANCE-CONTROL                    PIC X.
  6331         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6332         88  CO-NO-BALANCE                        VALUE 'N'.
  6333
  6334     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6335         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6336         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6337         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6338
  6339     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6340         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6341         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6342
  6343     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6344     12  CO-GA-DIRECT-DEP                      PIC X.
  6345     12  CO-FUTURE-SPACE                       PIC X.
  6346         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6347
  6348     12  CO-ACCT-NAME                          PIC X(30).
  6349     12  CO-MAIL-NAME                          PIC X(30).
  6350     12  CO-ADDR-1                             PIC X(30).
  6351     12  CO-ADDR-2                             PIC X(30).
  6352     12  CO-ADDR-3.
  6353         16  CO-ADDR-CITY                      PIC X(27).
  6354         16  CO-ADDR-STATE                     PIC XX.
  6355     12  CO-CSO-1099                           PIC X.
  6356     12  CO-ZIP.
  6357         16  CO-ZIP-PRIME.
  6358             20  CO-ZIP-PRI-1ST                PIC X.
  6359                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6360             20  FILLER                        PIC X(4).
  6361         16  CO-ZIP-PLUS4                      PIC X(4).
  6362     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6363         16  CO-CAN-POSTAL-1                   PIC XXX.
  6364         16  CO-CAN-POSTAL-2                   PIC XXX.
  6365         16  FILLER                            PIC XXX.
  6366     12  CO-SOC-SEC                            PIC X(13).
  6367     12  CO-TELEPHONE.
  6368         16  CO-AREA-CODE                      PIC XXX.
  6369         16  CO-PREFIX                         PIC XXX.
  6370         16  CO-PHONE                          PIC X(4).
  6371
  6372     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL152.cbl
  6373
  6374     12  CO-AR-BAL-LEVEL                       PIC X.
  6375         88  CO-AR-REF-LVL                        VALUE '1'.
  6376         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6377         88  CO-AR-BILL-LVL                       VALUE '2'.
  6378         88  CO-AR-AGT-LVL                        VALUE '3'.
  6379         88  CO-AR-FR-LVL                         VALUE '4'.
  6380
  6381     12  CO-AR-NORMAL-PRINT                    PIC X.
  6382         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6383         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6384
  6385     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6386
  6387     12  CO-AR-REPORTING                       PIC X.
  6388         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6389         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6390
  6391     12  CO-AR-PULL-CHECK                      PIC X.
  6392         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6393         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6394
  6395     12  CO-AR-BALANCE-PRINT                   PIC X.
  6396         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6397
  6398     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6399         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6400         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6401         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6402
  6403     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6404
  6405     12  CO-USER-CODE                          PIC X.
  6406     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6407
  6408******************************************************************
  6409*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6410*    THE LAST MONTH END RUN.
  6411******************************************************************
  6412
  6413     12  CO-LAST-ACTIVITY-DATE.
  6414         16  CO-ACT-YEAR                       PIC 99.
  6415         16  CO-ACT-MONTH                      PIC 99.
  6416         16  CO-ACT-DAY                        PIC 99.
  6417
  6418     12  CO-LAST-STMT-DT.
  6419         16  CO-LAST-STMT-YEAR                 PIC 99.
  6420         16  CO-LAST-STMT-MONTH                PIC 99.
  6421         16  CO-LAST-STMT-DAY                  PIC 99.
  6422
  6423     12  CO-MO-END-TOTALS.
  6424         16  CO-MONTHLY-TOTALS.
  6425             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6426             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6427             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6428             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6429             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  6430
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL152.cbl
  6431         16  CO-AGING-TOTALS.
  6432             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6433             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6434             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6435             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6436
  6437         16  CO-YTD-TOTALS.
  6438             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6439             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6440
  6441         16  CO-OVER-UNDER-TOTALS.
  6442             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6443             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6444
  6445     12  CO-MISCELLANEOUS-TOTALS.
  6446         16  CO-FICA-TOTALS.
  6447             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6448             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6449
  6450         16  CO-CLAIM-TOTALS.
  6451             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6452             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6453
  6454******************************************************************
  6455*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6456*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6457******************************************************************
  6458
  6459     12  CO-CURRENT-TOTALS.
  6460         16  CO-CURRENT-LAST-STMT-DT.
  6461             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6462             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6463             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6464
  6465         16  CO-CURRENT-MONTHLY-TOTALS.
  6466             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6467             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6468             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6469             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6470             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6471
  6472         16  CO-CURRENT-AGING-TOTALS.
  6473             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6474             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6475             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6476             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6477
  6478         16  CO-CURRENT-YTD-TOTALS.
  6479             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6480             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6481
  6482     12  CO-PAID-COMM-TOTALS.
  6483         16  CO-YTD-PAID-COMMS.
  6484             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6485             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6486
  6487     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  6488         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL152.cbl
  6489         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6490
  6491     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6492         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6493         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6494         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6495         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6496         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6497         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6498         88  CO-FINAL-LETTER                  VALUE 'F'.
  6499         88  CO-RECONCILING                   VALUE 'R'.
  6500         88  CO-PHONE-CALL                    VALUE 'P'.
  6501         88  CO-LEGAL                         VALUE 'L'.
  6502         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6503         88  CO-WRITE-OFF                     VALUE 'W'.
  6504         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6505
  6506     12  CO-CSR-CODE                       PIC X(4).
  6507
  6508     12  CO-GA-STATUS-INFO.
  6509         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6510         16  CO-GA-TERMINATION-DT          PIC XX.
  6511         16  CO-GA-STATUS-CODE             PIC X.
  6512             88  CO-GA-ACTIVE                 VALUE 'A'.
  6513             88  CO-GA-INACTIVE               VALUE 'I'.
  6514             88  CO-GA-PENDING                VALUE 'P'.
  6515         16  CO-GA-COMMENTS.
  6516             20  CO-GA-COMMENT-1           PIC X(40).
  6517             20  CO-GA-COMMENT-2           PIC X(40).
  6518             20  CO-GA-COMMENT-3           PIC X(40).
  6519             20  CO-GA-COMMENT-4           PIC X(40).
  6520
  6521     12  CO-RPTCD2                         PIC X(10).
  6522
  6523     12  CO-TYPE-AGENT                     PIC X(01).
  6524         88  CO-CORPORATION                   VALUE 'C'.
  6525         88  CO-PARTNERSHIP                   VALUE 'P'.
  6526         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6527         88  CO-TRUST                         VALUE 'T'.
  6528         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6529
  6530     12  CO-FAXNO.
  6531         16  CO-FAX-AREA-CODE                  PIC XXX.
  6532         16  CO-FAX-PREFIX                     PIC XXX.
  6533         16  CO-FAX-PHONE                      PIC X(4).
  6534
  6535     12  CO-BANK-INFORMATION.
  6536         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6537         16  CO-BANK-TRANSIT-NON REDEFINES
  6538             CO-BANK-TRANSIT-NO                PIC 9(8).
  6539
  6540         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6541     12  CO-MISC-DEDUCT-INFO REDEFINES
  6542                  CO-BANK-INFORMATION.
  6543         16  CO-MD-GL-ACCT                     PIC X(10).
  6544         16  CO-MD-DIV                         PIC XX.
  6545         16  CO-MD-CENTER                      PIC X(4).
  6546         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL152.cbl
  6547         16  CO-CREATE-AP-CHECK                PIC X.
  6548         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6549         16  FILLER                            PIC XXX.
  6550     12  CO-ACH-STATUS                         PIC X.
  6551         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6552         88  CO-ACH-PENDING                        VALUE 'P'.
  6553
  6554     12  CO-BILL-SW                            PIC X.
  6555     12  CO-CONTROL-NAME                       PIC X(30).
  6556     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6557     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6558     12  CO-CLP-STATE                          PIC XX.
  6559     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6560     12  CO-SPP-REFUND-EDIT                    PIC X.
  6561
  6562******************************************************************
  6563
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL152.cbl
  6565*                                COPY MPCPROD.
  6566*    EJECT
  6567*                                COPY MPCPLCY.
  6568*    EJECT
  6569*                                COPY MPCPLAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL152.cbl
  6571*                                COPY ELCNAPS.
  6572******************************************************************
  6573*                                                                *
  6574*                            ELCNAPS                             *
  6575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6576*                            VMOD=2.003                          *
  6577*                                                                *
  6578*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  6579*                                                                *
  6580*        FILE TYPE= VSAM,KSDS                                    *
  6581*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6582*                                                                *
  6583*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  6584*                                                                *
  6585*        LOG = YES                                               *
  6586*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6587*                                                                *
  6588******************************************************************
  6589*                   C H A N G E   L O G
  6590*
  6591* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6592*-----------------------------------------------------------------
  6593*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6594* EFFECTIVE    NUMBER
  6595*-----------------------------------------------------------------
  6596* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  6597******************************************************************
  6598
  6599 01  NAPERSOFT-FILE.
  6600     12  NA-RECORD-ID                PIC  XX.
  6601         88  VALID-NA-ID                  VALUE 'NA'.
  6602
  6603     12  NA-CONTROL-PRIMARY.
  6604         16  NA-COMPANY-CD           PIC X.
  6605         16  NA-CARRIER              PIC X.
  6606         16  NA-CLAIM-NO             PIC X(7).
  6607         16  NA-CERT-NO.
  6608             20  NA-CERT-PRIME       PIC X(10).
  6609             20  NA-CERT-SFX         PIC X.
  6610         16  NA-ARCHIVE-NO           PIC 9(8).
  6611
  6612     12  NA-LETTER-INFORMATION.
  6613         16  NA-LETTER-ID            PIC X(4).
  6614         16  NA-PROCESSOR-ID         PIC X(4).
  6615         16  NA-CREATION-DT          PIC X(2).
  6616         16  NA-INITIAL-PRINT-DT     PIC X(2).
  6617         16  NA-FOLLOW-UP-DT         PIC X(2).
  6618         16  NA-RESEND-DT            PIC X(2).
  6619         16  NA-RESEND-LETTER-ID     PIC X(4).
  6620         16  NA-NO-OF-COPIES         PIC 9(2).
  6621         16  NA-ADDRESS-TYPE         PIC X(2).
  6622         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  6623         16  NA-RESEND-PRINT-DT      PIC X(2).
  6624         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  6625         16  NA-NEXT-DUE-DT          PIC X(2).
  6626         16  NA-AUTOPYDT             PIC X(2).
  6627         16  NA-ENCLOSURE-CD         PIC X(3).
  6628         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL152.cbl
  6629         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  6630         16  NA-RESEND-PROMPT-IND    PIC X(1).
  6631         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  6632         16  FILLER                  PIC X(67).
  6633******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL152.cbl
  6635*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  6636*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  6637
  6638*01  SYSTEM-VARIABLES            PIC X(3851).
  6639*01  SYS-VAR-ENTRY REDEFINES SYSTEM-VARIABLES.
  6640*    12  SYS-VAR-CODE            PIC X(4).
  6641*    12  SYS-VAR-LEN             PIC 99.
  6642*    12  SYS-VAR-DATA            PIC X(100).
  6643
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL152.cbl
  6645 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CLAIM-MASTER
  6646                          CONTROL-FILE LETTER-ARCHIVE
  6647                          LETTER-ARCHIVE-TEMP
  6648                          CERTIFICATE-MASTER ACCOUNT-MASTER
  6649                          TEXT-FILES ACTIVITY-TRAILERS
  6650                          BENEFICIARY-MASTER
  6651                          COMPENSATION-MASTER NAPERSOFT-FILE.
  6652 0000-DFHEXIT SECTION.
  6653     MOVE '9#                    $   ' TO DFHEIV0.
  6654     MOVE 'EL152' TO DFHEIV1.
  6655     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6656
  6657     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6658     MOVE '5'                   TO DC-OPTION-CODE.
  6659     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  6660     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  6661     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  6662
  6663     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  6664     MOVE 1                     TO EMI-NUMBER-OF-LINES.
  6665     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  6666                                TO EMI-SAVE-AREA.
  6667
  6668     MOVE EIBTRMID              TO TS-TERM-TEXT
  6669                                   TS-TERM-SCREEN
  6670                                   QID-TERM.
  6671
  6672     MOVE SAVE-BIN-DATE       TO CURRENT-SAVE.
  6673
  6674*    IF PI-COMPANY-ID = 'DMD'
  6675*       MOVE CURRENT-SAVE           TO DC-BIN-DATE-1
  6676*       MOVE '6'                    TO DC-OPTION-CODE
  6677*       MOVE +3                     TO DC-ELAPSED-MONTHS
  6678*       MOVE +0                     TO DC-ELAPSED-DAYS
  6679*       PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6680*       MOVE DC-BIN-DATE-2          TO CURRENT-PLUS3-SAVE.
  6681
  6682
  6683* EXEC CICS HANDLE CONDITION
  6684*        PGMIDERR (9600-PGMID-ERROR)
  6685*        MAPFAIL  (0325-MAPFAIL)
  6686*        ERROR    (9990-ABEND)
  6687*    END-EXEC.
  6688*    MOVE '"$L?.                 ! " #00006678' TO DFHEIV0
  6689     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  6690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6691     MOVE X'2220233030303036363738' TO DFHEIV0(25:11)
  6692     CALL 'kxdfhei1' USING DFHEIV0
  6693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6694
  6695
  6696     IF PI-PROCESSOR-ID NOT = 'LGXX'
  6697
  6698* EXEC CICS READQ TS
  6699*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6700*            INTO    (SECURITY-CONTROL)
  6701*            LENGTH  (SC-COMM-LENGTH)
  6702*            ITEM    (SC-ITEM)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL152.cbl
  6703*        END-EXEC
  6704*    MOVE '*$II   L              ''   #00006685' TO DFHEIV0
  6705     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6707     MOVE X'2020233030303036363835' TO DFHEIV0(25:11)
  6708     CALL 'kxdfhei1' USING DFHEIV0,
  6709           PI-SECURITY-TEMP-STORE-ID,
  6710           SECURITY-CONTROL,
  6711           SC-COMM-LENGTH,
  6712           SC-ITEM,
  6713           DFHEIV99,
  6714           DFHEIV99
  6715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6716         MOVE SC-CLAIMS-DISPLAY (7)  TO  PI-DISPLAY-CAP
  6717         MOVE SC-CLAIMS-UPDATE  (7)  TO  PI-MODIFY-CAP.
  6718
  6719     set P to address of KIXSYS
  6720     CALL "getenv" using by value P returning var-ptr
  6721     if var-ptr = null then
  6722        display ' kixsys not set '
  6723     else
  6724        set address of var to var-ptr
  6725        move 0 to env-var-len
  6726        inspect var tallying env-var-len
  6727          for characters before X'00'
  6728        unstring var (1:env-var-len) delimited by '/'
  6729           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6730              WS-KIX-SYS
  6731        end-unstring
  6732     end-if
  6733     IF EIBCALEN = 0
  6734         GO TO 8800-UNAUTHORIZED-ACCESS.
  6735
  6736     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6737         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6738             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6739             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6740             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6741             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6742             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6743             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6744             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6745             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6746             PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
  6747             PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
  6748             PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
  6749             MOVE SPACES              TO PI-WA
  6750                                         PI-FORCE-7840
  6751             MOVE ZEROS               TO PI-TOTAL-LINES
  6752                                         PI-CURRENT-LINE
  6753                                         PI-TEMP-STOR-ITEMS
  6754                                         PI-UPDATE-SW
  6755                                         PI-ADDR-SEQ
  6756             MOVE '2'                 TO PI-ACTION
  6757             MOVE LOW-VALUES          TO EL152AO
  6758                                         PI-ADDR-TYPE
  6759             GO TO 8100-SEND-INITIAL-MAP
  6760         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL152.cbl
  6761             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6762             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6763             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6764             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6765             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6766             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6767             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6768             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6769             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6770             PERFORM 7500-READ-TS           THRU 7599-EXIT
  6771             PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT
  6772             IF PGM-NAME = PGM-EL141
  6773                PERFORM 500-RECOVER-PI-TEMP-STORAGE THRU 599-EXIT
  6774                SET TB-INDX TO PI-CURRENT-LINE
  6775                PERFORM 400-SET-CODES       THRU 499-EXIT
  6776                PERFORM 7000-READ-ADDR      THRU 7099-EXIT
  6777                PERFORM 7170-FORMAT-SCREEN  THRU 7170-EXIT
  6778                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6779                        SC-INDX > NUM-LINES-PER-SCREEN
  6780                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6781                MOVE AL-UANON           TO PRINTERA
  6782                GO TO 8100-SEND-INITIAL-MAP
  6783             ELSE
  6784                SET TB-INDX TO PI-CURRENT-LINE
  6785                PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6786                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6787                        SC-INDX > NUM-LINES-PER-SCREEN
  6788                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6789                MOVE AL-UANON           TO PRINTERA
  6790                GO TO 8100-SEND-INITIAL-MAP.
  6791
  6792*0100-PA.
  6793*    MOVE ER-0008                TO EMI-ERROR.
  6794*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6795*    MOVE -1                     TO MAINTL.
  6796*    GO TO 8200-SEND-DATAONLY.
  6797
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL152.cbl
  6799 0200-RECEIVE.
  6800     MOVE TRANS-ID         TO EIBTRNID.
  6801     MOVE EMI-SAVE-AREA    TO ERROR-MESSAGE-INTERFACE-BLOCK.
  6802     MOVE LOW-VALUES       TO EL152AI.
  6803     MOVE '104A'           TO TS-ID-TEXT.
  6804     MOVE EIBTRMID         TO TS-TERM-TEXT
  6805                              TS-TERM-SCREEN
  6806                              QID-TERM.
  6807
  6808
  6809* EXEC CICS HANDLE AID
  6810*        CLEAR    (9400-CLEAR)
  6811*        PA1      (0100-PA)
  6812*        PA2      (0100-PA)
  6813*        PA3      (0100-PA)
  6814*    END-EXEC.
  6815*    MOVE '"&=!"#               V! # #00006783' TO DFHEIV0
  6816     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  6817     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  6818     MOVE X'2320233030303036373833' TO DFHEIV0(25:11)
  6819     CALL 'kxdfhei1' USING DFHEIV0
  6820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6821
  6822
  6823
  6824* EXEC CICS HANDLE CONDITION
  6825*        MAPFAIL  (0325-MAPFAIL)
  6826*    END-EXEC.
  6827*    MOVE '"$?                   ! $ #00006790' TO DFHEIV0
  6828     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6830     MOVE X'2420233030303036373930' TO DFHEIV0(25:11)
  6831     CALL 'kxdfhei1' USING DFHEIV0
  6832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6833
  6834
  6835
  6836* EXEC CICS SYNCPOINT
  6837*    END-EXEC.
  6838*    MOVE '6"                    !   #00006794' TO DFHEIV0
  6839     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6841     MOVE X'2020233030303036373934' TO DFHEIV0(25:11)
  6842     CALL 'kxdfhei1' USING DFHEIV0
  6843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6844
  6845
  6846     IF LOWER-CASE-LETTERS-USED
  6847
  6848* EXEC CICS RECEIVE
  6849*            MAP      (MAP-NAME)
  6850*            MAPSET   (MAPSET-NAME)
  6851*            INTO     (EL152AI)
  6852*            ASIS
  6853*       END-EXEC
  6854     MOVE LENGTH OF
  6855      EL152AI
  6856       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL152.cbl
  6857*    MOVE '8"TAI  L              ''   #00006798' TO DFHEIV0
  6858     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  6859     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6860     MOVE X'2020233030303036373938' TO DFHEIV0(25:11)
  6861     CALL 'kxdfhei1' USING DFHEIV0,
  6862           MAP-NAME,
  6863           EL152AI,
  6864           DFHEIV11,
  6865           MAPSET-NAME,
  6866           DFHEIV99,
  6867           DFHEIV99
  6868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6869      ELSE
  6870
  6871* EXEC CICS RECEIVE
  6872*            MAP      (MAP-NAME)
  6873*            MAPSET   (MAPSET-NAME)
  6874*            INTO     (EL152AI)
  6875*       END-EXEC.
  6876     MOVE LENGTH OF
  6877      EL152AI
  6878       TO DFHEIV11
  6879*    MOVE '8"T I  L              ''   #00006805' TO DFHEIV0
  6880     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6881     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6882     MOVE X'2020233030303036383035' TO DFHEIV0(25:11)
  6883     CALL 'kxdfhei1' USING DFHEIV0,
  6884           MAP-NAME,
  6885           EL152AI,
  6886           DFHEIV11,
  6887           MAPSET-NAME,
  6888           DFHEIV99,
  6889           DFHEIV99
  6890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6891
  6892
  6893     IF NOT DISPLAY-CAP AND PI-PROCESSOR-ID NOT = 'LGXX'
  6894         MOVE 'READ'             TO  SM-READ
  6895         PERFORM 9995-SECURITY-VIOLATION
  6896         MOVE ER-0070            TO  EMI-ERROR
  6897         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6898         GO TO 8100-SEND-INITIAL-MAP.
  6899
  6900     INSPECT MAINTI CONVERTING LOWER-CASE TO UPPER-CASE.
  6901     MOVE 'N'                    TO CLEANI
  6902
  6903     IF ENTERPFL = 0
  6904         GO TO 0300-CHECK-PFKEYS.
  6905     IF EIBAID NOT = DFHENTER
  6906         MOVE ER-0004            TO EMI-ERROR
  6907         GO TO 0320-INPUT-ERROR.
  6908     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  6909         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6910     ELSE
  6911         MOVE ER-0029            TO EMI-ERROR
  6912         GO TO 0320-INPUT-ERROR.
  6913
  6914 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL152.cbl
  6915     IF EIBAID = DFHPF23
  6916         GO TO 8810-PF23.
  6917     IF EIBAID = DFHPF24
  6918         GO TO 9200-RETURN-MAIN-MENU.
  6919*    IF EIBAID = DFHPF12
  6920*        GO TO 9500-PF12.
  6921     IF EIBAID = DFHPF1
  6922         MOVE 7                  TO ROLL-COUNTER
  6923         GO TO 7900-ROLL-PAGE.
  6924     IF EIBAID = DFHPF2
  6925         MOVE -7                 TO ROLL-COUNTER
  6926         GO TO 7900-ROLL-PAGE.
  6927     IF EIBAID = DFHPF3
  6928         GO TO 6100-ADDR-MAINT.
  6929     IF EIBAID = DFHPF4
  6930         IF MODIFY-CAP
  6931             GO TO 6200-EDIT-MODE
  6932         ELSE
  6933             MOVE 'UPDATE'       TO  SM-READ
  6934             PERFORM 9995-SECURITY-VIOLATION
  6935             MOVE ER-0070        TO  EMI-ERROR
  6936             GO TO 0320-INPUT-ERROR.
  6937
  6938     IF EIBAID = DFHPF5
  6939         GO TO 0330-FUNCTION-CHECK.
  6940
  6941     IF EIBAID = DFHPF6
  6942         GO TO 0330-FUNCTION-CHECK.
  6943
  6944     IF EIBAID = DFHPF7
  6945        COMPUTE ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  6946        GO TO 7900-ROLL-PAGE.
  6947
  6948     IF EIBAID = DFHPF8
  6949        MOVE PI-TOTAL-LINES TO ROLL-COUNTER
  6950        GO TO 7900-ROLL-PAGE.
  6951
  6952*    IF EIBAID = DFHPF9 AND
  6953*       PI-COMPANY-ID = 'DMD'
  6954*        MOVE '1'           TO PI-FORCE-7840
  6955*        GO TO 0330-FUNCTION-CHECK.
  6956
  6957     IF EIBAID = DFHENTER
  6958         GO TO 0330-FUNCTION-CHECK.
  6959
  6960     PERFORM 7500-READ-TS        THRU 7599-EXIT
  6961
  6962     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  6963     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  6964             VARYING SC-INDX FROM 1 BY 1
  6965             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  6966
  6967     MOVE ER-0029                TO EMI-ERROR.
  6968 0320-INPUT-ERROR.
  6969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6970     MOVE AL-UNBON               TO ENTERPFA.
  6971     IF ENTERPFL = 0
  6972         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL152.cbl
  6973     ELSE
  6974         MOVE -1                 TO ENTERPFL.
  6975
  6976     GO TO 8200-SEND-DATAONLY.
  6977
  6978 0100-PA.
  6979     MOVE ER-0008                TO EMI-ERROR.
  6980     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6981     MOVE -1                     TO MAINTL.
  6982     GO TO 8200-SEND-DATAONLY.
  6983
  6984 0325-MAPFAIL.
  6985***********************************************************
  6986*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  6987*      LETTERS ON A 3275 PRINTER.                         *
  6988***********************************************************
  6989
  6990     PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT.
  6991
  6992     SET TB-INDX         TO PI-CURRENT-LINE.
  6993     PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6994                  VARYING SC-INDX FROM 1 BY 1 UNTIL
  6995                  SC-INDX > NUM-LINES-PER-SCREEN.
  6996
  6997     GO TO 8100-SEND-INITIAL-MAP.
  6998
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL152.cbl
  7000 0330-FUNCTION-CHECK.
  7001     IF NOT MODIFY-CAP
  7002         IF MAINTI = 'S'
  7003             NEXT SENTENCE
  7004         ELSE
  7005             MOVE 'UPDATE'           TO  SM-READ
  7006             PERFORM 9995-SECURITY-VIOLATION
  7007             MOVE ER-0070            TO  EMI-ERROR
  7008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7009             GO TO 8100-SEND-INITIAL-MAP.
  7010
  7011     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  7012
  7013     IF EIBAID = DFHPF5
  7014      IF PI-PROMPT-LETTER = 'Y'
  7015         MOVE ER-0894            TO EMI-ERROR
  7016         MOVE -1             TO MAINTL
  7017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7018         MOVE AL-UABON       TO MAINTA
  7019         GO TO 8200-SEND-DATAONLY
  7020      ELSE
  7021         IF MAINTI NOT = 'C'
  7022             MOVE ER-0716        TO EMI-ERROR
  7023             MOVE -1             TO MAINTL
  7024             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7025             MOVE AL-UABON       TO MAINTA
  7026             GO TO 8200-SEND-DATAONLY
  7027         ELSE
  7028             IF MODIFY-CAP
  7029                 GO TO 6400-LETTER-RELEASE
  7030             ELSE
  7031                 IF PRINT-PERFORMED
  7032                     GO TO 6400-LETTER-RELEASE
  7033                 ELSE
  7034                     MOVE AL-UNBON TO ENTERPFA
  7035                     MOVE -1       TO ENTERPFL
  7036                     MOVE ER-2398 TO EMI-ERROR
  7037                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7038                     GO TO 8200-SEND-DATAONLY.
  7039
  7040     IF EIBAID = DFHPF6
  7041      IF PI-PROMPT-LETTER = 'Y'
  7042         MOVE ER-0894            TO EMI-ERROR
  7043         MOVE -1             TO MAINTL
  7044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7045         MOVE AL-UABON       TO MAINTA
  7046         GO TO 8200-SEND-DATAONLY
  7047      ELSE
  7048         GO TO 7800-PRINT-LETTER-NOW.
  7049
  7050     IF MAINTI = 'S'
  7051         GO TO 1000-SHOW.
  7052
  7053     IF MAINTI = 'C'
  7054         GO TO 2000-CREATE.
  7055
  7056     IF MAINTI = 'R'
  7057        IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL152.cbl
  7058           MOVE ER-0070          TO EMI-ERROR
  7059           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7060           MOVE LOW-VALUES       TO EL152AO
  7061           GO TO 8100-SEND-INITIAL-MAP
  7062          ELSE
  7063           GO TO 3000-RECORD.
  7064
  7065     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7066     PERFORM 7950-SET-INDX       THRU 7950-EXIT
  7067     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN
  7068                                 THRU 7960-EXIT
  7069        VARYING SC-INDX FROM 1 BY 1 UNTIL
  7070        SC-INDX > NUM-LINES-PER-SCREEN
  7071     MOVE ER-0023                TO EMI-ERROR.
  7072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7073     MOVE -1                     TO MAINTL.
  7074     MOVE AL-UABON               TO MAINTA.
  7075     GO TO 8200-SEND-DATAONLY.
  7076
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL152.cbl
  7078 0350-EDIT-ROUTINE.
  7079     PERFORM 400-SET-CODES THRU 499-EXIT.
  7080     MOVE PI-CLAIM-NO    TO CLAM-CLAIM
  7081                            ACTV-CLAIM.
  7082
  7083     IF ADDRL NOT = +0
  7084        INSPECT ADDRI CONVERTING LOWER-CASE TO UPPER-CASE
  7085        MOVE ADDRI           TO WS-ADDR-TYPE-CD
  7086        IF WS-ADDR-TYPE = 'I' OR 'B' OR 'A' OR 'P' OR
  7087                          'O' OR 'Q' OR 'E'
  7088           MOVE AL-UANON         TO ADDRA
  7089        ELSE
  7090           MOVE -1               TO ADDRL
  7091           MOVE AL-UABON         TO ADDRA
  7092           MOVE ER-0176          TO EMI-ERROR
  7093           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7094*     ELSE
  7095*       IF PI-COMPANY-ID = 'DMD'
  7096*        IF MAINTI = 'C' OR 'R'
  7097*          MOVE -1               TO ADDRL
  7098*          MOVE AL-UABON         TO ADDRA
  7099*          MOVE ER-0861          TO EMI-ERROR
  7100*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7101
  7102     IF ADDRL NOT = +0
  7103        IF WS-ADDR-SEQ NOT NUMERIC
  7104           MOVE -1               TO ADDRL
  7105           MOVE AL-UABON         TO ADDRA
  7106           MOVE ER-0176          TO EMI-ERROR
  7107           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7108
  7109*    IF ADDRL NOT = +0
  7110*       IF PI-COMPANY-ID = 'DMD'
  7111*          IF WS-ADDR-TYPE = 'B' AND
  7112*             WS-ADDR-SEQ NOT = '9'
  7113*                MOVE -1               TO ADDRL
  7114*                MOVE AL-UABON         TO ADDRA
  7115*                MOVE ER-7842          TO EMI-ERROR
  7116*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7117
  7118     IF FORML NOT = ZEROS
  7119        INSPECT FORMI CONVERTING LOWER-CASE TO UPPER-CASE.
  7120
  7121     IF MAINTI = 'C' AND FORML = ZEROS
  7122        MOVE -1                  TO FORML
  7123        MOVE ER-0177             TO EMI-ERROR
  7124        MOVE AL-UABON            TO FORMA
  7125        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7126
  7127     IF FOLLOWL NOT = ZEROS
  7128        MOVE FOLLOWI             TO DEEDIT-FIELD
  7129        PERFORM 8600-DEEDIT
  7130        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7131        MOVE '4'                 TO DC-OPTION-CODE
  7132        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7133        IF DATE-CONVERSION-ERROR
  7134           MOVE ER-0182          TO EMI-ERROR
  7135           MOVE -1               TO FOLLOWL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL152.cbl
  7136           MOVE AL-UABON         TO FOLLOWA
  7137           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7138        ELSE
  7139*          IF (PI-COMPANY-ID = 'DMD') AND
  7140*             (NOT FORCE-7840)        AND
  7141*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7142*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7143*              MOVE AL-SABON         TO PFKEY9A
  7144*              MOVE ER-7840          TO EMI-ERROR
  7145*              MOVE -1               TO FOLLOWL
  7146*              MOVE AL-UABON         TO FOLLOWA
  7147*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7148*          ELSE
  7149             MOVE SPACES                TO PFKEY9O
  7150             MOVE AL-SADON              TO PFKEY9A
  7151             MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWO
  7152             MOVE AL-UANON              TO FOLLOWA
  7153             MOVE DC-BIN-DATE-1         TO FOLLOW-UP-SAVE
  7154     ELSE
  7155        MOVE LOW-VALUES                 TO FOLLOW-UP-SAVE.
  7156
  7157     IF FOLLOW-UP-SAVE NOT = LOW-VALUES
  7158        IF FOLLOW-UP-SAVE NOT > CURRENT-SAVE
  7159           MOVE ER-0533          TO EMI-ERROR
  7160           MOVE AL-UABON         TO FOLLOWA
  7161           MOVE -1               TO FOLLOWL
  7162           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7163
  7164     IF RESENDL NOT = ZEROS
  7165        MOVE RESENDI             TO DEEDIT-FIELD
  7166        PERFORM 8600-DEEDIT
  7167        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7168        MOVE '4'                 TO DC-OPTION-CODE
  7169        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7170        IF DATE-CONVERSION-ERROR
  7171           MOVE ER-0185          TO EMI-ERROR
  7172           MOVE -1               TO RESENDL
  7173           MOVE AL-UABON         TO RESENDA
  7174           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7175         ELSE
  7176*          IF (PI-COMPANY-ID = 'DMD') AND
  7177*             (NOT FORCE-7840)        AND
  7178*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7179*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7180*              MOVE AL-SABON         TO PFKEY9A
  7181*              MOVE ER-7840          TO EMI-ERROR
  7182*              MOVE -1               TO RESENDL
  7183*              MOVE AL-UABON         TO RESENDA
  7184*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7185*          ELSE
  7186             MOVE SPACES                 TO PFKEY9O
  7187             MOVE AL-SADON               TO PFKEY9A
  7188             MOVE DC-GREG-DATE-1-EDIT    TO RESENDO
  7189             MOVE AL-UANON               TO RESENDA
  7190             MOVE DC-BIN-DATE-1          TO RESEND-SAVE
  7191     ELSE
  7192        MOVE LOW-VALUE                   TO RESEND-SAVE.
  7193
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL152.cbl
  7194     IF RESEND-SAVE NOT = LOW-VALUES
  7195        IF RESEND-SAVE NOT > CURRENT-SAVE
  7196           MOVE ER-0537          TO EMI-ERROR
  7197           MOVE AL-UABON         TO RESENDA
  7198           MOVE -1               TO RESENDL
  7199           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7200
  7201     IF PRINTL NOT = ZEROS
  7202        INSPECT PRINTI CONVERTING LOWER-CASE TO UPPER-CASE
  7203        IF PRINTI = 'Y' OR = ' '
  7204           MOVE AL-UANON         TO PRINTA
  7205        ELSE
  7206           MOVE ER-0183          TO EMI-ERROR
  7207           MOVE -1               TO PRINTL
  7208           MOVE AL-UABON         TO PRINTA
  7209           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7210
  7211     MOVE 'Y'                    TO CLEANO
  7212     IF ENCL <= ZEROS
  7213        MOVE 'N'                 TO CLEANO
  7214     END-IF
  7215     IF ENCL > ZEROS
  7216        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  7217                                          PI-ENCLOSURE-CD
  7218        IF ENCI  = '1'   OR
  7219                      '1P'  OR
  7220                      '2'   OR
  7221                      '3'   OR
  7222                      '4'   OR
  7223                      '5'   OR
  7224                      '6'   OR
  7225                      '7'   OR
  7226                      '8'   OR
  7227                      '9'   OR
  7228                      'A'   OR
  7229                      'C'   OR
  7230                      'E'   OR
  7231                      'EP'  OR
  7232                      'ENV' OR
  7233                      'I'   OR
  7234                      '0'   OR
  7235                      '4P'  OR
  7236                      '5P'
  7237           MOVE ENCI             TO PI-ENCLOSURE-CD
  7238                                    W-ENCLOSURE-CD
  7239           MOVE AL-UANON         TO ENCA
  7240        ELSE
  7241           MOVE 'N'              TO CLEANO
  7242           MOVE ER-1560          TO EMI-ERROR
  7243           MOVE -1               TO ENCL
  7244           MOVE AL-UABON         TO ENCA
  7245           PERFORM 9900-ERROR-FORMAT
  7246                                 THRU 9900-EXIT
  7247        END-IF
  7248     END-IF
  7249     IF COPIESL NOT = ZEROS
  7250        IF COPIESI NOT NUMERIC OR
  7251           COPIESI = '0'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL152.cbl
  7252           MOVE ER-0184          TO EMI-ERROR
  7253           MOVE -1               TO COPIESL
  7254           MOVE AL-UABON         TO COPIESA
  7255           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7256        ELSE
  7257           MOVE AL-UANON         TO COPIESA.
  7258
  7259     IF PI-PROCESSOR-PRINTER NOT = SPACES
  7260         MOVE PI-PROCESSOR-PRINTER   TO  PI-ALT-PRINTER-ID.
  7261
  7262     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  7263
  7264     IF PRINTERL > ZERO
  7265        INSPECT PRINTERI CONVERTING LOWER-CASE TO UPPER-CASE
  7266        MOVE AL-UANON            TO PRINTERA
  7267        MOVE PRINTERI            TO PI-ALT-PRINTER-ID
  7268                                    PI-ALT-DMD-PRT-ID
  7269     ELSE
  7270        IF (PI-NO-CARRIER-SECURITY AND
  7271            PI-NO-ACCOUNT-SECURITY) OR
  7272            PI-PROCESSOR-PRINTER NOT = SPACES
  7273             NEXT SENTENCE
  7274        ELSE
  7275            MOVE AL-UABON       TO PRINTERA
  7276            MOVE -1             TO PRINTERL
  7277            MOVE ER-2397        TO EMI-ERROR
  7278            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7279
  7280     IF ACTL NOT = +0
  7281         MOVE ZEROS              TO W-ACCOUNT
  7282         IF ACTI > SPACES
  7283             IF ACTI NUMERIC
  7284                     AND
  7285                ACTI NOT < 1
  7286                     AND
  7287                ACTI NOT > 9
  7288                 MOVE AL-UANON   TO ACTA
  7289                 MOVE ACTI       TO W-ACCOUNT
  7290                                    W-LETTER-ADDR-SEQ
  7291                 MOVE 'A'        TO W-LETTER-ADDR-TYPE
  7292             ELSE
  7293                 MOVE -1         TO ACTL
  7294                 MOVE AL-UABON   TO ACTA
  7295                 MOVE ER-3547    TO EMI-ERROR
  7296                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7297
  7298     IF BENL NOT = +0
  7299         MOVE ZEROS              TO W-BENEFICIARY
  7300         IF BENI > SPACES
  7301             IF BENI NUMERIC
  7302                     AND
  7303                BENI NOT < 1
  7304                     AND
  7305                BENI NOT > 9
  7306                 MOVE AL-UANON   TO BENA
  7307                 MOVE BENI       TO W-BENEFICIARY
  7308                                    W-LETTER-ADDR-SEQ
  7309                 MOVE 'B'        TO W-LETTER-ADDR-TYPE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL152.cbl
  7310             ELSE
  7311                 MOVE -1         TO BENL
  7312                 MOVE AL-UABON   TO BENA
  7313                 MOVE ER-3547    TO EMI-ERROR
  7314                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7315
  7316     IF EMPL NOT = +0
  7317         MOVE ZEROS              TO W-EMPLOYER
  7318         IF EMPI > SPACES
  7319             IF EMPI NUMERIC
  7320                     AND
  7321                EMPI NOT < 1
  7322                     AND
  7323                EMPI NOT > 9
  7324                 MOVE AL-UANON   TO EMPA
  7325                 MOVE EMPI       TO W-EMPLOYER
  7326                                    W-LETTER-ADDR-SEQ
  7327                 MOVE 'E'        TO W-LETTER-ADDR-TYPE
  7328             ELSE
  7329                 MOVE -1         TO EMPL
  7330                 MOVE AL-UABON   TO EMPA
  7331                 MOVE ER-3547    TO EMI-ERROR
  7332                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7333
  7334     IF INSL NOT = +0
  7335         MOVE ZEROS              TO W-INSURED
  7336         IF INSI > SPACES
  7337             IF INSI NUMERIC
  7338                     AND
  7339                INSI NOT < 1
  7340                     AND
  7341                INSI NOT > 9
  7342                 MOVE AL-UANON   TO INSA
  7343                 MOVE INSI       TO W-INSURED
  7344                                    W-LETTER-ADDR-SEQ
  7345                 MOVE 'I'        TO W-LETTER-ADDR-TYPE
  7346             ELSE
  7347                 MOVE -1         TO INSL
  7348                 MOVE AL-UABON   TO INSA
  7349                 MOVE ER-3547    TO EMI-ERROR
  7350                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7351
  7352     IF PHYSL NOT = +0
  7353         MOVE ZEROS              TO W-PHYSICIAN
  7354         IF PHYSI > SPACES
  7355             IF PHYSI NUMERIC
  7356                     AND
  7357                PHYSI NOT < 1
  7358                     AND
  7359                PHYSI NOT > 9
  7360                 MOVE AL-UANON   TO PHYSA
  7361                 MOVE PHYSI      TO W-PHYSICIAN
  7362                                    W-LETTER-ADDR-SEQ
  7363                 MOVE 'P'        TO W-LETTER-ADDR-TYPE
  7364             ELSE
  7365                 MOVE -1         TO PHYSL
  7366                 MOVE AL-UABON   TO PHYSA
  7367                 MOVE ER-3547    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL152.cbl
  7368                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7369
  7370     IF OTHR1L NOT = +0
  7371         MOVE ZEROS              TO W-OTHER-1
  7372         IF OTHR1I > SPACES
  7373             IF OTHR1I NUMERIC
  7374                     AND
  7375                OTHR1I NOT < 1
  7376                     AND
  7377                OTHR1I NOT > 9
  7378                 MOVE AL-UANON   TO OTHR1A
  7379                 MOVE OTHR1I     TO W-OTHER-1
  7380                                    W-LETTER-ADDR-SEQ
  7381                 MOVE 'O'        TO W-LETTER-ADDR-TYPE
  7382             ELSE
  7383                 MOVE -1         TO OTHR1L
  7384                 MOVE AL-UABON   TO OTHR1A
  7385                 MOVE ER-3547    TO EMI-ERROR
  7386                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7387
  7388     IF OTHR2L NOT = +0
  7389         MOVE ZEROS              TO W-OTHER-2
  7390         IF OTHR2I > SPACES
  7391             IF OTHR2I NUMERIC
  7392                     AND
  7393                OTHR2I NOT < 1
  7394                     AND
  7395                OTHR2I NOT > 9
  7396                 MOVE AL-UANON   TO OTHR2A
  7397                 MOVE OTHR2I     TO W-OTHER-2
  7398                                    W-LETTER-ADDR-SEQ
  7399                 MOVE 'Q'        TO W-LETTER-ADDR-TYPE
  7400             ELSE
  7401                 MOVE -1         TO OTHR2L
  7402                 MOVE AL-UABON   TO OTHR2A
  7403                 MOVE ER-3547    TO EMI-ERROR
  7404                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7405
  7406     IF NOT EMI-NO-ERRORS
  7407        GO TO 8200-SEND-DATAONLY.
  7408
  7409 0350-EXIT.
  7410      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL152.cbl
  7412 400-SET-CODES.
  7413     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7414     MOVE PI-COMPANY-CD          TO CLAM-CO
  7415                                    TEXT-CO
  7416                                    ACTV-CO
  7417                                    CERT-CO
  7418                                    ACCT-CO
  7419                                    ARCH-CO
  7420                                    PROD-CO
  7421                                    PLCY-CO
  7422                                    PLAN-CO.
  7423
  7424     MOVE PI-CARRIER             TO CLAM-CARRIER
  7425                                    ACTV-CARRIER
  7426                                    CERT-CARRIER
  7427                                    ACCT-CARRIER
  7428                                    PROD-CARRIER
  7429                                    PLCY-CARRIER
  7430                                    PLAN-CARRIER.
  7431
  7432     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  7433                                    ACTV-CERT-NUM
  7434                                    CERT-CERT-NUM.
  7435 499-EXIT.
  7436      EXIT.
  7437
  7438 500-RECOVER-PI-TEMP-STORAGE.
  7439
  7440
  7441* EXEC CICS HANDLE CONDITION
  7442*        QIDERR   (590-QIDERR)
  7443*    END-EXEC.
  7444*    MOVE '"$N                   ! % #00007358' TO DFHEIV0
  7445     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7447     MOVE X'2520233030303037333538' TO DFHEIV0(25:11)
  7448     CALL 'kxdfhei1' USING DFHEIV0
  7449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7450
  7451
  7452
  7453* EXEC CICS READQ TS
  7454*        QUEUE    (WS-PI-QID)
  7455*        INTO     (PROGRAM-INTERFACE-BLOCK)
  7456*        LENGTH   (PI-COMM-LENGTH)
  7457*    END-EXEC.
  7458*    MOVE '*$I    L              ''   #00007362' TO DFHEIV0
  7459     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7461     MOVE X'2020233030303037333632' TO DFHEIV0(25:11)
  7462     CALL 'kxdfhei1' USING DFHEIV0,
  7463           WS-PI-QID,
  7464           PROGRAM-INTERFACE-BLOCK,
  7465           PI-COMM-LENGTH,
  7466           DFHEIV99,
  7467           DFHEIV99,
  7468           DFHEIV99
  7469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL152.cbl
  7470
  7471
  7472     PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT.
  7473
  7474     GO TO 599-EXIT.
  7475
  7476 590-QIDERR.
  7477
  7478     IF EIBTRNID = TRANS-ID
  7479         MOVE ER-0033                   TO  EMI-ERROR
  7480         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7481         GO TO 8200-SEND-DATAONLY.
  7482
  7483 599-EXIT.
  7484     EXIT.
  7485
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL152.cbl
  7487 1000-SHOW.
  7488***************************************************************
  7489*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  7490*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN. THE TEXT      *
  7491*     WILL BE INSERTED INTO THE TS-TABLE AND DISPLAYED TO     *
  7492*     OPERATOR.                                               *
  7493***************************************************************
  7494
  7495     MOVE SPACES                 TO RECORD-TABLE.
  7496     IF ARCHNUML = ZEROS
  7497        MOVE -1                  TO ARCHNUML
  7498        MOVE AL-UNBON            TO ARCHNUMA
  7499        MOVE ER-0174             TO EMI-ERROR
  7500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7501        GO TO 8200-SEND-DATAONLY.
  7502
  7503     IF ARCHNUMI NOT NUMERIC
  7504        MOVE -1                  TO ARCHNUML
  7505        MOVE AL-UNBON            TO ARCHNUMA
  7506        MOVE ER-0175             TO EMI-ERROR
  7507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7508        GO TO 8200-SEND-DATAONLY.
  7509
  7510     IF PI-SHOW-MODE
  7511*       IF PI-ARCHIVE-NUMBER = ARCHNUMI
  7512*          MOVE -1               TO MAINTL
  7513*          GO TO 8200-SEND-DATAONLY
  7514*       ELSE
  7515           PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
  7516
  7517     MOVE ARCHNUMI               TO ARCH-NUMBER
  7518                                    PI-ARCHIVE-NUMBER.
  7519     MOVE ' '                    TO ARCH-REC-TYPE.
  7520     MOVE '1'                    TO PI-ACTION.
  7521     MOVE ZEROS                  TO PI-ADDR-SEQ.
  7522     MOVE LOW-VALUES             TO PI-ADDR-TYPE.
  7523     MOVE SPACES                 TO PI-PRINT-SW
  7524                                    PI-FORM-NUMBER.
  7525     SET TB-INDX TO 1.
  7526
  7527     MOVE SPACE                  TO WS-LETTER-STATUS.
  7528
  7529
  7530* EXEC CICS HANDLE CONDITION
  7531*         NOTOPEN    (8850-ARCH-NOT-OPEN)
  7532*         NOTFND     (1020-ENDBR)
  7533*         ENDFILE    (1020-ENDBR)
  7534*    END-EXEC.
  7535*    MOVE '"$JI''                 ! & #00007425' TO DFHEIV0
  7536     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  7537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7538     MOVE X'2620233030303037343235' TO DFHEIV0(25:11)
  7539     CALL 'kxdfhei1' USING DFHEIV0
  7540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7541
  7542
  7543     MOVE ARCH-PARTIAL-KEY       TO ARCH-SAVE-KEY.
  7544
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL152.cbl
  7545
  7546* EXEC CICS STARTBR
  7547*         DATASET    (ARCH-ID)
  7548*         RIDFLD     (ARCH-KEY)
  7549*         GTEQ
  7550*    END-EXEC
  7551     MOVE 0
  7552       TO DFHEIV11
  7553*    MOVE '&,         G          &   #00007433' TO DFHEIV0
  7554     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7555     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7556     MOVE X'2020233030303037343333' TO DFHEIV0(25:11)
  7557     CALL 'kxdfhei1' USING DFHEIV0,
  7558           ARCH-ID,
  7559           ARCH-KEY,
  7560           DFHEIV99,
  7561           DFHEIV11,
  7562           DFHEIV99
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7564
  7565     MOVE 'Y'                    TO ARCH-BROWSE-STARTED.
  7566
  7567 1010-READ-NEXT.
  7568
  7569* EXEC CICS READNEXT
  7570*         SET       (ADDRESS OF LETTER-ARCHIVE)
  7571*         DATASET   (ARCH-ID)
  7572*         RIDFLD    (ARCH-KEY)
  7573*    END-EXEC.
  7574     MOVE 0
  7575       TO DFHEIV11
  7576*    MOVE '&.S                   )   #00007442' TO DFHEIV0
  7577     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7578     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7579     MOVE X'2020233030303037343432' TO DFHEIV0(25:11)
  7580     CALL 'kxdfhei1' USING DFHEIV0,
  7581           ARCH-ID,
  7582           DFHEIV20,
  7583           DFHEIV99,
  7584           ARCH-KEY,
  7585           DFHEIV99,
  7586           DFHEIV11,
  7587           DFHEIV99,
  7588           DFHEIV99
  7589     SET ADDRESS OF LETTER-ARCHIVE TO
  7590         DFHEIV20
  7591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7592
  7593
  7594     IF LA-FORM-CONTROL-HDR
  7595        GO TO 1020-ENDBR.
  7596
  7597
  7598     IF NOT LA-HEADER-DATA
  7599         NEXT SENTENCE
  7600     ELSE
  7601         IF NOT LA-CSO-LETTER-PURGED
  7602             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL152.cbl
  7603         ELSE
  7604             MOVE 'P'            TO WS-LETTER-STATUS
  7605             GO TO 1020-ENDBR.
  7606
  7607     IF ARCH-PARTIAL-KEY = ARCH-SAVE-KEY
  7608        IF LA-HEADER-DATA
  7609           PERFORM 1040-FORMAT-RESEND
  7610           MOVE LA-NO-OF-COPIES    TO COPIESO
  7611           PERFORM 1050-GET-CORRESPOND THRU 1059-EXIT
  7612           GO TO 1010-READ-NEXT
  7613        ELSE
  7614           IF LA-ADDRESS-DATA
  7615              MOVE LA-ADDRESS-LINE   TO REC-TEXT (TB-INDX)
  7616              MOVE ZEROS             TO REC-PC (TB-INDX)
  7617              SET TB-INDX UP BY 1
  7618              GO TO 1010-READ-NEXT
  7619           ELSE
  7620              PERFORM 1030-TEXT-BUILD
  7621              GO TO 1010-READ-NEXT.
  7622
  7623 1020-ENDBR.
  7624     IF ARCH-BROWSE-STARTED = 'Y'
  7625        MOVE 'N'                TO ARCH-BROWSE-STARTED
  7626
  7627* EXEC CICS ENDBR
  7628*            DATASET   (ARCH-ID)
  7629*       END-EXEC
  7630     MOVE 0
  7631       TO DFHEIV11
  7632*    MOVE '&2                    $   #00007480' TO DFHEIV0
  7633     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7634     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7635     MOVE X'2020233030303037343830' TO DFHEIV0(25:11)
  7636     CALL 'kxdfhei1' USING DFHEIV0,
  7637           ARCH-ID,
  7638           DFHEIV11,
  7639           DFHEIV99
  7640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7641     END-IF.
  7642
  7643*    IF PI-COMPANY-ID = 'CID'
  7644         IF TB-INDX = 1
  7645             IF WS-LETTER-STATUS EQUAL 'P'
  7646                 MOVE 9021           TO EMI-ERROR
  7647                 MOVE -1             TO ARCHNUML
  7648                 MOVE AL-UNBON       TO ARCHNUMA
  7649                 PERFORM 9900-ERROR-FORMAT THRU
  7650                         9900-EXIT
  7651                 GO TO 8200-SEND-DATAONLY
  7652             ELSE
  7653                 MOVE ER-0006             TO EMI-ERROR
  7654                 MOVE -1                  TO ARCHNUML
  7655                 MOVE AL-UNBON            TO ARCHNUMA
  7656                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7657                 GO TO 8200-SEND-DATAONLY
  7658             END-IF
  7659         END-IF
  7660*    ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL152.cbl
  7661*        IF TB-INDX = 1
  7662*            MOVE ER-0006             TO EMI-ERROR
  7663*            MOVE -1                  TO ARCHNUML
  7664*            MOVE AL-UNBON            TO ARCHNUMA
  7665*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7666*            GO TO 8200-SEND-DATAONLY
  7667*        END-IF
  7668*    END-IF
  7669
  7670
  7671     SET TB-INDX DOWN BY 1.
  7672     SET PI-TOTAL-LINES          TO TB-INDX.
  7673     MOVE 1                      TO PI-CURRENT-LINE.
  7674     SET TB-INDX TO 1.
  7675
  7676     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7677             VARYING SC-INDX FROM 1 BY 1
  7678               UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7679
  7680     MOVE SPACES                 TO PI-ADDR-TYPE
  7681                                    MAINTI.
  7682     MOVE -1                     TO MAINTL.
  7683
  7684     GO TO 8100-SEND-INITIAL-MAP.
  7685
  7686 1030-TEXT-BUILD.
  7687***** IF THERE ARE NO ADDRESS LINES OR LESS THAN 6 LINES, SET TO
  7688***** TOP OF FORM.
  7689     IF TB-INDX < 7
  7690        SET TB-INDX   TO 7.
  7691
  7692     IF TB-INDX = 7
  7693        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7694        SET TB-INDX UP BY 1.
  7695
  7696     MOVE LA-TEXT-LINE           TO REC-TEXT (TB-INDX).
  7697     MOVE LA-SKIP-CONTROL        TO REC-PC (TB-INDX)
  7698                                    INDX-WORK.
  7699
  7700     IF INDX-WORK NOT = 99
  7701        SET TB-INDX UP BY 1
  7702        SET TB-INDX UP BY INDX-WORK
  7703     ELSE
  7704        SET TB-INDX UP BY 1
  7705        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7706        SET TB-INDX UP BY 1.
  7707
  7708 1040-FORMAT-RESEND.
  7709     IF LA-RESEND-DATE = LOW-VALUES
  7710        MOVE SPACES                 TO RESENDI
  7711       ELSE
  7712        MOVE LA-RESEND-DATE         TO DC-BIN-DATE-1
  7713        MOVE ' '                    TO DC-OPTION-CODE
  7714        PERFORM 9700-DATE-LINK  THRU 9700-EXIT
  7715        MOVE DC-GREG-DATE-1-EDIT    TO RESENDO.
  7716
  7717 1050-GET-CORRESPOND.
  7718     MOVE LA-CARRIER             TO ACTV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL152.cbl
  7719     MOVE LA-CLAIM-NO            TO ACTV-CLAIM.
  7720     MOVE LA-CERT-NO             TO ACTV-CERT-NUM.
  7721     MOVE LA-CORR-TRLR-SEQ       TO ACTV-SEQ.
  7722
  7723
  7724* EXEC CICS READ
  7725*         DATASET     (ACTV-ID)
  7726*         RIDFLD      (ACTV-KEY)
  7727*         SET         (ADDRESS OF ACTIVITY-TRAILERS)
  7728*    END-EXEC.
  7729*    MOVE '&"S        E          (   #00007565' TO DFHEIV0
  7730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7732     MOVE X'2020233030303037353635' TO DFHEIV0(25:11)
  7733     CALL 'kxdfhei1' USING DFHEIV0,
  7734           ACTV-ID,
  7735           DFHEIV20,
  7736           DFHEIV99,
  7737           ACTV-KEY,
  7738           DFHEIV99,
  7739           DFHEIV99,
  7740           DFHEIV99
  7741     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7742         DFHEIV20
  7743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7744
  7745
  7746     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  7747        MOVE SPACES                TO FOLLOWI
  7748     ELSE
  7749        MOVE SPACES                TO DC-OPTION-CODE
  7750        MOVE AT-RECEIPT-FOLLOW-UP  TO DC-BIN-DATE-1
  7751        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7752        MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWI.
  7753
  7754     MOVE SPACES                 TO ADDRI
  7755     MOVE AT-STD-LETTER-FORM     TO FORMI
  7756     MOVE AT-REASON-TEXT         TO REI.
  7757
  7758 1059-EXIT.
  7759      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL152.cbl
  7761 2000-CREATE.
  7762***************************************************************
  7763*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  7764*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  7765*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  7766*    WILL BE DISPLAYED ONTO THE SCREEN.                       *
  7767*                                                             *
  7768***************************************************************
  7769
  7770***************************************************************
  7771*    CHECK TO SEE IF SAME REQUEST OR NOT.                     *
  7772*    IF NEW REQUEST AND A LETTER WAS PRINTED, FORCE AN ERROR  *
  7773***************************************************************
  7774
  7775     IF PI-CREATE-MODE
  7776        IF PI-FORM-NUMBER = FORMI AND PI-ADDR-TYPE = ADDRI AND
  7777           PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7778           PERFORM 7500-READ-TS  THRU 7599-EXIT
  7779           PERFORM 7950-SET-INDX THRU 7950-EXIT
  7780           PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7781             VARYING SC-INDX FROM 1 BY 1
  7782             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  7783           MOVE -1               TO MAINTL
  7784*          MOVE 'Y'              TO CLEANO
  7785           GO TO 8200-SEND-DATAONLY
  7786        ELSE
  7787           IF PRINT-PERFORMED AND
  7788              PI-RETURN-TO-PROGRAM  =  PGM-EL150 AND
  7789              FORMI NOT = 9999
  7790              MOVE ER-0279           TO EMI-ERROR
  7791              MOVE -1                TO MAINTL
  7792              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7793              GO TO 8200-SEND-DATAONLY.
  7794
  7795***************************************************************
  7796*   IF THE FORM NUMBER IS THE SAME BUT THE ADDRESS TYPE       *
  7797*   HAS CHANGED, THEN SAVE THE CURRENT SCREEN AND REBUILD     *
  7798*   THE ADDRESS DATA.                                         *
  7799***************************************************************
  7800
  7801     IF PI-FORM-NUMBER = FORMI AND
  7802        PI-ADDR-TYPE  =  ADDRI AND
  7803        PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7804           MOVE -1                  TO MAINTL
  7805           GO TO 8200-SEND-DATAONLY.
  7806
  7807     IF PI-LETTER-ADDRESS-TYPE NOT = W-LETTER-ADDRESS-TYPE
  7808         MOVE 0                  TO GETMAIN-SWITCH
  7809         MOVE 'N'                TO WS-ACCT-READ-SW
  7810                                    WS-PROD-READ-SW
  7811                                    WS-COMP-READ-SW.
  7812
  7813     MOVE SPACES                 TO RECORD-TABLE.
  7814
  7815     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  7816
  7817     SET TB-INDX TO 1
  7818     MOVE TOP-FORM               TO REC-TEXT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL152.cbl
  7819     SET TB-INDX UP BY 1.
  7820
  7821***************************************************************
  7822*    IF A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE      *
  7823*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  7824***************************************************************
  7825
  7826     IF FORMI = '9999'
  7827        MOVE 16                  TO PI-TOTAL-LINES
  7828        MOVE 1                   TO PI-CURRENT-LINE
  7829        PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
  7830        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT
  7831        MOVE '3'                 TO PI-ACTION
  7832        MOVE FORMI               TO PI-FORM-NUMBER
  7833                                    PI-COMM-CONTROL
  7834        MOVE ZEROS               TO PI-UPDATE-SW
  7835        MOVE PGM-EL1042          TO PGM-NAME
  7836        GO TO 9300-XCTL.
  7837
  7838     MOVE FORMI                  TO TEXT-LETTER.
  7839     MOVE TEXT-PARTIAL-KEY       TO TEXT-SAVE-KEY.
  7840
  7841
  7842* EXEC CICS HANDLE CONDITION
  7843*         NOTFND     (2120-ENDBR)
  7844*         ENDFILE    (2120-ENDBR)
  7845*         NOTOPEN    (8890-TEXT-NOT-OPEN)
  7846*    END-EXEC
  7847*    MOVE '"$I''J                 ! '' #00007666' TO DFHEIV0
  7848     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7849     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7850     MOVE X'2720233030303037363636' TO DFHEIV0(25:11)
  7851     CALL 'kxdfhei1' USING DFHEIV0
  7852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7853
  7854
  7855* EXEC CICS STARTBR
  7856*         DATASET    (TEXT-ID)
  7857*         RIDFLD     (TEXT-KEY)
  7858*         GTEQ
  7859*    END-EXEC.
  7860     MOVE 0
  7861       TO DFHEIV11
  7862*    MOVE '&,         G          &   #00007672' TO DFHEIV0
  7863     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7865     MOVE X'2020233030303037363732' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           TEXT-ID,
  7868           TEXT-KEY,
  7869           DFHEIV99,
  7870           DFHEIV11,
  7871           DFHEIV99
  7872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7873
  7874
  7875     MOVE 'Y'                    TO TEXT-BROWSE-STARTED.
  7876
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL152.cbl
  7877 2110-READ-NEXT.
  7878     IF TB-INDX > MAX-LINES
  7879        MOVE ER-0051             TO EMI-ERROR
  7880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7881        GO TO 2120-ENDBR.
  7882
  7883
  7884* EXEC CICS READNEXT
  7885*         DATASET    (TEXT-ID)
  7886*         SET        (ADDRESS OF TEXT-FILES)
  7887*         RIDFLD     (TEXT-KEY)
  7888*    END-EXEC.
  7889     MOVE 0
  7890       TO DFHEIV11
  7891*    MOVE '&.S                   )   #00007686' TO DFHEIV0
  7892     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7893     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7894     MOVE X'2020233030303037363836' TO DFHEIV0(25:11)
  7895     CALL 'kxdfhei1' USING DFHEIV0,
  7896           TEXT-ID,
  7897           DFHEIV20,
  7898           DFHEIV99,
  7899           TEXT-KEY,
  7900           DFHEIV99,
  7901           DFHEIV11,
  7902           DFHEIV99,
  7903           DFHEIV99
  7904     SET ADDRESS OF TEXT-FILES TO
  7905         DFHEIV20
  7906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7907
  7908
  7909     IF TEXT-PARTIAL-KEY NOT = TEXT-SAVE-KEY
  7910        IF TB-INDX = +2
  7911           MOVE SPACES           TO PI-FORM-NUMBER
  7912           MOVE -1               TO FORML
  7913           MOVE AL-UABON         TO FORMA
  7914           MOVE ER-1236          TO EMI-ERROR
  7915           MOVE 'N'              TO CLEANO
  7916           PERFORM 9900-ERROR-FORMAT
  7917                                 THRU 9900-EXIT
  7918        END-IF
  7919        GO TO 2120-ENDBR
  7920     END-IF
  7921
  7922     MOVE FORMI                  TO PI-FORM-NUMBER.
  7923     IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  7924         PERFORM 2800-PROCESS-Z-CONTROLS THRU 2800-EXIT
  7925         GO TO 2110-READ-NEXT.
  7926
  7927      MOVE TX-BSR-CODE           TO PI-ELLETR-BSR.
  7928
  7929      IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  7930         AND (PI-CARRIER NOT = '8')
  7931         PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  7932            B1 > +20
  7933            IF TX-TEXT-LINE (B1:5) = '@03.1'
  7934               GO TO 2110-READ-NEXT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL152.cbl
  7935            END-IF
  7936         END-PERFORM
  7937      END-IF
  7938      MOVE TX-TEXT-LINE          TO REC-TEXT (TB-INDX).
  7939      MOVE TX-PROCESS-CONTROL    TO REC-PC (TB-INDX)
  7940                                    INDX-WORK.
  7941      SET TB-INDX UP BY 1.
  7942      IF INDX-WORK = 99
  7943         MOVE TOP-FORM           TO REC-TEXT (TB-INDX)
  7944         SET TB-INDX UP BY 1
  7945         GO TO 2110-READ-NEXT
  7946      ELSE
  7947         SET TB-INDX UP BY INDX-WORK
  7948         GO TO 2110-READ-NEXT.
  7949
  7950 2120-ENDBR.
  7951     IF TEXT-BROWSE-STARTED = 'Y'
  7952        MOVE 'N'                 TO TEXT-BROWSE-STARTED
  7953
  7954* EXEC CICS ENDBR
  7955*            DATASET     (TEXT-ID)
  7956*       END-EXEC.
  7957     MOVE 0
  7958       TO DFHEIV11
  7959*    MOVE '&2                    $   #00007736' TO DFHEIV0
  7960     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7961     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7962     MOVE X'2020233030303037373336' TO DFHEIV0(25:11)
  7963     CALL 'kxdfhei1' USING DFHEIV0,
  7964           TEXT-ID,
  7965           DFHEIV11,
  7966           DFHEIV99
  7967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7968
  7969
  7970*02160      IF TB-INDX = 8
  7971*02161         MOVE ER-0006             TO EMI-ERROR
  7972*02162         MOVE -1                  TO FORML
  7973*02163         MOVE AL-UABON            TO FORMA
  7974*02164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7975*02165         GO TO 8200-SEND-DATAONLY-ERASEAUP.
  7976
  7977     SET TB-INDX DOWN BY 1.
  7978     SET PI-TOTAL-LINES          TO TB-INDX.
  7979     MOVE 1                      TO PI-CURRENT-LINE.
  7980
  7981***************************************************************
  7982*    IF IT IS A DESIGNATED CLAIM, THEN RESOLVE ALL            *
  7983*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
  7984***************************************************************
  7985
  7986     IF PI-RETURN-TO-PROGRAM = PGM-EL150
  7987        PERFORM 7200-RESOLVE-VARIABLES THRU 7269-EXIT
  7988        MOVE SPACES              TO W-REVERSE-DATE-SW
  7989        PERFORM 7300-VARIABLE-SEARCH   THRU 7399-EXIT
  7990                VARYING TB-INDX FROM 7 BY 1 UNTIL
  7991                TB-INDX > PI-TOTAL-LINES
  7992     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL152.cbl
  7993        MOVE ER-0373             TO EMI-ERROR
  7994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7995
  7996     SET TB-INDX TO 1.
  7997     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7998             VARYING SC-INDX FROM 1 BY 1 UNTIL
  7999             SC-INDX > NUM-LINES-PER-SCREEN.
  8000
  8001     MOVE '3'                    TO PI-ACTION.
  8002*    MOVE FORMI                  TO PI-FORM-NUMBER.
  8003     MOVE W-LETTER-ADDRESS-TYPE  TO PI-LETTER-ADDRESS-TYPE.
  8004     MOVE -1                     TO MAINTL.
  8005     GO TO 8200-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL152.cbl
  8007 2800-PROCESS-Z-CONTROLS.
  8008
  8009     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
  8010
  8011     IF RESEND-SAVE = LOW-VALUES
  8012         IF W-DAYS-TO-RESEND-1 NUMERIC
  8013             IF W-DAYS-TO-RESEND-1 > ZEROS
  8014                 MOVE '6'                    TO DC-OPTION-CODE
  8015                 MOVE SAVE-BIN-DATE          TO DC-BIN-DATE-1
  8016                 MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8017                 MOVE W-DAYS-TO-RESEND-1     TO DC-ELAPSED-DAYS
  8018                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8019                 IF NO-CONVERSION-ERROR
  8020                     MOVE DC-BIN-DATE-2       TO RESEND-SAVE
  8021                     MOVE DC-GREG-DATE-1-EDIT TO RESENDO
  8022                     MOVE AL-UANON            TO RESENDA
  8023                     MOVE +8                  TO RESENDL
  8024                 ELSE
  8025                     MOVE ER-3770             TO EMI-ERROR
  8026                     MOVE -1                  TO MAINTL
  8027                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8028                     GO TO 8200-SEND-DATAONLY.
  8029
  8030     IF FOLLOW-UP-SAVE = LOW-VALUES
  8031         IF W-DAYS-TO-FOLLOW-UP NUMERIC
  8032             IF W-DAYS-TO-FOLLOW-UP > ZEROS
  8033                 MOVE '6'                 TO DC-OPTION-CODE
  8034                 MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  8035                 MOVE ZEROS               TO DC-ELAPSED-MONTHS
  8036                 MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  8037                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8038                 IF NO-CONVERSION-ERROR
  8039                     MOVE DC-BIN-DATE-2       TO FOLLOW-UP-SAVE
  8040                     MOVE DC-GREG-DATE-1-EDIT TO FOLLOWO
  8041                     MOVE AL-UANON            TO FOLLOWA
  8042                     MOVE +8                  TO FOLLOWL
  8043                 ELSE
  8044                     MOVE ER-3771             TO EMI-ERROR
  8045                     MOVE -1                  TO MAINTL
  8046                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8047                     GO TO 8200-SEND-DATAONLY.
  8048
  8049     IF COPIESI NOT NUMERIC
  8050         IF W-NUMBER-OF-COPIES NUMERIC
  8051             IF W-NUMBER-OF-COPIES > ZEROS
  8052                 MOVE W-NUMBER-OF-COPIES  TO COPIESI
  8053                 MOVE AL-UNNON            TO COPIESA
  8054                 MOVE +1                  TO COPIESL
  8055             ELSE
  8056                 MOVE +1                  TO COPIESI
  8057                 MOVE AL-UNNON            TO COPIESA
  8058                 MOVE +1                  TO COPIESL.
  8059
  8060     IF W-FORM-TO-RESEND > SPACES
  8061         MOVE W-FORM-TO-RESEND          TO PI-RESEND-FORM-NUMBER
  8062     ELSE
  8063         MOVE LOW-VALUES                TO PI-RESEND-FORM-NUMBER
  8064     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL152.cbl
  8065
  8066     IF W-PROMPT-LETTER = 'Y'
  8067         MOVE W-PROMPT-LETTER           TO PI-PROMPT-LETTER
  8068         MOVE ER-0894                   TO EMI-ERROR
  8069         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8070     ELSE
  8071         MOVE 'N'                       TO PI-PROMPT-LETTER
  8072     END-IF.
  8073
  8074     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
  8075                                           ENCO
  8076     MOVE AL-UANON                      TO ENCA
  8077     MOVE +3                            TO ENCL
  8078     MOVE 'N'                           TO CLEANO
  8079     MOVE W-AUTO-CLOSE-IND              TO PI-AUTO-CLOSE-IND.
  8080     MOVE W-LETTER-TO-BENE              TO PI-LETTER-TO-BENE.
  8081
  8082 2800-EXIT.
  8083     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL152.cbl
  8085 3000-RECORD.
  8086***************************************************************
  8087*    THIS ROUTINE WILL SAVE THE LETTER TEXT (IF ANY) AND      *
  8088*    BUILD A CORRESPONDENCE TRAILER WITH THE DATA FROM        *
  8089*    THE SCREEN.                                              *
  8090***************************************************************
  8091
  8092     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8093        MOVE ER-0211             TO EMI-ERROR
  8094        MOVE -1                  TO MAINTL
  8095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8096        GO TO 8200-SEND-DATAONLY.
  8097
  8098
  8099* EXEC CICS HANDLE CONDITION
  8100*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  8101*         NOTFND     (3010-NOT-FOUND)
  8102*    END-EXEC.
  8103*    MOVE '"$JI                  ! ( #00007868' TO DFHEIV0
  8104     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8106     MOVE X'2820233030303037383638' TO DFHEIV0(25:11)
  8107     CALL 'kxdfhei1' USING DFHEIV0
  8108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8109
  8110
  8111     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8112     PERFORM 7950-SET-INDX     THRU 7950-EXIT.
  8113
  8114     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8115             VARYING SC-INDX FROM 1 BY 1
  8116             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8117
  8118     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8119
  8120     IF NOT EMI-NO-ERRORS
  8121        GO TO 8200-SEND-DATAONLY.
  8122
  8123     MOVE ZEROS               TO ARCH-NUMBER.
  8124     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8125     MOVE ER-0000             TO EMI-ERROR.
  8126     MOVE -1                  TO MAINTL.
  8127     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8128     GO TO 8200-SEND-DATAONLY.
  8129
  8130 3010-NOT-FOUND.
  8131     MOVE ER-0133             TO EMI-ERROR.
  8132     MOVE -1                  TO MAINTL.
  8133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8134     GO TO 8200-SEND-DATAONLY.
  8135
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL152.cbl
  8137*4000-SET-BSR. Remove as dead code
  8138*4001-READ-NEXT. Remove as dead code
  8139*4002-ENDBR. Remove as dead code
  8140*4000-EXIT. Remove as dead code
  8141
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL152.cbl
  8143 5000-MOVE-NAME.
  8144*    COPY ELCMNS.
  8145*****************************************************************
  8146*                                                               *
  8147*                                                               *
  8148*                            ELCMNS.                            *
  8149*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8150*                            VMOD=2.002                         *
  8151*                                                               *
  8152*                     M O V E   N A M E   R O U T I N E         *
  8153*                                                               *
  8154*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8155*            NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8156*            NO EMBEDDED BLANKS.                                *
  8157*                                                               *
  8158*                  FIELD               VALUE                    *
  8159*                                                               *
  8160*                LAST NAME (CL15)      SMITH                    *
  8161*                1ST NAME  (CL12)      JOHN                     *
  8162*                MID NAME  (CL12)      ALLEN                    *
  8163*                                                               *
  8164*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8165*                                                               *
  8166*                        SMITH, JOHN ALLEN                      *
  8167*                                                               *
  8168*                TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8169*            STORAGE COPYBOOK:                                  *
  8170*                                                               *
  8171*                01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8172*                                                               *
  8173*****************************************************************.
  8174
  8175     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8176     MOVE ZERO                   TO  WS-NAME-SW.
  8177     SET NWA-INDEX TO +1.
  8178
  8179     IF CL-INSURED-1ST-NAME = SPACES  AND
  8180        CL-INSURED-MID-INIT = SPACES
  8181         MOVE +1                 TO  WS-NAME-SW.
  8182
  8183     MOVE CL-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8184     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8185
  8186     MOVE CL-INSURED-1ST-NAME   TO  WS-NAME-WORK2.
  8187     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8188
  8189     SET NWA-INDEX UP BY +1.
  8190     MOVE CL-INSURED-MID-INIT   TO  WS-NAME-WORK2.
  8191     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8192
  8193 5000-EXIT.
  8194     EXIT.
  8195
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL152.cbl
  8197 5100-MOVE-NAME SECTION.
  8198     IF WS-NAME-SW GREATER THAN +1
  8199         GO TO 5190-EXIT.
  8200
  8201     IF WS-NAME-WORK2 = SPACES
  8202         GO TO 5190-EXIT.
  8203
  8204     SET NWA-INDEX2 TO +1.
  8205     SET NWA-INDEX3 TO +2.
  8206
  8207 5110-MOVE-NAME.
  8208     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8209
  8210     IF NWA-INDEX LESS THAN +30
  8211         SET NWA-INDEX UP BY +1
  8212       ELSE
  8213         ADD +2  TO  WS-NAME-SW
  8214         GO TO 5190-EXIT.
  8215
  8216     IF NWA-INDEX2 LESS THAN +20
  8217         SET NWA-INDEX3 UP BY +1
  8218         SET NWA-INDEX2 UP BY +1.
  8219
  8220     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8221        WS-NW2 (NWA-INDEX3) = SPACES
  8222         IF WS-NAME-SW = ZERO
  8223             MOVE ','            TO  WS-NW (NWA-INDEX)
  8224             SET NWA-INDEX UP BY +2
  8225             MOVE +1             TO  WS-NAME-SW
  8226             GO TO 5190-EXIT
  8227           ELSE
  8228             GO TO 5190-EXIT.
  8229
  8230     GO TO 5110-MOVE-NAME.
  8231
  8232 5190-EXIT.
  8233     EXIT.
  8234
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL152.cbl
  8236 5200-MOVE-NAME.
  8237*    NOTE *******************************************************
  8238*         *           M O V E   N A M E   R O U T I N E         *
  8239*         *                                                     *
  8240*         *      THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8241*         *  NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8242*         *  NO EMBEDDED BLANKS.                                *
  8243*         *                                                     *
  8244*         *        FIELD               VALUE                    *
  8245*         *                                                     *
  8246*         *      LAST NAME (CL15)      SMITH                    *
  8247*         *      1ST NAME  (CL12)      JOHN                     *
  8248*         *      MID NAME  (CL1)       A                        *
  8249*         *                                                     *
  8250*         *      AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8251*         *                                                     *
  8252*         *              JOHN A. SMITH                          *
  8253*         *                                                     *
  8254*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8255*         *  STORAGE COPYBOOK:                                  *
  8256*         *                                                     *
  8257*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8258*         *                                                     *
  8259*         *******************************************************.
  8260
  8261     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8262     MOVE ZERO                   TO  WS-NAME-SW.
  8263     SET NWA-INDEX TO +1.
  8264
  8265     IF W-FIRST-NAME = SPACES
  8266             AND
  8267        W-MIDDLE-NAME = SPACES
  8268         MOVE W-LAST-NAME        TO WS-NAME-WORK
  8269         GO TO 5200-EXIT.
  8270
  8271     MOVE W-FIRST-NAME           TO  WS-NAME-WORK2.
  8272     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8273
  8274     SET NWA-INDEX UP BY +1.
  8275
  8276     IF W-MIDDLE-NAME NOT = SPACES
  8277        MOVE W-MIDDLE-NAME       TO  WS-NW (NWA-INDEX)
  8278        SET NWA-INDEX UP BY +1
  8279        MOVE '.'                 TO  WS-NW (NWA-INDEX)
  8280        SET NWA-INDEX UP BY +2.
  8281
  8282     MOVE W-LAST-NAME            TO  WS-NAME-WORK2.
  8283     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8284
  8285 5200-EXIT.
  8286     EXIT.
  8287
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL152.cbl
  8289 5300-MOVE-NAME.
  8290     IF WS-NAME-SW > +1
  8291         GO TO 5390-EXIT.
  8292
  8293     IF WS-NAME-WORK2 = SPACES
  8294         GO TO 5390-EXIT.
  8295
  8296     SET NWA-INDEX2 TO +1.
  8297     SET NWA-INDEX3 TO +2.
  8298
  8299 5310-MOVE-NAME.
  8300     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8301
  8302     IF NWA-INDEX < +30
  8303        SET NWA-INDEX UP BY +1
  8304     ELSE
  8305        ADD +2  TO  WS-NAME-SW
  8306        GO TO 5390-EXIT.
  8307
  8308     IF NWA-INDEX2 < +20
  8309         SET NWA-INDEX2 UP BY +1
  8310         SET NWA-INDEX3 UP BY +1.
  8311
  8312     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8313        WS-NW2 (NWA-INDEX3) = SPACES
  8314        GO TO 5390-EXIT.
  8315
  8316     GO TO 5310-MOVE-NAME.
  8317
  8318 5390-EXIT.
  8319     EXIT.
  8320
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL152.cbl
  8322 6100-ADDR-MAINT.
  8323***************************************************************
  8324*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8325*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8326*    IT WILL THEN XCTL TO THE ADDRESS MAINT PROGRAM.          *
  8327***************************************************************
  8328
  8329     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8330
  8331     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8332     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8333             VARYING SC-INDX FROM 1 BY 1
  8334             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8335
  8336     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8337        MOVE ER-0343             TO EMI-ERROR
  8338        MOVE -1                  TO MAINTL
  8339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8340        GO TO 8200-SEND-DATAONLY.
  8341
  8342*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8343*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8344*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8345*            VARYING SC-INDX FROM 1 BY 1
  8346*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8347
  8348     PERFORM 7700-PUT-TEMP-STOR    THRU 7749-EXIT.
  8349     PERFORM 7790-WRITE-SCREEN-TS  THRU 7790-EXIT.
  8350     PERFORM 7795-WRITE-PI-AREA-TS THRU 7795-EXIT.
  8351     MOVE PGM-EL141 TO PGM-NAME.
  8352
  8353     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL152.cbl
  8355 6200-EDIT-MODE.
  8356***************************************************************
  8357*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8358*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8359*    IT WILL THEN XCTL TO THE TEXT-EDITOR PROGRAM.            *
  8360***************************************************************
  8361     IF PI-SHOW-MODE
  8362        MOVE ER-0188             TO EMI-ERROR
  8363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8364        MOVE -1                  TO MAINTL
  8365        MOVE AL-UABON            TO MAINTA
  8366        GO TO 8200-SEND-DATAONLY
  8367     END-IF
  8368
  8369*    IF PI-COMPANY-ID = 'DMD'
  8370*        IF PI-BSR-AUTOMATED
  8371*            MOVE ER-0912        TO EMI-ERROR
  8372*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8373*            MOVE -1             TO MAINTL
  8374*            MOVE AL-UABON       TO MAINTA
  8375*            GO TO 8200-SEND-DATAONLY.
  8376
  8377     IF PI-CURRENT-LINE = ZEROS
  8378        MOVE ER-0187             TO EMI-ERROR
  8379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8380        MOVE -1                  TO MAINTL
  8381        GO TO 8200-SEND-DATAONLY.
  8382
  8383     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8384     PERFORM 7750-DELETE-TEMP-STOR
  8385                                 THRU 7750-EXIT
  8386     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8387     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8388             VARYING SC-INDX FROM 1 BY 1
  8389             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8390
  8391     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT.
  8392     PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
  8393
  8394     MOVE PI-FORM-NUMBER         TO PI-COMM-CONTROL.
  8395     MOVE ZEROS                  TO PI-UPDATE-SW.
  8396     MOVE '1'                    TO PI-ENTRY-CD-1.
  8397     MOVE PGM-EL1042             TO PGM-NAME.
  8398     GO TO 9300-XCTL.
  8399
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL152.cbl
  8401 6400-LETTER-RELEASE.
  8402***************************************************************
  8403*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
  8404*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS ONTO     *
  8405*    THE ARCHIVE FILE.                                        *
  8406*    THE FOLLOWING FUNCTIONS WILL BE PERFORMED                *
  8407*        1. CHECK SECURITY AND IF IT IS A DESIGNATED LETTER.  *
  8408*        2. RE-EDIT DATA AND UPDATE TS-TABLE WITH CHANGES     *
  8409*        3. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS         *
  8410*        4. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
  8411*        5. WRITE THE NEW ARCHIVE RECORDS FROM TS-TABLE.      *
  8412*        7. BUILD A CORRESPONDENCE TRAILER                    *
  8413*        8. BUILD OR UPDATE THE ACTIVITY QUE FILE WITH THE    *
  8414*                 ARCHIVE NUMBER IF IT IS TO BE PRINTED LATER.*
  8415*        4. RESET ALL CONTROL FIELDS AND RETURN THE           *
  8416*                 ARCHIVE NUMBER USED TO FILE THE RECORDS.    *
  8417***************************************************************
  8418
  8419     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8420
  8421     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8422     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8423             VARYING SC-INDX FROM 1 BY 1
  8424             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8425
  8426     IF NOT MODIFY-CAP
  8427        MOVE ER-0070             TO EMI-ERROR
  8428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8429        MOVE -1                  TO MAINTL
  8430        GO TO 8200-SEND-DATAONLY.
  8431
  8432     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8433        MOVE ER-0211             TO EMI-ERROR
  8434        MOVE -1                  TO MAINTL
  8435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8436        GO TO 8200-SEND-DATAONLY.
  8437
  8438*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8439*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8440*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8441*            VARYING SC-INDX FROM 1 BY 1
  8442*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8443
  8444     IF PI-ADDR-TYPE  NOT =  ADDRI
  8445        PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8446
  8447     IF NOT EMI-NO-ERRORS
  8448        GO TO 8200-SEND-DATAONLY.
  8449
  8450     MOVE +0                     TO TALLY.
  8451     INSPECT RECORD-TABLE TALLYING TALLY
  8452                                 FOR CHARACTERS BEFORE '@'.
  8453
  8454     IF TALLY < +21900
  8455        COMPUTE PI-CURRENT-LINE = TALLY / 73
  8456        MOVE ZEROS               TO ROLL-COUNTER
  8457        MOVE ER-0191             TO EMI-ERROR
  8458        MOVE -1                  TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL152.cbl
  8459        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8460        GO TO 7900-ROLL-PAGE.
  8461
  8462     MOVE '1'                    TO CNTL-RECORD-TYPE.
  8463     MOVE ZEROS                  TO CNTL-SEQ.
  8464     MOVE SPACES                 TO CNTL-GENL.
  8465
  8466* EXEC CICS READ
  8467*         DATASET    (CNTL-ID)
  8468*         SET        (ADDRESS OF CONTROL-FILE)
  8469*         RIDFLD     (CNTL-KEY)
  8470*         UPDATE
  8471*    END-EXEC.
  8472*    MOVE '&"S        EU         (   #00008227' TO DFHEIV0
  8473     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8474     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8475     MOVE X'2020233030303038323237' TO DFHEIV0(25:11)
  8476     CALL 'kxdfhei1' USING DFHEIV0,
  8477           CNTL-ID,
  8478           DFHEIV20,
  8479           DFHEIV99,
  8480           CNTL-KEY,
  8481           DFHEIV99,
  8482           DFHEIV99,
  8483           DFHEIV99
  8484     SET ADDRESS OF CONTROL-FILE TO
  8485         DFHEIV20
  8486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8487
  8488
  8489     ADD 1                       TO CF-CO-ARCHIVE-COUNTER.
  8490     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
  8491     MOVE CF-PRINT-ADDRESS-LABELS   TO  WS-LABELS-SW.
  8492
  8493
  8494* EXEC CICS REWRITE
  8495*         FROM      (CONTROL-FILE)
  8496*         DATASET   (CNTL-ID)
  8497*    END-EXEC
  8498     MOVE LENGTH OF
  8499      CONTROL-FILE
  8500       TO DFHEIV11
  8501*    MOVE '&& L                  %   #00008238' TO DFHEIV0
  8502     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8503     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8504     MOVE X'2020233030303038323338' TO DFHEIV0(25:11)
  8505     CALL 'kxdfhei1' USING DFHEIV0,
  8506           CNTL-ID,
  8507           CONTROL-FILE,
  8508           DFHEIV11,
  8509           DFHEIV99
  8510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8511
  8512     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8513
  8514
  8515* EXEC CICS HANDLE CONDITION
  8516*         NOTOPEN   (9990-ABEND)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL152.cbl
  8517*    END-EXEC.
  8518*    MOVE '"$J                   ! ) #00008245' TO DFHEIV0
  8519     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  8520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8521     MOVE X'2920233030303038323435' TO DFHEIV0(25:11)
  8522     CALL 'kxdfhei1' USING DFHEIV0
  8523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8524
  8525
  8526
  8527* EXEC CICS GETMAIN
  8528*         SET      (ADDRESS OF LETTER-ARCHIVE)
  8529*         LENGTH   (ARCH-LENGTH)
  8530*    END-EXEC.
  8531*    MOVE '," L                  $   #00008249' TO DFHEIV0
  8532     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8533     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8534     MOVE X'2020233030303038323439' TO DFHEIV0(25:11)
  8535     CALL 'kxdfhei1' USING DFHEIV0,
  8536           DFHEIV20,
  8537           ARCH-LENGTH,
  8538           DFHEIV99
  8539     SET ADDRESS OF LETTER-ARCHIVE TO
  8540         DFHEIV20
  8541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8542
  8543
  8544     MOVE SPACES                 TO LETTER-ARCHIVE.
  8545     MOVE 'LA'                   TO LA-RECORD-ID.
  8546     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8547                                    LA-ARCHIVE-NO-A1.
  8548     MOVE '1'                    TO LA-RECORD-TYPE
  8549                                    LA-RECORD-TYPE-A1.
  8550     MOVE ZEROS                  TO LA-LINE-SEQ-NO
  8551                                    LA-LINE-SEQ-NO-A1.
  8552     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8553                                    LA-COMPANY-CD-A1.
  8554     MOVE CLAM-CARRIER           TO LA-CARRIER.
  8555     MOVE PI-CLAIM-NO            TO LA-CLAIM-NO.
  8556     MOVE PI-CERT-NO             TO LA-CERT-NO.
  8557
  8558*    IF PI-COMPANY-ID = 'DMD'
  8559*        MOVE WS-DMD-CERT-STATE    TO LA-DMD-UND-CODE
  8560*        MOVE WS-DMD-CERT-GROUPING TO LA-DMD-PROD-CODE
  8561*        MOVE WS-DMD-BEN-CODE      TO LA-DMD-BEN-CODE
  8562*        MOVE WS-DMD-CORR-TRLR-SEQ TO LA-DMD-CORR-TRLR-SEQ
  8563*        MOVE WS-DMD-LETTER-FORM   TO LA-DMD-LETTER-FORM
  8564*        MOVE WS-DMD-RES-ST        TO LA-DMD-RES-ST
  8565*        MOVE LOW-VALUES           TO LA-DMD-LETTER-PURGE-DT
  8566*                                     LA-DMD-LETTER-RELOAD-DT
  8567*        MOVE '1'                  TO LA-DMD-LETTER-STATUS
  8568*        EXEC CICS GETMAIN
  8569*            SET    (ADDRESS OF LETTER-ARCHIVE-TEMP)
  8570*            LENGTH (ARCT-LENGTH)
  8571*        END-EXEC.
  8572
  8573     IF COPIESL NOT = ZEROS
  8574        MOVE COPIESI             TO LA-NO-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL152.cbl
  8575     ELSE
  8576        MOVE  1                  TO LA-NO-OF-COPIES.
  8577
  8578     IF RESENDL NOT = ZEROS
  8579        MOVE RESEND-SAVE         TO LA-RESEND-DATE
  8580     ELSE
  8581        MOVE LOW-VALUES          TO LA-RESEND-DATE.
  8582
  8583     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
  8584     MOVE CURRENT-SAVE           TO LA-CREATION-DT.
  8585
  8586     IF PRINT-PERFORMED
  8587        MOVE CURRENT-SAVE        TO LA-INITIAL-PRINT-DATE
  8588     ELSE
  8589        MOVE LOW-VALUES          TO LA-INITIAL-PRINT-DATE.
  8590
  8591     MOVE LOW-VALUES             TO LA-RESEND-PRINT-DATE.
  8592     MOVE CORR-TRLR-SEQ          TO LA-CORR-TRLR-SEQ.
  8593     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8594
  8595     IF PI-PROMPT-LETTER NOT EQUAL 'Y'
  8596         PERFORM 6700-BUILD-NAPERSOFT THRU 6799-EXIT
  8597     END-IF.
  8598
  8599     IF WS-LABELS-SW = 'N'
  8600         NEXT SENTENCE
  8601     ELSE
  8602         SET TB-INDX TO 1
  8603         MOVE ZEROS                  TO SEQ-COUNTER
  8604         PERFORM 6480-FORMAT-ADDRESS
  8605               VARYING TB-INDX FROM 1 BY 1 UNTIL
  8606               TB-INDX > 6.
  8607
  8608     MOVE ZEROS                  TO SEQ-COUNTER.
  8609     MOVE 'N'                    TO WS-SKIP-EMAIL
  8610     PERFORM 6470-FORMAT-TEXT THRU 6479-EXIT
  8611             VARYING TB-INDX FROM 8 BY 1
  8612             UNTIL TB-INDX > PI-TOTAL-LINES.
  8613     MOVE 'Y'                    TO WS-SKIP-EMAIL.
  8614     IF SEQ-COUNTER < +15
  8615      AND WS-SKIP-EMAIL EQUAL 'N'
  8616        MOVE ARCH-NUMBER         TO TRAN-DL2-ARCHNO
  8617        MOVE PI-PROCESSOR-ID     TO TRAN-DL2-USER
  8618        MOVE SPACES              TO TRAN-DL2-CCC
  8619        STRING PI-CARRIER ' ' PI-CLAIM-NO ' ' PI-CERT-NO
  8620           DELIMITED BY SIZE
  8621           INTO TRAN-DL2-CCC
  8622        END-STRING
  8623
  8624* EXEC CICS WRITEQ TD
  8625*          QUEUE ('BTCH')
  8626*          FROM (TRAN-DATA-LINE1)
  8627*          LENGTH (80)
  8628*       END-EXEC
  8629     MOVE 80
  8630       TO DFHEIV11
  8631     MOVE 'BTCH' TO DFHEIV5
  8632*    MOVE '(" L                  &   #00008333' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL152.cbl
  8633     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8634     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8635     MOVE X'2020233030303038333333' TO DFHEIV0(25:11)
  8636     CALL 'kxdfhei1' USING DFHEIV0,
  8637           DFHEIV5,
  8638           TRAN-DATA-LINE1,
  8639           DFHEIV11,
  8640           DFHEIV99,
  8641           DFHEIV99
  8642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8643
  8644* EXEC CICS WRITEQ TD
  8645*          QUEUE ('BTCH')
  8646*          FROM (TRAN-DATA-LINE2)
  8647*          LENGTH (80)
  8648*       END-EXEC
  8649     MOVE 80
  8650       TO DFHEIV11
  8651     MOVE 'BTCH' TO DFHEIV5
  8652*    MOVE '(" L                  &   #00008338' TO DFHEIV0
  8653     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8654     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8655     MOVE X'2020233030303038333338' TO DFHEIV0(25:11)
  8656     CALL 'kxdfhei1' USING DFHEIV0,
  8657           DFHEIV5,
  8658           TRAN-DATA-LINE2,
  8659           DFHEIV11,
  8660           DFHEIV99,
  8661           DFHEIV99
  8662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8663
  8664* EXEC CICS WRITEQ TD
  8665*          QUEUE ('BTCH')
  8666*          FROM (TRAN-DATA-LINE3)
  8667*          LENGTH (80)
  8668*       END-EXEC
  8669     MOVE 80
  8670       TO DFHEIV11
  8671     MOVE 'BTCH' TO DFHEIV5
  8672*    MOVE '(" L                  &   #00008343' TO DFHEIV0
  8673     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8674     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8675     MOVE X'2020233030303038333433' TO DFHEIV0(25:11)
  8676     CALL 'kxdfhei1' USING DFHEIV0,
  8677           DFHEIV5,
  8678           TRAN-DATA-LINE3,
  8679           DFHEIV11,
  8680           DFHEIV99,
  8681           DFHEIV99
  8682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8683     END-IF
  8684     MOVE ER-0280                TO EMI-ERROR.
  8685
  8686     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8687     MOVE ARCH-NUMBER            TO ARCH-SUPPRESS
  8688     MOVE ARCH-EDIT              TO EMI-TEXT-VARIABLE (1).
  8689
  8690     GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL152.cbl
  8691
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL152.cbl
  8693 6470-FORMAT-TEXT.
  8694
  8695     IF REC-TEXT (TB-INDX) (1:16) = NAPERSOFT-LETTER
  8696         MOVE 'Y'                TO WS-SKIP-EMAIL
  8697     END-IF.
  8698
  8699     MOVE SPACES                 TO LETTER-ARCHIVE.
  8700     MOVE '3'                    TO LA-RECORD-TYPE
  8701                                    LA-RECORD-TYPE-A1.
  8702     MOVE 'LA'                   TO LA-RECORD-ID.
  8703     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8704                                    LA-ARCHIVE-NO-A1.
  8705     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8706                                    LA-LINE-SEQ-NO-A1.
  8707     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8708                                    LA-COMPANY-CD-A1.
  8709     MOVE REC-TEXT (TB-INDX)     TO LA-TEXT-LINE.
  8710     SET TB-INDX1 TO TB-INDX.
  8711     SET TB-INDX1 UP BY 1.
  8712     MOVE ZEROS                  TO INDX-WORK.
  8713
  8714 6472-LOOP.
  8715     IF TB-INDX1 < PI-TOTAL-LINES AND
  8716        REC-TEXT (TB-INDX1) = SPACES
  8717           SET TB-INDX1 UP BY 1
  8718           ADD 1                 TO INDX-WORK
  8719           GO TO 6472-LOOP.
  8720
  8721     IF REC-TEXT (TB-INDX1) = TOP-FORM
  8722        MOVE '99'                TO LA-SKIP-CONTROL
  8723        SET TB-INDX1 UP BY 1
  8724     ELSE
  8725        MOVE INDX-WORK           TO LA-SKIP-CONTROL.
  8726
  8727     SET TB-INDX TO TB-INDX1.
  8728     SET TB-INDX DOWN BY 1.
  8729     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8730     ADD 1 TO SEQ-COUNTER.
  8731
  8732 6479-EXIT.
  8733      EXIT.
  8734
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL152.cbl
  8736 6480-FORMAT-ADDRESS.
  8737     MOVE SPACES                 TO LETTER-ARCHIVE.
  8738     MOVE '2'                    TO LA-RECORD-TYPE
  8739                                    LA-RECORD-TYPE-A1.
  8740     MOVE 'LA'                   TO LA-RECORD-ID.
  8741     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8742                                    LA-ARCHIVE-NO-A1.
  8743     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8744                                    LA-LINE-SEQ-NO-A1.
  8745     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8746                                    LA-COMPANY-CD-A1.
  8747     MOVE REC-TEXT (TB-INDX)     TO LA-ADDRESS-LINE.
  8748
  8749     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8750     ADD 1 TO SEQ-COUNTER.
  8751
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL152.cbl
  8753 6490-WRITE-ARCHIVE.
  8754
  8755* EXEC CICS HANDLE CONDITION
  8756*        DUPKEY    (6499-EXIT)
  8757*    END-EXEC.
  8758*    MOVE '"$$                   ! * #00008419' TO DFHEIV0
  8759     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8761     MOVE X'2A20233030303038343139' TO DFHEIV0(25:11)
  8762     CALL 'kxdfhei1' USING DFHEIV0
  8763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8764
  8765
  8766*    IF PI-COMPANY-ID = 'DMD'
  8767*        MOVE LETTER-ARCHIVE     TO LETTER-ARCHIVE-TEMP
  8768*        MOVE 'LT'               TO LT-RECORD-ID
  8769*        EXEC CICS WRITE
  8770*            DATASET   (ARCT-ID)
  8771*            FROM      (LETTER-ARCHIVE-TEMP)
  8772*            RIDFLD    (LT-CONTROL-PRIMARY)
  8773*        END-EXEC.
  8774
  8775
  8776* EXEC CICS WRITE
  8777*         DATASET   (ARCH-ID)
  8778*         FROM      (LETTER-ARCHIVE)
  8779*         RIDFLD    (LA-CONTROL-PRIMARY)
  8780*    END-EXEC.
  8781     MOVE LENGTH OF
  8782      LETTER-ARCHIVE
  8783       TO DFHEIV11
  8784*    MOVE '&$ L                  ''   #00008432' TO DFHEIV0
  8785     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8786     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8787     MOVE X'2020233030303038343332' TO DFHEIV0(25:11)
  8788     CALL 'kxdfhei1' USING DFHEIV0,
  8789           ARCH-ID,
  8790           LETTER-ARCHIVE,
  8791           DFHEIV11,
  8792           LA-CONTROL-PRIMARY,
  8793           DFHEIV99,
  8794           DFHEIV99
  8795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8796
  8797
  8798 6499-EXIT.
  8799     EXIT.
  8800
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL152.cbl
  8802 6500-BUILD-CORRESPOND.
  8803***************************************************************
  8804*    THIS ROUTINE WILL GET THE TRAILER SEQUENCE NUMBER FROM   *
  8805*    THE CLAIM MASTER AND BUILD A CORRESPONDENCE TRAILER      *
  8806*    USING THE NEW SEQUENCE NUMBER.                           *
  8807*    INPUT DATA FROM THE SCREEN IS USED TO CREATE THE NEW     *
  8808*    TRAILER RECORD.                                          *
  8809***************************************************************
  8810
  8811     MOVE PI-CLAIM-NO            TO CLAM-CLAIM.
  8812
  8813
  8814* EXEC CICS READ
  8815*         DATASET    (CLAM-ID)
  8816*         SET        (ADDRESS OF CLAIM-MASTER)
  8817*         RIDFLD     (CLAM-KEY)
  8818*         UPDATE
  8819*    END-EXEC.
  8820*    MOVE '&"S        EU         (   #00008453' TO DFHEIV0
  8821     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8822     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8823     MOVE X'2020233030303038343533' TO DFHEIV0(25:11)
  8824     CALL 'kxdfhei1' USING DFHEIV0,
  8825           CLAM-ID,
  8826           DFHEIV20,
  8827           DFHEIV99,
  8828           CLAM-KEY,
  8829           DFHEIV99,
  8830           DFHEIV99,
  8831           DFHEIV99
  8832     SET ADDRESS OF CLAIM-MASTER TO
  8833         DFHEIV20
  8834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8835
  8836
  8837     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  8838
  8839     IF FOLLOW-UP-SAVE > CL-NEXT-FOLLOWUP-DT
  8840        MOVE FOLLOW-UP-SAVE      TO CL-NEXT-FOLLOWUP-DT.
  8841
  8842     IF RESEND-SAVE > CL-NEXT-FOLLOWUP-DT
  8843        MOVE RESEND-SAVE         TO CL-NEXT-FOLLOWUP-DT.
  8844
  8845     IF MAINTI = 'C'
  8846        MOVE '2'                 TO CL-LAST-MAINT-TYPE.
  8847
  8848     IF MAINTI = 'R'
  8849        PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT
  8850        MOVE ACTV-SEQ            TO PI-ADDR-SEQ.
  8851
  8852*    IF PI-COMPANY-ID = 'DMD'
  8853*        MOVE 04                 TO CL-ACTIVITY-CODE.
  8854
  8855
  8856* EXEC CICS GETMAIN
  8857*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8858*         INITIMG   (GETMAIN-SPACE)
  8859*         LENGTH    (ACTV-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL152.cbl
  8860*    END-EXEC.
  8861*    MOVE ',"IL                  $   #00008478' TO DFHEIV0
  8862     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8863     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8864     MOVE X'2020233030303038343738' TO DFHEIV0(25:11)
  8865     CALL 'kxdfhei1' USING DFHEIV0,
  8866           DFHEIV20,
  8867           ACTV-LENGTH,
  8868           GETMAIN-SPACE
  8869     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8870         DFHEIV20
  8871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8872
  8873
  8874     MOVE 'AT'                   TO AT-RECORD-ID.
  8875     MOVE  4                     TO AT-TRAILER-TYPE.
  8876     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  8877                                    CL-LAST-MAINT-DT
  8878                                    AT-CORR-LAST-MAINT-DT
  8879     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  8880                                    CL-LAST-MAINT-USER
  8881                                    AT-CORR-LAST-UPDATED-BY
  8882     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  8883                                    CL-LAST-MAINT-HHMMSS.
  8884     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  8885     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  8886     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  8887                                    CORR-TRLR-SEQ.
  8888     MOVE CURRENT-SAVE           TO AT-LETTER-SENT-DT.
  8889     MOVE FOLLOW-UP-SAVE         TO AT-RECEIPT-FOLLOW-UP.
  8890     MOVE RESEND-SAVE            TO AT-AUTO-RE-SEND-DT.
  8891     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  8892                                    AT-LETTER-PURGED-DT.
  8893     MOVE ARCH-NUMBER            TO AT-LETTER-ARCHIVE-NO.
  8894     MOVE '1'                    TO AT-LETTER-ORIGIN.
  8895     MOVE PI-RESEND-FORM-NUMBER  TO AT-RESEND-LETTER-FORM.
  8896     MOVE PI-AUTO-CLOSE-IND      TO AT-AUTO-CLOSE-IND.
  8897     MOVE PI-LETTER-TO-BENE      TO AT-LETTER-TO-BENE.
  8898
  8899*    IF PI-COMPANY-ID = 'DMD'
  8900*        MOVE '1'                TO AT-DMD-LETTER-STATUS
  8901*        IF PI-BSR-AUTOMATED
  8902*            MOVE 'A'            TO AT-DMD-BSR-CODE.
  8903*
  8904     IF FORML  NOT = ZEROS
  8905        MOVE FORMI               TO AT-STD-LETTER-FORM
  8906     ELSE
  8907        MOVE SPACES              TO AT-STD-LETTER-FORM.
  8908
  8909     IF REL NOT = ZEROS
  8910        MOVE REI                 TO AT-REASON-TEXT
  8911     ELSE
  8912        MOVE SPACES              TO AT-REASON-TEXT.
  8913
  8914*    IF PI-COMPANY-ID = 'HAN'  OR  'JHL'
  8915*        MOVE AT-REASON-TEXT     TO WS-REASON-TEXT
  8916*        IF WS-RE-NDX NUMERIC  AND
  8917*           WS-RE-NDX > ZERO   AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL152.cbl
  8918*           WS-RE-NDX < 33
  8919*            MOVE HAN-REASON-TEXT (WS-RE-NDX)
  8920*                                TO AT-REASON-TEXT.
  8921
  8922     MOVE PI-ADDR-SEQ            TO AT-ADDRESS-REC-SEQ-NO.
  8923
  8924     IF PI-ADDR-TYPE > SPACES
  8925         MOVE PI-ADDR-TYPE          TO AT-ADDRESEE-TYPE
  8926         MOVE REC-TEXT (1)          TO AT-ADDRESSEE-NAME
  8927     ELSE
  8928     IF W-ACCOUNT > ZEROS
  8929         MOVE 'A'                   TO AT-ADDRESEE-TYPE
  8930         MOVE SS06D                 TO AT-ADDRESSEE-NAME
  8931     ELSE
  8932     IF W-BENEFICIARY > ZEROS
  8933          MOVE 'B'                  TO AT-ADDRESEE-TYPE
  8934          IF W-BENEFICIARY = 9
  8935              MOVE SS61D            TO AT-ADDRESSEE-NAME
  8936            ELSE
  8937              MOVE SS43D            TO AT-ADDRESSEE-NAME
  8938     ELSE
  8939     IF W-EMPLOYER > ZEROS
  8940          MOVE 'E'                  TO AT-ADDRESEE-TYPE
  8941          MOVE SS48D                TO AT-ADDRESSEE-NAME
  8942     ELSE
  8943     IF W-INSURED > ZEROS
  8944          MOVE 'I'                  TO AT-ADDRESEE-TYPE
  8945          MOVE SS57D                TO AT-ADDRESSEE-NAME
  8946     ELSE
  8947     IF W-PHYSICIAN > ZEROS
  8948          MOVE 'P'                  TO AT-ADDRESEE-TYPE
  8949          MOVE SS47D                TO AT-ADDRESSEE-NAME
  8950     ELSE
  8951     IF W-OTHER-1 > ZEROS
  8952          MOVE 'O'                  TO AT-ADDRESEE-TYPE
  8953          MOVE SS49D                TO AT-ADDRESSEE-NAME
  8954     ELSE
  8955     IF W-OTHER-2 > ZEROS
  8956          MOVE 'Q'                  TO AT-ADDRESEE-TYPE
  8957          MOVE SS50D                TO AT-ADDRESSEE-NAME
  8958     ELSE
  8959          MOVE SPACES               TO AT-ADDRESEE-TYPE
  8960                                       AT-ADDRESSEE-NAME.
  8961     IF PRINT-PERFORMED
  8962        MOVE CURRENT-SAVE        TO AT-INITIAL-PRINT-DATE
  8963     ELSE
  8964        MOVE LOW-VALUES          TO AT-INITIAL-PRINT-DATE.
  8965
  8966     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE.
  8967
  8968*    IF PI-COMPANY-ID = 'DMD'
  8969*        MOVE CL-CERT-STATE          TO WS-DMD-CERT-STATE
  8970*        MOVE CL-CERT-GROUPING (5:2) TO WS-DMD-CERT-GROUPING
  8971*        MOVE BEN-HOLD               TO WS-DMD-BEN-CODE
  8972*        MOVE AT-SEQUENCE-NO         TO WS-DMD-CORR-TRLR-SEQ
  8973*        MOVE AT-STD-LETTER-FORM     TO WS-DMD-LETTER-FORM.
  8974
  8975
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL152.cbl
  8976* EXEC CICS WRITE
  8977*         DATASET    (ACTV-ID)
  8978*         FROM       (ACTIVITY-TRAILERS)
  8979*         RIDFLD     (AT-CONTROL-PRIMARY)
  8980*    END-EXEC.
  8981     MOVE LENGTH OF
  8982      ACTIVITY-TRAILERS
  8983       TO DFHEIV11
  8984*    MOVE '&$ L                  ''   #00008585' TO DFHEIV0
  8985     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8987     MOVE X'2020233030303038353835' TO DFHEIV0(25:11)
  8988     CALL 'kxdfhei1' USING DFHEIV0,
  8989           ACTV-ID,
  8990           ACTIVITY-TRAILERS,
  8991           DFHEIV11,
  8992           AT-CONTROL-PRIMARY,
  8993           DFHEIV99,
  8994           DFHEIV99
  8995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8996
  8997
  8998
  8999* EXEC CICS HANDLE CONDITION
  9000*        DUPKEY      (6599-EXIT)
  9001*    END-EXEC.
  9002*    MOVE '"$$                   ! + #00008591' TO DFHEIV0
  9003     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9005     MOVE X'2B20233030303038353931' TO DFHEIV0(25:11)
  9006     CALL 'kxdfhei1' USING DFHEIV0
  9007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9008
  9009
  9010
  9011* EXEC CICS REWRITE
  9012*         DATASET    (CLAM-ID)
  9013*         FROM       (CLAIM-MASTER)
  9014*    END-EXEC.
  9015     MOVE LENGTH OF
  9016      CLAIM-MASTER
  9017       TO DFHEIV11
  9018*    MOVE '&& L                  %   #00008595' TO DFHEIV0
  9019     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9020     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9021     MOVE X'2020233030303038353935' TO DFHEIV0(25:11)
  9022     CALL 'kxdfhei1' USING DFHEIV0,
  9023           CLAM-ID,
  9024           CLAIM-MASTER,
  9025           DFHEIV11,
  9026           DFHEIV99
  9027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9028
  9029
  9030 6599-EXIT.
  9031      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL152.cbl
  9033 6600-SET-ADDR-SEQ.
  9034     IF ADDRL = ZEROS
  9035        GO TO 6699-EXIT.
  9036
  9037     MOVE ADDRI                  TO PI-ADDR-TYPE
  9038                                    WS-ADDR-TYPE-CD.
  9039     IF WS-ADDR-SEQ NOT NUMERIC
  9040        GO TO 6699-EXIT.
  9041
  9042     MOVE ZEROS                  TO PI-ADDR-SEQ.
  9043
  9044     IF WS-ADDR-TYPE = 'I'
  9045        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9046     ELSE
  9047     IF WS-ADDR-TYPE = 'A'
  9048        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9049        ADD +20                  TO ACTV-SEQ
  9050     ELSE
  9051     IF WS-ADDR-TYPE = 'B'
  9052        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9053        ADD +10                  TO ACTV-SEQ
  9054     ELSE
  9055     IF WS-ADDR-TYPE = 'P'
  9056        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9057        ADD +30                  TO ACTV-SEQ
  9058     ELSE
  9059     IF WS-ADDR-TYPE = 'E'
  9060        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9061        ADD +40                  TO ACTV-SEQ
  9062     ELSE
  9063     IF WS-ADDR-TYPE = 'O'
  9064        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9065        ADD +50                  TO ACTV-SEQ
  9066     ELSE
  9067     IF WS-ADDR-TYPE = 'Q'
  9068        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9069        ADD +60                  TO ACTV-SEQ.
  9070
  9071 6699-EXIT.
  9072      EXIT.
  9073
  9074 6700-BUILD-NAPERSOFT.
  9075
  9076
  9077* EXEC CICS GETMAIN
  9078*         SET      (ADDRESS OF NAPERSOFT-FILE)
  9079*         LENGTH   (NAPS-LENGTH)
  9080*    END-EXEC.
  9081*    MOVE '," L                  $   #00008646' TO DFHEIV0
  9082     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9083     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9084     MOVE X'2020233030303038363436' TO DFHEIV0(25:11)
  9085     CALL 'kxdfhei1' USING DFHEIV0,
  9086           DFHEIV20,
  9087           NAPS-LENGTH,
  9088           DFHEIV99
  9089     SET ADDRESS OF NAPERSOFT-FILE TO
  9090         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL152.cbl
  9091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9092
  9093
  9094     MOVE LOW-VALUES            TO  NAPERSOFT-FILE.
  9095     MOVE 'NA'                  TO  NA-RECORD-ID.
  9096     MOVE PI-COMPANY-CD         TO  NA-COMPANY-CD.
  9097     MOVE PI-CARRIER            TO  NA-CARRIER.
  9098     MOVE PI-CLAIM-NO           TO  NA-CLAIM-NO.
  9099     MOVE PI-CERT-NO            TO  NA-CERT-NO.
  9100     MOVE ARCH-NUMBER           TO  NA-ARCHIVE-NO.
  9101     MOVE FORMI                 TO  NA-LETTER-ID.
  9102     MOVE PI-PROCESSOR-ID       TO  NA-PROCESSOR-ID.
  9103     MOVE CURRENT-SAVE          TO  NA-CREATION-DT.
  9104     IF PRINT-PERFORMED
  9105         MOVE CURRENT-SAVE      TO  NA-INITIAL-PRINT-DT
  9106     ELSE
  9107         MOVE LOW-VALUES        TO  NA-INITIAL-PRINT-DT
  9108     END-IF.
  9109     MOVE FOLLOW-UP-SAVE        TO  NA-FOLLOW-UP-DT.
  9110     MOVE RESEND-SAVE           TO  NA-RESEND-DT
  9111     MOVE PI-RESEND-FORM-NUMBER TO  NA-RESEND-LETTER-ID.
  9112     IF COPIESL NOT = ZEROS
  9113         MOVE COPIESI           TO  NA-NO-OF-COPIES
  9114     ELSE
  9115         MOVE 1                 TO  NA-NO-OF-COPIES
  9116     END-IF.
  9117     IF PI-LETTER-ADDRESS-TYPE = ' 0'
  9118         MOVE LOW-VALUES        TO  NA-ADDRESS-TYPE
  9119     ELSE
  9120         MOVE PI-LETTER-ADDRESS-TYPE TO NA-ADDRESS-TYPE
  9121     END-IF.
  9122     MOVE CORR-TRLR-SEQ         TO  NA-CORR-TRLR-SEQ.
  9123     MOVE PI-ENCLOSURE-CD       TO  NA-ENCLOSURE-CD.
  9124
  9125
  9126* EXEC CICS WRITE
  9127*         DATASET    (NAPS-ID)
  9128*         FROM       (NAPERSOFT-FILE)
  9129*         RIDFLD     (NA-CONTROL-PRIMARY)
  9130*    END-EXEC.
  9131     MOVE LENGTH OF
  9132      NAPERSOFT-FILE
  9133       TO DFHEIV11
  9134*    MOVE '&$ L                  ''   #00008682' TO DFHEIV0
  9135     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9136     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9137     MOVE X'2020233030303038363832' TO DFHEIV0(25:11)
  9138     CALL 'kxdfhei1' USING DFHEIV0,
  9139           NAPS-ID,
  9140           NAPERSOFT-FILE,
  9141           DFHEIV11,
  9142           NA-CONTROL-PRIMARY,
  9143           DFHEIV99,
  9144           DFHEIV99
  9145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9146
  9147
  9148 6799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL152.cbl
  9149      EXIT.
  9150
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL152.cbl
  9152 7000-READ-ADDR.
  9153     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  9154        IF ADDRL = ZEROS
  9155           GO TO 7099-EXIT
  9156        ELSE
  9157           MOVE ER-0374             TO EMI-ERROR
  9158           MOVE -1                  TO ADDRL
  9159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9160           GO TO 7099-EXIT.
  9161
  9162     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  9163                                    ACTV-CLAIM.
  9164
  9165
  9166* EXEC CICS HANDLE CONDITION
  9167*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  9168*         NOTFND     (7090-CLAIM-NOT-FOUND)
  9169*     END-EXEC.
  9170*    MOVE '"$JI                  ! , #00008705' TO DFHEIV0
  9171     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9173     MOVE X'2C20233030303038373035' TO DFHEIV0(25:11)
  9174     CALL 'kxdfhei1' USING DFHEIV0
  9175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9176
  9177
  9178
  9179* EXEC CICS READ
  9180*         DATASET    (CLAM-ID)
  9181*         SET        (ADDRESS OF CLAIM-MASTER)
  9182*         RIDFLD     (CLAM-KEY)
  9183*    END-EXEC.
  9184*    MOVE '&"S        E          (   #00008710' TO DFHEIV0
  9185     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9186     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9187     MOVE X'2020233030303038373130' TO DFHEIV0(25:11)
  9188     CALL 'kxdfhei1' USING DFHEIV0,
  9189           CLAM-ID,
  9190           DFHEIV20,
  9191           DFHEIV99,
  9192           CLAM-KEY,
  9193           DFHEIV99,
  9194           DFHEIV99,
  9195           DFHEIV99
  9196     SET ADDRESS OF CLAIM-MASTER TO
  9197         DFHEIV20
  9198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9199
  9200
  9201*    IF PI-COMPANY-ID = 'DMD'
  9202*            AND
  9203*       NOT SYSTEM-MODIFY-CAP
  9204*            AND
  9205*        HIGHEST-PRIORITY
  9206*        IF MAINTI = 'R'
  9207*            MOVE ER-0909        TO EMI-ERROR
  9208*            MOVE -1             TO ADDRL
  9209*            MOVE AL-UABON       TO ADDRA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL152.cbl
  9210*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9211*            GO TO 8200-SEND-DATAONLY
  9212*        ELSE
  9213*            MOVE ER-0900        TO EMI-ERROR
  9214*            MOVE -1             TO ADDRL
  9215*            MOVE AL-UABON       TO ADDRA
  9216*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9217*            GO TO 8200-SEND-DATAONLY.
  9218
  9219     IF ADDRL = ZEROS
  9220        GO TO 7099-EXIT.
  9221
  9222*    IF PI-COMPANY-ID = 'DMD'
  9223*        IF MAINTI = 'C'
  9224*           IF CL-BENEFICIARY = '0000B0CA10' OR '0000B0CAN0' OR
  9225*                               '0000B0CAS0' OR '0000B0CA50' OR
  9226*                               '0000B0CAA0' OR '0000B0CAB0' OR
  9227*                               '0000B0CAC0' OR '0000B0CAD0' OR
  9228*                               '0000B0CO20' OR '0000B0MN10' OR
  9229*                               '0000B0MN20' OR '0000B0MN30' OR
  9230*                               '0000B0MN40' OR '0000B0MN50' OR
  9231*                               '0000B0MN60' OR '0000B0MN70'
  9232*           IF ADDRI(1:1) = 'B'
  9233*              MOVE ER-8158     TO EMI-ERROR
  9234*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9235*              MOVE -1          TO MAINTL
  9236*              GO TO 8200-SEND-DATAONLY.
  9237*
  9238*    IF PI-COMPANY-ID = 'DMD'
  9239*      PERFORM 4000-SET-BSR THRU 4000-EXIT
  9240*      IF PI-BSR-AUTOMATED
  9241*        IF MAINTI = 'C'
  9242*           MOVE ER-7843          TO EMI-ERROR
  9243*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9244*           MOVE -1               TO MAINTL
  9245*           GO TO 8200-SEND-DATAONLY.
  9246
  9247     PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT.
  9248
  9249     MOVE ADDRI TO WS-ADDR-TYPE-CD.
  9250
  9251*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9252*        GO TO 7040-READ-PRODUCER.
  9253
  9254 7010-READ-ACCT.
  9255
  9256     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9257     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9258     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9259     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DATE.
  9260
  9261
  9262* EXEC CICS HANDLE CONDITION
  9263*         NOTOPEN    (8880-ACCT-NOT-OPEN)
  9264*         NOTFND     (7080-ACCT-NOT-FOUND)
  9265*    END-EXEC.
  9266*    MOVE '"$JI                  ! - #00008776' TO DFHEIV0
  9267     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL152.cbl
  9268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9269     MOVE X'2D20233030303038373736' TO DFHEIV0(25:11)
  9270     CALL 'kxdfhei1' USING DFHEIV0
  9271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9272
  9273
  9274     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
  9275
  9276     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  9277
  9278 7020-READNEXT.
  9279
  9280     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
  9281
  9282     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  9283        IF WS-SAVE-ACCT-RECORD = SPACES
  9284            GO TO 7080-ACCT-NOT-FOUND
  9285        ELSE
  9286            MOVE 'Y'                 TO  WS-ACCT-READ-SW
  9287            MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
  9288            MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
  9289            GO TO 7030-CONTINUE-BUILD-ADDR.
  9290
  9291     IF AM-EXPIRATION-DT = HIGH-VALUES
  9292         NEXT SENTENCE
  9293     ELSE
  9294         MOVE ACCOUNT-MASTER         TO  WS-SAVE-ACCT-RECORD
  9295         GO TO 7020-READNEXT.
  9296
  9297     MOVE AM-CONTROL-PRIMARY TO ACCT-KEY.
  9298     MOVE 'Y'                TO WS-ACCT-READ-SW.
  9299
  9300 7030-CONTINUE-BUILD-ADDR.
  9301
  9302     MOVE SPACES             TO  WS-SAVE-ACCT-RECORD.
  9303
  9304     IF WS-ADDR-TYPE-CD = 'A0'
  9305        MOVE ZEROS               TO PI-ADDR-SEQ
  9306     ELSE
  9307        GO TO 7067-CHECK-BENE-ADDR.
  9308
  9309     MOVE SPACES             TO               WS-LABEL-HOLD-AREA.
  9310     MOVE AM-NAME            TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9311     MOVE AM-PERSON          TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9312     MOVE AM-ADDRS           TO  REC-TEXT (3) WS-LABEL-LINES (3).
  9313*    MOVE AM-CITY            TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9314     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
  9315        INTO WS-LABEL-LINES (4)
  9316     END-STRING
  9317     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9318     MOVE SPACES             TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9319
  9320     MOVE SPACES             TO  WS-ZIP-CODE.
  9321
  9322     IF AM-CANADIAN-POST-CODE
  9323         MOVE AM-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9324         MOVE AM-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9325     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL152.cbl
  9326         MOVE AM-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9327         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9328             MOVE '-'            TO  WS-AM-ZIP-DASH
  9329             MOVE AM-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9330
  9331     MOVE WS-ZIP-CODE        TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9332
  9333     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9334
  9335     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9336     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9337     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9338     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9339     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9340     MOVE WS-LABEL-LINES (6) TO  REC-TEXT (6)    SS05-6D.
  9341
  9342     GO TO 7099-EXIT.
  9343
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL152.cbl
  9345*7040-READ-PRODUCER. Remove as dead code
  9346*7050-READNEXT. Remove as dead code
  9347*7060-CONTINUE-BUILD-ADDR. Remove as dead code
  9348 7067-CHECK-BENE-ADDR.
  9349
  9350*    IF PI-COMPANY-ID = 'DMD'
  9351*        IF WS-ADDR-TYPE-CD = 'B9'
  9352*            GO TO 7067-CHECK-BENE-ADDR-9.
  9353
  9354     IF WS-ADDR-TYPE-CD NOT = 'B0'
  9355         GO TO 7068-CONTINUE-BUILD-ADDR.
  9356
  9357     IF CL-BENEFICIARY = SPACES
  9358         GO TO 7070-ACTV-NOT-FOUND.
  9359
  9360
  9361* EXEC CICS HANDLE CONDITION
  9362*         NOTFND     (7070-ACTV-NOT-FOUND)
  9363*    END-EXEC.
  9364*    MOVE '"$I                   ! . #00008867' TO DFHEIV0
  9365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9367     MOVE X'2E20233030303038383637' TO DFHEIV0(25:11)
  9368     CALL 'kxdfhei1' USING DFHEIV0
  9369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9370
  9371
  9372     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9373     MOVE 'B'                    TO BENE-REC-TYPE.
  9374     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9375
  9376
  9377* EXEC CICS READ
  9378*         DATASET    (BENE-ID)
  9379*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9380*         RIDFLD     (BENE-KEY)
  9381*    END-EXEC.
  9382*    MOVE '&"S        E          (   #00008875' TO DFHEIV0
  9383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9385     MOVE X'2020233030303038383735' TO DFHEIV0(25:11)
  9386     CALL 'kxdfhei1' USING DFHEIV0,
  9387           BENE-ID,
  9388           DFHEIV20,
  9389           DFHEIV99,
  9390           BENE-KEY,
  9391           DFHEIV99,
  9392           DFHEIV99,
  9393           DFHEIV99
  9394     SET ADDRESS OF BENEFICIARY-MASTER TO
  9395         DFHEIV20
  9396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9397
  9398
  9399     MOVE SPACES              TO  WS-LABEL-HOLD-AREA.
  9400     MOVE BE-MAIL-TO-NAME     TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9401     MOVE BE-ADDRESS-LINE-1   TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9402     MOVE BE-ADDRESS-LINE-2   TO  REC-TEXT (3) WS-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL152.cbl
  9403     MOVE BE-ADDRESS-LINE-3   TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9404*    MOVE BE-CITY-STATE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9405     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
  9406        INTO WS-LABEL-LINES (5)
  9407     END-STRING
  9408     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9409
  9410     MOVE SPACES              TO  WS-ZIP-CODE.
  9411     IF BE-CANADIAN-POST-CODE
  9412         MOVE BE-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9413         MOVE BE-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9414     ELSE
  9415         MOVE BE-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9416         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9417             MOVE '-'            TO  WS-AM-ZIP-DASH
  9418             MOVE BE-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9419
  9420     MOVE WS-ZIP-CODE         TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9421
  9422     GO TO 7069-SET-ADDR.
  9423
  9424 7067-CHECK-BENE-ADDR-9.
  9425
  9426     IF CL-BENEFICIARY = SPACES
  9427         GO TO 7070-ACTV-NOT-FOUND.
  9428
  9429
  9430* EXEC CICS HANDLE CONDITION
  9431*         NOTFND     (7070-ACTV-NOT-FOUND)
  9432*    END-EXEC.
  9433*    MOVE '"$I                   ! / #00008911' TO DFHEIV0
  9434     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9436     MOVE X'2F20233030303038393131' TO DFHEIV0(25:11)
  9437     CALL 'kxdfhei1' USING DFHEIV0
  9438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9439
  9440
  9441     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9442     MOVE 'B'                    TO BENE-REC-TYPE.
  9443     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9444
  9445
  9446* EXEC CICS READ
  9447*         DATASET    (BENE-ID)
  9448*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9449*         RIDFLD     (BENE-KEY)
  9450*    END-EXEC.
  9451*    MOVE '&"S        E          (   #00008919' TO DFHEIV0
  9452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9454     MOVE X'2020233030303038393139' TO DFHEIV0(25:11)
  9455     CALL 'kxdfhei1' USING DFHEIV0,
  9456           BENE-ID,
  9457           DFHEIV20,
  9458           DFHEIV99,
  9459           BENE-KEY,
  9460           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL152.cbl
  9461           DFHEIV99,
  9462           DFHEIV99
  9463     SET ADDRESS OF BENEFICIARY-MASTER TO
  9464         DFHEIV20
  9465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9466
  9467
  9468     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
  9469     MOVE BE-MAIL-TO-NAME2       TO REC-TEXT (1)
  9470                                    WS-LABEL-LINES (1).
  9471     MOVE BE-ADDRESS-LINE-12     TO REC-TEXT (2)
  9472                                    WS-LABEL-LINES (2).
  9473     MOVE BE-ADDRESS-LINE-22     TO REC-TEXT (3)
  9474                                    WS-LABEL-LINES (3).
  9475     MOVE BE-ADDRESS-LINE-32     TO REC-TEXT (4)
  9476                                    WS-LABEL-LINES (4).
  9477*    MOVE BE-CITY-STATE2         TO REC-TEXT (5)
  9478*                                   WS-LABEL-LINES (5).
  9479     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
  9480        INTO WS-LABEL-LINES (5)
  9481     END-STRING
  9482     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9483
  9484     MOVE SPACES                 TO WS-ZIP-CODE.
  9485
  9486     IF BE-CANADIAN-POST-CODE2
  9487         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
  9488         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
  9489     ELSE
  9490         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
  9491         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
  9492             MOVE '-'            TO WS-AM-ZIP-DASH
  9493             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
  9494
  9495     MOVE WS-ZIP-CODE            TO REC-TEXT (6)
  9496                                    WS-LABEL-LINES (6).
  9497
  9498     GO TO 7069-SET-ADDR.
  9499
  9500 7068-CONTINUE-BUILD-ADDR.
  9501
  9502     IF ACTV-SEQ = ZEROS
  9503        GO TO 7070-ACTV-NOT-FOUND.
  9504
  9505     MOVE ACTV-SEQ               TO PI-ADDR-SEQ.
  9506
  9507
  9508* EXEC CICS HANDLE CONDITION
  9509*         NOTOPEN    (8870-ACTV-NOT-OPEN)
  9510*         NOTFND     (7070-ACTV-NOT-FOUND)
  9511*    END-EXEC.
  9512*    MOVE '"$JI                  ! 0 #00008964' TO DFHEIV0
  9513     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9515     MOVE X'3020233030303038393634' TO DFHEIV0(25:11)
  9516     CALL 'kxdfhei1' USING DFHEIV0
  9517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9518
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL152.cbl
  9519
  9520
  9521* EXEC CICS READ
  9522*         DATASET    (ACTV-ID)
  9523*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
  9524*         RIDFLD     (ACTV-KEY)
  9525*    END-EXEC.
  9526*    MOVE '&"S        E          (   #00008969' TO DFHEIV0
  9527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9529     MOVE X'2020233030303038393639' TO DFHEIV0(25:11)
  9530     CALL 'kxdfhei1' USING DFHEIV0,
  9531           ACTV-ID,
  9532           DFHEIV20,
  9533           DFHEIV99,
  9534           ACTV-KEY,
  9535           DFHEIV99,
  9536           DFHEIV99,
  9537           DFHEIV99
  9538     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9539         DFHEIV20
  9540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9541
  9542
  9543     MOVE SPACES            TO              WS-LABEL-HOLD-AREA.
  9544     MOVE AT-MAIL-TO-NAME   TO REC-TEXT (1) WS-LABEL-LINES (1).
  9545     MOVE AT-ADDRESS-LINE-1 TO REC-TEXT (2) WS-LABEL-LINES (2).
  9546     MOVE AT-ADDRESS-LINE-2 TO REC-TEXT (3) WS-LABEL-LINES (3).
  9547*    MOVE AT-CITY-STATE     TO REC-TEXT (4) WS-LABEL-LINES (4).
  9548     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
  9549        INTO WS-LABEL-LINES (4)
  9550     END-STRING
  9551     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9552
  9553     MOVE SPACES            TO  WS-ZIP-CODE.
  9554     IF AT-CANADIAN-POST-CODE
  9555         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9556         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9557     ELSE
  9558         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
  9559         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9560             MOVE '-'            TO  WS-AM-ZIP-DASH
  9561             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9562
  9563     MOVE WS-ZIP-CODE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9564
  9565     MOVE SPACES            TO  REC-TEXT (6).
  9566
  9567 7069-SET-ADDR.
  9568     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9569
  9570     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9571     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9572     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9573     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9574     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9575     MOVE SPACES             TO  REC-TEXT (6)    SS05-6D.
  9576
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL152.cbl
  9577     GO TO 7099-EXIT.
  9578
  9579 7070-ACTV-NOT-FOUND.
  9580
  9581     IF ACTV-SEQ NOT = +29
  9582        GO TO 7075-CONTINUE-ACTV-ERROR.
  9583
  9584*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9585*        GO TO 7099-EXIT.
  9586
  9587     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9588        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
  9589        GO TO 7075-CONTINUE-ACTV-ERROR.
  9590
  9591     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
  9592        GO TO 7075-CONTINUE-ACTV-ERROR.
  9593
  9594     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD
  9595     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER
  9596     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING
  9597     MOVE 'A'             TO WS-ERCOMP-TYPE
  9598     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9599                          TO WS-ERCOMP-RESP-NO.
  9600
  9601     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
  9602         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
  9603                                       'G' OR 'B'
  9604             MOVE 'G'            TO WS-ERCOMP-TYPE
  9605             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
  9606         ELSE
  9607             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9608                                 TO WS-ERCOMP-ACCOUNT
  9609     ELSE
  9610         MOVE 'G'                TO WS-ERCOMP-TYPE
  9611         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
  9612
  9613     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  9614        MOVE ZEROS TO WS-ERCOMP-CARRIER.
  9615
  9616     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  9617        MOVE ZEROS TO WS-ERCOMP-GROUPING.
  9618
  9619
  9620* EXEC CICS HANDLE CONDITION
  9621*         NOTFND    (7075-CONTINUE-ACTV-ERROR)
  9622*    END-EXEC.
  9623*    MOVE '"$I                   ! 1 #00009051' TO DFHEIV0
  9624     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9626     MOVE X'3120233030303039303531' TO DFHEIV0(25:11)
  9627     CALL 'kxdfhei1' USING DFHEIV0
  9628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9629
  9630
  9631
  9632* EXEC CICS  READ
  9633*         SET      (ADDRESS OF COMPENSATION-MASTER)
  9634*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL152.cbl
  9635*         RIDFLD   (WS-ERCOMP-KEY)
  9636*    END-EXEC.
  9637     MOVE 'ERCOMP' TO DFHEIV1
  9638*    MOVE '&"S        E          (   #00009055' TO DFHEIV0
  9639     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9641     MOVE X'2020233030303039303535' TO DFHEIV0(25:11)
  9642     CALL 'kxdfhei1' USING DFHEIV0,
  9643           DFHEIV1,
  9644           DFHEIV20,
  9645           DFHEIV99,
  9646           WS-ERCOMP-KEY,
  9647           DFHEIV99,
  9648           DFHEIV99,
  9649           DFHEIV99
  9650     SET ADDRESS OF COMPENSATION-MASTER TO
  9651         DFHEIV20
  9652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9653
  9654
  9655     MOVE 'Y'                   TO WS-COMP-READ-SW.
  9656     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
  9657     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
  9658
  9659     IF CO-ACCT-NAME = SPACES
  9660        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
  9661
  9662     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
  9663     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
  9664     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
  9665
  9666     MOVE SPACES                TO  WS-ZIP-CODE.
  9667     IF CO-CANADIAN-POST-CODE
  9668         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
  9669         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
  9670     ELSE
  9671         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
  9672         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9673             MOVE '-'           TO  WS-AM-ZIP-DASH
  9674             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
  9675
  9676     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
  9677
  9678     MOVE ZEROS                 TO WS-PHONE-IN.
  9679     MOVE CO-AREA-CODE          TO WSPO-AREA.
  9680     MOVE CO-PREFIX             TO WSPO-PFX.
  9681     MOVE CO-PHONE              TO WSPO-SFX.
  9682     MOVE WS-PHONE-OUT          TO SS53-6D.
  9683
  9684     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9685
  9686     MOVE WS-LABEL-LINES (1)     TO REC-TEXT (1)    SS52D.
  9687     MOVE WS-LABEL-LINES (2)     TO REC-TEXT (2)    SS53-1D.
  9688     MOVE WS-LABEL-LINES (3)     TO REC-TEXT (3)    SS53-2D.
  9689     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)    SS53-3D.
  9690     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)    SS53-4D.
  9691     MOVE WS-LABEL-LINES (6)     TO REC-TEXT (6)    SS53-5D.
  9692
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL152.cbl
  9693     GO TO 7099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL152.cbl
  9695
  9696 7075-CONTINUE-ACTV-ERROR.
  9697     MOVE ER-0178                TO EMI-ERROR.
  9698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9699     MOVE -1                     TO ADDRL.
  9700     MOVE AL-UABON               TO ADDRA.
  9701     MOVE SPACES                 TO PI-ADDR-TYPE.
  9702     MOVE SPACES                 TO REC-TEXT (1)
  9703                                    REC-TEXT (2)
  9704                                    REC-TEXT (3)
  9705                                    REC-TEXT (4)
  9706                                    REC-TEXT (5)
  9707                                    REC-TEXT (6).
  9708     GO TO 7099-EXIT.
  9709
  9710 7080-ACCT-NOT-FOUND.
  9711     MOVE ER-0179                TO EMI-ERROR.
  9712     MOVE -1                     TO ADDRL.
  9713     MOVE AL-UABON               TO ADDRA.
  9714     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9715     GO TO 8200-SEND-DATAONLY.
  9716
  9717 7090-CLAIM-NOT-FOUND.
  9718     MOVE ER-0186                TO EMI-ERROR.
  9719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9720     GO TO 8200-SEND-DATAONLY.
  9721
  9722*7095-PROD-NOT-FOUND. Remove as dead code
  9723
  9724 7099-EXIT.
  9725      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL152.cbl
  9727
  9728 7170-FORMAT-SCREEN.
  9729     IF MAINTI = 'S'
  9730        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  9731       ELSE
  9732        MOVE AL-UANOF            TO SC-TEXTA (SC-INDX).
  9733
  9734     IF TB-INDX < 7
  9735        SET LINE23 TO TB-INDX
  9736        MOVE 'A'                 TO LINE1
  9737       ELSE
  9738        IF TB-INDX = 7
  9739           MOVE ZEROS            TO LINE-NUM
  9740        ELSE
  9741           SET LIN-NUM TO TB-INDX
  9742           SUBTRACT 7            FROM LIN-NUM.
  9743
  9744     MOVE LINE-NUM               TO SC-LINE (SC-INDX).
  9745     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  9746     SET TB-INDX UP BY 1.
  9747
  9748 7170-EXIT.
  9749      EXIT.
  9750
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL152.cbl
  9752 7200-RESOLVE-VARIABLES.
  9753***************************************************************
  9754*    THIS ROUTINE WILL FORMAT THE SYSTEM-DEFINED SYMBOLS      *
  9755*    WITH DATA PERTAINING TO THE DESIGNATED CLAIM.            *
  9756*    THIS ROUTINE IS PERFORMED THRU 7269-EXIT TO              *
  9757*    RESOLVE ALL OF THE SYMBOLS.                              *
  9758***************************************************************
  9759
  9760*    IF PI-COMPANY-ID = 'AUK'
  9761*        MOVE 'Y'                TO W-REVERSE-DATE-SW.
  9762
  9763     MOVE PI-CLAIM-NO            TO SS34D.
  9764
  9765     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9766        MOVE PI-LIFE-OVERRIDE-L6 TO SS12D
  9767     ELSE
  9768        MOVE PI-AH-OVERRIDE-L6   TO SS12D.
  9769
  9770     MOVE CL-LAST-PMT-AMT        TO SS16D.
  9771     MOVE CL-TOTAL-PAID-AMT      TO SS18D.
  9772     MOVE CL-CAUSE-CD            TO SS19-1D.
  9773     MOVE CL-ASSOC-CERT-SEQU     TO SS54D.
  9774     MOVE CL-ASSOC-CERT-TOTAL    TO SS55D.
  9775
  9776*    IF PI-COMPANY-ID NOT = 'DMD'
  9777*        GO TO 7200-CONTINUE.
  9778
  9779     IF CL-CCN-PREFIX-A5 = '1111' OR '3333' OR '6666' OR
  9780                           '8888' OR '9876'
  9781         MOVE CL-CCN-PRIME-A5    TO WS-CCN-12
  9782         MOVE WS-CCN-12          TO CL-CCN.
  9783
  9784     IF CL-CERT-STATE NOT = '08' AND '09'
  9785         MOVE SPACES             TO SS62D
  9786                                    SS63D
  9787         GO TO 7200-CONTINUE.
  9788
  9789     MOVE WS-DMD-UND-STATEMENT   TO SS62D.
  9790
  9791     MOVE 'CL'                   TO DL23-SYSTEM-ID.
  9792     MOVE 'UN'                   TO DL23-RECORD-TYPE.
  9793     MOVE CL-CERT-STATE          TO DL23-RECORD-KEY.
  9794
  9795
  9796* EXEC CICS LINK
  9797*        PROGRAM    ('DLO023')
  9798*        COMMAREA   (WS-DLO-CODES-TABLE)
  9799*        LENGTH     (DL23-COMM-LENGTH)
  9800*    END-EXEC.
  9801     MOVE 'DLO023' TO DFHEIV1
  9802*    MOVE '."C                   ''   #00009201' TO DFHEIV0
  9803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9805     MOVE X'2020233030303039323031' TO DFHEIV0(25:11)
  9806     CALL 'kxdfhei1' USING DFHEIV0,
  9807           DFHEIV1,
  9808           WS-DLO-CODES-TABLE,
  9809           DL23-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL152.cbl
  9810           DFHEIV99,
  9811           DFHEIV99,
  9812           DFHEIV99
  9813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9814
  9815
  9816     IF DL23-RETURN-CODE = 'OK'
  9817         MOVE DL23-CODE-DESC     TO SS63D
  9818       ELSE
  9819         MOVE SPACES             TO SS63D.
  9820
  9821 7200-CONTINUE.
  9822     MOVE CL-CCN                 TO SS60D.
  9823
  9824     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  9825     MOVE SPACES                 TO DC-OPTION-CODE.
  9826     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9827     IF NO-CONVERSION-ERROR
  9828        MOVE DC-GREG-DATE-1-EDIT TO SS13D.
  9829
  9830     MOVE CL-REPORTED-DT         TO DC-BIN-DATE-1.
  9831     MOVE SPACES                 TO DC-OPTION-CODE.
  9832     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9833     IF NO-CONVERSION-ERROR
  9834        MOVE DC-GREG-DATE-1-EDIT TO SS14D.
  9835
  9836     MOVE CL-LAST-PMT-DT         TO DC-BIN-DATE-1.
  9837     MOVE SPACES                 TO DC-OPTION-CODE.
  9838     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9839     IF NO-CONVERSION-ERROR
  9840        MOVE DC-GREG-DATE-1-EDIT TO SS15D.
  9841
  9842     IF NOT PI-USES-PAID-TO
  9843        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9844        MOVE SPACES                 TO DC-OPTION-CODE
  9845        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9846        IF NO-CONVERSION-ERROR
  9847           MOVE DC-GREG-DATE-1-EDIT TO SS17D
  9848        ELSE
  9849           MOVE SPACES TO SS17D
  9850     ELSE
  9851        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9852        MOVE '6'                    TO DC-OPTION-CODE
  9853        MOVE +1                     TO DC-ELAPSED-DAYS
  9854        MOVE +0                     TO DC-ELAPSED-MONTHS
  9855        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9856        IF NO-CONVERSION-ERROR
  9857           MOVE DC-GREG-DATE-1-EDIT TO SS17D.
  9858
  9859     MOVE CL-INSURED-BIRTH-DT    TO DC-BIN-DATE-1.
  9860     MOVE SPACES                 TO DC-OPTION-CODE.
  9861     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9862     IF NO-CONVERSION-ERROR
  9863        MOVE DC-GREG-DATE-1-EDIT TO SS45D
  9864     ELSE
  9865        MOVE '@@DOB'             TO SS45D.
  9866
  9867     IF CL-SSN-STATE   = CL-CERT-STATE  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL152.cbl
  9868        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
  9869             NEXT SENTENCE
  9870         ELSE
  9871             MOVE CL-SOC-SEC-NO  TO SS46D.
  9872
  9873     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
  9874                                    ACCT-GROUPING
  9875                                    PROD-GROUPING
  9876                                    PLCY-GROUPING
  9877                                    PLAN-GROUPING.
  9878     MOVE CL-CERT-STATE          TO CERT-STATE
  9879                                    ACCT-STATE
  9880                                    PROD-STATE
  9881                                    PLCY-STATE
  9882                                    PLAN-STATE.
  9883     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9884                                    ACCT-ACCOUNT
  9885                                    PROD-PRODUCER
  9886                                    PLCY-PRODUCER
  9887                                    PLAN-PRODUCER.
  9888     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
  9889                                    PLCY-EFF-DT.
  9890     MOVE CL-CV-REFERENCE-NO     TO PLCY-REFERENCE-NO.
  9891
  9892     PERFORM 5000-MOVE-NAME THRU 5000-EXIT.
  9893
  9894*    IF PI-COMPANY-ID = 'DMD'
  9895*       MOVE WS-NAME-WORK           TO SS10D
  9896*       GO TO 7200-CONTINUE-2.
  9897
  9898     IF LOWER-CASE-LETTERS-USED
  9899        MOVE 'N'                    TO WS-STATE-LINE
  9900        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
  9901        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
  9902        MOVE WS-TEMP-AREA2          TO SS10D
  9903     ELSE
  9904        MOVE WS-NAME-WORK           TO SS10D.
  9905
  9906 7200-CONTINUE-2.
  9907     MOVE CL-INSURED-1ST-NAME     TO W-FIRST-NAME.
  9908     MOVE CL-INSURED-LAST-NAME    TO W-LAST-NAME.
  9909     MOVE CL-INSURED-MID-INIT     TO W-MIDDLE-NAME.
  9910     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9911
  9912     IF LOWER-CASE-LETTERS-USED
  9913        MOVE 'N'                    TO WS-STATE-LINE
  9914        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
  9915        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
  9916        MOVE WS-TEMP-AREA2          TO SS39D
  9917     ELSE
  9918        MOVE WS-NAME-WORK           TO SS39D.
  9919
  9920     MOVE CL-INSURED-LAST-NAME   TO SS40D.
  9921
  9922     IF INSURED-IS-FEMALE
  9923        MOVE 'MS.'               TO SS41D
  9924       ELSE
  9925        MOVE 'MR.'               TO SS41D.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL152.cbl
  9926
  9927*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9928*        PERFORM 7290-RESOLVE-CREDITOR THRU 7290-EXIT.
  9929
  9930*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9931*        GO TO 7200-READ-EMPLCY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL152.cbl
  9933
  9934* EXEC CICS HANDLE CONDITION
  9935*         NOTOPEN   (8900-CERT-NOT-OPEN)
  9936*         NOTFND    (8910-CERT-NOT-FOUND)
  9937*    END-EXEC.
  9938*    MOVE '"$JI                  ! 2 #00009324' TO DFHEIV0
  9939     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9941     MOVE X'3220233030303039333234' TO DFHEIV0(25:11)
  9942     CALL 'kxdfhei1' USING DFHEIV0
  9943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9944
  9945
  9946
  9947* EXEC CICS READ
  9948*         DATASET   (CERT-ID)
  9949*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9950*         RIDFLD    (CERT-KEY)
  9951*    END-EXEC.
  9952*    MOVE '&"S        E          (   #00009329' TO DFHEIV0
  9953     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9955     MOVE X'2020233030303039333239' TO DFHEIV0(25:11)
  9956     CALL 'kxdfhei1' USING DFHEIV0,
  9957           CERT-ID,
  9958           DFHEIV20,
  9959           DFHEIV99,
  9960           CERT-KEY,
  9961           DFHEIV99,
  9962           DFHEIV99,
  9963           DFHEIV99
  9964     SET ADDRESS OF CERTIFICATE-MASTER TO
  9965         DFHEIV20
  9966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9967
  9968
  9969*    IF PI-COMPANY-ID = 'DMD'
  9970*        MOVE CM-RESIDENT-STATE  TO WS-DMD-RES-ST
  9971*        IF CM-POLICY-FORM-NO(6:1) = '1'
  9972*            MOVE WS-DMD-UND-COMPANYA    TO SS64D
  9973*          ELSE
  9974*        IF CM-POLICY-FORM-NO(6:1) = '2'
  9975*            MOVE WS-DMD-UND-COMPANYB    TO SS64D
  9976*          ELSE
  9977*            MOVE SPACES                 TO SS64D.
  9978
  9979     MOVE CM-CERT-NO             TO SS26D.
  9980     MOVE CM-INSURED-ISSUE-AGE   TO SS33D.
  9981
  9982*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9983*        MOVE CL-CURRENT-CARRIER TO SS23D
  9984*        MOVE CL-CURRENT-GROUPING
  9985*                                TO SS24D
  9986*        MOVE CL-CURRENT-ACCOUNT TO SS25D
  9987*        MOVE CM-MEMBER-NO       TO SS36D
  9988*        MOVE CM-GROUPING        TO W-GROUPING
  9989*        IF W-GROUP-3 = 'C01' OR 'C02'
  9990*            MOVE CM-MEMBER-NO   TO W-CURRENT-LOAN-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL152.cbl
  9991*            MOVE CM-LOAN-NUMBER TO W-LOAN-NO
  9992*            MOVE W-CREDIT-CARD-LOAN-NO
  9993*                                TO SS36-1D
  9994*        ELSE
  9995*            MOVE CM-MEMBER-NO   TO SS36-1D
  9996*    ELSE
  9997         MOVE CM-CARRIER         TO SS23D.
  9998         MOVE CM-GROUPING        TO SS24D.
  9999         MOVE CM-ACCOUNT         TO SS25D.
 10000         MOVE CM-LOAN-NUMBER     TO SS36D.
 10001
 10002     MOVE CM-LOAN-BALANCE        TO SS37D.
 10003     MOVE CM-MEMBER-NO           TO SS38D.
 10004
 10005     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 10006     MOVE SPACES                 TO DC-OPTION-CODE.
 10007     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10008     IF NO-CONVERSION-ERROR
 10009        MOVE DC-GREG-DATE-1-EDIT TO SS27D.
 10010
 10011     MOVE CM-INSURED-FIRST-NAME  TO W-FIRST-NAME.
 10012     MOVE CM-INSURED-LAST-NAME   TO W-LAST-NAME.
 10013     MOVE CM-INSURED-INITIAL2    TO W-MIDDLE-NAME.
 10014     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10015
 10016     IF LOWER-CASE-LETTERS-USED
 10017         MOVE 'N'                TO WS-STATE-LINE
 10018         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10019         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10020         MOVE WS-TEMP-AREA2      TO SS57D
 10021     ELSE
 10022         MOVE WS-NAME-WORK       TO SS57D.
 10023
 10024     MOVE CM-JT-FIRST-NAME       TO W-FIRST-NAME.
 10025     MOVE CM-JT-LAST-NAME        TO W-LAST-NAME.
 10026     MOVE CM-JT-INITIAL          TO W-MIDDLE-NAME.
 10027     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10028
 10029     IF LOWER-CASE-LETTERS-USED
 10030         MOVE 'N'                TO WS-STATE-LINE
 10031         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10032         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10033         MOVE WS-TEMP-AREA2      TO SS58D
 10034     ELSE
 10035         MOVE WS-NAME-WORK       TO SS58D.
 10036
 10037     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10038        MOVE CM-LF-BENEFIT-CD    TO BEN-HOLD
 10039        MOVE CM-LF-ORIG-TERM     TO SS29D
 10040        MOVE CM-LF-BENEFIT-AMT   TO SS30D
 10041        MOVE CM-POLICY-FORM-NO   TO SS32D
 10042        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
 10043     ELSE
 10044        MOVE CM-AH-BENEFIT-CD    TO BEN-HOLD
 10045        MOVE CM-AH-ORIG-TERM     TO SS29D
 10046        MOVE CM-AH-BENEFIT-AMT   TO SS30D
 10047        MOVE CM-POLICY-FORM-NO   TO SS32D
 10048        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL152.cbl
 10049
 10050     COMPUTE WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 10051
 10052     MOVE WORK-AMOUNT            TO SS51D.
 10053
 10054     MOVE SPACES                 TO DC-OPTION-CODE.
 10055     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10056     IF NO-CONVERSION-ERROR
 10057        MOVE DC-GREG-DATE-1-EDIT TO SS31D.
 10058
 10059     MOVE ' '                         TO  DC-OPTION-CODE.
 10060     MOVE +0                          TO  DC-ELAPSED-MONTHS
 10061                                          DC-ELAPSED-DAYS.
 10062
 10063     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10064         MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10065         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10066         IF NO-CONVERSION-ERROR
 10067             MOVE DC-GREG-DATE-1-EDIT TO  SS28D
 10068         ELSE
 10069             NEXT SENTENCE
 10070     ELSE
 10071         MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10072         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10073         IF NO-CONVERSION-ERROR
 10074             MOVE DC-GREG-DATE-1-EDIT TO  SS28D.
 10075
 10076*    GO TO 7200-READ-DIAGNOSIS.
 10077
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL152.cbl
 10079*7200-READ-EMPLCY. Remove as dead code
 10080 7200-READ-DIAGNOSIS.
 10081
 10082* EXEC CICS HANDLE CONDITION
 10083*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10084*         NOTFND     (7200-READ-LOAN-NUMBER)
 10085*    END-EXEC.
 10086*    MOVE '"$JI                  ! 3 #00009447' TO DFHEIV0
 10087     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10089     MOVE X'3320233030303039343437' TO DFHEIV0(25:11)
 10090     CALL 'kxdfhei1' USING DFHEIV0
 10091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10092
 10093
 10094     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10095     MOVE +90                   TO ACTV-SEQ.
 10096
 10097
 10098* EXEC CICS READ
 10099*         DATASET  (ACTV-ID)
 10100*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10101*         RIDFLD   (ACTV-KEY)
 10102*    END-EXEC.
 10103*    MOVE '&"S        E          (   #00009455' TO DFHEIV0
 10104     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10106     MOVE X'2020233030303039343535' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0,
 10108           ACTV-ID,
 10109           DFHEIV20,
 10110           DFHEIV99,
 10111           ACTV-KEY,
 10112           DFHEIV99,
 10113           DFHEIV99,
 10114           DFHEIV99
 10115     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10116         DFHEIV20
 10117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10118
 10119
 10120     IF AT-TRAILER-TYPE = '6'
 10121        MOVE AT-INFO-LINE-1         TO SS19D.
 10122
 10123 7200-READ-LOAN-NUMBER.
 10124
 10125
 10126* EXEC CICS HANDLE CONDITION
 10127*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10128*         NOTFND     (7201-READ-BENEFICIARY)
 10129*    END-EXEC.
 10130*    MOVE '"$JI                  ! 4 #00009466' TO DFHEIV0
 10131     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10133     MOVE X'3420233030303039343636' TO DFHEIV0(25:11)
 10134     CALL 'kxdfhei1' USING DFHEIV0
 10135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10136
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL152.cbl
 10137
 10138     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10139     MOVE +91                   TO ACTV-SEQ.
 10140
 10141
 10142* EXEC CICS READ
 10143*         DATASET  (ACTV-ID)
 10144*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10145*         RIDFLD   (ACTV-KEY)
 10146*    END-EXEC.
 10147*    MOVE '&"S        E          (   #00009474' TO DFHEIV0
 10148     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10150     MOVE X'2020233030303039343734' TO DFHEIV0(25:11)
 10151     CALL 'kxdfhei1' USING DFHEIV0,
 10152           ACTV-ID,
 10153           DFHEIV20,
 10154           DFHEIV99,
 10155           ACTV-KEY,
 10156           DFHEIV99,
 10157           DFHEIV99,
 10158           DFHEIV99
 10159     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10160         DFHEIV20
 10161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10162
 10163
 10164     IF AT-TRAILER-TYPE = '6'
 10165        MOVE AT-INFO-LINE-1         TO SS19-2D.
 10166
 10167 7201-READ-BENEFICIARY.
 10168     IF CL-BENIF-ADDR-CNT = +0  AND
 10169        CL-BENEFICIARY = SPACES
 10170          GO TO 7205-READ-PHYSICIAN-ADDR.
 10171
 10172     IF W-BENEFICIARY > ZERO
 10173         COMPUTE ACTV-SEQ = W-BENEFICIARY + 10
 10174     ELSE
 10175         MOVE CL-BENIF-ADDR-CNT  TO ACTV-SEQ
 10176         ADD +10                 TO ACTV-SEQ.
 10177
 10178
 10179* EXEC CICS HANDLE CONDITION
 10180*         NOTOPEN    (7290-BENE-NOT-OPEN)
 10181*         NOTFND     (7205-READ-PHYSICIAN-ADDR)
 10182*    END-EXEC.
 10183*    MOVE '"$JI                  ! 5 #00009494' TO DFHEIV0
 10184     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10185     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10186     MOVE X'3520233030303039343934' TO DFHEIV0(25:11)
 10187     CALL 'kxdfhei1' USING DFHEIV0
 10188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10189
 10190
 10191     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10192
 10193     IF ACTV-SEQ = +19
 10194         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL152.cbl
 10195     ELSE
 10196         IF ACTV-SEQ NOT = +10
 10197             GO TO 7202-GET-FROM-ACTIVITY.
 10198
 10199     MOVE PI-COMPANY-CD        TO BENE-COMP-CD.
 10200     MOVE 'B'                  TO BENE-REC-TYPE.
 10201     MOVE CL-BENEFICIARY       TO BENE-NUMBER.
 10202
 10203
 10204* EXEC CICS READ
 10205*         DATASET    (BENE-ID)
 10206*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 10207*         RIDFLD     (BENE-KEY)
 10208*    END-EXEC.
 10209*    MOVE '&"S        E          (   #00009511' TO DFHEIV0
 10210     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10212     MOVE X'2020233030303039353131' TO DFHEIV0(25:11)
 10213     CALL 'kxdfhei1' USING DFHEIV0,
 10214           BENE-ID,
 10215           DFHEIV20,
 10216           DFHEIV99,
 10217           BENE-KEY,
 10218           DFHEIV99,
 10219           DFHEIV99,
 10220           DFHEIV99
 10221     SET ADDRESS OF BENEFICIARY-MASTER TO
 10222         DFHEIV20
 10223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10224
 10225
 10226*    IF PI-COMPANY-ID = 'DMD'
 10227*        MOVE BE-BSR             TO PI-ELBENE-BSR.
 10228
 10229 7201-CONT.
 10230     MOVE BE-MAIL-TO-NAME2       TO WS-LABEL-LINES (1).
 10231     MOVE BE-ADDRESS-LINE-12     TO WS-LABEL-LINES (2).
 10232     MOVE BE-ADDRESS-LINE-22     TO WS-LABEL-LINES (3).
 10233     MOVE BE-ADDRESS-LINE-32     TO WS-LABEL-LINES (4).
 10234*    MOVE BE-CITY-STATE2         TO WS-LABEL-LINES (5).
 10235     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
 10236        INTO WS-LABEL-LINES (5)
 10237     END-STRING
 10238
 10239     MOVE SPACES                 TO WS-ZIP-CODE.
 10240
 10241     IF BE-CANADIAN-POST-CODE2
 10242         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
 10243         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
 10244     ELSE
 10245         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
 10246         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
 10247             MOVE '-'            TO WS-AM-ZIP-DASH
 10248             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
 10249
 10250     MOVE WS-ZIP-CODE            TO WS-LABEL-LINES (6).
 10251
 10252     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL152.cbl
 10253
 10254     MOVE WS-LABEL-LINES (1)     TO SS61D.
 10255     MOVE WS-LABEL-LINES (2)     TO SS61-1D.
 10256     MOVE WS-LABEL-LINES (3)     TO SS61-2D.
 10257     MOVE WS-LABEL-LINES (4)     TO SS61-3D.
 10258     MOVE WS-LABEL-LINES (5)     TO SS61-4D.
 10259     MOVE WS-LABEL-LINES (6)     TO SS61-5D.
 10260
 10261     MOVE BE-PHONE-NO2           TO WS-PHONE-IN.
 10262     MOVE WSPI-AREA              TO WSPO-AREA.
 10263     MOVE WSPI-PFX               TO WSPO-PFX.
 10264     MOVE WSPI-SFX               TO WSPO-SFX.
 10265     MOVE WS-PHONE-OUT           TO SS61-6D.
 10266
 10267 7201-CONT-PROCESS.
 10268     MOVE BE-MAIL-TO-NAME      TO  WS-LABEL-LINES (1).
 10269     MOVE BE-ADDRESS-LINE-1    TO  WS-LABEL-LINES (2).
 10270     MOVE BE-ADDRESS-LINE-2    TO  WS-LABEL-LINES (3).
 10271     MOVE BE-ADDRESS-LINE-3    TO  WS-LABEL-LINES (4).
 10272*    MOVE BE-CITY-STATE        TO  WS-LABEL-LINES (5).
 10273     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
 10274        INTO WS-LABEL-LINES (5)
 10275     END-STRING
 10276
 10277     MOVE SPACES               TO  WS-ZIP-CODE.
 10278     IF BE-CANADIAN-POST-CODE
 10279         MOVE BE-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 10280         MOVE BE-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 10281     ELSE
 10282         MOVE BE-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 10283         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10284             MOVE '-'          TO  WS-AM-ZIP-DASH
 10285             MOVE BE-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 10286
 10287     MOVE WS-ZIP-CODE          TO  WS-LABEL-LINES (6).
 10288
 10289     MOVE BE-PHONE-NO          TO  WS-PHONE-IN.
 10290
 10291     GO TO 7204-SET-PHONE.
 10292
 10293 7202-GET-FROM-ACTIVITY.
 10294
 10295* EXEC CICS READ
 10296*         DATASET  (ACTV-ID)
 10297*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10298*         RIDFLD   (ACTV-KEY)
 10299*    END-EXEC.
 10300*    MOVE '&"S        E          (   #00009585' TO DFHEIV0
 10301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10303     MOVE X'2020233030303039353835' TO DFHEIV0(25:11)
 10304     CALL 'kxdfhei1' USING DFHEIV0,
 10305           ACTV-ID,
 10306           DFHEIV20,
 10307           DFHEIV99,
 10308           ACTV-KEY,
 10309           DFHEIV99,
 10310           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL152.cbl
 10311           DFHEIV99
 10312     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10313         DFHEIV20
 10314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10315
 10316
 10317     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10318     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10319     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10320*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10321     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10322        INTO WS-LABEL-LINES (4)
 10323     END-STRING
 10324
 10325     MOVE SPACES                 TO  WS-ZIP-CODE.
 10326     IF AT-CANADIAN-POST-CODE
 10327         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10328         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10329     ELSE
 10330         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10331         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10332             MOVE '-'            TO  WS-AM-ZIP-DASH
 10333             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10334
 10335     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10336
 10337     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10338
 10339 7204-SET-PHONE.
 10340     MOVE WSPI-AREA              TO WSPO-AREA.
 10341     MOVE WSPI-PFX               TO WSPO-PFX.
 10342     MOVE WSPI-SFX               TO WSPO-SFX.
 10343     MOVE WS-PHONE-OUT           TO SS44-5D.
 10344
 10345     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10346
 10347     MOVE WS-LABEL-LINES (1)     TO SS43D.
 10348     MOVE WS-LABEL-LINES (2)     TO SS44-1D.
 10349     MOVE WS-LABEL-LINES (3)     TO SS44-2D.
 10350     MOVE WS-LABEL-LINES (4)     TO SS44-3D.
 10351     MOVE WS-LABEL-LINES (5)     TO SS44-4D.
 10352     MOVE WS-LABEL-LINES (6)     TO SS44-6D.
 10353
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL152.cbl
 10355 7205-READ-PHYSICIAN-ADDR.
 10356     IF W-PHYSICIAN > ZERO
 10357         COMPUTE ACTV-SEQ = W-PHYSICIAN + 30
 10358     ELSE
 10359         MOVE CL-DOCTOR-ADDR-CNT TO ACTV-SEQ
 10360         ADD +30                 TO ACTV-SEQ.
 10361
 10362     IF ACTV-SEQ = +30
 10363        GO TO 7210-READ-EMPLOYER-ADDR.
 10364
 10365
 10366* EXEC CICS HANDLE CONDITION
 10367*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10368*         NOTFND     (7210-READ-EMPLOYER-ADDR)
 10369*    END-EXEC.
 10370*    MOVE '"$JI                  ! 6 #00009639' TO DFHEIV0
 10371     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10373     MOVE X'3620233030303039363339' TO DFHEIV0(25:11)
 10374     CALL 'kxdfhei1' USING DFHEIV0
 10375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10376
 10377
 10378
 10379* EXEC CICS READ
 10380*         DATASET    (ACTV-ID)
 10381*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10382*         RIDFLD     (ACTV-KEY)
 10383*    END-EXEC.
 10384*    MOVE '&"S        E          (   #00009644' TO DFHEIV0
 10385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10387     MOVE X'2020233030303039363434' TO DFHEIV0(25:11)
 10388     CALL 'kxdfhei1' USING DFHEIV0,
 10389           ACTV-ID,
 10390           DFHEIV20,
 10391           DFHEIV99,
 10392           ACTV-KEY,
 10393           DFHEIV99,
 10394           DFHEIV99,
 10395           DFHEIV99
 10396     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10397         DFHEIV20
 10398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10399
 10400
 10401     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10402     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10403     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10404     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10405*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10406     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10407        INTO WS-LABEL-LINES (4)
 10408     END-STRING
 10409
 10410     MOVE SPACES                 TO  WS-ZIP-CODE.
 10411     IF AT-CANADIAN-POST-CODE
 10412         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL152.cbl
 10413         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10414     ELSE
 10415         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10416         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10417             MOVE '-'            TO  WS-AM-ZIP-DASH
 10418             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10419
 10420     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10421
 10422     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10423     MOVE WSPI-AREA              TO WSPO-AREA.
 10424     MOVE WSPI-PFX               TO WSPO-PFX.
 10425     MOVE WSPI-SFX               TO WSPO-SFX.
 10426     MOVE WS-PHONE-OUT           TO SS47-5D.
 10427
 10428     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10429
 10430     MOVE WS-LABEL-LINES (1)     TO SS47D.
 10431     MOVE WS-LABEL-LINES (2)     TO SS47-1D.
 10432     MOVE WS-LABEL-LINES (3)     TO SS47-2D.
 10433     MOVE WS-LABEL-LINES (4)     TO SS47-3D.
 10434     MOVE WS-LABEL-LINES (5)     TO SS47-4D.
 10435
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL152.cbl
 10437
 10438 7210-READ-EMPLOYER-ADDR.
 10439     IF W-EMPLOYER > ZERO
 10440         COMPUTE ACTV-SEQ = W-EMPLOYER + 40
 10441     ELSE
 10442         MOVE CL-EMPLOYER-ADDR-CNT
 10443                                 TO ACTV-SEQ
 10444         ADD +40                 TO ACTV-SEQ.
 10445
 10446     IF ACTV-SEQ = +40
 10447        GO TO 7220-READ-INSURED-ADDR.
 10448
 10449
 10450* EXEC CICS HANDLE CONDITION
 10451*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10452*         NOTFND     (7220-READ-INSURED-ADDR)
 10453*    END-EXEC.
 10454*    MOVE '"$JI                  ! 7 #00009698' TO DFHEIV0
 10455     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10457     MOVE X'3720233030303039363938' TO DFHEIV0(25:11)
 10458     CALL 'kxdfhei1' USING DFHEIV0
 10459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10460
 10461
 10462
 10463* EXEC CICS READ
 10464*         DATASET    (ACTV-ID)
 10465*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10466*         RIDFLD     (ACTV-KEY)
 10467*    END-EXEC.
 10468*    MOVE '&"S        E          (   #00009703' TO DFHEIV0
 10469     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10471     MOVE X'2020233030303039373033' TO DFHEIV0(25:11)
 10472     CALL 'kxdfhei1' USING DFHEIV0,
 10473           ACTV-ID,
 10474           DFHEIV20,
 10475           DFHEIV99,
 10476           ACTV-KEY,
 10477           DFHEIV99,
 10478           DFHEIV99,
 10479           DFHEIV99
 10480     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10481         DFHEIV20
 10482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10483
 10484
 10485     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10486     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10487     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10488     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10489*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10490     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10491        INTO WS-LABEL-LINES (4)
 10492     END-STRING
 10493
 10494     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL152.cbl
 10495     IF AT-CANADIAN-POST-CODE
 10496         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10497         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10498     ELSE
 10499         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10500         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10501             MOVE '-'            TO  WS-AM-ZIP-DASH
 10502             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10503
 10504     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10505
 10506     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10507     MOVE WSPI-AREA              TO WSPO-AREA.
 10508     MOVE WSPI-PFX               TO WSPO-PFX.
 10509     MOVE WSPI-SFX               TO WSPO-SFX.
 10510     MOVE WS-PHONE-OUT           TO SS48-5D.
 10511
 10512     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10513
 10514     MOVE WS-LABEL-LINES (1)     TO SS48D.
 10515     MOVE WS-LABEL-LINES (2)     TO SS48-1D.
 10516     MOVE WS-LABEL-LINES (3)     TO SS48-2D.
 10517     MOVE WS-LABEL-LINES (4)     TO SS48-3D.
 10518     MOVE WS-LABEL-LINES (5)     TO SS48-4D.
 10519
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL152.cbl
 10521 7220-READ-INSURED-ADDR.
 10522
 10523     IF W-INSURED > ZERO
 10524         COMPUTE ACTV-SEQ = W-INSURED
 10525     ELSE
 10526         MOVE CL-INSURED-ADDR-CNT TO ACTV-SEQ.
 10527
 10528     IF ACTV-SEQ = +0
 10529        GO TO 7225-READ-OTHER1-ADDR.
 10530
 10531
 10532* EXEC CICS HANDLE CONDITION
 10533*         NOTOPEN   (8870-ACTV-NOT-OPEN)
 10534*         NOTFND    (7225-READ-OTHER1-ADDR)
 10535*    END-EXEC.
 10536*    MOVE '"$JI                  ! 8 #00009755' TO DFHEIV0
 10537     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10539     MOVE X'3820233030303039373535' TO DFHEIV0(25:11)
 10540     CALL 'kxdfhei1' USING DFHEIV0
 10541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10542
 10543
 10544
 10545* EXEC CICS READ
 10546*         DATASET   (ACTV-ID)
 10547*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10548*         RIDFLD    (ACTV-KEY)
 10549*    END-EXEC.
 10550*    MOVE '&"S        E          (   #00009760' TO DFHEIV0
 10551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10553     MOVE X'2020233030303039373630' TO DFHEIV0(25:11)
 10554     CALL 'kxdfhei1' USING DFHEIV0,
 10555           ACTV-ID,
 10556           DFHEIV20,
 10557           DFHEIV99,
 10558           ACTV-KEY,
 10559           DFHEIV99,
 10560           DFHEIV99,
 10561           DFHEIV99
 10562     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10563         DFHEIV20
 10564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10565
 10566
 10567     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10568     MOVE SS10D                  TO WS-LABEL-LINES (1).
 10569     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10570     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10571*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10572     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10573        INTO WS-LABEL-LINES (4)
 10574     END-STRING
 10575
 10576     MOVE SPACES                 TO  WS-ZIP-CODE.
 10577     IF AT-CANADIAN-POST-CODE
 10578         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL152.cbl
 10579         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10580     ELSE
 10581         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10582         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10583             MOVE '-'            TO  WS-AM-ZIP-DASH
 10584             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10585
 10586     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10587
 10588     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10589
 10590     MOVE WS-LABEL-LINES (1)     TO SS10D.
 10591     MOVE WS-LABEL-LINES (2)     TO SS11-1D.
 10592     MOVE WS-LABEL-LINES (3)     TO SS11-2D.
 10593     MOVE WS-LABEL-LINES (4)     TO SS11-3D.
 10594     MOVE WS-LABEL-LINES (5)     TO SS11-4D.
 10595     MOVE AT-MAIL-TO-NAME        TO SS11-5D.
 10596
 10597     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10598     MOVE WSPI-AREA              TO WSPO-AREA.
 10599     MOVE WSPI-PFX               TO WSPO-PFX.
 10600     MOVE WSPI-SFX               TO WSPO-SFX.
 10601     MOVE WS-PHONE-OUT           TO SS11-6D.
 10602
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL152.cbl
 10604
 10605 7225-READ-OTHER1-ADDR.
 10606
 10607     IF W-OTHER-1 > ZERO
 10608         COMPUTE ACTV-SEQ = W-OTHER-1 + 50
 10609     ELSE
 10610         MOVE CL-OTHER-1-ADDR-CNT TO ACTV-SEQ
 10611         ADD +50                  TO ACTV-SEQ.
 10612
 10613     IF ACTV-SEQ = +50
 10614        GO TO 7230-READ-OTHER2-ADDR.
 10615
 10616
 10617* EXEC CICS HANDLE CONDITION
 10618*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10619*         NOTFND     (7230-READ-OTHER2-ADDR)
 10620*    END-EXEC.
 10621*    MOVE '"$JI                  ! 9 #00009815' TO DFHEIV0
 10622     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10624     MOVE X'3920233030303039383135' TO DFHEIV0(25:11)
 10625     CALL 'kxdfhei1' USING DFHEIV0
 10626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10627
 10628
 10629
 10630* EXEC CICS READ
 10631*         DATASET    (ACTV-ID)
 10632*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10633*         RIDFLD     (ACTV-KEY)
 10634*    END-EXEC.
 10635*    MOVE '&"S        E          (   #00009820' TO DFHEIV0
 10636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10638     MOVE X'2020233030303039383230' TO DFHEIV0(25:11)
 10639     CALL 'kxdfhei1' USING DFHEIV0,
 10640           ACTV-ID,
 10641           DFHEIV20,
 10642           DFHEIV99,
 10643           ACTV-KEY,
 10644           DFHEIV99,
 10645           DFHEIV99,
 10646           DFHEIV99
 10647     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10648         DFHEIV20
 10649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10650
 10651
 10652     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10653     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10654     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10655     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10656*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10657     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10658        INTO WS-LABEL-LINES (4)
 10659     END-STRING
 10660
 10661     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL152.cbl
 10662     IF AT-CANADIAN-POST-CODE
 10663         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10664         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10665     ELSE
 10666         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10667         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10668             MOVE '-'            TO  WS-AM-ZIP-DASH
 10669             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10670
 10671     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10672
 10673     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10674     MOVE WSPI-AREA              TO WSPO-AREA.
 10675     MOVE WSPI-PFX               TO WSPO-PFX.
 10676     MOVE WSPI-SFX               TO WSPO-SFX.
 10677     MOVE WS-PHONE-OUT           TO SS49-5D.
 10678
 10679     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10680
 10681     MOVE WS-LABEL-LINES (1)     TO SS49D.
 10682     MOVE WS-LABEL-LINES (2)     TO SS49-1D.
 10683     MOVE WS-LABEL-LINES (3)     TO SS49-2D.
 10684     MOVE WS-LABEL-LINES (4)     TO SS49-3D.
 10685     MOVE WS-LABEL-LINES (5)     TO SS49-4D.
 10686
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL152.cbl
 10688 7230-READ-OTHER2-ADDR.
 10689
 10690     IF W-OTHER-2 > ZERO
 10691         COMPUTE ACTV-SEQ = W-OTHER-2 + 60
 10692     ELSE
 10693         MOVE CL-OTHER-2-ADDR-CNT TO ACTV-SEQ
 10694         ADD +60                  TO ACTV-SEQ.
 10695
 10696     IF ACTV-SEQ = +60
 10697        GO TO 7240-NOT-FOUND.
 10698
 10699
 10700* EXEC CICS HANDLE CONDITION
 10701*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10702*         NOTFND     (7240-NOT-FOUND)
 10703*    END-EXEC.
 10704*    MOVE '"$JI                  ! : #00009873' TO DFHEIV0
 10705     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10706     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10707     MOVE X'3A20233030303039383733' TO DFHEIV0(25:11)
 10708     CALL 'kxdfhei1' USING DFHEIV0
 10709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10710
 10711
 10712
 10713* EXEC CICS READ
 10714*         DATASET    (ACTV-ID)
 10715*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10716*         RIDFLD     (ACTV-KEY)
 10717*    END-EXEC.
 10718*    MOVE '&"S        E          (   #00009878' TO DFHEIV0
 10719     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10721     MOVE X'2020233030303039383738' TO DFHEIV0(25:11)
 10722     CALL 'kxdfhei1' USING DFHEIV0,
 10723           ACTV-ID,
 10724           DFHEIV20,
 10725           DFHEIV99,
 10726           ACTV-KEY,
 10727           DFHEIV99,
 10728           DFHEIV99,
 10729           DFHEIV99
 10730     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10731         DFHEIV20
 10732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10733
 10734
 10735     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10736     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10737     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10738     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10739*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10740     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10741        INTO WS-LABEL-LINES (4)
 10742     END-STRING
 10743
 10744     MOVE SPACES                 TO  WS-ZIP-CODE.
 10745     IF AT-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL152.cbl
 10746         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10747         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10748     ELSE
 10749         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10750         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10751             MOVE '-'            TO  WS-AM-ZIP-DASH
 10752             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10753
 10754     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10755
 10756     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10757     MOVE WSPI-AREA              TO WSPO-AREA.
 10758     MOVE WSPI-PFX               TO WSPO-PFX.
 10759     MOVE WSPI-SFX               TO WSPO-SFX.
 10760     MOVE WS-PHONE-OUT           TO SS50-5D.
 10761
 10762     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10763
 10764     MOVE WS-LABEL-LINES (1)     TO SS50D.
 10765     MOVE WS-LABEL-LINES (2)     TO SS50-1D.
 10766     MOVE WS-LABEL-LINES (3)     TO SS50-2D.
 10767     MOVE WS-LABEL-LINES (4)     TO SS50-3D.
 10768     MOVE WS-LABEL-LINES (5)     TO SS50-4D.
 10769
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL152.cbl
 10771 7240-NOT-FOUND.
 10772     IF ACCOUNT-IS-ONLINE
 10773        GO TO 7250-READ-ACCOUNT.
 10774
 10775     IF W-ACCOUNT > ZERO
 10776         COMPUTE ACTV-SEQ = W-ACCOUNT + 20
 10777     ELSE
 10778         MOVE CL-ACCOUNT-ADDR-CNT TO ACTV-SEQ
 10779         ADD +20                  TO ACTV-SEQ.
 10780
 10781     IF ACTV-SEQ = +20
 10782        GO TO 7250-READ-ACCOUNT.
 10783
 10784
 10785* EXEC CICS HANDLE CONDITION
 10786*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10787*         NOTFND     (7250-READ-ACCOUNT)
 10788*    END-EXEC.
 10789*    MOVE '"$JI                  ! ; #00009933' TO DFHEIV0
 10790     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10792     MOVE X'3B20233030303039393333' TO DFHEIV0(25:11)
 10793     CALL 'kxdfhei1' USING DFHEIV0
 10794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10795
 10796
 10797
 10798* EXEC CICS READ
 10799*         DATASET    (ACTV-ID)
 10800*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10801*         RIDFLD     (ACTV-KEY)
 10802*    END-EXEC.
 10803*    MOVE '&"S        E          (   #00009938' TO DFHEIV0
 10804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10806     MOVE X'2020233030303039393338' TO DFHEIV0(25:11)
 10807     CALL 'kxdfhei1' USING DFHEIV0,
 10808           ACTV-ID,
 10809           DFHEIV20,
 10810           DFHEIV99,
 10811           ACTV-KEY,
 10812           DFHEIV99,
 10813           DFHEIV99,
 10814           DFHEIV99
 10815     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10816         DFHEIV20
 10817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10818
 10819
 10820     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10821     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10822     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10823     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10824*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10825     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10826        INTO WS-LABEL-LINES (4)
 10827     END-STRING
 10828
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL152.cbl
 10829     MOVE SPACES                 TO  WS-ZIP-CODE.
 10830     IF AT-CANADIAN-POST-CODE
 10831         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10832         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10833     ELSE
 10834         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10835         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10836             MOVE '-'            TO  WS-AM-ZIP-DASH
 10837             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10838
 10839     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10840
 10841     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10842     MOVE WSPI-AREA              TO WSPO-AREA.
 10843     MOVE WSPI-PFX               TO WSPO-PFX.
 10844     MOVE WSPI-SFX               TO WSPO-SFX.
 10845     MOVE WS-PHONE-OUT           TO SS07-6D.
 10846
 10847*    IF PI-COMPANY-ID NOT = 'FLA'
 10848*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10849
 10850     MOVE WS-LABEL-LINES (1)     TO SS06D.
 10851     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 10852     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 10853     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 10854     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 10855     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 10856
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL152.cbl
 10858 7250-READ-ACCOUNT.
 10859*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10860*        GO TO 7250-READ-PRODUCER.
 10861
 10862     IF WS-ACCT-READ-SW = 'Y'
 10863        GO TO 7250-BUILD-ACCT-ADDR.
 10864
 10865     MOVE CM-CERT-EFF-DT TO ACCT-EXP-DATE.
 10866
 10867
 10868* EXEC CICS HANDLE CONDITION
 10869*         NOTOPEN   (8880-ACCT-NOT-OPEN)
 10870*         NOTFND    (7251-READ-3RD-PARTY)
 10871*    END-EXEC.
 10872*    MOVE '"$JI                  ! < #00009991' TO DFHEIV0
 10873     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10875     MOVE X'3C20233030303039393931' TO DFHEIV0(25:11)
 10876     CALL 'kxdfhei1' USING DFHEIV0
 10877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10878
 10879
 10880 7250-STARTBR-ACCOUNT.
 10881     MOVE ACCT-PARTIAL-KEY       TO  ACCT-SAVE-KEY.
 10882     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
 10883
 10884 7250-READNEXT-ACCOUNT.
 10885     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
 10886
 10887     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
 10888         IF WS-SAVE-ACCT-RECORD = SPACES
 10889             GO TO 7251-READ-3RD-PARTY
 10890         ELSE
 10891             MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
 10892             MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
 10893             GO TO 7250-BUILD-ACCT-ADDR.
 10894
 10895     IF AM-EXPIRATION-DT = HIGH-VALUES
 10896         MOVE AM-CONTROL-PRIMARY      TO  ACCT-KEY
 10897     ELSE
 10898         MOVE ACCOUNT-MASTER          TO  WS-SAVE-ACCT-RECORD
 10899         GO TO 7250-READNEXT-ACCOUNT.
 10900
 10901 7250-BUILD-ACCT-ADDR.
 10902     MOVE SPACES                TO  WS-SAVE-ACCT-RECORD.
 10903
 10904     IF NOT ACCOUNT-IS-ONLINE
 10905        GO TO 7251-READ-3RD-PARTY.
 10906
 10907     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 10908     MOVE AM-NAME               TO WS-LABEL-LINES (1).
 10909     MOVE AM-PERSON             TO WS-LABEL-LINES (2).
 10910     MOVE AM-ADDRS              TO WS-LABEL-LINES (3).
 10911*    MOVE AM-CITY               TO WS-LABEL-LINES (4).
 10912     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
 10913        INTO WS-LABEL-LINES (4)
 10914     END-STRING
 10915
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL152.cbl
 10916     MOVE SPACES                TO  WS-ZIP-CODE.
 10917     IF AM-CANADIAN-POST-CODE
 10918         MOVE AM-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 10919         MOVE AM-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 10920     ELSE
 10921         MOVE AM-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 10922         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10923             MOVE '-'           TO  WS-AM-ZIP-DASH
 10924             MOVE AM-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 10925
 10926     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 10927
 10928     MOVE ZEROS                 TO WS-PHONE-IN.
 10929     MOVE AM-AREA-CODE          TO WSPO-AREA.
 10930     MOVE AM-TEL-PRE            TO WSPO-PFX.
 10931     MOVE AM-TEL-NBR            TO WSPO-SFX.
 10932     MOVE WS-PHONE-OUT          TO SS07-6D.
 10933
 10934*    IF PI-COMPANY-ID NOT = 'FLA'
 10935*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10936
 10937     MOVE WS-LABEL-LINES (1)     TO SS06D.
 10938     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 10939     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 10940     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 10941     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 10942     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 10943
 10944*    GO TO 7251-READ-3RD-PARTY.
 10945
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL152.cbl
 10947*7250-READ-PRODUCER. Remove as dead code
 10948*7250-STARTBR-PRODUCER. Remove as dead code
 10949*7250-READNEXT-PRODUCER. Remove as dead code
 10950*7250-BUILD-PROD-ADDR. Remove as dead code
 10951 7251-READ-3RD-PARTY.
 10952
 10953     MOVE +29                    TO ACTV-SEQ.
 10954
 10955
 10956* EXEC CICS HANDLE CONDITION
 10957*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10958*         NOTFND     (7252-READ-COMP)
 10959*    END-EXEC.
 10960*    MOVE '"$JI                  ! = #00010071' TO DFHEIV0
 10961     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10963     MOVE X'3D20233030303130303731' TO DFHEIV0(25:11)
 10964     CALL 'kxdfhei1' USING DFHEIV0
 10965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10966
 10967
 10968
 10969* EXEC CICS READ
 10970*         DATASET    (ACTV-ID)
 10971*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10972*         RIDFLD     (ACTV-KEY)
 10973*    END-EXEC.
 10974*    MOVE '&"S        E          (   #00010076' TO DFHEIV0
 10975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10977     MOVE X'2020233030303130303736' TO DFHEIV0(25:11)
 10978     CALL 'kxdfhei1' USING DFHEIV0,
 10979           ACTV-ID,
 10980           DFHEIV20,
 10981           DFHEIV99,
 10982           ACTV-KEY,
 10983           DFHEIV99,
 10984           DFHEIV99,
 10985           DFHEIV99
 10986     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10987         DFHEIV20
 10988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10989
 10990
 10991     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10992     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10993     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10994     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10995*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10996     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10997        INTO WS-LABEL-LINES (4)
 10998     END-STRING
 10999
 11000     MOVE SPACES                 TO  WS-ZIP-CODE.
 11001     IF AT-CANADIAN-POST-CODE
 11002         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 11003         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 11004     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL152.cbl
 11005         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11006         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11007             MOVE '-'            TO  WS-AM-ZIP-DASH
 11008             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11009
 11010     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11011
 11012     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11013     MOVE WSPI-AREA              TO WSPO-AREA.
 11014     MOVE WSPI-PFX               TO WSPO-PFX.
 11015     MOVE WSPI-SFX               TO WSPO-SFX.
 11016     MOVE WS-PHONE-OUT           TO SS53-6D.
 11017
 11018     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11019
 11020     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11021     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11022     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11023     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11024     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11025     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11026
 11027     GO TO 7260-READ-DENIAL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL152.cbl
 11029 7252-READ-COMP.
 11030
 11031     IF WS-COMP-READ-SW = 'Y'
 11032        GO TO 7255-BUILD-COMP-ADDR.
 11033
 11034     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 11035        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
 11036        GO TO 7260-READ-DENIAL.
 11037
 11038     IF AM-3RD-PARTY-NOTIF-LEVEL > 00 AND < 11
 11039        NEXT SENTENCE
 11040     ELSE
 11041        GO TO 7260-READ-DENIAL.
 11042
 11043     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
 11044        GO TO 7260-READ-DENIAL.
 11045
 11046     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD.
 11047     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER.
 11048     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING.
 11049     MOVE 'A'             TO WS-ERCOMP-TYPE.
 11050     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11051                          TO WS-ERCOMP-RESP-NO.
 11052
 11053     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 11054         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 11055                                       'G' OR 'B'
 11056             MOVE 'G'            TO WS-ERCOMP-TYPE
 11057             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
 11058         ELSE
 11059             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11060                                 TO WS-ERCOMP-ACCOUNT
 11061     ELSE
 11062         MOVE 'G'                TO WS-ERCOMP-TYPE
 11063         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
 11064
 11065     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
 11066        MOVE ZEROS TO WS-ERCOMP-CARRIER.
 11067
 11068     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
 11069        MOVE ZEROS TO WS-ERCOMP-GROUPING.
 11070
 11071
 11072* EXEC CICS HANDLE CONDITION
 11073*         NOTFND    (7260-READ-DENIAL)
 11074*    END-EXEC.
 11075*    MOVE '"$I                   ! > #00010162' TO DFHEIV0
 11076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11078     MOVE X'3E20233030303130313632' TO DFHEIV0(25:11)
 11079     CALL 'kxdfhei1' USING DFHEIV0
 11080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11081
 11082
 11083
 11084* EXEC CICS  READ
 11085*         SET      (ADDRESS OF COMPENSATION-MASTER)
 11086*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL152.cbl
 11087*         RIDFLD   (WS-ERCOMP-KEY)
 11088*    END-EXEC.
 11089     MOVE 'ERCOMP' TO DFHEIV1
 11090*    MOVE '&"S        E          (   #00010166' TO DFHEIV0
 11091     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11093     MOVE X'2020233030303130313636' TO DFHEIV0(25:11)
 11094     CALL 'kxdfhei1' USING DFHEIV0,
 11095           DFHEIV1,
 11096           DFHEIV20,
 11097           DFHEIV99,
 11098           WS-ERCOMP-KEY,
 11099           DFHEIV99,
 11100           DFHEIV99,
 11101           DFHEIV99
 11102     SET ADDRESS OF COMPENSATION-MASTER TO
 11103         DFHEIV20
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11105
 11106
 11107 7255-BUILD-COMP-ADDR.
 11108
 11109     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11110     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
 11111     IF CO-ACCT-NAME = SPACES
 11112        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
 11113     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
 11114     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
 11115     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
 11116
 11117     MOVE SPACES                TO  WS-ZIP-CODE.
 11118     IF CO-CANADIAN-POST-CODE
 11119         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11120         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11121     ELSE
 11122         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11123         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11124             MOVE '-'           TO  WS-AM-ZIP-DASH
 11125             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11126
 11127     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11128
 11129     MOVE ZEROS                 TO WS-PHONE-IN.
 11130     MOVE CO-AREA-CODE          TO WSPO-AREA.
 11131     MOVE CO-PREFIX             TO WSPO-PFX.
 11132     MOVE CO-PHONE              TO WSPO-SFX.
 11133     MOVE WS-PHONE-OUT          TO SS53-6D.
 11134
 11135     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11136
 11137     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11138     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11139     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11140     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11141     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11142     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11143
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL152.cbl
 11145
 11146 7260-READ-DENIAL.
 11147
 11148     MOVE +93                    TO ACTV-SEQ
 11149
 11150
 11151* EXEC CICS HANDLE CONDITION
 11152*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11153*         NOTFND     (7265-READ-CNTL1)
 11154*         ENDFILE    (7265-READ-CNTL1)
 11155*    END-EXEC.
 11156*    MOVE '"$JI''                 ! ? #00010215' TO DFHEIV0
 11157     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 11158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11159     MOVE X'3F20233030303130323135' TO DFHEIV0(25:11)
 11160     CALL 'kxdfhei1' USING DFHEIV0
 11161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11162
 11163
 11164
 11165* EXEC CICS STARTBR
 11166*         DATASET    (ACTV-ID)
 11167*         RIDFLD     (ACTV-KEY)
 11168*         GTEQ
 11169*    END-EXEC.
 11170     MOVE 0
 11171       TO DFHEIV11
 11172*    MOVE '&,         G          &   #00010221' TO DFHEIV0
 11173     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11174     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11175     MOVE X'2020233030303130323231' TO DFHEIV0(25:11)
 11176     CALL 'kxdfhei1' USING DFHEIV0,
 11177           ACTV-ID,
 11178           ACTV-KEY,
 11179           DFHEIV99,
 11180           DFHEIV11,
 11181           DFHEIV99
 11182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11183
 11184
 11185     MOVE 'Y'                    TO ACTV-BROWSE-STARTED.
 11186     MOVE ACTV-PARTIAL-KEY       TO ACTV-SAVE-KEY.
 11187
 11188 7262-READ-NEXT.
 11189
 11190
 11191* EXEC CICS READNEXT
 11192*         SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11193*         RIDFLD  (ACTV-KEY)
 11194*         DATASET (ACTV-ID)
 11195*    END-EXEC.
 11196     MOVE 0
 11197       TO DFHEIV11
 11198*    MOVE '&.S                   )   #00010232' TO DFHEIV0
 11199     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11200     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11201     MOVE X'2020233030303130323332' TO DFHEIV0(25:11)
 11202     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL152.cbl
 11203           ACTV-ID,
 11204           DFHEIV20,
 11205           DFHEIV99,
 11206           ACTV-KEY,
 11207           DFHEIV99,
 11208           DFHEIV11,
 11209           DFHEIV99,
 11210           DFHEIV99
 11211     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11212         DFHEIV20
 11213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11214
 11215
 11216     IF ACTV-PARTIAL-KEY  NOT = ACTV-SAVE-KEY
 11217        GO TO 7265-READ-CNTL1.
 11218     IF AT-TRAILER-TYPE = '2'
 11219        AND AT-PAYMENT-TYPE = 'I'
 11220        AND AT-INT-RATE NUMERIC
 11221        AND AT-INT-RATE NOT = ZEROS
 11222        COMPUTE WS-WORK-INT-RATE = AT-INT-RATE * 100
 11223        MOVE +1                  TO S2
 11224        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
 11225           (S1 > +6)
 11226           IF WS-WORK-INT (S1:1) NOT = '0'
 11227              MOVE WS-WORK-INT (S1:1)
 11228                                 TO SS16-1D (S2:1)
 11229              ADD +1             TO S2
 11230           END-IF
 11231        END-PERFORM
 11232        MOVE '%'                 TO SS16-1D (S2:1)
 11233        GO TO 7262-READ-NEXT
 11234     END-IF
 11235     IF AT-TRAILER-TYPE = '8'
 11236        MOVE AT-DENIAL-INFO-1    TO SS35-1D
 11237        MOVE AT-DENIAL-INFO-2    TO SS35-2D
 11238        IF (CL-TOTAL-INT-PAID = ZEROS)
 11239           OR (CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1)
 11240           GO TO 7265-READ-CNTL1
 11241        END-IF
 11242     END-IF
 11243     GO TO 7262-READ-NEXT
 11244     .
 11245 7265-READ-CNTL1.
 11246     IF ACTV-BROWSE-STARTED = 'Y'
 11247        MOVE 'N'                  TO ACTV-BROWSE-STARTED
 11248
 11249* EXEC CICS ENDBR
 11250*            DATASET    (ACTV-ID)
 11251*       END-EXEC.
 11252     MOVE 0
 11253       TO DFHEIV11
 11254*    MOVE '&2                    $   #00010270' TO DFHEIV0
 11255     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11257     MOVE X'2020233030303130323730' TO DFHEIV0(25:11)
 11258     CALL 'kxdfhei1' USING DFHEIV0,
 11259           ACTV-ID,
 11260           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL152.cbl
 11261           DFHEIV99
 11262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11263
 11264
 11265     IF SS35-1D = ALL '*'
 11266         MOVE '@@DENIAL1'        TO SS35-1D.
 11267
 11268     IF SS35-2D = ALL '*'
 11269         MOVE '@@DENIAL2'        TO SS35-2D.
 11270
 11271     MOVE '1'                    TO CNTL-RECORD-TYPE.
 11272     MOVE ZEROS                  TO CNTL-SEQ.
 11273
 11274* EXEC CICS HANDLE CONDITION
 11275*         NOTOPEN   (8840-CNTL-NOT-OPEN)
 11276*         NOTFND    (7266-READ-CNTL2)
 11277*    END-EXEC.
 11278*    MOVE '"$JI                  ! @ #00010282' TO DFHEIV0
 11279     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11281     MOVE X'4020233030303130323832' TO DFHEIV0(25:11)
 11282     CALL 'kxdfhei1' USING DFHEIV0
 11283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11284
 11285
 11286
 11287* EXEC CICS READ
 11288*         DATASET   (CNTL-ID)
 11289*         SET       (ADDRESS OF CONTROL-FILE)
 11290*         RIDFLD    (CNTL-KEY)
 11291*    END-EXEC.
 11292*    MOVE '&"S        E          (   #00010287' TO DFHEIV0
 11293     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11295     MOVE X'2020233030303130323837' TO DFHEIV0(25:11)
 11296     CALL 'kxdfhei1' USING DFHEIV0,
 11297           CNTL-ID,
 11298           DFHEIV20,
 11299           DFHEIV99,
 11300           CNTL-KEY,
 11301           DFHEIV99,
 11302           DFHEIV99,
 11303           DFHEIV99
 11304     SET ADDRESS OF CONTROL-FILE TO
 11305         DFHEIV20
 11306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11307
 11308
 11309     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11310     MOVE CF-CL-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11311     MOVE CF-CL-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11312     MOVE CF-CL-ADDR-LINE-1      TO WS-LABEL-LINES (3).
 11313     MOVE CF-CL-ADDR-LINE-2      TO WS-LABEL-LINES (4).
 11314     MOVE CF-CL-CITY-STATE       TO WS-LABEL-LINES (5).
 11315
 11316     IF CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11317         MOVE ZEROS              TO  CF-CL-ZIP-CODE-NUM.
 11318     IF CF-CL-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL152.cbl
 11319         MOVE CF-CL-ZIP-CODE-NUM TO  WS-ZIP-NUMERIC
 11320         MOVE WS-ZIP-NONNUM      TO  CF-CL-ZIP-CODE.
 11321
 11322     MOVE SPACES                 TO  WS-ZIP-CODE.
 11323     IF CF-CL-CAN-POST-CODE
 11324         MOVE CF-CL-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11325         MOVE CF-CL-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11326     ELSE
 11327         MOVE CF-CL-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11328         IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11329             MOVE '-'              TO  WS-AM-ZIP-DASH
 11330             MOVE CF-CL-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11331
 11332     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (6).
 11333
 11334     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11335
 11336     MOVE WS-LABEL-LINES (1)     TO SS01D.
 11337     MOVE WS-LABEL-LINES (2)     TO SS02-1D.
 11338     MOVE WS-LABEL-LINES (3)     TO SS02-2D.
 11339     MOVE WS-LABEL-LINES (4)     TO SS02-3D.
 11340     MOVE WS-LABEL-LINES (5)     TO SS02-4D.
 11341     MOVE WS-LABEL-LINES (6)     TO SS02-5D.
 11342
 11343 7266-READ-CNTL2.
 11344     IF PI-PROCESSOR-ID  =  LGXX-ID
 11345        GO TO 7267-READ-CNTL4.
 11346
 11347     MOVE '2'                    TO CNTL-RECORD-TYPE.
 11348     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
 11349     MOVE ZEROS                  TO CNTL-SEQ.
 11350
 11351
 11352* EXEC CICS HANDLE CONDITION
 11353*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11354*         NOTFND     (7267-READ-CNTL4)
 11355*    END-EXEC.
 11356*    MOVE '"$JI                  ! A #00010335' TO DFHEIV0
 11357     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11359     MOVE X'4120233030303130333335' TO DFHEIV0(25:11)
 11360     CALL 'kxdfhei1' USING DFHEIV0
 11361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11362
 11363
 11364
 11365* EXEC CICS READ
 11366*         DATASET    (CNTL-ID)
 11367*         SET        (ADDRESS OF CONTROL-FILE)
 11368*         RIDFLD     (CNTL-KEY)
 11369*    END-EXEC.
 11370*    MOVE '&"S        E          (   #00010340' TO DFHEIV0
 11371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11373     MOVE X'2020233030303130333430' TO DFHEIV0(25:11)
 11374     CALL 'kxdfhei1' USING DFHEIV0,
 11375           CNTL-ID,
 11376           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL152.cbl
 11377           DFHEIV99,
 11378           CNTL-KEY,
 11379           DFHEIV99,
 11380           DFHEIV99,
 11381           DFHEIV99
 11382     SET ADDRESS OF CONTROL-FILE TO
 11383         DFHEIV20
 11384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11385
 11386
 11387     MOVE CF-PROCESSOR-NAME      TO SS08D.
 11388     MOVE CF-PROCESSOR-TITLE     TO SS09D.
 11389
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL152.cbl
 11391 7267-READ-CNTL4.
 11392*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11393*        GO TO 7267-READ-EMPLAN.
 11394
 11395     IF BEN-HOLD = ZEROS
 11396        GO TO 7267-READ-CNTL6.
 11397
 11398     MOVE BEN-HOLD               TO CNTL-GEN2.
 11399     MOVE SPACES                 TO CNTL-GEN1.
 11400
 11401     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11402        MOVE '4'                 TO CNTL-RECORD-TYPE
 11403     ELSE
 11404        MOVE '5'                 TO CNTL-RECORD-TYPE.
 11405
 11406     MOVE ZEROS                  TO CNTL-SEQ.
 11407
 11408
 11409* EXEC CICS HANDLE CONDITION
 11410*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11411*         NOTFND     (7267-READ-CNTL6)
 11412*    END-EXEC.
 11413*    MOVE '"$JI                  ! B #00010367' TO DFHEIV0
 11414     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11416     MOVE X'4220233030303130333637' TO DFHEIV0(25:11)
 11417     CALL 'kxdfhei1' USING DFHEIV0
 11418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11419
 11420
 11421
 11422* EXEC CICS READ
 11423*         DATASET    (CNTL-ID)
 11424*         SET        (ADDRESS OF CONTROL-FILE)
 11425*         RIDFLD     (CNTL-KEY)
 11426*         GTEQ
 11427*    END-EXEC.
 11428*    MOVE '&"S        G          (   #00010372' TO DFHEIV0
 11429     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11431     MOVE X'2020233030303130333732' TO DFHEIV0(25:11)
 11432     CALL 'kxdfhei1' USING DFHEIV0,
 11433           CNTL-ID,
 11434           DFHEIV20,
 11435           DFHEIV99,
 11436           CNTL-KEY,
 11437           DFHEIV99,
 11438           DFHEIV99,
 11439           DFHEIV99
 11440     SET ADDRESS OF CONTROL-FILE TO
 11441         DFHEIV20
 11442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11443
 11444
 11445     MOVE 1                      TO SUB.
 11446 7267-LOOP.
 11447     IF SUB = 9
 11448        GO TO 7267-READ-CNTL6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL152.cbl
 11449
 11450     IF CF-BENEFIT-CODE (SUB) < BEN-HOLD
 11451        ADD 1 TO SUB
 11452        GO TO 7267-LOOP.
 11453
 11454     IF BEN-HOLD = CF-BENEFIT-CODE (SUB)
 11455        MOVE CF-BENEFIT-DESCRIP (SUB) TO SS22D
 11456        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 11457           OR CL-CLAIM-TYPE = 'I'
 11458           OR CL-CLAIM-TYPE = 'G'
 11459           MOVE CF-BENEFIT-ALPHA (SUB)   TO BENEFIT-WORK
 11460           MOVE ELIM-DAYS                TO SS42D.
 11461
 11462     GO TO 7267-READ-CNTL6.
 11463
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL152.cbl
 11465*7267-READ-EMPLAN. Remove as dead code
 11466 7267-READ-CNTL6.
 11467     MOVE '6'                    TO CNTL-RECORD-TYPE.
 11468     MOVE SPACES                 TO CNTL-GENL.
 11469
 11470*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11471*        MOVE CL-CURRENT-CARRIER TO CNTL-GEN4
 11472*    ELSE
 11473         MOVE PI-CARRIER         TO CNTL-GEN4.
 11474
 11475     MOVE ZEROS                  TO CNTL-SEQ.
 11476
 11477
 11478* EXEC CICS HANDLE CONDITION
 11479*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11480*         NOTFND     (7268-SET-DATE)
 11481*    END-EXEC.
 11482*    MOVE '"$JI                  ! C #00010411' TO DFHEIV0
 11483     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11485     MOVE X'4320233030303130343131' TO DFHEIV0(25:11)
 11486     CALL 'kxdfhei1' USING DFHEIV0
 11487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11488
 11489
 11490
 11491* EXEC CICS READ
 11492*         DATASET    (CNTL-ID)
 11493*         SET        (ADDRESS OF CONTROL-FILE)
 11494*         RIDFLD     (CNTL-KEY)
 11495*    END-EXEC.
 11496*    MOVE '&"S        E          (   #00010416' TO DFHEIV0
 11497     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11499     MOVE X'2020233030303130343136' TO DFHEIV0(25:11)
 11500     CALL 'kxdfhei1' USING DFHEIV0,
 11501           CNTL-ID,
 11502           DFHEIV20,
 11503           DFHEIV99,
 11504           CNTL-KEY,
 11505           DFHEIV99,
 11506           DFHEIV99,
 11507           DFHEIV99
 11508     SET ADDRESS OF CONTROL-FILE TO
 11509         DFHEIV20
 11510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11511
 11512
 11513     MOVE SPACES              TO WS-LABEL-HOLD-AREA.
 11514     MOVE CF-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11515     MOVE CF-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11516     MOVE CF-ADDRESS-LINE-1   TO WS-LABEL-LINES (3).
 11517     MOVE CF-ADDRESS-LINE-2   TO WS-LABEL-LINES (4).
 11518     MOVE CF-CITY-STATE       TO WS-LABEL-LINES (5).
 11519
 11520     IF CF-ZIP-CODE-NUM NOT NUMERIC
 11521         MOVE ZEROS              TO  CF-ZIP-CODE-NUM.
 11522     IF CF-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL152.cbl
 11523         MOVE CF-ZIP-CODE-NUM    TO  WS-ZIP-NUMERIC
 11524         MOVE WS-ZIP-NONNUM      TO  CF-ZIP-CODE.
 11525
 11526     MOVE SPACES              TO  WS-ZIP-CODE.
 11527     IF CF-CANADIAN-POST-CODE
 11528         MOVE CF-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 11529         MOVE CF-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 11530     ELSE
 11531         MOVE CF-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 11532         IF CF-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11533             MOVE '-'          TO  WS-AM-ZIP-DASH
 11534             MOVE CF-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 11535
 11536     MOVE WS-ZIP-CODE         TO  WS-LABEL-LINES (6).
 11537
 11538     MOVE CF-PHONE-NO         TO WS-PHONE-IN.
 11539     MOVE WSPI-AREA           TO WSPO-AREA.
 11540     MOVE WSPI-PFX            TO WSPO-PFX.
 11541     MOVE WSPI-SFX            TO WSPO-SFX.
 11542     MOVE WS-PHONE-OUT        TO SS04-6D.
 11543
 11544     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11545
 11546     MOVE WS-LABEL-LINES (1)  TO SS03D
 11547     IF PI-CARRIER = '8'
 11548        MOVE 'as Administrator for Investors Heritage Life Insuran
 11549-     'ce Company'               TO SS03-1D
 11550     END-IF
 11551     MOVE WS-LABEL-LINES (2)  TO SS04-1D.
 11552     MOVE WS-LABEL-LINES (3)  TO SS04-2D.
 11553     MOVE WS-LABEL-LINES (4)  TO SS04-3D.
 11554     MOVE WS-LABEL-LINES (5)  TO SS04-4D.
 11555     MOVE WS-LABEL-LINES (6)  TO SS04-5D.
 11556
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL152.cbl
 11558 7268-SET-DATE.
 11559     MOVE EIBDATE                TO DATE-WORK.
 11560     MOVE DT-WORK                TO DC-JULIAN-YYDDD.
 11561     MOVE '5'                    TO DC-OPTION-CODE.
 11562     PERFORM 9700-DATE-LINK  THRU  9700-EXIT.
 11563     MOVE DC-GREG-DATE-1-EDIT    TO SS20D.
 11564     MOVE DC-GREG-DATE-1-ALPHA   TO SS21D.
 11565
 11566     IF NOT LOWER-CASE-LETTERS-USED
 11567        GO TO 7269-EXIT.
 11568
 11569*    IF PI-COMPANY-ID = 'DMD'
 11570*        MOVE SS21D              TO WS-TEMP-AREA2
 11571*        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11572*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11573*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11574*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11575*        END-IF
 11576*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11577*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11578*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11579*        END-IF
 11580*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11581*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11582*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11583*        END-IF
 11584*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11585*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11586*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11587*        END-IF
 11588*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11589*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11590*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11591*        END-IF
 11592*        MOVE WS-TEMP-AREA2      TO SS21D
 11593*        GO TO 7269-EXIT.
 11594*
 11595     INSPECT SS19D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11596     INSPECT SS35-1D CONVERTING UPPER-CASE TO LOWER-CASE.
 11597     INSPECT SS35-2D CONVERTING UPPER-CASE TO LOWER-CASE.
 11598     INSPECT SS22D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11599
 11600     MOVE 'N'                    TO WS-STATE-LINE.
 11601
 11602     MOVE 'Y'                    TO WS-PROCESSOR-LINE.
 11603     MOVE SS08D                  TO WS-TEMP-AREA2.
 11604     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11605     MOVE WS-TEMP-AREA2          TO SS08D.
 11606     MOVE 'N'                    TO WS-PROCESSOR-LINE.
 11607     MOVE 'N'                    TO WS-CAPS-SW.
 11608
 11609     MOVE SS09D                  TO WS-TEMP-AREA2.
 11610     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11611     MOVE WS-TEMP-AREA2          TO SS09D.
 11612
 11613     MOVE SS11-5D                TO WS-TEMP-AREA2.
 11614     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11615     MOVE WS-TEMP-AREA2          TO SS11-5D.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL152.cbl
 11616
 11617     MOVE SS21D                  TO WS-TEMP-AREA2.
 11618     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11619     MOVE WS-TEMP-AREA2          TO SS21D.
 11620
 11621     MOVE SS40D                  TO WS-TEMP-AREA2.
 11622     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11623     MOVE WS-TEMP-AREA2          TO SS40D.
 11624
 11625     MOVE SS41D                  TO WS-TEMP-AREA2.
 11626     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11627     MOVE WS-TEMP-AREA2          TO SS41D.
 11628
 11629 7269-EXIT.
 11630     EXIT.
 11631
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL152.cbl
 11633*            COPY ELCNAMET.
 11634*****************************************************************
 11635*                                                               *
 11636*                                                               *
 11637*                            ELCNAMET                           *
 11638*                            VMOD=2.003                         *
 11639*                                                               *
 11640*            TRANSLATION ROUTINE USED MAINLY FOR CONVERTING     *
 11641*            NAMES AND ADDRESSES AND OTHER VARIABLES TO         *
 11642*            LOWER CASE.  THE FIRST CHARACTER OF EACH WORD      *
 11643*            IS LEFT AS UPPER AND ALL OTHER LOWER CASE.         *
 11644*                                                               *
 11645*                                                               *
 11646*****************************************************************.
 11647*                   C H A N G E   L O G
 11648*
 11649* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 11650*-----------------------------------------------------------------
 11651*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 11652* EFFECTIVE    NUMBER
 11653*-----------------------------------------------------------------
 11654* 102703                   SMVA  LEAVE CERTIFICATION DESIGNATION O
 11655*                                PROCESSOR NAME LINE IN CAPS
 11656******************************************************************
 11657
 11658 7270-LABEL-MOVE.
 11659     IF WS-LABEL-HOLD-AREA = SPACES
 11660        GO TO 7279-EXIT.
 11661
 11662     IF PI-COMPANY-ID NOT = 'DMD'
 11663         PERFORM 7280-TRANSLATE-LOWER THRU 7280-EXIT.
 11664
 11665 7270-LABEL-MOVE-1.
 11666
 11667     IF WS-LABEL-LINES (1) = SPACES
 11668        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
 11669        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11670        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11671        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11672        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11673        MOVE SPACES              TO WS-LABEL-LINES (6)
 11674        GO TO 7270-LABEL-MOVE-1.
 11675
 11676     IF WS-LABEL-LINES (2) = SPACES AND
 11677        WS-LABEL-LINES (3) = SPACES AND
 11678        WS-LABEL-LINES (4) = SPACES AND
 11679        WS-LABEL-LINES (5) = SPACES AND
 11680        WS-LABEL-LINES (6) = SPACES
 11681        SET WS-NDX               TO 1
 11682        GO TO 7275-MOVE-ZIP.
 11683
 11684 7270-LABEL-MOVE-2.
 11685
 11686     IF WS-LABEL-LINES (2) = SPACES
 11687        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11688        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11689        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11690        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL152.cbl
 11691        MOVE SPACES              TO WS-LABEL-LINES (6)
 11692        GO TO 7270-LABEL-MOVE-2.
 11693
 11694     IF WS-LABEL-LINES (3) = SPACES AND
 11695        WS-LABEL-LINES (4) = SPACES AND
 11696        WS-LABEL-LINES (5) = SPACES AND
 11697        WS-LABEL-LINES (6) = SPACES
 11698        SET WS-NDX               TO 2
 11699        GO TO 7275-MOVE-ZIP.
 11700
 11701 7270-LABEL-MOVE-3.
 11702
 11703     IF WS-LABEL-LINES (3) = SPACES
 11704        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11705        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11706        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11707        MOVE SPACES              TO WS-LABEL-LINES (6)
 11708        GO TO 7270-LABEL-MOVE-3.
 11709
 11710     IF WS-LABEL-LINES (4) = SPACES AND
 11711        WS-LABEL-LINES (5) = SPACES AND
 11712        WS-LABEL-LINES (6) = SPACES
 11713        SET WS-NDX               TO 3
 11714        GO TO 7275-MOVE-ZIP.
 11715
 11716 7270-LABEL-MOVE-4.
 11717
 11718     IF WS-LABEL-LINES (4) = SPACES
 11719        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11720        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11721        MOVE SPACES              TO WS-LABEL-LINES (6)
 11722        GO TO 7270-LABEL-MOVE-4.
 11723
 11724     IF WS-LABEL-LINES (5) = SPACES AND
 11725        WS-LABEL-LINES (6) = SPACES
 11726        SET WS-NDX               TO 4
 11727        GO TO 7275-MOVE-ZIP.
 11728
 11729 7270-LABEL-MOVE-5.
 11730
 11731     IF WS-LABEL-LINES (5) = SPACES
 11732        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11733        MOVE SPACES              TO WS-LABEL-LINES (6)
 11734        SET WS-NDX               TO 5
 11735        GO TO 7275-MOVE-ZIP
 11736
 11737     ELSE
 11738        IF WS-LABEL-LINES (6) = SPACES
 11739           SET WS-NDX            TO 5
 11740           GO TO 7275-MOVE-ZIP
 11741
 11742        ELSE
 11743           SET WS-NDX            TO 6.
 11744
 11745 7275-MOVE-ZIP.
 11746
 11747     SET WS-NDX2                 TO WS-NDX.
 11748     SET WS-NDX2 DOWN BY +1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL152.cbl
 11749
 11750     IF  WS-LAST-ZIP (WS-NDX2) = SPACES
 11751*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 11752         IF WS-LABEL-1ST-ZIP (WS-NDX) NUMERIC
 11753          IF PI-COMPANY-ID NOT = 'FLA'
 11754            MOVE WS-LABEL-ZIP (WS-NDX)
 11755                                     TO WS-LAST-ZIP (WS-NDX2)
 11756            MOVE SPACES              TO WS-LABEL-LINES (WS-NDX).
 11757
 11758 7279-EXIT.
 11759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL152.cbl
 11761
 11762 7280-TRANSLATE-LOWER.
 11763     IF LOWER-CASE-LETTERS-USED
 11764        MOVE 'N'                     TO WS-STATE-LINE
 11765     ELSE
 11766        GO TO 7280-EXIT.
 11767
 11768     IF WS-LABEL-LINES (1) NOT = SPACES
 11769        MOVE WS-LABEL-LINES (1)      TO WS-TEMP-AREA2
 11770        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11771        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (1).
 11772
 11773     IF WS-LABEL-LINES (2) NOT = SPACES
 11774        MOVE WS-LABEL-LINES (2)      TO WS-TEMP-AREA2
 11775        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11776        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (2).
 11777
 11778     IF WS-LABEL-LINES (3) NOT = SPACES
 11779        MOVE WS-LABEL-LINES (3)      TO WS-TEMP-AREA2
 11780        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11781        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (3).
 11782
 11783*****THE CITY STATE WILL BE ON LINE FOUR OR FIVE DEPENDING
 11784*****ON THE FORMAT USED.  THE SIXTH LINE BEING BLANK WILL TELL.
 11785
 11786
 11787     IF WS-LABEL-LINES (4) NOT = SPACES
 11788        IF (WS-LABEL-LINES (6) = SPACES  OR
 11789           WS-LABEL-LINES (5) = SPACES)
 11790           MOVE 'Y'                     TO WS-STATE-LINE
 11791           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11792           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11793           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4)
 11794        ELSE
 11795           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11796           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11797           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4).
 11798
 11799     IF WS-LABEL-LINES (5) NOT = SPACES
 11800        IF WS-LABEL-LINES (6) NOT = SPACES
 11801           MOVE 'Y'                     TO WS-STATE-LINE
 11802           MOVE WS-LABEL-LINES (5)      TO WS-TEMP-AREA2
 11803           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11804           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (5).
 11805
 11806 7280-EXIT.
 11807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL152.cbl
 11809
 11810 7281-SEARCH-AND-TRANSLATE.
 11811     SET TA1  TO +1.
 11812
 11813 7281-FIND-FIRST-NON-BLANK.
 11814     IF WS-TEMP-2 (TA1) = SPACES
 11815        SET TA1 UP BY 1
 11816        GO TO 7281-FIND-FIRST-NON-BLANK.
 11817
 11818*****SET INDEX TO THE NEXT CHAR TO START THE TRANSLATE.
 11819     SET TA2   TO TA1
 11820     SET TA2   UP BY 1
 11821     SET TA21  TO TA2
 11822     SET TA21  UP BY 1.
 11823
 11824     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11825     PERFORM 7282-FIND-NEXT-BLANK THRU 7282-EXIT.
 11826
 11827 7281-EXIT.
 11828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL152.cbl
 11830
 11831 7282-FIND-NEXT-BLANK.
 11832     IF TA21 GREATER THAN 31
 11833        GO TO 7282-EXIT.
 11834
 11835     IF TA21 EQUAL TO 31
 11836        IF NO-CHARACTERS-FOUND
 11837           GO TO 7282-EXIT
 11838           ELSE
 11839           SET TA1   TO +1
 11840           MOVE SPACES             TO WS-TEMP-AREA1
 11841           PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11842                   UNTIL MOVE-INDX EQUAL TO TA21
 11843           PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT
 11844           SET TA1   TO +1
 11845           PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11846                   UNTIL MOVE-INDX EQUAL TO TA21
 11847           GO TO 7282-EXIT.
 11848
 11849     IF WS-TEMP-2 (TA2)  = SPACE OR ',' OR '/'
 11850         GO TO 7282-NEXT-GROUP-SEARCH.
 11851
 11852     IF WS-TEMP-2 (TA21) = SPACES OR ',' OR '/'
 11853         IF WS-TEMP-2 (TA21)  = ','
 11854            AND WS-PROCESSOR-LINE = 'Y'
 11855             SET THE-REST-R-CAPS TO TRUE
 11856         ELSE
 11857             CONTINUE
 11858     ELSE
 11859         MOVE 'Y'                  TO WS-DATA-FOUND-SW
 11860         SET TA21 UP BY +1
 11861         GO TO 7282-FIND-NEXT-BLANK.
 11862
 11863     SET TA1  TO +1
 11864     MOVE SPACES                   TO WS-TEMP-AREA1.
 11865     PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11866             UNTIL MOVE-INDX EQUAL TO TA21
 11867     PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT.
 11868     SET TA1  TO +1
 11869     PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11870             UNTIL MOVE-INDX EQUAL TO TA21
 11871     IF THE-REST-R-CAPS
 11872         GO TO 7282-EXIT.
 11873     SET TA2   TO TA21
 11874     SET TA21  UP BY 1
 11875     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11876 7282-NEXT-GROUP-SEARCH.
 11877     IF WS-TEMP-2 (TA2) EQUAL TO SPACES OR ',' OR '/'
 11878        SET TA2   UP BY 1
 11879        IF TA2 = 30
 11880           GO TO 7282-EXIT
 11881           ELSE
 11882           GO TO 7282-NEXT-GROUP-SEARCH.
 11883
 11884     SET TA2    UP BY 1
 11885     SET TA21   TO TA2
 11886     SET TA21   UP BY 1
 11887     GO TO 7282-FIND-NEXT-BLANK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL152.cbl
 11888
 11889 7282-EXIT.
 11890     EXIT.
 11891
 11892
 11893 7283-MOVE.
 11894     MOVE WS-TEMP-2 (MOVE-INDX) TO WS-TEMP-1 (TA1)
 11895     SET TA1 UP BY +1.
 11896
 11897
 11898 7284-MOVE-BACK.
 11899     MOVE WS-TEMP-1 (TA1)       TO WS-TEMP-2 (MOVE-INDX).
 11900     SET TA1 UP BY +1.
 11901
 11902 7285-TEST-AND-TRANSLATE.
 11903***BYPASS IF THE AREA MAY BE A PO BOX, OR RR NUMBER
 11904     IF WS-TEMP-AREA1 = '.O.' OR 'RR' OR 'O'
 11905        GO TO 7285-EXIT.
 11906
 11907***BYPASS IF IT IS A CITY/STATE LINE AND BEYOND CHARACTER 07
 11908***AND IT APPEARS THAT IT MAY BE A ABREVIATION.
 11909
 11910     SET WS-POSITION2   TO TA2
 11911     SET WS-POSITION21  TO TA21
 11912     COMPUTE WS-WORD-LENGTH = WS-POSITION21 - WS-POSITION2
 11913     IF WS-WORD-LENGTH LESS THAN 3 AND
 11914        WS-STATE-LINE = 'Y' AND
 11915        TA2 GREATER THAN 07
 11916        GO TO 7285-EXIT.
 11917
 11918     INSPECT WS-TEMP-AREA1 CONVERTING UPPER-CASE TO LOWER-CASE.
 11919
 11920 7285-EXIT.
 11921     EXIT.
 11922
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL152.cbl
 11924 7290-RESOLVE-CREDITOR.
 11925
 11926
 11927* EXEC CICS HANDLE CONDITION
 11928*         NOTOPEN    (7290-BENE-NOT-OPEN)
 11929*         NOTFND     (7290-EXIT)
 11930*    END-EXEC.
 11931*    MOVE '"$JI                  ! D #00010835' TO DFHEIV0
 11932     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11934     MOVE X'4420233030303130383335' TO DFHEIV0(25:11)
 11935     CALL 'kxdfhei1' USING DFHEIV0
 11936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11937
 11938
 11939     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11940
 11941     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 11942     MOVE 'B'                    TO BENE-REC-TYPE.
 11943     MOVE SPACES                 TO BENE-NUMBER.
 11944     MOVE CL-CURRENT-GROUPING    TO BENE-CREDITOR.
 11945
 11946
 11947* EXEC CICS READ
 11948*         DATASET    (BENE-ID)
 11949*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 11950*         RIDFLD     (BENE-KEY)
 11951*    END-EXEC.
 11952*    MOVE '&"S        E          (   #00010847' TO DFHEIV0
 11953     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11955     MOVE X'2020233030303130383437' TO DFHEIV0(25:11)
 11956     CALL 'kxdfhei1' USING DFHEIV0,
 11957           BENE-ID,
 11958           DFHEIV20,
 11959           DFHEIV99,
 11960           BENE-KEY,
 11961           DFHEIV99,
 11962           DFHEIV99,
 11963           DFHEIV99
 11964     SET ADDRESS OF BENEFICIARY-MASTER TO
 11965         DFHEIV20
 11966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11967
 11968
 11969     IF LOWER-CASE-LETTERS-USED
 11970         MOVE BE-MAIL-TO-NAME    TO WS-TEMP-AREA2
 11971         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11972         MOVE WS-TEMP-AREA2      TO SS56D
 11973     ELSE
 11974         MOVE BE-MAIL-TO-NAME    TO SS56D.
 11975
 11976     GO TO 7290-EXIT.
 11977
 11978 7290-BENE-NOT-OPEN.
 11979
 11980     MOVE ER-7675                TO EMI-ERROR.
 11981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL152.cbl
 11982     MOVE -1                     TO MAINTL.
 11983     GO TO 8200-SEND-DATAONLY.
 11984
 11985 7290-EXIT.
 11986     EXIT.
 11987
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL152.cbl
 11989 7300-VARIABLE-SEARCH.
 11990***************************************************************
 11991*    THIS ROUTINE SEARCHES THE NEWLY CREATED LETTER FOR ANY   *
 11992*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 11993*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 11994*    DATA THAT WAS GENERATED IN PARAGRAPHS 7200-7299.         *
 11995*                                                             *
 11996*    THE ADDRESSING OF THE VARIABLE TABLE IS ACCOMPLISHED     *
 11997*    BY DOING A GETMAIN, MOVING THE TABLE TO THE NEW STORAGE  *
 11998*    AND BY ADJUSTING THE BLL POINTER TO POINT AT THE DATA.   *
 11999***************************************************************
 12000
 12001     MOVE REC-TEXT (TB-INDX)     TO SINGLE-LINE.
 12002
 12003     SET INDX1 TO 1.
 12004 7301-LOOP.
 12005     IF INDX1 > 70
 12006        MOVE SINGLE-LINE         TO REC-TEXT (TB-INDX)
 12007        GO TO 7399-EXIT.
 12008
 12009     IF ONE-CHAR (INDX1) NOT = '@'
 12010        SET INDX1 UP BY 1
 12011        GO TO 7301-LOOP.
 12012
 12013     SET INDX2 TO INDX1.
 12014     SET INDX2 UP BY 1.
 12015
 12016     IF ONE-CHAR (INDX2) = '@'
 12017        SET INDX1 UP BY 2
 12018        GO TO 7301-LOOP.
 12019
 12020     MOVE ONE-CHAR (INDX2)       TO V1.
 12021     SET INDX2 UP BY 1.
 12022     MOVE ONE-CHAR (INDX2)       TO V2.
 12023     SET INDX2 UP BY 1.
 12024     MOVE ONE-CHAR (INDX2)       TO V3.
 12025     SET INDX2 UP BY 1.
 12026     MOVE ONE-CHAR (INDX2)       TO V4.
 12027
 12028     IF V-NUM NOT NUMERIC
 12029        GO TO 7330-VAR-ERROR.
 12030
 12031     IF V-PERIOD NOT = '.'
 12032        MOVE '.'                 TO V-PERIOD
 12033        MOVE ZERO                TO V-DECIMAL
 12034        GO TO 7340-TABLE-SEARCH.
 12035
 12036     IF V-DECIMAL NUMERIC
 12037        GO TO 7340-TABLE-SEARCH.
 12038
 12039 7330-VAR-ERROR.
 12040     MOVE ER-0180                TO EMI-ERROR.
 12041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12042     SET INDX1 UP BY 1.
 12043     GO TO 7301-LOOP.
 12044
 12045 7340-TABLE-SEARCH.
 12046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL152.cbl
 12047     IF REFRESH-GETMAIN-AREA
 12048*        MOVE SAVE-VARIABLE-POINTER      TO LCP-WS-ADDR-COMP
 12049*        SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12050         MOVE SYSTEM-SUPPORTED-VARIABLES TO SYSTEM-VARIABLES
 12051         MOVE 2                          TO GETMAIN-SWITCH
 12052         MOVE 1                          TO SS-COUNTER
 12053                                            B1
 12054     ELSE
 12055         IF NO-GETMAIN-DONE-YET
 12056*            EXEC CICS GETMAIN
 12057*                 SET       (ADDRESS OF SYSTEM-VARIABLES)
 12058*                 LENGTH    (SS-WORK-AREA-LENGTH)
 12059*            END-EXEC
 12060             MOVE 2              TO GETMAIN-SWITCH
 12061*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12062*            MOVE LCP-WS-ADDR-COMP
 12063*                                TO SAVE-VARIABLE-POINTER
 12064             MOVE SYSTEM-SUPPORTED-VARIABLES
 12065                                 TO SYSTEM-VARIABLES
 12066             MOVE 1              TO SS-COUNTER
 12067                                    B1
 12068         ELSE
 12069             MOVE 1              TO SS-COUNTER
 12070                                    B1
 12071*            MOVE SAVE-VARIABLE-POINTER
 12072*                                TO LCP-WS-ADDR-COMP
 12073*            SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12074         END-IF
 12075     END-IF
 12076     .
 12077 7350-TABLE-LOOP.
 12078
 12079     IF SS-COUNTER  >  SS-NUM-ENTRIES
 12080        GO TO 7330-VAR-ERROR.
 12081
 12082     MOVE SYSTEM-VARIABLES (B1:106)
 12083                                 TO SYS-VAR-ENTRY
 12084     IF SYS-VAR-CODE NOT = VAR-HOLD
 12085        ADD SYS-VAR-LEN          TO B1
 12086*       SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12087*       ADD SYS-VAR-LEN          TO LCP-WS-ADDR-COMP
 12088*       SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12089        ADD 1                    TO SS-COUNTER
 12090        GO TO 7350-TABLE-LOOP
 12091     END-IF
 12092
 12093     MOVE SYS-VAR-ENTRY          TO VARIABLE-WORK-AREA.
 12094     SET INDXV TO 1.
 12095     SUBTRACT 6                  FROM VAR-LEN.
 12096     PERFORM 7400-MOVE-VAR-DATA VAR-LEN TIMES.
 12097     GO TO 7301-LOOP.
 12098
 12099 7399-EXIT.
 12100      EXIT.
 12101
 12102 7400-MOVE-VAR-DATA.
 12103     IF INDX1 > 70
 12104        MOVE ER-0181             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL152.cbl
 12105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12106        GO TO 7301-LOOP.
 12107
 12108     MOVE VAR-ONE-CHAR (INDXV)   TO ONE-CHAR (INDX1).
 12109     SET INDXV UP BY 1.
 12110     SET INDX1 UP BY 1.
 12111
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL152.cbl
 12113 7500-READ-TS.
 12114
 12115* EXEC CICS HANDLE CONDITION
 12116*         QIDERR     (7590-TS-QIDERR)
 12117*         ITEMERR    (7585-TS-ITEMERR)
 12118*    END-EXEC.
 12119*    MOVE '"$N<                  ! E #00010998' TO DFHEIV0
 12120     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12122     MOVE X'4520233030303130393938' TO DFHEIV0(25:11)
 12123     CALL 'kxdfhei1' USING DFHEIV0
 12124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12125
 12126
 12127     SET TS-INDX TO 1.
 12128     MOVE 1                      TO TS-ITEM.
 12129
 12130 7501-LOOP.
 12131
 12132* EXEC CICS READQ TS
 12133*         INTO     (TS-WORK-AREA)
 12134*         QUEUE    (TS-NAME-TEXT)
 12135*         LENGTH   (TS-LENGTH)
 12136*         ITEM     (TS-ITEM)
 12137*    END-EXEC.
 12138*    MOVE '*$II   L              ''   #00011007' TO DFHEIV0
 12139     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12140     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12141     MOVE X'2020233030303131303037' TO DFHEIV0(25:11)
 12142     CALL 'kxdfhei1' USING DFHEIV0,
 12143           TS-NAME-TEXT,
 12144           TS-WORK-AREA,
 12145           TS-LENGTH,
 12146           TS-ITEM,
 12147           DFHEIV99,
 12148           DFHEIV99
 12149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12150
 12151
 12152     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
 12153     SET TS-INDX UP BY 1.
 12154     ADD 1                       TO TS-ITEM.
 12155     GO TO 7501-LOOP.
 12156
 12157 7585-TS-ITEMERR.
 12158     IF EIBTRNID NOT = TRANS-ID
 12159        SUBTRACT 1               FROM TS-ITEM
 12160        MOVE TS-ITEM             TO PI-TEMP-STOR-ITEMS.
 12161
 12162     GO TO 7599-EXIT.
 12163
 12164 7590-TS-QIDERR.
 12165     IF EIBTRNID = TRANS-ID
 12166        MOVE ER-0033             TO EMI-ERROR
 12167        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12168        GO TO 8200-SEND-DATAONLY.
 12169
 12170 7599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL152.cbl
 12171      EXIT.
 12172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL152.cbl
 12174 7600-READ-SCREEN-TS.
 12175
 12176* EXEC CICS HANDLE CONDITION
 12177*         QIDERR     (7690-TS-QIDERR)
 12178*         ITEMERR    (7685-TS-ITEMERR)
 12179*    END-EXEC.
 12180*    MOVE '"$N<                  ! F #00011037' TO DFHEIV0
 12181     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12183     MOVE X'4620233030303131303337' TO DFHEIV0(25:11)
 12184     CALL 'kxdfhei1' USING DFHEIV0
 12185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12186
 12187
 12188     MOVE 1                      TO TS-ITEM.
 12189
 12190
 12191* EXEC CICS READQ TS
 12192*         INTO    (EL152AO)
 12193*         QUEUE   (TS-NAME-SCREEN)
 12194*         LENGTH  (TS-MAP-LENGTH)
 12195*         ITEM    (TS-ITEM)
 12196*    END-EXEC.
 12197*    MOVE '*$II   L              ''   #00011044' TO DFHEIV0
 12198     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12199     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12200     MOVE X'2020233030303131303434' TO DFHEIV0(25:11)
 12201     CALL 'kxdfhei1' USING DFHEIV0,
 12202           TS-NAME-SCREEN,
 12203           EL152AO,
 12204           TS-MAP-LENGTH,
 12205           TS-ITEM,
 12206           DFHEIV99,
 12207           DFHEIV99
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12209
 12210
 12211     IF MAINTL NOT = ZEROS
 12212        MOVE AL-UANON            TO MAINTA.
 12213     IF ARCHNUML NOT = ZEROS
 12214        MOVE AL-UNNON            TO ARCHNUMA.
 12215     IF FORML NOT = ZEROS
 12216        MOVE AL-UANON            TO FORMA.
 12217     IF FOLLOWL NOT = ZEROS
 12218        MOVE AL-UANON            TO FOLLOWA.
 12219     IF RESENDL NOT = ZEROS
 12220        MOVE AL-UANON            TO RESENDA.
 12221     IF PRINTL NOT = ZEROS
 12222        MOVE AL-UANON            TO PRINTA.
 12223     IF COPIESL NOT = ZEROS
 12224        MOVE AL-UNNON            TO COPIESA.
 12225     IF ADDRL NOT = ZEROS
 12226        MOVE AL-UANON            TO ADDRA.
 12227     IF REL NOT = ZEROS
 12228        MOVE AL-UANON            TO REA.
 12229
 12230     GO TO 7699-EXIT.
 12231
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL152.cbl
 12232 7685-TS-ITEMERR.
 12233     GO TO 7699-EXIT.
 12234
 12235 7690-TS-QIDERR.
 12236     IF EIBTRNID = TRANS-ID
 12237        MOVE ER-0033             TO EMI-ERROR
 12238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12239        GO TO 8200-SEND-DATAONLY.
 12240
 12241 7699-EXIT.
 12242      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL152.cbl
 12244
 12245 7700-PUT-TEMP-STOR.
 12246     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 12247     PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT.
 12248     SET TS-INDX TO 1.
 12249     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12250     PERFORM 7780-WRITE-TS THRU 7780-EXIT
 12251             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12252             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES.
 12253
 12254 7749-EXIT.
 12255      EXIT.
 12256
 12257 7750-DELETE-TEMP-STOR.
 12258
 12259* EXEC CICS HANDLE CONDITION
 12260*         QIDERR      (7750-EXIT)
 12261*    END-EXEC.
 12262*    MOVE '"$N                   ! G #00011098' TO DFHEIV0
 12263     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12265     MOVE X'4720233030303131303938' TO DFHEIV0(25:11)
 12266     CALL 'kxdfhei1' USING DFHEIV0
 12267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12268
 12269
 12270
 12271* EXEC CICS DELETEQ TS
 12272*         QUEUE       (TS-NAME-TEXT)
 12273*    END-EXEC.
 12274*    MOVE '*&                    #   #00011102' TO DFHEIV0
 12275     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12276     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12277     MOVE X'2020233030303131313032' TO DFHEIV0(25:11)
 12278     CALL 'kxdfhei1' USING DFHEIV0,
 12279           TS-NAME-TEXT,
 12280           DFHEIV99
 12281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12282
 12283
 12284 7750-EXIT.
 12285     EXIT.
 12286
 12287 7760-DELETE-TEMP-STOR-SCREEN.
 12288
 12289* EXEC CICS HANDLE CONDITION
 12290*         QIDERR     (7760-EXIT)
 12291*    END-EXEC.
 12292*    MOVE '"$N                   ! H #00011110' TO DFHEIV0
 12293     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12295     MOVE X'4820233030303131313130' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0
 12297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12298
 12299
 12300
 12301* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL152.cbl
 12302*         QUEUE      (TS-NAME-SCREEN)
 12303*    END-EXEC.
 12304*    MOVE '*&                    #   #00011114' TO DFHEIV0
 12305     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12306     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12307     MOVE X'2020233030303131313134' TO DFHEIV0(25:11)
 12308     CALL 'kxdfhei1' USING DFHEIV0,
 12309           TS-NAME-SCREEN,
 12310           DFHEIV99
 12311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12312
 12313
 12314 7760-EXIT.
 12315     EXIT.
 12316
 12317 7770-DELETE-TEMP-STOR-PI-AREA.
 12318
 12319* EXEC CICS HANDLE CONDITION
 12320*        QIDERR   (7770-EXIT)
 12321*    END-EXEC.
 12322*    MOVE '"$N                   ! I #00011122' TO DFHEIV0
 12323     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12325     MOVE X'4920233030303131313232' TO DFHEIV0(25:11)
 12326     CALL 'kxdfhei1' USING DFHEIV0
 12327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12328
 12329
 12330
 12331* EXEC CICS DELETEQ TS
 12332*        QUEUE    (WS-PI-QID)
 12333*    END-EXEC.
 12334*    MOVE '*&                    #   #00011126' TO DFHEIV0
 12335     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12336     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12337     MOVE X'2020233030303131313236' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0,
 12339           WS-PI-QID,
 12340           DFHEIV99
 12341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12342
 12343
 12344 7770-EXIT.
 12345     EXIT.
 12346
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL152.cbl
 12348 7780-WRITE-TS.
 12349     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
 12350     SET TS-INDX UP BY 1.
 12351     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 12352
 12353
 12354* EXEC CICS WRITEQ TS
 12355*         FROM    (TS-WORK-AREA)
 12356*         QUEUE   (TS-NAME-TEXT)
 12357*         LENGTH  (TS-LENGTH)
 12358*         ITEM    (PI-TEMP-STOR-ITEMS)
 12359*    END-EXEC.
 12360*    MOVE '*" I                  ''   #00011139' TO DFHEIV0
 12361     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12363     MOVE X'2020233030303131313339' TO DFHEIV0(25:11)
 12364     CALL 'kxdfhei1' USING DFHEIV0,
 12365           TS-NAME-TEXT,
 12366           TS-WORK-AREA,
 12367           TS-LENGTH,
 12368           PI-TEMP-STOR-ITEMS,
 12369           DFHEIV99,
 12370           DFHEIV99
 12371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12372
 12373
 12374 7780-EXIT.
 12375     EXIT.
 12376
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL152.cbl
 12378 7790-WRITE-SCREEN-TS.
 12379     MOVE 1                      TO TS-ITEM.
 12380
 12381
 12382* EXEC CICS WRITEQ TS
 12383*         FROM    (EL152AI)
 12384*         QUEUE   (TS-NAME-SCREEN)
 12385*         LENGTH  (TS-MAP-LENGTH)
 12386*         ITEM    (TS-ITEM)
 12387*    END-EXEC.
 12388*    MOVE '*" I                  ''   #00011153' TO DFHEIV0
 12389     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12391     MOVE X'2020233030303131313533' TO DFHEIV0(25:11)
 12392     CALL 'kxdfhei1' USING DFHEIV0,
 12393           TS-NAME-SCREEN,
 12394           EL152AI,
 12395           TS-MAP-LENGTH,
 12396           TS-ITEM,
 12397           DFHEIV99,
 12398           DFHEIV99
 12399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12400
 12401
 12402 7790-EXIT.
 12403     EXIT.
 12404
 12405 7795-WRITE-PI-AREA-TS.
 12406
 12407* EXEC CICS WRITEQ TS
 12408*        QUEUE    (WS-PI-QID)
 12409*        FROM     (PROGRAM-INTERFACE-BLOCK)
 12410*        LENGTH   (PI-COMM-LENGTH)
 12411*    END-EXEC.
 12412*    MOVE '*"                    ''   #00011164' TO DFHEIV0
 12413     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 12414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12415     MOVE X'2020233030303131313634' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0,
 12417           WS-PI-QID,
 12418           PROGRAM-INTERFACE-BLOCK,
 12419           PI-COMM-LENGTH,
 12420           DFHEIV99,
 12421           DFHEIV99,
 12422           DFHEIV99
 12423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12424
 12425
 12426 7795-EXIT.
 12427     EXIT.
 12428
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL152.cbl
 12430 7800-PRINT-LETTER-NOW.
 12431***************************************************************
 12432*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 12433*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 12434*        THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS,       *
 12435*        THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE,    *
 12436*        THE LETTER IS SAVED IN TEMP-STORAGE,                 *
 12437*        AND A START IS ISSUED FOR THE PRINT TRANSACTION.     *
 12438***************************************************************
 12439
 12440     PERFORM 400-SET-CODES THRU 499-EXIT.
 12441
 12442     PERFORM 7500-READ-TS        THRU 7599-EXIT
 12443     PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12444     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12445             VARYING SC-INDX FROM 1 BY 1
 12446             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12447
 12448     IF PI-TOTAL-LINES = 0
 12449        MOVE ER-0187             TO EMI-ERROR
 12450        MOVE -1                  TO MAINTL
 12451        MOVE AL-UABON            TO MAINTA
 12452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12453        GO TO 8200-SEND-DATAONLY.
 12454
 12455     IF COPIESL NOT = ZEROS
 12456        IF COPIESI NOT NUMERIC
 12457           MOVE ER-0184          TO EMI-ERROR
 12458           MOVE -1               TO COPIESL
 12459           MOVE AL-UNBON         TO COPIESA
 12460           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12461           GO TO 8200-SEND-DATAONLY
 12462         ELSE
 12463           MOVE COPIESI          TO PI-NUM-PRINT-COPIES
 12464       ELSE
 12465        MOVE 1                   TO PI-NUM-PRINT-COPIES.
 12466
 12467*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12468*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12469*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12470*            VARYING SC-INDX FROM 1 BY 1
 12471*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12472
 12473     MOVE +0                     TO TALLY.
 12474     INSPECT RECORD-TABLE TALLYING TALLY
 12475                                 FOR CHARACTERS BEFORE '@'.
 12476
 12477     IF TALLY < +21900
 12478        COMPUTE PI-CURRENT-LINE = TALLY / 73
 12479        MOVE ZEROS               TO ROLL-COUNTER
 12480        MOVE ER-0191             TO EMI-ERROR
 12481        MOVE -1                  TO MAINTL
 12482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12483        GO TO 7900-ROLL-PAGE.
 12484
 12485 7800-UPDATE-CLAIM.
 12486
 12487     IF PI-RETURN-TO-PROGRAM = PGM-EL126
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 257
* EL152.cbl
 12488         GO TO 7800-GET-PRINTER.
 12489
 12490     MOVE PI-COMPANY-CD          TO  CLAM-CO.
 12491     MOVE PI-CARRIER             TO  CLAM-CARRIER.
 12492     MOVE PI-CLAIM-NO            TO  CLAM-CLAIM.
 12493     MOVE PI-CERT-NO             TO  CLAM-CERT-NUM.
 12494
 12495
 12496* EXEC CICS HANDLE CONDITION
 12497*        NOTOPEN   (8860-CLAM-NOT-OPEN)
 12498*        NOTFND    (7800-CLAIM-NOT-FOUND)
 12499*    END-EXEC.
 12500*    MOVE '"$JI                  ! J #00011239' TO DFHEIV0
 12501     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12503     MOVE X'4A20233030303131323339' TO DFHEIV0(25:11)
 12504     CALL 'kxdfhei1' USING DFHEIV0
 12505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12506
 12507
 12508
 12509* EXEC CICS READ
 12510*        DATASET   (CLAM-ID)
 12511*        RIDFLD    (CLAM-KEY)
 12512*        SET       (ADDRESS OF CLAIM-MASTER)
 12513*        UPDATE
 12514*    END-EXEC.
 12515*    MOVE '&"S        EU         (   #00011244' TO DFHEIV0
 12516     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12517     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12518     MOVE X'2020233030303131323434' TO DFHEIV0(25:11)
 12519     CALL 'kxdfhei1' USING DFHEIV0,
 12520           CLAM-ID,
 12521           DFHEIV20,
 12522           DFHEIV99,
 12523           CLAM-KEY,
 12524           DFHEIV99,
 12525           DFHEIV99,
 12526           DFHEIV99
 12527     SET ADDRESS OF CLAIM-MASTER TO
 12528         DFHEIV20
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12530
 12531
 12532     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
 12533     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
 12534     MOVE CURRENT-SAVE           TO  CL-LAST-MAINT-DT.
 12535     MOVE '2'                    TO  CL-LAST-MAINT-TYPE.
 12536
 12537
 12538* EXEC CICS HANDLE CONDITION
 12539*        DUPKEY    (7800-GET-PRINTER)
 12540*    END-EXEC.
 12541*    MOVE '"$$                   ! K #00011256' TO DFHEIV0
 12542     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12544     MOVE X'4B20233030303131323536' TO DFHEIV0(25:11)
 12545     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 258
* EL152.cbl
 12546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12547
 12548
 12549
 12550* EXEC CICS REWRITE
 12551*        DATASET   (CLAM-ID)
 12552*        FROM      (CLAIM-MASTER)
 12553*    END-EXEC.
 12554     MOVE LENGTH OF
 12555      CLAIM-MASTER
 12556       TO DFHEIV11
 12557*    MOVE '&& L                  %   #00011260' TO DFHEIV0
 12558     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12559     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12560     MOVE X'2020233030303131323630' TO DFHEIV0(25:11)
 12561     CALL 'kxdfhei1' USING DFHEIV0,
 12562           CLAM-ID,
 12563           CLAIM-MASTER,
 12564           DFHEIV11,
 12565           DFHEIV99
 12566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12567
 12568
 12569     GO TO 7800-GET-PRINTER.
 12570
 12571 7800-CLAIM-NOT-FOUND.
 12572
 12573     MOVE ER-0133                TO  EMI-ERROR.
 12574     MOVE -1                     TO  MAINTL.
 12575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12576     GO TO 8200-SEND-DATAONLY.
 12577
 12578 7800-GET-PRINTER.
 12579
 12580     IF PI-ALT-PRINTER-ID NOT = SPACES
 12581        GO TO 7800-CNTL-BYPASS.
 12582
 12583     MOVE '1'                    TO CNTL-RECORD-TYPE.
 12584     MOVE SPACES                 TO CNTL-GENL.
 12585     MOVE ZEROS                  TO CNTL-SEQ.
 12586
 12587
 12588* EXEC CICS HANDLE CONDITION
 12589*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 12590*         NOTFND     (7890-NOT-FOUND)
 12591*    END-EXEC.
 12592*    MOVE '"$JI                  ! L #00011283' TO DFHEIV0
 12593     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12595     MOVE X'4C20233030303131323833' TO DFHEIV0(25:11)
 12596     CALL 'kxdfhei1' USING DFHEIV0
 12597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12598
 12599
 12600
 12601* EXEC CICS READ
 12602*         DATASET    (CNTL-ID)
 12603*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 259
* EL152.cbl
 12604*         RIDFLD     (CNTL-KEY)
 12605*    END-EXEC.
 12606*    MOVE '&"S        E          (   #00011288' TO DFHEIV0
 12607     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12608     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12609     MOVE X'2020233030303131323838' TO DFHEIV0(25:11)
 12610     CALL 'kxdfhei1' USING DFHEIV0,
 12611           CNTL-ID,
 12612           DFHEIV20,
 12613           DFHEIV99,
 12614           CNTL-KEY,
 12615           DFHEIV99,
 12616           DFHEIV99,
 12617           DFHEIV99
 12618     SET ADDRESS OF CONTROL-FILE TO
 12619         DFHEIV20
 12620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12621
 12622
 12623*    MOVE CF-FORMS-PRINTER-ID       TO TS-TERM-TEXT.
 12624     MOVE CF-FORMS-PRINTER-ID    TO WS-PRINTER-ID
 12625     GO TO 7800-SET-UP-TS.
 12626
 12627 7800-CNTL-BYPASS.
 12628*    MOVE PI-ALT-PRINTER-ID         TO TS-TERM-TEXT.
 12629     MOVE PI-ALT-PRINTER-ID      TO WS-PRINTER-ID.
 12630
 12631 7800-SET-UP-TS.
 12632
 12633***********************************************************
 12634*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 12635*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 12636***********************************************************
 12637
 12638     IF TS-TERM-PREFIX = 'DU'
 12639        PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT
 12640        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
 12641
 12642     SET TS-INDX TO 1.
 12643
 12644
 12645* EXEC CICS ASKTIME
 12646*    END-EXEC.
 12647*    MOVE '0"                    "   #00011315' TO DFHEIV0
 12648     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
 12649     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 12650     MOVE X'2020233030303131333135' TO DFHEIV0(25:11)
 12651     CALL 'kxdfhei1' USING DFHEIV0,
 12652           DFHEIV99
 12653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12654
 12655
 12656     MOVE EIBTIME                TO TS-ID-TIME.
 12657*    MOVE '152A'                 TO TS-ID-TEXT
 12658     MOVE TS-NAME-TEXT           TO PI-TEMP-STOR-ID.
 12659     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12660
 12661     PERFORM 7780-WRITE-TS THRU 7780-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 260
* EL152.cbl
 12662             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12663             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
 12664
 12665     IF NOT PI-SHOW-MODE
 12666        MOVE '1'                 TO PI-PRINT-SW.
 12667
 12668
 12669* EXEC CICS HANDLE CONDITION
 12670*         TERMIDERR  (8820-TERM-ERROR)
 12671*         TRANSIDERR (8830-TRAN-ERROR)
 12672*    END-EXEC.
 12673*    MOVE '"$[\                  ! M #00011330' TO DFHEIV0
 12674     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 12675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12676     MOVE X'4D20233030303131333330' TO DFHEIV0(25:11)
 12677     CALL 'kxdfhei1' USING DFHEIV0
 12678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12679
 12680
 12681*    IF PI-COMPANY-ID = 'DMD' OR 'XXX'
 12682*        MOVE EIBTRMID    TO TS-TERM-TEXT
 12683*        EXEC CICS START
 12684*             INTERVAL    (0)
 12685*             TRANSID     (PRINT-TRANS)
 12686*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12687*             LENGTH      (PI-COMM-LENGTH)
 12688*             TERMID      (TS-TERM-TEXT)
 12689*        END-EXEC
 12690*    ELSE
 12691
 12692* EXEC CICS START
 12693*             INTERVAL    (0)
 12694*             TRANSID     (PRINT-TRANS)
 12695*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12696*             LENGTH      (PI-COMM-LENGTH)
 12697*             TERMID      (TS-TERM-TEXT)
 12698*             TERMID      (WS-PRINTER-ID)
 12699*        END-EXEC.
 12700     MOVE 0 TO DFHEIV10
 12701*    MOVE '0(ILFT                0   #00011345' TO DFHEIV0
 12702     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 12703     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
 12704     MOVE X'2020233030303131333435' TO DFHEIV0(25:11)
 12705     CALL 'kxdfhei1' USING DFHEIV0,
 12706           DFHEIV10,
 12707           PRINT-TRANS,
 12708           DFHEIV99,
 12709           PROGRAM-INTERFACE-BLOCK,
 12710           PI-COMM-LENGTH,
 12711           WS-PRINTER-ID,
 12712           DFHEIV99,
 12713           DFHEIV99,
 12714           DFHEIV99,
 12715           DFHEIV99,
 12716           DFHEIV99,
 12717           DFHEIV99,
 12718           DFHEIV99,
 12719           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 261
* EL152.cbl
 12720           DFHEIV99
 12721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12722
 12723
 12724     MOVE '104A'                 TO TS-ID-TEXT
 12725     MOVE ER-0189                TO EMI-ERROR.
 12726     MOVE -1                     TO MAINTL.
 12727     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 12728     MOVE ' PRINT TRANS STARTED ' TO EMI-MESSAGE-AREA (1)
 12729     MOVE PI-TEMP-STOR-ID TO EMI-MESSAGE-AREA (1) (25:10)
 12730
 12731     GO TO 8200-SEND-DATAONLY.
 12732
 12733 7890-NOT-FOUND.
 12734     MOVE ER-0190                TO EMI-ERROR.
 12735     MOVE -1                     TO MAINTL.
 12736     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12737     GO TO 8200-SEND-DATAONLY.
 12738
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 262
* EL152.cbl
 12740 7900-ROLL-PAGE.
 12741     IF ENTERPFL NOT = ZEROS
 12742        MOVE -1                  TO ENTERPFL
 12743       ELSE
 12744        MOVE -1                  TO MAINTL.
 12745
 12746     PERFORM 7500-READ-TS     THRU 7599-EXIT
 12747     PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12748     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12749        VARYING SC-INDX FROM 1 BY 1 UNTIL
 12750        SC-INDX > NUM-LINES-PER-SCREEN
 12751     IF PI-TOTAL-LINES = 0
 12752        MOVE ER-0047             TO EMI-ERROR
 12753        MOVE -1                  TO MAINTL
 12754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12755        GO TO 8200-SEND-DATAONLY.
 12756
 12757     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
 12758
 12759     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12760        MOVE ER-0067             TO EMI-ERROR
 12761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12762        MOVE 1                   TO TEMP-CURR-LINE.
 12763
 12764     IF TEMP-CURR-LINE > PI-TOTAL-LINES
 12765        MOVE ER-0066             TO EMI-ERROR
 12766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12767        COMPUTE TEMP-CURR-LINE
 12768            = PI-TOTAL-LINES + 1 - NUM-LINES-PER-SCREEN
 12769        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12770            MOVE 1 TO TEMP-CURR-LINE.
 12771
 12772*    IF EMI-ERROR NOT = ER-0191
 12773*       PERFORM 7500-READ-TS     THRU 7599-EXIT
 12774*       PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12775*       PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12776*                VARYING SC-INDX FROM 1 BY 1 UNTIL
 12777*                SC-INDX > NUM-LINES-PER-SCREEN
 12778*    END-IF
 12779
 12780     IF EMI-ERROR = ER-0066 OR ER-0067 OR ER-0000 OR ER-0191
 12781        NEXT SENTENCE
 12782     ELSE
 12783        GO TO 8200-SEND-DATAONLY.
 12784
 12785*    PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12786     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
 12787     SET TB-INDX                 TO PI-CURRENT-LINE.
 12788     MOVE LOW-VALUES             TO EL152RI.
 12789
 12790*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12791     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
 12792             VARYING SC-INDX FROM 1 BY 1
 12793             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12794
 12795     GO TO 8200-SEND-DATAONLY.
 12796
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 263
* EL152.cbl
 12798 7950-SET-INDX.
 12799     IF PI-CURRENT-LINE = 0
 12800        SET TB-INDX TO 1
 12801       ELSE
 12802        SET TB-INDX              TO PI-CURRENT-LINE.
 12803
 12804 7950-EXIT.
 12805      EXIT.
 12806
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 264
* EL152.cbl
 12808 7960-UPDATE-TABLE-FROM-SCREEN.
 12809     IF SC-TEXTL (SC-INDX) NOT = ZEROS
 12810        IF TB-INDX > PI-TOTAL-LINES
 12811           IF PI-TOTAL-LINES = MAX-LINES
 12812              MOVE ER-0051       TO EMI-ERROR
 12813              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12814              GO TO 8200-SEND-DATAONLY
 12815           ELSE
 12816              MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX)
 12817              ADD 1              TO PI-TOTAL-LINES
 12818        ELSE
 12819           MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
 12820
 12821     SET TB-INDX UP BY 1.
 12822
 12823 7960-EXIT.
 12824      EXIT.
 12825
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 265
* EL152.cbl
 12827 8000-STARTBR-ERACCT.
 12828
 12829     IF WS-ACCT-READ-SW = 'Y'
 12830         NEXT SENTENCE
 12831     ELSE
 12832
 12833* EXEC CICS GETMAIN
 12834*             SET       (ADDRESS OF ACCOUNT-MASTER)
 12835*             LENGTH    (ACCT-LENGTH)
 12836*        END-EXEC.
 12837*    MOVE '," L                  $   #00011462' TO DFHEIV0
 12838     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12839     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12840     MOVE X'2020233030303131343632' TO DFHEIV0(25:11)
 12841     CALL 'kxdfhei1' USING DFHEIV0,
 12842           DFHEIV20,
 12843           ACCT-LENGTH,
 12844           DFHEIV99
 12845     SET ADDRESS OF ACCOUNT-MASTER TO
 12846         DFHEIV20
 12847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12848
 12849
 12850
 12851* EXEC CICS STARTBR
 12852*        RIDFLD      (ACCT-KEY)
 12853*        DATASET     (ACCT-ID)
 12854*        KEYLENGTH   (20)
 12855*        GENERIC
 12856*    END-EXEC.
 12857     MOVE 20
 12858       TO DFHEIV11
 12859     MOVE 0
 12860       TO DFHEIV12
 12861*    MOVE '&,   KG    G          &   #00011467' TO DFHEIV0
 12862     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12863     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12864     MOVE X'2020233030303131343637' TO DFHEIV0(25:11)
 12865     CALL 'kxdfhei1' USING DFHEIV0,
 12866           ACCT-ID,
 12867           ACCT-KEY,
 12868           DFHEIV11,
 12869           DFHEIV12,
 12870           DFHEIV99
 12871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12872
 12873
 12874     MOVE 'Y'         TO ACCT-BROWSE-STARTED.
 12875 8000-STARTBR-EXIT.
 12876     EXIT.
 12877
 12878 8000-READNEXT-ERACCT.
 12879
 12880
 12881* EXEC CICS READNEXT
 12882*        DATASET   (ACCT-ID)
 12883*        INTO      (ACCOUNT-MASTER)
 12884*        RIDFLD    (ACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 266
* EL152.cbl
 12885*    END-EXEC.
 12886     MOVE LENGTH OF
 12887      ACCOUNT-MASTER
 12888       TO DFHEIV12
 12889     MOVE 0
 12890       TO DFHEIV11
 12891*    MOVE '&.IL                  )   #00011480' TO DFHEIV0
 12892     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12893     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12894     MOVE X'2020233030303131343830' TO DFHEIV0(25:11)
 12895     CALL 'kxdfhei1' USING DFHEIV0,
 12896           ACCT-ID,
 12897           ACCOUNT-MASTER,
 12898           DFHEIV12,
 12899           ACCT-KEY,
 12900           DFHEIV99,
 12901           DFHEIV11,
 12902           DFHEIV99,
 12903           DFHEIV99
 12904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12905
 12906
 12907 8000-READNEXT-EXIT.
 12908     EXIT.
 12909
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 267
* EL152.cbl
 12911*8050-STARTBR-EMPROD. Remove as dead code
 12912*8050-EXIT. Remove as dead code
 12913*8060-READNEXT-EMPROD. Remove as dead code
 12914*8060-EXIT. Remove as dead code
 12915
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 268
* EL152.cbl
 12917 8100-SEND-INITIAL-MAP.
 12918     PERFORM 7700-PUT-TEMP-STOR  THRU 7749-EXIT
 12919     MOVE SAVE-DATE              TO DATEAO.
 12920     MOVE EIBTIME                TO TIME-IN.
 12921     MOVE TIME-OUT               TO TIMEAO.
 12922
 12923     MOVE PI-CARRIER             TO CARRO
 12924     MOVE PI-CLAIM-NO            TO CLMNOO
 12925     MOVE PI-CERT-NO             TO CRTNOO
 12926     MOVE PI-PROCESSOR-ID        TO PROCO
 12927     MOVE PI-COMPANY-ID          TO COMPIDO
 12928     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 12929                                 TO SYSO
 12930     MOVE PI-ENCLOSURE-CD        TO ENCO
 12931     IF NOT EMI-NO-ERRORS
 12932         SET EMI-INDX TO 1
 12933         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSGO
 12934     ELSE
 12935         MOVE SPACES             TO ERRMSGO.
 12936
 12937     MOVE -1                     TO MAINTL.
 12938
 12939
 12940* EXEC CICS SEND
 12941*        MAP      (MAP-NAME)
 12942*        MAPSET   (MAPSET-NAME)
 12943*        FROM     (EL152AO)
 12944*        ERASE
 12945*        CURSOR
 12946*    END-EXEC.
 12947     MOVE LENGTH OF
 12948      EL152AO
 12949       TO DFHEIV12
 12950     MOVE -1
 12951       TO DFHEIV11
 12952*    MOVE '8$     CT  E    H L F ,   #00011518' TO DFHEIV0
 12953     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 12954     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12955     MOVE X'2020233030303131353138' TO DFHEIV0(25:11)
 12956     CALL 'kxdfhei1' USING DFHEIV0,
 12957           MAP-NAME,
 12958           EL152AO,
 12959           DFHEIV12,
 12960           MAPSET-NAME,
 12961           DFHEIV99,
 12962           DFHEIV99,
 12963           DFHEIV99,
 12964           DFHEIV11,
 12965           DFHEIV99,
 12966           DFHEIV99,
 12967           DFHEIV99
 12968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12969
 12970
 12971     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 12972     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 12973
 12974     GO TO 9000-RETURN-TRANS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 269
* EL152.cbl
 12975*    GO TO 0200-RECEIVE.
 12976
 12977 8200-SEND-DATAONLY.
 12978     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12979     MOVE PI-ENCLOSURE-CD        TO ENCO
 12980     MOVE SAVE-DATE              TO DATEAO.
 12981     MOVE EIBTIME                TO TIME-IN.
 12982     MOVE TIME-OUT               TO TIMEAO.
 12983     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 12984
 12985*    IF PI-COMPANY-ID = 'DMD'
 12986*       IF FORCE-7840
 12987*          MOVE '7840 FORCED' TO PFKEY9O
 12988*          MOVE AL-SABON      TO PFKEY9A.
 12989
 12990
 12991* EXEC CICS SEND
 12992*        MAP      (MAP-NAME)
 12993*        MAPSET   (MAPSET-NAME)
 12994*        FROM     (EL152AO)
 12995*        DATAONLY
 12996*        CURSOR
 12997*    END-EXEC.
 12998     MOVE LENGTH OF
 12999      EL152AO
 13000       TO DFHEIV12
 13001     MOVE -1
 13002       TO DFHEIV11
 13003*    MOVE '8$D    CT       H L F ,   #00011545' TO DFHEIV0
 13004     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 13005     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13006     MOVE X'2020233030303131353435' TO DFHEIV0(25:11)
 13007     CALL 'kxdfhei1' USING DFHEIV0,
 13008           MAP-NAME,
 13009           EL152AO,
 13010           DFHEIV12,
 13011           MAPSET-NAME,
 13012           DFHEIV99,
 13013           DFHEIV99,
 13014           DFHEIV99,
 13015           DFHEIV11,
 13016           DFHEIV99,
 13017           DFHEIV99,
 13018           DFHEIV99
 13019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13020
 13021
 13022     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13023     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13024
 13025     GO TO 9000-RETURN-TRANS.
 13026*    GO TO 0200-RECEIVE.
 13027
 13028 8200-SEND-DATAONLY-ERASEAUP.
 13029     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13030     MOVE PI-ENCLOSURE-CD        TO ENCO
 13031     MOVE SAVE-DATE              TO DATEAO.
 13032     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 270
* EL152.cbl
 13033     MOVE TIME-OUT               TO TIMEAO.
 13034     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13035
 13036* EXEC CICS SEND
 13037*        MAP      (MAP-NAME)
 13038*        MAPSET   (MAPSET-NAME)
 13039*        FROM     (EL152AO)
 13040*        DATAONLY
 13041*        ERASEAUP
 13042*        CURSOR
 13043*    END-EXEC.
 13044     MOVE LENGTH OF
 13045      EL152AO
 13046       TO DFHEIV12
 13047     MOVE -1
 13048       TO DFHEIV11
 13049*    MOVE '8$D    CT  A    H L F ,   #00011566' TO DFHEIV0
 13050     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 13051     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13052     MOVE X'2020233030303131353636' TO DFHEIV0(25:11)
 13053     CALL 'kxdfhei1' USING DFHEIV0,
 13054           MAP-NAME,
 13055           EL152AO,
 13056           DFHEIV12,
 13057           MAPSET-NAME,
 13058           DFHEIV99,
 13059           DFHEIV99,
 13060           DFHEIV99,
 13061           DFHEIV11,
 13062           DFHEIV99,
 13063           DFHEIV99,
 13064           DFHEIV99
 13065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13066
 13067
 13068     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13069     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13070
 13071     GO TO 9000-RETURN-TRANS.
 13072*    GO TO 0200-RECEIVE.
 13073
 13074 8210-ENDBR.
 13075     IF ACCT-BROWSE-STARTED = 'Y'
 13076        MOVE 'N'                  TO ACCT-BROWSE-STARTED
 13077
 13078* EXEC CICS ENDBR
 13079*            DATASET    (ACCT-ID)
 13080*       END-EXEC.
 13081     MOVE 0
 13082       TO DFHEIV11
 13083*    MOVE '&2                    $   #00011584' TO DFHEIV0
 13084     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13085     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13086     MOVE X'2020233030303131353834' TO DFHEIV0(25:11)
 13087     CALL 'kxdfhei1' USING DFHEIV0,
 13088           ACCT-ID,
 13089           DFHEIV11,
 13090           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 271
* EL152.cbl
 13091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13092
 13093
 13094 8210-EXIT.
 13095     EXIT.
 13096
 13097 8220-ENDBR-EMPROD.
 13098     IF PROD-BROWSE-STARTED = 'Y'
 13099        MOVE 'N'                  TO PROD-BROWSE-STARTED
 13100
 13101* EXEC CICS ENDBR
 13102*            DATASET    (PROD-ID)
 13103*       END-EXEC.
 13104     MOVE 0
 13105       TO DFHEIV11
 13106*    MOVE '&2                    $   #00011594' TO DFHEIV0
 13107     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13109     MOVE X'2020233030303131353934' TO DFHEIV0(25:11)
 13110     CALL 'kxdfhei1' USING DFHEIV0,
 13111           PROD-ID,
 13112           DFHEIV11,
 13113           DFHEIV99
 13114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13115
 13116
 13117 8220-EXIT.
 13118     EXIT.
 13119
 13120 8300-SEND-TEXT.
 13121
 13122* EXEC CICS SEND TEXT
 13123*        FROM    (LOGOFF-TEXT)
 13124*        LENGTH  (LOGOFF-LENGTH)
 13125*        ERASE
 13126*        FREEKB
 13127*    END-EXEC.
 13128*    MOVE '8&      T  E F  H   F -   #00011602' TO DFHEIV0
 13129     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13130     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13131     MOVE X'2020233030303131363032' TO DFHEIV0(25:11)
 13132     CALL 'kxdfhei1' USING DFHEIV0,
 13133           LOGOFF-TEXT,
 13134           LOGOFF-LENGTH,
 13135           DFHEIV99,
 13136           DFHEIV99,
 13137           DFHEIV99,
 13138           DFHEIV99,
 13139           DFHEIV99,
 13140           DFHEIV99,
 13141           DFHEIV99,
 13142           DFHEIV99,
 13143           DFHEIV99,
 13144           DFHEIV99
 13145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13146
 13147
 13148
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 272
* EL152.cbl
 13149* EXEC CICS RETURN
 13150*    END-EXEC.
 13151*    MOVE '.(                    &   #00011609' TO DFHEIV0
 13152     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13153     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13154     MOVE X'2020233030303131363039' TO DFHEIV0(25:11)
 13155     CALL 'kxdfhei1' USING DFHEIV0,
 13156           DFHEIV99,
 13157           DFHEIV99,
 13158           DFHEIV99,
 13159           DFHEIV99,
 13160           DFHEIV99
 13161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13162
 13163
 13164 8600-DEEDIT.
 13165
 13166* EXEC CICS BIF DEEDIT
 13167*         FIELD    (DEEDIT-FIELD)
 13168*         LENGTH   (15)
 13169*    END-EXEC.
 13170     MOVE 15
 13171       TO DFHEIV11
 13172*    MOVE '@"L                   #   #00011613' TO DFHEIV0
 13173     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13174     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13175     MOVE X'2020233030303131363133' TO DFHEIV0(25:11)
 13176     CALL 'kxdfhei1' USING DFHEIV0,
 13177           DEEDIT-FIELD,
 13178           DFHEIV11
 13179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13180
 13181
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 273
* EL152.cbl
 13183 8800-UNAUTHORIZED-ACCESS.
 13184     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13185     GO TO 8300-SEND-TEXT.
 13186
 13187 8810-PF23.
 13188     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13189     MOVE ZEROS                  TO PI-TOTAL-LINES.
 13190     MOVE ZEROS                  TO PI-CURRENT-LINE.
 13191     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13192     MOVE XCTL-005               TO PGM-NAME.
 13193     GO TO 9300-XCTL.
 13194
 13195 8820-TERM-ERROR.
 13196     MOVE ER-0412                TO EMI-ERROR.
 13197     MOVE SPACES                 TO PI-PRINT-SW.
 13198     GO TO 8999-OPEN-ERROR.
 13199
 13200 8830-TRAN-ERROR.
 13201     MOVE ER-0413                TO EMI-ERROR.
 13202     MOVE SPACES                 TO PI-PRINT-SW.
 13203     GO TO 8999-OPEN-ERROR.
 13204
 13205 8840-CNTL-NOT-OPEN.
 13206     MOVE ER-0042                TO EMI-ERROR.
 13207     GO TO 8999-OPEN-ERROR.
 13208
 13209 8850-ARCH-NOT-OPEN.
 13210     MOVE ER-0332                TO EMI-ERROR.
 13211     GO TO 8999-OPEN-ERROR.
 13212
 13213 8860-CLAM-NOT-OPEN.
 13214     MOVE ER-0154                TO EMI-ERROR.
 13215     GO TO 8999-OPEN-ERROR.
 13216
 13217 8870-ACTV-NOT-OPEN.
 13218     MOVE ER-0172                TO EMI-ERROR.
 13219     GO TO 8999-OPEN-ERROR.
 13220
 13221 8880-ACCT-NOT-OPEN.
 13222     MOVE ER-0168                TO EMI-ERROR.
 13223     GO TO 8999-OPEN-ERROR.
 13224
 13225 8890-TEXT-NOT-OPEN.
 13226     MOVE ER-0013                TO EMI-ERROR.
 13227     GO TO 8999-OPEN-ERROR.
 13228
 13229 8900-CERT-NOT-OPEN.
 13230     MOVE ER-0169                TO EMI-ERROR.
 13231     GO TO 8999-OPEN-ERROR.
 13232
 13233 8910-CERT-NOT-FOUND.
 13234     MOVE ER-0206                TO EMI-ERROR.
 13235     GO TO 8999-OPEN-ERROR.
 13236
 13237 8915-PROD-NOT-OPEN.
 13238     MOVE ER-9106                TO EMI-ERROR.
 13239     GO TO 8999-OPEN-ERROR.
 13240
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 274
* EL152.cbl
 13241 8920-PLCY-NOT-OPEN.
 13242     MOVE ER-9883                TO EMI-ERROR.
 13243     GO TO 8999-OPEN-ERROR.
 13244
 13245 8925-PLAN-NOT-OPEN.
 13246     MOVE ER-9808                TO EMI-ERROR.
 13247     GO TO 8999-OPEN-ERROR.
 13248
 13249 8930-PLCY-NOT-FOUND.
 13250     MOVE ER-9483                TO EMI-ERROR.
 13251     GO TO 8999-OPEN-ERROR.
 13252
 13253 8999-OPEN-ERROR.
 13254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13255     MOVE -1                     TO MAINTL.
 13256     GO TO 8200-SEND-DATAONLY.
 13257
 13258 9000-RETURN-TRANS.
 13259
 13260     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 13261
 13262* EXEC CICS RETURN
 13263*        TRANSID    (TRANS-ID)
 13264*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13265*        LENGTH     (PI-COMM-LENGTH)
 13266*    END-EXEC.
 13267*    MOVE '.(CT                  &   #00011697' TO DFHEIV0
 13268     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13269     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13270     MOVE X'2020233030303131363937' TO DFHEIV0(25:11)
 13271     CALL 'kxdfhei1' USING DFHEIV0,
 13272           TRANS-ID,
 13273           PROGRAM-INTERFACE-BLOCK,
 13274           PI-COMM-LENGTH,
 13275           DFHEIV99,
 13276           DFHEIV99
 13277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13278
 13279
 13280
 13281 9000-EXIT.
 13282     EXIT.
 13283 9200-RETURN-MAIN-MENU.
 13284     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13285
 13286     MOVE ZEROS                  TO PI-TOTAL-LINES
 13287                                    PI-CURRENT-LINE.
 13288     MOVE XCTL-126               TO PGM-NAME.
 13289
 13290     GO TO 9300-XCTL.
 13291
 13292 9300-XCTL.
 13293
 13294* EXEC CICS XCTL
 13295*        PROGRAM    (PGM-NAME)
 13296*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13297*        LENGTH     (PI-COMM-LENGTH)
 13298*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 275
* EL152.cbl
 13299*    MOVE '.$C                   $   #00011716' TO DFHEIV0
 13300     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13301     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13302     MOVE X'2020233030303131373136' TO DFHEIV0(25:11)
 13303     CALL 'kxdfhei1' USING DFHEIV0,
 13304           PGM-NAME,
 13305           PROGRAM-INTERFACE-BLOCK,
 13306           PI-COMM-LENGTH
 13307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13308
 13309
 13310 9400-CLEAR.
 13311     IF PI-CLEAR-MODE
 13312         MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
 13313         GO TO 9300-XCTL
 13314     ELSE
 13315         PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
 13316         PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
 13317         PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
 13318         MOVE SPACES             TO PI-WA
 13319                                    RECORD-TABLE
 13320                                    TS-WORK-AREA
 13321         MOVE ZEROS              TO PI-TOTAL-LINES
 13322                                    PI-CURRENT-LINE
 13323                                    PI-TEMP-STOR-ITEMS
 13324                                    PI-UPDATE-SW
 13325                                    PI-ADDR-SEQ
 13326         MOVE '2'                TO PI-ACTION
 13327         MOVE LOW-VALUES         TO EL152AO
 13328                                    PI-ADDR-TYPE
 13329         SET TS-INDX
 13330             TA1
 13331             TA2
 13332             TA21
 13333             TB-INDX
 13334             TB-INDX1
 13335             MOVE-INDX
 13336             SC-INDX             TO +1
 13337         IF GETMAIN-SWITCH = '2'
 13338             MOVE 1              TO GETMAIN-SWITCH
 13339             GO TO 8100-SEND-INITIAL-MAP
 13340         ELSE
 13341             GO TO 8100-SEND-INITIAL-MAP.
 13342
 13343 9600-PGMID-ERROR.
 13344
 13345* EXEC CICS HANDLE CONDITION
 13346*        PGMIDERR    (8300-SEND-TEXT)
 13347*    END-EXEC.
 13348*    MOVE '"$L                   ! N #00011756' TO DFHEIV0
 13349     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13351     MOVE X'4E20233030303131373536' TO DFHEIV0(25:11)
 13352     CALL 'kxdfhei1' USING DFHEIV0
 13353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13354
 13355
 13356     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 276
* EL152.cbl
 13357     MOVE ' '                    TO PI-ENTRY-CD-1.
 13358     MOVE XCTL-005               TO PGM-NAME.
 13359     MOVE PGM-NAME               TO LOGOFF-PGM.
 13360     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13361     GO TO 9300-XCTL.
 13362
 13363 9700-DATE-LINK.
 13364     MOVE LINK-ELDATCV           TO PGM-NAME.
 13365
 13366* EXEC CICS LINK
 13367*        PROGRAM   (PGM-NAME)
 13368*        COMMAREA  (DATE-CONVERSION-DATA)
 13369*        LENGTH    (DC-COMM-LENGTH)
 13370*    END-EXEC.
 13371*    MOVE '."C                   ''   #00011769' TO DFHEIV0
 13372     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13373     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13374     MOVE X'2020233030303131373639' TO DFHEIV0(25:11)
 13375     CALL 'kxdfhei1' USING DFHEIV0,
 13376           PGM-NAME,
 13377           DATE-CONVERSION-DATA,
 13378           DC-COMM-LENGTH,
 13379           DFHEIV99,
 13380           DFHEIV99,
 13381           DFHEIV99
 13382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13383
 13384
 13385*    IF NO-CONVERSION-ERROR
 13386*            AND
 13387*       W-REVERSE-DATE
 13388*            AND
 13389*       PI-COMPANY-ID = 'AUK'
 13390*           MOVE DC-GREG-DATE-1-EDIT TO W-EDIT-DATE-1
 13391*           MOVE W-ED1-MM            TO W-ED2-MM
 13392*           MOVE W-ED1-DD            TO W-ED2-DD
 13393*           MOVE W-ED1-YY            TO W-ED2-YY
 13394*           MOVE W-EDIT-DATE-2       TO DC-GREG-DATE-1-EDIT.
 13395
 13396 9700-EXIT.
 13397      EXIT.
 13398
 13399 9900-ERROR-FORMAT.
 13400     IF NOT EMI-ERRORS-COMPLETE
 13401         MOVE LINK-001           TO PGM-NAME
 13402
 13403* EXEC CICS LINK
 13404*            PROGRAM   (PGM-NAME)
 13405*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 13406*            LENGTH    (EMI-COMM-LENGTH)
 13407*        END-EXEC.
 13408*    MOVE '."C                   ''   #00011792' TO DFHEIV0
 13409     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13411     MOVE X'2020233030303131373932' TO DFHEIV0(25:11)
 13412     CALL 'kxdfhei1' USING DFHEIV0,
 13413           PGM-NAME,
 13414           ERROR-MESSAGE-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 277
* EL152.cbl
 13415           EMI-COMM-LENGTH,
 13416           DFHEIV99,
 13417           DFHEIV99,
 13418           DFHEIV99
 13419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13420
 13421
 13422 9900-EXIT.
 13423     EXIT.
 13424
 13425 9990-ABEND.
 13426     MOVE LINK-004               TO PGM-NAME.
 13427     MOVE DFHEIBLK               TO EMI-LINE1.
 13428
 13429* EXEC CICS LINK
 13430*        PROGRAM   (PGM-NAME)
 13431*        COMMAREA  (EMI-LINE1)
 13432*        LENGTH    (72)
 13433*    END-EXEC.
 13434     MOVE 72
 13435       TO DFHEIV11
 13436*    MOVE '."C                   ''   #00011804' TO DFHEIV0
 13437     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13439     MOVE X'2020233030303131383034' TO DFHEIV0(25:11)
 13440     CALL 'kxdfhei1' USING DFHEIV0,
 13441           PGM-NAME,
 13442           EMI-LINE1,
 13443           DFHEIV11,
 13444           DFHEIV99,
 13445           DFHEIV99,
 13446           DFHEIV99
 13447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13448
 13449
 13450     GO TO 8200-SEND-DATAONLY.
 13451
 13452 9995-SECURITY-VIOLATION.
 13453*                            COPY ELCSCTP.
 13454******************************************************************
 13455*                                                                *
 13456*                            ELCSCTP                             *
 13457*                            VMOD=2.001                          *
 13458*                                                                *
 13459*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13460******************************************************************
 13461
 13462
 13463     MOVE EIBDATE          TO SM-JUL-DATE.
 13464     MOVE EIBTRMID         TO SM-TERMID.
 13465     MOVE THIS-PGM         TO SM-PGM.
 13466     MOVE EIBTIME          TO TIME-IN.
 13467     MOVE TIME-OUT         TO SM-TIME.
 13468     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13469
 13470
 13471* EXEC CICS LINK
 13472*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 278
* EL152.cbl
 13473*         COMMAREA (SECURITY-MESSAGE)
 13474*         LENGTH   (80)
 13475*    END-EXEC.
 13476     MOVE 'EL003' TO DFHEIV1
 13477     MOVE 80
 13478       TO DFHEIV11
 13479*    MOVE '."C                   ''   #00011830' TO DFHEIV0
 13480     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13481     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13482     MOVE X'2020233030303131383330' TO DFHEIV0(25:11)
 13483     CALL 'kxdfhei1' USING DFHEIV0,
 13484           DFHEIV1,
 13485           SECURITY-MESSAGE,
 13486           DFHEIV11,
 13487           DFHEIV99,
 13488           DFHEIV99,
 13489           DFHEIV99
 13490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13491
 13492
 13493******************************************************************
 13494
 13495
 13496
 13497 9999-DFHBACK SECTION.
 13498     MOVE '9%                    "   ' TO DFHEIV0
 13499     MOVE 'EL152' TO DFHEIV1
 13500     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13501     GOBACK.
 13502 9999-DFHEXIT.
 13503     IF DFHEIGDJ EQUAL 0001
 13504         NEXT SENTENCE
 13505     ELSE IF DFHEIGDJ EQUAL 2
 13506         GO TO 9600-PGMID-ERROR,
 13507               0325-MAPFAIL,
 13508               9990-ABEND
 13509         DEPENDING ON DFHEIGDI
 13510     ELSE IF DFHEIGDJ EQUAL 3
 13511         GO TO 9400-CLEAR,
 13512               0100-PA,
 13513               0100-PA,
 13514               0100-PA
 13515         DEPENDING ON DFHEIGDI
 13516     ELSE IF DFHEIGDJ EQUAL 4
 13517         GO TO 0325-MAPFAIL
 13518         DEPENDING ON DFHEIGDI
 13519     ELSE IF DFHEIGDJ EQUAL 5
 13520         GO TO 590-QIDERR
 13521         DEPENDING ON DFHEIGDI
 13522     ELSE IF DFHEIGDJ EQUAL 6
 13523         GO TO 8850-ARCH-NOT-OPEN,
 13524               1020-ENDBR,
 13525               1020-ENDBR
 13526         DEPENDING ON DFHEIGDI
 13527     ELSE IF DFHEIGDJ EQUAL 7
 13528         GO TO 2120-ENDBR,
 13529               2120-ENDBR,
 13530               8890-TEXT-NOT-OPEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 279
* EL152.cbl
 13531         DEPENDING ON DFHEIGDI
 13532     ELSE IF DFHEIGDJ EQUAL 8
 13533         GO TO 8860-CLAM-NOT-OPEN,
 13534               3010-NOT-FOUND
 13535         DEPENDING ON DFHEIGDI
 13536     ELSE IF DFHEIGDJ EQUAL 9
 13537         GO TO 9990-ABEND
 13538         DEPENDING ON DFHEIGDI
 13539     ELSE IF DFHEIGDJ EQUAL 10
 13540         GO TO 6499-EXIT
 13541         DEPENDING ON DFHEIGDI
 13542     ELSE IF DFHEIGDJ EQUAL 11
 13543         GO TO 6599-EXIT
 13544         DEPENDING ON DFHEIGDI
 13545     ELSE IF DFHEIGDJ EQUAL 12
 13546         GO TO 8860-CLAM-NOT-OPEN,
 13547               7090-CLAIM-NOT-FOUND
 13548         DEPENDING ON DFHEIGDI
 13549     ELSE IF DFHEIGDJ EQUAL 13
 13550         GO TO 8880-ACCT-NOT-OPEN,
 13551               7080-ACCT-NOT-FOUND
 13552         DEPENDING ON DFHEIGDI
 13553     ELSE IF DFHEIGDJ EQUAL 14
 13554         GO TO 7070-ACTV-NOT-FOUND
 13555         DEPENDING ON DFHEIGDI
 13556     ELSE IF DFHEIGDJ EQUAL 15
 13557         GO TO 7070-ACTV-NOT-FOUND
 13558         DEPENDING ON DFHEIGDI
 13559     ELSE IF DFHEIGDJ EQUAL 16
 13560         GO TO 8870-ACTV-NOT-OPEN,
 13561               7070-ACTV-NOT-FOUND
 13562         DEPENDING ON DFHEIGDI
 13563     ELSE IF DFHEIGDJ EQUAL 17
 13564         GO TO 7075-CONTINUE-ACTV-ERROR
 13565         DEPENDING ON DFHEIGDI
 13566     ELSE IF DFHEIGDJ EQUAL 18
 13567         GO TO 8900-CERT-NOT-OPEN,
 13568               8910-CERT-NOT-FOUND
 13569         DEPENDING ON DFHEIGDI
 13570     ELSE IF DFHEIGDJ EQUAL 19
 13571         GO TO 8870-ACTV-NOT-OPEN,
 13572               7200-READ-LOAN-NUMBER
 13573         DEPENDING ON DFHEIGDI
 13574     ELSE IF DFHEIGDJ EQUAL 20
 13575         GO TO 8870-ACTV-NOT-OPEN,
 13576               7201-READ-BENEFICIARY
 13577         DEPENDING ON DFHEIGDI
 13578     ELSE IF DFHEIGDJ EQUAL 21
 13579         GO TO 7290-BENE-NOT-OPEN,
 13580               7205-READ-PHYSICIAN-ADDR
 13581         DEPENDING ON DFHEIGDI
 13582     ELSE IF DFHEIGDJ EQUAL 22
 13583         GO TO 8870-ACTV-NOT-OPEN,
 13584               7210-READ-EMPLOYER-ADDR
 13585         DEPENDING ON DFHEIGDI
 13586     ELSE IF DFHEIGDJ EQUAL 23
 13587         GO TO 8870-ACTV-NOT-OPEN,
 13588               7220-READ-INSURED-ADDR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 280
* EL152.cbl
 13589         DEPENDING ON DFHEIGDI
 13590     ELSE IF DFHEIGDJ EQUAL 24
 13591         GO TO 8870-ACTV-NOT-OPEN,
 13592               7225-READ-OTHER1-ADDR
 13593         DEPENDING ON DFHEIGDI
 13594     ELSE IF DFHEIGDJ EQUAL 25
 13595         GO TO 8870-ACTV-NOT-OPEN,
 13596               7230-READ-OTHER2-ADDR
 13597         DEPENDING ON DFHEIGDI
 13598     ELSE IF DFHEIGDJ EQUAL 26
 13599         GO TO 8870-ACTV-NOT-OPEN,
 13600               7240-NOT-FOUND
 13601         DEPENDING ON DFHEIGDI
 13602     ELSE IF DFHEIGDJ EQUAL 27
 13603         GO TO 8870-ACTV-NOT-OPEN,
 13604               7250-READ-ACCOUNT
 13605         DEPENDING ON DFHEIGDI
 13606     ELSE IF DFHEIGDJ EQUAL 28
 13607         GO TO 8880-ACCT-NOT-OPEN,
 13608               7251-READ-3RD-PARTY
 13609         DEPENDING ON DFHEIGDI
 13610     ELSE IF DFHEIGDJ EQUAL 29
 13611         GO TO 8870-ACTV-NOT-OPEN,
 13612               7252-READ-COMP
 13613         DEPENDING ON DFHEIGDI
 13614     ELSE IF DFHEIGDJ EQUAL 30
 13615         GO TO 7260-READ-DENIAL
 13616         DEPENDING ON DFHEIGDI
 13617     ELSE IF DFHEIGDJ EQUAL 31
 13618         GO TO 8870-ACTV-NOT-OPEN,
 13619               7265-READ-CNTL1,
 13620               7265-READ-CNTL1
 13621         DEPENDING ON DFHEIGDI
 13622     ELSE IF DFHEIGDJ EQUAL 32
 13623         GO TO 8840-CNTL-NOT-OPEN,
 13624               7266-READ-CNTL2
 13625         DEPENDING ON DFHEIGDI
 13626     ELSE IF DFHEIGDJ EQUAL 33
 13627         GO TO 8840-CNTL-NOT-OPEN,
 13628               7267-READ-CNTL4
 13629         DEPENDING ON DFHEIGDI
 13630     ELSE IF DFHEIGDJ EQUAL 34
 13631         GO TO 8840-CNTL-NOT-OPEN,
 13632               7267-READ-CNTL6
 13633         DEPENDING ON DFHEIGDI
 13634     ELSE IF DFHEIGDJ EQUAL 35
 13635         GO TO 8840-CNTL-NOT-OPEN,
 13636               7268-SET-DATE
 13637         DEPENDING ON DFHEIGDI
 13638     ELSE IF DFHEIGDJ EQUAL 36
 13639         GO TO 7290-BENE-NOT-OPEN,
 13640               7290-EXIT
 13641         DEPENDING ON DFHEIGDI
 13642     ELSE IF DFHEIGDJ EQUAL 37
 13643         GO TO 7590-TS-QIDERR,
 13644               7585-TS-ITEMERR
 13645         DEPENDING ON DFHEIGDI
 13646     ELSE IF DFHEIGDJ EQUAL 38
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 281
* EL152.cbl
 13647         GO TO 7690-TS-QIDERR,
 13648               7685-TS-ITEMERR
 13649         DEPENDING ON DFHEIGDI
 13650     ELSE IF DFHEIGDJ EQUAL 39
 13651         GO TO 7750-EXIT
 13652         DEPENDING ON DFHEIGDI
 13653     ELSE IF DFHEIGDJ EQUAL 40
 13654         GO TO 7760-EXIT
 13655         DEPENDING ON DFHEIGDI
 13656     ELSE IF DFHEIGDJ EQUAL 41
 13657         GO TO 7770-EXIT
 13658         DEPENDING ON DFHEIGDI
 13659     ELSE IF DFHEIGDJ EQUAL 42
 13660         GO TO 8860-CLAM-NOT-OPEN,
 13661               7800-CLAIM-NOT-FOUND
 13662         DEPENDING ON DFHEIGDI
 13663     ELSE IF DFHEIGDJ EQUAL 43
 13664         GO TO 7800-GET-PRINTER
 13665         DEPENDING ON DFHEIGDI
 13666     ELSE IF DFHEIGDJ EQUAL 44
 13667         GO TO 8840-CNTL-NOT-OPEN,
 13668               7890-NOT-FOUND
 13669         DEPENDING ON DFHEIGDI
 13670     ELSE IF DFHEIGDJ EQUAL 45
 13671         GO TO 8820-TERM-ERROR,
 13672               8830-TRAN-ERROR
 13673         DEPENDING ON DFHEIGDI
 13674     ELSE IF DFHEIGDJ EQUAL 46
 13675         GO TO 8300-SEND-TEXT
 13676         DEPENDING ON DFHEIGDI.
 13677     MOVE '9%                    "   ' TO DFHEIV0
 13678     MOVE 'EL152' TO DFHEIV1
 13679     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13680     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       47156     Code:       43842
