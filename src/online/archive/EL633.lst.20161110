* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56* 110315  CR2015101400001  PEMA ADD NEW DCC G/L #'S FOR ACH
    57* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    58* 021716  CR2016021000003  PEMA  ADD NEW G/L FOR MACHENS ACCTS
    59******************************************************************
    60
    61 ENVIRONMENT DIVISION.
    62 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   3
* EL633.cbl
    64 WORKING-STORAGE SECTION.
    65 01  DFH-START PIC X(04).
    66 77  FILLER  PIC X(32)  VALUE '********************************'.
    67 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    68 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    69
    70*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    71*77  SV-COFA PIC X(42)  VALUE SPACES.
    72*77  K-SPACE PIC X(11)  VALUE SPACES.
    73
    74 01  DATE-WORK-AREAS.
    75     05  WS-GREG-STORE.
    76         10  WS-GS-MM  PIC XX.
    77         10  FILLER    PIC X.
    78         10  WS-GS-DD  PIC XX.
    79         10  FILLER    PIC X.
    80         10  WS-GS-YY  PIC XX.
    81     05  WS-SDTE-STORE.
    82         10  WS-SS-MM  PIC XX.
    83         10  WS-SS-DD  PIC XX.
    84         10  WS-SS-YY  PIC XX.
    85*                            COPY ELCSCTM.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCTM                             *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-MESSAGE.
    96     12  FILLER                          PIC X(30)
    97            VALUE '** LOGIC SECURITY VIOLATION -'.
    98     12  SM-READ                         PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' PGM='.
   101     12  SM-PGM                          PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' OPR='.
   104     12  SM-PROCESSOR-ID                 PIC X(4).
   105     12  FILLER                          PIC X(6)
   106            VALUE ' TERM='.
   107     12  SM-TERMID                       PIC X(4).
   108     12  FILLER                          PIC XX   VALUE SPACE.
   109     12  SM-JUL-DATE                     PIC 9(5).
   110     12  FILLER                          PIC X    VALUE SPACE.
   111     12  SM-TIME                         PIC 99.99.
   112
   113*                            COPY ELCSCRTY.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCRTY                            *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   121*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   4
* EL633.cbl
   122*        SAVED IN PI-SECURITY-ADDRESS.                           *
   123*                                                                *
   124******************************************************************
   125 01  SECURITY-CONTROL.
   126     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   127     12  FILLER                       PIC XX    VALUE 'SC'.
   128     12  SC-CREDIT-CODES.
   129         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   130             20  SC-CREDIT-DISPLAY    PIC X.
   131             20  SC-CREDIT-UPDATE     PIC X.
   132     12  SC-CLAIMS-CODES.
   133         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   134             20  SC-CLAIMS-DISPLAY    PIC X.
   135             20  SC-CLAIMS-UPDATE     PIC X.
   136
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   5
* EL633.cbl
   138
   139 01  STANDARD-AREAS.
   140     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   141     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   142     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   143     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   144     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   145     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   146     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   147     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   148     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   149     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   150     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   151     12  PGM-NAME            PIC  X(8).
   152     12  TIME-IN             PIC S9(7).
   153     12  TIME-OUT-R  REDEFINES  TIME-IN.
   154         16  FILLER          PIC  X.
   155         16  TIME-OUT        PIC  99V99.
   156         16  FILLER          PIC  X(2).
   157     12  EL640               PIC  X(8)       VALUE 'EL640'.
   158     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   159     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   160     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   161     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   162     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   163     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   164     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   165     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   166     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   167     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   168     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   169     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   170     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   171     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   172     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   173     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   174     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   175         88  PYAJ-1ST-READ                   VALUE 'Y'.
   176     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   177         88  FIRST-ADD                       VALUE 'Y'.
   178     12  ZERO-NDX            PIC  9          VALUE ZERO.
   179     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   180     12  WORK-SEQ-TIME       PIC  9(6).
   181     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   182         16  WORK-SEQ-HHMMS  PIC  9(5).
   183         16  FILLER          PIC  9.
   184     12  WORK-DATE-JULIAN.
   185         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   186         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   187     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   188     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   189         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   190                                                    'S' 'T' 'U'
   191                                                    'X' 'Y' 'Z'
   192                                                    'F'.
   193     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   194         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   195     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   6
* EL633.cbl
   196         88  FORCE-SHOW                      VALUE  'Y'.
   197
   198     12  WS-EOM-DTS OCCURS 13  TIMES
   199                              INDEXED BY PINDEX.
   200         16  WS-EOM-DT               PIC XX.
   201*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   202
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   7
* EL633.cbl
   204     12  WS-ERROR-CODES.
   205         16  ER-0000         PIC  X(4)       VALUE '0000'.
   206         16  ER-0008         PIC  X(4)       VALUE '0008'.
   207         16  ER-0023         PIC  X(4)       VALUE '0023'.
   208         16  ER-0029         PIC  X(4)       VALUE '0029'.
   209         16  ER-0070         PIC  X(4)       VALUE '0070'.
   210         16  ER-0587         PIC  X(4)       VALUE '0587'.
   211         16  ER-2056         PIC  X(4)       VALUE '2056'.
   212         16  ER-2230         PIC  X(4)       VALUE '2230'.
   213         16  ER-2231         PIC  X(4)       VALUE '2231'.
   214         16  ER-2232         PIC  X(4)       VALUE '2232'.
   215         16  ER-2233         PIC  X(4)       VALUE '2233'.
   216         16  ER-2234         PIC  X(4)       VALUE '2234'.
   217         16  ER-2235         PIC  X(4)       VALUE '2235'.
   218         16  ER-2236         PIC  X(4)       VALUE '2236'.
   219         16  ER-2237         PIC  X(4)       VALUE '2237'.
   220         16  ER-2238         PIC  X(4)       VALUE '2238'.
   221         16  ER-2239         PIC  X(4)       VALUE '2239'.
   222         16  ER-2244         PIC  X(4)       VALUE '2244'.
   223         16  ER-2245         PIC  X(4)       VALUE '2245'.
   224         16  ER-2246         PIC  X(4)       VALUE '2246'.
   225         16  ER-2370         PIC  X(4)       VALUE '2370'.
   226         16  ER-2432         PIC  X(4)       VALUE '2432'.
   227         16  ER-2449         PIC  X(4)       VALUE '2449'.
   228         16  ER-2587         PIC  X(4)       VALUE '2587'.
   229         16  ER-2588         PIC  X(4)       VALUE '2588'.
   230         16  ER-2595         PIC  X(4)       VALUE '2595'.
   231         16  ER-2596         PIC  X(4)       VALUE '2596'.
   232         16  ER-2763         PIC  X(4)       VALUE '2763'.
   233         16  ER-2929         PIC  X(4)       VALUE '2929'.
   234         16  ER-2957         PIC  X(4)       VALUE '2957'.
   235         16  ER-2958         PIC  X(4)       VALUE '2958'.
   236*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   237         16  ER-2960         PIC  X(4)       VALUE '2960'.
   238         16  ER-3020         PIC  X(4)       VALUE '3020'.
   239
   240*************************************************************
   241*                      TABLE OF STATE NAMES
   242*************************************************************
   243
   244 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   245     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   246                                   'CD' 'CO' 'CT' 'DC' 'DE'
   247                                   'FL' 'GA' 'GM' 'HI' 'IA'
   248                                   'ID' 'IL' 'IN' 'KS' 'KY'
   249                                   'LA' 'MA' 'MD' 'ME' 'MI'
   250                                   'MN' 'MO' 'MS' 'MT' 'MX'
   251                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   252                                   'NM' 'NV' 'NY' 'OF' 'OH'
   253                                   'OK' 'OR' 'PA' 'PI' 'PR'
   254                                   'RI' 'SC' 'SD' 'TN' 'TX'
   255                                   'UT' 'VA' 'VI' 'VT' 'WA'
   256                                   'WI' 'WV' 'WY'.
   257
   258 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   259     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   260                                 '1108124700'
   261                                 '1108125100'
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   8
* EL633.cbl
   262                                 '1721211400'
   263                                 '1825011200'
   264                                 '1825011300'
   265                                 '1825091000'
   266                                 '1825099050'
   267                                 '8505700033'
   268                                 '8506400030'
   269                                 '8507200020'
   270                                 '8507200010'
   271                                 '2725010160'.
   272     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   273                                     '2725040320'
   274                                     '2725040330'
   275                                     '2725040310'
   276                                     '8506400030'
   277                                     '8507200010'
   278                                     '1108121250'.
   279     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   280                                     '2725040110'
   281                                     '2725040120'
   282                                     '2725040130'
   283                                     '2725020400'.
   284
   285     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   286                                     '1825013200'
   287                                     '1825013300'
   288                                     '1825013400'
   289                                     '8506400030'
   290                                     '8507200010'
   291                                     '8507200020'
   292                                     '1108121010'.
   293
   294*01  WS-ACCT-BREAK.
   295*    05  WS-ACCT-1               PIC X.
   296*    05  FILLER                  PIC X(6).
   297*
   298 01  WORK-AREA.
   299     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   300     12  QID.
   301         16  QID-TERM        PIC X(04).
   302         16  FILLER          PIC X(04)       VALUE '633A'.
   303     12  DEEDIT-FIELD        PIC X(11).
   304     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   305     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   306     12  DATE-TEST-AREA      PIC  9(6).
   307     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   308         16  DATE-TEST-MM    PIC  99.
   309         16  DATE-TEST-DD    PIC  99.
   310         16  DATE-TEST-YY    PIC  99.
   311     12  DIVIDE-RESULT       PIC  99.
   312     12  DIVIDE-REMAINDER    PIC  9.
   313     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   314     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   315     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   316     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   317     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   318     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   319     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page   9
* EL633.cbl
   320     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   321
   322 01  ACCESS-KEYS.
   323     12  ERPYAJ-KEY.
   324         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   325         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   326         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   327         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   328         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   329         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   330         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   331
   332     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   333     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   334
   335     12  ERCHKQ-KEY.
   336         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   337         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   338         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   339     12  ERCOMP-KEY.
   340         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   341         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   342         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   343         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   344         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   345         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   346*    12  COFA-KEY-X.
   347*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   348*        16  COFA-ACCOUNT.
   349*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   350*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   351*
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  10
* EL633.cbl
   353*                                    COPY ELCDATE.
   354******************************************************************
   355*                                                                *
   356*                                                                *
   357*                            ELCDATE.                            *
   358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   359*                            VMOD=2.003
   360*                                                                *
   361*                                                                *
   362*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   363*                 LENGTH = 200                                   *
   364******************************************************************
   365
   366 01  DATE-CONVERSION-DATA.
   367     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   368     12  DC-OPTION-CODE                PIC X.
   369         88  BIN-TO-GREG                VALUE ' '.
   370         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   371         88  EDIT-GREG-TO-BIN           VALUE '2'.
   372         88  YMD-GREG-TO-BIN            VALUE '3'.
   373         88  MDY-GREG-TO-BIN            VALUE '4'.
   374         88  JULIAN-TO-BIN              VALUE '5'.
   375         88  BIN-PLUS-ELAPSED           VALUE '6'.
   376         88  FIND-CENTURY               VALUE '7'.
   377         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   378         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   379         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   380         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   381         88  JULIAN-TO-BIN-3            VALUE 'C'.
   382         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   383         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   384         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   385         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   386         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   387         88  CHECK-LEAP-YEAR            VALUE 'H'.
   388         88  BIN-3-TO-GREG              VALUE 'I'.
   389         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   390         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   391         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   392         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   393         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   394         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   395         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   396         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   397         88  THREE-CHARACTER-BIN
   398                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   399         88  GREGORIAN-TO-BIN
   400                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   401         88  BIN-TO-GREGORIAN
   402                  VALUES ' ' '1' 'I' '8' 'G'.
   403         88  JULIAN-TO-BINARY
   404                  VALUES '5' 'C' 'E' 'F'.
   405     12  DC-ERROR-CODE                 PIC X.
   406         88  NO-CONVERSION-ERROR        VALUE ' '.
   407         88  DATE-CONVERSION-ERROR
   408                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   409         88  DATE-IS-ZERO               VALUE '1'.
   410         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  11
* EL633.cbl
   411         88  DATE-IS-INVALID            VALUE '3'.
   412         88  DATE1-GREATER-DATE2        VALUE '4'.
   413         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   414         88  DATE-INVALID-OPTION        VALUE '9'.
   415         88  INVALID-CENTURY            VALUE 'A'.
   416         88  ONLY-CENTURY               VALUE 'B'.
   417         88  ONLY-LEAP-YEAR             VALUE 'C'.
   418         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   419     12  DC-END-OF-MONTH               PIC X.
   420         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   421     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   422         88  USE-NORMAL-PROCESS         VALUE ' '.
   423         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   424         88  ADJUST-UP-100-YRS          VALUE '2'.
   425     12  FILLER                        PIC X.
   426     12  DC-CONVERSION-DATES.
   427         16  DC-BIN-DATE-1             PIC XX.
   428         16  DC-BIN-DATE-2             PIC XX.
   429         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   430         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   431                       DC-GREG-DATE-1-EDIT.
   432             20  DC-EDIT1-MONTH        PIC 99.
   433             20  SLASH1-1              PIC X.
   434             20  DC-EDIT1-DAY          PIC 99.
   435             20  SLASH1-2              PIC X.
   436             20  DC-EDIT1-YEAR         PIC 99.
   437         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   438         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   439                     DC-GREG-DATE-2-EDIT.
   440             20  DC-EDIT2-MONTH        PIC 99.
   441             20  SLASH2-1              PIC X.
   442             20  DC-EDIT2-DAY          PIC 99.
   443             20  SLASH2-2              PIC X.
   444             20  DC-EDIT2-YEAR         PIC 99.
   445         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   446         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   447                     DC-GREG-DATE-1-YMD.
   448             20  DC-YMD-YEAR           PIC 99.
   449             20  DC-YMD-MONTH          PIC 99.
   450             20  DC-YMD-DAY            PIC 99.
   451         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   452         16  DC-GREG-DATE-1-MDY-R REDEFINES
   453                      DC-GREG-DATE-1-MDY.
   454             20  DC-MDY-MONTH          PIC 99.
   455             20  DC-MDY-DAY            PIC 99.
   456             20  DC-MDY-YEAR           PIC 99.
   457         16  DC-GREG-DATE-1-ALPHA.
   458             20  DC-ALPHA-MONTH        PIC X(10).
   459             20  DC-ALPHA-DAY          PIC 99.
   460             20  FILLER                PIC XX.
   461             20  DC-ALPHA-CENTURY.
   462                 24 DC-ALPHA-CEN-N     PIC 99.
   463             20  DC-ALPHA-YEAR         PIC 99.
   464         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   465         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   466         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   467         16  DC-JULIAN-DATE            PIC 9(05).
   468         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  12
* EL633.cbl
   469                                       PIC 9(05).
   470         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   471             20  DC-JULIAN-YEAR        PIC 99.
   472             20  DC-JULIAN-DAYS        PIC 999.
   473         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   474         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   475         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   476     12  DATE-CONVERSION-VARIBLES.
   477         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   478         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   479             20  FILLER                PIC 9(3).
   480             20  HOLD-CEN-1-CCYY.
   481                 24  HOLD-CEN-1-CC     PIC 99.
   482                 24  HOLD-CEN-1-YY     PIC 99.
   483             20  HOLD-CEN-1-MO         PIC 99.
   484             20  HOLD-CEN-1-DA         PIC 99.
   485         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   486             20  HOLD-CEN-1-R-MO       PIC 99.
   487             20  HOLD-CEN-1-R-DA       PIC 99.
   488             20  HOLD-CEN-1-R-CCYY.
   489                 24  HOLD-CEN-1-R-CC   PIC 99.
   490                 24  HOLD-CEN-1-R-YY   PIC 99.
   491             20  FILLER                PIC 9(3).
   492         16  HOLD-CENTURY-1-X.
   493             20  FILLER                PIC X(3)  VALUE SPACES.
   494             20  HOLD-CEN-1-X-CCYY.
   495                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   496                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   497             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   498             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   499         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   500             20  HOLD-CEN-1-R-X-MO     PIC XX.
   501             20  HOLD-CEN-1-R-X-DA     PIC XX.
   502             20  HOLD-CEN-1-R-X-CCYY.
   503                 24  HOLD-CEN-1-R-X-CC PIC XX.
   504                 24  HOLD-CEN-1-R-X-YY PIC XX.
   505             20  FILLER                PIC XXX.
   506         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   507         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   508         16  DC-JULIAN-DATE-1          PIC 9(07).
   509         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   510             20  DC-JULIAN-1-CCYY.
   511                 24  DC-JULIAN-1-CC    PIC 99.
   512                 24  DC-JULIAN-1-YR    PIC 99.
   513             20  DC-JULIAN-DA-1        PIC 999.
   514         16  DC-JULIAN-DATE-2          PIC 9(07).
   515         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   516             20  DC-JULIAN-2-CCYY.
   517                 24  DC-JULIAN-2-CC    PIC 99.
   518                 24  DC-JULIAN-2-YR    PIC 99.
   519             20  DC-JULIAN-DA-2        PIC 999.
   520         16  DC-GREG-DATE-A-EDIT.
   521             20  DC-EDITA-MONTH        PIC 99.
   522             20  SLASHA-1              PIC X VALUE '/'.
   523             20  DC-EDITA-DAY          PIC 99.
   524             20  SLASHA-2              PIC X VALUE '/'.
   525             20  DC-EDITA-CCYY.
   526                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  13
* EL633.cbl
   527                 24  DC-EDITA-YEAR     PIC 99.
   528         16  DC-GREG-DATE-B-EDIT.
   529             20  DC-EDITB-MONTH        PIC 99.
   530             20  SLASHB-1              PIC X VALUE '/'.
   531             20  DC-EDITB-DAY          PIC 99.
   532             20  SLASHB-2              PIC X VALUE '/'.
   533             20  DC-EDITB-CCYY.
   534                 24  DC-EDITB-CENT     PIC 99.
   535                 24  DC-EDITB-YEAR     PIC 99.
   536         16  DC-GREG-DATE-CYMD         PIC 9(08).
   537         16  DC-GREG-DATE-CYMD-R REDEFINES
   538                              DC-GREG-DATE-CYMD.
   539             20  DC-CYMD-CEN           PIC 99.
   540             20  DC-CYMD-YEAR          PIC 99.
   541             20  DC-CYMD-MONTH         PIC 99.
   542             20  DC-CYMD-DAY           PIC 99.
   543         16  DC-GREG-DATE-MDCY         PIC 9(08).
   544         16  DC-GREG-DATE-MDCY-R REDEFINES
   545                              DC-GREG-DATE-MDCY.
   546             20  DC-MDCY-MONTH         PIC 99.
   547             20  DC-MDCY-DAY           PIC 99.
   548             20  DC-MDCY-CEN           PIC 99.
   549             20  DC-MDCY-YEAR          PIC 99.
   550    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   551        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   552    12  DC-EL310-DATE                  PIC X(21).
   553    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  14
* EL633.cbl
   555*                                    COPY ELCLOGOF.
   556******************************************************************
   557*                                                                *
   558*                                                                *
   559*                            ELCLOGOF.                           *
   560*                            VMOD=2.001                          *
   561*                                                                *
   562*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   563*                                                                *
   564******************************************************************
   565 01  CLASIC-LOGOFF.
   566     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   567     12  LOGOFF-TEXT.
   568         16  FILLER          PIC X(5)    VALUE SPACES.
   569         16  LOGOFF-MSG.
   570             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   571             20  FILLER      PIC X       VALUE SPACES.
   572             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   573         16  FILLER          PIC X(80)
   574           VALUE '* YOU ARE NOW LOGGED OFF'.
   575         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   576         16  FILLER          PIC X       VALUE QUOTE.
   577         16  LOGOFF-SYS-MSG  PIC X(17)
   578           VALUE 'S CLAS-IC SYSTEM '.
   579     12  TEXT-MESSAGES.
   580         16  UNACCESS-MSG    PIC X(29)
   581             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   582         16  PGMIDERR-MSG    PIC X(17)
   583             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  15
* EL633.cbl
   585*                                    COPY ELCATTR.
   586******************************************************************
   587*                                                                *
   588*                            ELCATTR.                            *
   589*                            VMOD=2.001                          *
   590*                                                                *
   591*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   592*                                                                *
   593*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   594*                                                                *
   595*                   POS 1   P=PROTECTED                          *
   596*                           U=UNPROTECTED                        *
   597*                           S=ASKIP                              *
   598*                   POS 2   A=ALPHA/NUMERIC                      *
   599*                           N=NUMERIC                            *
   600*                   POS 3   N=NORMAL                             *
   601*                           B=BRIGHT                             *
   602*                           D=DARK                               *
   603*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   604*                           OF=MODIFIED DATA TAG OFF             *
   605*                                                                *
   606*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   607******************************************************************
   608 01  ATTRIBUTE-LIST.
   609     12  AL-PABOF            PIC X       VALUE 'Y'.
   610     12  AL-PABON            PIC X       VALUE 'Z'.
   611     12  AL-PADOF            PIC X       VALUE '%'.
   612     12  AL-PADON            PIC X       VALUE '_'.
   613     12  AL-PANOF            PIC X       VALUE '-'.
   614     12  AL-PANON            PIC X       VALUE '/'.
   615     12  AL-SABOF            PIC X       VALUE '8'.
   616     12  AL-SABON            PIC X       VALUE '9'.
   617     12  AL-SADOF            PIC X       VALUE '@'.
   618     12  AL-SADON            PIC X       VALUE QUOTE.
   619     12  AL-SANOF            PIC X       VALUE '0'.
   620     12  AL-SANON            PIC X       VALUE '1'.
   621     12  AL-UABOF            PIC X       VALUE 'H'.
   622     12  AL-UABON            PIC X       VALUE 'I'.
   623     12  AL-UADOF            PIC X       VALUE '<'.
   624     12  AL-UADON            PIC X       VALUE '('.
   625     12  AL-UANOF            PIC X       VALUE ' '.
   626     12  AL-UANON            PIC X       VALUE 'A'.
   627     12  AL-UNBOF            PIC X       VALUE 'Q'.
   628     12  AL-UNBON            PIC X       VALUE 'R'.
   629     12  AL-UNDOF            PIC X       VALUE '*'.
   630     12  AL-UNDON            PIC X       VALUE ')'.
   631     12  AL-UNNOF            PIC X       VALUE '&'.
   632     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  16
* EL633.cbl
   634*                                    COPY ELCEMIB.
   635******************************************************************
   636*                                                                *
   637*                                                                *
   638*                            ELCEMIB.                            *
   639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   640*                            VMOD=2.005                          *
   641*                                                                *
   642*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   643*                                                                *
   644******************************************************************
   645 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   646     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   647     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   648     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   649     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   650     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   651     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   652     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   653     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   654     12  EMI-SWITCH1             PIC X        VALUE '1'.
   655         88  EMI-NO-ERRORS                    VALUE '1'.
   656         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   657         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   658     12  EMI-SWITCH2             PIC X        VALUE '1'.
   659         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   660     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   661         88  EMI-AREA1-EMPTY                  VALUE '1'.
   662         88  EMI-AREA1-FULL                   VALUE '2'.
   663     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   664         88  EMI-AREA2-EMPTY                  VALUE '1'.
   665         88  EMI-AREA2-FULL                   VALUE '2'.
   666     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   667         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   668         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   669         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   670         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   671         88  EMI-BYPASS-FATALS                VALUE 'X'.
   672     12  EMI-ERROR-LINES.
   673         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   674         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   675         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   676         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   677             20  EMI-ERR-CODES OCCURS 10 TIMES.
   678                 24  EMI-ERR-NUM         PIC X(4).
   679                 24  EMI-FILLER          PIC X.
   680                 24  EMI-SEV             PIC X.
   681                 24  FILLER              PIC X.
   682             20  FILLER                  PIC X(02).
   683     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   684         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   685             20  EMI-ERROR-NUMBER    PIC X(4).
   686             20  EMI-FILL            PIC X.
   687             20  EMI-SEVERITY        PIC X.
   688             20  FILLER              PIC X.
   689             20  EMI-ERROR-TEXT.
   690                 24  EMI-TEXT-VARIABLE   PIC X(10).
   691                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  17
* EL633.cbl
   692     12  EMI-SEVERITY-SAVE           PIC X.
   693         88  EMI-NOTE                    VALUE 'N'.
   694         88  EMI-WARNING                 VALUE 'W'.
   695         88  EMI-FORCABLE                VALUE 'F'.
   696         88  EMI-FATAL                   VALUE 'X'.
   697     12  EMI-MESSAGE-FLAG            PIC X.
   698         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   699         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   700     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   701     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   702         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   703         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   704         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   705     12  emi-claim-no                pic x(7).
   706     12  emi-claim-type              pic x(6).
   707     12  FILLER                      PIC X(124)  VALUE SPACES.
   708     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   709     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   710     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   711     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  18
* EL633.cbl
   713*                                    COPY ELCINTF.
   714******************************************************************
   715*                                                                *
   716*                                                                *
   717*                            ELCINTF.                            *
   718*                            VMOD=2.017                          *
   719*                                                                *
   720*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   721*                                                                *
   722*       LENGTH = 1024                                            *
   723*                                                                *
   724******************************************************************
   725*                   C H A N G E   L O G
   726*
   727* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   728*-----------------------------------------------------------------
   729*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   730* EFFECTIVE    NUMBER
   731*-----------------------------------------------------------------
   732* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   733******************************************************************
   734 01  PROGRAM-INTERFACE-BLOCK.
   735     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   736     12  PI-CALLING-PROGRAM              PIC X(8).
   737     12  PI-SAVED-PROGRAM-1              PIC X(8).
   738     12  PI-SAVED-PROGRAM-2              PIC X(8).
   739     12  PI-SAVED-PROGRAM-3              PIC X(8).
   740     12  PI-SAVED-PROGRAM-4              PIC X(8).
   741     12  PI-SAVED-PROGRAM-5              PIC X(8).
   742     12  PI-SAVED-PROGRAM-6              PIC X(8).
   743     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   744     12  PI-COMPANY-ID                   PIC XXX.
   745     12  PI-COMPANY-CD                   PIC X.
   746
   747     12  PI-COMPANY-PASSWORD             PIC X(8).
   748
   749     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   750
   751     12  PI-CONTROL-IN-PROGRESS.
   752         16  PI-CARRIER                  PIC X.
   753         16  PI-GROUPING                 PIC X(6).
   754         16  PI-STATE                    PIC XX.
   755         16  PI-ACCOUNT                  PIC X(10).
   756         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   757                                         PIC X(10).
   758         16  PI-CLAIM-CERT-GRP.
   759             20  PI-CLAIM-NO             PIC X(7).
   760             20  PI-CERT-NO.
   761                 25  PI-CERT-PRIME       PIC X(10).
   762                 25  PI-CERT-SFX         PIC X.
   763             20  PI-CERT-EFF-DT          PIC XX.
   764         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   765             20  PI-PLAN-CODE            PIC X(2).
   766             20  PI-REVISION-NUMBER      PIC X(3).
   767             20  PI-PLAN-EFF-DT          PIC X(2).
   768             20  PI-PLAN-EXP-DT          PIC X(2).
   769             20  FILLER                  PIC X(11).
   770         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  19
* EL633.cbl
   771             20  PI-OE-REFERENCE-1.
   772                 25  PI-OE-REF-1-PRIME   PIC X(18).
   773                 25  PI-OE-REF-1-SUFF    PIC XX.
   774
   775     12  PI-SESSION-IN-PROGRESS          PIC X.
   776         88  CLAIM-SESSION                   VALUE '1'.
   777         88  CREDIT-SESSION                  VALUE '2'.
   778         88  WARRANTY-SESSION                VALUE '3'.
   779         88  MORTGAGE-SESSION                VALUE '4'.
   780         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   781
   782
   783*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   784
   785     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   786     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   787
   788     12  PI-CREDIT-USER                  PIC X.
   789         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   790         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   791
   792     12  PI-CLAIM-USER                   PIC X.
   793         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   794         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   795
   796     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   797         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   798         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   799         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   800         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   801         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   802
   803     12  PI-PROCESSOR-ID                 PIC X(4).
   804
   805     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   806
   807     12  PI-MEMBER-CAPTION               PIC X(10).
   808
   809     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   810         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   811
   812     12  PI-LIFE-OVERRIDE-L1             PIC X.
   813     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   814     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   815     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   816
   817     12  PI-AH-OVERRIDE-L1               PIC X.
   818     12  PI-AH-OVERRIDE-L2               PIC XX.
   819     12  PI-AH-OVERRIDE-L6               PIC X(6).
   820     12  PI-AH-OVERRIDE-L12              PIC X(12).
   821
   822     12  PI-NEW-SYSTEM                   PIC X(2).
   823
   824     12  PI-PRIMARY-CERT-NO              PIC X(11).
   825     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   826         88  PI-USES-PAID-TO                 VALUE '1'.
   827     12  PI-CRDTCRD-SYSTEM.
   828         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  20
* EL633.cbl
   829             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   830             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   831         16  PI-CC-MONTH-END-DT          PIC XX.
   832     12  PI-PROCESSOR-PRINTER            PIC X(4).
   833
   834     12  PI-OE-REFERENCE-2.
   835         16  PI-OE-REF-2-PRIME           PIC X(10).
   836         16  PI-OE-REF-2-SUFF            PIC X.
   837
   838     12  PI-REM-TRM-CALC-OPTION          PIC X.
   839
   840     12  PI-LANGUAGE-TYPE                PIC X.
   841             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   842             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   843             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   844
   845     12  PI-POLICY-LINKAGE-IND           PIC X.
   846         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   847         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   848                                                   LOW-VALUES.
   849
   850     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   851     12  PI-CLAIM-PW-SESSION             PIC X(1).
   852         88  PI-CLAIM-CREDIT                 VALUE '1'.
   853         88  PI-CLAIM-CONVEN                 VALUE '2'.
   854
   855     12  PI-PROCESSOR-CSR-IND            PIC X.
   856         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   857         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   858
   859     12  FILLER                          PIC X(3).
   860
   861     12  PI-SYSTEM-LEVEL                 PIC X(145).
   862
   863     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   864         PI-SYSTEM-LEVEL.
   865
   866         16  PI-ENTRY-CODES.
   867             20  PI-ENTRY-CD-1           PIC X.
   868             20  PI-ENTRY-CD-2           PIC X.
   869
   870         16  PI-RETURN-CODES.
   871             20  PI-RETURN-CD-1          PIC X.
   872             20  PI-RETURN-CD-2          PIC X.
   873
   874         16  PI-UPDATE-STATUS-SAVE.
   875             20  PI-UPDATE-BY            PIC X(4).
   876             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   877
   878         16  PI-LOWER-CASE-LETTERS       PIC X.
   879             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   880
   881*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   882*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   883*            88  CARRIER-CLM-CNTL            VALUE '2'.
   884
   885         16  PI-CERT-ACCESS-CONTROL      PIC X.
   886             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  21
* EL633.cbl
   887             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   888             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   889             88  ACCNT-CNTL                  VALUE '3'.
   890             88  CARR-ACCNT-CNTL             VALUE '4'.
   891
   892         16  PI-PROCESSOR-CAP-LIST.
   893             20  PI-SYSTEM-CONTROLS.
   894                24 PI-SYSTEM-DISPLAY     PIC X.
   895                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   896                24 PI-SYSTEM-MODIFY      PIC X.
   897                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   898             20  FILLER                  PIC XX.
   899             20  PI-DISPLAY-CAP          PIC X.
   900                 88  DISPLAY-CAP             VALUE 'Y'.
   901             20  PI-MODIFY-CAP           PIC X.
   902                 88  MODIFY-CAP              VALUE 'Y'.
   903             20  PI-MSG-AT-LOGON-CAP     PIC X.
   904                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   905             20  PI-FORCE-CAP            PIC X.
   906                 88  FORCE-CAP               VALUE 'Y'.
   907
   908         16  PI-PROGRAM-CONTROLS.
   909             20  PI-PGM-PRINT-OPT        PIC X.
   910             20  PI-PGM-FORMAT-OPT       PIC X.
   911             20  PI-PGM-PROCESS-OPT      PIC X.
   912             20  PI-PGM-TOTALS-OPT       PIC X.
   913
   914         16  PI-HELP-INTERFACE.
   915             20  PI-LAST-ERROR-NO        PIC X(4).
   916             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   917
   918         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   919             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   920
   921         16  PI-CR-CONTROL-IN-PROGRESS.
   922             20  PI-CR-CARRIER           PIC X.
   923             20  PI-CR-GROUPING          PIC X(6).
   924             20  PI-CR-STATE             PIC XX.
   925             20  PI-CR-ACCOUNT           PIC X(10).
   926             20  PI-CR-FIN-RESP          PIC X(10).
   927             20  PI-CR-TYPE              PIC X.
   928
   929         16  PI-CR-BATCH-NUMBER          PIC X(6).
   930
   931         16  PI-CR-MONTH-END-DT          PIC XX.
   932
   933         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   934             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   935             88  PI-ZERO-CARRIER             VALUE '1'.
   936             88  PI-ZERO-GROUPING            VALUE '2'.
   937             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   938
   939         16  PI-CARRIER-SECURITY         PIC X.
   940             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   941
   942         16  PI-ACCOUNT-SECURITY         PIC X(10).
   943             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   944             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  22
* EL633.cbl
   945
   946         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   947             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   948                                         INDEXED BY PI-ACCESS-NDX
   949                                         PIC X.
   950
   951         16  PI-GA-BILLING-CONTROL       PIC X.
   952             88  PI-GA-BILLING               VALUE '1'.
   953
   954         16  PI-MAIL-PROCESSING          PIC X.
   955             88  PI-MAIL-YES                 VALUE 'Y'.
   956
   957         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   958
   959         16  PI-AR-SYSTEM.
   960             20  PI-AR-PROCESSING-CNTL   PIC X.
   961                 88  PI-AR-PROCESSING        VALUE 'Y'.
   962             20  PI-AR-SUMMARY-CODE      PIC X(6).
   963             20  PI-AR-MONTH-END-DT      PIC XX.
   964
   965         16  PI-MP-SYSTEM.
   966             20  PI-MORTGAGE-USER            PIC X.
   967                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   968                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   969             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   970                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   971                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   972                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   973                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   974                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   975             20  PI-MP-MONTH-END-DT          PIC XX.
   976             20  PI-MP-REFERENCE-NO.
   977                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   978                 24  PI-MP-REFERENCE-SFX     PIC XX.
   979
   980         16  PI-LABEL-CONTROL            PIC X(01).
   981             88  PI-CREATE-LABELS                    VALUE 'Y'.
   982             88  PI-BYPASS-LABELS                    VALUE 'N'.
   983
   984         16  PI-BILL-GROUPING-CODE       PIC X(01).
   985             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   986
   987         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   988             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   989             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   990
   991         16  FILLER                      PIC X(14).
   992
   993     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   994******************************************************************
   995     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   996         16  PI-PYAJ-FILE-SW             PIC  X.
   997             88  END-OF-ACCT                 VALUE 'A'.
   998             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   999             88  END-OF-FILE                 VALUE 'X'.
  1000             88  TOP-OF-FILE                 VALUE 'T'.
  1001             88  PAGE-FULL                   VALUE 'F'.
  1002             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  23
* EL633.cbl
  1003             88  NOT-OPEN                    VALUE 'Z'.
  1004         16  PI-PREV-FUNCTION            PIC  X.
  1005         16  PI-SAV-FUNCTION             PIC  X.
  1006         16  PI-PREV-PFKEY               PIC  X.
  1007         16  PI-SEQ-NOS.
  1008             20  FILLER  OCCURS 13 TIMES
  1009                             INDEXED BY NDX.
  1010                 24  PI-REC-TYPE         PIC  X.
  1011                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1012         16  PI-SAV-ENDING-PYAJ-KEY.
  1013             20  PI-SAV-COMP-CD          PIC  X.
  1014             20  PI-SAV-COMP-CONTROL.
  1015                 24  PI-SAV-CARRIER      PIC  X.
  1016                 24  PI-SAV-GROUPING     PIC  X(6).
  1017                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1018                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1019                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1020                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1021         16  PI-START-PYAJ-KEY           PIC  X(33).
  1022         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1023         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1024         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1025         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1026         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1027             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1028         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1029         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1030         16  PI-FRST-RECORD-TYPE         PIC  X.
  1031         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1032         16  PI-PREV-RECORD-TYPE         PIC  X.
  1033         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1034         16  PI-LAST-RECORD-TYPE         PIC  X.
  1035         16  PI-PAGE-SW                  PIC  X.
  1036             88  FIRST-PAGE                          VALUE 'Y'.
  1037         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  24
* EL633.cbl
  1039*                            COPY ELCJPFX.
  1040******************************************************************
  1041*                                                                *
  1042*                                                                *
  1043*                            ELCJPFX.                            *
  1044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1045*                            VMOD=2.002                          *
  1046*                                                                *
  1047*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1048*                                                                *
  1049*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1050*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1051*        ELCNTL - CONTROL FILE                                   *
  1052*        ELMSTR - CLAIM MASTERS                                  *
  1053*        ELTRLR - ACTIVITY TRAILERS                              *
  1054*        ELCHKQ - CHECK QUE                                      *
  1055******************************************************************
  1056 01  JOURNAL-RECORD.
  1057     12  jp-date                     pic s9(5) comp-3.
  1058     12  jp-time                     pic s9(7) comp-3.
  1059     12  JP-USER-ID                  PIC X(4).
  1060     12  JP-FILE-ID                  PIC X(8).
  1061     12  JP-PROGRAM-ID               PIC X(8).
  1062     12  JP-RECORD-TYPE              PIC X.
  1063         88 JP-ADD              VALUE 'A'.
  1064         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1065         88 JP-AFTER-CHANGE     VALUE 'C'.
  1066         88 JP-DELETE           VALUE 'D'.
  1067         88 JP-GENERIC-DELETE   VALUE 'G'.
  1068         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1069         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1070     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1071     12  JP-RECORD-AREA
  1072
  1073
  1074                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  25
* EL633.cbl
  1076*                            COPY ELCAID.
  1077******************************************************************
  1078*                                                                *
  1079*                            ELCAID.                             *
  1080*                            VMOD=2.001                          *
  1081*                                                                *
  1082*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1083*                                                                *
  1084*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1085*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1086******************************************************************
  1087
  1088 01  DFHAID.
  1089   02  DFHNULL   PIC  X  VALUE  ' '.
  1090   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1091   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1092   02  DFHPEN    PIC  X  VALUE  '='.
  1093   02  DFHOPID   PIC  X  VALUE  'W'.
  1094   02  DFHPA1    PIC  X  VALUE  '%'.
  1095   02  DFHPA2    PIC  X  VALUE  '>'.
  1096   02  DFHPA3    PIC  X  VALUE  ','.
  1097   02  DFHPF1    PIC  X  VALUE  '1'.
  1098   02  DFHPF2    PIC  X  VALUE  '2'.
  1099   02  DFHPF3    PIC  X  VALUE  '3'.
  1100   02  DFHPF4    PIC  X  VALUE  '4'.
  1101   02  DFHPF5    PIC  X  VALUE  '5'.
  1102   02  DFHPF6    PIC  X  VALUE  '6'.
  1103   02  DFHPF7    PIC  X  VALUE  '7'.
  1104   02  DFHPF8    PIC  X  VALUE  '8'.
  1105   02  DFHPF9    PIC  X  VALUE  '9'.
  1106   02  DFHPF10   PIC  X  VALUE  ':'.
  1107   02  DFHPF11   PIC  X  VALUE  '#'.
  1108   02  DFHPF12   PIC  X  VALUE  '@'.
  1109   02  DFHPF13   PIC  X  VALUE  'A'.
  1110   02  DFHPF14   PIC  X  VALUE  'B'.
  1111   02  DFHPF15   PIC  X  VALUE  'C'.
  1112   02  DFHPF16   PIC  X  VALUE  'D'.
  1113   02  DFHPF17   PIC  X  VALUE  'E'.
  1114   02  DFHPF18   PIC  X  VALUE  'F'.
  1115   02  DFHPF19   PIC  X  VALUE  'G'.
  1116   02  DFHPF20   PIC  X  VALUE  'H'.
  1117   02  DFHPF21   PIC  X  VALUE  'I'.
  1118*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1119   02  DFHPF22   PIC  X  VALUE  '['.
  1120   02  DFHPF23   PIC  X  VALUE  '.'.
  1121   02  DFHPF24   PIC  X  VALUE  '<'.
  1122   02  DFHMSRE   PIC  X  VALUE  'X'.
  1123   02  DFHSTRF   PIC  X  VALUE  'h'.
  1124   02  DFHTRIG   PIC  X  VALUE  '"'.
  1125
  1126 01  FILLER  REDEFINES  DFHAID.
  1127     12  FILLER              PIC  X(8).
  1128     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  26
* EL633.cbl
  1130*                            COPY EL633S.
  1131 01  EL633AI.
  1132     05  FILLER            PIC  X(0012).
  1133*    -------------------------------
  1134     05  DATEL PIC S9(0004) COMP.
  1135     05  DATEF PIC  X(0001).
  1136     05  FILLER REDEFINES DATEF.
  1137         10  DATEA PIC  X(0001).
  1138     05  DATEI PIC  X(0008).
  1139*    -------------------------------
  1140     05  TIMEL PIC S9(0004) COMP.
  1141     05  TIMEF PIC  X(0001).
  1142     05  FILLER REDEFINES TIMEF.
  1143         10  TIMEA PIC  X(0001).
  1144     05  TIMEI PIC  X(0005).
  1145*    -------------------------------
  1146     05  CMPNYIDL PIC S9(0004) COMP.
  1147     05  CMPNYIDF PIC  X(0001).
  1148     05  FILLER REDEFINES CMPNYIDF.
  1149         10  CMPNYIDA PIC  X(0001).
  1150     05  CMPNYIDI PIC  X(0003).
  1151*    -------------------------------
  1152     05  USERIDL PIC S9(0004) COMP.
  1153     05  USERIDF PIC  X(0001).
  1154     05  FILLER REDEFINES USERIDF.
  1155         10  USERIDA PIC  X(0001).
  1156     05  USERIDI PIC  X(0004).
  1157*    -------------------------------
  1158     05  MAINTL PIC S9(0004) COMP.
  1159     05  MAINTF PIC  X(0001).
  1160     05  FILLER REDEFINES MAINTF.
  1161         10  MAINTA PIC  X(0001).
  1162     05  MAINTI PIC  X(0001).
  1163*    -------------------------------
  1164     05  CARRIERL PIC S9(0004) COMP.
  1165     05  CARRIERF PIC  X(0001).
  1166     05  FILLER REDEFINES CARRIERF.
  1167         10  CARRIERA PIC  X(0001).
  1168     05  CARRIERI PIC  X(0001).
  1169*    -------------------------------
  1170     05  GROUPL PIC S9(0004) COMP.
  1171     05  GROUPF PIC  X(0001).
  1172     05  FILLER REDEFINES GROUPF.
  1173         10  GROUPA PIC  X(0001).
  1174     05  GROUPI PIC  X(0006).
  1175*    -------------------------------
  1176     05  FINRESPL PIC S9(0004) COMP.
  1177     05  FINRESPF PIC  X(0001).
  1178     05  FILLER REDEFINES FINRESPF.
  1179         10  FINRESPA PIC  X(0001).
  1180     05  FINRESPI PIC  X(0010).
  1181*    -------------------------------
  1182     05  ACCTL PIC S9(0004) COMP.
  1183     05  ACCTF PIC  X(0001).
  1184     05  FILLER REDEFINES ACCTF.
  1185         10  ACCTA PIC  X(0001).
  1186     05  ACCTI PIC  X(0010).
  1187*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  27
* EL633.cbl
  1188     05  MSAAC1L PIC S9(0004) COMP.
  1189     05  MSAAC1F PIC  X(0001).
  1190     05  FILLER REDEFINES MSAAC1F.
  1191         10  MSAAC1A PIC  X(0001).
  1192     05  MSAAC1I PIC  X(0010).
  1193*    -------------------------------
  1194     05  MSAST1L PIC S9(0004) COMP.
  1195     05  MSAST1F PIC  X(0001).
  1196     05  FILLER REDEFINES MSAST1F.
  1197         10  MSAST1A PIC  X(0001).
  1198     05  MSAST1I PIC  X(0002).
  1199*    -------------------------------
  1200     05  MSACN1L PIC S9(0004) COMP.
  1201     05  MSACN1F PIC  X(0001).
  1202     05  FILLER REDEFINES MSACN1F.
  1203         10  MSACN1A PIC  X(0001).
  1204     05  MSACN1I PIC  X(0001).
  1205*    -------------------------------
  1206     05  MSACM1L PIC S9(0004) COMP.
  1207     05  MSACM1F PIC  X(0001).
  1208     05  FILLER REDEFINES MSACM1F.
  1209         10  MSACM1A PIC  X(0001).
  1210     05  MSACM1I PIC  X(0010).
  1211*    -------------------------------
  1212     05  TYPE1L PIC S9(0004) COMP.
  1213     05  TYPE1F PIC  X(0001).
  1214     05  FILLER REDEFINES TYPE1F.
  1215         10  TYPE1A PIC  X(0001).
  1216     05  TYPE1I PIC  X(0001).
  1217*    -------------------------------
  1218     05  AMT1L PIC S9(0004) COMP.
  1219     05  AMT1F PIC  X(0001).
  1220     05  FILLER REDEFINES AMT1F.
  1221         10  AMT1A PIC  X(0001).
  1222     05  AMT1I PIC  X(0011).
  1223*    -------------------------------
  1224     05  VOID1L PIC S9(0004) COMP.
  1225     05  VOID1F PIC  X(0001).
  1226     05  FILLER REDEFINES VOID1F.
  1227         10  VOID1A PIC  X(0001).
  1228     05  VOID1I PIC  X(0001).
  1229*    -------------------------------
  1230     05  MDT1L PIC S9(0004) COMP.
  1231     05  MDT1F PIC  X(0001).
  1232     05  FILLER REDEFINES MDT1F.
  1233         10  MDT1A PIC  X(0001).
  1234     05  MDT1I PIC  X(0006).
  1235*    -------------------------------
  1236     05  BDT1L PIC S9(0004) COMP.
  1237     05  BDT1F PIC  X(0001).
  1238     05  FILLER REDEFINES BDT1F.
  1239         10  BDT1A PIC  X(0001).
  1240     05  BDT1I PIC  X(0006).
  1241*    -------------------------------
  1242     05  SDT1L PIC S9(0004) COMP.
  1243     05  SDT1F PIC  X(0001).
  1244     05  FILLER REDEFINES SDT1F.
  1245         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  28
* EL633.cbl
  1246     05  SDT1I PIC  X(0006).
  1247*    -------------------------------
  1248     05  MSAAC2L PIC S9(0004) COMP.
  1249     05  MSAAC2F PIC  X(0001).
  1250     05  FILLER REDEFINES MSAAC2F.
  1251         10  MSAAC2A PIC  X(0001).
  1252     05  MSAAC2I PIC  X(0010).
  1253*    -------------------------------
  1254     05  MSAST2L PIC S9(0004) COMP.
  1255     05  MSAST2F PIC  X(0001).
  1256     05  FILLER REDEFINES MSAST2F.
  1257         10  MSAST2A PIC  X(0001).
  1258     05  MSAST2I PIC  X(0002).
  1259*    -------------------------------
  1260     05  MSACN2L PIC S9(0004) COMP.
  1261     05  MSACN2F PIC  X(0001).
  1262     05  FILLER REDEFINES MSACN2F.
  1263         10  MSACN2A PIC  X(0001).
  1264     05  MSACN2I PIC  X(0001).
  1265*    -------------------------------
  1266     05  MSACM2L PIC S9(0004) COMP.
  1267     05  MSACM2F PIC  X(0001).
  1268     05  FILLER REDEFINES MSACM2F.
  1269         10  MSACM2A PIC  X(0001).
  1270     05  MSACM2I PIC  X(0010).
  1271*    -------------------------------
  1272     05  TYPE2L PIC S9(0004) COMP.
  1273     05  TYPE2F PIC  X(0001).
  1274     05  FILLER REDEFINES TYPE2F.
  1275         10  TYPE2A PIC  X(0001).
  1276     05  TYPE2I PIC  X(0001).
  1277*    -------------------------------
  1278     05  AMT2L PIC S9(0004) COMP.
  1279     05  AMT2F PIC  X(0001).
  1280     05  FILLER REDEFINES AMT2F.
  1281         10  AMT2A PIC  X(0001).
  1282     05  AMT2I PIC  X(0011).
  1283*    -------------------------------
  1284     05  VOID2L PIC S9(0004) COMP.
  1285     05  VOID2F PIC  X(0001).
  1286     05  FILLER REDEFINES VOID2F.
  1287         10  VOID2A PIC  X(0001).
  1288     05  VOID2I PIC  X(0001).
  1289*    -------------------------------
  1290     05  MDT2L PIC S9(0004) COMP.
  1291     05  MDT2F PIC  X(0001).
  1292     05  FILLER REDEFINES MDT2F.
  1293         10  MDT2A PIC  X(0001).
  1294     05  MDT2I PIC  X(0006).
  1295*    -------------------------------
  1296     05  BDT2L PIC S9(0004) COMP.
  1297     05  BDT2F PIC  X(0001).
  1298     05  FILLER REDEFINES BDT2F.
  1299         10  BDT2A PIC  X(0001).
  1300     05  BDT2I PIC  X(0006).
  1301*    -------------------------------
  1302     05  SDT2L PIC S9(0004) COMP.
  1303     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  29
* EL633.cbl
  1304     05  FILLER REDEFINES SDT2F.
  1305         10  SDT2A PIC  X(0001).
  1306     05  SDT2I PIC  X(0006).
  1307*    -------------------------------
  1308     05  MSAAC3L PIC S9(0004) COMP.
  1309     05  MSAAC3F PIC  X(0001).
  1310     05  FILLER REDEFINES MSAAC3F.
  1311         10  MSAAC3A PIC  X(0001).
  1312     05  MSAAC3I PIC  X(0010).
  1313*    -------------------------------
  1314     05  MSAST3L PIC S9(0004) COMP.
  1315     05  MSAST3F PIC  X(0001).
  1316     05  FILLER REDEFINES MSAST3F.
  1317         10  MSAST3A PIC  X(0001).
  1318     05  MSAST3I PIC  X(0002).
  1319*    -------------------------------
  1320     05  MSACN3L PIC S9(0004) COMP.
  1321     05  MSACN3F PIC  X(0001).
  1322     05  FILLER REDEFINES MSACN3F.
  1323         10  MSACN3A PIC  X(0001).
  1324     05  MSACN3I PIC  X(0001).
  1325*    -------------------------------
  1326     05  MSACM3L PIC S9(0004) COMP.
  1327     05  MSACM3F PIC  X(0001).
  1328     05  FILLER REDEFINES MSACM3F.
  1329         10  MSACM3A PIC  X(0001).
  1330     05  MSACM3I PIC  X(0010).
  1331*    -------------------------------
  1332     05  TYPE3L PIC S9(0004) COMP.
  1333     05  TYPE3F PIC  X(0001).
  1334     05  FILLER REDEFINES TYPE3F.
  1335         10  TYPE3A PIC  X(0001).
  1336     05  TYPE3I PIC  X(0001).
  1337*    -------------------------------
  1338     05  AMT3L PIC S9(0004) COMP.
  1339     05  AMT3F PIC  X(0001).
  1340     05  FILLER REDEFINES AMT3F.
  1341         10  AMT3A PIC  X(0001).
  1342     05  AMT3I PIC  X(0011).
  1343*    -------------------------------
  1344     05  VOID3L PIC S9(0004) COMP.
  1345     05  VOID3F PIC  X(0001).
  1346     05  FILLER REDEFINES VOID3F.
  1347         10  VOID3A PIC  X(0001).
  1348     05  VOID3I PIC  X(0001).
  1349*    -------------------------------
  1350     05  MDT3L PIC S9(0004) COMP.
  1351     05  MDT3F PIC  X(0001).
  1352     05  FILLER REDEFINES MDT3F.
  1353         10  MDT3A PIC  X(0001).
  1354     05  MDT3I PIC  X(0006).
  1355*    -------------------------------
  1356     05  BDT3L PIC S9(0004) COMP.
  1357     05  BDT3F PIC  X(0001).
  1358     05  FILLER REDEFINES BDT3F.
  1359         10  BDT3A PIC  X(0001).
  1360     05  BDT3I PIC  X(0006).
  1361*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  30
* EL633.cbl
  1362     05  SDT3L PIC S9(0004) COMP.
  1363     05  SDT3F PIC  X(0001).
  1364     05  FILLER REDEFINES SDT3F.
  1365         10  SDT3A PIC  X(0001).
  1366     05  SDT3I PIC  X(0006).
  1367*    -------------------------------
  1368     05  MSAAC4L PIC S9(0004) COMP.
  1369     05  MSAAC4F PIC  X(0001).
  1370     05  FILLER REDEFINES MSAAC4F.
  1371         10  MSAAC4A PIC  X(0001).
  1372     05  MSAAC4I PIC  X(0010).
  1373*    -------------------------------
  1374     05  MSAST4L PIC S9(0004) COMP.
  1375     05  MSAST4F PIC  X(0001).
  1376     05  FILLER REDEFINES MSAST4F.
  1377         10  MSAST4A PIC  X(0001).
  1378     05  MSAST4I PIC  X(0002).
  1379*    -------------------------------
  1380     05  MSACN4L PIC S9(0004) COMP.
  1381     05  MSACN4F PIC  X(0001).
  1382     05  FILLER REDEFINES MSACN4F.
  1383         10  MSACN4A PIC  X(0001).
  1384     05  MSACN4I PIC  X(0001).
  1385*    -------------------------------
  1386     05  MSACM4L PIC S9(0004) COMP.
  1387     05  MSACM4F PIC  X(0001).
  1388     05  FILLER REDEFINES MSACM4F.
  1389         10  MSACM4A PIC  X(0001).
  1390     05  MSACM4I PIC  X(0010).
  1391*    -------------------------------
  1392     05  TYPE4L PIC S9(0004) COMP.
  1393     05  TYPE4F PIC  X(0001).
  1394     05  FILLER REDEFINES TYPE4F.
  1395         10  TYPE4A PIC  X(0001).
  1396     05  TYPE4I PIC  X(0001).
  1397*    -------------------------------
  1398     05  AMT4L PIC S9(0004) COMP.
  1399     05  AMT4F PIC  X(0001).
  1400     05  FILLER REDEFINES AMT4F.
  1401         10  AMT4A PIC  X(0001).
  1402     05  AMT4I PIC  X(0011).
  1403*    -------------------------------
  1404     05  VOID4L PIC S9(0004) COMP.
  1405     05  VOID4F PIC  X(0001).
  1406     05  FILLER REDEFINES VOID4F.
  1407         10  VOID4A PIC  X(0001).
  1408     05  VOID4I PIC  X(0001).
  1409*    -------------------------------
  1410     05  MDT4L PIC S9(0004) COMP.
  1411     05  MDT4F PIC  X(0001).
  1412     05  FILLER REDEFINES MDT4F.
  1413         10  MDT4A PIC  X(0001).
  1414     05  MDT4I PIC  X(0006).
  1415*    -------------------------------
  1416     05  BDT4L PIC S9(0004) COMP.
  1417     05  BDT4F PIC  X(0001).
  1418     05  FILLER REDEFINES BDT4F.
  1419         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  31
* EL633.cbl
  1420     05  BDT4I PIC  X(0006).
  1421*    -------------------------------
  1422     05  SDT4L PIC S9(0004) COMP.
  1423     05  SDT4F PIC  X(0001).
  1424     05  FILLER REDEFINES SDT4F.
  1425         10  SDT4A PIC  X(0001).
  1426     05  SDT4I PIC  X(0006).
  1427*    -------------------------------
  1428     05  MSAAC5L PIC S9(0004) COMP.
  1429     05  MSAAC5F PIC  X(0001).
  1430     05  FILLER REDEFINES MSAAC5F.
  1431         10  MSAAC5A PIC  X(0001).
  1432     05  MSAAC5I PIC  X(0010).
  1433*    -------------------------------
  1434     05  MSAST5L PIC S9(0004) COMP.
  1435     05  MSAST5F PIC  X(0001).
  1436     05  FILLER REDEFINES MSAST5F.
  1437         10  MSAST5A PIC  X(0001).
  1438     05  MSAST5I PIC  X(0002).
  1439*    -------------------------------
  1440     05  MSACN5L PIC S9(0004) COMP.
  1441     05  MSACN5F PIC  X(0001).
  1442     05  FILLER REDEFINES MSACN5F.
  1443         10  MSACN5A PIC  X(0001).
  1444     05  MSACN5I PIC  X(0001).
  1445*    -------------------------------
  1446     05  MSACM5L PIC S9(0004) COMP.
  1447     05  MSACM5F PIC  X(0001).
  1448     05  FILLER REDEFINES MSACM5F.
  1449         10  MSACM5A PIC  X(0001).
  1450     05  MSACM5I PIC  X(0010).
  1451*    -------------------------------
  1452     05  TYPE5L PIC S9(0004) COMP.
  1453     05  TYPE5F PIC  X(0001).
  1454     05  FILLER REDEFINES TYPE5F.
  1455         10  TYPE5A PIC  X(0001).
  1456     05  TYPE5I PIC  X(0001).
  1457*    -------------------------------
  1458     05  AMT5L PIC S9(0004) COMP.
  1459     05  AMT5F PIC  X(0001).
  1460     05  FILLER REDEFINES AMT5F.
  1461         10  AMT5A PIC  X(0001).
  1462     05  AMT5I PIC  X(0011).
  1463*    -------------------------------
  1464     05  VOID5L PIC S9(0004) COMP.
  1465     05  VOID5F PIC  X(0001).
  1466     05  FILLER REDEFINES VOID5F.
  1467         10  VOID5A PIC  X(0001).
  1468     05  VOID5I PIC  X(0001).
  1469*    -------------------------------
  1470     05  MDT5L PIC S9(0004) COMP.
  1471     05  MDT5F PIC  X(0001).
  1472     05  FILLER REDEFINES MDT5F.
  1473         10  MDT5A PIC  X(0001).
  1474     05  MDT5I PIC  X(0006).
  1475*    -------------------------------
  1476     05  BDT5L PIC S9(0004) COMP.
  1477     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  32
* EL633.cbl
  1478     05  FILLER REDEFINES BDT5F.
  1479         10  BDT5A PIC  X(0001).
  1480     05  BDT5I PIC  X(0006).
  1481*    -------------------------------
  1482     05  SDT5L PIC S9(0004) COMP.
  1483     05  SDT5F PIC  X(0001).
  1484     05  FILLER REDEFINES SDT5F.
  1485         10  SDT5A PIC  X(0001).
  1486     05  SDT5I PIC  X(0006).
  1487*    -------------------------------
  1488     05  MSAAC6L PIC S9(0004) COMP.
  1489     05  MSAAC6F PIC  X(0001).
  1490     05  FILLER REDEFINES MSAAC6F.
  1491         10  MSAAC6A PIC  X(0001).
  1492     05  MSAAC6I PIC  X(0010).
  1493*    -------------------------------
  1494     05  MSAST6L PIC S9(0004) COMP.
  1495     05  MSAST6F PIC  X(0001).
  1496     05  FILLER REDEFINES MSAST6F.
  1497         10  MSAST6A PIC  X(0001).
  1498     05  MSAST6I PIC  X(0002).
  1499*    -------------------------------
  1500     05  MSACN6L PIC S9(0004) COMP.
  1501     05  MSACN6F PIC  X(0001).
  1502     05  FILLER REDEFINES MSACN6F.
  1503         10  MSACN6A PIC  X(0001).
  1504     05  MSACN6I PIC  X(0001).
  1505*    -------------------------------
  1506     05  MSACM6L PIC S9(0004) COMP.
  1507     05  MSACM6F PIC  X(0001).
  1508     05  FILLER REDEFINES MSACM6F.
  1509         10  MSACM6A PIC  X(0001).
  1510     05  MSACM6I PIC  X(0010).
  1511*    -------------------------------
  1512     05  TYPE6L PIC S9(0004) COMP.
  1513     05  TYPE6F PIC  X(0001).
  1514     05  FILLER REDEFINES TYPE6F.
  1515         10  TYPE6A PIC  X(0001).
  1516     05  TYPE6I PIC  X(0001).
  1517*    -------------------------------
  1518     05  AMT6L PIC S9(0004) COMP.
  1519     05  AMT6F PIC  X(0001).
  1520     05  FILLER REDEFINES AMT6F.
  1521         10  AMT6A PIC  X(0001).
  1522     05  AMT6I PIC  X(0011).
  1523*    -------------------------------
  1524     05  VOID6L PIC S9(0004) COMP.
  1525     05  VOID6F PIC  X(0001).
  1526     05  FILLER REDEFINES VOID6F.
  1527         10  VOID6A PIC  X(0001).
  1528     05  VOID6I PIC  X(0001).
  1529*    -------------------------------
  1530     05  MDT6L PIC S9(0004) COMP.
  1531     05  MDT6F PIC  X(0001).
  1532     05  FILLER REDEFINES MDT6F.
  1533         10  MDT6A PIC  X(0001).
  1534     05  MDT6I PIC  X(0006).
  1535*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  33
* EL633.cbl
  1536     05  BDT6L PIC S9(0004) COMP.
  1537     05  BDT6F PIC  X(0001).
  1538     05  FILLER REDEFINES BDT6F.
  1539         10  BDT6A PIC  X(0001).
  1540     05  BDT6I PIC  X(0006).
  1541*    -------------------------------
  1542     05  SDT6L PIC S9(0004) COMP.
  1543     05  SDT6F PIC  X(0001).
  1544     05  FILLER REDEFINES SDT6F.
  1545         10  SDT6A PIC  X(0001).
  1546     05  SDT6I PIC  X(0006).
  1547*    -------------------------------
  1548     05  MSAAC7L PIC S9(0004) COMP.
  1549     05  MSAAC7F PIC  X(0001).
  1550     05  FILLER REDEFINES MSAAC7F.
  1551         10  MSAAC7A PIC  X(0001).
  1552     05  MSAAC7I PIC  X(0010).
  1553*    -------------------------------
  1554     05  MSAST7L PIC S9(0004) COMP.
  1555     05  MSAST7F PIC  X(0001).
  1556     05  FILLER REDEFINES MSAST7F.
  1557         10  MSAST7A PIC  X(0001).
  1558     05  MSAST7I PIC  X(0002).
  1559*    -------------------------------
  1560     05  MSACN7L PIC S9(0004) COMP.
  1561     05  MSACN7F PIC  X(0001).
  1562     05  FILLER REDEFINES MSACN7F.
  1563         10  MSACN7A PIC  X(0001).
  1564     05  MSACN7I PIC  X(0001).
  1565*    -------------------------------
  1566     05  MSACM7L PIC S9(0004) COMP.
  1567     05  MSACM7F PIC  X(0001).
  1568     05  FILLER REDEFINES MSACM7F.
  1569         10  MSACM7A PIC  X(0001).
  1570     05  MSACM7I PIC  X(0010).
  1571*    -------------------------------
  1572     05  TYPE7L PIC S9(0004) COMP.
  1573     05  TYPE7F PIC  X(0001).
  1574     05  FILLER REDEFINES TYPE7F.
  1575         10  TYPE7A PIC  X(0001).
  1576     05  TYPE7I PIC  X(0001).
  1577*    -------------------------------
  1578     05  AMT7L PIC S9(0004) COMP.
  1579     05  AMT7F PIC  X(0001).
  1580     05  FILLER REDEFINES AMT7F.
  1581         10  AMT7A PIC  X(0001).
  1582     05  AMT7I PIC  X(0011).
  1583*    -------------------------------
  1584     05  VOID7L PIC S9(0004) COMP.
  1585     05  VOID7F PIC  X(0001).
  1586     05  FILLER REDEFINES VOID7F.
  1587         10  VOID7A PIC  X(0001).
  1588     05  VOID7I PIC  X(0001).
  1589*    -------------------------------
  1590     05  MDT7L PIC S9(0004) COMP.
  1591     05  MDT7F PIC  X(0001).
  1592     05  FILLER REDEFINES MDT7F.
  1593         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  34
* EL633.cbl
  1594     05  MDT7I PIC  X(0006).
  1595*    -------------------------------
  1596     05  BDT7L PIC S9(0004) COMP.
  1597     05  BDT7F PIC  X(0001).
  1598     05  FILLER REDEFINES BDT7F.
  1599         10  BDT7A PIC  X(0001).
  1600     05  BDT7I PIC  X(0006).
  1601*    -------------------------------
  1602     05  SDT7L PIC S9(0004) COMP.
  1603     05  SDT7F PIC  X(0001).
  1604     05  FILLER REDEFINES SDT7F.
  1605         10  SDT7A PIC  X(0001).
  1606     05  SDT7I PIC  X(0006).
  1607*    -------------------------------
  1608     05  MSAAC8L PIC S9(0004) COMP.
  1609     05  MSAAC8F PIC  X(0001).
  1610     05  FILLER REDEFINES MSAAC8F.
  1611         10  MSAAC8A PIC  X(0001).
  1612     05  MSAAC8I PIC  X(0010).
  1613*    -------------------------------
  1614     05  MSAST8L PIC S9(0004) COMP.
  1615     05  MSAST8F PIC  X(0001).
  1616     05  FILLER REDEFINES MSAST8F.
  1617         10  MSAST8A PIC  X(0001).
  1618     05  MSAST8I PIC  X(0002).
  1619*    -------------------------------
  1620     05  MSACN8L PIC S9(0004) COMP.
  1621     05  MSACN8F PIC  X(0001).
  1622     05  FILLER REDEFINES MSACN8F.
  1623         10  MSACN8A PIC  X(0001).
  1624     05  MSACN8I PIC  X(0001).
  1625*    -------------------------------
  1626     05  MSACM8L PIC S9(0004) COMP.
  1627     05  MSACM8F PIC  X(0001).
  1628     05  FILLER REDEFINES MSACM8F.
  1629         10  MSACM8A PIC  X(0001).
  1630     05  MSACM8I PIC  X(0010).
  1631*    -------------------------------
  1632     05  TYPE8L PIC S9(0004) COMP.
  1633     05  TYPE8F PIC  X(0001).
  1634     05  FILLER REDEFINES TYPE8F.
  1635         10  TYPE8A PIC  X(0001).
  1636     05  TYPE8I PIC  X(0001).
  1637*    -------------------------------
  1638     05  AMT8L PIC S9(0004) COMP.
  1639     05  AMT8F PIC  X(0001).
  1640     05  FILLER REDEFINES AMT8F.
  1641         10  AMT8A PIC  X(0001).
  1642     05  AMT8I PIC  X(0011).
  1643*    -------------------------------
  1644     05  VOID8L PIC S9(0004) COMP.
  1645     05  VOID8F PIC  X(0001).
  1646     05  FILLER REDEFINES VOID8F.
  1647         10  VOID8A PIC  X(0001).
  1648     05  VOID8I PIC  X(0001).
  1649*    -------------------------------
  1650     05  MDT8L PIC S9(0004) COMP.
  1651     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  35
* EL633.cbl
  1652     05  FILLER REDEFINES MDT8F.
  1653         10  MDT8A PIC  X(0001).
  1654     05  MDT8I PIC  X(0006).
  1655*    -------------------------------
  1656     05  BDT8L PIC S9(0004) COMP.
  1657     05  BDT8F PIC  X(0001).
  1658     05  FILLER REDEFINES BDT8F.
  1659         10  BDT8A PIC  X(0001).
  1660     05  BDT8I PIC  X(0006).
  1661*    -------------------------------
  1662     05  SDT8L PIC S9(0004) COMP.
  1663     05  SDT8F PIC  X(0001).
  1664     05  FILLER REDEFINES SDT8F.
  1665         10  SDT8A PIC  X(0001).
  1666     05  SDT8I PIC  X(0006).
  1667*    -------------------------------
  1668     05  MSAAC9L PIC S9(0004) COMP.
  1669     05  MSAAC9F PIC  X(0001).
  1670     05  FILLER REDEFINES MSAAC9F.
  1671         10  MSAAC9A PIC  X(0001).
  1672     05  MSAAC9I PIC  X(0010).
  1673*    -------------------------------
  1674     05  MSAST9L PIC S9(0004) COMP.
  1675     05  MSAST9F PIC  X(0001).
  1676     05  FILLER REDEFINES MSAST9F.
  1677         10  MSAST9A PIC  X(0001).
  1678     05  MSAST9I PIC  X(0002).
  1679*    -------------------------------
  1680     05  MSACN9L PIC S9(0004) COMP.
  1681     05  MSACN9F PIC  X(0001).
  1682     05  FILLER REDEFINES MSACN9F.
  1683         10  MSACN9A PIC  X(0001).
  1684     05  MSACN9I PIC  X(0001).
  1685*    -------------------------------
  1686     05  MSACM9L PIC S9(0004) COMP.
  1687     05  MSACM9F PIC  X(0001).
  1688     05  FILLER REDEFINES MSACM9F.
  1689         10  MSACM9A PIC  X(0001).
  1690     05  MSACM9I PIC  X(0010).
  1691*    -------------------------------
  1692     05  TYPE9L PIC S9(0004) COMP.
  1693     05  TYPE9F PIC  X(0001).
  1694     05  FILLER REDEFINES TYPE9F.
  1695         10  TYPE9A PIC  X(0001).
  1696     05  TYPE9I PIC  X(0001).
  1697*    -------------------------------
  1698     05  AMT9L PIC S9(0004) COMP.
  1699     05  AMT9F PIC  X(0001).
  1700     05  FILLER REDEFINES AMT9F.
  1701         10  AMT9A PIC  X(0001).
  1702     05  AMT9I PIC  X(0011).
  1703*    -------------------------------
  1704     05  VOID9L PIC S9(0004) COMP.
  1705     05  VOID9F PIC  X(0001).
  1706     05  FILLER REDEFINES VOID9F.
  1707         10  VOID9A PIC  X(0001).
  1708     05  VOID9I PIC  X(0001).
  1709*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  36
* EL633.cbl
  1710     05  MDT9L PIC S9(0004) COMP.
  1711     05  MDT9F PIC  X(0001).
  1712     05  FILLER REDEFINES MDT9F.
  1713         10  MDT9A PIC  X(0001).
  1714     05  MDT9I PIC  X(0006).
  1715*    -------------------------------
  1716     05  BDT9L PIC S9(0004) COMP.
  1717     05  BDT9F PIC  X(0001).
  1718     05  FILLER REDEFINES BDT9F.
  1719         10  BDT9A PIC  X(0001).
  1720     05  BDT9I PIC  X(0006).
  1721*    -------------------------------
  1722     05  SDT9L PIC S9(0004) COMP.
  1723     05  SDT9F PIC  X(0001).
  1724     05  FILLER REDEFINES SDT9F.
  1725         10  SDT9A PIC  X(0001).
  1726     05  SDT9I PIC  X(0006).
  1727*    -------------------------------
  1728     05  MSAAC10L PIC S9(0004) COMP.
  1729     05  MSAAC10F PIC  X(0001).
  1730     05  FILLER REDEFINES MSAAC10F.
  1731         10  MSAAC10A PIC  X(0001).
  1732     05  MSAAC10I PIC  X(0010).
  1733*    -------------------------------
  1734     05  MSAST10L PIC S9(0004) COMP.
  1735     05  MSAST10F PIC  X(0001).
  1736     05  FILLER REDEFINES MSAST10F.
  1737         10  MSAST10A PIC  X(0001).
  1738     05  MSAST10I PIC  X(0002).
  1739*    -------------------------------
  1740     05  MSACN10L PIC S9(0004) COMP.
  1741     05  MSACN10F PIC  X(0001).
  1742     05  FILLER REDEFINES MSACN10F.
  1743         10  MSACN10A PIC  X(0001).
  1744     05  MSACN10I PIC  X(0001).
  1745*    -------------------------------
  1746     05  MSACM10L PIC S9(0004) COMP.
  1747     05  MSACM10F PIC  X(0001).
  1748     05  FILLER REDEFINES MSACM10F.
  1749         10  MSACM10A PIC  X(0001).
  1750     05  MSACM10I PIC  X(0010).
  1751*    -------------------------------
  1752     05  TYPE10L PIC S9(0004) COMP.
  1753     05  TYPE10F PIC  X(0001).
  1754     05  FILLER REDEFINES TYPE10F.
  1755         10  TYPE10A PIC  X(0001).
  1756     05  TYPE10I PIC  X(0001).
  1757*    -------------------------------
  1758     05  AMT10L PIC S9(0004) COMP.
  1759     05  AMT10F PIC  X(0001).
  1760     05  FILLER REDEFINES AMT10F.
  1761         10  AMT10A PIC  X(0001).
  1762     05  AMT10I PIC  X(0011).
  1763*    -------------------------------
  1764     05  VOID10L PIC S9(0004) COMP.
  1765     05  VOID10F PIC  X(0001).
  1766     05  FILLER REDEFINES VOID10F.
  1767         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  37
* EL633.cbl
  1768     05  VOID10I PIC  X(0001).
  1769*    -------------------------------
  1770     05  MDT10L PIC S9(0004) COMP.
  1771     05  MDT10F PIC  X(0001).
  1772     05  FILLER REDEFINES MDT10F.
  1773         10  MDT10A PIC  X(0001).
  1774     05  MDT10I PIC  X(0006).
  1775*    -------------------------------
  1776     05  BDT10L PIC S9(0004) COMP.
  1777     05  BDT10F PIC  X(0001).
  1778     05  FILLER REDEFINES BDT10F.
  1779         10  BDT10A PIC  X(0001).
  1780     05  BDT10I PIC  X(0006).
  1781*    -------------------------------
  1782     05  SDT10L PIC S9(0004) COMP.
  1783     05  SDT10F PIC  X(0001).
  1784     05  FILLER REDEFINES SDT10F.
  1785         10  SDT10A PIC  X(0001).
  1786     05  SDT10I PIC  X(0006).
  1787*    -------------------------------
  1788     05  MSAAC11L PIC S9(0004) COMP.
  1789     05  MSAAC11F PIC  X(0001).
  1790     05  FILLER REDEFINES MSAAC11F.
  1791         10  MSAAC11A PIC  X(0001).
  1792     05  MSAAC11I PIC  X(0010).
  1793*    -------------------------------
  1794     05  MSAST11L PIC S9(0004) COMP.
  1795     05  MSAST11F PIC  X(0001).
  1796     05  FILLER REDEFINES MSAST11F.
  1797         10  MSAST11A PIC  X(0001).
  1798     05  MSAST11I PIC  X(0002).
  1799*    -------------------------------
  1800     05  MSACN11L PIC S9(0004) COMP.
  1801     05  MSACN11F PIC  X(0001).
  1802     05  FILLER REDEFINES MSACN11F.
  1803         10  MSACN11A PIC  X(0001).
  1804     05  MSACN11I PIC  X(0001).
  1805*    -------------------------------
  1806     05  MSACM11L PIC S9(0004) COMP.
  1807     05  MSACM11F PIC  X(0001).
  1808     05  FILLER REDEFINES MSACM11F.
  1809         10  MSACM11A PIC  X(0001).
  1810     05  MSACM11I PIC  X(0010).
  1811*    -------------------------------
  1812     05  TYPE11L PIC S9(0004) COMP.
  1813     05  TYPE11F PIC  X(0001).
  1814     05  FILLER REDEFINES TYPE11F.
  1815         10  TYPE11A PIC  X(0001).
  1816     05  TYPE11I PIC  X(0001).
  1817*    -------------------------------
  1818     05  AMT11L PIC S9(0004) COMP.
  1819     05  AMT11F PIC  X(0001).
  1820     05  FILLER REDEFINES AMT11F.
  1821         10  AMT11A PIC  X(0001).
  1822     05  AMT11I PIC  X(0011).
  1823*    -------------------------------
  1824     05  VOID11L PIC S9(0004) COMP.
  1825     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  38
* EL633.cbl
  1826     05  FILLER REDEFINES VOID11F.
  1827         10  VOID11A PIC  X(0001).
  1828     05  VOID11I PIC  X(0001).
  1829*    -------------------------------
  1830     05  MDT11L PIC S9(0004) COMP.
  1831     05  MDT11F PIC  X(0001).
  1832     05  FILLER REDEFINES MDT11F.
  1833         10  MDT11A PIC  X(0001).
  1834     05  MDT11I PIC  X(0006).
  1835*    -------------------------------
  1836     05  BDT11L PIC S9(0004) COMP.
  1837     05  BDT11F PIC  X(0001).
  1838     05  FILLER REDEFINES BDT11F.
  1839         10  BDT11A PIC  X(0001).
  1840     05  BDT11I PIC  X(0006).
  1841*    -------------------------------
  1842     05  SDT11L PIC S9(0004) COMP.
  1843     05  SDT11F PIC  X(0001).
  1844     05  FILLER REDEFINES SDT11F.
  1845         10  SDT11A PIC  X(0001).
  1846     05  SDT11I PIC  X(0006).
  1847*    -------------------------------
  1848     05  MSAAC12L PIC S9(0004) COMP.
  1849     05  MSAAC12F PIC  X(0001).
  1850     05  FILLER REDEFINES MSAAC12F.
  1851         10  MSAAC12A PIC  X(0001).
  1852     05  MSAAC12I PIC  X(0010).
  1853*    -------------------------------
  1854     05  MSAST12L PIC S9(0004) COMP.
  1855     05  MSAST12F PIC  X(0001).
  1856     05  FILLER REDEFINES MSAST12F.
  1857         10  MSAST12A PIC  X(0001).
  1858     05  MSAST12I PIC  X(0002).
  1859*    -------------------------------
  1860     05  MSACN12L PIC S9(0004) COMP.
  1861     05  MSACN12F PIC  X(0001).
  1862     05  FILLER REDEFINES MSACN12F.
  1863         10  MSACN12A PIC  X(0001).
  1864     05  MSACN12I PIC  X(0001).
  1865*    -------------------------------
  1866     05  MSACM12L PIC S9(0004) COMP.
  1867     05  MSACM12F PIC  X(0001).
  1868     05  FILLER REDEFINES MSACM12F.
  1869         10  MSACM12A PIC  X(0001).
  1870     05  MSACM12I PIC  X(0010).
  1871*    -------------------------------
  1872     05  TYPE12L PIC S9(0004) COMP.
  1873     05  TYPE12F PIC  X(0001).
  1874     05  FILLER REDEFINES TYPE12F.
  1875         10  TYPE12A PIC  X(0001).
  1876     05  TYPE12I PIC  X(0001).
  1877*    -------------------------------
  1878     05  AMT12L PIC S9(0004) COMP.
  1879     05  AMT12F PIC  X(0001).
  1880     05  FILLER REDEFINES AMT12F.
  1881         10  AMT12A PIC  X(0001).
  1882     05  AMT12I PIC  X(0011).
  1883*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  39
* EL633.cbl
  1884     05  VOID12L PIC S9(0004) COMP.
  1885     05  VOID12F PIC  X(0001).
  1886     05  FILLER REDEFINES VOID12F.
  1887         10  VOID12A PIC  X(0001).
  1888     05  VOID12I PIC  X(0001).
  1889*    -------------------------------
  1890     05  MDT12L PIC S9(0004) COMP.
  1891     05  MDT12F PIC  X(0001).
  1892     05  FILLER REDEFINES MDT12F.
  1893         10  MDT12A PIC  X(0001).
  1894     05  MDT12I PIC  X(0006).
  1895*    -------------------------------
  1896     05  BDT12L PIC S9(0004) COMP.
  1897     05  BDT12F PIC  X(0001).
  1898     05  FILLER REDEFINES BDT12F.
  1899         10  BDT12A PIC  X(0001).
  1900     05  BDT12I PIC  X(0006).
  1901*    -------------------------------
  1902     05  SDT12L PIC S9(0004) COMP.
  1903     05  SDT12F PIC  X(0001).
  1904     05  FILLER REDEFINES SDT12F.
  1905         10  SDT12A PIC  X(0001).
  1906     05  SDT12I PIC  X(0006).
  1907*    -------------------------------
  1908     05  MSAAC13L PIC S9(0004) COMP.
  1909     05  MSAAC13F PIC  X(0001).
  1910     05  FILLER REDEFINES MSAAC13F.
  1911         10  MSAAC13A PIC  X(0001).
  1912     05  MSAAC13I PIC  X(0010).
  1913*    -------------------------------
  1914     05  MSAST13L PIC S9(0004) COMP.
  1915     05  MSAST13F PIC  X(0001).
  1916     05  FILLER REDEFINES MSAST13F.
  1917         10  MSAST13A PIC  X(0001).
  1918     05  MSAST13I PIC  X(0002).
  1919*    -------------------------------
  1920     05  MSACN13L PIC S9(0004) COMP.
  1921     05  MSACN13F PIC  X(0001).
  1922     05  FILLER REDEFINES MSACN13F.
  1923         10  MSACN13A PIC  X(0001).
  1924     05  MSACN13I PIC  X(0001).
  1925*    -------------------------------
  1926     05  MSACM13L PIC S9(0004) COMP.
  1927     05  MSACM13F PIC  X(0001).
  1928     05  FILLER REDEFINES MSACM13F.
  1929         10  MSACM13A PIC  X(0001).
  1930     05  MSACM13I PIC  X(0010).
  1931*    -------------------------------
  1932     05  TYPE13L PIC S9(0004) COMP.
  1933     05  TYPE13F PIC  X(0001).
  1934     05  FILLER REDEFINES TYPE13F.
  1935         10  TYPE13A PIC  X(0001).
  1936     05  TYPE13I PIC  X(0001).
  1937*    -------------------------------
  1938     05  AMT13L PIC S9(0004) COMP.
  1939     05  AMT13F PIC  X(0001).
  1940     05  FILLER REDEFINES AMT13F.
  1941         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  40
* EL633.cbl
  1942     05  AMT13I PIC  X(0011).
  1943*    -------------------------------
  1944     05  VOID13L PIC S9(0004) COMP.
  1945     05  VOID13F PIC  X(0001).
  1946     05  FILLER REDEFINES VOID13F.
  1947         10  VOID13A PIC  X(0001).
  1948     05  VOID13I PIC  X(0001).
  1949*    -------------------------------
  1950     05  MDT13L PIC S9(0004) COMP.
  1951     05  MDT13F PIC  X(0001).
  1952     05  FILLER REDEFINES MDT13F.
  1953         10  MDT13A PIC  X(0001).
  1954     05  MDT13I PIC  X(0006).
  1955*    -------------------------------
  1956     05  BDT13L PIC S9(0004) COMP.
  1957     05  BDT13F PIC  X(0001).
  1958     05  FILLER REDEFINES BDT13F.
  1959         10  BDT13A PIC  X(0001).
  1960     05  BDT13I PIC  X(0006).
  1961*    -------------------------------
  1962     05  SDT13L PIC S9(0004) COMP.
  1963     05  SDT13F PIC  X(0001).
  1964     05  FILLER REDEFINES SDT13F.
  1965         10  SDT13A PIC  X(0001).
  1966     05  SDT13I PIC  X(0006).
  1967*    -------------------------------
  1968     05  ERRMSG1L PIC S9(0004) COMP.
  1969     05  ERRMSG1F PIC  X(0001).
  1970     05  FILLER REDEFINES ERRMSG1F.
  1971         10  ERRMSG1A PIC  X(0001).
  1972     05  ERRMSG1I PIC  X(0079).
  1973*    -------------------------------
  1974     05  ERRMSG2L PIC S9(0004) COMP.
  1975     05  ERRMSG2F PIC  X(0001).
  1976     05  FILLER REDEFINES ERRMSG2F.
  1977         10  ERRMSG2A PIC  X(0001).
  1978     05  ERRMSG2I PIC  X(0079).
  1979*    -------------------------------
  1980     05  PFENTERL PIC S9(0004) COMP.
  1981     05  PFENTERF PIC  X(0001).
  1982     05  FILLER REDEFINES PFENTERF.
  1983         10  PFENTERA PIC  X(0001).
  1984     05  PFENTERI PIC  9(2).
  1985 01  EL633AO REDEFINES EL633AI.
  1986     05  FILLER            PIC  X(0012).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  DATEO PIC  X(0008).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  TIMEO PIC  99.99.
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  CMPNYIDO PIC  X(0003).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  USERIDO PIC  X(0004).
  1999*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  41
* EL633.cbl
  2000     05  FILLER            PIC  X(0003).
  2001     05  MAINTO PIC  X(0001).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  CARRIERO PIC  X(0001).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  GROUPO PIC  X(0006).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  FINRESPO PIC  X(0010).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  ACCTO PIC  X(0010).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  MSAAC1O PIC  X(0010).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  MSAST1O PIC  X(0002).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  MSACN1O PIC  X(0001).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  MSACM1O PIC  X(0010).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  TYPE1O PIC  X(0001).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  AMT1O PIC  X(0011).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  VOID1O PIC  X(0001).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  MDT1O PIC  X(0006).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  BDT1O PIC  X(0006).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  SDT1O PIC  X(0006).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  MSAAC2O PIC  X(0010).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  MSAST2O PIC  X(0002).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  MSACN2O PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  MSACM2O PIC  X(0010).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  42
* EL633.cbl
  2058     05  TYPE2O PIC  X(0001).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  AMT2O PIC  X(0011).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  VOID2O PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  MDT2O PIC  X(0006).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BDT2O PIC  X(0006).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  SDT2O PIC  X(0006).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  MSAAC3O PIC  X(0010).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  MSAST3O PIC  X(0002).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  MSACN3O PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  MSACM3O PIC  X(0010).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  TYPE3O PIC  X(0001).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  AMT3O PIC  X(0011).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  VOID3O PIC  X(0001).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  MDT3O PIC  X(0006).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  BDT3O PIC  X(0006).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  SDT3O PIC  X(0006).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  MSAAC4O PIC  X(0010).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  MSAST4O PIC  X(0002).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  MSACN4O PIC  X(0001).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  43
* EL633.cbl
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  TYPE4O PIC  X(0001).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  AMT4O PIC  X(0011).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  VOID4O PIC  X(0001).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  MDT4O PIC  X(0006).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  BDT4O PIC  X(0006).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  SDT4O PIC  X(0006).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  MSAAC5O PIC  X(0010).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  MSAST5O PIC  X(0002).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  MSACN5O PIC  X(0001).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  MSACM5O PIC  X(0010).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  TYPE5O PIC  X(0001).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  AMT5O PIC  X(0011).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  VOID5O PIC  X(0001).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  MDT5O PIC  X(0006).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  BDT5O PIC  X(0006).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  SDT5O PIC  X(0006).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  MSAAC6O PIC  X(0010).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  MSAST6O PIC  X(0002).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  MSACN6O PIC  X(0001).
  2173*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  44
* EL633.cbl
  2174     05  FILLER            PIC  X(0003).
  2175     05  MSACM6O PIC  X(0010).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  TYPE6O PIC  X(0001).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  AMT6O PIC  X(0011).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  VOID6O PIC  X(0001).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  MDT6O PIC  X(0006).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  BDT6O PIC  X(0006).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  SDT6O PIC  X(0006).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  MSAAC7O PIC  X(0010).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  MSAST7O PIC  X(0002).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  MSACN7O PIC  X(0001).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  MSACM7O PIC  X(0010).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  TYPE7O PIC  X(0001).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  AMT7O PIC  X(0011).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  VOID7O PIC  X(0001).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  MDT7O PIC  X(0006).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  BDT7O PIC  X(0006).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  SDT7O PIC  X(0006).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  MSAAC8O PIC  X(0010).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  MSAST8O PIC  X(0002).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  45
* EL633.cbl
  2232     05  MSACN8O PIC  X(0001).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  MSACM8O PIC  X(0010).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  TYPE8O PIC  X(0001).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  AMT8O PIC  X(0011).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  VOID8O PIC  X(0001).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  MDT8O PIC  X(0006).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  BDT8O PIC  X(0006).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  SDT8O PIC  X(0006).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  MSAAC9O PIC  X(0010).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  MSAST9O PIC  X(0002).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  MSACN9O PIC  X(0001).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  MSACM9O PIC  X(0010).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  TYPE9O PIC  X(0001).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  AMT9O PIC  X(0011).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  VOID9O PIC  X(0001).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  MDT9O PIC  X(0006).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  BDT9O PIC  X(0006).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  SDT9O PIC  X(0006).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  MSAAC10O PIC  X(0010).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  46
* EL633.cbl
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  MSACN10O PIC  X(0001).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  MSACM10O PIC  X(0010).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  TYPE10O PIC  X(0001).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  AMT10O PIC  X(0011).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  VOID10O PIC  X(0001).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  MDT10O PIC  X(0006).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  BDT10O PIC  X(0006).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  SDT10O PIC  X(0006).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  MSAAC11O PIC  X(0010).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  MSAST11O PIC  X(0002).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  MSACN11O PIC  X(0001).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  MSACM11O PIC  X(0010).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  TYPE11O PIC  X(0001).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  AMT11O PIC  X(0011).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  VOID11O PIC  X(0001).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  MDT11O PIC  X(0006).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  BDT11O PIC  X(0006).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  SDT11O PIC  X(0006).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  MSAAC12O PIC  X(0010).
  2347*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  47
* EL633.cbl
  2348     05  FILLER            PIC  X(0003).
  2349     05  MSAST12O PIC  X(0002).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  MSACN12O PIC  X(0001).
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  MSACM12O PIC  X(0010).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  TYPE12O PIC  X(0001).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  AMT12O PIC  X(0011).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  VOID12O PIC  X(0001).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  MDT12O PIC  X(0006).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  BDT12O PIC  X(0006).
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  SDT12O PIC  X(0006).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  MSAAC13O PIC  X(0010).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  MSAST13O PIC  X(0002).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  MSACN13O PIC  X(0001).
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  MSACM13O PIC  X(0010).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  TYPE13O PIC  X(0001).
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
  2391     05  AMT13O PIC  X(0011).
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  VOID13O PIC  X(0001).
  2395*    -------------------------------
  2396     05  FILLER            PIC  X(0003).
  2397     05  MDT13O PIC  X(0006).
  2398*    -------------------------------
  2399     05  FILLER            PIC  X(0003).
  2400     05  BDT13O PIC  X(0006).
  2401*    -------------------------------
  2402     05  FILLER            PIC  X(0003).
  2403     05  SDT13O PIC  X(0006).
  2404*    -------------------------------
  2405     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  48
* EL633.cbl
  2406     05  ERRMSG1O PIC  X(0079).
  2407*    -------------------------------
  2408     05  FILLER            PIC  X(0003).
  2409     05  ERRMSG2O PIC  X(0079).
  2410*    -------------------------------
  2411     05  FILLER            PIC  X(0003).
  2412     05  PFENTERO PIC  X(0002).
  2413*    -------------------------------
  2414
  2415 01  MAP-EL633A  REDEFINES  EL633AI.
  2416     12  FILLER                  PIC  X(87).
  2417     12  DATA-AREA       OCCURS 13 TIMES
  2418                             INDEXED BY PINDX.
  2419         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2420         16  GL-ACCT-ATTRB       PIC  X.
  2421         16  GL-ACCT             PIC  X(10).
  2422         16  WSL-COMM  REDEFINES GL-ACCT.
  2423             20  WSL-COMM-DTE.
  2424                 24  WSL-MO      PIC  X(2).
  2425                 24  WSL-DA      PIC  X(2).
  2426                 24  WSL-YR      PIC  X(2).
  2427             20  WSL-COMM-REST   PIC  X(4).
  2428         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2429         16  GL-STATE-ATTRB      PIC  X.
  2430         16  GL-STATE            PIC  X(02).
  2431         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2432         16  GL-CANC-ATTRB       PIC  X.
  2433         16  GL-CANC             PIC  X.
  2434         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2435         16  GL-COMM-ATTRB       PIC  X.
  2436         16  GL-COMM             PIC  X(10).
  2437         16  RTYPE-LEN           PIC S9(4)              COMP.
  2438         16  RTYPE-ATTRB         PIC  X.
  2439         16  RTYPE               PIC  X.
  2440         16  AMT-LEN             PIC S9(4)              COMP.
  2441         16  AMT-ATTRB           PIC  X.
  2442         16  AMT                 PIC S9(9)V9(2).
  2443         16  AMTO  REDEFINES
  2444             AMT                 PIC Z(7).9(2)-.
  2445         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2446         16  VOID-SW-ATTRB       PIC  X.
  2447         16  VOID-SW             PIC  X.
  2448         16  MDTE-LEN            PIC S9(4)              COMP.
  2449         16  MDTE-ATTRB          PIC  X.
  2450         16  MDTE                PIC  X(6).
  2451         16  BDTE-LEN            PIC S9(4)              COMP.
  2452         16  BDTE-ATTRB          PIC  X.
  2453         16  BDTE                PIC  X(6).
  2454         16  SDTE-LEN            PIC S9(4)              COMP.
  2455         16  SDTE-ATTRB          PIC  X.
  2456         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  49
* EL633.cbl
  2458****************************************************************
  2459*
  2460* Copyright (c) 2007 by Clerity Solutions, Inc.
  2461* All rights reserved.
  2462*
  2463****************************************************************
  2464 01  DFHEIV.
  2465   02  DFHEIV0               PIC X(35).
  2466   02  DFHEIV1               PIC X(08).
  2467   02  DFHEIV2               PIC X(08).
  2468   02  DFHEIV3               PIC X(08).
  2469   02  DFHEIV4               PIC X(06).
  2470   02  DFHEIV5               PIC X(04).
  2471   02  DFHEIV6               PIC X(04).
  2472   02  DFHEIV7               PIC X(02).
  2473   02  DFHEIV8               PIC X(02).
  2474   02  DFHEIV9               PIC X(01).
  2475   02  DFHEIV10              PIC S9(7) COMP-3.
  2476   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2477   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2478   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2479   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2480   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2481   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2482   02  DFHEIV17              PIC X(04).
  2483   02  DFHEIV18              PIC X(04).
  2484   02  DFHEIV19              PIC X(04).
  2485   02  DFHEIV20              USAGE IS POINTER.
  2486   02  DFHEIV21              USAGE IS POINTER.
  2487   02  DFHEIV22              USAGE IS POINTER.
  2488   02  DFHEIV23              USAGE IS POINTER.
  2489   02  DFHEIV24              USAGE IS POINTER.
  2490   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2491   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2492   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2493   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2494   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2495   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2496   02  FILLER                PIC X(02).
  2497   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2498   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2499   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2500   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2501   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2502 LINKAGE  SECTION.
  2503*****************************************************************
  2504*                                                               *
  2505* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2506* All rights reserved.                                          *
  2507*                                                               *
  2508*****************************************************************
  2509 01  dfheiblk.
  2510     02  eibtime          pic s9(7) comp-3.
  2511     02  eibdate          pic s9(7) comp-3.
  2512     02  eibtrnid         pic x(4).
  2513     02  eibtaskn         pic s9(7) comp-3.
  2514     02  eibtrmid         pic x(4).
  2515     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  50
* EL633.cbl
  2516     02  eibcposn         pic s9(4) comp.
  2517     02  eibcalen         pic s9(4) comp.
  2518     02  eibaid           pic x(1).
  2519     02  eibfiller1       pic x(1).
  2520     02  eibfn            pic x(2).
  2521     02  eibfiller2       pic x(2).
  2522     02  eibrcode         pic x(6).
  2523     02  eibfiller3       pic x(2).
  2524     02  eibds            pic x(8).
  2525     02  eibreqid         pic x(8).
  2526     02  eibrsrce         pic x(8).
  2527     02  eibsync          pic x(1).
  2528     02  eibfree          pic x(1).
  2529     02  eibrecv          pic x(1).
  2530     02  eibsend          pic x(1).
  2531     02  eibatt           pic x(1).
  2532     02  eibeoc           pic x(1).
  2533     02  eibfmh           pic x(1).
  2534     02  eibcompl         pic x(1).
  2535     02  eibsig           pic x(1).
  2536     02  eibconf          pic x(1).
  2537     02  eiberr           pic x(1).
  2538     02  eibrldbk         pic x(1).
  2539     02  eiberrcd         pic x(4).
  2540     02  eibsynrb         pic x(1).
  2541     02  eibnodat         pic x(1).
  2542     02  eibfiller5       pic x(2).
  2543     02  eibresp          pic 9(09) comp.
  2544     02  eibresp2         pic 9(09) comp.
  2545     02  dfheigdj         pic s9(4) comp.
  2546     02  dfheigdk         pic s9(4) comp.
  2547 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  51
* EL633.cbl
  2548/
  2549*                            COPY ERCCHKQ.
  2550******************************************************************
  2551*                                                                *
  2552*                                                                *
  2553*                            ERCCHKQ                             *
  2554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2555*                            VMOD=2.005                          *
  2556*                                                                *
  2557*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2558*                                                                *
  2559*   FILE TYPE = VSAM,KSDS                                        *
  2560*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2561*                                                                *
  2562*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2563*       ALTERNATE PATH  = NONE                                   *
  2564*                                                                *
  2565*   LOG = YES                                                    *
  2566*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2567******************************************************************
  2568 01  CHECK-QUE.
  2569     12  CQ-RECORD-ID                PIC XX.
  2570         88  VALID-CQ-ID                     VALUE 'CQ'.
  2571
  2572     12  CQ-CONTROL-PRIMARY.
  2573         16  CQ-COMPANY-CD           PIC X.
  2574         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2575         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2576
  2577     12  CQ-ENTRY-TYPE               PIC X.
  2578             88  CHECK-ON-QUE           VALUE 'Q'.
  2579             88  ALIGNMENT-CHECK        VALUE 'A'.
  2580             88  MANUAL-CHECK           VALUE 'M'.
  2581             88  SPOILED-CHECK          VALUE 'S'.
  2582             88  VOIDED-CHECK           VALUE 'V'.
  2583             88  PAYMENT-ABORTED        VALUE 'X'.
  2584
  2585     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2586
  2587     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2588         CQ-CREDIT-MASTER-CNTL.
  2589         16  CQ-PYAJ-CARRIER         PIC X.
  2590         16  CQ-PYAJ-GROUPING        PIC X(6).
  2591         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2592         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2593         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2594         16  CQ-PYAJ-REC-TYPE        PIC X.
  2595         16  FILLER                  PIC X(18).
  2596
  2597     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2598         CQ-CREDIT-MASTER-CNTL.
  2599         16  CQ-CHEK-CARRIER         PIC X.
  2600         16  CQ-CHEK-GROUPING        PIC X(6).
  2601         16  CQ-CHEK-STATE           PIC XX.
  2602         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2603         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2604         16  CQ-CHEK-CERT-NO.
  2605             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  52
* EL633.cbl
  2606             20  CQ-CHEK-CERT-SFX    PIC X.
  2607         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2608         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2609         16  FILLER                  PIC X(06).
  2610
  2611     12  CQ-CHECK-NUMBER             PIC X(7).
  2612     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2613     12  CQ-PAYMENT-TYPE             PIC X.
  2614             88  CQ-BILLING-CREDIT         VALUE '1'.
  2615             88  CQ-REFUND-PMT             VALUE '2'.
  2616             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2617     12  CQ-VOID-INDICATOR           PIC X.
  2618             88  CHECK-IS-VOID             VALUE 'V'.
  2619     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2620     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2621     12  CQ-CHECK-BY-USER            PIC X(4).
  2622     12  CQ-PRE-NUMBERING-SW         PIC X.
  2623       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2624       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2625
  2626     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2627     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2628     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2629     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2630
  2631     12  CQ-LETTERS-IND              PIC X.
  2632         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2633
  2634******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  53
* EL633.cbl
  2635/
  2636*                            COPY ERCPYAJ.
  2637******************************************************************
  2638*                                                                *
  2639*                            ERCPYAJ                             *
  2640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2641*                            VMOD=2.015                          *
  2642*                                                                *
  2643*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2644*                                                                *
  2645*                                                                *
  2646*   FILE TYPE = VSAM,KSDS                                        *
  2647*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2648*                                                                *
  2649*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2650*       ALTERNATE PATHS = NONE                                   *
  2651*                                                                *
  2652*   LOG = YES                                                    *
  2653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2654******************************************************************
  2655******************************************************************
  2656*                   C H A N G E   L O G
  2657*
  2658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2659*-----------------------------------------------------------------
  2660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2661* EFFECTIVE    NUMBER
  2662*-----------------------------------------------------------------
  2663* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2664* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2665******************************************************************
  2666
  2667 01  PENDING-PAY-ADJ.
  2668     12  PY-RECORD-ID                     PIC XX.
  2669         88  VALID-PY-ID                        VALUE 'PY'.
  2670
  2671     12  PY-CONTROL-PRIMARY.
  2672         16  PY-COMPANY-CD                PIC X.
  2673         16  PY-CARRIER                   PIC X.
  2674         16  PY-GROUPING                  PIC X(6).
  2675         16  PY-FIN-RESP                  PIC X(10).
  2676         16  PY-ACCOUNT                   PIC X(10).
  2677         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2678                                          PIC X(10).
  2679         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2680         16  PY-RECORD-TYPE               PIC X.
  2681             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2682             88  PY-DEPOSIT                   VALUE 'D'.
  2683             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2684             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2685             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2686             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2687             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2688             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2689             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2690             88  PY-FICA-ENTRY                VALUE 'F'.
  2691             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2692             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  54
* EL633.cbl
  2693             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2694
  2695     12  PY-PYMT-TYPE                     PIC X.
  2696             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2697             88  PY-REINS-PYMT                VALUE 'R'.
  2698             88  PY-EXP-PYMT                  VALUE 'E'.
  2699
  2700     12  PY-BIL-INV                       PIC X(6).
  2701     12  PY-REF-NO                        PIC X(12).
  2702
  2703     12  PY-LAST-MAINT-DT                 PIC XX.
  2704     12  PY-LAST-MAINT-BY                 PIC X(4).
  2705     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2706
  2707     12  PY-PYADJ-RECORD.
  2708         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2709         16  PY-ENTRY-COMMENT             PIC X(30).
  2710         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2711             20  PY-GL-ACCOUNT            PIC X(10).
  2712             20  PY-GL-STATE              PIC X(02).
  2713             20  PY-GL-CANC-SW            PIC X(01).
  2714                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2715                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2716             20  PY-GL-COMMENT            PIC X(10).
  2717             20  FILLER      REDEFINES PY-GL-COMMENT.
  2718                 24  PY-GL-CHECK-NO       PIC 9(06).
  2719                 24  FILLER               PIC X(04).
  2720             20  FILLER                   PIC X(07).
  2721         16  PY-SAVE-ACCOUNT              PIC X(10).
  2722         16  PY-SAVE-TYPE                 PIC X(01).
  2723
  2724         16  PY-LETTERS.
  2725             20  PY-LETTER OCCURS 3 TIMES
  2726                           INDEXED BY PY-LET-NDX
  2727                                          PIC X(04).
  2728
  2729         16  PY-ERCOMP-TYPE               PIC X.
  2730             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2731             88  PY-GA-TYPE                   VALUE 'G'.
  2732             88  PY-BANK-TYPE                 VALUE 'B'.
  2733         16  FILLER                       PIC X(05).
  2734
  2735     12  PY-RECORD-STATUS.
  2736         16  PY-CREDIT-SELECT-DT          PIC XX.
  2737         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2738         16  PY-BILLED-DATE               PIC XX.
  2739         16  PY-REPORTED-DT               PIC XX.
  2740         16  PY-PMT-APPLIED               PIC X.
  2741             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2742             88  PY-GA-PMT                    VALUE 'G'.
  2743             88  PY-OVWRITE-PMT               VALUE 'O'.
  2744             88  PY-NON-AR-PMT                VALUE 'N'.
  2745         16  FILLER                       PIC X(5).
  2746         16  PY-INPUT-DT                  PIC XX.
  2747         16  PY-CHECK-NUMBER              PIC X(6).
  2748         16  PY-VOID-SW                   PIC X.
  2749             88  PY-CHECK-VOIDED              VALUE 'V'.
  2750         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  55
* EL633.cbl
  2751             88  PY-BILLING-CHECK             VALUE 'B'.
  2752             88  PY-REFUND-CHECK              VALUE 'R'.
  2753             88  PY-GA-CHECK                  VALUE 'G'.
  2754             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2755             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2756         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2757         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2758         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2759         16  PY-BILL-FLAG                 PIC X.
  2760             88  PY-BILLED                    VALUE 'B'.
  2761         16  PY-AR-FLAG                   PIC X.
  2762             88  PY-AR-CYCLE                  VALUE 'C'.
  2763             88  PY-AR-MONTH-END              VALUE 'M'.
  2764         16  PY-AR-DATE                   PIC XX.
  2765
  2766     12  PY-GL-CODES.
  2767         16  PY-GL-DB                     PIC X(14).
  2768         16  PY-GL-CR                     PIC X(14).
  2769         16  PY-GL-FLAG                   PIC X.
  2770         16  PY-GL-DATE                   PIC XX.
  2771
  2772     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2773     12  FILLER                           PIC X(3).
  2774******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  56
* EL633.cbl
  2775/
  2776*                            COPY ERCCOMP.
  2777******************************************************************
  2778*                                                                *
  2779*                                                                *
  2780*                            ERCCOMP                             *
  2781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2782*                            VMOD=2.019                          *
  2783*                                                                *
  2784*   ONLINE CREDIT SYSTEM                                         *
  2785*                                                                *
  2786*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2787*                                                                *
  2788*   FILE TYPE = VSAM,KSDS                                        *
  2789*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2790*                                                                *
  2791*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2792*       ALTERNATE PATH = NONE                                    *
  2793*                                                                *
  2794*   LOG = NO                                                     *
  2795*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2796*                                                                *
  2797******************************************************************
  2798*                   C H A N G E   L O G
  2799*
  2800* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2801*-----------------------------------------------------------------
  2802*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2803* EFFECTIVE    NUMBER
  2804*-----------------------------------------------------------------
  2805* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2806* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2807* 092205    2005050300006  PEMA  ADD LEASE FEE
  2808* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2809* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2810* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2811* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2812* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2813* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2814******************************************************************
  2815
  2816 01  COMPENSATION-MASTER.
  2817     12  CO-RECORD-ID                          PIC XX.
  2818         88  VALID-CO-ID                          VALUE 'CO'.
  2819
  2820     12  CO-CONTROL-PRIMARY.
  2821         16  CO-COMPANY-CD                     PIC X.
  2822         16  CO-CONTROL.
  2823             20  CO-CTL-1.
  2824                 24  CO-CARR-GROUP.
  2825                     28  CO-CARRIER            PIC X.
  2826                     28  CO-GROUPING.
  2827                         32  CO-GROUP-PREFIX   PIC XXX.
  2828                         32  CO-GROUP-PRIME    PIC XXX.
  2829                 24  CO-RESP-NO.
  2830                     28  CO-RESP-PREFIX        PIC X(4).
  2831                     28  CO-RESP-PRIME         PIC X(6).
  2832             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  57
* EL633.cbl
  2833                 24  CO-ACCOUNT.
  2834                     28  CO-ACCT-PREFIX        PIC X(4).
  2835                     28  CO-ACCT-PRIME         PIC X(6).
  2836         16  CO-TYPE                           PIC X.
  2837             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2838             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2839             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2840
  2841     12  CO-MAINT-INFORMATION.
  2842         16  CO-LAST-MAINT-DT                  PIC XX.
  2843         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2844         16  CO-LAST-MAINT-USER                PIC X(4).
  2845     12  FILLER                                PIC XX.
  2846     12  CO-STMT-TYPE                          PIC XXX.
  2847     12  CO-COMP-TYPE                          PIC X.
  2848         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2849     12  CO-STMT-OWNER                         PIC X(4).
  2850     12  CO-BALANCE-CONTROL                    PIC X.
  2851         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2852         88  CO-NO-BALANCE                        VALUE 'N'.
  2853
  2854     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2855         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2856         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2857         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2858
  2859     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2860         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2861         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2862
  2863     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2864     12  CO-GA-DIRECT-DEP                      PIC X.
  2865     12  CO-FUTURE-SPACE                       PIC X.
  2866         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2867
  2868     12  CO-ACCT-NAME                          PIC X(30).
  2869     12  CO-MAIL-NAME                          PIC X(30).
  2870     12  CO-ADDR-1                             PIC X(30).
  2871     12  CO-ADDR-2                             PIC X(30).
  2872     12  CO-ADDR-3.
  2873         16  CO-ADDR-CITY                      PIC X(27).
  2874         16  CO-ADDR-STATE                     PIC XX.
  2875     12  CO-CSO-1099                           PIC X.
  2876     12  CO-ZIP.
  2877         16  CO-ZIP-PRIME.
  2878             20  CO-ZIP-PRI-1ST                PIC X.
  2879                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2880             20  FILLER                        PIC X(4).
  2881         16  CO-ZIP-PLUS4                      PIC X(4).
  2882     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2883         16  CO-CAN-POSTAL-1                   PIC XXX.
  2884         16  CO-CAN-POSTAL-2                   PIC XXX.
  2885         16  FILLER                            PIC XXX.
  2886     12  CO-SOC-SEC                            PIC X(13).
  2887     12  CO-TELEPHONE.
  2888         16  CO-AREA-CODE                      PIC XXX.
  2889         16  CO-PREFIX                         PIC XXX.
  2890         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  58
* EL633.cbl
  2891
  2892     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2893
  2894     12  CO-AR-BAL-LEVEL                       PIC X.
  2895         88  CO-AR-REF-LVL                        VALUE '1'.
  2896         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2897         88  CO-AR-BILL-LVL                       VALUE '2'.
  2898         88  CO-AR-AGT-LVL                        VALUE '3'.
  2899         88  CO-AR-FR-LVL                         VALUE '4'.
  2900
  2901     12  CO-AR-NORMAL-PRINT                    PIC X.
  2902         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2903         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2904
  2905     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2906
  2907     12  CO-AR-REPORTING                       PIC X.
  2908         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2909         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2910
  2911     12  CO-AR-PULL-CHECK                      PIC X.
  2912         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2913         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2914
  2915     12  CO-AR-BALANCE-PRINT                   PIC X.
  2916         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2917
  2918     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2919         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2920         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2921         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2922
  2923     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2924
  2925     12  CO-USER-CODE                          PIC X.
  2926     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2927
  2928******************************************************************
  2929*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2930*    THE LAST MONTH END RUN.
  2931******************************************************************
  2932
  2933     12  CO-LAST-ACTIVITY-DATE.
  2934         16  CO-ACT-YEAR                       PIC 99.
  2935         16  CO-ACT-MONTH                      PIC 99.
  2936         16  CO-ACT-DAY                        PIC 99.
  2937
  2938     12  CO-LAST-STMT-DT.
  2939         16  CO-LAST-STMT-YEAR                 PIC 99.
  2940         16  CO-LAST-STMT-MONTH                PIC 99.
  2941         16  CO-LAST-STMT-DAY                  PIC 99.
  2942
  2943     12  CO-MO-END-TOTALS.
  2944         16  CO-MONTHLY-TOTALS.
  2945             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2946             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2947             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2948             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  59
* EL633.cbl
  2949             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2950
  2951         16  CO-AGING-TOTALS.
  2952             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2953             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2954             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2955             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2956
  2957         16  CO-YTD-TOTALS.
  2958             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2959             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2960
  2961         16  CO-OVER-UNDER-TOTALS.
  2962             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2963             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2964
  2965     12  CO-MISCELLANEOUS-TOTALS.
  2966         16  CO-FICA-TOTALS.
  2967             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2968             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2969
  2970         16  CO-CLAIM-TOTALS.
  2971             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2972             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2973
  2974******************************************************************
  2975*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2976*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2977******************************************************************
  2978
  2979     12  CO-CURRENT-TOTALS.
  2980         16  CO-CURRENT-LAST-STMT-DT.
  2981             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2982             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2983             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2984
  2985         16  CO-CURRENT-MONTHLY-TOTALS.
  2986             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2987             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2988             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2989             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2990             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2991
  2992         16  CO-CURRENT-AGING-TOTALS.
  2993             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2994             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2995             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2996             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2997
  2998         16  CO-CURRENT-YTD-TOTALS.
  2999             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3000             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3001
  3002     12  CO-PAID-COMM-TOTALS.
  3003         16  CO-YTD-PAID-COMMS.
  3004             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3005             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3006
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  60
* EL633.cbl
  3007     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3008         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3009         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3010
  3011     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3012         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3013         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3014         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3015         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3016         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3017         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3018         88  CO-FINAL-LETTER                  VALUE 'F'.
  3019         88  CO-RECONCILING                   VALUE 'R'.
  3020         88  CO-PHONE-CALL                    VALUE 'P'.
  3021         88  CO-LEGAL                         VALUE 'L'.
  3022         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3023         88  CO-WRITE-OFF                     VALUE 'W'.
  3024         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3025
  3026     12  CO-CSR-CODE                       PIC X(4).
  3027
  3028     12  CO-GA-STATUS-INFO.
  3029         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3030         16  CO-GA-TERMINATION-DT          PIC XX.
  3031         16  CO-GA-STATUS-CODE             PIC X.
  3032             88  CO-GA-ACTIVE                 VALUE 'A'.
  3033             88  CO-GA-INACTIVE               VALUE 'I'.
  3034             88  CO-GA-PENDING                VALUE 'P'.
  3035         16  CO-GA-COMMENTS.
  3036             20  CO-GA-COMMENT-1           PIC X(40).
  3037             20  CO-GA-COMMENT-2           PIC X(40).
  3038             20  CO-GA-COMMENT-3           PIC X(40).
  3039             20  CO-GA-COMMENT-4           PIC X(40).
  3040
  3041     12  CO-RPTCD2                         PIC X(10).
  3042     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3043         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3044         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3045
  3046     12  CO-TYPE-AGENT                     PIC X(01).
  3047         88  CO-CORPORATION                   VALUE 'C'.
  3048         88  CO-PARTNERSHIP                   VALUE 'P'.
  3049         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3050         88  CO-TRUST                         VALUE 'T'.
  3051         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3052
  3053     12  CO-FAXNO.
  3054         16  CO-FAX-AREA-CODE                  PIC XXX.
  3055         16  CO-FAX-PREFIX                     PIC XXX.
  3056         16  CO-FAX-PHONE                      PIC X(4).
  3057
  3058     12  CO-BANK-INFORMATION.
  3059         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3060         16  CO-BANK-TRANSIT-NON REDEFINES
  3061             CO-BANK-TRANSIT-NO                PIC 9(8).
  3062
  3063         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3064     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  61
* EL633.cbl
  3065                  CO-BANK-INFORMATION.
  3066         16  CO-MD-GL-ACCT                     PIC X(10).
  3067         16  CO-MD-DIV                         PIC XX.
  3068         16  CO-MD-CENTER                      PIC X(4).
  3069         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3070         16  CO-CREATE-AP-CHECK                PIC X.
  3071         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3072         16  FILLER                            PIC XXX.
  3073     12  CO-ACH-STATUS                         PIC X.
  3074         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3075         88  CO-ACH-PENDING                        VALUE 'P'.
  3076
  3077     12  CO-BILL-SW                            PIC X.
  3078     12  CO-CONTROL-NAME                       PIC X(30).
  3079     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3080     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3081     12  CO-CLP-STATE                          PIC XX.
  3082     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3083     12  CO-SPP-REFUND-EDIT                    PIC X.
  3084
  3085******************************************************************
  3086*
  3087*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  62
* EL633.cbl
  3088/
  3089 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3090                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3091 0000-DFHEXIT SECTION.
  3092     MOVE '9#                    $   ' TO DFHEIV0.
  3093     MOVE 'EL633' TO DFHEIV1.
  3094     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3095
  3096     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3097     MOVE EIBTRMID               TO  QID-TERM.
  3098     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3099
  3100     IF EIBCALEN = ZERO
  3101         GO TO 8800-UNAUTHORIZED-ACCESS.
  3102
  3103     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3104         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3105
  3106     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3107     MOVE '5'                    TO  DC-OPTION-CODE.
  3108
  3109     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3110
  3111     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3112     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3113
  3114     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3115         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3116             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3117             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3118             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3119             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3120             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3121             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3122             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3123             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3124         ELSE
  3125             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3126             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3127             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3128             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3129             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3130             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3131             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3132             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3133
  3134     MOVE LOW-VALUES             TO  EL633AI.
  3135
  3136     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3137     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3138     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3139     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3140
  3141     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3142                                     TOTAL-ACCT-NET.
  3143
  3144     IF RETURNED-FROM = XCTL-6331 OR
  3145                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  63
* EL633.cbl
  3146                        XCTL-642  OR
  3147                        XCTL-652
  3148         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3149
  3150     IF EIBTRNID NOT = TRANS-ID
  3151         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3152         MOVE 'Y'                TO  PI-PAGE-SW
  3153         MOVE ZEROS              TO  PI-SEQ-NOS
  3154         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3155                                     PI-SAV-ACCT-NET
  3156                                     PI-SAV-PREV-AMT
  3157                                     PI-SAV-PREV-NET
  3158         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3159             EIBTRNID NOT = EL642-TRANS-ID  AND
  3160             EIBTRNID NOT = EL652-TRANS-ID) OR
  3161             PI-CR-FIN-RESP = SPACES
  3162             GO TO 8100-SEND-INITIAL-MAP
  3163         ELSE
  3164             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3165                            EL640-TRANS-ID   OR
  3166                            EL642-TRANS-ID)  AND
  3167                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3168                GO TO 8100-SEND-INITIAL-MAP
  3169             ELSE
  3170                 MOVE DFHENTER   TO  EIBAID
  3171                 MOVE 'S'        TO  MAINTI
  3172                 MOVE PI-CR-CARRIER
  3173                                 TO  CARRIERI
  3174                 MOVE PI-CR-GROUPING
  3175                                 TO  GROUPI
  3176                 MOVE PI-CR-FIN-RESP
  3177                                 TO  FINRESPI
  3178                 MOVE PI-CR-ACCOUNT
  3179                                 TO  ACCTI
  3180                 MOVE 1          TO  CARRIERL  MAINTA
  3181                 MOVE 3          TO  GROUPL
  3182                 MOVE 6          TO  FINRESPL  ACCTL
  3183                 GO TO 0400-VALIDATE-KEY-DATA.
  3184
  3185
  3186* EXEC CICS HANDLE CONDITION
  3187*        PGMIDERR  (9600-PGMID-ERROR)
  3188*        ERROR     (9990-ABEND)
  3189*    END-EXEC.
  3190*    MOVE '"$L.                  ! " #00003181' TO DFHEIV0
  3191     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3193     MOVE X'2220233030303033313831' TO DFHEIV0(25:11)
  3194     CALL 'kxdfhei1' USING DFHEIV0
  3195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3196
  3197
  3198     IF EIBAID = DFHCLEAR
  3199         GO TO 9400-CLEAR.
  3200
  3201     IF PI-PROCESSOR-ID = 'LGXX'
  3202         GO TO 0200-RECEIVE.
  3203
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  64
* EL633.cbl
  3204
  3205* EXEC CICS READQ TS
  3206*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3207*        INTO   (SECURITY-CONTROL)
  3208*        LENGTH (SC-COMM-LENGTH)
  3209*        ITEM   (SC-ITEM)
  3210*    END-EXEC.
  3211*    MOVE '*$II   L              ''   #00003192' TO DFHEIV0
  3212     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3213     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3214     MOVE X'2020233030303033313932' TO DFHEIV0(25:11)
  3215     CALL 'kxdfhei1' USING DFHEIV0,
  3216           PI-SECURITY-TEMP-STORE-ID,
  3217           SECURITY-CONTROL,
  3218           SC-COMM-LENGTH,
  3219           SC-ITEM,
  3220           DFHEIV99,
  3221           DFHEIV99
  3222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3223
  3224
  3225     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3226     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3227
  3228     IF NOT DISPLAY-CAP
  3229         MOVE 'READ'          TO SM-READ
  3230         PERFORM 9995-SECURITY-VIOLATION
  3231         MOVE ER-0070         TO  EMI-ERROR
  3232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3233         GO TO 8100-SEND-INITIAL-MAP.
  3234
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  65
* EL633.cbl
  3236 0200-RECEIVE.
  3237
  3238     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3239         MOVE ER-0008            TO  EMI-ERROR
  3240         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3241         MOVE -1                 TO  MAINTL
  3242         GO TO 8200-SEND-DATAONLY.
  3243
  3244
  3245* EXEC CICS RECEIVE
  3246*        MAP     (MAP-NAME)
  3247*        MAPSET  (MAPSET-NAME)
  3248*        INTO    (EL633AI)
  3249*    END-EXEC.
  3250     MOVE LENGTH OF
  3251      EL633AI
  3252       TO DFHEIV11
  3253*    MOVE '8"T I  L              ''   #00003218' TO DFHEIV0
  3254     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3256     MOVE X'2020233030303033323138' TO DFHEIV0(25:11)
  3257     CALL 'kxdfhei1' USING DFHEIV0,
  3258           MAP-NAME,
  3259           EL633AI,
  3260           DFHEIV11,
  3261           MAPSET-NAME,
  3262           DFHEIV99,
  3263           DFHEIV99
  3264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3265
  3266
  3267     IF MAINTI = 'S' AND
  3268        EIBAID = DFHENTER
  3269         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3270                                     PI-SAV-ACCT-NET
  3271                                     PI-SAV-PREV-AMT
  3272                                     PI-SAV-PREV-NET
  3273                                     PI-FRST-FILE-SEQ-NO
  3274         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3275
  3276     IF PFENTERL = ZERO
  3277         GO TO 0300-CHECK-PFKEYS.
  3278
  3279     IF (PFENTERI  IS NUMERIC)
  3280       AND (PFENTERI GREATER 0 AND LESS 25)
  3281         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3282     ELSE
  3283         MOVE ER-0029               TO  EMI-ERROR
  3284         GO TO 0320-INPUT-ERROR.
  3285
  3286 0300-CHECK-PFKEYS.
  3287     IF EIBAID = DFHPF23
  3288         GO TO 8810-PF23.
  3289
  3290     IF EIBAID = DFHPF24
  3291         GO TO 9200-RETURN-MAIN-MENU.
  3292
  3293     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  66
* EL633.cbl
  3294         GO TO 9500-PF12.
  3295
  3296     IF EIBAID = DFHPF3
  3297         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3298             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3299             MOVE XCTL-652       TO  PGM-NAME
  3300             IF ERCOMP-KEY  NOT =      SPACES
  3301                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3302                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3303                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3304                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3305             END-IF
  3306
  3307             IF PI-CR-ACCOUNT = LOW-VALUES
  3308                 MOVE 'G'        TO  PI-CR-TYPE
  3309                 GO TO 9300-XCTL
  3310             ELSE
  3311                 MOVE 'A'        TO  PI-CR-TYPE
  3312                 GO TO 9300-XCTL
  3313         ELSE
  3314            MOVE ER-3020         TO  EMI-ERROR
  3315            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3316            GO TO 8100-SEND-INITIAL-MAP.
  3317
  3318     IF EIBAID = DFHPF4
  3319         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3320         MOVE XCTL-6331          TO  PGM-NAME
  3321         GO TO 9300-XCTL.
  3322
  3323     IF EIBAID = DFHPF5
  3324         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3325         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3326         MOVE XCTL-640           TO  PGM-NAME
  3327         IF PI-CR-ACCOUNT = LOW-VALUES
  3328             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3329             IF ACCTI = LOW-VALUES
  3330                MOVE 'G'         TO  PI-CR-TYPE
  3331             END-IF
  3332             GO TO 9300-XCTL
  3333         ELSE
  3334             MOVE 'A'        TO  PI-CR-TYPE
  3335             GO TO 9300-XCTL.
  3336
  3337     IF EIBAID = DFHPF6
  3338        IF PI-GA-BILLING
  3339            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3340            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3341            MOVE XCTL-642        TO  PGM-NAME
  3342            IF PI-CR-ACCOUNT = LOW-VALUES
  3343                 MOVE 'G'        TO  PI-CR-TYPE
  3344                 GO TO 9300-XCTL
  3345             ELSE
  3346                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3347                 GO TO 9300-XCTL
  3348        ELSE
  3349            MOVE ER-2929         TO  EMI-ERROR
  3350            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3351            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  67
* EL633.cbl
  3352            IF PFENTERL = ZERO
  3353                MOVE -1          TO  MAINTL
  3354                GO TO 8200-SEND-DATAONLY
  3355            ELSE
  3356                MOVE -1          TO  PFENTERL
  3357                GO TO 8200-SEND-DATAONLY.
  3358
  3359     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3360         GO TO 0400-VALIDATE-KEY-DATA.
  3361
  3362 0320-INPUT-ERROR.
  3363     MOVE ER-0029                TO  EMI-ERROR.
  3364
  3365     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3366
  3367     MOVE AL-UNBON               TO  PFENTERA.
  3368
  3369     IF PFENTERL = ZERO
  3370         MOVE -1                 TO  MAINTL
  3371     ELSE
  3372         MOVE -1                 TO  PFENTERL.
  3373
  3374     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  68
* EL633.cbl
  3376 0400-VALIDATE-KEY-DATA.
  3377     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3378         NEXT SENTENCE
  3379       ELSE
  3380        IF MAINTI NOT = 'S'
  3381         MOVE 'UPDATE'       TO SM-READ
  3382         PERFORM 9995-SECURITY-VIOLATION
  3383         MOVE ER-0070        TO EMI-ERROR
  3384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3385         GO TO 8100-SEND-INITIAL-MAP.
  3386
  3387     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3388
  3389     IF EIBAID = DFHPF1
  3390         GO TO 4000-BROWSE-FRWD.
  3391
  3392     IF EIBAID   = DFHPF1   AND
  3393        CARRIERL = ZEROS    AND
  3394        GROUPL   = ZEROS    AND
  3395        FINRESPL = ZEROS    AND
  3396        ACCTL    = ZEROS
  3397         GO TO 4000-BROWSE-FRWD.
  3398
  3399     IF PI-PROCESSOR-ID = 'LGXX'
  3400         IF MAINTI = 'C'
  3401             MOVE AL-UANON       TO MAINTA
  3402             MOVE MAINTI         TO PI-SAV-FUNCTION
  3403             GO TO CSO-BRANCH
  3404         END-IF
  3405     END-IF.
  3406
  3407     IF MAINTI = 'C' OR  'S'
  3408         MOVE AL-UANON           TO  MAINTA
  3409         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3410     ELSE
  3411         MOVE -1                 TO  MAINTL
  3412         MOVE ER-0023            TO  EMI-ERROR
  3413         MOVE AL-UABON           TO  MAINTA
  3414         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3415
  3416 CSO-BRANCH.
  3417
  3418     IF MAINTI = 'C'
  3419       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3420         MOVE -1                 TO  MAINTL
  3421         MOVE ER-2056            TO  EMI-ERROR
  3422         MOVE AL-UABON           TO  MAINTA
  3423         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3424
  3425     IF CARRIERL = ZEROS  AND
  3426        GROUPL   = ZEROS  AND
  3427        FINRESPL = ZEROS  AND
  3428        ACCTL    = ZEROS
  3429         MOVE -1                 TO  CARRIERL
  3430         MOVE ER-2231            TO  EMI-ERROR
  3431         MOVE AL-UABON           TO  CARRIERA
  3432                                     GROUPA
  3433                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  69
* EL633.cbl
  3434                                     ACCTA
  3435         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3436         GO TO 8200-SEND-DATAONLY.
  3437
  3438     IF CARRIERL NOT = ZEROS
  3439         MOVE AL-UANON           TO  CARRIERA
  3440         MOVE CARRIERI           TO  COMP-CARRIER
  3441                                     PI-SAV-CARRIER
  3442                                     PI-CR-CARRIER
  3443         IF CARRIERI NOT = ZEROS
  3444           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3445             MOVE ER-2587        TO  EMI-ERROR
  3446             MOVE -1             TO  CARRIERL
  3447             MOVE AL-UABON       TO  CARRIERA
  3448             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3449         ELSE
  3450             NEXT SENTENCE
  3451     ELSE
  3452         MOVE LOW-VALUES          TO  COMP-CARRIER
  3453                                      PI-SAV-CARRIER.
  3454
  3455     IF CARRIERL NOT = ZEROS
  3456         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3457             IF PI-CARRIER-SECURITY = CARRIERI
  3458                 NEXT SENTENCE
  3459             ELSE
  3460                 MOVE -1         TO  CARRIERL
  3461                 MOVE ER-2370    TO  EMI-ERROR
  3462                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3463
  3464     IF GROUPL NOT = ZEROS
  3465         MOVE AL-UANON           TO  GROUPA
  3466         MOVE GROUPI             TO  COMP-GROUPING
  3467                                     PI-SAV-GROUPING
  3468                                     PI-CR-GROUPING
  3469         IF GROUPI NOT = ZEROS
  3470           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3471             MOVE ER-2588        TO  EMI-ERROR
  3472             MOVE -1             TO  GROUPL
  3473             MOVE AL-UABON       TO  GROUPA
  3474             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3475         ELSE
  3476             NEXT SENTENCE
  3477     ELSE
  3478         MOVE LOW-VALUES         TO  COMP-GROUPING
  3479                                     PI-SAV-GROUPING.
  3480
  3481     IF FINRESPL NOT = ZEROS
  3482         MOVE AL-UANON           TO  FINRESPA
  3483         MOVE FINRESPI           TO  COMP-FIN-RESP
  3484                                     PI-SAV-FIN-RESP
  3485                                     PI-CR-FIN-RESP
  3486     ELSE
  3487         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3488                                     PI-SAV-FIN-RESP.
  3489
  3490     IF ACCTL NOT = ZEROS
  3491         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  70
* EL633.cbl
  3492         MOVE ACCTI              TO  COMP-ACCOUNT
  3493                                     PI-SAV-ACCOUNT
  3494                                     PI-CR-ACCOUNT
  3495     ELSE
  3496         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3497                                     PI-SAV-ACCOUNT
  3498                                     PI-CR-ACCOUNT.
  3499
  3500     IF EMI-ERROR = ZEROS
  3501         NEXT SENTENCE
  3502     ELSE
  3503         IF EIBTRNID = EL640-TRANS-ID OR
  3504            EIBTRNID = EL642-TRANS-ID OR
  3505            EIBTRNID = EL6331-TRANS-ID
  3506             GO TO 8100-SEND-INITIAL-MAP
  3507         ELSE
  3508             GO TO 8200-SEND-DATAONLY.
  3509
  3510     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3511
  3512     IF MAINTI = 'S'
  3513         IF EIBAID = DFHPF1              OR  DFHENTER
  3514             GO TO 4000-BROWSE-FRWD
  3515         ELSE
  3516             GO TO 4100-BROWSE-BKWD.
  3517
  3518     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3519     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3520
  3521
  3522* EXEC CICS HANDLE CONDITION
  3523*        NOTFND   (0410-NO-COMP-MSTR)
  3524*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3525*        END-EXEC.
  3526*    MOVE '"$IJ                  ! # #00003478' TO DFHEIV0
  3527     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3529     MOVE X'2320233030303033343738' TO DFHEIV0(25:11)
  3530     CALL 'kxdfhei1' USING DFHEIV0
  3531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3532
  3533
  3534
  3535* EXEC CICS READ
  3536*        DATASET  (COMP-FILE-ID)
  3537*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3538*        RIDFLD   (ERCOMP-KEY)
  3539*        GTEQ
  3540*        END-EXEC.
  3541*    MOVE '&"S        G          (   #00003483' TO DFHEIV0
  3542     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3544     MOVE X'2020233030303033343833' TO DFHEIV0(25:11)
  3545     CALL 'kxdfhei1' USING DFHEIV0,
  3546           COMP-FILE-ID,
  3547           DFHEIV20,
  3548           DFHEIV99,
  3549           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  71
* EL633.cbl
  3550           DFHEIV99,
  3551           DFHEIV99,
  3552           DFHEIV99
  3553     SET ADDRESS OF COMPENSATION-MASTER TO
  3554         DFHEIV20
  3555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3556
  3557
  3558     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3559        COMP-CARRIER  = CO-CARRIER     AND
  3560        COMP-GROUPING = CO-GROUPING    AND
  3561        COMP-FIN-RESP = CO-RESP-NO    AND
  3562        COMP-ACCOUNT  = CO-ACCOUNT
  3563         NEXT SENTENCE
  3564     ELSE
  3565         GO TO 0410-NO-COMP-MSTR.
  3566
  3567     IF PI-COMPANY-ID = 'NCL'
  3568         IF CO-GA-INACTIVE
  3569             GO TO 0420-INACTIVE-COMP.
  3570
  3571     IF MAINTI = 'C'
  3572         GO TO 1000-EDIT-DATA.
  3573
  3574     IF EIBAID = DFHPF1
  3575       OR DFHENTER
  3576         GO TO 4000-BROWSE-FRWD.
  3577
  3578     IF EIBAID = DFHPF2
  3579         GO TO 4100-BROWSE-BKWD.
  3580
  3581 0410-NO-COMP-MSTR.
  3582     MOVE ER-2230                TO  EMI-ERROR.
  3583     MOVE -1                     TO  CARRIERL.
  3584     MOVE AL-UABON               TO  CARRIERA
  3585                                     GROUPA
  3586                                     FINRESPA
  3587                                     ACCTA.
  3588
  3589     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3590
  3591     GO TO 8200-SEND-DATAONLY.
  3592
  3593 0420-INACTIVE-COMP.
  3594     MOVE ER-2763                TO  EMI-ERROR.
  3595     MOVE -1                     TO  CARRIERL.
  3596     MOVE AL-UABON               TO  CARRIERA
  3597                                     GROUPA
  3598                                     FINRESPA
  3599                                     ACCTA.
  3600
  3601     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3602
  3603     GO TO 8200-SEND-DATAONLY.
  3604
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  72
* EL633.cbl
  3606 0500-CREATE-TEMP-STORAGE.
  3607
  3608     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3609
  3610
  3611* EXEC CICS WRITEQ TS
  3612*        QUEUE  (QID)
  3613*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3614*        LENGTH (PI-COMM-LENGTH)
  3615*    END-EXEC.
  3616*    MOVE '*"                    ''   #00003542' TO DFHEIV0
  3617     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3618     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3619     MOVE X'2020233030303033353432' TO DFHEIV0(25:11)
  3620     CALL 'kxdfhei1' USING DFHEIV0,
  3621           QID,
  3622           PROGRAM-INTERFACE-BLOCK,
  3623           PI-COMM-LENGTH,
  3624           DFHEIV99,
  3625           DFHEIV99,
  3626           DFHEIV99
  3627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3628
  3629
  3630 0590-EXIT.
  3631      EXIT.
  3632
  3633 0600-RECOVER-TEMP-STORAGE.
  3634
  3635* EXEC CICS READQ TS
  3636*        QUEUE  (QID)
  3637*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3638*        LENGTH (PI-COMM-LENGTH)
  3639*    END-EXEC.
  3640*    MOVE '*$I    L              ''   #00003552' TO DFHEIV0
  3641     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3643     MOVE X'2020233030303033353532' TO DFHEIV0(25:11)
  3644     CALL 'kxdfhei1' USING DFHEIV0,
  3645           QID,
  3646           PROGRAM-INTERFACE-BLOCK,
  3647           PI-COMM-LENGTH,
  3648           DFHEIV99,
  3649           DFHEIV99,
  3650           DFHEIV99
  3651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3652
  3653
  3654     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3655
  3656 0690-EXIT.
  3657      EXIT.
  3658
  3659 0800-DELETE-TS.
  3660
  3661* EXEC CICS HANDLE CONDITION
  3662*        QIDERR (0890-EXIT)
  3663*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  73
* EL633.cbl
  3664*    MOVE '"$N                   ! $ #00003564' TO DFHEIV0
  3665     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3667     MOVE X'2420233030303033353634' TO DFHEIV0(25:11)
  3668     CALL 'kxdfhei1' USING DFHEIV0
  3669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3670
  3671
  3672
  3673* EXEC CICS DELETEQ TS
  3674*        QUEUE  (QID)
  3675*    END-EXEC.
  3676*    MOVE '*&                    #   #00003568' TO DFHEIV0
  3677     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3678     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3679     MOVE X'2020233030303033353638' TO DFHEIV0(25:11)
  3680     CALL 'kxdfhei1' USING DFHEIV0,
  3681           QID,
  3682           DFHEIV99
  3683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3684
  3685
  3686
  3687* EXEC CICS SYNCPOINT
  3688*    END-EXEC.
  3689*    MOVE '6"                    !   #00003572' TO DFHEIV0
  3690     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3692     MOVE X'2020233030303033353732' TO DFHEIV0(25:11)
  3693     CALL 'kxdfhei1' USING DFHEIV0
  3694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3695
  3696
  3697 0890-EXIT.
  3698      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  74
* EL633.cbl
  3700
  3701 1000-EDIT-DATA.
  3702     SET PINDX                   TO  1.
  3703
  3704     .
  3705 1010-EDIT-LOOP.
  3706     SET NDX                     TO  PINDX.
  3707     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3708        GL-STATE-LEN (PINDX) = ZEROS   AND
  3709        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3710        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3711        RTYPE-LEN (PINDX)     = ZEROS  AND
  3712        AMT-LEN (PINDX)       = ZEROS  AND
  3713        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3714        SDTE-LEN (PINDX)      = ZEROS
  3715         GO TO 1020-INCREMENT-PINDX.
  3716
  3717     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3718         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3719         IF PI-COMPANY-ID NOT = 'WSL'
  3720             NEXT SENTENCE
  3721         ELSE
  3722             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3723             MOVE '4'                   TO  DC-OPTION-CODE
  3724             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3725             IF NO-CONVERSION-ERROR
  3726                 NEXT SENTENCE
  3727             ELSE
  3728                 MOVE ER-2595    TO  EMI-ERROR
  3729                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3730                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3731                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3732     ELSE
  3733         IF PI-COMPANY-ID = 'WSL'
  3734           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3735             MOVE ER-2596        TO  EMI-ERROR
  3736             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3737             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3738             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3739
  3740
  3741     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3742*        MOVE K-SPACE            TO COFA-FILLER
  3743*        MOVE '0001'             TO COFA-COMPANY-X
  3744*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3745         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3746     ELSE
  3747         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3748             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3749             MOVE ER-2957        TO EMI-ERROR
  3750             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3751             PERFORM 9900-ERROR-FORMAT THRU
  3752                     9900-EXIT
  3753             GO TO 1040-CONTINUE-EDIT
  3754         ELSE
  3755             GO TO 1040-CONTINUE-EDIT
  3756         END-IF
  3757     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  75
* EL633.cbl
  3758
  3759     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3760        AND (RTYPE (PINDX) = 'P')
  3761        GO TO 1040-CONTINUE-EDIT
  3762     END-IF
  3763     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3764        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3765     ELSE
  3766        MOVE SPACES              TO CHECK-GL-ACCT
  3767     END-IF
  3768
  3769     EVALUATE TRUE
  3770        WHEN (PI-COMPANY-ID = 'DCC' or 'VPP')
  3771           AND (CO-CARRIER = '1' OR '2' or '9')
  3772           AND (VALID-DCC-GL-ACCOUNT)
  3773           GO TO 1040-CONTINUE-EDIT
  3774        WHEN (PI-COMPANY-ID = 'DCC' or 'VPP')
  3775           AND (CO-CARRIER = '3' OR '4')
  3776           AND VALID-CSI-GL-ACCOUNT
  3777           GO TO 1040-CONTINUE-EDIT
  3778        WHEN (PI-COMPANY-ID = 'DCC' or 'VPP')
  3779           AND (CO-CARRIER = '5' OR '6' or '7')
  3780           AND (VALID-CCC-GL-ACCOUNT)
  3781           GO TO 1040-CONTINUE-EDIT
  3782        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3783           AND (VALID-GL-ACCOUNT)
  3784           GO TO 1040-CONTINUE-EDIT
  3785     END-EVALUATE
  3786*    EXEC CICS HANDLE CONDITION
  3787*         NOTFND (1040-NO-COFA-MSTR)
  3788*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3789*    END-EXEC.
  3790*
  3791*    EXEC CICS READ
  3792*         DATASET (COFA-FILE-ID)
  3793*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3794*         RIDFLD  (COFA-KEY-X)
  3795*    END-EXEC.
  3796*
  3797*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3798*    GO TO 1040-CONTINUE-EDIT.
  3799*
  3800*1040-NO-COFA-MSTR.
  3801
  3802     MOVE ER-2960                TO EMI-ERROR.
  3803     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3804     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3805     PERFORM 9900-ERROR-FORMAT THRU
  3806             9900-EXIT.
  3807
  3808 1040-CONTINUE-EDIT.
  3809
  3810*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3811     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3812         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3813         IF NOT VALID-STATE-CODE
  3814             MOVE -1             TO GL-STATE-LEN (PINDX)
  3815             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  76
* EL633.cbl
  3816             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3817             PERFORM 9900-ERROR-FORMAT THRU
  3818                     9900-EXIT
  3819         ELSE
  3820             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3821         END-IF
  3822     END-IF.
  3823
  3824 1040-CSO-SKIP.
  3825
  3826     IF GL-CANC (PINDX) = LOW-VALUES
  3827         MOVE SPACES             TO GL-CANC (PINDX)
  3828     END-IF.
  3829
  3830     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3831         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3832         IF NOT VALID-CANC-TYPE
  3833             MOVE -1             TO GL-CANC-LEN (PINDX)
  3834             MOVE ER-2958        TO EMI-ERROR
  3835             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3836             PERFORM 9900-ERROR-FORMAT THRU
  3837                     9900-EXIT
  3838         ELSE
  3839             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3840         END-IF
  3841     END-IF.
  3842
  3843     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3844        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3845        IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  3846           AND (RTYPE (PINDX) = 'P')
  3847           SET VALID-REC-TYPE   TO TRUE
  3848        END-IF
  3849         IF NOT VALID-REC-TYPE
  3850             MOVE -1             TO  RTYPE-LEN (PINDX)
  3851             MOVE ER-2234        TO  EMI-ERROR
  3852             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3853             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3854         ELSE
  3855             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3856     ELSE
  3857         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3858             MOVE -1             TO  RTYPE-LEN (PINDX)
  3859             MOVE ER-2235        TO  EMI-ERROR
  3860             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3861             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3862
  3863     IF AMT-LEN (PINDX) NOT = ZEROS
  3864
  3865* EXEC CICS BIF DEEDIT
  3866*           FIELD (AMT (PINDX))
  3867*           LENGTH (11)
  3868*       END-EXEC
  3869     MOVE 11
  3870       TO DFHEIV11
  3871*    MOVE '@"L                   #   #00003742' TO DFHEIV0
  3872     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3873     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  77
* EL633.cbl
  3874     MOVE X'2020233030303033373432' TO DFHEIV0(25:11)
  3875     CALL 'kxdfhei1' USING DFHEIV0,
  3876           AMT(PINDX),
  3877           DFHEIV11
  3878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3879         IF AMT (PINDX) = ZEROS
  3880             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3881                 NEXT SENTENCE
  3882             ELSE
  3883                 MOVE ER-2245    TO  EMI-ERROR
  3884                 MOVE -1         TO  AMT-LEN(PINDX)
  3885                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3886                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3887         ELSE
  3888             IF AMT (PINDX) NUMERIC
  3889                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3890             ELSE
  3891                 MOVE ER-2245    TO  EMI-ERROR
  3892                 MOVE -1         TO  AMT-LEN(PINDX)
  3893                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3894                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3895     ELSE
  3896         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3897             MOVE -1             TO  AMT-LEN (PINDX)
  3898             MOVE ER-2236        TO  EMI-ERROR
  3899             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3900             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3901
  3902     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3903         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3904           AND (PI-REC-TYPE (NDX) = 'C')
  3905             IF VOID-SW (PINDX) = 'V'
  3906                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3907             ELSE
  3908                 MOVE ER-2246    TO  EMI-ERROR
  3909                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3910                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3911                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3912         ELSE
  3913             MOVE ER-2449        TO  EMI-ERROR
  3914             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3915             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3916             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3917
  3918     IF SDTE-LEN (PINDX) = ZEROS
  3919        GO TO 1020-INCREMENT-PINDX.
  3920
  3921     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3922
  3923     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3924     PERFORM 8600-DEEDIT.
  3925
  3926     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3927        GO TO 1015-DAY-ERROR.
  3928
  3929     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3930     MOVE '4'                    TO  DC-OPTION-CODE.
  3931     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  78
* EL633.cbl
  3932
  3933     IF NO-CONVERSION-ERROR
  3934        SET PINDEX               TO  PINDX
  3935        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3936     ELSE
  3937        GO TO 1015-DAY-ERROR.
  3938
  3939     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3940
  3941     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3942         IF DATE-TEST-DD  NOT = 30
  3943             GO TO 1015-DAY-ERROR
  3944         ELSE
  3945             GO TO 1020-INCREMENT-PINDX.
  3946
  3947     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3948                             8  OR  10  OR  12
  3949         IF DATE-TEST-DD  NOT = 31
  3950             GO TO 1015-DAY-ERROR
  3951         ELSE
  3952             GO TO 1020-INCREMENT-PINDX.
  3953
  3954     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3955         REMAINDER  DIVIDE-REMAINDER.
  3956
  3957     IF (DATE-TEST-YY = ZERO)
  3958       OR (DIVIDE-REMAINDER NOT = ZERO)
  3959         IF DATE-TEST-DD  NOT = 28
  3960             GO TO 1015-DAY-ERROR
  3961         ELSE
  3962             GO TO 1020-INCREMENT-PINDX
  3963     ELSE
  3964         IF DATE-TEST-DD = 29
  3965             GO TO 1020-INCREMENT-PINDX.
  3966
  3967 1015-DAY-ERROR.
  3968     MOVE -1                     TO  SDTE-LEN (PINDX).
  3969     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3970     MOVE ER-0587                TO  EMI-ERROR.
  3971
  3972     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3973
  3974 1020-INCREMENT-PINDX.
  3975     SET PINDX  UP  BY  1.
  3976
  3977     IF PINDX  IS NOT GREATER THAN  13
  3978         GO TO 1010-EDIT-LOOP.
  3979
  3980     IF EMI-ERROR = ZEROS
  3981         NEXT SENTENCE
  3982     ELSE
  3983         MOVE 'S'                TO  PI-PREV-FUNCTION
  3984         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  79
* EL633.cbl
  3986 2000-UPDATE-THE-FILE.
  3987     SET PINDX                   TO  ZERO-NDX.
  3988*    SET NDX                     TO  ZERO-NDX.
  3989*    SET NDX  UP  BY  1.
  3990
  3991     IF PI-PYAJ-FILE-SW = 'B'
  3992         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3993         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3994     ELSE
  3995         MOVE PI-LAST-FILE-SEQ-NO
  3996                                 TO  PI-SAV-FILE-SEQ-NO
  3997         MOVE PI-LAST-RECORD-TYPE
  3998                                 TO  PI-SAV-RECORD-TYPE.
  3999
  4000 2100-UPDATE-LOOP.
  4001     SET PINDX  UP  BY  1.
  4002     SET NDX                     TO  PINDX.
  4003
  4004     IF PINDX  IS GREATER THAN  13
  4005         GO TO 2200-UPDATE-COMPLETE.
  4006
  4007     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4008        GL-STATE-LEN (PINDX) = ZEROS AND
  4009        GL-CANC-LEN (PINDX)   = ZEROS AND
  4010        GL-COMM-LEN (PINDX)   = ZEROS AND
  4011        RTYPE-LEN (PINDX)   = ZEROS  AND
  4012        AMT-LEN (PINDX)     = ZEROS  AND
  4013        VOID-SW-LEN (PINDX) = ZEROS  AND
  4014        SDTE-LEN (PINDX)    = ZEROS
  4015         GO TO 2100-UPDATE-LOOP.
  4016
  4017
  4018* EXEC CICS BIF DEEDIT
  4019*         FIELD (AMT (PINDX))
  4020*         LENGTH (11)
  4021*    END-EXEC.
  4022     MOVE 11
  4023       TO DFHEIV11
  4024*    MOVE '@"L                   #   #00003884' TO DFHEIV0
  4025     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4026     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4027     MOVE X'2020233030303033383834' TO DFHEIV0(25:11)
  4028     CALL 'kxdfhei1' USING DFHEIV0,
  4029           AMT(PINDX),
  4030           DFHEIV11
  4031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4032
  4033
  4034     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4035         NEXT SENTENCE
  4036     ELSE
  4037         GO TO 2110-ADD-RECORD.
  4038
  4039
  4040* EXEC CICS HANDLE CONDITION
  4041*        NOTFND  (2110-ADD-RECORD)
  4042*    END-EXEC.
  4043*    MOVE '"$I                   ! % #00003894' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  80
* EL633.cbl
  4044     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4046     MOVE X'2520233030303033383934' TO DFHEIV0(25:11)
  4047     CALL 'kxdfhei1' USING DFHEIV0
  4048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4049
  4050
  4051     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4052     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4053     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4054
  4055
  4056* EXEC CICS READ
  4057*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4058*        DATASET  (PYAJ-FILE-ID)
  4059*        RIDFLD   (ERPYAJ-KEY)
  4060*        UPDATE
  4061*    END-EXEC.
  4062*    MOVE '&"S        EU         (   #00003902' TO DFHEIV0
  4063     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4064     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4065     MOVE X'2020233030303033393032' TO DFHEIV0(25:11)
  4066     CALL 'kxdfhei1' USING DFHEIV0,
  4067           PYAJ-FILE-ID,
  4068           DFHEIV20,
  4069           DFHEIV99,
  4070           ERPYAJ-KEY,
  4071           DFHEIV99,
  4072           DFHEIV99,
  4073           DFHEIV99
  4074     SET ADDRESS OF PENDING-PAY-ADJ TO
  4075         DFHEIV20
  4076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4077
  4078
  4079
  4080     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4081        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4082            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4083            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4084            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4085
  4086     IF AMT-LEN (PINDX) NOT = ZEROS
  4087         IF AMT (PINDX) = ZEROS
  4088             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4089                 GO TO 2120-DELETE-RECORD
  4090             ELSE
  4091                 MOVE ER-2244       TO  EMI-ERROR
  4092                 MOVE -1            TO  AMT-LEN (PINDX)
  4093                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4094                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4095                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4096
  4097* EXEC CICS UNLOCK
  4098*                    DATASET  (PYAJ-FILE-ID)
  4099*                END-EXEC
  4100*    MOVE '&*                    #   #00003926' TO DFHEIV0
  4101     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  81
* EL633.cbl
  4102     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4103     MOVE X'2020233030303033393236' TO DFHEIV0(25:11)
  4104     CALL 'kxdfhei1' USING DFHEIV0,
  4105           PYAJ-FILE-ID,
  4106           DFHEIV99
  4107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4108                 GO TO 8200-SEND-DATAONLY.
  4109
  4110     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4111     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4112     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4113
  4114     PERFORM 8400-LOG-JOURNAL-RECORD.
  4115
  4116     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4117     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4118     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4119
  4120     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4121         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4122     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4123         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4124     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4125         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4126     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4127         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4128     IF AMT-LEN (PINDX) NOT = ZEROS
  4129         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4130
  4131     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4132         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4133
  4134     IF SDTE-LEN (PINDX) NOT = ZEROS
  4135        SET PINDEX               TO  PINDX
  4136        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4137
  4138     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4139     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4140     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4141
  4142
  4143* EXEC CICS REWRITE
  4144*        DATASET  (PYAJ-FILE-ID)
  4145*        FROM     (PENDING-PAY-ADJ)
  4146*    END-EXEC.
  4147     MOVE LENGTH OF
  4148      PENDING-PAY-ADJ
  4149       TO DFHEIV11
  4150*    MOVE '&& L                  %   #00003963' TO DFHEIV0
  4151     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4152     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4153     MOVE X'2020233030303033393633' TO DFHEIV0(25:11)
  4154     CALL 'kxdfhei1' USING DFHEIV0,
  4155           PYAJ-FILE-ID,
  4156           PENDING-PAY-ADJ,
  4157           DFHEIV11,
  4158           DFHEIV99
  4159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  82
* EL633.cbl
  4160
  4161
  4162     PERFORM 8400-LOG-JOURNAL-RECORD.
  4163
  4164     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  83
* EL633.cbl
  4166 2110-ADD-RECORD.
  4167
  4168* EXEC CICS GETMAIN
  4169*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4170*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4171*        INITIMG  (GETMAIN-SPACE)
  4172*    END-EXEC.
  4173*    MOVE ',"IL                  $   #00003973' TO DFHEIV0
  4174     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4175     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4176     MOVE X'2020233030303033393733' TO DFHEIV0(25:11)
  4177     CALL 'kxdfhei1' USING DFHEIV0,
  4178           DFHEIV20,
  4179           ERPYAJ-RECORD-LENGTH,
  4180           GETMAIN-SPACE
  4181     SET ADDRESS OF PENDING-PAY-ADJ TO
  4182         DFHEIV20
  4183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4184
  4185
  4186     MOVE 'PY'                   TO  PY-RECORD-ID.
  4187     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4188     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4189     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4190     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4191     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4192
  4193     ADD +1                      TO  WORK-SEQ-NO.
  4194     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4195
  4196     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4197     if gl-state-len (pindx) <> zeros
  4198        MOVE GL-STATE (PINDX)    TO  PY-GL-STATE
  4199     end-if
  4200     if gl-canc-len (pindx) <> zeros
  4201        MOVE GL-CANC (PINDX)     TO  PY-GL-CANC-SW
  4202     end-if
  4203     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4204
  4205     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4206     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4207     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4208        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4209     END-IF
  4210     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4211     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4212     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4213                                     PY-INPUT-DT.
  4214     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4215                                     PY-CHECK-QUE-SEQUENCE.
  4216     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4217                                     PY-BILLED-DATE
  4218                                     PY-AR-DATE
  4219                                     PY-REPORTED-DT
  4220                                     PY-CHECK-WRITTEN-DT.
  4221     IF SDTE-LEN (PINDX) = ZEROS
  4222         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4223         GO TO 2115-WRITE-REC
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  84
* EL633.cbl
  4224     END-IF.
  4225
  4226     IF SDTE (PINDX) IS NUMERIC
  4227         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
  4228         MOVE '4'            TO  DC-OPTION-CODE
  4229         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4230         IF DATE-CONVERSION-ERROR
  4231             MOVE PI-CR-MONTH-END-DT
  4232                             TO  PY-CREDIT-SELECT-DT
  4233         ELSE
  4234             MOVE DC-BIN-DATE-1
  4235                             TO  PY-CREDIT-SELECT-DT
  4236         END-IF
  4237     ELSE
  4238         MOVE PI-CR-MONTH-END-DT
  4239                             TO  PY-CREDIT-SELECT-DT
  4240     END-IF
  4241
  4242     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4243         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4244         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4245
  4246     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4247         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4248         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4249
  4250     MOVE 'N'                    TO  FIRST-ADD-SW.
  4251
  4252     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4253     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4254     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4255 2115-WRITE-REC.
  4256
  4257* EXEC CICS WRITE
  4258*        DATASET  (PYAJ-FILE-ID)
  4259*        FROM     (PENDING-PAY-ADJ)
  4260*        RIDFLD   (PY-CONTROL-PRIMARY)
  4261*    END-EXEC.
  4262     MOVE LENGTH OF
  4263      PENDING-PAY-ADJ
  4264       TO DFHEIV11
  4265*    MOVE '&$ L                  ''   #00004049' TO DFHEIV0
  4266     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4267     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4268     MOVE X'2020233030303034303439' TO DFHEIV0(25:11)
  4269     CALL 'kxdfhei1' USING DFHEIV0,
  4270           PYAJ-FILE-ID,
  4271           PENDING-PAY-ADJ,
  4272           DFHEIV11,
  4273           PY-CONTROL-PRIMARY,
  4274           DFHEIV99,
  4275           DFHEIV99
  4276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4277
  4278
  4279     PERFORM 8400-LOG-JOURNAL-RECORD.
  4280
  4281     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  85
* EL633.cbl
  4282
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  86
* EL633.cbl
  4284 2120-DELETE-RECORD.
  4285     IF PY-RECORD-TYPE NOT = 'C'
  4286         GO TO 2120-DELETE-CONT.
  4287
  4288     IF PY-CHECK-QUE-CONTROL = ZEROS
  4289       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4290         GO TO 2120-DELETE-CONT.
  4291
  4292
  4293* EXEC CICS HANDLE CONDITION
  4294*        NOTFND  (2120-DELETE-CONT)
  4295*    END-EXEC.
  4296*    MOVE '"$I                   ! & #00004068' TO DFHEIV0
  4297     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4299     MOVE X'2620233030303034303638' TO DFHEIV0(25:11)
  4300     CALL 'kxdfhei1' USING DFHEIV0
  4301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4302
  4303
  4304     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4305     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4306     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4307
  4308
  4309* EXEC CICS READ
  4310*        SET      (ADDRESS OF CHECK-QUE)
  4311*        DATASET  (CHKQ-FILE-ID)
  4312*        RIDFLD   (ERCHKQ-KEY)
  4313*        UPDATE
  4314*    END-EXEC.
  4315*    MOVE '&"S        EU         (   #00004076' TO DFHEIV0
  4316     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4317     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4318     MOVE X'2020233030303034303736' TO DFHEIV0(25:11)
  4319     CALL 'kxdfhei1' USING DFHEIV0,
  4320           CHKQ-FILE-ID,
  4321           DFHEIV20,
  4322           DFHEIV99,
  4323           ERCHKQ-KEY,
  4324           DFHEIV99,
  4325           DFHEIV99,
  4326           DFHEIV99
  4327     SET ADDRESS OF CHECK-QUE TO
  4328         DFHEIV20
  4329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4330
  4331
  4332*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4333*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4334*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4335*
  4336*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4337
  4338
  4339* EXEC CICS DELETE
  4340*        DATASET  (CHKQ-FILE-ID)
  4341*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  87
* EL633.cbl
  4342*    MOVE '&(                    &   #00004089' TO DFHEIV0
  4343     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4344     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4345     MOVE X'2020233030303034303839' TO DFHEIV0(25:11)
  4346     CALL 'kxdfhei1' USING DFHEIV0,
  4347           CHKQ-FILE-ID,
  4348           DFHEIV99,
  4349           DFHEIV99,
  4350           DFHEIV99,
  4351           DFHEIV99
  4352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4353
  4354
  4355 2120-DELETE-CONT.
  4356*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4357*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4358*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4359*
  4360*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4361
  4362     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4363         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4364         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4365         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4366                                     PI-SAV-ACCT-NET
  4367                                     PI-SAV-PREV-AMT
  4368                                     PI-SAV-PREV-NET.
  4369
  4370
  4371* EXEC CICS DELETE
  4372*        DATASET(PYAJ-FILE-ID)
  4373*    END-EXEC.
  4374*    MOVE '&(                    &   #00004108' TO DFHEIV0
  4375     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4377     MOVE X'2020233030303034313038' TO DFHEIV0(25:11)
  4378     CALL 'kxdfhei1' USING DFHEIV0,
  4379           PYAJ-FILE-ID,
  4380           DFHEIV99,
  4381           DFHEIV99,
  4382           DFHEIV99,
  4383           DFHEIV99
  4384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4385
  4386
  4387     GO TO 2100-UPDATE-LOOP.
  4388
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  88
* EL633.cbl
  4390
  4391 2190-CHANGE-RECORD-TYPE.
  4392
  4393*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4394*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4395*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4396*
  4397*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4398
  4399
  4400* EXEC CICS DELETE
  4401*        DATASET(PYAJ-FILE-ID)
  4402*    END-EXEC.
  4403*    MOVE '&(                    &   #00004124' TO DFHEIV0
  4404     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4405     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4406     MOVE X'2020233030303034313234' TO DFHEIV0(25:11)
  4407     CALL 'kxdfhei1' USING DFHEIV0,
  4408           PYAJ-FILE-ID,
  4409           DFHEIV99,
  4410           DFHEIV99,
  4411           DFHEIV99,
  4412           DFHEIV99
  4413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4414
  4415
  4416
  4417* EXEC CICS GETMAIN
  4418*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4419*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4420*        INITIMG  (GETMAIN-SPACE)
  4421*    END-EXEC.
  4422*    MOVE ',"IL                  $   #00004128' TO DFHEIV0
  4423     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4425     MOVE X'2020233030303034313238' TO DFHEIV0(25:11)
  4426     CALL 'kxdfhei1' USING DFHEIV0,
  4427           DFHEIV20,
  4428           ERPYAJ-RECORD-LENGTH,
  4429           GETMAIN-SPACE
  4430     SET ADDRESS OF PENDING-PAY-ADJ TO
  4431         DFHEIV20
  4432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4433
  4434
  4435*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4436*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4437
  4438     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4439     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4440                                    PYAJ-RECORD-TYPE.
  4441
  4442
  4443* EXEC CICS HANDLE CONDITION
  4444*        DUPREC (2190-DUP-RECORD)
  4445*    END-EXEC.
  4446*    MOVE '"$%                   ! '' #00004141' TO DFHEIV0
  4447     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  89
* EL633.cbl
  4448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4449     MOVE X'2720233030303034313431' TO DFHEIV0(25:11)
  4450     CALL 'kxdfhei1' USING DFHEIV0
  4451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4452
  4453
  4454*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4455*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4456*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4457
  4458 2190-RETRY-WRITE.
  4459
  4460
  4461* EXEC CICS WRITE
  4462*        DATASET  (PYAJ-FILE-ID)
  4463*        FROM     (PENDING-PAY-ADJ)
  4464*        RIDFLD   (PY-CONTROL-PRIMARY)
  4465*    END-EXEC.
  4466     MOVE LENGTH OF
  4467      PENDING-PAY-ADJ
  4468       TO DFHEIV11
  4469*    MOVE '&$ L                  ''   #00004151' TO DFHEIV0
  4470     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4472     MOVE X'2020233030303034313531' TO DFHEIV0(25:11)
  4473     CALL 'kxdfhei1' USING DFHEIV0,
  4474           PYAJ-FILE-ID,
  4475           PENDING-PAY-ADJ,
  4476           DFHEIV11,
  4477           PY-CONTROL-PRIMARY,
  4478           DFHEIV99,
  4479           DFHEIV99
  4480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4481
  4482
  4483*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4484
  4485
  4486* EXEC CICS READ
  4487*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4488*        DATASET  (PYAJ-FILE-ID)
  4489*        RIDFLD   (ERPYAJ-KEY)
  4490*        UPDATE
  4491*    END-EXEC.
  4492*    MOVE '&"S        EU         (   #00004159' TO DFHEIV0
  4493     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4494     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4495     MOVE X'2020233030303034313539' TO DFHEIV0(25:11)
  4496     CALL 'kxdfhei1' USING DFHEIV0,
  4497           PYAJ-FILE-ID,
  4498           DFHEIV20,
  4499           DFHEIV99,
  4500           ERPYAJ-KEY,
  4501           DFHEIV99,
  4502           DFHEIV99,
  4503           DFHEIV99
  4504     SET ADDRESS OF PENDING-PAY-ADJ TO
  4505         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  90
* EL633.cbl
  4506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4507
  4508
  4509     GO TO 2190-EXIT.
  4510
  4511 2190-DUP-RECORD.
  4512
  4513     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4514
  4515     GO TO 2190-RETRY-WRITE.
  4516
  4517 2190-EXIT.
  4518     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  91
* EL633.cbl
  4520
  4521 2200-UPDATE-COMPLETE.
  4522     IF EIBAID = DFHPF1
  4523         GO TO 4000-BROWSE-FRWD.
  4524
  4525     IF EIBAID = DFHPF2
  4526         GO TO 4100-BROWSE-BKWD.
  4527
  4528     MOVE LOW-VALUES             TO  EL633AI.
  4529
  4530     MOVE ER-0000                TO  EMI-ERROR.
  4531     MOVE -1                     TO  MAINTL.
  4532
  4533     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4534
  4535     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4536     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4537
  4538*    GO TO 4000-BROWSE-FRWD.
  4539
  4540*    GO TO 8100-SEND-INITIAL-MAP.
  4541
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  92
* EL633.cbl
  4543 4000-BROWSE-FRWD.
  4544     MOVE '1'                     TO  PI-PREV-PFKEY.
  4545     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4546
  4547     IF EIBAID = DFHPF1
  4548         IF PAGE-FULL
  4549             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4550                                      TO  PYAJ-FILE-SEQ-NO
  4551             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4552             MOVE 'N'                 TO  PYAJ-READ-SW
  4553             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4554             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4555             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4556             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4557         ELSE
  4558             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4559                                          PI-SAV-ACCT-NET
  4560                                          PI-SAV-PREV-AMT
  4561                                          PI-SAV-PREV-NET
  4562             MOVE 'Y'                 TO  PI-PAGE-SW
  4563             IF NOT END-OF-FILE
  4564                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4565                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4566             END-IF
  4567             IF TOP-OF-FILE
  4568                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4569                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4570                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4571             ELSE
  4572                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4573                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4574     ELSE
  4575         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4576         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4577         IF MAINTI = 'S'
  4578             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4579             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4580
  4581
  4582     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4583
  4584     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4585         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4586
  4587 4000-BROWSE-FRWD-FOR-PREV.
  4588*    IF END-OF-FILE
  4589*        IF EIBAID = DFHPF1
  4590*           IF PI-TOTAL-DISPLAYED
  4591*              NEXT SENTENCE
  4592*           ELSE
  4593*              MOVE -1                 TO  MAINTL
  4594*              MOVE ER-2237            TO  EMI-ERROR
  4595*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4596*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4597*              SET PINDX               TO  +2
  4598*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4599*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4600*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  93
* EL633.cbl
  4601*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4602*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4603*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4604*                                          PI-SAV-ACCT-NET
  4605*              GO TO 8100-SEND-INITIAL-MAP.
  4606*
  4607*     IF END-OF-FILE
  4608*        IF EIBAID = DFHPF1
  4609*           MOVE -1             TO  MAINTL
  4610*           MOVE ER-2237        TO  EMI-ERROR
  4611*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4612*           GO TO 8200-SEND-DATAONLY.
  4613*
  4614     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4615
  4616     IF NO-RECORDS
  4617        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4618        MOVE LOW-VALUES         TO  EL633AO
  4619        MOVE ER-2239            TO  EMI-ERROR
  4620        MOVE -1                 TO  MAINTL
  4621        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4622        GO TO 8100-SEND-INITIAL-MAP.
  4623
  4624     IF NOT-OPEN
  4625         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4626
  4627     MOVE LOW-VALUES             TO  EL633AO.
  4628     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4629
  4630     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4631          VARYING  PINDX  FROM  1  BY  1
  4632             UNTIL  END-OF-ACCT
  4633                 OR  END-OF-FILE
  4634                     OR  PAGE-FULL
  4635                         OR  NO-RECORDS.
  4636
  4637     IF NO-RECORDS
  4638         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4639         MOVE LOW-VALUES         TO  EL633AO
  4640         MOVE ER-2239            TO  EMI-ERROR
  4641         MOVE -1                 TO  MAINTL
  4642         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4643         GO TO 8100-SEND-INITIAL-MAP.
  4644
  4645     IF END-OF-FILE
  4646         IF EIBAID = DFHPF2
  4647             MOVE ER-2238        TO  EMI-ERROR
  4648             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4649             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4650         ELSE
  4651             MOVE ER-2237        TO  EMI-ERROR
  4652             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4653
  4654     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4655                                     PI-SAV-FUNCTION.
  4656
  4657     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  94
* EL633.cbl
  4659 4100-BROWSE-BKWD.
  4660     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4661                                      PI-TOTAL-DISPLAYED-SW.
  4662     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4663     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4664     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4665     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4666                                      PI-SAV-ACCT-NET
  4667                                      PI-SAV-PREV-AMT
  4668                                      PI-SAV-PREV-NET.
  4669
  4670     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4671
  4672     IF NO-RECORDS
  4673         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4674         MOVE LOW-VALUES         TO  EL633AO
  4675         MOVE ER-2239            TO  EMI-ERROR
  4676         MOVE -1                 TO  MAINTL
  4677         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4678         GO TO 8100-SEND-INITIAL-MAP.
  4679
  4680     IF NOT-OPEN
  4681         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4682
  4683
  4684* EXEC CICS READNEXT
  4685*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4686*        DATASET  (PYAJ-FILE-ID)
  4687*        RIDFLD   (ERPYAJ-KEY)
  4688*    END-EXEC.
  4689     MOVE 0
  4690       TO DFHEIV11
  4691*    MOVE '&.S                   )   #00004340' TO DFHEIV0
  4692     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4693     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4694     MOVE X'2020233030303034333430' TO DFHEIV0(25:11)
  4695     CALL 'kxdfhei1' USING DFHEIV0,
  4696           PYAJ-FILE-ID,
  4697           DFHEIV20,
  4698           DFHEIV99,
  4699           ERPYAJ-KEY,
  4700           DFHEIV99,
  4701           DFHEIV11,
  4702           DFHEIV99,
  4703           DFHEIV99
  4704     SET ADDRESS OF PENDING-PAY-ADJ TO
  4705         DFHEIV20
  4706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4707
  4708
  4709     IF FIRST-PAGE OR
  4710        PI-PREV-PFKEY = '2'
  4711         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4712         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4713
  4714     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4715
  4716     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  95
* EL633.cbl
  4717     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4718     MOVE '2'                     TO  PI-PREV-PFKEY.
  4719
  4720     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  96
* EL633.cbl
  4722 5000-START-BROWSE.
  4723
  4724* EXEC CICS HANDLE CONDITION
  4725*        NOTOPEN  (5010-NOT-OPEN)
  4726*        NOTFND   (5020-NO-RECORDS)
  4727*        ENDFILE  (5020-NO-RECORDS)
  4728*    END-EXEC.
  4729*    MOVE '"$JI''                 ! ( #00004360' TO DFHEIV0
  4730     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4732     MOVE X'2820233030303034333630' TO DFHEIV0(25:11)
  4733     CALL 'kxdfhei1' USING DFHEIV0
  4734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4735
  4736
  4737
  4738* EXEC CICS STARTBR
  4739*        DATASET  (PYAJ-FILE-ID)
  4740*        RIDFLD   (ERPYAJ-KEY)
  4741*    END-EXEC.
  4742     MOVE 0
  4743       TO DFHEIV11
  4744*    MOVE '&,         G          &   #00004366' TO DFHEIV0
  4745     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4746     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4747     MOVE X'2020233030303034333636' TO DFHEIV0(25:11)
  4748     CALL 'kxdfhei1' USING DFHEIV0,
  4749           PYAJ-FILE-ID,
  4750           ERPYAJ-KEY,
  4751           DFHEIV99,
  4752           DFHEIV11,
  4753           DFHEIV99
  4754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4755
  4756
  4757     GO TO 5030-EXIT.
  4758
  4759 5010-NOT-OPEN.
  4760     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4761
  4762     GO TO 5030-EXIT.
  4763
  4764 5020-NO-RECORDS.
  4765     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4766     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4767
  4768 5030-EXIT.
  4769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  97
* EL633.cbl
  4771 5100-READ-PREVIOUS.
  4772
  4773* EXEC CICS HANDLE CONDITION
  4774*        ENDFILE  (5110-END-OF-FILE)
  4775*        NOTFND   (5110-END-OF-FILE)
  4776*    END-EXEC.
  4777*    MOVE '"$''I                  ! ) #00004386' TO DFHEIV0
  4778     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4780     MOVE X'2920233030303034333836' TO DFHEIV0(25:11)
  4781     CALL 'kxdfhei1' USING DFHEIV0
  4782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4783
  4784
  4785
  4786* EXEC CICS READPREV
  4787*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4788*        DATASET  (PYAJ-FILE-ID)
  4789*        RIDFLD   (ERPYAJ-KEY)
  4790*    END-EXEC.
  4791     MOVE 0
  4792       TO DFHEIV11
  4793*    MOVE '&0S                   )   #00004391' TO DFHEIV0
  4794     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4795     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4796     MOVE X'2020233030303034333931' TO DFHEIV0(25:11)
  4797     CALL 'kxdfhei1' USING DFHEIV0,
  4798           PYAJ-FILE-ID,
  4799           DFHEIV20,
  4800           DFHEIV99,
  4801           ERPYAJ-KEY,
  4802           DFHEIV99,
  4803           DFHEIV11,
  4804           DFHEIV99,
  4805           DFHEIV99
  4806     SET ADDRESS OF PENDING-PAY-ADJ TO
  4807         DFHEIV20
  4808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4809
  4810
  4811     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4812         IF PI-CARRIER-SECURITY = PY-CARRIER
  4813             NEXT SENTENCE
  4814         ELSE
  4815             GO TO 5110-END-OF-FILE.
  4816
  4817     GO TO 5120-EXIT.
  4818
  4819 5110-END-OF-FILE.
  4820     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4821     MOVE ER-2238                TO  EMI-ERROR.
  4822     MOVE -1                     TO  PFENTERL.
  4823
  4824     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4825
  4826     GO TO 8200-SEND-DATAONLY.
  4827
  4828 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  98
* EL633.cbl
  4829     EXIT.
  4830
  4831 5200-END-BROWSE.
  4832
  4833* EXEC CICS ENDBR
  4834*        DATASET  (PYAJ-FILE-ID)
  4835*    END-EXEC.
  4836     MOVE 0
  4837       TO DFHEIV11
  4838*    MOVE '&2                    $   #00004418' TO DFHEIV0
  4839     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4841     MOVE X'2020233030303034343138' TO DFHEIV0(25:11)
  4842     CALL 'kxdfhei1' USING DFHEIV0,
  4843           PYAJ-FILE-ID,
  4844           DFHEIV11,
  4845           DFHEIV99
  4846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4847
  4848
  4849 5200-EXIT.
  4850     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page  99
* EL633.cbl
  4852 6000-READ-AND-FORMAT-SCREEN.
  4853
  4854* EXEC CICS HANDLE CONDITION
  4855*        ENDFILE  (6100-END-OF-FILE)
  4856*        NOTFND   (6100-END-OF-FILE)
  4857*    END-EXEC.
  4858*    MOVE '"$''I                  ! * #00004426' TO DFHEIV0
  4859     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4861     MOVE X'2A20233030303034343236' TO DFHEIV0(25:11)
  4862     CALL 'kxdfhei1' USING DFHEIV0
  4863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4864
  4865
  4866*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4867*    INITIALIZE  PI-SEQ-NOS.
  4868
  4869 6010-READ-NEXT.
  4870
  4871
  4872* EXEC CICS READNEXT
  4873*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4874*        DATASET  (PYAJ-FILE-ID)
  4875*        RIDFLD   (ERPYAJ-KEY)
  4876*    END-EXEC.
  4877     MOVE 0
  4878       TO DFHEIV11
  4879*    MOVE '&.S                   )   #00004436' TO DFHEIV0
  4880     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4881     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4882     MOVE X'2020233030303034343336' TO DFHEIV0(25:11)
  4883     CALL 'kxdfhei1' USING DFHEIV0,
  4884           PYAJ-FILE-ID,
  4885           DFHEIV20,
  4886           DFHEIV99,
  4887           ERPYAJ-KEY,
  4888           DFHEIV99,
  4889           DFHEIV11,
  4890           DFHEIV99,
  4891           DFHEIV99
  4892     SET ADDRESS OF PENDING-PAY-ADJ TO
  4893         DFHEIV20
  4894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4895
  4896
  4897     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4898       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4899         GO TO 6100-END-OF-FILE.
  4900
  4901     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4902         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4903             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4904                 GO TO 6100-END-OF-FILE.
  4905
  4906     IF PYAJ-1ST-READ
  4907       AND EIBAID NOT = DFHENTER
  4908       AND NOT PAGE-FULL
  4909         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 100
* EL633.cbl
  4910         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4911         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4912         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4913         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4914
  4915     IF PYAJ-1ST-READ
  4916         MOVE PI-SAV-ENDING-PYAJ-KEY
  4917                                 TO  PI-START-PYAJ-KEY.
  4918
  4919     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4920        PI-SAV-CARRIER  = PY-CARRIER     AND
  4921        PI-SAV-GROUPING = PY-GROUPING    AND
  4922        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4923        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4924         NEXT SENTENCE
  4925     ELSE
  4926         IF PYAJ-1ST-READ
  4927             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4928             MOVE SPACE          TO  PYAJ-READ-SW
  4929             GO TO 6200-EXIT
  4930         ELSE
  4931             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4932             IF PINDX  IS LESS THAN  12
  4933                 SET PINDX  UP  BY  1
  4934                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4935                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4936                 SET PINDX  UP  BY  1
  4937                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4938                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4939                     GO TO 6200-EXIT
  4940             ELSE
  4941                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4942                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4943                 SET PINDX  UP  BY  1
  4944                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4945                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4946                 GO TO 6200-EXIT.
  4947
  4948*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4949
  4950     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4951         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4952
  4953*    SET PINDX  UP  BY +1.
  4954
  4955     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4956
  4957     IF PINDX  IS GREATER THAN  13
  4958         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4959         MOVE +13                TO  PI-FULL-INDX
  4960         MOVE PI-FRST-FILE-SEQ-NO
  4961                                 TO  PI-LAST-FILE-SEQ-NO
  4962         MOVE PI-FRST-RECORD-TYPE
  4963                                 TO  PI-LAST-RECORD-TYPE
  4964         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4965         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4966         GO TO 6200-EXIT.
  4967
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 101
* EL633.cbl
  4968     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4969     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4970
  4971     IF PYAJ-1ST-READ
  4972         MOVE SPACE              TO  PYAJ-READ-SW.
  4973
  4974     IF PINDX = 1
  4975         MOVE PI-PREV-FILE-SEQ-NO
  4976                                 TO  PI-FRST-FILE-SEQ-NO
  4977         MOVE PI-PREV-RECORD-TYPE
  4978                                 TO  PI-FRST-RECORD-TYPE
  4979         MOVE PI-PREV-FILE-SEQ-NO
  4980                                 TO  PI-LAST-FILE-SEQ-NO
  4981         MOVE PI-PREV-RECORD-TYPE
  4982                                 TO  PI-LAST-RECORD-TYPE.
  4983
  4984     SET NDX                     TO  PINDX.
  4985     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4986
  4987     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4988
  4989     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4990     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4991     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4992     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4993     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4994
  4995     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4996
  4997     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4998         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4999     ELSE
  5000         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  5001
  5002     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  5003                                     PI-REC-TYPE (NDX).
  5004
  5005     IF PY-VOID-SW NOT = SPACE
  5006         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  5007
  5008     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5009         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5010     ELSE
  5011         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5012                                     PREV-BIN-MAINT-DT
  5013         MOVE SPACE              TO  DC-OPTION-CODE
  5014         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5015* DAN    MOVE DC-GREG-DATE-1-EDIT
  5016         MOVE DC-GREG-DATE-1-MDY
  5017                                 TO  MDTE (PINDX)
  5018                                     PREV-MAINT-DT.
  5019
  5020*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5021     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5022         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5023         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5024*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5025*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 102
* EL633.cbl
  5026     END-IF.
  5027
  5028     IF PY-BILLED-DATE NOT = LOW-VALUES
  5029         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5030                                     AMT-ATTRB (PINDX)
  5031                                     VOID-SW-ATTRB (PINDX)
  5032         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5033             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5034         ELSE
  5035             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5036                                     PREV-BIN-BL-DT
  5037             MOVE SPACE          TO  DC-OPTION-CODE
  5038             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5039* DAN        MOVE DC-GREG-DATE-1-EDIT
  5040             MOVE DC-GREG-DATE-1-MDY
  5041                                 TO  BDTE (PINDX)
  5042                                     PREV-BL-DT.
  5043
  5044     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5045         NEXT SENTENCE
  5046     ELSE
  5047         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5048                                     AMT-ATTRB     (PINDX).
  5049
  5050     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5051         MOVE PY-CREDIT-SELECT-DT
  5052                                 TO  DC-BIN-DATE-1
  5053         MOVE SPACE              TO  DC-OPTION-CODE
  5054         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5055
  5056         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5057         MOVE WS-GS-MM             TO  WS-SS-MM
  5058         MOVE WS-GS-DD             TO  WS-SS-DD
  5059         MOVE WS-GS-YY             TO  WS-SS-YY
  5060         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5061     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5062        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5063         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5064                                    AMT-ATTRB      (PINDX)
  5065                                    GL-ACCT-ATTRB  (PINDX)
  5066                                    GL-COMM-ATTRB  (PINDX)
  5067                                    VOID-SW-ATTRB  (PINDX)
  5068                                    GL-STATE-ATTRB (PINDX)
  5069                                    GL-CANC-ATTRB  (PINDX)
  5070                                    SDTE-ATTRB     (PINDX)
  5071
  5072     END-IF
  5073
  5074*    GO TO 6010-READ-NEXT.
  5075     GO TO 6200-EXIT.
  5076
  5077 6100-END-OF-FILE.
  5078     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5079
  5080     IF PINDX  IS LESS THAN  12
  5081         SET PINDX  UP  BY  1
  5082         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5083         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 103
* EL633.cbl
  5084         SET PINDX  UP  BY  1
  5085         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5086         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5087         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5088     ELSE
  5089         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5090         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5091         SET PINDX  UP  BY  1
  5092         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5093         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5094
  5095 6200-EXIT.
  5096     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 104
* EL633.cbl
  5098 7000-PYAJ-FILE-NOTOPEN.
  5099     MOVE -1                     TO  MAINTL.
  5100     MOVE ER-2232                TO  EMI-ERROR.
  5101
  5102     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5103
  5104     GO TO 8200-SEND-DATAONLY.
  5105
  5106 7100-COMP-FILE-NOTOPEN.
  5107     MOVE -1                     TO  MAINTL.
  5108     MOVE ER-2233                TO  EMI-ERROR.
  5109
  5110     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5111
  5112     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 105
* EL633.cbl
  5114*
  5115*7100-COFA-FILE-NOTOPEN.
  5116*    MOVE -1                     TO PFENTERL.
  5117*    MOVE ER-2959                TO EMI-ERROR.
  5118*    PERFORM 9900-ERROR-FORMAT THRU
  5119*            9900-EXIT.
  5120*    GO TO 8200-SEND-DATAONLY.
  5121*
  5122 8100-SEND-INITIAL-MAP.
  5123     MOVE WS-CURRENT-DT          TO  DATEO.
  5124     MOVE EIBTIME                TO  TIME-IN.
  5125     MOVE TIME-OUT               TO  TIMEO.
  5126     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5127     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5128     MOVE -1                     TO  MAINTL.
  5129     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5130     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5131
  5132     IF EIBTRNID = TRANS-ID
  5133       OR EL640-TRANS-ID
  5134       OR EL642-TRANS-ID
  5135       OR EL652-TRANS-ID
  5136       OR EL6331-TRANS-ID
  5137         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5138             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5139             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5140             MOVE PI-SAV-GROUPING  TO  GROUPO
  5141             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5142             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5143             MOVE AL-UANON         TO  MAINTA
  5144                                       CARRIERA
  5145                                       GROUPA
  5146                                       FINRESPA
  5147                                       ACCTA
  5148         ELSE
  5149             NEXT SENTENCE.
  5150
  5151
  5152* EXEC CICS SEND
  5153*        MAP     (MAP-NAME)
  5154*        MAPSET  (MAPSET-NAME)
  5155*        FROM    (EL633AO)
  5156*        ERASE
  5157*        CURSOR
  5158*        END-EXEC.
  5159     MOVE LENGTH OF
  5160      EL633AO
  5161       TO DFHEIV12
  5162     MOVE -1
  5163       TO DFHEIV11
  5164*    MOVE '8$     CT  E    H L F ,   #00004696' TO DFHEIV0
  5165     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5166     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5167     MOVE X'2020233030303034363936' TO DFHEIV0(25:11)
  5168     CALL 'kxdfhei1' USING DFHEIV0,
  5169           MAP-NAME,
  5170           EL633AO,
  5171           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 106
* EL633.cbl
  5172           MAPSET-NAME,
  5173           DFHEIV99,
  5174           DFHEIV99,
  5175           DFHEIV99,
  5176           DFHEIV11,
  5177           DFHEIV99,
  5178           DFHEIV99,
  5179           DFHEIV99
  5180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5181
  5182
  5183     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 107
* EL633.cbl
  5185 8200-SEND-DATAONLY.
  5186     MOVE WS-CURRENT-DT          TO  DATEO.
  5187     MOVE EIBTIME                TO  TIME-IN.
  5188     MOVE TIME-OUT               TO  TIMEO.
  5189     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5190     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5191     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5192     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5193
  5194
  5195* EXEC CICS SEND
  5196*        MAP     (MAP-NAME)
  5197*        MAPSET  (MAPSET-NAME)
  5198*        FROM    (EL633AO)
  5199*        DATAONLY
  5200*        CURSOR
  5201*    END-EXEC.
  5202     MOVE LENGTH OF
  5203      EL633AO
  5204       TO DFHEIV12
  5205     MOVE -1
  5206       TO DFHEIV11
  5207*    MOVE '8$D    CT       H L F ,   #00004715' TO DFHEIV0
  5208     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5209     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5210     MOVE X'2020233030303034373135' TO DFHEIV0(25:11)
  5211     CALL 'kxdfhei1' USING DFHEIV0,
  5212           MAP-NAME,
  5213           EL633AO,
  5214           DFHEIV12,
  5215           MAPSET-NAME,
  5216           DFHEIV99,
  5217           DFHEIV99,
  5218           DFHEIV99,
  5219           DFHEIV11,
  5220           DFHEIV99,
  5221           DFHEIV99,
  5222           DFHEIV99
  5223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5224
  5225
  5226     GO TO 9100-RETURN-TRAN.
  5227
  5228 8300-SEND-TEXT.
  5229
  5230* EXEC CICS SEND TEXT
  5231*        FROM    (LOGOFF-TEXT)
  5232*        LENGTH  (LOGOFF-LENGTH)
  5233*        ERASE
  5234*        FREEKB
  5235*    END-EXEC.
  5236*    MOVE '8&      T  E F  H   F -   #00004726' TO DFHEIV0
  5237     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5238     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5239     MOVE X'2020233030303034373236' TO DFHEIV0(25:11)
  5240     CALL 'kxdfhei1' USING DFHEIV0,
  5241           LOGOFF-TEXT,
  5242           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 108
* EL633.cbl
  5243           DFHEIV99,
  5244           DFHEIV99,
  5245           DFHEIV99,
  5246           DFHEIV99,
  5247           DFHEIV99,
  5248           DFHEIV99,
  5249           DFHEIV99,
  5250           DFHEIV99,
  5251           DFHEIV99,
  5252           DFHEIV99
  5253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5254
  5255
  5256
  5257* EXEC CICS RETURN
  5258*    END-EXEC.
  5259*    MOVE '.(                    ''   #00004733' TO DFHEIV0
  5260     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5261     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5262     MOVE X'2020233030303034373333' TO DFHEIV0(25:11)
  5263     CALL 'kxdfhei1' USING DFHEIV0,
  5264           DFHEIV99,
  5265           DFHEIV99,
  5266           DFHEIV99,
  5267           DFHEIV99,
  5268           DFHEIV99,
  5269           DFHEIV99
  5270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5271
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 109
* EL633.cbl
  5273 8400-LOG-JOURNAL-RECORD.
  5274*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5275*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5276
  5277*    EXEC CICS JOURNAL
  5278*        JFILEID  (PI-JOURNAL-FILE-ID)
  5279*        JTYPEID  ('EL')
  5280*        FROM     (JOURNAL-RECORD)
  5281*        LENGTH   (223)
  5282*        END-EXEC.
  5283
  5284 8500-DATE-CONVERT.
  5285
  5286* EXEC CICS LINK
  5287*        PROGRAM   (LINK-CLDATCV)
  5288*        COMMAREA  (DATE-CONVERSION-DATA)
  5289*        LENGTH    (DC-COMM-LENGTH)
  5290*    END-EXEC.
  5291*    MOVE '."C                   (   #00004748' TO DFHEIV0
  5292     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5293     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5294     MOVE X'2020233030303034373438' TO DFHEIV0(25:11)
  5295     CALL 'kxdfhei1' USING DFHEIV0,
  5296           LINK-CLDATCV,
  5297           DATE-CONVERSION-DATA,
  5298           DC-COMM-LENGTH,
  5299           DFHEIV99,
  5300           DFHEIV99,
  5301           DFHEIV99,
  5302           DFHEIV99
  5303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5304
  5305
  5306 8500-EXIT.
  5307     EXIT.
  5308
  5309 8600-DEEDIT.
  5310
  5311* EXEC CICS BIF DEEDIT
  5312*        FIELD   (DEEDIT-FIELD)
  5313*        LENGTH  (11)
  5314*    END-EXEC.
  5315     MOVE 11
  5316       TO DFHEIV11
  5317*    MOVE '@"L                   #   #00004758' TO DFHEIV0
  5318     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5319     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5320     MOVE X'2020233030303034373538' TO DFHEIV0(25:11)
  5321     CALL 'kxdfhei1' USING DFHEIV0,
  5322           DEEDIT-FIELD,
  5323           DFHEIV11
  5324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5325
  5326
  5327 8600-EXIT.
  5328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 110
* EL633.cbl
  5330 8800-UNAUTHORIZED-ACCESS.
  5331     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5332
  5333     GO TO 8300-SEND-TEXT.
  5334
  5335 8810-PF23.
  5336     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5337     MOVE XCTL-005               TO  PGM-NAME.
  5338
  5339     GO TO 9300-XCTL.
  5340
  5341 9100-RETURN-TRAN.
  5342     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5343     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5344
  5345
  5346* EXEC CICS RETURN
  5347*        TRANSID   (TRANS-ID)
  5348*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5349*        LENGTH    (PI-COMM-LENGTH)
  5350*    END-EXEC.
  5351*    MOVE '.(CT                  ''   #00004781' TO DFHEIV0
  5352     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5353     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5354     MOVE X'2020233030303034373831' TO DFHEIV0(25:11)
  5355     CALL 'kxdfhei1' USING DFHEIV0,
  5356           TRANS-ID,
  5357           PROGRAM-INTERFACE-BLOCK,
  5358           PI-COMM-LENGTH,
  5359           DFHEIV99,
  5360           DFHEIV99,
  5361           DFHEIV99
  5362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5363
  5364
  5365 9200-RETURN-MAIN-MENU.
  5366     MOVE XCTL-626               TO  PGM-NAME.
  5367
  5368     GO TO 9300-XCTL.
  5369
  5370 9300-XCTL.
  5371
  5372* EXEC CICS XCTL
  5373*        PROGRAM   (PGM-NAME)
  5374*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5375*        LENGTH    (PI-COMM-LENGTH)
  5376*    END-EXEC.
  5377*    MOVE '.$C                   %   #00004793' TO DFHEIV0
  5378     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5379     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5380     MOVE X'2020233030303034373933' TO DFHEIV0(25:11)
  5381     CALL 'kxdfhei1' USING DFHEIV0,
  5382           PGM-NAME,
  5383           PROGRAM-INTERFACE-BLOCK,
  5384           PI-COMM-LENGTH,
  5385           DFHEIV99
  5386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5387
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 111
* EL633.cbl
  5388
  5389 9400-CLEAR.
  5390     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5391
  5392     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5393     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5394                                     PI-SAV-COMP-CONTROL.
  5395
  5396     GO TO 9300-XCTL.
  5397
  5398 9500-PF12.
  5399     MOVE XCTL-010               TO  PGM-NAME.
  5400
  5401     GO TO 9300-XCTL.
  5402
  5403 9600-PGMID-ERROR.
  5404
  5405* EXEC CICS HANDLE CONDITION
  5406*        PGMIDERR  (8300-SEND-TEXT)
  5407*    END-EXEC.
  5408*    MOVE '"$L                   ! + #00004814' TO DFHEIV0
  5409     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5411     MOVE X'2B20233030303034383134' TO DFHEIV0(25:11)
  5412     CALL 'kxdfhei1' USING DFHEIV0
  5413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5414
  5415
  5416     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5417     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5418     MOVE XCTL-005               TO  PGM-NAME.
  5419     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5420     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5421
  5422     GO TO 9300-XCTL.
  5423
  5424 9900-ERROR-FORMAT.
  5425     IF NOT EMI-ERRORS-COMPLETE
  5426         MOVE LINK-001           TO  PGM-NAME
  5427
  5428* EXEC CICS LINK
  5429*            PROGRAM   (PGM-NAME)
  5430*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5431*            LENGTH    (EMI-COMM-LENGTH)
  5432*        END-EXEC.
  5433*    MOVE '."C                   (   #00004829' TO DFHEIV0
  5434     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5436     MOVE X'2020233030303034383239' TO DFHEIV0(25:11)
  5437     CALL 'kxdfhei1' USING DFHEIV0,
  5438           PGM-NAME,
  5439           ERROR-MESSAGE-INTERFACE-BLOCK,
  5440           EMI-COMM-LENGTH,
  5441           DFHEIV99,
  5442           DFHEIV99,
  5443           DFHEIV99,
  5444           DFHEIV99
  5445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 112
* EL633.cbl
  5446
  5447
  5448 9900-EXIT.
  5449     EXIT.
  5450
  5451 9990-ABEND.
  5452     MOVE LINK-004               TO  PGM-NAME.
  5453     MOVE DFHEIBLK               TO  EMI-LINE1.
  5454
  5455
  5456* EXEC CICS LINK
  5457*        PROGRAM   (PGM-NAME)
  5458*        COMMAREA  (EMI-LINE1)
  5459*        LENGTH    (72)
  5460*    END-EXEC.
  5461     MOVE 72
  5462       TO DFHEIV11
  5463*    MOVE '."C                   (   #00004842' TO DFHEIV0
  5464     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5465     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5466     MOVE X'2020233030303034383432' TO DFHEIV0(25:11)
  5467     CALL 'kxdfhei1' USING DFHEIV0,
  5468           PGM-NAME,
  5469           EMI-LINE1,
  5470           DFHEIV11,
  5471           DFHEIV99,
  5472           DFHEIV99,
  5473           DFHEIV99,
  5474           DFHEIV99
  5475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5476
  5477
  5478     MOVE -1                     TO  PFENTERL.
  5479
  5480     GO TO 8200-SEND-DATAONLY.
  5481
  5482 9995-SECURITY-VIOLATION.
  5483*                            COPY ELCSCTP.
  5484******************************************************************
  5485*                                                                *
  5486*                            ELCSCTP                             *
  5487*                            VMOD=2.001                          *
  5488*                                                                *
  5489*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5490******************************************************************
  5491
  5492
  5493     MOVE EIBDATE          TO SM-JUL-DATE.
  5494     MOVE EIBTRMID         TO SM-TERMID.
  5495     MOVE THIS-PGM         TO SM-PGM.
  5496     MOVE EIBTIME          TO TIME-IN.
  5497     MOVE TIME-OUT         TO SM-TIME.
  5498     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5499
  5500
  5501* EXEC CICS LINK
  5502*         PROGRAM  ('EL003')
  5503*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 113
* EL633.cbl
  5504*         LENGTH   (80)
  5505*    END-EXEC.
  5506     MOVE 'EL003' TO DFHEIV1
  5507     MOVE 80
  5508       TO DFHEIV11
  5509*    MOVE '."C                   (   #00004870' TO DFHEIV0
  5510     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5511     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5512     MOVE X'2020233030303034383730' TO DFHEIV0(25:11)
  5513     CALL 'kxdfhei1' USING DFHEIV0,
  5514           DFHEIV1,
  5515           SECURITY-MESSAGE,
  5516           DFHEIV11,
  5517           DFHEIV99,
  5518           DFHEIV99,
  5519           DFHEIV99,
  5520           DFHEIV99
  5521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5522
  5523
  5524******************************************************************
  5525
  5526
  5527 9995-EXIT.
  5528     EXIT.
  5529
  5530
  5531 9999-DFHBACK SECTION.
  5532     MOVE '9%                    "   ' TO DFHEIV0
  5533     MOVE 'EL633' TO DFHEIV1
  5534     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5535     GOBACK.
  5536 9999-DFHEXIT.
  5537     IF DFHEIGDJ EQUAL 0001
  5538         NEXT SENTENCE
  5539     ELSE IF DFHEIGDJ EQUAL 2
  5540         GO TO 9600-PGMID-ERROR,
  5541               9990-ABEND
  5542         DEPENDING ON DFHEIGDI
  5543     ELSE IF DFHEIGDJ EQUAL 3
  5544         GO TO 0410-NO-COMP-MSTR,
  5545               7100-COMP-FILE-NOTOPEN
  5546         DEPENDING ON DFHEIGDI
  5547     ELSE IF DFHEIGDJ EQUAL 4
  5548         GO TO 0890-EXIT
  5549         DEPENDING ON DFHEIGDI
  5550     ELSE IF DFHEIGDJ EQUAL 5
  5551         GO TO 2110-ADD-RECORD
  5552         DEPENDING ON DFHEIGDI
  5553     ELSE IF DFHEIGDJ EQUAL 6
  5554         GO TO 2120-DELETE-CONT
  5555         DEPENDING ON DFHEIGDI
  5556     ELSE IF DFHEIGDJ EQUAL 7
  5557         GO TO 2190-DUP-RECORD
  5558         DEPENDING ON DFHEIGDI
  5559     ELSE IF DFHEIGDJ EQUAL 8
  5560         GO TO 5010-NOT-OPEN,
  5561               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 25-Feb-16 11:09 Page 114
* EL633.cbl
  5562               5020-NO-RECORDS
  5563         DEPENDING ON DFHEIGDI
  5564     ELSE IF DFHEIGDJ EQUAL 9
  5565         GO TO 5110-END-OF-FILE,
  5566               5110-END-OF-FILE
  5567         DEPENDING ON DFHEIGDI
  5568     ELSE IF DFHEIGDJ EQUAL 10
  5569         GO TO 6100-END-OF-FILE,
  5570               6100-END-OF-FILE
  5571         DEPENDING ON DFHEIGDI
  5572     ELSE IF DFHEIGDJ EQUAL 11
  5573         GO TO 8300-SEND-TEXT
  5574         DEPENDING ON DFHEIGDI.
  5575     MOVE '9%                    "   ' TO DFHEIV0
  5576     MOVE 'EL633' TO DFHEIV1
  5577     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5578     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5640     Code:       16884
