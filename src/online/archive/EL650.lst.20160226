* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL650.cbl
* Options: int("EL650.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL650.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL650.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL650.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL650 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 14:53:46.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.048.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL650.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC4 - ACCOUNT MASTER MAINTENANCE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL650AI FILLER
    38* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    39* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    40*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    41* 121207  CR2007121100001  PEMA  SPACE OUT ORIG DLR NO ON COPY
    42* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    43* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    44* 111513  IR2013110500003  PEMA  CORRECT MAINT FUNC OF "N"
    45* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    46******************************************************************
    47
    48 ENVIRONMENT DIVISION.
    49 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL650.cbl
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53 77  FILLER  PIC  X(32) VALUE '********************************'.
    54 77  FILLER  PIC  X(32) VALUE '*    EL650 WORKING STORAGE     *'.
    55 77  FILLER  PIC  X(32) VALUE '********* VMOD=2.048 ***********'.
    56 77  d1                      pic s999 value +0 comp-3.
    57
    58 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1500.
    59
    60 01  ws-display-eff-date     pic x(10) value spaces.
    61 01  ws-display-exp-date     pic x(10) value spaces.
    62 01  WS-DATE-AREA.
    63     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    64     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    65
    66 01  STANDARD-AREAS.
    67     12  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    68     12  MAP-NAME                PIC  X(8)   VALUE 'EL650A'.
    69     12  MAPSET-NAME             PIC  X(8)   VALUE 'EL650S'.
    70     12  SCREEN-NUMBER           PIC  X(4)   VALUE '650A'.
    71     12  TRANS-ID                PIC  X(4)   VALUE 'EXC4'.
    72     12  EL6311-TRANS-ID         PIC  X(4)   VALUE 'EXB1'.
    73     12  EL1273-TRANS-ID         PIC  X(4)   VALUE 'EXX3'.
    74     12  EL652-TRANS-ID          PIC  X(4)   VALUE 'EXD4'.
    75     12  EL6523-TRANS-ID         PIC  X(4)   VALUE 'EXDD'.
    76     12  EL6311NC-TRANS-ID       PIC  X(4)   VALUE 'NXB1'.
    77     12  EL640-TRANS-ID          PIC  X(4)   VALUE 'EXC1'.
    78     12  EL658-TRANS-ID          PIC  X(4)   VALUE 'EXJ3'.
    79     12  EL130-TRANS-ID          PIC  X(4)   VALUE 'EX19'.
    80     12  EL6503-TRANS-ID         PIC  X(4)   VALUE 'EXC7'.
    81     12  EL6509-TRANS-ID         PIC  X(4)   VALUE 'EXDA'.
    82     12  EL6592-TRANS-ID         PIC  X(4)   VALUE 'EX66'.
    83     12  EL608-TRANS-ID          PIC  X(4)   VALUE 'EX1E'.
    84     12  THIS-PGM                PIC  X(8)   VALUE 'EL650'.
    85     12  PGM-NAME                PIC  X(8).
    86     12  RETURNED-FROM           PIC  X(8)   VALUE SPACES.
    87     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
    88     12  TIME-OUT-R  REDEFINES  TIME-IN.
    89         16  FILLER              PIC  X.
    90         16  TIME-OUT            PIC  99V99.
    91         16  FILLER              PIC  XX.
    92     12  XCTL-005                PIC  X(8)   VALUE 'EL005'.
    93     12  XCTL-010                PIC  X(8)   VALUE 'EL010'.
    94     12  XCTL-126                PIC  X(8)   VALUE 'EL126'.
    95     12  XCTL-EL601              PIC  X(8)   VALUE 'EL601 '.
    96     12  XCTL-6501               PIC  X(8)   VALUE 'EL6501'.
    97     12  XCTL-6502               PIC  X(8)   VALUE 'EL6502'.
    98     12  XCTL-6503               PIC  X(8)   VALUE 'EL6503'.
    99     12  XCTL-6504               PIC  X(8)   VALUE 'EL6504'.
   100     12  XCTL-6505               PIC  X(8)   VALUE 'EL6505'.
   101     12  XCTL-6506               PIC  X(8)   VALUE 'EL6506'.
   102     12  XCTL-6508               PIC  X(8)   VALUE 'EL6508'.
   103     12  XCTL-6509               PIC  X(8)   VALUE 'EL6509'.
   104     12  LINK-001                PIC  X(8)   VALUE 'EL001'.
   105     12  LINK-004                PIC  X(8)   VALUE 'EL004'.
   106     12  LINK-ELDATCV            PIC  X(8)   VALUE 'ELDATCV'.
   107     12  FILE-ID                 PIC  X(8)   VALUE SPACES.
   108     12  CNTL-FILE-ID            PIC  X(8)   VALUE 'ELCNTL'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL650.cbl
   109     12  ACCT-FILE-ID            PIC  X(8)   VALUE 'ERACCT'.
   110     12  COMP-FILE-ID            PIC  X(8)   VALUE 'ERCOMP'.
   111     12  NAME-FILE-ID            PIC  X(8)   VALUE 'ERNAME'.
   112     12  PEND2-FILE-ID           PIC  X(8)   VALUE 'ERPNDB2'.
   113     12  PLAN-FILE-ID            PIC  X(8)   VALUE 'ERPLAN'.
   114     12  ACCT2-FILE-ID           PIC  X(8)   VALUE 'ERACCT2'.
   115     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   116     12  PLAN-REC-LEN            PIC S9(4)   VALUE +420   COMP.
   117     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   118     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   119     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   120     12  ERGXRF-FILE-ID          PIC  X(8)   VALUE 'ERGXRF'.
   121     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   122     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   123     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   124     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   125     12  BIN-MIN-DATE            PIC  XX     VALUE LOW-VALUES.
   126     12  BIN-MAX-DATE            PIC  XX     VALUE LOW-VALUES.
   127     12  B4-ACCT-KEY.
   128         16  B4-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   129         16  B4-ACCT-CARRIER     PIC  X      VALUE SPACES.
   130         16  B4-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   131         16  B4-ACCT-STATE       PIC  XX     VALUE SPACES.
   132         16  B4-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   133         16  B4-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   134         16  B4-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   135     12  AF-ACCT-KEY.
   136         16  AF-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   137         16  AF-ACCT-CARRIER     PIC  X      VALUE SPACES.
   138         16  AF-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   139         16  AF-ACCT-STATE       PIC  XX     VALUE SPACES.
   140         16  AF-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   141         16  AF-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   142         16  AF-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   143     12  GX-AM-CONTROL-PRIMARY.
   144         16  GX-AM-COMPANY-CD    PIC  X      VALUE LOW-VALUES.
   145         16  GX-REST-OF-KEY      PIC  X(21)  VALUE SPACES.
   146         16  GX-AM-CNTL-FILLER   PIC  X(4)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL650.cbl
   148*                                copy ERCGXRF.
   149******************************************************************
   150*                                                                *
   151*                                                                *
   152*                            ERCGXRF                             *
   153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   154*                            VMOD=2.002                          *
   155*                                                                *
   156*   ONLINE CREDIT SYSTEM                                         *
   157*                                                                *
   158*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   159*                                                                *
   160*   FILE TYPE = VSAM,KSDS                                        *
   161*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   162*                                                                *
   163*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   164*       ALTERNATE PATH = NONE                                    *
   165*                                                                *
   166*   LOG = NO                                                     *
   167*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   168*                                                                *
   169******************************************************************
   170
   171 01  AGENT-CROSS-REFERENCE.
   172     12  GX-RECORD-ID                PIC XX.
   173         88  VALID-GX-ID             VALUE 'GX'.
   174
   175     12  GX-CONTROL-PRIMARY.
   176         16  GX-COMPANY-CD           PIC X.
   177         16  GX-CARRIER              PIC X.
   178         16  GX-GROUPING             PIC X(6).
   179         16  GX-AGENT-NO             PIC X(10).
   180
   181     12  GX-MAINT-INFORMATION.
   182         16  GX-LAST-MAINT-DT        PIC XX.
   183         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   184         16  GX-LAST-MAINT-USER      PIC X(4).
   185         16  FILLER                  PIC X(9).
   186
   187     12  FILLER                      PIC X(37).
   188
   189     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   190
   191     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   192                            DEPENDING ON GX-AGENT-POINTER-CNT.
   193         16  GX-AM-CARRIER           PIC X.
   194         16  GX-AM-GROUPING          PIC X(6).
   195         16  GX-AM-STATE             PIC XX.
   196         16  GX-AM-ACCOUNT           PIC X(10).
   197         16  GX-AM-EXPIRATION-DT     PIC XX.
   198         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   199         16  GX-LAST-BILL-DT         PIC XX.
   200         16  GX-AM-EFF-DT            PIC XX.
   201         16  FILLER                  PIC X(4).
   202
   203******************************************************************
   204 01  WORK-AREAS-AND-SWITCHES.
   205     12  WS-PAGE-LINES               PIC  S99    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL650.cbl
   206     12  WS-ACCT2-FOUND              PIC  X      VALUE 'N'.
   207     12  GETMAIN-SW                  PIC  X      VALUE SPACES.
   208     12  NEW-KEY-SAVE.
   209         16  NEW-KEY-COMPANY-CD      PIC  X      VALUE LOW-VALUES.
   210         16  NEW-KEY-CNTRL           PIC  X(19)  VALUE SPACES.
   211     12  WS-PLAN-KEY.
   212         16  EK-CCGSA-KEY.
   213           18  EK-COMPANY-CD         PIC  X     VALUE LOW-VALUES.
   214           18  EK-CARRIER            PIC  X     VALUE SPACES.
   215           18  EK-GROUPING           PIC  X(6)  VALUE SPACES.
   216           18  EK-STATE              PIC  XX    VALUE SPACES.
   217           18  EK-ACCOUNT            PIC  X(10) VALUE SPACES.
   218         16  EK-BTYPE                PIC  X     VALUE SPACES.
   219         16  EK-BCODE                PIC  XX    VALUE SPACES.
   220         16  EK-REVISION             PIC  XXX   VALUE SPACES.
   221     12  WS-EXP-SAVE                 PIC  XX    VALUE LOW-VALUES.
   222     12  CURRENT-SAVE                PIC  X(6)  VALUE SPACES.
   223     12  SAVE-ACCT-KEY               PIC  X(26).
   224     12  SAVE-CURR-EXP-DT            PIC  XX    VALUE LOW-VALUES.
   225     12  SAVE-CURR-EFF-DT            PIC  XX    VALUE LOW-VALUES.
   226     12  WS-EFFCHG-SAVE              PIC  9(11) VALUE ZEROS.
   227     12  WS-EXPCHG-SAVE              PIC  9(11) VALUE ZEROS.
   228     12  BIN-CURRENT-SAVE            PIC  XX    VALUE LOW-VALUES.
   229     12  WS-VERIFY-AREA.
   230         16  FILLER      OCCURS  33  TIMES
   231                             INDEXED  BY  WS-INDEX.
   232             20  WS-ACCT-KEY         PIC  X(20).
   233             20  WS-ACCT-EXP-DT      PIC  XX.
   234             20  WS-ACCT-EFF-DT      PIC  XX.
   235             20  WS-ACCT-HI-CERT     PIC  XX.
   236             20  WS-ACCT-LO-CERT     PIC  XX.
   237     12  WS-TEST-KEY                 PIC  X(20)  VALUE SPACES.
   238     12  WS-SAVE-VERIFY-KEY          PIC  X(20)  VALUE SPACES.
   239     12  WS-ACCT-VERIFY-KEY.
   240         16  WS-ACCT-VER-COMP-CD     PIC  X      VALUE LOW-VALUES.
   241         16  WS-ACCT-VER-CARR        PIC  X      VALUE SPACES.
   242         16  WS-ACCT-VER-GROUP       PIC  X(6)   VALUE SPACES.
   243         16  WS-ACCT-VER-STATE       PIC  XX     VALUE SPACES.
   244         16  WS-ACCT-VER-ACCOUNT     PIC  X(10)  VALUE SPACES.
   245         16  WS-ACCT-VER-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   246     12  filler                      pic x(10)   value spaces.
   247     12  KEY-SAVE.
   248         16  SV-CO                   PIC  X      VALUE LOW-VALUES.
   249         16  SV-CARRIER              PIC  X      VALUE SPACES.
   250         16  SV-GROUPING             PIC  X(6)   VALUE SPACES.
   251         16  SV-STATE                PIC  XX     VALUE SPACES.
   252         16  SV-ACCOUNT              PIC  X(10)  VALUE SPACES.
   253
   254     12  WS-DEEDIT-FIELD              PIC X(10)  VALUE SPACES.
   255     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   256                                      PIC X(10).
   257     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   258         16  FILLER                   PIC X(4).
   259         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   260
   261     12  WS-AXRF-KEY.
   262         16  WS-AXRF-COMPANY-CD      PIC  X     VALUE LOW-VALUES.
   263         16  WS-AXRF-CARRIER         PIC  X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL650.cbl
   264         16  WS-AXRF-GROUPING        PIC  X(6)  VALUE SPACES.
   265         16  WS-AXRF-AGENT-NO        PIC  X(10) VALUE SPACES.
   266     12  AXRF-SUB                    PIC S9(4) COMP VALUE +0.
   267     12  GX-AGENT-SUB                PIC S9(4) COMP VALUE +0.
   268     12  COMM-WORK-SUB               PIC S9(4) COMP VALUE +0.
   269     12  COMM-WORK-SUB2              PIC S9(4) COMP VALUE +0.
   270     12  ELCNTL-KEY.
   271         16  CNTL-COMP-ID            PIC  X(3) VALUE SPACES.
   272         16  CNTL-REC-TYPE           PIC  X    VALUE SPACES.
   273         16  CNTL-ACCESS.
   274             20  CNTL-STATE          PIC  XX   VALUE SPACES.
   275             20  FILLER              PIC  X    VALUE SPACES.
   276             20  CNTL-CARRIER        PIC  X    VALUE SPACES.
   277         16  CNTL-SEQ-NO             PIC S9(4) COMP VALUE +0.
   278     12  ERPNDB-KEY.
   279         16  PNDB-COMPANY-CD-A1      PIC  X  VALUE LOW-VALUES.
   280         16  PNDB-CARRIER            PIC  X    VALUE SPACES.
   281         16  PNDB-GROUPING           PIC  X(6) VALUE SPACES.
   282         16  PNDB-STATE              PIC  XX   VALUE SPACES.
   283         16  PNDB-ACCOUNT            PIC  X(10) VALUE SPACES.
   284         16  PNDB-CERT-EFF-DT        PIC  XX    VALUE LOW-VALUES.
   285         16  PNDB-CERT-NO            PIC  X(11) VALUE SPACES.
   286         16  PNDB-ALT-CHG-SEQ-NO     PIC S9(4)   COMP VALUE +0.
   287         16  PNDB-RECORD-TYPE        PIC  X   VALUE SPACES.
   288     12  REC-SW                      PIC  9          VALUE 0.
   289         88  REC-FOUND                               VALUE 1.
   290     12  K-WITH-LINE-USED            PIC  9          VALUE 0.
   291         88  K-WITH-LINE-NO                          VALUE 1.
   292     12  RETURN-FROM-SW              PIC  9          VALUE 0.
   293         88  RETURNING-FROM-6501                     VALUE 1.
   294     12  BROWSE-STARTED-SW           PIC  X          VALUE ' '.
   295         88  BROWSE-STARTED                          VALUE 'Y'.
   296     12  FIRST-TIME-SW               PIC  X          VALUE ' '.
   297         88  FIRST-TIME                              VALUE 'Y'.
   298     12  FROM-WHERE-SW               PIC  X          VALUE ' '.
   299         88  FROM-DELETE                             VALUE '1'.
   300         88  FROM-CHANGE                             VALUE '2'.
   301     12  FROM-EL608-SW               PIC  X          VALUE 'N'.
   302     12  PENDING-BUSINESS-SW         PIC  X          VALUE 'N'.
   303         88  THERE-IS-PENDING-BUSINESS               VALUE 'Y'.
   304     12  PENDING-BROWSE-SW           PIC  X          VALUE 'N'.
   305         88  PENDING-BROWSE-STARTED                  VALUE 'Y'.
   306     12  TS-QUEUE.
   307         16  TS-SCREEN               PIC  X(4)   VALUE SPACES.
   308         16  TS-TERM                 PIC  X(4)   VALUE SPACES.
   309     12  TS-LENGTH                   PIC S9(4) COMP VALUE +640.
   310     12  TS-ITEM                     PIC S9(4) COMP VALUE +0.
   311     12  AGT-SUB                     PIC 99      VALUE ZEROS.
   312     12  VALID-AGT-SW                PIC X       VALUE 'N'.
   313
   314 01  ERROR-MESSAGES.
   315     12  ER-0000             PIC  X(4)       VALUE '0000'.
   316     12  ER-0004             PIC  X(4)       VALUE '0004'.
   317     12  ER-0008             PIC  X(4)       VALUE '0008'.
   318     12  ER-0022             PIC  X(4)       VALUE '0022'.
   319     12  ER-0023             PIC  X(4)       VALUE '0023'.
   320     12  ER-0029             PIC  X(4)       VALUE '0029'.
   321     12  ER-0042             PIC  X(4)       VALUE '0042'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL650.cbl
   322     12  ER-0050             PIC  X(4)       VALUE '0050'.
   323     12  ER-0052             PIC  X(4)       VALUE '0052'.
   324     12  ER-0066             PIC  X(4)       VALUE '0066'.
   325     12  ER-0067             PIC  X(4)       VALUE '0067'.
   326     12  ER-0070             PIC  X(4)       VALUE '0070'.
   327     12  ER-0144             PIC  X(4)       VALUE '0144'.
   328     12  ER-0168             PIC  X(4)       VALUE '0168'.
   329     12  ER-0193             PIC  X(4)       VALUE '0193'.
   330     12  ER-0195             PIC  X(4)       VALUE '0195'.
   331     12  ER-0216             PIC  X(4)       VALUE '0216'.
   332     12  ER-0226             PIC  X(4)       VALUE '0226'.
   333     12  ER-0348             PIC  X(4)       VALUE '0348'.
   334     12  ER-0453             PIC  X(4)       VALUE '0453'.
   335     12  ER-0454             PIC  X(4)       VALUE '0454'.
   336     12  ER-0455             PIC  X(4)       VALUE '0455'.
   337     12  ER-0456             PIC  X(4)       VALUE '0456'.
   338     12  ER-0457             PIC  X(4)       VALUE '0457'.
   339     12  ER-0470             PIC  X(4)       VALUE '0470'.
   340     12  ER-0471             PIC  X(4)       VALUE '0471'.
   341     12  ER-0472             PIC  X(4)       VALUE '0472'.
   342     12  ER-0482             PIC  X(4)       VALUE '0482'.
   343     12  ER-0561             PIC  X(4)       VALUE '0561'.
   344     12  ER-0619             PIC  X(4)       VALUE '0619'.
   345     12  ER-0630             PIC  X(4)       VALUE '0630'.
   346     12  ER-0668             PIC  X(4)       VALUE '0668'.
   347     12  ER-0899             PIC  X(4)       VALUE '0899'.
   348     12  ER-1220             PIC  X(4)       VALUE '1220'.
   349     12  ER-1228             PIC  X(4)       VALUE '1228'.
   350     12  ER-1238             PIC  X(4)       VALUE '1238'.
   351     12  ER-1299             PIC  X(4)       VALUE '1299'.
   352     12  ER-1612             PIC  X(4)       VALUE '1612'.
   353     12  ER-2051             PIC  X(4)       VALUE '2051'.
   354     12  ER-2052             PIC  X(4)       VALUE '2052'.
   355     12  ER-2053             PIC  X(4)       VALUE '2053'.
   356     12  ER-2054             PIC  X(4)       VALUE '2054'.
   357     12  ER-2058             PIC  X(4)       VALUE '2058'.
   358     12  ER-2059             PIC  X(4)       VALUE '2059'.
   359     12  ER-2060             PIC  X(4)       VALUE '2060'.
   360     12  ER-2061             PIC  X(4)       VALUE '2061'.
   361     12  ER-2062             PIC  X(4)       VALUE '2062'.
   362     12  ER-2063             PIC  X(4)       VALUE '2063'.
   363     12  ER-2064             PIC  X(4)       VALUE '2064'.
   364     12  ER-2065             PIC  X(4)       VALUE '2065'.
   365     12  ER-2066             PIC  X(4)       VALUE '2066'.
   366     12  ER-2068             PIC  X(4)       VALUE '2068'.
   367     12  ER-2069             PIC  X(4)       VALUE '2069'.
   368     12  ER-2070             PIC  X(4)       VALUE '2070'.
   369     12  ER-2072             PIC  X(4)       VALUE '2072'.
   370     12  ER-2073             PIC  X(4)       VALUE '2073'.
   371     12  ER-2074             PIC  X(4)       VALUE '2074'.
   372     12  ER-2075             PIC  X(4)       VALUE '2075'.
   373     12  ER-2087             PIC  X(4)       VALUE '2087'.
   374     12  ER-2113             PIC  X(4)       VALUE '2113'.
   375     12  ER-2151             PIC  X(4)       VALUE '2151'.
   376     12  ER-2370             PIC  X(4)       VALUE '2370'.
   377     12  ER-2572             PIC  X(4)       VALUE '2572'.
   378     12  ER-3155             PIC  X(4)       VALUE '3155'.
   379     12  ER-3785             PIC  X(4)       VALUE '3785'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL650.cbl
   380     12  ER-9638             PIC  X(4)       VALUE '9638'.
   381     12  ER-9999             PIC  X(4)       VALUE '9999'.
   382
   383 01  TEMP-STORAGE-RECORD.
   384     12  TS-ACCT-KEY     OCCURS  32  TIMES
   385                             INDEXED  BY  TS-INDEX
   386                                 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL650.cbl
   388*    COPY ELCSCTM.
   389******************************************************************
   390*                                                                *
   391*                                                                *
   392*                            ELCSCTM                             *
   393*                            VMOD=2.001                          *
   394*                                                                *
   395*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   396*                                                                *
   397******************************************************************
   398 01  SECURITY-MESSAGE.
   399     12  FILLER                          PIC X(30)
   400            VALUE '** LOGIC SECURITY VIOLATION -'.
   401     12  SM-READ                         PIC X(6).
   402     12  FILLER                          PIC X(5)
   403            VALUE ' PGM='.
   404     12  SM-PGM                          PIC X(6).
   405     12  FILLER                          PIC X(5)
   406            VALUE ' OPR='.
   407     12  SM-PROCESSOR-ID                 PIC X(4).
   408     12  FILLER                          PIC X(6)
   409            VALUE ' TERM='.
   410     12  SM-TERMID                       PIC X(4).
   411     12  FILLER                          PIC XX   VALUE SPACE.
   412     12  SM-JUL-DATE                     PIC 9(5).
   413     12  FILLER                          PIC X    VALUE SPACE.
   414     12  SM-TIME                         PIC 99.99.
   415
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL650.cbl
   417*    COPY ELCSCRTY.
   418******************************************************************
   419*                                                                *
   420*                                                                *
   421*                            ELCSCRTY                            *
   422*                            VMOD=2.001                          *
   423*                                                                *
   424*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   425*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   426*        SAVED IN PI-SECURITY-ADDRESS.                           *
   427*                                                                *
   428******************************************************************
   429 01  SECURITY-CONTROL.
   430     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   431     12  FILLER                       PIC XX    VALUE 'SC'.
   432     12  SC-CREDIT-CODES.
   433         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   434             20  SC-CREDIT-DISPLAY    PIC X.
   435             20  SC-CREDIT-UPDATE     PIC X.
   436     12  SC-CLAIMS-CODES.
   437         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   438             20  SC-CLAIMS-DISPLAY    PIC X.
   439             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL650.cbl
   441*    COPY ELCLOGOF.
   442******************************************************************
   443*                                                                *
   444*                                                                *
   445*                            ELCLOGOF.                           *
   446*                            VMOD=2.001                          *
   447*                                                                *
   448*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   449*                                                                *
   450******************************************************************
   451 01  CLASIC-LOGOFF.
   452     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   453     12  LOGOFF-TEXT.
   454         16  FILLER          PIC X(5)    VALUE SPACES.
   455         16  LOGOFF-MSG.
   456             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   457             20  FILLER      PIC X       VALUE SPACES.
   458             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   459         16  FILLER          PIC X(80)
   460           VALUE '* YOU ARE NOW LOGGED OFF'.
   461         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   462         16  FILLER          PIC X       VALUE QUOTE.
   463         16  LOGOFF-SYS-MSG  PIC X(17)
   464           VALUE 'S CLAS-IC SYSTEM '.
   465     12  TEXT-MESSAGES.
   466         16  UNACCESS-MSG    PIC X(29)
   467             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   468         16  PGMIDERR-MSG    PIC X(17)
   469             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL650.cbl
   471*    COPY ELCDATE.
   472******************************************************************
   473*                                                                *
   474*                                                                *
   475*                            ELCDATE.                            *
   476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   477*                            VMOD=2.003
   478*                                                                *
   479*                                                                *
   480*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   481*                 LENGTH = 200                                   *
   482******************************************************************
   483
   484 01  DATE-CONVERSION-DATA.
   485     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   486     12  DC-OPTION-CODE                PIC X.
   487         88  BIN-TO-GREG                VALUE ' '.
   488         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   489         88  EDIT-GREG-TO-BIN           VALUE '2'.
   490         88  YMD-GREG-TO-BIN            VALUE '3'.
   491         88  MDY-GREG-TO-BIN            VALUE '4'.
   492         88  JULIAN-TO-BIN              VALUE '5'.
   493         88  BIN-PLUS-ELAPSED           VALUE '6'.
   494         88  FIND-CENTURY               VALUE '7'.
   495         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   496         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   497         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   498         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   499         88  JULIAN-TO-BIN-3            VALUE 'C'.
   500         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   501         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   502         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   503         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   504         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   505         88  CHECK-LEAP-YEAR            VALUE 'H'.
   506         88  BIN-3-TO-GREG              VALUE 'I'.
   507         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   508         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   509         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   510         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   511         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   512         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   513         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   514         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   515         88  THREE-CHARACTER-BIN
   516                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   517         88  GREGORIAN-TO-BIN
   518                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   519         88  BIN-TO-GREGORIAN
   520                  VALUES ' ' '1' 'I' '8' 'G'.
   521         88  JULIAN-TO-BINARY
   522                  VALUES '5' 'C' 'E' 'F'.
   523     12  DC-ERROR-CODE                 PIC X.
   524         88  NO-CONVERSION-ERROR        VALUE ' '.
   525         88  DATE-CONVERSION-ERROR
   526                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   527         88  DATE-IS-ZERO               VALUE '1'.
   528         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL650.cbl
   529         88  DATE-IS-INVALID            VALUE '3'.
   530         88  DATE1-GREATER-DATE2        VALUE '4'.
   531         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   532         88  DATE-INVALID-OPTION        VALUE '9'.
   533         88  INVALID-CENTURY            VALUE 'A'.
   534         88  ONLY-CENTURY               VALUE 'B'.
   535         88  ONLY-LEAP-YEAR             VALUE 'C'.
   536         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   537     12  DC-END-OF-MONTH               PIC X.
   538         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   539     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   540         88  USE-NORMAL-PROCESS         VALUE ' '.
   541         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   542         88  ADJUST-UP-100-YRS          VALUE '2'.
   543     12  FILLER                        PIC X.
   544     12  DC-CONVERSION-DATES.
   545         16  DC-BIN-DATE-1             PIC XX.
   546         16  DC-BIN-DATE-2             PIC XX.
   547         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   548         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   549                       DC-GREG-DATE-1-EDIT.
   550             20  DC-EDIT1-MONTH        PIC 99.
   551             20  SLASH1-1              PIC X.
   552             20  DC-EDIT1-DAY          PIC 99.
   553             20  SLASH1-2              PIC X.
   554             20  DC-EDIT1-YEAR         PIC 99.
   555         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   556         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   557                     DC-GREG-DATE-2-EDIT.
   558             20  DC-EDIT2-MONTH        PIC 99.
   559             20  SLASH2-1              PIC X.
   560             20  DC-EDIT2-DAY          PIC 99.
   561             20  SLASH2-2              PIC X.
   562             20  DC-EDIT2-YEAR         PIC 99.
   563         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   564         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   565                     DC-GREG-DATE-1-YMD.
   566             20  DC-YMD-YEAR           PIC 99.
   567             20  DC-YMD-MONTH          PIC 99.
   568             20  DC-YMD-DAY            PIC 99.
   569         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   570         16  DC-GREG-DATE-1-MDY-R REDEFINES
   571                      DC-GREG-DATE-1-MDY.
   572             20  DC-MDY-MONTH          PIC 99.
   573             20  DC-MDY-DAY            PIC 99.
   574             20  DC-MDY-YEAR           PIC 99.
   575         16  DC-GREG-DATE-1-ALPHA.
   576             20  DC-ALPHA-MONTH        PIC X(10).
   577             20  DC-ALPHA-DAY          PIC 99.
   578             20  FILLER                PIC XX.
   579             20  DC-ALPHA-CENTURY.
   580                 24 DC-ALPHA-CEN-N     PIC 99.
   581             20  DC-ALPHA-YEAR         PIC 99.
   582         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   583         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   584         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   585         16  DC-JULIAN-DATE            PIC 9(05).
   586         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL650.cbl
   587                                       PIC 9(05).
   588         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   589             20  DC-JULIAN-YEAR        PIC 99.
   590             20  DC-JULIAN-DAYS        PIC 999.
   591         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   592         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   593         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   594     12  DATE-CONVERSION-VARIBLES.
   595         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   596         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   597             20  FILLER                PIC 9(3).
   598             20  HOLD-CEN-1-CCYY.
   599                 24  HOLD-CEN-1-CC     PIC 99.
   600                 24  HOLD-CEN-1-YY     PIC 99.
   601             20  HOLD-CEN-1-MO         PIC 99.
   602             20  HOLD-CEN-1-DA         PIC 99.
   603         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   604             20  HOLD-CEN-1-R-MO       PIC 99.
   605             20  HOLD-CEN-1-R-DA       PIC 99.
   606             20  HOLD-CEN-1-R-CCYY.
   607                 24  HOLD-CEN-1-R-CC   PIC 99.
   608                 24  HOLD-CEN-1-R-YY   PIC 99.
   609             20  FILLER                PIC 9(3).
   610         16  HOLD-CENTURY-1-X.
   611             20  FILLER                PIC X(3)  VALUE SPACES.
   612             20  HOLD-CEN-1-X-CCYY.
   613                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   614                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   615             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   616             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   617         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   618             20  HOLD-CEN-1-R-X-MO     PIC XX.
   619             20  HOLD-CEN-1-R-X-DA     PIC XX.
   620             20  HOLD-CEN-1-R-X-CCYY.
   621                 24  HOLD-CEN-1-R-X-CC PIC XX.
   622                 24  HOLD-CEN-1-R-X-YY PIC XX.
   623             20  FILLER                PIC XXX.
   624         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   625         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   626         16  DC-JULIAN-DATE-1          PIC 9(07).
   627         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   628             20  DC-JULIAN-1-CCYY.
   629                 24  DC-JULIAN-1-CC    PIC 99.
   630                 24  DC-JULIAN-1-YR    PIC 99.
   631             20  DC-JULIAN-DA-1        PIC 999.
   632         16  DC-JULIAN-DATE-2          PIC 9(07).
   633         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   634             20  DC-JULIAN-2-CCYY.
   635                 24  DC-JULIAN-2-CC    PIC 99.
   636                 24  DC-JULIAN-2-YR    PIC 99.
   637             20  DC-JULIAN-DA-2        PIC 999.
   638         16  DC-GREG-DATE-A-EDIT.
   639             20  DC-EDITA-MONTH        PIC 99.
   640             20  SLASHA-1              PIC X VALUE '/'.
   641             20  DC-EDITA-DAY          PIC 99.
   642             20  SLASHA-2              PIC X VALUE '/'.
   643             20  DC-EDITA-CCYY.
   644                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL650.cbl
   645                 24  DC-EDITA-YEAR     PIC 99.
   646         16  DC-GREG-DATE-B-EDIT.
   647             20  DC-EDITB-MONTH        PIC 99.
   648             20  SLASHB-1              PIC X VALUE '/'.
   649             20  DC-EDITB-DAY          PIC 99.
   650             20  SLASHB-2              PIC X VALUE '/'.
   651             20  DC-EDITB-CCYY.
   652                 24  DC-EDITB-CENT     PIC 99.
   653                 24  DC-EDITB-YEAR     PIC 99.
   654         16  DC-GREG-DATE-CYMD         PIC 9(08).
   655         16  DC-GREG-DATE-CYMD-R REDEFINES
   656                              DC-GREG-DATE-CYMD.
   657             20  DC-CYMD-CEN           PIC 99.
   658             20  DC-CYMD-YEAR          PIC 99.
   659             20  DC-CYMD-MONTH         PIC 99.
   660             20  DC-CYMD-DAY           PIC 99.
   661         16  DC-GREG-DATE-MDCY         PIC 9(08).
   662         16  DC-GREG-DATE-MDCY-R REDEFINES
   663                              DC-GREG-DATE-MDCY.
   664             20  DC-MDCY-MONTH         PIC 99.
   665             20  DC-MDCY-DAY           PIC 99.
   666             20  DC-MDCY-CEN           PIC 99.
   667             20  DC-MDCY-YEAR          PIC 99.
   668    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   669        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   670    12  DC-EL310-DATE                  PIC X(21).
   671    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL650.cbl
   673*    COPY ELCATTR.
   674******************************************************************
   675*                                                                *
   676*                            ELCATTR.                            *
   677*                            VMOD=2.001                          *
   678*                                                                *
   679*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   680*                                                                *
   681*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   682*                                                                *
   683*                   POS 1   P=PROTECTED                          *
   684*                           U=UNPROTECTED                        *
   685*                           S=ASKIP                              *
   686*                   POS 2   A=ALPHA/NUMERIC                      *
   687*                           N=NUMERIC                            *
   688*                   POS 3   N=NORMAL                             *
   689*                           B=BRIGHT                             *
   690*                           D=DARK                               *
   691*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   692*                           OF=MODIFIED DATA TAG OFF             *
   693*                                                                *
   694*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   695******************************************************************
   696 01  ATTRIBUTE-LIST.
   697     12  AL-PABOF            PIC X       VALUE 'Y'.
   698     12  AL-PABON            PIC X       VALUE 'Z'.
   699     12  AL-PADOF            PIC X       VALUE '%'.
   700     12  AL-PADON            PIC X       VALUE '_'.
   701     12  AL-PANOF            PIC X       VALUE '-'.
   702     12  AL-PANON            PIC X       VALUE '/'.
   703     12  AL-SABOF            PIC X       VALUE '8'.
   704     12  AL-SABON            PIC X       VALUE '9'.
   705     12  AL-SADOF            PIC X       VALUE '@'.
   706     12  AL-SADON            PIC X       VALUE QUOTE.
   707     12  AL-SANOF            PIC X       VALUE '0'.
   708     12  AL-SANON            PIC X       VALUE '1'.
   709     12  AL-UABOF            PIC X       VALUE 'H'.
   710     12  AL-UABON            PIC X       VALUE 'I'.
   711     12  AL-UADOF            PIC X       VALUE '<'.
   712     12  AL-UADON            PIC X       VALUE '('.
   713     12  AL-UANOF            PIC X       VALUE ' '.
   714     12  AL-UANON            PIC X       VALUE 'A'.
   715     12  AL-UNBOF            PIC X       VALUE 'Q'.
   716     12  AL-UNBON            PIC X       VALUE 'R'.
   717     12  AL-UNDOF            PIC X       VALUE '*'.
   718     12  AL-UNDON            PIC X       VALUE ')'.
   719     12  AL-UNNOF            PIC X       VALUE '&'.
   720     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL650.cbl
   722*    COPY ELCEMIB.
   723******************************************************************
   724*                                                                *
   725*                                                                *
   726*                            ELCEMIB.                            *
   727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   728*                            VMOD=2.005                          *
   729*                                                                *
   730*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   731*                                                                *
   732******************************************************************
   733 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   734     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   735     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   736     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   737     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   738     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   739     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   740     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   741     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   742     12  EMI-SWITCH1             PIC X        VALUE '1'.
   743         88  EMI-NO-ERRORS                    VALUE '1'.
   744         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   745         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   746     12  EMI-SWITCH2             PIC X        VALUE '1'.
   747         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   748     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   749         88  EMI-AREA1-EMPTY                  VALUE '1'.
   750         88  EMI-AREA1-FULL                   VALUE '2'.
   751     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   752         88  EMI-AREA2-EMPTY                  VALUE '1'.
   753         88  EMI-AREA2-FULL                   VALUE '2'.
   754     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   755         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   756         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   757         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   758         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   759         88  EMI-BYPASS-FATALS                VALUE 'X'.
   760     12  EMI-ERROR-LINES.
   761         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   762         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   763         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   764         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   765             20  EMI-ERR-CODES OCCURS 10 TIMES.
   766                 24  EMI-ERR-NUM         PIC X(4).
   767                 24  EMI-FILLER          PIC X.
   768                 24  EMI-SEV             PIC X.
   769                 24  FILLER              PIC X.
   770             20  FILLER                  PIC X(02).
   771     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   772         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   773             20  EMI-ERROR-NUMBER    PIC X(4).
   774             20  EMI-FILL            PIC X.
   775             20  EMI-SEVERITY        PIC X.
   776             20  FILLER              PIC X.
   777             20  EMI-ERROR-TEXT.
   778                 24  EMI-TEXT-VARIABLE   PIC X(10).
   779                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL650.cbl
   780     12  EMI-SEVERITY-SAVE           PIC X.
   781         88  EMI-NOTE                    VALUE 'N'.
   782         88  EMI-WARNING                 VALUE 'W'.
   783         88  EMI-FORCABLE                VALUE 'F'.
   784         88  EMI-FATAL                   VALUE 'X'.
   785     12  EMI-MESSAGE-FLAG            PIC X.
   786         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   787         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   788     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   789     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   790         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   791         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   792         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   793     12  emi-claim-no                pic x(7).
   794     12  emi-claim-type              pic x(6).
   795     12  FILLER                      PIC X(124)  VALUE SPACES.
   796     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   797     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   798     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   799     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL650.cbl
   801*    COPY ELCINTF.
   802******************************************************************
   803*                                                                *
   804*                                                                *
   805*                            ELCINTF.                            *
   806*                            VMOD=2.017                          *
   807*                                                                *
   808*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   809*                                                                *
   810*       LENGTH = 1024                                            *
   811*                                                                *
   812******************************************************************
   813*                   C H A N G E   L O G
   814*
   815* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   816*-----------------------------------------------------------------
   817*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   818* EFFECTIVE    NUMBER
   819*-----------------------------------------------------------------
   820* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   821******************************************************************
   822 01  PROGRAM-INTERFACE-BLOCK.
   823     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   824     12  PI-CALLING-PROGRAM              PIC X(8).
   825     12  PI-SAVED-PROGRAM-1              PIC X(8).
   826     12  PI-SAVED-PROGRAM-2              PIC X(8).
   827     12  PI-SAVED-PROGRAM-3              PIC X(8).
   828     12  PI-SAVED-PROGRAM-4              PIC X(8).
   829     12  PI-SAVED-PROGRAM-5              PIC X(8).
   830     12  PI-SAVED-PROGRAM-6              PIC X(8).
   831     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   832     12  PI-COMPANY-ID                   PIC XXX.
   833     12  PI-COMPANY-CD                   PIC X.
   834
   835     12  PI-COMPANY-PASSWORD             PIC X(8).
   836
   837     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   838
   839     12  PI-CONTROL-IN-PROGRESS.
   840         16  PI-CARRIER                  PIC X.
   841         16  PI-GROUPING                 PIC X(6).
   842         16  PI-STATE                    PIC XX.
   843         16  PI-ACCOUNT                  PIC X(10).
   844         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   845                                         PIC X(10).
   846         16  PI-CLAIM-CERT-GRP.
   847             20  PI-CLAIM-NO             PIC X(7).
   848             20  PI-CERT-NO.
   849                 25  PI-CERT-PRIME       PIC X(10).
   850                 25  PI-CERT-SFX         PIC X.
   851             20  PI-CERT-EFF-DT          PIC XX.
   852         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   853             20  PI-PLAN-CODE            PIC X(2).
   854             20  PI-REVISION-NUMBER      PIC X(3).
   855             20  PI-PLAN-EFF-DT          PIC X(2).
   856             20  PI-PLAN-EXP-DT          PIC X(2).
   857             20  FILLER                  PIC X(11).
   858         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL650.cbl
   859             20  PI-OE-REFERENCE-1.
   860                 25  PI-OE-REF-1-PRIME   PIC X(18).
   861                 25  PI-OE-REF-1-SUFF    PIC XX.
   862
   863     12  PI-SESSION-IN-PROGRESS          PIC X.
   864         88  CLAIM-SESSION                   VALUE '1'.
   865         88  CREDIT-SESSION                  VALUE '2'.
   866         88  WARRANTY-SESSION                VALUE '3'.
   867         88  MORTGAGE-SESSION                VALUE '4'.
   868         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   869
   870
   871*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   872
   873     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   874     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   875
   876     12  PI-CREDIT-USER                  PIC X.
   877         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   878         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   879
   880     12  PI-CLAIM-USER                   PIC X.
   881         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   882         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   883
   884     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   885         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   886         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   887         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   888         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   889         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   890
   891     12  PI-PROCESSOR-ID                 PIC X(4).
   892
   893     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   894
   895     12  PI-MEMBER-CAPTION               PIC X(10).
   896
   897     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   898         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   899
   900     12  PI-LIFE-OVERRIDE-L1             PIC X.
   901     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   902     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   903     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   904
   905     12  PI-AH-OVERRIDE-L1               PIC X.
   906     12  PI-AH-OVERRIDE-L2               PIC XX.
   907     12  PI-AH-OVERRIDE-L6               PIC X(6).
   908     12  PI-AH-OVERRIDE-L12              PIC X(12).
   909
   910     12  PI-NEW-SYSTEM                   PIC X(2).
   911
   912     12  PI-PRIMARY-CERT-NO              PIC X(11).
   913     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   914         88  PI-USES-PAID-TO                 VALUE '1'.
   915     12  PI-CRDTCRD-SYSTEM.
   916         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL650.cbl
   917             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   918             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   919         16  PI-CC-MONTH-END-DT          PIC XX.
   920     12  PI-PROCESSOR-PRINTER            PIC X(4).
   921
   922     12  PI-OE-REFERENCE-2.
   923         16  PI-OE-REF-2-PRIME           PIC X(10).
   924         16  PI-OE-REF-2-SUFF            PIC X.
   925
   926     12  PI-REM-TRM-CALC-OPTION          PIC X.
   927
   928     12  PI-LANGUAGE-TYPE                PIC X.
   929             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   930             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   931             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   932
   933     12  PI-POLICY-LINKAGE-IND           PIC X.
   934         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   935         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   936                                                   LOW-VALUES.
   937
   938     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   939     12  PI-CLAIM-PW-SESSION             PIC X(1).
   940         88  PI-CLAIM-CREDIT                 VALUE '1'.
   941         88  PI-CLAIM-CONVEN                 VALUE '2'.
   942
   943     12  PI-PROCESSOR-CSR-IND            PIC X.
   944         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   945         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   946
   947     12  FILLER                          PIC X(3).
   948
   949     12  PI-SYSTEM-LEVEL                 PIC X(145).
   950
   951     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   952         PI-SYSTEM-LEVEL.
   953
   954         16  PI-ENTRY-CODES.
   955             20  PI-ENTRY-CD-1           PIC X.
   956             20  PI-ENTRY-CD-2           PIC X.
   957
   958         16  PI-RETURN-CODES.
   959             20  PI-RETURN-CD-1          PIC X.
   960             20  PI-RETURN-CD-2          PIC X.
   961
   962         16  PI-UPDATE-STATUS-SAVE.
   963             20  PI-UPDATE-BY            PIC X(4).
   964             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   965
   966         16  PI-LOWER-CASE-LETTERS       PIC X.
   967             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   968
   969*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   970*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   971*            88  CARRIER-CLM-CNTL            VALUE '2'.
   972
   973         16  PI-CERT-ACCESS-CONTROL      PIC X.
   974             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL650.cbl
   975             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   976             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   977             88  ACCNT-CNTL                  VALUE '3'.
   978             88  CARR-ACCNT-CNTL             VALUE '4'.
   979
   980         16  PI-PROCESSOR-CAP-LIST.
   981             20  PI-SYSTEM-CONTROLS.
   982                24 PI-SYSTEM-DISPLAY     PIC X.
   983                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   984                24 PI-SYSTEM-MODIFY      PIC X.
   985                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   986             20  FILLER                  PIC XX.
   987             20  PI-DISPLAY-CAP          PIC X.
   988                 88  DISPLAY-CAP             VALUE 'Y'.
   989             20  PI-MODIFY-CAP           PIC X.
   990                 88  MODIFY-CAP              VALUE 'Y'.
   991             20  PI-MSG-AT-LOGON-CAP     PIC X.
   992                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   993             20  PI-FORCE-CAP            PIC X.
   994                 88  FORCE-CAP               VALUE 'Y'.
   995
   996         16  PI-PROGRAM-CONTROLS.
   997             20  PI-PGM-PRINT-OPT        PIC X.
   998             20  PI-PGM-FORMAT-OPT       PIC X.
   999             20  PI-PGM-PROCESS-OPT      PIC X.
  1000             20  PI-PGM-TOTALS-OPT       PIC X.
  1001
  1002         16  PI-HELP-INTERFACE.
  1003             20  PI-LAST-ERROR-NO        PIC X(4).
  1004             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1005
  1006         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1007             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1008
  1009         16  PI-CR-CONTROL-IN-PROGRESS.
  1010             20  PI-CR-CARRIER           PIC X.
  1011             20  PI-CR-GROUPING          PIC X(6).
  1012             20  PI-CR-STATE             PIC XX.
  1013             20  PI-CR-ACCOUNT           PIC X(10).
  1014             20  PI-CR-FIN-RESP          PIC X(10).
  1015             20  PI-CR-TYPE              PIC X.
  1016
  1017         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1018
  1019         16  PI-CR-MONTH-END-DT          PIC XX.
  1020
  1021         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1022             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1023             88  PI-ZERO-CARRIER             VALUE '1'.
  1024             88  PI-ZERO-GROUPING            VALUE '2'.
  1025             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1026
  1027         16  PI-CARRIER-SECURITY         PIC X.
  1028             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1029
  1030         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1031             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1032             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL650.cbl
  1033
  1034         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1035             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1036                                         INDEXED BY PI-ACCESS-NDX
  1037                                         PIC X.
  1038
  1039         16  PI-GA-BILLING-CONTROL       PIC X.
  1040             88  PI-GA-BILLING               VALUE '1'.
  1041
  1042         16  PI-MAIL-PROCESSING          PIC X.
  1043             88  PI-MAIL-YES                 VALUE 'Y'.
  1044
  1045         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1046
  1047         16  PI-AR-SYSTEM.
  1048             20  PI-AR-PROCESSING-CNTL   PIC X.
  1049                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1050             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1051             20  PI-AR-MONTH-END-DT      PIC XX.
  1052
  1053         16  PI-MP-SYSTEM.
  1054             20  PI-MORTGAGE-USER            PIC X.
  1055                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1056                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1057             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1058                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1059                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1060                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1061                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1062                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1063             20  PI-MP-MONTH-END-DT          PIC XX.
  1064             20  PI-MP-REFERENCE-NO.
  1065                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1066                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1067
  1068         16  PI-LABEL-CONTROL            PIC X(01).
  1069             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1070             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1071
  1072         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1073             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1074
  1075         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1076             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1077             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1078
  1079         16  FILLER                      PIC X(14).
  1080
  1081     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1082******************************************************************
  1083*    COPY ELC650PI.
  1084******************************************************************
  1085*
  1086*                            ELC650PI.
  1087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1088*                            VMOD=2.007
  1089*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1090*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL650.cbl
  1091* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1092*
  1093******************************************************************
  1094
  1095     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1096         16  PI-MAINT                   PIC X.
  1097         16  PI-PREV-ACCOUNT            PIC X(20).
  1098         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1099         16  PI-ACCT-KEY.
  1100             20  PI-ACCT-CCGSA-KEY.
  1101                 24  PI-ACCT-CO             PIC X.
  1102                 24  PI-ACCT-CARRIER        PIC X.
  1103                 24  PI-ACCT-GROUPING       PIC X(6).
  1104                 24  PI-ACCT-STATE          PIC XX.
  1105                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1106             20  PI-ACCT-EXP-DT           PIC XX.
  1107             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1108         16  PI-ACCT-ID                 PIC X(8).
  1109         16  PI-PLAN-KEY.
  1110             20  PI-PLAN-ACCT-KEY.
  1111                 24  PI-PLAN-COMPANY-CD PIC X.
  1112                 24  PI-PLAN-CARRIER    PIC X.
  1113                 24  PI-PLAN-GROUP      PIC X(6).
  1114                 24  PI-PLAN-STATE      PIC X(2).
  1115                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1116             20  PI-PLAN-BEN-TYPE       PIC X.
  1117             20  PI-PLAN-BEN            PIC XX.
  1118             20  PI-PLAN-REVISION       PIC X(3).
  1119         16  PI-WS-STATE                PIC XX.
  1120         16  PI-WS-CLASS                PIC XX.
  1121         16  PI-WS-DEV                  PIC X(3).
  1122         16  PI-WS-TYPE                 PIC X.
  1123         16  PI-WS-PLAN                 PIC XX.
  1124
  1125         16  PI-ERPNDB-ALT-KEY.
  1126             20  PI-PB-COMPANY-CD-A1    PIC X.
  1127             20  PI-PB-CARRIER          PIC X.
  1128             20  PI-PB-GROUPING         PIC X(6).
  1129             20  PI-PB-STATE            PIC XX.
  1130             20  PI-PB-ACCOUNT          PIC X(10).
  1131             20  PI-PB-CERT-EFF-DT      PIC XX.
  1132             20  PI-PB-CERT-NO          PIC X(10).
  1133             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1134             20  PI-PB-RECORD-TYPE      PIC X.
  1135
  1136         16  PI-DATE-RANGE-TABLE.
  1137             20  PI-TABLE-ENT OCCURS 32 TIMES
  1138                            INDEXED BY T-INDEX.
  1139                 24  PI-BIN-EFF-DT          PIC XX.
  1140                 24  PI-BIN-EXP-DT          PIC XX.
  1141                 24  PI-BIN-MAINT-DT        PIC XX.
  1142                 24  PI-BIN-LO-CERT         PIC XX.
  1143                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1144                 24  PI-BIN-HI-CERT         PIC XX.
  1145         16  PI-PAGE-NUMBER             PIC S9.
  1146             88  PI-FST-PAGE               VALUE +1.
  1147             88  PI-2ND-PAGE               VALUE +2.
  1148             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL650.cbl
  1149             88  PI-LST-PAGE               VALUE +4.
  1150         16  PI-TOTAL-LINES             PIC S99.
  1151         16  PI-LINE-SELECTED    PIC S9.
  1152***  Y2K PROJ 7744
  1153         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1154         16  BIN-EFFCHG-SAVE     PIC XX.
  1155         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1156***  Y2K PROJ 7744
  1157         16  BIN-EXPCHG-SAVE     PIC XX.
  1158         16  PI-RECORD-ADDED-SW  PIC X.
  1159             88  PI-RECORD-ADDED            VALUE '1'.
  1160             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1161         16  PI-ACCNAME          PIC X(30).
  1162         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1163         16  PI-SV-MAINT         PIC X.
  1164         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1165         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1166         16  PI-UPDATE-SW        PIC X.
  1167             88  PI-CHANGES-MADE             VALUE '1'.
  1168         16  PI-NOTE-TYPE        PIC X.
  1169             88  PI-ACCT-NOTE                VALUE '1'.
  1170         16  PI-DMD-FILE-SW      PIC X.
  1171             88  END-OF-FILE                 VALUE 'E'.
  1172             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1173             88  FIRST-OCCURS                VALUE 'F'.
  1174         16  PI-DMD-OCCURS       PIC S999.
  1175         16  PI-DMD-SCREEN       PIC X.
  1176             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1177             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1178             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1179         16  PI-NAMEFLG          PIC X.
  1180         16  PI-EL650-DEL-SW     PIC X.
  1181         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1182         16  PI-DCC-PROD-CODE    PIC XXX.
  1183         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL650.cbl
  1185*          16  PI-NAMEFLG       PIC X.
  1186
  1187*    COPY ELCJPFX.
  1188******************************************************************
  1189*                                                                *
  1190*                                                                *
  1191*                            ELCJPFX.                            *
  1192*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1193*                            VMOD=2.002                          *
  1194*                                                                *
  1195*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1196*                                                                *
  1197*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1198*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1199*        ELCNTL - CONTROL FILE                                   *
  1200*        ELMSTR - CLAIM MASTERS                                  *
  1201*        ELTRLR - ACTIVITY TRAILERS                              *
  1202*        ELCHKQ - CHECK QUE                                      *
  1203******************************************************************
  1204 01  JOURNAL-RECORD.
  1205     12  jp-date                     pic s9(5) comp-3.
  1206     12  jp-time                     pic s9(7) comp-3.
  1207     12  JP-USER-ID                  PIC X(4).
  1208     12  JP-FILE-ID                  PIC X(8).
  1209     12  JP-PROGRAM-ID               PIC X(8).
  1210     12  JP-RECORD-TYPE              PIC X.
  1211         88 JP-ADD              VALUE 'A'.
  1212         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1213         88 JP-AFTER-CHANGE     VALUE 'C'.
  1214         88 JP-DELETE           VALUE 'D'.
  1215         88 JP-GENERIC-DELETE   VALUE 'G'.
  1216         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1217         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1218     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1219     12  JP-RECORD-AREA
  1220
  1221
  1222                                 PIC  X(2000).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL650.cbl
  1224*    COPY ELCAID.
  1225******************************************************************
  1226*                                                                *
  1227*                            ELCAID.                             *
  1228*                            VMOD=2.001                          *
  1229*                                                                *
  1230*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1231*                                                                *
  1232*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1233*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1234******************************************************************
  1235
  1236 01  DFHAID.
  1237   02  DFHNULL   PIC  X  VALUE  ' '.
  1238   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1239   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1240   02  DFHPEN    PIC  X  VALUE  '='.
  1241   02  DFHOPID   PIC  X  VALUE  'W'.
  1242   02  DFHPA1    PIC  X  VALUE  '%'.
  1243   02  DFHPA2    PIC  X  VALUE  '>'.
  1244   02  DFHPA3    PIC  X  VALUE  ','.
  1245   02  DFHPF1    PIC  X  VALUE  '1'.
  1246   02  DFHPF2    PIC  X  VALUE  '2'.
  1247   02  DFHPF3    PIC  X  VALUE  '3'.
  1248   02  DFHPF4    PIC  X  VALUE  '4'.
  1249   02  DFHPF5    PIC  X  VALUE  '5'.
  1250   02  DFHPF6    PIC  X  VALUE  '6'.
  1251   02  DFHPF7    PIC  X  VALUE  '7'.
  1252   02  DFHPF8    PIC  X  VALUE  '8'.
  1253   02  DFHPF9    PIC  X  VALUE  '9'.
  1254   02  DFHPF10   PIC  X  VALUE  ':'.
  1255   02  DFHPF11   PIC  X  VALUE  '#'.
  1256   02  DFHPF12   PIC  X  VALUE  '@'.
  1257   02  DFHPF13   PIC  X  VALUE  'A'.
  1258   02  DFHPF14   PIC  X  VALUE  'B'.
  1259   02  DFHPF15   PIC  X  VALUE  'C'.
  1260   02  DFHPF16   PIC  X  VALUE  'D'.
  1261   02  DFHPF17   PIC  X  VALUE  'E'.
  1262   02  DFHPF18   PIC  X  VALUE  'F'.
  1263   02  DFHPF19   PIC  X  VALUE  'G'.
  1264   02  DFHPF20   PIC  X  VALUE  'H'.
  1265   02  DFHPF21   PIC  X  VALUE  'I'.
  1266*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1267   02  DFHPF22   PIC  X  VALUE  '['.
  1268   02  DFHPF23   PIC  X  VALUE  '.'.
  1269   02  DFHPF24   PIC  X  VALUE  '<'.
  1270   02  DFHMSRE   PIC  X  VALUE  'X'.
  1271   02  DFHSTRF   PIC  X  VALUE  'h'.
  1272   02  DFHTRIG   PIC  X  VALUE  '"'.
  1273
  1274 01  FILLER  REDEFINES  DFHAID.
  1275     12  FILLER              PIC  X(8).
  1276     12  PF-VALUES           PIC  X      OCCURS  24  TIMES.
  1277     12  FILLER              PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL650.cbl
  1279*    COPY EL650S.
  1280 01  EL650AI.
  1281     05  FILLER            PIC  X(0012).
  1282*    -------------------------------
  1283     05  DATEL PIC S9(0004) COMP.
  1284     05  DATEF PIC  X(0001).
  1285     05  FILLER REDEFINES DATEF.
  1286         10  DATEA PIC  X(0001).
  1287     05  DATEI PIC  X(0008).
  1288*    -------------------------------
  1289     05  TIMEL PIC S9(0004) COMP.
  1290     05  TIMEF PIC  X(0001).
  1291     05  FILLER REDEFINES TIMEF.
  1292         10  TIMEA PIC  X(0001).
  1293     05  TIMEI PIC  X(0005).
  1294*    -------------------------------
  1295     05  CMPNYIDL PIC S9(0004) COMP.
  1296     05  CMPNYIDF PIC  X(0001).
  1297     05  FILLER REDEFINES CMPNYIDF.
  1298         10  CMPNYIDA PIC  X(0001).
  1299     05  CMPNYIDI PIC  X(0003).
  1300*    -------------------------------
  1301     05  USERIDL PIC S9(0004) COMP.
  1302     05  USERIDF PIC  X(0001).
  1303     05  FILLER REDEFINES USERIDF.
  1304         10  USERIDA PIC  X(0001).
  1305     05  USERIDI PIC  X(0004).
  1306*    -------------------------------
  1307     05  MAINTL PIC S9(0004) COMP.
  1308     05  MAINTF PIC  X(0001).
  1309     05  FILLER REDEFINES MAINTF.
  1310         10  MAINTA PIC  X(0001).
  1311     05  MAINTI PIC  X(0001).
  1312*    -------------------------------
  1313     05  TRNMSG1L PIC S9(0004) COMP.
  1314     05  TRNMSG1F PIC  X(0001).
  1315     05  FILLER REDEFINES TRNMSG1F.
  1316         10  TRNMSG1A PIC  X(0001).
  1317     05  TRNMSG1I PIC  X(0017).
  1318*    -------------------------------
  1319     05  LINEL PIC S9(0004) COMP.
  1320     05  LINEF PIC  X(0001).
  1321     05  FILLER REDEFINES LINEF.
  1322         10  LINEA PIC  X(0001).
  1323     05  LINEI PIC  9.
  1324*    -------------------------------
  1325     05  ACARIERL PIC S9(0004) COMP.
  1326     05  ACARIERF PIC  X(0001).
  1327     05  FILLER REDEFINES ACARIERF.
  1328         10  ACARIERA PIC  X(0001).
  1329     05  ACARIERI PIC  X(0001).
  1330*    -------------------------------
  1331     05  AGROUPL PIC S9(0004) COMP.
  1332     05  AGROUPF PIC  X(0001).
  1333     05  FILLER REDEFINES AGROUPF.
  1334         10  AGROUPA PIC  X(0001).
  1335     05  AGROUPI PIC  X(0006).
  1336*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL650.cbl
  1337     05  ASTATEL PIC S9(0004) COMP.
  1338     05  ASTATEF PIC  X(0001).
  1339     05  FILLER REDEFINES ASTATEF.
  1340         10  ASTATEA PIC  X(0001).
  1341     05  ASTATEI PIC  X(0002).
  1342*    -------------------------------
  1343     05  AACCTL PIC S9(0004) COMP.
  1344     05  AACCTF PIC  X(0001).
  1345     05  FILLER REDEFINES AACCTF.
  1346         10  AACCTA PIC  X(0001).
  1347     05  AACCTI PIC  X(0010).
  1348*    -------------------------------
  1349     05  NAMEFLGL PIC S9(0004) COMP.
  1350     05  NAMEFLGF PIC  X(0001).
  1351     05  FILLER REDEFINES NAMEFLGF.
  1352         10  NAMEFLGA PIC  X(0001).
  1353     05  NAMEFLGI PIC  X(0001).
  1354*    -------------------------------
  1355     05  NAMEL PIC S9(0004) COMP.
  1356     05  NAMEF PIC  X(0001).
  1357     05  FILLER REDEFINES NAMEF.
  1358         10  NAMEA PIC  X(0001).
  1359     05  NAMEI PIC  X(0030).
  1360*    -------------------------------
  1361     05  ARHDGL PIC S9(0004) COMP.
  1362     05  ARHDGF PIC  X(0001).
  1363     05  FILLER REDEFINES ARHDGF.
  1364         10  ARHDGA PIC  X(0001).
  1365     05  ARHDGI PIC  X(0010).
  1366*    -------------------------------
  1367     05  DET1L PIC S9(0004) COMP.
  1368     05  DET1F PIC  X(0001).
  1369     05  FILLER REDEFINES DET1F.
  1370         10  DET1A PIC  X(0001).
  1371     05  DET1I PIC  X(0070).
  1372*    -------------------------------
  1373     05  DET2L PIC S9(0004) COMP.
  1374     05  DET2F PIC  X(0001).
  1375     05  FILLER REDEFINES DET2F.
  1376         10  DET2A PIC  X(0001).
  1377     05  DET2I PIC  X(0070).
  1378*    -------------------------------
  1379     05  DET3L PIC S9(0004) COMP.
  1380     05  DET3F PIC  X(0001).
  1381     05  FILLER REDEFINES DET3F.
  1382         10  DET3A PIC  X(0001).
  1383     05  DET3I PIC  X(0070).
  1384*    -------------------------------
  1385     05  DET4L PIC S9(0004) COMP.
  1386     05  DET4F PIC  X(0001).
  1387     05  FILLER REDEFINES DET4F.
  1388         10  DET4A PIC  X(0001).
  1389     05  DET4I PIC  X(0070).
  1390*    -------------------------------
  1391     05  DET5L PIC S9(0004) COMP.
  1392     05  DET5F PIC  X(0001).
  1393     05  FILLER REDEFINES DET5F.
  1394         10  DET5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL650.cbl
  1395     05  DET5I PIC  X(0070).
  1396*    -------------------------------
  1397     05  DET6L PIC S9(0004) COMP.
  1398     05  DET6F PIC  X(0001).
  1399     05  FILLER REDEFINES DET6F.
  1400         10  DET6A PIC  X(0001).
  1401     05  DET6I PIC  X(0070).
  1402*    -------------------------------
  1403     05  DET7L PIC S9(0004) COMP.
  1404     05  DET7F PIC  X(0001).
  1405     05  FILLER REDEFINES DET7F.
  1406         10  DET7A PIC  X(0001).
  1407     05  DET7I PIC  X(0070).
  1408*    -------------------------------
  1409     05  DET8L PIC S9(0004) COMP.
  1410     05  DET8F PIC  X(0001).
  1411     05  FILLER REDEFINES DET8F.
  1412         10  DET8A PIC  X(0001).
  1413     05  DET8I PIC  X(0070).
  1414*    -------------------------------
  1415     05  TRNMSG2L PIC S9(0004) COMP.
  1416     05  TRNMSG2F PIC  X(0001).
  1417     05  FILLER REDEFINES TRNMSG2F.
  1418         10  TRNMSG2A PIC  X(0001).
  1419     05  TRNMSG2I PIC  X(0020).
  1420*    -------------------------------
  1421     05  EFFCHGL PIC S9(0004) COMP.
  1422     05  EFFCHGF PIC  X(0001).
  1423     05  FILLER REDEFINES EFFCHGF.
  1424         10  EFFCHGA PIC  X(0001).
  1425     05  EFFCHGI PIC  X(0008).
  1426*    -------------------------------
  1427     05  EXPCHGL PIC S9(0004) COMP.
  1428     05  EXPCHGF PIC  X(0001).
  1429     05  FILLER REDEFINES EXPCHGF.
  1430         10  EXPCHGA PIC  X(0001).
  1431     05  EXPCHGI PIC  X(0008).
  1432*    -------------------------------
  1433     05  TRNMSG3L PIC S9(0004) COMP.
  1434     05  TRNMSG3F PIC  X(0001).
  1435     05  FILLER REDEFINES TRNMSG3F.
  1436         10  TRNMSG3A PIC  X(0001).
  1437     05  TRNMSG3I PIC  X(0003).
  1438*    -------------------------------
  1439     05  TRNTOL PIC S9(0004) COMP.
  1440     05  TRNTOF PIC  X(0001).
  1441     05  FILLER REDEFINES TRNTOF.
  1442         10  TRNTOA PIC  X(0001).
  1443     05  TRNTOI PIC  X(0019).
  1444*    -------------------------------
  1445     05  TRNTODTL PIC S9(0004) COMP.
  1446     05  TRNTODTF PIC  X(0001).
  1447     05  FILLER REDEFINES TRNTODTF.
  1448         10  TRNTODTA PIC  X(0001).
  1449     05  TRNTODTI PIC  X(0008).
  1450*    -------------------------------
  1451     05  TRNMSG4L PIC S9(0004) COMP.
  1452     05  TRNMSG4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL650.cbl
  1453     05  FILLER REDEFINES TRNMSG4F.
  1454         10  TRNMSG4A PIC  X(0001).
  1455     05  TRNMSG4I PIC  X(0005).
  1456*    -------------------------------
  1457     05  TRNFROML PIC S9(0004) COMP.
  1458     05  TRNFROMF PIC  X(0001).
  1459     05  FILLER REDEFINES TRNFROMF.
  1460         10  TRNFROMA PIC  X(0001).
  1461     05  TRNFROMI PIC  X(0019).
  1462*    -------------------------------
  1463     05  TRNFRDTL PIC S9(0004) COMP.
  1464     05  TRNFRDTF PIC  X(0001).
  1465     05  FILLER REDEFINES TRNFRDTF.
  1466         10  TRNFRDTA PIC  X(0001).
  1467     05  TRNFRDTI PIC  X(0008).
  1468*    -------------------------------
  1469     05  ERRMSG1L PIC S9(0004) COMP.
  1470     05  ERRMSG1F PIC  X(0001).
  1471     05  FILLER REDEFINES ERRMSG1F.
  1472         10  ERRMSG1A PIC  X(0001).
  1473     05  ERRMSG1I PIC  X(0075).
  1474*    -------------------------------
  1475     05  ERRMSG2L PIC S9(0004) COMP.
  1476     05  ERRMSG2F PIC  X(0001).
  1477     05  FILLER REDEFINES ERRMSG2F.
  1478         10  ERRMSG2A PIC  X(0001).
  1479     05  ERRMSG2I PIC  X(0075).
  1480*    -------------------------------
  1481     05  PFENTERL PIC S9(0004) COMP.
  1482     05  PFENTERF PIC  X(0001).
  1483     05  FILLER REDEFINES PFENTERF.
  1484         10  PFENTERA PIC  X(0001).
  1485     05  PFENTERI PIC  9(2).
  1486 01  EL650AO REDEFINES EL650AI.
  1487     05  FILLER            PIC  X(0012).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  DATEO PIC  X(0008).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  TIMEO PIC  99.99.
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  CMPNYIDO PIC  X(0003).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  USERIDO PIC  X(0004).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  MAINTO PIC  X(0001).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  TRNMSG1O PIC  X(0017).
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  LINEO PIC  X(0001).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL650.cbl
  1511     05  ACARIERO PIC  X(0001).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  AGROUPO PIC  X(0006).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  ASTATEO PIC  X(0002).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  AACCTO PIC  X(0010).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  NAMEFLGO PIC  X(0001).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  NAMEO PIC  X(0030).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  ARHDGO PIC  X(0010).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  DET1O PIC  X(0070).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  DET2O PIC  X(0070).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  DET3O PIC  X(0070).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  DET4O PIC  X(0070).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  DET5O PIC  X(0070).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  DET6O PIC  X(0070).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  DET7O PIC  X(0070).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  DET8O PIC  X(0070).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  TRNMSG2O PIC  X(0020).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  EFFCHGO PIC  X(0008).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  EXPCHGO PIC  99B99B99.
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  TRNMSG3O PIC  X(0003).
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  TRNTOO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL650.cbl
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  TRNTODTO PIC  X(0008).
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  TRNMSG4O PIC  X(0005).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  TRNFROMO PIC  X(0019).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  TRNFRDTO PIC  X(0008).
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  ERRMSG1O PIC  X(0075).
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
  1586     05  ERRMSG2O PIC  X(0075).
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  PFENTERO PIC  X(0002).
  1590*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL650.cbl
  1592 01  EL650R  REDEFINES  EL650AI.
  1593     12  FILLER                      PIC  X(153).
  1594     12  MAP-RECORD-AREA.
  1595         16  DATE-RANGES     OCCURS  8  TIMES
  1596                                 INDEXED  BY  M-INDEX.
  1597             20  FILLER              PIC  X(3).
  1598             20  MAP-EFF-DT          PIC  X(8).
  1599             20  FILLER              PIC  X(6).
  1600             20  MAP-EXP-DT          PIC  X(8).
  1601             20  MAP-EXP-DT-ED  REDEFINES
  1602                 MAP-EXP-DT          PIC 99B99B99.
  1603             20  FILLER              PIC  X(4).
  1604             20  MAP-LST-MAINT-DT    PIC  X(8).
  1605             20  FILLER              PIC  X(3).
  1606             20  MAP-LOW-CERT        PIC  X(8).
  1607             20  FILLER              PIC  X(3).
  1608             20  MAP-HIGH-CERT       PIC  X(8).
  1609             20  FILLER              PIC  X(4).
  1610             20  MAP-AR-DATE         PIC  X(8).
  1611             20  FILLER              PIC  XX.
  1612     12  FILLER                      PIC  X(286).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL650.cbl
  1614****************************************************************
  1615*
  1616* Copyright (c) 2007 by Clerity Solutions, Inc.
  1617* All rights reserved.
  1618*
  1619****************************************************************
  1620 01  DFHEIV.
  1621   02  DFHEIV0               PIC X(35).
  1622   02  DFHEIV1               PIC X(08).
  1623   02  DFHEIV2               PIC X(08).
  1624   02  DFHEIV3               PIC X(08).
  1625   02  DFHEIV4               PIC X(06).
  1626   02  DFHEIV5               PIC X(04).
  1627   02  DFHEIV6               PIC X(04).
  1628   02  DFHEIV7               PIC X(02).
  1629   02  DFHEIV8               PIC X(02).
  1630   02  DFHEIV9               PIC X(01).
  1631   02  DFHEIV10              PIC S9(7) COMP-3.
  1632   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1633   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1634   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1635   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1636   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1637   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1638   02  DFHEIV17              PIC X(04).
  1639   02  DFHEIV18              PIC X(04).
  1640   02  DFHEIV19              PIC X(04).
  1641   02  DFHEIV20              USAGE IS POINTER.
  1642   02  DFHEIV21              USAGE IS POINTER.
  1643   02  DFHEIV22              USAGE IS POINTER.
  1644   02  DFHEIV23              USAGE IS POINTER.
  1645   02  DFHEIV24              USAGE IS POINTER.
  1646   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1647   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1648   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1649   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1651   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1652   02  FILLER                PIC X(02).
  1653   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1654   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1655   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1656   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1657   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1658 LINKAGE  SECTION.
  1659*****************************************************************
  1660*                                                               *
  1661* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1662* All rights reserved.                                          *
  1663*                                                               *
  1664*****************************************************************
  1665 01  dfheiblk.
  1666     02  eibtime          pic s9(7) comp-3.
  1667     02  eibdate          pic s9(7) comp-3.
  1668     02  eibtrnid         pic x(4).
  1669     02  eibtaskn         pic s9(7) comp-3.
  1670     02  eibtrmid         pic x(4).
  1671     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL650.cbl
  1672     02  eibcposn         pic s9(4) comp.
  1673     02  eibcalen         pic s9(4) comp.
  1674     02  eibaid           pic x(1).
  1675     02  eibfiller1       pic x(1).
  1676     02  eibfn            pic x(2).
  1677     02  eibfiller2       pic x(2).
  1678     02  eibrcode         pic x(6).
  1679     02  eibfiller3       pic x(2).
  1680     02  eibds            pic x(8).
  1681     02  eibreqid         pic x(8).
  1682     02  eibrsrce         pic x(8).
  1683     02  eibsync          pic x(1).
  1684     02  eibfree          pic x(1).
  1685     02  eibrecv          pic x(1).
  1686     02  eibsend          pic x(1).
  1687     02  eibatt           pic x(1).
  1688     02  eibeoc           pic x(1).
  1689     02  eibfmh           pic x(1).
  1690     02  eibcompl         pic x(1).
  1691     02  eibsig           pic x(1).
  1692     02  eibconf          pic x(1).
  1693     02  eiberr           pic x(1).
  1694     02  eibrldbk         pic x(1).
  1695     02  eiberrcd         pic x(4).
  1696     02  eibsynrb         pic x(1).
  1697     02  eibnodat         pic x(1).
  1698     02  eibfiller5       pic x(2).
  1699     02  eibresp          pic 9(09) comp.
  1700     02  eibresp2         pic 9(09) comp.
  1701     02  dfheigdj         pic s9(4) comp.
  1702     02  dfheigdk         pic s9(4) comp.
  1703 01  DFHCOMMAREA             PIC  X(1500).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL650.cbl
  1705*01 PARMLIST .
  1706*    12  FILLER              PIC S9(8)   COMP.
  1707*    12  ERACCT-POINTER      PIC S9(8)   COMP.
  1708*    12  ERCOMP-POINTER      PIC S9(8)   COMP.
  1709*    12  ERNAME-POINTER      PIC S9(8)   COMP.
  1710*    12  ERPLAN-POINTER      PIC S9(8)   COMP.
  1711*    12  ELCNTL-POINTER      PIC S9(8)   COMP.
  1712*    12  ERPNDB-POINTER      PIC S9(8)   COMP.
  1713*    12  AXRF-POINTER        PIC S9(8)   COMP.
  1714*    12  AXRF2-POINTER       PIC S9(8)   COMP.
  1715*    12  AXRF3-POINTER       PIC S9(8)   COMP.
  1716*    12  AXRF4-POINTER       PIC S9(8)   COMP.
  1717*    12  AXRF5-POINTER       PIC S9(8)   COMP.
  1718*    12  AXRF6-POINTER       PIC S9(8)   COMP.
  1719*    12  AXRF7-POINTER       PIC S9(8)   COMP.
  1720*    12  AXRF8-POINTER       PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL650.cbl
  1722*    COPY ERCACCT.
  1723******************************************************************
  1724*                                                                *
  1725*                                                                *
  1726*                            ERCACCT                             *
  1727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1728*                            VMOD=2.031                          *
  1729*                                                                *
  1730*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1731*                                                                *
  1732*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1733*   VSAM ACCOUNT MASTER FILES.                                   *
  1734*                                                                *
  1735*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1736*                                                                *
  1737*   FILE TYPE = VSAM,KSDS                                        *
  1738*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1739*                                                                *
  1740*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1741*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1742*                                                                *
  1743*   LOG = NO                                                     *
  1744*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1745*                                                                *
  1746*                                                                *
  1747******************************************************************
  1748*                   C H A N G E   L O G
  1749*
  1750* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1751*-----------------------------------------------------------------
  1752*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1753* EFFECTIVE    NUMBER
  1754*-----------------------------------------------------------------
  1755* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1756* 092705    2005050300006  PEMA  ADD SPP LEASES
  1757* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1758* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1759* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1760* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1761* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1762******************************************************************
  1763
  1764 01  ACCOUNT-MASTER.
  1765     12  AM-RECORD-ID                      PIC XX.
  1766         88  VALID-AM-ID                      VALUE 'AM'.
  1767
  1768     12  AM-CONTROL-PRIMARY.
  1769         16  AM-COMPANY-CD                 PIC X.
  1770         16  AM-MSTR-CNTRL.
  1771             20  AM-CONTROL-A.
  1772                 24  AM-CARRIER            PIC X.
  1773                 24  AM-GROUPING.
  1774                     28 AM-GROUPING-PREFIX PIC XXX.
  1775                     28 AM-GROUPING-PRIME  PIC XXX.
  1776                 24  AM-STATE              PIC XX.
  1777                 24  AM-ACCOUNT.
  1778                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1779                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL650.cbl
  1780             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1781                                           PIC X(19).
  1782             20  AM-CNTRL-B.
  1783                 24  AM-EXPIRATION-DT      PIC XX.
  1784                 24  FILLER                PIC X(4).
  1785             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1786                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1787
  1788     12  AM-CONTROL-BY-VAR-GRP.
  1789         16  AM-COMPANY-CD-A1              PIC X.
  1790         16  AM-VG-CARRIER                 PIC X.
  1791         16  AM-VG-GROUPING                PIC X(6).
  1792         16  AM-VG-STATE                   PIC XX.
  1793         16  AM-VG-ACCOUNT                 PIC X(10).
  1794         16  AM-VG-DATE.
  1795             20  AM-VG-EXPIRATION-DT       PIC XX.
  1796             20  FILLER                    PIC X(4).
  1797         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1798                                           PIC 9(11)      COMP-3.
  1799     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1800         16  FILLER                        PIC X(10).
  1801         16  AM-VG-KEY3.
  1802             20  AM-VG3-ACCOUNT            PIC X(10).
  1803             20  AM-VG3-EXP-DT             PIC XX.
  1804         16  FILLER                        PIC X(4).
  1805     12  AM-MAINT-INFORMATION.
  1806         16  AM-LAST-MAINT-DT              PIC XX.
  1807         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1808         16  AM-LAST-MAINT-USER            PIC X(4).
  1809         16  FILLER                        PIC XX.
  1810
  1811     12  AM-EFFECTIVE-DT                   PIC XX.
  1812     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1813
  1814     12  AM-PREV-DATES  COMP-3.
  1815         16  AM-PREV-EXP-DT                PIC 9(11).
  1816         16  AM-PREV-EFF-DT                PIC 9(11).
  1817
  1818     12  AM-REPORT-CODE-1                  PIC X(10).
  1819     12  AM-REPORT-CODE-2                  PIC X(10).
  1820
  1821     12  AM-CITY-CODE                      PIC X(4).
  1822     12  AM-COUNTY-PARISH                  PIC X(6).
  1823
  1824     12  AM-NAME                           PIC X(30).
  1825     12  AM-PERSON                         PIC X(30).
  1826     12  AM-ADDRS                          PIC X(30).
  1827     12  AM-CITY.
  1828         16  AM-ADDR-CITY                  PIC X(28).
  1829         16  AM-ADDR-STATE                 PIC XX.
  1830     12  AM-ZIP.
  1831         16  AM-ZIP-PRIME.
  1832             20  AM-ZIP-PRI-1ST            PIC X.
  1833                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1834             20  FILLER                    PIC X(4).
  1835         16  AM-ZIP-PLUS4                  PIC X(4).
  1836     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1837         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL650.cbl
  1838         16  AM-CAN-POSTAL-2               PIC XXX.
  1839         16  FILLER                        PIC XXX.
  1840     12  AM-TEL-NO.
  1841         16  AM-AREA-CODE                  PIC 999.
  1842         16  AM-TEL-PRE                    PIC 999.
  1843         16  AM-TEL-NBR                    PIC 9(4).
  1844     12  AM-TEL-LOC                        PIC X.
  1845         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1846         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1847
  1848     12  AM-COMM-STRUCTURE.
  1849         16  AM-DEFN-1.
  1850             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1851                 24  AM-AGT.
  1852                     28  AM-AGT-PREFIX     PIC X(4).
  1853                     28  AM-AGT-PRIME      PIC X(6).
  1854                 24  AM-COM-TYP            PIC X.
  1855                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1856                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1857                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1858                 24  AM-RECALC-LV-INDIC    PIC X.
  1859                 24  AM-RETRO-LV-INDIC     PIC X.
  1860                 24  AM-GL-CODES           PIC X.
  1861                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1862                 24  FILLER                PIC X(01).
  1863         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1864             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1865                 24  FILLER                PIC X(11).
  1866                 24  AM-L-COMA             PIC XXX.
  1867                 24  AM-J-COMA             PIC XXX.
  1868                 24  AM-A-COMA             PIC XXX.
  1869                 24  FILLER                PIC X(6).
  1870
  1871     12  AM-COMM-CHANGE-STATUS             PIC X.
  1872         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1873
  1874     12  AM-CSR-CODE                       PIC X(4).
  1875
  1876     12  AM-BILLING-STATUS                 PIC X.
  1877         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1878         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1879     12  AM-AUTO-REFUND-SW                 PIC X.
  1880         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1881         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1882     12  AM-GPCD                           PIC 99.
  1883     12  AM-IG                             PIC X.
  1884         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1885         88  AM-HAS-GROUP                     VALUE '2'.
  1886     12  AM-STATUS                         PIC X.
  1887         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1888         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1889         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1890         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1891         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1892         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1893     12  AM-REMIT-TO                       PIC 99.
  1894     12  AM-ID-NO                          PIC X(11).
  1895
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL650.cbl
  1896     12  AM-CAL-TABLE                      PIC XX.
  1897     12  AM-LF-DEVIATION                   PIC XXX.
  1898     12  AM-AH-DEVIATION                   PIC XXX.
  1899     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1900     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1901     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1902     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1903     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1904     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1905
  1906     12  AM-USER-FIELDS.
  1907         16  AM-FLD-1                      PIC XX.
  1908         16  AM-FLD-2                      PIC XX.
  1909         16  AM-FLD-3                      PIC XX.
  1910         16  AM-FLD-4                      PIC XX.
  1911         16  AM-FLD-5                      PIC XX.
  1912
  1913     12  AM-1ST-PROD-DATE.
  1914         16  AM-1ST-PROD-YR                PIC XX.
  1915         16  AM-1ST-PROD-MO                PIC XX.
  1916         16  AM-1ST-PROD-DA                PIC XX.
  1917     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1918     12  AM-CERTS-PURGED-DATE.
  1919         16  AM-PUR-YR                     PIC XX.
  1920         16  AM-PUR-MO                     PIC XX.
  1921         16  AM-PUR-DA                     PIC XX.
  1922     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1923     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1924     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1925     12  AM-INACTIVE-DATE.
  1926         16  AM-INA-MO                     PIC 99.
  1927         16  AM-INA-DA                     PIC 99.
  1928         16  AM-INA-YR                     PIC 99.
  1929     12  AM-AR-HI-CERT-DATE                PIC XX.
  1930
  1931     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1932     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1933
  1934     12  AM-OB-PAYMENT-MODE                PIC X.
  1935         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1936         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1937         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1938         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1939
  1940     12  AM-AH-ONLY-INDICATOR              PIC X.
  1941         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1942         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1943
  1944     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1945
  1946     12  AM-OVER-SHORT.
  1947         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1948         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1949
  1950     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1951     12  AM-DCC-CLP-STATE                  PIC XX.
  1952
  1953     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL650.cbl
  1954     12  AM-RECALC-REIN                    PIC X.
  1955
  1956     12  AM-REI-TABLE                      PIC XXX.
  1957     12  AM-REI-ET-LF                      PIC X.
  1958     12  AM-REI-ET-AH                      PIC X.
  1959     12  AM-REI-PE-LF                      PIC X.
  1960     12  AM-REI-PE-AH                      PIC X.
  1961     12  AM-REI-PRT-ST                     PIC X.
  1962     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1963     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1964     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1965     12  AM-REI-GROUP-A                    PIC X(6).
  1966     12  AM-REI-MORT                       PIC X(4).
  1967     12  AM-REI-PRT-OW                     PIC X.
  1968     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1969     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1970     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1971     12  AM-REI-GROUP-B                    PIC X(6).
  1972
  1973     12  AM-TRUST-TYPE                     PIC X(2).
  1974
  1975     12  AM-EMPLOYER-STMT-USED             PIC X.
  1976     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1977
  1978     12  AM-STD-AH-TYPE                    PIC XX.
  1979     12  AM-EARN-METHODS.
  1980         16  AM-EARN-METHOD-R              PIC X.
  1981             88 AM-REF-RL-R78                 VALUE 'R'.
  1982             88 AM-REF-RL-PR                  VALUE 'P'.
  1983             88 AM-REF-RL-MEAN                VALUE 'M'.
  1984             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1985         16  AM-EARN-METHOD-L              PIC X.
  1986             88 AM-REF-LL-R78                 VALUE 'R'.
  1987             88 AM-REF-LL-PR                  VALUE 'P'.
  1988             88 AM-REF-LL-MEAN                VALUE 'M'.
  1989             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1990         16  AM-EARN-METHOD-A              PIC X.
  1991             88 AM-REF-AH-R78                 VALUE 'R'.
  1992             88 AM-REF-AH-PR                  VALUE 'P'.
  1993             88 AM-REF-AH-MEAN                VALUE 'M'.
  1994             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1995             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1996             88 AM-REF-AH-NET                 VALUE 'N'.
  1997
  1998     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1999     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2000     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2001
  2002     12  AM-RET-Y-N                        PIC X.
  2003     12  AM-RET-P-E                        PIC X.
  2004     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2005     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2006     12  AM-RET-GRP                        PIC X(6).
  2007     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2008         16  AM-POOL-PRIME                 PIC XXX.
  2009         16  AM-POOL-SUB                   PIC XXX.
  2010     12  AM-RETRO-EARNINGS.
  2011         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL650.cbl
  2012         16  AM-RET-EARN-L                 PIC X.
  2013         16  AM-RET-EARN-A                 PIC X.
  2014     12  AM-RET-ST-TAX-USE                 PIC X.
  2015         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2016         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2017     12  AM-RETRO-BEG-EARNINGS.
  2018         16  AM-RET-BEG-EARN-R             PIC X.
  2019         16  AM-RET-BEG-EARN-L             PIC X.
  2020         16  AM-RET-BEG-EARN-A             PIC X.
  2021     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2022     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2023
  2024     12  AM-USER-SELECT-OPTIONS.
  2025         16  AM-USER-SELECT-1              PIC X(10).
  2026         16  AM-USER-SELECT-2              PIC X(10).
  2027         16  AM-USER-SELECT-3              PIC X(10).
  2028         16  AM-USER-SELECT-4              PIC X(10).
  2029         16  AM-USER-SELECT-5              PIC X(10).
  2030
  2031     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2032
  2033     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2034
  2035     12  AM-RPT045A-SWITCH                 PIC X.
  2036         88  RPT045A-OFF                   VALUE 'N'.
  2037
  2038     12  AM-INSURANCE-LIMITS.
  2039         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2040         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2041
  2042     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2043         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2044
  2045     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2046         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2047         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2048
  2049     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2050
  2051     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2052     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2053     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2054     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2055     12  AM-DCC-UEF-STATE                  PIC XX.
  2056     12  FILLER                            PIC XXX.
  2057     12  AM-REPORT-CODE-3                  PIC X(10).
  2058*    12  FILLER                            PIC X(22).
  2059
  2060     12  AM-RESERVE-DATE.
  2061         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2062         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2063         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2064
  2065     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2066     12  AM-NOTIFICATION-TYPES.
  2067         16  AM-NOTIF-OF-LETTERS           PIC X.
  2068         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2069         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL650.cbl
  2070         16  AM-NOTIF-OF-STATUS            PIC X.
  2071
  2072     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2073         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2074         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2075         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2076         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2077
  2078     12  AM-BENEFIT-CONTROLS.
  2079         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2080             20  AM-BENEFIT-CODE           PIC XX.
  2081             20  AM-BENEFIT-TYPE           PIC X.
  2082             20  AM-BENEFIT-REVISION       PIC XXX.
  2083             20  AM-BENEFIT-REM-TERM       PIC X.
  2084             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2085             20  FILLER                    PIC XX.
  2086         16  FILLER                        PIC X(80).
  2087
  2088     12  AM-TRANSFER-DATA.
  2089         16  AM-TRANSFERRED-FROM.
  2090             20  AM-TRNFROM-CARRIER        PIC X.
  2091             20  AM-TRNFROM-GROUPING.
  2092                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2093                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2094             20  AM-TRNFROM-STATE          PIC XX.
  2095             20  AM-TRNFROM-ACCOUNT.
  2096                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2097                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2098             20  AM-TRNFROM-DTE            PIC XX.
  2099         16  AM-TRANSFERRED-TO.
  2100             20  AM-TRNTO-CARRIER          PIC X.
  2101             20  AM-TRNTO-GROUPING.
  2102                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2103                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2104             20  AM-TRNTO-STATE            PIC XX.
  2105             20  AM-TRNTO-ACCOUNT.
  2106                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2107                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2108             20  AM-TRNTO-DTE              PIC XX.
  2109         16  FILLER                        PIC X(10).
  2110
  2111     12  AM-SAVED-REMIT-TO                 PIC 99.
  2112
  2113     12  AM-COMM-STRUCTURE-SAVED.
  2114         16  AM-DEFN-1-SAVED.
  2115             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2116                 24  AM-AGT-SV             PIC X(10).
  2117                 24  AM-COM-TYP-SV         PIC X.
  2118                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2119                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2120                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2121                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2122                 24  FILLER                PIC X.
  2123                 24  AM-GL-CODES-SV        PIC X.
  2124                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2125                 24  FILLER                PIC X.
  2126         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2127             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL650.cbl
  2128                 24  FILLER                PIC X(11).
  2129                 24  AM-L-COMA-SV          PIC XXX.
  2130                 24  AM-J-COMA-SV          PIC XXX.
  2131                 24  AM-A-COMA-SV          PIC XXX.
  2132                 24  FILLER                PIC X(6).
  2133
  2134     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2135         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2136            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2137            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2138            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2139
  2140     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2141     12  FILLER                            PIC X(120).
  2142
  2143     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2144         16  AM-CONTROL-NAME               PIC X(30).
  2145         16  AM-EXECUTIVE-ONE.
  2146             20  AM-EXEC1-NAME             PIC X(15).
  2147             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2148                                                          COMP-3.
  2149             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2150                                                          COMP-3.
  2151         16  AM-EXECUTIVE-TWO.
  2152             20  AM-EXEC2-NAME             PIC X(15).
  2153             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2154                                                          COMP-3.
  2155             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2156                                                          COMP-3.
  2157
  2158     12  AM-RETRO-ADDITIONAL-DATA.
  2159         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2160         16  AM-RETRO-PREM-P-E             PIC X.
  2161         16  AM-RETRO-CLMS-P-I             PIC X.
  2162         16  AM-RETRO-RET-BRACKET-LF.
  2163             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2164                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2165                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2166             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2167                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2168                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2169             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2170                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2171                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2172         16  AM-RETRO-RET-BRACKET-AH.
  2173             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2174                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2175                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2176                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2177             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2178                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2179                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2180             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2181                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2182                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2183
  2184     12  AM-COMMENTS.
  2185         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL650.cbl
  2186
  2187     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2188         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2189         16  AM-FLI-BILLING-CODE           PIC X.
  2190         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2191         16  AM-FLI-UNITED-IDENT           PIC X.
  2192         16  AM-FLI-INTEREST-LOST-DATA.
  2193             20  AM-FLI-BANK-NO            PIC X(5).
  2194             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2195             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2196             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2197         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2198             20  AM-FLI-AGT                PIC X(9).
  2199             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2200             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2201         16  FILLER                        PIC X(102).
  2202
  2203     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2204         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2205             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2206             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2207             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2208             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2209             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2210         16  FILLER                          PIC X(10).
  2211******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL650.cbl
  2213*    COPY ERCCOMP.
  2214******************************************************************
  2215*                                                                *
  2216*                                                                *
  2217*                            ERCCOMP                             *
  2218*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2219*                            VMOD=2.019                          *
  2220*                                                                *
  2221*   ONLINE CREDIT SYSTEM                                         *
  2222*                                                                *
  2223*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2224*                                                                *
  2225*   FILE TYPE = VSAM,KSDS                                        *
  2226*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2227*                                                                *
  2228*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2229*       ALTERNATE PATH = NONE                                    *
  2230*                                                                *
  2231*   LOG = NO                                                     *
  2232*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2233*                                                                *
  2234******************************************************************
  2235*                   C H A N G E   L O G
  2236*
  2237* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2238*-----------------------------------------------------------------
  2239*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2240* EFFECTIVE    NUMBER
  2241*-----------------------------------------------------------------
  2242* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2243* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2244* 092205    2005050300006  PEMA  ADD LEASE FEE
  2245* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2246* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2247* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2248* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2249* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2250* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2251******************************************************************
  2252
  2253 01  COMPENSATION-MASTER.
  2254     12  CO-RECORD-ID                          PIC XX.
  2255         88  VALID-CO-ID                          VALUE 'CO'.
  2256
  2257     12  CO-CONTROL-PRIMARY.
  2258         16  CO-COMPANY-CD                     PIC X.
  2259         16  CO-CONTROL.
  2260             20  CO-CTL-1.
  2261                 24  CO-CARR-GROUP.
  2262                     28  CO-CARRIER            PIC X.
  2263                     28  CO-GROUPING.
  2264                         32  CO-GROUP-PREFIX   PIC XXX.
  2265                         32  CO-GROUP-PRIME    PIC XXX.
  2266                 24  CO-RESP-NO.
  2267                     28  CO-RESP-PREFIX        PIC X(4).
  2268                     28  CO-RESP-PRIME         PIC X(6).
  2269             20  CO-CTL-2.
  2270                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL650.cbl
  2271                     28  CO-ACCT-PREFIX        PIC X(4).
  2272                     28  CO-ACCT-PRIME         PIC X(6).
  2273         16  CO-TYPE                           PIC X.
  2274             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2275             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2276             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2277
  2278     12  CO-MAINT-INFORMATION.
  2279         16  CO-LAST-MAINT-DT                  PIC XX.
  2280         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2281         16  CO-LAST-MAINT-USER                PIC X(4).
  2282     12  FILLER                                PIC XX.
  2283     12  CO-STMT-TYPE                          PIC XXX.
  2284     12  CO-COMP-TYPE                          PIC X.
  2285         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2286     12  CO-STMT-OWNER                         PIC X(4).
  2287     12  CO-BALANCE-CONTROL                    PIC X.
  2288         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2289         88  CO-NO-BALANCE                        VALUE 'N'.
  2290
  2291     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2292         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2293         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2294         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2295
  2296     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2297         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2298         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2299
  2300     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2301     12  CO-GA-DIRECT-DEP                      PIC X.
  2302     12  CO-FUTURE-SPACE                       PIC X.
  2303         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2304
  2305     12  CO-ACCT-NAME                          PIC X(30).
  2306     12  CO-MAIL-NAME                          PIC X(30).
  2307     12  CO-ADDR-1                             PIC X(30).
  2308     12  CO-ADDR-2                             PIC X(30).
  2309     12  CO-ADDR-3.
  2310         16  CO-ADDR-CITY                      PIC X(27).
  2311         16  CO-ADDR-STATE                     PIC XX.
  2312     12  CO-CSO-1099                           PIC X.
  2313     12  CO-ZIP.
  2314         16  CO-ZIP-PRIME.
  2315             20  CO-ZIP-PRI-1ST                PIC X.
  2316                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2317             20  FILLER                        PIC X(4).
  2318         16  CO-ZIP-PLUS4                      PIC X(4).
  2319     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2320         16  CO-CAN-POSTAL-1                   PIC XXX.
  2321         16  CO-CAN-POSTAL-2                   PIC XXX.
  2322         16  FILLER                            PIC XXX.
  2323     12  CO-SOC-SEC                            PIC X(13).
  2324     12  CO-TELEPHONE.
  2325         16  CO-AREA-CODE                      PIC XXX.
  2326         16  CO-PREFIX                         PIC XXX.
  2327         16  CO-PHONE                          PIC X(4).
  2328
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL650.cbl
  2329     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2330
  2331     12  CO-AR-BAL-LEVEL                       PIC X.
  2332         88  CO-AR-REF-LVL                        VALUE '1'.
  2333         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2334         88  CO-AR-BILL-LVL                       VALUE '2'.
  2335         88  CO-AR-AGT-LVL                        VALUE '3'.
  2336         88  CO-AR-FR-LVL                         VALUE '4'.
  2337
  2338     12  CO-AR-NORMAL-PRINT                    PIC X.
  2339         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2340         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2341
  2342     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2343
  2344     12  CO-AR-REPORTING                       PIC X.
  2345         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2346         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2347
  2348     12  CO-AR-PULL-CHECK                      PIC X.
  2349         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2350         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2351
  2352     12  CO-AR-BALANCE-PRINT                   PIC X.
  2353         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2354
  2355     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2356         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2357         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2358         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2359
  2360     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2361
  2362     12  CO-USER-CODE                          PIC X.
  2363     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2364
  2365******************************************************************
  2366*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2367*    THE LAST MONTH END RUN.
  2368******************************************************************
  2369
  2370     12  CO-LAST-ACTIVITY-DATE.
  2371         16  CO-ACT-YEAR                       PIC 99.
  2372         16  CO-ACT-MONTH                      PIC 99.
  2373         16  CO-ACT-DAY                        PIC 99.
  2374
  2375     12  CO-LAST-STMT-DT.
  2376         16  CO-LAST-STMT-YEAR                 PIC 99.
  2377         16  CO-LAST-STMT-MONTH                PIC 99.
  2378         16  CO-LAST-STMT-DAY                  PIC 99.
  2379
  2380     12  CO-MO-END-TOTALS.
  2381         16  CO-MONTHLY-TOTALS.
  2382             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2383             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2384             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2385             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2386             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL650.cbl
  2387
  2388         16  CO-AGING-TOTALS.
  2389             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2390             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2391             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2392             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2393
  2394         16  CO-YTD-TOTALS.
  2395             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2396             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2397
  2398         16  CO-OVER-UNDER-TOTALS.
  2399             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2400             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2401
  2402     12  CO-MISCELLANEOUS-TOTALS.
  2403         16  CO-FICA-TOTALS.
  2404             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2405             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2406
  2407         16  CO-CLAIM-TOTALS.
  2408             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2409             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2410
  2411******************************************************************
  2412*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2413*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2414******************************************************************
  2415
  2416     12  CO-CURRENT-TOTALS.
  2417         16  CO-CURRENT-LAST-STMT-DT.
  2418             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2419             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2420             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2421
  2422         16  CO-CURRENT-MONTHLY-TOTALS.
  2423             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2424             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2425             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2426             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2427             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2428
  2429         16  CO-CURRENT-AGING-TOTALS.
  2430             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2431             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2432             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2433             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2434
  2435         16  CO-CURRENT-YTD-TOTALS.
  2436             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2437             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2438
  2439     12  CO-PAID-COMM-TOTALS.
  2440         16  CO-YTD-PAID-COMMS.
  2441             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2442             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2443
  2444     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL650.cbl
  2445         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2446         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2447
  2448     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2449         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2450         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2451         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2452         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2453         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2454         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2455         88  CO-FINAL-LETTER                  VALUE 'F'.
  2456         88  CO-RECONCILING                   VALUE 'R'.
  2457         88  CO-PHONE-CALL                    VALUE 'P'.
  2458         88  CO-LEGAL                         VALUE 'L'.
  2459         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2460         88  CO-WRITE-OFF                     VALUE 'W'.
  2461         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2462
  2463     12  CO-CSR-CODE                       PIC X(4).
  2464
  2465     12  CO-GA-STATUS-INFO.
  2466         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2467         16  CO-GA-TERMINATION-DT          PIC XX.
  2468         16  CO-GA-STATUS-CODE             PIC X.
  2469             88  CO-GA-ACTIVE                 VALUE 'A'.
  2470             88  CO-GA-INACTIVE               VALUE 'I'.
  2471             88  CO-GA-PENDING                VALUE 'P'.
  2472         16  CO-GA-COMMENTS.
  2473             20  CO-GA-COMMENT-1           PIC X(40).
  2474             20  CO-GA-COMMENT-2           PIC X(40).
  2475             20  CO-GA-COMMENT-3           PIC X(40).
  2476             20  CO-GA-COMMENT-4           PIC X(40).
  2477
  2478     12  CO-RPTCD2                         PIC X(10).
  2479     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2480         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2481         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2482
  2483     12  CO-TYPE-AGENT                     PIC X(01).
  2484         88  CO-CORPORATION                   VALUE 'C'.
  2485         88  CO-PARTNERSHIP                   VALUE 'P'.
  2486         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2487         88  CO-TRUST                         VALUE 'T'.
  2488         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2489
  2490     12  CO-FAXNO.
  2491         16  CO-FAX-AREA-CODE                  PIC XXX.
  2492         16  CO-FAX-PREFIX                     PIC XXX.
  2493         16  CO-FAX-PHONE                      PIC X(4).
  2494
  2495     12  CO-BANK-INFORMATION.
  2496         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2497         16  CO-BANK-TRANSIT-NON REDEFINES
  2498             CO-BANK-TRANSIT-NO                PIC 9(8).
  2499
  2500         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2501     12  CO-MISC-DEDUCT-INFO REDEFINES
  2502                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL650.cbl
  2503         16  CO-MD-GL-ACCT                     PIC X(10).
  2504         16  CO-MD-DIV                         PIC XX.
  2505         16  CO-MD-CENTER                      PIC X(4).
  2506         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2507         16  CO-CREATE-AP-CHECK                PIC X.
  2508         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2509         16  FILLER                            PIC XXX.
  2510     12  CO-ACH-STATUS                         PIC X.
  2511         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2512         88  CO-ACH-PENDING                        VALUE 'P'.
  2513
  2514     12  CO-BILL-SW                            PIC X.
  2515     12  CO-CONTROL-NAME                       PIC X(30).
  2516     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2517     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2518     12  CO-CLP-STATE                          PIC XX.
  2519     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2520     12  CO-SPP-REFUND-EDIT                    PIC X.
  2521
  2522******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL650.cbl
  2524*    COPY ERCNAME.
  2525******************************************************************
  2526*                                                                *
  2527*                                                                *
  2528*                            ERCNAME                             *
  2529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2530*                            VMOD=2.003                          *
  2531*                                                                *
  2532*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2533*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2534*                                                                *
  2535*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2536*                                                                *
  2537*   FILE TYPE = VSAM,KSDS                                        *
  2538*   RECORD SIZE = 160   RECFORM = FIX                            *
  2539*                                                                *
  2540*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2541*                                                                *
  2542*   LOG = NO                                                     *
  2543*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2544*                                                                *
  2545*                                                                *
  2546******************************************************************
  2547
  2548 01  NAME-LOOKUP-MASTER.
  2549     12  NL-RECORD-ID                PIC  X(02).
  2550         88  VALID-NL-ID                         VALUE 'NL'.
  2551
  2552     12  NL-RECORD-KEY.
  2553         16  NL-CONTROL-PRIMARY.
  2554             20  NL-COMPANY-CD       PIC  X(01).
  2555             20  NL-NAME             PIC  X(30).
  2556             20  NL-RECORD-TYPE      PIC  X(01).
  2557                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2558                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2559                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2560
  2561         16  NL-ACCOUNT-MASTER.
  2562             20  NL-AM-COMPANY-CD    PIC  X(01).
  2563             20  NL-AM-CARRIER       PIC  X(01).
  2564             20  NL-AM-GROUPING      PIC  X(06).
  2565             20  NL-AM-STATE         PIC  X(02).
  2566             20  NL-AM-ACCOUNT       PIC  X(10).
  2567             20  FILLER              PIC  X(09).
  2568
  2569         16  NL-COMPENSATION-MASTER
  2570                                 REDEFINES  NL-ACCOUNT-MASTER.
  2571             20  NL-CO-COMPANY-CD    PIC  X(01).
  2572             20  NL-CO-CARRIER       PIC  X(01).
  2573             20  NL-CO-GROUPING      PIC  X(06).
  2574             20  NL-CO-RESP-NO       PIC  X(10).
  2575             20  NL-CO-ACCOUNT       PIC  X(10).
  2576             20  NL-CO-TYPE          PIC  X(01).
  2577
  2578         16  NL-REINSURANCE-RECORD
  2579                                 REDEFINES  NL-ACCOUNT-MASTER.
  2580             20  NL-RE-COMPANY-CD    PIC  X(01).
  2581             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL650.cbl
  2582             20  NL-RE-COMPANY.
  2583                 24  NL-RE-COMP      PIC  X(03).
  2584                 24  NL-RE-CO-SUB    PIC  X(03).
  2585             20  NL-RE-TABLE         PIC  X(03).
  2586             20  FILLER              PIC  X(18).
  2587
  2588     12  NL-MAINT-INFORMATION.
  2589         16  NL-LAST-MAINT-DT        PIC  X(02).
  2590         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2591         16  NL-LAST-MAINT-USER      PIC  X(04).
  2592         16  FILLER                  PIC  X(10).
  2593
  2594     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2595         16  NL-RE-LEVEL             PIC  9(02).
  2596
  2597     12  NL-CITY                     PIC  X(15).
  2598     12  NL-ST                       PIC  XX.
  2599
  2600******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL650.cbl
  2602*    COPY ERCPLAN.
  2603******************************************************************
  2604*                                                                *
  2605*                                                                *
  2606*                            ERCPLAN                             *
  2607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2608*                            VMOD=2.003                          *
  2609*                                                                *
  2610*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2611*                                                                *
  2612*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2613*   PLAN MASTER                                                  *
  2614*                                                                *
  2615*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2616*                                                                *
  2617*   FILE TYPE = VSAM,KSDS                                        *
  2618*   RECORD SIZE = 420   RECFORM = FIX                            *
  2619*                                                                *
  2620*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2621*       ALTERNATE PATH1 = N/A                                    *
  2622*                                                                *
  2623*   LOG = NO                                                     *
  2624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2625*                                                                *
  2626*                                                                *
  2627******************************************************************
  2628
  2629 01  PLAN-MASTER.
  2630     12  PL-RECORD-ID                      PIC XX.
  2631         88  VALID-PL-ID                      VALUE 'PL'.
  2632
  2633     12  PL-CONTROL-PRIMARY.
  2634         16  PL-COMPANY-CD                 PIC X.
  2635         16  PL-MSTR-CNTRL.
  2636             20  PL-CONTROL-A.
  2637                 24  PL-CARRIER            PIC X.
  2638                 24  PL-GROUPING           PIC X(6).
  2639                 24  PL-STATE              PIC XX.
  2640                 24  PL-ACCOUNT            PIC X(10).
  2641             20  PL-BENEFIT-TYPE           PIC X.
  2642             20  PL-BENEFIT-CODE           PIC XX.
  2643             20  PL-REVISION-NO            PIC X(3).
  2644
  2645     12  PL-CONTROL-BY-VAR-GRP.
  2646         16  PL-COMPANY-CD-A1              PIC X.
  2647         16  PL-VG-CARRIER                 PIC X.
  2648         16  PL-VG-GROUPING                PIC X(6).
  2649         16  PL-VG-STATE                   PIC XX.
  2650         16  PL-VG-ACCOUNT                 PIC X(10).
  2651         16  PL-BENEFIT-TYPE-A1            PIC X.
  2652         16  PL-BENEFIT-CODE-A1            PIC XX.
  2653         16  PL-REVISION-NO-A1             PIC 999.
  2654
  2655     12  PL-MAINT-INFORMATION.
  2656         16  PL-LAST-MAINT-DT              PIC XX.
  2657         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2658         16  PL-LAST-MAINT-USER            PIC X(4).
  2659         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL650.cbl
  2660
  2661     12  PL-LIABILITY-LIMITS.
  2662         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2663         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2664             20  PL-LM-AGE                 PIC S99        COMP-3.
  2665             20  PL-LM-DUR                 PIC S999       COMP-3.
  2666             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2667             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2668
  2669     12  FILLER                            PIC X(30).
  2670
  2671     12  PL-GL-ACCOUNT-NOS.
  2672         16  PL-PREMIUM-GL                 PIC X(8).
  2673         16  PL-COMM-GL                    PIC X(8).
  2674         16  PL-CLAIM-GL                   PIC X(8).
  2675     12  FILLER                            PIC X(24).
  2676     12  PL-TOLERANCES.
  2677         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2678         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2679         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2680         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2681         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2682         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2683     12  PL-OVER-SHORT.
  2684         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2685         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2686     12  FILLER                            PIC X(24).
  2687     12  PLAN-MISC.
  2688         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2689         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2690         16  PL-IG                         PIC X.
  2691         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2692         16  PL-POLICY-FORM                PIC X(12).
  2693         16  PL-EDIT-FOR-FORM              PIC X(01).
  2694         16  PL-DEV-CODE                   PIC XXX.
  2695         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2696         16  PL-CALC-METHOD                PIC X.
  2697         16  PL-BENEFIT-GROUP              PIC X(05).
  2698         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2699
  2700         16  FILLER                        PIC X(99).
  2701******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL650.cbl
  2703*    COPY ELCCNTL.
  2704******************************************************************
  2705*                                                                *
  2706*                                                                *
  2707*                            ELCCNTL.                            *
  2708*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2709*                            VMOD=2.059                          *
  2710*                                                                *
  2711*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2712*                                                                *
  2713*   FILE TYPE = VSAM,KSDS                                        *
  2714*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2715*                                                                *
  2716*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2717*       ALTERNATE INDEX = NONE                                   *
  2718*                                                                *
  2719*   LOG = YES                                                    *
  2720*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2721******************************************************************
  2722*                   C H A N G E   L O G
  2723*
  2724* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2725*-----------------------------------------------------------------
  2726*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2727* EFFECTIVE    NUMBER
  2728*-----------------------------------------------------------------
  2729* 082503                   PEMA  ADD BENEFIT GROUP
  2730* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2731* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2732* 092705    2005050300006  PEMA  ADD SPP LEASES
  2733* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2734* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2735* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2736* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2737* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2738* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2739* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2740* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2741* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2742* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2743******************************************************************
  2744*
  2745 01  CONTROL-FILE.
  2746     12  CF-RECORD-ID                       PIC XX.
  2747         88  VALID-CF-ID                        VALUE 'CF'.
  2748
  2749     12  CF-CONTROL-PRIMARY.
  2750         16  CF-COMPANY-ID                  PIC XXX.
  2751         16  CF-RECORD-TYPE                 PIC X.
  2752             88  CF-COMPANY-MASTER              VALUE '1'.
  2753             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2754             88  CF-STATE-MASTER                VALUE '3'.
  2755             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2756             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2757             88  CF-CARRIER-MASTER              VALUE '6'.
  2758             88  CF-MORTALITY-MASTER            VALUE '7'.
  2759             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2760             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL650.cbl
  2761             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2762             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2763             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2764             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2765             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2766             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2767             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2768             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2769             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2770         16  CF-ACCESS-CD-GENL              PIC X(4).
  2771         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2772             20  CF-PROCESSOR               PIC X(4).
  2773         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2774             20  CF-STATE-CODE              PIC XX.
  2775             20  FILLER                     PIC XX.
  2776         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2777             20  FILLER                     PIC XX.
  2778             20  CF-HI-BEN-IN-REC           PIC XX.
  2779         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2780             20  FILLER                     PIC XXX.
  2781             20  CF-CARRIER-CNTL            PIC X.
  2782         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2783             20  FILLER                     PIC XX.
  2784             20  CF-HI-TYPE-IN-REC          PIC 99.
  2785         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2786             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2787                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2788             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2789             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2790         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2791             20  FILLER                     PIC X.
  2792             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2793         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2794             20  FILLER                     PIC XX.
  2795             20  CF-MORTGAGE-PLAN           PIC XX.
  2796         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2797
  2798     12  CF-LAST-MAINT-DT                   PIC XX.
  2799     12  CF-LAST-MAINT-BY                   PIC X(4).
  2800     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2801
  2802     12  CF-RECORD-BODY                     PIC X(728).
  2803
  2804
  2805****************************************************************
  2806*             COMPANY MASTER RECORD                            *
  2807****************************************************************
  2808
  2809     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2810         16  CF-COMPANY-ADDRESS.
  2811             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2812             20  CF-CL-IN-CARE-OF           PIC X(30).
  2813             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2814             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2815             20  CF-CL-CITY-STATE           PIC X(30).
  2816             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2817             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2818         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL650.cbl
  2819         16  CF-COMPANY-PASSWORD            PIC X(8).
  2820         16  CF-SECURITY-OPTION             PIC X.
  2821             88  ALL-SECURITY                   VALUE '1'.
  2822             88  COMPANY-VERIFY                 VALUE '2'.
  2823             88  PROCESSOR-VERIFY               VALUE '3'.
  2824             88  NO-SECURITY                    VALUE '4'.
  2825             88  ALL-BUT-TERM                   VALUE '5'.
  2826         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2827             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2828         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2829             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2830         16  CF-INFORCE-LOCATION            PIC X.
  2831             88  CERTS-ARE-ONLINE               VALUE '1'.
  2832             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2833             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2834         16  CF-LOWER-CASE-LETTERS          PIC X.
  2835         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2836             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2837             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2838             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2839             88  CF-ACCNT-CNTL                  VALUE '3'.
  2840             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2841
  2842         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2843         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2844
  2845         16  CF-LGX-CREDIT-USER             PIC X.
  2846             88  CO-IS-NOT-USER                 VALUE 'N'.
  2847             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2848
  2849         16 CF-CREDIT-CALC-CODES.
  2850             20  CF-CR-REM-TERM-CALC PIC X.
  2851               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2852               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2853               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2854               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2855               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2856               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2857               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2858             20  CF-CR-R78-METHOD           PIC X.
  2859               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2860               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2861
  2862         16  CF-CLAIM-CONTROL-COUNTS.
  2863             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2864                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2865
  2866             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2867                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2868
  2869             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2870                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2871
  2872             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2873                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2874
  2875         16  CF-CURRENT-MONTH-END           PIC XX.
  2876
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL650.cbl
  2877         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2878             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2879             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2880             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2881             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2882                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2883                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2884             20  CF-CO-PREM-REJECT-SW       PIC X.
  2885                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2886                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2887             20  CF-CO-REF-REJECT-SW        PIC X.
  2888                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2889                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2890
  2891         16  CF-CO-REPORTING-DT             PIC XX.
  2892         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2893         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2894           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2895           88  CF-CO-MONTH-END                  VALUE '1'.
  2896
  2897         16  CF-LGX-CLAIM-USER              PIC X.
  2898             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2899             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2900
  2901         16  CF-CREDIT-EDIT-CONTROLS.
  2902             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2903             20  CF-MIN-AGE                 PIC 99.
  2904             20  CF-DEFAULT-AGE             PIC 99.
  2905             20  CF-MIN-TERM                PIC S999      COMP-3.
  2906             20  CF-MAX-TERM                PIC S999      COMP-3.
  2907             20  CF-DEFAULT-SEX             PIC X.
  2908             20  CF-JOINT-AGE-INPUT         PIC X.
  2909                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2910             20  CF-BIRTH-DATE-INPUT        PIC X.
  2911                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2912             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2913                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2914                 88  CF-ZERO-CARRIER            VALUE '1'.
  2915                 88  CF-ZERO-GROUPING           VALUE '2'.
  2916                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2917             20  CF-EDIT-SW                 PIC X.
  2918                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2919             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2920             20  CF-CR-PR-METHOD            PIC X.
  2921               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2922               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2923             20  FILLER                     PIC X.
  2924
  2925         16  CF-CREDIT-MISC-CONTROLS.
  2926             20  CF-REIN-TABLE-SW           PIC X.
  2927                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2928             20  CF-COMP-TABLE-SW           PIC X.
  2929                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2930             20  CF-EXPERIENCE-RETENTION-AGE
  2931                                            PIC S9        COMP-3.
  2932             20  CF-CONVERSION-DT           PIC XX.
  2933             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2934             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL650.cbl
  2935                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2936                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2937
  2938             20  CF-CR-CHECK-NO-CONTROL.
  2939                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2940                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2941                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2942                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2943                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2944                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2945
  2946                 24  CF-CR-CHECK-COUNT       REDEFINES
  2947                     CF-CR-CHECK-COUNTER      PIC X(4).
  2948
  2949                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2950                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2951
  2952                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2953                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2954                 24  CF-MAIL-PROCESSING       PIC X.
  2955                     88  MAIL-PROCESSING          VALUE 'Y'.
  2956
  2957         16  CF-MISC-SYSTEM-CONTROL.
  2958             20  CF-SYSTEM-C                 PIC X.
  2959                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2960             20  CF-SYSTEM-D                 PIC X.
  2961                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2962             20  CF-SOC-SEC-NO-SW            PIC X.
  2963                 88  SOC-SEC-NO-USED             VALUE '1'.
  2964             20  CF-MEMBER-NO-SW             PIC X.
  2965                 88  MEMBER-NO-USED              VALUE '1'.
  2966             20  CF-TAX-ID-NUMBER            PIC X(11).
  2967             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2968             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2969                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2970                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2971                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2972                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2973             20  CF-SYSTEM-E                 PIC X.
  2974                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2975
  2976         16  CF-LGX-LIFE-USER               PIC X.
  2977             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2978             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2979
  2980         16  CF-CR-MONTH-END-DT             PIC XX.
  2981
  2982         16  CF-FILE-MAINT-DATES.
  2983             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2984                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2985             20  CF-LAST-BATCH       REDEFINES
  2986                 CF-LAST-BATCH-NO               PIC X(4).
  2987             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2988             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2989             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2990             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2991             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2992             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL650.cbl
  2993             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2994             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2995             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2996             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2997
  2998         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2999         16  FILLER                         PIC X.
  3000
  3001         16  CF-ALT-MORT-CODE               PIC X(4).
  3002         16  CF-MEMBER-CAPTION              PIC X(10).
  3003
  3004         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3005             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3006             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3007             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3008             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3009             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3010
  3011         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3012
  3013         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3014         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3015         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3016         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3017
  3018         16  CF-AH-OVERRIDE-L1              PIC X.
  3019         16  CF-AH-OVERRIDE-L2              PIC XX.
  3020         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3021         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3022
  3023         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3024         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3025
  3026         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3027         16  CF-AR-LAST-EL860-DT            PIC XX.
  3028         16  CF-MP-MONTH-END-DT             PIC XX.
  3029
  3030         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3031         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3032             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3033
  3034         16  CF-AR-MONTH-END-DT             PIC XX.
  3035
  3036         16  CF-CRDTCRD-USER                PIC X.
  3037             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3038             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3039
  3040         16  CF-CC-MONTH-END-DT             PIC XX.
  3041
  3042         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3043
  3044         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3045             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3046             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3047             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3048         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3049         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3050         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL650.cbl
  3051         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3052             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3053             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3054         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3055         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3056         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3057             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3058         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3059
  3060         16  CF-CL-ZIP-CODE.
  3061             20  CF-CL-ZIP-PRIME.
  3062                 24  CF-CL-ZIP-1ST          PIC X.
  3063                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3064                 24  FILLER                 PIC X(4).
  3065             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3066         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3067             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3068             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3069             20  FILLER                     PIC XXX.
  3070
  3071         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3072         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3073         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3074         16  CF-CO-OPTION-START-DATE        PIC XX.
  3075         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3076           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3077                                                      '3' '4'.
  3078           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3079           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3080           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3081           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3082           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3083           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3084
  3085         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3086
  3087         16  CF-PAYMENT-APPROVAL-LEVELS.
  3088             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3089             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3090             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3091             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3092             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3093             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3094
  3095         16  CF-END-USER-REPORTING-USER     PIC X.
  3096             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3097             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3098
  3099         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3100             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3101             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3102
  3103         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3104
  3105         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3106         16  FILLER                         PIC X.
  3107
  3108         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL650.cbl
  3109             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3110             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3111             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3112
  3113         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3114
  3115         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3116             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3117             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3118
  3119         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3120             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3121             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3122
  3123         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3124
  3125         16  CF-CO-ACH-ID-CODE              PIC  X.
  3126             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3127             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3128             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3129         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3130         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3131         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3132         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3133         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3134         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3135         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3136         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3137         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3138                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3139         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3140                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3141
  3142         16  CF-CO-OVER-SHORT.
  3143             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3144             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3145
  3146*         16  FILLER                         PIC X(102).
  3147         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3148             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3149             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3150
  3151         16  CF-AH-APPROVAL-DAYS.
  3152             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3153             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3154             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3155             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3156
  3157         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3158
  3159         16  CF-APPROV-LEV-5.
  3160             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3161             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3162             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3163
  3164         16  FILLER                         PIC X(68).
  3165****************************************************************
  3166*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL650.cbl
  3167****************************************************************
  3168
  3169     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3170         16  CF-PROCESSOR-NAME              PIC X(30).
  3171         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3172         16  CF-PROCESSOR-TITLE             PIC X(26).
  3173         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3174                 88  MESSAGE-YES                VALUE 'Y'.
  3175                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3176
  3177*****************************************************
  3178****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3179****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3180****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3181****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3182*****************************************************
  3183
  3184         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3185             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3186             20  CF-APPLICATION-FORCE       PIC X.
  3187             20  CF-INDIVIDUAL-APP.
  3188                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3189                     28  CF-BROWSE-APP      PIC X.
  3190                     28  CF-UPDATE-APP      PIC X.
  3191
  3192         16  CF-CURRENT-TERM-ON             PIC X(4).
  3193         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3194             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3195             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3196             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3197             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3198             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3199             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3200             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3201         16  CF-PROCESSOR-CARRIER           PIC X.
  3202             88  NO-CARRIER-SECURITY            VALUE ' '.
  3203         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3204             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3205         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3206             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3207         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3208             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3209
  3210         16  CF-PROC-SYS-ACCESS-SW.
  3211             20  CF-PROC-CREDIT-CLAIMS-SW.
  3212                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3213                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3214                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3215                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3216             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3217                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3218                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3219             20  CF-PROC-LIFE-GNRLDGR-SW.
  3220                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3221                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3222                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3223                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3224             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL650.cbl
  3225                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3226                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3227         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3228             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3229             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3230         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3231
  3232         16  CF-APPROVAL-LEVEL                  PIC X.
  3233             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3234             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3235             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3236             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3237             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3238
  3239         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3240
  3241         16  CF-LANGUAGE-TYPE                   PIC X.
  3242             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3243             88  CF-LANG-IS-FR                      VALUE 'F'.
  3244
  3245         16  CF-CSR-IND                         PIC X.
  3246         16  FILLER                             PIC X(239).
  3247
  3248****************************************************************
  3249*             PROCESSOR/REMINDERS RECORD                       *
  3250****************************************************************
  3251
  3252     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3253         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3254             20  CF-START-REMIND-DT         PIC XX.
  3255             20  CF-END-REMIND-DT           PIC XX.
  3256             20  CF-REMINDER-TEXT           PIC X(50).
  3257         16  FILLER                         PIC X(296).
  3258
  3259
  3260****************************************************************
  3261*             STATE MASTER RECORD                              *
  3262****************************************************************
  3263
  3264     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3265         16  CF-STATE-ABBREVIATION          PIC XX.
  3266         16  CF-STATE-NAME                  PIC X(25).
  3267         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3268         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3269             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3270             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3271             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3272             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3273                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3274                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3275             20  CF-ST-PREM-REJECT-SW       PIC X.
  3276                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3277                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3278             20  CF-ST-REF-REJECT-SW        PIC X.
  3279                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3280                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3281         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3282         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL650.cbl
  3283         16  CF-ST-REFUND-RULES.
  3284             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3285             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3286             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3287         16  CF-ST-FST-PMT-EXTENSION.
  3288             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3289             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3290                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3291                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3292                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3293                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3294         16  CF-ST-STATE-CALL.
  3295             20  CF-ST-CALL-UNEARNED        PIC X.
  3296             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3297             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3298         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3299             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3300             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3301         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3302         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3303         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3304         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3305         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3306         16  FILLER                         PIC X.
  3307         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3308             20  CF-ST-BENEFIT-CD           PIC XX.
  3309             20  CF-ST-BENEFIT-KIND         PIC X.
  3310                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3311                 88  CF-ST-AH-KIND              VALUE 'A'.
  3312             20  CF-ST-REM-TERM-CALC        PIC X.
  3313                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3314                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3315                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3316                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3317                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3318                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3319                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3320                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3321
  3322             20  CF-ST-REFUND-CALC          PIC X.
  3323                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3324                 88  ST-REFD-BY-R78             VALUE '1'.
  3325                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3326                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3327                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3328                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3329                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3330                 88  ST-REFD-UTAH               VALUE '7'.
  3331                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3332                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3333                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3334
  3335             20  CF-ST-EARNING-CALC         PIC X.
  3336                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3337                 88  ST-EARN-BY-R78             VALUE '1'.
  3338                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3339                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3340                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL650.cbl
  3341                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3342                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3343                 88  ST-EARN-MEAN               VALUE '8'.
  3344                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3345
  3346             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3347                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3348                 88  ST-OVRD-BY-R78             VALUE '1'.
  3349                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3350                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3351                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3352                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3353                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3354                 88  ST-OVRD-MEAN               VALUE '8'.
  3355                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3356             20  FILLER                     PIC X.
  3357
  3358         16  CF-ST-COMMISSION-CAPS.
  3359             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3360             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3361             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3362             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3363         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3364                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3365
  3366         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3367
  3368         16  CF-ST-STATUTORY-INTEREST.
  3369             20  CF-ST-STAT-DATE-FROM       PIC X.
  3370                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3371                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3372             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3373             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3374             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3375             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3376             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3377
  3378         16  CF-ST-OVER-SHORT.
  3379             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3380             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3381
  3382         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3383
  3384         16  CF-ST-RT-CALC                  PIC X.
  3385
  3386         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3387         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3388         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3389         16  CF-ST-RF-LR-CALC               PIC X.
  3390         16  CF-ST-RF-LL-CALC               PIC X.
  3391         16  CF-ST-RF-LN-CALC               PIC X.
  3392         16  CF-ST-RF-AH-CALC               PIC X.
  3393         16  CF-ST-RF-CP-CALC               PIC X.
  3394*        16  FILLER                         PIC X(206).
  3395*CIDMOD         16  FILLER                         PIC X(192).
  3396         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3397             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3398         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL650.cbl
  3399         16  CF-ST-VFY-2ND-BENE             PIC X.
  3400         16  CF-ST-CAUSAL-STATE             PIC X.
  3401         16  FILLER                         PIC X(185).
  3402
  3403****************************************************************
  3404*             BENEFIT MASTER RECORD                            *
  3405****************************************************************
  3406
  3407     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3408         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3409             20  CF-BENEFIT-CODE            PIC XX.
  3410             20  CF-BENEFIT-NUMERIC  REDEFINES
  3411                 CF-BENEFIT-CODE            PIC XX.
  3412             20  CF-BENEFIT-ALPHA           PIC XXX.
  3413             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3414             20  CF-BENEFIT-COMMENT         PIC X(10).
  3415
  3416             20  CF-LF-COVERAGE-TYPE        PIC X.
  3417                 88  CF-REDUCING                VALUE 'R'.
  3418                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3419
  3420             20  CF-SPECIAL-CALC-CD         PIC X.
  3421                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3422                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3423                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3424                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3425                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3426                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3427                 88  CF-FARM-PLAN               VALUE 'F'.
  3428                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3429                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3430                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3431                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3432                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3433                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3434                 88  CF-PRUDENTIAL              VALUE 'P'.
  3435                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3436                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3437                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3438                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3439                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3440                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3441
  3442             20  CF-JOINT-INDICATOR         PIC X.
  3443                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3444
  3445*            20  FILLER                     PIC X(12).
  3446             20  cf-maximum-benefits        pic s999 comp-3.
  3447             20  FILLER                     PIC X(09).
  3448             20  CF-BENEFIT-CATEGORY        PIC X.
  3449             20  CF-LOAN-TYPE               PIC X(8).
  3450
  3451             20  CF-CO-REM-TERM-CALC        PIC X.
  3452                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3453                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3454                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3455                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3456                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL650.cbl
  3457
  3458             20  CF-CO-EARNINGS-CALC        PIC X.
  3459                 88  CO-EARN-BY-R78             VALUE '1'.
  3460                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3461                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3462                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3463                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3464                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3465                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3466                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3467
  3468             20  CF-CO-REFUND-CALC          PIC X.
  3469                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3470                 88  CO-REFD-BY-R78             VALUE '1'.
  3471                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3472                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3473                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3474                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3475                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3476                 88  CO-REFD-MEAN               VALUE '8'.
  3477                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3478                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3479                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3480
  3481             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3482                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3483                 88  CO-OVRD-BY-R78             VALUE '1'.
  3484                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3485                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3486                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3487                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3488                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3489                 88  CO-OVRD-MEAN               VALUE '8'.
  3490                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3491
  3492             20  CF-CO-BEN-I-G-CD           PIC X.
  3493                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3494                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3495                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3496
  3497         16  FILLER                         PIC X(304).
  3498
  3499
  3500****************************************************************
  3501*             CARRIER MASTER RECORD                            *
  3502****************************************************************
  3503
  3504     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3505         16  CF-ADDRESS-DATA.
  3506             20  CF-MAIL-TO-NAME            PIC X(30).
  3507             20  CF-IN-CARE-OF              PIC X(30).
  3508             20  CF-ADDRESS-LINE-1          PIC X(30).
  3509             20  CF-ADDRESS-LINE-2          PIC X(30).
  3510             20  CF-CITY-STATE              PIC X(30).
  3511             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3512             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3513
  3514         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL650.cbl
  3515             20  CF-CLAIM-NO-METHOD         PIC X.
  3516                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3517                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3518                 88  CLAIM-NO-SEQ               VALUE '3'.
  3519                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3520             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3521                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3522                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3523                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3524
  3525         16  CF-CHECK-NO-CONTROL.
  3526             20  CF-CHECK-NO-METHOD         PIC X.
  3527                 88  CHECK-NO-MANUAL            VALUE '1'.
  3528                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3529                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3530                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3531             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3532                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3533
  3534         16  CF-DOMICILE-STATE              PIC XX.
  3535
  3536         16  CF-EXPENSE-CONTROLS.
  3537             20  CF-EXPENSE-METHOD          PIC X.
  3538                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3539                 88  DOLLARS-PER-PMT            VALUE '2'.
  3540                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3541                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3542             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3543             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3544
  3545         16  CF-CORRESPONDENCE-CONTROL.
  3546             20  CF-LETTER-RESEND-OPT       PIC X.
  3547                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3548                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3549             20  FILLER                     PIC X(4).
  3550
  3551         16  CF-RESERVE-CONTROLS.
  3552             20  CF-MANUAL-SW               PIC X.
  3553                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3554             20  CF-FUTURE-SW               PIC X.
  3555                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3556             20  CF-PTC-SW                  PIC X.
  3557                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3558             20  CF-IBNR-SW                 PIC X.
  3559                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3560             20  CF-PTC-LF-SW               PIC X.
  3561                 88  CF-LF-PTC-USED             VALUE '1'.
  3562             20  CF-CDT-ACCESS-METHOD       PIC X.
  3563                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3564                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3565                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3566             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3567
  3568         16  CF-CLAIM-CALC-METHOD           PIC X.
  3569             88  360-PLUS-MONTHS                VALUE '1'.
  3570             88  365-PLUS-MONTHS                VALUE '2'.
  3571             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3572             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL650.cbl
  3573             88  365-DAILY                      VALUE '5'.
  3574
  3575         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3576         16  FILLER                         PIC X(11).
  3577
  3578         16  CF-LIMIT-AMOUNTS.
  3579             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3580             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3581             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3582             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3583             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3584             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3585             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3586             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3587             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3588             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3589
  3590         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3591         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3592         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3593
  3594         16  CF-ZIP-CODE.
  3595             20  CF-ZIP-PRIME.
  3596                 24  CF-ZIP-1ST             PIC X.
  3597                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3598                 24  FILLER                 PIC X(4).
  3599             20  CF-ZIP-PLUS4               PIC X(4).
  3600         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3601             20  CF-CAN-POSTAL-1            PIC XXX.
  3602             20  CF-CAN-POSTAL-2            PIC XXX.
  3603             20  FILLER                     PIC XXX.
  3604
  3605         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3606         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3607         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3608
  3609         16  CF-RATING-SWITCH               PIC X.
  3610             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3611             88  CF-NO-RATING                   VALUE 'N'.
  3612
  3613         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3614
  3615         16  CF-CARRIER-OVER-SHORT.
  3616             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3617             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3618
  3619         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3620         16  CF-SECPAY-SWITCH               PIC X.
  3621             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3622             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3623         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3624         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3625         16  FILLER                         PIC X(444).
  3626*        16  FILLER                         PIC X(452).
  3627
  3628
  3629****************************************************************
  3630*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL650.cbl
  3631****************************************************************
  3632
  3633     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3634         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3635                                INDEXED BY CF-MORT-NDX.
  3636             20  CF-MORT-TABLE              PIC X(5).
  3637             20  CF-MORT-TABLE-TYPE         PIC X.
  3638                 88  CF-MORT-JOINT              VALUE 'J'.
  3639                 88  CF-MORT-SINGLE             VALUE 'S'.
  3640                 88  CF-MORT-COMBINED           VALUE 'C'.
  3641                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3642                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3643             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3644             20  CF-MORT-AGE-METHOD         PIC XX.
  3645                 88  CF-AGE-LAST                VALUE 'AL'.
  3646                 88  CF-AGE-NEAR                VALUE 'AN'.
  3647             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3648             20  CF-MORT-ADJUSTMENT-DIRECTION
  3649                                            PIC X.
  3650                 88  CF-MINUS                   VALUE '-'.
  3651                 88  CF-PLUS                    VALUE '+'.
  3652             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3653             20  CF-MORT-JOINT-CODE         PIC X.
  3654                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3655             20  CF-MORT-PC-Q               PIC X.
  3656                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3657             20  CF-MORT-TABLE-CODE         PIC X(4).
  3658             20  CF-MORT-COMMENTS           PIC X(15).
  3659             20  FILLER                     PIC X(14).
  3660
  3661         16  FILLER                         PIC X(251).
  3662
  3663
  3664****************************************************************
  3665*             BUSSINESS TYPE MASTER RECORD                     *
  3666****************************************************************
  3667
  3668     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3669* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3670* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3671* AND RECORD 05 IS TYPES 81-99
  3672         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3673             20  CF-BUSINESS-TITLE          PIC  X(19).
  3674             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3675                                            PIC S9V9(4) COMP-3.
  3676             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3677             20  FILLER                     PIC  X.
  3678         16  FILLER                         PIC  X(248).
  3679
  3680
  3681****************************************************************
  3682*             TERMINAL MASTER RECORD                           *
  3683****************************************************************
  3684
  3685     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3686
  3687         16  CF-COMPANY-TERMINALS.
  3688             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL650.cbl
  3689                                  PIC X(4).
  3690         16  FILLER               PIC X(248).
  3691
  3692
  3693****************************************************************
  3694*             LIFE EDIT MASTER RECORD                          *
  3695****************************************************************
  3696
  3697     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3698         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3699             20  CF-LIFE-CODE-IN            PIC XX.
  3700             20  CF-LIFE-CODE-OUT           PIC XX.
  3701         16  FILLER                         PIC X(248).
  3702
  3703
  3704****************************************************************
  3705*             AH EDIT MASTER RECORD                            *
  3706****************************************************************
  3707
  3708     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3709         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3710             20  CF-AH-CODE-IN              PIC XXX.
  3711             20  CF-AH-CODE-OUT             PIC XX.
  3712         16  FILLER                         PIC X(248).
  3713
  3714
  3715****************************************************************
  3716*             CREDIBILITY TABLES                               *
  3717****************************************************************
  3718
  3719     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3720         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3721                             INDEXED BY CF-CRDB-NDX.
  3722             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3723             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3724             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3725         16  FILLER                         PIC  X(332).
  3726
  3727
  3728****************************************************************
  3729*             REPORT CUSTOMIZATION RECORD                      *
  3730****************************************************************
  3731
  3732     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3733         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3734             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3735             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3736             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3737**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3738****       A T-TRANSFER.                                   ****
  3739             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3740
  3741         16  FILLER                         PIC XX.
  3742
  3743         16  CF-CARRIER-CNTL-OPT.
  3744             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3745                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3746                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL650.cbl
  3747             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3748                                            PIC X.
  3749         16  CF-GROUP-CNTL-OPT.
  3750             20  CF-GROUP-OPT-SEQ           PIC 9.
  3751                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3752                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3753             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3754                                            PIC X(6).
  3755         16  CF-STATE-CNTL-OPT.
  3756             20  CF-STATE-OPT-SEQ           PIC 9.
  3757                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3758                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3759             20  CF-STATE-SELECT OCCURS 3 TIMES
  3760                                            PIC XX.
  3761         16  CF-ACCOUNT-CNTL-OPT.
  3762             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3763                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3764                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3765             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3766                                            PIC X(10).
  3767         16  CF-BUS-TYP-CNTL-OPT.
  3768             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3769                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3770                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3771             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3772                                            PIC XX.
  3773         16  CF-LF-TYP-CNTL-OPT.
  3774             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3775                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3776                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3777             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3778                                            PIC XX.
  3779         16  CF-AH-TYP-CNTL-OPT.
  3780             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3781                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3782                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3783             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3784                                            PIC XX.
  3785         16  CF-REPTCD1-CNTL-OPT.
  3786             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3787                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3788                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3789             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3790                                            PIC X(10).
  3791         16  CF-REPTCD2-CNTL-OPT.
  3792             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3793                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3794                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3795             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3796                                            PIC X(10).
  3797         16  CF-USER1-CNTL-OPT.
  3798             20  CF-USER1-OPT-SEQ           PIC 9.
  3799                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3800                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3801             20  CF-USER1-SELECT OCCURS 3 TIMES
  3802                                            PIC X(10).
  3803         16  CF-USER2-CNTL-OPT.
  3804             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL650.cbl
  3805                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3806                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3807             20  CF-USER2-SELECT OCCURS 3 TIMES
  3808                                            PIC X(10).
  3809         16  CF-USER3-CNTL-OPT.
  3810             20  CF-USER3-OPT-SEQ           PIC 9.
  3811                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3812                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3813             20  CF-USER3-SELECT OCCURS 3 TIMES
  3814                                            PIC X(10).
  3815         16  CF-USER4-CNTL-OPT.
  3816             20  CF-USER4-OPT-SEQ           PIC 9.
  3817                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3818                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3819             20  CF-USER4-SELECT OCCURS 3 TIMES
  3820                                            PIC X(10).
  3821         16  CF-USER5-CNTL-OPT.
  3822             20  CF-USER5-OPT-SEQ           PIC 9.
  3823                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3824                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3825             20  CF-USER5-SELECT OCCURS 3 TIMES
  3826                                            PIC X(10).
  3827         16  CF-REINS-CNTL-OPT.
  3828             20  CF-REINS-OPT-SEQ           PIC 9.
  3829                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3830                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3831             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3832                 24  CF-REINS-PRIME         PIC XXX.
  3833                 24  CF-REINS-SUB           PIC XXX.
  3834
  3835         16  CF-AGENT-CNTL-OPT.
  3836             20  CF-AGENT-OPT-SEQ           PIC 9.
  3837                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3838                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3839             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3840                                            PIC X(10).
  3841
  3842         16  FILLER                         PIC X(43).
  3843
  3844         16  CF-LOSS-RATIO-SELECT.
  3845             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3846             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3847         16  CF-ENTRY-DATE-SELECT.
  3848             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3849             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3850         16  CF-EFFECTIVE-DATE-SELECT.
  3851             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3852             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3853
  3854         16  CF-EXCEPTION-LIST-IND          PIC X.
  3855             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3856
  3857         16  FILLER                         PIC X(318).
  3858
  3859****************************************************************
  3860*                  EXCEPTION REPORTING RECORD                  *
  3861****************************************************************
  3862
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL650.cbl
  3863     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3864         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3865             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3866
  3867         16  CF-COMBINED-LIFE-AH-OPT.
  3868             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3869             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3870             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3871             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3872
  3873         16  CF-LIFE-OPT.
  3874             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3875             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3876             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3877             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3878             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3879             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3880             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3881             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3882             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3883             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3884
  3885         16  CF-AH-OPT.
  3886             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3887             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3888             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3889             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3890             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3891             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3892             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3893             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3894             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3895             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3896
  3897         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3898             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3899             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3900             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3901
  3902         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3903
  3904         16  FILLER                         PIC X(673).
  3905
  3906
  3907****************************************************************
  3908*             MORTGAGE SYSTEM PLAN RECORD                      *
  3909****************************************************************
  3910
  3911     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3912         16  CF-PLAN-TYPE                   PIC X.
  3913             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3914             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3915             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3916         16  CF-PLAN-ABBREV                 PIC XXX.
  3917         16  CF-PLAN-DESCRIPT               PIC X(10).
  3918         16  CF-PLAN-NOTES                  PIC X(20).
  3919         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3920         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL650.cbl
  3921             20  CF-PLAN-TERM-DATA.
  3922                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3923                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3924             20  CF-PLAN-AGE-DATA.
  3925                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3926                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3927                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3928             20  CF-PLAN-BENEFIT-DATA.
  3929                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3930                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3931                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3932                                            PIC S9(7)V99  COMP-3.
  3933         16  CF-PLAN-POLICY-FORMS.
  3934             20  CF-POLICY-FORM             PIC X(12).
  3935             20  CF-MASTER-APPLICATION      PIC X(12).
  3936             20  CF-MASTER-POLICY           PIC X(12).
  3937         16  CF-PLAN-RATING.
  3938             20  CF-RATE-CODE               PIC X(5).
  3939             20  CF-SEX-RATING              PIC X.
  3940                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3941                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3942             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3943             20  CF-SUB-STD-TYPE            PIC X.
  3944                 88  CF-PCT-OF-PREM            VALUE '1'.
  3945                 88  CF-PCT-OF-BENE            VALUE '2'.
  3946         16  CF-PLAN-PREM-TOLERANCES.
  3947             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3948             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3949         16  CF-PLAN-PYMT-TOLERANCES.
  3950             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3951             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3952         16  CF-PLAN-MISC-DATA.
  3953             20  FILLER                     PIC X.
  3954             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3955             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3956         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3957         16  CF-PLAN-IND-GRP                PIC X.
  3958             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3959                                                     '1'.
  3960             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3961                                                     '2'.
  3962         16  CF-MIB-SEARCH-SW               PIC X.
  3963             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3964             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3965             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3966             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3967         16  CF-ALPHA-SEARCH-SW             PIC X.
  3968             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3969             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3970             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3971             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3972             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3973             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3974             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3975             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3976             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3977             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3978                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL650.cbl
  3979                                                     'X' 'Y' 'Z'.
  3980         16  CF-EFF-DT-RULE-SW              PIC X.
  3981             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3982             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3983             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3984             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3985             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3986         16  FILLER                         PIC X(4).
  3987         16  CF-HEALTH-QUESTIONS            PIC X.
  3988             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3989         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3990         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3991         16  CF-PLAN-SNGL-JNT               PIC X.
  3992             88  CF-COMBINED-PLAN              VALUE 'C'.
  3993             88  CF-JNT-PLAN                   VALUE 'J'.
  3994             88  CF-SNGL-PLAN                  VALUE 'S'.
  3995         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3996         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3997         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3998         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3999         16  CF-RERATE-CNTL                 PIC  X.
  4000             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4001             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4002             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4003             88  CF-AUTO-RECALC                 VALUE '4'.
  4004         16  CF-BENEFIT-TYPE                PIC  X.
  4005             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4006             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4007         16  CF-POLICY-FEE                  PIC S999V99
  4008                                                    COMP-3.
  4009         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4010         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4011         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4012         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4013         16  FILLER                         PIC  X(32).
  4014         16  CF-TERMINATION-FORM            PIC  X(04).
  4015         16  FILLER                         PIC  X(08).
  4016         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4017                                                       COMP-3.
  4018         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4019         16  CF-ISSUE-LETTER                PIC  X(4).
  4020         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4021         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4022             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4023             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4024         16  CF-MP-REFUND-CALC              PIC X.
  4025             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4026             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4027             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4028             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4029             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4030             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4031             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4032             88  CF-MP-REFD-MEAN                VALUE '8'.
  4033         16  CF-ALT-RATE-CODE               PIC  X(5).
  4034
  4035
  4036         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL650.cbl
  4037****************************************************************
  4038*             MORTGAGE COMPANY MASTER RECORD                   *
  4039****************************************************************
  4040
  4041     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4042         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4043         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4044             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4045             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4046             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4047             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4048             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4049
  4050         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4051         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4052         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4053         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4054         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4055
  4056         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4057             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4058         16  CF-MP-RECON-USE-IND            PIC X(1).
  4059             88  CF-MP-USE-RECON             VALUE 'Y'.
  4060         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4061             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4062         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4063             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4064             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4065         16  FILLER                         PIC X(1).
  4066         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4067             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4068         16  CF-MORTG-MIB-VERSION           PIC X.
  4069             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4070             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4071             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4072         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4073             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4074                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4075             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4076                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4077             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4078                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4079             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4080                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4081             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4082                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4083             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4084                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4085         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4086         16  FILLER                         PIC X(7).
  4087         16  CF-MORTG-DESTINATION-SYMBOL.
  4088             20  CF-MORTG-MIB-COMM          PIC X(5).
  4089             20  CF-MORTG-MIB-TERM          PIC X(5).
  4090         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4091             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4092         16  FILLER                         PIC X(03).
  4093         16  CF-MP-CHECK-NO-CONTROL.
  4094             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL650.cbl
  4095                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4096                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4097                                                ' ' LOW-VALUES.
  4098                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4099                                               VALUE '3'.
  4100         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4101         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4102         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4103             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4104                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4105             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4106                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4107             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4108                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4109             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4110                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4111             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4112                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4113             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4114                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4115         16  CF-MORTG-BILLING-AREA.
  4116             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4117                                            PIC X.
  4118         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4119         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4120         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4121         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4122             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4123             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4124         16  FILLER                         PIC X.
  4125         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4126             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4127             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4128         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4129         16  FILLER                         PIC X(8).
  4130         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4131         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4132         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4133         16  CF-ACH-COMPANY-ID.
  4134             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4135                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4136                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4137                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4138             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4139         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4140             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4141         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4142             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4143             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4144         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4145         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4146         16  FILLER                         PIC X(536).
  4147
  4148****************************************************************
  4149*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4150****************************************************************
  4151
  4152     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL650.cbl
  4153         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4154             20  CF-FEMALE-HEIGHT.
  4155                 24  CF-FEMALE-FT           PIC 99.
  4156                 24  CF-FEMALE-IN           PIC 99.
  4157             20  CF-FEMALE-MIN-WT           PIC 999.
  4158             20  CF-FEMALE-MAX-WT           PIC 999.
  4159         16  FILLER                         PIC X(428).
  4160
  4161     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4162         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4163             20  CF-MALE-HEIGHT.
  4164                 24  CF-MALE-FT             PIC 99.
  4165                 24  CF-MALE-IN             PIC 99.
  4166             20  CF-MALE-MIN-WT             PIC 999.
  4167             20  CF-MALE-MAX-WT             PIC 999.
  4168         16  FILLER                         PIC X(428).
  4169******************************************************************
  4170*             AUTOMATIC ACTIVITY RECORD                          *
  4171******************************************************************
  4172     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4173         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4174             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4175             20  CF-SYS-LETTER-ID           PIC X(04).
  4176             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4177             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4178             20  CF-SYS-RESET-SW            PIC X(01).
  4179             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4180             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4181
  4182         16  FILLER                         PIC X(50).
  4183
  4184         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4185             20  CF-USER-ACTIVE-SW          PIC X(01).
  4186             20  CF-USER-LETTER-ID          PIC X(04).
  4187             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4188             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4189             20  CF-USER-RESET-SW           PIC X(01).
  4190             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4191             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4192             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4193
  4194         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL650.cbl
  4196*    COPY ERCPNDB.
  4197******************************************************************
  4198*                                                                *
  4199*                                                                *
  4200*                            ERCPNDB.                            *
  4201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4202*                            VMOD=2.025                          *
  4203*                                                                *
  4204*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4205*                                                                *
  4206******************************************************************
  4207*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4208*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4209******************************************************************
  4210*                                                                *
  4211*                                                                *
  4212*   FILE TYPE = VSAM,KSDS                                        *
  4213*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4214*                                                                *
  4215*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4216*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4217*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4218*                                                 RKP=13,LEN=36  *
  4219*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4220*                                      AND CHG-SEQ.)             *
  4221*                                                RKP=49,LEN=11   *
  4222*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4223*                                      AND CHG-SEQ.)             *
  4224*                                                RKP=60,LEN=15   *
  4225*                                                                *
  4226*   LOG = NO                                                     *
  4227*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4228******************************************************************
  4229******************************************************************
  4230*                   C H A N G E   L O G
  4231*
  4232* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4233*-----------------------------------------------------------------
  4234*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4235* EFFECTIVE    NUMBER
  4236*-----------------------------------------------------------------
  4237* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4238* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4239* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4240* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4241* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4242* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4243* 032306                   PEMA  ADD BOW LOAN NUMBER
  4244* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4245* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4246* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4247* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4248* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4249* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4250* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4251* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4252* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4253******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL650.cbl
  4254
  4255 01  PENDING-BUSINESS.
  4256     12  PB-RECORD-ID                     PIC XX.
  4257         88  VALID-PB-ID                        VALUE 'PB'.
  4258
  4259     12  PB-CONTROL-PRIMARY.
  4260         16  PB-COMPANY-CD                PIC X.
  4261         16  PB-ENTRY-BATCH               PIC X(6).
  4262         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4263         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4264
  4265     12  PB-CONTROL-BY-ACCOUNT.
  4266         16  PB-COMPANY-CD-A1             PIC X.
  4267         16  PB-CARRIER                   PIC X.
  4268         16  PB-GROUPING.
  4269             20  PB-GROUPING-PREFIX       PIC XXX.
  4270             20  PB-GROUPING-PRIME        PIC XXX.
  4271         16  PB-STATE                     PIC XX.
  4272         16  PB-ACCOUNT.
  4273             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4274             20  PB-ACCOUNT-PRIME         PIC X(6).
  4275         16  PB-CERT-EFF-DT               PIC XX.
  4276         16  PB-CERT-NO.
  4277             20  PB-CERT-PRIME            PIC X(10).
  4278             20  PB-CERT-SFX              PIC X.
  4279         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4280
  4281         16  PB-RECORD-TYPE               PIC X.
  4282             88  PB-MAILING-DATA                VALUE '0'.
  4283             88  PB-ISSUE                       VALUE '1'.
  4284             88  PB-CANCELLATION                VALUE '2'.
  4285             88  PB-BATCH-TRAILER               VALUE '9'.
  4286
  4287     12  PB-CONTROL-BY-ORIG-BATCH.
  4288         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4289         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4290         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4291         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4292
  4293     12  PB-CONTROL-BY-CSR.
  4294         16  PB-CSR-COMPANY-CD            PIC X.
  4295         16  PB-CSR-ID                    PIC X(4).
  4296         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4297         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4298         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4299******************************************************************
  4300*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4301******************************************************************
  4302
  4303     12  PB-LAST-MAINT-DT                 PIC XX.
  4304     12  PB-LAST-MAINT-BY                 PIC X(4).
  4305     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4306
  4307     12  PB-RECORD-BODY                   PIC X(375).
  4308
  4309     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4310         16  PB-CERT-ORIGIN               PIC X.
  4311             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL650.cbl
  4312         16  PB-I-NAME.
  4313             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4314             20  PB-I-INSURED-FIRST-NAME.
  4315                 24  PB-I-INSURED-1ST-INIT PIC X.
  4316                 24  FILLER                PIC X(9).
  4317             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4318         16  PB-I-AGE                     PIC S99   COMP-3.
  4319         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4320         16  PB-I-BIRTHDAY                PIC XX.
  4321         16  PB-I-INSURED-SEX             PIC X.
  4322             88  PB-SEX-MALE     VALUE 'M'.
  4323             88  PB-SEX-FEMALE   VALUE 'F'.
  4324
  4325         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4326         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4327         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4328         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4329         16  PB-I-SKIP-CODE               PIC X.
  4330             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4331             88  PB-SKIP-JULY              VALUE '1'.
  4332             88  PB-SKIP-AUGUST            VALUE '2'.
  4333             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4334             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4335             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4336             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4337             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4338             88  PB-SKIP-JUNE              VALUE '8'.
  4339             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4340             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4341             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4342         16  PB-I-TERM-TYPE               PIC X.
  4343             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4344             88  PB-PAID-WEEKLY            VALUE 'W'.
  4345             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4346             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4347             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4348         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4349         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4350         16  PB-I-DATA-ENTRY-SW           PIC X.
  4351             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4352             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4353             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4354             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4355         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4356         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4357*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4358         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4359         16  FILLER                       PIC X.
  4360
  4361         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4362             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4363             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4364                                                   '90' THRU '99'.
  4365         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4366                                          PIC XX.
  4367         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4368         16  PB-I-AMOUNT-FINANCED REDEFINES
  4369                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL650.cbl
  4370         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4371         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4372                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4373         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4374         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4375         16  PB-I-CLP-AMOUNT REDEFINES
  4376                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4377         16  PB-I-LF-CALC-FLAG            PIC X.
  4378             88 PB-COMP-LF-PREM               VALUE '?'.
  4379         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4380         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4381         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4382         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4383         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4384         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4385         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4386         16  PB-I-LF-ABBR                 PIC XXX.
  4387         16  PB-I-LF-INPUT-CD             PIC XX.
  4388
  4389         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4390             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4391             88  PB-INVALID-AH               VALUE '  ' '00'
  4392                                                   '90' THRU '99'.
  4393         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4394         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4395         16  PB-I-AH-CALC-FLAG            PIC X.
  4396             88 PB-COMP-AH-PREM                  VALUE '?'.
  4397         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4398         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4399         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4400         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4401         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4402         16  PB-I-AH-ABBR                 PIC XXX.
  4403         16  PB-I-AH-INPUT-CD             PIC XXX.
  4404
  4405         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4406         16  PB-I-REIN-TABLE              PIC XXX.
  4407         16  PB-I-BUSINESS-TYPE           PIC 99.
  4408         16  PB-I-INDV-GRP-CD             PIC X.
  4409         16  PB-I-MORT-CODE.
  4410             20  PB-I-TABLE               PIC X.
  4411             20  PB-I-INTEREST            PIC XX.
  4412             20  PB-I-MORT-TYP            PIC X.
  4413         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4414         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4415         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4416         16  PB-I-INDV-GRP-OVRD           PIC X.
  4417         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4418         16  PB-I-SIG-SW                  PIC X.
  4419             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4420         16  PB-I-RATE-CLASS              PIC XX.
  4421         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4422         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4423         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4424         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4425         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4426         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4427         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL650.cbl
  4428         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4429         16  PB-I-OB-FLAG                 PIC X.
  4430             88  PB-I-OB                      VALUE 'B'.
  4431             88  PB-I-SUMMARY                 VALUE 'Z'.
  4432         16  PB-I-ENTRY-STATUS            PIC X.
  4433             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4434                                              'M' '5' '9' '2'.
  4435             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4436             88  PB-I-POLICY-PENDING          VALUE '2'.
  4437             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4438             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4439             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4440             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4441             88  PB-I-REIN-ONLY               VALUE '9'.
  4442             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4443             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4444             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4445             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4446         16  PB-I-INT-CODE                PIC X.
  4447             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4448             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4449         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4450         16  PB-I-SOC-SEC-NO              PIC X(11).
  4451         16  PB-I-MEMBER-NO               PIC X(12).
  4452         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4453*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4454         16  PB-I-OLD-LOF                 PIC XXX.
  4455         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4456         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4457         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4458         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4459         16  PB-I-LIFE-INDICATOR          PIC X.
  4460             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4461         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4462         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4463                                          PIC S9(5)V99    COMP-3.
  4464         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4465             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4466             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4467         16  PB-I-1ST-PMT-DT              PIC XX.
  4468         16  PB-I-JOINT-INSURED.
  4469             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4470             20 PB-I-JOINT-FIRST-NAME.
  4471                24  PB-I-JOINT-FIRST-INIT PIC X.
  4472                24  FILLER                PIC X(9).
  4473             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4474*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4475         16  PB-I-BENEFICIARY-NAME.
  4476             20  PB-I-BANK-NUMBER         PIC X(10).
  4477             20  FILLER                   PIC X(15).
  4478         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4479         16  PB-I-REFERENCE               PIC X(12).
  4480         16  FILLER REDEFINES PB-I-REFERENCE.
  4481             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4482             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4483             20  PB-I-CLP-STATE           PIC XX.
  4484         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4485             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL650.cbl
  4486             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4487             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4488         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4489         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4490         16  PB-I-RESIDENT-STATE          PIC XX.
  4491         16  PB-I-RATE-CODE               PIC X(4).
  4492         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4493         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4494         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4495         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4496         16  PB-I-BANK-NOCHRGB            PIC 99.
  4497         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4498         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4499
  4500     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4501         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4502             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4503         16  PB-C-CANCEL-ORIGIN           PIC X.
  4504             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4505         16  PB-C-LF-CANCEL-DT            PIC XX.
  4506         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4507         16  PB-C-LF-CALC-REQ             PIC X.
  4508             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4509         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4510         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4511         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4512             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4513         16  PB-C-AH-CANCEL-DT            PIC XX.
  4514         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4515         16  PB-C-AH-CALC-REQ             PIC X.
  4516             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4517         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4518         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4519         16  PB-C-LAST-NAME               PIC X(15).
  4520         16  PB-C-REFUND-SW               PIC X.
  4521             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4522             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4523         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4524         16  PB-C-PAYEE-CODE              PIC X(6).
  4525         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4526         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4527         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4528         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4529         16  PB-C-REFERENCE               PIC X(12).
  4530         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4531         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4532         16  PB-C-POST-CARD-IND           PIC X.
  4533         16  PB-C-CANCEL-REASON           PIC X.
  4534         16  PB-C-REF-INTERFACE-SW        PIC X.
  4535         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4536         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4537         16  FILLER                       PIC X(01).
  4538*        16  FILLER                       PIC X(18).
  4539         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4540*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4541         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4542         16  PB-CANCELED-CERT-DATA.
  4543             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL650.cbl
  4544                 24  PB-CI-LAST-NAME      PIC X(15).
  4545                 24  PB-CI-INITIALS       PIC XX.
  4546             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4547             20  PB-CI-INSURED-SEX        PIC X.
  4548             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4549             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4550             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4551             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4552             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4553             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4554             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4555             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4556             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4557             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4558             20  PB-CI-RATE-CLASS         PIC XX.
  4559             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4560             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4561             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4562             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4563             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4564             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4565             20  PB-CI-LF-ABBR            PIC X(3).
  4566             20  PB-CI-AH-ABBR            PIC X(3).
  4567             20  PB-CI-OB-FLAG            PIC X.
  4568                 88  PB-CI-OB                VALUE 'B'.
  4569             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4570                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4571                                           'M' '4' '5' '9' '2'.
  4572                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4573                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4574                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4575                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4576                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4577                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4578                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4579                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4580                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4581                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4582                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4583                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4584                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4585             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4586                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4587                                           'M' '4' '5' '9' '2'.
  4588                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4589                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4590                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4591                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4592                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4593                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4594                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4595                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4596                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4597                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4598                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4599                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4600                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4601             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL650.cbl
  4602             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4603             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4604             20  PB-CI-MEMBER-NO          PIC X(12).
  4605             20  PB-CI-INT-CODE           PIC X.
  4606                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4607                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4608             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4609             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4610             20  PB-CI-COMP-EXCP-SW       PIC X.
  4611                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4612                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4613             20  PB-CI-ENTRY-STATUS       PIC X.
  4614             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4615             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4616             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4617             20  PB-CI-DEATH-DT           PIC XX.
  4618             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4619             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4620             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4621             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4622             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4623             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4624             20  PB-CI-ENTRY-DT              PIC XX.
  4625             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4626             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4627             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4628             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4629             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4630             20  PB-CI-OLD-LOF               PIC XXX.
  4631*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4632             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4633             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4634             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4635             20  PB-CI-INDV-GRP-CD           PIC X.
  4636             20  PB-CI-BENEFICIARY-NAME.
  4637                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4638                 24  FILLER                  PIC X(15).
  4639             20  PB-CI-NOTE-SW               PIC X.
  4640             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4641             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4642             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4643             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4644             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4645             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4646             20  PB-CI-FIRST-NAME            PIC X(10).
  4647             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4648
  4649         16  FILLER                       PIC X(13).
  4650*032306  16  FILLER                       PIC X(27).
  4651*        16  FILLER                       PIC X(46).
  4652
  4653     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4654         16  FILLER                       PIC X(10).
  4655         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4656         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4657         16  PB-M-INSURED-MID-INIT        PIC X.
  4658         16  PB-M-INSURED-AGE             PIC 99.
  4659         16  PB-M-INSURED-BIRTHDAY        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL650.cbl
  4660         16  PB-M-INSURED-SEX             PIC X.
  4661         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4662         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4663         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4664         16  PB-M-INSURED-CITY-STATE.
  4665             20  PB-M-INSURED-CITY        PIC X(28).
  4666             20  PB-M-INSURED-STATE       PIC XX.
  4667         16  PB-M-INSURED-ZIP-CODE.
  4668             20  PB-M-INSURED-ZIP-PRIME.
  4669                 24  PB-M-INSURED-ZIP-1   PIC X.
  4670                     88  PB-M-CANADIAN-POST-CODE
  4671                                             VALUE 'A' THRU 'Z'.
  4672                 24  FILLER               PIC X(4).
  4673             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4674         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4675                                        PB-M-INSURED-ZIP-CODE.
  4676             20  PM-M-INS-CAN-POST1       PIC XXX.
  4677             20  PM-M-INS-CAN-POST2       PIC XXX.
  4678             20  FILLER                   PIC XXX.
  4679         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4680         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4681         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4682         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4683         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4684         16  PB-M-CRED-BENE-CITYST.
  4685             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4686             20  PB-M-CRED-BENE-STATE     PIC XX.
  4687         16  FILLER                       PIC X(92).
  4688
  4689     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4690         16  FILLER                       PIC X(10).
  4691         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4692         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4693         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4694         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4695         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4696         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4697         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4698         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4699         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4700         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4701         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4702         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4703         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4704         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4705         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4706         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4707         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4708         16  PB-ACCOUNT-NAME              PIC X(30).
  4709         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4710         16  PB-REFERENCE                 PIC X(12).
  4711         16  PB-B-RECEIVED-DT             PIC XX.
  4712         16  FILLER                       PIC X(234).
  4713
  4714     12  PB-RECORD-STATUS.
  4715         16  PB-CREDIT-SELECT-DT          PIC XX.
  4716         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4717         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL650.cbl
  4718         16  PB-BILLING-STATUS            PIC X.
  4719             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4720             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4721             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4722         16  PB-RECORD-BILL               PIC X.
  4723             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4724             88  PB-RECORD-RETURNED           VALUE 'R'.
  4725             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4726             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4727             88  PB-OVERRIDE-AH               VALUE 'A'.
  4728             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4729         16  PB-BATCH-ENTRY               PIC X.
  4730             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4731             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4732             88  PB-REISSUED-CERT             VALUE 'E'.
  4733             88  PB-CASH-CERT                 VALUE 'C'.
  4734             88  PB-MONTHLY-CERT              VALUE 'M'.
  4735             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4736             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4737             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4738         16  PB-FORCE-CODE                PIC X.
  4739             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4740             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4741             88  PB-CANCEL-FORCE              VALUE '8'.
  4742             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4743             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4744             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4745             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4746             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4747             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4748             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4749         16  PB-FATAL-FLAG                PIC X.
  4750             88  PB-FATAL-ERRORS              VALUE 'X'.
  4751         16  PB-FORCE-ER-CD               PIC X.
  4752             88  PB-FORCE-ERRORS              VALUE 'F'.
  4753             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4754         16  PB-WARN-ER-CD                PIC X.
  4755             88  PB-WARNING-ERRORS            VALUE 'W'.
  4756         16  FILLER                       PIC X.
  4757         16  PB-OUT-BAL-CD                PIC X.
  4758             88  PB-OUT-OF-BAL                VALUE 'O'.
  4759         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4760         16  PB-AH-OVERRIDE-L1            PIC X.
  4761         16  PB-INPUT-DT                  PIC XX.
  4762         16  PB-INPUT-BY                  PIC X(4).
  4763         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4764         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4765         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4766         16  PB-LF-EARNING-METHOD         PIC X.
  4767         16  PB-AH-EARNING-METHOD         PIC X.
  4768         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4769         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4770         16  PB-REIN-CD                   PIC XXX.
  4771         16  PB-LF-REFUND-TYPE            PIC X.
  4772         16  PB-AH-REFUND-TYPE            PIC X.
  4773         16  PB-ACCT-EFF-DT               PIC XX.
  4774         16  PB-ACCT-EXP-DT               PIC XX.
  4775         16  PB-COMPANY-ID                PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL650.cbl
  4776         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4777         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4778         16  PB-SV-CARRIER                PIC X.
  4779         16  PB-SV-GROUPING               PIC X(6).
  4780         16  PB-SV-STATE                  PIC XX.
  4781         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4782         16  PB-GA-BILLING-INFO.
  4783             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4784                                          PIC XX.
  4785         16  PB-SV-REMIT-TO  REDEFINES
  4786             PB-GA-BILLING-INFO           PIC X(10).
  4787         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4788         16  PB-I-LOAN-OFFICER            PIC X(5).
  4789         16  PB-I-VIN                     PIC X(17).
  4790
  4791         16  FILLER                       PIC X(04).
  4792         16  IMNET-BYPASS-SW              PIC X.
  4793
  4794******************************************************************
  4795*                COMMON EDIT ERRORS                              *
  4796******************************************************************
  4797
  4798     12  PB-COMMON-ERRORS.
  4799         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4800                                           PIC S9(4)     COMP.
  4801
  4802******************************************************************
  4803*EJECT
  4804*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL650.cbl
  4806 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  4807                          COMPENSATION-MASTER
  4808                          NAME-LOOKUP-MASTER PLAN-MASTER
  4809                          CONTROL-FILE PENDING-BUSINESS.
  4810 0000-DFHEXIT SECTION.
  4811     MOVE '9#                    $   ' TO DFHEIV0.
  4812     MOVE 'EL650' TO DFHEIV1.
  4813     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4814
  4815     MOVE LOW-VALUES             TO  WS-VERIFY-AREA.
  4816     INITIALIZE  TEMP-STORAGE-RECORD.
  4817
  4818     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4819     MOVE '5'                    TO  DC-OPTION-CODE.
  4820
  4821     PERFORM 9700-DATE-CONVERSION.
  4822
  4823     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4824     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4825     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4826     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4827*    display ' beginning of program el650   '
  4828
  4829     IF EIBCALEN  =  0
  4830         GO TO 8800-UNAUTHORIZED-ACCESS.
  4831
  4832     MOVE SCREEN-NUMBER          TO  TS-SCREEN.
  4833     MOVE EIBTRMID               TO  TS-TERM.
  4834     MOVE LOW-VALUES             TO  EL650AI.
  4835
  4836     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4837         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4838
  4839     IF PI-CALLING-PROGRAM  NOT = THIS-PGM
  4840         IF PI-RETURN-TO-PROGRAM  NOT = THIS-PGM
  4841             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4842             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4843             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4844             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4845             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4846             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4847             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4848             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4849             MOVE LOW-VALUES            TO  PI-PROGRAM-WORK-AREA
  4850             MOVE ZEROS                 TO  PI-TOTAL-LINES
  4851                                            PI-LINE-SELECTED
  4852             MOVE SPACE                 TO  PI-RECORD-ADDED-SW
  4853             MOVE 1                     TO  PI-PAGE-NUMBER
  4854         ELSE
  4855             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4856             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4857             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4858             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4859             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4860             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4861             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4862             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4863
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL650.cbl
  4864**************************************************************
  4865*               CLIENT "DMD" CUSTOM CODE
  4866* CHECK IF CONTROL PASSED FROM EL608 PROGRAM
  4867* START BROWSE BEGINNING WITH KEY PASSED BY EL608
  4868*              CSO CR# 6475
  4869     IF EIBTRNID  =  EL608-TRANS-ID
  4870         MOVE 1                     TO RETURN-FROM-SW
  4871         MOVE 'Y'                   TO FROM-EL608-SW
  4872         MOVE TRANS-ID              TO EIBTRNID
  4873         MOVE XCTL-EL601            TO PI-RETURN-TO-PROGRAM
  4874         MOVE PI-PREV-VG-ACCOUNT    TO PI-ACCT-CCGSA-KEY
  4875                                       KEY-SAVE
  4876         MOVE LOW-VALUES            TO PI-ACCT-EXP-DT
  4877                                       PI-ACCT-REST-OF-EXP
  4878                                       PI-DATE-RANGE-TABLE
  4879
  4880* EXEC CICS  HANDLE CONDITION
  4881*            NOTFND   (5340-END)
  4882*            ENDFILE  (5330-NOT-FOUND)
  4883*        END-EXEC
  4884*    MOVE '"$I''                  ! " #00004875' TO DFHEIV0
  4885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4887     MOVE X'2220233030303034383735' TO DFHEIV0(25:11)
  4888     CALL 'kxdfhei1' USING DFHEIV0
  4889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4890         MOVE 'Y'                   TO FIRST-TIME-SW
  4891         MOVE ZEROS                 TO PI-TOTAL-LINES
  4892         SET T-INDEX
  4893             TS-INDEX  TO  +1
  4894         MOVE ACCT-FILE-ID          TO PI-ACCT-ID
  4895         MOVE 1                     TO PI-PAGE-NUMBER
  4896         MOVE 'S'                   TO PI-MAINT
  4897         MOVE DFHPF1                TO EIBAID
  4898         GO TO 1002-SHOW-NEW-RECORDS.
  4899*    END OF CLIENT "DMD" CUSTOM CODE
  4900**************************************************************
  4901
  4902     IF RETURNED-FROM = XCTL-6501 OR XCTL-6502 OR XCTL-6503 OR
  4903                        XCTL-6504 OR XCTL-6505 OR XCTL-6506 OR
  4904                        XCTL-6508
  4905         MOVE 1                     TO  RETURN-FROM-SW
  4906         MOVE PI-PREV-VG-ACCOUNT    TO  PI-ACCT-CCGSA-KEY
  4907         MOVE PI-ACCT-CCGSA-KEY     TO  KEY-SAVE
  4908         MOVE LOW-VALUES            TO  PI-ACCT-EXP-DT
  4909         GO TO 1002-SHOW-NEW-RECORDS.
  4910
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL650.cbl
  4912     IF EIBTRNID  NOT =  TRANS-ID
  4913         IF EIBTRNID  NOT = EL640-TRANS-ID  AND
  4914            EIBTRNID  NOT = EL658-TRANS-ID  AND
  4915            EIBTRNID  NOT = EL6311-TRANS-ID AND
  4916            EIBTRNID  NOT = EL1273-TRANS-ID AND
  4917            EIBTRNID  NOT = EL652-TRANS-ID  AND
  4918            EIBTRNID  NOT = EL6523-TRANS-ID AND
  4919            EIBTRNID  NOT = EL6311NC-TRANS-ID AND
  4920            EIBTRNID  NOT = EL130-TRANS-ID  AND
  4921            EIBTRNID  NOT = EL6592-TRANS-ID AND
  4922            EIBTRNID  NOT = EL6509-TRANS-ID
  4923            AND EIBTRNID NOT = EL6503-TRANS-ID
  4924             GO TO 8100-SEND-INITIAL-MAP
  4925         ELSE
  4926             IF PI-CR-CONTROL-IN-PROGRESS  = SPACES
  4927                 GO TO 8100-SEND-INITIAL-MAP
  4928             ELSE
  4929                 MOVE 'S'             TO  MAINTI
  4930                 MOVE PI-CR-CARRIER   TO  ACARIERI
  4931                 MOVE PI-CR-GROUPING  TO  AGROUPI
  4932                 MOVE PI-CR-STATE     TO  ASTATEI
  4933                 MOVE PI-CR-ACCOUNT   TO  AACCTI
  4934                 MOVE +1              TO  ACARIERL
  4935                                          MAINTL
  4936                 MOVE +6              TO  AGROUPL
  4937                 MOVE +2              TO  ASTATEL
  4938                 MOVE +10             TO  AACCTL
  4939                 GO TO 0330-EDIT-DATA.
  4940
  4941
  4942* EXEC CICS  HANDLE CONDITION
  4943*        PGMIDERR  (9600-PGMID-ERROR)
  4944*        ERROR     (9990-ABEND)
  4945*    END-EXEC.
  4946*    MOVE '"$L.                  ! # #00004930' TO DFHEIV0
  4947     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4949     MOVE X'2320233030303034393330' TO DFHEIV0(25:11)
  4950     CALL 'kxdfhei1' USING DFHEIV0
  4951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4952
  4953
  4954     IF EIBAID  = DFHCLEAR
  4955         GO TO 9400-CLEAR.
  4956
  4957     IF PI-PROCESSOR-ID  =  'LGXX'
  4958         GO TO 0200-RECEIVE.
  4959
  4960
  4961* EXEC CICS  READQ TS
  4962*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4963*        INTO    (SECURITY-CONTROL)
  4964*        LENGTH  (SC-COMM-LENGTH)
  4965*        ITEM    (SC-ITEM)
  4966*    END-EXEC.
  4967*    MOVE '*$II   L              ''   #00004941' TO DFHEIV0
  4968     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4969     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL650.cbl
  4970     MOVE X'2020233030303034393431' TO DFHEIV0(25:11)
  4971     CALL 'kxdfhei1' USING DFHEIV0,
  4972           PI-SECURITY-TEMP-STORE-ID,
  4973           SECURITY-CONTROL,
  4974           SC-COMM-LENGTH,
  4975           SC-ITEM,
  4976           DFHEIV99,
  4977           DFHEIV99
  4978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4979
  4980
  4981     MOVE SC-CREDIT-DISPLAY (04)  TO  PI-DISPLAY-CAP.
  4982     MOVE SC-CREDIT-UPDATE  (04)  TO  PI-MODIFY-CAP.
  4983
  4984     IF NOT DISPLAY-CAP
  4985         MOVE 'READ'             TO  SM-READ
  4986         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  4987         MOVE ER-0070            TO  EMI-ERROR
  4988         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4989         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL650.cbl
  4991 0200-RECEIVE.
  4992     IF EIBAID  = DFHPA1  OR  DFHPA2  OR  DFHPA3
  4993         MOVE ER-0008            TO  EMI-ERROR
  4994         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4995         MOVE -1                 TO  MAINTL
  4996         GO TO 8200-SEND-DATAONLY.
  4997
  4998
  4999* EXEC CICS  RECEIVE
  5000*        MAP     (MAP-NAME)
  5001*        MAPSET  (MAPSET-NAME)
  5002*        INTO    (EL650AI)
  5003*    END-EXEC.
  5004     MOVE LENGTH OF
  5005      EL650AI
  5006       TO DFHEIV11
  5007*    MOVE '8"T I  L              ''   #00004965' TO DFHEIV0
  5008     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5010     MOVE X'2020233030303034393635' TO DFHEIV0(25:11)
  5011     CALL 'kxdfhei1' USING DFHEIV0,
  5012           MAP-NAME,
  5013           EL650AI,
  5014           DFHEIV11,
  5015           MAPSET-NAME,
  5016           DFHEIV99,
  5017           DFHEIV99
  5018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5019
  5020
  5021     IF PFENTERL  = ZERO
  5022         GO TO 0300-CHECK-PFKEYS.
  5023
  5024     IF EIBAID  NOT = DFHENTER
  5025         MOVE ER-0004            TO  EMI-ERROR
  5026         GO TO 0320-INPUT-ERROR.
  5027
  5028     IF (PFENTERI NUMERIC)
  5029       AND  (PFENTERI GREATER ZERO AND LESS 25)
  5030         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  5031     ELSE
  5032         MOVE ER-0029               TO  EMI-ERROR
  5033         GO TO 0320-INPUT-ERROR.
  5034
  5035 0300-CHECK-PFKEYS.
  5036     IF EIBAID  = DFHPF23
  5037         GO TO 8810-PF23.
  5038
  5039     IF EIBAID  = DFHPF24
  5040         GO TO 9200-RETURN-MAIN-MENU.
  5041
  5042     IF EIBAID  = DFHPF12
  5043         GO TO 9500-PF12.
  5044
  5045     IF MAINTL  NOT = ZERO   AND
  5046        MAINTI  NOT = SPACE  AND
  5047        EIBAID  NOT = DFHENTER
  5048          MOVE ER-0050            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL650.cbl
  5049          GO TO 0320-INPUT-ERROR.
  5050
  5051     if (maintl not = zeros)
  5052        and (mainti not = 'D')
  5053        move spaces              to pi-el650-del-sw
  5054     end-if
  5055     IF EIBAID  = DFHPF1
  5056         GO TO 5300-FIND-NEXT-ACCOUNT.
  5057
  5058     IF EIBAID  = DFHPF2
  5059         GO TO 5400-FIND-PREV-ACCOUNT.
  5060
  5061     IF EIBAID  = DFHPF3
  5062         GO TO 5100-FIND-NEXT-RANGE.
  5063
  5064     IF EIBAID  = DFHPF4
  5065         GO TO 5200-FIND-PREV-RANGE.
  5066
  5067     IF EIBAID  = DFHPF5
  5068         GO TO 8900-PF5.
  5069
  5070     IF EIBAID  = DFHPF6
  5071        GO TO 8910-PF6
  5072     END-IF
  5073     IF EIBAID  = DFHENTER
  5074         GO TO 0330-EDIT-DATA.
  5075
  5076     MOVE ER-0029                TO  EMI-ERROR.
  5077
  5078 0320-INPUT-ERROR.
  5079     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5080
  5081     MOVE AL-UNBON               TO  PFENTERA.
  5082
  5083     IF PFENTERL  = ZERO
  5084         MOVE -1                 TO  MAINTL
  5085     ELSE
  5086         MOVE -1                 TO  PFENTERL.
  5087
  5088     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL650.cbl
  5090 0330-EDIT-DATA.
  5091     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5092     MOVE '5'                    TO  DC-OPTION-CODE.
  5093
  5094     PERFORM 9700-DATE-CONVERSION.
  5095
  5096     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  5097     MOVE DC-GREG-DATE-1-YMD     TO  CURRENT-SAVE.
  5098
  5099     IF ACARIERL GREATER ZEROS
  5100         IF PI-CARRIER-SECURITY GREATER SPACES
  5101             IF ACARIERI = PI-CARRIER-SECURITY
  5102                 NEXT SENTENCE
  5103             ELSE
  5104                 MOVE -1         TO  ACARIERL
  5105                 MOVE ER-2370    TO  EMI-ERROR
  5106                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5107                 MOVE AL-UABON   TO  ACARIERA
  5108                 GO TO 8200-SEND-DATAONLY.
  5109
  5110     IF MAINTI  = 'S'
  5111       IF LINEL = ZEROS
  5112           MOVE 1 TO PI-PAGE-NUMBER
  5113           GO TO 1000-SHOW-ACCOUNT
  5114       ELSE
  5115           GO TO 1000-SHOW-ACCOUNT.
  5116
  5117     PERFORM 6800-COMPANY-REC-READ  THRU  6899-EXIT.
  5118
  5119     IF EMI-ERROR  NOT = ZEROS
  5120         MOVE -1                 TO  MAINTL
  5121         GO TO 8200-SEND-DATAONLY.
  5122
  5123     IF NOT  MODIFY-CAP
  5124         MOVE 'UPDATE'           TO  SM-READ
  5125         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5126         MOVE ER-0070            TO  EMI-ERROR
  5127         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5128         MOVE AL-UANON           TO  ACARIERA  AGROUPA
  5129                                     ASTATEA   AACCTA
  5130         GO TO 8100-SEND-INITIAL-MAP.
  5131
  5132     IF MAINTI  = 'A'
  5133         GO TO 1500-ADD-ACCOUNT.
  5134
  5135     IF MAINTI  = 'C'
  5136         IF PI-SV-MAINT IS EQUAL TO 'L'
  5137            MOVE -1              TO  MAINTL
  5138            MOVE AL-UABON        TO  MAINTA
  5139            MOVE ER-0899         TO  EMI-ERROR
  5140            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5141            GO TO 8200-SEND-DATAONLY
  5142         ELSE
  5143            GO TO 2000-CHANGE-ACCOUNT.
  5144
  5145     IF MAINTI  = 'D'
  5146         GO TO 2500-DELETE-ACCOUNT.
  5147
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL650.cbl
  5148     IF MAINTI  = 'X'
  5149         GO TO 3000-CHANGE-EXPIRATION.
  5150
  5151     IF MAINTI  = 'E'
  5152         GO TO 3500-CHANGE-EFFECTIVE.
  5153
  5154     IF MAINTI  = 'L'
  5155         MOVE 'L'             TO  PI-SV-MAINT
  5156         GO TO 4000-CHANGE-ALL.
  5157
  5158     IF MAINTI  = 'K'
  5159       IF LINEL GREATER ZERO
  5160           GO TO 4900-CREATE-NEW-ACCOUNT
  5161        ELSE
  5162           GO TO 4500-CREATE-NEW-ACCOUNT.
  5163
  5164     IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5165         IF MAINTI  = 'T'
  5166             GO TO 4500-CREATE-NEW-ACCOUNT.
  5167
  5168     IF MAINTI  = 'N'
  5169         GO TO 5000-CREATE-NEW-RANGE.
  5170
  5171     MOVE ER-0023                TO  EMI-ERROR.
  5172
  5173     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5174
  5175     MOVE -1                     TO  MAINTL.
  5176     MOVE AL-UABON               TO  MAINTA.
  5177
  5178     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL650.cbl
  5180 1000-SHOW-ACCOUNT.
  5181     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5182
  5183     IF LINEL GREATER ZEROS   AND
  5184        PI-TOTAL-LINES  NOT =  ZEROS
  5185         NEXT SENTENCE
  5186     ELSE
  5187         GO TO 1002-SHOW-NEW-RECORDS.
  5188
  5189     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5190
  5191     IF EMI-ERROR  NOT = ZEROS
  5192         GO TO 8200-SEND-DATAONLY.
  5193
  5194     SET T-INDEX                 TO  LINEI.
  5195
  5196     IF PI-2ND-PAGE
  5197         SET T-INDEX  UP  BY  8
  5198     ELSE
  5199     IF PI-3RD-PAGE
  5200         SET T-INDEX  UP  BY  16
  5201     ELSE
  5202     IF PI-LST-PAGE
  5203         SET T-INDEX  UP  BY  24.
  5204
  5205     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5206     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5207
  5208     IF PI-PREV-ACCOUNT  =  PI-ACCT-CCGSA-KEY
  5209         MOVE MAINTI             TO  PI-MAINT
  5210         MOVE XCTL-6501          TO  PGM-NAME
  5211         GO TO 9300-XCTL
  5212     ELSE
  5213         IF PI-PREV-VG-ACCOUNT = PI-ACCT-CCGSA-KEY
  5214             MOVE MAINTI         TO  PI-MAINT
  5215             MOVE XCTL-6501      TO  PGM-NAME
  5216             PERFORM 7400-READ-TEMP-STORAGE  THRU  7400-EXIT
  5217             SET TS-INDEX        TO  T-INDEX
  5218             MOVE TS-ACCT-KEY (TS-INDEX)
  5219                                 TO  PI-ACCT-CCGSA-KEY
  5220             GO TO 9300-XCTL.
  5221
  5222 1002-SHOW-NEW-RECORDS.
  5223
  5224* EXEC CICS  HANDLE CONDITION
  5225*         NOTFND   (1010-NOT-FOUND)
  5226*         ENDFILE  (1010-NOT-FOUND)
  5227*    END-EXEC.
  5228*    MOVE '"$I''                  ! $ #00005173' TO DFHEIV0
  5229     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5231     MOVE X'2420233030303035313733' TO DFHEIV0(25:11)
  5232     CALL 'kxdfhei1' USING DFHEIV0
  5233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5234
  5235
  5236     SET T-INDEX
  5237        TS-INDEX  TO  +1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL650.cbl
  5238
  5239     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  5240
  5241     MOVE LOW-VALUES             TO  TEMP-STORAGE-RECORD.
  5242
  5243     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  5244
  5245     PERFORM 7100-START-BROWSE  THRU  7100-EXIT.
  5246
  5247     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  5248
  5249 1005-READ-ACCT.
  5250     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  5251
  5252     IF K-WITH-LINE-NO
  5253       IF SV-CARRIER   NOT = AM-CARRIER  OR
  5254          SV-GROUPING  NOT = AM-GROUPING OR
  5255          SV-STATE     NOT = AM-STATE    OR
  5256          SV-ACCOUNT   NOT = AM-ACCOUNT
  5257            GO TO 1010-NOT-FOUND.
  5258
  5259     IF SV-CO  NOT = AM-COMPANY-CD
  5260         GO TO 1010-NOT-FOUND.
  5261
  5262     IF SV-ACCOUNT  NOT =  AM-ACCOUNT
  5263         GO TO 1010-NOT-FOUND.
  5264
  5265     IF SV-STATE  NOT = AM-STATE
  5266       AND  (ST-ACCNT-CNTL
  5267       OR  CARR-ST-ACCNT-CNTL
  5268       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5269         GO TO 1010-NOT-FOUND.
  5270
  5271     IF SV-CARRIER  NOT =  AM-CARRIER
  5272       AND  (CARR-ACCNT-CNTL
  5273       OR  CARR-ST-ACCNT-CNTL
  5274       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5275         GO TO 1010-NOT-FOUND.
  5276
  5277     IF SV-GROUPING  NOT = AM-GROUPING
  5278       AND  CARR-GROUP-ST-ACCNT-CNTL
  5279         GO TO 1010-NOT-FOUND.
  5280
  5281     IF AM-TRNTO-DTE  =  SPACES
  5282         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  5283
  5284     IF AM-TRNFROM-DTE  = SPACES
  5285         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  5286
  5287     IF T-INDEX  = 1
  5288         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5289             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  5290             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  5291             MOVE SPACE              TO  DC-OPTION-CODE
  5292             PERFORM 9700-DATE-CONVERSION
  5293             IF DATE-CONVERSION-ERROR
  5294                 MOVE SPACES         TO  TRNTODTO
  5295             ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL650.cbl
  5296                 MOVE DC-GREG-DATE-1-EDIT
  5297                                     TO  TRNTODTO.
  5298
  5299     IF T-INDEX  =  1
  5300         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5301             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  5302             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  5303             MOVE SPACE                TO  DC-OPTION-CODE
  5304             PERFORM 9700-DATE-CONVERSION
  5305             IF DATE-CONVERSION-ERROR
  5306                 MOVE SPACES           TO  TRNFRDTO
  5307             ELSE
  5308                 MOVE DC-GREG-DATE-1-EDIT
  5309                                       TO  TRNFRDTO.
  5310
  5311     IF T-INDEX  = 1
  5312         MOVE AM-CONTROL-PRIMARY  TO  PI-PREV-ACCOUNT
  5313         MOVE PI-ACCT-CCGSA-KEY   TO  PI-PREV-VG-ACCOUNT
  5314         MOVE AM-NAME             TO  NAMEO
  5315                                      PI-ACCNAME
  5316         MOVE SPACE               TO  NAMEFLGO
  5317                                      PI-NAMEFLG.
  5318
  5319     IF AM-NAME  NOT = NAMEO
  5320         MOVE '*'                TO  NAMEFLGO
  5321                                     PI-NAMEFLG.
  5322
  5323     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  5324
  5325     GO TO 1005-READ-ACCT.
  5326
  5327 1010-NOT-FOUND.
  5328     IF BROWSE-STARTED
  5329
  5330* EXEC CICS  ENDBR
  5331*            DATASET  (PI-ACCT-ID)
  5332*        END-EXEC.
  5333     MOVE 0
  5334       TO DFHEIV11
  5335*    MOVE '&2                    $   #00005271' TO DFHEIV0
  5336     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5338     MOVE X'2020233030303035323731' TO DFHEIV0(25:11)
  5339     CALL 'kxdfhei1' USING DFHEIV0,
  5340           PI-ACCT-ID,
  5341           DFHEIV11,
  5342           DFHEIV99
  5343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5344
  5345
  5346     IF T-INDEX  NOT = 1
  5347         PERFORM 7200-WRITE-TEMP-STORAGE  THRU  7200-EXIT
  5348         GO TO 7000-BUILD-OUTPUT-MAP.
  5349
  5350     MOVE ER-0226                TO  EMI-ERROR.
  5351
  5352     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5353
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL650.cbl
  5354     MOVE -1                     TO  ACARIERL.
  5355     MOVE AL-UABON               TO  ACARIERA
  5356                                     AGROUPA
  5357                                     ASTATEA
  5358                                     AACCTA.
  5359
  5360     IF FROM-EL608-SW = 'Y'
  5361         MOVE SV-CARRIER     TO  ACARIERO
  5362         MOVE SV-GROUPING    TO  AGROUPO
  5363         MOVE SV-STATE       TO  ASTATEO
  5364         MOVE SV-ACCOUNT     TO  AACCTO
  5365         MOVE 'N'            TO  FROM-EL608-SW.
  5366
  5367     IF PI-MAINT = 'A'
  5368         IF PI-RECORD-NOT-CREATED
  5369             MOVE SV-CARRIER     TO  ACARIERO
  5370             MOVE SV-GROUPING    TO  AGROUPO
  5371             MOVE SV-STATE       TO  ASTATEO
  5372             MOVE SV-ACCOUNT     TO  AACCTO
  5373             MOVE ER-2151        TO  EMI-ERROR
  5374             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5375             MOVE 'S'            TO  PI-MAINT.
  5376
  5377     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL650.cbl
  5379 1020-MOVE-TO-TABLE.
  5380     MOVE AM-EXPIRATION-DT       TO  PI-BIN-EXP-DT   (T-INDEX).
  5381     MOVE AM-EFFECTIVE-DT        TO  PI-BIN-EFF-DT   (T-INDEX).
  5382     MOVE AM-LAST-MAINT-DT       TO  PI-BIN-MAINT-DT (T-INDEX).
  5383     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5384     MOVE '3'                    TO  DC-OPTION-CODE.
  5385
  5386     PERFORM 9700-DATE-CONVERSION.
  5387
  5388     IF DATE-CONVERSION-ERROR
  5389         MOVE LOW-VALUES         TO  PI-BIN-HI-CERT (T-INDEX)
  5390     ELSE
  5391         MOVE DC-BIN-DATE-1      TO  PI-BIN-HI-CERT (T-INDEX).
  5392
  5393     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5394     MOVE '3'                    TO  DC-OPTION-CODE.
  5395
  5396     PERFORM 9700-DATE-CONVERSION.
  5397
  5398     IF DATE-CONVERSION-ERROR
  5399         MOVE LOW-VALUES         TO  PI-BIN-LO-CERT (T-INDEX)
  5400     ELSE
  5401         MOVE DC-BIN-DATE-1      TO  PI-BIN-LO-CERT (T-INDEX).
  5402
  5403     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
  5404     MOVE AM-CONTROL-PRIMARY     TO  TS-ACCT-KEY (TS-INDEX).
  5405
  5406     ADD 1                       TO  PI-TOTAL-LINES.
  5407
  5408     SET T-INDEX
  5409        TS-INDEX  UP  BY  +1.
  5410
  5411     IF T-INDEX  = +33
  5412         GO TO 7000-BUILD-OUTPUT-MAP.
  5413
  5414
  5415 1020-EXIT.
  5416     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL650.cbl
  5418 1500-ADD-ACCOUNT.
  5419     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5420
  5421     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5422
  5423     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5424                                     PI-ACCT-REST-OF-EXP.
  5425
  5426     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  5427
  5428     IF REC-FOUND
  5429         MOVE -1                 TO  ACARIERL
  5430         MOVE ER-0561            TO  EMI-ERROR
  5431         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5432         GO TO 8200-SEND-DATAONLY.
  5433
  5434     MOVE NEW-KEY-SAVE           TO PI-ACCT-CCGSA-KEY.
  5435
  5436     PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT.
  5437
  5438     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5439
  5440     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  5441
  5442     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  5443         MOVE -1                 TO  EXPCHGL
  5444         MOVE ER-1228            TO  EMI-ERROR
  5445         MOVE AL-UABON           TO  EXPCHGA
  5446         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5447
  5448     IF NOT EMI-NO-ERRORS
  5449         GO TO 8200-SEND-DATAONLY.
  5450
  5451     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5452
  5453     IF WS-ACCT2-FOUND  = 'Y'
  5454         PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  5455             VARYING  WS-INDEX  FROM  +1  BY  +1
  5456                UNTIL WS-INDEX GREATER +32.
  5457
  5458     IF NOT EMI-NO-ERRORS
  5459         GO TO 8200-SEND-DATAONLY.
  5460
  5461     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5462
  5463     MOVE NEW-KEY-SAVE           TO  PI-ACCT-CCGSA-KEY
  5464                                     PI-PREV-ACCOUNT
  5465                                     PI-PREV-VG-ACCOUNT.
  5466     MOVE LOW-VALUES             TO  PI-DATE-RANGE-TABLE
  5467                                     PI-ACCT-REST-OF-EXP.
  5468     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  5469                                     PI-BIN-EXP-DT (1)
  5470     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT (1).
  5471     MOVE 1                      TO  PI-TOTAL-LINES
  5472                                     PI-PAGE-NUMBER
  5473                                     PI-LINE-SELECTED.
  5474     MOVE SPACE                  TO  PI-RECORD-ADDED-SW.
  5475     MOVE MAINTI                 TO  PI-MAINT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL650.cbl
  5476     MOVE XCTL-6501              TO  PGM-NAME.
  5477
  5478     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL650.cbl
  5480 2000-CHANGE-ACCOUNT.
  5481     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5482
  5483     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5484
  5485     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5486
  5487     IF NOT EMI-NO-ERRORS
  5488         GO TO 8200-SEND-DATAONLY.
  5489
  5490     SET T-INDEX TO LINEI.
  5491
  5492     IF PI-2ND-PAGE
  5493         SET T-INDEX  UP  BY  8
  5494     ELSE
  5495     IF PI-3RD-PAGE
  5496         SET T-INDEX  UP  BY  16
  5497     ELSE
  5498     IF PI-LST-PAGE
  5499         SET T-INDEX  UP  BY  24.
  5500
  5501     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5502     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5503     MOVE MAINTI                   TO  PI-MAINT.
  5504     MOVE XCTL-6501                TO  PGM-NAME.
  5505
  5506     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL650.cbl
  5508 2500-DELETE-ACCOUNT.
  5509     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5510
  5511     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5512
  5513     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5514
  5515     IF NOT EMI-NO-ERRORS
  5516         GO TO 8200-SEND-DATAONLY.
  5517
  5518     SET T-INDEX                 TO  LINEI.
  5519
  5520     IF PI-2ND-PAGE
  5521         SET T-INDEX  UP  BY  8
  5522     ELSE
  5523     IF PI-3RD-PAGE
  5524         SET T-INDEX  UP  BY  16
  5525     ELSE
  5526     IF PI-LST-PAGE
  5527         SET T-INDEX  UP  BY  24.
  5528
  5529     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  5530                                       BIN-MAX-DATE.
  5531     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5532     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-MIN-DATE.
  5533     MOVE '1'                      TO  FROM-WHERE-SW.
  5534
  5535     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5536       VARYING  T-INDEX  FROM  +1  BY  +1
  5537         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5538
  5539     MOVE SPACE                  TO  FROM-WHERE-SW.
  5540
  5541     IF NOT EMI-NO-ERRORS
  5542         GO TO 8200-SEND-DATAONLY.
  5543
  5544     SET T-INDEX TO LINEI.
  5545
  5546     IF PI-2ND-PAGE
  5547         SET T-INDEX  UP  BY  8
  5548     ELSE
  5549     IF PI-3RD-PAGE
  5550         SET T-INDEX  UP  BY  16
  5551     ELSE
  5552     IF PI-LST-PAGE
  5553         SET T-INDEX  UP  BY  24.
  5554
  5555
  5556* EXEC CICS  READ
  5557*        UPDATE
  5558*        DATASET  (PI-ACCT-ID)
  5559*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5560*        RIDFLD   (PI-ACCT-KEY)
  5561*    END-EXEC.
  5562*    MOVE '&"S        EU         (   #00005484' TO DFHEIV0
  5563     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5564     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5565     MOVE X'2020233030303035343834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL650.cbl
  5566     CALL 'kxdfhei1' USING DFHEIV0,
  5567           PI-ACCT-ID,
  5568           DFHEIV20,
  5569           DFHEIV99,
  5570           PI-ACCT-KEY,
  5571           DFHEIV99,
  5572           DFHEIV99,
  5573           DFHEIV99
  5574     SET ADDRESS OF ACCOUNT-MASTER TO
  5575         DFHEIV20
  5576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5577
  5578
  5579     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES  OR
  5580        PI-BIN-HI-CERT (T-INDEX)  NOT =  LOW-VALUES
  5581         MOVE ER-2070            TO  EMI-ERROR
  5582         MOVE -1                 TO  MAINTL
  5583         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5584         GO TO 8200-SEND-DATAONLY.
  5585
  5586     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5587         MOVE 'N'                TO  PENDING-BUSINESS-SW
  5588     ELSE
  5589         PERFORM 2560-CHECK-PENDING-BUSINESS  THRU  2569-EXIT.
  5590
  5591     IF THERE-IS-PENDING-BUSINESS
  5592         MOVE ER-1612            TO  EMI-ERROR
  5593         MOVE -1                 TO  MAINTL
  5594         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5595         GO TO 8200-SEND-DATAONLY.
  5596
  5597     MOVE AM-CONTROL-PRIMARY     TO  B4-ACCT-KEY.
  5598     MOVE AM-EFFECTIVE-DT        TO  B4-ACCT-EFF-DT.
  5599
  5600     if pi-el650-del-sw = 'Y'
  5601        continue
  5602     else
  5603        move 'Y'                 to pi-el650-del-sw
  5604        move er-1299             to emi-error
  5605        perform 9900-error-format thru 9900-exit
  5606        MOVE 1 TO PI-PAGE-NUMBER
  5607        move spaces              to mainto
  5608        MOVE -1                  TO MAINTL
  5609        GO TO 1000-SHOW-ACCOUNT
  5610     end-if
  5611     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  5612
  5613****** DO NOT DELETE PLAN MASTER RECORDS IF MORE ACCT DATE RANGES
  5614     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5615         NEXT SENTENCE
  5616     ELSE
  5617         IF PI-TOTAL-LINES  = 1
  5618             PERFORM 4800-DELETE-PLAN-REC   THRU  4899-EXIT
  5619         end-if
  5620     end-if
  5621
  5622     MOVE 'D'                    TO  JP-RECORD-TYPE
  5623     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL650.cbl
  5624
  5625
  5626* EXEC CICS  DELETE
  5627*        DATASET  (PI-ACCT-ID)
  5628*    END-EXEC
  5629*    MOVE '&(                    &   #00005537' TO DFHEIV0
  5630     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5632     MOVE X'2020233030303035353337' TO DFHEIV0(25:11)
  5633     CALL 'kxdfhei1' USING DFHEIV0,
  5634           PI-ACCT-ID,
  5635           DFHEIV99,
  5636           DFHEIV99,
  5637           DFHEIV99,
  5638           DFHEIV99
  5639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5640
  5641     PERFORM 8400-LOG-JOURNAL-RECORD
  5642
  5643     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT
  5644
  5645     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5646                                     PI-ACCT-REST-OF-EXP
  5647                                     LINEO
  5648     MOVE ER-0000                TO  EMI-ERROR
  5649
  5650     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5651
  5652     IF PI-TOTAL-LINES  = 1
  5653         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  5654         MOVE ZEROS              TO  PI-TOTAL-LINES
  5655         MOVE 1                  TO  PI-PAGE-NUMBER
  5656         GO TO 7000-BUILD-OUTPUT-MAP
  5657     end-if
  5658     GO TO 1002-SHOW-NEW-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL650.cbl
  5660 2550-CHECK-HI-LO-DATES.
  5661     IF FROM-CHANGE
  5662         GO TO 2550-CHECK-CHANGE.
  5663
  5664     IF PI-BIN-LO-CERT (T-INDEX)  =  LOW-VALUES  AND
  5665        PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  5666         GO TO 2550-CHECK-AR-DELETE.
  5667
  5668     IF ((PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5669          PI-BIN-HI-CERT (T-INDEX) LESS BIN-MAX-DATE)
  5670       OR
  5671         (PI-BIN-LO-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5672          PI-BIN-LO-CERT (T-INDEX) LESS BIN-MAX-DATE))
  5673       AND
  5674            (PI-PROCESSOR-ID  NOT =  'LGXX')
  5675         MOVE ER-2087            TO  EMI-ERROR
  5676         MOVE -1                 TO  MAINTL
  5677         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5678
  5679 2550-CHECK-AR-DELETE.
  5680     IF NOT PI-AR-PROCESSING
  5681         GO TO 2550-EXIT.
  5682
  5683     IF T-INDEX NOT = LINEI
  5684         GO TO 2550-EXIT.
  5685
  5686     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  5687        GO TO 2550-EXIT.
  5688
  5689     MOVE ER-3155                TO  EMI-ERROR
  5690     MOVE -1                     TO  MAINTL
  5691     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5692
  5693 2550-CHECK-CHANGE.
  5694     IF PI-BIN-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  5695         GO TO 2550-CHECK-AR-CHANGE.
  5696
  5697     IF PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5698         MOVE ER-2113            TO  EMI-ERROR
  5699         MOVE -1                 TO  MAINTL
  5700         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5701
  5702 2550-CHECK-AR-CHANGE.
  5703      IF NOT PI-AR-PROCESSING
  5704          GO TO 2550-EXIT.
  5705
  5706      IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES
  5707          GO TO 2550-EXIT.
  5708
  5709      IF PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5710         MOVE ER-3155            TO  EMI-ERROR
  5711         MOVE -1                 TO  MAINTL
  5712         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5713
  5714 2550-EXIT.
  5715     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL650.cbl
  5717 2560-CHECK-PENDING-BUSINESS.
  5718     MOVE 'N'                    TO  PENDING-BUSINESS-SW.
  5719     MOVE LOW-VALUES             TO  ERPNDB-KEY
  5720                                     PI-ERPNDB-ALT-KEY.
  5721     MOVE AM-COMPANY-CD-A1       TO  PNDB-COMPANY-CD-A1
  5722                                     PI-PB-COMPANY-CD-A1.
  5723     MOVE AM-VG-CARRIER          TO  PNDB-CARRIER
  5724                                     PI-PB-CARRIER.
  5725     MOVE AM-VG-GROUPING         TO  PNDB-GROUPING
  5726                                     PI-PB-GROUPING.
  5727     MOVE AM-VG-STATE            TO  PNDB-STATE
  5728                                     PI-PB-STATE.
  5729     MOVE AM-VG-ACCOUNT          TO  PNDB-ACCOUNT
  5730                                     PI-PB-ACCOUNT.
  5731
  5732
  5733* EXEC CICS  HANDLE CONDITION
  5734*         NOTFND   (2568-NO-RECORDS)
  5735*         ENDFILE  (2568-NO-RECORDS)
  5736*    END-EXEC.
  5737*    MOVE '"$I''                  ! % #00005632' TO DFHEIV0
  5738     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5739     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5740     MOVE X'2520233030303035363332' TO DFHEIV0(25:11)
  5741     CALL 'kxdfhei1' USING DFHEIV0
  5742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5743
  5744
  5745
  5746* EXEC CICS  STARTBR
  5747*        DATASET  (PEND2-FILE-ID)
  5748*        RIDFLD   (ERPNDB-KEY)
  5749*    END-EXEC.
  5750     MOVE 0
  5751       TO DFHEIV11
  5752*    MOVE '&,         G          &   #00005637' TO DFHEIV0
  5753     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5754     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5755     MOVE X'2020233030303035363337' TO DFHEIV0(25:11)
  5756     CALL 'kxdfhei1' USING DFHEIV0,
  5757           PEND2-FILE-ID,
  5758           ERPNDB-KEY,
  5759           DFHEIV99,
  5760           DFHEIV11,
  5761           DFHEIV99
  5762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5763
  5764
  5765     MOVE 'Y'                    TO  PENDING-BROWSE-SW.
  5766
  5767 2562-READ-NEXT-PENDING.
  5768
  5769* EXEC CICS  READNEXT
  5770*        DATASET  (PEND2-FILE-ID)
  5771*        RIDFLD   (ERPNDB-KEY)
  5772*        SET      (ADDRESS OF PENDING-BUSINESS)
  5773*    END-EXEC.
  5774     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL650.cbl
  5775       TO DFHEIV11
  5776*    MOVE '&.S                   )   #00005645' TO DFHEIV0
  5777     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5778     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5779     MOVE X'2020233030303035363435' TO DFHEIV0(25:11)
  5780     CALL 'kxdfhei1' USING DFHEIV0,
  5781           PEND2-FILE-ID,
  5782           DFHEIV20,
  5783           DFHEIV99,
  5784           ERPNDB-KEY,
  5785           DFHEIV99,
  5786           DFHEIV11,
  5787           DFHEIV99,
  5788           DFHEIV99
  5789     SET ADDRESS OF PENDING-BUSINESS TO
  5790         DFHEIV20
  5791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5792
  5793
  5794     IF PB-COMPANY-CD-A1 = PI-PB-COMPANY-CD-A1 AND
  5795        PB-CARRIER       = PI-PB-CARRIER       AND
  5796        PB-GROUPING      = PI-PB-GROUPING      AND
  5797        PB-STATE         = PI-PB-STATE         AND
  5798        PB-ACCOUNT       = PI-PB-ACCOUNT
  5799            NEXT SENTENCE
  5800          ELSE
  5801            GO TO 2568-NO-RECORDS.
  5802
  5803     IF PB-ISSUE
  5804       OR  PB-CANCELLATION
  5805         NEXT SENTENCE
  5806     ELSE
  5807         GO TO 2562-READ-NEXT-PENDING.
  5808
  5809     IF PB-CERT-EFF-DT  IS EQUAL TO  AM-EFFECTIVE-DT
  5810         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5811         GO TO 2568-NO-RECORDS.
  5812
  5813     IF PB-CERT-EFF-DT  IS GREATER THAN  AM-EFFECTIVE-DT
  5814       AND PB-CERT-EFF-DT  IS LESS THAN  AM-EXPIRATION-DT
  5815         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5816         GO TO 2568-NO-RECORDS.
  5817
  5818     GO TO 2562-READ-NEXT-PENDING.
  5819
  5820 2568-NO-RECORDS.
  5821     IF PENDING-BROWSE-STARTED
  5822         MOVE ' '                TO  PENDING-BROWSE-SW
  5823
  5824* EXEC CICS ENDBR
  5825*           DATASET  (PEND2-FILE-ID)
  5826*       END-EXEC.
  5827     MOVE 0
  5828       TO DFHEIV11
  5829*    MOVE '&2                    $   #00005680' TO DFHEIV0
  5830     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5832     MOVE X'2020233030303035363830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL650.cbl
  5833     CALL 'kxdfhei1' USING DFHEIV0,
  5834           PEND2-FILE-ID,
  5835           DFHEIV11,
  5836           DFHEIV99
  5837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5838
  5839
  5840 2569-EXIT.
  5841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL650.cbl
  5843 3000-CHANGE-EXPIRATION.
  5844     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5845     PERFORM 6200-CHECK-KEY             THRU  6200-EXIT.
  5846     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5847     PERFORM 4100-BUILD-VERIFICATION    THRU  4199-EXIT.
  5848
  5849     SET T-INDEX  TO  PI-TOTAL-LINES.
  5850
  5851     PERFORM VARYING WS-INDEX FROM +1 BY +1
  5852             UNTIL  PI-BIN-EXP-DT (T-INDEX)
  5853                        =  WS-ACCT-EXP-DT (WS-INDEX)
  5854                 OR  WS-INDEX GREATER +32
  5855     END-PERFORM.
  5856
  5857     IF PI-BIN-EXP-DT (T-INDEX) = WS-ACCT-EXP-DT (WS-INDEX)
  5858         MOVE BIN-EXPCHG-SAVE    TO  WS-ACCT-EXP-DT (WS-INDEX)
  5859         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  5860             VARYING  WS-INDEX  FROM  +1  BY  +1
  5861               UNTIL  WS-INDEX GREATER +32
  5862     ELSE
  5863         MOVE ER-0453            TO  EMI-ERROR
  5864         MOVE -1                 TO  MAINTL
  5865         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5866
  5867     IF NOT EMI-NO-ERRORS
  5868         GO TO 8200-SEND-DATAONLY.
  5869
  5870     MOVE BIN-EXPCHG-SAVE        TO  BIN-MAX-DATE.
  5871     MOVE '2'                    TO  FROM-WHERE-SW.
  5872
  5873     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5874       VARYING  T-INDEX  FROM  +1  BY  +1
  5875         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5876
  5877     MOVE SPACE                  TO  FROM-WHERE-SW.
  5878
  5879     IF NOT EMI-NO-ERRORS
  5880         GO TO 8200-SEND-DATAONLY.
  5881
  5882     SET T-INDEX  TO  PI-TOTAL-LINES.
  5883     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  5884
  5885     IF NOT EMI-NO-ERRORS
  5886         GO TO 8200-SEND-DATAONLY.
  5887
  5888     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5889     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5890     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  5891     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  5892
  5893     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  5894
  5895     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  5896                                     AM-VG-EXPIRATION-DT
  5897                                     PI-BIN-EXP-DT (T-INDEX).
  5898     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  5899                                     PI-BIN-MAINT-DT (T-INDEX).
  5900     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL650.cbl
  5901     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  5902
  5903     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  5904
  5905     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  5906
  5907     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  5908
  5909     MOVE SPACES                 TO  EXPCHGI.
  5910     MOVE AL-UANOF               TO  EXPCHGA.
  5911     MOVE ER-0000                TO  EMI-ERROR.
  5912
  5913     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5914
  5915     GO TO 7000-BUILD-OUTPUT-MAP.
  5916
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL650.cbl
  5918 3100-DELETE-DATE-RANGE.
  5919
  5920* EXEC CICS GETMAIN
  5921*        LENGTH   (ACCT-REC-LEN)
  5922*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5923*        INITIMG  (GETMAIN-SPACE)
  5924*    END-EXEC.
  5925*    MOVE ',"IL                  $   #00005763' TO DFHEIV0
  5926     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5927     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5928     MOVE X'2020233030303035373633' TO DFHEIV0(25:11)
  5929     CALL 'kxdfhei1' USING DFHEIV0,
  5930           DFHEIV20,
  5931           ACCT-REC-LEN,
  5932           GETMAIN-SPACE
  5933     SET ADDRESS OF ACCOUNT-MASTER TO
  5934         DFHEIV20
  5935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5936
  5937
  5938
  5939* EXEC CICS  HANDLE CONDITION
  5940*        NOTFND   (3175-CONTINUE)
  5941*        ENDFILE  (3175-CONTINUE)
  5942*    END-EXEC.
  5943*    MOVE '"$I''                  ! & #00005769' TO DFHEIV0
  5944     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5945     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5946     MOVE X'2620233030303035373639' TO DFHEIV0(25:11)
  5947     CALL 'kxdfhei1' USING DFHEIV0
  5948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5949
  5950
  5951
  5952
  5953* EXEC CICS  READ
  5954*        UPDATE
  5955*        DATASET  (PI-ACCT-ID)
  5956*        INTO     (ACCOUNT-MASTER)
  5957*        RIDFLD   (PI-ACCT-KEY)
  5958*    END-EXEC.
  5959     MOVE LENGTH OF
  5960      ACCOUNT-MASTER
  5961       TO DFHEIV11
  5962*    MOVE '&"IL       EU         (   #00005775' TO DFHEIV0
  5963     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5964     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5965     MOVE X'2020233030303035373735' TO DFHEIV0(25:11)
  5966     CALL 'kxdfhei1' USING DFHEIV0,
  5967           PI-ACCT-ID,
  5968           ACCOUNT-MASTER,
  5969           DFHEIV11,
  5970           PI-ACCT-KEY,
  5971           DFHEIV99,
  5972           DFHEIV99,
  5973           DFHEIV99
  5974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5975
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL650.cbl
  5976
  5977     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5978     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5979     MOVE ACCT-FILE-ID           TO  FILE-ID.
  5980
  5981
  5982* EXEC CICS  DELETE
  5983*        DATASET  (PI-ACCT-ID)
  5984*    END-EXEC.
  5985*    MOVE '&(                    &   #00005786' TO DFHEIV0
  5986     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5988     MOVE X'2020233030303035373836' TO DFHEIV0(25:11)
  5989     CALL 'kxdfhei1' USING DFHEIV0,
  5990           PI-ACCT-ID,
  5991           DFHEIV99,
  5992           DFHEIV99,
  5993           DFHEIV99,
  5994           DFHEIV99
  5995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5996
  5997
  5998     PERFORM 8400-LOG-JOURNAL-RECORD.
  5999
  6000     GO TO 3199-EXIT.
  6001
  6002 3175-CONTINUE.
  6003     IF BROWSE-STARTED
  6004         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6005
  6006     MOVE ER-0226                TO  EMI-ERROR.
  6007
  6008     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6009
  6010     MOVE -1                     TO  MAINTL.
  6011
  6012     GO TO 8200-SEND-DATAONLY.
  6013
  6014 3199-EXIT.
  6015     EXIT.
  6016
  6017 3200-ADD-DATE-RANGE.
  6018     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6019     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6020
  6021
  6022* EXEC CICS  WRITE
  6023*        FROM     (ACCOUNT-MASTER)
  6024*        RIDFLD   (AM-CONTROL-PRIMARY)
  6025*        DATASET  (PI-ACCT-ID)
  6026*    END-EXEC.
  6027     MOVE LENGTH OF
  6028      ACCOUNT-MASTER
  6029       TO DFHEIV11
  6030*    MOVE '&$ L                  ''   #00005813' TO DFHEIV0
  6031     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6032     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6033     MOVE X'2020233030303035383133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL650.cbl
  6034     CALL 'kxdfhei1' USING DFHEIV0,
  6035           PI-ACCT-ID,
  6036           ACCOUNT-MASTER,
  6037           DFHEIV11,
  6038           AM-CONTROL-PRIMARY,
  6039           DFHEIV99,
  6040           DFHEIV99
  6041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6042
  6043
  6044     PERFORM 8400-LOG-JOURNAL-RECORD.
  6045
  6046 3299-EXIT.
  6047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL650.cbl
  6049 3500-CHANGE-EFFECTIVE.
  6050     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6051
  6052     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6053
  6054     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU  6000-EFF-EXIT.
  6055
  6056     IF NOT EMI-NO-ERRORS
  6057         GO TO 8200-SEND-DATAONLY.
  6058
  6059     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6060
  6061     SET T-INDEX                 TO  +1.
  6062
  6063     PERFORM VARYING  WS-INDEX  FROM  +1  BY  +1
  6064             UNTIL  PI-BIN-EFF-DT (T-INDEX)
  6065                        =  WS-ACCT-EFF-DT (WS-INDEX)
  6066                 OR  WS-INDEX GREATER +32
  6067     END-PERFORM.
  6068
  6069     IF PI-BIN-EFF-DT (T-INDEX)
  6070                 = WS-ACCT-EFF-DT (WS-INDEX)
  6071         MOVE BIN-EFFCHG-SAVE    TO  WS-ACCT-EFF-DT (WS-INDEX)
  6072         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  6073             VARYING  WS-INDEX  FROM  +1  BY  +1
  6074               UNTIL  WS-INDEX GREATER +32
  6075     ELSE
  6076         MOVE ER-0453            TO  EMI-ERROR
  6077         MOVE -1                 TO  MAINTL
  6078         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6079
  6080     IF NOT EMI-NO-ERRORS
  6081         GO TO 8200-SEND-DATAONLY.
  6082
  6083     SET T-INDEX TO  1.
  6084
  6085     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  6086
  6087     IF NOT EMI-NO-ERRORS
  6088         GO TO 8200-SEND-DATAONLY.
  6089
  6090     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6091     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6092     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  6093     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  6094
  6095
  6096* EXEC CICS  READ
  6097*        UPDATE
  6098*        DATASET  (PI-ACCT-ID)
  6099*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6100*        RIDFLD   (PI-ACCT-KEY)
  6101*    END-EXEC.
  6102*    MOVE '&"S        EU         (   #00005870' TO DFHEIV0
  6103     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6104     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6105     MOVE X'2020233030303035383730' TO DFHEIV0(25:11)
  6106     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL650.cbl
  6107           PI-ACCT-ID,
  6108           DFHEIV20,
  6109           DFHEIV99,
  6110           PI-ACCT-KEY,
  6111           DFHEIV99,
  6112           DFHEIV99,
  6113           DFHEIV99
  6114     SET ADDRESS OF ACCOUNT-MASTER TO
  6115         DFHEIV20
  6116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6117
  6118
  6119     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6120     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6121     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6122
  6123     PERFORM 8400-LOG-JOURNAL-RECORD.
  6124
  6125     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT
  6126                                     PI-BIN-EFF-DT (T-INDEX).
  6127     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  6128     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  6129                                     PI-BIN-MAINT-DT (T-INDEX).
  6130     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  6131     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  6132     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6133     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6134
  6135     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  6136
  6137
  6138* EXEC CICS  REWRITE
  6139*        FROM     (ACCOUNT-MASTER)
  6140*        DATASET  (PI-ACCT-ID)
  6141*    END-EXEC.
  6142     MOVE LENGTH OF
  6143      ACCOUNT-MASTER
  6144       TO DFHEIV11
  6145*    MOVE '&& L                  %   #00005895' TO DFHEIV0
  6146     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6147     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6148     MOVE X'2020233030303035383935' TO DFHEIV0(25:11)
  6149     CALL 'kxdfhei1' USING DFHEIV0,
  6150           PI-ACCT-ID,
  6151           ACCOUNT-MASTER,
  6152           DFHEIV11,
  6153           DFHEIV99
  6154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6155
  6156
  6157     PERFORM 8400-LOG-JOURNAL-RECORD.
  6158
  6159     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6160
  6161     MOVE SPACES                 TO  EFFCHGO.
  6162
  6163     MOVE ZERO                   TO  EFFCHGL
  6164                                     EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL650.cbl
  6165
  6166     MOVE AL-UANOF               TO  EFFCHGA.
  6167
  6168     MOVE ER-0000                TO  EMI-ERROR.
  6169
  6170     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6171
  6172     GO TO 7000-BUILD-OUTPUT-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL650.cbl
  6174 4000-CHANGE-ALL.
  6175     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6176
  6177     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6178
  6179     IF NOT EMI-NO-ERRORS
  6180         GO TO 8200-SEND-DATAONLY.
  6181
  6182     MOVE 1                      TO  PI-LINE-SELECTED.
  6183     MOVE MAINTI                 TO  PI-MAINT.
  6184     MOVE XCTL-6501              TO  PGM-NAME.
  6185
  6186     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL650.cbl
  6188 4100-BUILD-VERIFICATION.
  6189     MOVE SPACES                 TO  BROWSE-STARTED-SW.
  6190
  6191     SET WS-INDEX  TO  +1.
  6192
  6193     MOVE 'N'                    TO  WS-ACCT2-FOUND.
  6194     MOVE PI-ACCT-KEY            TO  WS-ACCT-VERIFY-KEY.
  6195     MOVE LOW-VALUES             TO  WS-ACCT-VER-EXP-DT
  6196                                     WS-VERIFY-AREA.
  6197
  6198     IF ST-ACCNT-CNTL  OR
  6199        ACCNT-CNTL
  6200          MOVE SPACES             TO  WS-ACCT-VER-CARR.
  6201
  6202     IF ST-ACCNT-CNTL      OR
  6203        CARR-ST-ACCNT-CNTL OR
  6204        ACCNT-CNTL         OR
  6205        CARR-ACCNT-CNTL
  6206          MOVE SPACES             TO  WS-ACCT-VER-GROUP.
  6207
  6208     IF ACCNT-CNTL OR
  6209        CARR-ACCNT-CNTL
  6210          MOVE SPACES             TO  WS-ACCT-VER-STATE.
  6211
  6212     MOVE WS-ACCT-VERIFY-KEY     TO  WS-SAVE-VERIFY-KEY.
  6213
  6214
  6215* EXEC CICS  HANDLE CONDITION
  6216*        NOTFND   (4175-CONTINUE)
  6217*        ENDFILE  (4175-CONTINUE)
  6218*    END-EXEC.
  6219*    MOVE '"$I''                  ! '' #00005957' TO DFHEIV0
  6220     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6221     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6222     MOVE X'2720233030303035393537' TO DFHEIV0(25:11)
  6223     CALL 'kxdfhei1' USING DFHEIV0
  6224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6225
  6226
  6227
  6228* EXEC CICS  STARTBR
  6229*        DATASET  (ACCT2-FILE-ID)
  6230*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6231*        GTEQ
  6232*    END-EXEC.
  6233     MOVE 0
  6234       TO DFHEIV11
  6235*    MOVE '&,         G          &   #00005962' TO DFHEIV0
  6236     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6237     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6238     MOVE X'2020233030303035393632' TO DFHEIV0(25:11)
  6239     CALL 'kxdfhei1' USING DFHEIV0,
  6240           ACCT2-FILE-ID,
  6241           WS-ACCT-VERIFY-KEY,
  6242           DFHEIV99,
  6243           DFHEIV11,
  6244           DFHEIV99
  6245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL650.cbl
  6246
  6247
  6248     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  6249
  6250 4150-READ-NEXT.
  6251
  6252* EXEC CICS  READNEXT
  6253*        DATASET  (ACCT2-FILE-ID)
  6254*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6255*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6256*    END-EXEC.
  6257     MOVE 0
  6258       TO DFHEIV11
  6259*    MOVE '&.S                   )   #00005971' TO DFHEIV0
  6260     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6261     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6262     MOVE X'2020233030303035393731' TO DFHEIV0(25:11)
  6263     CALL 'kxdfhei1' USING DFHEIV0,
  6264           ACCT2-FILE-ID,
  6265           DFHEIV20,
  6266           DFHEIV99,
  6267           WS-ACCT-VERIFY-KEY,
  6268           DFHEIV99,
  6269           DFHEIV11,
  6270           DFHEIV99,
  6271           DFHEIV99
  6272     SET ADDRESS OF ACCOUNT-MASTER TO
  6273         DFHEIV20
  6274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6275
  6276
  6277     MOVE AM-CONTROL-BY-VAR-GRP  TO  WS-TEST-KEY.
  6278
  6279     IF WS-TEST-KEY  NOT = WS-SAVE-VERIFY-KEY
  6280         GO TO 4175-CONTINUE.
  6281
  6282     MOVE 'Y'                    TO  WS-ACCT2-FOUND.
  6283     MOVE AM-CONTROL-PRIMARY     TO  WS-ACCT-KEY (WS-INDEX).
  6284     MOVE AM-VG-EXPIRATION-DT    TO  WS-ACCT-EXP-DT (WS-INDEX).
  6285     MOVE AM-EFFECTIVE-DT        TO  WS-ACCT-EFF-DT (WS-INDEX).
  6286     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6287     MOVE '3'                    TO  DC-OPTION-CODE.
  6288
  6289     PERFORM 9700-DATE-CONVERSION.
  6290
  6291     IF DATE-CONVERSION-ERROR
  6292         MOVE LOW-VALUES         TO  WS-ACCT-HI-CERT (WS-INDEX)
  6293     ELSE
  6294         MOVE DC-BIN-DATE-1      TO  WS-ACCT-HI-CERT (WS-INDEX).
  6295
  6296     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6297     MOVE '3'                    TO  DC-OPTION-CODE.
  6298
  6299     PERFORM 9700-DATE-CONVERSION.
  6300
  6301     IF DATE-CONVERSION-ERROR
  6302         MOVE LOW-VALUES         TO  WS-ACCT-LO-CERT (WS-INDEX)
  6303     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL650.cbl
  6304         MOVE DC-BIN-DATE-1      TO  WS-ACCT-LO-CERT (WS-INDEX).
  6305
  6306     SET WS-INDEX  UP  BY  +1.
  6307
  6308     GO TO 4150-READ-NEXT.
  6309
  6310 4175-CONTINUE.
  6311     IF BROWSE-STARTED
  6312
  6313* EXEC CICS  ENDBR
  6314*            DATASET  (ACCT2-FILE-ID)
  6315*        END-EXEC
  6316     MOVE 0
  6317       TO DFHEIV11
  6318*    MOVE '&2                    $   #00006012' TO DFHEIV0
  6319     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6320     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6321     MOVE X'2020233030303036303132' TO DFHEIV0(25:11)
  6322     CALL 'kxdfhei1' USING DFHEIV0,
  6323           ACCT2-FILE-ID,
  6324           DFHEIV11,
  6325           DFHEIV99
  6326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6327         MOVE SPACES             TO  BROWSE-STARTED-SW.
  6328
  6329 4199-EXIT.
  6330     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL650.cbl
  6332 4200-CHECK-VALIDITY.
  6333     IF (BIN-EXPCHG-SAVE GREATER
  6334                    WS-ACCT-EFF-DT (WS-INDEX))
  6335       AND  (BIN-EXPCHG-SAVE NOT GREATER
  6336                    WS-ACCT-EXP-DT (WS-INDEX))
  6337         MOVE ER-2051            TO  EMI-ERROR
  6338         MOVE -1                 TO  EXPCHGL
  6339         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6340
  6341     IF BIN-EFFCHG-SAVE NOT LESS WS-ACCT-EFF-DT (WS-INDEX) AND
  6342        BIN-EFFCHG-SAVE LESS     WS-ACCT-EXP-DT (WS-INDEX)
  6343          MOVE ER-2051            TO  EMI-ERROR
  6344          MOVE -1                 TO  EFFCHGL
  6345          PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6346
  6347 4200-EXIT.
  6348     EXIT.
  6349 4220-DISPLAY-VERI-TABLE.
  6350
  6351     perform varying d1 from +1 by +1 until
  6352        (d1 > +32)
  6353        or (ws-acct-eff-dt (d1) = low-values)
  6354        move ws-acct-eff-dt (d1) to dc-bin-date-1
  6355        move ' '                 to dc-option-code
  6356        perform 9700-date-conversion
  6357        move dc-greg-date-1-edit to ws-display-eff-date
  6358
  6359        move ws-acct-exp-dt (d1) to dc-bin-date-1
  6360        move ' '                 to dc-option-code
  6361        perform 9700-date-conversion
  6362        move dc-greg-date-1-edit to ws-display-exp-date
  6363
  6364        display ' date range ' d1 ' ' ws-display-eff-date
  6365                                  ' ' ws-display-exp-date
  6366     end-perform
  6367
  6368     .
  6369 4220-EXIT.
  6370     EXIT.
  6371
  6372 4300-VERIFY-INTEGRITY.
  6373     set d1 to ws-index
  6374     IF WS-ACCT-EFF-DT (WS-INDEX + 1)  = LOW-VALUES
  6375         SET WS-INDEX  TO  +32
  6376         GO TO 4399-EXIT.
  6377
  6378     IF ((WS-ACCT-EXP-DT (WS-INDEX)  =  BIN-EXPCHG-SAVE)  OR
  6379        (WS-ACCT-EFF-DT (WS-INDEX + 1)  =  BIN-EFFCHG-SAVE))
  6380                  AND
  6381        (WS-ACCT-EXP-DT (WS-INDEX) > WS-ACCT-EFF-DT (WS-INDEX))
  6382         SET WS-INDEX  TO  +33
  6383         GO TO 4399-EXIT.
  6384
  6385     IF (WS-ACCT-EXP-DT (WS-INDEX) NOT GREATER
  6386                    WS-ACCT-EFF-DT (WS-INDEX + 1))
  6387       AND  (WS-ACCT-EXP-DT (WS-INDEX) GREATER
  6388                    WS-ACCT-EFF-DT (WS-INDEX))
  6389         GO TO 4399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL650.cbl
  6390
  6391     MOVE ER-2051                TO  EMI-ERROR.
  6392     MOVE -1                     TO  EXPCHGL.
  6393
  6394     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6395
  6396 4399-EXIT.
  6397     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL650.cbl
  6399 4500-CREATE-NEW-ACCOUNT.
  6400     PERFORM 6100-BUILD-KEY            THRU 6199-EXIT.
  6401
  6402     PERFORM 6700-VERIFY-STATE-CARRIER THRU 6799-EXIT.
  6403
  6404     IF MAINTI = 'T'
  6405         PERFORM 6000-EDIT-EFFECTIVE-DATE THRU 6000-EFF-EXIT.
  6406
  6407     PERFORM 4100-BUILD-VERIFICATION THRU 4199-EXIT.
  6408
  6409     IF WS-ACCT2-FOUND = 'Y'
  6410         MOVE ER-0561            TO  EMI-ERROR
  6411         MOVE -1                 TO  MAINTL
  6412         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6413
  6414     MOVE SPACES                 TO  GETMAIN-SW.
  6415
  6416     IF NOT EMI-NO-ERRORS
  6417         GO TO 8200-SEND-DATAONLY.
  6418
  6419     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6420         MOVE ER-0453            TO  EMI-ERROR
  6421         MOVE -1                 TO  MAINTL
  6422         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6423         GO TO 8200-SEND-DATAONLY.
  6424
  6425     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6426
  6427     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6428                                     PI-ACCT-REST-OF-EXP.
  6429
  6430     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  6431
  6432     IF REC-FOUND
  6433         MOVE -1                 TO  ACARIERL
  6434         MOVE ER-0561            TO  EMI-ERROR
  6435         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6436         GO TO 8200-SEND-DATAONLY.
  6437
  6438     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6439     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6440                                     PI-ACCT-REST-OF-EXP.
  6441
  6442
  6443* EXEC CICS  HANDLE CONDITION
  6444*        NOTFND   (4530-NOT-FOUND)
  6445*        ENDFILE  (4530-NOT-FOUND)
  6446*    END-EXEC.
  6447*    MOVE '"$I''                  ! ( #00006130' TO DFHEIV0
  6448     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6450     MOVE X'2820233030303036313330' TO DFHEIV0(25:11)
  6451     CALL 'kxdfhei1' USING DFHEIV0
  6452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6453
  6454
  6455     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6456
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL650.cbl
  6457 4510-READ-NEXT.
  6458     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6459
  6460     IF PI-ACCT-CCGSA-KEY  NOT = PI-PREV-ACCOUNT
  6461         GO TO 4540-END-COPY.
  6462
  6463     MOVE AM-EXPIRATION-DT       TO  WS-EXP-SAVE.
  6464     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6465     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6466     MOVE WS-EXP-SAVE            TO  AM-EXPIRATION-DT.
  6467
  6468     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6469
  6470     IF MAINTI  = 'T'
  6471         MOVE '2'                TO  AM-STATUS
  6472         MOVE AM-ACCOUNT         TO  AM-AGT (1)
  6473         MOVE PI-ACCT-CARRIER    TO  AM-TRNFROM-CARRIER
  6474         MOVE PI-ACCT-GROUPING   TO  AM-TRNFROM-GROUPING
  6475         MOVE PI-ACCT-STATE      TO  AM-TRNFROM-STATE
  6476         MOVE PI-ACCT-ACCOUNT    TO  AM-TRNFROM-ACCOUNT
  6477         MOVE BIN-EFFCHG-SAVE    TO  AM-TRNFROM-DTE
  6478     ELSE
  6479         MOVE LOW-VALUES         TO  AM-AR-HI-CERT-DATE
  6480         MOVE ZEROS              TO  AM-HI-CERT-DATE
  6481                                     AM-LO-CERT-DATE
  6482         MOVE SPACES             TO  AM-1ST-PROD-DATE
  6483                                     AM-PREV-DATES
  6484                                     AM-ORIG-DEALER-NO
  6485     END-IF
  6486
  6487     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6488     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6489     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6490     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6491
  6492     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6493
  6494     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6495     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6496
  6497     PERFORM 6320-ENDBR THRU 6320-EXIT.
  6498
  6499
  6500* EXEC CICS GETMAIN
  6501*        LENGTH   (ACCT-REC-LEN)
  6502*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6503*        INITIMG  (GETMAIN-SPACE)
  6504*    END-EXEC.
  6505*    MOVE ',"IL                  $   #00006179' TO DFHEIV0
  6506     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6507     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6508     MOVE X'2020233030303036313739' TO DFHEIV0(25:11)
  6509     CALL 'kxdfhei1' USING DFHEIV0,
  6510           DFHEIV20,
  6511           ACCT-REC-LEN,
  6512           GETMAIN-SPACE
  6513     SET ADDRESS OF ACCOUNT-MASTER TO
  6514         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL650.cbl
  6515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6516
  6517
  6518     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6519
  6520
  6521* EXEC CICS  WRITE
  6522*        DATASET  (PI-ACCT-ID)
  6523*        RIDFLD   (AM-CONTROL-PRIMARY)
  6524*        FROM     (ACCOUNT-MASTER)
  6525*    END-EXEC.
  6526     MOVE LENGTH OF
  6527      ACCOUNT-MASTER
  6528       TO DFHEIV11
  6529*    MOVE '&$ L                  ''   #00006187' TO DFHEIV0
  6530     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6531     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6532     MOVE X'2020233030303036313837' TO DFHEIV0(25:11)
  6533     CALL 'kxdfhei1' USING DFHEIV0,
  6534           PI-ACCT-ID,
  6535           ACCOUNT-MASTER,
  6536           DFHEIV11,
  6537           AM-CONTROL-PRIMARY,
  6538           DFHEIV99,
  6539           DFHEIV99
  6540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6541
  6542
  6543     MOVE PI-ACCT-ID             TO  FILE-ID.
  6544
  6545     PERFORM 8400-LOG-JOURNAL-RECORD.
  6546
  6547     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  6548     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6549
  6550     GO TO 4510-READ-NEXT.
  6551
  6552 4530-NOT-FOUND.
  6553     IF BROWSE-STARTED
  6554         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6555
  6556     MOVE ER-0226                TO  EMI-ERROR.
  6557
  6558     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6559
  6560     MOVE -1                     TO  MAINTL.
  6561
  6562     GO TO 8200-SEND-DATAONLY.
  6563
  6564 4540-END-COPY.
  6565     IF MAINTI = 'K'
  6566         IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  6567             NEXT SENTENCE
  6568         ELSE
  6569             PERFORM 4600-ADD-ERPLAN-RECORD THRU 4699-EXIT.
  6570
  6571     IF BROWSE-STARTED
  6572         PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL650.cbl
  6573
  6574     IF MAINTI  NOT = 'T'
  6575         GO TO 4590-SHOW-NEW-ACCOUNT.
  6576
  6577     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6578     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6579                                     PI-ACCT-REST-OF-EXP.
  6580
  6581     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6582
  6583 4550-READ-NEXT.
  6584     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6585
  6586     IF PI-ACCT-CCGSA-KEY  NOT =  PI-PREV-ACCOUNT
  6587         GO TO 4570-END-REWRITE.
  6588
  6589
  6590* EXEC CICS  READ
  6591*        UPDATE
  6592*        DATASET  (PI-ACCT-ID)
  6593*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6594*        RIDFLD   (PI-ACCT-KEY)
  6595*    END-EXEC.
  6596*    MOVE '&"S        EU         (   #00006239' TO DFHEIV0
  6597     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6598     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6599     MOVE X'2020233030303036323339' TO DFHEIV0(25:11)
  6600     CALL 'kxdfhei1' USING DFHEIV0,
  6601           PI-ACCT-ID,
  6602           DFHEIV20,
  6603           DFHEIV99,
  6604           PI-ACCT-KEY,
  6605           DFHEIV99,
  6606           DFHEIV99,
  6607           DFHEIV99
  6608     SET ADDRESS OF ACCOUNT-MASTER TO
  6609         DFHEIV20
  6610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6611
  6612
  6613     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6614     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6615     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6616
  6617     PERFORM 8400-LOG-JOURNAL-RECORD.
  6618
  6619     MOVE NEW-KEY-CNTRL          TO  AM-TRANSFERRED-TO.
  6620     MOVE BIN-EFFCHG-SAVE        TO  AM-TRNTO-DTE.
  6621     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6622     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6623     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6624     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6625     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6626
  6627
  6628* EXEC CICS  REWRITE
  6629*        DATASET  (PI-ACCT-ID)
  6630*        FROM     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL650.cbl
  6631*    END-EXEC.
  6632     MOVE LENGTH OF
  6633      ACCOUNT-MASTER
  6634       TO DFHEIV11
  6635*    MOVE '&& L                  %   #00006260' TO DFHEIV0
  6636     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6637     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6638     MOVE X'2020233030303036323630' TO DFHEIV0(25:11)
  6639     CALL 'kxdfhei1' USING DFHEIV0,
  6640           PI-ACCT-ID,
  6641           ACCOUNT-MASTER,
  6642           DFHEIV11,
  6643           DFHEIV99
  6644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6645
  6646
  6647     MOVE PI-ACCT-ID             TO  FILE-ID.
  6648
  6649     PERFORM 8400-LOG-JOURNAL-RECORD.
  6650
  6651     GO TO 4550-READ-NEXT.
  6652
  6653 4570-END-REWRITE.
  6654     IF BROWSE-STARTED
  6655         PERFORM 6320-ENDBR  THRU  6320-EXIT.
  6656
  6657     MOVE SPACES                 TO  MAINTI
  6658                                     EFFCHGI.
  6659     MOVE AL-UANOF               TO  EFFCHGA.
  6660
  6661 4590-SHOW-NEW-ACCOUNT.
  6662     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6663
  6664     MOVE NEW-KEY-SAVE           TO  PI-PREV-ACCOUNT
  6665                                     PI-ACCT-CCGSA-KEY.
  6666
  6667     MOVE -1                     TO  MAINTL.
  6668     MOVE ER-0000                TO  EMI-ERROR.
  6669
  6670     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6671
  6672     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT.
  6673
  6674     GO TO 1002-SHOW-NEW-RECORDS.
  6675
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL650.cbl
  6677 4600-ADD-ERPLAN-RECORD.
  6678
  6679* EXEC CICS  HANDLE CONDITION
  6680*        NOTFND   (4699-EXIT)
  6681*        ENDFILE  (4689-EOF)
  6682*    END-EXEC.
  6683*    MOVE '"$I''                  ! ) #00006296' TO DFHEIV0
  6684     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6686     MOVE X'2920233030303036323936' TO DFHEIV0(25:11)
  6687     CALL 'kxdfhei1' USING DFHEIV0
  6688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6689
  6690
  6691     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6692     MOVE PI-PREV-ACCOUNT       TO EK-CCGSA-KEY.
  6693
  6694     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6695
  6696 4610-READ-NEXT.
  6697     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6698
  6699     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6700         GO TO 4689-EOF.
  6701
  6702     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  6703
  6704     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  6705     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  6706     MOVE EK-REVISION            TO  PL-REVISION-NO.
  6707
  6708     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  6709
  6710     MOVE PLAN-MASTER            TO  JP-RECORD-AREA.
  6711
  6712
  6713* EXEC CICS  ENDBR
  6714*        DATASET  (PLAN-FILE-ID)
  6715*    END-EXEC.
  6716     MOVE 0
  6717       TO DFHEIV11
  6718*    MOVE '&2                    $   #00006322' TO DFHEIV0
  6719     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6720     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6721     MOVE X'2020233030303036333232' TO DFHEIV0(25:11)
  6722     CALL 'kxdfhei1' USING DFHEIV0,
  6723           PLAN-FILE-ID,
  6724           DFHEIV11,
  6725           DFHEIV99
  6726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6727
  6728
  6729
  6730* EXEC CICS GETMAIN
  6731*        LENGTH   (PLAN-REC-LEN)
  6732*        SET      (ADDRESS OF PLAN-MASTER)
  6733*        INITIMG  (GETMAIN-SPACE)
  6734*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL650.cbl
  6735*    MOVE ',"IL                  $   #00006326' TO DFHEIV0
  6736     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6738     MOVE X'2020233030303036333236' TO DFHEIV0(25:11)
  6739     CALL 'kxdfhei1' USING DFHEIV0,
  6740           DFHEIV20,
  6741           PLAN-REC-LEN,
  6742           GETMAIN-SPACE
  6743     SET ADDRESS OF PLAN-MASTER TO
  6744         DFHEIV20
  6745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6746
  6747
  6748     MOVE JP-RECORD-AREA         TO PLAN-MASTER.
  6749
  6750
  6751* EXEC CICS  WRITE
  6752*        DATASET  (PLAN-FILE-ID)
  6753*        RIDFLD   (PL-CONTROL-PRIMARY)
  6754*        FROM     (PLAN-MASTER)
  6755*    END-EXEC.
  6756     MOVE LENGTH OF
  6757      PLAN-MASTER
  6758       TO DFHEIV11
  6759*    MOVE '&$ L                  ''   #00006334' TO DFHEIV0
  6760     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6761     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6762     MOVE X'2020233030303036333334' TO DFHEIV0(25:11)
  6763     CALL 'kxdfhei1' USING DFHEIV0,
  6764           PLAN-FILE-ID,
  6765           PLAN-MASTER,
  6766           DFHEIV11,
  6767           PL-CONTROL-PRIMARY,
  6768           DFHEIV99,
  6769           DFHEIV99
  6770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6771
  6772
  6773     PERFORM 4700-STARTBR-PLAN  THRU 4700-EXIT.
  6774     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6775
  6776     GO TO 4610-READ-NEXT.
  6777
  6778 4689-EOF.
  6779
  6780* EXEC CICS  ENDBR
  6781*        DATASET  (PLAN-FILE-ID)
  6782*    END-EXEC.
  6783     MOVE 0
  6784       TO DFHEIV11
  6785*    MOVE '&2                    $   #00006346' TO DFHEIV0
  6786     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6787     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6788     MOVE X'2020233030303036333436' TO DFHEIV0(25:11)
  6789     CALL 'kxdfhei1' USING DFHEIV0,
  6790           PLAN-FILE-ID,
  6791           DFHEIV11,
  6792           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL650.cbl
  6793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6794
  6795
  6796 4699-EXIT.
  6797      EXIT.
  6798
  6799 4700-STARTBR-PLAN.
  6800
  6801* EXEC CICS  STARTBR
  6802*        DATASET  (PLAN-FILE-ID)
  6803*        RIDFLD   (WS-PLAN-KEY)
  6804*    END-EXEC.
  6805     MOVE 0
  6806       TO DFHEIV11
  6807*    MOVE '&,         G          &   #00006354' TO DFHEIV0
  6808     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6809     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6810     MOVE X'2020233030303036333534' TO DFHEIV0(25:11)
  6811     CALL 'kxdfhei1' USING DFHEIV0,
  6812           PLAN-FILE-ID,
  6813           WS-PLAN-KEY,
  6814           DFHEIV99,
  6815           DFHEIV11,
  6816           DFHEIV99
  6817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6818
  6819
  6820 4700-EXIT.
  6821      EXIT.
  6822
  6823 4710-READNEXT-PLAN.
  6824
  6825* EXEC CICS  READNEXT
  6826*        DATASET  (PLAN-FILE-ID)
  6827*        SET      (ADDRESS OF PLAN-MASTER)
  6828*        RIDFLD   (WS-PLAN-KEY)
  6829*    END-EXEC.
  6830     MOVE 0
  6831       TO DFHEIV11
  6832*    MOVE '&.S                   )   #00006363' TO DFHEIV0
  6833     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6834     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6835     MOVE X'2020233030303036333633' TO DFHEIV0(25:11)
  6836     CALL 'kxdfhei1' USING DFHEIV0,
  6837           PLAN-FILE-ID,
  6838           DFHEIV20,
  6839           DFHEIV99,
  6840           WS-PLAN-KEY,
  6841           DFHEIV99,
  6842           DFHEIV11,
  6843           DFHEIV99,
  6844           DFHEIV99
  6845     SET ADDRESS OF PLAN-MASTER TO
  6846         DFHEIV20
  6847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6848
  6849
  6850 4710-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL650.cbl
  6851      EXIT.
  6852
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL650.cbl
  6854 4800-DELETE-PLAN-REC.
  6855
  6856* EXEC CICS  HANDLE CONDITION
  6857*        NOTFND   (4899-EXIT)
  6858*        ENDFILE  (4889-EOF)
  6859*    END-EXEC.
  6860*    MOVE '"$I''                  ! * #00006374' TO DFHEIV0
  6861     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6862     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6863     MOVE X'2A20233030303036333734' TO DFHEIV0(25:11)
  6864     CALL 'kxdfhei1' USING DFHEIV0
  6865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6866
  6867
  6868     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6869     MOVE AM-CONTROL-PRIMARY    TO EK-CCGSA-KEY
  6870                                   PI-PREV-ACCOUNT.
  6871
  6872 4805-STARTBR.
  6873     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6874
  6875 4810-READ-NEXT.
  6876     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6877
  6878     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6879         GO TO 4889-EOF.
  6880
  6881
  6882* EXEC CICS  ENDBR
  6883*        DATASET  (PLAN-FILE-ID)
  6884*    END-EXEC.
  6885     MOVE 0
  6886       TO DFHEIV11
  6887*    MOVE '&2                    $   #00006392' TO DFHEIV0
  6888     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6889     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6890     MOVE X'2020233030303036333932' TO DFHEIV0(25:11)
  6891     CALL 'kxdfhei1' USING DFHEIV0,
  6892           PLAN-FILE-ID,
  6893           DFHEIV11,
  6894           DFHEIV99
  6895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6896
  6897
  6898
  6899* EXEC CICS  READ
  6900*        UPDATE
  6901*        DATASET  (PLAN-FILE-ID)
  6902*        SET      (ADDRESS OF PLAN-MASTER)
  6903*        RIDFLD   (WS-PLAN-KEY)
  6904*    END-EXEC.
  6905*    MOVE '&"S        EU         (   #00006396' TO DFHEIV0
  6906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6907     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6908     MOVE X'2020233030303036333936' TO DFHEIV0(25:11)
  6909     CALL 'kxdfhei1' USING DFHEIV0,
  6910           PLAN-FILE-ID,
  6911           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL650.cbl
  6912           DFHEIV99,
  6913           WS-PLAN-KEY,
  6914           DFHEIV99,
  6915           DFHEIV99,
  6916           DFHEIV99
  6917     SET ADDRESS OF PLAN-MASTER TO
  6918         DFHEIV20
  6919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6920
  6921
  6922
  6923* EXEC CICS  DELETE
  6924*        DATASET  (PLAN-FILE-ID)
  6925*    END-EXEC.
  6926*    MOVE '&(                    &   #00006403' TO DFHEIV0
  6927     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6928     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6929     MOVE X'2020233030303036343033' TO DFHEIV0(25:11)
  6930     CALL 'kxdfhei1' USING DFHEIV0,
  6931           PLAN-FILE-ID,
  6932           DFHEIV99,
  6933           DFHEIV99,
  6934           DFHEIV99,
  6935           DFHEIV99
  6936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6937
  6938
  6939     GO TO 4805-STARTBR.
  6940
  6941 4889-EOF.
  6942
  6943* EXEC CICS  ENDBR
  6944*        DATASET  (PLAN-FILE-ID)
  6945*    END-EXEC.
  6946     MOVE 0
  6947       TO DFHEIV11
  6948*    MOVE '&2                    $   #00006410' TO DFHEIV0
  6949     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6950     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6951     MOVE X'2020233030303036343130' TO DFHEIV0(25:11)
  6952     CALL 'kxdfhei1' USING DFHEIV0,
  6953           PLAN-FILE-ID,
  6954           DFHEIV11,
  6955           DFHEIV99
  6956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6957
  6958
  6959 4899-EXIT.
  6960      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL650.cbl
  6962 4900-CREATE-NEW-ACCOUNT.
  6963     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  6964
  6965     SET T-INDEX                 TO  LINEI.
  6966
  6967     IF PI-2ND-PAGE
  6968         SET T-INDEX  UP  BY  8
  6969     ELSE
  6970     IF PI-3RD-PAGE
  6971         SET T-INDEX  UP  BY  16
  6972     ELSE
  6973     IF PI-LST-PAGE
  6974         SET T-INDEX  UP  BY  24.
  6975
  6976     IF EFFCHGL NOT =  ZERO
  6977         PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT
  6978       ELSE
  6979         MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-EFFCHG-SAVE.
  6980
  6981     IF EXPCHGL NOT =  ZERO
  6982         PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT
  6983       ELSE
  6984         MOVE PI-BIN-EXP-DT (T-INDEX)  TO  BIN-EXPCHG-SAVE.
  6985
  6986     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  6987
  6988     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  6989         MOVE -1                 TO  EXPCHGL
  6990         MOVE ER-1228            TO  EMI-ERROR
  6991         MOVE AL-UABON           TO  EXPCHGA
  6992         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6993
  6994     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  6995
  6996     IF EMI-ERROR  NOT = ZEROS
  6997         GO TO 8200-SEND-DATAONLY.
  6998
  6999     MOVE SPACES                 TO  GETMAIN-SW.
  7000
  7001     IF NOT EMI-NO-ERRORS
  7002         GO TO 8200-SEND-DATAONLY.
  7003
  7004     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  7005         MOVE ER-0453            TO  EMI-ERROR
  7006         MOVE -1                 TO  MAINTL
  7007         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7008         GO TO 8200-SEND-DATAONLY.
  7009
  7010     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  7011
  7012     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7013
  7014     PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  7015         VARYING  WS-INDEX  FROM  +1  BY  +1
  7016            UNTIL WS-INDEX GREATER +32.
  7017
  7018     IF NOT EMI-NO-ERRORS
  7019         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL650.cbl
  7020
  7021     MOVE PI-PREV-ACCOUNT          TO  PI-ACCT-CCGSA-KEY.
  7022     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7023     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7024
  7025     PERFORM 6500-READ-ACCT     THRU  6599-EXIT.
  7026
  7027     MOVE LOW-VALUES             TO  AM-AR-HI-CERT-DATE
  7028     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  7029                                     AM-LO-CERT-DATE
  7030     MOVE ZEROS                  TO  AM-DCC-MAX-MARKETING-FEE
  7031     MOVE SPACES                 TO  AM-1ST-PROD-DATE
  7032                                     AM-PREV-DATES
  7033                                     AM-ORIG-DEALER-NO
  7034
  7035     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  7036     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  7037     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  7038     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  7039
  7040     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  7041
  7042     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7043     MOVE 'A'                    TO  JP-RECORD-TYPE.
  7044
  7045
  7046* EXEC CICS GETMAIN
  7047*        LENGTH   (ACCT-REC-LEN)
  7048*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7049*        INITIMG  (GETMAIN-SPACE)
  7050*    END-EXEC.
  7051*    MOVE ',"IL                  $   #00006500' TO DFHEIV0
  7052     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7053     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7054     MOVE X'2020233030303036353030' TO DFHEIV0(25:11)
  7055     CALL 'kxdfhei1' USING DFHEIV0,
  7056           DFHEIV20,
  7057           ACCT-REC-LEN,
  7058           GETMAIN-SPACE
  7059     SET ADDRESS OF ACCOUNT-MASTER TO
  7060         DFHEIV20
  7061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7062
  7063
  7064     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  7065     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  7066     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  7067     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  7068     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7069                                     AM-VG-EXPIRATION-DT.
  7070
  7071     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  7072
  7073
  7074* EXEC CICS  HANDLE CONDITION
  7075*        DUPREC   (4580-DUPREC)
  7076*        DUPKEY   (4580-DUPREC)
  7077*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL650.cbl
  7078*    MOVE '"$%$                  ! + #00006515' TO DFHEIV0
  7079     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7081     MOVE X'2B20233030303036353135' TO DFHEIV0(25:11)
  7082     CALL 'kxdfhei1' USING DFHEIV0
  7083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7084
  7085
  7086
  7087* EXEC CICS  WRITE
  7088*        DATASET  (PI-ACCT-ID)
  7089*        RIDFLD   (AM-CONTROL-PRIMARY)
  7090*        FROM     (ACCOUNT-MASTER)
  7091*    END-EXEC.
  7092     MOVE LENGTH OF
  7093      ACCOUNT-MASTER
  7094       TO DFHEIV11
  7095*    MOVE '&$ L                  ''   #00006520' TO DFHEIV0
  7096     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7097     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7098     MOVE X'2020233030303036353230' TO DFHEIV0(25:11)
  7099     CALL 'kxdfhei1' USING DFHEIV0,
  7100           PI-ACCT-ID,
  7101           ACCOUNT-MASTER,
  7102           DFHEIV11,
  7103           AM-CONTROL-PRIMARY,
  7104           DFHEIV99,
  7105           DFHEIV99
  7106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7107
  7108
  7109     MOVE PI-ACCT-ID             TO  FILE-ID.
  7110
  7111     PERFORM 8400-LOG-JOURNAL-RECORD.
  7112
  7113     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7114         NEXT SENTENCE
  7115     ELSE
  7116         PERFORM 4950-ADD-ERPLAN-RECORD THRU 4959-EXIT
  7117         PERFORM 4960-ADD-ERCOMP-RECORD THRU 4969-EXIT.
  7118
  7119 4580-DUPREC.
  7120     MOVE 1                  TO K-WITH-LINE-USED.
  7121     MOVE LOW-VALUES         TO EL650AI.
  7122
  7123     GO TO 4590-SHOW-NEW-ACCOUNT.
  7124
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL650.cbl
  7126 4950-ADD-ERPLAN-RECORD.
  7127
  7128* EXEC CICS GETMAIN
  7129*        LENGTH   (PLAN-REC-LEN)
  7130*        SET      (ADDRESS OF PLAN-MASTER)
  7131*        INITIMG  (GETMAIN-SPACE)
  7132*    END-EXEC.
  7133*    MOVE ',"IL                  $   #00006544' TO DFHEIV0
  7134     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7135     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7136     MOVE X'2020233030303036353434' TO DFHEIV0(25:11)
  7137     CALL 'kxdfhei1' USING DFHEIV0,
  7138           DFHEIV20,
  7139           PLAN-REC-LEN,
  7140           GETMAIN-SPACE
  7141     SET ADDRESS OF PLAN-MASTER TO
  7142         DFHEIV20
  7143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7144
  7145
  7146
  7147* EXEC CICS  HANDLE CONDITION
  7148*        DUPREC   (4959-EXIT)
  7149*        DUPKEY   (4959-EXIT)
  7150*    END-EXEC.
  7151*    MOVE '"$%$                  ! , #00006550' TO DFHEIV0
  7152     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7154     MOVE X'2C20233030303036353530' TO DFHEIV0(25:11)
  7155     CALL 'kxdfhei1' USING DFHEIV0
  7156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7157
  7158
  7159     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  7160
  7161     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  7162     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  7163     MOVE EK-REVISION            TO  PL-REVISION-NO.
  7164
  7165     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  7166
  7167
  7168* EXEC CICS  WRITE
  7169*        DATASET  (PLAN-FILE-ID)
  7170*        RIDFLD   (PL-CONTROL-PRIMARY)
  7171*        FROM     (PLAN-MASTER)
  7172*    END-EXEC.
  7173     MOVE LENGTH OF
  7174      PLAN-MASTER
  7175       TO DFHEIV11
  7176*    MOVE '&$ L                  ''   #00006563' TO DFHEIV0
  7177     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7178     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7179     MOVE X'2020233030303036353633' TO DFHEIV0(25:11)
  7180     CALL 'kxdfhei1' USING DFHEIV0,
  7181           PLAN-FILE-ID,
  7182           PLAN-MASTER,
  7183           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL650.cbl
  7184           PL-CONTROL-PRIMARY,
  7185           DFHEIV99,
  7186           DFHEIV99
  7187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7188
  7189
  7190 4959-EXIT.
  7191     EXIT.
  7192
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL650.cbl
  7194 4960-ADD-ERCOMP-RECORD.
  7195
  7196* EXEC CICS GETMAIN
  7197*         LENGTH   (COMP-REC-LEN)
  7198*         SET      (ADDRESS OF COMPENSATION-MASTER)
  7199*         INITIMG  (GETMAIN-SPACE)
  7200*    END-EXEC.
  7201*    MOVE ',"IL                  $   #00006574' TO DFHEIV0
  7202     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7203     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7204     MOVE X'2020233030303036353734' TO DFHEIV0(25:11)
  7205     CALL 'kxdfhei1' USING DFHEIV0,
  7206           DFHEIV20,
  7207           COMP-REC-LEN,
  7208           GETMAIN-SPACE
  7209     SET ADDRESS OF COMPENSATION-MASTER TO
  7210         DFHEIV20
  7211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7212
  7213
  7214     MOVE SPACES                 TO COMPENSATION-MASTER.
  7215     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  7216                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  7217                   CO-OV30         CO-OV60      CO-OV90
  7218                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  7219                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  7220                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  7221                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  7222                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  7223                   CO-CURRENT-CUR     CO-CURRENT-OV30
  7224                   CO-CURRENT-OV60    CO-CURRENT-OV90
  7225                   CO-CURRENT-CUR-PMT
  7226                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  7227                   CO-ACT-YEAR        CO-ACT-MONTH
  7228                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  7229                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  7230                   CO-CURRENT-LAST-STMT-YEAR
  7231                   CO-CURRENT-LAST-STMT-MONTH
  7232                   CO-CURRENT-LAST-STMT-DAY
  7233                   CO-YTD-PAID-COM
  7234                   CO-YTD-PAID-OV co-ov120 co-current-ov120
  7235     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  7236     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  7237     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  7238     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  7239     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  7240
  7241     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  7242         MOVE ZEROS              TO CO-CARRIER
  7243     ELSE
  7244         MOVE AM-CARRIER         TO CO-CARRIER.
  7245
  7246     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  7247         MOVE ZEROS              TO CO-GROUPING
  7248     ELSE
  7249         MOVE AM-GROUPING        TO CO-GROUPING.
  7250
  7251     MOVE 'A'                    TO CO-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL650.cbl
  7252     MOVE AM-NAME                TO CO-ACCT-NAME.
  7253     MOVE AM-PERSON              TO CO-MAIL-NAME.
  7254     MOVE AM-ADDRS               TO CO-ADDR-1.
  7255*    MOVE AM-CITY                TO CO-ADDR-3.
  7256     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  7257     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  7258     MOVE AM-ZIP                 TO CO-ZIP.
  7259     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  7260     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  7261     MOVE AM-ID-NO               TO CO-SOC-SEC.
  7262
  7263     IF AM-REMIT-TO NOT = ZERO
  7264         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  7265       ELSE
  7266         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  7267
  7268     MOVE +0                      TO AGT-SUB.
  7269
  7270     PERFORM 4970-FIND-C-AGT THRU 4970-EXIT.
  7271
  7272     IF VALID-AGT-SW = 'Y'
  7273         NEXT SENTENCE
  7274     ELSE
  7275         GO TO 4969-EXIT.
  7276
  7277     IF CO-RESP-NO = CO-ACCOUNT
  7278         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  7279     ELSE
  7280         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  7281
  7282     IF PI-AR-PROCESSING
  7283        MOVE 'G'                   TO CO-AR-REPORTING
  7284        MOVE '1'                   TO CO-AR-BAL-LEVEL
  7285        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  7286        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  7287
  7288     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  7289        MOVE 'N'                   TO CO-AR-REPORTING.
  7290
  7291     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  7292        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  7293
  7294     PERFORM 4980-ADD-COMPENSATION-NAME THRU 4980-EXIT.
  7295
  7296
  7297* EXEC CICS HANDLE CONDITION
  7298*         DUPREC   (4969-EXIT)
  7299*         DUPKEY   (4969-EXIT)
  7300*    END-EXEC.
  7301*    MOVE '"$%$                  ! - #00006662' TO DFHEIV0
  7302     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7304     MOVE X'2D20233030303036363632' TO DFHEIV0(25:11)
  7305     CALL 'kxdfhei1' USING DFHEIV0
  7306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7307
  7308
  7309
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL650.cbl
  7310* EXEC CICS WRITE
  7311*        FROM      (COMPENSATION-MASTER)
  7312*        RIDFLD    (CO-CONTROL-PRIMARY)
  7313*        DATASET   (COMP-FILE-ID)
  7314*    END-EXEC.
  7315     MOVE LENGTH OF
  7316      COMPENSATION-MASTER
  7317       TO DFHEIV11
  7318*    MOVE '&$ L                  ''   #00006667' TO DFHEIV0
  7319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7321     MOVE X'2020233030303036363637' TO DFHEIV0(25:11)
  7322     CALL 'kxdfhei1' USING DFHEIV0,
  7323           COMP-FILE-ID,
  7324           COMPENSATION-MASTER,
  7325           DFHEIV11,
  7326           CO-CONTROL-PRIMARY,
  7327           DFHEIV99,
  7328           DFHEIV99
  7329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7330
  7331
  7332 4969-EXIT.
  7333     EXIT.
  7334
  7335 4970-FIND-C-AGT.
  7336     ADD 1 TO  AGT-SUB.
  7337     IF AGT-SUB GREATER 10
  7338         MOVE 'N'                TO  VALID-AGT-SW
  7339         GO TO 4970-EXIT.
  7340
  7341     IF (AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F')
  7342         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  7343         MOVE 'Y'                TO  VALID-AGT-SW
  7344         GO TO 4970-EXIT
  7345     ELSE
  7346         GO TO 4970-FIND-C-AGT.
  7347
  7348 4970-EXIT.
  7349     EXIT.
  7350
  7351 4980-ADD-COMPENSATION-NAME.
  7352
  7353* EXEC CICS HANDLE CONDITION
  7354*         DUPREC   (4980-EXIT)
  7355*    END-EXEC.
  7356*    MOVE '"$%                   ! . #00006693' TO DFHEIV0
  7357     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7359     MOVE X'2E20233030303036363933' TO DFHEIV0(25:11)
  7360     CALL 'kxdfhei1' USING DFHEIV0
  7361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7362
  7363
  7364
  7365* EXEC CICS GETMAIN
  7366*         LENGTH   (NAME-REC-LEN)
  7367*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL650.cbl
  7368*         INITIMG  (GETMAIN-SPACE)
  7369*    END-EXEC.
  7370*    MOVE ',"IL                  $   #00006697' TO DFHEIV0
  7371     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7372     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7373     MOVE X'2020233030303036363937' TO DFHEIV0(25:11)
  7374     CALL 'kxdfhei1' USING DFHEIV0,
  7375           DFHEIV20,
  7376           NAME-REC-LEN,
  7377           GETMAIN-SPACE
  7378     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7379         DFHEIV20
  7380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7381
  7382
  7383     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7384     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7385     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7386     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7387     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7388     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7389     MOVE CO-ADDR-CITY           TO  NL-CITY
  7390     MOVE CO-ADDR-STATE          TO  NL-ST
  7391     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7392     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7393     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7394     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7395     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7396     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7397     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7398
  7399
  7400* EXEC CICS WRITE
  7401*        FROM      (NAME-LOOKUP-MASTER)
  7402*        RIDFLD    (NL-CONTROL-PRIMARY)
  7403*        DATASET   (NAME-FILE-ID)
  7404*    END-EXEC.
  7405     MOVE LENGTH OF
  7406      NAME-LOOKUP-MASTER
  7407       TO DFHEIV11
  7408*    MOVE '&$ L                  ''   #00006719' TO DFHEIV0
  7409     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7411     MOVE X'2020233030303036373139' TO DFHEIV0(25:11)
  7412     CALL 'kxdfhei1' USING DFHEIV0,
  7413           NAME-FILE-ID,
  7414           NAME-LOOKUP-MASTER,
  7415           DFHEIV11,
  7416           NL-CONTROL-PRIMARY,
  7417           DFHEIV99,
  7418           DFHEIV99
  7419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7420
  7421
  7422 4980-EXIT.
  7423     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL650.cbl
  7425 5000-CREATE-NEW-RANGE.
  7426
  7427     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  7428     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  7429
  7430     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU 6000-EFF-EXIT.
  7431     PERFORM 6000-EDIT-EXPIRATION-DATE THRU 6000-EXP-EXIT.
  7432
  7433     SET T-INDEX TO PI-TOTAL-LINES.
  7434
  7435     PERFORM 600A-CHECK-HI-LO-DATES    THRU 600A-EXIT
  7436        VARYING T-INDEX FROM T-INDEX BY +1
  7437         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  7438
  7439     IF NOT EMI-NO-ERRORS
  7440         GO TO 8200-SEND-DATAONLY.
  7441
  7442     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7443     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7444
  7445     IF BIN-EFFCHG-SAVE NOT LESS BIN-EXPCHG-SAVE
  7446         MOVE -1                 TO  EFFCHGL EXPCHGL
  7447         MOVE AL-UANON           TO  EFFCHGA EXPCHGA
  7448         MOVE ER-2053            TO  EMI-ERROR
  7449         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7450
  7451     IF NOT EMI-NO-ERRORS
  7452         GO TO 8200-SEND-DATAONLY.
  7453
  7454***************************************************************
  7455*    NO EFFECTIVE DATE ENTERED, WILL USE CURRENT EXPIRATION   *
  7456*    DATE IF WITHIN LIMITS                                    *
  7457***************************************************************
  7458
  7459     IF EFFCHGL = ZERO
  7460         SET T-INDEX             TO  PI-TOTAL-LINES
  7461         IF PI-BIN-EXP-DT (T-INDEX)  =  HIGH-VALUES
  7462             MOVE ER-2060        TO  EMI-ERROR
  7463             MOVE -1             TO  EFFCHGL
  7464             MOVE AL-UABON       TO  EFFCHGA
  7465             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7466             GO TO 8200-SEND-DATAONLY
  7467         ELSE
  7468             IF PI-BIN-EXP-DT (T-INDEX) NOT LESS
  7469                    BIN-EXPCHG-SAVE
  7470                 MOVE ER-2061    TO  EMI-ERROR
  7471                 MOVE -1         TO  EXPCHGL
  7472                 MOVE AL-UABON   TO  EXPCHGA
  7473                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7474                 GO TO 8200-SEND-DATAONLY.
  7475
  7476     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7477
  7478*    display ' VERI TABLE BEFORE '
  7479*    perform 4220-DISPLAY-VERI-TABLE
  7480*                                thru 4220-exit
  7481     IF EFFCHGL = ZERO
  7482         MOVE PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL650.cbl
  7483                                 TO WS-ACCT-EFF-DT (WS-INDEX)
  7484         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX)
  7485     ELSE
  7486         MOVE BIN-EFFCHG-SAVE    TO WS-ACCT-EFF-DT (WS-INDEX)
  7487                                    WS-ACCT-EXP-DT (WS-INDEX - 1)
  7488         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX).
  7489
  7490*    display ' VERI TABLE AFTER  '
  7491*    perform 4220-DISPLAY-VERI-TABLE
  7492*                                thru 4220-exit
  7493     PERFORM 4300-VERIFY-INTEGRITY  THRU  4399-EXIT
  7494         VARYING  WS-INDEX  FROM  +1  BY  +1
  7495           UNTIL  WS-INDEX  GREATER +32.
  7496
  7497     IF NOT EMI-NO-ERRORS
  7498         GO TO 8200-SEND-DATAONLY.
  7499
  7500     IF EFFCHGL  =  ZEROS
  7501         MOVE PI-BIN-EXP-DT (T-INDEX)
  7502                                  TO  PI-ACCT-EXP-DT
  7503                                      BIN-EFFCHG-SAVE
  7504                                      DC-BIN-DATE-1
  7505         MOVE SPACE               TO  DC-OPTION-CODE
  7506         PERFORM 9700-DATE-CONVERSION
  7507***  Y2K PROJ 7744
  7508         MOVE DC-GREG-DATE-1-YMD  TO  WS-EFFCHG-SAVE
  7509         MOVE DC-ALPHA-CENTURY    TO  WS-EFFCHG-SAVE(4:2)
  7510         MOVE WS-EFFCHG-SAVE      TO  EFFCHG-SAVE
  7511
  7512         PERFORM 5020-READ-PREV-REC
  7513         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT
  7514         GO TO 5005-EXIT
  7515     END-IF.
  7516***  Y2K PROJ 7744
  7517
  7518     IF NOT EMI-NO-ERRORS
  7519         GO TO 8200-SEND-DATAONLY.
  7520
  7521     SET T-INDEX  TO  PI-TOTAL-LINES.
  7522
  7523*    IF (EFFCHGL GREATER THAN +0) AND
  7524*       (EXPCHGL GREATER THAN +0)
  7525*       IF (PI-BIN-EXP-DT (T-INDEX) EQUAL HIGH-VALUES) AND
  7526*          (BIN-EXPCHG-SAVE EQUAL HIGH-VALUES)
  7527*          NEXT SENTENCE
  7528*       ELSE
  7529*          GO TO 5006-FIND-EXP-DATE.
  7530*
  7531
  7532
  7533***************************************************************
  7534*    EFFECTIVE DATE ENTERED, WILL REPLACE CURRENT EXPIRATION  *
  7535*    DATE IF ALL NINES AND CREATE NEW RANGE                   *
  7536***************************************************************
  7537     SET T-INDEX  TO  PI-TOTAL-LINES.
  7538
  7539     IF BROWSE-STARTED-SW EQUAL 'Y'
  7540        PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL650.cbl
  7541
  7542     IF PI-BIN-EXP-DT (T-INDEX)  = HIGH-VALUES
  7543         IF PI-BIN-EFF-DT (T-INDEX) NOT LESS BIN-EFFCHG-SAVE
  7544             MOVE ER-2063             TO  EMI-ERROR
  7545             MOVE -1                  TO  EFFCHGL
  7546             MOVE AL-UABON            TO  EFFCHGA
  7547             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7548             GO TO 8200-SEND-DATAONLY
  7549         ELSE
  7550             MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  7551             MOVE LOW-VALUES              TO  PI-ACCT-REST-OF-EXP
  7552             MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7553             MOVE PI-BIN-EFF-DT (T-INDEX)
  7554                                      TO  B4-ACCT-EFF-DT
  7555             PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7556             MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7557                                          AM-VG-EXPIRATION-DT
  7558                                          PI-BIN-EXP-DT
  7559                                                    (T-INDEX)
  7560             MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7561             MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7562             PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7563             PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7564             PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7565             GO TO 5005-EXIT.
  7566
  7567***************************************************************
  7568*    EFFECTIVE DATE ENTERED, CHECK TO ENSURE EFFECTIVE        *
  7569*    DATE GREATER PREVIOUS EXPIRATION DATE                    *
  7570***************************************************************
  7571     SET T-INDEX  TO  PI-TOTAL-LINES.
  7572
  7573     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7574     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7575
  7576     IF BIN-EFFCHG-SAVE LESS PI-BIN-EXP-DT (T-INDEX)
  7577         PERFORM 5010-CHECK-VALID-NEW-RANGE  THRU  5010-EXIT
  7578     ELSE
  7579         PERFORM 5020-READ-PREV-REC
  7580         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT.
  7581
  7582 5005-EXIT.
  7583     MOVE SPACES                 TO  EFFCHGO
  7584                                     EXPCHGI.
  7585     MOVE AL-UANOF               TO  EFFCHGA
  7586                                     EXPCHGA.
  7587     MOVE ER-0000                TO  EMI-ERROR.
  7588
  7589     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7590
  7591     GO TO 7000-BUILD-OUTPUT-MAP.
  7592
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL650.cbl
  7594 5006-FIND-EXP-DATE.
  7595     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  7596                                     PI-ACCT-REST-OF-EXP.
  7597     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7598
  7599     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7600         VARYING  T-INDEX  FROM  +1  BY  +1
  7601           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EFFCHG-SAVE.
  7602
  7603     IF BIN-EFFCHG-SAVE > PI-BIN-EXP-DT (T-INDEX)
  7604        MOVE ER-1220             TO  EMI-ERROR
  7605        MOVE -1                  TO  EFFCHGL
  7606        MOVE AL-UABON            TO  EFFCHGA
  7607        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7608        GO TO         8200-SEND-DATAONLY.
  7609
  7610     IF (BIN-EFFCHG-SAVE > PI-BIN-EFF-DT (T-INDEX)) AND
  7611        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7612        PERFORM 5007-CREATE-SUB-DATE-RANGES THRU 5007-EXIT
  7613        MOVE 1 TO PI-PAGE-NUMBER
  7614        GO TO 1000-SHOW-ACCOUNT
  7615     ELSE
  7616     IF (BIN-EFFCHG-SAVE = PI-BIN-EFF-DT (T-INDEX)) AND
  7617        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7618        PERFORM 5008-CREATE-SUB-DATE-RANGES THRU 5008-EXIT
  7619        MOVE 1 TO PI-PAGE-NUMBER
  7620        GO TO 1000-SHOW-ACCOUNT
  7621     ELSE
  7622        MOVE ER-2051             TO  EMI-ERROR
  7623        MOVE -1                  TO  EFFCHGL
  7624        MOVE AL-UABON            TO  EFFCHGA
  7625        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7626        GO TO 8200-SEND-DATAONLY.
  7627
  7628 5006-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL650.cbl
  7630 5007-CREATE-SUB-DATE-RANGES.
  7631
  7632     IF BROWSE-STARTED-SW EQUAL 'Y'
  7633        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7634
  7635     IF NOT SYSTEM-MODIFY-CAP
  7636         MOVE 'UPDATE'           TO  SM-READ
  7637         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7638         MOVE ER-0070            TO  EMI-ERROR
  7639         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7640         GO TO 8100-SEND-INITIAL-MAP.
  7641
  7642
  7643* EXEC CICS GETMAIN
  7644*        LENGTH   (ACCT-REC-LEN)
  7645*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7646*        INITIMG  (GETMAIN-SPACE)
  7647*    END-EXEC.
  7648*    MOVE ',"IL                  $   #00006945' TO DFHEIV0
  7649     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7651     MOVE X'2020233030303036393435' TO DFHEIV0(25:11)
  7652     CALL 'kxdfhei1' USING DFHEIV0,
  7653           DFHEIV20,
  7654           ACCT-REC-LEN,
  7655           GETMAIN-SPACE
  7656     SET ADDRESS OF ACCOUNT-MASTER TO
  7657         DFHEIV20
  7658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7659
  7660
  7661
  7662* EXEC CICS  HANDLE CONDITION
  7663*        ENDFILE  (5007-EXIT)
  7664*        NOTFND   (5007-EXIT)
  7665*    END-EXEC.
  7666*    MOVE '"$''I                  ! / #00006951' TO DFHEIV0
  7667     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7669     MOVE X'2F20233030303036393531' TO DFHEIV0(25:11)
  7670     CALL 'kxdfhei1' USING DFHEIV0
  7671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7672
  7673
  7674     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7675     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7676
  7677
  7678* EXEC CICS  READ
  7679*        UPDATE
  7680*        DATASET  (PI-ACCT-ID)
  7681*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7682*        RIDFLD   (PI-ACCT-KEY)
  7683*    END-EXEC.
  7684*    MOVE '&"S        EU         (   #00006959' TO DFHEIV0
  7685     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7686     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7687     MOVE X'2020233030303036393539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL650.cbl
  7688     CALL 'kxdfhei1' USING DFHEIV0,
  7689           PI-ACCT-ID,
  7690           DFHEIV20,
  7691           DFHEIV99,
  7692           PI-ACCT-KEY,
  7693           DFHEIV99,
  7694           DFHEIV99,
  7695           DFHEIV99
  7696     SET ADDRESS OF ACCOUNT-MASTER TO
  7697         DFHEIV20
  7698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7699
  7700
  7701     MOVE AM-CONTROL-PRIMARY     TO  SAVE-ACCT-KEY.
  7702     MOVE AM-EXPIRATION-DT       TO  SAVE-CURR-EXP-DT.
  7703     MOVE AM-EFFECTIVE-DT        TO  SAVE-CURR-EFF-DT.
  7704     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7705     MOVE AM-EXPIRATION-DT       TO  AF-ACCT-EFF-DT.
  7706     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7707     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7708     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7709     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7710
  7711     MOVE BIN-EXPCHG-SAVE     TO  AM-EFFECTIVE-DT
  7712                                  PI-BIN-EFF-DT (T-INDEX).
  7713
  7714* EXEC CICS  REWRITE
  7715*        FROM     (ACCOUNT-MASTER)
  7716*        DATASET  (PI-ACCT-ID)
  7717*    END-EXEC.
  7718     MOVE LENGTH OF
  7719      ACCOUNT-MASTER
  7720       TO DFHEIV11
  7721*    MOVE '&& L                  %   #00006978' TO DFHEIV0
  7722     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7723     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7724     MOVE X'2020233030303036393738' TO DFHEIV0(25:11)
  7725     CALL 'kxdfhei1' USING DFHEIV0,
  7726           PI-ACCT-ID,
  7727           ACCOUNT-MASTER,
  7728           DFHEIV11,
  7729           DFHEIV99
  7730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7731
  7732
  7733
  7734* EXEC CICS SYNCPOINT
  7735*    END-EXEC.
  7736*    MOVE '6"                    !   #00006983' TO DFHEIV0
  7737     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7739     MOVE X'2020233030303036393833' TO DFHEIV0(25:11)
  7740     CALL 'kxdfhei1' USING DFHEIV0
  7741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7742
  7743
  7744     PERFORM 8400-LOG-JOURNAL-RECORD.
  7745     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL650.cbl
  7746     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7747     MOVE LOW-VALUES          TO  AM-CNTRL-B.
  7748     MOVE SAVE-CURR-EFF-DT    TO  PI-BIN-EFF-DT (T-INDEX)
  7749                                  AM-EFFECTIVE-DT.
  7750     MOVE BIN-EFFCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7751                                  AM-EXPIRATION-DT
  7752                                  AM-VG-EXPIRATION-DT.
  7753     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7754                                  PI-BIN-MAINT-DT (T-INDEX).
  7755     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7756     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7757     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7758     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7759                                  AM-PREV-DATES.
  7760     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7761
  7762
  7763* EXEC CICS  HANDLE CONDITION
  7764*        ENDFILE  (5007-EXIT)
  7765*        NOTFND   (5007-EXIT)
  7766*        DUPREC   (5007-EXIT)
  7767*        ILLOGIC  (5007-EXIT)
  7768*        INVREQ   (5007-EXIT)
  7769*    END-EXEC.
  7770*    MOVE '"$''I%38               ! 0 #00007004' TO DFHEIV0
  7771     MOVE X'222427492533382020202020' TO DFHEIV0(1:12)
  7772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7773     MOVE X'3020233030303037303034' TO DFHEIV0(25:11)
  7774     CALL 'kxdfhei1' USING DFHEIV0
  7775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7776
  7777
  7778     MOVE 'AM'                TO AM-RECORD-ID.
  7779
  7780     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7781     PERFORM 8400-LOG-JOURNAL-RECORD.
  7782     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7783
  7784     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7785     MOVE BIN-EFFCHG-SAVE     TO  AM-EFFECTIVE-DT
  7786                                  PI-BIN-EFF-DT (T-INDEX).
  7787     MOVE BIN-EXPCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7788                                  AM-EXPIRATION-DT
  7789                                  AM-VG-EXPIRATION-DT.
  7790     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7791                                  PI-BIN-MAINT-DT (T-INDEX).
  7792     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7793     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7794                                  AM-PREV-DATES.
  7795     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7796     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7797     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7798     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7799     PERFORM 8400-LOG-JOURNAL-RECORD.
  7800     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7801
  7802     MOVE ZERO                TO EFFCHGL
  7803                                 EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL650.cbl
  7804
  7805
  7806* EXEC CICS  HANDLE CONDITION
  7807*         NOTFND   (5015-NOT-FOUND)
  7808*         ENDFILE  (5015-NOT-FOUND)
  7809*    END-EXEC.
  7810*    MOVE '"$I''                  ! 1 #00007039' TO DFHEIV0
  7811     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7813     MOVE X'3120233030303037303339' TO DFHEIV0(25:11)
  7814     CALL 'kxdfhei1' USING DFHEIV0
  7815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7816
  7817
  7818 5007-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL650.cbl
  7820 5008-CREATE-SUB-DATE-RANGES.
  7821
  7822     IF BROWSE-STARTED-SW EQUAL 'Y'
  7823        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7824
  7825     IF NOT SYSTEM-MODIFY-CAP
  7826         MOVE 'UPDATE'           TO  SM-READ
  7827         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7828         MOVE ER-0070            TO  EMI-ERROR
  7829         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7830         GO TO 8100-SEND-INITIAL-MAP.
  7831
  7832     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7833     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7834     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  7835     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  7836
  7837     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  7838
  7839     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7840                                     AM-VG-EXPIRATION-DT
  7841                                     PI-BIN-EXP-DT (T-INDEX).
  7842     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7843                                     PI-BIN-MAINT-DT (T-INDEX).
  7844     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7845     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7846
  7847     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7848
  7849     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7850
  7851     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7852
  7853     IF T-INDEX = PI-TOTAL-LINES
  7854        MOVE ZERO             TO EFFCHGL
  7855                                 EXPCHGL
  7856        GO TO 5008-EXIT.
  7857
  7858     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  7859     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  7860     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7861
  7862     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  7863
  7864     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7865         VARYING  T-INDEX  FROM T-INDEX  BY  +1
  7866           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EXPCHG-SAVE.
  7867
  7868     IF BROWSE-STARTED-SW EQUAL 'Y'
  7869        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7870
  7871
  7872* EXEC CICS  READ
  7873*        UPDATE
  7874*        DATASET  (PI-ACCT-ID)
  7875*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7876*        RIDFLD   (PI-ACCT-KEY)
  7877*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL650.cbl
  7878*    MOVE '&"S        EU         (   #00007097' TO DFHEIV0
  7879     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7880     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7881     MOVE X'2020233030303037303937' TO DFHEIV0(25:11)
  7882     CALL 'kxdfhei1' USING DFHEIV0,
  7883           PI-ACCT-ID,
  7884           DFHEIV20,
  7885           DFHEIV99,
  7886           PI-ACCT-KEY,
  7887           DFHEIV99,
  7888           DFHEIV99,
  7889           DFHEIV99
  7890     SET ADDRESS OF ACCOUNT-MASTER TO
  7891         DFHEIV20
  7892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7893
  7894
  7895     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7896     MOVE ACCT-FILE-ID           TO  FILE-ID.
  7897     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7898
  7899     PERFORM 8400-LOG-JOURNAL-RECORD.
  7900
  7901     MOVE BIN-EXPCHG-SAVE        TO  AM-EFFECTIVE-DT
  7902                                     PI-BIN-EFF-DT (T-INDEX).
  7903     MOVE EXPCHG-SAVE            TO  AM-EFFECT-DT.
  7904     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7905                                     PI-BIN-MAINT-DT (T-INDEX).
  7906     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7907     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7908     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7909     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7910
  7911     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7912
  7913
  7914* EXEC CICS  REWRITE
  7915*        FROM     (ACCOUNT-MASTER)
  7916*        DATASET  (PI-ACCT-ID)
  7917*    END-EXEC.
  7918     MOVE LENGTH OF
  7919      ACCOUNT-MASTER
  7920       TO DFHEIV11
  7921*    MOVE '&& L                  %   #00007122' TO DFHEIV0
  7922     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7923     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7924     MOVE X'2020233030303037313232' TO DFHEIV0(25:11)
  7925     CALL 'kxdfhei1' USING DFHEIV0,
  7926           PI-ACCT-ID,
  7927           ACCOUNT-MASTER,
  7928           DFHEIV11,
  7929           DFHEIV99
  7930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7931
  7932
  7933     PERFORM 8400-LOG-JOURNAL-RECORD.
  7934
  7935     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL650.cbl
  7936
  7937
  7938
  7939     MOVE ZERO                TO EFFCHGL
  7940                                 EXPCHGL.
  7941
  7942
  7943* EXEC CICS  HANDLE CONDITION
  7944*         NOTFND   (5015-NOT-FOUND)
  7945*         ENDFILE  (5015-NOT-FOUND)
  7946*    END-EXEC.
  7947*    MOVE '"$I''                  ! 2 #00007136' TO DFHEIV0
  7948     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7950     MOVE X'3220233030303037313336' TO DFHEIV0(25:11)
  7951     CALL 'kxdfhei1' USING DFHEIV0
  7952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7953
  7954
  7955 5008-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL650.cbl
  7957 5010-CHECK-VALID-NEW-RANGE.
  7958
  7959***************************************************************
  7960*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7961*    CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED        *
  7962***************************************************************
  7963
  7964     IF PI-AR-PROCESSING
  7965        GO TO 5010-CHECK-AR-VALID-NEW-RANGE.
  7966
  7967     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7968                        GREATER BIN-EFFCHG-SAVE          AND
  7969                        GREATER PI-BIN-HI-CERT (T-INDEX)
  7970         MOVE PI-BIN-EXP-DT (T-INDEX)
  7971                                  TO  PI-ACCT-EXP-DT
  7972         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7973         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7974         MOVE PI-BIN-EFF-DT (T-INDEX)
  7975                                  TO  B4-ACCT-EFF-DT
  7976         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7977         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7978                                      AM-VG-EXPIRATION-DT
  7979                                      PI-BIN-EXP-DT (T-INDEX)
  7980         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7981         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7982         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7983         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7984         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7985         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7986     ELSE
  7987         MOVE ER-2051             TO  EMI-ERROR
  7988         MOVE -1                  TO  EFFCHGL
  7989         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  7990         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7991         GO TO 8200-SEND-DATAONLY.
  7992
  7993     GO TO 5010-EXIT.
  7994
  7995 5010-CHECK-AR-VALID-NEW-RANGE.
  7996
  7997***************************************************************
  7998*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7999*    A/R CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED    *
  8000***************************************************************
  8001
  8002     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  8003                        GREATER BIN-EFFCHG-SAVE          AND
  8004                        GREATER PI-BIN-AR-HI-CERT (T-INDEX)
  8005         MOVE PI-BIN-EXP-DT (T-INDEX)
  8006                                  TO  PI-ACCT-EXP-DT
  8007         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  8008         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  8009         MOVE PI-BIN-EFF-DT (T-INDEX)
  8010                                  TO  B4-ACCT-EFF-DT
  8011         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  8012         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  8013                                      AM-VG-EXPIRATION-DT
  8014                                      PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL650.cbl
  8015         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  8016         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  8017         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  8018         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  8019         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  8020         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  8021     ELSE
  8022         MOVE ER-2051             TO  EMI-ERROR
  8023         MOVE -1                  TO  EFFCHGL
  8024         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8025         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8026         GO TO 8200-SEND-DATAONLY.
  8027
  8028 5010-EXIT.
  8029     EXIT.
  8030
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL650.cbl
  8032 5015-NOT-FOUND.
  8033     MOVE ER-0226                TO  EMI-ERROR.
  8034     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8035     MOVE -1                 TO  MAINTL.
  8036     GO TO 8200-SEND-DATAONLY.
  8037
  8038 5015-EXIT.
  8039     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL650.cbl
  8041 5020-READ-PREV-REC.
  8042
  8043* EXEC CICS  READ
  8044*        DATASET  (PI-ACCT-ID)
  8045*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8046*        RIDFLD   (PI-ACCT-KEY)
  8047*    END-EXEC.
  8048*    MOVE '&"S        E          (   #00007228' TO DFHEIV0
  8049     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8051     MOVE X'2020233030303037323238' TO DFHEIV0(25:11)
  8052     CALL 'kxdfhei1' USING DFHEIV0,
  8053           PI-ACCT-ID,
  8054           DFHEIV20,
  8055           DFHEIV99,
  8056           PI-ACCT-KEY,
  8057           DFHEIV99,
  8058           DFHEIV99,
  8059           DFHEIV99
  8060     SET ADDRESS OF ACCOUNT-MASTER TO
  8061         DFHEIV20
  8062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8063
  8064
  8065 5050-CREATE-NEW-REC.
  8066     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  8067     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  8068                                     AM-VG-EXPIRATION-DT.
  8069     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  8070     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE
  8071                                     AM-1ST-PROD-DATE
  8072                                     AM-PREV-DATES
  8073                                     AM-BILLING-STATUS.
  8074     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  8075                                     AM-LO-CERT-DATE.
  8076
  8077     IF AM-AR-HI-CERT-DATE NOT LESS THAN AM-EFFECTIVE-DT
  8078        NEXT SENTENCE
  8079     ELSE
  8080        MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE.
  8081
  8082     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  8083     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  8084     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  8085
  8086     SET T-INDEX  UP  BY  1.
  8087     IF T-INDEX  GREATER 32
  8088         MOVE ER-2062            TO  EMI-ERROR
  8089         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8090         MOVE -1                 TO  MAINTL
  8091         GO TO 8200-SEND-DATAONLY.
  8092
  8093     ADD 1                       TO  PI-TOTAL-LINES.
  8094
  8095     MOVE LOW-VALUES             TO  PI-TABLE-ENT    (T-INDEX).
  8096     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT   (T-INDEX).
  8097     MOVE BIN-EXPCHG-SAVE        TO  PI-BIN-EXP-DT   (T-INDEX).
  8098     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL650.cbl
  8099     MOVE BIN-CURRENT-SAVE       TO  PI-BIN-MAINT-DT (T-INDEX).
  8100
  8101     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  8102
  8103     MOVE 'A'                    TO  JP-RECORD-TYPE.
  8104     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  8105     MOVE ACCT-FILE-ID           TO  FILE-ID.
  8106
  8107
  8108* EXEC CICS  WRITE
  8109*        RIDFLD   (AM-CONTROL-PRIMARY)
  8110*        FROM     (ACCOUNT-MASTER)
  8111*        DATASET  (PI-ACCT-ID)
  8112*    END-EXEC.
  8113     MOVE LENGTH OF
  8114      ACCOUNT-MASTER
  8115       TO DFHEIV11
  8116*    MOVE '&$ L                  ''   #00007276' TO DFHEIV0
  8117     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8118     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8119     MOVE X'2020233030303037323736' TO DFHEIV0(25:11)
  8120     CALL 'kxdfhei1' USING DFHEIV0,
  8121           PI-ACCT-ID,
  8122           ACCOUNT-MASTER,
  8123           DFHEIV11,
  8124           AM-CONTROL-PRIMARY,
  8125           DFHEIV99,
  8126           DFHEIV99
  8127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8128
  8129
  8130     PERFORM 8400-LOG-JOURNAL-RECORD.
  8131
  8132     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  8133
  8134 5050-EXIT.
  8135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL650.cbl
  8137 5100-FIND-NEXT-RANGE.
  8138     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8139
  8140     IF PI-TOTAL-LINES  = ZERO
  8141         GO TO 5210-NO-DATA.
  8142
  8143     IF PI-LST-PAGE
  8144       OR (PI-FST-PAGE AND PI-TOTAL-LINES NOT GREATER 8)
  8145       OR (PI-2ND-PAGE AND PI-TOTAL-LINES NOT GREATER 16)
  8146       OR (PI-3RD-PAGE AND PI-TOTAL-LINES NOT GREATER 24)
  8147         MOVE ER-2065            TO  EMI-ERROR
  8148         MOVE -1                 TO  MAINTL
  8149         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8150         GO TO 8200-SEND-DATAONLY.
  8151
  8152     IF PI-FST-PAGE
  8153         MOVE 2                  TO  PI-PAGE-NUMBER
  8154     ELSE
  8155     IF PI-2ND-PAGE
  8156         MOVE 3                  TO  PI-PAGE-NUMBER
  8157     ELSE
  8158     IF PI-3RD-PAGE
  8159         MOVE 4                  TO  PI-PAGE-NUMBER.
  8160
  8161     GO TO 7000-BUILD-OUTPUT-MAP.
  8162
  8163 5200-FIND-PREV-RANGE.
  8164     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8165
  8166     IF PI-TOTAL-LINES  =  ZERO
  8167         GO TO 5210-NO-DATA.
  8168
  8169     IF PI-FST-PAGE
  8170         MOVE ER-2066            TO  EMI-ERROR
  8171         MOVE -1                 TO  MAINTL
  8172         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8173         GO TO 8200-SEND-DATAONLY.
  8174
  8175     IF PI-2ND-PAGE
  8176         MOVE 1                  TO  PI-PAGE-NUMBER
  8177     ELSE
  8178     IF PI-3RD-PAGE
  8179         MOVE 2                  TO  PI-PAGE-NUMBER
  8180     ELSE
  8181     IF PI-LST-PAGE
  8182         MOVE 3                  TO  PI-PAGE-NUMBER.
  8183
  8184     GO TO 7000-BUILD-OUTPUT-MAP.
  8185
  8186 5210-NO-DATA.
  8187     MOVE ER-2069                TO  EMI-ERROR.
  8188     MOVE -1                     TO  MAINTL.
  8189
  8190     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8191
  8192     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL650.cbl
  8194 5300-FIND-NEXT-ACCOUNT.
  8195     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8196     MOVE 'Y'                    TO  FIRST-TIME-SW.
  8197
  8198     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8199         MOVE PI-COMPANY-CD      TO  PI-ACCT-CO
  8200     ELSE
  8201         PERFORM 6100-BUILD-KEY  THRU  6199-EXIT
  8202         MOVE HIGH-VALUES        TO  PI-ACCT-EXP-DT
  8203         MOVE LOW-VALUES         TO  PI-ACCT-REST-OF-EXP.
  8204
  8205     IF NOT EMI-NO-ERRORS
  8206         GO TO 8200-SEND-DATAONLY.
  8207
  8208
  8209* EXEC CICS  HANDLE CONDITION
  8210*        NOTFND   (5340-END)
  8211*        ENDFILE  (5330-NOT-FOUND)
  8212*    END-EXEC.
  8213*    MOVE '"$I''                  ! 3 #00007360' TO DFHEIV0
  8214     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8216     MOVE X'3320233030303037333630' TO DFHEIV0(25:11)
  8217     CALL 'kxdfhei1' USING DFHEIV0
  8218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8219
  8220
  8221 5305-START-BR.
  8222     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  8223
  8224     SET T-INDEX
  8225        TS-INDEX  TO  +1.
  8226
  8227     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  8228
  8229 5310-READ-NEXT.
  8230     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  8231
  8232     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8233         GO TO 5330-NOT-FOUND.
  8234
  8235     IF PI-CARRIER-SECURITY GREATER SPACES
  8236         IF PI-ACCT-CARRIER  =  PI-CARRIER-SECURITY
  8237             NEXT SENTENCE
  8238         ELSE
  8239             GO TO 5310-READ-NEXT.
  8240
  8241     IF FIRST-TIME
  8242         IF PI-ACCT-CCGSA-KEY  NOT = KEY-SAVE
  8243             MOVE SPACES             TO  FIRST-TIME-SW
  8244             MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE
  8245                                         PI-PREV-VG-ACCOUNT
  8246         ELSE
  8247             GO TO 5310-READ-NEXT.
  8248
  8249     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  8250         IF PI-COMPANY-CD  = PI-ACCT-CO
  8251             GO TO 5320-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL650.cbl
  8252         ELSE
  8253             MOVE ER-0066        TO  EMI-ERROR
  8254             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8255             MOVE -1             TO  MAINTL
  8256             GO TO 8200-SEND-DATAONLY.
  8257
  8258     IF PI-ACCT-CCGSA-KEY  = KEY-SAVE
  8259         GO TO 5320-DISPLAY-RECORD
  8260     ELSE
  8261         MOVE 1                  TO  PI-PAGE-NUMBER
  8262         GO TO 7000-BUILD-OUTPUT-MAP.
  8263
  8264 5320-DISPLAY-RECORD.
  8265     IF T-INDEX  = 1
  8266         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  8267         MOVE SPACE              TO  NAMEFLGO
  8268                                     PI-NAMEFLG.
  8269
  8270     IF AM-TRNTO-DTE  =  SPACES
  8271         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  8272
  8273     IF AM-TRNFROM-DTE  = SPACES
  8274         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  8275
  8276     IF T-INDEX  = 1
  8277         IF PI-COMPANY-ID  = 'LGX'  OR
  8278                             'MIC'  OR  'MCC'
  8279             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  8280             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  8281             MOVE SPACE              TO  DC-OPTION-CODE
  8282             PERFORM 9700-DATE-CONVERSION
  8283             IF DATE-CONVERSION-ERROR
  8284                 MOVE SPACES         TO  TRNTODTO
  8285             ELSE
  8286                 MOVE DC-GREG-DATE-1-EDIT
  8287                                     TO  TRNTODTO.
  8288
  8289     IF T-INDEX  = 1
  8290         IF PI-COMPANY-ID  =  'LGX'  OR
  8291                              'MIC'  OR  'MCC'
  8292             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  8293             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  8294             MOVE SPACE                TO  DC-OPTION-CODE
  8295             PERFORM 9700-DATE-CONVERSION
  8296             IF DATE-CONVERSION-ERROR
  8297                 MOVE SPACES           TO  TRNFRDTO
  8298             ELSE
  8299                 MOVE DC-GREG-DATE-1-EDIT
  8300                                       TO  TRNFRDTO.
  8301
  8302     IF NAMEO  NOT = LOW-VALUES
  8303         IF AM-NAME  NOT = NAMEO
  8304             MOVE '*'            TO  NAMEFLGO
  8305                                     PI-NAMEFLG.
  8306
  8307     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8308
  8309     IF T-INDEX  = 1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL650.cbl
  8310         MOVE AM-NAME                TO  NAMEO
  8311                                         PI-ACCNAME
  8312        ELSE
  8313         MOVE PI-ACCNAME             TO  NAMEO.
  8314
  8315     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  8316
  8317     GO TO 5310-READ-NEXT.
  8318
  8319 5330-NOT-FOUND.
  8320     IF BROWSE-STARTED
  8321         PERFORM 6320-ENDBR  THRU  6320-EXIT
  8322     ELSE
  8323         GO TO 5340-END.
  8324
  8325     IF PI-ACCT-ACCOUNT  = LOW-VALUE
  8326         MOVE ER-0472            TO  EMI-ERROR
  8327         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8328         MOVE -1                 TO  MAINTL
  8329         GO TO 8200-SEND-DATAONLY.
  8330
  8331     IF PI-ACCT-CCGSA-KEY  =  PI-PREV-ACCOUNT
  8332       AND  T-INDEX  NOT = 1
  8333         MOVE 1                  TO  PI-PAGE-NUMBER
  8334         GO TO 7000-BUILD-OUTPUT-MAP
  8335     ELSE
  8336         IF T-INDEX  NOT = 1
  8337             MOVE ER-0066        TO  EMI-ERROR
  8338             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8339             MOVE 1              TO  PI-PAGE-NUMBER
  8340             GO TO 7000-BUILD-OUTPUT-MAP.
  8341
  8342 5340-END.
  8343     MOVE ER-0066                TO  EMI-ERROR.
  8344
  8345     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8346
  8347     MOVE -1                     TO  MAINTL.
  8348
  8349     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL650.cbl
  8351 5400-FIND-PREV-ACCOUNT.
  8352     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8353         GO TO 5430-NOT-FOUND.
  8354
  8355     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8356     MOVE PI-BIN-EXP-DT (1)      TO  PI-ACCT-EXP-DT.
  8357     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  8358
  8359
  8360* EXEC CICS  HANDLE CONDITION
  8361*        NOTFND   (5440-NOT-FOUND)
  8362*        ENDFILE  (5430-NOT-FOUND)
  8363*    END-EXEC.
  8364*    MOVE '"$I''                  ! 4 #00007503' TO DFHEIV0
  8365     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8367     MOVE X'3420233030303037353033' TO DFHEIV0(25:11)
  8368     CALL 'kxdfhei1' USING DFHEIV0
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
  8371
  8372
  8373* EXEC CICS  STARTBR
  8374*        DATASET  (PI-ACCT-ID)
  8375*        RIDFLD   (PI-ACCT-KEY)
  8376*    END-EXEC.
  8377     MOVE 0
  8378       TO DFHEIV11
  8379*    MOVE '&,         G          &   #00007508' TO DFHEIV0
  8380     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8381     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8382     MOVE X'2020233030303037353038' TO DFHEIV0(25:11)
  8383     CALL 'kxdfhei1' USING DFHEIV0,
  8384           PI-ACCT-ID,
  8385           PI-ACCT-KEY,
  8386           DFHEIV99,
  8387           DFHEIV11,
  8388           DFHEIV99
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8390
  8391
  8392     MOVE 'Y'                    TO  BROWSE-STARTED-SW
  8393                                     FIRST-TIME-SW.
  8394 5410-READ-PREV.
  8395
  8396* EXEC CICS  READPREV
  8397*        DATASET  (PI-ACCT-ID)
  8398*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8399*        RIDFLD   (PI-ACCT-KEY)
  8400*    END-EXEC.
  8401     MOVE 0
  8402       TO DFHEIV11
  8403*    MOVE '&0S                   )   #00007516' TO DFHEIV0
  8404     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8405     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8406     MOVE X'2020233030303037353136' TO DFHEIV0(25:11)
  8407     CALL 'kxdfhei1' USING DFHEIV0,
  8408           PI-ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL650.cbl
  8409           DFHEIV20,
  8410           DFHEIV99,
  8411           PI-ACCT-KEY,
  8412           DFHEIV99,
  8413           DFHEIV11,
  8414           DFHEIV99,
  8415           DFHEIV99
  8416     SET ADDRESS OF ACCOUNT-MASTER TO
  8417         DFHEIV20
  8418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8419
  8420
  8421     IF FIRST-TIME
  8422         MOVE SPACE              TO  FIRST-TIME-SW
  8423         GO TO 5410-READ-PREV.
  8424
  8425     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8426         GO TO 5430-NOT-FOUND.
  8427
  8428     IF PI-CARRIER-SECURITY GREATER SPACES
  8429         IF PI-ACCT-CARRIER  = PI-CARRIER-SECURITY
  8430             NEXT SENTENCE
  8431         ELSE
  8432             GO TO 5410-READ-PREV.
  8433
  8434     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8435     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE
  8436                                     PI-PREV-VG-ACCOUNT.
  8437     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  8438                                     PI-ACCT-REST-OF-EXP
  8439                                     PI-DATE-RANGE-TABLE.
  8440
  8441     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  8442
  8443
  8444* EXEC CICS  ENDBR
  8445*        DATASET  (PI-ACCT-ID)
  8446*    END-EXEC.
  8447     MOVE 0
  8448       TO DFHEIV11
  8449*    MOVE '&2                    $   #00007544' TO DFHEIV0
  8450     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8451     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8452     MOVE X'2020233030303037353434' TO DFHEIV0(25:11)
  8453     CALL 'kxdfhei1' USING DFHEIV0,
  8454           PI-ACCT-ID,
  8455           DFHEIV11,
  8456           DFHEIV99
  8457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8458
  8459
  8460     GO TO 5305-START-BR.
  8461
  8462 5430-NOT-FOUND.
  8463     IF BROWSE-STARTED
  8464         MOVE SPACE              TO  BROWSE-STARTED-SW
  8465
  8466* EXEC CICS  ENDBR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL650.cbl
  8467*            DATASET  (PI-ACCT-ID)
  8468*        END-EXEC.
  8469     MOVE 0
  8470       TO DFHEIV11
  8471*    MOVE '&2                    $   #00007553' TO DFHEIV0
  8472     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8473     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8474     MOVE X'2020233030303037353533' TO DFHEIV0(25:11)
  8475     CALL 'kxdfhei1' USING DFHEIV0,
  8476           PI-ACCT-ID,
  8477           DFHEIV11,
  8478           DFHEIV99
  8479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8480
  8481
  8482     MOVE ER-0067                TO  EMI-ERROR.
  8483
  8484     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8485
  8486     MOVE -1                     TO  MAINTL.
  8487
  8488     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8489         GO TO 5300-FIND-NEXT-ACCOUNT.
  8490
  8491     GO TO 8200-SEND-DATAONLY.
  8492
  8493 5440-NOT-FOUND.
  8494     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8495
  8496     PERFORM 6310-READNEXT THRU 6310-EXIT.
  8497
  8498     GO TO 5410-READ-PREV.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL650.cbl
  8500 5500-ADD-NEW-AXRF-RECORD.
  8501     IF NOT PI-GA-BILLING
  8502         GO TO 5599-EXIT.
  8503
  8504     MOVE +1                     TO  AXRF-SUB.
  8505
  8506*    IF MAINTI  = 'K'
  8507*        IF GETMAIN-SW  = 'X'
  8508*            GO TO 5510-BUILD-AXRF-KEY.
  8509
  8510     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8511
  8512*    EXEC CICS  GETMAIN
  8513*        LENGTH   (ERGXRF-REC-LEN)
  8514*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8515*        INITIMG  (GETMAIN-SPACE)
  8516*    END-EXEC.
  8517*    display ' beginning of CP displays  '
  8518*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8519*    display ' address         ==   '
  8520*              address of agent-cross-reference
  8521*    display ' contents        ==   '  agent-cross-reference (1:1)
  8522*    display ' end       of CP displays  '
  8523
  8524*    MOVE 'X'                    TO  GETMAIN-SW.
  8525
  8526 5510-BUILD-AXRF-KEY.
  8527     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8528
  8529     IF AXRF-SUB  =  +11
  8530         GO TO 5599-EXIT.
  8531
  8532     IF AM-AGT (AXRF-SUB)  =  SPACES  OR ZEROS OR LOW-VALUES
  8533         ADD +1 TO AXRF-SUB
  8534         GO TO 5510-BUILD-AXRF-KEY.
  8535
  8536     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O' AND 'P' AND 'S'
  8537         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8538         ADD +1 TO AXRF-SUB
  8539         GO TO 5510-BUILD-AXRF-KEY.
  8540
  8541     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8542
  8543     IF PI-ZERO-CARRIER  OR
  8544        PI-ZERO-CAR-GROUP
  8545         MOVE ZERO               TO  WS-AXRF-CARRIER
  8546     ELSE
  8547         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8548
  8549     IF PI-ZERO-GROUPING  OR
  8550        PI-ZERO-CAR-GROUP
  8551         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8552     ELSE
  8553         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8554
  8555     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8556
  8557
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL650.cbl
  8558* EXEC CICS  HANDLE CONDITION
  8559*        ENDFILE  (5525-SKIP-REWRITE)
  8560*        NOTFND   (5525-SKIP-REWRITE)
  8561*    END-EXEC.
  8562*    MOVE '"$''I                  ! 5 #00007632' TO DFHEIV0
  8563     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8565     MOVE X'3520233030303037363332' TO DFHEIV0(25:11)
  8566     CALL 'kxdfhei1' USING DFHEIV0
  8567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8568
  8569
  8570
  8571* EXEC CICS  READ
  8572*        DATASET  (ERGXRF-FILE-ID)
  8573*        LENGTH   (ERGXRF-REC-LEN)
  8574*        INTO     (AGENT-CROSS-REFERENCE)
  8575*        RIDFLD   (WS-AXRF-KEY)
  8576*        EQUAL
  8577*        UPDATE
  8578*    END-EXEC.
  8579*    MOVE '&"IL       EU         (   #00007637' TO DFHEIV0
  8580     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8581     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8582     MOVE X'2020233030303037363337' TO DFHEIV0(25:11)
  8583     CALL 'kxdfhei1' USING DFHEIV0,
  8584           ERGXRF-FILE-ID,
  8585           AGENT-CROSS-REFERENCE,
  8586           ERGXRF-REC-LEN,
  8587           WS-AXRF-KEY,
  8588           DFHEIV99,
  8589           DFHEIV99,
  8590           DFHEIV99
  8591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8592
  8593
  8594     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8595     MOVE +1                     TO  GX-AGENT-SUB.
  8596
  8597     IF GX-AGENT-POINTER-CNT = +1006
  8598         GO TO 5525-SKIP-REWRITE.
  8599
  8600
  8601 5520-FIND-REC-LOCATION.
  8602     MOVE AM-COMPANY-CD          TO  GX-AM-COMPANY-CD.
  8603     MOVE GX-AGENT-POINTER (GX-AGENT-SUB)
  8604                                 TO  GX-REST-OF-KEY.
  8605     MOVE LOW-VALUES             TO  GX-AM-CNTL-FILLER.
  8606
  8607     IF GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY  OR
  8608        GX-AGENT-SUB          GREATER GX-AGENT-POINTER-CNT
  8609         NEXT SENTENCE
  8610     ELSE
  8611         ADD +1 TO GX-AGENT-SUB
  8612         GO TO 5520-FIND-REC-LOCATION.
  8613
  8614     MOVE GX-AGENT-POINTER-CNT   TO  COMM-WORK-SUB
  8615                                     COMM-WORK-SUB2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL650.cbl
  8616
  8617     ADD +1 TO COMM-WORK-SUB2.
  8618
  8619     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  8620         NEXT SENTENCE
  8621      ELSE
  8622         PERFORM 5530-BUMP-AXRF-REC
  8623             VARYING  COMM-WORK-SUB  FROM  COMM-WORK-SUB  BY  -1
  8624               UNTIL  COMM-WORK-SUB2 = GX-AGENT-SUB.
  8625
  8626     ADD ERGXRF-INC-LEN TO  ERGXRF-REC-LEN.
  8627     ADD  +1 TO  GX-AGENT-POINTER-CNT.
  8628
  8629     MOVE AM-CARRIER        TO  GX-AM-CARRIER   (COMM-WORK-SUB2).
  8630     MOVE AM-GROUPING       TO  GX-AM-GROUPING  (COMM-WORK-SUB2).
  8631     MOVE AM-STATE          TO  GX-AM-STATE     (COMM-WORK-SUB2).
  8632     MOVE AM-ACCOUNT        TO  GX-AM-ACCOUNT   (COMM-WORK-SUB2).
  8633     MOVE AM-EXPIRATION-DT  TO  GX-AM-EXPIRATION-DT
  8634                                                (COMM-WORK-SUB2).
  8635     MOVE AM-EFFECTIVE-DT   TO  GX-AM-EFF-DT    (COMM-WORK-SUB2).
  8636     MOVE AXRF-SUB          TO  GX-AM-LEVEL-NO  (COMM-WORK-SUB2).
  8637     MOVE LOW-VALUES        TO  GX-LAST-BILL-DT (COMM-WORK-SUB2).
  8638     MOVE BIN-CURRENT-SAVE  TO  GX-LAST-MAINT-DT.
  8639     MOVE EIBTIME           TO  GX-LAST-MAINT-HHMMSS.
  8640     MOVE PI-PROCESSOR-ID   TO  GX-LAST-MAINT-USER.
  8641     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  8642     if ergxrf-rec-len > +31264
  8643        move +31264          to ergxrf-rec-len
  8644        move +1006           to gx-agent-pointer-cnt
  8645     end-if
  8646
  8647
  8648* EXEC CICS  REWRITE
  8649*        FROM     (AGENT-CROSS-REFERENCE)
  8650*        LENGTH   (ERGXRF-REC-LEN)
  8651*        DATASET  (ERGXRF-FILE-ID)
  8652*    END-EXEC.
  8653*    MOVE '&& L                  %   #00007699' TO DFHEIV0
  8654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8656     MOVE X'2020233030303037363939' TO DFHEIV0(25:11)
  8657     CALL 'kxdfhei1' USING DFHEIV0,
  8658           ERGXRF-FILE-ID,
  8659           AGENT-CROSS-REFERENCE,
  8660           ERGXRF-REC-LEN,
  8661           DFHEIV99
  8662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8663
  8664
  8665 5525-SKIP-REWRITE.
  8666
  8667     ADD +1 TO AXRF-SUB.
  8668
  8669     GO TO 5510-BUILD-AXRF-KEY.
  8670
  8671 5530-BUMP-AXRF-REC.
  8672     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8673                          TO  GX-AGENT-POINTER (COMM-WORK-SUB2).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL650.cbl
  8674
  8675     SUBTRACT +1  FROM  COMM-WORK-SUB2.
  8676
  8677 5599-EXIT.
  8678     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL650.cbl
  8680 5600-CHG-AXRF-RECORDS.
  8681     IF NOT PI-GA-BILLING
  8682         GO TO 5699-EXIT.
  8683
  8684     MOVE +1                     TO  AXRF-SUB.
  8685     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8686
  8687*    IF GETMAIN-SW  = 'X'
  8688*        GO TO 5610-BUILD-AXRF-KEY.
  8689
  8690*    EXEC CICS  GETMAIN
  8691*        LENGTH   (ERGXRF-REC-LEN)
  8692*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8693*        INITIMG  (GETMAIN-SPACE)
  8694*    END-EXEC.
  8695*
  8696*    display ' beginning of CP displays  '
  8697*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8698*    display ' address         ==   '
  8699*              address of agent-cross-reference
  8700*    display ' contents        ==   '  agent-cross-reference (1:1)
  8701*    display ' end       of CP displays  '
  8702
  8703*    MOVE 'X'                    TO  GETMAIN-SW.
  8704
  8705 5610-BUILD-AXRF-KEY.
  8706     IF AXRF-SUB  = +11
  8707         GO TO 5699-EXIT.
  8708
  8709     IF AM-AGT (AXRF-SUB)  = SPACES OR ZEROS OR LOW-VALUES
  8710         ADD +1 TO AXRF-SUB
  8711         GO TO 5610-BUILD-AXRF-KEY.
  8712
  8713     IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'S'
  8714         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8715         ADD +1 TO AXRF-SUB
  8716         GO TO 5610-BUILD-AXRF-KEY.
  8717
  8718     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8719     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8720
  8721     IF PI-ZERO-CARRIER OR
  8722        PI-ZERO-CAR-GROUP
  8723         MOVE ZERO               TO  WS-AXRF-CARRIER
  8724     ELSE
  8725         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8726
  8727     IF PI-ZERO-GROUPING  OR
  8728        PI-ZERO-CAR-GROUP
  8729         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8730     ELSE
  8731         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8732
  8733     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8734
  8735
  8736* EXEC CICS  HANDLE CONDITION
  8737*        ENDFILE  (5615-SKIP-REWRITE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL650.cbl
  8738*        NOTFND   (5615-SKIP-REWRITE)
  8739*    END-EXEC.
  8740*    MOVE '"$''I                  ! 6 #00007775' TO DFHEIV0
  8741     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8742     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8743     MOVE X'3620233030303037373735' TO DFHEIV0(25:11)
  8744     CALL 'kxdfhei1' USING DFHEIV0
  8745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8746
  8747
  8748
  8749* EXEC CICS  READ
  8750*        DATASET  (ERGXRF-FILE-ID)
  8751*        LENGTH   (ERGXRF-REC-LEN)
  8752*        INTO     (AGENT-CROSS-REFERENCE)
  8753*        RIDFLD   (WS-AXRF-KEY)
  8754*        EQUAL
  8755*        UPDATE
  8756*    END-EXEC.
  8757*    MOVE '&"IL       EU         (   #00007780' TO DFHEIV0
  8758     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8759     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8760     MOVE X'2020233030303037373830' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0,
  8762           ERGXRF-FILE-ID,
  8763           AGENT-CROSS-REFERENCE,
  8764           ERGXRF-REC-LEN,
  8765           WS-AXRF-KEY,
  8766           DFHEIV99,
  8767           DFHEIV99,
  8768           DFHEIV99
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8770
  8771
  8772     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8773
  8774     PERFORM VARYING GX-AGENT-SUB FROM +1 BY +1
  8775             UNTIL
  8776       (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT)
  8777            OR
  8778       (GX-AM-ACCOUNT       (GX-AGENT-SUB) = B4-ACCT-ACCOUNT  AND
  8779        GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = B4-ACCT-EXP-DT   AND
  8780        GX-AM-EFF-DT        (GX-AGENT-SUB) = B4-ACCT-EFF-DT   AND
  8781        GX-AM-CARRIER       (GX-AGENT-SUB) = B4-ACCT-CARRIER  AND
  8782        GX-AM-GROUPING      (GX-AGENT-SUB) = B4-ACCT-GROUPING AND
  8783        GX-AM-STATE         (GX-AGENT-SUB) = B4-ACCT-STATE)
  8784     END-PERFORM.
  8785
  8786     IF MAINTI  = 'D'
  8787        IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8788            MOVE GX-AGENT-SUB    TO  COMM-WORK-SUB
  8789            PERFORM 5630-BUMP-RECORDS
  8790                VARYING  GX-AGENT-SUB  FROM  GX-AGENT-SUB  BY  +1
  8791                  UNTIL  GX-AGENT-SUB  = GX-AGENT-POINTER-CNT
  8792            SUBTRACT ERGXRF-INC-LEN  FROM  ERGXRF-REC-LEN
  8793            SUBTRACT +1              FROM  GX-AGENT-POINTER-CNT
  8794            GO TO 5615-REWRITE-AXRF-RECORD.
  8795
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL650.cbl
  8796     IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8797        MOVE AF-ACCT-EFF-DT  TO GX-AM-EFF-DT        (GX-AGENT-SUB)
  8798        MOVE AF-ACCT-EXP-DT  TO GX-AM-EXPIRATION-DT (GX-AGENT-SUB)
  8799        MOVE AXRF-SUB        TO GX-AM-LEVEL-NO      (GX-AGENT-SUB)
  8800        GO TO 5615-REWRITE-AXRF-RECORD.
  8801
  8802
  8803* EXEC CICS  UNLOCK
  8804*        DATASET  (ERGXRF-FILE-ID)
  8805*    END-EXEC.
  8806*    MOVE '&*                    #   #00007819' TO DFHEIV0
  8807     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8808     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8809     MOVE X'2020233030303037383139' TO DFHEIV0(25:11)
  8810     CALL 'kxdfhei1' USING DFHEIV0,
  8811           ERGXRF-FILE-ID,
  8812           DFHEIV99
  8813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8814
  8815
  8816     GO TO 5615-SKIP-REWRITE.
  8817
  8818 5615-REWRITE-AXRF-RECORD.
  8819     IF MAINTI  = 'D'
  8820       AND  GX-AGENT-POINTER-CNT  =  +0
  8821
  8822* EXEC CICS  DELETE
  8823*            DATASET  (ERGXRF-FILE-ID)
  8824*        END-EXEC
  8825*    MOVE '&(                    &   #00007828' TO DFHEIV0
  8826     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8827     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8828     MOVE X'2020233030303037383238' TO DFHEIV0(25:11)
  8829     CALL 'kxdfhei1' USING DFHEIV0,
  8830           ERGXRF-FILE-ID,
  8831           DFHEIV99,
  8832           DFHEIV99,
  8833           DFHEIV99,
  8834           DFHEIV99
  8835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8836     ELSE
  8837         MOVE BIN-CURRENT-SAVE   TO  GX-LAST-MAINT-DT
  8838         MOVE EIBTIME            TO  GX-LAST-MAINT-HHMMSS
  8839         MOVE PI-PROCESSOR-ID    TO  GX-LAST-MAINT-USER
  8840         compute ergxrf-rec-len =
  8841              (gx-agent-pointer-cnt * +31) + +78
  8842         if ergxrf-rec-len > +31264
  8843            move +31264          to ergxrf-rec-len
  8844            move +1006           to gx-agent-pointer-cnt
  8845         end-if
  8846
  8847* EXEC CICS  REWRITE
  8848*            FROM     (AGENT-CROSS-REFERENCE)
  8849*            LENGTH   (ERGXRF-REC-LEN)
  8850*            DATASET  (ERGXRF-FILE-ID)
  8851*        END-EXEC.
  8852*    MOVE '&& L                  %   #00007841' TO DFHEIV0
  8853     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL650.cbl
  8854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8855     MOVE X'2020233030303037383431' TO DFHEIV0(25:11)
  8856     CALL 'kxdfhei1' USING DFHEIV0,
  8857           ERGXRF-FILE-ID,
  8858           AGENT-CROSS-REFERENCE,
  8859           ERGXRF-REC-LEN,
  8860           DFHEIV99
  8861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8862
  8863
  8864 5615-SKIP-REWRITE.
  8865     ADD +1  TO  AXRF-SUB.
  8866
  8867     GO TO 5610-BUILD-AXRF-KEY.
  8868
  8869 5630-BUMP-RECORDS.
  8870     ADD +1  TO  COMM-WORK-SUB.
  8871
  8872     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8873                            TO  GX-AGENT-POINTER (GX-AGENT-SUB).
  8874
  8875 5699-EXIT.
  8876     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL650.cbl
  8878 6000-EDIT-EFFECTIVE-DATE.
  8879     IF EFFCHGL  NOT =  ZEROS
  8880         MOVE EFFCHGI                  TO  WS-DT-DEEDIT-FIELD
  8881         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8882         MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8883         MOVE '4'                      TO  DC-OPTION-CODE
  8884         PERFORM 9700-DATE-CONVERSION
  8885         IF DATE-CONVERSION-ERROR
  8886             MOVE ER-0348              TO  EMI-ERROR
  8887             MOVE -1                   TO  EFFCHGL
  8888             MOVE AL-UABON             TO  EFFCHGA
  8889             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8890         ELSE
  8891             MOVE DC-GREG-DATE-1-EDIT  TO  EFFCHGI
  8892             MOVE AL-UANON             TO  EFFCHGA
  8893***  Y2K PROJ 7744
  8894             MOVE DC-GREG-DATE-1-YMD   TO  WS-EFFCHG-SAVE
  8895             MOVE DC-ALPHA-CENTURY     TO  WS-EFFCHG-SAVE(4:2)
  8896             MOVE WS-EFFCHG-SAVE       TO  EFFCHG-SAVE
  8897             MOVE DC-BIN-DATE-1        TO  BIN-EFFCHG-SAVE
  8898         END-IF
  8899***  Y2K PROJ 7744
  8900     ELSE
  8901         IF MAINTI  NOT = 'N'
  8902             MOVE ER-0216              TO  EMI-ERROR
  8903             MOVE -1                   TO  EFFCHGL
  8904             MOVE AL-UABON             TO  EFFCHGA
  8905             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8906
  8907 6000-EFF-EXIT.
  8908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL650.cbl
  8910 6000-EDIT-EXPIRATION-DATE.
  8911***  Y2K PROJ 7744
  8912     IF EXPCHGL  NOT = ZEROS
  8913         MOVE EXPCHGI                  TO  WS-DT-DEEDIT-FIELD
  8914         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8915         IF WS-DEEDIT-FIELD-DATE-OUT NOT LESS 999999
  8916             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EXPCHGO
  8917             INSPECT EXPCHGI CONVERTING SPACES TO '/'
  8918             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8919             MOVE 99999999999              TO  EXPCHG-SAVE
  8920         ELSE
  8921             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8922             MOVE '4'                      TO  DC-OPTION-CODE
  8923             PERFORM 9700-DATE-CONVERSION
  8924             IF DATE-CONVERSION-ERROR
  8925                 MOVE ER-0454              TO  EMI-ERROR
  8926                 MOVE -1                   TO  EXPCHGL
  8927                 MOVE AL-UABON             TO  EXPCHGA
  8928                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8929             ELSE
  8930                 MOVE DC-GREG-DATE-1-EDIT  TO  EXPCHGI
  8931                 MOVE AL-UANON             TO  EXPCHGA
  8932                 MOVE DC-GREG-DATE-1-YMD   TO  WS-EXPCHG-SAVE
  8933                 MOVE DC-ALPHA-CENTURY     TO  WS-EXPCHG-SAVE(4:2)
  8934                 MOVE WS-EXPCHG-SAVE       TO  EXPCHG-SAVE
  8935                 MOVE DC-BIN-DATE-1        TO  BIN-EXPCHG-SAVE
  8936             END-IF
  8937         END-IF
  8938     ELSE
  8939         IF MAINTI  NOT =  'N'
  8940             MOVE ER-2058                  TO  EMI-ERROR
  8941             MOVE -1                       TO  EXPCHGL
  8942             MOVE AL-UABON                 TO  EXPCHGA
  8943             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8944         ELSE
  8945             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8946             MOVE 99999999999              TO  EXPCHG-SAVE
  8947         END-IF
  8948     END-IF.
  8949***  Y2K PROJ 7744
  8950
  8951 6000-EXP-EXIT.
  8952     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL650.cbl
  8954 6000-EDIT-LINE.
  8955     IF LINEL  = ZEROS
  8956         GO TO 6000-NO-LINE.
  8957
  8958     MOVE AL-UNNON               TO  LINEA.
  8959
  8960     IF LINEI NOT NUMERIC
  8961         GO TO 6000-LINE-ERROR.
  8962
  8963     IF LINEI LESS 1 OR GREATER 8 OR GREATER PI-TOTAL-LINES
  8964         GO TO 6000-LINE-ERROR.
  8965
  8966     MOVE PI-TOTAL-LINES         TO WS-PAGE-LINES.
  8967
  8968     IF PI-2ND-PAGE
  8969         SUBTRACT 8 FROM WS-PAGE-LINES
  8970     ELSE
  8971     IF PI-3RD-PAGE
  8972         SUBTRACT 16 FROM WS-PAGE-LINES
  8973     ELSE
  8974     IF PI-LST-PAGE
  8975         SUBTRACT 24 FROM WS-PAGE-LINES.
  8976
  8977     IF LINEI GREATER WS-PAGE-LINES
  8978         GO TO 6000-LINE-ERROR.
  8979
  8980     MOVE LINEI                  TO  PI-LINE-SELECTED.
  8981
  8982     GO TO 6000-LIN-EXIT.
  8983
  8984 6000-NO-LINE.
  8985     IF PI-TOTAL-LINES  = 1
  8986         MOVE 1                  TO  PI-LINE-SELECTED
  8987                                     LINEI
  8988         MOVE AL-UNNON           TO  LINEA
  8989         GO TO 6000-LIN-EXIT.
  8990
  8991 6000-LINE-ERROR.
  8992     MOVE ER-2064                TO  EMI-ERROR.
  8993     MOVE -1                     TO  LINEL.
  8994     MOVE AL-UABON               TO  LINEA.
  8995
  8996     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8997
  8998 6000-LIN-EXIT.
  8999     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL650.cbl
  9001 600A-CHECK-HI-LO-DATES.
  9002
  9003     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9004         GO TO 600A-CHECK-AR-DATES.
  9005
  9006     IF BIN-EFFCHG-SAVE GREATER THAN PI-BIN-EFF-DT (T-INDEX)
  9007     IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9008         MOVE ER-2113            TO  EMI-ERROR
  9009         MOVE -1                 TO  MAINTL
  9010         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9011
  9012*    IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9013*        MOVE ER-2113            TO  EMI-ERROR
  9014*        MOVE -1                 TO  MAINTL
  9015*        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9016
  9017 600A-CHECK-AR-DATES.
  9018     IF NOT PI-AR-PROCESSING
  9019         GO TO 600A-EXIT.
  9020
  9021     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  9022        GO TO 600A-EXIT.
  9023
  9024     IF (PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9025         MOVE ER-2113            TO  EMI-ERROR
  9026         MOVE -1                 TO  MAINTL
  9027         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9028
  9029 600A-EXIT.
  9030     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL650.cbl
  9032 6010-DATE-CHECK.
  9033     IF MAINTI  = 'E'
  9034         GO TO 6010-CHECK-EFF.
  9035
  9036     IF PI-BIN-HI-CERT (T-INDEX)  NOT = LOW-VALUES
  9037         IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-HI-CERT (T-INDEX)
  9038             MOVE ER-2072        TO  EMI-ERROR
  9039             MOVE -1             TO  EXPCHGL
  9040             MOVE AL-UABON       TO  EXPCHGA
  9041             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9042
  9043     IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-EFF-DT (T-INDEX)
  9044         MOVE ER-2074            TO  EMI-ERROR
  9045         MOVE -1                 TO  EXPCHGL
  9046         MOVE AL-UABON           TO  EXPCHGA
  9047         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9048
  9049     GO TO 6010-EXIT.
  9050
  9051 6010-CHECK-EFF.
  9052     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES
  9053        IF (BIN-EFFCHG-SAVE >= PI-BIN-LO-CERT (T-INDEX))
  9054           AND (PI-PROCESSOR-ID NOT = 'PEMA')
  9055           MOVE ER-2073          TO EMI-ERROR
  9056           MOVE -1               TO EFFCHGL
  9057           MOVE AL-UABON         TO EFFCHGA
  9058           PERFORM 9900-ERROR-FORMAT
  9059                                 THRU 9900-EXIT
  9060        END-IF
  9061     END-IF
  9062
  9063     IF BIN-EFFCHG-SAVE NOT LESS PI-BIN-EXP-DT (T-INDEX)
  9064         MOVE ER-2075            TO  EMI-ERROR
  9065         MOVE -1                 TO  EFFCHGL
  9066         MOVE AL-UABON           TO  EFFCHGA
  9067         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9068
  9069 6010-EXIT.
  9070     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL650.cbl
  9072 6100-BUILD-KEY.
  9073     MOVE LOW-VALUES             TO  PI-ACCT-KEY.
  9074     MOVE PI-COMPANY-CD          TO  PI-ACCT-CO.
  9075
  9076     IF ACARIERI  =  SPACES  OR  LOW-VALUES
  9077         IF MAINTI  = 'S'
  9078           OR  FIRST-TIME
  9079             MOVE SPACES         TO  PI-ACCT-CARRIER
  9080         ELSE
  9081             MOVE -1             TO  ACARIERL
  9082             MOVE ER-2059        TO  EMI-ERROR
  9083             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9084     ELSE
  9085         MOVE AL-UANON           TO  ACARIERA
  9086         MOVE ACARIERI           TO  PI-ACCT-CARRIER.
  9087
  9088     IF AGROUPI  =  SPACES  OR  LOW-VALUES
  9089         IF MAINTI  = 'S'
  9090           OR  FIRST-TIME
  9091             MOVE SPACES         TO  PI-ACCT-GROUPING
  9092         ELSE
  9093             MOVE -1             TO  AGROUPL
  9094             MOVE ER-2059        TO  EMI-ERROR
  9095             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9096     ELSE
  9097         IF AGROUPI  =  '0     '
  9098             MOVE -1             TO  AGROUPL
  9099             MOVE ER-0195        TO  EMI-ERROR
  9100             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9101         ELSE
  9102             MOVE AL-UANON       TO  AGROUPA
  9103             MOVE AGROUPI        TO  PI-ACCT-GROUPING.
  9104
  9105     IF ASTATEI  = SPACES  OR  LOW-VALUES
  9106         IF MAINTI  =  'S'
  9107           OR  FIRST-TIME
  9108             MOVE SPACES         TO  PI-ACCT-STATE
  9109         ELSE
  9110             MOVE -1             TO  ASTATEL
  9111             MOVE ER-2059        TO  EMI-ERROR
  9112             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9113     ELSE
  9114         MOVE AL-UANON           TO  ASTATEA
  9115         MOVE ASTATEI            TO  PI-ACCT-STATE.
  9116
  9117     IF AACCTI  = SPACES  OR  LOW-VALUES
  9118        IF MAINTI  = 'S'
  9119          OR  FIRST-TIME
  9120            MOVE SPACES          TO  PI-ACCT-ACCOUNT
  9121        ELSE
  9122            MOVE -1              TO  AACCTL
  9123            MOVE ER-2059         TO  EMI-ERROR
  9124            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9125     ELSE
  9126         MOVE AL-UANON           TO  AACCTA
  9127         MOVE AACCTI             TO  PI-ACCT-ACCOUNT.
  9128
  9129     IF PI-ACCT-CARRIER  = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL650.cbl
  9130       AND  (CARR-ACCNT-CNTL
  9131       OR   CARR-ST-ACCNT-CNTL
  9132       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9133         MOVE ER-0193            TO  EMI-ERROR
  9134         MOVE -1                 TO  ACARIERL
  9135         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9136
  9137     IF PI-ACCT-GROUPING  =  SPACES
  9138       AND  CARR-GROUP-ST-ACCNT-CNTL
  9139         MOVE ER-0195            TO  EMI-ERROR
  9140         MOVE -1                 TO  AGROUPL
  9141         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9142
  9143     IF PI-ACCT-STATE  = SPACES
  9144       AND  (ST-ACCNT-CNTL
  9145       OR   CARR-ST-ACCNT-CNTL
  9146       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9147         MOVE ER-0144            TO  EMI-ERROR
  9148         MOVE -1                 TO  ASTATEL
  9149         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9150
  9151     IF MAINTI  =  'S'
  9152       OR  FIRST-TIME
  9153         NEXT SENTENCE
  9154     ELSE
  9155         MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE.
  9156
  9157     IF NOT EMI-NO-ERRORS
  9158         IF EIBTRNID = EL6311-TRANS-ID
  9159             GO TO 8100-SEND-INITIAL-MAP
  9160           ELSE
  9161             GO TO 8200-SEND-DATAONLY.
  9162
  9163     IF PI-ACCT-CARRIER   = SPACES  OR
  9164        PI-ACCT-STATE     = SPACES  OR
  9165        PI-ACCT-GROUPING  = SPACES
  9166         MOVE ACCT2-FILE-ID      TO  PI-ACCT-ID
  9167     ELSE
  9168         MOVE ACCT-FILE-ID       TO  PI-ACCT-ID.
  9169
  9170     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  9171                                     PI-ACCT-REST-OF-EXP.
  9172
  9173 6199-EXIT.
  9174     EXIT.
  9175
  9176 6200-CHECK-KEY.
  9177     IF PI-PREV-ACCOUNT  NOT = PI-ACCT-CCGSA-KEY
  9178         MOVE ER-0453            TO  EMI-ERROR
  9179         MOVE -1                 TO  MAINTL
  9180         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9181
  9182 6200-EXIT.
  9183     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL650.cbl
  9185 6300-STARTBR.
  9186     MOVE ACCT-FILE-ID           TO  PI-ACCT-ID.
  9187
  9188
  9189* EXEC CICS  STARTBR
  9190*        DATASET  (PI-ACCT-ID)
  9191*        RIDFLD   (PI-ACCT-KEY)
  9192*    END-EXEC.
  9193     MOVE 0
  9194       TO DFHEIV11
  9195*    MOVE '&,         G          &   #00008171' TO DFHEIV0
  9196     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9197     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9198     MOVE X'2020233030303038313731' TO DFHEIV0(25:11)
  9199     CALL 'kxdfhei1' USING DFHEIV0,
  9200           PI-ACCT-ID,
  9201           PI-ACCT-KEY,
  9202           DFHEIV99,
  9203           DFHEIV11,
  9204           DFHEIV99
  9205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9206
  9207
  9208     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  9209     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  9210
  9211 6300-EXIT.
  9212     EXIT.
  9213
  9214 6310-READNEXT.
  9215
  9216* EXEC CICS  READNEXT
  9217*        DATASET  (PI-ACCT-ID)
  9218*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9219*        RIDFLD   (PI-ACCT-KEY)
  9220*    END-EXEC.
  9221     MOVE 0
  9222       TO DFHEIV11
  9223*    MOVE '&.S                   )   #00008183' TO DFHEIV0
  9224     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9225     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9226     MOVE X'2020233030303038313833' TO DFHEIV0(25:11)
  9227     CALL 'kxdfhei1' USING DFHEIV0,
  9228           PI-ACCT-ID,
  9229           DFHEIV20,
  9230           DFHEIV99,
  9231           PI-ACCT-KEY,
  9232           DFHEIV99,
  9233           DFHEIV11,
  9234           DFHEIV99,
  9235           DFHEIV99
  9236     SET ADDRESS OF ACCOUNT-MASTER TO
  9237         DFHEIV20
  9238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9239
  9240
  9241 6310-EXIT.
  9242     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL650.cbl
  9243
  9244 6320-ENDBR.
  9245     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  9246
  9247
  9248* EXEC CICS  ENDBR
  9249*        DATASET  (PI-ACCT-ID)
  9250*    END-EXEC.
  9251     MOVE 0
  9252       TO DFHEIV11
  9253*    MOVE '&2                    $   #00008195' TO DFHEIV0
  9254     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9255     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9256     MOVE X'2020233030303038313935' TO DFHEIV0(25:11)
  9257     CALL 'kxdfhei1' USING DFHEIV0,
  9258           PI-ACCT-ID,
  9259           DFHEIV11,
  9260           DFHEIV99
  9261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9262
  9263
  9264 6320-EXIT.
  9265     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL650.cbl
  9267 6400-BUILD-VG-KEY.
  9268     MOVE AM-CONTROL-PRIMARY     TO  AM-CONTROL-BY-VAR-GRP.
  9269
  9270     IF ST-ACCNT-CNTL
  9271         MOVE SPACES             TO  AM-VG-CARRIER
  9272                                     AM-VG-GROUPING.
  9273
  9274     IF CARR-ST-ACCNT-CNTL
  9275         MOVE SPACES             TO  AM-VG-GROUPING.
  9276
  9277     IF ACCNT-CNTL
  9278         MOVE SPACES             TO  AM-VG-CARRIER
  9279                                     AM-VG-STATE
  9280                                     AM-VG-GROUPING.
  9281
  9282     IF CARR-ACCNT-CNTL
  9283         MOVE SPACES             TO  AM-VG-STATE
  9284                                     AM-VG-GROUPING.
  9285
  9286 6499-EXIT.
  9287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL650.cbl
  9289 6500-READ-ACCT.
  9290
  9291* EXEC CICS  HANDLE CONDITION
  9292*        NOTFND  (6599-EXIT)
  9293*    END-EXEC.
  9294*    MOVE '"$I                   ! 7 #00008225' TO DFHEIV0
  9295     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9297     MOVE X'3720233030303038323235' TO DFHEIV0(25:11)
  9298     CALL 'kxdfhei1' USING DFHEIV0
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9300
  9301
  9302     MOVE ZERO                   TO  REC-SW.
  9303
  9304
  9305* EXEC CICS  READ
  9306*        GTEQ
  9307*        DATASET  (ACCT-FILE-ID)
  9308*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9309*        RIDFLD   (PI-ACCT-KEY)
  9310*    END-EXEC.
  9311*    MOVE '&"S        G          (   #00008231' TO DFHEIV0
  9312     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9314     MOVE X'2020233030303038323331' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0,
  9316           ACCT-FILE-ID,
  9317           DFHEIV20,
  9318           DFHEIV99,
  9319           PI-ACCT-KEY,
  9320           DFHEIV99,
  9321           DFHEIV99,
  9322           DFHEIV99
  9323     SET ADDRESS OF ACCOUNT-MASTER TO
  9324         DFHEIV20
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9326
  9327
  9328     MOVE AM-CONTROL-PRIMARY     TO  PI-ACCT-KEY.
  9329     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  9330
  9331     IF PI-ACCT-CCGSA-KEY  = NEW-KEY-SAVE
  9332         MOVE 1                  TO  REC-SW.
  9333
  9334 6599-EXIT.
  9335     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL650.cbl
  9337 6600-UPDATE-MAINT-DT.
  9338     MOVE SPACES                 TO  ELCNTL-KEY.
  9339     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9340     MOVE '1'                    TO  CNTL-REC-TYPE.
  9341     MOVE +0                     TO  CNTL-SEQ-NO.
  9342
  9343
  9344* EXEC CICS  HANDLE CONDITION
  9345*        NOTFND  (6699-EXIT)
  9346*    END-EXEC.
  9347*    MOVE '"$I                   ! 8 #00008253' TO DFHEIV0
  9348     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9350     MOVE X'3820233030303038323533' TO DFHEIV0(25:11)
  9351     CALL 'kxdfhei1' USING DFHEIV0
  9352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9353
  9354
  9355
  9356* EXEC CICS  READ
  9357*        UPDATE
  9358*        DATASET  (CNTL-FILE-ID)
  9359*        SET      (ADDRESS OF CONTROL-FILE)
  9360*        RIDFLD   (ELCNTL-KEY)
  9361*    END-EXEC.
  9362*    MOVE '&"S        EU         (   #00008257' TO DFHEIV0
  9363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9364     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9365     MOVE X'2020233030303038323537' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0,
  9367           CNTL-FILE-ID,
  9368           DFHEIV20,
  9369           DFHEIV99,
  9370           ELCNTL-KEY,
  9371           DFHEIV99,
  9372           DFHEIV99,
  9373           DFHEIV99
  9374     SET ADDRESS OF CONTROL-FILE TO
  9375         DFHEIV20
  9376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9377
  9378
  9379     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9380     MOVE 'B'                    TO  JP-RECORD-TYPE.
  9381     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9382
  9383     PERFORM 8400-LOG-JOURNAL-RECORD.
  9384
  9385     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  9386     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9387     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9388     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9389
  9390
  9391* EXEC CICS  REWRITE
  9392*        DATASET  (CNTL-FILE-ID)
  9393*        FROM     (CONTROL-FILE)
  9394*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL650.cbl
  9395     MOVE LENGTH OF
  9396      CONTROL-FILE
  9397       TO DFHEIV11
  9398*    MOVE '&& L                  %   #00008275' TO DFHEIV0
  9399     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9400     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9401     MOVE X'2020233030303038323735' TO DFHEIV0(25:11)
  9402     CALL 'kxdfhei1' USING DFHEIV0,
  9403           CNTL-FILE-ID,
  9404           CONTROL-FILE,
  9405           DFHEIV11,
  9406           DFHEIV99
  9407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9408
  9409
  9410     PERFORM 8400-LOG-JOURNAL-RECORD.
  9411
  9412 6699-EXIT.
  9413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL650.cbl
  9415 6700-VERIFY-STATE-CARRIER.
  9416     IF PI-ACCT-CARRIER  = SPACES
  9417         GO TO 6750-CHECK-STATE.
  9418
  9419     MOVE SPACES                 TO  ELCNTL-KEY.
  9420     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9421     MOVE '6'                    TO  CNTL-REC-TYPE.
  9422     MOVE PI-ACCT-CARRIER        TO  CNTL-CARRIER
  9423     MOVE +0                     TO  CNTL-SEQ-NO.
  9424
  9425
  9426* EXEC CICS  HANDLE CONDITION
  9427*        NOTFND  (6720-NO-CARRIER)
  9428*    END-EXEC.
  9429*    MOVE '"$I                   ! 9 #00008295' TO DFHEIV0
  9430     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9432     MOVE X'3920233030303038323935' TO DFHEIV0(25:11)
  9433     CALL 'kxdfhei1' USING DFHEIV0
  9434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9435
  9436
  9437
  9438* EXEC CICS  READ
  9439*        DATASET  (CNTL-FILE-ID)
  9440*        SET      (ADDRESS OF CONTROL-FILE)
  9441*        RIDFLD   (ELCNTL-KEY)
  9442*    END-EXEC.
  9443*    MOVE '&"S        E          (   #00008299' TO DFHEIV0
  9444     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9445     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9446     MOVE X'2020233030303038323939' TO DFHEIV0(25:11)
  9447     CALL 'kxdfhei1' USING DFHEIV0,
  9448           CNTL-FILE-ID,
  9449           DFHEIV20,
  9450           DFHEIV99,
  9451           ELCNTL-KEY,
  9452           DFHEIV99,
  9453           DFHEIV99,
  9454           DFHEIV99
  9455     SET ADDRESS OF CONTROL-FILE TO
  9456         DFHEIV20
  9457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9458
  9459
  9460     GO TO 6750-CHECK-STATE.
  9461
  9462 6720-NO-CARRIER.
  9463     MOVE ER-0193                TO  EMI-ERROR.
  9464     MOVE -1                     TO  ACARIERL.
  9465     MOVE AL-UABON               TO  ACARIERA.
  9466
  9467     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9468
  9469 6750-CHECK-STATE.
  9470     IF PI-ACCT-STATE  =  SPACES
  9471         GO TO 6799-EXIT.
  9472
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL650.cbl
  9473     MOVE SPACES                 TO  ELCNTL-KEY.
  9474     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9475     MOVE '3'                    TO  CNTL-REC-TYPE.
  9476     MOVE PI-ACCT-STATE          TO  CNTL-STATE.
  9477     MOVE +0                     TO  CNTL-SEQ-NO.
  9478
  9479
  9480* EXEC CICS  HANDLE CONDITION
  9481*        NOTFND  (6780-NO-STATE)
  9482*    END-EXEC.
  9483*    MOVE '"$I                   ! : #00008324' TO DFHEIV0
  9484     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9485     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9486     MOVE X'3A20233030303038333234' TO DFHEIV0(25:11)
  9487     CALL 'kxdfhei1' USING DFHEIV0
  9488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9489
  9490
  9491
  9492* EXEC CICS  READ
  9493*        DATASET  (CNTL-FILE-ID)
  9494*        SET      (ADDRESS OF CONTROL-FILE)
  9495*        RIDFLD   (ELCNTL-KEY)
  9496*    END-EXEC.
  9497*    MOVE '&"S        E          (   #00008328' TO DFHEIV0
  9498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9500     MOVE X'2020233030303038333238' TO DFHEIV0(25:11)
  9501     CALL 'kxdfhei1' USING DFHEIV0,
  9502           CNTL-FILE-ID,
  9503           DFHEIV20,
  9504           DFHEIV99,
  9505           ELCNTL-KEY,
  9506           DFHEIV99,
  9507           DFHEIV99,
  9508           DFHEIV99
  9509     SET ADDRESS OF CONTROL-FILE TO
  9510         DFHEIV20
  9511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9512
  9513
  9514     GO TO 6799-EXIT.
  9515
  9516 6780-NO-STATE.
  9517     MOVE ER-0144                TO  EMI-ERROR.
  9518     MOVE -1                     TO  ASTATEL.
  9519     MOVE AL-UABON               TO  ASTATEA.
  9520
  9521     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9522
  9523 6799-EXIT.
  9524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL650.cbl
  9526 6800-COMPANY-REC-READ.
  9527     MOVE SPACES                 TO  ELCNTL-KEY.
  9528     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9529     MOVE '1'                    TO  CNTL-REC-TYPE.
  9530     MOVE +0                     TO  CNTL-SEQ-NO.
  9531
  9532
  9533* EXEC CICS  HANDLE CONDITION
  9534*        NOTFND  (6880-NO-COMP)
  9535*    END-EXEC.
  9536*    MOVE '"$I                   ! ; #00008352' TO DFHEIV0
  9537     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9539     MOVE X'3B20233030303038333532' TO DFHEIV0(25:11)
  9540     CALL 'kxdfhei1' USING DFHEIV0
  9541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9542
  9543
  9544
  9545* EXEC CICS  READ
  9546*        DATASET  (CNTL-FILE-ID)
  9547*        SET      (ADDRESS OF CONTROL-FILE)
  9548*        RIDFLD   (ELCNTL-KEY)
  9549*    END-EXEC.
  9550*    MOVE '&"S        E          (   #00008356' TO DFHEIV0
  9551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9553     MOVE X'2020233030303038333536' TO DFHEIV0(25:11)
  9554     CALL 'kxdfhei1' USING DFHEIV0,
  9555           CNTL-FILE-ID,
  9556           DFHEIV20,
  9557           DFHEIV99,
  9558           ELCNTL-KEY,
  9559           DFHEIV99,
  9560           DFHEIV99,
  9561           DFHEIV99
  9562     SET ADDRESS OF CONTROL-FILE TO
  9563         DFHEIV20
  9564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9565
  9566
  9567     IF CF-ACCOUNT-MSTR-MAINT-DT  = LOW-VALUES
  9568         MOVE ER-2572            TO  EMI-ERROR
  9569         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9570
  9571     GO TO 6899-EXIT.
  9572
  9573 6880-NO-COMP.
  9574     MOVE ER-0022                TO  EMI-ERROR.
  9575
  9576     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9577
  9578 6899-EXIT.
  9579     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL650.cbl
  9581 7000-BUILD-OUTPUT-MAP.
  9582     IF RETURNING-FROM-6501
  9583         MOVE PI-PREV-VG-ACCOUNT  TO  KEY-SAVE.
  9584
  9585     IF PI-COMPANY-ID  = 'LGX'  OR  'MIC'  OR  'MCC'
  9586         MOVE AL-SANOF           TO  TRNMSG1A
  9587                                     TRNMSG2A
  9588                                     TRNMSG3A
  9589                                     TRNMSG4A.
  9590
  9591     MOVE AL-UANON               TO  ACARIERA
  9592                                     AGROUPA
  9593                                     ASTATEA
  9594                                     AACCTA.
  9595     MOVE SV-CARRIER             TO  ACARIERO.
  9596     MOVE SV-GROUPING            TO  AGROUPO.
  9597     MOVE SV-STATE               TO  ASTATEO.
  9598     MOVE SV-ACCOUNT             TO  AACCTO.
  9599
  9600     SET M-INDEX  TO  1.
  9601
  9602     MOVE LOW-VALUES             TO  MAP-RECORD-AREA.
  9603
  9604     IF PI-MAINT  = 'A'
  9605       AND  PI-RECORD-NOT-CREATED
  9606         MOVE ER-2151            TO  EMI-ERROR
  9607         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9608         GO TO 7000-END.
  9609
  9610     IF PI-FST-PAGE
  9611         SET T-INDEX   TO  1
  9612     ELSE
  9613     IF PI-2ND-PAGE
  9614         SET T-INDEX   TO  9
  9615     ELSE
  9616     IF PI-3RD-PAGE
  9617         SET T-INDEX   TO  17
  9618     ELSE
  9619         SET T-INDEX   TO  25.
  9620
  9621 7000-LOOP.
  9622     IF PI-BIN-EXP-DT (T-INDEX)  NOT = HIGH-VALUES
  9623         MOVE PI-BIN-EXP-DT (T-INDEX)
  9624                                 TO  DC-BIN-DATE-1
  9625         MOVE SPACE              TO  DC-OPTION-CODE
  9626         PERFORM 9700-DATE-CONVERSION
  9627         IF DATE-CONVERSION-ERROR
  9628             MOVE SPACES         TO  MAP-EXP-DT (M-INDEX)
  9629         ELSE
  9630             MOVE DC-GREG-DATE-1-EDIT
  9631                                 TO  MAP-EXP-DT (M-INDEX)
  9632     ELSE
  9633         MOVE 999999             TO  MAP-EXP-DT-ED (M-INDEX)
  9634         INSPECT MAP-EXP-DT-ED (M-INDEX) CONVERTING SPACES TO '/'.
  9635
  9636     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  DC-BIN-DATE-1.
  9637     MOVE SPACE                    TO  DC-OPTION-CODE.
  9638
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL650.cbl
  9639     PERFORM 9700-DATE-CONVERSION.
  9640
  9641     IF DATE-CONVERSION-ERROR
  9642         MOVE SPACES               TO  MAP-EFF-DT (M-INDEX)
  9643     ELSE
  9644         MOVE DC-GREG-DATE-1-EDIT  TO  MAP-EFF-DT (M-INDEX).
  9645
  9646     IF PI-BIN-MAINT-DT (T-INDEX)  = LOW-VALUES
  9647         MOVE SPACES             TO  MAP-LST-MAINT-DT (M-INDEX)
  9648     ELSE
  9649         MOVE PI-BIN-MAINT-DT (T-INDEX)
  9650                                 TO  DC-BIN-DATE-1
  9651         MOVE SPACE              TO  DC-OPTION-CODE
  9652         PERFORM 9700-DATE-CONVERSION
  9653         IF DATE-CONVERSION-ERROR
  9654             MOVE SPACES         TO  MAP-LST-MAINT-DT (M-INDEX)
  9655         ELSE
  9656             MOVE DC-GREG-DATE-1-EDIT
  9657                                 TO  MAP-LST-MAINT-DT (M-INDEX).
  9658
  9659     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9660         MOVE SPACES             TO  MAP-HIGH-CERT (M-INDEX)
  9661     ELSE
  9662         MOVE PI-BIN-HI-CERT (T-INDEX)
  9663                                 TO  DC-BIN-DATE-1
  9664         MOVE SPACE              TO  DC-OPTION-CODE
  9665         PERFORM 9700-DATE-CONVERSION
  9666         IF DATE-CONVERSION-ERROR
  9667             MOVE SPACES         TO  MAP-HIGH-CERT (M-INDEX)
  9668         ELSE
  9669             MOVE DC-GREG-DATE-1-EDIT
  9670                                 TO  MAP-HIGH-CERT (M-INDEX).
  9671
  9672     IF PI-BIN-LO-CERT (T-INDEX)  = LOW-VALUES
  9673         MOVE SPACES             TO  MAP-LOW-CERT (M-INDEX)
  9674     ELSE
  9675         MOVE PI-BIN-LO-CERT (T-INDEX)
  9676                                 TO  DC-BIN-DATE-1
  9677         MOVE SPACE              TO  DC-OPTION-CODE
  9678         PERFORM 9700-DATE-CONVERSION
  9679         IF DATE-CONVERSION-ERROR
  9680             MOVE SPACES         TO  MAP-LOW-CERT (M-INDEX)
  9681         ELSE
  9682             MOVE DC-GREG-DATE-1-EDIT
  9683                                 TO  MAP-LOW-CERT (M-INDEX).
  9684
  9685     IF PI-BIN-AR-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  9686         MOVE SPACES             TO  MAP-AR-DATE (M-INDEX)
  9687     ELSE
  9688         MOVE PI-BIN-AR-HI-CERT (T-INDEX)
  9689                                 TO  DC-BIN-DATE-1
  9690         MOVE SPACE              TO  DC-OPTION-CODE
  9691         PERFORM 9700-DATE-CONVERSION
  9692         IF DATE-CONVERSION-ERROR
  9693             MOVE SPACES         TO  MAP-AR-DATE (M-INDEX)
  9694         ELSE
  9695             MOVE DC-GREG-DATE-1-EDIT
  9696                                 TO  MAP-AR-DATE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL650.cbl
  9697
  9698     IF M-INDEX  =  8  OR
  9699        T-INDEX  =  PI-TOTAL-LINES
  9700         NEXT SENTENCE
  9701     ELSE
  9702         SET M-INDEX
  9703             T-INDEX  UP  BY  1
  9704         GO TO 7000-LOOP.
  9705
  9706     IF M-INDEX  =  8
  9707       AND  T-INDEX  LESS THAN  PI-TOTAL-LINES
  9708         MOVE ER-0668            TO  EMI-ERROR
  9709         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9710
  9711     IF T-INDEX  =  PI-TOTAL-LINES
  9712         MOVE ER-0630            TO  EMI-ERROR
  9713         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9714
  9715 7000-END.
  9716     MOVE -1                     TO  MAINTL.
  9717     MOVE MAINTI                 TO  PI-MAINT.
  9718
  9719     IF MAINTI  = 'S'  OR  'D'
  9720       OR  RETURNING-FROM-6501
  9721         MOVE LOW-VALUES         TO  MAINTI
  9722         MOVE PI-ACCNAME         TO  NAMEO
  9723         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9724         GO TO 8100-SEND-INITIAL-MAP.
  9725
  9726     IF EIBAID  =  DFHPF1  OR  DFHPF2  OR
  9727                   DFHPF3  OR  DFHPF4
  9728         MOVE 'S'                TO  PI-MAINT
  9729         MOVE PI-ACCNAME         TO  NAMEO
  9730         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9731         GO TO 8100-SEND-INITIAL-MAP.
  9732
  9733     IF MAINTI  = 'N' OR 'E' OR 'X'
  9734        MOVE SPACES                 TO  BIN-EXPCHG-SAVE
  9735                                        BIN-EFFCHG-SAVE
  9736        MOVE SPACES                 TO  EFFCHGI
  9737                                        EXPCHGI
  9738        MOVE AL-UANOF               TO  EFFCHGA
  9739                                        EXPCHGA
  9740        MOVE SPACES                 TO  PI-MAINT
  9741        MOVE SPACES                 TO  MAINTI
  9742                                        MAINTO
  9743        MOVE AL-UANOF               TO  MAINTA.
  9744
  9745     IF K-WITH-LINE-NO
  9746         MOVE ZERO         TO K-WITH-LINE-USED
  9747         GO TO 8100-SEND-INITIAL-MAP.
  9748
  9749     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL650.cbl
  9751 7100-START-BROWSE.
  9752
  9753* EXEC CICS  STARTBR
  9754*        DATASET  (PI-ACCT-ID)
  9755*        RIDFLD   (PI-ACCT-KEY)
  9756*    END-EXEC.
  9757     MOVE 0
  9758       TO DFHEIV11
  9759*    MOVE '&,         G          &   #00008547' TO DFHEIV0
  9760     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9761     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9762     MOVE X'2020233030303038353437' TO DFHEIV0(25:11)
  9763     CALL 'kxdfhei1' USING DFHEIV0,
  9764           PI-ACCT-ID,
  9765           PI-ACCT-KEY,
  9766           DFHEIV99,
  9767           DFHEIV11,
  9768           DFHEIV99
  9769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9770
  9771
  9772 7100-EXIT.
  9773     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL650.cbl
  9775 7200-WRITE-TEMP-STORAGE.
  9776     PERFORM 7300-DELETE-TEMP-STORAGE  THRU  7300-EXIT.
  9777
  9778
  9779* EXEC CICS  HANDLE CONDITION
  9780*        ITEMERR  (7200-EXIT)
  9781*        QIDERR   (7200-EXIT)
  9782*    END-EXEC.
  9783*    MOVE '"$<N                  ! < #00008558' TO DFHEIV0
  9784     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9786     MOVE X'3C20233030303038353538' TO DFHEIV0(25:11)
  9787     CALL 'kxdfhei1' USING DFHEIV0
  9788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9789
  9790
  9791     MOVE +0                     TO  TS-ITEM.
  9792
  9793
  9794* EXEC CICS  WRITEQ TS
  9795*        QUEUE   (TS-QUEUE)
  9796*        FROM    (TEMP-STORAGE-RECORD)
  9797*        LENGTH  (TS-LENGTH)
  9798*        ITEM    (TS-ITEM)
  9799*    END-EXEC.
  9800*    MOVE '*" I                  ''   #00008565' TO DFHEIV0
  9801     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  9802     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9803     MOVE X'2020233030303038353635' TO DFHEIV0(25:11)
  9804     CALL 'kxdfhei1' USING DFHEIV0,
  9805           TS-QUEUE,
  9806           TEMP-STORAGE-RECORD,
  9807           TS-LENGTH,
  9808           TS-ITEM,
  9809           DFHEIV99,
  9810           DFHEIV99
  9811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9812
  9813
  9814 7200-EXIT.
  9815     EXIT.
  9816
  9817 7300-DELETE-TEMP-STORAGE.
  9818
  9819* EXEC CICS  HANDLE CONDITION
  9820*        ITEMERR  (7300-EXIT)
  9821*        QIDERR   (7300-EXIT)
  9822*    END-EXEC.
  9823*    MOVE '"$<N                  ! = #00008576' TO DFHEIV0
  9824     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9826     MOVE X'3D20233030303038353736' TO DFHEIV0(25:11)
  9827     CALL 'kxdfhei1' USING DFHEIV0
  9828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9829
  9830
  9831
  9832* EXEC CICS  DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL650.cbl
  9833*        QUEUE  (TS-QUEUE)
  9834*    END-EXEC.
  9835*    MOVE '*&                    #   #00008581' TO DFHEIV0
  9836     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9837     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9838     MOVE X'2020233030303038353831' TO DFHEIV0(25:11)
  9839     CALL 'kxdfhei1' USING DFHEIV0,
  9840           TS-QUEUE,
  9841           DFHEIV99
  9842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9843
  9844
  9845 7300-EXIT.
  9846     EXIT.
  9847
  9848 7400-READ-TEMP-STORAGE.
  9849
  9850* EXEC CICS  HANDLE CONDITION
  9851*        ITEMERR  (7400-EXIT)
  9852*        QIDERR   (7400-EXIT)
  9853*    END-EXEC.
  9854*    MOVE '"$<N                  ! > #00008589' TO DFHEIV0
  9855     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9857     MOVE X'3E20233030303038353839' TO DFHEIV0(25:11)
  9858     CALL 'kxdfhei1' USING DFHEIV0
  9859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9860
  9861
  9862     MOVE +1                     TO  TS-ITEM.
  9863
  9864
  9865* EXEC CICS  READQ TS
  9866*        QUEUE   (TS-QUEUE)
  9867*        INTO    (TEMP-STORAGE-RECORD)
  9868*        LENGTH  (TS-LENGTH)
  9869*        ITEM    (TS-ITEM)
  9870*    END-EXEC.
  9871*    MOVE '*$II   L              ''   #00008596' TO DFHEIV0
  9872     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9874     MOVE X'2020233030303038353936' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0,
  9876           TS-QUEUE,
  9877           TEMP-STORAGE-RECORD,
  9878           TS-LENGTH,
  9879           TS-ITEM,
  9880           DFHEIV99,
  9881           DFHEIV99
  9882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9883
  9884
  9885 7400-EXIT.
  9886     EXIT.
  9887
  9888 8100-SEND-INITIAL-MAP.
  9889     MOVE SAVE-DATE              TO  DATEO.
  9890     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL650.cbl
  9891     MOVE TIME-OUT               TO  TIMEO.
  9892     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9893     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9894     MOVE -1                     TO  MAINTL.
  9895     MOVE AL-UABON               TO  MAINTA.
  9896     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9897     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9898
  9899     IF PI-AR-PROCESSING
  9900        MOVE AL-PANOF            TO  ARHDGA.
  9901
  9902
  9903* EXEC CICS  SEND
  9904*        MAP     (MAP-NAME)
  9905*        MAPSET  (MAPSET-NAME)
  9906*        FROM    (EL650AO)
  9907*        ERASE
  9908*        CURSOR
  9909*    END-EXEC.
  9910     MOVE LENGTH OF
  9911      EL650AO
  9912       TO DFHEIV12
  9913     MOVE -1
  9914       TO DFHEIV11
  9915*    MOVE '8$     CT  E    H L F ,   #00008620' TO DFHEIV0
  9916     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9917     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9918     MOVE X'2020233030303038363230' TO DFHEIV0(25:11)
  9919     CALL 'kxdfhei1' USING DFHEIV0,
  9920           MAP-NAME,
  9921           EL650AO,
  9922           DFHEIV12,
  9923           MAPSET-NAME,
  9924           DFHEIV99,
  9925           DFHEIV99,
  9926           DFHEIV99,
  9927           DFHEIV11,
  9928           DFHEIV99,
  9929           DFHEIV99,
  9930           DFHEIV99
  9931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9932
  9933
  9934     GO TO 9100-RETURN-TRAN.
  9935
  9936 8200-SEND-DATAONLY.
  9937     MOVE SAVE-DATE              TO  DATEO.
  9938     MOVE EIBTIME                TO  TIME-IN.
  9939     MOVE TIME-OUT               TO  TIMEO.
  9940     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9941     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9942     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9943     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9944
  9945
  9946* EXEC CICS  SEND
  9947*        MAP     (MAP-NAME)
  9948*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL650.cbl
  9949*        FROM    (EL650AO)
  9950*        DATAONLY
  9951*        CURSOR
  9952*    END-EXEC.
  9953     MOVE LENGTH OF
  9954      EL650AO
  9955       TO DFHEIV12
  9956     MOVE -1
  9957       TO DFHEIV11
  9958*    MOVE '8$D    CT       H L F ,   #00008639' TO DFHEIV0
  9959     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9960     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9961     MOVE X'2020233030303038363339' TO DFHEIV0(25:11)
  9962     CALL 'kxdfhei1' USING DFHEIV0,
  9963           MAP-NAME,
  9964           EL650AO,
  9965           DFHEIV12,
  9966           MAPSET-NAME,
  9967           DFHEIV99,
  9968           DFHEIV99,
  9969           DFHEIV99,
  9970           DFHEIV11,
  9971           DFHEIV99,
  9972           DFHEIV99,
  9973           DFHEIV99
  9974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9975
  9976
  9977     GO TO 9100-RETURN-TRAN.
  9978
  9979 8300-SEND-TEXT.
  9980
  9981* EXEC CICS  SEND TEXT
  9982*        FROM    (LOGOFF-TEXT)
  9983*        LENGTH  (LOGOFF-LENGTH)
  9984*        ERASE
  9985*        FREEKB
  9986*    END-EXEC.
  9987*    MOVE '8&      T  E F  H   F -   #00008650' TO DFHEIV0
  9988     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9989     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9990     MOVE X'2020233030303038363530' TO DFHEIV0(25:11)
  9991     CALL 'kxdfhei1' USING DFHEIV0,
  9992           LOGOFF-TEXT,
  9993           LOGOFF-LENGTH,
  9994           DFHEIV99,
  9995           DFHEIV99,
  9996           DFHEIV99,
  9997           DFHEIV99,
  9998           DFHEIV99,
  9999           DFHEIV99,
 10000           DFHEIV99,
 10001           DFHEIV99,
 10002           DFHEIV99,
 10003           DFHEIV99
 10004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10005
 10006
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL650.cbl
 10007
 10008* EXEC CICS  RETURN
 10009*    END-EXEC.
 10010*    MOVE '.(                    ''   #00008657' TO DFHEIV0
 10011     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10013     MOVE X'2020233030303038363537' TO DFHEIV0(25:11)
 10014     CALL 'kxdfhei1' USING DFHEIV0,
 10015           DFHEIV99,
 10016           DFHEIV99,
 10017           DFHEIV99,
 10018           DFHEIV99,
 10019           DFHEIV99,
 10020           DFHEIV99
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10022
 10023
 10024 8400-LOG-JOURNAL-RECORD.
 10025*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10026*    MOVE FILE-ID                TO  JP-FILE-ID.
 10027*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10028*
 10029*    IF PI-JOURNAL-FILE-ID  NOT =  ZERO
 10030*        EXEC CICS  JOURNAL
 10031*            JFILEID  (PI-JOURNAL-FILE-ID)
 10032*            JTYPEID  ('ER')
 10033*            FROM     (JOURNAL-RECORD)
 10034*            LENGTH   (2023)
 10035*        END-EXEC.
 10036
 10037 8600-DEEDIT.
 10038
 10039* EXEC CICS  BIF DEEDIT
 10040*        FIELD   (WS-DEEDIT-FIELD)
 10041*        LENGTH  (10)
 10042*    END-EXEC.
 10043     MOVE 10
 10044       TO DFHEIV11
 10045*    MOVE '@"L                   #   #00008674' TO DFHEIV0
 10046     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10047     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10048     MOVE X'2020233030303038363734' TO DFHEIV0(25:11)
 10049     CALL 'kxdfhei1' USING DFHEIV0,
 10050           WS-DEEDIT-FIELD,
 10051           DFHEIV11
 10052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10053
 10054 8600-EXIT.
 10055      EXIT.
 10056 8800-UNAUTHORIZED-ACCESS.
 10057     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10058
 10059     GO TO 8300-SEND-TEXT.
 10060
 10061 8810-PF23.
 10062     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10063     MOVE XCTL-005               TO  PGM-NAME.
 10064
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL650.cbl
 10065     GO TO 9300-XCTL.
 10066
 10067 8900-PF5.
 10068     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10069         MOVE ER-3785            TO  EMI-ERROR
 10070         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 10071         MOVE -1                 TO  MAINTL
 10072         GO TO 8200-SEND-DATAONLY.
 10073
 10074     MOVE PI-PREV-VG-ACCOUNT     TO  PI-ACCT-CCGSA-KEY.
 10075
 10076     MOVE XCTL-6509              TO  PGM-NAME.
 10077
 10078     GO TO 9300-XCTL.
 10079
 10080 8910-PF6.
 10081     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10082        MOVE ER-3785             TO EMI-ERROR
 10083        PERFORM 9900-ERROR-FORMAT
 10084                                 THRU 9900-EXIT
 10085        MOVE -1                  TO MAINTL
 10086        GO TO 8200-SEND-DATAONLY
 10087     END-IF
 10088     MOVE PI-PREV-VG-ACCOUNT     TO PI-ACCT-CCGSA-KEY
 10089     MOVE XCTL-6503              TO PGM-NAME
 10090     GO TO 9300-XCTL
 10091     .
 10092 9100-RETURN-TRAN.
 10093     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10094     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10095
 10096* EXEC CICS  RETURN
 10097*        TRANSID   (TRANS-ID)
 10098*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10099*        LENGTH    (WS-COMM-LENGTH)
 10100*    END-EXEC.
 10101*    MOVE '.(CT                  ''   #00008719' TO DFHEIV0
 10102     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10104     MOVE X'2020233030303038373139' TO DFHEIV0(25:11)
 10105     CALL 'kxdfhei1' USING DFHEIV0,
 10106           TRANS-ID,
 10107           PROGRAM-INTERFACE-BLOCK,
 10108           WS-COMM-LENGTH,
 10109           DFHEIV99,
 10110           DFHEIV99,
 10111           DFHEIV99
 10112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10113
 10114
 10115 9200-RETURN-MAIN-MENU.
 10116     MOVE XCTL-126               TO  PGM-NAME.
 10117
 10118     GO TO 9300-XCTL.
 10119
 10120 9300-XCTL.
 10121
 10122* EXEC CICS  XCTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL650.cbl
 10123*        PROGRAM   (PGM-NAME)
 10124*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10125*        LENGTH    (WS-COMM-LENGTH)
 10126*    END-EXEC.
 10127*    MOVE '.$C                   %   #00008731' TO DFHEIV0
 10128     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10129     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10130     MOVE X'2020233030303038373331' TO DFHEIV0(25:11)
 10131     CALL 'kxdfhei1' USING DFHEIV0,
 10132           PGM-NAME,
 10133           PROGRAM-INTERFACE-BLOCK,
 10134           WS-COMM-LENGTH,
 10135           DFHEIV99
 10136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10137
 10138
 10139 9400-CLEAR.
 10140     MOVE SPACES                 TO  PI-SV-MAINT.
 10141     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10142
 10143     GO TO 9300-XCTL.
 10144
 10145 9500-PF12.
 10146     MOVE XCTL-010               TO  PGM-NAME.
 10147
 10148     GO TO 9300-XCTL.
 10149
 10150 9600-PGMID-ERROR.
 10151
 10152* EXEC CICS  HANDLE CONDITION
 10153*        PGMIDERR  (8300-SEND-TEXT)
 10154*    END-EXEC.
 10155*    MOVE '"$L                   ! ? #00008749' TO DFHEIV0
 10156     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10158     MOVE X'3F20233030303038373439' TO DFHEIV0(25:11)
 10159     CALL 'kxdfhei1' USING DFHEIV0
 10160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10161
 10162
 10163     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10164     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10165     MOVE XCTL-005               TO  PGM-NAME.
 10166     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10167     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10168
 10169     GO TO 9300-XCTL.
 10170
 10171 9700-DATE-CONVERSION.
 10172     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10173
 10174
 10175* EXEC CICS  LINK
 10176*        PROGRAM   (PGM-NAME)
 10177*        COMMAREA  (DATE-CONVERSION-DATA)
 10178*        LENGTH    (DC-COMM-LENGTH)
 10179*    END-EXEC.
 10180*    MOVE '."C                   (   #00008764' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL650.cbl
 10181     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10183     MOVE X'2020233030303038373634' TO DFHEIV0(25:11)
 10184     CALL 'kxdfhei1' USING DFHEIV0,
 10185           PGM-NAME,
 10186           DATE-CONVERSION-DATA,
 10187           DC-COMM-LENGTH,
 10188           DFHEIV99,
 10189           DFHEIV99,
 10190           DFHEIV99,
 10191           DFHEIV99
 10192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10193
 10194
 10195 9900-ERROR-FORMAT.
 10196     IF NOT EMI-ERRORS-COMPLETE
 10197         MOVE LINK-001           TO  PGM-NAME
 10198
 10199* EXEC CICS  LINK
 10200*            PROGRAM   (PGM-NAME)
 10201*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10202*            LENGTH    (EMI-COMM-LENGTH)
 10203*        END-EXEC.
 10204*    MOVE '."C                   (   #00008773' TO DFHEIV0
 10205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10207     MOVE X'2020233030303038373733' TO DFHEIV0(25:11)
 10208     CALL 'kxdfhei1' USING DFHEIV0,
 10209           PGM-NAME,
 10210           ERROR-MESSAGE-INTERFACE-BLOCK,
 10211           EMI-COMM-LENGTH,
 10212           DFHEIV99,
 10213           DFHEIV99,
 10214           DFHEIV99,
 10215           DFHEIV99
 10216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10217
 10218
 10219 9900-EXIT.
 10220     EXIT.
 10221
 10222 9990-ABEND.
 10223     MOVE LINK-004               TO  PGM-NAME.
 10224     MOVE DFHEIBLK               TO  EMI-LINE1.
 10225
 10226
 10227* EXEC CICS  LINK
 10228*        PROGRAM   (PGM-NAME)
 10229*        COMMAREA  (EMI-LINE1)
 10230*        LENGTH    (72)
 10231*    END-EXEC.
 10232     MOVE 72
 10233       TO DFHEIV11
 10234*    MOVE '."C                   (   #00008786' TO DFHEIV0
 10235     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10237     MOVE X'2020233030303038373836' TO DFHEIV0(25:11)
 10238     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL650.cbl
 10239           PGM-NAME,
 10240           EMI-LINE1,
 10241           DFHEIV11,
 10242           DFHEIV99,
 10243           DFHEIV99,
 10244           DFHEIV99,
 10245           DFHEIV99
 10246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10247
 10248
 10249     MOVE -1                     TO  MAINTL.
 10250
 10251     GO TO 8200-SEND-DATAONLY.
 10252
 10253 9995-SECURITY-VIOLATION.
 10254*                            COPY ELCSCTP.
 10255******************************************************************
 10256*                                                                *
 10257*                            ELCSCTP                             *
 10258*                            VMOD=2.001                          *
 10259*                                                                *
 10260*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10261******************************************************************
 10262
 10263
 10264     MOVE EIBDATE          TO SM-JUL-DATE.
 10265     MOVE EIBTRMID         TO SM-TERMID.
 10266     MOVE THIS-PGM         TO SM-PGM.
 10267     MOVE EIBTIME          TO TIME-IN.
 10268     MOVE TIME-OUT         TO SM-TIME.
 10269     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10270
 10271
 10272* EXEC CICS LINK
 10273*         PROGRAM  ('EL003')
 10274*         COMMAREA (SECURITY-MESSAGE)
 10275*         LENGTH   (80)
 10276*    END-EXEC.
 10277     MOVE 'EL003' TO DFHEIV1
 10278     MOVE 80
 10279       TO DFHEIV11
 10280*    MOVE '."C                   (   #00008814' TO DFHEIV0
 10281     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10283     MOVE X'2020233030303038383134' TO DFHEIV0(25:11)
 10284     CALL 'kxdfhei1' USING DFHEIV0,
 10285           DFHEIV1,
 10286           SECURITY-MESSAGE,
 10287           DFHEIV11,
 10288           DFHEIV99,
 10289           DFHEIV99,
 10290           DFHEIV99,
 10291           DFHEIV99
 10292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10293
 10294
 10295******************************************************************
 10296
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 212
* EL650.cbl
 10297
 10298 9995-EXIT.
 10299     EXIT.
 10300
 10301 9999-DFHBACK SECTION.
 10302     MOVE '9%                    "   ' TO DFHEIV0
 10303     MOVE 'EL650' TO DFHEIV1
 10304     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10305     GOBACK.
 10306 9999-DFHEXIT.
 10307     IF DFHEIGDJ EQUAL 0001
 10308         NEXT SENTENCE
 10309     ELSE IF DFHEIGDJ EQUAL 2
 10310         GO TO 5340-END,
 10311               5330-NOT-FOUND
 10312         DEPENDING ON DFHEIGDI
 10313     ELSE IF DFHEIGDJ EQUAL 3
 10314         GO TO 9600-PGMID-ERROR,
 10315               9990-ABEND
 10316         DEPENDING ON DFHEIGDI
 10317     ELSE IF DFHEIGDJ EQUAL 4
 10318         GO TO 1010-NOT-FOUND,
 10319               1010-NOT-FOUND
 10320         DEPENDING ON DFHEIGDI
 10321     ELSE IF DFHEIGDJ EQUAL 5
 10322         GO TO 2568-NO-RECORDS,
 10323               2568-NO-RECORDS
 10324         DEPENDING ON DFHEIGDI
 10325     ELSE IF DFHEIGDJ EQUAL 6
 10326         GO TO 3175-CONTINUE,
 10327               3175-CONTINUE
 10328         DEPENDING ON DFHEIGDI
 10329     ELSE IF DFHEIGDJ EQUAL 7
 10330         GO TO 4175-CONTINUE,
 10331               4175-CONTINUE
 10332         DEPENDING ON DFHEIGDI
 10333     ELSE IF DFHEIGDJ EQUAL 8
 10334         GO TO 4530-NOT-FOUND,
 10335               4530-NOT-FOUND
 10336         DEPENDING ON DFHEIGDI
 10337     ELSE IF DFHEIGDJ EQUAL 9
 10338         GO TO 4699-EXIT,
 10339               4689-EOF
 10340         DEPENDING ON DFHEIGDI
 10341     ELSE IF DFHEIGDJ EQUAL 10
 10342         GO TO 4899-EXIT,
 10343               4889-EOF
 10344         DEPENDING ON DFHEIGDI
 10345     ELSE IF DFHEIGDJ EQUAL 11
 10346         GO TO 4580-DUPREC,
 10347               4580-DUPREC
 10348         DEPENDING ON DFHEIGDI
 10349     ELSE IF DFHEIGDJ EQUAL 12
 10350         GO TO 4959-EXIT,
 10351               4959-EXIT
 10352         DEPENDING ON DFHEIGDI
 10353     ELSE IF DFHEIGDJ EQUAL 13
 10354         GO TO 4969-EXIT,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 213
* EL650.cbl
 10355               4969-EXIT
 10356         DEPENDING ON DFHEIGDI
 10357     ELSE IF DFHEIGDJ EQUAL 14
 10358         GO TO 4980-EXIT
 10359         DEPENDING ON DFHEIGDI
 10360     ELSE IF DFHEIGDJ EQUAL 15
 10361         GO TO 5007-EXIT,
 10362               5007-EXIT
 10363         DEPENDING ON DFHEIGDI
 10364     ELSE IF DFHEIGDJ EQUAL 16
 10365         GO TO 5007-EXIT,
 10366               5007-EXIT,
 10367               5007-EXIT,
 10368               5007-EXIT,
 10369               5007-EXIT
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 17
 10372         GO TO 5015-NOT-FOUND,
 10373               5015-NOT-FOUND
 10374         DEPENDING ON DFHEIGDI
 10375     ELSE IF DFHEIGDJ EQUAL 18
 10376         GO TO 5015-NOT-FOUND,
 10377               5015-NOT-FOUND
 10378         DEPENDING ON DFHEIGDI
 10379     ELSE IF DFHEIGDJ EQUAL 19
 10380         GO TO 5340-END,
 10381               5330-NOT-FOUND
 10382         DEPENDING ON DFHEIGDI
 10383     ELSE IF DFHEIGDJ EQUAL 20
 10384         GO TO 5440-NOT-FOUND,
 10385               5430-NOT-FOUND
 10386         DEPENDING ON DFHEIGDI
 10387     ELSE IF DFHEIGDJ EQUAL 21
 10388         GO TO 5525-SKIP-REWRITE,
 10389               5525-SKIP-REWRITE
 10390         DEPENDING ON DFHEIGDI
 10391     ELSE IF DFHEIGDJ EQUAL 22
 10392         GO TO 5615-SKIP-REWRITE,
 10393               5615-SKIP-REWRITE
 10394         DEPENDING ON DFHEIGDI
 10395     ELSE IF DFHEIGDJ EQUAL 23
 10396         GO TO 6599-EXIT
 10397         DEPENDING ON DFHEIGDI
 10398     ELSE IF DFHEIGDJ EQUAL 24
 10399         GO TO 6699-EXIT
 10400         DEPENDING ON DFHEIGDI
 10401     ELSE IF DFHEIGDJ EQUAL 25
 10402         GO TO 6720-NO-CARRIER
 10403         DEPENDING ON DFHEIGDI
 10404     ELSE IF DFHEIGDJ EQUAL 26
 10405         GO TO 6780-NO-STATE
 10406         DEPENDING ON DFHEIGDI
 10407     ELSE IF DFHEIGDJ EQUAL 27
 10408         GO TO 6880-NO-COMP
 10409         DEPENDING ON DFHEIGDI
 10410     ELSE IF DFHEIGDJ EQUAL 28
 10411         GO TO 7200-EXIT,
 10412               7200-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 214
* EL650.cbl
 10413         DEPENDING ON DFHEIGDI
 10414     ELSE IF DFHEIGDJ EQUAL 29
 10415         GO TO 7300-EXIT,
 10416               7300-EXIT
 10417         DEPENDING ON DFHEIGDI
 10418     ELSE IF DFHEIGDJ EQUAL 30
 10419         GO TO 7400-EXIT,
 10420               7400-EXIT
 10421         DEPENDING ON DFHEIGDI
 10422     ELSE IF DFHEIGDJ EQUAL 31
 10423         GO TO 8300-SEND-TEXT
 10424         DEPENDING ON DFHEIGDI.
 10425     MOVE '9%                    "   ' TO DFHEIV0
 10426     MOVE 'EL650' TO DFHEIV1
 10427     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10428     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40228     Code:       34354
