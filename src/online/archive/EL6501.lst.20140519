* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56******************************************************************
    57
    58 ENVIRONMENT DIVISION.
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6501.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    64 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    65                                   USAGE POINTER.
    66 77  FILLER  PIC X(32)  VALUE '********************************'.
    67 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    68 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    69 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    70     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    71 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    72     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    73 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    74 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    75 01  WS-DEGUG-AREA.
    76     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    77     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    78     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    79     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    80     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    81     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    82     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    83     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    84 01  S1                          PIC S999   VALUE +0    COMP.
    85 01  WS-WORK-FIELD.
    86     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    87 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    88 01  WS-DATE-AREA.
    89     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    90     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    91
    92***DMD CUSTOM CODE *****START
    93     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    94     12  WS-DMD-AGENT            PIC X(10).
    95     12  WS-YYYYMMDD             PIC X(8).
    96     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
    97                                 PIC 9(8).
    98***DMD CUSTOM CODE *****END
    99
   100 01  WS-ACCOUNT-NUM-AREA.
   101     12  WS-ACCOUNT-FILLER       PIC X(06).
   102     12  WS-ACCT-BRANCH-CD       PIC X(04).
   103
   104 01  WS-NAME-AREA.
   105     12  WS-NAME-1-4             PIC X(04).
   106     12  WS-NAME-FILLER          PIC X(26).
   107
   108 01  STANDARD-AREAS.
   109     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   110         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   111     12  WS-RESPONSE             PIC S9(8)   COMP.
   112         88  RESP-NORMAL                  VALUE +00.
   113         88  RESP-NOTFND                  VALUE +13.
   114         88  RESP-DUPREC                  VALUE +14.
   115         88  RESP-DUPKEY                  VALUE +15.
   116         88  RESP-NOTOPEN                 VALUE +19.
   117         88  RESP-ENDFILE                 VALUE +20.
   118
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6501.cbl
   119     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   120     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   121     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   122     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   123     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   124     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   125     12  PGM-NAME                PIC X(8).
   126     12  TIME-IN                 PIC S9(7).
   127     12  TIME-OUT-R REDEFINES TIME-IN.
   128         16  FILLER              PIC X.
   129         16  TIME-OUT            PIC 99V99.
   130         16  FILLER              PIC XX.
   131     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   132     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   133     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   134     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   135     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   136     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   137     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   138     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   139     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   140     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   141     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   142     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   143     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   144     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   145     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   146     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   147     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   148     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   149     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   150     12  FILE-ID                 PIC X(8).
   151     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   152     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   153     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   154     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   155     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   156     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   157     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   158     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   159     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   160     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   161     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   162     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   163     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   164     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   165     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   166     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   167     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   168     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   169     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   170     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   171     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   172*                                copy ERCGXRF.
   173******************************************************************
   174*                                                                *
   175*                                                                *
   176*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6501.cbl
   177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   178*                            VMOD=2.002                          *
   179*                                                                *
   180*   ONLINE CREDIT SYSTEM                                         *
   181*                                                                *
   182*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   183*                                                                *
   184*   FILE TYPE = VSAM,KSDS                                        *
   185*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   186*                                                                *
   187*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   188*       ALTERNATE PATH = NONE                                    *
   189*                                                                *
   190*   LOG = NO                                                     *
   191*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   192*                                                                *
   193******************************************************************
   194
   195 01  AGENT-CROSS-REFERENCE.
   196     12  GX-RECORD-ID                PIC XX.
   197         88  VALID-GX-ID             VALUE 'GX'.
   198
   199     12  GX-CONTROL-PRIMARY.
   200         16  GX-COMPANY-CD           PIC X.
   201         16  GX-CARRIER              PIC X.
   202         16  GX-GROUPING             PIC X(6).
   203         16  GX-AGENT-NO             PIC X(10).
   204
   205     12  GX-MAINT-INFORMATION.
   206         16  GX-LAST-MAINT-DT        PIC XX.
   207         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   208         16  GX-LAST-MAINT-USER      PIC X(4).
   209         16  FILLER                  PIC X(9).
   210
   211     12  FILLER                      PIC X(37).
   212
   213     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   214
   215     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   216                            DEPENDING ON GX-AGENT-POINTER-CNT.
   217         16  GX-AM-CARRIER           PIC X.
   218         16  GX-AM-GROUPING          PIC X(6).
   219         16  GX-AM-STATE             PIC XX.
   220         16  GX-AM-ACCOUNT           PIC X(10).
   221         16  GX-AM-EXPIRATION-DT     PIC XX.
   222         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   223         16  GX-LAST-BILL-DT         PIC XX.
   224         16  GX-AM-EFF-DT            PIC XX.
   225         16  FILLER                  PIC X(4).
   226
   227******************************************************************
   228 01  WORK-AREAS-AND-SWITCHES.
   229     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   230     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   231     12  WS-ST-COMMISSION-CAPS.
   232         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   233         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   234         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6501.cbl
   235         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   236     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   237     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   238         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
   239
   240     12  COMMISSION-ACCUMS.
   241         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   242         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   243         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   244         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   245
   246     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   247     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   248     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   249     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   250     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   251     12  CURRENT-SAVE            PIC 9(8).
   252     12  BIN-CURRENT-SAVE        PIC XX.
   253     12  CYMD-CURRENT-SAVE       PIC 9(8).
   254     12  SUB                     PIC 99.
   255     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   256     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   257     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   258         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   259
   260     12  WS-EDIT-BEN-CODE        PIC XX.
   261         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   262                                          '90' THRU '99'.
   263
   264     12  WS-KEY-SAVE.
   265           18  WS-ACCT-CCGSA-KEY.
   266             20  WS-ACCT-CO             PIC X.
   267             20  WS-ACCT-CARRIER        PIC X.
   268             20  WS-ACCT-GROUPING       PIC X(6).
   269             20  WS-ACCT-STATE          PIC XX.
   270             20  WS-ACCT-ACCOUNT        PIC X(10).
   271           18  WS-ACCT-EXP-DT           PIC XX.
   272           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   273
   274     12  DEEDIT-FIELD                   PIC X(15).
   275     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   276     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   277     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   278     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   279     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
   280
   281     12  ELCNTL-KEY.
   282         16  CNTL-COMP-ID        PIC XXX.
   283         16  CNTL-REC-TYPE       PIC X.
   284         16  CNTL-ACCESS.
   285             20  FILLER          PIC X(4).
   286         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   287             20  FILLER          PIC XX.
   288             20  CNTL-BUS-TYPE   PIC XX.
   289         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   290             20  FILLER          PIC XX.
   291             20  CNTL-BEN-TYPE   PIC XX.
   292         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6501.cbl
   293
   294     12  REIN-KEY.
   295         16  REIN-COMP-CD        PIC X.
   296         16  REIN-CODE           PIC X.
   297         16  REIN-TABLE          PIC X(3).
   298         16  FILLER              PIC X(3).
   299
   300     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   301     12  COMM-KEY.
   302         16  COMM-COMP-CD        PIC X.
   303         16  COMM-TABLE          PIC XXX.
   304         16  COMM-LF-AH          PIC X.
   305         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   306
   307     12  RQST-KEY.
   308         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   309         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   310
   311     12  RQST3-KEY.
   312         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   313         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   314         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   315         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   316         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   317         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   318         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   319
   320     12  SAVE-RQST3-KEY.
   321         16  FILLER              PIC X     VALUE SPACES.
   322         16  FILLER              PIC X     VALUE SPACES.
   323         16  FILLER              PIC X(6)  VALUE SPACES.
   324         16  FILLER              PIC X(10) VALUE SPACES.
   325         16  FILLER              PIC X(10) VALUE SPACES.
   326         16  FILLER              PIC X(12) VALUE SPACES.
   327         16  FILLER              PIC X(6)  VALUE SPACES.
   328
   329     12  COMP-KEY.
   330         16  COMP-COMPANY-CD     PIC X.
   331         16  COMP-CARRIER        PIC X.
   332         16  COMP-GROUPING       PIC X(6).
   333         16  COMP-RESP-NO        PIC X(10).
   334         16  COMP-ACCOUNT        PIC X(10).
   335         16  COMP-TYPE           PIC X.
   336
   337     12  WS-AXRF-KEY.
   338         16  WS-AXRF-COMPANY-CD  PIC X.
   339         16  WS-AXRF-CARRIER     PIC X.
   340         16  WS-AXRF-GROUPING    PIC X(6).
   341         16  WS-AXRF-AGENT-NO    PIC X(10).
   342
   343     12  GX-AM-CONTROL-PRIMARY.
   344         16  GX-AM-COMPANY-CD    PIC X.
   345         16  GX-REST-OF-KEY      PIC X(20).
   346
   347     12  QID.
   348         16  QID-TERM            PIC X(4).
   349         16  FILLER              PIC X(4)    VALUE '6501'.
   350
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6501.cbl
   351     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   352         88  BROWSE-STARTED         VALUE 'Y'.
   353     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   354         88  FIRST-TIME             VALUE 'Y'.
   355
   356     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   357     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   358     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   359     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   360     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   361     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   362     12  GETMAIN-SW              PIC X       VALUE SPACES.
   363     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   364         88  GETMAIN-ACQUIRED                VALUE 'X'.
   365
   366     12  ER-0000                 PIC X(4)    VALUE '0000'.
   367     12  ER-0002                 PIC X(4)    VALUE '0002'.
   368     12  ER-0004                 PIC X(4)    VALUE '0004'.
   369     12  ER-0008                 PIC X(4)    VALUE '0008'.
   370     12  ER-0023                 PIC X(4)    VALUE '0023'.
   371     12  ER-0029                 PIC X(4)    VALUE '0029'.
   372     12  ER-0033                 PIC X(4)    VALUE '0033'.
   373     12  ER-0144                 PIC X(4)    VALUE '0144'.
   374     12  ER-0070                 PIC X(4)    VALUE '0070'.
   375     12  ER-0250                 PIC X(4)    VALUE '0250'.
   376     12  ER-0348                 PIC X(4)    VALUE '0348'.
   377     12  ER-0454                 PIC X(4)    VALUE '0454'.
   378     12  ER-0625                 PIC X(4)    VALUE '0625'.
   379     12  ER-0759                 PIC X(4)    VALUE '0759'.
   380     12  ER-0788                 PIC X(4)    VALUE '0788'.
   381     12  ER-0852                 PIC X(4)    VALUE '0852'.
   382     12  ER-0899                 PIC X(4)    VALUE '0899'.
   383     12  ER-1778                 PIC X(4)    VALUE '1778'.
   384     12  ER-1817                 PIC X(4)    VALUE '1817'.
   385     12  ER-1883                 PIC X(4)    VALUE '1883'.
   386     12  ER-1884                 PIC X(4)    VALUE '1884'.
   387     12  ER-1885                 PIC X(4)    VALUE '1885'.
   388     12  ER-1886                 PIC X(4)    VALUE '1886'.
   389     12  ER-1887                 PIC X(4)    VALUE '1887'.
   390     12  ER-2045                 PIC X(4)    VALUE '2045'.
   391     12  ER-2071                 PIC X(4)    VALUE '2071'.
   392     12  ER-2131                 PIC X(4)    VALUE '2131'.
   393*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   394     12  ER-2151                 PIC X(4)    VALUE '2151'.
   395     12  ER-2152                 PIC X(4)    VALUE '2152'.
   396     12  ER-2153                 PIC X(4)    VALUE '2153'.
   397     12  ER-2154                 PIC X(4)    VALUE '2154'.
   398     12  ER-2155                 PIC X(4)    VALUE '2155'.
   399     12  ER-2156                 PIC X(4)    VALUE '2156'.
   400     12  ER-2157                 PIC X(4)    VALUE '2157'.
   401     12  ER-2158                 PIC X(4)    VALUE '2158'.
   402     12  ER-2159                 PIC X(4)    VALUE '2159'.
   403     12  ER-2160                 PIC X(4)    VALUE '2160'.
   404     12  ER-2165                 PIC X(4)    VALUE '2165'.
   405     12  ER-2168                 PIC X(4)    VALUE '2168'.
   406     12  ER-2169                 PIC X(4)    VALUE '2169'.
   407     12  ER-2170                 PIC X(4)    VALUE '2170'.
   408     12  ER-2172                 PIC X(4)    VALUE '2172'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6501.cbl
   409     12  ER-2173                 PIC X(4)    VALUE '2173'.
   410     12  ER-2174                 PIC X(4)    VALUE '2174'.
   411     12  ER-2175                 PIC X(4)    VALUE '2175'.
   412     12  ER-2176                 PIC X(4)    VALUE '2176'.
   413     12  ER-2177                 PIC X(4)    VALUE '2177'.
   414     12  ER-2178                 PIC X(4)    VALUE '2178'.
   415     12  ER-2179                 PIC X(4)    VALUE '2179'.
   416     12  ER-2180                 PIC X(4)    VALUE '2180'.
   417     12  ER-2181                 PIC X(4)    VALUE '2181'.
   418     12  ER-2182                 PIC X(4)    VALUE '2182'.
   419     12  ER-2183                 PIC X(4)    VALUE '2183'.
   420     12  ER-2189                 PIC X(4)    VALUE '2189'.
   421     12  ER-2572                 PIC X(4)    VALUE '2572'.
   422     12  ER-2615                 PIC X(4)    VALUE '2615'.
   423     12  ER-2949                 PIC X(4)    VALUE '2949'.
   424     12  ER-2970                 PIC X(4)    VALUE '2970'.
   425     12  ER-4009                 PIC X(4)    VALUE '4009'.
   426     12  ER-4010                 PIC X(4)    VALUE '4010'.
   427     12  ER-4011                 PIC X(4)    VALUE '4011'.
   428     12  ER-4012                 PIC X(4)    VALUE '4012'.
   429     12  ER-7717                 PIC X(4)    VALUE '7717'.
   430     12  ER-9999                 PIC X(4)    VALUE '9999'.
   431     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   432
   433     12  WSS-LINE-LIAB-LIMITS.
   434         16  WSS-LF-LIMITS.
   435             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   436             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   437             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   438                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   439                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   440                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   441         16  WSS-AH-LIMITS.
   442             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   443             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   444             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   445                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   446                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   447                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   448                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   449
   450     12  WSS-COMM-STRUCTURE.
   451         16  WSS-DEFN-1.
   452             20  WSS-AGT-COMMS.
   453                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   454                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   455                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   456                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   457                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   458                 24  FILLER      PIC X(6)     VALUE SPACES.
   459
   460     12  WS-PHONE.
   461         16  WS-PH1              PIC XXX.
   462         16  WS-PH2              PIC XXX.
   463         16  WS-PH3              PIC XXXX.
   464     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   465
   466     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6501.cbl
   467     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   468     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   469     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   470     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   471     12  WS-BUS-TYPE             PIC 99.
   472     12  WS-BUS-ENTRY            PIC 99.
   473     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   474     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   475     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   476     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   477     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   478     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   479     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   480         88  COMMISSION-ERROR    VALUE 1.
   481     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   482     12  AGENT-FIND              PIC X        VALUE SPACES.
   483         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   484         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   485         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   486
   487     12  WS-ZIP-CODE.
   488         16  WS-ZIP-1            PIC X.
   489             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   490         16  WS-ZIP-2-3          PIC XX.
   491         16  WS-ZIP-4            PIC X.
   492         16  WS-ZIP-5            PIC X.
   493         16  WS-ZIP-6            PIC X.
   494         16  FILLER              PIC X(4).
   495     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   496         16  WS-ZIP-AM-1-CODE    PIC X(5).
   497         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   498         16  FILLER              PIC X.
   499     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   500         16  WS-ZIP-AM-2-CODE    PIC X(5).
   501         16  WS-ZIP-AM-2-DASH    PIC X.
   502         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   503     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   504         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   505         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   506         16  FILLER              PIC X(4).
   507     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   508         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   509         16  FILLER              PIC X.
   510         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   511         16  FILLER              PIC XXX.
   512     12  WS-SOC-SEC-WORK.
   513         16  WS-SS-TYPE          PIC X.
   514         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6501.cbl
   516*    COPY ELCSCTM.
   517******************************************************************
   518*                                                                *
   519*                                                                *
   520*                            ELCSCTM                             *
   521*                            VMOD=2.001                          *
   522*                                                                *
   523*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   524*                                                                *
   525******************************************************************
   526 01  SECURITY-MESSAGE.
   527     12  FILLER                          PIC X(30)
   528            VALUE '** LOGIC SECURITY VIOLATION -'.
   529     12  SM-READ                         PIC X(6).
   530     12  FILLER                          PIC X(5)
   531            VALUE ' PGM='.
   532     12  SM-PGM                          PIC X(6).
   533     12  FILLER                          PIC X(5)
   534            VALUE ' OPR='.
   535     12  SM-PROCESSOR-ID                 PIC X(4).
   536     12  FILLER                          PIC X(6)
   537            VALUE ' TERM='.
   538     12  SM-TERMID                       PIC X(4).
   539     12  FILLER                          PIC XX   VALUE SPACE.
   540     12  SM-JUL-DATE                     PIC 9(5).
   541     12  FILLER                          PIC X    VALUE SPACE.
   542     12  SM-TIME                         PIC 99.99.
   543
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6501.cbl
   545*    COPY ELCSCRTY.
   546******************************************************************
   547*                                                                *
   548*                                                                *
   549*                            ELCSCRTY                            *
   550*                            VMOD=2.001                          *
   551*                                                                *
   552*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   553*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   554*        SAVED IN PI-SECURITY-ADDRESS.                           *
   555*                                                                *
   556******************************************************************
   557 01  SECURITY-CONTROL.
   558     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   559     12  FILLER                       PIC XX    VALUE 'SC'.
   560     12  SC-CREDIT-CODES.
   561         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   562             20  SC-CREDIT-DISPLAY    PIC X.
   563             20  SC-CREDIT-UPDATE     PIC X.
   564     12  SC-CLAIMS-CODES.
   565         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   566             20  SC-CLAIMS-DISPLAY    PIC X.
   567             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6501.cbl
   569*    COPY ELCLOGOF.
   570******************************************************************
   571*                                                                *
   572*                                                                *
   573*                            ELCLOGOF.                           *
   574*                            VMOD=2.001                          *
   575*                                                                *
   576*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   577*                                                                *
   578******************************************************************
   579 01  CLASIC-LOGOFF.
   580     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   581     12  LOGOFF-TEXT.
   582         16  FILLER          PIC X(5)    VALUE SPACES.
   583         16  LOGOFF-MSG.
   584             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   585             20  FILLER      PIC X       VALUE SPACES.
   586             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   587         16  FILLER          PIC X(80)
   588           VALUE '* YOU ARE NOW LOGGED OFF'.
   589         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   590         16  FILLER          PIC X       VALUE QUOTE.
   591         16  LOGOFF-SYS-MSG  PIC X(17)
   592           VALUE 'S CLAS-IC SYSTEM '.
   593     12  TEXT-MESSAGES.
   594         16  UNACCESS-MSG    PIC X(29)
   595             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   596         16  PGMIDERR-MSG    PIC X(17)
   597             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6501.cbl
   599*    COPY ELCDATE.
   600******************************************************************
   601*                                                                *
   602*                                                                *
   603*                            ELCDATE.                            *
   604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   605*                            VMOD=2.003
   606*                                                                *
   607*                                                                *
   608*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   609*                 LENGTH = 200                                   *
   610******************************************************************
   611
   612 01  DATE-CONVERSION-DATA.
   613     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   614     12  DC-OPTION-CODE                PIC X.
   615         88  BIN-TO-GREG                VALUE ' '.
   616         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   617         88  EDIT-GREG-TO-BIN           VALUE '2'.
   618         88  YMD-GREG-TO-BIN            VALUE '3'.
   619         88  MDY-GREG-TO-BIN            VALUE '4'.
   620         88  JULIAN-TO-BIN              VALUE '5'.
   621         88  BIN-PLUS-ELAPSED           VALUE '6'.
   622         88  FIND-CENTURY               VALUE '7'.
   623         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   624         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   625         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   626         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   627         88  JULIAN-TO-BIN-3            VALUE 'C'.
   628         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   629         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   630         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   631         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   632         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   633         88  CHECK-LEAP-YEAR            VALUE 'H'.
   634         88  BIN-3-TO-GREG              VALUE 'I'.
   635         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   636         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   637         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   638         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   639         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   640         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   641         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   642         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   643         88  THREE-CHARACTER-BIN
   644                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   645         88  GREGORIAN-TO-BIN
   646                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   647         88  BIN-TO-GREGORIAN
   648                  VALUES ' ' '1' 'I' '8' 'G'.
   649         88  JULIAN-TO-BINARY
   650                  VALUES '5' 'C' 'E' 'F'.
   651     12  DC-ERROR-CODE                 PIC X.
   652         88  NO-CONVERSION-ERROR        VALUE ' '.
   653         88  DATE-CONVERSION-ERROR
   654                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   655         88  DATE-IS-ZERO               VALUE '1'.
   656         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6501.cbl
   657         88  DATE-IS-INVALID            VALUE '3'.
   658         88  DATE1-GREATER-DATE2        VALUE '4'.
   659         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   660         88  DATE-INVALID-OPTION        VALUE '9'.
   661         88  INVALID-CENTURY            VALUE 'A'.
   662         88  ONLY-CENTURY               VALUE 'B'.
   663         88  ONLY-LEAP-YEAR             VALUE 'C'.
   664         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   665     12  DC-END-OF-MONTH               PIC X.
   666         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   667     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   668         88  USE-NORMAL-PROCESS         VALUE ' '.
   669         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   670         88  ADJUST-UP-100-YRS          VALUE '2'.
   671     12  FILLER                        PIC X.
   672     12  DC-CONVERSION-DATES.
   673         16  DC-BIN-DATE-1             PIC XX.
   674         16  DC-BIN-DATE-2             PIC XX.
   675         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   676         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   677                       DC-GREG-DATE-1-EDIT.
   678             20  DC-EDIT1-MONTH        PIC 99.
   679             20  SLASH1-1              PIC X.
   680             20  DC-EDIT1-DAY          PIC 99.
   681             20  SLASH1-2              PIC X.
   682             20  DC-EDIT1-YEAR         PIC 99.
   683         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   684         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   685                     DC-GREG-DATE-2-EDIT.
   686             20  DC-EDIT2-MONTH        PIC 99.
   687             20  SLASH2-1              PIC X.
   688             20  DC-EDIT2-DAY          PIC 99.
   689             20  SLASH2-2              PIC X.
   690             20  DC-EDIT2-YEAR         PIC 99.
   691         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   692         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   693                     DC-GREG-DATE-1-YMD.
   694             20  DC-YMD-YEAR           PIC 99.
   695             20  DC-YMD-MONTH          PIC 99.
   696             20  DC-YMD-DAY            PIC 99.
   697         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   698         16  DC-GREG-DATE-1-MDY-R REDEFINES
   699                      DC-GREG-DATE-1-MDY.
   700             20  DC-MDY-MONTH          PIC 99.
   701             20  DC-MDY-DAY            PIC 99.
   702             20  DC-MDY-YEAR           PIC 99.
   703         16  DC-GREG-DATE-1-ALPHA.
   704             20  DC-ALPHA-MONTH        PIC X(10).
   705             20  DC-ALPHA-DAY          PIC 99.
   706             20  FILLER                PIC XX.
   707             20  DC-ALPHA-CENTURY.
   708                 24 DC-ALPHA-CEN-N     PIC 99.
   709             20  DC-ALPHA-YEAR         PIC 99.
   710         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   711         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   712         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   713         16  DC-JULIAN-DATE            PIC 9(05).
   714         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6501.cbl
   715                                       PIC 9(05).
   716         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   717             20  DC-JULIAN-YEAR        PIC 99.
   718             20  DC-JULIAN-DAYS        PIC 999.
   719         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   720         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   721         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   722     12  DATE-CONVERSION-VARIBLES.
   723         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   724         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   725             20  FILLER                PIC 9(3).
   726             20  HOLD-CEN-1-CCYY.
   727                 24  HOLD-CEN-1-CC     PIC 99.
   728                 24  HOLD-CEN-1-YY     PIC 99.
   729             20  HOLD-CEN-1-MO         PIC 99.
   730             20  HOLD-CEN-1-DA         PIC 99.
   731         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   732             20  HOLD-CEN-1-R-MO       PIC 99.
   733             20  HOLD-CEN-1-R-DA       PIC 99.
   734             20  HOLD-CEN-1-R-CCYY.
   735                 24  HOLD-CEN-1-R-CC   PIC 99.
   736                 24  HOLD-CEN-1-R-YY   PIC 99.
   737             20  FILLER                PIC 9(3).
   738         16  HOLD-CENTURY-1-X.
   739             20  FILLER                PIC X(3)  VALUE SPACES.
   740             20  HOLD-CEN-1-X-CCYY.
   741                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   742                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   743             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   744             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   745         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   746             20  HOLD-CEN-1-R-X-MO     PIC XX.
   747             20  HOLD-CEN-1-R-X-DA     PIC XX.
   748             20  HOLD-CEN-1-R-X-CCYY.
   749                 24  HOLD-CEN-1-R-X-CC PIC XX.
   750                 24  HOLD-CEN-1-R-X-YY PIC XX.
   751             20  FILLER                PIC XXX.
   752         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   753         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   754         16  DC-JULIAN-DATE-1          PIC 9(07).
   755         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   756             20  DC-JULIAN-1-CCYY.
   757                 24  DC-JULIAN-1-CC    PIC 99.
   758                 24  DC-JULIAN-1-YR    PIC 99.
   759             20  DC-JULIAN-DA-1        PIC 999.
   760         16  DC-JULIAN-DATE-2          PIC 9(07).
   761         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   762             20  DC-JULIAN-2-CCYY.
   763                 24  DC-JULIAN-2-CC    PIC 99.
   764                 24  DC-JULIAN-2-YR    PIC 99.
   765             20  DC-JULIAN-DA-2        PIC 999.
   766         16  DC-GREG-DATE-A-EDIT.
   767             20  DC-EDITA-MONTH        PIC 99.
   768             20  SLASHA-1              PIC X VALUE '/'.
   769             20  DC-EDITA-DAY          PIC 99.
   770             20  SLASHA-2              PIC X VALUE '/'.
   771             20  DC-EDITA-CCYY.
   772                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6501.cbl
   773                 24  DC-EDITA-YEAR     PIC 99.
   774         16  DC-GREG-DATE-B-EDIT.
   775             20  DC-EDITB-MONTH        PIC 99.
   776             20  SLASHB-1              PIC X VALUE '/'.
   777             20  DC-EDITB-DAY          PIC 99.
   778             20  SLASHB-2              PIC X VALUE '/'.
   779             20  DC-EDITB-CCYY.
   780                 24  DC-EDITB-CENT     PIC 99.
   781                 24  DC-EDITB-YEAR     PIC 99.
   782         16  DC-GREG-DATE-CYMD         PIC 9(08).
   783         16  DC-GREG-DATE-CYMD-R REDEFINES
   784                              DC-GREG-DATE-CYMD.
   785             20  DC-CYMD-CEN           PIC 99.
   786             20  DC-CYMD-YEAR          PIC 99.
   787             20  DC-CYMD-MONTH         PIC 99.
   788             20  DC-CYMD-DAY           PIC 99.
   789         16  DC-GREG-DATE-MDCY         PIC 9(08).
   790         16  DC-GREG-DATE-MDCY-R REDEFINES
   791                              DC-GREG-DATE-MDCY.
   792             20  DC-MDCY-MONTH         PIC 99.
   793             20  DC-MDCY-DAY           PIC 99.
   794             20  DC-MDCY-CEN           PIC 99.
   795             20  DC-MDCY-YEAR          PIC 99.
   796    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   797        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   798    12  DC-EL310-DATE                  PIC X(21).
   799    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6501.cbl
   801*    COPY ELCATTR.
   802******************************************************************
   803*                                                                *
   804*                            ELCATTR.                            *
   805*                            VMOD=2.001                          *
   806*                                                                *
   807*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   808*                                                                *
   809*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   810*                                                                *
   811*                   POS 1   P=PROTECTED                          *
   812*                           U=UNPROTECTED                        *
   813*                           S=ASKIP                              *
   814*                   POS 2   A=ALPHA/NUMERIC                      *
   815*                           N=NUMERIC                            *
   816*                   POS 3   N=NORMAL                             *
   817*                           B=BRIGHT                             *
   818*                           D=DARK                               *
   819*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   820*                           OF=MODIFIED DATA TAG OFF             *
   821*                                                                *
   822*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   823******************************************************************
   824 01  ATTRIBUTE-LIST.
   825     12  AL-PABOF            PIC X       VALUE 'Y'.
   826     12  AL-PABON            PIC X       VALUE 'Z'.
   827     12  AL-PADOF            PIC X       VALUE '%'.
   828     12  AL-PADON            PIC X       VALUE '_'.
   829     12  AL-PANOF            PIC X       VALUE '-'.
   830     12  AL-PANON            PIC X       VALUE '/'.
   831     12  AL-SABOF            PIC X       VALUE '8'.
   832     12  AL-SABON            PIC X       VALUE '9'.
   833     12  AL-SADOF            PIC X       VALUE '@'.
   834     12  AL-SADON            PIC X       VALUE QUOTE.
   835     12  AL-SANOF            PIC X       VALUE '0'.
   836     12  AL-SANON            PIC X       VALUE '1'.
   837     12  AL-UABOF            PIC X       VALUE 'H'.
   838     12  AL-UABON            PIC X       VALUE 'I'.
   839     12  AL-UADOF            PIC X       VALUE '<'.
   840     12  AL-UADON            PIC X       VALUE '('.
   841     12  AL-UANOF            PIC X       VALUE ' '.
   842     12  AL-UANON            PIC X       VALUE 'A'.
   843     12  AL-UNBOF            PIC X       VALUE 'Q'.
   844     12  AL-UNBON            PIC X       VALUE 'R'.
   845     12  AL-UNDOF            PIC X       VALUE '*'.
   846     12  AL-UNDON            PIC X       VALUE ')'.
   847     12  AL-UNNOF            PIC X       VALUE '&'.
   848     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6501.cbl
   850*    COPY ELCEMIB.
   851******************************************************************
   852*                                                                *
   853*                                                                *
   854*                            ELCEMIB.                            *
   855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   856*                            VMOD=2.005                          *
   857*                                                                *
   858*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   859*                                                                *
   860******************************************************************
   861 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   862     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   863     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   864     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   865     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   866     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   867     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   868     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   869     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   870     12  EMI-SWITCH1             PIC X        VALUE '1'.
   871         88  EMI-NO-ERRORS                    VALUE '1'.
   872         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   873         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   874     12  EMI-SWITCH2             PIC X        VALUE '1'.
   875         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   876     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   877         88  EMI-AREA1-EMPTY                  VALUE '1'.
   878         88  EMI-AREA1-FULL                   VALUE '2'.
   879     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   880         88  EMI-AREA2-EMPTY                  VALUE '1'.
   881         88  EMI-AREA2-FULL                   VALUE '2'.
   882     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   883         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   884         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   885         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   886         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   887         88  EMI-BYPASS-FATALS                VALUE 'X'.
   888     12  EMI-ERROR-LINES.
   889         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   890         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   891         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   892         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   893             20  EMI-ERR-CODES OCCURS 10 TIMES.
   894                 24  EMI-ERR-NUM         PIC X(4).
   895                 24  EMI-FILLER          PIC X.
   896                 24  EMI-SEV             PIC X.
   897                 24  FILLER              PIC X.
   898             20  FILLER                  PIC X(02).
   899     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   900         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   901             20  EMI-ERROR-NUMBER    PIC X(4).
   902             20  EMI-FILL            PIC X.
   903             20  EMI-SEVERITY        PIC X.
   904             20  FILLER              PIC X.
   905             20  EMI-ERROR-TEXT.
   906                 24  EMI-TEXT-VARIABLE   PIC X(10).
   907                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6501.cbl
   908     12  EMI-SEVERITY-SAVE           PIC X.
   909         88  EMI-NOTE                    VALUE 'N'.
   910         88  EMI-WARNING                 VALUE 'W'.
   911         88  EMI-FORCABLE                VALUE 'F'.
   912         88  EMI-FATAL                   VALUE 'X'.
   913     12  EMI-MESSAGE-FLAG            PIC X.
   914         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   915         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   916     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   917     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   918         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   919         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   920         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   921     12  FILLER                      PIC X(137)  VALUE SPACES.
   922     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   923     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   924     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   925     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6501.cbl
   927*    COPY ELCINTF.
   928******************************************************************
   929*                                                                *
   930*                                                                *
   931*                            ELCINTF.                            *
   932*                            VMOD=2.017                          *
   933*                                                                *
   934*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   935*                                                                *
   936*       LENGTH = 1024                                            *
   937*                                                                *
   938******************************************************************
   939 01  PROGRAM-INTERFACE-BLOCK.
   940     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   941     12  PI-CALLING-PROGRAM              PIC X(8).
   942     12  PI-SAVED-PROGRAM-1              PIC X(8).
   943     12  PI-SAVED-PROGRAM-2              PIC X(8).
   944     12  PI-SAVED-PROGRAM-3              PIC X(8).
   945     12  PI-SAVED-PROGRAM-4              PIC X(8).
   946     12  PI-SAVED-PROGRAM-5              PIC X(8).
   947     12  PI-SAVED-PROGRAM-6              PIC X(8).
   948     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   949     12  PI-COMPANY-ID                   PIC XXX.
   950     12  PI-COMPANY-CD                   PIC X.
   951
   952     12  PI-COMPANY-PASSWORD             PIC X(8).
   953
   954     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   955
   956     12  PI-CONTROL-IN-PROGRESS.
   957         16  PI-CARRIER                  PIC X.
   958         16  PI-GROUPING                 PIC X(6).
   959         16  PI-STATE                    PIC XX.
   960         16  PI-ACCOUNT                  PIC X(10).
   961         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   962                                         PIC X(10).
   963         16  PI-CLAIM-CERT-GRP.
   964             20  PI-CLAIM-NO             PIC X(7).
   965             20  PI-CERT-NO.
   966                 25  PI-CERT-PRIME       PIC X(10).
   967                 25  PI-CERT-SFX         PIC X.
   968             20  PI-CERT-EFF-DT          PIC XX.
   969         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   970             20  PI-PLAN-CODE            PIC X(2).
   971             20  PI-REVISION-NUMBER      PIC X(3).
   972             20  PI-PLAN-EFF-DT          PIC X(2).
   973             20  PI-PLAN-EXP-DT          PIC X(2).
   974             20  FILLER                  PIC X(11).
   975         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   976             20  PI-OE-REFERENCE-1.
   977                 25  PI-OE-REF-1-PRIME   PIC X(18).
   978                 25  PI-OE-REF-1-SUFF    PIC XX.
   979
   980     12  PI-SESSION-IN-PROGRESS          PIC X.
   981         88  CLAIM-SESSION                   VALUE '1'.
   982         88  CREDIT-SESSION                  VALUE '2'.
   983         88  WARRANTY-SESSION                VALUE '3'.
   984         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6501.cbl
   985         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   986
   987
   988*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   989
   990     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   991     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   992
   993     12  PI-CREDIT-USER                  PIC X.
   994         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   995         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   996
   997     12  PI-CLAIM-USER                   PIC X.
   998         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   999         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1000
  1001     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1002         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1003         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1004         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1005         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1006         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1007
  1008     12  PI-PROCESSOR-ID                 PIC X(4).
  1009
  1010     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1011
  1012     12  PI-MEMBER-CAPTION               PIC X(10).
  1013
  1014     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1015         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1016
  1017     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1018     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1019     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1020     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1021
  1022     12  PI-AH-OVERRIDE-L1               PIC X.
  1023     12  PI-AH-OVERRIDE-L2               PIC XX.
  1024     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1025     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1026
  1027     12  PI-NEW-SYSTEM                   PIC X(2).
  1028
  1029     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1030     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1031         88  PI-USES-PAID-TO                 VALUE '1'.
  1032     12  PI-CRDTCRD-SYSTEM.
  1033         16  PI-CRDTCRD-USER             PIC X.
  1034             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1035             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1036         16  PI-CC-MONTH-END-DT          PIC XX.
  1037     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1038
  1039     12  PI-OE-REFERENCE-2.
  1040         16  PI-OE-REF-2-PRIME           PIC X(10).
  1041         16  PI-OE-REF-2-SUFF            PIC X.
  1042
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6501.cbl
  1043     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1044
  1045     12  PI-LANGUAGE-TYPE                PIC X.
  1046             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1047             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1048             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1049
  1050     12  PI-POLICY-LINKAGE-IND           PIC X.
  1051         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1052         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1053                                                   LOW-VALUES.
  1054
  1055     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1056     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1057         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1058         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1059     12  FILLER                          PIC X(4).
  1060
  1061     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1062
  1063     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1064         PI-SYSTEM-LEVEL.
  1065
  1066         16  PI-ENTRY-CODES.
  1067             20  PI-ENTRY-CD-1           PIC X.
  1068             20  PI-ENTRY-CD-2           PIC X.
  1069
  1070         16  PI-RETURN-CODES.
  1071             20  PI-RETURN-CD-1          PIC X.
  1072             20  PI-RETURN-CD-2          PIC X.
  1073
  1074         16  PI-UPDATE-STATUS-SAVE.
  1075             20  PI-UPDATE-BY            PIC X(4).
  1076             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1077
  1078         16  PI-LOWER-CASE-LETTERS       PIC X.
  1079             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1080
  1081*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1082*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1083*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1084
  1085         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1086             88  ST-ACCNT-CNTL               VALUE ' '.
  1087             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1088             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1089             88  ACCNT-CNTL                  VALUE '3'.
  1090             88  CARR-ACCNT-CNTL             VALUE '4'.
  1091
  1092         16  PI-PROCESSOR-CAP-LIST.
  1093             20  PI-SYSTEM-CONTROLS.
  1094                24 PI-SYSTEM-DISPLAY     PIC X.
  1095                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1096                24 PI-SYSTEM-MODIFY      PIC X.
  1097                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1098             20  FILLER                  PIC XX.
  1099             20  PI-DISPLAY-CAP          PIC X.
  1100                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6501.cbl
  1101             20  PI-MODIFY-CAP           PIC X.
  1102                 88  MODIFY-CAP              VALUE 'Y'.
  1103             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1104                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1105             20  PI-FORCE-CAP            PIC X.
  1106                 88  FORCE-CAP               VALUE 'Y'.
  1107
  1108         16  PI-PROGRAM-CONTROLS.
  1109             20  PI-PGM-PRINT-OPT        PIC X.
  1110             20  PI-PGM-FORMAT-OPT       PIC X.
  1111             20  PI-PGM-PROCESS-OPT      PIC X.
  1112             20  PI-PGM-TOTALS-OPT       PIC X.
  1113
  1114         16  PI-HELP-INTERFACE.
  1115             20  PI-LAST-ERROR-NO        PIC X(4).
  1116             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1117
  1118         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1119             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1120
  1121         16  PI-CR-CONTROL-IN-PROGRESS.
  1122             20  PI-CR-CARRIER           PIC X.
  1123             20  PI-CR-GROUPING          PIC X(6).
  1124             20  PI-CR-STATE             PIC XX.
  1125             20  PI-CR-ACCOUNT           PIC X(10).
  1126             20  PI-CR-FIN-RESP          PIC X(10).
  1127             20  PI-CR-TYPE              PIC X.
  1128
  1129         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1130
  1131         16  PI-CR-MONTH-END-DT          PIC XX.
  1132
  1133         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1134             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1135             88  PI-ZERO-CARRIER             VALUE '1'.
  1136             88  PI-ZERO-GROUPING            VALUE '2'.
  1137             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1138
  1139         16  PI-CARRIER-SECURITY         PIC X.
  1140             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1141
  1142         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1143             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1144             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1145
  1146         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1147             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1148                                         INDEXED BY PI-ACCESS-NDX
  1149                                         PIC X.
  1150
  1151         16  PI-GA-BILLING-CONTROL       PIC X.
  1152             88  PI-GA-BILLING               VALUE '1'.
  1153
  1154         16  PI-MAIL-PROCESSING          PIC X.
  1155             88  PI-MAIL-YES                 VALUE 'Y'.
  1156
  1157         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6501.cbl
  1159         16  PI-AR-SYSTEM.
  1160             20  PI-AR-PROCESSING-CNTL   PIC X.
  1161                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1162             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1163             20  PI-AR-MONTH-END-DT      PIC XX.
  1164
  1165         16  PI-MP-SYSTEM.
  1166             20  PI-MORTGAGE-USER            PIC X.
  1167                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1168                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1169             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1170                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1171                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1172                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1173                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1174                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1175             20  PI-MP-MONTH-END-DT          PIC XX.
  1176             20  PI-MP-REFERENCE-NO.
  1177                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1178                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1179
  1180         16  PI-LABEL-CONTROL            PIC X(01).
  1181             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1182             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1183
  1184         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1185             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1186
  1187         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1188             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1189             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1190
  1191         16  FILLER                      PIC X(14).
  1192
  1193     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1194******************************************************************
  1195*    COPY ELC650PI.
  1196******************************************************************
  1197*
  1198*                            ELC650PI.
  1199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1200*                            VMOD=2.007
  1201*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1202*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
  1203* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1204*
  1205******************************************************************
  1206
  1207     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1208         16  PI-MAINT                   PIC X.
  1209         16  PI-PREV-ACCOUNT            PIC X(20).
  1210         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1211         16  PI-ACCT-KEY.
  1212             20  PI-ACCT-CCGSA-KEY.
  1213                 24  PI-ACCT-CO             PIC X.
  1214                 24  PI-ACCT-CARRIER        PIC X.
  1215                 24  PI-ACCT-GROUPING       PIC X(6).
  1216                 24  PI-ACCT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6501.cbl
  1217                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1218             20  PI-ACCT-EXP-DT           PIC XX.
  1219             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1220         16  PI-ACCT-ID                 PIC X(8).
  1221         16  PI-PLAN-KEY.
  1222             20  PI-PLAN-ACCT-KEY.
  1223                 24  PI-PLAN-COMPANY-CD PIC X.
  1224                 24  PI-PLAN-CARRIER    PIC X.
  1225                 24  PI-PLAN-GROUP      PIC X(6).
  1226                 24  PI-PLAN-STATE      PIC X(2).
  1227                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1228             20  PI-PLAN-BEN-TYPE       PIC X.
  1229             20  PI-PLAN-BEN            PIC XX.
  1230             20  PI-PLAN-REVISION       PIC X(3).
  1231         16  PI-WS-STATE                PIC XX.
  1232         16  PI-WS-CLASS                PIC XX.
  1233         16  PI-WS-DEV                  PIC X(3).
  1234         16  PI-WS-TYPE                 PIC X.
  1235         16  PI-WS-PLAN                 PIC XX.
  1236
  1237         16  PI-ERPNDB-ALT-KEY.
  1238             20  PI-PB-COMPANY-CD-A1    PIC X.
  1239             20  PI-PB-CARRIER          PIC X.
  1240             20  PI-PB-GROUPING         PIC X(6).
  1241             20  PI-PB-STATE            PIC XX.
  1242             20  PI-PB-ACCOUNT          PIC X(10).
  1243             20  PI-PB-CERT-EFF-DT      PIC XX.
  1244             20  PI-PB-CERT-NO          PIC X(10).
  1245             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1246             20  PI-PB-RECORD-TYPE      PIC X.
  1247
  1248         16  PI-DATE-RANGE-TABLE.
  1249             20  PI-TABLE-ENT OCCURS 32 TIMES
  1250                            INDEXED BY T-INDEX.
  1251                 24  PI-BIN-EFF-DT          PIC XX.
  1252                 24  PI-BIN-EXP-DT          PIC XX.
  1253                 24  PI-BIN-MAINT-DT        PIC XX.
  1254                 24  PI-BIN-LO-CERT         PIC XX.
  1255                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1256                 24  PI-BIN-HI-CERT         PIC XX.
  1257         16  PI-PAGE-NUMBER             PIC S9.
  1258             88  PI-FST-PAGE               VALUE +1.
  1259             88  PI-2ND-PAGE               VALUE +2.
  1260             88  PI-3RD-PAGE               VALUE +3.
  1261             88  PI-LST-PAGE               VALUE +4.
  1262         16  PI-TOTAL-LINES             PIC S99.
  1263         16  PI-LINE-SELECTED    PIC S9.
  1264***  Y2K PROJ 7744
  1265         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1266         16  BIN-EFFCHG-SAVE     PIC XX.
  1267         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1268***  Y2K PROJ 7744
  1269         16  BIN-EXPCHG-SAVE     PIC XX.
  1270         16  PI-RECORD-ADDED-SW  PIC X.
  1271             88  PI-RECORD-ADDED            VALUE '1'.
  1272             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1273         16  PI-ACCNAME          PIC X(30).
  1274         16  PI-COMM-POINTER     PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6501.cbl
  1275         16  PI-SV-MAINT         PIC X.
  1276         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1277         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1278         16  PI-UPDATE-SW        PIC X.
  1279             88  PI-CHANGES-MADE             VALUE '1'.
  1280         16  PI-NOTE-TYPE        PIC X.
  1281             88  PI-ACCT-NOTE                VALUE '1'.
  1282         16  PI-DMD-FILE-SW      PIC X.
  1283             88  END-OF-FILE                 VALUE 'E'.
  1284             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1285             88  FIRST-OCCURS                VALUE 'F'.
  1286         16  PI-DMD-OCCURS       PIC S999.
  1287         16  PI-DMD-SCREEN       PIC X.
  1288             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1289             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1290             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1291         16  PI-NAMEFLG          PIC X.
  1292         16  PI-EL650-DEL-SW     PIC X.
  1293         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1294         16  PI-DCC-PROD-CODE    PIC XXX.
  1295         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6501.cbl
  1297
  1298*    COPY ELCJPFX.
  1299******************************************************************
  1300*                                                                *
  1301*                                                                *
  1302*                            ELCJPFX.                            *
  1303*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1304*                            VMOD=2.002                          *
  1305*                                                                *
  1306*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1307*                                                                *
  1308*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1309*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1310*        ELCNTL - CONTROL FILE                                   *
  1311*        ELMSTR - CLAIM MASTERS                                  *
  1312*        ELTRLR - ACTIVITY TRAILERS                              *
  1313*        ELCHKQ - CHECK QUE                                      *
  1314******************************************************************
  1315 01  JOURNAL-RECORD.
  1316     12  JP-USER-ID                  PIC X(4).
  1317     12  JP-FILE-ID                  PIC X(8).
  1318     12  JP-PROGRAM-ID               PIC X(8).
  1319     12  JP-RECORD-TYPE              PIC X.
  1320         88 JP-ADD              VALUE 'A'.
  1321         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1322         88 JP-AFTER-CHANGE     VALUE 'C'.
  1323         88 JP-DELETE           VALUE 'D'.
  1324         88 JP-GENERIC-DELETE   VALUE 'G'.
  1325         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1326         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1327     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1328     12  JP-RECORD-AREA
  1329
  1330
  1331         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6501.cbl
  1333*    COPY ELCAID.
  1334******************************************************************
  1335*                                                                *
  1336*                            ELCAID.                             *
  1337*                            VMOD=2.001                          *
  1338*                                                                *
  1339*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1340*                                                                *
  1341*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1342*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1343******************************************************************
  1344
  1345 01  DFHAID.
  1346   02  DFHNULL   PIC  X  VALUE  ' '.
  1347   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1348   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1349   02  DFHPEN    PIC  X  VALUE  '='.
  1350   02  DFHOPID   PIC  X  VALUE  'W'.
  1351   02  DFHPA1    PIC  X  VALUE  '%'.
  1352   02  DFHPA2    PIC  X  VALUE  '>'.
  1353   02  DFHPA3    PIC  X  VALUE  ','.
  1354   02  DFHPF1    PIC  X  VALUE  '1'.
  1355   02  DFHPF2    PIC  X  VALUE  '2'.
  1356   02  DFHPF3    PIC  X  VALUE  '3'.
  1357   02  DFHPF4    PIC  X  VALUE  '4'.
  1358   02  DFHPF5    PIC  X  VALUE  '5'.
  1359   02  DFHPF6    PIC  X  VALUE  '6'.
  1360   02  DFHPF7    PIC  X  VALUE  '7'.
  1361   02  DFHPF8    PIC  X  VALUE  '8'.
  1362   02  DFHPF9    PIC  X  VALUE  '9'.
  1363   02  DFHPF10   PIC  X  VALUE  ':'.
  1364   02  DFHPF11   PIC  X  VALUE  '#'.
  1365   02  DFHPF12   PIC  X  VALUE  '@'.
  1366   02  DFHPF13   PIC  X  VALUE  'A'.
  1367   02  DFHPF14   PIC  X  VALUE  'B'.
  1368   02  DFHPF15   PIC  X  VALUE  'C'.
  1369   02  DFHPF16   PIC  X  VALUE  'D'.
  1370   02  DFHPF17   PIC  X  VALUE  'E'.
  1371   02  DFHPF18   PIC  X  VALUE  'F'.
  1372   02  DFHPF19   PIC  X  VALUE  'G'.
  1373   02  DFHPF20   PIC  X  VALUE  'H'.
  1374   02  DFHPF21   PIC  X  VALUE  'I'.
  1375*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1376   02  DFHPF22   PIC  X  VALUE  '['.
  1377   02  DFHPF23   PIC  X  VALUE  '.'.
  1378   02  DFHPF24   PIC  X  VALUE  '<'.
  1379   02  DFHMSRE   PIC  X  VALUE  'X'.
  1380   02  DFHSTRF   PIC  X  VALUE  'h'.
  1381   02  DFHTRIG   PIC  X  VALUE  '"'.
  1382 01  FILLER    REDEFINES DFHAID.
  1383     12  FILLER                  PIC X(8).
  1384     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6501.cbl
  1386*    COPY EL6501S.
  1387 01  EL6501AI.
  1388     05  FILLER            PIC  X(0012).
  1389*    -------------------------------
  1390     05  DATEL PIC S9(0004) COMP.
  1391     05  DATEF PIC  X(0001).
  1392     05  FILLER REDEFINES DATEF.
  1393         10  DATEA PIC  X(0001).
  1394     05  DATEI PIC  X(0008).
  1395*    -------------------------------
  1396     05  TIMEL PIC S9(0004) COMP.
  1397     05  TIMEF PIC  X(0001).
  1398     05  FILLER REDEFINES TIMEF.
  1399         10  TIMEA PIC  X(0001).
  1400     05  TIMEI PIC  X(0005).
  1401*    -------------------------------
  1402     05  CMPNYIDL PIC S9(0004) COMP.
  1403     05  CMPNYIDF PIC  X(0001).
  1404     05  FILLER REDEFINES CMPNYIDF.
  1405         10  CMPNYIDA PIC  X(0001).
  1406     05  CMPNYIDI PIC  X(0003).
  1407*    -------------------------------
  1408     05  USERIDL PIC S9(0004) COMP.
  1409     05  USERIDF PIC  X(0001).
  1410     05  FILLER REDEFINES USERIDF.
  1411         10  USERIDA PIC  X(0001).
  1412     05  USERIDI PIC  X(0004).
  1413*    -------------------------------
  1414     05  MAINTL PIC S9(0004) COMP.
  1415     05  MAINTF PIC  X(0001).
  1416     05  FILLER REDEFINES MAINTF.
  1417         10  MAINTA PIC  X(0001).
  1418     05  MAINTI PIC  X(0001).
  1419*    -------------------------------
  1420     05  CARRL PIC S9(0004) COMP.
  1421     05  CARRF PIC  X(0001).
  1422     05  FILLER REDEFINES CARRF.
  1423         10  CARRA PIC  X(0001).
  1424     05  CARRI PIC  X(0001).
  1425*    -------------------------------
  1426     05  GROUPINL PIC S9(0004) COMP.
  1427     05  GROUPINF PIC  X(0001).
  1428     05  FILLER REDEFINES GROUPINF.
  1429         10  GROUPINA PIC  X(0001).
  1430     05  GROUPINI PIC  X(0006).
  1431*    -------------------------------
  1432     05  STATEL PIC S9(0004) COMP.
  1433     05  STATEF PIC  X(0001).
  1434     05  FILLER REDEFINES STATEF.
  1435         10  STATEA PIC  X(0001).
  1436     05  STATEI PIC  X(0002).
  1437*    -------------------------------
  1438     05  ACCOUNTL PIC S9(0004) COMP.
  1439     05  ACCOUNTF PIC  X(0001).
  1440     05  FILLER REDEFINES ACCOUNTF.
  1441         10  ACCOUNTA PIC  X(0001).
  1442     05  ACCOUNTI PIC  X(0010).
  1443*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6501.cbl
  1444     05  EFFDTEL PIC S9(0004) COMP.
  1445     05  EFFDTEF PIC  X(0001).
  1446     05  FILLER REDEFINES EFFDTEF.
  1447         10  EFFDTEA PIC  X(0001).
  1448     05  EFFDTEI PIC  X(0008).
  1449*    -------------------------------
  1450     05  EXPDTEL PIC S9(0004) COMP.
  1451     05  EXPDTEF PIC  X(0001).
  1452     05  FILLER REDEFINES EXPDTEF.
  1453         10  EXPDTEA PIC  X(0001).
  1454     05  EXPDTEI PIC  X(0008).
  1455*    -------------------------------
  1456     05  MAINTBYL PIC S9(0004) COMP.
  1457     05  MAINTBYF PIC  X(0001).
  1458     05  FILLER REDEFINES MAINTBYF.
  1459         10  MAINTBYA PIC  X(0001).
  1460     05  MAINTBYI PIC  X(0004).
  1461*    -------------------------------
  1462     05  PCONTL PIC S9(0004) COMP.
  1463     05  PCONTF PIC  X(0001).
  1464     05  FILLER REDEFINES PCONTF.
  1465         10  PCONTA PIC  X(0001).
  1466     05  PCONTI PIC  X(0030).
  1467*    -------------------------------
  1468     05  CSRL PIC S9(0004) COMP.
  1469     05  CSRF PIC  X(0001).
  1470     05  FILLER REDEFINES CSRF.
  1471         10  CSRA PIC  X(0001).
  1472     05  CSRI PIC  X(0004).
  1473*    -------------------------------
  1474     05  PDSPLYL PIC S9(0004) COMP.
  1475     05  PDSPLYF PIC  X(0001).
  1476     05  FILLER REDEFINES PDSPLYF.
  1477         10  PDSPLYA PIC  X(0001).
  1478     05  PDSPLYI PIC  X(0006).
  1479*    -------------------------------
  1480     05  PEFFDTEL PIC S9(0004) COMP.
  1481     05  PEFFDTEF PIC  X(0001).
  1482     05  FILLER REDEFINES PEFFDTEF.
  1483         10  PEFFDTEA PIC  X(0001).
  1484     05  PEFFDTEI PIC  X(0008).
  1485*    -------------------------------
  1486     05  PEXPDTEL PIC S9(0004) COMP.
  1487     05  PEXPDTEF PIC  X(0001).
  1488     05  FILLER REDEFINES PEXPDTEF.
  1489         10  PEXPDTEA PIC  X(0001).
  1490     05  PEXPDTEI PIC  X(0008).
  1491*    -------------------------------
  1492     05  NAMEL PIC S9(0004) COMP.
  1493     05  NAMEF PIC  X(0001).
  1494     05  FILLER REDEFINES NAMEF.
  1495         10  NAMEA PIC  X(0001).
  1496     05  NAMEI PIC  X(0030).
  1497*    -------------------------------
  1498     05  TAXNOL PIC S9(0004) COMP.
  1499     05  TAXNOF PIC  X(0001).
  1500     05  FILLER REDEFINES TAXNOF.
  1501         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6501.cbl
  1502     05  TAXNOI PIC  X(0011).
  1503*    -------------------------------
  1504     05  STATUSL PIC S9(0004) COMP.
  1505     05  STATUSF PIC  X(0001).
  1506     05  FILLER REDEFINES STATUSF.
  1507         10  STATUSA PIC  X(0001).
  1508     05  STATUSI PIC  X(0001).
  1509*    -------------------------------
  1510     05  INCAREL PIC S9(0004) COMP.
  1511     05  INCAREF PIC  X(0001).
  1512     05  FILLER REDEFINES INCAREF.
  1513         10  INCAREA PIC  X(0001).
  1514     05  INCAREI PIC  X(0030).
  1515*    -------------------------------
  1516     05  PHONEL PIC S9(0004) COMP.
  1517     05  PHONEF PIC  X(0001).
  1518     05  FILLER REDEFINES PHONEF.
  1519         10  PHONEA PIC  X(0001).
  1520     05  PHONEI PIC  X(0012).
  1521*    -------------------------------
  1522     05  INDGRPL PIC S9(0004) COMP.
  1523     05  INDGRPF PIC  X(0001).
  1524     05  FILLER REDEFINES INDGRPF.
  1525         10  INDGRPA PIC  X(0001).
  1526     05  INDGRPI PIC  X(0001).
  1527*    -------------------------------
  1528     05  ADDR1L PIC S9(0004) COMP.
  1529     05  ADDR1F PIC  X(0001).
  1530     05  FILLER REDEFINES ADDR1F.
  1531         10  ADDR1A PIC  X(0001).
  1532     05  ADDR1I PIC  X(0030).
  1533*    -------------------------------
  1534     05  CONTRL PIC S9(0004) COMP.
  1535     05  CONTRF PIC  X(0001).
  1536     05  FILLER REDEFINES CONTRF.
  1537         10  CONTRA PIC  X(0001).
  1538     05  CONTRI PIC  X(0008).
  1539*    -------------------------------
  1540     05  TYPEL PIC S9(0004) COMP.
  1541     05  TYPEF PIC  X(0001).
  1542     05  FILLER REDEFINES TYPEF.
  1543         10  TYPEA PIC  X(0001).
  1544     05  TYPEI PIC  99.
  1545*    -------------------------------
  1546     05  ACITYL PIC S9(0004) COMP.
  1547     05  ACITYF PIC  X(0001).
  1548     05  FILLER REDEFINES ACITYF.
  1549         10  ACITYA PIC  X(0001).
  1550     05  ACITYI PIC  X(0028).
  1551*    -------------------------------
  1552     05  ASTATEL PIC S9(0004) COMP.
  1553     05  ASTATEF PIC  X(0001).
  1554     05  FILLER REDEFINES ASTATEF.
  1555         10  ASTATEA PIC  X(0001).
  1556     05  ASTATEI PIC  X(0002).
  1557*    -------------------------------
  1558     05  PRODATEL PIC S9(0004) COMP.
  1559     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6501.cbl
  1560     05  FILLER REDEFINES PRODATEF.
  1561         10  PRODATEA PIC  X(0001).
  1562     05  PRODATEI PIC  X(0008).
  1563*    -------------------------------
  1564     05  STDBENL PIC S9(0004) COMP.
  1565     05  STDBENF PIC  X(0001).
  1566     05  FILLER REDEFINES STDBENF.
  1567         10  STDBENA PIC  X(0001).
  1568     05  STDBENI PIC  X(0002).
  1569*    -------------------------------
  1570     05  ZIPL PIC S9(0004) COMP.
  1571     05  ZIPF PIC  X(0001).
  1572     05  FILLER REDEFINES ZIPF.
  1573         10  ZIPA PIC  X(0001).
  1574     05  ZIPI PIC  X(0010).
  1575*    -------------------------------
  1576     05  CTPLABLL PIC S9(0004) COMP.
  1577     05  CTPLABLF PIC  X(0001).
  1578     05  FILLER REDEFINES CTPLABLF.
  1579         10  CTPLABLA PIC  X(0001).
  1580     05  CTPLABLI PIC  X(0010).
  1581*    -------------------------------
  1582     05  CLPTOLPL PIC S9(0004) COMP.
  1583     05  CLPTOLPF PIC  X(0001).
  1584     05  FILLER REDEFINES CLPTOLPF.
  1585         10  CLPTOLPA PIC  X(0001).
  1586     05  CLPTOLPI PIC  S9(02)V9999.
  1587*    -------------------------------
  1588     05  RETROCDL PIC S9(0004) COMP.
  1589     05  RETROCDF PIC  X(0001).
  1590     05  FILLER REDEFINES RETROCDF.
  1591         10  RETROCDA PIC  X(0001).
  1592     05  RETROCDI PIC  X(0003).
  1593*    -------------------------------
  1594     05  BILLCDL PIC S9(0004) COMP.
  1595     05  BILLCDF PIC  X(0001).
  1596     05  FILLER REDEFINES BILLCDF.
  1597         10  BILLCDA PIC  X(0001).
  1598     05  BILLCDI PIC  X(0003).
  1599*    -------------------------------
  1600     05  LCLABLL PIC S9(0004) COMP.
  1601     05  LCLABLF PIC  X(0001).
  1602     05  FILLER REDEFINES LCLABLF.
  1603         10  LCLABLA PIC  X(0001).
  1604     05  LCLABLI PIC  X(0011).
  1605*    -------------------------------
  1606     05  LCOMML PIC S9(0004) COMP.
  1607     05  LCOMMF PIC  X(0001).
  1608     05  FILLER REDEFINES LCOMMF.
  1609         10  LCOMMA PIC  X(0001).
  1610     05  LCOMMI PIC  S9(6)V9(2).
  1611*    -------------------------------
  1612     05  MAXFEEHL PIC S9(0004) COMP.
  1613     05  MAXFEEHF PIC  X(0001).
  1614     05  FILLER REDEFINES MAXFEEHF.
  1615         10  MAXFEEHA PIC  X(0001).
  1616     05  MAXFEEHI PIC  X(0013).
  1617*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6501.cbl
  1618     05  MAXMFEEL PIC S9(0004) COMP.
  1619     05  MAXMFEEF PIC  X(0001).
  1620     05  FILLER REDEFINES MAXMFEEF.
  1621         10  MAXMFEEA PIC  X(0001).
  1622     05  MAXMFEEI PIC  X(0005).
  1623*    -------------------------------
  1624     05  CLPSTHL PIC S9(0004) COMP.
  1625     05  CLPSTHF PIC  X(0001).
  1626     05  FILLER REDEFINES CLPSTHF.
  1627         10  CLPSTHA PIC  X(0001).
  1628     05  CLPSTHI PIC  X(0010).
  1629*    -------------------------------
  1630     05  CLPSTL PIC S9(0004) COMP.
  1631     05  CLPSTF PIC  X(0001).
  1632     05  FILLER REDEFINES CLPSTF.
  1633         10  CLPSTA PIC  X(0001).
  1634     05  CLPSTI PIC  X(0002).
  1635*    -------------------------------
  1636     05  PRODCDHL PIC S9(0004) COMP.
  1637     05  PRODCDHF PIC  X(0001).
  1638     05  FILLER REDEFINES PRODCDHF.
  1639         10  PRODCDHA PIC  X(0001).
  1640     05  PRODCDHI PIC  X(0012).
  1641*    -------------------------------
  1642     05  PRODCDL PIC S9(0004) COMP.
  1643     05  PRODCDF PIC  X(0001).
  1644     05  FILLER REDEFINES PRODCDF.
  1645         10  PRODCDA PIC  X(0001).
  1646     05  PRODCDI PIC  X(0003).
  1647*    -------------------------------
  1648     05  REMITL PIC S9(0004) COMP.
  1649     05  REMITF PIC  X(0001).
  1650     05  FILLER REDEFINES REMITF.
  1651         10  REMITA PIC  X(0001).
  1652     05  REMITI PIC  99.
  1653*    -------------------------------
  1654     05  COMMCALL PIC S9(0004) COMP.
  1655     05  COMMCALF PIC  X(0001).
  1656     05  FILLER REDEFINES COMMCALF.
  1657         10  COMMCALA PIC  X(0001).
  1658     05  COMMCALI PIC  X(0001).
  1659*    -------------------------------
  1660     05  REINTABL PIC S9(0004) COMP.
  1661     05  REINTABF PIC  X(0001).
  1662     05  FILLER REDEFINES REINTABF.
  1663         10  REINTABA PIC  X(0001).
  1664     05  REINTABI PIC  X(0003).
  1665*    -------------------------------
  1666     05  REINCALL PIC S9(0004) COMP.
  1667     05  REINCALF PIC  X(0001).
  1668     05  FILLER REDEFINES REINCALF.
  1669         10  REINCALA PIC  X(0001).
  1670     05  REINCALI PIC  X(0001).
  1671*    -------------------------------
  1672     05  AHHEADL PIC S9(0004) COMP.
  1673     05  AHHEADF PIC  X(0001).
  1674     05  FILLER REDEFINES AHHEADF.
  1675         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6501.cbl
  1676     05  AHHEADI PIC  X(0006).
  1677*    -------------------------------
  1678     05  AGNT1L PIC S9(0004) COMP.
  1679     05  AGNT1F PIC  X(0001).
  1680     05  FILLER REDEFINES AGNT1F.
  1681         10  AGNT1A PIC  X(0001).
  1682     05  AGNT1I PIC  X(0010).
  1683*    -------------------------------
  1684     05  TYPE1L PIC S9(0004) COMP.
  1685     05  TYPE1F PIC  X(0001).
  1686     05  FILLER REDEFINES TYPE1F.
  1687         10  TYPE1A PIC  X(0001).
  1688     05  TYPE1I PIC  X(0001).
  1689*    -------------------------------
  1690     05  SINRT1L PIC S9(0004) COMP.
  1691     05  SINRT1F PIC  X(0001).
  1692     05  FILLER REDEFINES SINRT1F.
  1693         10  SINRT1A PIC  X(0001).
  1694     05  SINRT1I PIC  X(0006).
  1695*    -------------------------------
  1696     05  JNTRT1L PIC S9(0004) COMP.
  1697     05  JNTRT1F PIC  X(0001).
  1698     05  FILLER REDEFINES JNTRT1F.
  1699         10  JNTRT1A PIC  X(0001).
  1700     05  JNTRT1I PIC  X(0006).
  1701*    -------------------------------
  1702     05  AHRT1L PIC S9(0004) COMP.
  1703     05  AHRT1F PIC  X(0001).
  1704     05  FILLER REDEFINES AHRT1F.
  1705         10  AHRT1A PIC  X(0001).
  1706     05  AHRT1I PIC  X(0006).
  1707*    -------------------------------
  1708     05  RECAL1L PIC S9(0004) COMP.
  1709     05  RECAL1F PIC  X(0001).
  1710     05  FILLER REDEFINES RECAL1F.
  1711         10  RECAL1A PIC  X(0001).
  1712     05  RECAL1I PIC  X(0001).
  1713*    -------------------------------
  1714     05  COMM1L PIC S9(0004) COMP.
  1715     05  COMM1F PIC  X(0001).
  1716     05  FILLER REDEFINES COMM1F.
  1717         10  COMM1A PIC  X(0001).
  1718     05  COMM1I PIC  X(0001).
  1719*    -------------------------------
  1720     05  CHGBK1L PIC S9(0004) COMP.
  1721     05  CHGBK1F PIC  X(0001).
  1722     05  FILLER REDEFINES CHGBK1F.
  1723         10  CHGBK1A PIC  X(0001).
  1724     05  CHGBK1I PIC  X(0002).
  1725*    -------------------------------
  1726     05  GLCDE1L PIC S9(0004) COMP.
  1727     05  GLCDE1F PIC  X(0001).
  1728     05  FILLER REDEFINES GLCDE1F.
  1729         10  GLCDE1A PIC  X(0001).
  1730     05  GLCDE1I PIC  X(0001).
  1731*    -------------------------------
  1732     05  AGNT2L PIC S9(0004) COMP.
  1733     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6501.cbl
  1734     05  FILLER REDEFINES AGNT2F.
  1735         10  AGNT2A PIC  X(0001).
  1736     05  AGNT2I PIC  X(0010).
  1737*    -------------------------------
  1738     05  TYPE2L PIC S9(0004) COMP.
  1739     05  TYPE2F PIC  X(0001).
  1740     05  FILLER REDEFINES TYPE2F.
  1741         10  TYPE2A PIC  X(0001).
  1742     05  TYPE2I PIC  X(0001).
  1743*    -------------------------------
  1744     05  SINRT2L PIC S9(0004) COMP.
  1745     05  SINRT2F PIC  X(0001).
  1746     05  FILLER REDEFINES SINRT2F.
  1747         10  SINRT2A PIC  X(0001).
  1748     05  SINRT2I PIC  X(0006).
  1749*    -------------------------------
  1750     05  JNTRT2L PIC S9(0004) COMP.
  1751     05  JNTRT2F PIC  X(0001).
  1752     05  FILLER REDEFINES JNTRT2F.
  1753         10  JNTRT2A PIC  X(0001).
  1754     05  JNTRT2I PIC  X(0006).
  1755*    -------------------------------
  1756     05  AHRT2L PIC S9(0004) COMP.
  1757     05  AHRT2F PIC  X(0001).
  1758     05  FILLER REDEFINES AHRT2F.
  1759         10  AHRT2A PIC  X(0001).
  1760     05  AHRT2I PIC  X(0006).
  1761*    -------------------------------
  1762     05  RECAL2L PIC S9(0004) COMP.
  1763     05  RECAL2F PIC  X(0001).
  1764     05  FILLER REDEFINES RECAL2F.
  1765         10  RECAL2A PIC  X(0001).
  1766     05  RECAL2I PIC  X(0001).
  1767*    -------------------------------
  1768     05  COMM2L PIC S9(0004) COMP.
  1769     05  COMM2F PIC  X(0001).
  1770     05  FILLER REDEFINES COMM2F.
  1771         10  COMM2A PIC  X(0001).
  1772     05  COMM2I PIC  X(0001).
  1773*    -------------------------------
  1774     05  CHGBK2L PIC S9(0004) COMP.
  1775     05  CHGBK2F PIC  X(0001).
  1776     05  FILLER REDEFINES CHGBK2F.
  1777         10  CHGBK2A PIC  X(0001).
  1778     05  CHGBK2I PIC  X(0002).
  1779*    -------------------------------
  1780     05  GLCDE2L PIC S9(0004) COMP.
  1781     05  GLCDE2F PIC  X(0001).
  1782     05  FILLER REDEFINES GLCDE2F.
  1783         10  GLCDE2A PIC  X(0001).
  1784     05  GLCDE2I PIC  X(0001).
  1785*    -------------------------------
  1786     05  AGNT3L PIC S9(0004) COMP.
  1787     05  AGNT3F PIC  X(0001).
  1788     05  FILLER REDEFINES AGNT3F.
  1789         10  AGNT3A PIC  X(0001).
  1790     05  AGNT3I PIC  X(0010).
  1791*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6501.cbl
  1792     05  TYPE3L PIC S9(0004) COMP.
  1793     05  TYPE3F PIC  X(0001).
  1794     05  FILLER REDEFINES TYPE3F.
  1795         10  TYPE3A PIC  X(0001).
  1796     05  TYPE3I PIC  X(0001).
  1797*    -------------------------------
  1798     05  SINRT3L PIC S9(0004) COMP.
  1799     05  SINRT3F PIC  X(0001).
  1800     05  FILLER REDEFINES SINRT3F.
  1801         10  SINRT3A PIC  X(0001).
  1802     05  SINRT3I PIC  X(0006).
  1803*    -------------------------------
  1804     05  JNTRT3L PIC S9(0004) COMP.
  1805     05  JNTRT3F PIC  X(0001).
  1806     05  FILLER REDEFINES JNTRT3F.
  1807         10  JNTRT3A PIC  X(0001).
  1808     05  JNTRT3I PIC  X(0006).
  1809*    -------------------------------
  1810     05  AHRT3L PIC S9(0004) COMP.
  1811     05  AHRT3F PIC  X(0001).
  1812     05  FILLER REDEFINES AHRT3F.
  1813         10  AHRT3A PIC  X(0001).
  1814     05  AHRT3I PIC  X(0006).
  1815*    -------------------------------
  1816     05  RECAL3L PIC S9(0004) COMP.
  1817     05  RECAL3F PIC  X(0001).
  1818     05  FILLER REDEFINES RECAL3F.
  1819         10  RECAL3A PIC  X(0001).
  1820     05  RECAL3I PIC  X(0001).
  1821*    -------------------------------
  1822     05  COMM3L PIC S9(0004) COMP.
  1823     05  COMM3F PIC  X(0001).
  1824     05  FILLER REDEFINES COMM3F.
  1825         10  COMM3A PIC  X(0001).
  1826     05  COMM3I PIC  X(0001).
  1827*    -------------------------------
  1828     05  CHGBK3L PIC S9(0004) COMP.
  1829     05  CHGBK3F PIC  X(0001).
  1830     05  FILLER REDEFINES CHGBK3F.
  1831         10  CHGBK3A PIC  X(0001).
  1832     05  CHGBK3I PIC  X(0002).
  1833*    -------------------------------
  1834     05  GLCDE3L PIC S9(0004) COMP.
  1835     05  GLCDE3F PIC  X(0001).
  1836     05  FILLER REDEFINES GLCDE3F.
  1837         10  GLCDE3A PIC  X(0001).
  1838     05  GLCDE3I PIC  X(0001).
  1839*    -------------------------------
  1840     05  AGNT4L PIC S9(0004) COMP.
  1841     05  AGNT4F PIC  X(0001).
  1842     05  FILLER REDEFINES AGNT4F.
  1843         10  AGNT4A PIC  X(0001).
  1844     05  AGNT4I PIC  X(0010).
  1845*    -------------------------------
  1846     05  TYPE4L PIC S9(0004) COMP.
  1847     05  TYPE4F PIC  X(0001).
  1848     05  FILLER REDEFINES TYPE4F.
  1849         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6501.cbl
  1850     05  TYPE4I PIC  X(0001).
  1851*    -------------------------------
  1852     05  SINRT4L PIC S9(0004) COMP.
  1853     05  SINRT4F PIC  X(0001).
  1854     05  FILLER REDEFINES SINRT4F.
  1855         10  SINRT4A PIC  X(0001).
  1856     05  SINRT4I PIC  X(0006).
  1857*    -------------------------------
  1858     05  JNTRT4L PIC S9(0004) COMP.
  1859     05  JNTRT4F PIC  X(0001).
  1860     05  FILLER REDEFINES JNTRT4F.
  1861         10  JNTRT4A PIC  X(0001).
  1862     05  JNTRT4I PIC  X(0006).
  1863*    -------------------------------
  1864     05  AHRT4L PIC S9(0004) COMP.
  1865     05  AHRT4F PIC  X(0001).
  1866     05  FILLER REDEFINES AHRT4F.
  1867         10  AHRT4A PIC  X(0001).
  1868     05  AHRT4I PIC  X(0006).
  1869*    -------------------------------
  1870     05  RECAL4L PIC S9(0004) COMP.
  1871     05  RECAL4F PIC  X(0001).
  1872     05  FILLER REDEFINES RECAL4F.
  1873         10  RECAL4A PIC  X(0001).
  1874     05  RECAL4I PIC  X(0001).
  1875*    -------------------------------
  1876     05  COMM4L PIC S9(0004) COMP.
  1877     05  COMM4F PIC  X(0001).
  1878     05  FILLER REDEFINES COMM4F.
  1879         10  COMM4A PIC  X(0001).
  1880     05  COMM4I PIC  X(0001).
  1881*    -------------------------------
  1882     05  CHGBK4L PIC S9(0004) COMP.
  1883     05  CHGBK4F PIC  X(0001).
  1884     05  FILLER REDEFINES CHGBK4F.
  1885         10  CHGBK4A PIC  X(0001).
  1886     05  CHGBK4I PIC  X(0002).
  1887*    -------------------------------
  1888     05  GLCDE4L PIC S9(0004) COMP.
  1889     05  GLCDE4F PIC  X(0001).
  1890     05  FILLER REDEFINES GLCDE4F.
  1891         10  GLCDE4A PIC  X(0001).
  1892     05  GLCDE4I PIC  X(0001).
  1893*    -------------------------------
  1894     05  AGNT5L PIC S9(0004) COMP.
  1895     05  AGNT5F PIC  X(0001).
  1896     05  FILLER REDEFINES AGNT5F.
  1897         10  AGNT5A PIC  X(0001).
  1898     05  AGNT5I PIC  X(0010).
  1899*    -------------------------------
  1900     05  TYPE5L PIC S9(0004) COMP.
  1901     05  TYPE5F PIC  X(0001).
  1902     05  FILLER REDEFINES TYPE5F.
  1903         10  TYPE5A PIC  X(0001).
  1904     05  TYPE5I PIC  X(0001).
  1905*    -------------------------------
  1906     05  SINRT5L PIC S9(0004) COMP.
  1907     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6501.cbl
  1908     05  FILLER REDEFINES SINRT5F.
  1909         10  SINRT5A PIC  X(0001).
  1910     05  SINRT5I PIC  X(0006).
  1911*    -------------------------------
  1912     05  JNTRT5L PIC S9(0004) COMP.
  1913     05  JNTRT5F PIC  X(0001).
  1914     05  FILLER REDEFINES JNTRT5F.
  1915         10  JNTRT5A PIC  X(0001).
  1916     05  JNTRT5I PIC  X(0006).
  1917*    -------------------------------
  1918     05  AHRT5L PIC S9(0004) COMP.
  1919     05  AHRT5F PIC  X(0001).
  1920     05  FILLER REDEFINES AHRT5F.
  1921         10  AHRT5A PIC  X(0001).
  1922     05  AHRT5I PIC  X(0006).
  1923*    -------------------------------
  1924     05  RECAL5L PIC S9(0004) COMP.
  1925     05  RECAL5F PIC  X(0001).
  1926     05  FILLER REDEFINES RECAL5F.
  1927         10  RECAL5A PIC  X(0001).
  1928     05  RECAL5I PIC  X(0001).
  1929*    -------------------------------
  1930     05  COMM5L PIC S9(0004) COMP.
  1931     05  COMM5F PIC  X(0001).
  1932     05  FILLER REDEFINES COMM5F.
  1933         10  COMM5A PIC  X(0001).
  1934     05  COMM5I PIC  X(0001).
  1935*    -------------------------------
  1936     05  CHGBK5L PIC S9(0004) COMP.
  1937     05  CHGBK5F PIC  X(0001).
  1938     05  FILLER REDEFINES CHGBK5F.
  1939         10  CHGBK5A PIC  X(0001).
  1940     05  CHGBK5I PIC  X(0002).
  1941*    -------------------------------
  1942     05  GLCDE5L PIC S9(0004) COMP.
  1943     05  GLCDE5F PIC  X(0001).
  1944     05  FILLER REDEFINES GLCDE5F.
  1945         10  GLCDE5A PIC  X(0001).
  1946     05  GLCDE5I PIC  X(0001).
  1947*    -------------------------------
  1948     05  AGNT6L PIC S9(0004) COMP.
  1949     05  AGNT6F PIC  X(0001).
  1950     05  FILLER REDEFINES AGNT6F.
  1951         10  AGNT6A PIC  X(0001).
  1952     05  AGNT6I PIC  X(0010).
  1953*    -------------------------------
  1954     05  TYPE6L PIC S9(0004) COMP.
  1955     05  TYPE6F PIC  X(0001).
  1956     05  FILLER REDEFINES TYPE6F.
  1957         10  TYPE6A PIC  X(0001).
  1958     05  TYPE6I PIC  X(0001).
  1959*    -------------------------------
  1960     05  SINRT6L PIC S9(0004) COMP.
  1961     05  SINRT6F PIC  X(0001).
  1962     05  FILLER REDEFINES SINRT6F.
  1963         10  SINRT6A PIC  X(0001).
  1964     05  SINRT6I PIC  X(0006).
  1965*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6501.cbl
  1966     05  JNTRT6L PIC S9(0004) COMP.
  1967     05  JNTRT6F PIC  X(0001).
  1968     05  FILLER REDEFINES JNTRT6F.
  1969         10  JNTRT6A PIC  X(0001).
  1970     05  JNTRT6I PIC  X(0006).
  1971*    -------------------------------
  1972     05  AHRT6L PIC S9(0004) COMP.
  1973     05  AHRT6F PIC  X(0001).
  1974     05  FILLER REDEFINES AHRT6F.
  1975         10  AHRT6A PIC  X(0001).
  1976     05  AHRT6I PIC  X(0006).
  1977*    -------------------------------
  1978     05  RECAL6L PIC S9(0004) COMP.
  1979     05  RECAL6F PIC  X(0001).
  1980     05  FILLER REDEFINES RECAL6F.
  1981         10  RECAL6A PIC  X(0001).
  1982     05  RECAL6I PIC  X(0001).
  1983*    -------------------------------
  1984     05  COMM6L PIC S9(0004) COMP.
  1985     05  COMM6F PIC  X(0001).
  1986     05  FILLER REDEFINES COMM6F.
  1987         10  COMM6A PIC  X(0001).
  1988     05  COMM6I PIC  X(0001).
  1989*    -------------------------------
  1990     05  CHGBK6L PIC S9(0004) COMP.
  1991     05  CHGBK6F PIC  X(0001).
  1992     05  FILLER REDEFINES CHGBK6F.
  1993         10  CHGBK6A PIC  X(0001).
  1994     05  CHGBK6I PIC  X(0002).
  1995*    -------------------------------
  1996     05  GLCDE6L PIC S9(0004) COMP.
  1997     05  GLCDE6F PIC  X(0001).
  1998     05  FILLER REDEFINES GLCDE6F.
  1999         10  GLCDE6A PIC  X(0001).
  2000     05  GLCDE6I PIC  X(0001).
  2001*    -------------------------------
  2002     05  AGNT7L PIC S9(0004) COMP.
  2003     05  AGNT7F PIC  X(0001).
  2004     05  FILLER REDEFINES AGNT7F.
  2005         10  AGNT7A PIC  X(0001).
  2006     05  AGNT7I PIC  X(0010).
  2007*    -------------------------------
  2008     05  TYPE7L PIC S9(0004) COMP.
  2009     05  TYPE7F PIC  X(0001).
  2010     05  FILLER REDEFINES TYPE7F.
  2011         10  TYPE7A PIC  X(0001).
  2012     05  TYPE7I PIC  X(0001).
  2013*    -------------------------------
  2014     05  SINRT7L PIC S9(0004) COMP.
  2015     05  SINRT7F PIC  X(0001).
  2016     05  FILLER REDEFINES SINRT7F.
  2017         10  SINRT7A PIC  X(0001).
  2018     05  SINRT7I PIC  X(0006).
  2019*    -------------------------------
  2020     05  JNTRT7L PIC S9(0004) COMP.
  2021     05  JNTRT7F PIC  X(0001).
  2022     05  FILLER REDEFINES JNTRT7F.
  2023         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6501.cbl
  2024     05  JNTRT7I PIC  X(0006).
  2025*    -------------------------------
  2026     05  AHRT7L PIC S9(0004) COMP.
  2027     05  AHRT7F PIC  X(0001).
  2028     05  FILLER REDEFINES AHRT7F.
  2029         10  AHRT7A PIC  X(0001).
  2030     05  AHRT7I PIC  X(0006).
  2031*    -------------------------------
  2032     05  RECAL7L PIC S9(0004) COMP.
  2033     05  RECAL7F PIC  X(0001).
  2034     05  FILLER REDEFINES RECAL7F.
  2035         10  RECAL7A PIC  X(0001).
  2036     05  RECAL7I PIC  X(0001).
  2037*    -------------------------------
  2038     05  COMM7L PIC S9(0004) COMP.
  2039     05  COMM7F PIC  X(0001).
  2040     05  FILLER REDEFINES COMM7F.
  2041         10  COMM7A PIC  X(0001).
  2042     05  COMM7I PIC  X(0001).
  2043*    -------------------------------
  2044     05  CHGBK7L PIC S9(0004) COMP.
  2045     05  CHGBK7F PIC  X(0001).
  2046     05  FILLER REDEFINES CHGBK7F.
  2047         10  CHGBK7A PIC  X(0001).
  2048     05  CHGBK7I PIC  X(0002).
  2049*    -------------------------------
  2050     05  GLCDE7L PIC S9(0004) COMP.
  2051     05  GLCDE7F PIC  X(0001).
  2052     05  FILLER REDEFINES GLCDE7F.
  2053         10  GLCDE7A PIC  X(0001).
  2054     05  GLCDE7I PIC  X(0001).
  2055*    -------------------------------
  2056     05  AGNT8L PIC S9(0004) COMP.
  2057     05  AGNT8F PIC  X(0001).
  2058     05  FILLER REDEFINES AGNT8F.
  2059         10  AGNT8A PIC  X(0001).
  2060     05  AGNT8I PIC  X(0010).
  2061*    -------------------------------
  2062     05  TYPE8L PIC S9(0004) COMP.
  2063     05  TYPE8F PIC  X(0001).
  2064     05  FILLER REDEFINES TYPE8F.
  2065         10  TYPE8A PIC  X(0001).
  2066     05  TYPE8I PIC  X(0001).
  2067*    -------------------------------
  2068     05  SINRT8L PIC S9(0004) COMP.
  2069     05  SINRT8F PIC  X(0001).
  2070     05  FILLER REDEFINES SINRT8F.
  2071         10  SINRT8A PIC  X(0001).
  2072     05  SINRT8I PIC  X(0006).
  2073*    -------------------------------
  2074     05  JNTRT8L PIC S9(0004) COMP.
  2075     05  JNTRT8F PIC  X(0001).
  2076     05  FILLER REDEFINES JNTRT8F.
  2077         10  JNTRT8A PIC  X(0001).
  2078     05  JNTRT8I PIC  X(0006).
  2079*    -------------------------------
  2080     05  AHRT8L PIC S9(0004) COMP.
  2081     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6501.cbl
  2082     05  FILLER REDEFINES AHRT8F.
  2083         10  AHRT8A PIC  X(0001).
  2084     05  AHRT8I PIC  X(0006).
  2085*    -------------------------------
  2086     05  RECAL8L PIC S9(0004) COMP.
  2087     05  RECAL8F PIC  X(0001).
  2088     05  FILLER REDEFINES RECAL8F.
  2089         10  RECAL8A PIC  X(0001).
  2090     05  RECAL8I PIC  X(0001).
  2091*    -------------------------------
  2092     05  COMM8L PIC S9(0004) COMP.
  2093     05  COMM8F PIC  X(0001).
  2094     05  FILLER REDEFINES COMM8F.
  2095         10  COMM8A PIC  X(0001).
  2096     05  COMM8I PIC  X(0001).
  2097*    -------------------------------
  2098     05  CHGBK8L PIC S9(0004) COMP.
  2099     05  CHGBK8F PIC  X(0001).
  2100     05  FILLER REDEFINES CHGBK8F.
  2101         10  CHGBK8A PIC  X(0001).
  2102     05  CHGBK8I PIC  X(0002).
  2103*    -------------------------------
  2104     05  GLCDE8L PIC S9(0004) COMP.
  2105     05  GLCDE8F PIC  X(0001).
  2106     05  FILLER REDEFINES GLCDE8F.
  2107         10  GLCDE8A PIC  X(0001).
  2108     05  GLCDE8I PIC  X(0001).
  2109*    -------------------------------
  2110     05  AGNT9L PIC S9(0004) COMP.
  2111     05  AGNT9F PIC  X(0001).
  2112     05  FILLER REDEFINES AGNT9F.
  2113         10  AGNT9A PIC  X(0001).
  2114     05  AGNT9I PIC  X(0010).
  2115*    -------------------------------
  2116     05  TYPE9L PIC S9(0004) COMP.
  2117     05  TYPE9F PIC  X(0001).
  2118     05  FILLER REDEFINES TYPE9F.
  2119         10  TYPE9A PIC  X(0001).
  2120     05  TYPE9I PIC  X(0001).
  2121*    -------------------------------
  2122     05  SINRT9L PIC S9(0004) COMP.
  2123     05  SINRT9F PIC  X(0001).
  2124     05  FILLER REDEFINES SINRT9F.
  2125         10  SINRT9A PIC  X(0001).
  2126     05  SINRT9I PIC  X(0006).
  2127*    -------------------------------
  2128     05  JNTRT9L PIC S9(0004) COMP.
  2129     05  JNTRT9F PIC  X(0001).
  2130     05  FILLER REDEFINES JNTRT9F.
  2131         10  JNTRT9A PIC  X(0001).
  2132     05  JNTRT9I PIC  X(0006).
  2133*    -------------------------------
  2134     05  AHRT9L PIC S9(0004) COMP.
  2135     05  AHRT9F PIC  X(0001).
  2136     05  FILLER REDEFINES AHRT9F.
  2137         10  AHRT9A PIC  X(0001).
  2138     05  AHRT9I PIC  X(0006).
  2139*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6501.cbl
  2140     05  RECAL9L PIC S9(0004) COMP.
  2141     05  RECAL9F PIC  X(0001).
  2142     05  FILLER REDEFINES RECAL9F.
  2143         10  RECAL9A PIC  X(0001).
  2144     05  RECAL9I PIC  X(0001).
  2145*    -------------------------------
  2146     05  COMM9L PIC S9(0004) COMP.
  2147     05  COMM9F PIC  X(0001).
  2148     05  FILLER REDEFINES COMM9F.
  2149         10  COMM9A PIC  X(0001).
  2150     05  COMM9I PIC  X(0001).
  2151*    -------------------------------
  2152     05  CHGBK9L PIC S9(0004) COMP.
  2153     05  CHGBK9F PIC  X(0001).
  2154     05  FILLER REDEFINES CHGBK9F.
  2155         10  CHGBK9A PIC  X(0001).
  2156     05  CHGBK9I PIC  X(0002).
  2157*    -------------------------------
  2158     05  GLCDE9L PIC S9(0004) COMP.
  2159     05  GLCDE9F PIC  X(0001).
  2160     05  FILLER REDEFINES GLCDE9F.
  2161         10  GLCDE9A PIC  X(0001).
  2162     05  GLCDE9I PIC  X(0001).
  2163*    -------------------------------
  2164     05  AGNT10L PIC S9(0004) COMP.
  2165     05  AGNT10F PIC  X(0001).
  2166     05  FILLER REDEFINES AGNT10F.
  2167         10  AGNT10A PIC  X(0001).
  2168     05  AGNT10I PIC  X(0010).
  2169*    -------------------------------
  2170     05  TYPE10L PIC S9(0004) COMP.
  2171     05  TYPE10F PIC  X(0001).
  2172     05  FILLER REDEFINES TYPE10F.
  2173         10  TYPE10A PIC  X(0001).
  2174     05  TYPE10I PIC  X(0001).
  2175*    -------------------------------
  2176     05  SINRT10L PIC S9(0004) COMP.
  2177     05  SINRT10F PIC  X(0001).
  2178     05  FILLER REDEFINES SINRT10F.
  2179         10  SINRT10A PIC  X(0001).
  2180     05  SINRT10I PIC  X(0006).
  2181*    -------------------------------
  2182     05  JNTRT10L PIC S9(0004) COMP.
  2183     05  JNTRT10F PIC  X(0001).
  2184     05  FILLER REDEFINES JNTRT10F.
  2185         10  JNTRT10A PIC  X(0001).
  2186     05  JNTRT10I PIC  X(0006).
  2187*    -------------------------------
  2188     05  AHRT10L PIC S9(0004) COMP.
  2189     05  AHRT10F PIC  X(0001).
  2190     05  FILLER REDEFINES AHRT10F.
  2191         10  AHRT10A PIC  X(0001).
  2192     05  AHRT10I PIC  X(0006).
  2193*    -------------------------------
  2194     05  RECAL10L PIC S9(0004) COMP.
  2195     05  RECAL10F PIC  X(0001).
  2196     05  FILLER REDEFINES RECAL10F.
  2197         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6501.cbl
  2198     05  RECAL10I PIC  X(0001).
  2199*    -------------------------------
  2200     05  COMM10L PIC S9(0004) COMP.
  2201     05  COMM10F PIC  X(0001).
  2202     05  FILLER REDEFINES COMM10F.
  2203         10  COMM10A PIC  X(0001).
  2204     05  COMM10I PIC  X(0001).
  2205*    -------------------------------
  2206     05  CHGBK10L PIC S9(0004) COMP.
  2207     05  CHGBK10F PIC  X(0001).
  2208     05  FILLER REDEFINES CHGBK10F.
  2209         10  CHGBK10A PIC  X(0001).
  2210     05  CHGBK10I PIC  X(0002).
  2211*    -------------------------------
  2212     05  GLCDE10L PIC S9(0004) COMP.
  2213     05  GLCDE10F PIC  X(0001).
  2214     05  FILLER REDEFINES GLCDE10F.
  2215         10  GLCDE10A PIC  X(0001).
  2216     05  GLCDE10I PIC  X(0001).
  2217*    -------------------------------
  2218     05  ERRMSG1L PIC S9(0004) COMP.
  2219     05  ERRMSG1F PIC  X(0001).
  2220     05  FILLER REDEFINES ERRMSG1F.
  2221         10  ERRMSG1A PIC  X(0001).
  2222     05  ERRMSG1I PIC  X(0075).
  2223*    -------------------------------
  2224     05  PFENTERL PIC S9(0004) COMP.
  2225     05  PFENTERF PIC  X(0001).
  2226     05  FILLER REDEFINES PFENTERF.
  2227         10  PFENTERA PIC  X(0001).
  2228     05  PFENTERI PIC  9(2).
  2229*    -------------------------------
  2230     05  PF1PF2L PIC S9(0004) COMP.
  2231     05  PF1PF2F PIC  X(0001).
  2232     05  FILLER REDEFINES PF1PF2F.
  2233         10  PF1PF2A PIC  X(0001).
  2234     05  PF1PF2I PIC  X(0035).
  2235 01  EL6501AO REDEFINES EL6501AI.
  2236     05  FILLER            PIC  X(0012).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  DATEO PIC  X(0008).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  TIMEO PIC  99.99.
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  CMPNYIDO PIC  X(0003).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  USERIDO PIC  X(0004).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  MAINTO PIC  X(0001).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  CARRO PIC  X(0001).
  2255*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6501.cbl
  2256     05  FILLER            PIC  X(0003).
  2257     05  GROUPINO PIC  X(0006).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  STATEO PIC  X(0002).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  ACCOUNTO PIC  X(0010).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  EFFDTEO PIC  X(0008).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  EXPDTEO PIC  99B99B99.
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  MAINTBYO PIC  X(0004).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  PCONTO PIC  X(0030).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  CSRO PIC  X(0004).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  PDSPLYO PIC  X(0006).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  PEFFDTEO PIC  X(0008).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  PEXPDTEO PIC  X(0008).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  NAMEO PIC  X(0030).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  TAXNOO PIC  X(0011).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  STATUSO PIC  X(0001).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  INCAREO PIC  X(0030).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  PHONEO PIC  999B999B9999.
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  INDGRPO PIC  X(0001).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  ADDR1O PIC  X(0030).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  CONTRO PIC  X(0008).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6501.cbl
  2314     05  TYPEO PIC  X(0002).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  ACITYO PIC  X(0028).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  ASTATEO PIC  X(0002).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  PRODATEO PIC  X(0008).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  STDBENO PIC  X(0002).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  ZIPO PIC  X(0010).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  CTPLABLO PIC  X(0010).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  CLPTOLPO PIC  Z.9999.
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  RETROCDO PIC  X(0003).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  BILLCDO PIC  X(0003).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  LCLABLO PIC  X(0011).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  LCOMMO PIC  ZZ99.99-.
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  MAXFEEHO PIC  X(0013).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  MAXMFEEO PIC  Z,Z99.
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  CLPSTHO PIC  X(0010).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  CLPSTO PIC  X(0002).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  PRODCDHO PIC  X(0012).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  PRODCDO PIC  X(0003).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  REMITO PIC  X(0002).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6501.cbl
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  REINTABO PIC  X(0003).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  REINCALO PIC  X(0001).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  AHHEADO PIC  X(0006).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  AGNT1O PIC  X(0010).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  TYPE1O PIC  X(0001).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  SINRT1O PIC  X(0006).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  JNTRT1O PIC  X(0006).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  AHRT1O PIC  X(0006).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  RECAL1O PIC  X(0001).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  COMM1O PIC  X(0001).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  CHGBK1O PIC  X(0002).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  GLCDE1O PIC  X(0001).
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  AGNT2O PIC  X(0010).
  2411*    -------------------------------
  2412     05  FILLER            PIC  X(0003).
  2413     05  TYPE2O PIC  X(0001).
  2414*    -------------------------------
  2415     05  FILLER            PIC  X(0003).
  2416     05  SINRT2O PIC  X(0006).
  2417*    -------------------------------
  2418     05  FILLER            PIC  X(0003).
  2419     05  JNTRT2O PIC  X(0006).
  2420*    -------------------------------
  2421     05  FILLER            PIC  X(0003).
  2422     05  AHRT2O PIC  X(0006).
  2423*    -------------------------------
  2424     05  FILLER            PIC  X(0003).
  2425     05  RECAL2O PIC  X(0001).
  2426*    -------------------------------
  2427     05  FILLER            PIC  X(0003).
  2428     05  COMM2O PIC  X(0001).
  2429*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6501.cbl
  2430     05  FILLER            PIC  X(0003).
  2431     05  CHGBK2O PIC  X(0002).
  2432*    -------------------------------
  2433     05  FILLER            PIC  X(0003).
  2434     05  GLCDE2O PIC  X(0001).
  2435*    -------------------------------
  2436     05  FILLER            PIC  X(0003).
  2437     05  AGNT3O PIC  X(0010).
  2438*    -------------------------------
  2439     05  FILLER            PIC  X(0003).
  2440     05  TYPE3O PIC  X(0001).
  2441*    -------------------------------
  2442     05  FILLER            PIC  X(0003).
  2443     05  SINRT3O PIC  X(0006).
  2444*    -------------------------------
  2445     05  FILLER            PIC  X(0003).
  2446     05  JNTRT3O PIC  X(0006).
  2447*    -------------------------------
  2448     05  FILLER            PIC  X(0003).
  2449     05  AHRT3O PIC  X(0006).
  2450*    -------------------------------
  2451     05  FILLER            PIC  X(0003).
  2452     05  RECAL3O PIC  X(0001).
  2453*    -------------------------------
  2454     05  FILLER            PIC  X(0003).
  2455     05  COMM3O PIC  X(0001).
  2456*    -------------------------------
  2457     05  FILLER            PIC  X(0003).
  2458     05  CHGBK3O PIC  X(0002).
  2459*    -------------------------------
  2460     05  FILLER            PIC  X(0003).
  2461     05  GLCDE3O PIC  X(0001).
  2462*    -------------------------------
  2463     05  FILLER            PIC  X(0003).
  2464     05  AGNT4O PIC  X(0010).
  2465*    -------------------------------
  2466     05  FILLER            PIC  X(0003).
  2467     05  TYPE4O PIC  X(0001).
  2468*    -------------------------------
  2469     05  FILLER            PIC  X(0003).
  2470     05  SINRT4O PIC  X(0006).
  2471*    -------------------------------
  2472     05  FILLER            PIC  X(0003).
  2473     05  JNTRT4O PIC  X(0006).
  2474*    -------------------------------
  2475     05  FILLER            PIC  X(0003).
  2476     05  AHRT4O PIC  X(0006).
  2477*    -------------------------------
  2478     05  FILLER            PIC  X(0003).
  2479     05  RECAL4O PIC  X(0001).
  2480*    -------------------------------
  2481     05  FILLER            PIC  X(0003).
  2482     05  COMM4O PIC  X(0001).
  2483*    -------------------------------
  2484     05  FILLER            PIC  X(0003).
  2485     05  CHGBK4O PIC  X(0002).
  2486*    -------------------------------
  2487     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6501.cbl
  2488     05  GLCDE4O PIC  X(0001).
  2489*    -------------------------------
  2490     05  FILLER            PIC  X(0003).
  2491     05  AGNT5O PIC  X(0010).
  2492*    -------------------------------
  2493     05  FILLER            PIC  X(0003).
  2494     05  TYPE5O PIC  X(0001).
  2495*    -------------------------------
  2496     05  FILLER            PIC  X(0003).
  2497     05  SINRT5O PIC  X(0006).
  2498*    -------------------------------
  2499     05  FILLER            PIC  X(0003).
  2500     05  JNTRT5O PIC  X(0006).
  2501*    -------------------------------
  2502     05  FILLER            PIC  X(0003).
  2503     05  AHRT5O PIC  X(0006).
  2504*    -------------------------------
  2505     05  FILLER            PIC  X(0003).
  2506     05  RECAL5O PIC  X(0001).
  2507*    -------------------------------
  2508     05  FILLER            PIC  X(0003).
  2509     05  COMM5O PIC  X(0001).
  2510*    -------------------------------
  2511     05  FILLER            PIC  X(0003).
  2512     05  CHGBK5O PIC  X(0002).
  2513*    -------------------------------
  2514     05  FILLER            PIC  X(0003).
  2515     05  GLCDE5O PIC  X(0001).
  2516*    -------------------------------
  2517     05  FILLER            PIC  X(0003).
  2518     05  AGNT6O PIC  X(0010).
  2519*    -------------------------------
  2520     05  FILLER            PIC  X(0003).
  2521     05  TYPE6O PIC  X(0001).
  2522*    -------------------------------
  2523     05  FILLER            PIC  X(0003).
  2524     05  SINRT6O PIC  X(0006).
  2525*    -------------------------------
  2526     05  FILLER            PIC  X(0003).
  2527     05  JNTRT6O PIC  X(0006).
  2528*    -------------------------------
  2529     05  FILLER            PIC  X(0003).
  2530     05  AHRT6O PIC  X(0006).
  2531*    -------------------------------
  2532     05  FILLER            PIC  X(0003).
  2533     05  RECAL6O PIC  X(0001).
  2534*    -------------------------------
  2535     05  FILLER            PIC  X(0003).
  2536     05  COMM6O PIC  X(0001).
  2537*    -------------------------------
  2538     05  FILLER            PIC  X(0003).
  2539     05  CHGBK6O PIC  X(0002).
  2540*    -------------------------------
  2541     05  FILLER            PIC  X(0003).
  2542     05  GLCDE6O PIC  X(0001).
  2543*    -------------------------------
  2544     05  FILLER            PIC  X(0003).
  2545     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6501.cbl
  2546*    -------------------------------
  2547     05  FILLER            PIC  X(0003).
  2548     05  TYPE7O PIC  X(0001).
  2549*    -------------------------------
  2550     05  FILLER            PIC  X(0003).
  2551     05  SINRT7O PIC  X(0006).
  2552*    -------------------------------
  2553     05  FILLER            PIC  X(0003).
  2554     05  JNTRT7O PIC  X(0006).
  2555*    -------------------------------
  2556     05  FILLER            PIC  X(0003).
  2557     05  AHRT7O PIC  X(0006).
  2558*    -------------------------------
  2559     05  FILLER            PIC  X(0003).
  2560     05  RECAL7O PIC  X(0001).
  2561*    -------------------------------
  2562     05  FILLER            PIC  X(0003).
  2563     05  COMM7O PIC  X(0001).
  2564*    -------------------------------
  2565     05  FILLER            PIC  X(0003).
  2566     05  CHGBK7O PIC  X(0002).
  2567*    -------------------------------
  2568     05  FILLER            PIC  X(0003).
  2569     05  GLCDE7O PIC  X(0001).
  2570*    -------------------------------
  2571     05  FILLER            PIC  X(0003).
  2572     05  AGNT8O PIC  X(0010).
  2573*    -------------------------------
  2574     05  FILLER            PIC  X(0003).
  2575     05  TYPE8O PIC  X(0001).
  2576*    -------------------------------
  2577     05  FILLER            PIC  X(0003).
  2578     05  SINRT8O PIC  X(0006).
  2579*    -------------------------------
  2580     05  FILLER            PIC  X(0003).
  2581     05  JNTRT8O PIC  X(0006).
  2582*    -------------------------------
  2583     05  FILLER            PIC  X(0003).
  2584     05  AHRT8O PIC  X(0006).
  2585*    -------------------------------
  2586     05  FILLER            PIC  X(0003).
  2587     05  RECAL8O PIC  X(0001).
  2588*    -------------------------------
  2589     05  FILLER            PIC  X(0003).
  2590     05  COMM8O PIC  X(0001).
  2591*    -------------------------------
  2592     05  FILLER            PIC  X(0003).
  2593     05  CHGBK8O PIC  X(0002).
  2594*    -------------------------------
  2595     05  FILLER            PIC  X(0003).
  2596     05  GLCDE8O PIC  X(0001).
  2597*    -------------------------------
  2598     05  FILLER            PIC  X(0003).
  2599     05  AGNT9O PIC  X(0010).
  2600*    -------------------------------
  2601     05  FILLER            PIC  X(0003).
  2602     05  TYPE9O PIC  X(0001).
  2603*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6501.cbl
  2604     05  FILLER            PIC  X(0003).
  2605     05  SINRT9O PIC  X(0006).
  2606*    -------------------------------
  2607     05  FILLER            PIC  X(0003).
  2608     05  JNTRT9O PIC  X(0006).
  2609*    -------------------------------
  2610     05  FILLER            PIC  X(0003).
  2611     05  AHRT9O PIC  X(0006).
  2612*    -------------------------------
  2613     05  FILLER            PIC  X(0003).
  2614     05  RECAL9O PIC  X(0001).
  2615*    -------------------------------
  2616     05  FILLER            PIC  X(0003).
  2617     05  COMM9O PIC  X(0001).
  2618*    -------------------------------
  2619     05  FILLER            PIC  X(0003).
  2620     05  CHGBK9O PIC  X(0002).
  2621*    -------------------------------
  2622     05  FILLER            PIC  X(0003).
  2623     05  GLCDE9O PIC  X(0001).
  2624*    -------------------------------
  2625     05  FILLER            PIC  X(0003).
  2626     05  AGNT10O PIC  X(0010).
  2627*    -------------------------------
  2628     05  FILLER            PIC  X(0003).
  2629     05  TYPE10O PIC  X(0001).
  2630*    -------------------------------
  2631     05  FILLER            PIC  X(0003).
  2632     05  SINRT10O PIC  X(0006).
  2633*    -------------------------------
  2634     05  FILLER            PIC  X(0003).
  2635     05  JNTRT10O PIC  X(0006).
  2636*    -------------------------------
  2637     05  FILLER            PIC  X(0003).
  2638     05  AHRT10O PIC  X(0006).
  2639*    -------------------------------
  2640     05  FILLER            PIC  X(0003).
  2641     05  RECAL10O PIC  X(0001).
  2642*    -------------------------------
  2643     05  FILLER            PIC  X(0003).
  2644     05  COMM10O PIC  X(0001).
  2645*    -------------------------------
  2646     05  FILLER            PIC  X(0003).
  2647     05  CHGBK10O PIC  X(0002).
  2648*    -------------------------------
  2649     05  FILLER            PIC  X(0003).
  2650     05  GLCDE10O PIC  X(0001).
  2651*    -------------------------------
  2652     05  FILLER            PIC  X(0003).
  2653     05  ERRMSG1O PIC  X(0075).
  2654*    -------------------------------
  2655     05  FILLER            PIC  X(0003).
  2656     05  PFENTERO PIC  X(0002).
  2657*    -------------------------------
  2658     05  FILLER            PIC  X(0003).
  2659     05  PF1PF2O PIC  X(0035).
  2660*    -------------------------------
  2661 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6501.cbl
  2662*    12  FILLER                  PIC X(518).
  2663*    12  FILLER                  PIC X(543).
  2664     12  FILLER                  PIC X(546).
  2665     12  MAP-AGENT-AREA.
  2666         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2667             20  AGENTL          PIC S9(4) COMP.
  2668             20  AGENTA          PIC X.
  2669             20  AGENT           PIC X(10).
  2670             20  ATYPEL          PIC S9(4) COMP.
  2671             20  ATYPEA          PIC X.
  2672             20  ATYPE           PIC X.
  2673             20  SINGLEL         PIC S9(4) COMP.
  2674             20  SINGLEA         PIC X.
  2675             20  SINGLE-COMM-T   PIC X(6).
  2676             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2677                 24  SINGLE-COMM-R PIC V9(5).
  2678                 24  SINGLE-DASH   PIC X.
  2679             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2680                                 PIC V9(5)-.
  2681             20  JOINTL          PIC S9(4) COMP.
  2682             20  JOINTA          PIC X.
  2683             20  JOINT-COMM-T    PIC X(6).
  2684             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2685                 24  JOINT-COMM-R PIC V9(5).
  2686                 24  JOINT-DASH   PIC X.
  2687             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2688                                 PIC V9(5)-.
  2689             20  A-HL            PIC S9(4) COMP.
  2690             20  A-HA            PIC X.
  2691             20  A-H-COMM-T      PIC X(6).
  2692             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2693                 24  A-H-COMM-R  PIC V9(5).
  2694                 24  A-H-DASH    PIC X.
  2695             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2696                                 PIC V9(5)-.
  2697             20  RECALL          PIC S9(4) COMP.
  2698             20  RECALA          PIC X.
  2699             20  RECAL           PIC X.
  2700             20  RCOMML          PIC S9(4) COMP.
  2701             20  RCOMMA          PIC X.
  2702             20  RCOMM           PIC X.
  2703             20  CHGBCKL         PIC S9(4) COMP.
  2704             20  CHGBCKA         PIC X.
  2705             20  CHGBCK          PIC X(02).
  2706             20  GLCODEL         PIC S9(4) COMP.
  2707             20  GLCODEA         PIC X.
  2708             20  GLCODE          PIC X.
  2709****************************************************************
  2710*
  2711* Copyright (c) 2007 by Clerity Solutions, Inc.
  2712* All rights reserved.
  2713*
  2714****************************************************************
  2715 01  DFHEIV.
  2716   02  DFHEIV0               PIC X(35).
  2717   02  DFHEIV1               PIC X(08).
  2718   02  DFHEIV2               PIC X(08).
  2719   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6501.cbl
  2720   02  DFHEIV4               PIC X(06).
  2721   02  DFHEIV5               PIC X(04).
  2722   02  DFHEIV6               PIC X(04).
  2723   02  DFHEIV7               PIC X(02).
  2724   02  DFHEIV8               PIC X(02).
  2725   02  DFHEIV9               PIC X(01).
  2726   02  DFHEIV10              PIC S9(7) COMP-3.
  2727   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2728   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2729   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2730   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2731   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2732   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2733   02  DFHEIV17              PIC X(04).
  2734   02  DFHEIV18              PIC X(04).
  2735   02  DFHEIV19              PIC X(04).
  2736   02  DFHEIV20              USAGE IS POINTER.
  2737   02  DFHEIV21              USAGE IS POINTER.
  2738   02  DFHEIV22              USAGE IS POINTER.
  2739   02  DFHEIV23              USAGE IS POINTER.
  2740   02  DFHEIV24              USAGE IS POINTER.
  2741   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2742   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2743   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2744   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2745   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2746   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2747   02  FILLER                PIC X(02).
  2748   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2749   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2750   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2751   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2752   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2753 LINKAGE  SECTION.
  2754*****************************************************************
  2755*                                                               *
  2756* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2757* All rights reserved.                                          *
  2758*                                                               *
  2759*****************************************************************
  2760 01  dfheiblk.
  2761     02  eibtime          pic s9(7) comp-3.
  2762     02  eibdate          pic s9(7) comp-3.
  2763     02  eibtrnid         pic x(4).
  2764     02  eibtaskn         pic s9(7) comp-3.
  2765     02  eibtrmid         pic x(4).
  2766     02  dfheigdi         pic s9(4) comp.
  2767     02  eibcposn         pic s9(4) comp.
  2768     02  eibcalen         pic s9(4) comp.
  2769     02  eibaid           pic x(1).
  2770     02  eibfiller1       pic x(1).
  2771     02  eibfn            pic x(2).
  2772     02  eibfiller2       pic x(2).
  2773     02  eibrcode         pic x(6).
  2774     02  eibfiller3       pic x(2).
  2775     02  eibds            pic x(8).
  2776     02  eibreqid         pic x(8).
  2777     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6501.cbl
  2778     02  eibsync          pic x(1).
  2779     02  eibfree          pic x(1).
  2780     02  eibrecv          pic x(1).
  2781     02  eibsend          pic x(1).
  2782     02  eibatt           pic x(1).
  2783     02  eibeoc           pic x(1).
  2784     02  eibfmh           pic x(1).
  2785     02  eibcompl         pic x(1).
  2786     02  eibsig           pic x(1).
  2787     02  eibconf          pic x(1).
  2788     02  eiberr           pic x(1).
  2789     02  eibrldbk         pic x(1).
  2790     02  eiberrcd         pic x(4).
  2791     02  eibsynrb         pic x(1).
  2792     02  eibnodat         pic x(1).
  2793     02  eibfiller5       pic x(2).
  2794     02  eibresp          pic 9(09) comp.
  2795     02  eibresp2         pic 9(09) comp.
  2796     02  dfheigdj         pic s9(4) comp.
  2797     02  dfheigdk         pic s9(4) comp.
  2798 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6501.cbl
  2800*01 PARMLIST .
  2801*    02  FILLER                  PIC S9(8)   COMP.
  2802*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2803*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2804*    02  REIN-POINTER            PIC S9(8)   COMP.
  2805*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2806*    02  COMM-POINTER            PIC S9(8)   COMP.
  2807*    02  COMP-POINTER            PIC S9(8)   COMP.
  2808*    02  NAME-POINTER            PIC S9(8)   COMP.
  2809*    02  RQST-POINTER            PIC S9(8)   COMP.
  2810*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2811*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2812*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2813*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2814*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2815*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2816*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2817*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2818*    COPY ERCACCT.
  2819******************************************************************
  2820*                                                                *
  2821*                                                                *
  2822*                            ERCACCT                             *
  2823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2824*                            VMOD=2.031                          *
  2825*                                                                *
  2826*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2827*                                                                *
  2828*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2829*   VSAM ACCOUNT MASTER FILES.                                   *
  2830*                                                                *
  2831*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2832*                                                                *
  2833*   FILE TYPE = VSAM,KSDS                                        *
  2834*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2835*                                                                *
  2836*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2837*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2838*                                                                *
  2839*   LOG = NO                                                     *
  2840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2841*                                                                *
  2842*                                                                *
  2843******************************************************************
  2844*                   C H A N G E   L O G
  2845*
  2846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2847*-----------------------------------------------------------------
  2848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2849* EFFECTIVE    NUMBER
  2850*-----------------------------------------------------------------
  2851* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2852* 092705    2005050300006  PEMA  ADD SPP LEASES
  2853* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2854* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2855* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2856* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2857* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6501.cbl
  2858******************************************************************
  2859
  2860 01  ACCOUNT-MASTER.
  2861     12  AM-RECORD-ID                      PIC XX.
  2862         88  VALID-AM-ID                      VALUE 'AM'.
  2863
  2864     12  AM-CONTROL-PRIMARY.
  2865         16  AM-COMPANY-CD                 PIC X.
  2866         16  AM-MSTR-CNTRL.
  2867             20  AM-CONTROL-A.
  2868                 24  AM-CARRIER            PIC X.
  2869                 24  AM-GROUPING.
  2870                     28 AM-GROUPING-PREFIX PIC XXX.
  2871                     28 AM-GROUPING-PRIME  PIC XXX.
  2872                 24  AM-STATE              PIC XX.
  2873                 24  AM-ACCOUNT.
  2874                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2875                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2876             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2877                                           PIC X(19).
  2878             20  AM-CNTRL-B.
  2879                 24  AM-EXPIRATION-DT      PIC XX.
  2880                 24  FILLER                PIC X(4).
  2881             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2882                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2883
  2884     12  AM-CONTROL-BY-VAR-GRP.
  2885         16  AM-COMPANY-CD-A1              PIC X.
  2886         16  AM-VG-CARRIER                 PIC X.
  2887         16  AM-VG-GROUPING                PIC X(6).
  2888         16  AM-VG-STATE                   PIC XX.
  2889         16  AM-VG-ACCOUNT                 PIC X(10).
  2890         16  AM-VG-DATE.
  2891             20  AM-VG-EXPIRATION-DT       PIC XX.
  2892             20  FILLER                    PIC X(4).
  2893         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2894                                           PIC 9(11)      COMP-3.
  2895     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2896         16  FILLER                        PIC X(10).
  2897         16  AM-VG-KEY3.
  2898             20  AM-VG3-ACCOUNT            PIC X(10).
  2899             20  AM-VG3-EXP-DT             PIC XX.
  2900         16  FILLER                        PIC X(4).
  2901     12  AM-MAINT-INFORMATION.
  2902         16  AM-LAST-MAINT-DT              PIC XX.
  2903         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2904         16  AM-LAST-MAINT-USER            PIC X(4).
  2905         16  FILLER                        PIC XX.
  2906
  2907     12  AM-EFFECTIVE-DT                   PIC XX.
  2908     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2909
  2910     12  AM-PREV-DATES  COMP-3.
  2911         16  AM-PREV-EXP-DT                PIC 9(11).
  2912         16  AM-PREV-EFF-DT                PIC 9(11).
  2913
  2914     12  AM-REPORT-CODE-1                  PIC X(10).
  2915     12  AM-REPORT-CODE-2                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6501.cbl
  2916
  2917     12  AM-CITY-CODE                      PIC X(4).
  2918     12  AM-COUNTY-PARISH                  PIC X(6).
  2919
  2920     12  AM-NAME                           PIC X(30).
  2921     12  AM-PERSON                         PIC X(30).
  2922     12  AM-ADDRS                          PIC X(30).
  2923     12  AM-CITY.
  2924         16  AM-ADDR-CITY                  PIC X(28).
  2925         16  AM-ADDR-STATE                 PIC XX.
  2926     12  AM-ZIP.
  2927         16  AM-ZIP-PRIME.
  2928             20  AM-ZIP-PRI-1ST            PIC X.
  2929                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2930             20  FILLER                    PIC X(4).
  2931         16  AM-ZIP-PLUS4                  PIC X(4).
  2932     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2933         16  AM-CAN-POSTAL-1               PIC XXX.
  2934         16  AM-CAN-POSTAL-2               PIC XXX.
  2935         16  FILLER                        PIC XXX.
  2936     12  AM-TEL-NO.
  2937         16  AM-AREA-CODE                  PIC 999.
  2938         16  AM-TEL-PRE                    PIC 999.
  2939         16  AM-TEL-NBR                    PIC 9(4).
  2940     12  AM-TEL-LOC                        PIC X.
  2941         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2942         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2943
  2944     12  AM-COMM-STRUCTURE.
  2945         16  AM-DEFN-1.
  2946             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2947                 24  AM-AGT.
  2948                     28  AM-AGT-PREFIX     PIC X(4).
  2949                     28  AM-AGT-PRIME      PIC X(6).
  2950                 24  AM-COM-TYP            PIC X.
  2951                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2952                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2953                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2954                 24  AM-RECALC-LV-INDIC    PIC X.
  2955                 24  AM-RETRO-LV-INDIC     PIC X.
  2956                 24  AM-GL-CODES           PIC X.
  2957                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2958                 24  FILLER                PIC X(01).
  2959         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2960             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2961                 24  FILLER                PIC X(11).
  2962                 24  AM-L-COMA             PIC XXX.
  2963                 24  AM-J-COMA             PIC XXX.
  2964                 24  AM-A-COMA             PIC XXX.
  2965                 24  FILLER                PIC X(6).
  2966
  2967     12  AM-COMM-CHANGE-STATUS             PIC X.
  2968         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2969
  2970     12  AM-CSR-CODE                       PIC X(4).
  2971
  2972     12  AM-BILLING-STATUS                 PIC X.
  2973         88  AM-ACCOUNT-BILLED                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6501.cbl
  2974         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2975     12  AM-AUTO-REFUND-SW                 PIC X.
  2976         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2977         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2978     12  AM-GPCD                           PIC 99.
  2979     12  AM-IG                             PIC X.
  2980         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2981         88  AM-HAS-GROUP                     VALUE '2'.
  2982     12  AM-STATUS                         PIC X.
  2983         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2984         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2985         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2986         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2987         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2988         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2989     12  AM-REMIT-TO                       PIC 99.
  2990     12  AM-ID-NO                          PIC X(11).
  2991
  2992     12  AM-CAL-TABLE                      PIC XX.
  2993     12  AM-LF-DEVIATION                   PIC XXX.
  2994     12  AM-AH-DEVIATION                   PIC XXX.
  2995     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2996     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2997     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2998     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2999     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3000     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3001
  3002     12  AM-USER-FIELDS.
  3003         16  AM-FLD-1                      PIC XX.
  3004         16  AM-FLD-2                      PIC XX.
  3005         16  AM-FLD-3                      PIC XX.
  3006         16  AM-FLD-4                      PIC XX.
  3007         16  AM-FLD-5                      PIC XX.
  3008
  3009     12  AM-1ST-PROD-DATE.
  3010         16  AM-1ST-PROD-YR                PIC XX.
  3011         16  AM-1ST-PROD-MO                PIC XX.
  3012         16  AM-1ST-PROD-DA                PIC XX.
  3013     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3014     12  AM-CERTS-PURGED-DATE.
  3015         16  AM-PUR-YR                     PIC XX.
  3016         16  AM-PUR-MO                     PIC XX.
  3017         16  AM-PUR-DA                     PIC XX.
  3018     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3019     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3020     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3021     12  AM-INACTIVE-DATE.
  3022         16  AM-INA-MO                     PIC 99.
  3023         16  AM-INA-DA                     PIC 99.
  3024         16  AM-INA-YR                     PIC 99.
  3025     12  AM-AR-HI-CERT-DATE                PIC XX.
  3026
  3027     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3028     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3029
  3030     12  AM-OB-PAYMENT-MODE                PIC X.
  3031         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6501.cbl
  3032         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3033         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3034         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3035
  3036     12  AM-AH-ONLY-INDICATOR              PIC X.
  3037         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3038         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3039
  3040     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3041
  3042     12  AM-OVER-SHORT.
  3043         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3044         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3045
  3046     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3047     12  AM-DCC-CLP-STATE                  PIC XX.
  3048
  3049     12  AM-RECALC-COMM                    PIC X.
  3050     12  AM-RECALC-REIN                    PIC X.
  3051
  3052     12  AM-REI-TABLE                      PIC XXX.
  3053     12  AM-REI-ET-LF                      PIC X.
  3054     12  AM-REI-ET-AH                      PIC X.
  3055     12  AM-REI-PE-LF                      PIC X.
  3056     12  AM-REI-PE-AH                      PIC X.
  3057     12  AM-REI-PRT-ST                     PIC X.
  3058     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3059     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3060     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3061     12  AM-REI-GROUP-A                    PIC X(6).
  3062     12  AM-REI-MORT                       PIC X(4).
  3063     12  AM-REI-PRT-OW                     PIC X.
  3064     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3065     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3066     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3067     12  AM-REI-GROUP-B                    PIC X(6).
  3068
  3069     12  AM-TRUST-TYPE                     PIC X(2).
  3070
  3071     12  AM-EMPLOYER-STMT-USED             PIC X.
  3072     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3073
  3074     12  AM-STD-AH-TYPE                    PIC XX.
  3075     12  AM-EARN-METHODS.
  3076         16  AM-EARN-METHOD-R              PIC X.
  3077             88 AM-REF-RL-R78                 VALUE 'R'.
  3078             88 AM-REF-RL-PR                  VALUE 'P'.
  3079             88 AM-REF-RL-MEAN                VALUE 'M'.
  3080             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3081         16  AM-EARN-METHOD-L              PIC X.
  3082             88 AM-REF-LL-R78                 VALUE 'R'.
  3083             88 AM-REF-LL-PR                  VALUE 'P'.
  3084             88 AM-REF-LL-MEAN                VALUE 'M'.
  3085             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3086         16  AM-EARN-METHOD-A              PIC X.
  3087             88 AM-REF-AH-R78                 VALUE 'R'.
  3088             88 AM-REF-AH-PR                  VALUE 'P'.
  3089             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6501.cbl
  3090             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3091             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3092             88 AM-REF-AH-NET                 VALUE 'N'.
  3093
  3094     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3095     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3096     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3097
  3098     12  AM-RET-Y-N                        PIC X.
  3099     12  AM-RET-P-E                        PIC X.
  3100     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3101     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3102     12  AM-RET-GRP                        PIC X(6).
  3103     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3104         16  AM-POOL-PRIME                 PIC XXX.
  3105         16  AM-POOL-SUB                   PIC XXX.
  3106     12  AM-RETRO-EARNINGS.
  3107         16  AM-RET-EARN-R                 PIC X.
  3108         16  AM-RET-EARN-L                 PIC X.
  3109         16  AM-RET-EARN-A                 PIC X.
  3110     12  AM-RET-ST-TAX-USE                 PIC X.
  3111         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3112         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3113     12  AM-RETRO-BEG-EARNINGS.
  3114         16  AM-RET-BEG-EARN-R             PIC X.
  3115         16  AM-RET-BEG-EARN-L             PIC X.
  3116         16  AM-RET-BEG-EARN-A             PIC X.
  3117     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3118     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3119
  3120     12  AM-USER-SELECT-OPTIONS.
  3121         16  AM-USER-SELECT-1              PIC X(10).
  3122         16  AM-USER-SELECT-2              PIC X(10).
  3123         16  AM-USER-SELECT-3              PIC X(10).
  3124         16  AM-USER-SELECT-4              PIC X(10).
  3125         16  AM-USER-SELECT-5              PIC X(10).
  3126
  3127     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3128
  3129     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3130
  3131     12  AM-RPT045A-SWITCH                 PIC X.
  3132         88  RPT045A-OFF                   VALUE 'N'.
  3133
  3134     12  AM-INSURANCE-LIMITS.
  3135         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3136         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3137
  3138     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3139         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3140
  3141     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3142         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3143         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3144
  3145     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3146
  3147     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6501.cbl
  3148     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3149     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3150     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3151     12  AM-DCC-UEF-STATE                  PIC XX.
  3152     12  FILLER                            PIC XXX.
  3153     12  AM-REPORT-CODE-3                  PIC X(10).
  3154*    12  FILLER                            PIC X(22).
  3155
  3156     12  AM-RESERVE-DATE.
  3157         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3158         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3159         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3160
  3161     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3162     12  AM-NOTIFICATION-TYPES.
  3163         16  AM-NOTIF-OF-LETTERS           PIC X.
  3164         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3165         16  AM-NOTIF-OF-REPORTS           PIC X.
  3166         16  AM-NOTIF-OF-STATUS            PIC X.
  3167
  3168     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3169         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3170         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3171         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3172         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3173
  3174     12  AM-BENEFIT-CONTROLS.
  3175         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3176             20  AM-BENEFIT-CODE           PIC XX.
  3177             20  AM-BENEFIT-TYPE           PIC X.
  3178             20  AM-BENEFIT-REVISION       PIC XXX.
  3179             20  AM-BENEFIT-REM-TERM       PIC X.
  3180             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3181             20  FILLER                    PIC XX.
  3182         16  FILLER                        PIC X(80).
  3183
  3184     12  AM-TRANSFER-DATA.
  3185         16  AM-TRANSFERRED-FROM.
  3186             20  AM-TRNFROM-CARRIER        PIC X.
  3187             20  AM-TRNFROM-GROUPING.
  3188                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3189                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3190             20  AM-TRNFROM-STATE          PIC XX.
  3191             20  AM-TRNFROM-ACCOUNT.
  3192                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3193                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3194             20  AM-TRNFROM-DTE            PIC XX.
  3195         16  AM-TRANSFERRED-TO.
  3196             20  AM-TRNTO-CARRIER          PIC X.
  3197             20  AM-TRNTO-GROUPING.
  3198                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3199                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3200             20  AM-TRNTO-STATE            PIC XX.
  3201             20  AM-TRNTO-ACCOUNT.
  3202                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3203                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3204             20  AM-TRNTO-DTE              PIC XX.
  3205         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6501.cbl
  3206
  3207     12  AM-SAVED-REMIT-TO                 PIC 99.
  3208
  3209     12  AM-COMM-STRUCTURE-SAVED.
  3210         16  AM-DEFN-1-SAVED.
  3211             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3212                 24  AM-AGT-SV             PIC X(10).
  3213                 24  AM-COM-TYP-SV         PIC X.
  3214                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3215                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3216                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3217                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3218                 24  FILLER                PIC X.
  3219                 24  AM-GL-CODES-SV        PIC X.
  3220                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3221                 24  FILLER                PIC X.
  3222         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3223             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3224                 24  FILLER                PIC X(11).
  3225                 24  AM-L-COMA-SV          PIC XXX.
  3226                 24  AM-J-COMA-SV          PIC XXX.
  3227                 24  AM-A-COMA-SV          PIC XXX.
  3228                 24  FILLER                PIC X(6).
  3229
  3230     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3231         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3232            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3233            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3234            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3235
  3236     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3237     12  FILLER                            PIC X(120).
  3238
  3239     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3240         16  AM-CONTROL-NAME               PIC X(30).
  3241         16  AM-EXECUTIVE-ONE.
  3242             20  AM-EXEC1-NAME             PIC X(15).
  3243             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3244                                                          COMP-3.
  3245             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3246                                                          COMP-3.
  3247         16  AM-EXECUTIVE-TWO.
  3248             20  AM-EXEC2-NAME             PIC X(15).
  3249             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3250                                                          COMP-3.
  3251             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3252                                                          COMP-3.
  3253
  3254     12  AM-RETRO-ADDITIONAL-DATA.
  3255         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3256         16  AM-RETRO-PREM-P-E             PIC X.
  3257         16  AM-RETRO-CLMS-P-I             PIC X.
  3258         16  AM-RETRO-RET-BRACKET-LF.
  3259             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3260                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3261                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3262             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3263                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6501.cbl
  3264                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3265             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3266                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3267                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3268         16  AM-RETRO-RET-BRACKET-AH.
  3269             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3270                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3271                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3272                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3273             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3274                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3275                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3276             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3277                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3278                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3279
  3280     12  AM-COMMENTS.
  3281         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3282
  3283     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3284         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3285         16  AM-FLI-BILLING-CODE           PIC X.
  3286         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3287         16  AM-FLI-UNITED-IDENT           PIC X.
  3288         16  AM-FLI-INTEREST-LOST-DATA.
  3289             20  AM-FLI-BANK-NO            PIC X(5).
  3290             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3291             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3292             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3293         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3294             20  AM-FLI-AGT                PIC X(9).
  3295             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3296             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3297         16  FILLER                        PIC X(102).
  3298
  3299     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3300         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3301             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3302             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3303             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3304             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3305             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3306         16  FILLER                          PIC X(10).
  3307******************************************************************
  3308*    COPY ELCCNTL.
  3309******************************************************************
  3310*                                                                *
  3311*                                                                *
  3312*                            ELCCNTL.                            *
  3313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3314*                            VMOD=2.059                          *
  3315*                                                                *
  3316*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3317*                                                                *
  3318*   FILE TYPE = VSAM,KSDS                                        *
  3319*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3320*                                                                *
  3321*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6501.cbl
  3322*       ALTERNATE INDEX = NONE                                   *
  3323*                                                                *
  3324*   LOG = YES                                                    *
  3325*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3326******************************************************************
  3327*                   C H A N G E   L O G
  3328*
  3329* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3330*-----------------------------------------------------------------
  3331*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3332* EFFECTIVE    NUMBER
  3333*-----------------------------------------------------------------
  3334* 082503                   PEMA  ADD BENEFIT GROUP
  3335* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3336* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3337* 092705    2005050300006  PEMA  ADD SPP LEASES
  3338* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3339* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3340* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3341* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3342* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3343******************************************************************
  3344*
  3345 01  CONTROL-FILE.
  3346     12  CF-RECORD-ID                       PIC XX.
  3347         88  VALID-CF-ID                        VALUE 'CF'.
  3348
  3349     12  CF-CONTROL-PRIMARY.
  3350         16  CF-COMPANY-ID                  PIC XXX.
  3351         16  CF-RECORD-TYPE                 PIC X.
  3352             88  CF-COMPANY-MASTER              VALUE '1'.
  3353             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3354             88  CF-STATE-MASTER                VALUE '3'.
  3355             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3356             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3357             88  CF-CARRIER-MASTER              VALUE '6'.
  3358             88  CF-MORTALITY-MASTER            VALUE '7'.
  3359             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3360             88  CF-TERMINAL-MASTER             VALUE '9'.
  3361             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3362             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3363             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3364             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3365             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3366             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3367             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3368             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3369             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3370         16  CF-ACCESS-CD-GENL              PIC X(4).
  3371         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3372             20  CF-PROCESSOR               PIC X(4).
  3373         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3374             20  CF-STATE-CODE              PIC XX.
  3375             20  FILLER                     PIC XX.
  3376         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3377             20  FILLER                     PIC XX.
  3378             20  CF-HI-BEN-IN-REC           PIC XX.
  3379         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6501.cbl
  3380             20  FILLER                     PIC XXX.
  3381             20  CF-CARRIER-CNTL            PIC X.
  3382         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3383             20  FILLER                     PIC XX.
  3384             20  CF-HI-TYPE-IN-REC          PIC 99.
  3385         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3386             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3387                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3388             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3389             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3390         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3391             20  FILLER                     PIC X.
  3392             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3393         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3394             20  FILLER                     PIC XX.
  3395             20  CF-MORTGAGE-PLAN           PIC XX.
  3396         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3397
  3398     12  CF-LAST-MAINT-DT                   PIC XX.
  3399     12  CF-LAST-MAINT-BY                   PIC X(4).
  3400     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3401
  3402     12  CF-RECORD-BODY                     PIC X(728).
  3403
  3404
  3405****************************************************************
  3406*             COMPANY MASTER RECORD                            *
  3407****************************************************************
  3408
  3409     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3410         16  CF-COMPANY-ADDRESS.
  3411             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3412             20  CF-CL-IN-CARE-OF           PIC X(30).
  3413             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3414             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3415             20  CF-CL-CITY-STATE           PIC X(30).
  3416             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3417             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3418         16  CF-COMPANY-CD                  PIC X.
  3419         16  CF-COMPANY-PASSWORD            PIC X(8).
  3420         16  CF-SECURITY-OPTION             PIC X.
  3421             88  ALL-SECURITY                   VALUE '1'.
  3422             88  COMPANY-VERIFY                 VALUE '2'.
  3423             88  PROCESSOR-VERIFY               VALUE '3'.
  3424             88  NO-SECURITY                    VALUE '4'.
  3425             88  ALL-BUT-TERM                   VALUE '5'.
  3426         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3427             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3428         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3429             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3430         16  CF-INFORCE-LOCATION            PIC X.
  3431             88  CERTS-ARE-ONLINE               VALUE '1'.
  3432             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3433             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3434         16  CF-LOWER-CASE-LETTERS          PIC X.
  3435         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3436             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3437             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6501.cbl
  3438             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3439             88  CF-ACCNT-CNTL                  VALUE '3'.
  3440             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3441
  3442         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3443         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3444
  3445         16  CF-LGX-CREDIT-USER             PIC X.
  3446             88  CO-IS-NOT-USER                 VALUE 'N'.
  3447             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3448
  3449         16 CF-CREDIT-CALC-CODES.
  3450             20  CF-CR-REM-TERM-CALC PIC X.
  3451               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3452               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3453               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3454               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3455               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3456               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3457               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3458             20  CF-CR-R78-METHOD           PIC X.
  3459               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3460               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3461
  3462         16  CF-CLAIM-CONTROL-COUNTS.
  3463             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3464                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3465
  3466             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3467                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3468
  3469             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3470                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3471
  3472             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3473                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3474
  3475         16  CF-CURRENT-MONTH-END           PIC XX.
  3476
  3477         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3478             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3479             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3480             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3481             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3482                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3483                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3484             20  CF-CO-PREM-REJECT-SW       PIC X.
  3485                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3486                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3487             20  CF-CO-REF-REJECT-SW        PIC X.
  3488                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3489                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3490
  3491         16  CF-CO-REPORTING-DT             PIC XX.
  3492         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3493         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3494           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3495           88  CF-CO-MONTH-END                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6501.cbl
  3496
  3497         16  CF-LGX-CLAIM-USER              PIC X.
  3498             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3499             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3500
  3501         16  CF-CREDIT-EDIT-CONTROLS.
  3502             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3503             20  CF-MIN-AGE                 PIC 99.
  3504             20  CF-DEFAULT-AGE             PIC 99.
  3505             20  CF-MIN-TERM                PIC S999      COMP-3.
  3506             20  CF-MAX-TERM                PIC S999      COMP-3.
  3507             20  CF-DEFAULT-SEX             PIC X.
  3508             20  CF-JOINT-AGE-INPUT         PIC X.
  3509                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3510             20  CF-BIRTH-DATE-INPUT        PIC X.
  3511                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3512             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3513                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3514                 88  CF-ZERO-CARRIER            VALUE '1'.
  3515                 88  CF-ZERO-GROUPING           VALUE '2'.
  3516                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3517             20  CF-EDIT-SW                 PIC X.
  3518                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3519             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3520             20  CF-CR-PR-METHOD            PIC X.
  3521               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3522               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3523             20  FILLER                     PIC X.
  3524
  3525         16  CF-CREDIT-MISC-CONTROLS.
  3526             20  CF-REIN-TABLE-SW           PIC X.
  3527                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3528             20  CF-COMP-TABLE-SW           PIC X.
  3529                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3530             20  CF-EXPERIENCE-RETENTION-AGE
  3531                                            PIC S9        COMP-3.
  3532             20  CF-CONVERSION-DT           PIC XX.
  3533             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3534             20  CF-RUN-FREQUENCY-SW        PIC X.
  3535                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3536                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3537
  3538             20  CF-CR-CHECK-NO-CONTROL.
  3539                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3540                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3541                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3542                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3543                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3544                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3545
  3546                 24  CF-CR-CHECK-COUNT       REDEFINES
  3547                     CF-CR-CHECK-COUNTER      PIC X(4).
  3548
  3549                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3550                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3551
  3552                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3553                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6501.cbl
  3554                 24  CF-MAIL-PROCESSING       PIC X.
  3555                     88  MAIL-PROCESSING          VALUE 'Y'.
  3556
  3557         16  CF-MISC-SYSTEM-CONTROL.
  3558             20  CF-SYSTEM-C                 PIC X.
  3559                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3560             20  CF-SYSTEM-D                 PIC X.
  3561                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3562             20  CF-SOC-SEC-NO-SW            PIC X.
  3563                 88  SOC-SEC-NO-USED             VALUE '1'.
  3564             20  CF-MEMBER-NO-SW             PIC X.
  3565                 88  MEMBER-NO-USED              VALUE '1'.
  3566             20  CF-TAX-ID-NUMBER            PIC X(11).
  3567             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3568             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3569                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3570                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3571                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3572                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3573             20  CF-SYSTEM-E                 PIC X.
  3574                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3575
  3576         16  CF-LGX-LIFE-USER               PIC X.
  3577             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3578             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3579
  3580         16  CF-CR-MONTH-END-DT             PIC XX.
  3581
  3582         16  CF-FILE-MAINT-DATES.
  3583             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3584                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3585             20  CF-LAST-BATCH       REDEFINES
  3586                 CF-LAST-BATCH-NO               PIC X(4).
  3587             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3588             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3589             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3590             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3591             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3592             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3593             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3594             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3595             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3596             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3597
  3598         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3599         16  FILLER                         PIC X.
  3600
  3601         16  CF-ALT-MORT-CODE               PIC X(4).
  3602         16  CF-MEMBER-CAPTION              PIC X(10).
  3603
  3604         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3605             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3606             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3607             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3608             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3609             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3610
  3611         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6501.cbl
  3612
  3613         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3614         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3615         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3616         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3617
  3618         16  CF-AH-OVERRIDE-L1              PIC X.
  3619         16  CF-AH-OVERRIDE-L2              PIC XX.
  3620         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3621         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3622
  3623         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3624         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3625
  3626         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3627         16  CF-AR-LAST-EL860-DT            PIC XX.
  3628         16  CF-MP-MONTH-END-DT             PIC XX.
  3629
  3630         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3631         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3632             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3633
  3634         16  CF-AR-MONTH-END-DT             PIC XX.
  3635
  3636         16  CF-CRDTCRD-USER                PIC X.
  3637             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3638             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3639
  3640         16  CF-CC-MONTH-END-DT             PIC XX.
  3641
  3642         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3643
  3644         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3645             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3646             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3647             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3648         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3649         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3650         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3651         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3652             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3653             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3654         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3655         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3656         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3657             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3658         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3659
  3660         16  CF-CL-ZIP-CODE.
  3661             20  CF-CL-ZIP-PRIME.
  3662                 24  CF-CL-ZIP-1ST          PIC X.
  3663                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3664                 24  FILLER                 PIC X(4).
  3665             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3666         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3667             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3668             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3669             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6501.cbl
  3670
  3671         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3672         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3673         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3674         16  CF-CO-OPTION-START-DATE        PIC XX.
  3675         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3676           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3677                                                      '3' '4'.
  3678           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3679           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3680           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3681           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3682           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3683           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3684
  3685         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3686
  3687         16  CF-PAYMENT-APPROVAL-LEVELS.
  3688             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3689             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3690             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3691             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3692             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3693             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3694
  3695         16  CF-END-USER-REPORTING-USER     PIC X.
  3696             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3697             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3698
  3699         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3700             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3701             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3702
  3703         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3704
  3705         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3706         16  FILLER                         PIC X.
  3707
  3708         16  CF-CREDIT-ARCHIVE-CNTL.
  3709             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3710             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3711             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3712
  3713         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3714
  3715         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3716             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3717             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3718
  3719         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3720             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3721             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3722
  3723         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3724
  3725         16  CF-CO-ACH-ID-CODE              PIC  X.
  3726             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3727             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6501.cbl
  3728             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3729         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3730         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3731         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3732         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3733         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3734         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3735         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3736         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3737         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3738                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3739         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3740                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3741
  3742         16  CF-CO-OVER-SHORT.
  3743             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3744             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3745
  3746*         16  FILLER                         PIC X(102).
  3747         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3748             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3749             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3750
  3751         16  CF-AH-APPROVAL-DAYS.
  3752             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3753             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3754             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3755             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3756
  3757         16  FILLER                         PIC X(82).
  3758****************************************************************
  3759*             PROCESSOR/USER RECORD                            *
  3760****************************************************************
  3761
  3762     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3763         16  CF-PROCESSOR-NAME              PIC X(30).
  3764         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3765         16  CF-PROCESSOR-TITLE             PIC X(26).
  3766         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3767                 88  MESSAGE-YES                VALUE 'Y'.
  3768                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3769
  3770*****************************************************
  3771****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3772****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3773****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3774****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3775*****************************************************
  3776
  3777         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3778             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3779             20  CF-APPLICATION-FORCE       PIC X.
  3780             20  CF-INDIVIDUAL-APP.
  3781                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3782                     28  CF-BROWSE-APP      PIC X.
  3783                     28  CF-UPDATE-APP      PIC X.
  3784
  3785         16  CF-CURRENT-TERM-ON             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6501.cbl
  3786         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3787             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3788             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3789             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3790             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3791             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3792             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3793             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3794         16  CF-PROCESSOR-CARRIER           PIC X.
  3795             88  NO-CARRIER-SECURITY            VALUE ' '.
  3796         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3797             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3798         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3799             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3800         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3801             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3802
  3803         16  CF-PROC-SYS-ACCESS-SW.
  3804             20  CF-PROC-CREDIT-CLAIMS-SW.
  3805                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3806                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3807                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3808                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3809             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3810                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3811                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3812             20  CF-PROC-LIFE-GNRLDGR-SW.
  3813                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3814                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3815                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3816                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3817             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3818                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3819                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3820         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3821             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3822             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3823         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3824
  3825         16  CF-APPROVAL-LEVEL                  PIC X.
  3826             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3827             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3828             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3829             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3830
  3831         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3832
  3833         16  CF-LANGUAGE-TYPE                   PIC X.
  3834             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3835             88  CF-LANG-IS-FR                      VALUE 'F'.
  3836         16  FILLER                             PIC  X(240).
  3837
  3838****************************************************************
  3839*             PROCESSOR/REMINDERS RECORD                       *
  3840****************************************************************
  3841
  3842     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3843         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6501.cbl
  3844             20  CF-START-REMIND-DT         PIC XX.
  3845             20  CF-END-REMIND-DT           PIC XX.
  3846             20  CF-REMINDER-TEXT           PIC X(50).
  3847         16  FILLER                         PIC X(296).
  3848
  3849
  3850****************************************************************
  3851*             STATE MASTER RECORD                              *
  3852****************************************************************
  3853
  3854     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3855         16  CF-STATE-ABBREVIATION          PIC XX.
  3856         16  CF-STATE-NAME                  PIC X(25).
  3857         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3858         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3859             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3860             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3861             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3862             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3863                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3864                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3865             20  CF-ST-PREM-REJECT-SW       PIC X.
  3866                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3867                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3868             20  CF-ST-REF-REJECT-SW        PIC X.
  3869                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3870                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3871         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3872         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3873         16  CF-ST-REFUND-RULES.
  3874             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3875             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3876             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3877         16  CF-ST-FST-PMT-EXTENSION.
  3878             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3879             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3880                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3881                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3882                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3883                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3884         16  CF-ST-STATE-CALL.
  3885             20  CF-ST-CALL-UNEARNED        PIC X.
  3886             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3887             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3888         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3889             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3890             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3891         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3892         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3893         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3894         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3895         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3896         16  FILLER                         PIC X.
  3897         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3898             20  CF-ST-BENEFIT-CD           PIC XX.
  3899             20  CF-ST-BENEFIT-KIND         PIC X.
  3900                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3901                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6501.cbl
  3902             20  CF-ST-REM-TERM-CALC        PIC X.
  3903                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3904                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3905                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3906                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3907                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3908                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3909                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3910                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3911
  3912             20  CF-ST-REFUND-CALC          PIC X.
  3913                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3914                 88  ST-REFD-BY-R78             VALUE '1'.
  3915                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3916                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3917                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3918                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3919                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3920                 88  ST-REFD-UTAH               VALUE '7'.
  3921                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3922                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3923                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3924
  3925             20  CF-ST-EARNING-CALC         PIC X.
  3926                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3927                 88  ST-EARN-BY-R78             VALUE '1'.
  3928                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3929                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3930                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3931                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3932                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3933                 88  ST-EARN-MEAN               VALUE '8'.
  3934                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3935
  3936             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3937                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3938                 88  ST-OVRD-BY-R78             VALUE '1'.
  3939                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3940                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3941                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3942                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3943                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3944                 88  ST-OVRD-MEAN               VALUE '8'.
  3945                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3946             20  FILLER                     PIC X.
  3947
  3948         16  CF-ST-COMMISSION-CAPS.
  3949             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3950             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3951             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3952             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3953         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3954                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3955
  3956         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3957
  3958         16  CF-ST-STATUTORY-INTEREST.
  3959             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6501.cbl
  3960                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3961                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3962             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3963             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3964             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3965             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3966             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3967
  3968         16  CF-ST-OVER-SHORT.
  3969             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3970             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3971
  3972         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3973
  3974         16  CF-ST-RT-CALC                  PIC X.
  3975
  3976         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3977         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3978         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3979         16  CF-ST-RF-LR-CALC               PIC X.
  3980         16  CF-ST-RF-LL-CALC               PIC X.
  3981         16  CF-ST-RF-LN-CALC               PIC X.
  3982         16  CF-ST-RF-AH-CALC               PIC X.
  3983         16  CF-ST-RF-CP-CALC               PIC X.
  3984*        16  FILLER                         PIC X(206).
  3985*CIDMOD         16  FILLER                         PIC X(192).
  3986         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3987             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3988         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3989         16  CF-ST-VFY-2ND-BENE             PIC X.
  3990         16  FILLER                         PIC X(186).
  3991
  3992****************************************************************
  3993*             BENEFIT MASTER RECORD                            *
  3994****************************************************************
  3995
  3996     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3997         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3998             20  CF-BENEFIT-CODE            PIC XX.
  3999             20  CF-BENEFIT-NUMERIC  REDEFINES
  4000                 CF-BENEFIT-CODE            PIC XX.
  4001             20  CF-BENEFIT-ALPHA           PIC XXX.
  4002             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4003             20  CF-BENEFIT-COMMENT         PIC X(10).
  4004
  4005             20  CF-LF-COVERAGE-TYPE        PIC X.
  4006                 88  CF-REDUCING                VALUE 'R'.
  4007                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4008
  4009             20  CF-SPECIAL-CALC-CD         PIC X.
  4010                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4011                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4012                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4013                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4014                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4015                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4016                 88  CF-FARM-PLAN               VALUE 'F'.
  4017                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6501.cbl
  4018                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4019                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4020                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4021                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4022                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4023                 88  CF-PRUDENTIAL              VALUE 'P'.
  4024                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4025                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4026                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4027                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4028                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4029                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4030
  4031             20  CF-JOINT-INDICATOR         PIC X.
  4032                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4033
  4034*            20  FILLER                     PIC X(12).
  4035             20  FILLER                     PIC X(11).
  4036             20  CF-BENEFIT-CATEGORY        PIC X.
  4037             20  CF-LOAN-TYPE               PIC X(8).
  4038
  4039             20  CF-CO-REM-TERM-CALC        PIC X.
  4040                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4041                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4042                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4043                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4044                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4045
  4046             20  CF-CO-EARNINGS-CALC        PIC X.
  4047                 88  CO-EARN-BY-R78             VALUE '1'.
  4048                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4049                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4050                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4051                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4052                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4053                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4054                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4055
  4056             20  CF-CO-REFUND-CALC          PIC X.
  4057                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4058                 88  CO-REFD-BY-R78             VALUE '1'.
  4059                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4060                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4061                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4062                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4063                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4064                 88  CO-REFD-MEAN               VALUE '8'.
  4065                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4066                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4067                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4068
  4069             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4070                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4071                 88  CO-OVRD-BY-R78             VALUE '1'.
  4072                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4073                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4074                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4075                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6501.cbl
  4076                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4077                 88  CO-OVRD-MEAN               VALUE '8'.
  4078                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4079
  4080             20  CF-CO-BEN-I-G-CD           PIC X.
  4081                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4082                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4083                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4084
  4085         16  FILLER                         PIC X(304).
  4086
  4087
  4088****************************************************************
  4089*             CARRIER MASTER RECORD                            *
  4090****************************************************************
  4091
  4092     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4093         16  CF-ADDRESS-DATA.
  4094             20  CF-MAIL-TO-NAME            PIC X(30).
  4095             20  CF-IN-CARE-OF              PIC X(30).
  4096             20  CF-ADDRESS-LINE-1          PIC X(30).
  4097             20  CF-ADDRESS-LINE-2          PIC X(30).
  4098             20  CF-CITY-STATE              PIC X(30).
  4099             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4100             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4101
  4102         16  CF-CLAIM-NO-CONTROL.
  4103             20  CF-CLAIM-NO-METHOD         PIC X.
  4104                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4105                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4106                 88  CLAIM-NO-SEQ               VALUE '3'.
  4107                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4108             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4109                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4110                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4111                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4112
  4113         16  CF-CHECK-NO-CONTROL.
  4114             20  CF-CHECK-NO-METHOD         PIC X.
  4115                 88  CHECK-NO-MANUAL            VALUE '1'.
  4116                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4117                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4118                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4119             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4120                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4121
  4122         16  CF-DOMICILE-STATE              PIC XX.
  4123
  4124         16  CF-EXPENSE-CONTROLS.
  4125             20  CF-EXPENSE-METHOD          PIC X.
  4126                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4127                 88  DOLLARS-PER-PMT            VALUE '2'.
  4128                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4129                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4130             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4131             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4132
  4133         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6501.cbl
  4134             20  CF-LETTER-RESEND-OPT       PIC X.
  4135                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4136                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4137             20  FILLER                     PIC X(4).
  4138
  4139         16  CF-RESERVE-CONTROLS.
  4140             20  CF-MANUAL-SW               PIC X.
  4141                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4142             20  CF-FUTURE-SW               PIC X.
  4143                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4144             20  CF-PTC-SW                  PIC X.
  4145                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4146             20  CF-IBNR-SW                 PIC X.
  4147                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4148             20  CF-PTC-LF-SW               PIC X.
  4149                 88  CF-LF-PTC-USED             VALUE '1'.
  4150             20  CF-CDT-ACCESS-METHOD       PIC X.
  4151                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4152                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4153                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4154             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4155
  4156         16  CF-CLAIM-CALC-METHOD           PIC X.
  4157             88  360-PLUS-MONTHS                VALUE '1'.
  4158             88  365-PLUS-MONTHS                VALUE '2'.
  4159             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4160             88  360-DAILY                      VALUE '4'.
  4161             88  365-DAILY                      VALUE '5'.
  4162
  4163         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4164         16  FILLER                         PIC X(11).
  4165
  4166         16  CF-LIMIT-AMOUNTS.
  4167             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4168             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4169             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4170             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4171             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4172             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4173             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4174             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4175             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4176             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4177
  4178         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4179         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4180         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4181
  4182         16  CF-ZIP-CODE.
  4183             20  CF-ZIP-PRIME.
  4184                 24  CF-ZIP-1ST             PIC X.
  4185                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4186                 24  FILLER                 PIC X(4).
  4187             20  CF-ZIP-PLUS4               PIC X(4).
  4188         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4189             20  CF-CAN-POSTAL-1            PIC XXX.
  4190             20  CF-CAN-POSTAL-2            PIC XXX.
  4191             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6501.cbl
  4192
  4193         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4194         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4195         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4196
  4197         16  CF-RATING-SWITCH               PIC X.
  4198             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4199             88  CF-NO-RATING                   VALUE 'N'.
  4200
  4201         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4202
  4203         16  CF-CARRIER-OVER-SHORT.
  4204             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4205             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4206
  4207         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4208         16  CF-SECPAY-SWITCH               PIC X.
  4209             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4210             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4211         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4212         16  FILLER                         PIC X(448).
  4213*        16  FILLER                         PIC X(452).
  4214
  4215
  4216****************************************************************
  4217*             MORTALITY MASTER RECORD                          *
  4218****************************************************************
  4219
  4220     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4221         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4222                                INDEXED BY CF-MORT-NDX.
  4223             20  CF-MORT-TABLE              PIC X(5).
  4224             20  CF-MORT-TABLE-TYPE         PIC X.
  4225                 88  CF-MORT-JOINT              VALUE 'J'.
  4226                 88  CF-MORT-SINGLE             VALUE 'S'.
  4227                 88  CF-MORT-COMBINED           VALUE 'C'.
  4228                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4229                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4230             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4231             20  CF-MORT-AGE-METHOD         PIC XX.
  4232                 88  CF-AGE-LAST                VALUE 'AL'.
  4233                 88  CF-AGE-NEAR                VALUE 'AN'.
  4234             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4235             20  CF-MORT-ADJUSTMENT-DIRECTION
  4236                                            PIC X.
  4237                 88  CF-MINUS                   VALUE '-'.
  4238                 88  CF-PLUS                    VALUE '+'.
  4239             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4240             20  CF-MORT-JOINT-CODE         PIC X.
  4241                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4242             20  CF-MORT-PC-Q               PIC X.
  4243                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4244             20  CF-MORT-TABLE-CODE         PIC X(4).
  4245             20  CF-MORT-COMMENTS           PIC X(15).
  4246             20  FILLER                     PIC X(14).
  4247
  4248         16  FILLER                         PIC X(251).
  4249
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6501.cbl
  4250
  4251****************************************************************
  4252*             BUSSINESS TYPE MASTER RECORD                     *
  4253****************************************************************
  4254
  4255     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4256* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4257* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4258* AND RECORD 05 IS TYPES 81-99
  4259         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4260             20  CF-BUSINESS-TITLE          PIC  X(19).
  4261             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4262                                            PIC S9V9(4) COMP-3.
  4263             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4264             20  FILLER                     PIC  X.
  4265         16  FILLER                         PIC  X(248).
  4266
  4267
  4268****************************************************************
  4269*             TERMINAL MASTER RECORD                           *
  4270****************************************************************
  4271
  4272     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4273
  4274         16  CF-COMPANY-TERMINALS.
  4275             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4276                                  PIC X(4).
  4277         16  FILLER               PIC X(248).
  4278
  4279
  4280****************************************************************
  4281*             LIFE EDIT MASTER RECORD                          *
  4282****************************************************************
  4283
  4284     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4285         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4286             20  CF-LIFE-CODE-IN            PIC XX.
  4287             20  CF-LIFE-CODE-OUT           PIC XX.
  4288         16  FILLER                         PIC X(248).
  4289
  4290
  4291****************************************************************
  4292*             AH EDIT MASTER RECORD                            *
  4293****************************************************************
  4294
  4295     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4296         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4297             20  CF-AH-CODE-IN              PIC XXX.
  4298             20  CF-AH-CODE-OUT             PIC XX.
  4299         16  FILLER                         PIC X(248).
  4300
  4301
  4302****************************************************************
  4303*             CREDIBILITY TABLES                               *
  4304****************************************************************
  4305
  4306     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4307         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6501.cbl
  4308                             INDEXED BY CF-CRDB-NDX.
  4309             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4310             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4311             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4312         16  FILLER                         PIC  X(332).
  4313
  4314
  4315****************************************************************
  4316*             REPORT CUSTOMIZATION RECORD                      *
  4317****************************************************************
  4318
  4319     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4320         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4321             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4322             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4323             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4324**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4325****       A T-TRANSFER.                                   ****
  4326             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4327
  4328         16  FILLER                         PIC XX.
  4329
  4330         16  CF-CARRIER-CNTL-OPT.
  4331             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4332                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4333                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4334             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4335                                            PIC X.
  4336         16  CF-GROUP-CNTL-OPT.
  4337             20  CF-GROUP-OPT-SEQ           PIC 9.
  4338                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4339                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4340             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4341                                            PIC X(6).
  4342         16  CF-STATE-CNTL-OPT.
  4343             20  CF-STATE-OPT-SEQ           PIC 9.
  4344                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4345                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4346             20  CF-STATE-SELECT OCCURS 3 TIMES
  4347                                            PIC XX.
  4348         16  CF-ACCOUNT-CNTL-OPT.
  4349             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4350                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4351                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4352             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4353                                            PIC X(10).
  4354         16  CF-BUS-TYP-CNTL-OPT.
  4355             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4356                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4357                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4358             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4359                                            PIC XX.
  4360         16  CF-LF-TYP-CNTL-OPT.
  4361             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4362                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4363                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4364             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4365                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6501.cbl
  4366         16  CF-AH-TYP-CNTL-OPT.
  4367             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4368                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4369                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4370             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4371                                            PIC XX.
  4372         16  CF-REPTCD1-CNTL-OPT.
  4373             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4374                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4375                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4376             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4377                                            PIC X(10).
  4378         16  CF-REPTCD2-CNTL-OPT.
  4379             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4380                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4381                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4382             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4383                                            PIC X(10).
  4384         16  CF-USER1-CNTL-OPT.
  4385             20  CF-USER1-OPT-SEQ           PIC 9.
  4386                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4387                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4388             20  CF-USER1-SELECT OCCURS 3 TIMES
  4389                                            PIC X(10).
  4390         16  CF-USER2-CNTL-OPT.
  4391             20  CF-USER2-OPT-SEQ           PIC 9.
  4392                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4393                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4394             20  CF-USER2-SELECT OCCURS 3 TIMES
  4395                                            PIC X(10).
  4396         16  CF-USER3-CNTL-OPT.
  4397             20  CF-USER3-OPT-SEQ           PIC 9.
  4398                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4399                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4400             20  CF-USER3-SELECT OCCURS 3 TIMES
  4401                                            PIC X(10).
  4402         16  CF-USER4-CNTL-OPT.
  4403             20  CF-USER4-OPT-SEQ           PIC 9.
  4404                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4405                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4406             20  CF-USER4-SELECT OCCURS 3 TIMES
  4407                                            PIC X(10).
  4408         16  CF-USER5-CNTL-OPT.
  4409             20  CF-USER5-OPT-SEQ           PIC 9.
  4410                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4411                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4412             20  CF-USER5-SELECT OCCURS 3 TIMES
  4413                                            PIC X(10).
  4414         16  CF-REINS-CNTL-OPT.
  4415             20  CF-REINS-OPT-SEQ           PIC 9.
  4416                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4417                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4418             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4419                 24  CF-REINS-PRIME         PIC XXX.
  4420                 24  CF-REINS-SUB           PIC XXX.
  4421
  4422         16  CF-AGENT-CNTL-OPT.
  4423             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6501.cbl
  4424                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4425                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4426             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4427                                            PIC X(10).
  4428
  4429         16  FILLER                         PIC X(43).
  4430
  4431         16  CF-LOSS-RATIO-SELECT.
  4432             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4433             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4434         16  CF-ENTRY-DATE-SELECT.
  4435             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4436             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4437         16  CF-EFFECTIVE-DATE-SELECT.
  4438             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4439             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4440
  4441         16  CF-EXCEPTION-LIST-IND          PIC X.
  4442             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4443
  4444         16  FILLER                         PIC X(318).
  4445
  4446****************************************************************
  4447*                  EXCEPTION REPORTING RECORD                  *
  4448****************************************************************
  4449
  4450     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4451         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4452             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4453
  4454         16  CF-COMBINED-LIFE-AH-OPT.
  4455             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4456             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4457             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4458             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4459
  4460         16  CF-LIFE-OPT.
  4461             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4462             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4463             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4464             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4465             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4466             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4467             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4468             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4469             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4470             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4471
  4472         16  CF-AH-OPT.
  4473             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4474             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4475             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4476             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4477             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4478             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4479             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4480             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4481             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6501.cbl
  4482             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4483
  4484         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4485             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4486             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4487             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4488
  4489         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4490
  4491         16  FILLER                         PIC X(673).
  4492
  4493
  4494****************************************************************
  4495*             MORTGAGE SYSTEM PLAN RECORD                      *
  4496****************************************************************
  4497
  4498     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4499         16  CF-PLAN-TYPE                   PIC X.
  4500             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4501             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4502             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4503         16  CF-PLAN-ABBREV                 PIC XXX.
  4504         16  CF-PLAN-DESCRIPT               PIC X(10).
  4505         16  CF-PLAN-NOTES                  PIC X(20).
  4506         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4507         16  CF-PLAN-UNDERWRITING.
  4508             20  CF-PLAN-TERM-DATA.
  4509                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4510                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4511             20  CF-PLAN-AGE-DATA.
  4512                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4513                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4514                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4515             20  CF-PLAN-BENEFIT-DATA.
  4516                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4517                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4518                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4519                                            PIC S9(7)V99  COMP-3.
  4520         16  CF-PLAN-POLICY-FORMS.
  4521             20  CF-POLICY-FORM             PIC X(12).
  4522             20  CF-MASTER-APPLICATION      PIC X(12).
  4523             20  CF-MASTER-POLICY           PIC X(12).
  4524         16  CF-PLAN-RATING.
  4525             20  CF-RATE-CODE               PIC X(5).
  4526             20  CF-SEX-RATING              PIC X.
  4527                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4528                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4529             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4530             20  CF-SUB-STD-TYPE            PIC X.
  4531                 88  CF-PCT-OF-PREM            VALUE '1'.
  4532                 88  CF-PCT-OF-BENE            VALUE '2'.
  4533         16  CF-PLAN-PREM-TOLERANCES.
  4534             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4535             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4536         16  CF-PLAN-PYMT-TOLERANCES.
  4537             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4538             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4539         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6501.cbl
  4540             20  FILLER                     PIC X.
  4541             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4542             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4543         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4544         16  CF-PLAN-IND-GRP                PIC X.
  4545             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4546                                                     '1'.
  4547             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4548                                                     '2'.
  4549         16  CF-MIB-SEARCH-SW               PIC X.
  4550             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4551             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4552             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4553             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4554         16  CF-ALPHA-SEARCH-SW             PIC X.
  4555             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4556             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4557             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4558             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4559             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4560             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4561             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4562             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4563             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4564             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4565                                                     'A' 'B' 'C'
  4566                                                     'X' 'Y' 'Z'.
  4567         16  CF-EFF-DT-RULE-SW              PIC X.
  4568             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4569             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4570             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4571             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4572             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4573         16  FILLER                         PIC X(4).
  4574         16  CF-HEALTH-QUESTIONS            PIC X.
  4575             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4576         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4577         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4578         16  CF-PLAN-SNGL-JNT               PIC X.
  4579             88  CF-COMBINED-PLAN              VALUE 'C'.
  4580             88  CF-JNT-PLAN                   VALUE 'J'.
  4581             88  CF-SNGL-PLAN                  VALUE 'S'.
  4582         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4583         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4584         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4585         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4586         16  CF-RERATE-CNTL                 PIC  X.
  4587             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4588             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4589             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4590             88  CF-AUTO-RECALC                 VALUE '4'.
  4591         16  CF-BENEFIT-TYPE                PIC  X.
  4592             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4593             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4594         16  CF-POLICY-FEE                  PIC S999V99
  4595                                                    COMP-3.
  4596         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4597         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6501.cbl
  4598         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4599         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4600         16  FILLER                         PIC  X(32).
  4601         16  CF-TERMINATION-FORM            PIC  X(04).
  4602         16  FILLER                         PIC  X(08).
  4603         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4604                                                       COMP-3.
  4605         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4606         16  CF-ISSUE-LETTER                PIC  X(4).
  4607         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4608         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4609             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4610             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4611         16  CF-MP-REFUND-CALC              PIC X.
  4612             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4613             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4614             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4615             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4616             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4617             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4618             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4619             88  CF-MP-REFD-MEAN                VALUE '8'.
  4620         16  CF-ALT-RATE-CODE               PIC  X(5).
  4621
  4622
  4623         16  FILLER                         PIC X(498).
  4624****************************************************************
  4625*             MORTGAGE COMPANY MASTER RECORD                   *
  4626****************************************************************
  4627
  4628     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4629         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4630         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4631             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4632             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4633             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4634             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4635             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4636
  4637         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4638         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4639         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4640         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4641         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4642
  4643         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4644             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4645         16  CF-MP-RECON-USE-IND            PIC X(1).
  4646             88  CF-MP-USE-RECON             VALUE 'Y'.
  4647         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4648             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4649         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4650             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4651             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4652         16  FILLER                         PIC X(1).
  4653         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4654             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4655         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6501.cbl
  4656             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4657             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4658             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4659         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4660             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4661                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4662             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4663                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4664             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4665                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4666             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4667                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4668             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4669                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4670             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4671                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4672         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4673         16  FILLER                         PIC X(7).
  4674         16  CF-MORTG-DESTINATION-SYMBOL.
  4675             20  CF-MORTG-MIB-COMM          PIC X(5).
  4676             20  CF-MORTG-MIB-TERM          PIC X(5).
  4677         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4678             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4679         16  FILLER                         PIC X(03).
  4680         16  CF-MP-CHECK-NO-CONTROL.
  4681             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4682                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4683                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4684                                                ' ' LOW-VALUES.
  4685                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4686                                               VALUE '3'.
  4687         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4688         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4689         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4690             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4691                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4692             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4693                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4694             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4695                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4696             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4697                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4698             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4699                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4700             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4701                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4702         16  CF-MORTG-BILLING-AREA.
  4703             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4704                                            PIC X.
  4705         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4706         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4707         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4708         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4709             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4710             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4711         16  FILLER                         PIC X.
  4712         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4713             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6501.cbl
  4714             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4715         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4716         16  FILLER                         PIC X(8).
  4717         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4718         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4719         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4720         16  CF-ACH-COMPANY-ID.
  4721             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4722                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4723                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4724                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4725             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4726         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4727             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4728         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4729             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4730             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4731         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4732         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4733         16  FILLER                         PIC X(536).
  4734
  4735****************************************************************
  4736*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4737****************************************************************
  4738
  4739     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4740         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4741             20  CF-FEMALE-HEIGHT.
  4742                 24  CF-FEMALE-FT           PIC 99.
  4743                 24  CF-FEMALE-IN           PIC 99.
  4744             20  CF-FEMALE-MIN-WT           PIC 999.
  4745             20  CF-FEMALE-MAX-WT           PIC 999.
  4746         16  FILLER                         PIC X(428).
  4747
  4748     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4749         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4750             20  CF-MALE-HEIGHT.
  4751                 24  CF-MALE-FT             PIC 99.
  4752                 24  CF-MALE-IN             PIC 99.
  4753             20  CF-MALE-MIN-WT             PIC 999.
  4754             20  CF-MALE-MAX-WT             PIC 999.
  4755         16  FILLER                         PIC X(428).
  4756******************************************************************
  4757*             AUTOMATIC ACTIVITY RECORD                          *
  4758******************************************************************
  4759     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4760         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4761             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4762             20  CF-SYS-LETTER-ID           PIC X(04).
  4763             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4764             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4765             20  CF-SYS-RESET-SW            PIC X(01).
  4766             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4767             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4768
  4769         16  FILLER                         PIC X(50).
  4770
  4771         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6501.cbl
  4772             20  CF-USER-ACTIVE-SW          PIC X(01).
  4773             20  CF-USER-LETTER-ID          PIC X(04).
  4774             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4775             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4776             20  CF-USER-RESET-SW           PIC X(01).
  4777             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4778             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4779             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4780
  4781         16  FILLER                         PIC X(246).
  4782*    COPY ERCREIN.
  4783******************************************************************
  4784*                                                                *
  4785*                            ERCREIN                             *
  4786*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4787*                            VMOD=2.010                          *
  4788*                                                                *
  4789*   ONLINE CREDIT SYSTEM                                         *
  4790*                                                                *
  4791*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4792*                                                                *
  4793*   FILE TYPE = VSAM,KSDS                                        *
  4794*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4795*                                                                *
  4796*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4797*       ALTERNATE PATH = NONE                                    *
  4798*                                                                *
  4799*   LOG = NO                                                     *
  4800*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4801*                                                                *
  4802******************************************************************
  4803*                   C H A N G E   L O G
  4804*
  4805* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4806*-----------------------------------------------------------------
  4807*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4808* EFFECTIVE    NUMBER
  4809*-----------------------------------------------------------------
  4810* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4811* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4812******************************************************************
  4813 01  REINSURANCE-RECORD.
  4814     12  RE-RECORD-ID                      PIC XX.
  4815         88  VALID-RE-ID                      VALUE 'RE'.
  4816
  4817     12  RE-CONTROL-PRIMARY.
  4818         16  RE-COMPANY-CD                 PIC X.
  4819         16  RE-KEY.
  4820             20  RE-CODE                   PIC X.
  4821                 88  RE-TABLE-RECORD          VALUE 'A'.
  4822                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4823             20  RE-TABLE                  PIC XXX.
  4824             20  FILLER                    PIC XXX.
  4825         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4826             20  FILLER                    PIC X.
  4827             20  RE-COMPANY.
  4828                 24  RE-COMP-PRIME         PIC XXX.
  4829                 24  RE-COMP-SUB           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6501.cbl
  4830
  4831     12  RE-MAINT-INFORMATION.
  4832         16  RE-LAST-MAINT-DT              PIC XX.
  4833         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4834         16  RE-LAST-MAINT-USER            PIC X(4).
  4835         16  FILLER                        PIC X(10).
  4836
  4837     12  RE-TABLE-DATA.
  4838         16  RE-100-COMP                   PIC 99.
  4839
  4840         16  RE-COMP-INFO    OCCURS 30 TIMES.
  4841             20  RE-REI-COMP-NO.
  4842                 24  RE-REI-COMP           PIC XXX.
  4843                 24  RE-REI-COMP-SUB       PIC XXX.
  4844             20  RE-LF-QC                  PIC X.
  4845             20  RE-AH-QC                  PIC X.
  4846             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  4847             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  4848             20  RE-LFAGE-LO               PIC 99.
  4849             20  RE-LFAGE-HI               PIC 99.
  4850             20  RE-AHAGE-LO               PIC 99.
  4851             20  RE-AHAGE-HI               PIC 99.
  4852             20  RE-LFTRM-LO               PIC S999       COMP-3.
  4853             20  RE-LFTRM-HI               PIC S999       COMP-3.
  4854             20  RE-AHTRM-LO               PIC S999       COMP-3.
  4855             20  RE-AHTRM-HI               PIC S999       COMP-3.
  4856             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  4857             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  4858             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  4859             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  4860             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  4861             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  4862             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  4863             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  4864             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  4865             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  4866             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  4867             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  4868             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  4869             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  4870             20  RE-LF-BEN-CODE            PIC X.
  4871             20  RE-AH-BEN-CODE            PIC X.
  4872             20  RE-INTERACTIVE            PIC X.
  4873             20  RE-REMAINING              PIC X.
  4874             20  RE-LF-RUNOFF-SW           PIC X.
  4875             20  RE-AH-RUNOFF-SW           PIC X.
  4876             20  FILLER                    PIC X(19).
  4877
  4878         16  RE-COMP-INFO-END              PIC X(6).
  4879         16  RE-NSP-ST-CD-LF               PIC XX.
  4880         16  RE-NSP-ST-CD-AH               PIC XX.
  4881         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  4882             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  4883
  4884         16  FILLER                        PIC X(27).
  4885
  4886     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  4887         16  RE-NAME                       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6501.cbl
  4888         16  RE-LF-PE                      PIC X.
  4889         16  RE-AH-PE                      PIC X.
  4890         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  4891         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  4892         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  4893         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  4894         16  RE-PRT-ST                     PIC X.
  4895         16  RE-PRT-OW                     PIC X.
  4896         16  RE-MORT-CODE                  PIC X(4).
  4897         16  RE-CLAIM-CODE                 PIC X.
  4898         16  RE-ZERO-LF-FEE                PIC X.
  4899         16  RE-ZERO-AH-FEE                PIC X.
  4900         16  RE-CEDE-NAME                  PIC X(30).
  4901         16  RE-LF-COMM                    PIC X.
  4902         16  RE-AH-COMM                    PIC X.
  4903         16  RE-LF-TAX                     PIC X.
  4904         16  RE-AH-TAX                     PIC X.
  4905         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  4906         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  4907         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  4908
  4909         16  RE-COMP-CARRIER-SECURITY      PIC X.
  4910             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  4911
  4912         16  RE-LF-CEDING-FEE-BRACKETS.
  4913             20  RE-LF-FEE-METHOD          PIC X.
  4914                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  4915                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  4916                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  4917                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  4918             20  RE-LF-FEE-BASIS           PIC X.
  4919                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  4920                 88  RE-LF-NET-CEDED               VALUE '2'.
  4921                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  4922                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  4923                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  4924                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  4925                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  4926                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  4927             20  FILLER                    PIC XXX.
  4928             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  4929                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  4930                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  4931
  4932         16  RE-AH-CEDING-FEE-BRACKETS.
  4933             20  RE-AH-FEE-METHOD          PIC X.
  4934                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  4935                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  4936                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  4937                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  4938             20  RE-AH-FEE-BASIS           PIC X.
  4939                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  4940                 88  RE-AH-NET-CEDED               VALUE '2'.
  4941                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  4942                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  4943                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  4944                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  4945                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6501.cbl
  4946                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  4947             20  FILLER                    PIC XXX.
  4948             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  4949                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  4950                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  4951
  4952         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  4953
  4954         16  RE-OLD-CEDING-STMT            PIC X.
  4955
  4956         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  4957         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  4958         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  4959         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  4960         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  4961         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  4962         16  RE-REINS-GROUPING-CODE        PIC X(6).
  4963         16  RE-MORT-SW                    PIC X.
  4964         16  RE-CEDING-TYPE-FLAG           PIC X.
  4965             88  RE-NO-CESSION-TYPE                VALUE ' '.
  4966             88  RE-CEDED                          VALUE 'C'.
  4967             88  RE-ASSUMED                        VALUE 'A'.
  4968             88  RE-PHANTOM                        VALUE 'P'.
  4969
  4970         16  RE-CEDING-STMT-OPT-A          PIC X.
  4971             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  4972         16  RE-CEDING-STMT-OPT-B          PIC X.
  4973             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  4974         16  RE-CEDING-STMT-OPT-C          PIC X.
  4975             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  4976         16  RE-CEDING-STMT-OPT-D          PIC X.
  4977             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  4978         16  RE-CEDING-STMT-OPT-E          PIC X.
  4979             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  4980
  4981         16  RE-PRT-CRSV                   PIC X.
  4982
  4983         16  RE-GL-CENTER                  PIC X(4).
  4984
  4985         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  4986
  4987         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  4988
  4989         16  RE-EARN-STOP-CODE             PIC X.
  4990             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  4991             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  4992
  4993         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  4994             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  4995
  4996         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  4997         16  FILLER                        PIC X(2281).
  4998
  4999         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5000
  5001******************************************************************
  5002*    COPY ERCCTBL.
  5003******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6501.cbl
  5004*                                                                *
  5005*                                                                *
  5006*                            ERCCTBL                             *
  5007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5008*                            VMOD=2.003
  5009*                                                                *
  5010*   ONLINE CREDIT SYSTEM                                         *
  5011*                                                                *
  5012*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5013*                                                                *
  5014*   FILE TYPE = VSAM,KSDS                                        *
  5015*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5016*                                                                *
  5017*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5018*       ALTERNATE PATH = NONE                                    *
  5019*                                                                *
  5020*   LOG = NO                                                     *
  5021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5022*                                                                *
  5023*                                                                *
  5024******************************************************************
  5025
  5026 01  COMM-TABLE-RECORD.
  5027     12  CT-RECORD-ID                      PIC XX.
  5028         88  VALID-CT-ID                      VALUE 'CT'.
  5029
  5030     12  CT-CONTROL-PRIMARY.
  5031         16  CT-COMPANY-CD                 PIC X.
  5032         16  CT-TABLE                      PIC XXX.
  5033         16  CT-CNTRL-2.
  5034             20  CT-BEN-TYPE               PIC X.
  5035             20  CT-BEN-CODE               PIC XX.
  5036
  5037     12  CT-MAINT-INFORMATION.
  5038         16  CT-LAST-MAINT-DT              PIC XX.
  5039         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5040         16  CT-LAST-MAINT-USER            PIC X(4).
  5041         16  FILLER                        PIC X(31).
  5042
  5043     12  CT-LIMITS.
  5044         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5045
  5046         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5047
  5048         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5049
  5050     12  CT-RATES.
  5051         16  CT-RTX          OCCURS 27 TIMES.
  5052             20  CT-RT                     PIC SV9(5)     COMP-3.
  5053             20  CT-RT-R   REDEFINES
  5054                 CT-RT                     PIC XXX.
  5055
  5056     12  FILLER                            PIC  X(42).
  5057
  5058******************************************************************
  5059*                                COPY ERCACNT.
  5060******************************************************************
  5061*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6501.cbl
  5062*                                                                *
  5063*                            ERCACNT.                            *
  5064*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5065*                            VMOD=2.002                          *
  5066*                                                                *
  5067*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5068*                                                                *
  5069*   FILE TYPE = VSAM,KSDS                                        *
  5070*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5071*                                                                *
  5072*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5073*       ALTERNATE INDEX = NONE                                   *
  5074*                                                                *
  5075*                                                                *
  5076*   LOG = YES                                                    *
  5077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5078******************************************************************
  5079*                   C H A N G E   L O G
  5080*
  5081* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5082*-----------------------------------------------------------------
  5083*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5084* EFFECTIVE    NUMBER
  5085*-----------------------------------------------------------------
  5086* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5087*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5088******************************************************************
  5089 01  NOTE-FILE.
  5090     12  NT-FILE-ID                  PIC XX.
  5091         88  VALID-NOTE-ID              VALUE 'NT'.
  5092
  5093     12  NT-CONTROL-PRIMARY.
  5094         16  NT-COMPANY-CD           PIC X.
  5095         16  NT-ACCT-NOTE-KEY.
  5096             18  NT-CARRIER              PIC X.
  5097             18  NT-GROUPING             PIC X(06).
  5098             18  NT-STATE                PIC XX.
  5099             18  NT-ACCOUNT              PIC X(10).
  5100         16  NT-RECORD-TYPE          PIC X.
  5101              88  ACCT-NOTE          VALUE '1'.
  5102              88  ACCT-BRANCH-LOC    VALUE '2'.
  5103              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5104         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5105
  5106     12  NT-LAST-MAINT-DT            PIC XX.
  5107     12  NT-LAST-MAINT-BY            PIC X(4).
  5108     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5109
  5110*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5111*     SEQUENCE NUMBERS
  5112     12  NT-NOTE-INFORMATION.
  5113         16  NT-NOTE-LINE            PIC X(60).
  5114         16  FILLER                  PIC X(25).
  5115*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5116     12  NT-LOCATION-INFORMATION REDEFINES
  5117                         NT-NOTE-INFORMATION.
  5118         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5119         16  FILLER                  PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6501.cbl
  5120*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5121*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5122*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5123*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5124*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5125*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5126*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5127     12  NT-SHIPPING-INFORMATION REDEFINES
  5128                         NT-NOTE-INFORMATION.
  5129         16  NT-SHIPPING-LINE        PIC X(60).
  5130         16  NT-SHIP-STATE           PIC XX.
  5131         16  NT-SHIP-ZIP             PIC X(10).
  5132         16  FILLER                  PIC X(13).
  5133*****************************************************************
  5134
  5135 01  COMMISSION-WORK-AREA.
  5136     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5137         10  WK-AM-AGT           PIC X(10).
  5138         10  WK-AM-TYPE          PIC X.
  5139         10  WK-FILLER           PIC X(13).
  5140         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6501.cbl
  5142*    COPY ERCCOMP.
  5143******************************************************************
  5144*                                                                *
  5145*                                                                *
  5146*                            ERCCOMP                             *
  5147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5148*                            VMOD=2.019                          *
  5149*                                                                *
  5150*   ONLINE CREDIT SYSTEM                                         *
  5151*                                                                *
  5152*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5153*                                                                *
  5154*   FILE TYPE = VSAM,KSDS                                        *
  5155*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5156*                                                                *
  5157*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5158*       ALTERNATE PATH = NONE                                    *
  5159*                                                                *
  5160*   LOG = NO                                                     *
  5161*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5162*                                                                *
  5163******************************************************************
  5164*                   C H A N G E   L O G
  5165*
  5166* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5167*-----------------------------------------------------------------
  5168*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5169* EFFECTIVE    NUMBER
  5170*-----------------------------------------------------------------
  5171* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5172* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5173* 092205    2005050300006  PEMA  ADD LEASE FEE
  5174* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5175* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5176* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5177* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5178* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5179* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5180******************************************************************
  5181
  5182 01  COMPENSATION-MASTER.
  5183     12  CO-RECORD-ID                          PIC XX.
  5184         88  VALID-CO-ID                          VALUE 'CO'.
  5185
  5186     12  CO-CONTROL-PRIMARY.
  5187         16  CO-COMPANY-CD                     PIC X.
  5188         16  CO-CONTROL.
  5189             20  CO-CTL-1.
  5190                 24  CO-CARR-GROUP.
  5191                     28  CO-CARRIER            PIC X.
  5192                     28  CO-GROUPING.
  5193                         32  CO-GROUP-PREFIX   PIC XXX.
  5194                         32  CO-GROUP-PRIME    PIC XXX.
  5195                 24  CO-RESP-NO.
  5196                     28  CO-RESP-PREFIX        PIC X(4).
  5197                     28  CO-RESP-PRIME         PIC X(6).
  5198             20  CO-CTL-2.
  5199                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6501.cbl
  5200                     28  CO-ACCT-PREFIX        PIC X(4).
  5201                     28  CO-ACCT-PRIME         PIC X(6).
  5202         16  CO-TYPE                           PIC X.
  5203             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5204             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5205             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5206
  5207     12  CO-MAINT-INFORMATION.
  5208         16  CO-LAST-MAINT-DT                  PIC XX.
  5209         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5210         16  CO-LAST-MAINT-USER                PIC X(4).
  5211     12  FILLER                                PIC XX.
  5212     12  CO-STMT-TYPE                          PIC XXX.
  5213     12  CO-COMP-TYPE                          PIC X.
  5214         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5215     12  CO-STMT-OWNER                         PIC X(4).
  5216     12  CO-BALANCE-CONTROL                    PIC X.
  5217         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5218         88  CO-NO-BALANCE                        VALUE 'N'.
  5219
  5220     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5221         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5222         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5223         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5224
  5225     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5226         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5227         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5228
  5229     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5230     12  CO-GA-DIRECT-DEP                      PIC X.
  5231     12  CO-FUTURE-SPACE                       PIC X.
  5232         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5233
  5234     12  CO-ACCT-NAME                          PIC X(30).
  5235     12  CO-MAIL-NAME                          PIC X(30).
  5236     12  CO-ADDR-1                             PIC X(30).
  5237     12  CO-ADDR-2                             PIC X(30).
  5238     12  CO-ADDR-3.
  5239         16  CO-ADDR-CITY                      PIC X(27).
  5240         16  CO-ADDR-STATE                     PIC XX.
  5241     12  CO-CSO-1099                           PIC X.
  5242     12  CO-ZIP.
  5243         16  CO-ZIP-PRIME.
  5244             20  CO-ZIP-PRI-1ST                PIC X.
  5245                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5246             20  FILLER                        PIC X(4).
  5247         16  CO-ZIP-PLUS4                      PIC X(4).
  5248     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5249         16  CO-CAN-POSTAL-1                   PIC XXX.
  5250         16  CO-CAN-POSTAL-2                   PIC XXX.
  5251         16  FILLER                            PIC XXX.
  5252     12  CO-SOC-SEC                            PIC X(13).
  5253     12  CO-TELEPHONE.
  5254         16  CO-AREA-CODE                      PIC XXX.
  5255         16  CO-PREFIX                         PIC XXX.
  5256         16  CO-PHONE                          PIC X(4).
  5257
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6501.cbl
  5258     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5259
  5260     12  CO-AR-BAL-LEVEL                       PIC X.
  5261         88  CO-AR-REF-LVL                        VALUE '1'.
  5262         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5263         88  CO-AR-BILL-LVL                       VALUE '2'.
  5264         88  CO-AR-AGT-LVL                        VALUE '3'.
  5265         88  CO-AR-FR-LVL                         VALUE '4'.
  5266
  5267     12  CO-AR-NORMAL-PRINT                    PIC X.
  5268         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5269         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5270
  5271     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5272
  5273     12  CO-AR-REPORTING                       PIC X.
  5274         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5275         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5276
  5277     12  CO-AR-PULL-CHECK                      PIC X.
  5278         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5279         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5280
  5281     12  CO-AR-BALANCE-PRINT                   PIC X.
  5282         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5283
  5284     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5285         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5286         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5287         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5288
  5289     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5290
  5291     12  CO-USER-CODE                          PIC X.
  5292     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5293
  5294******************************************************************
  5295*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5296*    THE LAST MONTH END RUN.
  5297******************************************************************
  5298
  5299     12  CO-LAST-ACTIVITY-DATE.
  5300         16  CO-ACT-YEAR                       PIC 99.
  5301         16  CO-ACT-MONTH                      PIC 99.
  5302         16  CO-ACT-DAY                        PIC 99.
  5303
  5304     12  CO-LAST-STMT-DT.
  5305         16  CO-LAST-STMT-YEAR                 PIC 99.
  5306         16  CO-LAST-STMT-MONTH                PIC 99.
  5307         16  CO-LAST-STMT-DAY                  PIC 99.
  5308
  5309     12  CO-MO-END-TOTALS.
  5310         16  CO-MONTHLY-TOTALS.
  5311             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5312             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5313             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5314             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5315             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6501.cbl
  5316
  5317         16  CO-AGING-TOTALS.
  5318             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5319             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5320             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5321             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5322
  5323         16  CO-YTD-TOTALS.
  5324             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5325             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5326
  5327         16  CO-OVER-UNDER-TOTALS.
  5328             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5329             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5330
  5331     12  CO-MISCELLANEOUS-TOTALS.
  5332         16  CO-FICA-TOTALS.
  5333             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5334             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5335
  5336         16  CO-CLAIM-TOTALS.
  5337             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5338             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5339
  5340******************************************************************
  5341*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5342*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5343******************************************************************
  5344
  5345     12  CO-CURRENT-TOTALS.
  5346         16  CO-CURRENT-LAST-STMT-DT.
  5347             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5348             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5349             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5350
  5351         16  CO-CURRENT-MONTHLY-TOTALS.
  5352             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5353             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5354             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5355             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5356             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5357
  5358         16  CO-CURRENT-AGING-TOTALS.
  5359             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5360             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5361             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5362             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5363
  5364         16  CO-CURRENT-YTD-TOTALS.
  5365             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5366             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5367
  5368     12  CO-PAID-COMM-TOTALS.
  5369         16  CO-YTD-PAID-COMMS.
  5370             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5371             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5372
  5373     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6501.cbl
  5374         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5375         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5376
  5377     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5378         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5379         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5380         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5381         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5382         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5383         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5384         88  CO-FINAL-LETTER                  VALUE 'F'.
  5385         88  CO-RECONCILING                   VALUE 'R'.
  5386         88  CO-PHONE-CALL                    VALUE 'P'.
  5387         88  CO-LEGAL                         VALUE 'L'.
  5388         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5389         88  CO-WRITE-OFF                     VALUE 'W'.
  5390         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5391
  5392     12  CO-CSR-CODE                       PIC X(4).
  5393
  5394     12  CO-GA-STATUS-INFO.
  5395         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5396         16  CO-GA-TERMINATION-DT          PIC XX.
  5397         16  CO-GA-STATUS-CODE             PIC X.
  5398             88  CO-GA-ACTIVE                 VALUE 'A'.
  5399             88  CO-GA-INACTIVE               VALUE 'I'.
  5400             88  CO-GA-PENDING                VALUE 'P'.
  5401         16  CO-GA-COMMENTS.
  5402             20  CO-GA-COMMENT-1           PIC X(40).
  5403             20  CO-GA-COMMENT-2           PIC X(40).
  5404             20  CO-GA-COMMENT-3           PIC X(40).
  5405             20  CO-GA-COMMENT-4           PIC X(40).
  5406
  5407     12  CO-RPTCD2                         PIC X(10).
  5408     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5409         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5410         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5411
  5412     12  CO-TYPE-AGENT                     PIC X(01).
  5413         88  CO-CORPORATION                   VALUE 'C'.
  5414         88  CO-PARTNERSHIP                   VALUE 'P'.
  5415         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5416         88  CO-TRUST                         VALUE 'T'.
  5417         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5418
  5419     12  CO-FAXNO.
  5420         16  CO-FAX-AREA-CODE                  PIC XXX.
  5421         16  CO-FAX-PREFIX                     PIC XXX.
  5422         16  CO-FAX-PHONE                      PIC X(4).
  5423
  5424     12  CO-BANK-INFORMATION.
  5425         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5426         16  CO-BANK-TRANSIT-NON REDEFINES
  5427             CO-BANK-TRANSIT-NO                PIC 9(8).
  5428
  5429         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5430     12  CO-MISC-DEDUCT-INFO REDEFINES
  5431                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6501.cbl
  5432         16  CO-MD-GL-ACCT                     PIC X(10).
  5433         16  CO-MD-DIV                         PIC XX.
  5434         16  CO-MD-CENTER                      PIC X(4).
  5435         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5436         16  CO-CREATE-AP-CHECK                PIC X.
  5437         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5438         16  FILLER                            PIC XXX.
  5439     12  CO-ACH-STATUS                         PIC X.
  5440         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5441         88  CO-ACH-PENDING                        VALUE 'P'.
  5442
  5443     12  CO-BILL-SW                            PIC X.
  5444     12  CO-CONTROL-NAME                       PIC X(30).
  5445     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5446     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5447     12  CO-CLP-STATE                          PIC XX.
  5448     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5449     12  CO-SPP-REFUND-EDIT                    PIC X.
  5450
  5451******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6501.cbl
  5453*    COPY ERCNAME.
  5454******************************************************************
  5455*                                                                *
  5456*                                                                *
  5457*                            ERCNAME                             *
  5458*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5459*                            VMOD=2.003                          *
  5460*                                                                *
  5461*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5462*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5463*                                                                *
  5464*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5465*                                                                *
  5466*   FILE TYPE = VSAM,KSDS                                        *
  5467*   RECORD SIZE = 160   RECFORM = FIX                            *
  5468*                                                                *
  5469*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5470*                                                                *
  5471*   LOG = NO                                                     *
  5472*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5473*                                                                *
  5474*                                                                *
  5475******************************************************************
  5476
  5477 01  NAME-LOOKUP-MASTER.
  5478     12  NL-RECORD-ID                PIC  X(02).
  5479         88  VALID-NL-ID                         VALUE 'NL'.
  5480
  5481     12  NL-RECORD-KEY.
  5482         16  NL-CONTROL-PRIMARY.
  5483             20  NL-COMPANY-CD       PIC  X(01).
  5484             20  NL-NAME             PIC  X(30).
  5485             20  NL-RECORD-TYPE      PIC  X(01).
  5486                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5487                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5488                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5489
  5490         16  NL-ACCOUNT-MASTER.
  5491             20  NL-AM-COMPANY-CD    PIC  X(01).
  5492             20  NL-AM-CARRIER       PIC  X(01).
  5493             20  NL-AM-GROUPING      PIC  X(06).
  5494             20  NL-AM-STATE         PIC  X(02).
  5495             20  NL-AM-ACCOUNT       PIC  X(10).
  5496             20  FILLER              PIC  X(09).
  5497
  5498         16  NL-COMPENSATION-MASTER
  5499                                 REDEFINES  NL-ACCOUNT-MASTER.
  5500             20  NL-CO-COMPANY-CD    PIC  X(01).
  5501             20  NL-CO-CARRIER       PIC  X(01).
  5502             20  NL-CO-GROUPING      PIC  X(06).
  5503             20  NL-CO-RESP-NO       PIC  X(10).
  5504             20  NL-CO-ACCOUNT       PIC  X(10).
  5505             20  NL-CO-TYPE          PIC  X(01).
  5506
  5507         16  NL-REINSURANCE-RECORD
  5508                                 REDEFINES  NL-ACCOUNT-MASTER.
  5509             20  NL-RE-COMPANY-CD    PIC  X(01).
  5510             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6501.cbl
  5511             20  NL-RE-COMPANY.
  5512                 24  NL-RE-COMP      PIC  X(03).
  5513                 24  NL-RE-CO-SUB    PIC  X(03).
  5514             20  NL-RE-TABLE         PIC  X(03).
  5515             20  FILLER              PIC  X(18).
  5516
  5517     12  NL-MAINT-INFORMATION.
  5518         16  NL-LAST-MAINT-DT        PIC  X(02).
  5519         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5520         16  NL-LAST-MAINT-USER      PIC  X(04).
  5521         16  FILLER                  PIC  X(10).
  5522
  5523     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5524         16  NL-RE-LEVEL             PIC  9(02).
  5525
  5526     12  NL-CITY                     PIC  X(15).
  5527     12  NL-ST                       PIC  XX.
  5528
  5529******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6501.cbl
  5531*    COPY ERCRQST.
  5532******************************************************************
  5533*                                                                *
  5534*                                                                *
  5535*                            ERCRQST.                            *
  5536*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5537*                            VMOD=2.002                          *
  5538*                                                                *
  5539*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5540*                                                                *
  5541*   FILE TYPE = VSAM,KSDS                                        *
  5542*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5543*                                                                *
  5544*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5545*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5546*                                   ACCOUNT, REF, BATCH)         *
  5547*                                                RKP=9, LEN=38   *
  5548*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5549*                                   ACCOUNT, REF, BATCH)         *
  5550*                                                RKP=47, LEN=46  *
  5551*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5552*                                   BATCH)                       *
  5553*                                                RKP=93, LEN=24  *
  5554*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5555*                                   REF, BATCH)                  *
  5556*                                                RKP=117, LEN=35 *
  5557*   LOG = NO                                                     *
  5558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5559******************************************************************
  5560
  5561 01  AR-REQUEST-RECORD.
  5562     12  RQ-RECORD-ID                     PIC XX.
  5563         88  VALID-RQ-ID                        VALUE 'RQ'.
  5564
  5565     12  RQ-CONTROL-PRIMARY.
  5566         16  RQ-COMPANY-CD                PIC X.
  5567         16  RQ-ENTRY-BATCH               PIC X(6).
  5568
  5569     12  RQ-CONTROL-BY-ACCT-REF.
  5570         16  RQ-COMPANY-CD-A1             PIC X.
  5571         16  RQ-CARRIER-A1                PIC X.
  5572         16  RQ-GROUPING-A1               PIC X(6).
  5573         16  RQ-STATE-A1                  PIC XX.
  5574         16  RQ-ACCOUNT-A1                PIC X(10).
  5575         16  RQ-REFERENCE-A1              PIC X(12).
  5576         16  RQ-BATCH-A1                  PIC X(6).
  5577
  5578     12  RQ-CONTROL-BY-FIN-RESP.
  5579         16  RQ-COMPANY-CD-A2             PIC X.
  5580         16  RQ-CARRIER-A2                PIC X.
  5581         16  RQ-GROUPING-A2               PIC X(6).
  5582         16  RQ-FIN-RESP-A2               PIC X(10).
  5583         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5584         16  RQ-REFERENCE-A2              PIC X(12).
  5585         16  RQ-BATCH-A2                  PIC X(6).
  5586
  5587     12  RQ-CONTROL-BY-ACCT-AGENT.
  5588         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6501.cbl
  5589         16  RQ-CARRIER-A3                PIC X.
  5590         16  RQ-GROUPING-A3               PIC X(6).
  5591         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5592         16  RQ-BATCH-A3                  PIC X(6).
  5593
  5594     12  RQ-CONTROL-BY-SUMMARY.
  5595         16  RQ-COMPANY-CD-A4             PIC X.
  5596         16  RQ-SUMMARY-CODE              PIC X(6).
  5597         16  RQ-ACCOUNT-A4                PIC X(10).
  5598         16  RQ-REFERENCE-A4              PIC X(12).
  5599         16  RQ-BATCH-A4                  PIC X(6).
  5600
  5601     12  RQ-REQUEST-METHOD                PIC X.
  5602         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5603         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5604         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5605         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5606     12  FILLER                           PIC X.
  5607     12  RQ-STATUS                        PIC X.
  5608         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5609         88  RQ-RESUBMIT                      VALUE 'R'.
  5610     12  RQ-PROCESSOR-ID                  PIC X(4).
  5611     12  RQ-ENTRY-DT                      PIC XX.
  5612     12  RQ-MO-END-DT                     PIC XX.
  5613     12  RQ-REQUEST-DT                    PIC XX.
  5614     12  RQ-STMT-DT                       PIC XX.
  5615     12  RQ-REVERSAL-DT                   PIC XX.
  5616     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5617     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5618
  5619     12  FILLER                           PIC X(27).
  5620
  5621******************************************************************
  5622
  5623*EJECT
  5624*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6501.cbl
  5626 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5627                          CONTROL-FILE REINSURANCE-RECORD
  5628                          COMM-TABLE-RECORD NOTE-FILE
  5629                          COMMISSION-WORK-AREA
  5630                          COMPENSATION-MASTER
  5631                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5632 0000-DFHEXIT SECTION.
  5633     MOVE '9#                    $   ' TO DFHEIV0.
  5634     MOVE 'EL6501' TO DFHEIV1.
  5635     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5636     MOVE EIBTRMID              TO QID-TERM.
  5637
  5638     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5639     MOVE '5'                   TO DC-OPTION-CODE.
  5640     PERFORM 9700-DATE-LINK.
  5641     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5642     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5643
  5644***  Y2K PROJ 7744
  5645     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5646                                    CURRENT-SAVE
  5647     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5648                                    CURRENT-SAVE(1:2)
  5649***  Y2K PROJ 7744
  5650
  5651     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5652     IF EIBCALEN = 0
  5653         GO TO 8800-UNAUTHORIZED-ACCESS.
  5654
  5655     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5656     MOVE LOW-VALUES             TO EL6501AI.
  5657
  5658
  5659* EXEC CICS HANDLE CONDITION
  5660*        PGMIDERR  (9600-PGMID-ERROR)
  5661*        ERROR     (9990-ABEND)
  5662*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5663*    END-EXEC.
  5664*    MOVE '"$L.N                 ! " #00005654' TO DFHEIV0
  5665     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5667     MOVE X'2220233030303035363534' TO DFHEIV0(25:11)
  5668     CALL 'kxdfhei1' USING DFHEIV0
  5669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5670
  5671
  5672     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5673         IF PI-CALLING-PROGRAM = XCTL-650
  5674             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5675             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5676             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5677             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5678             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5679             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5680             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5681             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5682             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5683             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL6501.cbl
  5684         ELSE
  5685             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5686             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5687             GO TO 0600-DISPLAY-RECORD.
  5688
  5689     IF EIBAID = DFHCLEAR
  5690         GO TO 9400-CLEAR.
  5691
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL6501.cbl
  5693 0200-RECEIVE.
  5694     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5695         MOVE ER-0008            TO EMI-ERROR
  5696         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5697         MOVE -1                 TO PFENTERL
  5698         GO TO 8200-SEND-DATAONLY.
  5699
  5700
  5701* EXEC CICS RECEIVE
  5702*        MAP      (MAP-NAME)
  5703*        MAPSET   (MAPSET-NAME)
  5704*        INTO     (EL6501AI)
  5705*    END-EXEC.
  5706     MOVE LENGTH OF
  5707      EL6501AI
  5708       TO DFHEIV11
  5709*    MOVE '8"T I  L              ''   #00005688' TO DFHEIV0
  5710     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5711     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5712     MOVE X'2020233030303035363838' TO DFHEIV0(25:11)
  5713     CALL 'kxdfhei1' USING DFHEIV0,
  5714           MAP-NAME,
  5715           EL6501AI,
  5716           DFHEIV11,
  5717           MAPSET-NAME,
  5718           DFHEIV99,
  5719           DFHEIV99
  5720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5721
  5722
  5723     IF PFENTERL = 0
  5724         GO TO 0300-CHECK-PFKEYS.
  5725     IF EIBAID NOT = DFHENTER
  5726         MOVE ER-0004            TO EMI-ERROR
  5727         GO TO 0320-INPUT-ERROR.
  5728     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5729         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5730     ELSE
  5731         MOVE ER-0029            TO EMI-ERROR
  5732         GO TO 0320-INPUT-ERROR.
  5733
  5734 0300-CHECK-PFKEYS.
  5735     IF EIBAID = DFHPF23
  5736         GO TO 8810-PF23.
  5737     IF EIBAID = DFHPF24
  5738         GO TO 9200-RETURN-MAIN-MENU.
  5739     IF EIBAID = DFHPF12
  5740         GO TO 9500-PF12.
  5741
  5742* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5743*             MASTER(ERRESC)
  5744*
  5745*    IF  EIBAID = DFHPF10
  5746*        IF PI-COMPANY-ID = 'DMD'
  5747*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5748*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5749*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5750*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL6501.cbl
  5751*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5752*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5753*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5754*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5755*           MOVE XCTL-608           TO PGM-NAME
  5756*                                      PI-RETURN-TO-PROGRAM
  5757*                                      PI-CALLING-PROGRAM
  5758*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5759*           GO TO 9300-XCTL.
  5760
  5761     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5762                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5763                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5764         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5765             MOVE ER-0029        TO  EMI-ERROR
  5766             GO TO 0320-INPUT-ERROR
  5767         ELSE
  5768             GO TO 0800-CHECK-MAINT.
  5769
  5770     IF EIBAID = DFHENTER
  5771         GO TO 0330-EDIT-DATA.
  5772
  5773     MOVE ER-0029                TO EMI-ERROR.
  5774
  5775 0320-INPUT-ERROR.
  5776     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5777     MOVE AL-UNBON               TO PFENTERA.
  5778     MOVE -1                     TO PFENTERL.
  5779     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL6501.cbl
  5781 0330-EDIT-DATA.
  5782     IF MAINTI  = 'S'
  5783        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5784        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5785        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5786        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5787        MOVE -1                  TO MAINTL
  5788        GO TO 8100-SEND-INITIAL-MAP.
  5789
  5790     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5791     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5792
  5793     IF EMI-ERROR NOT = ZEROS
  5794         MOVE -1                 TO MAINTL
  5795         GO TO 8200-SEND-DATAONLY.
  5796
  5797     IF NOT MODIFY-CAP
  5798         MOVE 'UPDATE'           TO SM-READ
  5799         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5800         MOVE ER-0070            TO EMI-ERROR
  5801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5802         GO TO 8100-SEND-INITIAL-MAP.
  5803
  5804     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5805
  5806     IF MAINTI = 'A'
  5807        GO TO 1000-ADD-A-RECORD.
  5808
  5809     IF MAINTI = 'C'
  5810        IF PI-SV-MAINT  =  'L'
  5811            MOVE -1             TO MAINTL
  5812            MOVE AL-UABON       TO MAINTA
  5813            MOVE ER-0899        TO EMI-ERROR
  5814            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5815            GO TO 8200-SEND-DATAONLY
  5816        ELSE
  5817            GO TO 2000-CHANGE-A-RECORD.
  5818
  5819     IF MAINTI = 'L'
  5820        MOVE 'L'                TO PI-SV-MAINT
  5821        GO TO 3000-CHANGE-ALL-RECORDS.
  5822
  5823     MOVE ER-0023                TO EMI-ERROR.
  5824     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5825     MOVE -1                     TO MAINTL.
  5826     MOVE AL-UABON               TO MAINTA.
  5827     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL6501.cbl
  5829 0500-CHECK-MAINT-TYPE.
  5830     IF PI-MAINT = 'A'
  5831        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5832        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5833        MOVE -1                  TO NAMEL
  5834        GO TO 8100-SEND-INITIAL-MAP.
  5835
  5836 0600-DISPLAY-RECORD.
  5837     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5838     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  5839     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  5840     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  5841
  5842     IF PI-MAINT = 'A'
  5843        MOVE -1                  TO NAMEL
  5844     ELSE
  5845        MOVE -1                  TO MAINTL.
  5846
  5847     GO TO 8100-SEND-INITIAL-MAP.
  5848
  5849 0700-FORMAT-KEYDATA.
  5850     MOVE PI-MAINT               TO MAINTI.
  5851
  5852     IF PI-MAINT = 'A'
  5853        MOVE AL-PANON            TO MAINTA
  5854        SET T-INDEX TO 1
  5855     ELSE
  5856        SET T-INDEX              TO PI-LINE-SELECTED
  5857        MOVE AL-UANON            TO MAINTA.
  5858
  5859     IF PI-2ND-PAGE
  5860         SET T-INDEX UP BY 8
  5861     ELSE
  5862     IF PI-3RD-PAGE
  5863         SET T-INDEX UP BY 16
  5864     ELSE
  5865     IF PI-LST-PAGE
  5866         SET T-INDEX UP BY 24.
  5867
  5868     MOVE PI-ACCT-CARRIER        TO CARRI.
  5869     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  5870     MOVE PI-ACCT-STATE          TO STATEI.
  5871     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  5872
  5873     IF PI-ACCT-EXP-DT = LOW-VALUES
  5874        MOVE SPACES              TO EXPDTEI
  5875     ELSE
  5876        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  5877           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  5878           MOVE SPACE               TO DC-OPTION-CODE
  5879           PERFORM 9700-DATE-LINK
  5880           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  5881        ELSE
  5882           MOVE 999999              TO EXPDTEO
  5883           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  5884
  5885***DMD CUSTOM CODE *****START
  5886     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL6501.cbl
  5887     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  5888     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  5889     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  5890        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  5891     ELSE
  5892        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  5893***DMD CUSTOM CODE *****END
  5894
  5895     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  5896     MOVE SPACE                   TO DC-OPTION-CODE.
  5897     PERFORM 9700-DATE-LINK.
  5898     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  5899
  5900 0700-EXIT.
  5901      EXIT.
  5902
  5903 0800-CHECK-MAINT.
  5904     IF PI-MAINT = 'A'
  5905        IF PI-RECORD-NOT-CREATED
  5906           MOVE ER-2071          TO EMI-ERROR
  5907           MOVE  -1              TO NAMEL
  5908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5909           GO TO 8200-SEND-DATAONLY.
  5910
  5911     IF  EIBAID = DFHPF1
  5912             AND
  5913         CREDIT-SESSION
  5914         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5915         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5916         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5917         MOVE PI-ACCT-STATE      TO PI-STATE
  5918         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5919         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  5920         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  5921         MOVE XCTL-689           TO PGM-NAME
  5922         GO TO 9300-XCTL.
  5923
  5924     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  5925         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5926         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5927         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5928         MOVE PI-ACCT-STATE      TO PI-STATE
  5929         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5930         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  5931         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  5932         MOVE XCTL-690           TO PGM-NAME
  5933         GO TO 9300-XCTL
  5934     END-IF.
  5935
  5936     IF EIBAID = DFHPF3
  5937             AND
  5938         CREDIT-SESSION
  5939         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5940         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  5941         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  5942         MOVE PI-ACCT-STATE      TO PI-STATE
  5943         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  5944         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL6501.cbl
  5945         MOVE XCTL-653           TO PGM-NAME
  5946         GO TO 9300-XCTL.
  5947
  5948     IF EIBAID = DFHPF4
  5949         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  5950         MOVE XCTL-652           TO PGM-NAME
  5951         GO TO 9300-XCTL.
  5952
  5953     IF EIBAID = DFHPF5
  5954         MOVE XCTL-6502          TO PGM-NAME
  5955         GO TO 9300-XCTL.
  5956
  5957     IF EIBAID = DFHPF7
  5958         MOVE XCTL-6504          TO PGM-NAME
  5959         GO TO 9300-XCTL.
  5960
  5961     IF EIBAID = DFHPF8
  5962         MOVE XCTL-6506          TO PGM-NAME
  5963         GO TO 9300-XCTL.
  5964
  5965     IF EIBAID = DFHPF9
  5966        MOVE XCTL-6505           TO PGM-NAME
  5967        GO TO 9300-XCTL.
  5968
  5969     IF EIBAID = DFHPF10
  5970        IF PI-COMPANY-ID = 'DMD'
  5971           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  5972           MOVE XCTL-608         TO PGM-NAME
  5973           GO TO 9300-XCTL.
  5974
  5975     MOVE ER-0029                TO EMI-ERROR.
  5976     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5977     MOVE AL-UNBON               TO PFENTERA.
  5978     MOVE -1                     TO PFENTERL.
  5979     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL6501.cbl
  5981 1000-ADD-A-RECORD.
  5982     IF PI-MAINT = 'A'
  5983        PERFORM 4000-EDITS THRU 4900-EXIT
  5984     ELSE
  5985        MOVE ER-2180             TO EMI-ERROR
  5986        MOVE -1                  TO MAINTL
  5987        MOVE AL-UABON            TO MAINTA
  5988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5989
  5990     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  5991        EMI-FATAL-CTR    GREATER ZERO
  5992         GO TO 8200-SEND-DATAONLY.
  5993
  5994
  5995* EXEC CICS GETMAIN
  5996*         LENGTH   (ACCT-REC-LEN)
  5997*         SET      (ADDRESS OF ACCOUNT-MASTER)
  5998*         INITIMG  (GETMAIN-SPACE)
  5999*    END-EXEC.
  6000*    MOVE ',"IL                  $   #00005965' TO DFHEIV0
  6001     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6002     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6003     MOVE X'2020233030303035393635' TO DFHEIV0(25:11)
  6004     CALL 'kxdfhei1' USING DFHEIV0,
  6005           DFHEIV20,
  6006           ACCT-REC-LEN,
  6007           GETMAIN-SPACE
  6008     SET ADDRESS OF ACCOUNT-MASTER TO
  6009         DFHEIV20
  6010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6011
  6012
  6013     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6014                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6015                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6016                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6017                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6018                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6019
  6020     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6021                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6022                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6023                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6024                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6025                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6026                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6027                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6028
  6029     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6030                                    AM-AGT-COMMS (2)
  6031                                    AM-AGT-COMMS (3)
  6032                                    AM-AGT-COMMS (4)
  6033                                    AM-AGT-COMMS (5)
  6034                                    AM-AGT-COMMS (6)
  6035                                    AM-AGT-COMMS (7)
  6036                                    AM-AGT-COMMS (8)
  6037                                    AM-AGT-COMMS (9)
  6038                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL6501.cbl
  6039
  6040     IF PI-COMPANY-ID = 'FLI'
  6041         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6042                                    AM-FLI-BANK-1ST-6-PREM
  6043                                    AM-FLI-BANK-CAP-AMT
  6044                                    AM-FLI-AGT-SHARE-PCT (1)
  6045                                    AM-FLI-AGT-SHARE-PCT (2)
  6046                                    AM-FLI-AGT-SHARE-PCT (3)
  6047                                    AM-FLI-AGT-SHARE-PCT (4)
  6048                                    AM-FLI-AGT-SHARE-PCT (5)
  6049                                    AM-FLI-AGT-SHARE-PCT (6)
  6050                                    AM-FLI-AGT-SHARE-PCT (7)
  6051                                    AM-FLI-AGT-SHARE-PCT (8)
  6052                                    AM-FLI-AGT-SHARE-PCT (9)
  6053                                    AM-FLI-AGT-SHARE-PCT (10).
  6054
  6055     MOVE ZEROS                  TO AM-GPCD
  6056                                    AM-LF-RET
  6057                                    AM-AH-RET
  6058                                    AM-LF-OB-RATE
  6059                                    AM-LF-OB-RATE-JNT
  6060                                    AM-AH-OB-RATE
  6061                                    AM-AH-OB-RATE-JNT
  6062                                    AM-REI-FEE-LF
  6063                                    AM-REI-FEE-AH
  6064                                    AM-REI-LF-TAX
  6065                                    AM-REI-PR-PCT
  6066                                    AM-REI-78-PCT
  6067                                    AM-REI-AH-TAX
  6068                                    AM-TOL-PREM
  6069                                    AM-TOL-REF
  6070                                    AM-CLP-TOL-PCT
  6071                                    AM-TOL-CLM
  6072                                    AM-CERTS-PURGED-DATE
  6073                                    AM-HI-CERT-DATE
  6074                                    AM-LO-CERT-DATE
  6075                                    AM-1ST-PROD-DATE
  6076                                    AM-GPCD
  6077                                    AM-CAL-TABLE
  6078                                    AM-LF-DEVIATION
  6079                                    AM-LF-DEVIATION-PCT
  6080                                    AM-AH-DEVIATION
  6081                                    AM-AH-DEVIATION-PCT
  6082                                    AM-ANNIVERSARY-DATE
  6083                                    AM-TEL-NO
  6084                                    AM-ENTRY-DATE
  6085                                    AM-INACTIVE-DATE
  6086                                    AM-RET-MIN-LOSS-L
  6087                                    AM-RET-MIN-LOSS-A
  6088                                    AM-LF-RPT021-EXP-PCT
  6089                                    AM-AH-RPT021-EXP-PCT
  6090                                    AM-MAX-MON-BEN
  6091                                    AM-MAX-TOT-BEN
  6092                                    AM-DCC-MAX-MARKETING-FEE
  6093                                    AM-SPP-LEASE-COMM
  6094                                    AM-RETRO-QUALIFY-LIMIT
  6095                                    AM-RETRO-RET-PCT-LF (1)
  6096                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL6501.cbl
  6097                                    AM-RETRO-RET-PCT-LF (3)
  6098                                    AM-RETRO-RET-THRU-LF (1)
  6099                                    AM-RETRO-RET-THRU-LF (2)
  6100                                    AM-RETRO-RET-THRU-LF (3)
  6101                                    AM-RETRO-RET-PCT-AH (1)
  6102                                    AM-RETRO-RET-PCT-AH (2)
  6103                                    AM-RETRO-RET-PCT-AH (3)
  6104                                    AM-RETRO-RET-THRU-AH (1)
  6105                                    AM-RETRO-RET-THRU-AH (2)
  6106                                    AM-RETRO-RET-THRU-AH (3).
  6107
  6108     IF PI-COMPANY-ID = 'DCC'
  6109        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6110     END-IF
  6111     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6112                                    AM-AR-HI-CERT-DATE.
  6113
  6114     MOVE 'AM'                   TO AM-RECORD-ID.
  6115     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6116                                    AM-CONTROL-BY-VAR-GRP.
  6117
  6118     IF ST-ACCNT-CNTL
  6119        MOVE SPACES              TO AM-VG-CARRIER
  6120                                    AM-VG-GROUPING.
  6121     IF CARR-ST-ACCNT-CNTL
  6122        MOVE SPACES              TO AM-VG-GROUPING.
  6123
  6124     IF ACCNT-CNTL
  6125        MOVE SPACES              TO AM-VG-CARRIER
  6126                                    AM-VG-STATE
  6127                                    AM-VG-GROUPING.
  6128
  6129     IF CARR-ACCNT-CNTL
  6130        MOVE SPACES              TO AM-VG-STATE
  6131                                    AM-VG-GROUPING.
  6132
  6133     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6134     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6135     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6136
  6137     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6138     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6139     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6140
  6141     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6142
  6143     IF PI-COMPANY-ID = 'NCL'
  6144         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6145
  6146     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6147        EMI-FATAL-CTR    GREATER ZERO
  6148         GO TO 8200-SEND-DATAONLY.
  6149
  6150     IF PI-COMPANY-ID = 'DCC'
  6151        IF CLPSTL <= ZEROS
  6152           MOVE ER-0144          TO  EMI-ERROR
  6153           MOVE -1               TO  CLPSTL
  6154           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL6501.cbl
  6155           PERFORM 9900-ERROR-FORMAT
  6156                                 THRU  9900-EXIT
  6157           GO TO 8200-SEND-DATAONLY
  6158        END-IF
  6159     END-IF
  6160     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6161     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6162
  6163     MOVE +1 TO AXRF-SUB
  6164                COMM-WORK-SUB.
  6165
  6166     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6167     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6168
  6169     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6170
  6171     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6172         NEXT SENTENCE
  6173     ELSE
  6174         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6175
  6176
  6177* EXEC CICS WRITE
  6178*        FROM      (ACCOUNT-MASTER)
  6179*        RIDFLD    (AM-CONTROL-PRIMARY)
  6180*        DATASET   (ACCT-FILE-ID)
  6181*    END-EXEC.
  6182     MOVE LENGTH OF
  6183      ACCOUNT-MASTER
  6184       TO DFHEIV11
  6185*    MOVE '&$ L                  ''   #00006134' TO DFHEIV0
  6186     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6187     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6188     MOVE X'2020233030303036313334' TO DFHEIV0(25:11)
  6189     CALL 'kxdfhei1' USING DFHEIV0,
  6190           ACCT-FILE-ID,
  6191           ACCOUNT-MASTER,
  6192           DFHEIV11,
  6193           AM-CONTROL-PRIMARY,
  6194           DFHEIV99,
  6195           DFHEIV99
  6196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6197
  6198
  6199     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6200
  6201     MOVE PI-MAINT               TO PI-SV-MAINT.
  6202     MOVE 'C'                    TO PI-MAINT.
  6203     MOVE LOW-VALUES             TO EL6501AI.
  6204
  6205     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6206     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6207     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6208
  6209     IF PI-COMPANY-ID = 'NCL'
  6210         MOVE ER-4011            TO EMI-ERROR
  6211      ELSE
  6212         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL6501.cbl
  6213
  6214     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6215
  6216     MOVE -1                     TO MAINTL.
  6217     MOVE AL-UANON               TO MAINTA.
  6218     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6219     GO TO 8100-SEND-INITIAL-MAP.
  6220
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL6501.cbl
  6222 1500-ADD-COMP.
  6223
  6224* EXEC CICS GETMAIN
  6225*         LENGTH   (COMP-REC-LEN)
  6226*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6227*         INITIMG  (GETMAIN-SPACE)
  6228*    END-EXEC.
  6229*    MOVE ',"IL                  $   #00006164' TO DFHEIV0
  6230     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6231     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6232     MOVE X'2020233030303036313634' TO DFHEIV0(25:11)
  6233     CALL 'kxdfhei1' USING DFHEIV0,
  6234           DFHEIV20,
  6235           COMP-REC-LEN,
  6236           GETMAIN-SPACE
  6237     SET ADDRESS OF COMPENSATION-MASTER TO
  6238         DFHEIV20
  6239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6240
  6241
  6242     MOVE SPACES                 TO COMPENSATION-MASTER.
  6243     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6244                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6245                   CO-OV30         CO-OV60      CO-OV90
  6246                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6247                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6248                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6249                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6250                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6251                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6252                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6253                   CO-CURRENT-CUR-PMT
  6254                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6255                   CO-ACT-YEAR        CO-ACT-MONTH
  6256                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6257                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6258                   CO-CURRENT-LAST-STMT-YEAR
  6259                   CO-CURRENT-LAST-STMT-MONTH
  6260                   CO-CURRENT-LAST-STMT-DAY
  6261                   CO-YTD-PAID-COM
  6262                   CO-YTD-PAID-OV
  6263                   co-ov120 co-current-ov120
  6264
  6265     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6266     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6267     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6268     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6269     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6270
  6271     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6272         MOVE ZEROS              TO CO-CARRIER
  6273     ELSE
  6274         MOVE AM-CARRIER         TO CO-CARRIER.
  6275
  6276     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6277         MOVE ZEROS              TO CO-GROUPING
  6278     ELSE
  6279         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL6501.cbl
  6280
  6281     MOVE 'CO'                   TO CO-RECORD-ID
  6282     MOVE 'A'                    TO CO-TYPE.
  6283     MOVE AM-NAME                TO CO-ACCT-NAME.
  6284     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6285     MOVE AM-ADDRS               TO CO-ADDR-1.
  6286*    MOVE AM-CITY                TO CO-ADDR-3.
  6287     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6288     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6289     MOVE AM-ZIP                 TO CO-ZIP.
  6290     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6291     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6292
  6293     IF PI-COMPANY-ID = 'NCL'
  6294         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6295         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6296                         'X' OR 'I'
  6297             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6298             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6299         ELSE
  6300             MOVE SPACE          TO  CO-TYPE-AGENT
  6301             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6302     ELSE
  6303         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6304
  6305     IF AM-REMIT-TO NOT = ZERO
  6306         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6307       ELSE
  6308         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6309
  6310     MOVE +0                      TO AGT-SUB.
  6311
  6312     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6313
  6314     IF VALID-AGT-SW = 'Y'
  6315         NEXT SENTENCE
  6316     ELSE
  6317         GO TO 1500-EXIT.
  6318
  6319     IF CO-RESP-NO = CO-ACCOUNT
  6320         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6321     ELSE
  6322         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6323
  6324     IF PI-AR-PROCESSING
  6325        MOVE 'G'                   TO CO-AR-REPORTING
  6326        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6327        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6328        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6329
  6330     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6331        MOVE 'N'                   TO CO-AR-REPORTING.
  6332
  6333     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6334        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6335
  6336     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6337
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL6501.cbl
  6338
  6339* EXEC CICS HANDLE CONDITION
  6340*         DUPREC   (1500-EXIT)
  6341*    END-EXEC.
  6342*    MOVE '"$%                   ! # #00006266' TO DFHEIV0
  6343     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6345     MOVE X'2320233030303036323636' TO DFHEIV0(25:11)
  6346     CALL 'kxdfhei1' USING DFHEIV0
  6347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6348
  6349
  6350
  6351* EXEC CICS WRITE
  6352*        FROM      (COMPENSATION-MASTER)
  6353*        RIDFLD    (CO-CONTROL-PRIMARY)
  6354*        DATASET   (COMP-FILE-ID)
  6355*    END-EXEC.
  6356     MOVE LENGTH OF
  6357      COMPENSATION-MASTER
  6358       TO DFHEIV11
  6359*    MOVE '&$ L                  ''   #00006270' TO DFHEIV0
  6360     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6362     MOVE X'2020233030303036323730' TO DFHEIV0(25:11)
  6363     CALL 'kxdfhei1' USING DFHEIV0,
  6364           COMP-FILE-ID,
  6365           COMPENSATION-MASTER,
  6366           DFHEIV11,
  6367           CO-CONTROL-PRIMARY,
  6368           DFHEIV99,
  6369           DFHEIV99
  6370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6371
  6372
  6373 1500-EXIT.
  6374      EXIT.
  6375
  6376 1600-FIND-C-AGT.
  6377     ADD 1 TO  AGT-SUB.
  6378     IF AGT-SUB GREATER 10
  6379         MOVE 'N'                TO  VALID-AGT-SW
  6380         GO TO 1600-EXIT.
  6381
  6382************************************************************
  6383**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6384************************************************************
  6385
  6386     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6387         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6388         MOVE 'Y'                TO  VALID-AGT-SW
  6389         GO TO 1600-EXIT
  6390     ELSE
  6391         GO TO 1600-FIND-C-AGT.
  6392
  6393 1600-EXIT.
  6394     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL6501.cbl
  6396 1700-CHANGE-COMP.
  6397     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6398     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6399
  6400     IF PI-ZERO-CARRIER
  6401       OR PI-ZERO-CAR-GROUP
  6402         MOVE ZEROS              TO COMP-CARRIER
  6403     ELSE
  6404         MOVE AM-CARRIER         TO COMP-CARRIER.
  6405
  6406     IF PI-ZERO-GROUPING
  6407       OR PI-ZERO-CAR-GROUP
  6408         MOVE ZEROS              TO COMP-GROUPING
  6409     ELSE
  6410         MOVE AM-GROUPING        TO COMP-GROUPING.
  6411
  6412     IF AM-REMIT-TO NOT = ZERO
  6413         MOVE AM-AGT (AM-REMIT-TO)
  6414                                 TO COMP-RESP-NO
  6415     ELSE
  6416         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6417
  6418     MOVE ZERO                   TO AGT-SUB.
  6419
  6420     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6421
  6422     IF VALID-AGT-SW = 'Y'
  6423         NEXT SENTENCE
  6424     ELSE
  6425         GO TO 1799-EXIT.
  6426
  6427     MOVE 'A'                    TO COMP-TYPE.
  6428
  6429
  6430* EXEC CICS HANDLE CONDITION
  6431*         ENDFILE     (1799-EXIT)
  6432*         NOTFND      (1799-EXIT)
  6433*    END-EXEC.
  6434*    MOVE '"$''I                  ! $ #00006332' TO DFHEIV0
  6435     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6437     MOVE X'2420233030303036333332' TO DFHEIV0(25:11)
  6438     CALL 'kxdfhei1' USING DFHEIV0
  6439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6440
  6441
  6442
  6443* EXEC CICS READ
  6444*        UPDATE
  6445*        DATASET   (COMP-FILE-ID)
  6446*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6447*        RIDFLD    (COMP-KEY)
  6448*    END-EXEC.
  6449*    MOVE '&"S        EU         (   #00006337' TO DFHEIV0
  6450     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6451     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6452     MOVE X'2020233030303036333337' TO DFHEIV0(25:11)
  6453     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL6501.cbl
  6454           COMP-FILE-ID,
  6455           DFHEIV20,
  6456           DFHEIV99,
  6457           COMP-KEY,
  6458           DFHEIV99,
  6459           DFHEIV99,
  6460           DFHEIV99
  6461     SET ADDRESS OF COMPENSATION-MASTER TO
  6462         DFHEIV20
  6463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6464
  6465
  6466     IF (ON-LAST-DATE-RANGE)
  6467        IF NAMEL GREATER ZEROS
  6468           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6469           MOVE AM-NAME          TO CO-ACCT-NAME
  6470        END-IF
  6471        IF INCAREL GREATER ZEROS
  6472           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6473           MOVE AM-PERSON        TO CO-MAIL-NAME
  6474        END-IF
  6475        IF ADDR1L GREATER ZEROS
  6476           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6477           MOVE AM-ADDRS         TO CO-ADDR-1
  6478        END-IF
  6479        IF ACITYL  GREATER ZEROS
  6480           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6481           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6482        END-IF
  6483        IF ASTATEL  GREATER ZEROS
  6484           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6485           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6486        END-IF
  6487        IF ZIPL GREATER ZEROS
  6488           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6489           MOVE AM-ZIP           TO CO-ZIP
  6490        END-IF
  6491        IF CSRL GREATER ZEROS
  6492           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6493           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6494        END-IF
  6495        IF PHONEL GREATER ZEROS
  6496           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6497           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6498        END-IF
  6499        IF TAXNOL GREATER ZEROS
  6500           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6501           MOVE AM-ID-NO         TO CO-SOC-SEC
  6502        END-IF
  6503        IF AUTO-CANCEL-ACCOUNT
  6504           IF CO-BILL-SW = ' '
  6505              MOVE 'B'           TO CO-BILL-SW
  6506              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6507           END-IF
  6508        END-IF
  6509     END-IF
  6510
  6511     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL6501.cbl
  6512         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6513         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6514     END-IF
  6515
  6516     IF CHANGE-WAS-MADE
  6517         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6518         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6519         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6520
  6521     IF NAMEL GREATER THAN ZERO
  6522         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6523
  6524
  6525* EXEC CICS REWRITE
  6526*        FROM      (COMPENSATION-MASTER)
  6527*        DATASET   (COMP-FILE-ID)
  6528*    END-EXEC.
  6529     MOVE LENGTH OF
  6530      COMPENSATION-MASTER
  6531       TO DFHEIV11
  6532*    MOVE '&& L                  %   #00006402' TO DFHEIV0
  6533     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6534     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6535     MOVE X'2020233030303036343032' TO DFHEIV0(25:11)
  6536     CALL 'kxdfhei1' USING DFHEIV0,
  6537           COMP-FILE-ID,
  6538           COMPENSATION-MASTER,
  6539           DFHEIV11,
  6540           DFHEIV99
  6541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6542
  6543
  6544 1799-EXIT.
  6545     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL6501.cbl
  6547 1800-FIND-C-AGT.
  6548     ADD 1                       TO  AGT-SUB.
  6549
  6550     IF AGT-SUB GREATER 10
  6551         MOVE 'N'                TO  VALID-AGT-SW
  6552         GO TO 1899-EXIT.
  6553
  6554************************************************************
  6555**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6556************************************************************
  6557
  6558     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6559         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6560         MOVE 'Y'                TO  VALID-AGT-SW
  6561         GO TO 1899-EXIT
  6562     ELSE
  6563         GO TO 1800-FIND-C-AGT.
  6564
  6565 1899-EXIT.
  6566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL6501.cbl
  6568 2000-CHANGE-A-RECORD.
  6569     PERFORM 4000-EDITS THRU 4900-EXIT.
  6570
  6571     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6572        EMI-FATAL-CTR    GREATER ZERO
  6573         GO TO 8200-SEND-DATAONLY.
  6574
  6575
  6576* EXEC CICS READ
  6577*        UPDATE
  6578*        DATASET   (ACCT-FILE-ID)
  6579*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6580*        RIDFLD    (PI-ACCT-KEY)
  6581*    END-EXEC.
  6582*    MOVE '&"S        EU         (   #00006438' TO DFHEIV0
  6583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6584     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6585     MOVE X'2020233030303036343338' TO DFHEIV0(25:11)
  6586     CALL 'kxdfhei1' USING DFHEIV0,
  6587           ACCT-FILE-ID,
  6588           DFHEIV20,
  6589           DFHEIV99,
  6590           PI-ACCT-KEY,
  6591           DFHEIV99,
  6592           DFHEIV99,
  6593           DFHEIV99
  6594     SET ADDRESS OF ACCOUNT-MASTER TO
  6595         DFHEIV20
  6596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6597
  6598
  6599     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6600
  6601     IF NOT PI-AR-PROCESSING
  6602        GO TO 2075-PROCESS-CHANGE.
  6603
  6604     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6605     MOVE +0                     TO SUB1.
  6606
  6607 2075-PROCESS-CHANGE.
  6608     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6609
  6610     IF PI-AR-PROCESSING
  6611        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6612
  6613     IF PI-COMPANY-ID = 'DMD'
  6614     IF AM-ANNIVERSARY-DATE = ZEROS
  6615           MOVE ER-0852             TO EMI-ERROR
  6616           MOVE -1                  TO CONTRL
  6617           MOVE AL-UABON            TO CONTRA
  6618           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6619
  6620     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6621        EMI-FATAL-CTR    GREATER ZERO
  6622         GO TO 8200-SEND-DATAONLY.
  6623
  6624     MOVE +1                     TO AXRF-SUB
  6625                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL6501.cbl
  6626     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6627
  6628     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6629     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6630     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6631
  6632     IF ((PI-FST-PAGE)
  6633        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6634                      OR
  6635        ((PI-2ND-PAGE)
  6636        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6637                      OR
  6638        ((PI-3RD-PAGE)
  6639        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6640                      OR
  6641        ((PI-LST-PAGE)
  6642        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6643        SET ON-LAST-DATE-RANGE   TO TRUE
  6644     END-IF
  6645     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6646         NEXT SENTENCE
  6647     ELSE
  6648         IF (ON-LAST-DATE-RANGE)
  6649                          OR
  6650            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6651             (PCONTL > ZERO))
  6652             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6653
  6654     IF NAMEL GREATER THAN ZERO
  6655         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6656
  6657
  6658* EXEC CICS REWRITE
  6659*        FROM      (ACCOUNT-MASTER)
  6660*        DATASET   (ACCT-FILE-ID)
  6661*    END-EXEC.
  6662     MOVE LENGTH OF
  6663      ACCOUNT-MASTER
  6664       TO DFHEIV11
  6665*    MOVE '&& L                  %   #00006503' TO DFHEIV0
  6666     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6667     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6668     MOVE X'2020233030303036353033' TO DFHEIV0(25:11)
  6669     CALL 'kxdfhei1' USING DFHEIV0,
  6670           ACCT-FILE-ID,
  6671           ACCOUNT-MASTER,
  6672           DFHEIV11,
  6673           DFHEIV99
  6674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6675
  6676
  6677     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6678
  6679     IF CSRL GREATER ZEROS
  6680         GO TO 3500-CHANGE-ALL-CSR.
  6681
  6682     MOVE ER-0000                TO EMI-ERROR.
  6683     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL6501.cbl
  6684     MOVE LOW-VALUES             TO EL6501AI.
  6685
  6686     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6687     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6688     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6689
  6690     MOVE ER-0000                TO EMI-ERROR.
  6691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6692
  6693     MOVE -1                     TO MAINTL.
  6694     MOVE AL-UANON               TO MAINTA.
  6695     GO TO 8100-SEND-INITIAL-MAP.
  6696
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL6501.cbl
  6698 2100-ADD-ACCOUNT-NAME.
  6699
  6700* EXEC CICS HANDLE CONDITION
  6701*         DUPREC   (2100-EXIT)
  6702*    END-EXEC.
  6703*    MOVE '"$%                   ! % #00006530' TO DFHEIV0
  6704     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6706     MOVE X'2520233030303036353330' TO DFHEIV0(25:11)
  6707     CALL 'kxdfhei1' USING DFHEIV0
  6708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6709
  6710
  6711
  6712* EXEC CICS GETMAIN
  6713*         LENGTH   (NAME-REC-LEN)
  6714*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6715*         INITIMG  (GETMAIN-SPACE)
  6716*    END-EXEC.
  6717*    MOVE ',"IL                  $   #00006534' TO DFHEIV0
  6718     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6720     MOVE X'2020233030303036353334' TO DFHEIV0(25:11)
  6721     CALL 'kxdfhei1' USING DFHEIV0,
  6722           DFHEIV20,
  6723           NAME-REC-LEN,
  6724           GETMAIN-SPACE
  6725     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6726         DFHEIV20
  6727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6728
  6729
  6730     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6731     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6732     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6733     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6734     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6735     MOVE AM-NAME                TO  NL-NAME.
  6736     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6737        MOVE NL-NAME (5:26)      TO NL-NAME
  6738     END-IF
  6739     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6740     MOVE AM-ADDR-STATE          TO  NL-ST.
  6741     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6742     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6743     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6744     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6745     MOVE AM-STATE               TO  NL-AM-STATE.
  6746     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6747
  6748
  6749* EXEC CICS WRITE
  6750*        FROM      (NAME-LOOKUP-MASTER)
  6751*        RIDFLD    (NL-CONTROL-PRIMARY)
  6752*        DATASET   (NAME-FILE-ID)
  6753*    END-EXEC.
  6754     MOVE LENGTH OF
  6755      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL6501.cbl
  6756       TO DFHEIV11
  6757*    MOVE '&$ L                  ''   #00006558' TO DFHEIV0
  6758     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6760     MOVE X'2020233030303036353538' TO DFHEIV0(25:11)
  6761     CALL 'kxdfhei1' USING DFHEIV0,
  6762           NAME-FILE-ID,
  6763           NAME-LOOKUP-MASTER,
  6764           DFHEIV11,
  6765           NL-CONTROL-PRIMARY,
  6766           DFHEIV99,
  6767           DFHEIV99
  6768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6769
  6770
  6771 2100-EXIT.
  6772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL6501.cbl
  6774 2200-ADD-COMPENSATION-NAME.
  6775
  6776* EXEC CICS HANDLE CONDITION
  6777*         DUPREC   (2200-EXIT)
  6778*    END-EXEC.
  6779*    MOVE '"$%                   ! & #00006568' TO DFHEIV0
  6780     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6782     MOVE X'2620233030303036353638' TO DFHEIV0(25:11)
  6783     CALL 'kxdfhei1' USING DFHEIV0
  6784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6785
  6786
  6787
  6788* EXEC CICS GETMAIN
  6789*         LENGTH   (NAME-REC-LEN)
  6790*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6791*         INITIMG  (GETMAIN-SPACE)
  6792*    END-EXEC.
  6793*    MOVE ',"IL                  $   #00006572' TO DFHEIV0
  6794     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6795     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6796     MOVE X'2020233030303036353732' TO DFHEIV0(25:11)
  6797     CALL 'kxdfhei1' USING DFHEIV0,
  6798           DFHEIV20,
  6799           NAME-REC-LEN,
  6800           GETMAIN-SPACE
  6801     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6802         DFHEIV20
  6803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6804
  6805
  6806     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6807     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6808     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6809     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6810     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6811     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6812     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6813        MOVE NL-NAME (5:26)      TO NL-NAME
  6814     END-IF
  6815     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6816     MOVE CO-ADDR-STATE          TO  NL-ST
  6817     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6818     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6819     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6820     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6821     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6822     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6823     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6824
  6825
  6826* EXEC CICS WRITE
  6827*        FROM      (NAME-LOOKUP-MASTER)
  6828*        RIDFLD    (NL-CONTROL-PRIMARY)
  6829*        DATASET   (NAME-FILE-ID)
  6830*    END-EXEC.
  6831     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL6501.cbl
  6832      NAME-LOOKUP-MASTER
  6833       TO DFHEIV11
  6834*    MOVE '&$ L                  ''   #00006597' TO DFHEIV0
  6835     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6837     MOVE X'2020233030303036353937' TO DFHEIV0(25:11)
  6838     CALL 'kxdfhei1' USING DFHEIV0,
  6839           NAME-FILE-ID,
  6840           NAME-LOOKUP-MASTER,
  6841           DFHEIV11,
  6842           NL-CONTROL-PRIMARY,
  6843           DFHEIV99,
  6844           DFHEIV99
  6845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6846
  6847
  6848 2200-EXIT.
  6849     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL6501.cbl
  6851 3000-CHANGE-ALL-RECORDS.
  6852     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  6853     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  6854
  6855
  6856* EXEC CICS HANDLE CONDITION
  6857*         ENDFILE     (3030-END-FILE)
  6858*    END-EXEC.
  6859*    MOVE '"$''                   ! '' #00006610' TO DFHEIV0
  6860     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6861     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6862     MOVE X'2720233030303036363130' TO DFHEIV0(25:11)
  6863     CALL 'kxdfhei1' USING DFHEIV0
  6864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6865
  6866
  6867     PERFORM 6300-STARTBR THRU 6300-EXIT.
  6868
  6869 3010-READ-NEXT.
  6870     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6871
  6872     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  6873        GO TO 3030-END-FILE.
  6874
  6875
  6876* EXEC CICS ENDBR
  6877*        DATASET   (ACCT-FILE-ID)
  6878*    END-EXEC.
  6879     MOVE 0
  6880       TO DFHEIV11
  6881*    MOVE '&2                    $   #00006622' TO DFHEIV0
  6882     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6883     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6884     MOVE X'2020233030303036363232' TO DFHEIV0(25:11)
  6885     CALL 'kxdfhei1' USING DFHEIV0,
  6886           ACCT-FILE-ID,
  6887           DFHEIV11,
  6888           DFHEIV99
  6889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6890
  6891     ADD +1                      TO WS-CHANGE-ALL-CNT
  6892
  6893* EXEC CICS READ
  6894*        UPDATE
  6895*        DATASET   (ACCT-FILE-ID)
  6896*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6897*        RIDFLD    (WS-KEY-SAVE)
  6898*    END-EXEC.
  6899*    MOVE '&"S        EU         (   #00006626' TO DFHEIV0
  6900     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6901     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6902     MOVE X'2020233030303036363236' TO DFHEIV0(25:11)
  6903     CALL 'kxdfhei1' USING DFHEIV0,
  6904           ACCT-FILE-ID,
  6905           DFHEIV20,
  6906           DFHEIV99,
  6907           WS-KEY-SAVE,
  6908           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL6501.cbl
  6909           DFHEIV99,
  6910           DFHEIV99
  6911     SET ADDRESS OF ACCOUNT-MASTER TO
  6912         DFHEIV20
  6913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6914
  6915
  6916     IF NAMEL    GREATER THAN ZERO  OR
  6917        INCAREL  GREATER THAN ZERO  OR
  6918        ADDR1L   GREATER THAN ZERO  OR
  6919        ACITYL   GREATER THAN ZERO  OR
  6920        ASTATEL  GREATER THAN ZERO  OR
  6921        ZIPL     GREATER THAN ZERO  OR
  6922        CLPTOLPL GREATER THAN ZERO  OR
  6923        PHONEL   GREATER THAN ZERO
  6924         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  6925
  6926     IF STATUSL > ZERO
  6927        EVALUATE TRUE
  6928           WHEN STATUSI = 'A'
  6929              MOVE '0'           TO AM-STATUS
  6930           WHEN STATUSI = 'I'
  6931              MOVE '1'           TO AM-STATUS
  6932           WHEN (STATUSI = 'C')
  6933              AND (AM-STATUS NOT = '3' AND 'C')
  6934              MOVE '3'           TO AM-STATUS
  6935              SET AUTO-CANCEL-ACCOUNT
  6936                                 TO TRUE
  6937           WHEN (STATUSI = 'C')
  6938              MOVE '3'           TO AM-STATUS
  6939           WHEN STATUSI = 'F'
  6940              MOVE '4'           TO AM-STATUS
  6941           WHEN STATUSI = 'S'
  6942              MOVE '5'           TO AM-STATUS
  6943           WHEN OTHER
  6944              MOVE -1            TO STATUSL
  6945              MOVE AL-UABON      TO STATUSA
  6946              MOVE ER-2153       TO EMI-ERROR
  6947              PERFORM 9900-ERROR-FORMAT
  6948                                 THRU 9900-EXIT
  6949        END-EVALUATE
  6950     END-IF
  6951*    IF STATUSL > ZERO
  6952*       IF STATUSI = 'A'
  6953*          MOVE '0'              TO AM-STATUS
  6954*       ELSE
  6955*          IF STATUSI = 'I'
  6956*             MOVE '1'           TO AM-STATUS
  6957*          ELSE
  6958*             IF STATUSI = 'C'
  6959*                IF AM-STATUS NOT = '3' AND 'C'
  6960*                   SET AUTO-CANCEL-ACCOUNT
  6961*                                TO TRUE
  6962*                END-IF
  6963*                MOVE '3'        TO AM-STATUS
  6964*             ELSE
  6965*                IF STATUSI = 'F'
  6966*                   MOVE '4'     TO AM-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL6501.cbl
  6967*                ELSE
  6968*                   MOVE -1         TO STATUSL
  6969*                   MOVE AL-UABON   TO STATUSA
  6970*                   MOVE ER-2153    TO EMI-ERROR
  6971*                   PERFORM 9900-ERROR-FORMAT
  6972*                                THRU 9900-EXIT
  6973*                END-IF
  6974*             END-IF
  6975*          END-IF
  6976*       END-IF
  6977*    END-IF
  6978
  6979     IF CSRL GREATER ZERO
  6980        MOVE CSRI                TO AM-CSR-CODE.
  6981     IF NAMEL GREATER THAN ZERO
  6982        MOVE NAMEI               TO AM-NAME.
  6983     IF PCONTL GREATER THAN ZERO
  6984        MOVE PCONTI              TO AM-CONTROL-NAME
  6985     END-IF
  6986     IF INCAREL GREATER ZEROS
  6987        MOVE INCAREI             TO AM-PERSON.
  6988     IF ADDR1L GREATER ZEROS
  6989        MOVE ADDR1I              TO AM-ADDRS.
  6990     IF ACITYL GREATER ZEROS
  6991        MOVE ACITYI             TO AM-ADDR-CITY.
  6992     IF ASTATEL GREATER ZEROS
  6993        MOVE ASTATEI            TO AM-ADDR-STATE.
  6994     IF ZIPL NOT GREATER ZEROS
  6995         GO TO 3015-CONT-CHANGING.
  6996
  6997     MOVE ZIPI                   TO WS-ZIP-CODE.
  6998
  6999     IF WS-CANADIAN-ZIP
  7000         IF WS-ZIP-4 = SPACE  OR  '-'
  7001             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7002             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7003         ELSE
  7004             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7005             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7006     ELSE
  7007         IF WS-ZIP-6 = SPACE  OR  '-'
  7008             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7009             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7010         ELSE
  7011             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7012             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7013
  7014 3015-CONT-CHANGING.
  7015
  7016     IF CLPTOLPL GREATER ZEROS
  7017
  7018* EXEC CICS BIF
  7019*            DEEDIT
  7020*            FIELD    (CLPTOLPI)
  7021*            LENGTH   (6)
  7022*        END-EXEC
  7023     MOVE 6
  7024       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL6501.cbl
  7025*    MOVE '@"L                   #   #00006734' TO DFHEIV0
  7026     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7027     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7028     MOVE X'2020233030303036373334' TO DFHEIV0(25:11)
  7029     CALL 'kxdfhei1' USING DFHEIV0,
  7030           CLPTOLPI,
  7031           DFHEIV11
  7032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7033         IF CLPTOLPI NUMERIC
  7034             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7035         ELSE
  7036             MOVE -1                  TO CLPTOLPL
  7037             MOVE AL-UNBON            TO CLPTOLPA
  7038             MOVE ER-1778             TO EMI-ERROR
  7039             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7040         END-IF
  7041     END-IF
  7042
  7043     IF LCOMML > ZEROS
  7044
  7045* EXEC CICS BIF
  7046*            DEEDIT
  7047*            FIELD    (LCOMMI)
  7048*            LENGTH   (8)
  7049*        END-EXEC
  7050     MOVE 8
  7051       TO DFHEIV11
  7052*    MOVE '@"L                   #   #00006750' TO DFHEIV0
  7053     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7054     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7055     MOVE X'2020233030303036373530' TO DFHEIV0(25:11)
  7056     CALL 'kxdfhei1' USING DFHEIV0,
  7057           LCOMMI,
  7058           DFHEIV11
  7059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7060         IF LCOMMI NUMERIC
  7061            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7062         ELSE
  7063            MOVE -1              TO LCOMML
  7064            MOVE AL-UNBON        TO LCOMMA
  7065            MOVE ER-1778         TO EMI-ERROR
  7066            PERFORM 9900-ERROR-FORMAT
  7067                                 THRU 9900-EXIT
  7068         END-IF
  7069     END-IF
  7070
  7071     IF PHONEL GREATER ZEROS
  7072        MOVE PHONEI              TO DEEDIT-FIELD
  7073        PERFORM 8600-DEEDIT
  7074        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  7075        MOVE WS-PH1              TO AM-AREA-CODE
  7076        MOVE WS-PH2              TO AM-TEL-PRE
  7077        MOVE WS-PH3              TO AM-TEL-NBR.
  7078
  7079*    IF PSILFFL GREATER +0
  7080*       MOVE PSILFFI             TO DEEDIT-FIELD
  7081*       PERFORM 8600-DEEDIT
  7082*       IF DEEDIT-FIELD NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL6501.cbl
  7083*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7084*
  7085*    IF PSIAHFL GREATER +0
  7086*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7087*       PERFORM 8600-DEEDIT
  7088*       IF DEEDIT-FIELD NUMERIC
  7089*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7090
  7091     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7092     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7093     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7094
  7095     IF ((PI-FST-PAGE)
  7096        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7097                      OR
  7098        ((PI-2ND-PAGE)
  7099        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7100                      OR
  7101        ((PI-3RD-PAGE)
  7102        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7103                      OR
  7104        ((PI-LST-PAGE)
  7105        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7106        SET ON-LAST-DATE-RANGE   TO TRUE
  7107     END-IF
  7108*    IF ((PI-FST-PAGE)
  7109*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7110*                     OR
  7111*       ((PI-2ND-PAGE)
  7112*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7113*                     OR
  7114*       ((PI-3RD-PAGE)
  7115*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7116*                     OR
  7117*       ((PI-LST-PAGE)
  7118*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7119*       SET ON-LAST-DATE-RANGE   TO TRUE
  7120*    END-IF
  7121     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7122     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7123     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7124*    EXEC CICS DELAY
  7125*       INTERVAL (WS-DELAY-INT)
  7126*    END-EXEC
  7127     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7128        CONTINUE
  7129     ELSE
  7130        IF (ON-LAST-DATE-RANGE)
  7131                   OR
  7132           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  7133           (PCONTL > ZERO))
  7134           PERFORM 1700-CHANGE-COMP
  7135                                 THRU 1799-EXIT
  7136        END-IF
  7137     END-IF
  7138
  7139     IF NAMEL GREATER THAN ZERO
  7140         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL6501.cbl
  7141
  7142
  7143* EXEC CICS REWRITE
  7144*        FROM      (ACCOUNT-MASTER)
  7145*        DATASET   (ACCT-FILE-ID)
  7146*    END-EXEC.
  7147     MOVE LENGTH OF
  7148      ACCOUNT-MASTER
  7149       TO DFHEIV11
  7150*    MOVE '&& L                  %   #00006837' TO DFHEIV0
  7151     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7152     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7153     MOVE X'2020233030303036383337' TO DFHEIV0(25:11)
  7154     CALL 'kxdfhei1' USING DFHEIV0,
  7155           ACCT-FILE-ID,
  7156           ACCOUNT-MASTER,
  7157           DFHEIV11,
  7158           DFHEIV99
  7159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7160
  7161
  7162     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7163     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7164
  7165     GO TO 3010-READ-NEXT.
  7166
  7167 3030-END-FILE.
  7168     IF BROWSE-STARTED
  7169        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7170
  7171     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7172
  7173     IF AUTO-CANCEL-ACCOUNT
  7174
  7175* EXEC CICS GETMAIN
  7176*          LENGTH   (ERACNT-REC-LEN)
  7177*          SET      (ADDRESS OF NOTE-FILE)
  7178*          INITIMG  (GETMAIN-SPACE)
  7179*          RESP     (WS-RESPONSE)
  7180*       END-EXEC
  7181*    MOVE ',"IL                  $  N#00006854' TO DFHEIV0
  7182     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7183     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7184     MOVE X'204E233030303036383534' TO DFHEIV0(25:11)
  7185     CALL 'kxdfhei1' USING DFHEIV0,
  7186           DFHEIV20,
  7187           ERACNT-REC-LEN,
  7188           GETMAIN-SPACE
  7189     SET ADDRESS OF NOTE-FILE TO
  7190         DFHEIV20
  7191     MOVE EIBRESP  TO WS-RESPONSE
  7192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7193        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7194        MOVE '1'                 TO NT-RECORD-TYPE
  7195        MOVE +1                  TO NT-LINE-SEQUENCE
  7196        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7197        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7198        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL6501.cbl
  7199        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7200                                 TO NT-NOTE-LINE
  7201        PERFORM WITH TEST AFTER UNTIL
  7202           (NOT RESP-DUPKEY)
  7203           AND (NOT RESP-DUPREC)
  7204
  7205* EXEC CICS WRITE
  7206*             FROM      (NOTE-FILE)
  7207*             RIDFLD    (NT-CONTROL-PRIMARY)
  7208*             DATASET   (ERACNT-FILE-ID)
  7209*             RESP      (WS-RESPONSE)
  7210*          END-EXEC
  7211     MOVE LENGTH OF
  7212      NOTE-FILE
  7213       TO DFHEIV11
  7214*    MOVE '&$ L                  ''  N#00006871' TO DFHEIV0
  7215     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7216     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7217     MOVE X'204E233030303036383731' TO DFHEIV0(25:11)
  7218     CALL 'kxdfhei1' USING DFHEIV0,
  7219           ERACNT-FILE-ID,
  7220           NOTE-FILE,
  7221           DFHEIV11,
  7222           NT-CONTROL-PRIMARY,
  7223           DFHEIV99,
  7224           DFHEIV99
  7225     MOVE EIBRESP  TO WS-RESPONSE
  7226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7227           IF RESP-DUPKEY OR RESP-DUPREC
  7228              ADD +1             TO NT-LINE-SEQUENCE
  7229           END-IF
  7230        END-PERFORM
  7231     END-IF
  7232     IF NOT EMI-NO-ERRORS
  7233         GO TO 8200-SEND-DATAONLY.
  7234
  7235     MOVE -1                     TO NAMEL.
  7236     MOVE ER-0000                TO EMI-ERROR.
  7237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7238     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL6501.cbl
  7240 3500-CHANGE-ALL-CSR.
  7241     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7242     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7243                                    WS-ACCT-REST-OF-EXP.
  7244
  7245
  7246* EXEC CICS HANDLE CONDITION
  7247*         ENDFILE     (3530-END-FILE)
  7248*    END-EXEC.
  7249*    MOVE '"$''                   ! ( #00006895' TO DFHEIV0
  7250     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7252     MOVE X'2820233030303036383935' TO DFHEIV0(25:11)
  7253     CALL 'kxdfhei1' USING DFHEIV0
  7254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7255
  7256
  7257     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7258
  7259 3510-READ-NEXT.
  7260     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7261
  7262     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7263        GO TO 3530-END-FILE.
  7264
  7265
  7266* EXEC CICS ENDBR
  7267*        DATASET   (ACCT-FILE-ID)
  7268*    END-EXEC.
  7269     MOVE 0
  7270       TO DFHEIV11
  7271*    MOVE '&2                    $   #00006907' TO DFHEIV0
  7272     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7273     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7274     MOVE X'2020233030303036393037' TO DFHEIV0(25:11)
  7275     CALL 'kxdfhei1' USING DFHEIV0,
  7276           ACCT-FILE-ID,
  7277           DFHEIV11,
  7278           DFHEIV99
  7279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7280
  7281
  7282
  7283* EXEC CICS READ
  7284*        UPDATE
  7285*        DATASET   (ACCT-FILE-ID)
  7286*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7287*        RIDFLD    (WS-KEY-SAVE)
  7288*    END-EXEC.
  7289*    MOVE '&"S        EU         (   #00006911' TO DFHEIV0
  7290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7291     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7292     MOVE X'2020233030303036393131' TO DFHEIV0(25:11)
  7293     CALL 'kxdfhei1' USING DFHEIV0,
  7294           ACCT-FILE-ID,
  7295           DFHEIV20,
  7296           DFHEIV99,
  7297           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL6501.cbl
  7298           DFHEIV99,
  7299           DFHEIV99,
  7300           DFHEIV99
  7301     SET ADDRESS OF ACCOUNT-MASTER TO
  7302         DFHEIV20
  7303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7304
  7305
  7306     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7307     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7308     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7309
  7310     MOVE CSRI                   TO AM-CSR-CODE.
  7311
  7312
  7313* EXEC CICS REWRITE
  7314*        FROM      (ACCOUNT-MASTER)
  7315*        DATASET   (ACCT-FILE-ID)
  7316*    END-EXEC.
  7317     MOVE LENGTH OF
  7318      ACCOUNT-MASTER
  7319       TO DFHEIV11
  7320*    MOVE '&& L                  %   #00006924' TO DFHEIV0
  7321     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7323     MOVE X'2020233030303036393234' TO DFHEIV0(25:11)
  7324     CALL 'kxdfhei1' USING DFHEIV0,
  7325           ACCT-FILE-ID,
  7326           ACCOUNT-MASTER,
  7327           DFHEIV11,
  7328           DFHEIV99
  7329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7330
  7331
  7332     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7333     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7334
  7335     GO TO 3510-READ-NEXT.
  7336
  7337 3530-END-FILE.
  7338     IF BROWSE-STARTED
  7339        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7340
  7341     MOVE ER-4009                TO EMI-ERROR.
  7342     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7343     MOVE LOW-VALUES             TO EL6501AI.
  7344
  7345     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7346     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7347     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7348
  7349     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7350
  7351     MOVE -1                     TO MAINTL.
  7352     MOVE AL-UANON               TO MAINTA.
  7353     GO TO 8100-SEND-INITIAL-MAP.
  7354
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL6501.cbl
  7356 4000-EDITS.
  7357     IF PI-COMPANY-ID = 'NCL'
  7358      IF MAINTI = 'A' OR 'C'
  7359        IF CSRL GREATER ZEROS
  7360            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7361          ELSE
  7362            IF MAINTI = 'A'
  7363                MOVE ER-1883         TO EMI-ERROR
  7364                MOVE -1              TO CSRL
  7365                MOVE AL-UABON        TO CSRA
  7366                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7367
  7368     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7369        IF NAMEL NOT GREATER ZEROS
  7370           IF MAINTI = 'C'
  7371              GO TO 4070-CHECK-STATUS
  7372           ELSE
  7373              MOVE -1               TO  NAMEL
  7374              MOVE AL-UABON         TO  NAMEA
  7375              MOVE ER-2045          TO  EMI-ERROR
  7376              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7377        ELSE
  7378            GO TO 4065-CHECK-ASSOCIATES.
  7379
  7380     IF TYPEL NOT GREATER ZEROS
  7381        IF MAINTI = 'C'
  7382           GO TO 4050-CONTINUE
  7383        ELSE
  7384           GO TO 4020-BUS-TYPE-ERROR.
  7385
  7386     IF TYPEI NOT NUMERIC
  7387        GO TO 4020-BUS-TYPE-ERROR
  7388     ELSE
  7389        IF TYPEI LESS 1 OR GREATER 99
  7390           GO TO 4020-BUS-TYPE-ERROR.
  7391
  7392     MOVE SPACES                 TO ELCNTL-KEY.
  7393
  7394     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7395     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7396     MOVE '8'                    TO CNTL-REC-TYPE.
  7397     MOVE +0                     TO CNTL-SEQ-NO.
  7398
  7399
  7400* EXEC CICS HANDLE CONDITION
  7401*        NOTFND   (4020-BUS-TYPE-ERROR)
  7402*    END-EXEC.
  7403*    MOVE '"$I                   ! ) #00006996' TO DFHEIV0
  7404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7406     MOVE X'2920233030303036393936' TO DFHEIV0(25:11)
  7407     CALL 'kxdfhei1' USING DFHEIV0
  7408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7409
  7410
  7411
  7412* EXEC CICS READ
  7413*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL6501.cbl
  7414*        DATASET   (CNTL-FILE-ID)
  7415*        SET       (ADDRESS OF CONTROL-FILE)
  7416*        RIDFLD    (ELCNTL-KEY)
  7417*    END-EXEC.
  7418*    MOVE '&"S        G          (   #00007000' TO DFHEIV0
  7419     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7421     MOVE X'2020233030303037303030' TO DFHEIV0(25:11)
  7422     CALL 'kxdfhei1' USING DFHEIV0,
  7423           CNTL-FILE-ID,
  7424           DFHEIV20,
  7425           DFHEIV99,
  7426           ELCNTL-KEY,
  7427           DFHEIV99,
  7428           DFHEIV99,
  7429           DFHEIV99
  7430     SET ADDRESS OF CONTROL-FILE TO
  7431         DFHEIV20
  7432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7433
  7434
  7435     IF TYPEI LESS 21
  7436        MOVE TYPEI               TO WS-BUS-ENTRY
  7437     ELSE
  7438        DIVIDE TYPEI BY 20
  7439            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7440        IF WS-BUS-ENTRY = ZEROS
  7441           MOVE 20               TO WS-BUS-ENTRY.
  7442
  7443     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7444        GO TO 4050-CONTINUE.
  7445
  7446 4020-BUS-TYPE-ERROR.
  7447     MOVE -1                     TO TYPEL.
  7448     MOVE AL-UNBON               TO TYPEA.
  7449     MOVE ER-2178                TO EMI-ERROR.
  7450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7451
  7452 4050-CONTINUE.
  7453     IF ASTATEL > 0
  7454        MOVE SPACES                 TO  ELCNTL-KEY
  7455        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7456        MOVE '3'                    TO  CNTL-REC-TYPE
  7457        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7458        MOVE +0                     TO  CNTL-SEQ-NO
  7459
  7460* EXEC CICS  READ
  7461*           DATASET  ('ELCNTL')
  7462*           SET      (ADDRESS OF CONTROL-FILE)
  7463*           RIDFLD   (ELCNTL-KEY)
  7464*           RESP     (WS-RESPONSE)
  7465*       END-EXEC
  7466     MOVE 'ELCNTL' TO DFHEIV1
  7467*    MOVE '&"S        E          (  N#00007031' TO DFHEIV0
  7468     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7470     MOVE X'204E233030303037303331' TO DFHEIV0(25:11)
  7471     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL6501.cbl
  7472           DFHEIV1,
  7473           DFHEIV20,
  7474           DFHEIV99,
  7475           ELCNTL-KEY,
  7476           DFHEIV99,
  7477           DFHEIV99,
  7478           DFHEIV99
  7479     SET ADDRESS OF CONTROL-FILE TO
  7480         DFHEIV20
  7481     MOVE EIBRESP  TO WS-RESPONSE
  7482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7483        IF NOT RESP-NORMAL
  7484           MOVE ER-0144                TO  EMI-ERROR
  7485           MOVE -1                     TO  ASTATEL
  7486           MOVE AL-UABON               TO  ASTATEA
  7487           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7488        END-IF
  7489     ELSE
  7490        IF MAINTI = 'A'
  7491           MOVE ER-0144                TO  EMI-ERROR
  7492           MOVE -1                     TO  ASTATEL
  7493           MOVE AL-UABON               TO  ASTATEA
  7494           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7495        END-IF
  7496     END-IF
  7497     IF INDGRPL NOT GREATER ZEROS
  7498        IF MAINTI = 'C'
  7499           GO TO 4070-CHECK-STATUS
  7500        ELSE
  7501           GO TO 4060-IG-ERROR.
  7502
  7503     IF INDGRPI = 'I' OR 'G'
  7504        GO TO 4070-CHECK-STATUS.
  7505
  7506 4060-IG-ERROR.
  7507     MOVE -1                     TO INDGRPL.
  7508     MOVE AL-UABON               TO INDGRPA.
  7509     MOVE ER-2152                TO EMI-ERROR.
  7510     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7511
  7512 4065-CHECK-ASSOCIATES.
  7513     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7514        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7515        MOVE  NAMEI              TO  WS-NAME-AREA
  7516     ELSE
  7517        GO TO 4070-CHECK-STATUS.
  7518
  7519     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7520        NEXT SENTENCE
  7521     ELSE
  7522        MOVE -1                  TO  NAMEL
  7523        MOVE AL-UABON            TO  NAMEA
  7524        MOVE ER-0788             TO  EMI-ERROR
  7525        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7526
  7527 4070-CHECK-STATUS.
  7528     IF STATUSL NOT GREATER ZEROS
  7529        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL6501.cbl
  7530           GO TO 4090-CHECK-STD-AH-TYPE
  7531        ELSE
  7532           MOVE 'A'              TO STATUSI
  7533           MOVE AL-UANON         TO STATUSA
  7534           GO TO 4090-CHECK-STD-AH-TYPE.
  7535
  7536     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7537        GO TO 4090-CHECK-STD-AH-TYPE.
  7538
  7539 4080-STATUS-ERROR.
  7540     MOVE -1                     TO STATUSL.
  7541     MOVE AL-UABON               TO STATUSA.
  7542     MOVE ER-2153                TO EMI-ERROR.
  7543     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7544
  7545 4090-CHECK-STD-AH-TYPE.
  7546
  7547     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7548         GO TO 4900-EXIT.
  7549
  7550     IF STDBENL NOT GREATER ZEROS
  7551        IF MAINTI = 'C'
  7552*          GO TO 4110-CHECK-REMIT
  7553           GO TO 4100-CHECK-CLPTOLP
  7554        ELSE
  7555           MOVE ZEROS            TO STDBENI
  7556           MOVE AL-UANON         TO STDBENA
  7557*          GO TO 4110-CHECK-REMIT.
  7558           GO TO 4100-CHECK-CLPTOLP.
  7559
  7560     IF STDBENI = SPACES
  7561         MOVE ZEROS               TO STDBENI.
  7562     IF STDBENI = ZEROS
  7563*        GO TO 4110-CHECK-REMIT.
  7564         GO TO 4100-CHECK-CLPTOLP.
  7565
  7566     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7567     IF INVALID-BENEFIT-CODE
  7568        GO TO 4099-STD-BEN-ERROR.
  7569
  7570     MOVE SPACES                 TO ELCNTL-KEY.
  7571
  7572     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7573     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7574     MOVE '5'                    TO CNTL-REC-TYPE.
  7575     MOVE +0                     TO CNTL-SEQ-NO.
  7576
  7577
  7578* EXEC CICS HANDLE CONDITION
  7579*        NOTFND   (4099-STD-BEN-ERROR)
  7580*    END-EXEC.
  7581*    MOVE '"$I                   ! * #00007131' TO DFHEIV0
  7582     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7583     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7584     MOVE X'2A20233030303037313331' TO DFHEIV0(25:11)
  7585     CALL 'kxdfhei1' USING DFHEIV0
  7586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7587
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL6501.cbl
  7588
  7589
  7590* EXEC CICS READ
  7591*        GTEQ
  7592*        DATASET   (CNTL-FILE-ID)
  7593*        SET       (ADDRESS OF CONTROL-FILE)
  7594*        RIDFLD    (ELCNTL-KEY)
  7595*    END-EXEC.
  7596*    MOVE '&"S        G          (   #00007135' TO DFHEIV0
  7597     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7599     MOVE X'2020233030303037313335' TO DFHEIV0(25:11)
  7600     CALL 'kxdfhei1' USING DFHEIV0,
  7601           CNTL-FILE-ID,
  7602           DFHEIV20,
  7603           DFHEIV99,
  7604           ELCNTL-KEY,
  7605           DFHEIV99,
  7606           DFHEIV99,
  7607           DFHEIV99
  7608     SET ADDRESS OF CONTROL-FILE TO
  7609         DFHEIV20
  7610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7611
  7612
  7613     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7614        CNTL-REC-TYPE = CF-RECORD-TYPE
  7615         MOVE 1                  TO SUB
  7616     ELSE
  7617         GO TO 4099-STD-BEN-ERROR.
  7618
  7619 4095-CHECK-BEN-TYPE.
  7620     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7621*       GO TO 4110-CHECK-REMIT.
  7622        GO TO 4100-CHECK-CLPTOLP.
  7623
  7624     IF SUB LESS 8
  7625         ADD 1 TO SUB
  7626         GO TO 4095-CHECK-BEN-TYPE.
  7627
  7628 4099-STD-BEN-ERROR.
  7629     MOVE -1                     TO STDBENL.
  7630     MOVE AL-UABON               TO STDBENA.
  7631     MOVE ER-0250                TO EMI-ERROR.
  7632     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7633
  7634 4100-CHECK-CLPTOLP.
  7635
  7636     IF CLPTOLPL > ZERO
  7637
  7638* EXEC CICS BIF
  7639*            DEEDIT
  7640*            FIELD    (CLPTOLPI)
  7641*            LENGTH   (6)
  7642*        END-EXEC
  7643     MOVE 6
  7644       TO DFHEIV11
  7645*    MOVE '@"L                   #   #00007166' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL6501.cbl
  7646     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7647     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7648     MOVE X'2020233030303037313636' TO DFHEIV0(25:11)
  7649     CALL 'kxdfhei1' USING DFHEIV0,
  7650           CLPTOLPI,
  7651           DFHEIV11
  7652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7653         IF CLPTOLPI NOT NUMERIC
  7654             MOVE ER-1778        TO EMI-ERROR
  7655             MOVE -1             TO CLPTOLPL
  7656             MOVE AL-UNBON       TO CLPTOLPA
  7657             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7658         END-IF
  7659     END-IF.
  7660     IF LCOMML > ZERO
  7661
  7662* EXEC CICS BIF
  7663*            DEEDIT
  7664*            FIELD    (LCOMMI)
  7665*            LENGTH   (8)
  7666*        END-EXEC
  7667     MOVE 8
  7668       TO DFHEIV11
  7669*    MOVE '@"L                   #   #00007179' TO DFHEIV0
  7670     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7671     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7672     MOVE X'2020233030303037313739' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0,
  7674           LCOMMI,
  7675           DFHEIV11
  7676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7677         IF LCOMMI NOT NUMERIC
  7678             MOVE ER-1778        TO EMI-ERROR
  7679             MOVE -1             TO LCOMML
  7680             MOVE AL-UNBON       TO LCOMMA
  7681             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7682         END-IF
  7683     END-IF
  7684     IF MAXMFEEL > ZEROS
  7685
  7686* EXEC CICS BIF DEEDIT
  7687*          FIELD   (MAXMFEEI)
  7688*          LENGTH  (5)
  7689*       END-EXEC
  7690     MOVE 5
  7691       TO DFHEIV11
  7692*    MOVE '@"L                   #   #00007192' TO DFHEIV0
  7693     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7694     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7695     MOVE X'2020233030303037313932' TO DFHEIV0(25:11)
  7696     CALL 'kxdfhei1' USING DFHEIV0,
  7697           MAXMFEEI,
  7698           DFHEIV11
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7700        IF MAXMFEEI NUMERIC
  7701           MOVE MAXMFEEI         TO WS-WORK-FIELD
  7702           MOVE WS-WORK-NUM      TO MAXMFEEO
  7703        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL6501.cbl
  7704           MOVE -1               TO MAXMFEEL
  7705           MOVE AL-UABON         TO MAXMFEEA
  7706           MOVE ER-7717          TO EMI-ERROR
  7707           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7708        END-IF
  7709     END-IF
  7710     IF (CLPSTL > 0)
  7711        IF (CLPSTI NOT = SPACES)
  7712           MOVE SPACES           TO ELCNTL-KEY
  7713           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7714           MOVE '3'              TO CNTL-REC-TYPE
  7715           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7716           MOVE +0               TO CNTL-SEQ-NO
  7717
  7718* EXEC CICS  READ
  7719*              DATASET  ('ELCNTL')
  7720*              SET      (ADDRESS OF CONTROL-FILE)
  7721*              RIDFLD   (ELCNTL-KEY)
  7722*              RESP     (WS-RESPONSE)
  7723*          END-EXEC
  7724     MOVE 'ELCNTL' TO DFHEIV1
  7725*    MOVE '&"S        E          (  N#00007213' TO DFHEIV0
  7726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7728     MOVE X'204E233030303037323133' TO DFHEIV0(25:11)
  7729     CALL 'kxdfhei1' USING DFHEIV0,
  7730           DFHEIV1,
  7731           DFHEIV20,
  7732           DFHEIV99,
  7733           ELCNTL-KEY,
  7734           DFHEIV99,
  7735           DFHEIV99,
  7736           DFHEIV99
  7737     SET ADDRESS OF CONTROL-FILE TO
  7738         DFHEIV20
  7739     MOVE EIBRESP  TO WS-RESPONSE
  7740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7741           IF NOT RESP-NORMAL
  7742              MOVE ER-0144       TO EMI-ERROR
  7743              MOVE -1            TO CLPSTL
  7744              MOVE AL-UABON      TO CLPSTA
  7745              PERFORM 9900-ERROR-FORMAT
  7746                                 THRU  9900-EXIT
  7747           END-IF
  7748        ELSE
  7749           MOVE ER-0144          TO EMI-ERROR
  7750           MOVE -1               TO CLPSTL
  7751           MOVE AL-UABON         TO CLPSTA
  7752           PERFORM 9900-ERROR-FORMAT
  7753                                 THRU  9900-EXIT
  7754        END-IF
  7755     END-IF
  7756     .
  7757 4110-CHECK-REMIT.
  7758     IF REMITL NOT GREATER ZEROS
  7759        MOVE 1                   TO REMITI
  7760        MOVE AL-UNNON            TO REMITA
  7761        GO TO 4120-REMIT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL6501.cbl
  7762
  7763     IF (REMITI NOT NUMERIC)  OR
  7764        (REMITI LESS 1 OR GREATER 10)
  7765           GO TO 4120-REMIT-ERROR.
  7766
  7767 4115-CHECK-AGENT.
  7768     SET M-INDEX                 TO REMITI.
  7769
  7770     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7771        MOVE ER-2156             TO EMI-ERROR
  7772        GO TO 4120-R-ERROR.
  7773
  7774     GO TO 4130-CHECK-CONTRACT.
  7775
  7776 4120-REMIT-ERROR.
  7777     MOVE ER-2155                TO EMI-ERROR.
  7778
  7779 4120-R-ERROR.
  7780     MOVE -1                     TO REMITL.
  7781     MOVE AL-UABON               TO REMITA.
  7782     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7783
  7784 4130-CHECK-CONTRACT.
  7785     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  7786        MOVE CONTRI                TO DEEDIT-FIELD
  7787        PERFORM 8600-DEEDIT
  7788        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7789        MOVE '4'                    TO DC-OPTION-CODE
  7790        PERFORM 9700-DATE-LINK
  7791        IF DATE-CONVERSION-ERROR
  7792           MOVE ER-2157             TO EMI-ERROR
  7793           MOVE -1                  TO CONTRL
  7794           MOVE AL-UABON            TO CONTRA
  7795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7796        ELSE
  7797***  Y2K PROJ 7744
  7798           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  7799           MOVE AL-UANON            TO CONTRA
  7800           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  7801           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  7802        END-IF
  7803     END-IF.
  7804***  Y2K PROJ 7744
  7805
  7806     IF PI-COMPANY-ID = 'DMD'
  7807       IF PI-MAINT = 'A'
  7808        IF CONTRL = ZERO
  7809           MOVE ER-0852             TO EMI-ERROR
  7810           MOVE -1                  TO CONTRL
  7811           MOVE AL-UABON            TO CONTRA
  7812           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7813
  7814*4131-CHECK-PSI-FACTOR.
  7815*    IF PSILFFL GREATER +0
  7816*       MOVE PSILFFI             TO DEEDIT-FIELD
  7817*       PERFORM 8600-DEEDIT
  7818*       IF DEEDIT-FIELD NUMERIC
  7819*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL6501.cbl
  7820*                                   PSILFFO
  7821*       ELSE
  7822*          MOVE ER-9999          TO EMI-ERROR
  7823*          MOVE -1               TO PSILFFL
  7824*          MOVE AL-UABON         TO PSILFFA
  7825*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7826*
  7827*    IF PSIAHFL GREATER +0
  7828*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7829*       PERFORM 8600-DEEDIT
  7830*       IF DEEDIT-FIELD NUMERIC
  7831*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  7832*                                   PSIAHFO
  7833*       ELSE
  7834*          MOVE ER-9999          TO EMI-ERROR
  7835*          MOVE -1               TO PSIAHFL
  7836*          MOVE AL-UABON         TO PSIAHFA
  7837*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7838
  7839 4135-CHECK-PREVIOUS-DATES.
  7840     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  7841        MOVE PEFFDTEI              TO DEEDIT-FIELD
  7842        PERFORM 8600-DEEDIT
  7843        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7844        MOVE '4'                    TO DC-OPTION-CODE
  7845        PERFORM 9700-DATE-LINK
  7846        IF DATE-CONVERSION-ERROR
  7847           MOVE ER-0348             TO EMI-ERROR
  7848           MOVE -1                  TO PEFFDTEL
  7849           MOVE AL-UABON            TO PEFFDTEA
  7850           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7851        ELSE
  7852***  Y2K PROJ 7744
  7853           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  7854           MOVE AL-UANON            TO PEFFDTEA
  7855           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  7856           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  7857        END-IF
  7858     END-IF.
  7859
  7860     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  7861        MOVE PEXPDTEI              TO DEEDIT-FIELD
  7862        PERFORM 8600-DEEDIT
  7863        IF DEEDIT-FIELD-V0 NOT LESS 999999
  7864           MOVE '99/99/99'             TO PEXPDTEO
  7865           MOVE 99999999999            TO WS-PEXP-DT
  7866           MOVE AL-UANON               TO PEXPDTEA
  7867        ELSE
  7868           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7869           MOVE '4'                    TO DC-OPTION-CODE
  7870           PERFORM 9700-DATE-LINK
  7871           IF DATE-CONVERSION-ERROR
  7872              MOVE ER-0454             TO EMI-ERROR
  7873              MOVE -1                  TO PEXPDTEL
  7874              MOVE AL-UABON            TO PEXPDTEA
  7875              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7876           ELSE
  7877              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL6501.cbl
  7878              MOVE AL-UANON            TO PEXPDTEA
  7879              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  7880              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  7881           END-IF
  7882        END-IF
  7883     END-IF.
  7884***  Y2K PROJ 7744
  7885
  7886     IF COMMCALL NOT GREATER ZEROS
  7887         GO TO 4150-CHECK-REINCAL.
  7888
  7889     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  7890         (EFFCHG-SAVE LESS 841101)       AND
  7891         (COMMCALI = 'Y' OR '1')         AND
  7892         (NOT MODIFY-CAP)
  7893           MOVE -1               TO COMMCALL
  7894           MOVE AL-UABON         TO COMMCALA
  7895           MOVE ER-2189          TO EMI-ERROR
  7896           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7897
  7898     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  7899         GO TO 4150-CHECK-REINCAL.
  7900
  7901 4140-COMMCAL-ERROR.
  7902     MOVE -1                     TO COMMCALL.
  7903     MOVE AL-UABON               TO COMMCALA.
  7904     MOVE ER-2158                TO EMI-ERROR.
  7905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7906
  7907 4150-CHECK-REINCAL.
  7908     IF REINCALL NOT GREATER ZEROS
  7909         GO TO 4170-CHECK-REINTAB.
  7910
  7911     IF REINCALI = 'Y' OR 'N'
  7912        GO TO 4170-CHECK-REINTAB.
  7913
  7914 4160-REINCAL-ERROR.
  7915     MOVE -1                     TO REINCALL.
  7916     MOVE AL-UABON               TO REINCALA.
  7917     MOVE ER-2179                TO EMI-ERROR.
  7918     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7919
  7920 4170-CHECK-REINTAB.
  7921     IF REINTABL NOT GREATER ZEROS
  7922        IF PI-COMPANY-ID = 'NCL' AND
  7923           MAINTI = 'A'
  7924                MOVE ER-4010         TO EMI-ERROR
  7925                MOVE -1              TO REINTABL
  7926                MOVE AL-UABON        TO REINTABA
  7927                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7928
  7929     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  7930         GO TO 4410-CHECK-AGENTS.
  7931     IF PI-COMPANY-ID = 'CID'
  7932        IF PI-ACCT-STATE = 'KY'
  7933           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  7934              MOVE -1            TO REINTABL
  7935              MOVE AL-UABON      TO REINTABA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL6501.cbl
  7936              MOVE ER-2159       TO EMI-ERROR
  7937              PERFORM 9900-ERROR-FORMAT
  7938                                 THRU 9900-EXIT
  7939           END-IF
  7940        END-IF
  7941     END-IF
  7942     MOVE LOW-VALUES             TO REIN-KEY.
  7943
  7944     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  7945     MOVE 'A'                    TO REIN-CODE.
  7946     MOVE REINTABI               TO REIN-TABLE.
  7947
  7948
  7949* EXEC CICS HANDLE CONDITION
  7950*        NOTFND   (4180-REIN-ERROR)
  7951*    END-EXEC.
  7952*    MOVE '"$I                   ! + #00007426' TO DFHEIV0
  7953     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7954     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7955     MOVE X'2B20233030303037343236' TO DFHEIV0(25:11)
  7956     CALL 'kxdfhei1' USING DFHEIV0
  7957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7958
  7959
  7960
  7961* EXEC CICS READ
  7962*        DATASET   (REIN-FILE-ID)
  7963*        SET       (ADDRESS OF REINSURANCE-RECORD)
  7964*        RIDFLD    (REIN-KEY)
  7965*    END-EXEC.
  7966*    MOVE '&"S        E          (   #00007430' TO DFHEIV0
  7967     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7969     MOVE X'2020233030303037343330' TO DFHEIV0(25:11)
  7970     CALL 'kxdfhei1' USING DFHEIV0,
  7971           REIN-FILE-ID,
  7972           DFHEIV20,
  7973           DFHEIV99,
  7974           REIN-KEY,
  7975           DFHEIV99,
  7976           DFHEIV99,
  7977           DFHEIV99
  7978     SET ADDRESS OF REINSURANCE-RECORD TO
  7979         DFHEIV20
  7980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7981
  7982
  7983     GO TO 4410-CHECK-AGENTS.
  7984
  7985 4180-REIN-ERROR.
  7986     MOVE -1                     TO REINTABL.
  7987     MOVE AL-UABON               TO REINTABA.
  7988     MOVE ER-2615                TO EMI-ERROR.
  7989     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7990
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL6501.cbl
  7992 4410-CHECK-AGENTS.
  7993     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  7994     SET M-INDEX TO 1.
  7995
  7996     IF PI-COMPANY-ID = 'NCL'
  7997       IF AGENTL (M-INDEX) GREATER ZEROS
  7998         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  7999
  8000 4420-LOOP.
  8001     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8002        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8003            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8004           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8005           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8006           A-HL    (M-INDEX) GREATER ZEROS  OR
  8007           RECALL  (M-INDEX) GREATER ZEROS  OR
  8008           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8009           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8010           GLCODEL (M-INDEX) GREATER ZEROS
  8011           MOVE ER-2172          TO EMI-ERROR
  8012           MOVE -1               TO AGENTL (M-INDEX)
  8013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8014           GO TO 4450-BUMP-INDEX
  8015        ELSE
  8016           GO TO 4450-BUMP-INDEX.
  8017
  8018     IF AGENT (M-INDEX) = ZEROS
  8019         MOVE ER-2970            TO  EMI-ERROR
  8020         MOVE -1                 TO  AGENTL (M-INDEX)
  8021         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8023         GO TO 4450-BUMP-INDEX.
  8024
  8025     IF ATYPEL (M-INDEX) = ZEROS
  8026        MOVE -1                  TO ATYPEL (M-INDEX)
  8027        MOVE ER-2173             TO EMI-ERROR
  8028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8029        GO TO 4430-CHECK-SINGLE.
  8030
  8031     IF ATYPE (M-INDEX) = 'C'
  8032        ADD 1                    TO WS-ACCOUNT-CTR-C
  8033       ELSE
  8034        IF ATYPE (M-INDEX) = 'R'
  8035           ADD 1                 TO WS-ACCOUNT-CTR-R
  8036          ELSE
  8037           IF ATYPE (M-INDEX) = 'D'
  8038              ADD 1                 TO WS-ACCOUNT-CTR-D
  8039             ELSE
  8040              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8041                                OR 'B' OR 'I' OR 'K' OR 'L'
  8042                                OR 'J' OR 'M' OR 'A' OR 'N'
  8043                 NEXT SENTENCE
  8044                ELSE
  8045                 IF ATYPE (M-INDEX) = SPACES
  8046                    NEXT SENTENCE
  8047                   ELSE
  8048                    MOVE ER-2175       TO EMI-ERROR
  8049                    MOVE -1            TO ATYPEL (M-INDEX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL6501.cbl
  8050                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8051                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8052
  8053 4430-CHECK-SINGLE.
  8054     IF SINGLEL (M-INDEX) GREATER ZEROS
  8055        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8056           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8057           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8058           MOVE LOW-VALUES                 TO COMM-FILLER
  8059           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8060           IF COMMISSION-ERROR
  8061              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8062              MOVE -1            TO SINGLEL (M-INDEX)
  8063           ELSE
  8064            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8065              MOVE -1            TO MAINTL
  8066              MOVE ER-1884       TO EMI-ERROR
  8067              PERFORM 9900-ERROR-FORMAT
  8068                                 THRU 9900-EXIT
  8069            END-IF
  8070           END-IF
  8071        END-IF
  8072     END-IF
  8073
  8074     IF JOINTL (M-INDEX) GREATER ZEROS
  8075        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8076           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  8077           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8078           MOVE LOW-VALUES                 TO COMM-FILLER
  8079           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8080           IF COMMISSION-ERROR
  8081              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8082              MOVE -1            TO JOINTL (M-INDEX)
  8083           ELSE
  8084            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  8085              MOVE -1            TO MAINTL
  8086              MOVE ER-1885       TO EMI-ERROR
  8087              PERFORM 9900-ERROR-FORMAT
  8088                                 THRU 9900-EXIT
  8089            END-IF
  8090           END-IF
  8091        END-IF
  8092     END-IF
  8093
  8094     IF A-HL (M-INDEX) GREATER ZEROS
  8095        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8096           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8097           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8098           MOVE LOW-VALUES                 TO COMM-FILLER
  8099           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8100           IF COMMISSION-ERROR
  8101              MOVE AL-UABON      TO A-HA (M-INDEX)
  8102              MOVE -1            TO A-HL (M-INDEX)
  8103           ELSE
  8104            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  8105              MOVE -1            TO MAINTL
  8106              MOVE ER-1886       TO EMI-ERROR
  8107              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL6501.cbl
  8108                                 THRU 9900-EXIT
  8109            END-IF
  8110           END-IF
  8111        END-IF
  8112     END-IF
  8113
  8114     IF RECALL (M-INDEX) GREATER ZEROS
  8115         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8116             MOVE AL-UANON       TO RECALA (M-INDEX)
  8117         ELSE
  8118             MOVE -1             TO RECALL (M-INDEX)
  8119             MOVE AL-UABON       TO RECALA (M-INDEX)
  8120             MOVE ER-2158        TO EMI-ERROR
  8121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8122
  8123     IF RCOMML (M-INDEX) GREATER ZEROS
  8124         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8125             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8126         ELSE
  8127             MOVE -1             TO RCOMML (M-INDEX)
  8128             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8129             MOVE ER-0625        TO EMI-ERROR
  8130             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8131
  8132     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8133         IF  CHGBCK (M-INDEX)    NUMERIC
  8134             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8135         ELSE
  8136             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8137             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8138             MOVE  ER-0759         TO  EMI-ERROR
  8139             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8140
  8141     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8142         IF  GLCODE (M-INDEX)    NUMERIC
  8143             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8144         ELSE
  8145             MOVE  -1              TO  GLCODEL (M-INDEX)
  8146             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8147             MOVE  ER-0759         TO  EMI-ERROR
  8148             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8149
  8150     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8151        AND 'J'
  8152         GO TO 4450-BUMP-INDEX.
  8153
  8154     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8155         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8156
  8157     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8158         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8159
  8160     IF A-H-COMM-R (M-INDEX) NUMERIC
  8161        ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8162     END-IF
  8163     .
  8164 4450-BUMP-INDEX.
  8165     SET M-INDEX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL6501.cbl
  8166
  8167     IF M-INDEX NOT = 11
  8168        GO TO 4420-LOOP.
  8169
  8170     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8171        WS-ACCOUNT-CTR-D = ZEROS AND
  8172        WS-ACCOUNT-CTR-R = ZEROS
  8173          MOVE ER-2177             TO EMI-ERROR
  8174          MOVE -1                  TO AGENTL (1)
  8175          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8176          GO TO 4900-EXIT.
  8177
  8178     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8179         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8180        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8181         WS-ACCOUNT-CTR-D  GREATER 0)
  8182           MOVE ER-2174             TO EMI-ERROR
  8183           MOVE -1                  TO AGENTL (1)
  8184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8185           GO TO 4900-EXIT.
  8186
  8187     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8188        WS-ACCOUNT-CTR-R GREATER 1 OR
  8189        WS-ACCOUNT-CTR-D GREATER 1
  8190          MOVE ER-2182             TO EMI-ERROR
  8191          MOVE -1                  TO AGENTL (1)
  8192          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8193          GO TO 4900-EXIT.
  8194
  8195
  8196     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8197         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8198
  8199     IF WS-ST-COMM-CAP-SL = ZEROS
  8200        CONTINUE
  8201     ELSE
  8202      IF SINGLE-COMM-R (1) NUMERIC
  8203        IF (WS-LIMIT-TO-ACCOUNT AND
  8204           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8205                       OR
  8206           (NOT WS-LIMIT-TO-ACCOUNT AND
  8207           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8208           MOVE -1               TO MAINTL
  8209           MOVE ER-1884          TO EMI-ERROR
  8210           PERFORM 9900-ERROR-FORMAT
  8211                                 THRU 9900-EXIT
  8212        END-IF
  8213*     ELSE
  8214*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8215*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8216*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8217*       MOVE LOW-VALUES          TO COMM-FILLER
  8218*       PERFORM 6400-READ-COMMISSION
  8219*                                THRU 6459-EXIT
  8220*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8221*          MOVE -1               TO MAINTL
  8222*          MOVE ER-1884          TO EMI-ERROR
  8223*          PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL6501.cbl
  8224*                                THRU 9900-EXIT
  8225*       END-IF
  8226      END-IF
  8227     END-IF
  8228
  8229     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8230        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8231     END-IF
  8232
  8233     IF WS-ST-COMM-CAP-JL = ZEROS
  8234        CONTINUE
  8235     ELSE
  8236        IF JOINT-COMM-R (1) NUMERIC
  8237           IF (WS-LIMIT-TO-ACCOUNT AND
  8238              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8239                       OR
  8240              (NOT WS-LIMIT-TO-ACCOUNT AND
  8241               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8242               MOVE -1           TO MAINTL
  8243               MOVE ER-1885      TO EMI-ERROR
  8244               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8245           END-IF
  8246*       ELSE
  8247*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8248*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8249*          MOVE PI-LIFE-OVERRIDE-L1
  8250*                                TO COMM-LF-AH
  8251*          MOVE LOW-VALUES       TO COMM-FILLER
  8252*          PERFORM 6400-READ-COMMISSION
  8253*                                THRU 6459-EXIT
  8254*          IF EXCEEDS-STATE-MAX
  8255*             MOVE ER-1885       TO EMI-ERROR
  8256*             PERFORM 9900-ERROR-FORMAT
  8257*                                THRU 9900-EXIT
  8258*          END-IF
  8259        END-IF
  8260     END-IF
  8261
  8262     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8263        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8264     END-IF
  8265
  8266     IF WS-ST-COMM-CAP-SA = ZEROS
  8267        CONTINUE
  8268     ELSE
  8269        IF A-H-COMM-R (1) NUMERIC
  8270           IF (WS-LIMIT-TO-ACCOUNT AND
  8271              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8272                           OR
  8273              (NOT WS-LIMIT-TO-ACCOUNT AND
  8274              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8275              MOVE -1            TO MAINTL
  8276              MOVE ER-1886       TO EMI-ERROR
  8277              PERFORM 9900-ERROR-FORMAT
  8278                                 THRU 9900-EXIT
  8279           END-IF
  8280*       ELSE
  8281*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL6501.cbl
  8282*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8283*          MOVE PI-AH-OVERRIDE-L1
  8284*                                TO COMM-LF-AH
  8285*          MOVE LOW-VALUES       TO COMM-FILLER
  8286*          PERFORM 6400-READ-COMMISSION
  8287*                                THRU 6459-EXIT
  8288*          IF EXCEEDS-STATE-MAX
  8289*             MOVE ER-1886       TO EMI-ERROR
  8290*             PERFORM 9900-ERROR-FORMAT
  8291*                                THRU 9900-EXIT
  8292*          END-IF
  8293        END-IF
  8294     END-IF
  8295
  8296     IF MAINTI NOT = 'C'
  8297        GO TO 4900-EXIT.
  8298
  8299     IF NOT PI-GA-BILLING
  8300        GO TO 4900-EXIT.
  8301
  8302 4460-CHECK-IF-GA-BILLED.
  8303     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8304
  8305     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8306     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8307     SET M-INDEX TO +1.
  8308     MOVE +1 TO AXRF-SUB.
  8309
  8310 4470-GA-LOOP.
  8311     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8312        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8313        SINGLEL (M-INDEX) GREATER ZERO                OR
  8314        JOINTL  (M-INDEX) GREATER ZERO                OR
  8315        A-HL    (M-INDEX) GREATER ZERO                OR
  8316        RCOMML  (M-INDEX) GREATER ZERO                OR
  8317        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8318        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8319        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8320           MOVE ER-2131   TO EMI-ERROR
  8321           MOVE -1        TO AGENTL (M-INDEX)
  8322           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8323           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8324
  8325     ADD +1 TO AXRF-SUB.
  8326     SET M-INDEX UP BY +1.
  8327
  8328     IF AXRF-SUB NOT = +11
  8329        GO TO 4470-GA-LOOP.
  8330
  8331 4900-EXIT.
  8332      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL6501.cbl
  8334 5000-MOVE-TO-RECORD.
  8335
  8336     IF NAMEL   GREATER THAN ZERO  OR
  8337        INCAREL GREATER THAN ZERO  OR
  8338        ADDR1L  GREATER THAN ZERO  OR
  8339        ACITYL  GREATER THAN ZERO  OR
  8340        ASTATEL GREATER THAN ZERO  OR
  8341        ZIPL    GREATER THAN ZERO  OR
  8342        PHONEL  GREATER THAN ZERO  OR
  8343        TAXNOL  GREATER THAN ZERO
  8344         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8345
  8346     IF CSRL GREATER ZEROS
  8347        MOVE CSRI                TO AM-CSR-CODE.
  8348     IF NAMEL GREATER ZEROS
  8349        MOVE NAMEI               TO AM-NAME.
  8350     IF PCONTL GREATER ZEROS
  8351        MOVE PCONTI              TO AM-CONTROL-NAME
  8352     END-IF
  8353     IF INCAREL GREATER ZEROS
  8354        MOVE INCAREI             TO AM-PERSON.
  8355     IF ADDR1L GREATER ZEROS
  8356        MOVE ADDR1I              TO AM-ADDRS.
  8357     IF TAXNOL GREATER ZEROS
  8358        MOVE TAXNOI              TO AM-ID-NO.
  8359     IF PHONEL GREATER ZEROS
  8360        MOVE PHONEI              TO DEEDIT-FIELD
  8361        PERFORM 8600-DEEDIT
  8362        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8363        MOVE WS-PH1              TO AM-AREA-CODE
  8364        MOVE WS-PH2              TO AM-TEL-PRE
  8365        MOVE WS-PH3              TO AM-TEL-NBR.
  8366
  8367     IF ACITYL GREATER ZEROS
  8368        MOVE ACITYI             TO AM-ADDR-CITY.
  8369     IF ASTATEL GREATER ZEROS
  8370        MOVE ASTATEI            TO AM-ADDR-STATE.
  8371
  8372     IF ZIPL NOT GREATER ZEROS
  8373         GO TO 5010-CONT-MOVING.
  8374
  8375     MOVE ZIPI                   TO WS-ZIP-CODE.
  8376
  8377     IF WS-CANADIAN-ZIP
  8378         IF WS-ZIP-4 = SPACE  OR  '-'
  8379             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8380             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8381         ELSE
  8382             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8383             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8384     ELSE
  8385         IF WS-ZIP-6 = SPACE  OR  '-'
  8386             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8387             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8388         ELSE
  8389             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8390             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8391
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL6501.cbl
  8392 5010-CONT-MOVING.
  8393     IF TYPEL GREATER ZEROS
  8394        MOVE TYPEI               TO AM-GPCD.
  8395
  8396     IF STDBENL GREATER ZEROS
  8397        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8398
  8399     IF INDGRPL GREATER ZEROS
  8400        MOVE INDGRPI             TO AM-IG
  8401        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8402
  8403     IF STATUSL GREATER ZEROS
  8404        MOVE STATUSI             TO AM-STATUS
  8405        INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8406     END-IF
  8407
  8408     IF CLPTOLPL GREATER ZEROS
  8409        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8410     END-IF.
  8411
  8412     IF PRODCDL > 0
  8413        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8414     END-IF
  8415     IF CLPSTL > 0
  8416        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8417     END-IF
  8418     IF MAXMFEEL > ZEROS
  8419        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8420     END-IF
  8421     IF LCOMML > ZEROS
  8422        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8423     END-IF
  8424
  8425     IF REMITL GREATER ZEROS
  8426        MOVE REMITI              TO AM-REMIT-TO.
  8427     IF CONTRL GREATER ZEROS
  8428        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8429*    IF PSILFFL GREATER +0
  8430*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8431*    IF PSIAHFL GREATER +0
  8432*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8433     IF PEFFDTEL GREATER ZEROS
  8434        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8435     IF PEXPDTEL GREATER ZEROS
  8436        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8437     IF COMMCALL GREATER ZEROS
  8438        MOVE COMMCALI            TO AM-RECALC-COMM
  8439        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8440     ELSE
  8441         IF MAINTI = 'A'
  8442             MOVE 'N'            TO AM-RECALC-COMM.
  8443
  8444     IF REINCALL GREATER ZEROS
  8445        MOVE REINCALI            TO AM-RECALC-REIN
  8446     ELSE
  8447         IF MAINTI = 'A'
  8448             MOVE 'N'            TO AM-RECALC-REIN.
  8449
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL6501.cbl
  8450     IF REINTABL GREATER ZEROS
  8451        MOVE REINTABI            TO AM-REI-TABLE.
  8452
  8453     IF PI-MAINT = 'A'
  8454        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8455     END-IF
  8456
  8457     MOVE 1                      TO SUB.
  8458     SET M-INDEX                 TO 1.
  8459
  8460
  8461* EXEC CICS
  8462*         ASKTIME
  8463*    END-EXEC.
  8464*    MOVE '0"                    "   #00007913' TO DFHEIV0
  8465     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8466     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8467     MOVE X'2020233030303037393133' TO DFHEIV0(25:11)
  8468     CALL 'kxdfhei1' USING DFHEIV0,
  8469           DFHEIV99
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8471
  8472
  8473 5000-LOOP.
  8474*    IF PI-COMPANY-ID = 'DCC'
  8475*       IF (M-INDEX = +5)
  8476*          AND ((AGENTL (5) > ZEROS)
  8477*              OR (ATYPEL (5) > ZEROS))
  8478*             MOVE ER-3057         TO EMI-ERROR
  8479*             MOVE -1              TO AGENTL (5)
  8480*             MOVE AL-UABON        TO AGENTA (5)
  8481*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8482*             GO TO 5000-EXIT
  8483*       END-IF
  8484*    END-IF
  8485     IF MAINTI = 'C'
  8486        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8487           (COMMCALI NOT = 'Y' AND '1')                    AND
  8488            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8489           ((AM-AGT (SUB) = ZEROS AND
  8490             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8491                                     ZEROS) AND
  8492           (COMMCALI NOT = 'Y' AND '1')  AND
  8493            AM-HI-CERT-DATE NOT = ZEROS)
  8494              MOVE ER-2181         TO EMI-ERROR
  8495              MOVE -1              TO COMMCALL
  8496              MOVE AL-UABON        TO COMMCALA
  8497              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8498              GO TO 5000-EXIT.
  8499
  8500     IF MAINTI = 'C'
  8501        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8502             ATYPE (M-INDEX)) AND
  8503           (COMMCALI NOT = 'Y' AND '1') AND
  8504            AM-HI-CERT-DATE NOT = ZEROS)
  8505            OR
  8506           ((AM-COM-TYP (SUB) = SPACES AND
  8507             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL6501.cbl
  8508           (COMMCALI NOT = 'Y' AND '1')  AND
  8509            AM-HI-CERT-DATE NOT = ZEROS)
  8510              MOVE ER-2181         TO EMI-ERROR
  8511              MOVE -1              TO COMMCALL
  8512              MOVE AL-UABON        TO COMMCALA
  8513              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8514              GO TO 5000-EXIT.
  8515
  8516     IF AM-ACCOUNT-BILLED
  8517        IF COMMCALI = 'Y' OR '1'
  8518            MOVE ER-2183         TO EMI-ERROR
  8519            MOVE -1              TO COMMCALL
  8520            MOVE AL-UABON        TO COMMCALA
  8521            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8522            GO TO 5000-EXIT.
  8523
  8524     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8525        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8526        OR
  8527        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8528         ATYPE  (M-INDEX) = SPACES)
  8529           MOVE ZEROS              TO AM-AGT   (SUB)
  8530                                      AM-L-COM (SUB)
  8531                                      AM-J-COM (SUB)
  8532                                      AM-A-COM (SUB)
  8533           MOVE SPACE TO AM-COM-TYP (SUB)
  8534           SET M-INDEX UP BY 1
  8535           ADD 1 TO SUB
  8536           IF SUB = 11
  8537              GO TO 5000-CHECK-MAX-FEES
  8538            ELSE
  8539              GO TO 5000-LOOP.
  8540
  8541     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8542     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8543
  8544     IF SINGLEL (M-INDEX) GREATER ZEROS
  8545        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8546        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8547           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8548          ELSE
  8549           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8550           IF SINGLE-DASH (M-INDEX) = '-'
  8551               MULTIPLY AM-L-COM (SUB) BY -1
  8552                     GIVING AM-L-COM (SUB).
  8553
  8554     IF JOINTL (M-INDEX) GREATER ZEROS
  8555        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8556        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8557           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8558          ELSE
  8559           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8560           IF JOINT-DASH (M-INDEX) = '-'
  8561               MULTIPLY AM-J-COM (SUB) BY -1
  8562                     GIVING AM-J-COM (SUB).
  8563
  8564     IF A-HL (M-INDEX) GREATER ZEROS
  8565        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL6501.cbl
  8566        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8567           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8568          ELSE
  8569           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8570           IF A-H-DASH (M-INDEX) = '-'
  8571               MULTIPLY AM-A-COM (SUB) BY -1
  8572                     GIVING AM-A-COM (SUB).
  8573
  8574     IF RECALL (M-INDEX) GREATER ZEROS
  8575         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8576
  8577     IF RCOMML (M-INDEX) GREATER ZEROS
  8578         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8579
  8580     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8581         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8582
  8583     IF GLCODEL (M-INDEX) GREATER ZEROS
  8584         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8585
  8586     SET M-INDEX UP BY 1.
  8587     ADD 1 TO SUB.
  8588     IF M-INDEX NOT = 11
  8589        GO TO 5000-LOOP.
  8590
  8591 5000-CHECK-MAX-FEES.
  8592     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8593        MOVE +1                     TO S1
  8594        PERFORM UNTIL S1 > +10
  8595           IF (AM-A-COM (S1) NUMERIC)
  8596              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8597                     AND 'O')
  8598              AND (AM-COM-TYP (S1) = 'J')
  8599                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8600                    + (AM-A-COM (S1) * +1000)
  8601           END-IF
  8602           ADD +1             TO S1
  8603        END-PERFORM
  8604        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8605           MOVE -1               TO MAXMFEEL
  8606           MOVE AL-UABON         TO MAXMFEEA
  8607           MOVE ER-1817          TO EMI-ERROR
  8608           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8609        END-IF
  8610     END-IF
  8611     .
  8612 5000-EXIT.
  8613      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL6501.cbl
  8615
  8616 5100-WRITE-TS.
  8617     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8618
  8619     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8620         MOVE ZEROS              TO PI-CR-CARRIER
  8621     ELSE
  8622         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8623
  8624     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8625         MOVE ZEROS              TO PI-CR-GROUPING
  8626     ELSE
  8627         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8628
  8629     IF AM-REMIT-TO NOT = ZERO
  8630         MOVE AM-AGT (AM-REMIT-TO)
  8631                                 TO PI-CR-FIN-RESP
  8632       ELSE
  8633         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8634
  8635     MOVE 'A'                    TO PI-CR-TYPE.
  8636 5110-AGT-LOOP.
  8637     ADD 1                       TO  AGT-SUB.
  8638     IF AGT-SUB GREATER 10
  8639         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8640         GO TO 5120-WRITE.
  8641
  8642************************************************************
  8643**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8644************************************************************
  8645
  8646     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8647                  OR 'F' OR 'S' OR 'U'
  8648         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8649         GO TO 5120-WRITE
  8650     ELSE
  8651         GO TO 5110-AGT-LOOP.
  8652
  8653 5120-WRITE.
  8654
  8655* EXEC CICS WRITEQ TS
  8656*         QUEUE    (QID)
  8657*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8658*         LENGTH   (WS-COMM-LENGTH)
  8659*         ITEM     (W-ONE)
  8660*    END-EXEC.
  8661*    MOVE '*" I                  ''   #00008098' TO DFHEIV0
  8662     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8663     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8664     MOVE X'2020233030303038303938' TO DFHEIV0(25:11)
  8665     CALL 'kxdfhei1' USING DFHEIV0,
  8666           QID,
  8667           PROGRAM-INTERFACE-BLOCK,
  8668           WS-COMM-LENGTH,
  8669           W-ONE,
  8670           DFHEIV99,
  8671           DFHEIV99
  8672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL6501.cbl
  8673
  8674
  8675 5199-EXIT.
  8676     EXIT.
  8677
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL6501.cbl
  8679
  8680 5200-RECOVER-TS.
  8681
  8682     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8683                                 XCTL-653 AND
  8684                                 XCTL-689 AND
  8685                                 XCTL-608 AND
  8686                                 XCTL-690
  8687         GO TO 5299-EXIT.
  8688
  8689
  8690* EXEC CICS HANDLE CONDITION
  8691*        QIDERR  (5250-QID-ERROR)
  8692*    END-EXEC.
  8693*    MOVE '"$N                   ! , #00008119' TO DFHEIV0
  8694     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8696     MOVE X'2C20233030303038313139' TO DFHEIV0(25:11)
  8697     CALL 'kxdfhei1' USING DFHEIV0
  8698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8699
  8700
  8701
  8702* EXEC CICS READQ TS
  8703*        QUEUE    (QID)
  8704*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8705*        LENGTH   (WS-COMM-LENGTH)
  8706*        ITEM     (W-ONE)
  8707*    END-EXEC.
  8708*    MOVE '*$II   L              ''   #00008123' TO DFHEIV0
  8709     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8710     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8711     MOVE X'2020233030303038313233' TO DFHEIV0(25:11)
  8712     CALL 'kxdfhei1' USING DFHEIV0,
  8713           QID,
  8714           PROGRAM-INTERFACE-BLOCK,
  8715           WS-COMM-LENGTH,
  8716           W-ONE,
  8717           DFHEIV99,
  8718           DFHEIV99
  8719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8720
  8721
  8722 5200-DELETE-TS.
  8723
  8724
  8725* EXEC CICS DELETEQ TS
  8726*        QUEUE    (QID)
  8727*    END-EXEC.
  8728*    MOVE '*&                    #   #00008132' TO DFHEIV0
  8729     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8730     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8731     MOVE X'2020233030303038313332' TO DFHEIV0(25:11)
  8732     CALL 'kxdfhei1' USING DFHEIV0,
  8733           QID,
  8734           DFHEIV99
  8735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8736
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL6501.cbl
  8737
  8738     GO TO 5299-EXIT.
  8739
  8740 5250-QID-ERROR.
  8741     MOVE ER-0033                TO  EMI-ERROR.
  8742     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8743
  8744 5299-EXIT.
  8745     EXIT.
  8746
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL6501.cbl
  8748
  8749 5300-UPDATE-REQUEST-FILE.
  8750     MOVE +0                     TO SUB1.
  8751
  8752 5300-FIND-ACCOUNT-AGENT.
  8753     ADD +1                      TO SUB1.
  8754
  8755     IF SUB1 GREATER THAN +10
  8756        MOVE ER-2949             TO EMI-ERROR
  8757        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8758        MOVE -1                  TO AGENTL (1)
  8759
  8760* EXEC CICS SYNCPOINT ROLLBACK
  8761*       END-EXEC
  8762*    MOVE '6"R                   !   #00008157' TO DFHEIV0
  8763     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8765     MOVE X'2020233030303038313537' TO DFHEIV0(25:11)
  8766     CALL 'kxdfhei1' USING DFHEIV0
  8767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8768        GO TO 8200-SEND-DATAONLY.
  8769
  8770     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8771
  8772************************************************************
  8773**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8774************************************************************
  8775
  8776     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
  8777        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  8778           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  8779
  8780     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  8781        GO TO 5325-PROCESS-RQST-FILE.
  8782
  8783     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  8784        GO TO 5325-PROCESS-RQST-FILE.
  8785
  8786     GO TO 5399-EXIT.
  8787
  8788 5325-PROCESS-RQST-FILE.
  8789     MOVE LOW-VALUES             TO RQST3-KEY.
  8790     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  8791     MOVE AM-CARRIER             TO RQST3-CARRIER.
  8792     MOVE AM-GROUPING            TO RQST3-GROUPING.
  8793     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  8794     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  8795
  8796
  8797* EXEC CICS HANDLE CONDITION
  8798*        NOTFND(5399-EXIT)
  8799*        ENDFILE(5399-EXIT)
  8800*    END-EXEC.
  8801*    MOVE '"$I''                  ! - #00008187' TO DFHEIV0
  8802     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8804     MOVE X'2D20233030303038313837' TO DFHEIV0(25:11)
  8805     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL6501.cbl
  8806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8807
  8808
  8809 5325-PROCESS-REQUEST-FILE.
  8810
  8811* EXEC CICS STARTBR
  8812*         DATASET   (RQST3-FILE-ID)
  8813*         RIDFLD    (RQST3-KEY)
  8814*    END-EXEC.
  8815     MOVE 0
  8816       TO DFHEIV11
  8817*    MOVE '&,         G          &   #00008193' TO DFHEIV0
  8818     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8819     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8820     MOVE X'2020233030303038313933' TO DFHEIV0(25:11)
  8821     CALL 'kxdfhei1' USING DFHEIV0,
  8822           RQST3-FILE-ID,
  8823           RQST3-KEY,
  8824           DFHEIV99,
  8825           DFHEIV11,
  8826           DFHEIV99
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8828
  8829
  8830 5330-READNEXT-REQUEST.
  8831
  8832* EXEC CICS READNEXT
  8833*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  8834*        DATASET(RQST3-FILE-ID)
  8835*        RIDFLD (RQST3-KEY)
  8836*    END-EXEC.
  8837     MOVE 0
  8838       TO DFHEIV11
  8839*    MOVE '&.S                   )   #00008199' TO DFHEIV0
  8840     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8841     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8842     MOVE X'2020233030303038313939' TO DFHEIV0(25:11)
  8843     CALL 'kxdfhei1' USING DFHEIV0,
  8844           RQST3-FILE-ID,
  8845           DFHEIV20,
  8846           DFHEIV99,
  8847           RQST3-KEY,
  8848           DFHEIV99,
  8849           DFHEIV11,
  8850           DFHEIV99,
  8851           DFHEIV99
  8852     SET ADDRESS OF AR-REQUEST-RECORD TO
  8853         DFHEIV20
  8854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8855
  8856
  8857     IF RQST3-KEY = SAVE-RQST3-KEY
  8858        GO TO 5330-READNEXT-REQUEST.
  8859
  8860     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  8861
  8862     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  8863        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL6501.cbl
  8864
  8865     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  8866        GO TO 5350-REQUESTS-FINISHED.
  8867
  8868     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  8869        GO TO 5350-REQUESTS-FINISHED.
  8870
  8871     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  8872
  8873
  8874* EXEC CICS ENDBR
  8875*        DATASET(RQST3-FILE-ID)
  8876*    END-EXEC.
  8877     MOVE 0
  8878       TO DFHEIV11
  8879*    MOVE '&2                    $   #00008221' TO DFHEIV0
  8880     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8881     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8882     MOVE X'2020233030303038323231' TO DFHEIV0(25:11)
  8883     CALL 'kxdfhei1' USING DFHEIV0,
  8884           RQST3-FILE-ID,
  8885           DFHEIV11,
  8886           DFHEIV99
  8887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8888
  8889
  8890
  8891* EXEC CICS READ
  8892*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  8893*        DATASET(RQST-FILE-ID)
  8894*        RIDFLD (RQST-KEY)
  8895*        UPDATE
  8896*    END-EXEC.
  8897*    MOVE '&"S        EU         (   #00008225' TO DFHEIV0
  8898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8899     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8900     MOVE X'2020233030303038323235' TO DFHEIV0(25:11)
  8901     CALL 'kxdfhei1' USING DFHEIV0,
  8902           RQST-FILE-ID,
  8903           DFHEIV20,
  8904           DFHEIV99,
  8905           RQST-KEY,
  8906           DFHEIV99,
  8907           DFHEIV99,
  8908           DFHEIV99
  8909     SET ADDRESS OF AR-REQUEST-RECORD TO
  8910         DFHEIV20
  8911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8912
  8913
  8914     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  8915     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  8916
  8917
  8918* EXEC CICS REWRITE
  8919*        DATASET   (RQST-FILE-ID)
  8920*        FROM      (AR-REQUEST-RECORD)
  8921*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL6501.cbl
  8922     MOVE LENGTH OF
  8923      AR-REQUEST-RECORD
  8924       TO DFHEIV11
  8925*    MOVE '&& L                  %   #00008235' TO DFHEIV0
  8926     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8927     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8928     MOVE X'2020233030303038323335' TO DFHEIV0(25:11)
  8929     CALL 'kxdfhei1' USING DFHEIV0,
  8930           RQST-FILE-ID,
  8931           AR-REQUEST-RECORD,
  8932           DFHEIV11,
  8933           DFHEIV99
  8934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8935
  8936
  8937     GO TO  5325-PROCESS-REQUEST-FILE.
  8938
  8939 5350-REQUESTS-FINISHED.
  8940
  8941* EXEC CICS ENDBR
  8942*        DATASET(RQST3-FILE-ID)
  8943*    END-EXEC.
  8944     MOVE 0
  8945       TO DFHEIV11
  8946*    MOVE '&2                    $   #00008243' TO DFHEIV0
  8947     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8948     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8949     MOVE X'2020233030303038323433' TO DFHEIV0(25:11)
  8950     CALL 'kxdfhei1' USING DFHEIV0,
  8951           RQST3-FILE-ID,
  8952           DFHEIV11,
  8953           DFHEIV99
  8954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8955
  8956
  8957 5399-EXIT.
  8958     EXIT.
  8959
  8960
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL6501.cbl
  8962
  8963 6000-MOVE-TO-SCREEN.
  8964     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  8965
  8966     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  8967     MOVE AM-NAME                TO NAMEO.
  8968     MOVE AM-CONTROL-NAME        TO PCONTO.
  8969     MOVE AM-CSR-CODE            TO CSRO.
  8970     MOVE AM-PERSON              TO INCAREO.
  8971     MOVE AM-ADDRS               TO ADDR1O.
  8972     MOVE AM-ID-NO               TO TAXNOO.
  8973     MOVE AM-TEL-NO              TO WS-PHONE.
  8974     MOVE WS-PHONE-NUM           TO PHONEO.
  8975     INSPECT PHONEI CONVERTING SPACES TO '-'.
  8976     MOVE AM-ADDR-CITY           TO ACITYO
  8977     MOVE AM-ADDR-STATE          TO ASTATEO
  8978
  8979     MOVE SPACES                 TO WS-ZIP-CODE.
  8980     IF AM-CANADIAN-POST-CODE
  8981         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  8982         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  8983     ELSE
  8984         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  8985         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  8986             MOVE '-'            TO WS-ZIP-AM-2-DASH
  8987             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  8988
  8989     MOVE WS-ZIP-CODE            TO ZIPO.
  8990
  8991     MOVE AM-GPCD                TO TYPEO.
  8992     MOVE AM-STD-AH-TYPE         TO STDBENO.
  8993
  8994     MOVE AM-IG                  TO INDGRPO.
  8995     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  8996
  8997     MOVE AM-STATUS              TO STATUSO.
  8998     INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  8999
  9000     MOVE AM-REMIT-TO            TO REMITO.
  9001
  9002     IF PI-AR-PROCESSING
  9003        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9004           MOVE AL-UNNON         TO REMITA
  9005        ELSE
  9006           MOVE AL-SANON         TO REMITA
  9007     ELSE
  9008        MOVE AL-UNNON            TO REMITA.
  9009
  9010***  Y2K PROJ 7744
  9011     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9012     MOVE '3'                    TO DC-OPTION-CODE.
  9013     PERFORM 9700-DATE-LINK.
  9014     IF DATE-CONVERSION-ERROR
  9015        MOVE SPACES              TO CONTRO
  9016     ELSE
  9017        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9018     END-IF.
  9019***  Y2K PROJ 7744
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL6501.cbl
  9020
  9021*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9022*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9023
  9024*    IF AM-LF-PSI-FACTOR NUMERIC
  9025*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9026*
  9027*    IF AM-AH-PSI-FACTOR NUMERIC
  9028*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9029
  9030     MOVE AM-RECALC-COMM         TO COMMCALO.
  9031     MOVE AL-UANON               TO COMMCALA.
  9032     MOVE AM-RECALC-REIN         TO REINCALO.
  9033     MOVE AM-REI-TABLE           TO REINTABO.
  9034     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9035     MOVE '3'                    TO DC-OPTION-CODE.
  9036     PERFORM 9700-DATE-LINK.
  9037     IF DATE-CONVERSION-ERROR
  9038        MOVE SPACES              TO PRODATEO
  9039     ELSE
  9040        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9041
  9042     IF PI-COMPANY-ID = 'DCC'
  9043        IF AM-CLP-TOL-PCT NOT NUMERIC
  9044           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9045        END-IF
  9046        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9047           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9048        END-IF
  9049        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9050        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9051        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9052        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9053        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9054           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9055        END-IF
  9056        MOVE AM-DCC-MAX-MARKETING-FEE
  9057                                 TO MAXMFEEO
  9058     ELSE
  9059        MOVE AL-SADOF            TO CTPLABLA
  9060                                    CLPTOLPA
  9061                                    LCLABLA
  9062                                    LCOMMA
  9063     END-IF
  9064
  9065     IF AM-RET-Y-N = ' '  OR  'N'
  9066         MOVE 'NO '              TO RETROCDO
  9067     ELSE
  9068         MOVE 'YES'              TO RETROCDO.
  9069
  9070     IF AM-ACCOUNT-BILLED
  9071         MOVE 'YES'              TO BILLCDO
  9072     ELSE
  9073         MOVE 'NO '              TO BILLCDO.
  9074
  9075     MOVE AL-UANON               TO RETROCDA.
  9076     MOVE AL-SANON               TO PRODATEA
  9077                                    BILLCDA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL6501.cbl
  9078     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9079     MOVE '3' TO DC-OPTION-CODE.
  9080     PERFORM 9700-DATE-LINK.
  9081     IF DATE-CONVERSION-ERROR
  9082        MOVE SPACES TO PEFFDTEO
  9083     ELSE
  9084        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9085
  9086     IF AM-PREV-EXP-DT NOT = 99999999999
  9087        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9088        MOVE '3' TO DC-OPTION-CODE
  9089        PERFORM 9700-DATE-LINK
  9090        IF DATE-CONVERSION-ERROR
  9091           MOVE SPACES TO PEXPDTEO
  9092        ELSE
  9093           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9094     ELSE
  9095        MOVE '99/99/99' TO PEXPDTEO.
  9096
  9097     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9098        MOVE AL-UANON            TO PEXPDTEA
  9099                                    PEFFDTEA
  9100        MOVE AL-SANOF TO            PDSPLYA.
  9101
  9102     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9103     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9104     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9105
  9106     MOVE 1  TO SUB.
  9107     SET M-INDEX TO 1.
  9108
  9109 6005-LOOP.
  9110     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9111        IF PI-AR-PROCESSING
  9112           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9113              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9114                                   ATYPEA (M-INDEX)
  9115                                   SINGLEA (M-INDEX)
  9116                                   JOINTA (M-INDEX)
  9117                                   A-HA    (M-INDEX)
  9118              GO TO 6010-BUMP-SUB
  9119           ELSE
  9120              GO TO 6010-BUMP-SUB
  9121        ELSE
  9122           GO TO 6010-BUMP-SUB.
  9123
  9124     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9125
  9126***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9127     IF WS-DMD-AGENT = LOW-VALUES
  9128        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9129***DMD ******************************************************
  9130
  9131     IF PI-GA-BILLING
  9132        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9133     MOVE AL-UANON               TO AGENTA (M-INDEX).
  9134
  9135     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL6501.cbl
  9136     IF PI-GA-BILLING
  9137        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9138     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9139
  9140     IF (AM-L-COM (SUB) NOT NUMERIC)
  9141        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9142        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9143     ELSE
  9144        IF AM-L-COM (SUB) NOT = ZEROS
  9145           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9146
  9147     IF (AM-J-COM (SUB) NOT NUMERIC)
  9148        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9149        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9150     ELSE
  9151        IF AM-J-COM (SUB) NOT = ZEROS
  9152           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9153
  9154     IF (AM-A-COM (SUB) NOT NUMERIC)
  9155        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9156        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9157     ELSE
  9158        IF AM-A-COM (SUB) NOT = ZEROS
  9159           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9160
  9161************************************************************
  9162**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9163************************************************************
  9164
  9165     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9166            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9167            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9168         GO TO 6006-CONTINUE.
  9169
  9170     IF (AM-L-COM (SUB) NUMERIC)
  9171        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9172         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9173
  9174     IF (AM-J-COM (SUB) NUMERIC)
  9175        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9176         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9177
  9178     IF (AM-A-COM (SUB) NUMERIC)
  9179        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9180        ADD AM-A-COM (SUB) TO COMM-AH-ACCUM
  9181     END-IF
  9182     .
  9183 6006-CONTINUE.
  9184     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9185         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9186
  9187     IF WS-ST-COMM-CAP-SL = ZEROS
  9188        CONTINUE
  9189     ELSE
  9190        IF (AM-L-COM (SUB) NUMERIC)
  9191           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9192           IF (WS-LIMIT-TO-ACCOUNT AND
  9193              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL6501.cbl
  9194                       OR
  9195              (NOT WS-LIMIT-TO-ACCOUNT AND
  9196              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9197              MOVE -1            TO MAINTL
  9198              MOVE ER-1884       TO EMI-ERROR
  9199              PERFORM 9900-ERROR-FORMAT
  9200                                 THRU 9900-EXIT
  9201           END-IF
  9202        ELSE
  9203           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9204           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9205           MOVE PI-LIFE-OVERRIDE-L1
  9206                                 TO COMM-LF-AH
  9207           MOVE LOW-VALUES       TO COMM-FILLER
  9208           PERFORM 6400-READ-COMMISSION
  9209                                 THRU 6459-EXIT
  9210           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9211              MOVE -1            TO MAINTL
  9212              MOVE ER-1884       TO EMI-ERROR
  9213              PERFORM 9900-ERROR-FORMAT
  9214                                 THRU 9900-EXIT
  9215           END-IF
  9216        END-IF
  9217     END-IF
  9218
  9219     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9220         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9221
  9222     IF WS-ST-COMM-CAP-JL = ZEROS
  9223        CONTINUE
  9224     ELSE
  9225        IF (AM-J-COM (SUB) NUMERIC)
  9226           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9227           IF (WS-LIMIT-TO-ACCOUNT AND
  9228              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9229                       OR
  9230              (NOT WS-LIMIT-TO-ACCOUNT AND
  9231              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9232              MOVE -1            TO MAINTL
  9233              MOVE ER-1885       TO EMI-ERROR
  9234              PERFORM 9900-ERROR-FORMAT
  9235                                 THRU 9900-EXIT
  9236           END-IF
  9237        ELSE
  9238           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9239           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9240           MOVE PI-LIFE-OVERRIDE-L1
  9241                                 TO COMM-LF-AH
  9242           MOVE LOW-VALUES       TO COMM-FILLER
  9243           PERFORM 6400-READ-COMMISSION
  9244                                 THRU 6459-EXIT
  9245           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9246              MOVE -1            TO MAINTL
  9247              MOVE ER-1885       TO EMI-ERROR
  9248              PERFORM 9900-ERROR-FORMAT
  9249                                 THRU 9900-EXIT
  9250           END-IF
  9251        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL6501.cbl
  9252     END-IF
  9253
  9254     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9255         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9256
  9257     IF WS-ST-COMM-CAP-SA = ZEROS
  9258        CONTINUE
  9259     ELSE
  9260        IF (AM-A-COM (SUB) NUMERIC)
  9261           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9262           IF (WS-LIMIT-TO-ACCOUNT AND
  9263              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9264                       OR
  9265              (NOT WS-LIMIT-TO-ACCOUNT AND
  9266              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9267              MOVE -1            TO MAINTL
  9268              MOVE ER-1886       TO EMI-ERROR
  9269              PERFORM 9900-ERROR-FORMAT
  9270                                 THRU 9900-EXIT
  9271           END-IF
  9272        ELSE
  9273           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9274           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9275           MOVE PI-AH-OVERRIDE-L1
  9276                                 TO COMM-LF-AH
  9277           MOVE LOW-VALUES       TO COMM-FILLER
  9278           PERFORM 6400-READ-COMMISSION
  9279                                 THRU 6459-EXIT
  9280           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9281              MOVE -1            TO MAINTL
  9282              MOVE ER-1886       TO EMI-ERROR
  9283              PERFORM 9900-ERROR-FORMAT
  9284                                 THRU 9900-EXIT
  9285           END-IF
  9286        END-IF
  9287     END-IF
  9288
  9289     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9290         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9291
  9292     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9293         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9294
  9295     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9296        NEXT SENTENCE
  9297     ELSE
  9298        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9299
  9300     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9301         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9302
  9303     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9304         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9305
  9306     IF NOT PI-AR-PROCESSING
  9307        GO TO 6010-BUMP-SUB.
  9308
  9309     IF AM-AR-HI-CERT-DATE = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL6501.cbl
  9310        GO TO 6010-BUMP-SUB.
  9311
  9312     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9313                                   ATYPEA  (M-INDEX)
  9314                                   SINGLEA (M-INDEX)
  9315                                   JOINTA  (M-INDEX)
  9316                                   A-HA    (M-INDEX).
  9317
  9318 6010-BUMP-SUB.
  9319     ADD 1  TO SUB.
  9320     SET M-INDEX UP BY 1.
  9321     IF SUB LESS 11
  9322        GO TO 6005-LOOP.
  9323
  9324 6099-EXIT.
  9325      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL6501.cbl
  9327 6300-STARTBR.
  9328
  9329* EXEC CICS STARTBR
  9330*         DATASET   (ACCT-FILE-ID)
  9331*         RIDFLD    (WS-KEY-SAVE)
  9332*    END-EXEC.
  9333     MOVE 0
  9334       TO DFHEIV11
  9335*    MOVE '&,         G          &   #00008618' TO DFHEIV0
  9336     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9337     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9338     MOVE X'2020233030303038363138' TO DFHEIV0(25:11)
  9339     CALL 'kxdfhei1' USING DFHEIV0,
  9340           ACCT-FILE-ID,
  9341           WS-KEY-SAVE,
  9342           DFHEIV99,
  9343           DFHEIV11,
  9344           DFHEIV99
  9345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9346
  9347
  9348     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9349
  9350 6300-EXIT.
  9351      EXIT.
  9352
  9353 6310-READNEXT.
  9354
  9355* EXEC CICS READNEXT
  9356*         DATASET    (ACCT-FILE-ID)
  9357*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9358*         RIDFLD     (WS-KEY-SAVE)
  9359*    END-EXEC.
  9360     MOVE 0
  9361       TO DFHEIV11
  9362*    MOVE '&.S                   )   #00008629' TO DFHEIV0
  9363     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9364     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9365     MOVE X'2020233030303038363239' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0,
  9367           ACCT-FILE-ID,
  9368           DFHEIV20,
  9369           DFHEIV99,
  9370           WS-KEY-SAVE,
  9371           DFHEIV99,
  9372           DFHEIV11,
  9373           DFHEIV99,
  9374           DFHEIV99
  9375     SET ADDRESS OF ACCOUNT-MASTER TO
  9376         DFHEIV20
  9377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9378
  9379
  9380 6310-EXIT.
  9381      EXIT.
  9382
  9383 6320-ENDBR.
  9384     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL6501.cbl
  9385
  9386* EXEC CICS ENDBR
  9387*        DATASET(ACCT-FILE-ID)
  9388*    END-EXEC.
  9389     MOVE 0
  9390       TO DFHEIV11
  9391*    MOVE '&2                    $   #00008640' TO DFHEIV0
  9392     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9394     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
  9395     CALL 'kxdfhei1' USING DFHEIV0,
  9396           ACCT-FILE-ID,
  9397           DFHEIV11,
  9398           DFHEIV99
  9399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9400
  9401
  9402 6320-EXIT.
  9403      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL6501.cbl
  9405 6400-READ-COMMISSION.
  9406     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9407
  9408* EXEC CICS HANDLE CONDITION
  9409*         NOTFND   (6450-NOT-FOUND)
  9410*    END-EXEC
  9411*    MOVE '"$I                   ! . #00008649' TO DFHEIV0
  9412     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9414     MOVE X'2E20233030303038363439' TO DFHEIV0(25:11)
  9415     CALL 'kxdfhei1' USING DFHEIV0
  9416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9417
  9418
  9419* EXEC CICS READ
  9420*        GTEQ
  9421*        DATASET   (COMM-FILE-ID)
  9422*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9423*        RIDFLD    (COMM-KEY)
  9424*    END-EXEC
  9425*    MOVE '&"S        G          (   #00008653' TO DFHEIV0
  9426     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9428     MOVE X'2020233030303038363533' TO DFHEIV0(25:11)
  9429     CALL 'kxdfhei1' USING DFHEIV0,
  9430           COMM-FILE-ID,
  9431           DFHEIV20,
  9432           DFHEIV99,
  9433           COMM-KEY,
  9434           DFHEIV99,
  9435           DFHEIV99,
  9436           DFHEIV99
  9437     SET ADDRESS OF COMM-TABLE-RECORD TO
  9438         DFHEIV20
  9439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9440
  9441     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9442        CT-TABLE      = COMM-TABLE    AND
  9443        CT-BEN-TYPE   = COMM-LF-AH
  9444        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9445        GO TO 6459-EXIT
  9446     END-IF
  9447     .
  9448 6450-NOT-FOUND.
  9449     MOVE ER-2176                TO EMI-ERROR.
  9450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9451     MOVE 1  TO WS-COMM-ERROR-SW.
  9452
  9453 6459-EXIT.
  9454      EXIT.
  9455
  9456 6460-CHECK-MAX.
  9457
  9458
  9459* EXEC CICS STARTBR
  9460*         DATASET   (COMM-FILE-ID)
  9461*         RIDFLD    (COMM-KEY)
  9462*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL6501.cbl
  9463*    END-EXEC
  9464     MOVE 0
  9465       TO DFHEIV11
  9466*    MOVE '&,         G          &  N#00008677' TO DFHEIV0
  9467     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9468     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9469     MOVE X'204E233030303038363737' TO DFHEIV0(25:11)
  9470     CALL 'kxdfhei1' USING DFHEIV0,
  9471           COMM-FILE-ID,
  9472           COMM-KEY,
  9473           DFHEIV99,
  9474           DFHEIV11,
  9475           DFHEIV99
  9476     MOVE EIBRESP  TO WS-RESPONSE
  9477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9478
  9479     MOVE SPACES          TO WS-STATE-MAX-SW
  9480
  9481     IF RESP-NORMAL
  9482        MOVE LOW-VALUES          TO COMM-FILLER
  9483        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9484        MOVE ZEROS               TO WS-TABLE-MAX
  9485        PERFORM UNTIL
  9486              (NOT RESP-NORMAL) OR
  9487              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9488
  9489* EXEC CICS READNEXT
  9490*             DATASET   (COMM-FILE-ID)
  9491*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9492*             RIDFLD    (COMM-KEY)
  9493*             RESP      (WS-RESPONSE)
  9494*           END-EXEC
  9495     MOVE 0
  9496       TO DFHEIV11
  9497*    MOVE '&.S                   )  N#00008692' TO DFHEIV0
  9498     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9499     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9500     MOVE X'204E233030303038363932' TO DFHEIV0(25:11)
  9501     CALL 'kxdfhei1' USING DFHEIV0,
  9502           COMM-FILE-ID,
  9503           DFHEIV20,
  9504           DFHEIV99,
  9505           COMM-KEY,
  9506           DFHEIV99,
  9507           DFHEIV11,
  9508           DFHEIV99,
  9509           DFHEIV99
  9510     SET ADDRESS OF COMM-TABLE-RECORD TO
  9511         DFHEIV20
  9512     MOVE EIBRESP  TO WS-RESPONSE
  9513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9514            IF (RESP-NORMAL) AND
  9515               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9516               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9517                   (WS-NDX > +27)
  9518                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9519                      MOVE CT-RT (WS-NDX)
  9520                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL6501.cbl
  9521                   END-IF
  9522               END-PERFORM
  9523            END-IF
  9524        END-PERFORM
  9525
  9526* EXEC CICS ENDBR
  9527*            DATASET   (COMM-FILE-ID)
  9528*       END-EXEC
  9529     MOVE 0
  9530       TO DFHEIV11
  9531*    MOVE '&2                    $   #00008709' TO DFHEIV0
  9532     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9533     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9534     MOVE X'2020233030303038373039' TO DFHEIV0(25:11)
  9535     CALL 'kxdfhei1' USING DFHEIV0,
  9536           COMM-FILE-ID,
  9537           DFHEIV11,
  9538           DFHEIV99
  9539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9540     END-IF
  9541
  9542     .
  9543 6460-EXIT.
  9544      EXIT.
  9545
  9546
  9547 6500-READ-ACCT.
  9548
  9549* EXEC CICS READ
  9550*        GTEQ
  9551*        DATASET   (ACCT-FILE-ID)
  9552*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9553*        RIDFLD    (PI-ACCT-KEY)
  9554*    END-EXEC.
  9555*    MOVE '&"S        G          (   #00008720' TO DFHEIV0
  9556     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9558     MOVE X'2020233030303038373230' TO DFHEIV0(25:11)
  9559     CALL 'kxdfhei1' USING DFHEIV0,
  9560           ACCT-FILE-ID,
  9561           DFHEIV20,
  9562           DFHEIV99,
  9563           PI-ACCT-KEY,
  9564           DFHEIV99,
  9565           DFHEIV99,
  9566           DFHEIV99
  9567     SET ADDRESS OF ACCOUNT-MASTER TO
  9568         DFHEIV20
  9569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9570
  9571
  9572 6599-EXIT.
  9573      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL6501.cbl
  9575 6600-UPDATE-MAINT-DT.
  9576     MOVE SPACES                 TO ELCNTL-KEY.
  9577
  9578     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9579     MOVE '1'                    TO CNTL-REC-TYPE.
  9580     MOVE +0                     TO CNTL-SEQ-NO.
  9581
  9582
  9583* EXEC CICS HANDLE CONDITION
  9584*        NOTFND   (6699-EXIT)
  9585*    END-EXEC.
  9586*    MOVE '"$I                   ! / #00008737' TO DFHEIV0
  9587     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9589     MOVE X'2F20233030303038373337' TO DFHEIV0(25:11)
  9590     CALL 'kxdfhei1' USING DFHEIV0
  9591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9592
  9593
  9594
  9595* EXEC CICS READ
  9596*        UPDATE
  9597*        DATASET   (CNTL-FILE-ID)
  9598*        SET       (ADDRESS OF CONTROL-FILE)
  9599*        RIDFLD    (ELCNTL-KEY)
  9600*    END-EXEC.
  9601*    MOVE '&"S        EU         (   #00008741' TO DFHEIV0
  9602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9603     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9604     MOVE X'2020233030303038373431' TO DFHEIV0(25:11)
  9605     CALL 'kxdfhei1' USING DFHEIV0,
  9606           CNTL-FILE-ID,
  9607           DFHEIV20,
  9608           DFHEIV99,
  9609           ELCNTL-KEY,
  9610           DFHEIV99,
  9611           DFHEIV99,
  9612           DFHEIV99
  9613     SET ADDRESS OF CONTROL-FILE TO
  9614         DFHEIV20
  9615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9616
  9617
  9618     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9619
  9620
  9621* EXEC CICS REWRITE
  9622*        DATASET   (CNTL-FILE-ID)
  9623*        FROM      (CONTROL-FILE)
  9624*    END-EXEC.
  9625     MOVE LENGTH OF
  9626      CONTROL-FILE
  9627       TO DFHEIV11
  9628*    MOVE '&& L                  %   #00008750' TO DFHEIV0
  9629     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9630     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9631     MOVE X'2020233030303038373530' TO DFHEIV0(25:11)
  9632     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL6501.cbl
  9633           CNTL-FILE-ID,
  9634           CONTROL-FILE,
  9635           DFHEIV11,
  9636           DFHEIV99
  9637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9638
  9639
  9640 6699-EXIT.
  9641      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL6501.cbl
  9643 6700-BUILD-COMM-WORK.
  9644     IF NOT PI-GA-BILLING
  9645         GO TO 6799-EXIT.
  9646
  9647
  9648* EXEC CICS GETMAIN
  9649*         LENGTH   (260)
  9650*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9651*         INITIMG  (GETMAIN-SPACE)
  9652*     END-EXEC.
  9653     MOVE 260
  9654       TO DFHEIV11
  9655*    MOVE ',"IL                  $   #00008762' TO DFHEIV0
  9656     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9657     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9658     MOVE X'2020233030303038373632' TO DFHEIV0(25:11)
  9659     CALL 'kxdfhei1' USING DFHEIV0,
  9660           DFHEIV20,
  9661           DFHEIV11,
  9662           GETMAIN-SPACE
  9663     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9664         DFHEIV20
  9665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9666
  9667     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9668
  9669     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9670     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9671     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9672
  9673     IF PI-MAINT = 'A'
  9674         GO TO 6799-EXIT.
  9675
  9676     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9677     MOVE +1                TO AXRF-SUB.
  9678
  9679 6710-AXRF-LOOP.
  9680     MOVE SPACES         TO AGENT-FIND.
  9681     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9682
  9683     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9684
  9685     IF AGENT-FIND = SPACES
  9686        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9687             WK-GA-BILL-DT (AXRF-SUB)
  9688     ELSE
  9689        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9690
  9691     ADD +1 TO AXRF-SUB.
  9692
  9693     IF AXRF-SUB NOT = +11
  9694        GO TO 6710-AXRF-LOOP.
  9695
  9696 6799-EXIT.
  9697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL6501.cbl
  9699 6800-COMPANY-REC-READ.
  9700     MOVE SPACES                 TO ELCNTL-KEY.
  9701     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9702     MOVE '1'                    TO CNTL-REC-TYPE.
  9703     MOVE +0                     TO CNTL-SEQ-NO.
  9704
  9705* EXEC CICS HANDLE CONDITION
  9706*        NOTFND   (6880-NO-COMP)
  9707*    END-EXEC.
  9708*    MOVE '"$I                   ! 0 #00008804' TO DFHEIV0
  9709     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9711     MOVE X'3020233030303038383034' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0
  9713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9714
  9715
  9716
  9717* EXEC CICS READ
  9718*        DATASET   (CNTL-FILE-ID)
  9719*        SET       (ADDRESS OF CONTROL-FILE)
  9720*        RIDFLD    (ELCNTL-KEY)
  9721*    END-EXEC.
  9722*    MOVE '&"S        E          (   #00008808' TO DFHEIV0
  9723     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9725     MOVE X'2020233030303038383038' TO DFHEIV0(25:11)
  9726     CALL 'kxdfhei1' USING DFHEIV0,
  9727           CNTL-FILE-ID,
  9728           DFHEIV20,
  9729           DFHEIV99,
  9730           ELCNTL-KEY,
  9731           DFHEIV99,
  9732           DFHEIV99,
  9733           DFHEIV99
  9734     SET ADDRESS OF CONTROL-FILE TO
  9735         DFHEIV20
  9736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9737
  9738
  9739     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9740         MOVE ER-2572               TO EMI-ERROR
  9741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9742
  9743     GO TO 6899-EXIT.
  9744
  9745 6880-NO-COMP.
  9746     MOVE ER-0002                TO EMI-ERROR.
  9747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9748
  9749 6899-EXIT.
  9750     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL6501.cbl
  9752 6900-READ-AND-CHECK-AXRF.
  9753     IF NOT PI-GA-BILLING
  9754        GO TO 6999-EXIT.
  9755
  9756     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9757     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9758
  9759 6905-AGENT-LEVEL-LOOP.
  9760     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9761     MOVE SPACES TO AGENT-FIND.
  9762     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9763      OR
  9764        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9765      AND
  9766        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9767                             OR 'B' OR 'I'
  9768                             OR 'K' OR 'L' OR 'J' OR 'M'
  9769                                    OR 'A' OR 'N')
  9770                            OR
  9771        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9772                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
  9773                                         OR 'A' OR 'N'))
  9774            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
  9775            IF AGENT-RECORD-NOT-FOUND
  9776               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
  9777           ELSE
  9778            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
  9779               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
  9780           ELSE
  9781        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
  9782              AND 'B' AND 'I'
  9783              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
  9784           (AM-AGT (AXRF-SUB) NOT =
  9785                   WK-AM-AGT (AXRF-SUB))
  9786           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
  9787           GO TO 6910-INC-SUB.
  9788
  9789     MOVE SPACES TO AGENT-FIND.
  9790     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
  9791        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
  9792                               SPACES AND ZEROS)
  9793          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
  9794          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
  9795          PERFORM 6921-READ-AXRF THRU 6929-EXIT
  9796          IF AGENT-FIND = SPACES
  9797              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
  9798
  9799 6910-INC-SUB.
  9800     ADD +1                      TO AXRF-SUB.
  9801     IF AXRF-SUB NOT = +11
  9802        GO TO 6905-AGENT-LEVEL-LOOP.
  9803
  9804     GO TO 6999-EXIT.
  9805
  9806 6920-READ-AXRF-FILE.
  9807*    IF GETMAIN-SW = 'X'
  9808*       GO TO 6920-BUILD-KEY.
  9809*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL6501.cbl
  9810*    EXEC CICS GETMAIN
  9811*         LENGTH   (ERGXRF-REC-LEN)
  9812*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  9813*         INITIMG  (GETMAIN-SPACE)
  9814*    END-EXEC.
  9815*
  9816*    MOVE 'X' TO GETMAIN-SW.
  9817
  9818 6920-BUILD-KEY.
  9819     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
  9820
  9821     IF PI-ZERO-CARRIER
  9822       OR PI-ZERO-CAR-GROUP
  9823         MOVE ZERO               TO WS-AXRF-CARRIER
  9824     ELSE
  9825         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
  9826
  9827     IF PI-ZERO-GROUPING
  9828       OR PI-ZERO-CAR-GROUP
  9829         MOVE ZEROS              TO WS-AXRF-GROUPING
  9830     ELSE
  9831         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
  9832
  9833     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
  9834                                              LOW-VALUES
  9835        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
  9836     ELSE
  9837     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
  9838                                              LOW-VALUES
  9839        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
  9840     ELSE
  9841        MOVE 'X' TO AGENT-FIND
  9842        GO TO 6929-EXIT.
  9843
  9844     MOVE +1 TO GX-AGENT-SUB.
  9845
  9846 6921-READ-AXRF.
  9847
  9848* EXEC CICS HANDLE CONDITION
  9849*         ENDFILE     (6925-NOT-FIND)
  9850*         NOTFND      (6925-NOT-FIND)
  9851*    END-EXEC.
  9852*    MOVE '"$''I                  ! 1 #00008922' TO DFHEIV0
  9853     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9855     MOVE X'3120233030303038393232' TO DFHEIV0(25:11)
  9856     CALL 'kxdfhei1' USING DFHEIV0
  9857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9858
  9859
  9860
  9861* EXEC CICS READ
  9862*        DATASET   (ERGXRF-FILE-ID)
  9863*        LENGTH    (ERGXRF-REC-LEN)
  9864*        INTO      (AGENT-CROSS-REFERENCE)
  9865*        RIDFLD    (WS-AXRF-KEY)
  9866*        EQUAL
  9867*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL6501.cbl
  9868*    MOVE '&"IL       E          (   #00008927' TO DFHEIV0
  9869     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9871     MOVE X'2020233030303038393237' TO DFHEIV0(25:11)
  9872     CALL 'kxdfhei1' USING DFHEIV0,
  9873           ERGXRF-FILE-ID,
  9874           AGENT-CROSS-REFERENCE,
  9875           ERGXRF-REC-LEN,
  9876           WS-AXRF-KEY,
  9877           DFHEIV99,
  9878           DFHEIV99,
  9879           DFHEIV99
  9880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9881
  9882
  9883     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  9884
  9885     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
  9886             FROM +1 BY +1 UNTIL
  9887         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
  9888         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
  9889         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
  9890         AND
  9891         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
  9892         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
  9893         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
  9894         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
  9895
  9896     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  9897        MOVE 'Y' TO AGENT-FIND
  9898        GO TO 6929-EXIT.
  9899
  9900     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
  9901        MOVE 'Z' TO AGENT-FIND.
  9902
  9903     GO TO 6929-EXIT.
  9904
  9905 6921-FIND-ACCT-LOOP.
  9906***  DUMMY PARAGRAPH  ***
  9907
  9908 6925-NOT-FIND.
  9909     MOVE 'X' TO AGENT-FIND.
  9910
  9911 6929-EXIT.
  9912     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL6501.cbl
  9914 6950-ADD-AGENT-RECORD.
  9915     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
  9916        GO TO 6959-EXIT.
  9917
  9918     MOVE +109                   TO ERGXRF-REC-LEN.
  9919
  9920     MOVE +1                     TO GX-AGENT-POINTER-CNT.
  9921     MOVE 'GX'                   TO GX-RECORD-ID.
  9922     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
  9923
  9924     IF PI-ZERO-CARRIER
  9925       OR PI-ZERO-CAR-GROUP
  9926         MOVE ZERO               TO GX-CARRIER
  9927     ELSE
  9928         MOVE AM-CARRIER         TO GX-CARRIER.
  9929
  9930     IF PI-ZERO-GROUPING
  9931       OR PI-ZERO-CAR-GROUP
  9932         MOVE ZERO               TO GX-GROUPING
  9933     ELSE
  9934         MOVE AM-GROUPING        TO GX-GROUPING.
  9935
  9936     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
  9937
  9938     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
  9939     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
  9940     MOVE AM-STATE               TO GX-AM-STATE (1).
  9941     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
  9942     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
  9943     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
  9944     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
  9945     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
  9946
  9947     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
  9948     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
  9949     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
  9950
  9951
  9952* EXEC CICS WRITE
  9953*        FROM      (AGENT-CROSS-REFERENCE)
  9954*        LENGTH    (ERGXRF-REC-LEN)
  9955*        RIDFLD    (GX-CONTROL-PRIMARY)
  9956*        DATASET   (ERGXRF-FILE-ID)
  9957*    END-EXEC.
  9958*    MOVE '&$ L                  ''   #00009003' TO DFHEIV0
  9959     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9961     MOVE X'2020233030303039303033' TO DFHEIV0(25:11)
  9962     CALL 'kxdfhei1' USING DFHEIV0,
  9963           ERGXRF-FILE-ID,
  9964           AGENT-CROSS-REFERENCE,
  9965           ERGXRF-REC-LEN,
  9966           GX-CONTROL-PRIMARY,
  9967           DFHEIV99,
  9968           DFHEIV99
  9969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9970
  9971
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL6501.cbl
  9972 6959-EXIT.
  9973      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL6501.cbl
  9975 6970-REWRITE-AGENT-RECORD.
  9976     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9977
  9978
  9979* EXEC CICS READ
  9980*        DATASET   (ERGXRF-FILE-ID)
  9981*        INTO      (AGENT-CROSS-REFERENCE)
  9982*        LENGTH    (ERGXRF-REC-LEN)
  9983*        RIDFLD    (WS-AXRF-KEY)
  9984*        EQUAL
  9985*        UPDATE
  9986*    END-EXEC.
  9987*    MOVE '&"IL       EU         (   #00009016' TO DFHEIV0
  9988     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9989     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9990     MOVE X'2020233030303039303136' TO DFHEIV0(25:11)
  9991     CALL 'kxdfhei1' USING DFHEIV0,
  9992           ERGXRF-FILE-ID,
  9993           AGENT-CROSS-REFERENCE,
  9994           ERGXRF-REC-LEN,
  9995           WS-AXRF-KEY,
  9996           DFHEIV99,
  9997           DFHEIV99,
  9998           DFHEIV99
  9999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10000
 10001
 10002     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10003
 10004     IF ACCT-LEVEL-DIFFERENT
 10005        GO TO 6975-UPDATE-LEVEL-NO.
 10006
 10007     IF GX-AGENT-POINTER-CNT = +1006
 10008         GO TO 6979-EXIT.
 10009
 10010     MOVE +1 TO FIND-AGENT-SUB1.
 10011
 10012 6972-FIND-REC-LOCATION.
 10013     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10014     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10015
 10016     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10017        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10018        NEXT SENTENCE
 10019     ELSE
 10020        ADD +1 TO FIND-AGENT-SUB1
 10021        GO TO 6972-FIND-REC-LOCATION.
 10022
 10023     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10024                                  FIND-AGENT-SUB3.
 10025     ADD +1 TO FIND-AGENT-SUB3.
 10026
 10027     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10028        NEXT SENTENCE
 10029     ELSE
 10030        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10031        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10032        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL6501.cbl
 10033
 10034     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10035     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10036
 10037     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10038     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10039
 10040     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10041     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10042     MOVE AM-EXPIRATION-DT TO
 10043                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10044     MOVE AM-EFFECTIVE-DT  TO
 10045                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10046     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10047     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10048
 10049 6975-UPDATE-LEVEL-NO.
 10050     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10051     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10052     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10053     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10054     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10055     if ergxrf-rec-len > +31264
 10056        move +31264               to ergxrf-rec-len
 10057        move +1006                to gx-agent-pointer-cnt
 10058     end-if
 10059
 10060
 10061* EXEC CICS REWRITE
 10062*        FROM      (AGENT-CROSS-REFERENCE)
 10063*        LENGTH    (ERGXRF-REC-LEN)
 10064*        DATASET   (ERGXRF-FILE-ID)
 10065*    END-EXEC.
 10066*    MOVE '&& L                  %   #00009083' TO DFHEIV0
 10067     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10068     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10069     MOVE X'2020233030303039303833' TO DFHEIV0(25:11)
 10070     CALL 'kxdfhei1' USING DFHEIV0,
 10071           ERGXRF-FILE-ID,
 10072           AGENT-CROSS-REFERENCE,
 10073           ERGXRF-REC-LEN,
 10074           DFHEIV99
 10075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10076
 10077
 10078     GO TO 6979-EXIT.
 10079
 10080 6977-BUMP-AXRF-REC.
 10081     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10082          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10083
 10084     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10085
 10086 6979-EXIT.
 10087     EXIT.
 10088
 10089 6999-EXIT.
 10090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL6501.cbl
 10092 7000-DELETE-AXRF-REC.
 10093     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10094
 10095
 10096* EXEC CICS HANDLE CONDITION
 10097*         ENDFILE     (7999-EXIT)
 10098*         NOTFND      (7999-EXIT)
 10099*    END-EXEC.
 10100*    MOVE '"$''I                  ! 2 #00009106' TO DFHEIV0
 10101     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10103     MOVE X'3220233030303039313036' TO DFHEIV0(25:11)
 10104     CALL 'kxdfhei1' USING DFHEIV0
 10105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10106
 10107
 10108
 10109* EXEC CICS READ
 10110*        DATASET   (ERGXRF-FILE-ID)
 10111*        INTO      (AGENT-CROSS-REFERENCE)
 10112*        LENGTH    (ERGXRF-REC-LEN)
 10113*        RIDFLD    (WS-AXRF-KEY)
 10114*        EQUAL
 10115*        UPDATE
 10116*    END-EXEC.
 10117*    MOVE '&"IL       EU         (   #00009111' TO DFHEIV0
 10118     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10119     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10120     MOVE X'2020233030303039313131' TO DFHEIV0(25:11)
 10121     CALL 'kxdfhei1' USING DFHEIV0,
 10122           ERGXRF-FILE-ID,
 10123           AGENT-CROSS-REFERENCE,
 10124           ERGXRF-REC-LEN,
 10125           WS-AXRF-KEY,
 10126           DFHEIV99,
 10127           DFHEIV99,
 10128           DFHEIV99
 10129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10130
 10131
 10132     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10133
 10134     IF GX-AGENT-SUB = +0
 10135        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10136        FROM +1 BY +1 UNTIL
 10137         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10138         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10139         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10140         AND
 10141         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10142         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10143         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10144         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10145
 10146     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10147        GO TO 7999-EXIT.
 10148
 10149     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL6501.cbl
 10150     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10151                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10152                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10153     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10154     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10155     GO TO 7020-REWRITE-AXRF-RECORD.
 10156
 10157 7010-BUMP-RECORDS.
 10158     ADD +1 TO FIND-AGENT-SUB1.
 10159     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10160          GX-AGENT-POINTER (GX-AGENT-SUB).
 10161
 10162 7020-REWRITE-AXRF-RECORD.
 10163     IF GX-AGENT-POINTER-CNT = +0
 10164
 10165* EXEC CICS DELETE
 10166*            DATASET   (ERGXRF-FILE-ID)
 10167*       END-EXEC
 10168*    MOVE '&(                    &   #00009152' TO DFHEIV0
 10169     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10170     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10171     MOVE X'2020233030303039313532' TO DFHEIV0(25:11)
 10172     CALL 'kxdfhei1' USING DFHEIV0,
 10173           ERGXRF-FILE-ID,
 10174           DFHEIV99,
 10175           DFHEIV99,
 10176           DFHEIV99,
 10177           DFHEIV99
 10178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10179     ELSE
 10180        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10181        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10182        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10183        compute ergxrf-rec-len =
 10184            (gx-agent-pointer-cnt * +31) + +78
 10185        if ergxrf-rec-len > +31264
 10186           move +31264               to ergxrf-rec-len
 10187           move +1006                to gx-agent-pointer-cnt
 10188        end-if
 10189
 10190* EXEC CICS REWRITE
 10191*            FROM      (AGENT-CROSS-REFERENCE)
 10192*            LENGTH    (ERGXRF-REC-LEN)
 10193*            DATASET   (ERGXRF-FILE-ID)
 10194*       END-EXEC.
 10195*    MOVE '&& L                  %   #00009165' TO DFHEIV0
 10196     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10197     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10198     MOVE X'2020233030303039313635' TO DFHEIV0(25:11)
 10199     CALL 'kxdfhei1' USING DFHEIV0,
 10200           ERGXRF-FILE-ID,
 10201           AGENT-CROSS-REFERENCE,
 10202           ERGXRF-REC-LEN,
 10203           DFHEIV99
 10204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10205
 10206
 10207 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL6501.cbl
 10208     EXIT.
 10209
 10210*************************************
 10211 8000-STATE-REC-READ.
 10212     MOVE SPACES                 TO ELCNTL-KEY.
 10213     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10214     MOVE '3'                    TO CNTL-REC-TYPE.
 10215     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10216     MOVE +0                     TO CNTL-SEQ-NO.
 10217
 10218* EXEC CICS HANDLE CONDITION
 10219*        NOTFND  (8010-EXIT)
 10220*    END-EXEC.
 10221*    MOVE '"$I                   ! 3 #00009181' TO DFHEIV0
 10222     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10224     MOVE X'3320233030303039313831' TO DFHEIV0(25:11)
 10225     CALL 'kxdfhei1' USING DFHEIV0
 10226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10227
 10228
 10229
 10230* EXEC CICS READ
 10231*        DATASET   (CNTL-FILE-ID)
 10232*        SET       (ADDRESS OF CONTROL-FILE)
 10233*        RIDFLD    (ELCNTL-KEY)
 10234*    END-EXEC.
 10235*    MOVE '&"S        E          (   #00009185' TO DFHEIV0
 10236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10238     MOVE X'2020233030303039313835' TO DFHEIV0(25:11)
 10239     CALL 'kxdfhei1' USING DFHEIV0,
 10240           CNTL-FILE-ID,
 10241           DFHEIV20,
 10242           DFHEIV99,
 10243           ELCNTL-KEY,
 10244           DFHEIV99,
 10245           DFHEIV99,
 10246           DFHEIV99
 10247     SET ADDRESS OF CONTROL-FILE TO
 10248         DFHEIV20
 10249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10250
 10251
 10252     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10253     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10254
 10255 8010-EXIT.
 10256      EXIT.
 10257
 10258 8050-USER-REC-READ.
 10259     MOVE SPACES                 TO ELCNTL-KEY.
 10260     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10261     MOVE '2'                    TO CNTL-REC-TYPE.
 10262     MOVE CSRI                   TO CNTL-ACCESS.
 10263     MOVE +0                     TO CNTL-SEQ-NO.
 10264
 10265* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL6501.cbl
 10266*        NOTFND  (8055-NOTFND)
 10267*    END-EXEC.
 10268*    MOVE '"$I                   ! 4 #00009203' TO DFHEIV0
 10269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10271     MOVE X'3420233030303039323033' TO DFHEIV0(25:11)
 10272     CALL 'kxdfhei1' USING DFHEIV0
 10273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10274
 10275
 10276
 10277* EXEC CICS READ
 10278*        DATASET   (CNTL-FILE-ID)
 10279*        SET       (ADDRESS OF CONTROL-FILE)
 10280*        RIDFLD    (ELCNTL-KEY)
 10281*    END-EXEC.
 10282*    MOVE '&"S        E          (   #00009207' TO DFHEIV0
 10283     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10285     MOVE X'2020233030303039323037' TO DFHEIV0(25:11)
 10286     CALL 'kxdfhei1' USING DFHEIV0,
 10287           CNTL-FILE-ID,
 10288           DFHEIV20,
 10289           DFHEIV99,
 10290           ELCNTL-KEY,
 10291           DFHEIV99,
 10292           DFHEIV99,
 10293           DFHEIV99
 10294     SET ADDRESS OF CONTROL-FILE TO
 10295         DFHEIV20
 10296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10297
 10298
 10299     GO TO 8060-EXIT.
 10300
 10301 8055-NOTFND.
 10302     MOVE ER-1883             TO EMI-ERROR.
 10303     MOVE -1                  TO CSRL.
 10304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10305
 10306 8060-EXIT.
 10307      EXIT.
 10308
 10309*************************************
 10310
 10311 8100-SEND-INITIAL-MAP.
 10312     MOVE SAVE-DATE              TO DATEO.
 10313     MOVE EIBTIME                TO TIME-IN.
 10314     MOVE TIME-OUT               TO TIMEO.
 10315     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10316     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10317     MOVE -1                     TO PFENTERL.
 10318     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10319
 10320     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10321
 10322*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10323*       NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL6501.cbl
 10324*    ELSE
 10325*       MOVE AL-SADOF            TO PSIHEADA
 10326*                                   PSILFTA
 10327*                                   PSILFCA
 10328*                                   PSIAHTA
 10329*                                   PSIAHCA
 10330*                                   PSILFFA
 10331*                                   PSIAHFA.
 10332
 10333*    IF PI-COMPANY-ID = 'DMD'
 10334*         MOVE AL-SANOF          TO KEY10A.
 10335
 10336     IF PI-COMPANY-ID = 'DCC'
 10337        CONTINUE
 10338     ELSE
 10339        MOVE AL-SADOF            TO CTPLABLA
 10340                                    CLPTOLPA
 10341                                    LCLABLA
 10342                                    LCOMMA
 10343                                    MAXFEEHA
 10344                                    CLPSTHA
 10345                                    PRODCDHA
 10346     END-IF
 10347     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10348        MOVE -1                  TO CSRL.
 10349
 10350     IF  CLAIM-SESSION
 10351         MOVE SPACES             TO PF1PF2O
 10352         MOVE AL-SANOF           TO PF1PF2A.
 10353
 10354
 10355* EXEC CICS SEND
 10356*        MAP      (MAP-NAME)
 10357*        MAPSET   (MAPSET-NAME)
 10358*        FROM     (EL6501AO)
 10359*        ERASE
 10360*        CURSOR
 10361*    END-EXEC.
 10362     MOVE LENGTH OF
 10363      EL6501AO
 10364       TO DFHEIV12
 10365     MOVE -1
 10366       TO DFHEIV11
 10367*    MOVE '8$     CT  E    H L F ,   #00009268' TO DFHEIV0
 10368     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10369     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10370     MOVE X'2020233030303039323638' TO DFHEIV0(25:11)
 10371     CALL 'kxdfhei1' USING DFHEIV0,
 10372           MAP-NAME,
 10373           EL6501AO,
 10374           DFHEIV12,
 10375           MAPSET-NAME,
 10376           DFHEIV99,
 10377           DFHEIV99,
 10378           DFHEIV99,
 10379           DFHEIV11,
 10380           DFHEIV99,
 10381           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL6501.cbl
 10382           DFHEIV99
 10383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10384
 10385
 10386     GO TO 9100-RETURN-TRAN.
 10387
 10388 8200-SEND-DATAONLY.
 10389     MOVE SAVE-DATE              TO DATEO.
 10390     MOVE EIBTIME                TO TIME-IN.
 10391     MOVE TIME-OUT               TO TIMEO.
 10392     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10393     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10394     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10395
 10396     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10397
 10398     IF PI-COMPANY-ID = 'DCC'
 10399        CONTINUE
 10400     ELSE
 10401        MOVE AL-SADOF            TO CTPLABLA
 10402                                    CLPTOLPA
 10403                                    LCLABLA
 10404                                    LCOMMA
 10405                                    MAXFEEHA
 10406                                    CLPSTHA
 10407                                    PRODCDHA
 10408     END-IF
 10409     IF  CLAIM-SESSION
 10410         MOVE SPACES             TO PF1PF2O
 10411         MOVE AL-SANOF           TO PF1PF2A.
 10412
 10413
 10414* EXEC CICS SEND
 10415*        MAP      (MAP-NAME)
 10416*        MAPSET   (MAPSET-NAME)
 10417*        FROM     (EL6501AO)
 10418*        DATAONLY
 10419*        CURSOR
 10420*    END-EXEC.
 10421     MOVE LENGTH OF
 10422      EL6501AO
 10423       TO DFHEIV12
 10424     MOVE -1
 10425       TO DFHEIV11
 10426*    MOVE '8$D    CT       H L F ,   #00009303' TO DFHEIV0
 10427     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10428     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10429     MOVE X'2020233030303039333033' TO DFHEIV0(25:11)
 10430     CALL 'kxdfhei1' USING DFHEIV0,
 10431           MAP-NAME,
 10432           EL6501AO,
 10433           DFHEIV12,
 10434           MAPSET-NAME,
 10435           DFHEIV99,
 10436           DFHEIV99,
 10437           DFHEIV99,
 10438           DFHEIV11,
 10439           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL6501.cbl
 10440           DFHEIV99,
 10441           DFHEIV99
 10442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10443
 10444
 10445     GO TO 9100-RETURN-TRAN.
 10446
 10447 8300-SEND-TEXT.
 10448
 10449* EXEC CICS SEND TEXT
 10450*        FROM     (LOGOFF-TEXT)
 10451*        LENGTH   (LOGOFF-LENGTH)
 10452*        ERASE
 10453*        FREEKB
 10454*    END-EXEC.
 10455*    MOVE '8&      T  E F  H   F -   #00009314' TO DFHEIV0
 10456     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10457     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10458     MOVE X'2020233030303039333134' TO DFHEIV0(25:11)
 10459     CALL 'kxdfhei1' USING DFHEIV0,
 10460           LOGOFF-TEXT,
 10461           LOGOFF-LENGTH,
 10462           DFHEIV99,
 10463           DFHEIV99,
 10464           DFHEIV99,
 10465           DFHEIV99,
 10466           DFHEIV99,
 10467           DFHEIV99,
 10468           DFHEIV99,
 10469           DFHEIV99,
 10470           DFHEIV99,
 10471           DFHEIV99
 10472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10473
 10474
 10475
 10476* EXEC CICS RETURN
 10477*    END-EXEC.
 10478*    MOVE '.(                    &   #00009321' TO DFHEIV0
 10479     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10480     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10481     MOVE X'2020233030303039333231' TO DFHEIV0(25:11)
 10482     CALL 'kxdfhei1' USING DFHEIV0,
 10483           DFHEIV99,
 10484           DFHEIV99,
 10485           DFHEIV99,
 10486           DFHEIV99,
 10487           DFHEIV99
 10488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10489
 10490
 10491 8600-DEEDIT.
 10492
 10493* EXEC CICS BIF DEEDIT
 10494*         FIELD(DEEDIT-FIELD)
 10495*         LENGTH(15)
 10496*     END-EXEC.
 10497     MOVE 15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL6501.cbl
 10498       TO DFHEIV11
 10499*    MOVE '@"L                   #   #00009325' TO DFHEIV0
 10500     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10501     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10502     MOVE X'2020233030303039333235' TO DFHEIV0(25:11)
 10503     CALL 'kxdfhei1' USING DFHEIV0,
 10504           DEEDIT-FIELD,
 10505           DFHEIV11
 10506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10507
 10508
 10509 8800-UNAUTHORIZED-ACCESS.
 10510     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10511     GO TO 8300-SEND-TEXT.
 10512
 10513 8810-PF23.
 10514     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10515     MOVE XCTL-005               TO PGM-NAME.
 10516     GO TO 9300-XCTL.
 10517
 10518 9100-RETURN-TRAN.
 10519     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10520     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10521
 10522* EXEC CICS RETURN
 10523*        TRANSID    (TRANS-ID)
 10524*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10525*        LENGTH     (WS-COMM-LENGTH)
 10526*    END-EXEC.
 10527*    MOVE '.(CT                  &   #00009342' TO DFHEIV0
 10528     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10529     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10530     MOVE X'2020233030303039333432' TO DFHEIV0(25:11)
 10531     CALL 'kxdfhei1' USING DFHEIV0,
 10532           TRANS-ID,
 10533           PROGRAM-INTERFACE-BLOCK,
 10534           WS-COMM-LENGTH,
 10535           DFHEIV99,
 10536           DFHEIV99
 10537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10538
 10539
 10540 9200-RETURN-MAIN-MENU.
 10541     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10542         MOVE XCTL-126           TO  PGM-NAME
 10543     ELSE
 10544         MOVE XCTL-626           TO  PGM-NAME.
 10545
 10546     GO TO 9300-XCTL.
 10547
 10548 9300-XCTL.
 10549
 10550* EXEC CICS XCTL
 10551*        PROGRAM    (PGM-NAME)
 10552*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10553*        LENGTH     (WS-COMM-LENGTH)
 10554*    END-EXEC.
 10555*    MOVE '.$C                   $   #00009357' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL6501.cbl
 10556     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10558     MOVE X'2020233030303039333537' TO DFHEIV0(25:11)
 10559     CALL 'kxdfhei1' USING DFHEIV0,
 10560           PGM-NAME,
 10561           PROGRAM-INTERFACE-BLOCK,
 10562           WS-COMM-LENGTH
 10563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10564
 10565
 10566 9400-CLEAR.
 10567     IF PI-GA-BILLING
 10568        IF GETMAIN-ACQUIRED
 10569           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10570           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10571
 10572* EXEC CICS FREEMAIN
 10573*               DATA     (COMMISSION-WORK-AREA)
 10574*          END-EXEC.
 10575*    MOVE ',$D                   "   #00009368' TO DFHEIV0
 10576     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10577     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10578     MOVE X'2020233030303039333638' TO DFHEIV0(25:11)
 10579     CALL 'kxdfhei1' USING DFHEIV0,
 10580           COMMISSION-WORK-AREA
 10581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10582
 10583
 10584     MOVE SPACES                 TO PI-SV-MAINT.
 10585     MOVE XCTL-650               TO PGM-NAME.
 10586     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10587     GO TO 9300-XCTL.
 10588
 10589 9500-PF12.
 10590     MOVE XCTL-010               TO PGM-NAME.
 10591     GO TO 9300-XCTL.
 10592
 10593 9600-PGMID-ERROR.
 10594
 10595* EXEC CICS HANDLE CONDITION
 10596*        PGMIDERR    (8300-SEND-TEXT)
 10597*    END-EXEC.
 10598*    MOVE '"$L                   ! 5 #00009382' TO DFHEIV0
 10599     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10601     MOVE X'3520233030303039333832' TO DFHEIV0(25:11)
 10602     CALL 'kxdfhei1' USING DFHEIV0
 10603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10604
 10605
 10606     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10607     MOVE ' '                    TO PI-ENTRY-CD-1.
 10608     MOVE XCTL-005               TO PGM-NAME.
 10609     MOVE PGM-NAME               TO LOGOFF-PGM.
 10610     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10611     GO TO 9300-XCTL.
 10612
 10613 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL6501.cbl
 10614     MOVE LINK-ELDATCV           TO PGM-NAME.
 10615
 10616* EXEC CICS LINK
 10617*        PROGRAM    (PGM-NAME)
 10618*        COMMAREA   (DATE-CONVERSION-DATA)
 10619*        LENGTH     (DC-COMM-LENGTH)
 10620*    END-EXEC.
 10621*    MOVE '."C                   ''   #00009395' TO DFHEIV0
 10622     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10623     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10624     MOVE X'2020233030303039333935' TO DFHEIV0(25:11)
 10625     CALL 'kxdfhei1' USING DFHEIV0,
 10626           PGM-NAME,
 10627           DATE-CONVERSION-DATA,
 10628           DC-COMM-LENGTH,
 10629           DFHEIV99,
 10630           DFHEIV99,
 10631           DFHEIV99
 10632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10633
 10634
 10635 9900-ERROR-FORMAT.
 10636     IF NOT EMI-ERRORS-COMPLETE
 10637         MOVE LINK-001           TO PGM-NAME
 10638
 10639* EXEC CICS LINK
 10640*            PROGRAM    (PGM-NAME)
 10641*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10642*            LENGTH     (EMI-COMM-LENGTH)
 10643*        END-EXEC.
 10644*    MOVE '."C                   ''   #00009404' TO DFHEIV0
 10645     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10646     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10647     MOVE X'2020233030303039343034' TO DFHEIV0(25:11)
 10648     CALL 'kxdfhei1' USING DFHEIV0,
 10649           PGM-NAME,
 10650           ERROR-MESSAGE-INTERFACE-BLOCK,
 10651           EMI-COMM-LENGTH,
 10652           DFHEIV99,
 10653           DFHEIV99,
 10654           DFHEIV99
 10655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10656
 10657
 10658 9900-EXIT.
 10659     EXIT.
 10660
 10661 9990-ABEND.
 10662     MOVE LINK-004               TO PGM-NAME.
 10663     MOVE DFHEIBLK               TO EMI-LINE1.
 10664
 10665* EXEC CICS LINK
 10666*        PROGRAM   (PGM-NAME)
 10667*        COMMAREA  (EMI-LINE1)
 10668*        LENGTH    (72)
 10669*    END-EXEC.
 10670     MOVE 72
 10671       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL6501.cbl
 10672*    MOVE '."C                   ''   #00009416' TO DFHEIV0
 10673     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10674     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10675     MOVE X'2020233030303039343136' TO DFHEIV0(25:11)
 10676     CALL 'kxdfhei1' USING DFHEIV0,
 10677           PGM-NAME,
 10678           EMI-LINE1,
 10679           DFHEIV11,
 10680           DFHEIV99,
 10681           DFHEIV99,
 10682           DFHEIV99
 10683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10684
 10685
 10686     MOVE -1                     TO PFENTERL.
 10687     GO TO 8200-SEND-DATAONLY.
 10688
 10689
 10690* GOBACK.
 10691     MOVE '9%                    "   ' TO DFHEIV0
 10692     MOVE 'EL6501' TO DFHEIV1
 10693     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10694     GOBACK.
 10695
 10696 9995-SECURITY-VIOLATION.
 10697*                            COPY ELCSCTP.
 10698******************************************************************
 10699*                                                                *
 10700*                            ELCSCTP                             *
 10701*                            VMOD=2.001                          *
 10702*                                                                *
 10703*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10704******************************************************************
 10705
 10706
 10707     MOVE EIBDATE          TO SM-JUL-DATE.
 10708     MOVE EIBTRMID         TO SM-TERMID.
 10709     MOVE THIS-PGM         TO SM-PGM.
 10710     MOVE EIBTIME          TO TIME-IN.
 10711     MOVE TIME-OUT         TO SM-TIME.
 10712     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10713
 10714
 10715* EXEC CICS LINK
 10716*         PROGRAM  ('EL003')
 10717*         COMMAREA (SECURITY-MESSAGE)
 10718*         LENGTH   (80)
 10719*    END-EXEC.
 10720     MOVE 'EL003' TO DFHEIV1
 10721     MOVE 80
 10722       TO DFHEIV11
 10723*    MOVE '."C                   ''   #00009445' TO DFHEIV0
 10724     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10726     MOVE X'2020233030303039343435' TO DFHEIV0(25:11)
 10727     CALL 'kxdfhei1' USING DFHEIV0,
 10728           DFHEIV1,
 10729           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL6501.cbl
 10730           DFHEIV11,
 10731           DFHEIV99,
 10732           DFHEIV99,
 10733           DFHEIV99
 10734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10735
 10736
 10737******************************************************************
 10738
 10739
 10740 9995-EXIT.
 10741     EXIT.
 10742
 10743 9999-DFHBACK SECTION.
 10744     MOVE '9%                    "   ' TO DFHEIV0
 10745     MOVE 'EL6501' TO DFHEIV1
 10746     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10747     GOBACK.
 10748 9999-DFHEXIT.
 10749     IF DFHEIGDJ EQUAL 0001
 10750         NEXT SENTENCE
 10751     ELSE IF DFHEIGDJ EQUAL 2
 10752         GO TO 9600-PGMID-ERROR,
 10753               9990-ABEND,
 10754               0500-CHECK-MAINT-TYPE
 10755         DEPENDING ON DFHEIGDI
 10756     ELSE IF DFHEIGDJ EQUAL 3
 10757         GO TO 1500-EXIT
 10758         DEPENDING ON DFHEIGDI
 10759     ELSE IF DFHEIGDJ EQUAL 4
 10760         GO TO 1799-EXIT,
 10761               1799-EXIT
 10762         DEPENDING ON DFHEIGDI
 10763     ELSE IF DFHEIGDJ EQUAL 5
 10764         GO TO 2100-EXIT
 10765         DEPENDING ON DFHEIGDI
 10766     ELSE IF DFHEIGDJ EQUAL 6
 10767         GO TO 2200-EXIT
 10768         DEPENDING ON DFHEIGDI
 10769     ELSE IF DFHEIGDJ EQUAL 7
 10770         GO TO 3030-END-FILE
 10771         DEPENDING ON DFHEIGDI
 10772     ELSE IF DFHEIGDJ EQUAL 8
 10773         GO TO 3530-END-FILE
 10774         DEPENDING ON DFHEIGDI
 10775     ELSE IF DFHEIGDJ EQUAL 9
 10776         GO TO 4020-BUS-TYPE-ERROR
 10777         DEPENDING ON DFHEIGDI
 10778     ELSE IF DFHEIGDJ EQUAL 10
 10779         GO TO 4099-STD-BEN-ERROR
 10780         DEPENDING ON DFHEIGDI
 10781     ELSE IF DFHEIGDJ EQUAL 11
 10782         GO TO 4180-REIN-ERROR
 10783         DEPENDING ON DFHEIGDI
 10784     ELSE IF DFHEIGDJ EQUAL 12
 10785         GO TO 5250-QID-ERROR
 10786         DEPENDING ON DFHEIGDI
 10787     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL6501.cbl
 10788         GO TO 5399-EXIT,
 10789               5399-EXIT
 10790         DEPENDING ON DFHEIGDI
 10791     ELSE IF DFHEIGDJ EQUAL 14
 10792         GO TO 6450-NOT-FOUND
 10793         DEPENDING ON DFHEIGDI
 10794     ELSE IF DFHEIGDJ EQUAL 15
 10795         GO TO 6699-EXIT
 10796         DEPENDING ON DFHEIGDI
 10797     ELSE IF DFHEIGDJ EQUAL 16
 10798         GO TO 6880-NO-COMP
 10799         DEPENDING ON DFHEIGDI
 10800     ELSE IF DFHEIGDJ EQUAL 17
 10801         GO TO 6925-NOT-FIND,
 10802               6925-NOT-FIND
 10803         DEPENDING ON DFHEIGDI
 10804     ELSE IF DFHEIGDJ EQUAL 18
 10805         GO TO 7999-EXIT,
 10806               7999-EXIT
 10807         DEPENDING ON DFHEIGDI
 10808     ELSE IF DFHEIGDJ EQUAL 19
 10809         GO TO 8010-EXIT
 10810         DEPENDING ON DFHEIGDI
 10811     ELSE IF DFHEIGDJ EQUAL 20
 10812         GO TO 8055-NOTFND
 10813         DEPENDING ON DFHEIGDI
 10814     ELSE IF DFHEIGDJ EQUAL 21
 10815         GO TO 8300-SEND-TEXT
 10816         DEPENDING ON DFHEIGDI.
 10817     MOVE '9%                    "   ' TO DFHEIV0
 10818     MOVE 'EL6501' TO DFHEIV1
 10819     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10820     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39272     Code:       34569
