* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   117* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   118* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   119*-----------------------------------------------------------------
   120
   121 01  WORK-AREAS.
   122
   123*****************************************************************
   124*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   125*****************************************************************
   126
   127     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   128     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   129     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   130     12  WS-NAME-EDIT-WORK-AREA.
   131         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   132         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   133             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   134         16  WS-WORK-NAME.
   135             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   136             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   137             20  FILLER           PIC X(10)     VALUE SPACES.
   138         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   139             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   140
   141*****************************************************************
   142*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   143*****************************************************************
   144
   145     12  WS-ERRESC-KEY.
   146         16 WS-ERRESC-SEARCH-KEY.
   147             20  WS-ERRESC-COMPANY-CD PIC  X.
   148             20  WS-ERRESC-CARRIER    PIC  X.
   149             20  WS-ERRESC-GROUP      PIC X(6).
   150             20  WS-ERRESC-STATE      PIC XX.
   151             20  WS-ERRESC-ACCOUNT    PIC X(10).
   152         16 WS-ERRESC-RESIDUAL-KEY.
   153             20  WS-ERRESC-AGENT      PIC X(10).
   154             20  WS-ERRESC-RES-STATE  PIC XX.
   155             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   156*                                          YYYYMMDD
   157     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   158     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   159
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   5
* EL050.cbl
   160*RESIDENT STATE TAX MASTER(ERRESS)
   161*
   162     12  WS-ERRESS-KEY.
   163         16  WS-ERRESS-COMPANY-CD      PIC  X.
   164         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   165         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   166         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   167*                                          YYYYMMDD
   168
   169     12  WS-CONTRACT-DATE              PIC 9(8).
   170*                                          YYYYMMDD
   171     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   172     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   173         16 WS-YEAR-YY                 PIC   9999.
   174         16 FILLER                     PIC 9(4).
   175*                                          YYYYMMDD
   176     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   177     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   178     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   179     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   180
   181     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   182         88  DPRB-1ST-TIME                      VALUE ' '.
   183
   184*****************************************************************
   185*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   186*****************************************************************
   187
   188     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   189     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   190     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   191     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   192     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   193     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   194     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   195     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   196     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   197     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   198         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   199         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   200     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   201         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   202         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   203     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   204
   205     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   206     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   207
   208     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   209     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   212     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   213     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   214     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   6
* EL050.cbl
   218     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   221     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   222     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   223     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   244     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   245     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   246     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   247     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   256     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   257     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   258     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   259     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   260     12  WS-2671-SW               PIC X         VALUE SPACE.
   261     12  WS-2672-SW               PIC X         VALUE SPACE.
   262     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   263         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   264     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   265         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   266     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   267
   268     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   269         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   270         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   271         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   272         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   273
   274     12  WS-CREDIT-EDIT-CONTROLS.
   275         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   7
* EL050.cbl
   276         16  WS-MIN-AGE           PIC 99                VALUE  0.
   277         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   278         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   279         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   280         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   281
   282     12  WS-SAVE-ALLOWABLE-BENEFIT.
   283         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   284         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   285         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   286         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   287         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   288         16  FILLER                      PIC XX.
   289
   290     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   291     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   292     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   293     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   294     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   295     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   296     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   297     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   298     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   299     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   300
   301     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   302     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   303     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   304     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   305     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   306     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   307     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   308     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   309         88  WS-REDUCING              VALUE 'R'.
   310         88  WS-LEVEL                 VALUE 'L' 'P'.
   311     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   312
   313     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   314     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   315     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   316     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   317     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   318     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   319     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   320     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   321     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   322
   323     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   324     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   325     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   326     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   327     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   328     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   329     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   330     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   332     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   333     12  WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   8
* EL050.cbl
   334         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   335         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   336     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   337     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   338     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   341     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   342     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   343     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-INITIALS.
   345         16  WS-INIT-1            PIC X         VALUE SPACES.
   346         16  WS-INIT-2            PIC X         VALUE SPACES.
   347
   348     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   349     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   350     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   351     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   352     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   353*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   354     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   357     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   358     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   359     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   361     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   362     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   363     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   364     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   365     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   366     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   367     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   369     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   373     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   374     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376******** FLA
   377     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   380     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   381     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   382********
   383     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   384     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   385     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   386     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   387     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   388     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   389     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   390     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   391     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page   9
* EL050.cbl
   392     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   393
   394     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   395         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   396                                         '0' THRU '9'.
   397
   398     12  NUMBER-OF-MONTHS.
   399         16  SK-MO OCCURS 12 TIMES PIC X.
   400
   401     12  WS-WORK-DATE.
   402         16  WS-YEAR            PIC 99    VALUE 00.
   403         16  WS-MONTH           PIC 99    VALUE 00.
   404         16  WS-DAY             PIC 99    VALUE 00.
   405
   406     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   407     12  WS-WORK-CRIT-DEV       REDEFINES
   408         WS-WORK-LF-CRIT-PER    PIC X(03).
   409
   410     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   411     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   412
   413     12  WS-WORK-DATE-FROM.
   414         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   415         16  FILLER             PIC X  VALUE SPACE.
   416         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   417         16  FILLER             PIC X         VALUE SPACE.
   418         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   419
   420     12  WS-WORK-DATE-THRU.
   421         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   424         16  FILLER             PIC X         VALUE SPACE.
   425         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   426
   427     12  WS-LF-INPUT-CD.
   428         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   429         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   430
   431     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   432     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   433         16  WS-AH-INPUT-CD-1   PIC X.
   434         16  WS-AH-INPUT-CD-2-3 PIC XX.
   435
   436     12  WS-SWITCHES.
   437         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   438         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   439             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   440         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   441             88  BANK-ACCT-FOUND          VALUE 'Y'.
   442         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   443             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   444         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   445             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   446         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   447             88  COMP-MASTER-FOUND        VALUE 'Y'.
   448         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   449             88  LOFC-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  10
* EL050.cbl
   450         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   451             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   452         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   453             88  STAT-MASTER-FOUND        VALUE 'Y'.
   454         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   455             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   456         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   457             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   458         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   459             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   460         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   461             88  FORM-MASTER-FOUND        VALUE 'Y'.
   462         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   463             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   464         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   465             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   466         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   467             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   468         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   469             88  NO-BENEFIT-FOUND         VALUE 'N'.
   470         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   471             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   472         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   473             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   474         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   475             88  AH-BENEFIT-FOUND         VALUE ' '.
   476             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   477         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   478             88  LF-BENEFIT-FOUND         VALUE ' '.
   479             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   480         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   481             88  NO-STATE-RECORD          VALUE '1'.
   482         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   483             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   484         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   485             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   486         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   487             88  CERT-WAS-FOUND           VALUE ' '.
   488             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   489         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   490             88  BROWSE-STARTED           VALUE 'Y'.
   491         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   492             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   493         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   494             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   495         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   496             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   497         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   498             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   499         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   500             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   501         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   502             88  APP-CERT-USED            VALUE 'Y' 'A'.
   503         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   504             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   505             88  FIRST-TIME-THROUGH       VALUE '1'.
   506             88  CTBL-NOT-FOUND           VALUE '2'.
   507
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  11
* EL050.cbl
   508         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   509             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   510
   511         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   512             88  DLO-ERROR-FOUND          VALUE 'Y'.
   513
   514********FLA
   515     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   516     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   517********
   518     12  RC-SW-1                  PIC X           VALUE '0'.
   519     12  RC-SW-2                  PIC X           VALUE '0'.
   520     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   521     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   522     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   526     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   527     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   530     12  LIT-SPACES               PIC X           VALUE SPACES.
   531     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   532     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   533     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   534     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   535     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   536     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   537     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   538         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   539         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   540     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   541         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   542
   543 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   544     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   545     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   546 01  WS-CRI-SSN-WORK-AREA.
   547     05  WS-CRI-SOC-SEC-NO.
   548         10  WS-SS-REPT-CD       PIC X(5).
   549         10  WS-SS-LAST-NAME     PIC X(5).
   550         10  WS-SS-INITIAL       PIC X.
   551
   552     05  WS-CRI-REPORT-CODE.
   553         10  FILLER              PIC X(5).
   554         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   555
   556     05  WS-CRI-LAST-NAME.
   557         10  WS-CRI-NAME-MOVE    PIC X(5).
   558         10  FILLER              PIC X(10).
   559
   560 01  WS-NUM-TABLE                PIC X(26)  VALUE
   561     '12345678012345070923456789'.
   562 01  FILLER REDEFINES WS-NUM-TABLE.
   563     05  WS-NUM OCCURS 26        PIC 9.
   564 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   565 01  V1                          PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  12
* EL050.cbl
   566 01  V2                          PIC S999 COMP-3.
   567 01  V3                          PIC S999 COMP-3.
   568 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   569 01  FILLER REDEFINES WS-WORK-VIN.
   570     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   571 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   572 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   573 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   574 01  WS-HEX-WORK.
   575     05  FILLER                  PIC X  VALUE LOW-VALUES.
   576     05  WS-HEX-BYTE             PIC X.
   577 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   578 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   579 01  WS-WORK-HIN-ROW-B.
   580     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   581
   582 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   583 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   584     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   585 01  WS-ROW-D-TABLE.
   586     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   587
   588 01  WS-HIN-TABLE-B.
   589     05  F                       PIC XX VALUE 'A2'.
   590     05  F                       PIC XX VALUE 'B3'.
   591     05  F                       PIC XX VALUE 'C4'.
   592     05  F                       PIC XX VALUE 'D5'.
   593     05  F                       PIC XX VALUE 'E6'.
   594     05  F                       PIC XX VALUE 'F7'.
   595     05  F                       PIC XX VALUE 'G8'.
   596     05  F                       PIC XX VALUE 'H9'.
   597     05  F                       PIC XX VALUE 'I1'.
   598     05  F                       PIC XX VALUE 'J2'.
   599     05  F                       PIC XX VALUE 'K3'.
   600     05  F                       PIC XX VALUE 'L4'.
   601     05  F                       PIC XX VALUE 'M5'.
   602     05  F                       PIC XX VALUE 'N6'.
   603     05  F                       PIC XX VALUE 'O0'.
   604     05  F                       PIC XX VALUE 'P7'.
   605     05  F                       PIC XX VALUE 'Q0'.
   606     05  F                       PIC XX VALUE 'R8'.
   607     05  F                       PIC XX VALUE 'S9'.
   608     05  F                       PIC XX VALUE 'T2'.
   609     05  F                       PIC XX VALUE 'U3'.
   610     05  F                       PIC XX VALUE 'V4'.
   611     05  F                       PIC XX VALUE 'W5'.
   612     05  F                       PIC XX VALUE 'X6'.
   613     05  F                       PIC XX VALUE 'Y7'.
   614     05  F                       PIC XX VALUE 'Z8'.
   615 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   616     05  WS-VAL-IN               PIC X.
   617     05  WS-VAL-OUT              PIC 9.
   618 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   619 01  WS-COMPARE-BINARY-DATES.
   620     05  WS-971231                PIC XX VALUE X'92FF'.
   621     05  WS-931231                PIC XX VALUE X'8CFF'.
   622     05  WS-791231                PIC XX VALUE X'77FF'.
   623     05  WS-771001                PIC XX VALUE X'74A1'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  13
* EL050.cbl
   624     05  WS-820301                PIC XX VALUE X'7B41'.
   625     05  WS-831031                PIC XX VALUE X'7DBF'.
   626     05  WS-831231                PIC XX VALUE X'7DFF'.
   627     05  WS-810831                PIC XX VALUE X'7A7F'.
   628     05  WS-830901                PIC XX VALUE X'7D81'.
   629
   630 01  FILE-ACCESS-IDS.
   631     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   632     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   633     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   634     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   635     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   636     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   637     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   638     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   639     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   640     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   641     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   642     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   643     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   644     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   645     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   646     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   647     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   648 01  DD-IU-SW                    PIC X   VALUE ' '.
   649     88  DD-IU-PRESENT                 VALUE 'Y'.
   650
   651 01  ACCESS-KEYS.
   652     12  ELMSTR-KEY.
   653         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   654         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   655     12  W-CLAIM-KEY.
   656         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   657         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   658
   659     12  ELCNTL-KEY.
   660         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   661         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   662         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   663         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   664
   665     12  ELCERT-KEY.
   666         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   667         16  CERT-CARRIER         PIC X       VALUE SPACE.
   668         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   669         16  CERT-STATE           PIC XX      VALUE SPACES.
   670         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   671         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   672         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   673
   674     12  ELCERT2-KEY.
   675         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   676         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   677
   678     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   679
   680     12  ELCERT-SAVE.
   681         16  FILLER                      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  14
* EL050.cbl
   682
   683         16  WCS-CONTROL-PRIMARY.
   684             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   685             20  WCS-CARRIER             PIC X     VALUE SPACE.
   686             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   687             20  WCS-STATE               PIC XX    VALUE SPACES.
   688             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   689             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   690             20  WCS-CERT-NO.
   691                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   692                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   693
   694         16  CS-CONTROL-BY-NAME.
   695             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   696             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   697             20  CS-INSURED-INITIALS.
   698                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   699                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   700
   701         16  CS-CONTROL-BY-SSN.
   702             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   703             20  CS-SOC-SEC-NO.
   704                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   705                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   706                 24  CS-SSN-LN3.
   707                     28 CS-INSURED-INITIALS-A2   PIC XX
   708                                     VALUE SPACES.
   709                     28 CS-PART-LAST-NAME-A2     PIC X
   710                                     VALUE SPACE.
   711
   712         16  CS-CONTROL-BY-CERT-NO.
   713             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   714             20  CS-CERT-NO-A4           PIC X(11)
   715                                     VALUE SPACES.
   716
   717         16  CS-CONTROL-BY-MEMB.
   718             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   719             20  CS-MEMBER-NO.
   720                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   721                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   722                 24  CS-MEMB-LN4.
   723                     28 CS-INSURED-INITIALS-A5   PIC XX
   724                                      VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A5     PIC XX
   726                                      VALUE SPACES.
   727
   728         16  FILLER              PIC X(360) VALUE SPACES.
   729
   730     12  ERACCT-KEY.
   731         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   732         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   733         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   734         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   735         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   736         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   737
   738     12  ERCOMP-KEY.
   739         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  15
* EL050.cbl
   740         16  COMP-CARRIER         PIC X     VALUE SPACES.
   741         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   742         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   743         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   744         16  COMP-TYPE            PIC X     VALUE SPACES.
   745
   746     12  ERLOFC-KEY.
   747         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   749         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   750         16  LOFC-STATE           PIC XX    VALUE SPACES.
   751         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   753
   754     12  WS-ELCRTT-KEY.
   755         16  WS-ELCRTT-PRIMARY       PIC X(33).
   756         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   757
   758     12  ERBXRF-KEY.
   759         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   760         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   761         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   762         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   763
   764     12  ERAGTC-KEY.
   765         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   766         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   767         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   768         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   769         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   770         16  AGTC-TYPE            PIC X     VALUE SPACES.
   771
   772     12  ERPLAN-KEY.
   773         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   774         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   775         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   776         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   777         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   779         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   780         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   781
   782     12  ERFORM-KEY.
   783         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   784         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   785         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   786         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   787
   788     12  ERREIN-KEY.
   789         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  REIN-TYPE            PIC X     VALUE SPACES.
   791         16  REIN-TABLE-CO.
   792             20  REIN-CODE-1      PIC X     VALUE SPACE.
   793             20  REIN-CODE-2      PIC X     VALUE SPACE.
   794             20  REIN-CODE-3      PIC X     VALUE SPACE.
   795         16  FILLER               PIC X(3)  VALUE SPACES.
   796
   797     12  ERCTBL-KEY.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  16
* EL050.cbl
   798         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   800         16  CTBL-CNTRL-2.
   801             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   802             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   803
   804     12  WS-ACCESS.
   805         16  FILLER               PIC XX    VALUE SPACES.
   806         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   807
   808     12  WS-CARR-ACCESS.
   809         16  FILLER               PIC X(3)  VALUE SPACES.
   810         16  WS-CARR              PIC X     VALUE SPACE.
   811*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   812*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   813     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   814         88  WS-DMD-LF-RATING   VALUE 'Y'.
   815         88  WS-DMD-AH-RATING   VALUE 'Y'.
   816         88  WS-DMD-NO-RATING   VALUE 'N'.
   817
   818     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   819         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   820                                         'NJ' 'NL'
   821                                         'PJ' 'PL'
   822                                         'SJ' 'SL'.
   823     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   824         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   825                                         'NI' 'NJ' 'NL' 'NU'
   826                                         'PJ' 'PL' 'PI' 'PU'
   827                                         'SI' 'SJ' 'SL' 'SU'
   828                                         'MX' 'MY' 'MZ'.
   829 01  ERPDEF-KEY-SAVE             PIC X(18).
   830 01  ERPDEF-KEY.
   831     12  ERPDEF-COMPANY-CD       PIC X.
   832     12  ERPDEF-STATE            PIC XX.
   833     12  ERPDEF-PROD-CD          PIC XXX.
   834     12  F                       PIC X(7).
   835     12  ERPDEF-BEN-TYPE         PIC X.
   836     12  ERPDEF-BEN-CODE         PIC XX.
   837     12  ERPDEF-EXP-DT           PIC XX.
   838
   839 01  ELSTAT-KEY-SAVE             PIC X(20).
   840 01  ELSTAT-KEY.
   841     12  ELSTAT-COMPANY-ID       PIC XXX.
   842     12  ELSTAT-CARRIER          PIC X.
   843     12  ELSTAT-GROUP            PIC X(6).
   844     12  ELSTAT-STATE            PIC XX.
   845     12  ELSTAT-EXP-DT           PIC 9(8).
   846 01  WS-ERROR-VALUES.
   847     12  ER-1570                     PIC S9(4)   VALUE +1570.
   848     12  ER-1571                     PIC S9(4)   VALUE +1571.
   849     12  ER-1575                     PIC S9(4)   VALUE +1575.
   850     12  ER-1891                     PIC S9(4)   VALUE +1891.
   851     12  ER-1892                     PIC S9(4)   VALUE +1892.
   852     12  ER-1893                     PIC S9(4)   VALUE +1893.
   853     12  ER-1894                     PIC S9(4)   VALUE +1894.
   854     12  ER-1895                     PIC S9(4)   VALUE +1895.
   855     12  ER-1896                     PIC S9(4)   VALUE +1896.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  17
* EL050.cbl
   856     12  ER-1897                     PIC S9(4)   VALUE +1897.
   857     12  ER-1898                     PIC S9(4)   VALUE +1898.
   858     12  ER-1899                     PIC S9(4)   VALUE +1899.
   859     12  ER-1900                     PIC S9(4)   VALUE +1900.
   860     12  ER-1901                     PIC S9(4)   VALUE +1901.
   861     12  ER-1902                     PIC S9(4)   VALUE +1902.
   862     12  ER-1903                     PIC S9(4)   VALUE +1903.
   863     12  ER-1904                     PIC S9(4)   VALUE +1904.
   864     12  ER-1905                     PIC S9(4)   VALUE +1905.
   865     12  ER-1906                     PIC S9(4)   VALUE +1906.
   866     12  ER-1907                     PIC S9(4)   VALUE +1907.
   867     12  ER-1909                     PIC S9(4)   VALUE +1909.
   868     12  ER-1910                     PIC S9(4)   VALUE +1910.
   869     12  ER-1911                     PIC S9(4)   VALUE +1911.
   870     12  ER-1912                     PIC S9(4)   VALUE +1912.
   871     12  ER-1913                     PIC S9(4)   VALUE +1913.
   872     12  ER-1914                     PIC S9(4)   VALUE +1914.
   873     12  ER-1915                     PIC S9(4)   VALUE +1915.
   874     12  ER-1916                     PIC S9(4)   VALUE +1916.
   875     12  ER-1917                     PIC S9(4)   VALUE +1917.
   876     12  ER-1918                     PIC S9(4)   VALUE +1918.
   877     12  ER-1919                     PIC S9(4)   VALUE +1919.
   878     12  ER-1920                     PIC S9(4)   VALUE +1920.
   879     12  ER-1921                     PIC S9(4)   VALUE +1921.
   880     12  ER-1922                     PIC S9(4)   VALUE +1922.
   881     12  ER-1923                     PIC S9(4)   VALUE +1923.
   882     12  ER-1924                     PIC S9(4)   VALUE +1924.
   883     12  ER-1925                     PIC S9(4)   VALUE +1925.
   884     12  ER-1926                     PIC S9(4)   VALUE +1926.
   885     12  ER-1927                     PIC S9(4)   VALUE +1927.
   886     12  ER-2393                     PIC S9(4)   VALUE +2393.
   887     12  ER-2600                     PIC S9(4)   VALUE +2600.
   888     12  ER-2601                     PIC S9(4)   VALUE +2601.
   889     12  ER-2602                     PIC S9(4)   VALUE +2602.
   890     12  ER-2603                     PIC S9(4)   VALUE +2603.
   891     12  ER-2604                     PIC S9(4)   VALUE +2604.
   892     12  ER-2605                     PIC S9(4)   VALUE +2605.
   893     12  ER-2606                     PIC S9(4)   VALUE +2606.
   894     12  ER-2607                     PIC S9(4)   VALUE +2607.
   895     12  ER-2608                     PIC S9(4)   VALUE +2608.
   896     12  ER-2609                     PIC S9(4)   VALUE +2609.
   897     12  ER-2610                     PIC S9(4)   VALUE +2610.
   898     12  ER-2611                     PIC S9(4)   VALUE +2611.
   899     12  ER-2612                     PIC S9(4)   VALUE +2612.
   900     12  ER-2613                     PIC S9(4)   VALUE +2613.
   901     12  ER-2614                     PIC S9(4)   VALUE +2614.
   902     12  ER-2615                     PIC S9(4)   VALUE +2615.
   903     12  ER-2616                     PIC S9(4)   VALUE +2616.
   904     12  ER-2617                     PIC S9(4)   VALUE +2617.
   905     12  ER-2618                     PIC S9(4)   VALUE +2618.
   906     12  ER-2619                     PIC S9(4)   VALUE +2619.
   907     12  ER-2620                     PIC S9(4)   VALUE +2620.
   908     12  ER-2621                     PIC S9(4)   VALUE +2621.
   909     12  ER-2622                     PIC S9(4)   VALUE +2622.
   910     12  ER-2623                     PIC S9(4)   VALUE +2623.
   911     12  ER-2624                     PIC S9(4)   VALUE +2624.
   912     12  ER-2625                     PIC S9(4)   VALUE +2625.
   913     12  ER-2626                     PIC S9(4)   VALUE +2626.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  18
* EL050.cbl
   914     12  ER-2627                     PIC S9(4)   VALUE +2627.
   915     12  ER-2628                     PIC S9(4)   VALUE +2628.
   916     12  ER-2629                     PIC S9(4)   VALUE +2629.
   917     12  ER-2630                     PIC S9(4)   VALUE +2630.
   918     12  ER-2631                     PIC S9(4)   VALUE +2631.
   919     12  ER-2632                     PIC S9(4)   VALUE +2632.
   920     12  ER-2633                     PIC S9(4)   VALUE +2633.
   921     12  ER-2634                     PIC S9(4)   VALUE +2634.
   922     12  ER-2635                     PIC S9(4)   VALUE +2635.
   923     12  ER-2636                     PIC S9(4)   VALUE +2636.
   924     12  ER-2637                     PIC S9(4)   VALUE +2637.
   925     12  ER-2638                     PIC S9(4)   VALUE +2638.
   926     12  ER-2639                     PIC S9(4)   VALUE +2639.
   927     12  ER-2640                     PIC S9(4)   VALUE +2640.
   928     12  ER-2641                     PIC S9(4)   VALUE +2641.
   929     12  ER-2642                     PIC S9(4)   VALUE +2642.
   930     12  ER-2643                     PIC S9(4)   VALUE +2643.
   931     12  ER-2644                     PIC S9(4)   VALUE +2644.
   932     12  ER-2645                     PIC S9(4)   VALUE +2645.
   933     12  ER-2646                     PIC S9(4)   VALUE +2646.
   934     12  ER-2647                     PIC S9(4)   VALUE +2647.
   935     12  ER-2648                     PIC S9(4)   VALUE +2648.
   936     12  ER-2649                     PIC S9(4)   VALUE +2649.
   937     12  ER-2650                     PIC S9(4)   VALUE +2650.
   938     12  ER-2651                     PIC S9(4)   VALUE +2651.
   939     12  ER-2652                     PIC S9(4)   VALUE +2652.
   940     12  ER-2653                     PIC S9(4)   VALUE +2653.
   941     12  ER-2654                     PIC S9(4)   VALUE +2654.
   942     12  ER-2655                     PIC S9(4)   VALUE +2655.
   943     12  ER-2656                     PIC S9(4)   VALUE +2656.
   944     12  ER-2657                     PIC S9(4)   VALUE +2657.
   945     12  ER-2658                     PIC S9(4)   VALUE +2658.
   946     12  ER-2659                     PIC S9(4)   VALUE +2659.
   947     12  ER-2660                     PIC S9(4)   VALUE +2660.
   948     12  ER-2661                     PIC S9(4)   VALUE +2661.
   949     12  ER-2662                     PIC S9(4)   VALUE +2662.
   950     12  ER-2663                     PIC S9(4)   VALUE +2663.
   951     12  ER-2664                     PIC S9(4)   VALUE +2664.
   952     12  ER-2665                     PIC S9(4)   VALUE +2665.
   953     12  ER-2666                     PIC S9(4)   VALUE +2666.
   954     12  ER-2667                     PIC S9(4)   VALUE +2667.
   955     12  ER-2668                     PIC S9(4)   VALUE +2668.
   956     12  ER-2669                     PIC S9(4)   VALUE +2669.
   957     12  ER-2670                     PIC S9(4)   VALUE +2670.
   958     12  ER-2671                     PIC S9(4)   VALUE +2671.
   959     12  ER-2672                     PIC S9(4)   VALUE +2672.
   960     12  ER-2673                     PIC S9(4)   VALUE +2673.
   961     12  ER-2674                     PIC S9(4)   VALUE +2674.
   962     12  ER-2675                     PIC S9(4)   VALUE +2675.
   963     12  ER-2676                     PIC S9(4)   VALUE +2676.
   964     12  ER-2677                     PIC S9(4)   VALUE +2677.
   965     12  ER-2678                     PIC S9(4)   VALUE +2678.
   966     12  ER-2679                     PIC S9(4)   VALUE +2679.
   967     12  ER-2680                     PIC S9(4)   VALUE +2680.
   968     12  ER-2681                     PIC S9(4)   VALUE +2681.
   969     12  ER-2682                     PIC S9(4)   VALUE +2682.
   970     12  ER-2683                     PIC S9(4)   VALUE +2683.
   971     12  ER-2684                     PIC S9(4)   VALUE +2684.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  19
* EL050.cbl
   972     12  ER-2685                     PIC S9(4)   VALUE +2685.
   973     12  ER-2686                     PIC S9(4)   VALUE +2686.
   974     12  ER-2687                     PIC S9(4)   VALUE +2687.
   975     12  ER-2688                     PIC S9(4)   VALUE +2688.
   976     12  ER-2689                     PIC S9(4)   VALUE +2689.
   977     12  ER-2690                     PIC S9(4)   VALUE +2690.
   978     12  ER-2691                     PIC S9(4)   VALUE +2691.
   979     12  ER-2692                     PIC S9(4)   VALUE +2692.
   980     12  ER-2693                     PIC S9(4)   VALUE +2693.
   981     12  ER-2694                     PIC S9(4)   VALUE +2694.
   982     12  ER-2695                     PIC S9(4)   VALUE +2695.
   983     12  ER-2696                     PIC S9(4)   VALUE +2696.
   984     12  ER-2697                     PIC S9(4)   VALUE +2697.
   985     12  ER-2698                     PIC S9(4)   VALUE +2698.
   986     12  ER-2699                     PIC S9(4)   VALUE +2699.
   987     12  ER-2700                     PIC S9(4)   VALUE +2700.
   988     12  ER-2701                     PIC S9(4)   VALUE +2701.
   989     12  ER-2702                     PIC S9(4)   VALUE +2702.
   990     12  ER-2703                     PIC S9(4)   VALUE +2703.
   991     12  ER-2704                     PIC S9(4)   VALUE +2704.
   992     12  ER-2707                     PIC S9(4)   VALUE +2707.
   993     12  ER-2720                     PIC S9(4)   VALUE +2720.
   994     12  ER-2709                     PIC S9(4)   VALUE +2709.
   995     12  ER-2717                     PIC S9(4)   VALUE +2717.
   996     12  ER-2718                     PIC S9(4)   VALUE +2718.
   997     12  ER-2719                     PIC S9(4)   VALUE +2719.
   998     12  ER-2721                     PIC S9(4)   VALUE +2721.
   999     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1000     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1001     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1002     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1003     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1004     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1005     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1006     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1007     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1008     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1009     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1010     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1011     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1012     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1013     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1014     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1015     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1016     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1017     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1018     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1019     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1020     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1021     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1022     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1023     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1024     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1025     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1026     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1027     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1028     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1029     12  ER-2752                     PIC S9(4)   VALUE +2752.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  20
* EL050.cbl
  1030     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1031     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1032     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1033     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1034     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1035     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1036     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1037     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1038     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1039     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1040     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1041     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1042     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1043     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1044     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1045     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1046     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1047     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1048     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1049     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1050     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1051     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1052     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1053     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1054     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1055     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1056     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1057     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1058     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1059     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1060     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1061     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1062     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1063     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1064     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1065     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1066     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1067     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1068     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1069     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1070     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1071     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1072     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1073     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1074     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1075     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1076     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1077     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1078     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1079     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1080     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1081     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1082     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1083     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1084     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1085     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1086     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1087     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  21
* EL050.cbl
  1088     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1089     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1090     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1091     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1092     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1093     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1094     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1095     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1096     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1097     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1098     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1099     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1100     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1101     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1102     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1103     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1104     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1105     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1106     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1107     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1108     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1109     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1110     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1111     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1112     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1113     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1114     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1115     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1116     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1117     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1118     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1119     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1120     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1121     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1122     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1123     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1124     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1125     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1126     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1127     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1128     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1129     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1130     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1131     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1132     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1133     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1134     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1135     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1136     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1137     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1138     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1139     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1140     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1141     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1142     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1143     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1144     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1145     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  22
* EL050.cbl
  1146     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1147     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1148     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1149     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1150     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1151     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1152     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1153     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1154     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1155     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1156     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1157     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1158     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1159     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1160     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1161     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1162     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1163     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1164     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1165     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1166     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1167     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1168     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1169     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1170     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1171     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1172     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1173     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1174     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1175     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1176     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1177     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1178     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1179     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1180     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1181     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1182     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1183     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1184     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1185     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1186     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1187******************************************************************
  1188***************   END OF ELC50WS     ****************************
  1189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  23
* EL050.cbl
  1192 01  WORKING-STORAGE-WORK-AREAS.
  1193     12  WS-RESPONSE             PIC S9(8)  COMP.
  1194         88  WS-RESP-NORMAL           VALUE +00.
  1195         88  WS-RESP-ERROR            VALUE +01.
  1196         88  WS-RESP-NOTFND           VALUE +13.
  1197         88  WS-RESP-DUPREC           VALUE +14.
  1198         88  WS-RESP-ENDFILE          VALUE +20.
  1199     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1200     12  WORK-AREAS.
  1201         16  WK-CONV-GREG.
  1202             24  WCG-CENT             PIC XX.
  1203             24  WCG-REST             PIC X(4).
  1204         16  WORK-GREGORIAN-DATE.
  1205             24  WK-GREG-CENT         PIC XX.
  1206             24  WK-GREG-DATE-YYMMDD.
  1207                 28  WK-GREG-YYMM     PIC X(4).
  1208                 28  WK-GREG-DD       PIC XX.
  1209
  1210         16  WORK-SELECT-DATE.
  1211             24  WK-SELECT-CENT            PIC XX.
  1212             24  WK-SELECT-DATE-YYMMDD.
  1213                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1214                 28  FILLER                PIC XX.
  1215
  1216         16  WK-FORM-NO.
  1217             24  WK-FORM-BANK-ID       PIC X(5).
  1218             24  WK-FORM-UNDRWRTR      PIC X(1).
  1219             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1220
  1221         16  WK-MEMBER-NO.
  1222             24  WK-MEMBER-1-6        PIC X(6).
  1223             24  WK-MEMBER-7-12       PIC X(6).
  1224
  1225         16  WK-FULL-CERT-NO.
  1226             24  WK-CERT-POS-1-2      PIC X(2).
  1227             24  WK-CERT-POS-3        PIC X(1).
  1228             24  WK-CERT-POS-4        PIC X(1).
  1229             24  WK-CERT-POS-5-6      PIC X(2).
  1230             24  WK-CERT-POS-7        PIC X(1).
  1231             24  WK-CERT-POS-8-11     PIC X(4).
  1232
  1233         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1234             88  VALID-RATE-CODE        VALUE 'Y'.
  1235             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1236
  1237         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1238         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1239         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1240         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1241         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1242         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1243         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1244         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1245         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1246         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1247
  1248* DLO001
  1249 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  24
* EL050.cbl
  1250     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1251     12  DMPF-RETURN-CODE          PIC XX.
  1252         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1253         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1254         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1255         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1256         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1257         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1258
  1259* DLO002
  1260 01  WS-DLO-INTERNAL-POLICY-FORM.
  1261     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1262     12  DIPF-RETURN-CODE          PIC XX.
  1263         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1264         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1265         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1266         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1267         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1268         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1269
  1270* DLO003
  1271 01  WS-DLO-VALID-BANK-ID.
  1272     12  DVBI-BANK-ID              PIC X(5).
  1273     12  DVBI-BANK-ID-TYPE         PIC X.
  1274         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1275         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1276         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1277         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1278         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1279     12  DVBI-RETURN-CODE          PIC XX.
  1280         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1281         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1282         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1283         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1284         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1285         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1286         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1287         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1288         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1289
  1290* DLO007
  1291 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1292     12  DCUA-RES-STATE            PIC XX.
  1293     12  DCUA-BEN-TYPE             PIC XX.
  1294     12  DCUA-SYS-IDENT            PIC X.
  1295         88  DCUA-CLAIM                        VALUE 'C'.
  1296         88  DCUA-PREMIUM                      VALUE 'P'.
  1297     12  DCUA-COVERAGE-RULE        PIC X.
  1298     12  DCUA-CLIENT-ID            PIC X(10).
  1299     12  DCUA-EFF-DATE             PIC X(8).
  1300     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1301     12  DCUA-RETURN-CODE          PIC XX.
  1302         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1303     12  DCUA-CERT-NUMBER          PIC X(11).
  1304     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1305     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1306
  1307* DLO011
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  25
* EL050.cbl
  1308 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1309     12  DPRB-RATE-CODE            PIC X(4).
  1310     12  DPRB-COVERAGE-CATEG       PIC X.
  1311     12  DPRB-RETURN-CODE          PIC XX.
  1312         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1313         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1314         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1315         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1316         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1317         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1318         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1319         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1320         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1321     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1322     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1323     12  DPRB-BEN-TYPE             PIC XX.
  1324
  1325* DLO017
  1326 01  WS-DLO-VALID-RATE-CODE.
  1327     12  DVRC-RATE-CODE            PIC X(4).
  1328     12  DVRC-RETURN-CODE          PIC XX.
  1329         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1330         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1331         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1332         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1333         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1334         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1335
  1336* DLO019
  1337 01  WS-DLO-ORIG-COV-CAT.
  1338     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1339     12  DOCC-RETURN-CODE          PIC XX.
  1340     12  DOCC-ORIG-COV-CAT         PIC X.
  1341     12  DOCC-UNDERWITER           PIC XX.
  1342     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1343     12  DOCC-FILLER               PIC X(6).
  1344
  1345* DLO021
  1346 01  WS-DLO-VALID-LOAN-OFFICER.
  1347     12  DVLO-LOAN-OFFICER.
  1348         16  DVLO-BILL-TYPE        PIC X.
  1349         16  DVLO-BILL-SOURCE      PIC X.
  1350         16  DVLO-BATCH-TYPE       PIC X.
  1351     12  DVLO-RETURN-CODE          PIC XX.
  1352         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1353         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1354         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1355         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1356         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1357         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1358
  1359* DLO022
  1360 01  WS-DLO-VALID-STATE-CODE.
  1361     12  DVSC-STATE-CODE           PIC XX.
  1362     12  DVSC-RETURN-CODE          PIC XX.
  1363         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1364
  1365* DLO023
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  26
* EL050.cbl
  1366 01  WS-DLO-VALID-CODE-VALUES.
  1367     12  DVCV-SYSTEM-ID            PIC XX.
  1368         88  DVCV-CLAIMS                       VALUE 'CL'.
  1369         88  DVCV-CREDIT                       VALUE 'CR'.
  1370     12  DVCV-RECORD-TYPE          PIC XX.
  1371         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1372         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1373         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1374         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1375         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1376         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1377         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1378         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1379     12  DVCV-RECORD-KEY           PIC X(6).
  1380     12  DVCV-RETURN-CODE          PIC XX.
  1381         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1383         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1384         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1385         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1386         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1387         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1388     12  DVCV-CODE-DESC            PIC X(60).
  1389     12  DVCV-GEN-DESC-1           PIC X(20).
  1390     12  DVCV-GEN-DESC-2           PIC X(20).
  1391     12  DVCV-GEN-DESC-3           PIC X(20).
  1392
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  27
* EL050.cbl
  1394*    COPY ERCBXRF.
  1395******************************************************************
  1396*                                                                *
  1397*                                                                *
  1398*                            ERCBXRF                             *
  1399*                                                                *
  1400*   ONLINE CREDIT SYSTEM                                         *
  1401*                                                                *
  1402*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1403*                                                                *
  1404*   FILE TYPE = VSAM,KSDS                                        *
  1405*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1406*                                                                *
  1407*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1408*       ALTERNATE PATH = NONE                                    *
  1409*                                                                *
  1410*   LOG = NO                                                     *
  1411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1412*                                                                *
  1413******************************************************************
  1414
  1415 01  BANK-CROSS-REFERENCE.
  1416     12  BK-RECORD-ID                PIC XX.
  1417         88  VALID-BK-ID             VALUE 'BK'.
  1418
  1419     12  BK-CONTROL-PRIMARY.
  1420         16  BK-COMPANY-CD           PIC X.
  1421         16  BK-CARRIER              PIC X.
  1422         16  BK-GROUPING             PIC X(6).
  1423         16  BK-BANK-NO              PIC X(10).
  1424
  1425     12  BK-MAINT-INFORMATION.
  1426         16  BK-LAST-MAINT-DT        PIC XX.
  1427         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1428         16  BK-LAST-MAINT-USER      PIC X(4).
  1429         16  FILLER                  PIC X(9).
  1430
  1431     12  FILLER                      PIC X(37).
  1432
  1433     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1434
  1435     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1436                            DEPENDING ON BK-BANK-POINTER-CNT.
  1437         16  BK-AM-ACCOUNT           PIC X(10).
  1438         16  BK-AM-EXP-DT            PIC XX.
  1439         16  BK-AM-EFF-DT            PIC XX.
  1440         16  BK-AM-STATE             PIC XX.
  1441         16  FILLER                  PIC X(20).
  1442
  1443******************************************************************
  1444
  1445*    COPY ERCCOMP.
  1446******************************************************************
  1447*                                                                *
  1448*                                                                *
  1449*                            ERCCOMP                             *
  1450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1451*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  28
* EL050.cbl
  1452*                                                                *
  1453*   ONLINE CREDIT SYSTEM                                         *
  1454*                                                                *
  1455*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1456*                                                                *
  1457*   FILE TYPE = VSAM,KSDS                                        *
  1458*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1459*                                                                *
  1460*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1461*       ALTERNATE PATH = NONE                                    *
  1462*                                                                *
  1463*   LOG = NO                                                     *
  1464*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1465*                                                                *
  1466******************************************************************
  1467*                   C H A N G E   L O G
  1468*
  1469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1470*-----------------------------------------------------------------
  1471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1472* EFFECTIVE    NUMBER
  1473*-----------------------------------------------------------------
  1474* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1475* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1476* 092205    2005050300006  PEMA  ADD LEASE FEE
  1477* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1478* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1479* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1480* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1481* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1482******************************************************************
  1483
  1484 01  COMPENSATION-MASTER.
  1485     12  CO-RECORD-ID                          PIC XX.
  1486         88  VALID-CO-ID                          VALUE 'CO'.
  1487
  1488     12  CO-CONTROL-PRIMARY.
  1489         16  CO-COMPANY-CD                     PIC X.
  1490         16  CO-CONTROL.
  1491             20  CO-CTL-1.
  1492                 24  CO-CARR-GROUP.
  1493                     28  CO-CARRIER            PIC X.
  1494                     28  CO-GROUPING.
  1495                         32  CO-GROUP-PREFIX   PIC XXX.
  1496                         32  CO-GROUP-PRIME    PIC XXX.
  1497                 24  CO-RESP-NO.
  1498                     28  CO-RESP-PREFIX        PIC X(4).
  1499                     28  CO-RESP-PRIME         PIC X(6).
  1500             20  CO-CTL-2.
  1501                 24  CO-ACCOUNT.
  1502                     28  CO-ACCT-PREFIX        PIC X(4).
  1503                     28  CO-ACCT-PRIME         PIC X(6).
  1504         16  CO-TYPE                           PIC X.
  1505             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1506             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1507             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1508
  1509     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  29
* EL050.cbl
  1510         16  CO-LAST-MAINT-DT                  PIC XX.
  1511         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1512         16  CO-LAST-MAINT-USER                PIC X(4).
  1513     12  FILLER                                PIC XX.
  1514     12  CO-STMT-TYPE                          PIC XXX.
  1515     12  CO-COMP-TYPE                          PIC X.
  1516         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1517     12  CO-STMT-OWNER                         PIC X(4).
  1518     12  CO-BALANCE-CONTROL                    PIC X.
  1519         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1520         88  CO-NO-BALANCE                        VALUE 'N'.
  1521
  1522     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1523         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1524         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1525         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1526
  1527     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1528         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1529         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1530
  1531     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1532     12  CO-GA-DIRECT-DEP                      PIC X.
  1533     12  CO-FUTURE-SPACE                       PIC X.
  1534         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1535
  1536     12  CO-ACCT-NAME                          PIC X(30).
  1537     12  CO-MAIL-NAME                          PIC X(30).
  1538     12  CO-ADDR-1                             PIC X(30).
  1539     12  CO-ADDR-2                             PIC X(30).
  1540     12  CO-ADDR-3.
  1541         16  CO-ADDR-CITY                      PIC X(27).
  1542         16  CO-ADDR-STATE                     PIC XX.
  1543     12  CO-CSO-1099                           PIC X.
  1544     12  CO-ZIP.
  1545         16  CO-ZIP-PRIME.
  1546             20  CO-ZIP-PRI-1ST                PIC X.
  1547                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1548             20  FILLER                        PIC X(4).
  1549         16  CO-ZIP-PLUS4                      PIC X(4).
  1550     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1551         16  CO-CAN-POSTAL-1                   PIC XXX.
  1552         16  CO-CAN-POSTAL-2                   PIC XXX.
  1553         16  FILLER                            PIC XXX.
  1554     12  CO-SOC-SEC                            PIC X(13).
  1555     12  CO-TELEPHONE.
  1556         16  CO-AREA-CODE                      PIC XXX.
  1557         16  CO-PREFIX                         PIC XXX.
  1558         16  CO-PHONE                          PIC X(4).
  1559
  1560     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1561
  1562     12  CO-AR-BAL-LEVEL                       PIC X.
  1563         88  CO-AR-REF-LVL                        VALUE '1'.
  1564         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1565         88  CO-AR-BILL-LVL                       VALUE '2'.
  1566         88  CO-AR-AGT-LVL                        VALUE '3'.
  1567         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  30
* EL050.cbl
  1568
  1569     12  CO-AR-NORMAL-PRINT                    PIC X.
  1570         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1571         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1572
  1573     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1574
  1575     12  CO-AR-REPORTING                       PIC X.
  1576         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1577         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1578
  1579     12  CO-AR-PULL-CHECK                      PIC X.
  1580         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1581         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1582
  1583     12  CO-AR-BALANCE-PRINT                   PIC X.
  1584         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1585
  1586     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1587         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1588         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1589         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1590
  1591     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1592
  1593     12  CO-USER-CODE                          PIC X.
  1594     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1595
  1596******************************************************************
  1597*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1598*    THE LAST MONTH END RUN.
  1599******************************************************************
  1600
  1601     12  CO-LAST-ACTIVITY-DATE.
  1602         16  CO-ACT-YEAR                       PIC 99.
  1603         16  CO-ACT-MONTH                      PIC 99.
  1604         16  CO-ACT-DAY                        PIC 99.
  1605
  1606     12  CO-LAST-STMT-DT.
  1607         16  CO-LAST-STMT-YEAR                 PIC 99.
  1608         16  CO-LAST-STMT-MONTH                PIC 99.
  1609         16  CO-LAST-STMT-DAY                  PIC 99.
  1610
  1611     12  CO-MO-END-TOTALS.
  1612         16  CO-MONTHLY-TOTALS.
  1613             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1614             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1615             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1616             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1617             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1618
  1619         16  CO-AGING-TOTALS.
  1620             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1621             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1622             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1623             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1624
  1625         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  31
* EL050.cbl
  1626             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1627             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1628
  1629         16  CO-OVER-UNDER-TOTALS.
  1630             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1631             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1632
  1633     12  CO-MISCELLANEOUS-TOTALS.
  1634         16  CO-FICA-TOTALS.
  1635             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1636             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1637
  1638         16  CO-CLAIM-TOTALS.
  1639             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1640             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1641
  1642******************************************************************
  1643*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1644*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1645******************************************************************
  1646
  1647     12  CO-CURRENT-TOTALS.
  1648         16  CO-CURRENT-LAST-STMT-DT.
  1649             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1650             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1651             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1652
  1653         16  CO-CURRENT-MONTHLY-TOTALS.
  1654             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1657             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1658             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1659
  1660         16  CO-CURRENT-AGING-TOTALS.
  1661             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1662             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1663             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1664             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-CURRENT-YTD-TOTALS.
  1667             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1668             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1669
  1670     12  CO-PAID-COMM-TOTALS.
  1671         16  CO-YTD-PAID-COMMS.
  1672             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1673             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1674
  1675     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1676         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1677         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1678
  1679     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1680         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1681         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1682         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1683         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  32
* EL050.cbl
  1684         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1685         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1686         88  CO-FINAL-LETTER                  VALUE 'F'.
  1687         88  CO-RECONCILING                   VALUE 'R'.
  1688         88  CO-PHONE-CALL                    VALUE 'P'.
  1689         88  CO-LEGAL                         VALUE 'L'.
  1690         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1691         88  CO-WRITE-OFF                     VALUE 'W'.
  1692         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1693
  1694     12  CO-CSR-CODE                       PIC X(4).
  1695
  1696     12  CO-GA-STATUS-INFO.
  1697         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1698         16  CO-GA-TERMINATION-DT          PIC XX.
  1699         16  CO-GA-STATUS-CODE             PIC X.
  1700             88  CO-GA-ACTIVE                 VALUE 'A'.
  1701             88  CO-GA-INACTIVE               VALUE 'I'.
  1702             88  CO-GA-PENDING                VALUE 'P'.
  1703         16  CO-GA-COMMENTS.
  1704             20  CO-GA-COMMENT-1           PIC X(40).
  1705             20  CO-GA-COMMENT-2           PIC X(40).
  1706             20  CO-GA-COMMENT-3           PIC X(40).
  1707             20  CO-GA-COMMENT-4           PIC X(40).
  1708
  1709     12  CO-RPTCD2                         PIC X(10).
  1710
  1711     12  CO-TYPE-AGENT                     PIC X(01).
  1712         88  CO-CORPORATION                   VALUE 'C'.
  1713         88  CO-PARTNERSHIP                   VALUE 'P'.
  1714         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1715         88  CO-TRUST                         VALUE 'T'.
  1716         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1717
  1718     12  CO-FAXNO.
  1719         16  CO-FAX-AREA-CODE                  PIC XXX.
  1720         16  CO-FAX-PREFIX                     PIC XXX.
  1721         16  CO-FAX-PHONE                      PIC X(4).
  1722
  1723     12  CO-BANK-INFORMATION.
  1724         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1725         16  CO-BANK-TRANSIT-NON REDEFINES
  1726             CO-BANK-TRANSIT-NO                PIC 9(8).
  1727
  1728         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1729     12  CO-MISC-DEDUCT-INFO REDEFINES
  1730                  CO-BANK-INFORMATION.
  1731         16  CO-MD-GL-ACCT                     PIC X(10).
  1732         16  CO-MD-DIV                         PIC XX.
  1733         16  CO-MD-CENTER                      PIC X(4).
  1734         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1735         16  CO-CREATE-AP-CHECK                PIC X.
  1736         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1737         16  FILLER                            PIC XXX.
  1738     12  CO-ACH-STATUS                         PIC X.
  1739         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1740         88  CO-ACH-PENDING                        VALUE 'P'.
  1741
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  33
* EL050.cbl
  1742     12  CO-BILL-SW                            PIC X.
  1743     12  CO-CONTROL-NAME                       PIC X(30).
  1744     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1745     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1746     12  CO-CLP-STATE                          PIC XX.
  1747     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1748     12  CO-SPP-REFUND-EDIT                    PIC X.
  1749
  1750******************************************************************
  1751
  1752*    COPY ERCAGTC.
  1753******************************************************************
  1754*                                                                *
  1755*                                                                *
  1756*                            ERCAGTC                             *
  1757*                            VMOD=2.001                          *
  1758*                                                                *
  1759*   ONLINE CREDIT SYSTEM                                         *
  1760*                                                                *
  1761*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1762*                                                                *
  1763*   FILE TYPE = VSAM,KSDS                                        *
  1764*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1765*                                                                *
  1766*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1767*       ALTERNATE PATH = NONE                                    *
  1768*                                                                *
  1769*   LOG = NO                                                     *
  1770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1771*                                                                *
  1772******************************************************************
  1773*                   C H A N G E   L O G
  1774*
  1775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1776*-----------------------------------------------------------------
  1777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1778* EFFECTIVE    NUMBER
  1779*-----------------------------------------------------------------
  1780* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1781* 111004                         NEW FILE AND COPYBOOK
  1782* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1783******************************************************************
  1784 01  AGENT-COMMISSIONS.
  1785     12  AG-RECORD-ID                          PIC XX.
  1786         88  VALID-CO-ID                          VALUE 'AG'.
  1787     12  AG-CONTROL-PRIMARY.
  1788         16  AG-COMPANY-CD                     PIC X.
  1789         16  AG-CONTROL.
  1790             20  AG-CTL-1.
  1791                 24  AG-CARR-GROUP.
  1792                     28  AG-CARRIER            PIC X.
  1793                     28  AG-GROUPING           PIC X(6).
  1794                 24  AG-BANK                   PIC X(10).
  1795             20  AG-CTL-2.
  1796                 24  AG-EXP-DT                 PIC XX.
  1797         16  AG-TYPE                           PIC X.
  1798             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1799             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  34
* EL050.cbl
  1800     12  AG-MAINT-INFORMATION.
  1801         16  AG-LAST-MAINT-DT                  PIC XX.
  1802         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1803         16  AG-LAST-MAINT-USER                PIC X(4).
  1804         16  FILLER                            PIC X(10).
  1805     12  AG-EFF-DT                             PIC XX.
  1806     12  AG-COMM-STRUCTURE.
  1807         16  AG-AGT-COMMS OCCURS 10.
  1808             20  AG-AGT                PIC X(10).
  1809             20  AG-COM-TYP            PIC X.
  1810             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1811             20  AG-RECALC-LV-INDIC    PIC X.
  1812             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1813             20  AG-LRCALC-LV-INDIC    PIC X.
  1814             20  FILLER                PIC X(05).
  1815     12  FILLER                  PIC X(145).
  1816******************************************************************
  1817*    COPY ERCRESS.
  1818******************************************************************
  1819*                                                                *
  1820*                            ERCRESS                             *
  1821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1822*                            VMOD=2.002                          *
  1823*                                                                *
  1824*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1825*                                                                *
  1826*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1827*   VSAM RESIDENT STATE TAX MASTER                              *
  1828*                                                                *
  1829*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1833*                                                                *
  1834*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1835*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1836*                                                                *
  1837*   LOG = NO                                                     *
  1838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1839*                                                                *
  1840*                                                                *
  1841******************************************************************
  1842
  1843 01  RESIDENT-STATE-TAX-MASTER.
  1844
  1845     10  ERRESS-PRIMARY-KEY.
  1846         15  RES-COMPANY-CD        PIC X.
  1847         15  RES-RESIDENT-STATE    PIC XX.
  1848         15  RES-COVERAGE-CATEGORY PIC X.
  1849         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1850*                                      YYYYMMDD
  1851*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1852
  1853     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1854
  1855         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1856         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1857         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  35
* EL050.cbl
  1858         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1859
  1860     10 RES-RECALC-SW              PIC   X.
  1861         88 RECALC                VALUE 'Y'.
  1862         88 NO-RECALC             VALUE 'N'.
  1863     10  RES-MAINT-BY              PIC X(4).
  1864     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1865     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1866*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  36
* EL050.cbl
  1868*    COPY ERCRESC.
  1869******************************************************************
  1870*                                                                *
  1871*                            ERCRESC                             *
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1873*                            VMOD=2.003                          *
  1874*                                                                *
  1875*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1876*                                                                *
  1877*   FILE TYPE = VSAM,KSDS                                        *
  1878*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1879*                                                                *
  1880*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1881*       ALTERNATE PATH1 = NONE                                   *
  1882*                                                                *
  1883*   LOG = NO                                                     *
  1884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1885*                                                                *
  1886******************************************************************
  1887
  1888 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1889
  1890     10  ERRESC-RECORD-KEY.
  1891         15  RESC-COMPANY-CD           PIC   X.
  1892         15  RESC-CARRIER              PIC   X.
  1893         15  RESC-GROUP                PIC   X(6).
  1894         15  RESC-STATE                PIC   XX.
  1895         15  RESC-ACCOUNT              PIC   X(10).
  1896         15  RESC-AGENT                PIC   X(10).
  1897         15  RESC-RESIDENT-STATE       PIC   XX.
  1898         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1899*                                           YYYYMMDD
  1900     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1901
  1902     10  RESC-COMM-RECORD-DATA.
  1903         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1904             20 RESC-COVERAGE-CAT      PIC    X.
  1905             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1906             20 RESC-COMMISSION-TAB REDEFINES
  1907                RESC-COMMISSION-PER    PIC  XXX.
  1908
  1909     10  RESC-MAINT-BY                 PIC X(4).
  1910     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1911     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1912*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  37
* EL050.cbl
  1914*    COPY ERCPLAN.
  1915******************************************************************
  1916*                                                                *
  1917*                                                                *
  1918*                            ERCPLAN                             *
  1919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1920*                            VMOD=2.003                          *
  1921*                                                                *
  1922*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1923*                                                                *
  1924*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1925*   PLAN MASTER                                                  *
  1926*                                                                *
  1927*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1928*                                                                *
  1929*   FILE TYPE = VSAM,KSDS                                        *
  1930*   RECORD SIZE = 420   RECFORM = FIX                            *
  1931*                                                                *
  1932*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1933*       ALTERNATE PATH1 = N/A                                    *
  1934*                                                                *
  1935*   LOG = NO                                                     *
  1936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1937*                                                                *
  1938*                                                                *
  1939******************************************************************
  1940
  1941 01  PLAN-MASTER.
  1942     12  PL-RECORD-ID                      PIC XX.
  1943         88  VALID-PL-ID                      VALUE 'PL'.
  1944
  1945     12  PL-CONTROL-PRIMARY.
  1946         16  PL-COMPANY-CD                 PIC X.
  1947         16  PL-MSTR-CNTRL.
  1948             20  PL-CONTROL-A.
  1949                 24  PL-CARRIER            PIC X.
  1950                 24  PL-GROUPING           PIC X(6).
  1951                 24  PL-STATE              PIC XX.
  1952                 24  PL-ACCOUNT            PIC X(10).
  1953             20  PL-BENEFIT-TYPE           PIC X.
  1954             20  PL-BENEFIT-CODE           PIC XX.
  1955             20  PL-REVISION-NO            PIC X(3).
  1956
  1957     12  PL-CONTROL-BY-VAR-GRP.
  1958         16  PL-COMPANY-CD-A1              PIC X.
  1959         16  PL-VG-CARRIER                 PIC X.
  1960         16  PL-VG-GROUPING                PIC X(6).
  1961         16  PL-VG-STATE                   PIC XX.
  1962         16  PL-VG-ACCOUNT                 PIC X(10).
  1963         16  PL-BENEFIT-TYPE-A1            PIC X.
  1964         16  PL-BENEFIT-CODE-A1            PIC XX.
  1965         16  PL-REVISION-NO-A1             PIC 999.
  1966
  1967     12  PL-MAINT-INFORMATION.
  1968         16  PL-LAST-MAINT-DT              PIC XX.
  1969         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1970         16  PL-LAST-MAINT-USER            PIC X(4).
  1971         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  38
* EL050.cbl
  1972
  1973     12  PL-LIABILITY-LIMITS.
  1974         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1975         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1976             20  PL-LM-AGE                 PIC S99        COMP-3.
  1977             20  PL-LM-DUR                 PIC S999       COMP-3.
  1978             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1979             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1980
  1981     12  FILLER                            PIC X(30).
  1982
  1983     12  PL-GL-ACCOUNT-NOS.
  1984         16  PL-PREMIUM-GL                 PIC X(8).
  1985         16  PL-COMM-GL                    PIC X(8).
  1986         16  PL-CLAIM-GL                   PIC X(8).
  1987     12  FILLER                            PIC X(24).
  1988     12  PL-TOLERANCES.
  1989         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1990         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1991         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1992         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1993         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1994         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1995     12  PL-OVER-SHORT.
  1996         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1997         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1998     12  FILLER                            PIC X(24).
  1999     12  PLAN-MISC.
  2000         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2001         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2002         16  PL-IG                         PIC X.
  2003         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2004         16  PL-POLICY-FORM                PIC X(12).
  2005         16  PL-EDIT-FOR-FORM              PIC X(01).
  2006         16  PL-DEV-CODE                   PIC XXX.
  2007         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2008         16  PL-CALC-METHOD                PIC X.
  2009         16  PL-BENEFIT-GROUP              PIC X(05).
  2010         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2011
  2012         16  FILLER                        PIC X(99).
  2013******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  39
* EL050.cbl
  2015*    COPY ELCCERT.
  2016******************************************************************
  2017*                                                                *
  2018*                            ELCCERT.                            *
  2019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2020*                            VMOD=2.013                          *
  2021*                                                                *
  2022*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2023*                                                                *
  2024*   FILE TYPE = VSAM,KSDS                                        *
  2025*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2026*                                                                *
  2027*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2028*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2029*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2030*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2031*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2032*                                                                *
  2033*   LOG = YES                                                    *
  2034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2035******************************************************************
  2036*                   C H A N G E   L O G
  2037*
  2038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2039*-----------------------------------------------------------------
  2040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2041* EFFECTIVE    NUMBER
  2042*-----------------------------------------------------------------
  2043* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2044* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2045* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2046* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2047* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2048* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2049* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2050* 032612  CR2011110200001  PEMA  AHL CHANGES
  2051******************************************************************
  2052
  2053 01  CERTIFICATE-MASTER.
  2054     12  CM-RECORD-ID                      PIC XX.
  2055         88  VALID-CM-ID                      VALUE 'CM'.
  2056
  2057     12  CM-CONTROL-PRIMARY.
  2058         16  CM-COMPANY-CD                 PIC X.
  2059         16  CM-CARRIER                    PIC X.
  2060         16  CM-GROUPING.
  2061             20  CM-GROUPING-PREFIX        PIC X(3).
  2062             20  CM-GROUPING-PRIME         PIC X(3).
  2063         16  CM-STATE                      PIC XX.
  2064         16  CM-ACCOUNT.
  2065             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2066             20  CM-ACCOUNT-PRIME          PIC X(6).
  2067         16  CM-CERT-EFF-DT                PIC XX.
  2068         16  CM-CERT-NO.
  2069             20  CM-CERT-PRIME             PIC X(10).
  2070             20  CM-CERT-SFX               PIC X.
  2071
  2072     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  40
* EL050.cbl
  2073         16  CM-COMPANY-CD-A1              PIC X.
  2074         16  CM-INSURED-LAST-NAME          PIC X(15).
  2075         16  CM-INSURED-INITIALS.
  2076             20  CM-INSURED-INITIAL1       PIC X.
  2077             20  CM-INSURED-INITIAL2       PIC X.
  2078
  2079     12  CM-CONTROL-BY-SSN.
  2080         16  CM-COMPANY-CD-A2              PIC X.
  2081         16  CM-SOC-SEC-NO.
  2082             20  CM-SSN-STATE              PIC XX.
  2083             20  CM-SSN-ACCOUNT            PIC X(6).
  2084             20  CM-SSN-LN3.
  2085                 25  CM-INSURED-INITIALS-A2.
  2086                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2087                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2088                 25 CM-PART-LAST-NAME-A2         PIC X.
  2089
  2090     12  CM-CONTROL-BY-CERT-NO.
  2091         16  CM-COMPANY-CD-A4              PIC X.
  2092         16  CM-CERT-NO-A4                 PIC X(11).
  2093
  2094     12  CM-CONTROL-BY-MEMB.
  2095         16  CM-COMPANY-CD-A5              PIC X.
  2096         16  CM-MEMBER-NO.
  2097             20  CM-MEMB-STATE             PIC XX.
  2098             20  CM-MEMB-ACCOUNT           PIC X(6).
  2099             20  CM-MEMB-LN4.
  2100                 25  CM-INSURED-INITIALS-A5.
  2101                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2102                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2103                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2104
  2105     12  CM-INSURED-PROFILE-DATA.
  2106         16  CM-INSURED-FIRST-NAME.
  2107             20  CM-INSURED-1ST-INIT       PIC X.
  2108             20  FILLER                    PIC X(9).
  2109         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2110         16  CM-INSURED-SEX                PIC X.
  2111             88  CM-SEX-MALE                  VALUE 'M'.
  2112             88  CM-SEX-FEMAL                 VALUE 'F'.
  2113         16  CM-INSURED-JOINT-AGE          PIC 99.
  2114         16  CM-JOINT-INSURED-NAME.
  2115             20  CM-JT-LAST-NAME           PIC X(15).
  2116             20  CM-JT-FIRST-NAME.
  2117                 24  CM-JT-1ST-INIT        PIC X.
  2118                 24  FILLER                PIC X(9).
  2119             20  CM-JT-INITIAL             PIC X.
  2120
  2121     12  CM-LIFE-DATA.
  2122         16  CM-LF-BENEFIT-CD              PIC XX.
  2123         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2124         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2125         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2126         16  CM-LF-DEV-CODE                PIC XXX.
  2127         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2128         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2129         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2130         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  41
* EL050.cbl
  2131         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2132         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2133         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2134         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2135         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2136         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2137         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2138         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2139         16  FILLER                        PIC XX.
  2140
  2141     12  CM-AH-DATA.
  2142         16  CM-AH-BENEFIT-CD              PIC XX.
  2143         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2144         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2145         16  CM-AH-DEV-CODE                PIC XXX.
  2146         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2147         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2148         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2149         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2150         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2151         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2152         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2153         16  CM-AH-PAID-THRU-DT            PIC XX.
  2154             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2155         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2156         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2157         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2158         16  FILLER                        PIC X.
  2159
  2160     12  CM-LOAN-INFORMATION.
  2161         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2162         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2163                                           PIC S9(5)V99  COMP-3.
  2164         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2165         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2166         16  CM-PAY-FREQUENCY              PIC S99.
  2167         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2168         16  CM-RATE-CLASS                 PIC XX.
  2169         16  CM-BENEFICIARY                PIC X(25).
  2170         16  CM-POLICY-FORM-NO             PIC X(12).
  2171         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2172         16  CM-LAST-ADD-ON-DT             PIC XX.
  2173         16  CM-DEDUCTIBLE-AMOUNTS.
  2174             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2175             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2176         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2177             20  CM-RESIDENT-STATE         PIC XX.
  2178             20  CM-RATE-CODE              PIC X(4).
  2179             20  FILLER                    PIC XX.
  2180         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2181             20  CM-LOAN-OFFICER           PIC X(5).
  2182             20  FILLER                    PIC XXX.
  2183         16  CM-CSR-CODE                   PIC XXX.
  2184         16  CM-UNDERWRITING-CODE          PIC X.
  2185             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2186         16  CM-POST-CARD-IND              PIC X.
  2187         16  CM-NH-INTERFACE-SW            PIC X.
  2188         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  42
* EL050.cbl
  2189             88  CM-SING-PRM                  VALUE '1'.
  2190             88  CM-O-B-COVERAGE              VALUE '2'.
  2191             88  CM-OPEN-END                  VALUE '3'.
  2192         16  CM-IND-GRP-TYPE               PIC X.
  2193             88  CM-INDIVIDUAL                VALUE 'I'.
  2194             88  CM-GROUP                     VALUE 'G'.
  2195         16  CM-SKIP-CODE                  PIC X.
  2196             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2197             88  SKIP-JULY                    VALUE '1'.
  2198             88  SKIP-AUGUST                  VALUE '2'.
  2199             88  SKIP-SEPTEMBER               VALUE '3'.
  2200             88  SKIP-JULY-AUG                VALUE '4'.
  2201             88  SKIP-AUG-SEPT                VALUE '5'.
  2202             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2203             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2204             88  SKIP-JUNE                    VALUE '8'.
  2205             88  SKIP-JUNE-JULY               VALUE '9'.
  2206             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2207             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2208         16  CM-PAYMENT-MODE               PIC X.
  2209             88  PAY-MONTHLY                  VALUE SPACE.
  2210             88  PAY-WEEKLY                   VALUE '1'.
  2211             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2212             88  PAY-BI-WEEKLY                VALUE '3'.
  2213             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2214         16  CM-LOAN-NUMBER                PIC X(8).
  2215         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2216         16  CM-OLD-LOF                    PIC XXX.
  2217*        16  CM-LOAN-OFFICER               PIC XXX.
  2218         16  CM-REIN-TABLE                 PIC XXX.
  2219         16  CM-SPECIAL-REIN-CODE          PIC X.
  2220         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2221         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2222         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2223
  2224     12  CM-STATUS-DATA.
  2225         16  CM-ENTRY-STATUS               PIC X.
  2226         16  CM-ENTRY-DT                   PIC XX.
  2227
  2228         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2229         16  CM-LF-CANCEL-DT               PIC XX.
  2230         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2231
  2232         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2233         16  CM-LF-DEATH-DT                PIC XX.
  2234         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2235
  2236         16  CM-LF-CURRENT-STATUS          PIC X.
  2237             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2238                                                'M' '4' '5' '9'.
  2239             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2240             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2241             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2242             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2243             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2244             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2245             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2246             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  43
* EL050.cbl
  2247             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2248             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2249             88  CM-LF-DECLINED               VALUE 'D'.
  2250             88  CM-LF-VOIDED                 VALUE 'V'.
  2251
  2252         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2253         16  CM-AH-CANCEL-DT               PIC XX.
  2254         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2255
  2256         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2257         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2258         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2259
  2260         16  CM-AH-CURRENT-STATUS          PIC X.
  2261             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2262                                                'M' '4' '5' '9'.
  2263             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2264             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2265             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2266             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2267             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2268             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2269             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2270             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2271             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2272             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2273             88  CM-AH-DECLINED               VALUE 'D'.
  2274             88  CM-AH-VOIDED                 VALUE 'V'.
  2275
  2276         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2277             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2278             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2279             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2280         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2281
  2282         16  CM-ENTRY-BATCH                PIC X(6).
  2283         16  CM-LF-EXIT-BATCH              PIC X(6).
  2284         16  CM-AH-EXIT-BATCH              PIC X(6).
  2285         16  CM-LAST-MONTH-END             PIC XX.
  2286
  2287     12  CM-NOTE-SW                        PIC X.
  2288         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2289         88  CERT-NOTES-PRESENT               VALUE '1'.
  2290         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2291         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2292         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2293         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2294         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2295         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2296     12  CM-COMP-EXCP-SW                   PIC X.
  2297         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2298         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2299     12  CM-INSURED-ADDRESS-SW             PIC X.
  2300         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2301         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2302
  2303*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2304     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  44
* EL050.cbl
  2305     12  FILLER                            PIC X.
  2306
  2307*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2308     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2309     12  FILLER                            PIC X.
  2310*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2311     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2312
  2313     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2314         88  CERT-ADDED-BATCH                 VALUE ' '.
  2315         88  CERT-ADDED-ONLINE                VALUE '1'.
  2316         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2317         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2318         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2319     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2320         88  CERT-AS-LOADED                   VALUE ' '.
  2321         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2322         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2323         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2324         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2325         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2326         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2327         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2328
  2329     12  CM-ACCOUNT-COMM-PCTS.
  2330         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2331         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2332
  2333     12  CM-USER-FIELD                     PIC X.
  2334     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2335     12  CM-CLP-STATE                      PIC XX.
  2336     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2337     12  CM-USER-RESERVED                  PIC XXX.
  2338     12  FILLER REDEFINES CM-USER-RESERVED.
  2339         16  CM-AH-CLASS-CD                PIC XX.
  2340         16  F                             PIC X.
  2341******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  45
* EL050.cbl
  2343*    COPY ERCMAIL.
  2344******************************************************************
  2345*                                                                *
  2346*                                                                *
  2347*                            ERCMAIL                             *
  2348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2349*                            VMOD=2.003                          *
  2350*                                                                *
  2351*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2352*                                                                *
  2353*   FILE TYPE = VSAM,KSDS                                        *
  2354*   RECORD SIZE = 374   RECFORM = FIX                            *
  2355*                                                                *
  2356*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2357*   ALTERNATE PATH    = NOT USED                                 *
  2358*                                                                *
  2359*   LOG = YES                                                    *
  2360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2361******************************************************************
  2362*                   C H A N G E   L O G
  2363*
  2364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2365*-----------------------------------------------------------------
  2366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2367* EFFECTIVE    NUMBER
  2368*-----------------------------------------------------------------
  2369* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2370* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2371* 111108                   PEMA  ADD CRED BENE ADDR2
  2372******************************************************************
  2373
  2374 01  MAILING-DATA.
  2375     12  MA-RECORD-ID                      PIC XX.
  2376         88  VALID-MA-ID                       VALUE 'MA'.
  2377
  2378     12  MA-CONTROL-PRIMARY.
  2379         16  MA-COMPANY-CD                 PIC X.
  2380         16  MA-CARRIER                    PIC X.
  2381         16  MA-GROUPING.
  2382             20  MA-GROUPING-PREFIX        PIC XXX.
  2383             20  MA-GROUPING-PRIME         PIC XXX.
  2384         16  MA-STATE                      PIC XX.
  2385         16  MA-ACCOUNT.
  2386             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2387             20  MA-ACCOUNT-PRIME          PIC X(6).
  2388         16  MA-CERT-EFF-DT                PIC XX.
  2389         16  MA-CERT-NO.
  2390             20  MA-CERT-PRIME             PIC X(10).
  2391             20  MA-CERT-SFX               PIC X.
  2392
  2393     12  FILLER                            PIC XX.
  2394
  2395     12  MA-ACCESS-CONTROL.
  2396         16  MA-SOURCE-SYSTEM              PIC XX.
  2397             88  MA-FROM-CREDIT                VALUE 'CR'.
  2398             88  MA-FROM-VSI                   VALUE 'VS'.
  2399             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2400             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  46
* EL050.cbl
  2401         16  MA-RECORD-ADD-DT              PIC XX.
  2402         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2403         16  MA-LAST-MAINT-DT              PIC XX.
  2404         16  MA-LAST-MAINT-BY              PIC XXXX.
  2405         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2406
  2407     12  MA-PROFILE-INFO.
  2408         16  MA-QUALIFY-CODE-1             PIC XX.
  2409         16  MA-QUALIFY-CODE-2             PIC XX.
  2410         16  MA-QUALIFY-CODE-3             PIC XX.
  2411         16  MA-QUALIFY-CODE-4             PIC XX.
  2412         16  MA-QUALIFY-CODE-5             PIC XX.
  2413
  2414         16  MA-INSURED-LAST-NAME          PIC X(15).
  2415         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2416         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2417         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2418         16  MA-INSURED-BIRTH-DT           PIC XX.
  2419         16  MA-INSURED-SEX                PIC X.
  2420             88  MA-SEX-MALE                   VALUE 'M'.
  2421             88  MA-SEX-FEMALE                 VALUE 'F'.
  2422         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2423
  2424         16  MA-ADDRESS-CORRECTED          PIC X.
  2425         16  MA-JOINT-BIRTH-DT             PIC XX.
  2426*        16  FILLER                        PIC X(12).
  2427
  2428         16  MA-ADDRESS-LINE-1             PIC X(30).
  2429         16  MA-ADDRESS-LINE-2             PIC X(30).
  2430         16  MA-CITY-STATE.
  2431             20  MA-CITY                   PIC X(28).
  2432             20  MA-ADDR-STATE             PIC XX.
  2433         16  MA-ZIP.
  2434             20  MA-ZIP-CODE.
  2435                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2436                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2437                 24  FILLER                PIC X(4).
  2438             20  MA-ZIP-PLUS4              PIC X(4).
  2439         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2440             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2441             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2442             20  FILLER                    PIC X(3).
  2443
  2444         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2445
  2446         16  FILLER                        PIC XXX.
  2447*        16  FILLER                        PIC X(10).
  2448
  2449     12  MA-CRED-BENE-INFO.
  2450         16  MA-CRED-BENE-NAME                 PIC X(25).
  2451         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2452         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2453         16  MA-CRED-BENE-CTYST.
  2454             20  MA-CRED-BENE-CITY             PIC X(28).
  2455             20  MA-CRED-BENE-STATE            PIC XX.
  2456         16  MA-CRED-BENE-ZIP.
  2457             20  MA-CB-ZIP-CODE.
  2458                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  47
* EL050.cbl
  2459                     88  MA-CB-CANADIAN-POST-CODE
  2460                                           VALUE 'A' THRU 'Z'.
  2461                 24  FILLER                    PIC X(4).
  2462             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2463         16  MA-CB-CANADIAN-POSTAL-CODE
  2464                            REDEFINES MA-CRED-BENE-ZIP.
  2465             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2466             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2467             20  FILLER                        PIC X(3).
  2468     12  MA-POST-CARD-MAIL-DATA.
  2469         16  MA-MAIL-DATA OCCURS 7.
  2470             20  MA-MAIL-TYPE              PIC X.
  2471                 88  MA-12MO-MAILING           VALUE '1'.
  2472                 88  MA-EXP-MAILING            VALUE '2'.
  2473             20  MA-MAIL-STATUS            PIC X.
  2474                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2475                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2476                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2477             20  MA-MAIL-DATE              PIC XX.
  2478     12  FILLER                            PIC XX.
  2479     12  FILLER                            PIC XX.
  2480*    12  FILLER                            PIC X(30).
  2481******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  48
* EL050.cbl
  2483*    COPY ERCPNDM.
  2484******************************************************************
  2485*                                                                *
  2486*                                                                *
  2487*                            ERCPNDM                             *
  2488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2489*                            VMOD=2.003                          *
  2490*                                                                *
  2491*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2492*                                                                *
  2493*   FILE TYPE = VSAM,KSDS                                        *
  2494*   RECORD SIZE = 374   RECFORM = FIX                            *
  2495*                                                                *
  2496*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2497*   ALTERNATE PATH    = NOT USED                                 *
  2498*                                                                *
  2499*   LOG = YES                                                    *
  2500*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2501******************************************************************
  2502*                   C H A N G E   L O G
  2503*
  2504* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2505*-----------------------------------------------------------------
  2506*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2507* EFFECTIVE    NUMBER
  2508*-----------------------------------------------------------------
  2509* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2510* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2511* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2512******************************************************************
  2513
  2514 01  PENDING-MAILING-DATA.
  2515     12  PM-RECORD-ID                      PIC XX.
  2516         88  VALID-MA-ID                       VALUE 'PM'.
  2517
  2518     12  PM-CONTROL-PRIMARY.
  2519         16  PM-COMPANY-CD                 PIC X.
  2520         16  PM-ENTRY-BATCH                PIC X(6).
  2521         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2522         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2523
  2524     12  FILLER                            PIC X(14).
  2525
  2526     12  PM-ACCESS-CONTROL.
  2527         16  PM-SOURCE-SYSTEM              PIC XX.
  2528             88  PM-FROM-CREDIT                VALUE 'CR'.
  2529             88  PM-FROM-VSI                   VALUE 'VS'.
  2530             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2531             88  PM-FROM-OTHER                 VALUE 'OT'.
  2532         16  PM-RECORD-ADD-DT              PIC XX.
  2533         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2534         16  PM-LAST-MAINT-DT              PIC XX.
  2535         16  PM-LAST-MAINT-BY              PIC XXXX.
  2536         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2537
  2538     12  PM-PROFILE-INFO.
  2539         16  PM-QUALIFY-CODE-1             PIC XX.
  2540         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  49
* EL050.cbl
  2541         16  PM-QUALIFY-CODE-3             PIC XX.
  2542         16  PM-QUALIFY-CODE-4             PIC XX.
  2543         16  PM-QUALIFY-CODE-5             PIC XX.
  2544
  2545         16  PM-INSURED-LAST-NAME          PIC X(15).
  2546         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2547         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2548         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2549         16  PM-INSURED-BIRTH-DT           PIC XX.
  2550         16  PM-INSURED-SEX                PIC X.
  2551             88  PM-SEX-MALE                   VALUE 'M'.
  2552             88  PM-SEX-FEMALE                 VALUE 'F'.
  2553         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2554
  2555         16  PM-ADDRESS-CORRECTED          PIC X.
  2556         16  PM-JOINT-BIRTH-DT             PIC XX.
  2557*        16  FILLER                        PIC X(12).
  2558
  2559         16  PM-ADDRESS-LINE-1             PIC X(30).
  2560         16  PM-ADDRESS-LINE-2             PIC X(30).
  2561         16  PM-CITY-STATE.
  2562             20  PM-CITY                   PIC X(28).
  2563             20  PM-STATE                  PIC XX.
  2564         16  PM-ZIP.
  2565             20  PM-ZIP-CODE.
  2566                 24  PM-ZIP-1              PIC X.
  2567                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2568                 24  FILLER                PIC X(4).
  2569             20  PM-ZIP-PLUS4              PIC X(4).
  2570         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2571             20  PM-CAN-POST1              PIC XXX.
  2572             20  PM-CAN-POST2              PIC XXX.
  2573             20  FILLER                    PIC XXX.
  2574
  2575         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2576
  2577         16  FILLER                        PIC X(03).
  2578
  2579     12  PM-CRED-BENE-INFO.
  2580         16  PM-CRED-BENE-NAME             PIC X(25).
  2581         16  PM-CRED-BENE-ADDR             PIC X(30).
  2582         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2583         16  PM-CRED-BENE-CTYST.
  2584             20  PM-CRED-BENE-CITY         PIC X(28).
  2585             20  PM-CRED-BENE-STATE        PIC XX.
  2586         16  PM-CRED-BENE-ZIP.
  2587             20  PM-CB-ZIP-CODE.
  2588                 24  PM-CB-ZIP-1           PIC X.
  2589                     88  PM-CB-CANADIAN-POST-CODE
  2590                                  VALUE 'A' THRU 'Z'.
  2591                 24  FILLER                PIC X(4).
  2592             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2593         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2594             20  PM-CB-CAN-POST1           PIC XXX.
  2595             20  PM-CB-CAN-POST2           PIC XXX.
  2596             20  FILLER                    PIC XXX.
  2597     12  PM-POST-CARD-MAIL-DATA.
  2598         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  50
* EL050.cbl
  2599             20  PM-MAIL-TYPE              PIC X.
  2600                 88  PM-12MO-MAILING           VALUE '1'.
  2601                 88  PM-EXP-MAILING            VALUE '2'.
  2602             20  PM-MAIL-STATUS            PIC X.
  2603                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2604                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2605                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2606             20  PM-MAIL-DATE              PIC XX.
  2607     12  FILLER                            PIC XX.
  2608     12  FILLER                            PIC X(12).
  2609*    12  FILLER                            PIC X(30).
  2610
  2611******************************************************************
  2612*                                COPY ERCLOFC.
  2613******************************************************************
  2614*                                                                *
  2615*                                                                *
  2616*                            ERCLOFC                             *
  2617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2618*                            VMOD=2.003                          *
  2619*                                                                *
  2620*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2621*                                                                *
  2622*   FILE TYPE = VSAM,KSDS                                        *
  2623*   RECORD SIZE = 670   RECFORM = FIX                            *
  2624*                                                                *
  2625*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2626*                                                                *
  2627*   LOG = YES                                                    *
  2628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2629*                                                                *
  2630******************************************************************
  2631
  2632 01  LOAN-OFFICER-MASTER.
  2633     12  LO-RECORD-ID                PIC XX.
  2634         88  VALID-LO-ID                VALUE 'LO'.
  2635
  2636     12  LO-CONTROL-PRIMARY.
  2637         16  LO-COMPANY-CD           PIC X.
  2638         16  LO-CARRIER              PIC X.
  2639         16  LO-GROUPING.
  2640             20  LO-GROUPING-PREFIX  PIC XXX.
  2641             20  LO-GROUPING-PRIME   PIC XXX.
  2642         16  LO-STATE                PIC XX.
  2643         16  LO-ACCOUNT.
  2644             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2645             20  LO-ACCOUNT-PRIME    PIC X(6).
  2646         16  LO-OFFICER-CODE         PIC X(5).
  2647
  2648     12  LO-OFFICER-NAME             PIC X(30).
  2649
  2650     12  LO-LAST-MAINT-DT            PIC XX.
  2651     12  LO-LAST-USER                PIC X(4).
  2652     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2653
  2654     12  LO-COMP-CONTROL             PIC X.
  2655             88  LO-SHOW-COMP           VALUE 'Y'.
  2656             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  51
* EL050.cbl
  2657     12  LO-DETAIL-CONTROL           PIC X.
  2658             88  LO-PRINT-DETAIL        VALUE 'D'.
  2659             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2660
  2661     12  LO-SV-CARRIER               PIC X.
  2662     12  LO-SV-GROUPING              PIC X(6).
  2663     12  LO-SV-STATE                 PIC XX.
  2664
  2665     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2666     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2667
  2668     12  LO-OFFICER-INFO.
  2669         16  FILLER OCCURS 12 TIMES.
  2670             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2671             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2672             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2673             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2674             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2675             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2676             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2677             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2678     12  FILLER                      PIC X(198).
  2679******************************************************************
  2680*                                COPY ERCPDEF.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ERCPDEF.                            *
  2685*                                                                *
  2686*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2687*                                                                *
  2688*    FILE TYPE = VSAM,KSDS                                       *
  2689*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2690*                                                                *
  2691*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2692*                                                                *
  2693*    LOG = YES                                                   *
  2694*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2695******************************************************************
  2696 01  PRODUCT-MASTER.
  2697    12  PD-RECORD-ID                 PIC X(02).
  2698        88  VALID-PD-ID                  VALUE 'PD'.
  2699    12  PD-CONTROL-PRIMARY.
  2700        16  PD-COMPANY-CD            PIC X.
  2701        16  PD-STATE                 PIC XX.
  2702        16  PD-PRODUCT-CD            PIC XXX.
  2703        16  PD-FILLER                PIC X(7).
  2704        16  PD-BEN-TYPE              PIC X.
  2705        16  PD-BEN-CODE              PIC XX.
  2706        16  PD-PROD-EXP-DT           PIC XX.
  2707    12  FILLER                       PIC X(50).
  2708    12  PD-PRODUCT-DATA OCCURS 8.
  2709        16  PD-PROD-CODE             PIC X.
  2710            88  PD-PROD-LIFE           VALUE 'L'.
  2711            88  PD-PROD-PROP           VALUE 'P'.
  2712            88  PD-PROD-AH             VALUE 'A'.
  2713            88  PD-PROD-IU             VALUE 'I'.
  2714            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  52
* EL050.cbl
  2715        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2716        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2717        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2718        16  PD-MAX-TERM              PIC S999        COMP-3.
  2719        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2720        16  FILLER                   PIC X.
  2721        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2722        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2723        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2724        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2725        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2726        16  PD-REC-CRIT-PERIOD       PIC X.
  2727        16  PD-RTW-MOS               PIC 99.
  2728        16  FILLER                   PIC X(5).
  2729    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2730    12  PD-TERM-LIMITS OCCURS 15.
  2731        16  PD-LOW-TERM              PIC S999        COMP-3.
  2732        16  PD-HI-TERM               PIC S999        COMP-3.
  2733*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2734    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2735        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2736        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2737    12  PD-EARN-FACTORS.
  2738        16  FILLER OCCURS 15.
  2739            20  FILLER OCCURS 15.
  2740                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2741    12  PD-PRODUCT-DESC              PIC X(80).
  2742    12  PD-TRUNCATED                 PIC X.
  2743    12  FILLER                       PIC X(59).
  2744    12  PD-MAINT-INFORMATION.
  2745        16  PD-LAST-MAINT-DT         PIC X(02).
  2746        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2747        16  PD-LAST-MAINT-BY         PIC X(04).
  2748*                                COPY ELCSTATE.
  2749******************************************************************
  2750*                                                                *
  2751*                                                                *
  2752*                            ELCSTATE.                           *
  2753*                                                                *
  2754*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2755*                                                                *
  2756*   FILE TYPE = VSAM,KSDS                                        *
  2757*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2758*                                                                *
  2759*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2760*       ALTERNATE INDEX = NONE                                   *
  2761*                                                                *
  2762*   LOG = YES                                                    *
  2763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2764******************************************************************
  2765*                   C H A N G E   L O G
  2766*
  2767* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2768*-----------------------------------------------------------------
  2769*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2770* EFFECTIVE    NUMBER
  2771*-----------------------------------------------------------------
  2772* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  53
* EL050.cbl
  2773******************************************************************
  2774*
  2775 01  STATE-FILE.
  2776     12  SF-RECORD-ID                       PIC XX.
  2777         88  VALID-CF-ID                        VALUE 'SF'.
  2778     12  SF-CONTROL-PRIMARY.
  2779         16  SF-COMPANY-ID                  PIC XXX.
  2780         16  SF-CARRIER-CODE                PIC X.
  2781         16  SF-GROUPING                    PIC X(6).
  2782         16  SF-STATE-CODE                  PIC XX.
  2783         16  SF-EXPIRE-DATE                 PIC 9(8).
  2784****************************************************************
  2785*             STATE CONTROLS
  2786****************************************************************
  2787     12  SF-LAST-MAINT-DT                   PIC XX.
  2788     12  SF-LAST-MAINT-BY                   PIC X(4).
  2789     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2790     12  SF-STATE-RT-CONTROLS.
  2791         16  SF-ST-RT-CALC                  PIC X.
  2792     12  SF-ST-TAX-CONTROLS.
  2793         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2794         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2795         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2796     12  SF-ST-REFUND-OPTIONS.
  2797         16  SF-ST-RF-LR-CALC               PIC X.
  2798         16  SF-ST-RF-LL-CALC               PIC X.
  2799         16  SF-ST-RF-LN-CALC               PIC X.
  2800         16  SF-ST-RF-AH-CALC               PIC X.
  2801         16  SF-ST-RF-CP-CALC               PIC X.
  2802     12  SF-ST-UNEARN-PREM-OPTIONS.
  2803         16  SF-ST-LUEP-R78                 PIC X.
  2804         16  SF-ST-LUEP-PRO                 PIC X.
  2805         16  SF-ST-LUEP-ST                  PIC X.
  2806         16  SF-ST-LUEP-DOM                 PIC X.
  2807         16  SF-ST-AUEP-R78                 PIC X.
  2808         16  SF-ST-AUEP-PRO                 PIC X.
  2809         16  SF-ST-AUEP-ST                  PIC X.
  2810         16  SF-ST-AUEP-DOM                 PIC X.
  2811         16  SF-ST-CUEP-R78                 PIC X.
  2812         16  SF-ST-CUEP-PRO                 PIC X.
  2813         16  SF-ST-CUEP-ST                  PIC X.
  2814         16  SF-ST-CUEP-DOM                 PIC X.
  2815     12  SF-ST-EARN-PREM-OPTIONS.
  2816         16  SF-ST-LEP-R78                  PIC X.
  2817         16  SF-ST-LEP-PRO                  PIC X.
  2818         16  SF-ST-LEP-ST                   PIC X.
  2819         16  SF-ST-LEP-DOM                  PIC X.
  2820         16  SF-ST-AEP-R78                  PIC X.
  2821         16  SF-ST-AEP-PRO                  PIC X.
  2822         16  SF-ST-AEP-ST                   PIC X.
  2823         16  SF-ST-AEP-DOM                  PIC X.
  2824         16  SF-ST-CEP-R78                  PIC X.
  2825         16  SF-ST-CEP-PRO                  PIC X.
  2826         16  SF-ST-CEP-ST                   PIC X.
  2827         16  SF-ST-CEP-DOM                  PIC X.
  2828     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  54
* EL050.cbl
  2830*    COPY ELCCRTT.
  2831******************************************************************
  2832*                                                                *
  2833*                            ELCCRTT.                            *
  2834*                                                                *
  2835*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2836*                                                                *
  2837*   FILE TYPE = VSAM,KSDS                                        *
  2838*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2839*                                                                *
  2840*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2841*                                                                *
  2842*   LOG = YES                                                    *
  2843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2844******************************************************************
  2845*                   C H A N G E   L O G
  2846*
  2847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2848*-----------------------------------------------------------------
  2849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2850* EFFECTIVE    NUMBER
  2851*-----------------------------------------------------------------
  2852* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2853* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2854* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2855******************************************************************
  2856
  2857 01  CERTIFICATE-TRAILERS.
  2858     12  CS-RECORD-ID                      PIC XX.
  2859         88  VALID-CS-ID                      VALUE 'CS'.
  2860
  2861     12  CS-CONTROL-PRIMARY.
  2862         16  CS-COMPANY-CD                 PIC X.
  2863         16  CS-CARRIER                    PIC X.
  2864         16  CS-GROUPING                   PIC X(6).
  2865         16  CS-STATE                      PIC XX.
  2866         16  CS-ACCOUNT                    PIC X(10).
  2867         16  CS-CERT-EFF-DT                PIC XX.
  2868         16  CS-CERT-NO.
  2869             20  CS-CERT-PRIME             PIC X(10).
  2870             20  CS-CERT-SFX               PIC X.
  2871         16  CS-TRAILER-TYPE               PIC X.
  2872             88  COMM-TRLR           VALUE 'A'.
  2873             88  FUTURE-TRLR         VALUE 'B'.
  2874             88  CERT-DATA-TRLR      VALUE 'C'.
  2875
  2876     12  CS-DATA-AREA                      PIC X(516).
  2877
  2878     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2879         16  CS-BANK-COMMISSION-AREA.
  2880             20  CS-BANK-COMMS       OCCURS 10.
  2881                 24  CS-AGT                PIC X(10).
  2882                 24  CS-COM-TYP            PIC X.
  2883                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2884                 24  CS-RECALC-LV-INDIC    PIC X.
  2885                 24  FILLER                PIC X(10).
  2886         16  FILLER                        PIC X(256).
  2887
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  55
* EL050.cbl
  2888     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2889         16  CS-VIN-NUMBER                 PIC X(17).
  2890         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2891         16  FILLER                        PIC X(498).
  2892******************************************************************
  2893
  2894*    COPY ELCDATE.
  2895******************************************************************
  2896*                                                                *
  2897*                                                                *
  2898*                            ELCDATE.                            *
  2899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2900*                            VMOD=2.003
  2901*                                                                *
  2902*                                                                *
  2903*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2904*                 LENGTH = 200                                   *
  2905******************************************************************
  2906
  2907 01  DATE-CONVERSION-DATA.
  2908     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2909     12  DC-OPTION-CODE                PIC X.
  2910         88  BIN-TO-GREG                VALUE ' '.
  2911         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2912         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2913         88  YMD-GREG-TO-BIN            VALUE '3'.
  2914         88  MDY-GREG-TO-BIN            VALUE '4'.
  2915         88  JULIAN-TO-BIN              VALUE '5'.
  2916         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2917         88  FIND-CENTURY               VALUE '7'.
  2918         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2919         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2920         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2921         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2922         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2923         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2924         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2925         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2926         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2927         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2928         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2929         88  BIN-3-TO-GREG              VALUE 'I'.
  2930         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2931         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2932         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2933         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2934         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2935         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2936         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2937         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2938         88  THREE-CHARACTER-BIN
  2939                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2940         88  GREGORIAN-TO-BIN
  2941                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2942         88  BIN-TO-GREGORIAN
  2943                  VALUES ' ' '1' 'I' '8' 'G'.
  2944         88  JULIAN-TO-BINARY
  2945                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  56
* EL050.cbl
  2946     12  DC-ERROR-CODE                 PIC X.
  2947         88  NO-CONVERSION-ERROR        VALUE ' '.
  2948         88  DATE-CONVERSION-ERROR
  2949                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2950         88  DATE-IS-ZERO               VALUE '1'.
  2951         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2952         88  DATE-IS-INVALID            VALUE '3'.
  2953         88  DATE1-GREATER-DATE2        VALUE '4'.
  2954         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2955         88  DATE-INVALID-OPTION        VALUE '9'.
  2956         88  INVALID-CENTURY            VALUE 'A'.
  2957         88  ONLY-CENTURY               VALUE 'B'.
  2958         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2959         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2960     12  DC-END-OF-MONTH               PIC X.
  2961         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2962     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2963         88  USE-NORMAL-PROCESS         VALUE ' '.
  2964         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2965         88  ADJUST-UP-100-YRS          VALUE '2'.
  2966     12  FILLER                        PIC X.
  2967     12  DC-CONVERSION-DATES.
  2968         16  DC-BIN-DATE-1             PIC XX.
  2969         16  DC-BIN-DATE-2             PIC XX.
  2970         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2971         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2972                       DC-GREG-DATE-1-EDIT.
  2973             20  DC-EDIT1-MONTH        PIC 99.
  2974             20  SLASH1-1              PIC X.
  2975             20  DC-EDIT1-DAY          PIC 99.
  2976             20  SLASH1-2              PIC X.
  2977             20  DC-EDIT1-YEAR         PIC 99.
  2978         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2979         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2980                     DC-GREG-DATE-2-EDIT.
  2981             20  DC-EDIT2-MONTH        PIC 99.
  2982             20  SLASH2-1              PIC X.
  2983             20  DC-EDIT2-DAY          PIC 99.
  2984             20  SLASH2-2              PIC X.
  2985             20  DC-EDIT2-YEAR         PIC 99.
  2986         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2987         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2988                     DC-GREG-DATE-1-YMD.
  2989             20  DC-YMD-YEAR           PIC 99.
  2990             20  DC-YMD-MONTH          PIC 99.
  2991             20  DC-YMD-DAY            PIC 99.
  2992         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2993         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2994                      DC-GREG-DATE-1-MDY.
  2995             20  DC-MDY-MONTH          PIC 99.
  2996             20  DC-MDY-DAY            PIC 99.
  2997             20  DC-MDY-YEAR           PIC 99.
  2998         16  DC-GREG-DATE-1-ALPHA.
  2999             20  DC-ALPHA-MONTH        PIC X(10).
  3000             20  DC-ALPHA-DAY          PIC 99.
  3001             20  FILLER                PIC XX.
  3002             20  DC-ALPHA-CENTURY.
  3003                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  57
* EL050.cbl
  3004             20  DC-ALPHA-YEAR         PIC 99.
  3005         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3006         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3007         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3008         16  DC-JULIAN-DATE            PIC 9(05).
  3009         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3010                                       PIC 9(05).
  3011         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3012             20  DC-JULIAN-YEAR        PIC 99.
  3013             20  DC-JULIAN-DAYS        PIC 999.
  3014         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3015         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3016         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3017     12  DATE-CONVERSION-VARIBLES.
  3018         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3019         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3020             20  FILLER                PIC 9(3).
  3021             20  HOLD-CEN-1-CCYY.
  3022                 24  HOLD-CEN-1-CC     PIC 99.
  3023                 24  HOLD-CEN-1-YY     PIC 99.
  3024             20  HOLD-CEN-1-MO         PIC 99.
  3025             20  HOLD-CEN-1-DA         PIC 99.
  3026         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3027             20  HOLD-CEN-1-R-MO       PIC 99.
  3028             20  HOLD-CEN-1-R-DA       PIC 99.
  3029             20  HOLD-CEN-1-R-CCYY.
  3030                 24  HOLD-CEN-1-R-CC   PIC 99.
  3031                 24  HOLD-CEN-1-R-YY   PIC 99.
  3032             20  FILLER                PIC 9(3).
  3033         16  HOLD-CENTURY-1-X.
  3034             20  FILLER                PIC X(3)  VALUE SPACES.
  3035             20  HOLD-CEN-1-X-CCYY.
  3036                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3037                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3038             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3039             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3040         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3041             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3042             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3043             20  HOLD-CEN-1-R-X-CCYY.
  3044                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3045                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3046             20  FILLER                PIC XXX.
  3047         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3048         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3049         16  DC-JULIAN-DATE-1          PIC 9(07).
  3050         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3051             20  DC-JULIAN-1-CCYY.
  3052                 24  DC-JULIAN-1-CC    PIC 99.
  3053                 24  DC-JULIAN-1-YR    PIC 99.
  3054             20  DC-JULIAN-DA-1        PIC 999.
  3055         16  DC-JULIAN-DATE-2          PIC 9(07).
  3056         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3057             20  DC-JULIAN-2-CCYY.
  3058                 24  DC-JULIAN-2-CC    PIC 99.
  3059                 24  DC-JULIAN-2-YR    PIC 99.
  3060             20  DC-JULIAN-DA-2        PIC 999.
  3061         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  58
* EL050.cbl
  3062             20  DC-EDITA-MONTH        PIC 99.
  3063             20  SLASHA-1              PIC X VALUE '/'.
  3064             20  DC-EDITA-DAY          PIC 99.
  3065             20  SLASHA-2              PIC X VALUE '/'.
  3066             20  DC-EDITA-CCYY.
  3067                 24  DC-EDITA-CENT     PIC 99.
  3068                 24  DC-EDITA-YEAR     PIC 99.
  3069         16  DC-GREG-DATE-B-EDIT.
  3070             20  DC-EDITB-MONTH        PIC 99.
  3071             20  SLASHB-1              PIC X VALUE '/'.
  3072             20  DC-EDITB-DAY          PIC 99.
  3073             20  SLASHB-2              PIC X VALUE '/'.
  3074             20  DC-EDITB-CCYY.
  3075                 24  DC-EDITB-CENT     PIC 99.
  3076                 24  DC-EDITB-YEAR     PIC 99.
  3077         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3078         16  DC-GREG-DATE-CYMD-R REDEFINES
  3079                              DC-GREG-DATE-CYMD.
  3080             20  DC-CYMD-CEN           PIC 99.
  3081             20  DC-CYMD-YEAR          PIC 99.
  3082             20  DC-CYMD-MONTH         PIC 99.
  3083             20  DC-CYMD-DAY           PIC 99.
  3084         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3085         16  DC-GREG-DATE-MDCY-R REDEFINES
  3086                              DC-GREG-DATE-MDCY.
  3087             20  DC-MDCY-MONTH         PIC 99.
  3088             20  DC-MDCY-DAY           PIC 99.
  3089             20  DC-MDCY-CEN           PIC 99.
  3090             20  DC-MDCY-YEAR          PIC 99.
  3091    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3092        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3093    12  DC-EL310-DATE                  PIC X(21).
  3094    12  FILLER                         PIC X(28).
  3095
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  59
* EL050.cbl
  3097*    COPY ELCCALC.
  3098******************************************************************
  3099*                                                                *
  3100*                           ELCCALC.                            *
  3101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3102*                            VMOD=2.025                          *
  3103*                                                                *
  3104*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3105*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3106*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3107*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3108*                                                                *
  3109*  PASSED TO ELRTRM                                              *
  3110*  -----------------                                             *
  3111*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3112*  ORIGINAL TERM                                                 *
  3113*  BEGINNING DATE                                                *
  3114*  ENDING DATE                                                   *
  3115*  COMPANY I.D.                                                  *
  3116*  ACCOUNT MASTER USER FIELD                                     *
  3117*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3118*  FREE LOOK DAYS                                                *
  3119*                                                                *
  3120*  RETURNED FROM ELRTRM                                          *
  3121*  ---------------------                                         *
  3122*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3123*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3124*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3125*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3126*----------------------------------------------------------------*
  3127*  PASSED TO ELRAMT                                              *
  3128*  ----------------                                              *
  3129*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3130*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3131*  ORIGINAL AMOUNT                                               *
  3132*  ALTERNATE BENEFIT (BALLON)                                    *
  3133*  A.P.R. - NET PAY ONLY                                         *
  3134*  METHOD
  3135*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3136*  COMPANY I.D.                                                  *
  3137*  BENEFIT TYPE                                                  *
  3138*                                                                *
  3139*  RETURNED FROM ELRAMT                                          *
  3140*  --------------------                                          *
  3141*  REMAINING AMOUNT 1 - CURRENT                                  *
  3142*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3143*  REMAINING AMOUNT FACTOR
  3144*----------------------------------------------------------------*
  3145*  PASSED TO ELRESV                                              *
  3146*  -----------------                                             *
  3147*  CERTIFICATE EFFECTIVE DATE                                    *
  3148*  VALUATION DATE                                                *
  3149*  PAID THRU DATE                                                *
  3150*  BENEFIT                                                       *
  3151*  INCURRED DATE                                                 *
  3152*  REPORTED DATE                                                 *
  3153*  ISSUE AGE                                                     *
  3154*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  60
* EL050.cbl
  3155*  CDT PERCENT                                                   *
  3156*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3157* *CLAIM TYPE (LIFE, A/H)                                        *
  3158* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3159* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3160*                                                                *
  3161*  RETURNED FROM ELRESV                                          *
  3162*  --------------------                                          *
  3163*  CDT TABLE USED                                                *
  3164*  CDT FACTOR USED                                               *
  3165*  PAY TO CURRENT RESERVE                                        *
  3166*  I.B.N.R. - A/H ONLY                                           *
  3167*  FUTURE (ACCRUED) AH ONLY                                      *
  3168*----------------------------------------------------------------*
  3169*  PASSED TO ELRATE                                              *
  3170*  ----------------                                              *
  3171*  CERT ISSUE DATE                                               *
  3172*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3173*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3174*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3175*  STATE CODE (CLIENT DEFINED)                                   *
  3176*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3177*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3178*  DEVIATION CODE                                                *
  3179*  ISSUE AGE                                                     *
  3180*  ORIGINAL BENEFIT AMOUNT                                       *
  3181*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3182*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3183*  BENEFIT KIND (LIFE OR A/H)                                    *
  3184*  A.P.R.                                                        *
  3185*  METHOD
  3186*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3187*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3188*  COMPANY I.D. (3 CHARACTER)                                    *
  3189*  BENEFIT CODE                                                  *
  3190*  BENEFIT OVERRIDE CODE                                         *
  3191*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3192*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3193*  JOINT INDICATOR (CSL ONLY)                                    *
  3194*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3195*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3196*                                                                *
  3197*  RETURNED FROM ELRATE                                          *
  3198*  --------------------                                          *
  3199*  CALCULATED PREMIUM                                            *
  3200*  PREMIUM RATE                                                  *
  3201*  MORTALITY CODE                                                *
  3202*  MAX ATTAINED AGE                                              *
  3203*  MAX AGE                                                       *
  3204*  MAX TERM                                                      *
  3205*  MAX MONTHLY BENEFIT                                           *
  3206*  MAX TOTAL BENIFIT                                             *
  3207*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3208*----------------------------------------------------------------*
  3209*  PASSED TO ELRFND                                              *
  3210*  ----------------                                              *
  3211*  CERT ISSUE DATE                                               *
  3212*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  61
* EL050.cbl
  3213*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3214*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3215*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3216*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3217*  STATE CODE (CLIENT DEFINED)                                   *
  3218*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3219*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3220*  DEVIATION CODE                                                *
  3221*  ISSUE AGE                                                     *
  3222*  ORIGINAL BENEFIT AMOUNT                                       *
  3223*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3224*  PROCESS TYPE (CANCEL)                                         *
  3225*  BENEFIT KIND (LIFE OR A/H)                                    *
  3226*  A.P.R.                                                        *
  3227*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3228*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3229*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3230*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3231*  COMPANY I.D. (3 CHARACTER)                                    *
  3232*  BENEFIT CODE                                                  *
  3233*  BENEFIT OVERRIDE CODE                                         *
  3234*                                                                *
  3235*  RETURNED FROM ELRFND                                          *
  3236*  --------------------                                          *
  3237*  CALCULATED REFUND                                             *
  3238*----------------------------------------------------------------*
  3239*  PASSED TO ELEARN                                              *
  3240*  ----------------                                              *
  3241*  CERT ISSUE DATE                                               *
  3242*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3243*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3244*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3245*  STATE CODE (CLIENT DEFINED)                                   *
  3246*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3247*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3248*  DEVIATION CODE                                                *
  3249*  ISSUE AGE                                                     *
  3250*  ORIGINAL BENEFIT AMOUNT                                       *
  3251*  BENEFIT KIND (LIFE OR A/H)                                    *
  3252*  A.P.R.                                                        *
  3253*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3254*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3255*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3256*  COMPANY I.D. (3 CHARACTER)                                    *
  3257*  BENEFIT CODE                                                  *
  3258*  BENEFIT OVERRIDE CODE                                         *
  3259*                                                                *
  3260*  RETURNED FROM ELEARN                                          *
  3261*  --------------------                                          *
  3262*  INDICATED  EARNINGS                                           *
  3263*----------------------------------------------------------------*
  3264*                 LENGTH = 450                                   *
  3265*                                                                *
  3266******************************************************************
  3267******************************************************************
  3268*                   C H A N G E   L O G
  3269*
  3270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  62
* EL050.cbl
  3271*-----------------------------------------------------------------
  3272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3273* EFFECTIVE    NUMBER
  3274*-----------------------------------------------------------------
  3275* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3276* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3277* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3278* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3279* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3280* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3281* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3282* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3283* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3284******************************************************************
  3285
  3286 01  CALCULATION-PASS-AREA.
  3287     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3288                                     COMP.
  3289
  3290     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3291       88  NO-CP-ERROR                             VALUE ZERO.
  3292       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3293                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3294       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3295       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3296       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3297       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3298       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3299       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3300       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3301       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3302       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3303       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3304       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3305       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3306       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3307       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3308       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3309       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3310       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3311
  3312     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3313       88  NO-CP-ERROR-2                           VALUE ZERO.
  3314***********************  INPUT AREAS ****************************
  3315
  3316     12  CP-CALCULATION-AREA.
  3317         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3318         16  CP-CERT-EFF-DT        PIC XX.
  3319         16  CP-VALUATION-DT       PIC XX.
  3320         16  CP-PAID-THRU-DT       PIC XX.
  3321         16  CP-BENEFIT-TYPE       PIC X.
  3322           88  CP-AH                               VALUE 'A' 'D'
  3323                                                   'I' 'U'.
  3324           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3325           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3326         16  CP-INCURRED-DT        PIC XX.
  3327         16  CP-REPORTED-DT        PIC XX.
  3328         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  63
* EL050.cbl
  3329         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3330         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3331                                     COMP-3.
  3332         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3333                                     COMP-3.
  3334         16  CP-CDT-METHOD         PIC X.
  3335           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3336           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3337           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3338         16  CP-CLAIM-TYPE         PIC X.
  3339           88  CP-AH-CLAIM                         VALUE 'A'.
  3340           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3341         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3342                                     COMP-3.
  3343         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3344                                     COMP-3.
  3345         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3346                                     COMP-3.
  3347         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3348                                     COMP-3.
  3349         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3350                                     COMP-3.
  3351         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3352                                     COMP-3.
  3353         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3354                                     COMP-3.
  3355         16  CP-REM-TERM-METHOD    PIC X.
  3356           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3357           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3358           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3359           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3360           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3361           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3362           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3363         16  CP-EARNING-METHOD     PIC X.
  3364           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3365           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3366           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3367           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3368           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3369           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3370           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3371           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3372           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3373           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3374           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3375           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3376           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3377           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3378         16  CP-PROCESS-TYPE       PIC X.
  3379           88  CP-CLAIM                            VALUE '1'.
  3380           88  CP-CANCEL                           VALUE '2'.
  3381           88  CP-ISSUE                            VALUE '3'.
  3382         16  CP-SPECIAL-CALC-CD    PIC X.
  3383           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3384           88  CP-1-MTH-INTEREST               VALUE ' '.
  3385           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3386           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  64
* EL050.cbl
  3387           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3388           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3389           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3390           88  CP-FARM-PLAN                    VALUE 'F'.
  3391           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3392           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3393           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3394           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3395           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3396           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3397           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3398           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3399           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3400           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3401                                                     'W' 'X'.
  3402           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3403           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3404           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3405           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3406           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3407           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3408           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3409           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3410           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3411           88  CP-CSL-METH-1                   VALUE '5'.
  3412           88  CP-CSL-METH-2                   VALUE '6'.
  3413           88  CP-CSL-METH-3                   VALUE '7'.
  3414           88  CP-CSL-METH-4                   VALUE '8'.
  3415
  3416         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3417                                     COMP-3.
  3418         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3419         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3420         16  CP-STATE              PIC XX          VALUE SPACE.
  3421         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3422         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3423           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3424               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3425         16  CP-R78-OPTION         PIC X.
  3426           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3427           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3428
  3429         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3430         16  CP-IBNR-RESERVE-SW    PIC X.
  3431         16  CP-CLAIM-STATUS       PIC X.
  3432         16  CP-RATE-FILE          PIC X.
  3433         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3434                                     COMP-3.
  3435
  3436         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3437         16  CP-AH-OVERRIDE-CODE   PIC X.
  3438
  3439         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3440                                     COMP-3.
  3441         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3442                                   PIC S9(5)V99 COMP-3.
  3443         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3444                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  65
* EL050.cbl
  3445         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3446                                     COMP-3.
  3447         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3448                                     COMP-3.
  3449         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3450                                  PIC S9(7)V99 COMP-3.
  3451
  3452         16  CP-PAID-FROM-DATE     PIC X(02).
  3453         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3454         16  CP-EXT-DAYS-CALC      PIC X.
  3455           88  CP-EXT-NO-CHG                   VALUE ' '.
  3456           88  CP-EXT-CHG-LF                   VALUE '1'.
  3457           88  CP-EXT-CHG-AH                   VALUE '2'.
  3458           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3459         16  CP-DOMICILE-STATE     PIC XX.
  3460         16  CP-CARRIER            PIC X.
  3461         16  CP-REIN-FLAG          PIC X.
  3462         16  CP-REM-TRM-CALC-OPTION PIC X.
  3463           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3464                      '2' '3' '4' '5'.
  3465           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3466           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3467           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3468           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3469           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3470           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3471           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3472           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3473         16  CP-SIG-SWITCH         PIC X.
  3474         16  CP-RATING-METHOD      PIC X.
  3475           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3476           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3477           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3478           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3479           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3480           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3481           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3482           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3483           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3484         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3485                                     COMP-3.
  3486         16  CP-BEN-CATEGORY       PIC X.
  3487         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3488         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3489                                   PIC S99V9(5) COMP-3.
  3490         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3491         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3492                                   PIC S99V9(5) COMP-3.
  3493         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3494         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3495         16  CP-EXPIRE-DT          PIC XX.
  3496         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3497         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3498         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3499         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3500         16  CP-DDF-SPEC-CALC      PIC X.
  3501             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3502             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  66
* EL050.cbl
  3503         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3504         16  CP-CANCEL-REASON      PIC X.
  3505         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3506         16  CP-PMT-MODE           PIC X.
  3507         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3508         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3509         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3510         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3511         16  FILLER                PIC X.
  3512
  3513***************    OUTPUT FROM ELRESV   ************************
  3514
  3515         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3516
  3517         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3518                                     COMP-3.
  3519         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3520                                     COMP-3.
  3521         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3524                                     COMP-3.
  3525         16  FILLER                PIC X(09).
  3526***************    OUTPUT FROM ELRTRM   *************************
  3527
  3528         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3529                                     COMP-3.
  3530         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3531                                     COMP-3.
  3532         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3533                                     COMP-3.
  3534         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3535                                     COMP-3.
  3536         16  FILLER                PIC X(12).
  3537
  3538***************    OUTPUT FROM ELRAMT   *************************
  3539
  3540         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3543                                     COMP-3.
  3544         16  FILLER                PIC X(12).
  3545
  3546***************    OUTPUT FROM ELRATE   *************************
  3547
  3548         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3549                                     COMP-3.
  3550         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-MORTALITY-CODE     PIC X(4).
  3553         16  CP-RATE-EDIT-FLAG     PIC X.
  3554             88  CP-RATES-NEED-APR                  VALUE '1'.
  3555         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3556                                     COMP-3.
  3557         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3558         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3559         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3560                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  67
* EL050.cbl
  3561         16  FILLER                PIC X(07).
  3562
  3563***************    OUTPUT FROM ELRFND   *************************
  3564
  3565         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3566                                     COMP-3.
  3567         16  CP-REFUND-TYPE-USED   PIC X.
  3568           88  CP-R-AS-R78                         VALUE '1'.
  3569           88  CP-R-AS-PRORATA                     VALUE '2'.
  3570           88  CP-R-AS-CALIF                       VALUE '3'.
  3571           88  CP-R-AS-TEXAS                       VALUE '4'.
  3572           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3573           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3574           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3575           88  CP-R-AS-MEAN                        VALUE '8'.
  3576           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3577           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3578           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3579           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3580           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3581           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3582         16  FILLER                PIC X(12).
  3583
  3584***************    OUTPUT FROM ELEARN   *************************
  3585
  3586         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3587                                     COMP-3.
  3588         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3589                                     COMP-3.
  3590         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3595                                     COMP-3.
  3596         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3597                                     COMP-3.
  3598         16  CP-EARNING-TYPE-USED  PIC X.
  3599           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3600           88  CP-E-AS-R78                         VALUE '1'.
  3601           88  CP-E-AS-PRORATA                     VALUE '2'.
  3602           88  CP-E-AS-TEXAS                       VALUE '4'.
  3603           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3604           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3605           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3606           88  CP-E-AS-MEAN                        VALUE '8'.
  3607           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3608         16  FILLER                PIC X(12).
  3609
  3610***************    OUTPUT FROM ELPMNT   *************************
  3611
  3612         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3615                                     COMP-3.
  3616         16  FILLER                PIC X(12).
  3617
  3618***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  68
* EL050.cbl
  3619         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3620                                     COMP-3.
  3621         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3624                                     COMP-3.
  3625         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3628                                     COMP-3.
  3629         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3632             88  OPEN-RATE-FILE                   VALUE 'O'.
  3633             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3634             88  IO-ERROR                         VALUE 'E'.
  3635
  3636         16  CP-FIRST-PAY-DATE     PIC XX.
  3637
  3638         16  CP-JOINT-INDICATOR    PIC X.
  3639
  3640         16  CP-RESERVE-REMAINING-TERM
  3641                                   PIC S9(4)V9    VALUE ZERO
  3642                                     COMP-3.
  3643
  3644         16  CP-INSURED-BIRTH-DT   PIC XX.
  3645
  3646         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3647                                     COMP-3.
  3648
  3649         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3650                                     COMP-3.
  3651
  3652         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3653                                     COMP-3.
  3654
  3655         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3656                                     COMP-3.
  3657
  3658         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3659                                     COMP-3.
  3660
  3661         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3662                                     COMP-3.
  3663
  3664         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3665                                     COMP-3.
  3666
  3667         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3668             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3669
  3670         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3673                                     COMP-3.
  3674         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3675         16  FILLER                PIC X(15).
  3676******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  69
* EL050.cbl
  3678******************************************************************
  3679*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3680*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3681*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3682*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3683*** MODIFICATION.                                              ***
  3684*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3685*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3686******************************************************************
  3687*    COPY ERCPNDB.
  3688******************************************************************
  3689*                                                                *
  3690*                                                                *
  3691*                            ERCPNDB.                            *
  3692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3693*                            VMOD=2.025                          *
  3694*                                                                *
  3695*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3696*                                                                *
  3697******************************************************************
  3698*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3699*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3700******************************************************************
  3701*                                                                *
  3702*                                                                *
  3703*   FILE TYPE = VSAM,KSDS                                        *
  3704*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3705*                                                                *
  3706*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3707*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3708*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3709*                                                 RKP=13,LEN=36  *
  3710*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3711*                                      AND CHG-SEQ.)             *
  3712*                                                RKP=49,LEN=11   *
  3713*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3714*                                      AND CHG-SEQ.)             *
  3715*                                                RKP=60,LEN=15   *
  3716*                                                                *
  3717*   LOG = NO                                                     *
  3718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3719******************************************************************
  3720******************************************************************
  3721*                   C H A N G E   L O G
  3722*
  3723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3724*-----------------------------------------------------------------
  3725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3726* EFFECTIVE    NUMBER
  3727*-----------------------------------------------------------------
  3728* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3729* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3730* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3731* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3732* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3733* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3734* 032306                   PEMA  ADD BOW LOAN NUMBER
  3735* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  70
* EL050.cbl
  3736* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3737* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3738* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3739* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3740* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3741* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3742* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3743******************************************************************
  3744
  3745 01  PENDING-BUSINESS.
  3746     12  PB-RECORD-ID                     PIC XX.
  3747         88  VALID-PB-ID                        VALUE 'PB'.
  3748
  3749     12  PB-CONTROL-PRIMARY.
  3750         16  PB-COMPANY-CD                PIC X.
  3751         16  PB-ENTRY-BATCH               PIC X(6).
  3752         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3753         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3754
  3755     12  PB-CONTROL-BY-ACCOUNT.
  3756         16  PB-COMPANY-CD-A1             PIC X.
  3757         16  PB-CARRIER                   PIC X.
  3758         16  PB-GROUPING.
  3759             20  PB-GROUPING-PREFIX       PIC XXX.
  3760             20  PB-GROUPING-PRIME        PIC XXX.
  3761         16  PB-STATE                     PIC XX.
  3762         16  PB-ACCOUNT.
  3763             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3764             20  PB-ACCOUNT-PRIME         PIC X(6).
  3765         16  PB-CERT-EFF-DT               PIC XX.
  3766         16  PB-CERT-NO.
  3767             20  PB-CERT-PRIME            PIC X(10).
  3768             20  PB-CERT-SFX              PIC X.
  3769         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3770
  3771         16  PB-RECORD-TYPE               PIC X.
  3772             88  PB-MAILING-DATA                VALUE '0'.
  3773             88  PB-ISSUE                       VALUE '1'.
  3774             88  PB-CANCELLATION                VALUE '2'.
  3775             88  PB-BATCH-TRAILER               VALUE '9'.
  3776
  3777     12  PB-CONTROL-BY-ORIG-BATCH.
  3778         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3779         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3780         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3781         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3782
  3783     12  PB-CONTROL-BY-CSR.
  3784         16  PB-CSR-COMPANY-CD            PIC X.
  3785         16  PB-CSR-ID                    PIC X(4).
  3786         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3787         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3788         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3789******************************************************************
  3790*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3791******************************************************************
  3792
  3793     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  71
* EL050.cbl
  3794     12  PB-LAST-MAINT-BY                 PIC X(4).
  3795     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3796
  3797     12  PB-RECORD-BODY                   PIC X(375).
  3798
  3799     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3800         16  PB-CERT-ORIGIN               PIC X.
  3801             88  CLASIC-CREATED-CERT         VALUE '1'.
  3802         16  PB-I-NAME.
  3803             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3804             20  PB-I-INSURED-FIRST-NAME.
  3805                 24  PB-I-INSURED-1ST-INIT PIC X.
  3806                 24  FILLER                PIC X(9).
  3807             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3808         16  PB-I-AGE                     PIC S99   COMP-3.
  3809         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3810         16  PB-I-BIRTHDAY                PIC XX.
  3811         16  PB-I-INSURED-SEX             PIC X.
  3812             88  PB-SEX-MALE     VALUE 'M'.
  3813             88  PB-SEX-FEMALE   VALUE 'F'.
  3814
  3815         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3816         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3817         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3818         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3819         16  PB-I-SKIP-CODE               PIC X.
  3820             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3821             88  PB-SKIP-JULY              VALUE '1'.
  3822             88  PB-SKIP-AUGUST            VALUE '2'.
  3823             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3824             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3825             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3826             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3827             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3828             88  PB-SKIP-JUNE              VALUE '8'.
  3829             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3830             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3831             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3832         16  PB-I-TERM-TYPE               PIC X.
  3833             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3834             88  PB-PAID-WEEKLY            VALUE 'W'.
  3835             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3836             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3837             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3838         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3839         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3840         16  PB-I-DATA-ENTRY-SW           PIC X.
  3841             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3842             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3843             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3844             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3845         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3846         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3847*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3848         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3849         16  FILLER                       PIC X.
  3850
  3851         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  72
* EL050.cbl
  3852             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3853             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3854                                                   '90' THRU '99'.
  3855         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3856                                          PIC XX.
  3857         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3858         16  PB-I-AMOUNT-FINANCED REDEFINES
  3859                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3860         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3861         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3862                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3863         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3864         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3865         16  PB-I-CLP-AMOUNT REDEFINES
  3866                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3867         16  PB-I-LF-CALC-FLAG            PIC X.
  3868             88 PB-COMP-LF-PREM               VALUE '?'.
  3869         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3870         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3871         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3872         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3873         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3874         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3875         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3876         16  PB-I-LF-ABBR                 PIC XXX.
  3877         16  PB-I-LF-INPUT-CD             PIC XX.
  3878
  3879         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3880             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3881             88  PB-INVALID-AH               VALUE '  ' '00'
  3882                                                   '90' THRU '99'.
  3883         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3884         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3885         16  PB-I-AH-CALC-FLAG            PIC X.
  3886             88 PB-COMP-AH-PREM                  VALUE '?'.
  3887         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3888         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3889         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3890         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3891         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3892         16  PB-I-AH-ABBR                 PIC XXX.
  3893         16  PB-I-AH-INPUT-CD             PIC XXX.
  3894
  3895         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3896         16  PB-I-REIN-TABLE              PIC XXX.
  3897         16  PB-I-BUSINESS-TYPE           PIC 99.
  3898         16  PB-I-INDV-GRP-CD             PIC X.
  3899         16  PB-I-MORT-CODE.
  3900             20  PB-I-TABLE               PIC X.
  3901             20  PB-I-INTEREST            PIC XX.
  3902             20  PB-I-MORT-TYP            PIC X.
  3903         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3904         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3905         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3906         16  PB-I-INDV-GRP-OVRD           PIC X.
  3907         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3908         16  PB-I-SIG-SW                  PIC X.
  3909             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  73
* EL050.cbl
  3910         16  PB-I-RATE-CLASS              PIC XX.
  3911         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3912         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3913         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3914         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3915         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3916         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3917         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3918         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3919         16  PB-I-OB-FLAG                 PIC X.
  3920             88  PB-I-OB                      VALUE 'B'.
  3921             88  PB-I-SUMMARY                 VALUE 'Z'.
  3922         16  PB-I-ENTRY-STATUS            PIC X.
  3923             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3924                                              'M' '5' '9' '2'.
  3925             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3926             88  PB-I-POLICY-PENDING          VALUE '2'.
  3927             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3928             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3929             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3930             88  PB-I-REIN-ONLY               VALUE '9'.
  3931             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3932             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3933             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3934             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3935         16  PB-I-INT-CODE                PIC X.
  3936             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3937             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3938         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3939         16  PB-I-SOC-SEC-NO              PIC X(11).
  3940         16  PB-I-MEMBER-NO               PIC X(12).
  3941         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3942*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3943         16  PB-I-OLD-LOF                 PIC XXX.
  3944         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3945         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3946         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3947         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3948         16  PB-I-LIFE-INDICATOR          PIC X.
  3949             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3950         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3951         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3952                                          PIC S9(5)V99    COMP-3.
  3953         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3954             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3955             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3956         16  PB-I-1ST-PMT-DT              PIC XX.
  3957         16  PB-I-JOINT-INSURED.
  3958             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3959             20 PB-I-JOINT-FIRST-NAME.
  3960                24  PB-I-JOINT-FIRST-INIT PIC X.
  3961                24  FILLER                PIC X(9).
  3962             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3963*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3964         16  PB-I-BENEFICIARY-NAME.
  3965             20  PB-I-BANK-NUMBER         PIC X(10).
  3966             20  FILLER                   PIC X(15).
  3967         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  74
* EL050.cbl
  3968         16  PB-I-REFERENCE               PIC X(12).
  3969         16  FILLER REDEFINES PB-I-REFERENCE.
  3970             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3971             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3972             20  PB-I-CLP-STATE           PIC XX.
  3973         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3974             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3975             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3976             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3977         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3978         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3979         16  PB-I-RESIDENT-STATE          PIC XX.
  3980         16  PB-I-RATE-CODE               PIC X(4).
  3981         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3982         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3983         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3984         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3985         16  PB-I-BANK-NOCHRGB            PIC 99.
  3986         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3987         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3988
  3989     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3990         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3991             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3992         16  PB-C-CANCEL-ORIGIN           PIC X.
  3993             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3994         16  PB-C-LF-CANCEL-DT            PIC XX.
  3995         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3996         16  PB-C-LF-CALC-REQ             PIC X.
  3997             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3998         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3999         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4000         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4001             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4002         16  PB-C-AH-CANCEL-DT            PIC XX.
  4003         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4004         16  PB-C-AH-CALC-REQ             PIC X.
  4005             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4006         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4007         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4008         16  PB-C-LAST-NAME               PIC X(15).
  4009         16  PB-C-REFUND-SW               PIC X.
  4010             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4011             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4012         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4013         16  PB-C-PAYEE-CODE              PIC X(6).
  4014         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4015         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4016         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4017         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4018         16  PB-C-REFERENCE               PIC X(12).
  4019         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4020         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4021         16  PB-C-POST-CARD-IND           PIC X.
  4022         16  PB-C-CANCEL-REASON           PIC X.
  4023         16  PB-C-REF-INTERFACE-SW        PIC X.
  4024         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4025         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  75
* EL050.cbl
  4026         16  FILLER                       PIC X(01).
  4027*        16  FILLER                       PIC X(18).
  4028         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4029*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4030         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4031         16  PB-CANCELED-CERT-DATA.
  4032             20  PB-CI-INSURED-NAME.
  4033                 24  PB-CI-LAST-NAME      PIC X(15).
  4034                 24  PB-CI-INITIALS       PIC XX.
  4035             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4036             20  PB-CI-INSURED-SEX        PIC X.
  4037             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4038             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4039             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4040             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4041             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4042             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4043             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4044             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4045             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4046             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4047             20  PB-CI-RATE-CLASS         PIC XX.
  4048             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4049             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4050             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4051             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4052             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4053             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4054             20  PB-CI-LF-ABBR            PIC X(3).
  4055             20  PB-CI-AH-ABBR            PIC X(3).
  4056             20  PB-CI-OB-FLAG            PIC X.
  4057                 88  PB-CI-OB                VALUE 'B'.
  4058             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4059                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4060                                           'M' '4' '5' '9' '2'.
  4061                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4062                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4063                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4064                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4065                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4066                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4067                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4068                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4069                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4070                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4071                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4072                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4073             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4074                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4075                                           'M' '4' '5' '9' '2'.
  4076                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4077                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4078                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4079                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4080                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4081                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4082                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4083                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  76
* EL050.cbl
  4084                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4085                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4086                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4087                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4088             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4089             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4090             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4091             20  PB-CI-MEMBER-NO          PIC X(12).
  4092             20  PB-CI-INT-CODE           PIC X.
  4093                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4094                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4095             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4096             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4097             20  PB-CI-COMP-EXCP-SW       PIC X.
  4098                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4099                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4100             20  PB-CI-ENTRY-STATUS       PIC X.
  4101             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4102             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4103             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4104             20  PB-CI-DEATH-DT           PIC XX.
  4105             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4106             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4107             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4108             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4109             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4110             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4111             20  PB-CI-ENTRY-DT              PIC XX.
  4112             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4113             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4114             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4115             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4116             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4117             20  PB-CI-OLD-LOF               PIC XXX.
  4118*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4119             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4120             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4121             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4122             20  PB-CI-INDV-GRP-CD           PIC X.
  4123             20  PB-CI-BENEFICIARY-NAME.
  4124                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4125                 24  FILLER                  PIC X(15).
  4126             20  PB-CI-NOTE-SW               PIC X.
  4127             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4128             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4129             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4130             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4131             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4132             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4133             20  PB-CI-FIRST-NAME            PIC X(10).
  4134             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4135
  4136         16  FILLER                       PIC X(13).
  4137*032306  16  FILLER                       PIC X(27).
  4138*        16  FILLER                       PIC X(46).
  4139
  4140     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4141         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  77
* EL050.cbl
  4142         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4143         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4144         16  PB-M-INSURED-MID-INIT        PIC X.
  4145         16  PB-M-INSURED-AGE             PIC 99.
  4146         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4147         16  PB-M-INSURED-SEX             PIC X.
  4148         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4149         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4150         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4151         16  PB-M-INSURED-CITY-STATE.
  4152             20  PB-M-INSURED-CITY        PIC X(28).
  4153             20  PB-M-INSURED-STATE       PIC XX.
  4154         16  PB-M-INSURED-ZIP-CODE.
  4155             20  PB-M-INSURED-ZIP-PRIME.
  4156                 24  PB-M-INSURED-ZIP-1   PIC X.
  4157                     88  PB-M-CANADIAN-POST-CODE
  4158                                             VALUE 'A' THRU 'Z'.
  4159                 24  FILLER               PIC X(4).
  4160             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4161         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4162                                        PB-M-INSURED-ZIP-CODE.
  4163             20  PM-M-INS-CAN-POST1       PIC XXX.
  4164             20  PM-M-INS-CAN-POST2       PIC XXX.
  4165             20  FILLER                   PIC XXX.
  4166         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4167         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4168         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4169         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4170         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4171         16  PB-M-CRED-BENE-CITYST.
  4172             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4173             20  PB-M-CRED-BENE-STATE     PIC XX.
  4174         16  FILLER                       PIC X(92).
  4175
  4176     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4177         16  FILLER                       PIC X(10).
  4178         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4179         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4180         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4181         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4182         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4183         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4184         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4185         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4186         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4187         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4188         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4189         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4190         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4191         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4192         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4193         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4194         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4195         16  PB-ACCOUNT-NAME              PIC X(30).
  4196         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4197         16  PB-REFERENCE                 PIC X(12).
  4198         16  PB-B-RECEIVED-DT             PIC XX.
  4199         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  78
* EL050.cbl
  4200
  4201     12  PB-RECORD-STATUS.
  4202         16  PB-CREDIT-SELECT-DT          PIC XX.
  4203         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4204         16  PB-BILLED-DT                 PIC XX.
  4205         16  PB-BILLING-STATUS            PIC X.
  4206             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4207             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4208             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4209         16  PB-RECORD-BILL               PIC X.
  4210             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4211             88  PB-RECORD-RETURNED           VALUE 'R'.
  4212             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4213             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4214             88  PB-OVERRIDE-AH               VALUE 'A'.
  4215             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4216         16  PB-BATCH-ENTRY               PIC X.
  4217             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4218             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4219             88  PB-REISSUED-CERT             VALUE 'E'.
  4220             88  PB-MONTHLY-CERT              VALUE 'M'.
  4221             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4222             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4223             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4224         16  PB-FORCE-CODE                PIC X.
  4225             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4226             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4227             88  PB-CANCEL-FORCE              VALUE '8'.
  4228             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4229             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4230             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4231             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4232             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4233             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4234             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4235         16  PB-FATAL-FLAG                PIC X.
  4236             88  PB-FATAL-ERRORS              VALUE 'X'.
  4237         16  PB-FORCE-ER-CD               PIC X.
  4238             88  PB-FORCE-ERRORS              VALUE 'F'.
  4239             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4240         16  PB-WARN-ER-CD                PIC X.
  4241             88  PB-WARNING-ERRORS            VALUE 'W'.
  4242         16  FILLER                       PIC X.
  4243         16  PB-OUT-BAL-CD                PIC X.
  4244             88  PB-OUT-OF-BAL                VALUE 'O'.
  4245         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4246         16  PB-AH-OVERRIDE-L1            PIC X.
  4247         16  PB-INPUT-DT                  PIC XX.
  4248         16  PB-INPUT-BY                  PIC X(4).
  4249         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4250         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4251         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4252         16  PB-LF-EARNING-METHOD         PIC X.
  4253         16  PB-AH-EARNING-METHOD         PIC X.
  4254         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4255         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4256         16  PB-REIN-CD                   PIC XXX.
  4257         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  79
* EL050.cbl
  4258         16  PB-AH-REFUND-TYPE            PIC X.
  4259         16  PB-ACCT-EFF-DT               PIC XX.
  4260         16  PB-ACCT-EXP-DT               PIC XX.
  4261         16  PB-COMPANY-ID                PIC X(3).
  4262         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4263         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4264         16  PB-SV-CARRIER                PIC X.
  4265         16  PB-SV-GROUPING               PIC X(6).
  4266         16  PB-SV-STATE                  PIC XX.
  4267         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4268         16  PB-GA-BILLING-INFO.
  4269             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4270                                          PIC XX.
  4271         16  PB-SV-REMIT-TO  REDEFINES
  4272             PB-GA-BILLING-INFO           PIC X(10).
  4273         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4274         16  PB-I-LOAN-OFFICER            PIC X(5).
  4275         16  PB-I-VIN                     PIC X(17).
  4276
  4277         16  FILLER                       PIC X(04).
  4278         16  IMNET-BYPASS-SW              PIC X.
  4279
  4280******************************************************************
  4281*                COMMON EDIT ERRORS                              *
  4282******************************************************************
  4283
  4284     12  PB-COMMON-ERRORS.
  4285         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4286                                           PIC S9(4)     COMP.
  4287
  4288******************************************************************
  4289
  4290* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4291*    COPY ELC50W1.
  4292******************************************************************
  4293*                                                                *
  4294*                                                                *
  4295*                             ELC50W1                            *
  4296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4297*                            VMOD=2.004                          *
  4298*                                                                *
  4299*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4300*                                                                *
  4301*                                                                *
  4302******************************************************************
  4303
  4304     12  WK-WORK-AREA.
  4305         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4306         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4307         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4308         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4309         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4310         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4311         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4312         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4313         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4314         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4315         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  80
* EL050.cbl
  4316         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4317         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4318         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4319         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4320         16  WK-CREDIT-EDIT-CONTROLS.
  4321             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4322             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4323             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4324             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4325             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4326             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4327         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4328         16  WK-SAVE-REIN-DATA.
  4329             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4330             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4331             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4332         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4333             88  ENTRY-FROM-EL6311       VALUE '6'.
  4334         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4335         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4336     12  WK-RECORD-ADDRESSES.
  4337         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4338         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4339         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4340         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4341         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4342         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4343         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4344         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4345     12  WK-OVER-SHORT-AREA.
  4346         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4347         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4348         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4349             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4350         16  FILLER                   PIC X(5) VALUE SPACES.
  4351
  4352*    COPY ELCEDITC.
  4353******************************************************************
  4354*                                                                *
  4355*                                                                *
  4356*                            ELCEDITC                            *
  4357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4358*                            VMOD=2.012                          *
  4359*                                                                *
  4360*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4361*                     EL6313, EL050 AND EL517.                   *
  4362*                                                                *
  4363******************************************************************
  4364******************************************************************
  4365*                   C H A N G E   L O G
  4366*
  4367* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4368*-----------------------------------------------------------------
  4369*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4370* EFFECTIVE    NUMBER
  4371*-----------------------------------------------------------------
  4372* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4373******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  81
* EL050.cbl
  4374
  4375     12  EDIT-CRITERIA-DATA.
  4376         16  EC-CO-MONTH-END-DT       PIC XX.
  4377         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4378         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4379         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4380         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4381         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4382         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4383         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4384         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4385         16  EC-CO-REM-TERM-CALC      PIC X.
  4386               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4387               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4388               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4389               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4390
  4391         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4392               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4393               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4394               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4395               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4396               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4397               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4398               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4399               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4400               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4401               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4402
  4403         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4404               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4405               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4406               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4407               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4408               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4409               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4410               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4411               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4412
  4413         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4414                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4415                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4416
  4417         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4418                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4419                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4420                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4421                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4422                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4423                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4424                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4425                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4426
  4427         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4428               88  EC-BR-REDUCING                   VALUE 'R'.
  4429               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4430
  4431         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  82
* EL050.cbl
  4432         16  EC-BR-LF-DESC             PIC X(10).
  4433         16  EC-BR-AH-DESC             PIC X(10).
  4434         16  EC-BR-LF-COMMENT          PIC X(10).
  4435         16  EC-BR-AH-COMMENT          PIC X(10).
  4436
  4437         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4438               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4439               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4440               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4441               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4442
  4443         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4444               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4445               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4446               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4447               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4448
  4449         16  EC-BR-LF-REFUND-CALC      PIC X.
  4450                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4451                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4452                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4453                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4454                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4455                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4456                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4457
  4458         16  EC-BR-AH-REFUND-CALC      PIC X.
  4459                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4460                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4461                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4462                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4463                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4464                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4465                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4466                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4467
  4468         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4469                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4470                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4471                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4472
  4473         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4474                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4475                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4476                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4477
  4478         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4479         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4480         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4481         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4482
  4483         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4484         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4485                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4486                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4487                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4488                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4489
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  83
* EL050.cbl
  4490         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4491               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4492               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4493               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4494               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4495               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4496
  4497         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4498               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4499               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4500               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4501               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4502               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4503
  4504         16  EC-ST-LF-REFUND-CALC      PIC X.
  4505                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4506                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4507                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4508                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4509                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4510                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4511                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4512                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4513
  4514         16  EC-ST-AH-REFUND-CALC      PIC X.
  4515                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4516                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4517                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4518                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4519                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4520                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4521                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4522                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4523
  4524         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4525         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4526         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4527         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4528         16  EC-AM-EXPIRATION-DT       PIC XX.
  4529         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4530         16  EC-AM-CLASS-CD            PIC XX.
  4531         16  EC-AM-LF-DEVIATION        PIC XXX.
  4532         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4533         16  EC-AM-AH-DEVIATION        PIC XXX.
  4534         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4535         16  EC-AM-PHONE-NO            PIC X(10).
  4536
  4537         16  EC-AM-LF-REFUND-CALC      PIC X.
  4538                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4539                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4540                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4541                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4542                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4543                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4544                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4545
  4546         16  EC-AM-AH-REFUND-CALC      PIC X.
  4547                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  84
* EL050.cbl
  4548                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4549                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4550                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4551                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4552                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4553                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4554
  4555         16  EC-AM-BEN-I-G-CD          PIC X.
  4556                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4557                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4558                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4559
  4560         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4561         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4562         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4563         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4564         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4565         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4566         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4567         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4568         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4569
  4570         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4571         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4572         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4573         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4574         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4575         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4576         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4577         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4578         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4579         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4580         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4581         16  EC-RT-LF-NSP-ST           PIC XX.
  4582         16  EC-RT-AH-NSP-ST           PIC XX.
  4583         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4584         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4585
  4586         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4587             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4588                                             'M' '5' '9' '2'.
  4589             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4590             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4591             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4592             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4593             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4594             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4595             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4596             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4597             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4598             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4599
  4600         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4601             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4602                                             'M' '5' '9' '2'.
  4603             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4604             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4605             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  85
* EL050.cbl
  4606             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4607             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4608             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4609             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4610             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4611             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4612             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4613
  4614         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4615         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4616         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4617         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4618         16  EC-CM-DEATH-DT            PIC XX.
  4619
  4620*DMD CUSTOM CODING FIELDS BELOW
  4621*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4622         16  EC-BR-DMD-RATING-SW       PIC X.
  4623                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4624                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4625                 88  NO-DMD-RATING               VALUE 'N'.
  4626
  4627         16  EC-NEW-CERT               PIC X(11).
  4628         16  EC-NEW-STATE              PIC XX.
  4629         16  FILLER                    PIC X.
  4630*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4631         16  OVER-SHORT-EDIT-FIELDS.
  4632             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4633             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4634             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4635             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4636             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4637             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4638             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4639             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4640             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4641         16  FILLER                    PIC X(71).
  4642******************************************************************
  4643
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  86
* EL050.cbl
  4645*    COPY ELCDIFRD.
  4646******************************************************************
  4647*                                                                *
  4648*                                                                *
  4649*                            ELCDIFRD.                           *
  4650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4651*                            VMOD=2.004                          *
  4652*                                                                *
  4653*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4654*                                                                *
  4655******************************************************************
  4656*
  4657  01  WS-DIFFERENCE-CALCULATION.
  4658        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4659        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4660        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4661        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4662        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4663        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4664        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4665        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4666        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4667        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4668        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4669
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  87
* EL050.cbl
  4671****************************************************************
  4672*
  4673* Copyright (c) 2007 by Clerity Solutions, Inc.
  4674* All rights reserved.
  4675*
  4676****************************************************************
  4677 01  DFHEIV.
  4678   02  DFHEIV0               PIC X(35).
  4679   02  DFHEIV1               PIC X(08).
  4680   02  DFHEIV2               PIC X(08).
  4681   02  DFHEIV3               PIC X(08).
  4682   02  DFHEIV4               PIC X(06).
  4683   02  DFHEIV5               PIC X(04).
  4684   02  DFHEIV6               PIC X(04).
  4685   02  DFHEIV7               PIC X(02).
  4686   02  DFHEIV8               PIC X(02).
  4687   02  DFHEIV9               PIC X(01).
  4688   02  DFHEIV10              PIC S9(7) COMP-3.
  4689   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4690   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4691   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4692   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4693   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4694   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4695   02  DFHEIV17              PIC X(04).
  4696   02  DFHEIV18              PIC X(04).
  4697   02  DFHEIV19              PIC X(04).
  4698   02  DFHEIV20              USAGE IS POINTER.
  4699   02  DFHEIV21              USAGE IS POINTER.
  4700   02  DFHEIV22              USAGE IS POINTER.
  4701   02  DFHEIV23              USAGE IS POINTER.
  4702   02  DFHEIV24              USAGE IS POINTER.
  4703   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4704   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4705   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4706   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4707   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4708   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4709   02  FILLER                PIC X(02).
  4710   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4711   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4712   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4713   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4714   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4715 LINKAGE  SECTION.
  4716*****************************************************************
  4717*                                                               *
  4718* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4719* All rights reserved.                                          *
  4720*                                                               *
  4721*****************************************************************
  4722 01  dfheiblk.
  4723     02  eibtime          pic s9(7) comp-3.
  4724     02  eibdate          pic s9(7) comp-3.
  4725     02  eibtrnid         pic x(4).
  4726     02  eibtaskn         pic s9(7) comp-3.
  4727     02  eibtrmid         pic x(4).
  4728     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  88
* EL050.cbl
  4729     02  eibcposn         pic s9(4) comp.
  4730     02  eibcalen         pic s9(4) comp.
  4731     02  eibaid           pic x(1).
  4732     02  eibfiller1       pic x(1).
  4733     02  eibfn            pic x(2).
  4734     02  eibfiller2       pic x(2).
  4735     02  eibrcode         pic x(6).
  4736     02  eibfiller3       pic x(2).
  4737     02  eibds            pic x(8).
  4738     02  eibreqid         pic x(8).
  4739     02  eibrsrce         pic x(8).
  4740     02  eibsync          pic x(1).
  4741     02  eibfree          pic x(1).
  4742     02  eibrecv          pic x(1).
  4743     02  eibsend          pic x(1).
  4744     02  eibatt           pic x(1).
  4745     02  eibeoc           pic x(1).
  4746     02  eibfmh           pic x(1).
  4747     02  eibcompl         pic x(1).
  4748     02  eibsig           pic x(1).
  4749     02  eibconf          pic x(1).
  4750     02  eiberr           pic x(1).
  4751     02  eibrldbk         pic x(1).
  4752     02  eiberrcd         pic x(4).
  4753     02  eibsynrb         pic x(1).
  4754     02  eibnodat         pic x(1).
  4755     02  eibfiller5       pic x(2).
  4756     02  eibresp          pic 9(09) comp.
  4757     02  eibresp2         pic 9(09) comp.
  4758     02  dfheigdj         pic s9(4) comp.
  4759     02  dfheigdk         pic s9(4) comp.
  4760
  4761 01  DFHCOMMAREA                   PIC X(1036).
  4762
  4763*01 PARMLIST .
  4764*    02  FILLER                    PIC S9(8)   COMP.
  4765*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4766*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4767*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4768*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4769*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4770*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4771*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4772
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  89
* EL050.cbl
  4774*    COPY ELCCNTL.
  4775******************************************************************
  4776*                                                                *
  4777*                                                                *
  4778*                            ELCCNTL.                            *
  4779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4780*                            VMOD=2.059                          *
  4781*                                                                *
  4782*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4783*                                                                *
  4784*   FILE TYPE = VSAM,KSDS                                        *
  4785*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4786*                                                                *
  4787*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4788*       ALTERNATE INDEX = NONE                                   *
  4789*                                                                *
  4790*   LOG = YES                                                    *
  4791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4792******************************************************************
  4793*                   C H A N G E   L O G
  4794*
  4795* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4796*-----------------------------------------------------------------
  4797*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4798* EFFECTIVE    NUMBER
  4799*-----------------------------------------------------------------
  4800* 082503                   PEMA  ADD BENEFIT GROUP
  4801* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4802* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4803* 092705    2005050300006  PEMA  ADD SPP LEASES
  4804* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4805* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4806* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4807* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4808* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4809******************************************************************
  4810*
  4811 01  CONTROL-FILE.
  4812     12  CF-RECORD-ID                       PIC XX.
  4813         88  VALID-CF-ID                        VALUE 'CF'.
  4814
  4815     12  CF-CONTROL-PRIMARY.
  4816         16  CF-COMPANY-ID                  PIC XXX.
  4817         16  CF-RECORD-TYPE                 PIC X.
  4818             88  CF-COMPANY-MASTER              VALUE '1'.
  4819             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4820             88  CF-STATE-MASTER                VALUE '3'.
  4821             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4822             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4823             88  CF-CARRIER-MASTER              VALUE '6'.
  4824             88  CF-MORTALITY-MASTER            VALUE '7'.
  4825             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4826             88  CF-TERMINAL-MASTER             VALUE '9'.
  4827             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4828             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4829             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4830             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4831             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  90
* EL050.cbl
  4832             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4833             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4834             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4835             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4836         16  CF-ACCESS-CD-GENL              PIC X(4).
  4837         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4838             20  CF-PROCESSOR               PIC X(4).
  4839         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4840             20  CF-STATE-CODE              PIC XX.
  4841             20  FILLER                     PIC XX.
  4842         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4843             20  FILLER                     PIC XX.
  4844             20  CF-HI-BEN-IN-REC           PIC XX.
  4845         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4846             20  FILLER                     PIC XXX.
  4847             20  CF-CARRIER-CNTL            PIC X.
  4848         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4849             20  FILLER                     PIC XX.
  4850             20  CF-HI-TYPE-IN-REC          PIC 99.
  4851         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4853                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4854             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4855             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4856         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4857             20  FILLER                     PIC X.
  4858             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4859         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4860             20  FILLER                     PIC XX.
  4861             20  CF-MORTGAGE-PLAN           PIC XX.
  4862         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4863
  4864     12  CF-LAST-MAINT-DT                   PIC XX.
  4865     12  CF-LAST-MAINT-BY                   PIC X(4).
  4866     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4867
  4868     12  CF-RECORD-BODY                     PIC X(728).
  4869
  4870
  4871****************************************************************
  4872*             COMPANY MASTER RECORD                            *
  4873****************************************************************
  4874
  4875     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4876         16  CF-COMPANY-ADDRESS.
  4877             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4878             20  CF-CL-IN-CARE-OF           PIC X(30).
  4879             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4880             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4881             20  CF-CL-CITY-STATE           PIC X(30).
  4882             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4883             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4884         16  CF-COMPANY-CD                  PIC X.
  4885         16  CF-COMPANY-PASSWORD            PIC X(8).
  4886         16  CF-SECURITY-OPTION             PIC X.
  4887             88  ALL-SECURITY                   VALUE '1'.
  4888             88  COMPANY-VERIFY                 VALUE '2'.
  4889             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  91
* EL050.cbl
  4890             88  NO-SECURITY                    VALUE '4'.
  4891             88  ALL-BUT-TERM                   VALUE '5'.
  4892         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4893             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4894         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4895             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4896         16  CF-INFORCE-LOCATION            PIC X.
  4897             88  CERTS-ARE-ONLINE               VALUE '1'.
  4898             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4899             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4900         16  CF-LOWER-CASE-LETTERS          PIC X.
  4901         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4902             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4903             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4904             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4905             88  CF-ACCNT-CNTL                  VALUE '3'.
  4906             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4907
  4908         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4909         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4910
  4911         16  CF-LGX-CREDIT-USER             PIC X.
  4912             88  CO-IS-NOT-USER                 VALUE 'N'.
  4913             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4914
  4915         16 CF-CREDIT-CALC-CODES.
  4916             20  CF-CR-REM-TERM-CALC PIC X.
  4917               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4918               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4919               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4920               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4921               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4922               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4923               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4924             20  CF-CR-R78-METHOD           PIC X.
  4925               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4926               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4927
  4928         16  CF-CLAIM-CONTROL-COUNTS.
  4929             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4930                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4931
  4932             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4933                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4934
  4935             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4936                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4937
  4938             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4939                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4940
  4941         16  CF-CURRENT-MONTH-END           PIC XX.
  4942
  4943         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4944             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4945             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4946             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4947             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  92
* EL050.cbl
  4948                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4949                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4950             20  CF-CO-PREM-REJECT-SW       PIC X.
  4951                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4952                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4953             20  CF-CO-REF-REJECT-SW        PIC X.
  4954                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4955                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4956
  4957         16  CF-CO-REPORTING-DT             PIC XX.
  4958         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4959         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4960           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4961           88  CF-CO-MONTH-END                  VALUE '1'.
  4962
  4963         16  CF-LGX-CLAIM-USER              PIC X.
  4964             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4965             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4966
  4967         16  CF-CREDIT-EDIT-CONTROLS.
  4968             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4969             20  CF-MIN-AGE                 PIC 99.
  4970             20  CF-DEFAULT-AGE             PIC 99.
  4971             20  CF-MIN-TERM                PIC S999      COMP-3.
  4972             20  CF-MAX-TERM                PIC S999      COMP-3.
  4973             20  CF-DEFAULT-SEX             PIC X.
  4974             20  CF-JOINT-AGE-INPUT         PIC X.
  4975                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4976             20  CF-BIRTH-DATE-INPUT        PIC X.
  4977                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4978             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4979                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4980                 88  CF-ZERO-CARRIER            VALUE '1'.
  4981                 88  CF-ZERO-GROUPING           VALUE '2'.
  4982                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4983             20  CF-EDIT-SW                 PIC X.
  4984                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4985             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4986             20  CF-CR-PR-METHOD            PIC X.
  4987               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4988               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4989             20  FILLER                     PIC X.
  4990
  4991         16  CF-CREDIT-MISC-CONTROLS.
  4992             20  CF-REIN-TABLE-SW           PIC X.
  4993                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4994             20  CF-COMP-TABLE-SW           PIC X.
  4995                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4996             20  CF-EXPERIENCE-RETENTION-AGE
  4997                                            PIC S9        COMP-3.
  4998             20  CF-CONVERSION-DT           PIC XX.
  4999             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5000             20  CF-RUN-FREQUENCY-SW        PIC X.
  5001                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5002                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5003
  5004             20  CF-CR-CHECK-NO-CONTROL.
  5005                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  93
* EL050.cbl
  5006                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5007                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5008                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5009                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5010                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5011
  5012                 24  CF-CR-CHECK-COUNT       REDEFINES
  5013                     CF-CR-CHECK-COUNTER      PIC X(4).
  5014
  5015                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5016                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5017
  5018                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5019                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5020                 24  CF-MAIL-PROCESSING       PIC X.
  5021                     88  MAIL-PROCESSING          VALUE 'Y'.
  5022
  5023         16  CF-MISC-SYSTEM-CONTROL.
  5024             20  CF-SYSTEM-C                 PIC X.
  5025                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5026             20  CF-SYSTEM-D                 PIC X.
  5027                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5028             20  CF-SOC-SEC-NO-SW            PIC X.
  5029                 88  SOC-SEC-NO-USED             VALUE '1'.
  5030             20  CF-MEMBER-NO-SW             PIC X.
  5031                 88  MEMBER-NO-USED              VALUE '1'.
  5032             20  CF-TAX-ID-NUMBER            PIC X(11).
  5033             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5034             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5035                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5036                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5037                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5038                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5039             20  CF-SYSTEM-E                 PIC X.
  5040                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5041
  5042         16  CF-LGX-LIFE-USER               PIC X.
  5043             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5044             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5045
  5046         16  CF-CR-MONTH-END-DT             PIC XX.
  5047
  5048         16  CF-FILE-MAINT-DATES.
  5049             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5050                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5051             20  CF-LAST-BATCH       REDEFINES
  5052                 CF-LAST-BATCH-NO               PIC X(4).
  5053             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5054             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5055             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5056             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5057             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5058             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5059             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5060             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5061             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5062             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5063
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  94
* EL050.cbl
  5064         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5065         16  FILLER                         PIC X.
  5066
  5067         16  CF-ALT-MORT-CODE               PIC X(4).
  5068         16  CF-MEMBER-CAPTION              PIC X(10).
  5069
  5070         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5071             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5072             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5073             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5074             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5075             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5076
  5077         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5078
  5079         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5080         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5081         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5082         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5083
  5084         16  CF-AH-OVERRIDE-L1              PIC X.
  5085         16  CF-AH-OVERRIDE-L2              PIC XX.
  5086         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5087         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5088
  5089         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5090         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5091
  5092         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5093         16  CF-AR-LAST-EL860-DT            PIC XX.
  5094         16  CF-MP-MONTH-END-DT             PIC XX.
  5095
  5096         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5097         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5098             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5099
  5100         16  CF-AR-MONTH-END-DT             PIC XX.
  5101
  5102         16  CF-CRDTCRD-USER                PIC X.
  5103             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5104             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5105
  5106         16  CF-CC-MONTH-END-DT             PIC XX.
  5107
  5108         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5109
  5110         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5111             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5112             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5113             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5114         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5115         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5116         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5117         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5118             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5119             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5120         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5121         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  95
* EL050.cbl
  5122         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5123             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5124         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5125
  5126         16  CF-CL-ZIP-CODE.
  5127             20  CF-CL-ZIP-PRIME.
  5128                 24  CF-CL-ZIP-1ST          PIC X.
  5129                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5130                 24  FILLER                 PIC X(4).
  5131             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5132         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5133             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5134             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5135             20  FILLER                     PIC XXX.
  5136
  5137         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5138         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5139         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5140         16  CF-CO-OPTION-START-DATE        PIC XX.
  5141         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5142           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5143                                                      '3' '4'.
  5144           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5145           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5146           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5147           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5148           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5149           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5150
  5151         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5152
  5153         16  CF-PAYMENT-APPROVAL-LEVELS.
  5154             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5155             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5156             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5157             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5158             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5159             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5160
  5161         16  CF-END-USER-REPORTING-USER     PIC X.
  5162             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5163             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5164
  5165         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5166             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5167             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5168
  5169         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5170
  5171         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5172         16  FILLER                         PIC X.
  5173
  5174         16  CF-CREDIT-ARCHIVE-CNTL.
  5175             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5176             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5177             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5178
  5179         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  96
* EL050.cbl
  5180
  5181         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5182             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5183             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5184
  5185         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5186             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5187             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5188
  5189         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5190
  5191         16  CF-CO-ACH-ID-CODE              PIC  X.
  5192             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5193             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5194             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5195         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5196         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5197         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5198         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5199         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5200         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5201         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5202         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5203         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5204                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5205         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5206                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5207
  5208         16  CF-CO-OVER-SHORT.
  5209             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5210             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5211
  5212*         16  FILLER                         PIC X(102).
  5213         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5214             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5215             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5216
  5217         16  CF-AH-APPROVAL-DAYS.
  5218             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5219             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5220             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5221             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5222
  5223         16  FILLER                         PIC X(82).
  5224****************************************************************
  5225*             PROCESSOR/USER RECORD                            *
  5226****************************************************************
  5227
  5228     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5229         16  CF-PROCESSOR-NAME              PIC X(30).
  5230         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5231         16  CF-PROCESSOR-TITLE             PIC X(26).
  5232         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5233                 88  MESSAGE-YES                VALUE 'Y'.
  5234                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5235
  5236*****************************************************
  5237****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  97
* EL050.cbl
  5238****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5239****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5240****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5241*****************************************************
  5242
  5243         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5244             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5245             20  CF-APPLICATION-FORCE       PIC X.
  5246             20  CF-INDIVIDUAL-APP.
  5247                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5248                     28  CF-BROWSE-APP      PIC X.
  5249                     28  CF-UPDATE-APP      PIC X.
  5250
  5251         16  CF-CURRENT-TERM-ON             PIC X(4).
  5252         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5253             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5254             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5255             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5256             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5257             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5258             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5259             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5260         16  CF-PROCESSOR-CARRIER           PIC X.
  5261             88  NO-CARRIER-SECURITY            VALUE ' '.
  5262         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5263             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5264         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5265             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5266         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5267             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5268
  5269         16  CF-PROC-SYS-ACCESS-SW.
  5270             20  CF-PROC-CREDIT-CLAIMS-SW.
  5271                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5272                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5273                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5274                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5275             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5276                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5277                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5278             20  CF-PROC-LIFE-GNRLDGR-SW.
  5279                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5280                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5281                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5282                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5283             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5284                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5285                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5286         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5287             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5288             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5289         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5290
  5291         16  CF-APPROVAL-LEVEL                  PIC X.
  5292             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5293             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5294             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5295             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  98
* EL050.cbl
  5296
  5297         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5298
  5299         16  CF-LANGUAGE-TYPE                   PIC X.
  5300             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5301             88  CF-LANG-IS-FR                      VALUE 'F'.
  5302         16  FILLER                             PIC  X(240).
  5303
  5304****************************************************************
  5305*             PROCESSOR/REMINDERS RECORD                       *
  5306****************************************************************
  5307
  5308     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5309         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5310             20  CF-START-REMIND-DT         PIC XX.
  5311             20  CF-END-REMIND-DT           PIC XX.
  5312             20  CF-REMINDER-TEXT           PIC X(50).
  5313         16  FILLER                         PIC X(296).
  5314
  5315
  5316****************************************************************
  5317*             STATE MASTER RECORD                              *
  5318****************************************************************
  5319
  5320     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5321         16  CF-STATE-ABBREVIATION          PIC XX.
  5322         16  CF-STATE-NAME                  PIC X(25).
  5323         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5324         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5325             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5326             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5327             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5328             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5329                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5330                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5331             20  CF-ST-PREM-REJECT-SW       PIC X.
  5332                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5333                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5334             20  CF-ST-REF-REJECT-SW        PIC X.
  5335                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5336                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5337         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5338         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5339         16  CF-ST-REFUND-RULES.
  5340             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5341             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5342             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5343         16  CF-ST-FST-PMT-EXTENSION.
  5344             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5345             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5346                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5347                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5348                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5349                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5350         16  CF-ST-STATE-CALL.
  5351             20  CF-ST-CALL-UNEARNED        PIC X.
  5352             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5353             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page  99
* EL050.cbl
  5354         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5355             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5356             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5357         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5358         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5359         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5360         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5361         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5362         16  FILLER                         PIC X.
  5363         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5364             20  CF-ST-BENEFIT-CD           PIC XX.
  5365             20  CF-ST-BENEFIT-KIND         PIC X.
  5366                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5367                 88  CF-ST-AH-KIND              VALUE 'A'.
  5368             20  CF-ST-REM-TERM-CALC        PIC X.
  5369                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5370                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5371                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5372                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5373                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5374                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5375                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5376                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5377
  5378             20  CF-ST-REFUND-CALC          PIC X.
  5379                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5380                 88  ST-REFD-BY-R78             VALUE '1'.
  5381                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5382                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5383                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5384                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5385                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5386                 88  ST-REFD-UTAH               VALUE '7'.
  5387                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5388                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5389                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5390
  5391             20  CF-ST-EARNING-CALC         PIC X.
  5392                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5393                 88  ST-EARN-BY-R78             VALUE '1'.
  5394                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5395                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5396                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5397                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5398                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5399                 88  ST-EARN-MEAN               VALUE '8'.
  5400                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5401
  5402             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5403                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5404                 88  ST-OVRD-BY-R78             VALUE '1'.
  5405                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5406                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5407                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5408                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5409                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5410                 88  ST-OVRD-MEAN               VALUE '8'.
  5411                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 100
* EL050.cbl
  5412             20  FILLER                     PIC X.
  5413
  5414         16  CF-ST-COMMISSION-CAPS.
  5415             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5416             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5417             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5418             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5419         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5420                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5421
  5422         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5423
  5424         16  CF-ST-STATUTORY-INTEREST.
  5425             20  CF-ST-STAT-DATE-FROM       PIC X.
  5426                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5427                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5428             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5429             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5430             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5431             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5432             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5433
  5434         16  CF-ST-OVER-SHORT.
  5435             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5436             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5437
  5438         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5439
  5440         16  CF-ST-RT-CALC                  PIC X.
  5441
  5442         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5443         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5444         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5445         16  CF-ST-RF-LR-CALC               PIC X.
  5446         16  CF-ST-RF-LL-CALC               PIC X.
  5447         16  CF-ST-RF-LN-CALC               PIC X.
  5448         16  CF-ST-RF-AH-CALC               PIC X.
  5449         16  CF-ST-RF-CP-CALC               PIC X.
  5450*        16  FILLER                         PIC X(206).
  5451*CIDMOD         16  FILLER                         PIC X(192).
  5452         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5453             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5454         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5455         16  CF-ST-VFY-2ND-BENE             PIC X.
  5456         16  FILLER                         PIC X(186).
  5457
  5458****************************************************************
  5459*             BENEFIT MASTER RECORD                            *
  5460****************************************************************
  5461
  5462     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5463         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5464             20  CF-BENEFIT-CODE            PIC XX.
  5465             20  CF-BENEFIT-NUMERIC  REDEFINES
  5466                 CF-BENEFIT-CODE            PIC XX.
  5467             20  CF-BENEFIT-ALPHA           PIC XXX.
  5468             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5469             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 101
* EL050.cbl
  5470
  5471             20  CF-LF-COVERAGE-TYPE        PIC X.
  5472                 88  CF-REDUCING                VALUE 'R'.
  5473                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5474
  5475             20  CF-SPECIAL-CALC-CD         PIC X.
  5476                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5477                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5478                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5479                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5480                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5481                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5482                 88  CF-FARM-PLAN               VALUE 'F'.
  5483                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5484                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5485                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5486                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5487                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5488                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5489                 88  CF-PRUDENTIAL              VALUE 'P'.
  5490                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5491                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5492                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5493                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5494                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5495                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5496
  5497             20  CF-JOINT-INDICATOR         PIC X.
  5498                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5499
  5500*            20  FILLER                     PIC X(12).
  5501             20  FILLER                     PIC X(11).
  5502             20  CF-BENEFIT-CATEGORY        PIC X.
  5503             20  CF-LOAN-TYPE               PIC X(8).
  5504
  5505             20  CF-CO-REM-TERM-CALC        PIC X.
  5506                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5507                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5508                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5509                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5510                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5511
  5512             20  CF-CO-EARNINGS-CALC        PIC X.
  5513                 88  CO-EARN-BY-R78             VALUE '1'.
  5514                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5515                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5516                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5517                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5518                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5519                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5520                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5521
  5522             20  CF-CO-REFUND-CALC          PIC X.
  5523                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5524                 88  CO-REFD-BY-R78             VALUE '1'.
  5525                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5526                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5527                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 102
* EL050.cbl
  5528                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5529                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5530                 88  CO-REFD-MEAN               VALUE '8'.
  5531                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5532                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5533                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5534
  5535             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5536                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5537                 88  CO-OVRD-BY-R78             VALUE '1'.
  5538                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5539                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5540                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5541                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5542                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5543                 88  CO-OVRD-MEAN               VALUE '8'.
  5544                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5545
  5546             20  CF-CO-BEN-I-G-CD           PIC X.
  5547                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5548                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5549                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5550
  5551         16  FILLER                         PIC X(304).
  5552
  5553
  5554****************************************************************
  5555*             CARRIER MASTER RECORD                            *
  5556****************************************************************
  5557
  5558     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5559         16  CF-ADDRESS-DATA.
  5560             20  CF-MAIL-TO-NAME            PIC X(30).
  5561             20  CF-IN-CARE-OF              PIC X(30).
  5562             20  CF-ADDRESS-LINE-1          PIC X(30).
  5563             20  CF-ADDRESS-LINE-2          PIC X(30).
  5564             20  CF-CITY-STATE              PIC X(30).
  5565             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5566             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5567
  5568         16  CF-CLAIM-NO-CONTROL.
  5569             20  CF-CLAIM-NO-METHOD         PIC X.
  5570                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5571                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5572                 88  CLAIM-NO-SEQ               VALUE '3'.
  5573                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5574             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5575                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5576                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5577                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5578
  5579         16  CF-CHECK-NO-CONTROL.
  5580             20  CF-CHECK-NO-METHOD         PIC X.
  5581                 88  CHECK-NO-MANUAL            VALUE '1'.
  5582                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5583                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5584                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5585             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 103
* EL050.cbl
  5586                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5587
  5588         16  CF-DOMICILE-STATE              PIC XX.
  5589
  5590         16  CF-EXPENSE-CONTROLS.
  5591             20  CF-EXPENSE-METHOD          PIC X.
  5592                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5593                 88  DOLLARS-PER-PMT            VALUE '2'.
  5594                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5595                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5596             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5597             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5598
  5599         16  CF-CORRESPONDENCE-CONTROL.
  5600             20  CF-LETTER-RESEND-OPT       PIC X.
  5601                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5602                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5603             20  FILLER                     PIC X(4).
  5604
  5605         16  CF-RESERVE-CONTROLS.
  5606             20  CF-MANUAL-SW               PIC X.
  5607                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5608             20  CF-FUTURE-SW               PIC X.
  5609                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5610             20  CF-PTC-SW                  PIC X.
  5611                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5612             20  CF-IBNR-SW                 PIC X.
  5613                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5614             20  CF-PTC-LF-SW               PIC X.
  5615                 88  CF-LF-PTC-USED             VALUE '1'.
  5616             20  CF-CDT-ACCESS-METHOD       PIC X.
  5617                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5618                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5619                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5620             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5621
  5622         16  CF-CLAIM-CALC-METHOD           PIC X.
  5623             88  360-PLUS-MONTHS                VALUE '1'.
  5624             88  365-PLUS-MONTHS                VALUE '2'.
  5625             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5626             88  360-DAILY                      VALUE '4'.
  5627             88  365-DAILY                      VALUE '5'.
  5628
  5629         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5630         16  FILLER                         PIC X(11).
  5631
  5632         16  CF-LIMIT-AMOUNTS.
  5633             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5634             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5635             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5636             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5637             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5638             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5639             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5640             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5641             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5642             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5643
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 104
* EL050.cbl
  5644         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5645         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5646         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5647
  5648         16  CF-ZIP-CODE.
  5649             20  CF-ZIP-PRIME.
  5650                 24  CF-ZIP-1ST             PIC X.
  5651                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5652                 24  FILLER                 PIC X(4).
  5653             20  CF-ZIP-PLUS4               PIC X(4).
  5654         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5655             20  CF-CAN-POSTAL-1            PIC XXX.
  5656             20  CF-CAN-POSTAL-2            PIC XXX.
  5657             20  FILLER                     PIC XXX.
  5658
  5659         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5660         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5661         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5662
  5663         16  CF-RATING-SWITCH               PIC X.
  5664             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5665             88  CF-NO-RATING                   VALUE 'N'.
  5666
  5667         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5668
  5669         16  CF-CARRIER-OVER-SHORT.
  5670             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5671             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5672
  5673         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5674         16  CF-SECPAY-SWITCH               PIC X.
  5675             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5676             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5677         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5678         16  FILLER                         PIC X(448).
  5679*        16  FILLER                         PIC X(452).
  5680
  5681
  5682****************************************************************
  5683*             MORTALITY MASTER RECORD                          *
  5684****************************************************************
  5685
  5686     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5687         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5688                                INDEXED BY CF-MORT-NDX.
  5689             20  CF-MORT-TABLE              PIC X(5).
  5690             20  CF-MORT-TABLE-TYPE         PIC X.
  5691                 88  CF-MORT-JOINT              VALUE 'J'.
  5692                 88  CF-MORT-SINGLE             VALUE 'S'.
  5693                 88  CF-MORT-COMBINED           VALUE 'C'.
  5694                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5695                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5696             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5697             20  CF-MORT-AGE-METHOD         PIC XX.
  5698                 88  CF-AGE-LAST                VALUE 'AL'.
  5699                 88  CF-AGE-NEAR                VALUE 'AN'.
  5700             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5701             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 105
* EL050.cbl
  5702                                            PIC X.
  5703                 88  CF-MINUS                   VALUE '-'.
  5704                 88  CF-PLUS                    VALUE '+'.
  5705             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5706             20  CF-MORT-JOINT-CODE         PIC X.
  5707                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5708             20  CF-MORT-PC-Q               PIC X.
  5709                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5710             20  CF-MORT-TABLE-CODE         PIC X(4).
  5711             20  CF-MORT-COMMENTS           PIC X(15).
  5712             20  FILLER                     PIC X(14).
  5713
  5714         16  FILLER                         PIC X(251).
  5715
  5716
  5717****************************************************************
  5718*             BUSSINESS TYPE MASTER RECORD                     *
  5719****************************************************************
  5720
  5721     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5722* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5723* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5724* AND RECORD 05 IS TYPES 81-99
  5725         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5726             20  CF-BUSINESS-TITLE          PIC  X(19).
  5727             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5728                                            PIC S9V9(4) COMP-3.
  5729             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5730             20  FILLER                     PIC  X.
  5731         16  FILLER                         PIC  X(248).
  5732
  5733
  5734****************************************************************
  5735*             TERMINAL MASTER RECORD                           *
  5736****************************************************************
  5737
  5738     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5739
  5740         16  CF-COMPANY-TERMINALS.
  5741             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5742                                  PIC X(4).
  5743         16  FILLER               PIC X(248).
  5744
  5745
  5746****************************************************************
  5747*             LIFE EDIT MASTER RECORD                          *
  5748****************************************************************
  5749
  5750     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5751         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5752             20  CF-LIFE-CODE-IN            PIC XX.
  5753             20  CF-LIFE-CODE-OUT           PIC XX.
  5754         16  FILLER                         PIC X(248).
  5755
  5756
  5757****************************************************************
  5758*             AH EDIT MASTER RECORD                            *
  5759****************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 106
* EL050.cbl
  5760
  5761     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5762         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5763             20  CF-AH-CODE-IN              PIC XXX.
  5764             20  CF-AH-CODE-OUT             PIC XX.
  5765         16  FILLER                         PIC X(248).
  5766
  5767
  5768****************************************************************
  5769*             CREDIBILITY TABLES                               *
  5770****************************************************************
  5771
  5772     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5773         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5774                             INDEXED BY CF-CRDB-NDX.
  5775             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5776             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5777             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5778         16  FILLER                         PIC  X(332).
  5779
  5780
  5781****************************************************************
  5782*             REPORT CUSTOMIZATION RECORD                      *
  5783****************************************************************
  5784
  5785     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5786         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5787             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5788             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5789             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5790**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5791****       A T-TRANSFER.                                   ****
  5792             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5793
  5794         16  FILLER                         PIC XX.
  5795
  5796         16  CF-CARRIER-CNTL-OPT.
  5797             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5798                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5799                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5800             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5801                                            PIC X.
  5802         16  CF-GROUP-CNTL-OPT.
  5803             20  CF-GROUP-OPT-SEQ           PIC 9.
  5804                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5805                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5806             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5807                                            PIC X(6).
  5808         16  CF-STATE-CNTL-OPT.
  5809             20  CF-STATE-OPT-SEQ           PIC 9.
  5810                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5811                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5812             20  CF-STATE-SELECT OCCURS 3 TIMES
  5813                                            PIC XX.
  5814         16  CF-ACCOUNT-CNTL-OPT.
  5815             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5816                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5817                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 107
* EL050.cbl
  5818             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5819                                            PIC X(10).
  5820         16  CF-BUS-TYP-CNTL-OPT.
  5821             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5822                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5823                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5824             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5825                                            PIC XX.
  5826         16  CF-LF-TYP-CNTL-OPT.
  5827             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5828                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5829                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5830             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5831                                            PIC XX.
  5832         16  CF-AH-TYP-CNTL-OPT.
  5833             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5834                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5835                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5836             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5837                                            PIC XX.
  5838         16  CF-REPTCD1-CNTL-OPT.
  5839             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5840                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5841                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5842             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5843                                            PIC X(10).
  5844         16  CF-REPTCD2-CNTL-OPT.
  5845             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5846                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5847                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5848             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5849                                            PIC X(10).
  5850         16  CF-USER1-CNTL-OPT.
  5851             20  CF-USER1-OPT-SEQ           PIC 9.
  5852                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5853                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5854             20  CF-USER1-SELECT OCCURS 3 TIMES
  5855                                            PIC X(10).
  5856         16  CF-USER2-CNTL-OPT.
  5857             20  CF-USER2-OPT-SEQ           PIC 9.
  5858                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5859                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5860             20  CF-USER2-SELECT OCCURS 3 TIMES
  5861                                            PIC X(10).
  5862         16  CF-USER3-CNTL-OPT.
  5863             20  CF-USER3-OPT-SEQ           PIC 9.
  5864                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5865                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5866             20  CF-USER3-SELECT OCCURS 3 TIMES
  5867                                            PIC X(10).
  5868         16  CF-USER4-CNTL-OPT.
  5869             20  CF-USER4-OPT-SEQ           PIC 9.
  5870                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5871                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5872             20  CF-USER4-SELECT OCCURS 3 TIMES
  5873                                            PIC X(10).
  5874         16  CF-USER5-CNTL-OPT.
  5875             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 108
* EL050.cbl
  5876                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5877                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5878             20  CF-USER5-SELECT OCCURS 3 TIMES
  5879                                            PIC X(10).
  5880         16  CF-REINS-CNTL-OPT.
  5881             20  CF-REINS-OPT-SEQ           PIC 9.
  5882                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5883                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5884             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5885                 24  CF-REINS-PRIME         PIC XXX.
  5886                 24  CF-REINS-SUB           PIC XXX.
  5887
  5888         16  CF-AGENT-CNTL-OPT.
  5889             20  CF-AGENT-OPT-SEQ           PIC 9.
  5890                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5891                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5892             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5893                                            PIC X(10).
  5894
  5895         16  FILLER                         PIC X(43).
  5896
  5897         16  CF-LOSS-RATIO-SELECT.
  5898             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5899             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5900         16  CF-ENTRY-DATE-SELECT.
  5901             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5902             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5903         16  CF-EFFECTIVE-DATE-SELECT.
  5904             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5905             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5906
  5907         16  CF-EXCEPTION-LIST-IND          PIC X.
  5908             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5909
  5910         16  FILLER                         PIC X(318).
  5911
  5912****************************************************************
  5913*                  EXCEPTION REPORTING RECORD                  *
  5914****************************************************************
  5915
  5916     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5917         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5918             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5919
  5920         16  CF-COMBINED-LIFE-AH-OPT.
  5921             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5922             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5923             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5924             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5925
  5926         16  CF-LIFE-OPT.
  5927             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5928             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5929             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5930             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5931             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5932             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5933             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 109
* EL050.cbl
  5934             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5935             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5936             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5937
  5938         16  CF-AH-OPT.
  5939             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5940             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5941             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5942             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5943             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5944             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5945             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5946             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5947             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5948             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5949
  5950         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5951             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5952             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5953             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5954
  5955         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5956
  5957         16  FILLER                         PIC X(673).
  5958
  5959
  5960****************************************************************
  5961*             MORTGAGE SYSTEM PLAN RECORD                      *
  5962****************************************************************
  5963
  5964     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5965         16  CF-PLAN-TYPE                   PIC X.
  5966             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5967             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5968             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5969         16  CF-PLAN-ABBREV                 PIC XXX.
  5970         16  CF-PLAN-DESCRIPT               PIC X(10).
  5971         16  CF-PLAN-NOTES                  PIC X(20).
  5972         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5973         16  CF-PLAN-UNDERWRITING.
  5974             20  CF-PLAN-TERM-DATA.
  5975                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5976                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5977             20  CF-PLAN-AGE-DATA.
  5978                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5979                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5980                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5981             20  CF-PLAN-BENEFIT-DATA.
  5982                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5983                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5984                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5985                                            PIC S9(7)V99  COMP-3.
  5986         16  CF-PLAN-POLICY-FORMS.
  5987             20  CF-POLICY-FORM             PIC X(12).
  5988             20  CF-MASTER-APPLICATION      PIC X(12).
  5989             20  CF-MASTER-POLICY           PIC X(12).
  5990         16  CF-PLAN-RATING.
  5991             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 110
* EL050.cbl
  5992             20  CF-SEX-RATING              PIC X.
  5993                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5994                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5995             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5996             20  CF-SUB-STD-TYPE            PIC X.
  5997                 88  CF-PCT-OF-PREM            VALUE '1'.
  5998                 88  CF-PCT-OF-BENE            VALUE '2'.
  5999         16  CF-PLAN-PREM-TOLERANCES.
  6000             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6001             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6002         16  CF-PLAN-PYMT-TOLERANCES.
  6003             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6004             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6005         16  CF-PLAN-MISC-DATA.
  6006             20  FILLER                     PIC X.
  6007             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6008             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6009         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6010         16  CF-PLAN-IND-GRP                PIC X.
  6011             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6012                                                     '1'.
  6013             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6014                                                     '2'.
  6015         16  CF-MIB-SEARCH-SW               PIC X.
  6016             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6017             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6018             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6019             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6020         16  CF-ALPHA-SEARCH-SW             PIC X.
  6021             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6022             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6023             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6024             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6025             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6026             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6027             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6028             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6029             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6030             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6031                                                     'A' 'B' 'C'
  6032                                                     'X' 'Y' 'Z'.
  6033         16  CF-EFF-DT-RULE-SW              PIC X.
  6034             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6035             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6036             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6037             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6038             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6039         16  FILLER                         PIC X(4).
  6040         16  CF-HEALTH-QUESTIONS            PIC X.
  6041             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6042         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6043         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6044         16  CF-PLAN-SNGL-JNT               PIC X.
  6045             88  CF-COMBINED-PLAN              VALUE 'C'.
  6046             88  CF-JNT-PLAN                   VALUE 'J'.
  6047             88  CF-SNGL-PLAN                  VALUE 'S'.
  6048         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6049         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 111
* EL050.cbl
  6050         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6051         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6052         16  CF-RERATE-CNTL                 PIC  X.
  6053             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6054             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6055             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6056             88  CF-AUTO-RECALC                 VALUE '4'.
  6057         16  CF-BENEFIT-TYPE                PIC  X.
  6058             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6059             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6060         16  CF-POLICY-FEE                  PIC S999V99
  6061                                                    COMP-3.
  6062         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6063         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6064         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6065         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6066         16  FILLER                         PIC  X(32).
  6067         16  CF-TERMINATION-FORM            PIC  X(04).
  6068         16  FILLER                         PIC  X(08).
  6069         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6070                                                       COMP-3.
  6071         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6072         16  CF-ISSUE-LETTER                PIC  X(4).
  6073         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6074         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6075             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6076             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6077         16  CF-MP-REFUND-CALC              PIC X.
  6078             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6079             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6080             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6081             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6082             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6083             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6084             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6085             88  CF-MP-REFD-MEAN                VALUE '8'.
  6086         16  CF-ALT-RATE-CODE               PIC  X(5).
  6087
  6088
  6089         16  FILLER                         PIC X(498).
  6090****************************************************************
  6091*             MORTGAGE COMPANY MASTER RECORD                   *
  6092****************************************************************
  6093
  6094     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6095         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6096         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6097             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6098             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6099             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6100             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6101             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6102
  6103         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6104         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6105         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6106         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6107         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 112
* EL050.cbl
  6108
  6109         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6110             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6111         16  CF-MP-RECON-USE-IND            PIC X(1).
  6112             88  CF-MP-USE-RECON             VALUE 'Y'.
  6113         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6114             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6115         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6116             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6117             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6118         16  FILLER                         PIC X(1).
  6119         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6120             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6121         16  CF-MORTG-MIB-VERSION           PIC X.
  6122             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6123             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6124             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6125         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6126             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6127                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6128             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6129                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6130             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6131                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6132             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6133                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6134             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6135                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6136             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6137                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6138         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6139         16  FILLER                         PIC X(7).
  6140         16  CF-MORTG-DESTINATION-SYMBOL.
  6141             20  CF-MORTG-MIB-COMM          PIC X(5).
  6142             20  CF-MORTG-MIB-TERM          PIC X(5).
  6143         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6144             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6145         16  FILLER                         PIC X(03).
  6146         16  CF-MP-CHECK-NO-CONTROL.
  6147             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6148                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6149                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6150                                                ' ' LOW-VALUES.
  6151                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6152                                               VALUE '3'.
  6153         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6154         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6155         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6156             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6157                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6158             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6159                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6160             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6161                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6162             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6163                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6164             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6165                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 113
* EL050.cbl
  6166             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6167                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6168         16  CF-MORTG-BILLING-AREA.
  6169             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6170                                            PIC X.
  6171         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6172         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6173         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6174         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6175             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6176             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6177         16  FILLER                         PIC X.
  6178         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6179             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6180             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6181         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6182         16  FILLER                         PIC X(8).
  6183         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6184         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6185         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6186         16  CF-ACH-COMPANY-ID.
  6187             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6188                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6189                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6190                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6191             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6192         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6193             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6194         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6195             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6196             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6197         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6198         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6199         16  FILLER                         PIC X(536).
  6200
  6201****************************************************************
  6202*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6203****************************************************************
  6204
  6205     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6206         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6207             20  CF-FEMALE-HEIGHT.
  6208                 24  CF-FEMALE-FT           PIC 99.
  6209                 24  CF-FEMALE-IN           PIC 99.
  6210             20  CF-FEMALE-MIN-WT           PIC 999.
  6211             20  CF-FEMALE-MAX-WT           PIC 999.
  6212         16  FILLER                         PIC X(428).
  6213
  6214     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6215         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6216             20  CF-MALE-HEIGHT.
  6217                 24  CF-MALE-FT             PIC 99.
  6218                 24  CF-MALE-IN             PIC 99.
  6219             20  CF-MALE-MIN-WT             PIC 999.
  6220             20  CF-MALE-MAX-WT             PIC 999.
  6221         16  FILLER                         PIC X(428).
  6222******************************************************************
  6223*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 114
* EL050.cbl
  6224******************************************************************
  6225     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6226         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6227             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6228             20  CF-SYS-LETTER-ID           PIC X(04).
  6229             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6230             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6231             20  CF-SYS-RESET-SW            PIC X(01).
  6232             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6233             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6234
  6235         16  FILLER                         PIC X(50).
  6236
  6237         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6238             20  CF-USER-ACTIVE-SW          PIC X(01).
  6239             20  CF-USER-LETTER-ID          PIC X(04).
  6240             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6241             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6242             20  CF-USER-RESET-SW           PIC X(01).
  6243             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6244             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6245             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6246
  6247         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 115
* EL050.cbl
  6249*    COPY ERCACCT.
  6250******************************************************************
  6251*                                                                *
  6252*                                                                *
  6253*                            ERCACCT                             *
  6254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6255*                            VMOD=2.031                          *
  6256*                                                                *
  6257*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6258*                                                                *
  6259*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6260*   VSAM ACCOUNT MASTER FILES.                                   *
  6261*                                                                *
  6262*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6263*                                                                *
  6264*   FILE TYPE = VSAM,KSDS                                        *
  6265*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6266*                                                                *
  6267*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6268*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6269*                                                                *
  6270*   LOG = NO                                                     *
  6271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6272*                                                                *
  6273*                                                                *
  6274******************************************************************
  6275*                   C H A N G E   L O G
  6276*
  6277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6278*-----------------------------------------------------------------
  6279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6280* EFFECTIVE    NUMBER
  6281*-----------------------------------------------------------------
  6282* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6283* 092705    2005050300006  PEMA  ADD SPP LEASES
  6284* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6285* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6286* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6287* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6288* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6289******************************************************************
  6290
  6291 01  ACCOUNT-MASTER.
  6292     12  AM-RECORD-ID                      PIC XX.
  6293         88  VALID-AM-ID                      VALUE 'AM'.
  6294
  6295     12  AM-CONTROL-PRIMARY.
  6296         16  AM-COMPANY-CD                 PIC X.
  6297         16  AM-MSTR-CNTRL.
  6298             20  AM-CONTROL-A.
  6299                 24  AM-CARRIER            PIC X.
  6300                 24  AM-GROUPING.
  6301                     28 AM-GROUPING-PREFIX PIC XXX.
  6302                     28 AM-GROUPING-PRIME  PIC XXX.
  6303                 24  AM-STATE              PIC XX.
  6304                 24  AM-ACCOUNT.
  6305                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6306                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 116
* EL050.cbl
  6307             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6308                                           PIC X(19).
  6309             20  AM-CNTRL-B.
  6310                 24  AM-EXPIRATION-DT      PIC XX.
  6311                 24  FILLER                PIC X(4).
  6312             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6313                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6314
  6315     12  AM-CONTROL-BY-VAR-GRP.
  6316         16  AM-COMPANY-CD-A1              PIC X.
  6317         16  AM-VG-CARRIER                 PIC X.
  6318         16  AM-VG-GROUPING                PIC X(6).
  6319         16  AM-VG-STATE                   PIC XX.
  6320         16  AM-VG-ACCOUNT                 PIC X(10).
  6321         16  AM-VG-DATE.
  6322             20  AM-VG-EXPIRATION-DT       PIC XX.
  6323             20  FILLER                    PIC X(4).
  6324         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6325                                           PIC 9(11)      COMP-3.
  6326     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6327         16  FILLER                        PIC X(10).
  6328         16  AM-VG-KEY3.
  6329             20  AM-VG3-ACCOUNT            PIC X(10).
  6330             20  AM-VG3-EXP-DT             PIC XX.
  6331         16  FILLER                        PIC X(4).
  6332     12  AM-MAINT-INFORMATION.
  6333         16  AM-LAST-MAINT-DT              PIC XX.
  6334         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6335         16  AM-LAST-MAINT-USER            PIC X(4).
  6336         16  FILLER                        PIC XX.
  6337
  6338     12  AM-EFFECTIVE-DT                   PIC XX.
  6339     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6340
  6341     12  AM-PREV-DATES  COMP-3.
  6342         16  AM-PREV-EXP-DT                PIC 9(11).
  6343         16  AM-PREV-EFF-DT                PIC 9(11).
  6344
  6345     12  AM-REPORT-CODE-1                  PIC X(10).
  6346     12  AM-REPORT-CODE-2                  PIC X(10).
  6347
  6348     12  AM-CITY-CODE                      PIC X(4).
  6349     12  AM-COUNTY-PARISH                  PIC X(6).
  6350
  6351     12  AM-NAME                           PIC X(30).
  6352     12  AM-PERSON                         PIC X(30).
  6353     12  AM-ADDRS                          PIC X(30).
  6354     12  AM-CITY.
  6355         16  AM-ADDR-CITY                  PIC X(28).
  6356         16  AM-ADDR-STATE                 PIC XX.
  6357     12  AM-ZIP.
  6358         16  AM-ZIP-PRIME.
  6359             20  AM-ZIP-PRI-1ST            PIC X.
  6360                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6361             20  FILLER                    PIC X(4).
  6362         16  AM-ZIP-PLUS4                  PIC X(4).
  6363     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6364         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 117
* EL050.cbl
  6365         16  AM-CAN-POSTAL-2               PIC XXX.
  6366         16  FILLER                        PIC XXX.
  6367     12  AM-TEL-NO.
  6368         16  AM-AREA-CODE                  PIC 999.
  6369         16  AM-TEL-PRE                    PIC 999.
  6370         16  AM-TEL-NBR                    PIC 9(4).
  6371     12  AM-TEL-LOC                        PIC X.
  6372         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6373         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6374
  6375     12  AM-COMM-STRUCTURE.
  6376         16  AM-DEFN-1.
  6377             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6378                 24  AM-AGT.
  6379                     28  AM-AGT-PREFIX     PIC X(4).
  6380                     28  AM-AGT-PRIME      PIC X(6).
  6381                 24  AM-COM-TYP            PIC X.
  6382                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6383                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6384                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6385                 24  AM-RECALC-LV-INDIC    PIC X.
  6386                 24  AM-RETRO-LV-INDIC     PIC X.
  6387                 24  AM-GL-CODES           PIC X.
  6388                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6389                 24  FILLER                PIC X(01).
  6390         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6391             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6392                 24  FILLER                PIC X(11).
  6393                 24  AM-L-COMA             PIC XXX.
  6394                 24  AM-J-COMA             PIC XXX.
  6395                 24  AM-A-COMA             PIC XXX.
  6396                 24  FILLER                PIC X(6).
  6397
  6398     12  AM-COMM-CHANGE-STATUS             PIC X.
  6399         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6400
  6401     12  AM-CSR-CODE                       PIC X(4).
  6402
  6403     12  AM-BILLING-STATUS                 PIC X.
  6404         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6405         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6406     12  AM-AUTO-REFUND-SW                 PIC X.
  6407         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6408         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6409     12  AM-GPCD                           PIC 99.
  6410     12  AM-IG                             PIC X.
  6411         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6412         88  AM-HAS-GROUP                     VALUE '2'.
  6413     12  AM-STATUS                         PIC X.
  6414         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6415         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6416         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6417         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6418         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6419         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6420     12  AM-REMIT-TO                       PIC 99.
  6421     12  AM-ID-NO                          PIC X(11).
  6422
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 118
* EL050.cbl
  6423     12  AM-CAL-TABLE                      PIC XX.
  6424     12  AM-LF-DEVIATION                   PIC XXX.
  6425     12  AM-AH-DEVIATION                   PIC XXX.
  6426     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6427     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6428     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6429     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6430     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6431     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6432
  6433     12  AM-USER-FIELDS.
  6434         16  AM-FLD-1                      PIC XX.
  6435         16  AM-FLD-2                      PIC XX.
  6436         16  AM-FLD-3                      PIC XX.
  6437         16  AM-FLD-4                      PIC XX.
  6438         16  AM-FLD-5                      PIC XX.
  6439
  6440     12  AM-1ST-PROD-DATE.
  6441         16  AM-1ST-PROD-YR                PIC XX.
  6442         16  AM-1ST-PROD-MO                PIC XX.
  6443         16  AM-1ST-PROD-DA                PIC XX.
  6444     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6445     12  AM-CERTS-PURGED-DATE.
  6446         16  AM-PUR-YR                     PIC XX.
  6447         16  AM-PUR-MO                     PIC XX.
  6448         16  AM-PUR-DA                     PIC XX.
  6449     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6450     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6451     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6452     12  AM-INACTIVE-DATE.
  6453         16  AM-INA-MO                     PIC 99.
  6454         16  AM-INA-DA                     PIC 99.
  6455         16  AM-INA-YR                     PIC 99.
  6456     12  AM-AR-HI-CERT-DATE                PIC XX.
  6457
  6458     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6459     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6460
  6461     12  AM-OB-PAYMENT-MODE                PIC X.
  6462         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6463         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6464         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6465         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6466
  6467     12  AM-AH-ONLY-INDICATOR              PIC X.
  6468         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6469         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6470
  6471     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6472
  6473     12  AM-OVER-SHORT.
  6474         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6475         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6476
  6477     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6478     12  AM-DCC-CLP-STATE                  PIC XX.
  6479
  6480     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 119
* EL050.cbl
  6481     12  AM-RECALC-REIN                    PIC X.
  6482
  6483     12  AM-REI-TABLE                      PIC XXX.
  6484     12  AM-REI-ET-LF                      PIC X.
  6485     12  AM-REI-ET-AH                      PIC X.
  6486     12  AM-REI-PE-LF                      PIC X.
  6487     12  AM-REI-PE-AH                      PIC X.
  6488     12  AM-REI-PRT-ST                     PIC X.
  6489     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6490     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6491     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6492     12  AM-REI-GROUP-A                    PIC X(6).
  6493     12  AM-REI-MORT                       PIC X(4).
  6494     12  AM-REI-PRT-OW                     PIC X.
  6495     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6496     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6497     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6498     12  AM-REI-GROUP-B                    PIC X(6).
  6499
  6500     12  AM-TRUST-TYPE                     PIC X(2).
  6501
  6502     12  AM-EMPLOYER-STMT-USED             PIC X.
  6503     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6504
  6505     12  AM-STD-AH-TYPE                    PIC XX.
  6506     12  AM-EARN-METHODS.
  6507         16  AM-EARN-METHOD-R              PIC X.
  6508             88 AM-REF-RL-R78                 VALUE 'R'.
  6509             88 AM-REF-RL-PR                  VALUE 'P'.
  6510             88 AM-REF-RL-MEAN                VALUE 'M'.
  6511             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6512         16  AM-EARN-METHOD-L              PIC X.
  6513             88 AM-REF-LL-R78                 VALUE 'R'.
  6514             88 AM-REF-LL-PR                  VALUE 'P'.
  6515             88 AM-REF-LL-MEAN                VALUE 'M'.
  6516             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6517         16  AM-EARN-METHOD-A              PIC X.
  6518             88 AM-REF-AH-R78                 VALUE 'R'.
  6519             88 AM-REF-AH-PR                  VALUE 'P'.
  6520             88 AM-REF-AH-MEAN                VALUE 'M'.
  6521             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6522             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6523             88 AM-REF-AH-NET                 VALUE 'N'.
  6524
  6525     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6526     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6527     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6528
  6529     12  AM-RET-Y-N                        PIC X.
  6530     12  AM-RET-P-E                        PIC X.
  6531     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6532     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6533     12  AM-RET-GRP                        PIC X(6).
  6534     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6535         16  AM-POOL-PRIME                 PIC XXX.
  6536         16  AM-POOL-SUB                   PIC XXX.
  6537     12  AM-RETRO-EARNINGS.
  6538         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 120
* EL050.cbl
  6539         16  AM-RET-EARN-L                 PIC X.
  6540         16  AM-RET-EARN-A                 PIC X.
  6541     12  AM-RET-ST-TAX-USE                 PIC X.
  6542         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6543         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6544     12  AM-RETRO-BEG-EARNINGS.
  6545         16  AM-RET-BEG-EARN-R             PIC X.
  6546         16  AM-RET-BEG-EARN-L             PIC X.
  6547         16  AM-RET-BEG-EARN-A             PIC X.
  6548     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6549     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6550
  6551     12  AM-USER-SELECT-OPTIONS.
  6552         16  AM-USER-SELECT-1              PIC X(10).
  6553         16  AM-USER-SELECT-2              PIC X(10).
  6554         16  AM-USER-SELECT-3              PIC X(10).
  6555         16  AM-USER-SELECT-4              PIC X(10).
  6556         16  AM-USER-SELECT-5              PIC X(10).
  6557
  6558     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6559
  6560     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6561
  6562     12  AM-RPT045A-SWITCH                 PIC X.
  6563         88  RPT045A-OFF                   VALUE 'N'.
  6564
  6565     12  AM-INSURANCE-LIMITS.
  6566         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6567         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6568
  6569     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6570         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6571
  6572     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6573         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6574         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6575
  6576     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6577
  6578     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6579     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6580     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6581     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6582     12  AM-DCC-UEF-STATE                  PIC XX.
  6583     12  FILLER                            PIC XXX.
  6584     12  AM-REPORT-CODE-3                  PIC X(10).
  6585*    12  FILLER                            PIC X(22).
  6586
  6587     12  AM-RESERVE-DATE.
  6588         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6589         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6590         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6591
  6592     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6593     12  AM-NOTIFICATION-TYPES.
  6594         16  AM-NOTIF-OF-LETTERS           PIC X.
  6595         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6596         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 121
* EL050.cbl
  6597         16  AM-NOTIF-OF-STATUS            PIC X.
  6598
  6599     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6600         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6601         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6602         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6603         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6604
  6605     12  AM-BENEFIT-CONTROLS.
  6606         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6607             20  AM-BENEFIT-CODE           PIC XX.
  6608             20  AM-BENEFIT-TYPE           PIC X.
  6609             20  AM-BENEFIT-REVISION       PIC XXX.
  6610             20  AM-BENEFIT-REM-TERM       PIC X.
  6611             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6612             20  FILLER                    PIC XX.
  6613         16  FILLER                        PIC X(80).
  6614
  6615     12  AM-TRANSFER-DATA.
  6616         16  AM-TRANSFERRED-FROM.
  6617             20  AM-TRNFROM-CARRIER        PIC X.
  6618             20  AM-TRNFROM-GROUPING.
  6619                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6620                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6621             20  AM-TRNFROM-STATE          PIC XX.
  6622             20  AM-TRNFROM-ACCOUNT.
  6623                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6624                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6625             20  AM-TRNFROM-DTE            PIC XX.
  6626         16  AM-TRANSFERRED-TO.
  6627             20  AM-TRNTO-CARRIER          PIC X.
  6628             20  AM-TRNTO-GROUPING.
  6629                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6630                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6631             20  AM-TRNTO-STATE            PIC XX.
  6632             20  AM-TRNTO-ACCOUNT.
  6633                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6634                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6635             20  AM-TRNTO-DTE              PIC XX.
  6636         16  FILLER                        PIC X(10).
  6637
  6638     12  AM-SAVED-REMIT-TO                 PIC 99.
  6639
  6640     12  AM-COMM-STRUCTURE-SAVED.
  6641         16  AM-DEFN-1-SAVED.
  6642             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6643                 24  AM-AGT-SV             PIC X(10).
  6644                 24  AM-COM-TYP-SV         PIC X.
  6645                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6646                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6647                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6648                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6649                 24  FILLER                PIC X.
  6650                 24  AM-GL-CODES-SV        PIC X.
  6651                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6652                 24  FILLER                PIC X.
  6653         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6654             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 122
* EL050.cbl
  6655                 24  FILLER                PIC X(11).
  6656                 24  AM-L-COMA-SV          PIC XXX.
  6657                 24  AM-J-COMA-SV          PIC XXX.
  6658                 24  AM-A-COMA-SV          PIC XXX.
  6659                 24  FILLER                PIC X(6).
  6660
  6661     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6662         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6663            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6664            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6665            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6666
  6667     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6668     12  FILLER                            PIC X(120).
  6669
  6670     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6671         16  AM-CONTROL-NAME               PIC X(30).
  6672         16  AM-EXECUTIVE-ONE.
  6673             20  AM-EXEC1-NAME             PIC X(15).
  6674             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6675                                                          COMP-3.
  6676             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6677                                                          COMP-3.
  6678         16  AM-EXECUTIVE-TWO.
  6679             20  AM-EXEC2-NAME             PIC X(15).
  6680             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6681                                                          COMP-3.
  6682             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6683                                                          COMP-3.
  6684
  6685     12  AM-RETRO-ADDITIONAL-DATA.
  6686         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6687         16  AM-RETRO-PREM-P-E             PIC X.
  6688         16  AM-RETRO-CLMS-P-I             PIC X.
  6689         16  AM-RETRO-RET-BRACKET-LF.
  6690             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6691                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6692                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6693             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6694                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6695                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6696             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6697                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6698                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6699         16  AM-RETRO-RET-BRACKET-AH.
  6700             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6701                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6702                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6703                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6704             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6705                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6706                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6707             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6708                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6709                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6710
  6711     12  AM-COMMENTS.
  6712         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 123
* EL050.cbl
  6713
  6714     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6715         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6716         16  AM-FLI-BILLING-CODE           PIC X.
  6717         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6718         16  AM-FLI-UNITED-IDENT           PIC X.
  6719         16  AM-FLI-INTEREST-LOST-DATA.
  6720             20  AM-FLI-BANK-NO            PIC X(5).
  6721             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6722             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6723             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6724         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6725             20  AM-FLI-AGT                PIC X(9).
  6726             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6727             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6728         16  FILLER                        PIC X(102).
  6729
  6730     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6731         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6732             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6733             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6734             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6735             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6736             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6737         16  FILLER                          PIC X(10).
  6738******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 124
* EL050.cbl
  6740*    COPY ERCREIN.
  6741******************************************************************
  6742*                                                                *
  6743*                            ERCREIN                             *
  6744*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6745*                            VMOD=2.010                          *
  6746*                                                                *
  6747*   ONLINE CREDIT SYSTEM                                         *
  6748*                                                                *
  6749*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6750*                                                                *
  6751*   FILE TYPE = VSAM,KSDS                                        *
  6752*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6753*                                                                *
  6754*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6755*       ALTERNATE PATH = NONE                                    *
  6756*                                                                *
  6757*   LOG = NO                                                     *
  6758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6759*                                                                *
  6760******************************************************************
  6761*                   C H A N G E   L O G
  6762*
  6763* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6764*-----------------------------------------------------------------
  6765*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6766* EFFECTIVE    NUMBER
  6767*-----------------------------------------------------------------
  6768* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6769* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6770******************************************************************
  6771 01  REINSURANCE-RECORD.
  6772     12  RE-RECORD-ID                      PIC XX.
  6773         88  VALID-RE-ID                      VALUE 'RE'.
  6774
  6775     12  RE-CONTROL-PRIMARY.
  6776         16  RE-COMPANY-CD                 PIC X.
  6777         16  RE-KEY.
  6778             20  RE-CODE                   PIC X.
  6779                 88  RE-TABLE-RECORD          VALUE 'A'.
  6780                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6781             20  RE-TABLE                  PIC XXX.
  6782             20  FILLER                    PIC XXX.
  6783         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6784             20  FILLER                    PIC X.
  6785             20  RE-COMPANY.
  6786                 24  RE-COMP-PRIME         PIC XXX.
  6787                 24  RE-COMP-SUB           PIC XXX.
  6788
  6789     12  RE-MAINT-INFORMATION.
  6790         16  RE-LAST-MAINT-DT              PIC XX.
  6791         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6792         16  RE-LAST-MAINT-USER            PIC X(4).
  6793         16  FILLER                        PIC X(10).
  6794
  6795     12  RE-TABLE-DATA.
  6796         16  RE-100-COMP                   PIC 99.
  6797
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 125
* EL050.cbl
  6798         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6799             20  RE-REI-COMP-NO.
  6800                 24  RE-REI-COMP           PIC XXX.
  6801                 24  RE-REI-COMP-SUB       PIC XXX.
  6802             20  RE-LF-QC                  PIC X.
  6803             20  RE-AH-QC                  PIC X.
  6804             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6805             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6806             20  RE-LFAGE-LO               PIC 99.
  6807             20  RE-LFAGE-HI               PIC 99.
  6808             20  RE-AHAGE-LO               PIC 99.
  6809             20  RE-AHAGE-HI               PIC 99.
  6810             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6811             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6812             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6813             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6814             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6815             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6816             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6817             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6818             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6819             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6820             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6821             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6822             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6823             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6824             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6825             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6826             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6827             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6828             20  RE-LF-BEN-CODE            PIC X.
  6829             20  RE-AH-BEN-CODE            PIC X.
  6830             20  RE-INTERACTIVE            PIC X.
  6831             20  RE-REMAINING              PIC X.
  6832             20  RE-LF-RUNOFF-SW           PIC X.
  6833             20  RE-AH-RUNOFF-SW           PIC X.
  6834             20  FILLER                    PIC X(19).
  6835
  6836         16  RE-COMP-INFO-END              PIC X(6).
  6837         16  RE-NSP-ST-CD-LF               PIC XX.
  6838         16  RE-NSP-ST-CD-AH               PIC XX.
  6839         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6840             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6841
  6842         16  FILLER                        PIC X(27).
  6843
  6844     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6845         16  RE-NAME                       PIC X(30).
  6846         16  RE-LF-PE                      PIC X.
  6847         16  RE-AH-PE                      PIC X.
  6848         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6849         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6850         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6851         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6852         16  RE-PRT-ST                     PIC X.
  6853         16  RE-PRT-OW                     PIC X.
  6854         16  RE-MORT-CODE                  PIC X(4).
  6855         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 126
* EL050.cbl
  6856         16  RE-ZERO-LF-FEE                PIC X.
  6857         16  RE-ZERO-AH-FEE                PIC X.
  6858         16  RE-CEDE-NAME                  PIC X(30).
  6859         16  RE-LF-COMM                    PIC X.
  6860         16  RE-AH-COMM                    PIC X.
  6861         16  RE-LF-TAX                     PIC X.
  6862         16  RE-AH-TAX                     PIC X.
  6863         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6864         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6865         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6866
  6867         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6868             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6869
  6870         16  RE-LF-CEDING-FEE-BRACKETS.
  6871             20  RE-LF-FEE-METHOD          PIC X.
  6872                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6873                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6874                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6875                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6876             20  RE-LF-FEE-BASIS           PIC X.
  6877                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6878                 88  RE-LF-NET-CEDED               VALUE '2'.
  6879                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6880                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6881                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6882                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6883                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6884                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6885             20  FILLER                    PIC XXX.
  6886             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6887                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6888                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6889
  6890         16  RE-AH-CEDING-FEE-BRACKETS.
  6891             20  RE-AH-FEE-METHOD          PIC X.
  6892                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6893                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6894                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6895                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6896             20  RE-AH-FEE-BASIS           PIC X.
  6897                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6898                 88  RE-AH-NET-CEDED               VALUE '2'.
  6899                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6900                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6901                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6902                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6903                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6904                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6905             20  FILLER                    PIC XXX.
  6906             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6907                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6908                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6909
  6910         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6911
  6912         16  RE-OLD-CEDING-STMT            PIC X.
  6913
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 127
* EL050.cbl
  6914         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6915         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6916         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6917         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6918         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6919         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6920         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6921         16  RE-MORT-SW                    PIC X.
  6922         16  RE-CEDING-TYPE-FLAG           PIC X.
  6923             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6924             88  RE-CEDED                          VALUE 'C'.
  6925             88  RE-ASSUMED                        VALUE 'A'.
  6926             88  RE-PHANTOM                        VALUE 'P'.
  6927
  6928         16  RE-CEDING-STMT-OPT-A          PIC X.
  6929             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6930         16  RE-CEDING-STMT-OPT-B          PIC X.
  6931             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6932         16  RE-CEDING-STMT-OPT-C          PIC X.
  6933             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6934         16  RE-CEDING-STMT-OPT-D          PIC X.
  6935             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6936         16  RE-CEDING-STMT-OPT-E          PIC X.
  6937             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6938
  6939         16  RE-PRT-CRSV                   PIC X.
  6940
  6941         16  RE-GL-CENTER                  PIC X(4).
  6942
  6943         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6944
  6945         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6946
  6947         16  RE-EARN-STOP-CODE             PIC X.
  6948             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6949             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6950
  6951         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6952             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6953
  6954         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6955         16  FILLER                        PIC X(2281).
  6956
  6957         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6958
  6959******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 128
* EL050.cbl
  6961*    COPY ERCCTBL.
  6962******************************************************************
  6963*                                                                *
  6964*                                                                *
  6965*                            ERCCTBL                             *
  6966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6967*                            VMOD=2.003
  6968*                                                                *
  6969*   ONLINE CREDIT SYSTEM                                         *
  6970*                                                                *
  6971*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6972*                                                                *
  6973*   FILE TYPE = VSAM,KSDS                                        *
  6974*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6975*                                                                *
  6976*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6977*       ALTERNATE PATH = NONE                                    *
  6978*                                                                *
  6979*   LOG = NO                                                     *
  6980*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6981*                                                                *
  6982*                                                                *
  6983******************************************************************
  6984
  6985 01  COMM-TABLE-RECORD.
  6986     12  CT-RECORD-ID                      PIC XX.
  6987         88  VALID-CT-ID                      VALUE 'CT'.
  6988
  6989     12  CT-CONTROL-PRIMARY.
  6990         16  CT-COMPANY-CD                 PIC X.
  6991         16  CT-TABLE                      PIC XXX.
  6992         16  CT-CNTRL-2.
  6993             20  CT-BEN-TYPE               PIC X.
  6994             20  CT-BEN-CODE               PIC XX.
  6995
  6996     12  CT-MAINT-INFORMATION.
  6997         16  CT-LAST-MAINT-DT              PIC XX.
  6998         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6999         16  CT-LAST-MAINT-USER            PIC X(4).
  7000         16  FILLER                        PIC X(31).
  7001
  7002     12  CT-LIMITS.
  7003         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7004
  7005         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7006
  7007         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7008
  7009     12  CT-RATES.
  7010         16  CT-RTX          OCCURS 27 TIMES.
  7011             20  CT-RT                     PIC SV9(5)     COMP-3.
  7012             20  CT-RT-R   REDEFINES
  7013                 CT-RT                     PIC XXX.
  7014
  7015     12  FILLER                            PIC  X(42).
  7016
  7017******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 129
* EL050.cbl
  7019*    COPY ERCFORM.
  7020******************************************************************
  7021*                                                                *
  7022*                                                                *
  7023*                            ERCFORM.                            *
  7024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7025*                            VMOD=2.003                          *
  7026*                                                                *
  7027*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7028*                                                                *
  7029*    FILE TYPE = VSAM,KSDS                                       *
  7030*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7031*                                                                *
  7032*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7033*                                                                *
  7034*    LOG = YES                                                   *
  7035*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7036******************************************************************
  7037 01  FORM-MASTER.
  7038    12  FO-RECORD-ID                 PIC X(02).
  7039        88  VALID-FO-ID                  VALUE 'FO'.
  7040
  7041    12  FO-CONTROL-PRIMARY.
  7042        16  FO-COMPANY-CD            PIC X(01).
  7043        16  FO-STATE                 PIC X(02).
  7044        16  FO-FORM-ID               PIC X(12).
  7045        16  FO-FORM-EXP-DT           PIC X(02).
  7046
  7047    12  FO-POLICY-FORM-DATA.
  7048        16  FO-IND-GRP-CD            PIC X(01).
  7049        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7050        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7051        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7052        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7053        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7054        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7055        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7056        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7057        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7058        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7059        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7060        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7061        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7062        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7063        16  FO-APP-CERT-USE-CD       PIC X(01).
  7064
  7065    12  FILLER                       PIC X(29).
  7066
  7067    12  FO-FORM-PLAN-TABLE.
  7068        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7069            20  FO-PLAN-TYPE         PIC X(01).
  7070            20  FO-PLAN-ID           PIC X(02).
  7071            20  FO-PLAN-TERM         PIC 9(03).
  7072            20  FO-PLAN-REFUND-METHOD
  7073                                     PIC X.
  7074
  7075    12  FILLER                       PIC X(30).
  7076
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 130
* EL050.cbl
  7077    12  FO-COMMENTS-AREA.
  7078        16  FO-COMMENT-LINE-1        PIC X(78).
  7079
  7080    12  FILLER                       PIC X(20).
  7081
  7082    12  FO-MAINT-INFORMATION.
  7083        16  FO-LAST-MAINT-DT         PIC X(02).
  7084        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7085        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 131
* EL050.cbl
  7087*    COPY ELCMSTR.
  7088******************************************************************
  7089*                                                                *
  7090*                            ELCMSTR.                            *
  7091*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7092*                            VMOD=2.012                          *
  7093*                                                                *
  7094*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7095*                                                                *
  7096*   FILE TYPE = VSAM,KSDS                                        *
  7097*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7098*                                                                *
  7099*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7100*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7101*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7102*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7103*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7104*                                                 RKP=75,LEN=21  *
  7105*                                                                *
  7106*   **** NOTE ****                                               *
  7107*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7108*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7109*                                                                *
  7110*   LOG = YES                                                    *
  7111*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7112******************************************************************
  7113*                   C H A N G E   L O G
  7114*
  7115* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7116*-----------------------------------------------------------------
  7117*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7118* EFFECTIVE    NUMBER
  7119*-----------------------------------------------------------------
  7120* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7121* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7122******************************************************************
  7123 01  CLAIM-MASTER.
  7124     12  CL-RECORD-ID                PIC XX.
  7125         88  VALID-CL-ID         VALUE 'CL'.
  7126
  7127     12  CL-CONTROL-PRIMARY.
  7128         16  CL-COMPANY-CD           PIC X.
  7129         16  CL-CARRIER              PIC X.
  7130         16  CL-CLAIM-NO             PIC X(7).
  7131         16  CL-CERT-NO.
  7132             20  CL-CERT-PRIME       PIC X(10).
  7133             20  CL-CERT-SFX         PIC X.
  7134
  7135     12  CL-CONTROL-BY-NAME.
  7136         16  CL-COMPANY-CD-A1        PIC X.
  7137         16  CL-INSURED-LAST-NAME    PIC X(15).
  7138         16  CL-INSURED-NAME.
  7139             20  CL-INSURED-1ST-NAME PIC X(12).
  7140             20  CL-INSURED-MID-INIT PIC X.
  7141
  7142     12  CL-CONTROL-BY-SSN.
  7143         16  CL-COMPANY-CD-A2        PIC X.
  7144         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 132
* EL050.cbl
  7145             20  CL-SSN-STATE        PIC XX.
  7146             20  CL-SSN-ACCOUNT      PIC X(6).
  7147             20  CL-SSN-LN3          PIC X(3).
  7148
  7149     12  CL-CONTROL-BY-CERT-NO.
  7150         16  CL-COMPANY-CD-A4        PIC X.
  7151         16  CL-CERT-NO-A4.
  7152             20  CL-CERT-A4-PRIME    PIC X(10).
  7153             20  CL-CERT-A4-SFX      PIC X.
  7154
  7155     12  CL-CONTROL-BY-CCN.
  7156         16  CL-COMPANY-CD-A5        PIC X.
  7157         16  CL-CCN-A5.
  7158             20  CL-CCN.
  7159                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7160                 24  CL-CCN-PRIME-A5 PIC X(12).
  7161             20  CL-CCN-FILLER-A5    PIC X(4).
  7162
  7163     12  CL-INSURED-PROFILE-DATA.
  7164         16  CL-INSURED-BIRTH-DT     PIC XX.
  7165         16  CL-INSURED-SEX-CD       PIC X.
  7166             88  INSURED-IS-MALE        VALUE 'M'.
  7167             88  INSURED-IS-FEMALE      VALUE 'F'.
  7168             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7169         16  CL-INSURED-OCC-CD       PIC X(6).
  7170         16  FILLER                  PIC X(5).
  7171
  7172     12  CL-PROCESSING-INFO.
  7173         16  CL-PROCESSOR-ID         PIC X(4).
  7174         16  CL-CLAIM-STATUS         PIC X.
  7175             88  CLAIM-IS-OPEN          VALUE 'O'.
  7176             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7177         16  CL-CLAIM-TYPE           PIC X.
  7178*            88  AH-CLAIM               VALUE 'A'.
  7179*            88  LIFE-CLAIM             VALUE 'L'.
  7180*            88  PROPERTY-CLAIM         VALUE 'P'.
  7181*            88  IUI-CLAIM              VALUE 'I'.
  7182*            88  GAP-CLAIM              VALUE 'G'.
  7183         16  CL-CLAIM-PREM-TYPE      PIC X.
  7184             88  SINGLE-PREMIUM         VALUE '1'.
  7185             88  O-B-COVERAGE           VALUE '2'.
  7186             88  OPEN-END-COVERAGE      VALUE '3'.
  7187         16  CL-INCURRED-DT          PIC XX.
  7188         16  CL-REPORTED-DT          PIC XX.
  7189         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7190         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7191         16  CL-LAST-PMT-DT          PIC XX.
  7192         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7193         16  CL-PAID-THRU-DT         PIC XX.
  7194         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7195         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7196         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7197         16  CL-PMT-CALC-METHOD      PIC X.
  7198             88  CL-360-DAY-YR          VALUE '1'.
  7199             88  CL-365-DAY-YR          VALUE '2'.
  7200             88  CL-FULL-MONTHS         VALUE '3'.
  7201         16  CL-CAUSE-CD             PIC X(6).
  7202
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 133
* EL050.cbl
  7203         16  CL-PRIME-CERT-NO.
  7204             20  CL-PRIME-CERT-PRIME PIC X(10).
  7205             20  CL-PRIME-CERT-SFX   PIC X.
  7206
  7207         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7208             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7209             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7210
  7211         16  CL-MICROFILM-NO         PIC X(10).
  7212         16  CL-PROG-FORM-TYPE       PIC X.
  7213         16  CL-LAST-ADD-ON-DT       PIC XX.
  7214
  7215         16  CL-LAST-REOPEN-DT       PIC XX.
  7216         16  CL-LAST-CLOSE-DT        PIC XX.
  7217         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7218             88  FINAL-PAID             VALUE '1'.
  7219             88  CLAIM-DENIED           VALUE '2'.
  7220             88  AUTO-CLOSE             VALUE '3'.
  7221             88  MANUAL-CLOSE           VALUE '4'.
  7222             88  BENEFITS-CHANGED       VALUE 'C'.
  7223             88  SETUP-ERRORS           VALUE 'E'.
  7224         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7225         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7226         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7227             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7228         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7229         16  FILLER                  PIC X.
  7230
  7231     12  CL-CERTIFICATE-DATA.
  7232         16  CL-CERT-ORIGIN          PIC X.
  7233             88  CERT-WAS-ONLINE        VALUE '1'.
  7234             88  CERT-WAS-CREATED       VALUE '2'.
  7235             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7236         16  CL-CERT-KEY-DATA.
  7237             20  CL-CERT-CARRIER     PIC X.
  7238             20  CL-CERT-GROUPING    PIC X(6).
  7239             20  CL-CERT-STATE       PIC XX.
  7240             20  CL-CERT-ACCOUNT.
  7241                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7242                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7243             20  CL-CERT-EFF-DT      PIC XX.
  7244
  7245     12  CL-STATUS-CONTROLS.
  7246         16  CL-PRIORITY-CD          PIC X.
  7247             88  CONFIDENTIAL-DATA      VALUE '8'.
  7248             88  HIGHEST-PRIORITY       VALUE '9'.
  7249         16  CL-SUPV-ATTN-CD         PIC X.
  7250             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7251             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7252         16  CL-PURGED-DT            PIC XX.
  7253         16  CL-RESTORED-DT          PIC XX.
  7254         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7255         16  CL-NEXT-RESEND-DT       PIC XX.
  7256         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7257         16  FILLER                  PIC XX.
  7258         16  CL-LAST-MAINT-DT        PIC XX.
  7259         16  CL-LAST-MAINT-USER      PIC X(4).
  7260         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 134
* EL050.cbl
  7261         16  CL-LAST-MAINT-TYPE      PIC X.
  7262             88  CLAIM-SET-UP           VALUE ' '.
  7263             88  PAYMENT-MADE           VALUE '1'.
  7264             88  LETTER-SENT            VALUE '2'.
  7265             88  MASTER-WAS-ALTERED     VALUE '3'.
  7266             88  MASTER-WAS-RESTORED    VALUE '4'.
  7267             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7268             88  FILE-CONVERTED         VALUE '6'.
  7269             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7270             88  ERROR-CORRECTION       VALUE 'E'.
  7271         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7272         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7273         16  CL-BENEFICIARY          PIC X(10).
  7274         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7275         16  CL-DENIAL-TYPE          PIC X.
  7276             88  CL-TYPE-DENIAL          VALUE '1'.
  7277             88  CL-TYPE-RESCISSION      VALUE '2'.
  7278             88  CL-TYPE-REFORMATION     VALUE '3'.
  7279             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7280             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7281         16  FILLER                  PIC X(5).
  7282
  7283     12  CL-TRAILER-CONTROLS.
  7284         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7285             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7286             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7287             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7288         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7289         16  FILLER                  PIC XX.
  7290         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7291         16  CL-ADDRESS-TRAILER-CNT.
  7292             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7293                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7294             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7295                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7296             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7297                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7298             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7299                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7300             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7301                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7302             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7303                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7304             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7305                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7306
  7307     12  CL-CV-REFERENCE-NO.
  7308         16  CL-CV-REFNO-PRIME       PIC X(18).
  7309         16  CL-CV-REFNO-SFX         PIC XX.
  7310
  7311     12  CL-FILE-LOCATION            PIC X(4).
  7312
  7313     12  CL-PROCESS-ERRORS.
  7314         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7315             88  NO-FATAL-ERRORS        VALUE ZERO.
  7316         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7317             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7318
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 135
* EL050.cbl
  7319     12  CL-PRODUCT-CD               PIC X.
  7320
  7321     12  CL-CURRENT-KEY-DATA.
  7322         16  CL-CURRENT-CARRIER      PIC X.
  7323         16  CL-CURRENT-GROUPING     PIC X(6).
  7324         16  CL-CURRENT-STATE        PIC XX.
  7325         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7326
  7327     12  CL-ASSOCIATES               PIC X.
  7328         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7329         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7330         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7331         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7332
  7333     12  CL-ACTIVITY-CODE            PIC 99.
  7334     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7335     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7336
  7337     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7338     12  CL-LAG-REPORT-CODE          PIC 9.
  7339     12  CL-LOAN-TYPE                PIC XX.
  7340     12  CL-LEGAL-STATE              PIC XX.
  7341
  7342*    12  FILLER                      PIC X(5).
  7343     12  CL-YESNOSW                  PIC X.
  7344     12  FILLER                      PIC X(4).
  7345
  7346 01  PLAN-RECORDS.
  7347     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7348     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7349
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 136
* EL050.cbl
  7351 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7352                          ACCOUNT-MASTER REINSURANCE-RECORD
  7353                          COMM-TABLE-RECORD FORM-MASTER
  7354                          CLAIM-MASTER PLAN-RECORDS.
  7355 0000-DFHEXIT SECTION.
  7356     MOVE '9#                    $   ' TO DFHEIV0.
  7357     MOVE 'EL050' TO DFHEIV1.
  7358     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7359
  7360     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7361
  7362
  7363* EXEC CICS  HANDLE CONDITION
  7364*           ERROR    (9300-ABEND)
  7365*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7366*    END-EXEC.
  7367*    MOVE '"$.J                  ! " #00007358' TO DFHEIV0
  7368     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7370     MOVE X'2220233030303037333538' TO DFHEIV0(25:11)
  7371     CALL 'kxdfhei1' USING DFHEIV0
  7372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7373
  7374
  7375 0000-COPY-PROCEDURE-DIV.
  7376*                          COPY ELC50PD.
  7377******************************************************************
  7378*                                                                *
  7379*                            ELC50PD                             *
  7380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7381*                            VMOD=2.188                          *
  7382*                                                                *
  7383******************************************************************
  7384*                   C H A N G E   L O G
  7385*
  7386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7387*-----------------------------------------------------------------
  7388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7389* EFFECTIVE    NUMBER
  7390*-----------------------------------------------------------------
  7391* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7392* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7393* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7394*                             2709 AND 2718
  7395* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7396* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7397* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7398* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7399* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7400*                                IS OPEN OR CNC DT < PD THRU
  7401* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7402* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7403* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7404* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7405* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7406* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7407* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7408* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 137
* EL050.cbl
  7409* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7410* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7411* 020906                   PEMA  EXPAND LOAN OFFICER
  7412* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7413* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7414* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7415* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7416* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7417* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7418* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7419* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7420* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7421* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7422* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7423* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7424* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7425* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7426* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7427* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7428* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7429* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7430* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7431* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7432* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7433* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7434* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7435* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7436* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7437*                                UPDATE VIN ON CERT TRAILER
  7438* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7439* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7440* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7441* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7442* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7443* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7444* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7445* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7446* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7447* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7448* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7449* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7450* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7451* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7452* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7453* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7454* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7455* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7456* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7457* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7458* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7459* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7460* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7461* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7462* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7463* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7464* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7465* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7466* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 138
* EL050.cbl
  7467* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7468* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7469* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7470* 032912  CR2011110200001  PEMA  AHL CHANGES
  7471******************************************************************
  7472************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7473******************************************************************
  7474
  7475     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7476
  7477     MOVE SPACES                 TO PB-FATAL-FLAG
  7478                                    PB-FORCE-ER-CD
  7479                                    PB-WARN-ER-CD
  7480                                    PB-OUT-BAL-CD.
  7481
  7482     MOVE SPACE                  TO WS-IG-OVRD-AH
  7483                                    WS-IG-OVRD-LF
  7484                                    WS-IG-OVRD-AM
  7485                                    WS-IG-OVRD
  7486                                    WS-IG-OVRD-AH-PL
  7487                                    WS-IG-OVRD-LF-PL
  7488                                    WS-IG-OVRD-AH-BEN
  7489                                    WS-IG-OVRD-LF-BEN.
  7490
  7491******************************************************************
  7492*************       INITIALIZE COMMON ERRORS       ***************
  7493******************************************************************
  7494
  7495     MOVE +0                     TO PB-NO-OF-ERRORS.
  7496     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7497
  7498******************************************************************
  7499
  7500     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7501     SET JULIAN-TO-BIN           TO TRUE.
  7502*    MOVE 5                      TO DC-OPTION-CODE.
  7503     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7504     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7505
  7506     MOVE ZERO                   TO  SUB4.
  7507
  7508 0040-INITIALIZE-GA-BILL-DT.
  7509
  7510     ADD +1                      TO  SUB4.
  7511
  7512     IF  SUB4 GREATER THAN +5
  7513         GO TO 0050-CHECK-CNTL-FOUND.
  7514
  7515     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7516         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7517
  7518     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7519
  7520 0050-CHECK-CNTL-FOUND.
  7521
  7522     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7523        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7524                                         WS-AH-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 139
* EL050.cbl
  7525                                         EC-CO-REM-TERM-CALC
  7526        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7527        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7528        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7529                                         WS-TOL-AH-CLAIM
  7530        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7531                                         WS-TOL-AH-PREM
  7532                                         EC-CO-TOL-PREM
  7533        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7534                                         WS-TOL-AH-REFUND
  7535                                         EC-CO-TOL-REFUND
  7536        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7537                                         WS-AH-REFUND-OVS-AMT
  7538                                         EC-CO-OVR-SHT-AMT
  7539        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7540                                         WS-TOL-AH-PREM-PCT
  7541                                         EC-CO-TOL-PREM-PCT
  7542        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7543                                         WS-TOL-AH-REFUND-PCT
  7544                                         EC-CO-TOL-REFUND-PCT
  7545        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7546                                         WS-AH-REFUND-OVS-PCT
  7547                                         EC-CO-OVR-SHT-PCT
  7548        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7549        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7550        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7551        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7552        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7553        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7554        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7555        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7556        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7557        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7558        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7559        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7560                                         EC-CO-MONTH-END-DT
  7561        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7562          GO TO 0100-READ-ACCT.
  7563
  7564     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7565     MOVE SPACES                 TO CNTL-ACCESS.
  7566     MOVE '1'                    TO CNTL-REC-TYPE.
  7567     MOVE +0                     TO CNTL-SEQ-NO.
  7568
  7569     MOVE '1' TO RC-SW-1.
  7570     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7571     IF NOT CF-COMPANY-MASTER
  7572         MOVE ZEROS             TO WK-CO-TOL-PREM
  7573                                   WK-CO-TOL-CLAIM
  7574                                   WK-CO-TOL-REFUND
  7575                                   WK-REFUND-OVS-AMT
  7576                                   WK-REFUND-OVS-PCT
  7577                                   WK-CO-TOL-PREM-PCT
  7578                                   WK-CO-TOL-REFUND-PCT
  7579                                   WK-DEFAULT-APR
  7580                                   WK-CO-MAX-CAP
  7581        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7582                                   WK-CR-R78-METHOD
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 140
* EL050.cbl
  7583                                   WK-CO-REF-REJECT-SW
  7584                                   WK-CO-PREM-REJECT-SW
  7585                                   WK-REM-TRM-CALC-OPTION
  7586                                   WK-BIRTH-DATE-INPUT
  7587                                   WK-JOINT-AGE-INPUT
  7588        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7589        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7590        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7591        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7592          GO TO 0099-COMPANY-NOT-FOUND.
  7593
  7594     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7595        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7596     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7597        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7598     IF CF-CO-TOL-CAP NOT NUMERIC
  7599        MOVE +0                    TO CF-CO-TOL-CAP.
  7600     IF CF-DEFAULT-APR NOT NUMERIC
  7601        MOVE +0                    TO CF-DEFAULT-APR.
  7602
  7603     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7604     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7605     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7606     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7607     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7608     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7609     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7610     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7611     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7612     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7613     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7614     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7615
  7616     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7617          CF-CO-OVR-SHT-AMT > +0
  7618        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7619
  7620     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7621          CF-CO-OVR-SHT-PCT > +0
  7622        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7623
  7624     IF CF-VALID-REM-TRM-OPTION
  7625         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7626     ELSE
  7627         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7628
  7629     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7630     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7631     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7632     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7633
  7634     GO TO 0050-CHECK-CNTL-FOUND.
  7635
  7636 0099-COMPANY-NOT-FOUND.
  7637
  7638     MOVE ER-2616                TO WS-ERROR.
  7639     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7640
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 141
* EL050.cbl
  7641 0100-READ-ACCT.
  7642
  7643     MOVE SPACES                 TO DATE-RANGE-SW.
  7644
  7645     IF WK-ACCT-ADDR = ZEROS
  7646        GO TO 0102-ACCT-GETMAIN.
  7647
  7648     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7649     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7650     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7651
  7652     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7653        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7654        GO TO 0105-READ-ACCT
  7655     END-IF
  7656
  7657     IF PB-CARRIER NOT = SPACES
  7658        IF PB-CARRIER NOT = AM-VG-CARRIER
  7659           GO TO 0105-READ-ACCT.
  7660
  7661     IF PB-STATE NOT = SPACES
  7662        IF PB-STATE NOT = AM-VG-STATE
  7663           GO TO 0105-READ-ACCT.
  7664
  7665     IF PB-GROUPING NOT = SPACES
  7666        IF PB-GROUPING NOT = AM-VG-GROUPING
  7667           GO TO 0105-READ-ACCT.
  7668
  7669     MOVE 'X'                 TO DATE-RANGE-SW.
  7670
  7671     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7672        MOVE 'X'                 TO DATE-RANGE-SW
  7673        GO TO 0105-READ-ACCT.
  7674
  7675     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7676        GO TO 0105-READ-ACCT.
  7677
  7678     GO TO 0180-ACCOUNT-FOUND.
  7679
  7680 0102-ACCT-GETMAIN.
  7681     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7682     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7683
  7684 0105-READ-ACCT.
  7685     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7686     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7687     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7688     MOVE PB-STATE               TO ACCT-STATE.
  7689     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7690     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7691
  7692     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7693
  7694     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7695
  7696 0110-FIND-ACCT-TOLERANCES-LOOP.
  7697     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7698
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 142
* EL050.cbl
  7699     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7700        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7701        GO TO 0199-ACCT-NOT-FOUND
  7702     END-IF
  7703     IF PB-CARRIER NOT = SPACES
  7704        IF PB-CARRIER NOT = AM-VG-CARRIER
  7705           GO TO 0199-ACCT-NOT-FOUND.
  7706
  7707     IF PB-STATE NOT = SPACES
  7708        IF PB-STATE NOT = AM-VG-STATE
  7709           GO TO 0199-ACCT-NOT-FOUND.
  7710
  7711     IF PB-GROUPING NOT = SPACES
  7712        IF PB-GROUPING NOT = AM-VG-GROUPING
  7713           GO TO 0199-ACCT-NOT-FOUND.
  7714
  7715     MOVE 'X'                    TO DATE-RANGE-SW.
  7716
  7717     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7718        MOVE 'X'                 TO DATE-RANGE-SW
  7719        GO TO 0199-ACCT-NOT-FOUND.
  7720
  7721     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7722        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7723
  7724 0180-ACCOUNT-FOUND.
  7725     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7726     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7727     MOVE AM-STATE               TO PB-SV-STATE.
  7728     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7729
  7730     IF AM-CANCEL-FEE  NOT NUMERIC
  7731        MOVE ZEROS TO AM-CANCEL-FEE.
  7732
  7733     IF AM-MAX-MON-BEN NOT NUMERIC
  7734        MOVE ZEROS TO AM-MAX-MON-BEN.
  7735
  7736     IF AM-MAX-TOT-BEN NOT NUMERIC
  7737        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7738
  7739     IF AM-CLP-TOL-PCT NOT NUMERIC
  7740        MOVE +0                  TO AM-CLP-TOL-PCT
  7741     END-IF
  7742     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7743        MOVE +0                  TO AM-SPP-LEASE-COMM
  7744     END-IF
  7745     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7746        MOVE ER-2611             TO   WS-ERROR
  7747        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7748
  7749     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7750        MOVE ER-2621             TO   WS-ERROR
  7751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7752
  7753     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7754        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7755        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7756        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 143
* EL050.cbl
  7757         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7758
  7759     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7760     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7761     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7762     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7763     IF AM-CLP-TOL-PCT NOT = ZEROS
  7764        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7765     END-IF
  7766     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7767        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7768     END-IF
  7769*    IF PB-COMPANY-ID = 'DCC'
  7770*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7771*                                   WS-ADMIN-FEES
  7772*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7773*          (SUB5 > +10)
  7774*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7775*             AND (AM-A-COM (SUB5) NUMERIC)
  7776*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7777*                + (AM-A-COM (SUB5) * 1000)
  7778*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7779*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7780*                + (AM-A-COM (SUB5) * 1000)
  7781*             END-IF
  7782*             IF AM-COM-TYP (SUB5) = 'N'
  7783*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7784*                + (AM-A-COM (SUB5) * 1000)
  7785*             END-IF
  7786*          END-IF
  7787*       END-PERFORM
  7788*    END-IF
  7789     IF (PB-COMPANY-ID = 'DCC')
  7790        AND (PB-ISSUE)
  7791        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7792        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7793           (SUB5 > +10)
  7794           MOVE +0 TO WS-WK-RATE
  7795           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7796              IF (AM-A-COM (SUB5) NUMERIC)
  7797                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7798                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7799              ELSE
  7800                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7801                 IF PB-ISSUE
  7802                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7803                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7804                 ELSE
  7805                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7806                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7807                 END-IF
  7808                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7809                 MOVE ZEROS             TO WS-SUB1
  7810                                           WS-COMMISSION
  7811                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7812                 MOVE '0530'               TO CTBL-SW
  7813                 MOVE ' '                  TO WS-CTBL-READ-SW
  7814                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 144
* EL050.cbl
  7815                 IF FIRST-TIME-THROUGH
  7816                    MOVE 'AA'              TO CTBL-BEN-CODE
  7817                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7818                 END-IF
  7819                 IF CTBL-TABLE-FOUND
  7820                    IF PB-ISSUE
  7821                       COMPUTE WS-COMM-CK-AMT =
  7822                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7823                    ELSE
  7824                       COMPUTE WS-COMM-CK-AMT =
  7825                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7826                    END-IF
  7827                    PERFORM 8800-GET-COMP-RATE
  7828                              THRU 8800-EXIT
  7829                 END-IF
  7830              END-IF
  7831              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7832                + (WS-WK-RATE * 1000)
  7833           END-IF
  7834        END-PERFORM
  7835     END-IF
  7836     IF PB-COMPANY-ID EQUAL 'CRI'
  7837         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7838
  7839     IF PB-COMPANY-ID EQUAL 'NCL'
  7840         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7841     END-IF
  7842
  7843     GO TO 0200-READ-CERT.
  7844
  7845 0199-ACCT-NOT-FOUND.
  7846
  7847     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7848
  7849     IF DATE-RANGE-SW NOT = SPACES
  7850        MOVE ER-2601             TO WS-ERROR
  7851        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7852     ELSE
  7853        MOVE ER-2619             TO WS-ERROR
  7854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7855
  7856     GO TO 9990-RETURN.
  7857
  7858 0200-READ-CERT.
  7859
  7860     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7861     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7862     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7863     MOVE PB-SV-STATE            TO CERT-STATE.
  7864     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7865     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7866     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7867
  7868     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7869
  7870     IF CERT-WAS-NOT-FOUND
  7871        GO TO 0299-CERT-NOT-FOUND.
  7872
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 145
* EL050.cbl
  7873     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7874        MOVE ER-2759             TO WS-ERROR
  7875        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7876        GO TO 0298-UNLOCK-RETURN.
  7877
  7878     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7879         MOVE ER-2758            TO WS-ERROR
  7880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7881         GO TO 0298-UNLOCK-RETURN.
  7882
  7883     IF PB-ISSUE
  7884        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7885           IF CERT-WAS-CREATED-FOR-CLAIM
  7886              NEXT SENTENCE
  7887            ELSE
  7888              MOVE ER-2626       TO WS-ERROR
  7889              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7890              GO TO 0298-UNLOCK-RETURN.
  7891
  7892     IF NOT PB-CANCELLATION
  7893        GO TO 0300-CONTINUE-EDIT.
  7894
  7895     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7896     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7897     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7898     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7899     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7900     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7901
  7902     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7903     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7904     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7905     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7906     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7907     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7908     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7909     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7910     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7911
  7912     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7913     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7914     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7915     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7916     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7917     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7918     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7919
  7920     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7921     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7922
  7923     MOVE CM-CREDIT-INTERFACE-SW-1
  7924                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7925     MOVE CM-CREDIT-INTERFACE-SW-2
  7926                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7927
  7928     IF CM-O-B-COVERAGE
  7929         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7930
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 146
* EL050.cbl
  7931     IF CM-LIVES NOT NUMERIC
  7932         MOVE ZERO                TO CM-LIVES.
  7933
  7934     IF CM-BILLED NOT NUMERIC
  7935         MOVE ZERO                TO CM-BILLED.
  7936
  7937     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7938         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7939         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7940         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7941         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7942         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7943         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7944         MOVE CM-LIVES             TO PB-CI-LIVES
  7945*The next line causes a problem with my change  I dont think it is
  7946*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7947
  7948     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7949     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7950     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7951     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7952     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7953     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7954
  7955     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7956     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7957     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7958     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7959
  7960     IF CM-LIFE-COMM-PCT NUMERIC
  7961         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7962     ELSE
  7963         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7964
  7965     IF CM-AH-COMM-PCT NUMERIC
  7966         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7967     ELSE
  7968         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7969
  7970     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7971
  7972     IF CM-LOAN-APR       NOT NUMERIC
  7973           MOVE ZERO               TO CM-LOAN-APR.
  7974
  7975     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7976           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7977
  7978     IF CM-LOAN-TERM      NOT NUMERIC
  7979           MOVE ZERO               TO CM-LOAN-TERM.
  7980
  7981     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7982           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7983
  7984     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7985           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7986
  7987     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7988     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 147
* EL050.cbl
  7989     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7990     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7991     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7992     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7993     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7994     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  7995     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7996     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7997     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7998     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  7999
  8000     IF CM-STATE = CM-SSN-STATE
  8001         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8002
  8003     IF CM-STATE NOT = CM-MEMB-STATE
  8004         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8005
  8006     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8007
  8008     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8009        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8010        IF CM-ADDL-CLP NOT NUMERIC
  8011           MOVE +0               TO CM-ADDL-CLP
  8012        END-IF
  8013        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8014        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8015           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8016        END-IF
  8017     END-IF
  8018     IF PB-COMPANY-ID = 'DCC'
  8019        MOVE +0                  TO WS-ADMIN-FEES
  8020                                    WS-CSO-ADMIN-FEE
  8021                                    WS-COMM-AND-MFEE
  8022                                    WS-1ST-YR-ALLOW
  8023        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8024           (SUB5 > +10)
  8025           MOVE +0 TO WS-WK-RATE
  8026           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8027              IF (AM-A-COM (SUB5) NUMERIC)
  8028                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8029                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8030              ELSE
  8031                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8032                 IF PB-ISSUE
  8033                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8034                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8035                 ELSE
  8036                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8037                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8038                 END-IF
  8039                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8040                 MOVE ZEROS             TO WS-SUB1
  8041                                           WS-COMMISSION
  8042                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8043                 MOVE '0530'               TO CTBL-SW
  8044                 MOVE ' '                  TO WS-CTBL-READ-SW
  8045                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8046                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 148
* EL050.cbl
  8047                    MOVE 'AA'              TO CTBL-BEN-CODE
  8048                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8049                 END-IF
  8050                 IF CTBL-TABLE-FOUND
  8051                    IF PB-ISSUE
  8052                       COMPUTE WS-COMM-CK-AMT =
  8053                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8054                    ELSE
  8055                       COMPUTE WS-COMM-CK-AMT =
  8056                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8057                    END-IF
  8058                    PERFORM 8800-GET-COMP-RATE
  8059                              THRU 8800-EXIT
  8060                 END-IF
  8061              END-IF
  8062              IF AM-COM-TYP (SUB5) = 'I'
  8063                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8064                   + (WS-WK-RATE * 1000)
  8065              END-IF
  8066              IF AM-COM-TYP (SUB5) = 'N'
  8067                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8068                   + (WS-WK-RATE * 1000)
  8069              END-IF
  8070              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8071                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8072                   + (WS-WK-RATE * 1000)
  8073              END-IF
  8074              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8075                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8076                   + (WS-WK-RATE * 1000)
  8077              END-IF
  8078           END-IF
  8079        END-PERFORM
  8080     END-IF
  8081     GO TO 0300-CONTINUE-EDIT.
  8082
  8083 0298-UNLOCK-RETURN.
  8084      PERFORM 9250-UNLOCK-RETURN
  8085      GO TO 9990-RETURN.
  8086
  8087 0299-CERT-NOT-FOUND.
  8088
  8089     MOVE '1'                     TO CERT-STATUS-SW.
  8090
  8091     IF PB-COMPANY-ID = 'UCL'
  8092         IF WS-ERROR = ER-2799
  8093             GO TO 3000-CONTINUE-EDIT.
  8094
  8095     IF NOT PB-CANCELLATION
  8096         GO TO 0300-CONTINUE-EDIT.
  8097
  8098     MOVE ER-2726                  TO  WS-ERROR.
  8099     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8100     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8101     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8102                                    PB-CI-LF-TERM
  8103                                    PB-C-LF-REM-TERM
  8104                                    PB-CI-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 149
* EL050.cbl
  8105                                    PB-C-AH-REM-TERM
  8106                                    PB-CI-LF-BENEFIT-CD
  8107                                    PB-CI-LF-BENEFIT-AMT
  8108                                    PB-CI-LF-ALT-BENEFIT-AMT
  8109                                    PB-CI-LF-PREMIUM-AMT
  8110                                    PB-CI-LF-ALT-PREMIUM-AMT
  8111                                    PB-CI-AH-BENEFIT-CD
  8112                                    PB-CI-AH-BENEFIT-AMT
  8113                                    PB-CI-AH-PREMIUM-AMT
  8114                                    PB-CI-PAY-FREQUENCY
  8115                                    PB-CI-LOAN-APR
  8116                                    PB-CI-LOAN-TERM
  8117                                    PB-CI-LIFE-COMMISSION
  8118                                    PB-CI-AH-COMMISSION
  8119                                    PB-CI-CURR-SEQ
  8120                                    PB-CI-AH-CANCEL-AMT
  8121                                    PB-CI-LF-CANCEL-AMT
  8122                                    PB-CI-RATE-DEV-PCT-LF
  8123                                    PB-CI-RATE-DEV-PCT-AH
  8124                                    PB-CI-EXTENTION-DAYS
  8125                                    PB-CI-TERM-IN-DAYS
  8126                                    PB-CI-LIVES
  8127                                    PB-CI-LF-CRIT-PER
  8128                                    PB-CI-AH-CRIT-PER
  8129                                    PB-CI-ADDL-CLP
  8130                                    PB-CI-DDF-IU-RATE-UP.
  8131
  8132     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8133                                    PB-CI-AH-SETTLEMENT-DT
  8134                                    PB-CI-DEATH-DT
  8135                                    PB-CI-LF-PRIOR-CANCEL-DT
  8136                                    PB-CI-AH-PRIOR-CANCEL-DT
  8137                                    PB-CI-ENTRY-DT
  8138                                    PB-CI-LF-EXPIRE-DT
  8139                                    PB-CI-AH-EXPIRE-DT
  8140                                    PB-CI-LOAN-1ST-PMT-DT.
  8141
  8142     IF ACCOUNT-MAST-FOUND
  8143        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8144        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8145
  8146     GO TO 3000-CONTINUE-EDIT.
  8147
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 150
* EL050.cbl
  8149
  8150 0300-CONTINUE-EDIT.
  8151
  8152     IF PB-ISSUE
  8153        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8154            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8155
  8156     IF PB-ISSUE
  8157        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8158            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8159
  8160     IF PB-ISSUE
  8161       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8162          (AM-NO-AH-ONLY)
  8163           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8164               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8165                   MOVE ER-2679 TO WS-ERROR
  8166                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8167
  8168     IF PB-ISSUE
  8169        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8170        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8171        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8172     ELSE
  8173        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8174        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8175        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8176
  8177     MOVE 'N'                    TO PLAN-MASTER-SW
  8178                                    PLAN-MASTER-LIFE-SW
  8179                                    FORM-MASTER-SW
  8180                                    WS-APP-CERT-SW.
  8181
  8182     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8183                                    WS-PL-TOL-LF-REFUND
  8184                                    WS-PL-REF-OVS-AMT
  8185                                    WS-PL-TOL-LF-PREM-PCT
  8186                                    WS-PL-TOL-LF-REFUND-PCT
  8187                                    WS-PL-REF-OVS-PCT
  8188                                    WS-PL-TOL-LF-CLAIM.
  8189
  8190     IF PB-COMPANY-ID = 'NCL'
  8191       IF PB-ISSUE
  8192         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8193             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8194             IF FORM-MASTER-FOUND
  8195                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8196
  8197     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8198        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8199
  8200********************** MON CODE **********************
  8201     IF PB-COMPANY-ID = 'MON'
  8202     IF PB-ISSUE
  8203     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8204        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8205             PB-I-LOAN-APR = ZERO)
  8206               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 151
* EL050.cbl
  8207******************************************************
  8208
  8209     IF PB-COMPANY-ID = 'NCL'
  8210       IF PB-ISSUE
  8211           IF FORM-MASTER-FOUND
  8212             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8213                AM-DISMBR-COVERAGE
  8214                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8215                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8216                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8217                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8218                                           PB-I-LIFE-BENEFIT-CD.
  8219
  8220     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8221
  8222     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8223         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8224         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8225         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8226         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8227         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8228           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8229             GO TO 0301-LIFE-BENEFIT-SEARCH
  8230         ELSE
  8231             NEXT SENTENCE
  8232     ELSE
  8233         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8234
  8235     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8236     MOVE '4'                    TO CNTL-REC-TYPE.
  8237     MOVE +0                     TO CNTL-SEQ-NO.
  8238     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8239
  8240     MOVE '1' TO RC-SW-2.
  8241     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8242
  8243     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8244        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8245         GO TO 0305-BENEFIT-NOT-FOUND.
  8246
  8247     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8248
  8249 0301-LIFE-BENEFIT-SEARCH.
  8250
  8251     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8252
  8253     IF NO-BENEFIT-FOUND
  8254        GO TO 0305-BENEFIT-NOT-FOUND.
  8255
  8256     IF WS-BEN-CD = '99'
  8257        GO TO 0305-BENEFIT-NOT-FOUND.
  8258
  8259     IF PB-COMPANY-ID = 'NCL'
  8260         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8261             GO TO 0304-LIFE-BENEFIT-FOUND.
  8262
  8263     MOVE +1                     TO SUB5.
  8264     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 152
* EL050.cbl
  8265
  8266* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8267* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8268     IF PB-COMPANY-ID = 'DMD'
  8269         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8270
  8271 0302-EDIT-ACCT-LF-BENEFITS.
  8272
  8273     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8274        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8275           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8276                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8277           GO TO 03XX-GET-LIFE-ERPLAN.
  8278
  8279     IF SUB5 LESS THAN +20
  8280        ADD +1                   TO SUB5
  8281        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8282
  8283     MOVE +1                     TO SUB5.
  8284
  8285     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8286        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8287
  8288 0303-EDIT-DMD-EXTRA-BENEFITS.
  8289
  8290     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8291        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8292           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8293                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8294           GO TO 03XX-GET-LIFE-ERPLAN.
  8295
  8296     IF SUB5 LESS THAN +30
  8297        ADD +1                   TO SUB5
  8298        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8299
  8300     MOVE +1                     TO SUB5.
  8301
  8302 03XX-EDIT-FOR-NINETY-LF.
  8303
  8304***************************************************************
  8305*                                                             *
  8306*    NINETY BENEFIT PLAN TYPES:                               *
  8307*                                                             *
  8308*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8309*      92 = ALL GROUP REDUCING BENEFITS                       *
  8310*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8311*      94 = ALL GROUP LEVEL BENEFITS                          *
  8312*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8313*           BENEFIT CONTROLS.                                 *
  8314*      99 = ALL BENEFITS                                      *
  8315*                                                             *
  8316***************************************************************
  8317
  8318     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8319                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8320
  8321     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8322       AND
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 153
* EL050.cbl
  8323        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8324        GO TO 03XX-GET-LIFE-ERPLAN.
  8325
  8326     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8327       AND
  8328        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8329        IF CF-REDUCING (SUB3)
  8330           IF (PB-I-INDV-GRP-OVRD = 'I')
  8331              OR
  8332           ((AM-IG = '1') AND
  8333           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8334              OR
  8335           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8336           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8337           (AM-IG NOT = '2'))
  8338              GO TO 03XX-GET-LIFE-ERPLAN.
  8339
  8340     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8341       AND
  8342        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8343        IF CF-REDUCING (SUB3)
  8344           IF (PB-I-INDV-GRP-OVRD = 'G')
  8345              OR
  8346           ((AM-IG = '2') AND
  8347           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8348              OR
  8349           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8350           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8351           (AM-IG NOT = '1'))
  8352              GO TO 03XX-GET-LIFE-ERPLAN.
  8353
  8354     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8355       AND
  8356        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8357        IF CF-LEVEL    (SUB3)
  8358           IF (PB-I-INDV-GRP-OVRD = 'I')
  8359              OR
  8360           ((AM-IG = '1') AND
  8361           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8362              OR
  8363           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8364           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8365            (AM-IG NOT = '2'))
  8366              GO TO 03XX-GET-LIFE-ERPLAN.
  8367
  8368     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8369       AND
  8370        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8371        IF CF-LEVEL    (SUB3)
  8372           IF (PB-I-INDV-GRP-OVRD = 'G')
  8373              OR
  8374           ((AM-IG = '2') AND
  8375           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8376              OR
  8377           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8378           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8379           (AM-IG NOT = '1'))
  8380              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 154
* EL050.cbl
  8381
  8382     IF SUB5 LESS THAN +20
  8383        ADD +1                   TO SUB5
  8384        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8385
  8386     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8387
  8388     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8389        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8390
  8391     MOVE +1                     TO SUB5.
  8392
  8393 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8394
  8395     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8396                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8397
  8398     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8399       AND
  8400        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8401        GO TO 03XX-GET-LIFE-ERPLAN.
  8402
  8403     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8404       AND
  8405        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8406        IF CF-REDUCING (SUB3)
  8407           IF (PB-I-INDV-GRP-OVRD = 'I')
  8408              OR
  8409           ((AM-IG = '1') AND
  8410           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8411              OR
  8412           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8413           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8414           (AM-IG NOT = '2'))
  8415              GO TO 03XX-GET-LIFE-ERPLAN.
  8416
  8417     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8418       AND
  8419        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8420        IF CF-REDUCING (SUB3)
  8421           IF (PB-I-INDV-GRP-OVRD = 'G')
  8422              OR
  8423           ((AM-IG = '2') AND
  8424           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8425              OR
  8426           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8427           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8428           (AM-IG NOT = '1'))
  8429              GO TO 03XX-GET-LIFE-ERPLAN.
  8430
  8431     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8432       AND
  8433        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8434        IF CF-LEVEL    (SUB3)
  8435           IF (PB-I-INDV-GRP-OVRD = 'I')
  8436              OR
  8437           ((AM-IG = '1') AND
  8438           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 155
* EL050.cbl
  8439              OR
  8440           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8441           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8442            (AM-IG NOT = '2'))
  8443              GO TO 03XX-GET-LIFE-ERPLAN.
  8444
  8445     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8446       AND
  8447        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8448        IF CF-LEVEL    (SUB3)
  8449           IF (PB-I-INDV-GRP-OVRD = 'G')
  8450              OR
  8451           ((AM-IG = '2') AND
  8452           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8453              OR
  8454           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8455           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8456           (AM-IG NOT = '1'))
  8457              GO TO 03XX-GET-LIFE-ERPLAN.
  8458
  8459     IF SUB5 LESS THAN +30
  8460        ADD +1                   TO SUB5
  8461        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8462
  8463     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8464
  8465 03XX-EDIT-FOR-NINETY-LF-CONT.
  8466
  8467     MOVE +99                    TO SUB5.
  8468
  8469     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8470        IF PB-ISSUE
  8471           MOVE ER-1924          TO  WS-ERROR
  8472           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8473
  8474     GO TO 0304-LIFE-BENEFIT-FOUND.
  8475
  8476 03XX-GET-LIFE-ERPLAN.
  8477
  8478     IF WK-PLAN-ADDR EQUAL +0
  8479        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8480
  8481     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8482     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8483     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8484     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8485     MOVE 'Y'                    TO PLAN-MASTER-SW
  8486                                    PLAN-MASTER-LIFE-SW.
  8487     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8488
  8489 03XX-ERPLAN-LIFE-GETMAIN.
  8490
  8491     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8492     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8493
  8494 03XX-ERPLAN-LIFE-READ.
  8495
  8496     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 156
* EL050.cbl
  8497     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8498     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8499     MOVE PB-SV-STATE            TO PLAN-STATE.
  8500     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8501     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8502     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8503     MOVE WS-SAVE-BENEFIT-REVISION
  8504                                 TO PLAN-REVISION-NO.
  8505
  8506     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8507     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8508
  8509     IF PB-COMPANY-ID = 'NCL'
  8510       IF NOT LF-PLAN-MASTER-FOUND
  8511         IF NOT PB-POLICY-IS-DECLINED  AND
  8512            NOT PB-POLICY-IS-VOIDED
  8513             MOVE  ER-1921         TO  WS-ERROR
  8514             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8515             GO TO 0304-LIFE-BENEFIT-FOUND.
  8516
  8517     IF NOT LF-PLAN-MASTER-FOUND
  8518        GO TO 0304-LIFE-BENEFIT-FOUND.
  8519
  8520 XXXX-CHECK-LF-PLAN-KEY.
  8521
  8522     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8523        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8524        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8525        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8526        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8527        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8528        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8529        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8530        MOVE 'N'                 TO PLAN-MASTER-SW
  8531          GO TO 03XX-ERPLAN-LIFE-READ.
  8532
  8533     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8534
  8535     IF  PB-CANCELLATION
  8536         GO TO  0303-LF-ACCT-BEN-FOUND.
  8537
  8538     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8539        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8540           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8541           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8542              MOVE ER-2644             TO WS-ERROR
  8543              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8544           ELSE
  8545              NEXT SENTENCE
  8546        ELSE
  8547           IF PB-COMPANY-ID NOT = 'NCL'
  8548              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8549                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8550
  8551 0303-LF-ACCT-BEN-FOUND.
  8552
  8553     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8554
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 157
* EL050.cbl
  8555     IF PL-DEV-CODE NOT = SPACES
  8556        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8557
  8558     IF PL-DEV-PCT NUMERIC AND
  8559        PL-DEV-PCT NOT = ZEROS
  8560        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8561
  8562     IF PL-TOL-PREM-AMT GREATER THAN +0
  8563        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8564
  8565     IF PL-TOL-REF-AMT GREATER THAN +0
  8566        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8567
  8568     IF PL-TOL-PREM-PCT GREATER THAN +0
  8569        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8570
  8571     IF PL-TOL-REF-PCT GREATER THAN +0
  8572        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8573
  8574     IF PL-TOL-CLM-AMT GREATER THAN +0
  8575        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8576
  8577     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8578                          PL-OVER-SHORT-AMT > +0
  8579        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8580
  8581     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8582                          PL-OVER-SHORT-PCT > +0
  8583        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8584
  8585     IF PL-SALES-TAX NUMERIC AND
  8586                          PL-SALES-TAX > +0
  8587         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8588
  8589     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8590        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8591                                    WS-IG-OVRD-AM.
  8592
  8593 0304-LIFE-BENEFIT-FOUND.
  8594
  8595     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8596
  8597     IF PB-ISSUE
  8598        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8599     ELSE
  8600        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8601
  8602     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8603     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8604     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8605     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8606     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8607                                         WS-LF-REFUND-CALC.
  8608
  8609     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8610        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8611
  8612     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 158
* EL050.cbl
  8613        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8614     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8615
  8616     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8617     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8618     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8619     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8620     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8621     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8622
  8623     IF PB-COMPANY-ID = 'NCL'  AND
  8624        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8625         NEXT SENTENCE
  8626     ELSE
  8627         IF SUB5 NOT GREATER THAN +20
  8628            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8629               MOVE WS-SAVE-BENEFIT-REM-TERM
  8630                                      TO WS-AM-LF-BENE-REM-TERM
  8631                                         EC-BR-LF-REM-TERM-CALC.
  8632
  8633     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8634     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8635
  8636     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8637
  8638 0305-BENEFIT-NOT-FOUND.
  8639
  8640     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8641     MOVE ER-2604                TO WS-ERROR.
  8642     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8643
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 159
* EL050.cbl
  8645
  8646 0310-FIND-AH-BENEFIT-RECORD.
  8647
  8648     MOVE 'N'                    TO PLAN-MASTER-SW
  8649                                    PLAN-MASTER-AH-SW.
  8650
  8651     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8652                                    WS-PL-TOL-AH-REFUND
  8653                                    WS-AH-PL-REF-OVS-AMT
  8654                                    WS-PL-TOL-AH-PREM-PCT
  8655                                    WS-PL-TOL-AH-REFUND-PCT
  8656                                    WS-AH-PL-REF-OVS-PCT
  8657                                    WS-PL-TOL-AH-CLAIM.
  8658     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8659
  8660
  8661     if pb-issue
  8662        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8663           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8664        end-if
  8665        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8666           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8667           GO TO 0399-BENEFIT-NOT-FOUND
  8668        end-if
  8669     end-if
  8670
  8671     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8672        GO TO 0400-FIND-CARRIER.
  8673
  8674     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8675
  8676     IF WK-AH-BEN-ADDR NOT = ZEROS
  8677         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8678         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8679         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8680         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8681           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8682             GO TO 0311-AH-BENEFIT-SEARCH
  8683         ELSE
  8684             NEXT SENTENCE
  8685     ELSE
  8686         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8687
  8688     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8689     MOVE '5'                    TO CNTL-REC-TYPE.
  8690     MOVE +0                     TO CNTL-SEQ-NO.
  8691     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8692
  8693     MOVE '2' TO RC-SW-2.
  8694     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8695
  8696     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8697        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8698          GO TO 0399-BENEFIT-NOT-FOUND.
  8699
  8700     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8701
  8702 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 160
* EL050.cbl
  8703
  8704     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8705
  8706     IF NO-BENEFIT-FOUND
  8707         GO TO 0399-BENEFIT-NOT-FOUND.
  8708
  8709     IF WS-BEN-CD = '99'
  8710        GO TO 0399-BENEFIT-NOT-FOUND.
  8711
  8712     IF PB-COMPANY-ID  =  'NCL'
  8713         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8714             GO TO 0314-A-H-BENEFIT-FOUND.
  8715
  8716     MOVE +1                     TO SUB5.
  8717     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8718
  8719* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8720* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8721     IF PB-COMPANY-ID = 'DMD'
  8722         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8723
  8724 0312-EDIT-ACCT-AH-BENEFITS.
  8725
  8726     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8727        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8728           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8729                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8730           GO TO 03XX-GET-AH-ERPLAN.
  8731
  8732     IF SUB5 LESS THAN +20
  8733        ADD +1                   TO SUB5
  8734        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8735
  8736     MOVE +1                     TO SUB5.
  8737
  8738     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8739        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8740
  8741 0313-EDIT-DMD-EXTRA-BENEFITS.
  8742
  8743     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8744        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8745           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8746                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8747           GO TO 03XX-GET-AH-ERPLAN.
  8748
  8749     IF SUB5 LESS THAN +30
  8750        ADD +1                   TO SUB5
  8751        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8752
  8753     MOVE +1                     TO SUB5.
  8754
  8755 03XX-EDIT-FOR-NINETY-AH.
  8756
  8757***************************************************************
  8758*                                                             *
  8759*    NINETY BENEFIT PLAN TYPES:                               *
  8760*                                                             *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 161
* EL050.cbl
  8761*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8762*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8763*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8764*           BENEFIT CONTROLS.                                 *
  8765*      99 = ALL BENEFITS.                                     *
  8766*                                                             *
  8767***************************************************************
  8768
  8769     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8770                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8771
  8772     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8773       AND
  8774        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8775        GO TO 03XX-GET-AH-ERPLAN.
  8776
  8777     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8778       AND
  8779        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8780           IF (PB-I-INDV-GRP-OVRD = 'I')
  8781              OR
  8782           ((AM-IG = '1') AND
  8783           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8784              OR
  8785           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8786           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8787           (AM-IG NOT = '2'))
  8788              GO TO 03XX-GET-AH-ERPLAN.
  8789
  8790     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8791       AND
  8792        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8793           IF (PB-I-INDV-GRP-OVRD = 'G')
  8794              OR
  8795           ((AM-IG = '2') AND
  8796           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8797              OR
  8798           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8799           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8800           (AM-IG NOT = '1'))
  8801              GO TO 03XX-GET-AH-ERPLAN.
  8802
  8803     IF SUB5 LESS THAN +20
  8804        ADD +1                   TO SUB5
  8805        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8806
  8807     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8808        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8809
  8810     MOVE +1                    TO SUB5.
  8811
  8812 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8813
  8814     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8815                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8816
  8817     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8818       AND
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 162
* EL050.cbl
  8819        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8820        GO TO 03XX-GET-AH-ERPLAN.
  8821
  8822     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8823       AND
  8824        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8825           IF (PB-I-INDV-GRP-OVRD = 'I')
  8826              OR
  8827           ((AM-IG = '1') AND
  8828           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8829              OR
  8830           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8831           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8832           (AM-IG NOT = '2'))
  8833              GO TO 03XX-GET-AH-ERPLAN.
  8834
  8835     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8836       AND
  8837        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8838           IF (PB-I-INDV-GRP-OVRD = 'G')
  8839              OR
  8840           ((AM-IG = '2') AND
  8841           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8842              OR
  8843           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8844           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8845           (AM-IG NOT = '1'))
  8846              GO TO 03XX-GET-AH-ERPLAN.
  8847
  8848     IF SUB5 LESS THAN +30
  8849        ADD +1                   TO SUB5
  8850        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8851
  8852 03XX-EDIT-FOR-NINETY-AH-CONT.
  8853
  8854     MOVE +99                    TO SUB5.
  8855
  8856     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8857
  8858     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8859        IF PB-ISSUE
  8860           MOVE ER-1925          TO  WS-ERROR
  8861           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8862
  8863     GO TO 0314-A-H-BENEFIT-FOUND.
  8864
  8865 03XX-GET-AH-ERPLAN.
  8866
  8867     IF WK-PLAN-ADDR EQUAL +0
  8868         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8869
  8870     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8871     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8872     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8873     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8874     MOVE 'Y'                    TO PLAN-MASTER-SW
  8875                                    PLAN-MASTER-AH-SW.
  8876*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 163
* EL050.cbl
  8877     GO TO 03XX-ERPLAN-AH-READ.
  8878
  8879 03XX-ERPLAN-AH-GETMAIN.
  8880
  8881     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8882     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8883
  8884 03XX-ERPLAN-AH-READ.
  8885
  8886     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8887     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8888     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8889     MOVE PB-SV-STATE            TO PLAN-STATE.
  8890     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8891     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8892     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8893     MOVE WS-SAVE-BENEFIT-REVISION
  8894                                 TO PLAN-REVISION-NO.
  8895
  8896     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8897     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8898
  8899     IF PB-COMPANY-ID = 'NCL'
  8900       IF NOT AH-PLAN-MASTER-FOUND
  8901         IF NOT PB-POLICY-IS-DECLINED  AND
  8902            NOT PB-POLICY-IS-VOIDED
  8903             MOVE  ER-1922         TO  WS-ERROR
  8904             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8905             GO TO 0314-A-H-BENEFIT-FOUND.
  8906
  8907     IF NOT AH-PLAN-MASTER-FOUND
  8908        GO TO 0314-A-H-BENEFIT-FOUND.
  8909
  8910 XXXX-CHECK-AH-PLAN-KEY.
  8911
  8912     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8913        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8914        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8915        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8916        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8917        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8918        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8919        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8920        MOVE 'N'                 TO PLAN-MASTER-SW
  8921          GO TO 03XX-ERPLAN-AH-READ.
  8922
  8923     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8924
  8925     IF  PB-CANCELLATION
  8926         GO TO  0313-AH-ACCT-BEN-FOUND.
  8927
  8928     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8929       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8930          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8931          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8932             MOVE ER-2644             TO WS-ERROR
  8933             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8934          ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 164
* EL050.cbl
  8935             NEXT SENTENCE
  8936       ELSE
  8937          IF PB-COMPANY-ID NOT = 'NCL'
  8938             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8939                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8940
  8941 0313-AH-ACCT-BEN-FOUND.
  8942
  8943     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8944
  8945     IF PL-DEV-CODE NOT = SPACES
  8946        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8947
  8948     IF PL-DEV-PCT NUMERIC AND
  8949        PL-DEV-PCT NOT = ZEROS
  8950        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8951
  8952     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8953        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8954
  8955     IF PL-TOL-REF-AMT NOT EQUAL +0
  8956        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8957
  8958     IF PL-TOL-PREM-PCT GREATER THAN +0
  8959        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8960
  8961     IF PL-TOL-REF-PCT GREATER THAN +0
  8962        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8963
  8964     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8965        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8966
  8967     IF PL-OVER-SHORT-AMT NUMERIC AND
  8968                          PL-OVER-SHORT-AMT > +0
  8969        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8970
  8971     IF PL-OVER-SHORT-PCT NUMERIC AND
  8972                          PL-OVER-SHORT-PCT > +0
  8973        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8974
  8975     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8976        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8977        IF WS-IG-OVRD-AM EQUAL SPACES
  8978            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8979
  8980 0314-A-H-BENEFIT-FOUND.
  8981
  8982     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8983
  8984     IF PB-ISSUE
  8985        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8986       ELSE
  8987        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8988
  8989     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8990     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8991     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8992     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 165
* EL050.cbl
  8993                                         WS-AH-REFUND-CALC.
  8994
  8995     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8996        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  8997
  8998     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8999        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9000     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9001
  9002     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9003     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9004     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9005     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9006     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9007     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9008
  9009     IF PB-COMPANY-ID = 'NCL'  AND
  9010        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9011         NEXT SENTENCE
  9012     ELSE
  9013         IF SUB5 NOT GREATER THAN +20
  9014            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9015                MOVE WS-SAVE-BENEFIT-REM-TERM
  9016                                      TO WS-AM-AH-BENE-REM-TERM
  9017                                         EC-BR-AH-REM-TERM-CALC.
  9018
  9019     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9020     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9021
  9022     GO TO 0400-FIND-CARRIER.
  9023
  9024 0399-BENEFIT-NOT-FOUND.
  9025
  9026     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9027     MOVE ER-2605                TO WS-ERROR.
  9028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9029
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 166
* EL050.cbl
  9031
  9032 0400-FIND-CARRIER.
  9033
  9034     MOVE PB-SV-CARRIER          TO WS-CARR.
  9035
  9036     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9037     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9038     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9039     MOVE '6'                    TO CNTL-REC-TYPE.
  9040
  9041*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9042     MOVE SPACE                  TO WS-DMD-RATING-SW
  9043                                    EC-BR-DMD-RATING-SW.
  9044
  9045     MOVE '2'                    TO RC-SW-1.
  9046     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9047
  9048     IF NOT CF-CARRIER-MASTER
  9049        GO TO 0400-CARRIER-NOT-FOUND.
  9050
  9051 0400-BUILD-CARR-TOL.
  9052
  9053     IF CF-CR-TOL-PREM NUMERIC AND
  9054        CF-CR-TOL-PREM GREATER THAN +0
  9055        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9056                                    WS-TOL-AH-PREM.
  9057
  9058     IF CF-CR-TOL-REFUND NUMERIC AND
  9059        CF-CR-TOL-REFUND GREATER THAN +0
  9060        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9061                                    WS-TOL-AH-REFUND.
  9062
  9063     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9064        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9065        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9066                                    WS-AH-REFUND-OVS-AMT.
  9067
  9068     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9069        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9070        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9071                                    WS-AH-REFUND-OVS-PCT.
  9072
  9073     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9074        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9075        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9076                                    WS-TOL-AH-PREM-PCT.
  9077
  9078     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9079        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9080        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9081                                     WS-TOL-AH-REFUND-PCT.
  9082
  9083     IF CF-COMPANY-ID EQUAL 'DMD'
  9084         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9085                                    EC-BR-DMD-RATING-SW.
  9086
  9087     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9088     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 167
* EL050.cbl
  9089        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9090     END-IF
  9091     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9092        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9093     END-IF
  9094     IF WS-TOL-CLP-PCT = ZEROS
  9095        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9096     END-IF
  9097
  9098     IF WS-SPP-LEASE-COMM = ZEROS
  9099        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9100     END-IF
  9101     GO TO 0400-FIND-ERPDEF.
  9102
  9103 0400-CARRIER-NOT-FOUND.
  9104
  9105     MOVE ER-2602                TO WS-ERROR.
  9106     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9107
  9108 0400-FIND-ERPDEF.
  9109     IF PB-COMPANY-ID = 'DCC'
  9110        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9111        CONTINUE
  9112     ELSE
  9113        GO TO 0400-FIND-ERCOMP
  9114     END-IF
  9115     MOVE ' '                    TO PDEF-MASTER-SW
  9116     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9117     MOVE PB-STATE               TO ERPDEF-STATE
  9118     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9119     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9120     IF PB-ISSUE
  9121        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9122     ELSE
  9123        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9124     END-IF
  9125     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9126     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9127     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9128     IF PDEF-MASTER-FOUND
  9129        MOVE 'N'                 TO PDEF-MASTER-SW
  9130        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9131        IF PDEF-MASTER-FOUND
  9132           IF (ERPDEF-KEY-SAVE (1:16) =
  9133                        PD-CONTROL-PRIMARY (1:16))
  9134              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9135              CONTINUE
  9136           ELSE
  9137              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9138              IF (ERPDEF-KEY-SAVE (1:16) =
  9139                        PD-CONTROL-PRIMARY (1:16))
  9140                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9141                 CONTINUE
  9142              ELSE
  9143                 MOVE 'N'        TO PDEF-MASTER-SW
  9144              END-IF
  9145           END-IF
  9146        END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 168
* EL050.cbl
  9147        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9148     END-IF
  9149     IF PDEF-MASTER-FOUND
  9150        IF PD-TRUNCATED = 'Y'
  9151           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9152        END-IF
  9153     END-IF
  9154     .
  9155 0400-FIND-ERCOMP.
  9156     IF PB-COMPANY-ID = 'DCC'
  9157        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9158           (WS-SUB1 > +10)
  9159           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9160                 OR 'A' OR 'N'
  9161              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9162              MOVE PB-CARRIER    TO COMP-CARRIER
  9163              MOVE PB-GROUPING   TO COMP-GROUPING
  9164              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9165              MOVE AM-AGT (WS-SUB1)
  9166                                 TO COMP-FIN-RESP
  9167              MOVE 'G'           TO COMP-TYPE
  9168              PERFORM 8582-READ-COMPENSATION-MASTER
  9169                                 THRU 8582-EXIT
  9170              IF COMP-MASTER-FOUND
  9171                 IF CO-GA-INACTIVE
  9172                    MOVE ER-2763 TO WS-ERROR
  9173                    PERFORM 9900-ERROR-FORMAT
  9174                                 THRU 9900-EXIT
  9175                    MOVE +11     TO WS-SUB1
  9176                 END-IF
  9177                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9178                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9179                    MOVE ER-2788 TO WS-ERROR
  9180                    PERFORM 9900-ERROR-FORMAT
  9181                                 THRU 9900-EXIT
  9182                    MOVE +11     TO WS-SUB1
  9183                 END-IF
  9184              END-IF
  9185           END-IF
  9186        END-PERFORM
  9187     END-IF
  9188     IF (PB-COMPANY-ID = 'DCC')
  9189               AND
  9190        ((WS-LF-BEN-CATEGORY = 'D')
  9191        OR (WS-AH-BEN-CATEGORY = 'D')
  9192        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9193        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9194           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9195                                    WS-CLP-STATE
  9196        ELSE
  9197           MOVE SPACES           TO PB-I-CLP-STATE
  9198                                    WS-CLP-STATE
  9199        END-IF
  9200     END-IF
  9201
  9202     IF (PB-COMPANY-ID = 'DCC')
  9203        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9204        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 169
* EL050.cbl
  9205        CONTINUE
  9206     ELSE
  9207        GO TO 0400-FIND-STATE-RECORD
  9208     END-IF
  9209     MOVE SPACES                 TO WS-CLP-STATE
  9210     MOVE +0                     TO WS-BANK-FEE
  9211                                    WS-BANK-LFEE
  9212                                    WS-BANK-NOCHRGB
  9213
  9214     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9215     IF (PB-ISSUE)
  9216        AND (PB-I-BANK-NUMBER NOT =
  9217            SPACES AND ZEROS AND LOW-VALUES)
  9218        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9219     ELSE
  9220        IF (PB-CANCELLATION)
  9221           AND (PB-CI-BANK-NUMBER NOT =
  9222                SPACES AND ZEROS AND LOW-VALUES)
  9223           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9224        END-IF
  9225     END-IF
  9226     IF COMP-FIN-RESP NOT = LOW-VALUES
  9227        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9228        MOVE PB-CARRIER          TO COMP-CARRIER
  9229        MOVE PB-GROUPING         TO COMP-GROUPING
  9230        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9231        MOVE 'B'                 TO COMP-TYPE
  9232        PERFORM 8582-READ-COMPENSATION-MASTER
  9233                                 THRU 8582-EXIT
  9234        IF COMP-MASTER-FOUND
  9235           IF CO-MAX-BANK-FEE NOT NUMERIC
  9236              MOVE +0            TO CO-MAX-BANK-FEE
  9237           END-IF
  9238           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9239              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9240           END-IF
  9241           IF CO-GA-INACTIVE
  9242              MOVE ER-2763       TO WS-ERROR
  9243              PERFORM 9900-ERROR-FORMAT
  9244                                 THRU 9900-EXIT
  9245           END-IF
  9246           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9247              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9248              MOVE ER-2788 TO WS-ERROR
  9249              PERFORM 9900-ERROR-FORMAT
  9250                                 THRU 9900-EXIT
  9251              MOVE +11     TO WS-SUB1
  9252           END-IF
  9253           IF WS-AH-BEN-CATEGORY = 'G'
  9254              MOVE CO-MAX-BANK-FEE
  9255                                 TO WS-BANK-FEE
  9256                                    PB-I-BANK-FEE
  9257           ELSE
  9258              MOVE CO-MAX-BANK-FEE-LEASE
  9259                                 TO WS-BANK-LFEE
  9260                                    PB-I-BANK-FEE
  9261           END-IF
  9262           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 170
* EL050.cbl
  9263              AND (WS-AH-REFUND-CALC = 'G'))
  9264                        OR
  9265              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9266              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9267              CONTINUE
  9268           ELSE
  9269              MOVE ER-2789 TO WS-ERROR
  9270              PERFORM 9900-ERROR-FORMAT
  9271                                 THRU 9900-EXIT
  9272           END-IF
  9273           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9274                                    PB-I-CLP-STATE
  9275           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9276           MOVE CO-CARRIER       TO BXRF-CARRIER
  9277           MOVE CO-GROUPING      TO BXRF-GROUPING
  9278           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9279           MOVE BXRF-MAX-REC-LENGTH
  9280                                 TO BXRF-REC-LENGTH
  9281           PERFORM 8584-READ-BANK-CROSS-REF
  9282                                 THRU 8584-EXIT
  9283           IF BXRF-MASTER-FOUND
  9284              MOVE ' '           TO BANK-ACCT-SW
  9285              MOVE BK-BANK-POINTER-CNT
  9286                                 TO BK-BANK-POINTER-CNT
  9287              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9288                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9289                 OR (BANK-ACCT-FOUND)
  9290                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9291                    AND (BK-AM-EXP-DT (WS-SUB1)
  9292                                 > PB-CERT-EFF-DT)
  9293                    AND (BK-AM-EFF-DT (WS-SUB1)
  9294                                 NOT > PB-CERT-EFF-DT)
  9295                    SET BANK-ACCT-FOUND TO TRUE
  9296                 END-IF
  9297              END-PERFORM
  9298              IF NOT BANK-ACCT-FOUND
  9299                 MOVE ZEROS      TO WS-BANK-FEE
  9300                                    WS-BANK-LFEE
  9301                 MOVE ER-2869    TO WS-ERROR
  9302                 PERFORM 9900-ERROR-FORMAT
  9303                                 THRU 9900-EXIT
  9304              ELSE
  9305                 PERFORM 5000-PROCESS-REPS
  9306                                 THRU 5000-EXIT
  9307                 IF AGENT-MASTER-FOUND
  9308                    MOVE +0      TO WS-BANK-FEE
  9309                                    WS-BANK-LFEE
  9310*                   MOVE AG-SPP-FEES (1)
  9311*                                TO PB-I-BANK-FEE
  9312*                                   WS-BANK-FEE
  9313                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9314                       (WS-SUB1 > +10)
  9315                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9316                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9317                       END-IF
  9318                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9319                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9320                       END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 171
* EL050.cbl
  9321                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9322                          AG-SPP-FEES (WS-SUB1)
  9323                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9324                          AG-SPP-LFEES (WS-SUB1)
  9325                    END-PERFORM
  9326                    IF WS-AH-BEN-CATEGORY = 'G'
  9327                       MOVE WS-BANK-FEE
  9328                                 TO PB-I-BANK-FEE
  9329                    ELSE
  9330                       MOVE WS-BANK-LFEE
  9331                                 TO PB-I-BANK-FEE
  9332                    END-IF
  9333                 END-IF
  9334              END-IF
  9335           END-IF
  9336        ELSE
  9337           MOVE ER-2879          TO WS-ERROR
  9338           PERFORM 9900-ERROR-FORMAT
  9339                                 THRU 9900-EXIT
  9340        END-IF
  9341     ELSE
  9342        MOVE ER-2879             TO WS-ERROR
  9343        PERFORM 9900-ERROR-FORMAT
  9344                                 THRU 9900-EXIT
  9345     END-IF
  9346     IF WS-AH-BEN-CATEGORY = 'G'
  9347        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9348        + WS-BANK-FEE
  9349     ELSE
  9350        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9351        + WS-BANK-LFEE
  9352     END-IF
  9353     .
  9354 0400-FIND-STATE-RECORD.
  9355
  9356     IF WK-STATE-ADDR NOT = ZEROS
  9357         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9358         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9359         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9360         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9361         IF PB-SV-STATE = CF-STATE-CODE
  9362             GO TO 0405-CONTINUE-EDIT
  9363         ELSE
  9364             NEXT SENTENCE
  9365     ELSE
  9366         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9367
  9368     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9369     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9370     MOVE '3'                    TO CNTL-REC-TYPE.
  9371     MOVE +0                     TO CNTL-SEQ-NO.
  9372
  9373     MOVE '3'                    TO RC-SW-2.
  9374     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9375
  9376     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9377        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9378        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 172
* EL050.cbl
  9379        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9380                                    WS-TOL-AH-CLAIM
  9381                                    WS-MINIMUM-REFUND
  9382                                    WS-TOL-LF-PREM
  9383                                    WS-TOL-AH-PREM
  9384                                    WS-TOL-LF-REFUND
  9385                                    WS-TOL-AH-REFUND
  9386                                    EC-ST-TOL-PREM-PCT
  9387                                    WS-TOL-LF-PREM-PCT
  9388                                    WS-TOL-AH-PREM-PCT
  9389                                    EC-ST-TOL-REFUND-PCT
  9390                                    WS-TOL-LF-REFUND-PCT
  9391                                    WS-TOL-AH-REFUND-PCT
  9392                                    EC-ST-TOL-PREM
  9393                                    EC-ST-TOL-REFUND
  9394                                    EC-ST-FST-PMT-DAYS-MAX
  9395                                    WS-FREE-LOOK-PERIOD
  9396                                    WS-ST-LF-PREM-TAX
  9397                                    WS-ST-AH-PREM-TAX-I
  9398                                    WS-ST-AH-PREM-TAX-G
  9399                                    WS-BANK-FEE
  9400                                    WS-BANK-LFEE
  9401                                    WS-TOL-CLP-PCT
  9402                                    WS-SPP-LEASE-COMM
  9403        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9404                                    EC-ST-FST-PMT-DAYS-CHG
  9405                                    WS-LF-REM-TERM-CALC
  9406                                    WS-LF-REFUND-CALC
  9407                                    EC-ST-LF-REM-TERM-CALC
  9408                                    EC-ST-LF-REFUND-CALC
  9409                                    WS-AH-REM-TERM-CALC
  9410                                    WS-AH-REFUND-CALC
  9411                                    WS-LF-BEN-CATEGORY
  9412                                    WS-AH-BEN-CATEGORY
  9413                                    WS-CLP-STATE
  9414                                    WS-ST-REFUND-CLAIM-FLAG
  9415                                    EC-ST-AH-REM-TERM-CALC
  9416                                    EC-ST-AH-REFUND-CALC
  9417          GO TO 0499-STATE-NOT-FOUND.
  9418
  9419     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9420
  9421 0405-CONTINUE-EDIT.
  9422
  9423     IF PB-CERT-PRIME NOT NUMERIC
  9424        MOVE ER-2722             TO WS-ERROR
  9425        PERFORM 9900-ERROR-FORMAT
  9426                                 THRU 9900-EXIT
  9427     END-IF
  9428*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9429*       MOVE +0                  TO SUB3
  9430*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9431*       IF SUB3 > +0
  9432*          MOVE ER-2722          TO WS-ERROR
  9433*          PERFORM 9900-ERROR-FORMAT
  9434*                                THRU 9900-EXIT
  9435*       END-IF
  9436*    END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 173
* EL050.cbl
  9437*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9438*       IF PB-CERT-PRIME NOT NUMERIC
  9439*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9440*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9441*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9442*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9443*
  9444*          MOVE ER-2722          TO WS-ERROR
  9445*          PERFORM 9900-ERROR-FORMAT
  9446*                                THRU 9900-EXIT
  9447*       END-IF
  9448*    END-IF
  9449
  9450     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9451
  9452     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9453        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9454                                    WS-TOL-AH-CLAIM.
  9455
  9456     IF CF-ST-REFUND-MIN NOT NUMERIC
  9457        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9458
  9459     IF CF-ST-REFUND-MIN NOT = ZEROS
  9460        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9461
  9462     IF CF-ST-TOL-PREM  NOT = ZEROS
  9463        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9464                                    WS-TOL-AH-PREM
  9465        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9466
  9467     IF CF-ST-TOL-REFUND NOT = ZEROS
  9468        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9469                                    WS-TOL-AH-REFUND
  9470        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9471
  9472     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9473        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9474        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9475                                    WS-AH-REFUND-OVS-AMT
  9476                                    EC-ST-OVR-SHT-AMT.
  9477
  9478     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9479        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9480        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9481                                    WS-TOL-LF-PREM-PCT
  9482                                    WS-TOL-AH-PREM-PCT.
  9483
  9484     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9485        CF-ST-TOL-REF-PCT GREATER THAN +0
  9486        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9487                                    WS-TOL-LF-REFUND-PCT
  9488                                    WS-TOL-AH-REFUND-PCT.
  9489
  9490     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9491        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9492        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9493                                    WS-AH-REFUND-OVS-PCT
  9494                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 174
* EL050.cbl
  9495
  9496     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9497     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9498
  9499     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9500          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9501
  9502     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9503     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9504     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9505
  9506     IF CF-ST-LF-PREM-TAX NUMERIC
  9507        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9508     END-IF
  9509     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9510        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9511     END-IF
  9512     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9513        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9514     END-IF
  9515
  9516     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9517         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9518     END-IF.
  9519
  9520     IF WS-LF-BENEFIT-CD = ZEROS
  9521        GO TO 0410-CHECK-AH.
  9522
  9523     IF CF-ST-RT-CALC NOT = SPACES
  9524        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9525                                    EC-ST-LF-REM-TERM-CALC
  9526     END-IF
  9527
  9528     IF WS-LF-COVERAGE-TYPE = 'R'
  9529        IF WS-LF-EARNINGS-CALC = '5'
  9530           IF CF-ST-RF-LN-CALC > '0'
  9531              MOVE CF-ST-RF-LN-CALC
  9532                                 TO WS-LF-REFUND-CALC
  9533                                    EC-ST-LF-REFUND-CALC
  9534           END-IF
  9535        ELSE
  9536           IF CF-ST-RF-LR-CALC > '0'
  9537              MOVE CF-ST-RF-LR-CALC
  9538                                 TO WS-LF-REFUND-CALC
  9539                                    EC-ST-LF-REFUND-CALC
  9540           END-IF
  9541        END-IF
  9542     ELSE
  9543        IF CF-ST-RF-LL-CALC > '0'
  9544           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9545                                    EC-ST-LF-REFUND-CALC
  9546        END-IF
  9547     END-IF
  9548
  9549     IF CF-ST-RT-CALC NOT = SPACES
  9550        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9551                                    EC-ST-LF-REM-TERM-CALC
  9552     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 175
* EL050.cbl
  9553
  9554     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9555     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9556
  9557     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9558
  9559     IF NO-BENEFIT-FOUND
  9560        GO TO 0410-CHECK-AH.
  9561
  9562     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9563        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9564                                 TO EC-ST-LF-REM-TERM-CALC
  9565                                    WS-LF-REM-TERM-CALC
  9566     END-IF
  9567
  9568     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9569        MOVE CF-ST-REFUND-CALC (SUB3)
  9570                                 TO WS-LF-REFUND-CALC
  9571                                    EC-ST-LF-REFUND-CALC
  9572     END-IF
  9573*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9574
  9575     .
  9576 0410-CHECK-AH.
  9577
  9578     IF WS-AH-BENEFIT-CD = ZEROS
  9579        GO TO 0500-SET-ACCOUNT.
  9580
  9581     IF CF-ST-RT-CALC NOT = SPACES
  9582        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9583                                    EC-ST-AH-REM-TERM-CALC
  9584     END-IF
  9585
  9586     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9587        IF CF-ST-RF-CP-CALC > '0'
  9588           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9589                                    EC-ST-AH-REFUND-CALC
  9590        END-IF
  9591     ELSE
  9592        IF CF-ST-RF-AH-CALC > '0'
  9593           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9594                                    EC-ST-AH-REFUND-CALC
  9595        END-IF
  9596     END-IF
  9597     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9598     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9599
  9600     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9601
  9602     IF NO-BENEFIT-FOUND
  9603        GO TO 0500-SET-ACCOUNT.
  9604
  9605     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9606        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9607                                 TO WS-AH-REM-TERM-CALC
  9608                                    EC-ST-AH-REM-TERM-CALC
  9609     END-IF
  9610
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 176
* EL050.cbl
  9611     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9612        MOVE CF-ST-REFUND-CALC (SUB3)
  9613                                 TO WS-AH-REFUND-CALC
  9614                                    EC-ST-AH-REFUND-CALC
  9615     END-IF
  9616
  9617*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9618
  9619     GO TO 0500-SET-ACCOUNT.
  9620
  9621 0499-STATE-NOT-FOUND.
  9622
  9623     MOVE ER-2603                TO WS-ERROR.
  9624     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9625
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 177
* EL050.cbl
  9627
  9628 0500-SET-ACCOUNT.
  9629*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9630     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9631        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9632        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9633        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9634        MOVE '3'                 TO CNTL-REC-TYPE
  9635        MOVE +0                  TO CNTL-SEQ-NO
  9636
  9637        MOVE '3'                 TO RC-SW-2
  9638        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9639
  9640        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9641           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9642           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9643           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9644                                    WS-ST-AH-PREM-TAX-I
  9645                                    WS-ST-AH-PREM-TAX-G
  9646        ELSE
  9647           IF CF-ST-LF-PREM-TAX NUMERIC
  9648              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9649           END-IF
  9650           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9651              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9652           END-IF
  9653           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9654              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9655           END-IF
  9656        END-IF
  9657        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9658     END-IF
  9659*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9660*  FOR DCC ONLY
  9661     IF PB-COMPANY-ID = 'DCC'
  9662
  9663     MOVE ' '                    TO STAT-MASTER-SW
  9664     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9665     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9666     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9667     MOVE PB-STATE               TO ELSTAT-STATE
  9668     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9669        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9670     END-IF
  9671
  9672     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9673     SET BIN-TO-GREG             TO TRUE
  9674     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9675     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9676     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9677
  9678     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9679     IF STAT-MASTER-FOUND
  9680        MOVE 'N'                 TO STAT-MASTER-SW
  9681        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9682        IF STAT-MASTER-FOUND
  9683           IF (ELSTAT-KEY-SAVE (1:12) =
  9684                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 178
* EL050.cbl
  9685              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9686                 MOVE 'F'        TO STAT-MASTER-SW
  9687              ELSE
  9688                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9689                 IF (STAT-MASTER-FOUND)
  9690                    AND (ELSTAT-KEY-SAVE (1:12) =
  9691                        SF-CONTROL-PRIMARY (1:12))
  9692                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9693                    MOVE 'F'     TO STAT-MASTER-SW
  9694                 END-IF
  9695              END-IF
  9696           END-IF
  9697        END-IF
  9698     END-IF
  9699
  9700     IF STAT-MASTER-SW = 'F'
  9701        IF SF-ST-LF-PREM-TAX NUMERIC
  9702           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9703        END-IF
  9704        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9705           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9706        END-IF
  9707        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9708           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9709        END-IF
  9710     END-IF
  9711
  9712     END-IF
  9713     IF (PB-COMPANY-ID = 'DCC')
  9714        AND (PB-ISSUE)
  9715        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9716        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9717        AND (AM-GPCD = 06)
  9718        MOVE 'Y'                 TO WS-GOOD-HIN
  9719        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9720           MOVE PB-I-VIN         TO WS-WORK-VIN
  9721           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9722              (V1 > 16)
  9723              IF WS-WORK-VIN (V1:1) NUMERIC
  9724                 MOVE WS-WORK-VIN-N (V1)
  9725                                 TO WS-ROW-B-VAL (V1)
  9726              ELSE
  9727                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9728                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9729                    OR (V2 > 26)
  9730                 END-PERFORM
  9731                 IF V2 < 27
  9732                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9733                 ELSE
  9734                    MOVE 'N'     TO WS-GOOD-HIN
  9735                 END-IF
  9736              END-IF
  9737              COMPUTE WS-ROW-D-VAL (V1) =
  9738                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9739              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9740                 WS-ROW-D-VAL (V1)
  9741           END-PERFORM
  9742           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 179
* EL050.cbl
  9743           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9744             REMAINDER WS-VIN-REMAINDER
  9745           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9746              CONTINUE
  9747           ELSE
  9748              MOVE 'N'           TO WS-GOOD-HIN
  9749           END-IF
  9750        ELSE
  9751           MOVE 'N'              TO WS-GOOD-HIN
  9752        END-IF
  9753        IF WS-GOOD-HIN NOT = 'Y'
  9754           MOVE ER-3826           TO WS-ERROR
  9755           PERFORM 9900-ERROR-FORMAT
  9756                                 THRU 9900-EXIT
  9757        END-IF
  9758     END-IF
  9759     IF (PB-COMPANY-ID = 'DCC')
  9760        AND (PB-ISSUE)
  9761        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9762        AND (AM-GPCD NOT = 06)
  9763        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9764          MOVE PB-I-VIN          TO WS-WORK-VIN
  9765          MOVE +8                TO V2
  9766          MOVE ZEROS             TO WS-VIN-TOTAL
  9767          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9768           (V1 > 17)
  9769             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9770                MOVE ER-3825     TO WS-ERROR
  9771                PERFORM 9900-ERROR-FORMAT
  9772                                 THRU 9900-EXIT
  9773             ELSE
  9774                IF V1 = 8
  9775                   MOVE 10       TO V2
  9776                END-IF
  9777                IF V1 = 9
  9778                   MOVE 0        TO V2
  9779                END-IF
  9780                IF V1 = 10
  9781                   MOVE 9        TO V2
  9782                END-IF
  9783                IF WS-WORK-VIN (V1:1) NUMERIC
  9784                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9785                    + (WS-WORK-VIN-N (V1) * V2)
  9786                ELSE
  9787                   MOVE WS-WORK-VIN (V1:1)
  9788                                 TO WS-HEX-BYTE
  9789                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9790                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9791                    + (WS-NUM (V3) * V2)
  9792                END-IF
  9793                COMPUTE V2 = V2 - 1
  9794             END-IF
  9795          END-PERFORM
  9796          MOVE ZEROS TO WS-VIN-REMAINDER
  9797          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9798             REMAINDER WS-VIN-REMAINDER
  9799          IF ((WS-WORK-VIN (9:1) = 'X')
  9800             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 180
* EL050.cbl
  9801                     OR
  9802             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9803             CONTINUE
  9804          ELSE
  9805             MOVE ER-3826        TO WS-ERROR
  9806             PERFORM 9900-ERROR-FORMAT
  9807                                 THRU 9900-EXIT
  9808          END-IF
  9809        ELSE
  9810          MOVE ER-3826           TO WS-ERROR
  9811          PERFORM 9900-ERROR-FORMAT
  9812                                 THRU 9900-EXIT
  9813        END-IF
  9814     END-IF
  9815******************************************************************
  9816******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9817******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9818******* METHODS.
  9819******************************************************************
  9820     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9821        IF PB-CANCELLATION
  9822           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9823              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9824                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9825                IF FORM-MASTER-FOUND
  9826                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9827******************************************************************
  9828
  9829     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9830     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9831
  9832     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9833     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9834     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9835     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9836
  9837
  9838     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9839     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9840     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9841
  9842     IF AM-LF-OB-RATE NOT NUMERIC
  9843         MOVE ZERO               TO AM-LF-OB-RATE.
  9844
  9845     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9846         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9847
  9848     IF AM-AH-OB-RATE NOT NUMERIC
  9849         MOVE ZERO               TO AM-AH-OB-RATE.
  9850
  9851     IF WS-LF-JOINT-INDICATOR = 'J'
  9852         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9853     ELSE
  9854         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9855
  9856     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9857
  9858     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 181
* EL050.cbl
  9859         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9860
  9861     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9862         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9863                                       WS-IG-OVRD
  9864     ELSE
  9865         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9866             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9867                                       WS-IG-OVRD
  9868         ELSE
  9869             MOVE AM-IG             TO WS-IG-OVRD-AH
  9870                                       WS-IG-OVRD.
  9871
  9872     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9873         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9874                                       WS-IG-OVRD
  9875     ELSE
  9876         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9877             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9878                                       WS-IG-OVRD
  9879         ELSE
  9880             MOVE AM-IG             TO WS-IG-OVRD-LF
  9881                                       WS-IG-OVRD.
  9882
  9883     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9884     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9885     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9886     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9887     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9888
  9889     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9890     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9891     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9892     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9893
  9894     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9895     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9896     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9897     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9898     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9899     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9900     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9901
  9902     IF WS-ACCT-AH-DEV-PCT > +0
  9903        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9904     ELSE
  9905        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9906
  9907     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9908        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9909     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9910        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9911
  9912        IF AM-EARN-METHOD-L = 'S'
  9913            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9914                                        WS-LF-REFUND-CALC.
  9915
  9916        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 182
* EL050.cbl
  9917            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9918                                        WS-LF-REFUND-CALC.
  9919
  9920     IF WS-LF-COVERAGE-TYPE = 'R'
  9921         IF AM-EARN-METHOD-R = 'R'
  9922            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9923                                    WS-LF-REFUND-CALC.
  9924     IF WS-LF-COVERAGE-TYPE = 'R'
  9925         IF AM-EARN-METHOD-R = 'P'
  9926            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9927                                    WS-LF-REFUND-CALC.
  9928     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9929         IF AM-EARN-METHOD-L = 'R'
  9930            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9931                                    WS-LF-REFUND-CALC.
  9932     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9933         IF AM-EARN-METHOD-L = 'P'
  9934            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9935                                    WS-LF-REFUND-CALC.
  9936     IF WS-LF-COVERAGE-TYPE = 'R'
  9937         IF AM-EARN-METHOD-R = 'A'
  9938            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9939                                    WS-LF-REFUND-CALC.
  9940     IF WS-LF-COVERAGE-TYPE = 'R'
  9941         IF AM-EARN-METHOD-R = 'M'
  9942            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9943                                    WS-LF-REFUND-CALC.
  9944     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9945         IF AM-EARN-METHOD-L = 'A'
  9946            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9947                                    WS-LF-REFUND-CALC.
  9948     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9949         IF AM-EARN-METHOD-L = 'M'
  9950            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9951                                    WS-LF-REFUND-CALC.
  9952
  9953     IF AM-EARN-METHOD-A = 'R'
  9954        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9955                                    WS-AH-REFUND-CALC.
  9956     IF AM-EARN-METHOD-A = 'P'
  9957        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9958                                    WS-AH-REFUND-CALC.
  9959     IF AM-EARN-METHOD-A = 'C'
  9960        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9961                                    WS-AH-REFUND-CALC.
  9962     IF AM-EARN-METHOD-A = 'A'
  9963        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9964                                    WS-AH-REFUND-CALC.
  9965     IF AM-EARN-METHOD-A = 'M'
  9966        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9967                                    WS-AH-REFUND-CALC.
  9968     IF AM-EARN-METHOD-A = 'N'
  9969        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9970                                    WS-AH-REFUND-CALC.
  9971     IF AM-EARN-METHOD-A = 'S'
  9972        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9973                                    WS-AH-REFUND-CALC.
  9974
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 183
* EL050.cbl
  9975     IF AM-TOL-PREM NOT = ZEROS
  9976        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9977                                    WS-TOL-AH-PREM.
  9978
  9979     IF AM-OVR-SHT-AMT NUMERIC AND
  9980                  AM-OVR-SHT-AMT > 0
  9981        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9982                                    EC-AM-LF-OVR-SHT-AMT
  9983                                    WS-AH-REFUND-OVS-AMT
  9984                                    EC-AM-AH-OVR-SHT-AMT.
  9985
  9986     IF AM-OVR-SHT-PCT NUMERIC AND
  9987                    AM-OVR-SHT-PCT > 0
  9988        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9989                                    EC-AM-LF-OVR-SHT-PCT
  9990                                    WS-AH-REFUND-OVS-PCT
  9991                                    EC-AM-AH-OVR-SHT-PCT.
  9992
  9993     IF AM-TOL-REF-PCT NUMERIC AND
  9994                  AM-TOL-REF-PCT > 0
  9995        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
  9996                                    WS-TOL-AH-REFUND-PCT.
  9997
  9998     IF AM-TOL-REF  NOT = ZEROS  AND
  9999                  AM-TOL-REF NUMERIC
 10000        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10001                                    EC-AM-LF-TOL-REFUND
 10002                                    WS-TOL-AH-REFUND
 10003                                    EC-AM-AH-TOL-REFUND.
 10004
 10005     IF AM-TOL-CLM  NOT = ZEROS
 10006        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10007                                    WS-TOL-AH-CLAIM.
 10008
 10009     IF AM-CLP-TOL-PCT NOT NUMERIC
 10010        MOVE +0                  TO AM-CLP-TOL-PCT
 10011     END-IF
 10012
 10013     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10014        MOVE +0                  TO AM-SPP-LEASE-COMM
 10015     END-IF
 10016     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10017        MOVE WS-PL-TOL-LF-PREM-PCT
 10018                                 TO WS-TOL-LF-PREM-PCT.
 10019
 10020     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10021        MOVE WS-PL-TOL-AH-PREM-PCT
 10022                                 TO WS-TOL-AH-PREM-PCT.
 10023
 10024     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10025        MOVE WS-PL-TOL-LF-REFUND-PCT
 10026                                 TO WS-TOL-LF-REFUND-PCT.
 10027
 10028     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10029        MOVE WS-PL-TOL-AH-REFUND-PCT
 10030                                 TO WS-TOL-AH-REFUND-PCT.
 10031
 10032     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 184
* EL050.cbl
 10033        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10034
 10035     IF WS-PL-REF-OVS-PCT > +0
 10036        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10037
 10038     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10039        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10040     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10041        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10042     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10043        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10044     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10045        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10046     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10047        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10048     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10049        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10050
 10051     IF WS-AH-PL-REF-OVS-AMT > +0
 10052        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10053
 10054     IF WS-AH-PL-REF-OVS-PCT > +0
 10055        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10056
 10057     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10058     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10059
 10060     IF PB-CANCELLATION
 10061        GO TO 3000-CONTINUE-EDIT.
 10062
 10063     MOVE +1 TO SUB1.
 10064     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10065     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10066
 10067     IF CF-COMPANY-ID = 'DMD'
 10068       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10069         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10070        ELSE
 10071         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10072
 10073  0525-FIND-ACCT-COMM.
 10074     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10075        NEXT SENTENCE
 10076      ELSE
 10077         ADD +1 TO SUB1
 10078         IF SUB1 LESS +11
 10079            GO TO 0525-FIND-ACCT-COMM
 10080          ELSE
 10081             GO TO 0560-EDIT-CONTINUE.
 10082
 10083     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10084     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10085                                    PB-I-LIFE-COMMISSION.
 10086***  IF PB-COMPANY-ID = 'CRI'
 10087     IF PB-PREM-ACCTNG-ONLY
 10088         GO TO 0560-EDIT-CONTINUE.
 10089
 10090     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 185
* EL050.cbl
 10091     MOVE ' '    TO WS-CTBL-READ-SW.
 10092
 10093
 10094 0530-GET-AH-COMP.
 10095     IF NO-AH-COVERAGE  OR
 10096        NO-AH-BENEFIT-MATCH
 10097           GO TO 0540-NEXT-READ-STEP.
 10098
 10099     IF AM-A-COM (SUB1) NUMERIC
 10100        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10101         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10102         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10103         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10104         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10105     ELSE
 10106          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10107          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10108          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10109          MOVE ZEROS             TO WS-SUB1
 10110                                    WS-COMMISSION
 10111          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10112          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10113          IF WS-COMMISSION > ZEROS
 10114             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10115             GO TO 0540-NEXT-READ-STEP
 10116          END-IF
 10117          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10118          IF CTBL-TABLE-FOUND
 10119             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10120                                        PB-I-AH-TERM
 10121             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10122             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10123             GO TO 0540-NEXT-READ-STEP
 10124          ELSE
 10125             IF FIRST-TIME-THROUGH
 10126                 GO TO 0530-GET-AH-COMP
 10127             ELSE
 10128                 MOVE ER-2609                TO WS-ERROR
 10129                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10130
 10131 0540-NEXT-READ-STEP.
 10132     MOVE '0540' TO CTBL-SW.
 10133     MOVE ' '    TO WS-CTBL-READ-SW.
 10134
 10135 0540-GET-LF-COMP.
 10136     IF NO-LIFE-COVERAGE  OR
 10137        NO-LF-BENEFIT-MATCH
 10138           GO TO 0560-EDIT-CONTINUE.
 10139
 10140     IF WS-LF-JOINT-INDICATOR = 'J'
 10141        IF AM-J-COM (SUB1) NUMERIC
 10142           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10143           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10144           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10145           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10146           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10147        ELSE
 10148           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 186
* EL050.cbl
 10149           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10150           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10151           MOVE ZEROS                TO WS-SUB1
 10152                                        WS-COMMISSION
 10153           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10154           IF WS-COMMISSION > ZEROS
 10155              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10156              GO TO 0560-EDIT-CONTINUE
 10157           END-IF
 10158           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10159           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10160           IF CTBL-TABLE-FOUND
 10161              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10162              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10163              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10164              GO TO 0560-EDIT-CONTINUE
 10165           ELSE
 10166              IF FIRST-TIME-THROUGH
 10167                  GO TO 0540-GET-LF-COMP
 10168              ELSE
 10169                  MOVE ER-2609                TO WS-ERROR
 10170                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10171                  GO TO 0560-EDIT-CONTINUE.
 10172
 10173     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10174        IF AM-L-COM (SUB1) NUMERIC
 10175           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10176           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10177           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10178           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10179           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10180        ELSE
 10181           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10182           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10183           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10184           MOVE ZEROS                TO WS-SUB1
 10185                                        WS-COMMISSION
 10186           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10187           IF WS-COMMISSION IS GREATER THAN ZEROS
 10188              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10189              GO TO 0560-EDIT-CONTINUE
 10190           END-IF
 10191           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10192           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10193           IF CTBL-TABLE-FOUND
 10194              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10195              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10196              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10197              GO TO 0560-EDIT-CONTINUE
 10198           ELSE
 10199              IF FIRST-TIME-THROUGH
 10200                  GO TO 0540-GET-LF-COMP
 10201              ELSE
 10202                  MOVE ER-2609                TO WS-ERROR
 10203                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10204
 10205*    GO TO 0560-EDIT-CONTINUE.
 10206
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 187
* EL050.cbl
 10207 0560-EDIT-CONTINUE.
 10208     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10209                                    WS-AH-PMF-COMM
 10210*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10211*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10212     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10213        (SUB1 > +10)
 10214        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10215           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10216           MOVE '0530'           TO CTBL-SW
 10217           MOVE ' '              TO WS-CTBL-READ-SW
 10218           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10219           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10220           MOVE '0540'           TO CTBL-SW
 10221           MOVE ' '              TO WS-CTBL-READ-SW
 10222           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10223        END-IF
 10224     END-PERFORM
 10225     GO TO 0564-EDIT-CONTINUE
 10226     .
 10227 0561-CHECK-AH.
 10228     IF (NO-AH-COVERAGE)
 10229        OR (NO-AH-BENEFIT-MATCH)
 10230        CONTINUE
 10231     ELSE
 10232        IF (AM-A-COM (SUB1) NUMERIC)
 10233           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10234           IF (AM-COM-TYP (SUB1) = 'A')
 10235              AND (WS-AH-PMF-COMM = ZEROS)
 10236              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10237           END-IF
 10238           CONTINUE
 10239        ELSE
 10240           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10241           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10242           MOVE PB-AH-OVERRIDE-L1
 10243                                 TO CTBL-BEN-TYPE
 10244           MOVE ZEROS            TO WS-SUB1
 10245                                    WS-COMMISSION
 10246           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10247           PERFORM 8300-READ-CTBL-TABLE
 10248                                 THRU 8300-EXIT
 10249           IF CTBL-TABLE-FOUND
 10250              IF (AM-COM-TYP (SUB1) = 'A')
 10251                 AND (WS-AH-PMF-COMM = ZEROS)
 10252                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10253                                        PB-I-AH-TERM
 10254                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10255                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10256              END-IF
 10257              CONTINUE
 10258           ELSE
 10259              IF FIRST-TIME-THROUGH
 10260                 GO TO 0561-CHECK-AH
 10261              ELSE
 10262                 MOVE ER-2609    TO WS-ERROR
 10263                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10264              END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 188
* EL050.cbl
 10265           END-IF
 10266        END-IF
 10267     END-IF
 10268     .
 10269 0561-EXIT.
 10270     EXIT.
 10271 0563-CHECK-LF.
 10272     IF (NO-LIFE-COVERAGE)
 10273        OR (NO-LF-BENEFIT-MATCH)
 10274        CONTINUE
 10275     ELSE
 10276        IF WS-LF-JOINT-INDICATOR = 'J'
 10277           IF AM-J-COM (SUB1) NUMERIC
 10278              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10279              IF (AM-COM-TYP (SUB1) = 'A')
 10280                 AND (WS-LF-PMF-COMM = ZEROS)
 10281                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10282              END-IF
 10283              CONTINUE
 10284           ELSE
 10285              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10286              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10287              MOVE PB-LIFE-OVERRIDE-L1
 10288                                 TO CTBL-BEN-TYPE
 10289              MOVE ZEROS         TO WS-SUB1
 10290                                    WS-COMMISSION
 10291              MOVE AM-J-COMA (SUB1)
 10292                                 TO CTBL-TABLE
 10293              PERFORM 8300-READ-CTBL-TABLE
 10294                                 THRU 8300-EXIT
 10295              IF CTBL-TABLE-FOUND
 10296                 IF (AM-COM-TYP (SUB1) = 'A')
 10297                    AND (WS-LF-PMF-COMM = ZEROS)
 10298                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10299                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10300                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10301                 END-IF
 10302                 CONTINUE
 10303              ELSE
 10304                 IF FIRST-TIME-THROUGH
 10305                    GO TO 0563-CHECK-LF
 10306                 ELSE
 10307                    MOVE ER-2609 TO WS-ERROR
 10308                    PERFORM 9900-ERROR-FORMAT
 10309                                 THRU 9900-EXIT
 10310*                   GO TO 0560-EDIT-CONTINUE
 10311                 END-IF
 10312              END-IF
 10313           END-IF
 10314        ELSE
 10315           IF AM-L-COM (SUB1) NUMERIC
 10316              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10317              IF (AM-COM-TYP (SUB1) = 'A')
 10318                 AND (WS-LF-PMF-COMM = ZEROS)
 10319                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10320              END-IF
 10321              CONTINUE
 10322           ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 189
* EL050.cbl
 10323              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10324              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10325              MOVE PB-LIFE-OVERRIDE-L1
 10326                                 TO CTBL-BEN-TYPE
 10327              MOVE ZEROS         TO WS-SUB1
 10328                                    WS-COMMISSION
 10329              MOVE AM-L-COMA (SUB1)
 10330                                 TO CTBL-TABLE
 10331              PERFORM 8300-READ-CTBL-TABLE
 10332                                 THRU 8300-EXIT
 10333              IF CTBL-TABLE-FOUND
 10334                 CONTINUE
 10335              ELSE
 10336                 IF FIRST-TIME-THROUGH
 10337                    GO TO 0563-CHECK-LF
 10338                 ELSE
 10339                    MOVE ER-2609 TO WS-ERROR
 10340                    PERFORM 9900-ERROR-FORMAT
 10341                                 THRU 9900-EXIT
 10342                 END-IF
 10343              END-IF
 10344           END-IF
 10345        END-IF
 10346     END-IF
 10347     .
 10348 0563-EXIT.
 10349     EXIT.
 10350 0564-EDIT-CONTINUE.
 10351
 10352     IF  PB-COMPANY-ID EQUAL 'DMD'
 10353         IF PB-I-NUM-BILLED EQUAL ZEROS
 10354            MOVE ER-8148       TO WS-ERROR
 10355            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10356
 10357*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10358*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10359*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10360*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10361*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10362*         IF NO-CONVERSION-ERROR
 10363*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10364*         ELSE
 10365*             IF PB-COMPANY-ID EQUAL 'HAN'
 10366*                 MOVE ZEROS     TO PB-I-AGE.
 10367     IF PB-I-BIRTHDAY > LOW-VALUES
 10368        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10369        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10370        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10371        PERFORM 8500-DATE-CONVERT
 10372                                 THRU 8500-EXIT
 10373        IF NO-CONVERSION-ERROR
 10374           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10375           IF PB-I-AGE > ZEROS
 10376              IF WS-WORK-AGE NOT = PB-I-AGE
 10377                 MOVE ER-9501    TO WS-ERROR
 10378                 PERFORM 9900-ERROR-FORMAT
 10379                                 THRU 9900-EXIT
 10380              END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 190
* EL050.cbl
 10381           ELSE
 10382              MOVE WS-WORK-AGE   TO PB-I-AGE
 10383           END-IF
 10384        END-IF
 10385     END-IF
 10386     IF PB-I-AGE = ZEROS
 10387        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10388           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10389
 10390     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10391                                   WS-AH-EDIT-AGE.
 10392
 10393     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10394        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10395        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10396        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10397        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10398        IF NO-CONVERSION-ERROR
 10399           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10400           IF PB-I-JOINT-AGE > 0
 10401              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10402                 MOVE ER-9503    TO WS-ERROR
 10403                 PERFORM 9900-ERROR-FORMAT
 10404                                 THRU 9900-EXIT
 10405              END-IF
 10406           ELSE
 10407              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10408           END-IF
 10409        ELSE
 10410           MOVE ZEROS            TO PB-I-JOINT-AGE
 10411        END-IF
 10412     END-IF
 10413     IF PB-I-JOINT-AGE NOT NUMERIC
 10414        MOVE ZERO               TO PB-I-JOINT-AGE.
 10415
 10416     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10417        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10418           (WS-AH-JOINT-INDICATOR = 'J')
 10419           IF PB-I-JOINT-AGE = ZEROS
 10420               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10421           END-IF
 10422        END-IF
 10423     END-IF
 10424
 10425     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10426     IF WS-LF-JOINT-INDICATOR = 'J'
 10427        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10428        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10429            IF  PB-I-JOINT-AGE = ZERO
 10430                MOVE ER-2686       TO WS-ERROR
 10431                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10432            ELSE
 10433                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10434                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10435                    IF PB-COMPANY-ID NOT = 'LBL'
 10436                        MOVE ER-2685    TO WS-ERROR
 10437                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10438
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 191
* EL050.cbl
 10439     IF WS-AH-JOINT-INDICATOR = 'J'
 10440        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10441            IF  PB-I-JOINT-AGE = ZERO
 10442                MOVE ER-2686       TO WS-ERROR
 10443                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10444            ELSE
 10445                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10446                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10447                                           WS-EDIT-AGE
 10448                    IF PB-COMPANY-ID NOT = 'LBL'
 10449                        MOVE ER-2685    TO WS-ERROR
 10450                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10451
 10452******************************************************************
 10453*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10454******************************************************************
 10455
 10456     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10457        (WS-AH-SPECIAL-CALC-CD = 'O')
 10458        NEXT SENTENCE
 10459     ELSE
 10460        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10461          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10462           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10463            WS-AH-JOINT-INDICATOR = 'J')  AND
 10464           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10465            MOVE ER-2627             TO WS-ERROR
 10466            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10467
 10468     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10469        (WS-AH-SPECIAL-CALC-CD = 'O')
 10470         NEXT SENTENCE
 10471     ELSE
 10472         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10473            WS-AH-JOINT-INDICATOR = 'J'
 10474             IF PB-I-JOINT-INSURED = SPACES
 10475                 IF PB-COMPANY-ID NOT = 'JAL'
 10476                     MOVE ER-2696    TO WS-ERROR
 10477                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10478
 10479     IF PB-COMPANY-ID NOT = 'BOA'
 10480        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10481           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10482           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10483               PB-I-JOINT-INSURED NOT = SPACES)
 10484                MOVE ER-2691         TO WS-ERROR
 10485                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10486
 10487     IF PB-COMPANY-ID = 'BOA'
 10488        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10489           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10490            IF PB-I-JOINT-AGE NOT = ZEROS
 10491                MOVE ER-2691         TO WS-ERROR
 10492                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10493
 10494     IF PB-COMPANY-ID = 'CRI'
 10495        IF PB-I-SIG-SW = 'J'
 10496           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 192
* EL050.cbl
 10497              WS-AH-JOINT-INDICATOR NOT = 'J'
 10498              MOVE ER-2675       TO WS-ERROR
 10499              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10500
 10501     IF PB-COMPANY-ID = 'CRI'
 10502        IF PB-I-SIG-SW = 'S'
 10503           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10504              WS-AH-JOINT-INDICATOR = 'J'
 10505              MOVE ER-2676       TO WS-ERROR
 10506              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10507
 10508     IF PB-COMPANY-ID = 'CVL'
 10509         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10510            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10511              MOVE ER-2783           TO WS-ERROR
 10512              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10513     IF (WS-LF-JOINT-INDICATOR = 'J')
 10514        AND (WS-AH-JOINT-INDICATOR = 'J')
 10515        AND (PB-I-LF-TERM > 120)
 10516        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10517        MOVE ER-2783             TO WS-ERROR
 10518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10519     END-IF
 10520     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10521
 10522     IF PB-I-INDV-GRP-OVRD = 'I'
 10523        MOVE ER-2666             TO WS-ERROR
 10524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10525        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10526
 10527     IF PB-I-INDV-GRP-OVRD = 'G'
 10528        MOVE ER-2666             TO WS-ERROR
 10529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10530        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10531
 10532     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10533        NEXT SENTENCE
 10534     ELSE
 10535        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10536
 10537     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10538        IF WS-ERROR = ER-2666
 10539           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10540           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10541
 10542     IF PB-COMPANY-ID = 'CID'
 10543        IF PB-STATE = 'UT' OR 'MO'
 10544           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10545                 OR '76' OR '77')
 10546                      OR
 10547               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10548                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10549                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10550                   OR '2K' OR '2L'))
 10551              AND PB-I-INDV-GRP-CD = 'I'
 10552              MOVE ER-2721             TO WS-ERROR
 10553              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10554           END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 193
* EL050.cbl
 10555        END-IF
 10556     END-IF
 10557
 10558     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10559     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10560        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10561     ELSE
 10562        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10563     END-IF
 10564
 10565*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10566*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10567     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10568                                    ACCOUNT-AH-CK-SW.
 10569
 10570     IF PB-REISSUED-CERT       OR
 10571        PB-REIN-ONLY-CERT      OR
 10572        PB-POLICY-IS-DECLINED  OR
 10573        PB-POLICY-IS-VOIDED
 10574*       OR PB-MONTHLY-CERT
 10575         GO TO 3000-CONTINUE-EDIT.
 10576
 10577     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10578        IF WS-EDIT-AGE           > +65
 10579           MOVE ER-2709          TO WS-ERROR
 10580           PERFORM 9900-ERROR-FORMAT
 10581                                 THRU 9900-EXIT
 10582        ELSE
 10583           IF WS-EDIT-AGE        > +55
 10584              MOVE ER-2718       TO WS-ERROR
 10585              PERFORM 9900-ERROR-FORMAT
 10586                                 THRU 9900-EXIT
 10587           END-IF
 10588        END-IF
 10589     IF PB-COMPANY-ID = 'DCC'
 10590        IF WS-EDIT-AGE           > +65
 10591           MOVE ER-2709          TO WS-ERROR
 10592           PERFORM 9900-ERROR-FORMAT
 10593                                 THRU 9900-EXIT
 10594        END-IF
 10595     END-IF
 10596     .
 10597
 10598 0565-LIFE-PLAN-LIMIT-EDITS.
 10599
 10600     IF NOT LF-PLAN-MASTER-FOUND
 10601        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10602                                    EC-AM-LF-MAX-TOT-BEN
 10603        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10604
 10605     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10606
 10607     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10608         IF PL-LM-AGE (1) = ZEROS
 10609             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10610
 10611     IF NO-LF-BENEFIT-MATCH          OR
 10612        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 194
* EL050.cbl
 10613        WS-LF-SPECIAL-CALC-CD = 'M'
 10614        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10615
 10616     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10617     MOVE +1                     TO SUB2.
 10618
 10619     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10620        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10621           MOVE +5   TO SUB2
 10622           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10623              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10624              (PL-LM-AGE (SUB2) EQUAL +0)
 10625              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10626              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10627
 10628     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10629
 10630     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10631                               + PB-I-LF-ALT-BENEFIT-AMT.
 10632
 10633 0568-CHECK-LIFE-ATT-AGE.
 10634
 10635     IF PL-ATT-AGE NUMERIC AND
 10636        PL-ATT-AGE > +0
 10637        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10638     END-IF
 10639*    IF PL-ATT-AGE NUMERIC AND
 10640*       PL-ATT-AGE > +0
 10641*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10642*       IF PB-I-BIRTHDAY > LOW-VALUES
 10643*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10644*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10645*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10646*          SET BIN-PLUS-ELAPSED  TO TRUE
 10647*          PERFORM 8500-DATE-CONVERT
 10648*                                THRU 8500-EXIT
 10649*          IF NO-CONVERSION-ERROR
 10650*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10651*             MOVE ER-2669       TO WS-ERROR
 10652*             PERFORM 9900-ERROR-FORMAT
 10653*                                THRU 9900-EXIT
 10654*          END-IF
 10655*       ELSE
 10656*          IF WS-ATT-AGE >= PL-ATT-AGE
 10657*             MOVE ER-2669       TO WS-ERROR
 10658*             PERFORM 9900-ERROR-FORMAT
 10659*                                THRU 9900-EXIT
 10660*          END-IF
 10661*       END-IF
 10662*    END-IF
 10663     .
 10664 0570-CHECK-LIFE-LIMITS.
 10665
 10666     IF PB-COMPANY-ID EQUAL 'CRI'
 10667        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10668           IF SUB2 GREATER THAN +4
 10669              MOVE ER-2637 TO WS-ERROR
 10670              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 195
* EL050.cbl
 10671              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10672
 10673     IF PB-COMPANY-ID  =  'NCL'
 10674        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10675            SUB2 GREATER THAN +8
 10676             MOVE 'U'         TO PB-BATCH-ENTRY
 10677             MOVE ER-2637     TO WS-ERROR
 10678             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10679             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10680
 10681     IF SUB2 > +8
 10682        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10683           AND (PB-I-SIG-SW = 'Y')
 10684           CONTINUE
 10685        ELSE
 10686           MOVE ER-2637          TO WS-ERROR
 10687           PERFORM 9900-ERROR-FORMAT
 10688                                 THRU 9900-EXIT
 10689        END-IF
 10690        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10691     END-IF
 10692     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10693     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10694     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10695
 10696     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10697        ADD +1  TO SUB2
 10698        GO TO 0570-CHECK-LIFE-LIMITS.
 10699
 10700     IF PB-COMPANY-ID = 'NCL'
 10701         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10702
 10703     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10704        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10705        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10706           AND (PB-I-SIG-SW = 'Y')
 10707           CONTINUE
 10708        ELSE
 10709           MOVE ER-2637          TO WS-ERROR
 10710           PERFORM 9900-ERROR-FORMAT
 10711                                 THRU 9900-EXIT
 10712        END-IF
 10713     END-IF
 10714     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10715
 10716
 10717 0570-CHECK-NCL-LIFE-LIMITS.
 10718
 10719     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10720        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10721         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10722
 10723     IF APP-CERT-USED
 10724         IF SUB2  LESS THAN  +5
 10725             MOVE +5          TO SUB2
 10726             GO TO 0570-CHECK-LIFE-LIMITS.
 10727
 10728     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 196
* EL050.cbl
 10729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10730
 10731     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10732
 10733 0575-CHECK-NCL-SIG-SWITCH.
 10734
 10735     IF NOT APP-CERT-USED
 10736         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10737
 10738     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10739        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10740        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10741        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10742         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10743
 10744     IF SUB2 GREATER THAN +4
 10745         IF PL-LM-AGE (5) = ZEROS  AND
 10746            PL-LM-AGE (6) = ZEROS  AND
 10747            PL-LM-AGE (7) = ZEROS  AND
 10748            PL-LM-AGE (8) = ZEROS
 10749             MOVE  ER-1927        TO WS-ERROR
 10750             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10751             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10752         ELSE
 10753             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10754                 MOVE  ER-1920    TO WS-ERROR
 10755                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10756
 10757     IF PB-I-SIG-SW  = 'Y'
 10758       IF NOT PB-I-POLICY-ACCEPTED  AND
 10759          NOT PB-I-POLICY-DECLINED
 10760           MOVE 'U'               TO PB-BATCH-ENTRY
 10761           MOVE  ER-1926          TO WS-ERROR
 10762           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10763
 10764
 10765 0580-AH-PLAN-LIMIT-EDITS.
 10766
 10767     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10768        IF PB-I-AH-BENEFIT-AMT > +1250
 10769           MOVE ER-2702          TO WS-ERROR
 10770           PERFORM 9900-ERROR-FORMAT
 10771                                 THRU 9900-EXIT
 10772        END-IF
 10773     END-IF
 10774
 10775     IF (PB-COMPANY-ID = 'DCC')
 10776        AND (PB-MONTHLY-CERT)
 10777        IF PB-I-AH-BENEFIT-AMT > +1000
 10778           MOVE ER-2881          TO WS-ERROR
 10779           PERFORM 9900-ERROR-FORMAT
 10780                                 THRU 9900-EXIT
 10781        END-IF
 10782     END-IF
 10783     IF NOT AH-PLAN-MASTER-FOUND
 10784        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10785        GO TO 3000-CONTINUE-EDIT.
 10786
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 197
* EL050.cbl
 10787     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10788
 10789     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10790         IF PL-LM-AGE (1) = ZEROS
 10791             GO TO 3000-CONTINUE-EDIT.
 10792
 10793     IF NO-AH-BENEFIT-MATCH          OR
 10794        WS-AH-BENEFIT-CD = ZEROS     OR
 10795        WS-AH-SPECIAL-CALC-CD = 'M'
 10796        GO TO 3000-CONTINUE-EDIT.
 10797
 10798     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10799     MOVE +1                     TO SUB2.
 10800
 10801     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10802        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10803           MOVE +5 TO SUB2
 10804           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10805              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10806              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10807              (PL-LM-AGE (SUB2) EQUAL +0)
 10808              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10809              GO TO 3000-CONTINUE-EDIT.
 10810
 10811     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10812
 10813 0590-CHECK-AH-ATT-AGE.
 10814
 10815     IF PL-ATT-AGE NUMERIC AND
 10816        PL-ATT-AGE GREATER THAN +0
 10817        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10818     END-IF
 10819*       IF WS-ATT-AGE >= PL-ATT-AGE
 10820*          MOVE ER-3054          TO WS-ERROR
 10821*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10822     .
 10823 0597-CHECK-AH-LIMITS.
 10824
 10825     IF PB-COMPANY-ID EQUAL 'CRI'
 10826        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10827           IF SUB2 GREATER THAN +4
 10828              MOVE ER-2638       TO WS-ERROR
 10829              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10830              GO TO 3000-CONTINUE-EDIT.
 10831
 10832     IF PB-COMPANY-ID  =  'NCL'
 10833        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10834            SUB2 GREATER THAN +8
 10835             MOVE 'U'            TO PB-BATCH-ENTRY
 10836             MOVE ER-2638        TO WS-ERROR
 10837             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10838             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10839
 10840     IF SUB2 > +8
 10841        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10842           AND (PB-I-SIG-SW = 'Y')
 10843           CONTINUE
 10844        ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 198
* EL050.cbl
 10845           MOVE ER-2638          TO WS-ERROR
 10846           PERFORM 9900-ERROR-FORMAT
 10847                                 THRU 9900-EXIT
 10848        END-IF
 10849        GO TO 3000-CONTINUE-EDIT
 10850     END-IF
 10851
 10852     IF PB-COMPANY-ID = 'CRI'
 10853        IF WS-ERROR = ER-2638
 10854           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10855
 10856     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10857     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10858     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10859     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10860
 10861     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10862        ADD +1                   TO SUB2
 10863        GO TO 0597-CHECK-AH-LIMITS.
 10864
 10865     IF PB-COMPANY-ID = 'NCL'
 10866         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10867
 10868     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10869        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10870        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10871                                 > PL-LM-AMT (SUB2))
 10872        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10873           AND (PB-I-SIG-SW = 'Y')
 10874           CONTINUE
 10875        ELSE
 10876           MOVE ER-2638          TO WS-ERROR
 10877           PERFORM 9900-ERROR-FORMAT
 10878                                 THRU 9900-EXIT
 10879        END-IF
 10880     END-IF
 10881
 10882     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10883         IF  WS-ERROR    EQUAL    ER-2638
 10884             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10885                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10886                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10887                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10888                MOVE  ER-1910    TO  WS-ERROR
 10889                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10890
 10891     IF PB-COMPANY-ID = 'CRI'
 10892        IF WS-ERROR = ER-2638
 10893            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10894            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10895            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10896
 10897     GO TO 3000-CONTINUE-EDIT.
 10898
 10899 0597-CHECK-NCL-AH-LIMITS.
 10900
 10901     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10902        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 199
* EL050.cbl
 10903        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10904                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10905         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10906
 10907     IF APP-CERT-USED
 10908         IF SUB2  LESS THAN  +5
 10909             MOVE +5             TO SUB2
 10910             GO TO 0597-CHECK-AH-LIMITS.
 10911
 10912     MOVE ER-2638                TO WS-ERROR.
 10913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10914
 10915     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10916
 10917 0599-CHECK-NCL-SIG-SWITCH.
 10918
 10919     IF NOT APP-CERT-USED
 10920         GO TO 3000-CONTINUE-EDIT.
 10921
 10922     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10923        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10924        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10925        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10926         GO TO 3000-CONTINUE-EDIT.
 10927
 10928     IF SUB2 GREATER THAN +4
 10929         IF PL-LM-AGE (5) = ZEROS  AND
 10930            PL-LM-AGE (6) = ZEROS  AND
 10931            PL-LM-AGE (7) = ZEROS  AND
 10932            PL-LM-AGE (8) = ZEROS
 10933             MOVE  ER-1927        TO WS-ERROR
 10934             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10935             GO TO 3000-CONTINUE-EDIT
 10936         ELSE
 10937             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10938                 MOVE  ER-1920    TO WS-ERROR
 10939                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10940
 10941     IF PB-I-SIG-SW  = 'Y'
 10942       IF NOT PB-I-POLICY-ACCEPTED  AND
 10943          NOT PB-I-POLICY-DECLINED
 10944           MOVE 'U'               TO PB-BATCH-ENTRY
 10945           MOVE  ER-1926          TO WS-ERROR
 10946           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10947
 10948******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 200
* EL050.cbl
 10950
 10951 3000-CONTINUE-EDIT.
 10952
 10953     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10954     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10955     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10956     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10957     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10958
 10959     IF BROWSE-STARTED
 10960        PERFORM 9990-RETURN THRU 9990-EXIT
 10961        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10962
 10963     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10964        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10965        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10966        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10967*       MOVE 1                   TO DC-OPTION-CODE
 10968        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10969        IF DATE-CONVERSION-ERROR
 10970           MOVE ER-2622          TO WS-ERROR
 10971           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10972        ELSE
 10973           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10974              MOVE ER-2623       TO WS-ERROR
 10975              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10976           ELSE
 10977              MOVE ER-2622       TO WS-ERROR
 10978              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10979
 10980     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10981     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10982     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10983*    MOVE 1                      TO DC-OPTION-CODE.
 10984     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10985     IF DATE-CONVERSION-ERROR
 10986        GO TO 3005-EDIT-CONTINUE
 10987     ELSE
 10988        IF DC-ELAPSED-DAYS GREATER +180
 10989           MOVE ER-2613          TO WS-ERROR
 10990           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10991        ELSE
 10992           IF DC-ELAPSED-DAYS GREATER +90
 10993              MOVE ER-2612       TO WS-ERROR
 10994              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10995           ELSE
 10996             IF DC-ELAPSED-DAYS GREATER +60
 10997                MOVE ER-2614     TO WS-ERROR
 10998                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10999
 11000 3005-EDIT-CONTINUE.
 11001
 11002     IF PB-CANCELLATION
 11003         GO TO 3700-EDIT-CANCEL.
 11004
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 201
* EL050.cbl
 11006******************************************************************
 11007*                  E D I T   I S S U E                           *
 11008******************************************************************
 11009
 11010 3020-EDIT-ISSUE.
 11011
 11012      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11013      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11014      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11015      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11016      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11017
 11018     IF PB-ISSUE-FORCE
 11019        OR PB-ISSUE-DATE-FORCED
 11020        OR PB-FORCE-OFF
 11021        OR PB-OVERCHARGE-FORCE
 11022        CONTINUE
 11023     ELSE
 11024        MOVE ER-2670             TO WS-ERROR
 11025        PERFORM 9900-ERROR-FORMAT
 11026                                 THRU 9900-EXIT
 11027     END-IF
 11028     .
 11029 3022-SET-POLICY-STATUS.
 11030
 11031     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11032
 11033     IF (PB-REISSUED-CERT)
 11034             OR
 11035        ((PB-COMPANY-ID NOT = 'DCC')
 11036         AND (PB-MONTHLY-CERT))
 11037         MOVE '5'                TO PB-I-ENTRY-STATUS
 11038         MOVE 'E'                TO PB-BATCH-ENTRY
 11039     END-IF
 11040
 11041     IF PB-COMPANY-ID = 'DCC'
 11042        IF PB-MONTHLY-CERT
 11043           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11044        END-IF
 11045     END-IF
 11046     IF PB-POLICY-IS-DECLINED
 11047         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11048     IF PB-POLICY-IS-VOIDED
 11049         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11050     IF PB-NEEDS-UNDERWRITING
 11051         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11052     IF PB-REIN-ONLY-CERT
 11053         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11054     IF PB-PREM-ACCTNG-ONLY
 11055         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11056
 11057     MOVE SPACE                  TO PB-I-OB-FLAG.
 11058
 11059     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11060         MOVE ER-2665            TO WS-ERROR
 11061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11062         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11063
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 202
* EL050.cbl
 11064     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11065        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11066           MOVE 'Z'             TO PB-I-OB-FLAG.
 11067
 11068     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11069        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11070           MOVE 'Z'             TO PB-I-OB-FLAG.
 11071
 11072     IF ACCOUNT-MAST-FOUND
 11073         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11074         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11075         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11076         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11077         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11078         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11079         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11080     END-IF
 11081
 11082     IF ACCOUNT-MAST-FOUND
 11083        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11084         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11085
 11086     IF (ACCOUNT-MAST-FOUND)
 11087        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11088        IF PB-REISSUED-CERT
 11089           CONTINUE
 11090        ELSE
 11091           MOVE ER-2608          TO WS-ERROR
 11092           PERFORM 9900-ERROR-FORMAT
 11093                                 THRU 9900-EXIT
 11094         END-IF
 11095     END-IF
 11096
 11097     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11098        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11099        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11100
 11101**********   DMD CUSTOM CODE FOLLOWS  **********
 11102 3024-EDIT-DMD-FIELDS.
 11103     IF PB-COMPANY-ID NOT = 'DMD'
 11104        GO TO 3025-EDIT-REINSURANCE.
 11105
 11106*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11107*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11108*** ERROR IF THEY ARE NOT EQUAL.
 11109
 11110     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11111     SET BIN-TO-GREG               TO TRUE.
 11112     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11113     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11114**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11115
 11116     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11117     SET BIN-TO-GREG               TO TRUE.
 11118     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11119     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11120**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11121
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 203
* EL050.cbl
 11122     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11123        MOVE ER-8116               TO WS-ERROR
 11124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11125
 11126     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11127
 11128     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11129                                      WK-FULL-CERT-NO.
 11130     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11131
 11132     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11133
 11134     IF PB-VALID-LIFE
 11135        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11136     ELSE
 11137        IF PB-VALID-AH
 11138          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11139
 11140
 11141     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11142     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11143     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11144                                      DCUA-UNDRWRTR-CODE
 11145                                      DCUA-UNDRWRTR-GROUP-CODE
 11146                                      DCUA-RETURN-CODE.
 11147
 11148****************************************************************
 11149*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11150***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11151***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11152***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11153***   TO THIS RECORD.                                        ***
 11154****************************************************************
 11155     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11156     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11157     IF DCUA-SUCCESSFUL-PROCESS
 11158        GO TO 3024-EDIT-DL7-CONT.
 11159
 11160     IF DCUA-RETURN-CODE EQUAL '01'
 11161        MOVE ER-8110               TO WS-ERROR
 11162        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11163        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11164        GO TO 3024-EDIT-DL7-CONT.
 11165
 11166     IF DCUA-RETURN-CODE EQUAL '02'
 11167        MOVE ER-8111               TO WS-ERROR
 11168        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11170        GO TO 3024-EDIT-DL7-CONT.
 11171
 11172     IF DCUA-RETURN-CODE EQUAL '03'
 11173        MOVE ER-8074               TO WS-ERROR
 11174        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11176        GO TO 3024-EDIT-DL7-CONT.
 11177
 11178     IF DCUA-RETURN-CODE EQUAL '04'
 11179        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 204
* EL050.cbl
 11180        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11182        GO TO 3024-EDIT-DL7-CONT.
 11183
 11184     IF DCUA-RETURN-CODE EQUAL '05'
 11185        MOVE ER-8076               TO WS-ERROR
 11186        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11188        GO TO 3024-EDIT-DL7-CONT.
 11189
 11190     IF DCUA-RETURN-CODE EQUAL '06'
 11191        MOVE ER-8077               TO WS-ERROR
 11192        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11194        GO TO 3024-EDIT-DL7-CONT.
 11195
 11196     IF DCUA-RETURN-CODE EQUAL '07'
 11197        MOVE ER-8078               TO WS-ERROR
 11198        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11200        GO TO 3024-EDIT-DL7-CONT.
 11201
 11202     IF DCUA-RETURN-CODE EQUAL 'E1'
 11203        MOVE ER-8079               TO WS-ERROR
 11204        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11206        GO TO 3024-EDIT-DL7-CONT.
 11207
 11208     IF DCUA-RETURN-CODE EQUAL 'E2'
 11209        MOVE ER-8080               TO WS-ERROR
 11210        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11212        GO TO 3024-EDIT-DL7-CONT.
 11213
 11214     IF DCUA-RETURN-CODE EQUAL 'E3'
 11215        MOVE ER-8098               TO WS-ERROR
 11216        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11218        GO TO 3024-EDIT-DL7-CONT.
 11219
 11220     IF DCUA-RETURN-CODE EQUAL 'C1'
 11221        MOVE ER-8099               TO WS-ERROR
 11222        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11224        GO TO 3024-EDIT-DL7-CONT.
 11225
 11226     IF DCUA-RETURN-CODE EQUAL 'U1'
 11227        MOVE ER-8109               TO WS-ERROR
 11228        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11230        GO TO 3024-EDIT-DL7-CONT.
 11231
 11232     IF DCUA-RETURN-CODE EQUAL 'N1'
 11233        MOVE ER-8112               TO WS-ERROR
 11234        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11235        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11236        GO TO 3024-EDIT-DL7-CONT.
 11237
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 205
* EL050.cbl
 11238     IF DCUA-RETURN-CODE EQUAL 'N2'
 11239        MOVE ER-8113               TO WS-ERROR
 11240        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11242        GO TO 3024-EDIT-DL7-CONT.
 11243
 11244     IF DCUA-RETURN-CODE EQUAL 'N3'
 11245        MOVE ER-8114               TO WS-ERROR
 11246        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11248        GO TO 3024-EDIT-DL7-CONT.
 11249
 11250     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11251     MOVE ER-8097                  TO WS-ERROR.
 11252     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11253     GO TO 3024-EDIT-DL7-CONT.
 11254
 11255 3024-EDIT-DL7-CONT.
 11256
 11257     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11258     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11259     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11260        NEXT SENTENCE
 11261     ELSE
 11262        MOVE ER-9263               TO WS-ERROR
 11263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11264
 11265******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11266******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11267     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11268        NEXT SENTENCE
 11269     ELSE
 11270        MOVE ER-8039               TO WS-ERROR
 11271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11272
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 206
* EL050.cbl
 11274****************************************************************
 11275*** VALIDATE STATE  : DLO022                                 ***
 11276****************************************************************
 11277     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11278     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11279
 11280     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11281     IF DVSC-SUCCESSFUL-EDIT
 11282        GO TO 3024-EDIT-DL22-CONT.
 11283
 11284     IF DVSC-RETURN-CODE EQUAL '01'
 11285        MOVE ER-8300               TO WS-ERROR
 11286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11287        GO TO 3024-EDIT-DL22-CONT.
 11288
 11289     IF DVSC-RETURN-CODE EQUAL '02'
 11290        MOVE ER-8301               TO WS-ERROR
 11291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11292        GO TO 3024-EDIT-DL22-CONT.
 11293
 11294     IF DVSC-RETURN-CODE EQUAL '03'
 11295        MOVE ER-8302               TO WS-ERROR
 11296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11297        GO TO 3024-EDIT-DL22-CONT.
 11298
 11299     IF DVSC-RETURN-CODE EQUAL 'N1'
 11300        MOVE ER-8304               TO WS-ERROR
 11301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11302        GO TO 3024-EDIT-DL22-CONT.
 11303
 11304     MOVE ER-8303                  TO WS-ERROR
 11305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11306
 11307 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 207
* EL050.cbl
 11309****************************************************************
 11310*** VALIDATE LOAN OFFICER : DLO021                           ***
 11311****************************************************************
 11312
 11313     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11314     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11315     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11316     IF DVLO-SUCCESSFUL-EDIT
 11317        GO TO 3024-EDIT-DL21-CONT.
 11318
 11319     IF DVLO-RETURN-CODE EQUAL '01'
 11320        MOVE ER-8081               TO WS-ERROR
 11321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11322        GO TO 3024-EDIT-DL21-CONT.
 11323
 11324     IF DVLO-RETURN-CODE EQUAL '02'
 11325        MOVE ER-8082               TO WS-ERROR
 11326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11327        GO TO 3024-EDIT-DL21-CONT.
 11328
 11329     IF DVLO-RETURN-CODE EQUAL '03'
 11330        MOVE ER-8083               TO WS-ERROR
 11331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11332        GO TO 3024-EDIT-DL21-CONT.
 11333
 11334     IF DVLO-RETURN-CODE EQUAL '04'
 11335        MOVE ER-8084               TO WS-ERROR
 11336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11337        GO TO 3024-EDIT-DL21-CONT.
 11338
 11339     IF DVLO-RETURN-CODE EQUAL '05'
 11340        MOVE ER-8085               TO WS-ERROR
 11341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11342        GO TO 3024-EDIT-DL21-CONT.
 11343
 11344     MOVE ER-7825                  TO WS-ERROR
 11345     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11346     GO TO 3024-EDIT-DL21-CONT.
 11347
 11348 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 208
* EL050.cbl
 11350
 11351****************************************************************
 11352*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11353****************************************************************
 11354
 11355     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11356     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11357     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11358     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11359     IF DIPF-SUCCESSFUL-EDIT
 11360        GO TO 3024-EDIT-DL02-CONT.
 11361
 11362     IF DIPF-RETURN-CODE EQUAL '01'
 11363        MOVE ER-8086               TO WS-ERROR
 11364        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11365        GO TO 3024-EDIT-DL02-CONT.
 11366
 11367     IF DIPF-RETURN-CODE EQUAL '02'
 11368        MOVE ER-8087               TO WS-ERROR
 11369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11370        GO TO 3024-EDIT-DL02-CONT.
 11371
 11372     IF DIPF-RETURN-CODE EQUAL '03'
 11373        MOVE ER-8088               TO WS-ERROR
 11374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11375        GO TO 3024-EDIT-DL02-CONT.
 11376
 11377     MOVE ER-8095                  TO WS-ERROR
 11378     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11379     GO TO 3024-EDIT-DL02-CONT.
 11380
 11381 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 209
* EL050.cbl
 11383
 11384****************************************************************
 11385*** VALIDATE BANK ID : DLO003                                ***
 11386****************************************************************
 11387
 11388     MOVE WK-GREG-CENT           TO WCG-CENT.
 11389     MOVE WK-GREG-YYMM           TO WCG-REST.
 11390     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11391        MOVE ER-8040               TO WS-ERROR
 11392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11393
 11394     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11395     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11396     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11397     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11398     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11399     IF DVBI-SUCCESSFUL-EDIT
 11400        GO TO 3024-EDIT-DL03-CONT.
 11401
 11402     IF DVBI-RETURN-CODE EQUAL '01'
 11403        MOVE ER-8089               TO WS-ERROR
 11404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11405        GO TO 3024-EDIT-DL03-CONT.
 11406
 11407     IF DVBI-RETURN-CODE EQUAL '02'
 11408        MOVE ER-8090               TO WS-ERROR
 11409        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11410        GO TO 3024-EDIT-DL03-CONT.
 11411
 11412     IF DVBI-RETURN-CODE EQUAL '03'
 11413        MOVE ER-8091               TO WS-ERROR
 11414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11415        GO TO 3024-EDIT-DL03-CONT.
 11416
 11417     IF DVBI-RETURN-CODE EQUAL '04'
 11418        MOVE ER-8092               TO WS-ERROR
 11419        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11420        GO TO 3024-EDIT-DL03-CONT.
 11421
 11422     IF DVBI-RETURN-CODE EQUAL '05'
 11423        MOVE ER-8093               TO WS-ERROR
 11424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11425        GO TO 3024-EDIT-DL03-CONT.
 11426
 11427     IF DVBI-RETURN-CODE EQUAL '06'
 11428        MOVE ER-8094               TO WS-ERROR
 11429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11430        GO TO 3024-EDIT-DL03-CONT.
 11431
 11432     MOVE ER-8096                  TO WS-ERROR
 11433     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11434     GO TO 3024-EDIT-DL03-CONT.
 11435
 11436 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 210
* EL050.cbl
 11438
 11439     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11440        NEXT SENTENCE
 11441     ELSE
 11442        MOVE ER-8042               TO WS-ERROR
 11443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11444
 11445     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11446     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11447     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11448
 11449     IF DMPF-RETURN-CODE = '01'
 11450        MOVE ER-8067               TO WS-ERROR
 11451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11452        GO TO 3024-EDIT-DL01-CONT.
 11453
 11454     IF DMPF-RETURN-CODE = '02'
 11455        MOVE ER-8068               TO WS-ERROR
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11457        GO TO 3024-EDIT-DL01-CONT.
 11458
 11459     IF DMPF-RETURN-CODE = '03'
 11460        MOVE ER-8069               TO WS-ERROR
 11461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11462        GO TO 3024-EDIT-DL01-CONT.
 11463
 11464     IF DMPF-RETURN-CODE = 'E1'
 11465        MOVE ER-8070               TO WS-ERROR
 11466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467        GO TO 3024-EDIT-DL01-CONT.
 11468
 11469     IF DMPF-RETURN-CODE = 'N1'
 11470        MOVE ER-8071               TO WS-ERROR
 11471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11472        GO TO 3024-EDIT-DL01-CONT.
 11473
 11474     IF DMPF-RETURN-CODE NOT = 'OK'
 11475        MOVE ER-8072               TO WS-ERROR
 11476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11477
 11478 3024-EDIT-DL01-CONT.
 11479******************************************************************
 11480***  VALIDATES RATE CODES : DLO017                             ***
 11481******************************************************************
 11482
 11483      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11484      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11485      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11486      IF DVRC-SUCCESSFUL-EDIT
 11487        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11488        GO TO 3024-CHECK-VALID-RATE.
 11489
 11490      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11491
 11492      IF DVRC-RETURN-CODE EQUAL '01'
 11493         MOVE ER-7817                   TO WS-ERROR
 11494         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11495         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 211
* EL050.cbl
 11496
 11497      IF DVRC-RETURN-CODE EQUAL '02'
 11498         MOVE ER-7818                   TO WS-ERROR
 11499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11500         GO TO 3025-EDIT-REINSURANCE.
 11501
 11502      IF DVRC-RETURN-CODE EQUAL '03'
 11503         MOVE ER-7819                   TO WS-ERROR
 11504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11505         GO TO 3025-EDIT-REINSURANCE.
 11506
 11507       MOVE ER-7820                     TO WS-ERROR.
 11508       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11509       GO TO 3025-EDIT-REINSURANCE.
 11510
 11511******************************************************************
 11512***  GET PREMIUM RATES : DLO011                                ***
 11513******************************************************************
 11514
 11515 3024-CHECK-VALID-RATE.
 11516
 11517     IF VALID-RATE-CODE
 11518        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11519        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11520        MOVE SPACES                TO DPRB-RETURN-CODE
 11521        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11522     ELSE
 11523         GO TO 3025-EDIT-REINSURANCE.
 11524
 11525      IF DPRB-SUCCESSFUL-PROCESS
 11526         IF PB-VALID-LIFE
 11527             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11528             GO TO 3025-EDIT-REINSURANCE
 11529         ELSE
 11530             IF PB-VALID-AH
 11531                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11532                 GO TO 3025-EDIT-REINSURANCE.
 11533
 11534      IF DPRB-RETURN-CODE EQUAL '01'
 11535         MOVE ER-7812                   TO WS-ERROR
 11536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537         GO TO 3025-EDIT-REINSURANCE.
 11538
 11539      IF DPRB-RETURN-CODE EQUAL '02'
 11540         MOVE ER-7813                   TO WS-ERROR
 11541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542         GO TO 3025-EDIT-REINSURANCE.
 11543
 11544      IF DPRB-RETURN-CODE EQUAL '03'
 11545         MOVE ER-7814                   TO WS-ERROR
 11546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547         GO TO 3025-EDIT-REINSURANCE.
 11548
 11549      IF DPRB-RETURN-CODE EQUAL '04'
 11550         IF NOT DPRB-1ST-TIME
 11551            MOVE ER-7815                   TO WS-ERROR
 11552            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11553            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 212
* EL050.cbl
 11554          ELSE
 11555         IF PB-VALID-LIFE
 11556            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11557          ELSE
 11558            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11559         END-IF
 11560         MOVE SPACES                TO DOCC-RETURN-CODE
 11561         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11562         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11563         IF DOCC-RETURN-CODE = 'OK'
 11564             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11565             GO TO 3024-CHECK-VALID-RATE
 11566           ELSE
 11567             MOVE ER-7823               TO WS-ERROR
 11568             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11569             GO TO 3025-EDIT-REINSURANCE.
 11570
 11571       MOVE ER-7816                     TO WS-ERROR.
 11572       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11573       GO TO 3025-EDIT-REINSURANCE.
 11574
 11575**********   DMD CUSTOM CODE ABOVE    **********
 11576
 11577 3025-EDIT-REINSURANCE.
 11578     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11579         GO TO 3027-EDIT-CONTINUE.
 11580
 11581     MOVE LOW-VALUES               TO ERREIN-KEY.
 11582     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11583     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11584                                      REIN-CODE-2
 11585                                      REIN-CODE-3.
 11586     MOVE 'A'                      TO REIN-TYPE.
 11587
 11588     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11589
 11590     MOVE '3026' TO REIN-SW.
 11591     MOVE ' '                   TO WS-REIN-READ-SW.
 11592
 11593     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11594     IF REIN-TABLE-NOT-FOUND
 11595         GO TO 3026-NO-SPEC-TABLE.
 11596
 11597     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11598     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11599                                   WS-NSP-ST-CD-LF.
 11600     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11601                                   WS-NSP-ST-CD-AH.
 11602
 11603     GO TO 3040-EDIT-CONTINUE.
 11604
 11605 3026-NO-SPEC-TABLE.
 11606
 11607     MOVE ER-2664                TO WS-ERROR.
 11608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11609     GO TO 3040-EDIT-CONTINUE.
 11610
 11611 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 213
* EL050.cbl
 11612
 11613     IF PB-I-REIN-TABLE = SPACES
 11614       GO TO 3040-EDIT-CONTINUE.
 11615
 11616     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11617          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11618          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11619           GO TO 3040-EDIT-CONTINUE.
 11620
 11621     MOVE LOW-VALUES            TO ERREIN-KEY.
 11622     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11623     MOVE 'A'                   TO REIN-TYPE.
 11624     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11625
 11626     MOVE '3028'                TO REIN-SW.
 11627     MOVE ' '                   TO WS-REIN-READ-SW.
 11628
 11629     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11630     IF REIN-TABLE-NOT-FOUND
 11631         GO TO 3028-NO-REIN-TABLE.
 11632
 11633     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11634     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11635                                   WS-NSP-ST-CD-LF.
 11636     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11637                                   WS-NSP-ST-CD-AH.
 11638
 11639     GO TO 3040-EDIT-CONTINUE.
 11640
 11641 3028-NO-REIN-TABLE.
 11642
 11643     MOVE ER-2615                TO WS-ERROR.
 11644     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11645     GO TO 3040-EDIT-CONTINUE.
 11646
 11647 3040-EDIT-CONTINUE.
 11648
 11649     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11650         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11651
 11652     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11653         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11654
 11655     IF (NOT PB-REISSUED-CERT)
 11656        AND (NOT PB-MONTHLY-CERT)
 11657        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11658            MOVE '001'           TO PB-I-LF-TERM
 11659            MOVE 'M'             TO PB-I-INSURED-SEX.
 11660
 11661     IF (NOT PB-REISSUED-CERT)
 11662        AND (NOT PB-MONTHLY-CERT)
 11663        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11664            MOVE '001'           TO PB-I-AH-TERM
 11665            MOVE 'M'             TO PB-I-INSURED-SEX.
 11666
 11667 3040-EDIT-1ST-PMT-DT.
 11668     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11669     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 214
* EL050.cbl
 11670         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11671
 11672******************************************************************
 11673*                                                                *
 11674*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11675*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11676*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11677*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11678*                                                                *
 11679******************************************************************
 11680
 11681     IF PB-EFF-DT-PROCESSING
 11682        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11683                                    PB-I-LF-EXPIRE-DT
 11684                                    PB-I-AH-EXPIRE-DT
 11685        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11686        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11687        MOVE ZERO                TO DC-ELAPSED-DAYS
 11688        MOVE +1                  TO DC-ELAPSED-MONTHS
 11689        SET BIN-PLUS-ELAPSED     TO TRUE
 11690*       MOVE 6                   TO DC-OPTION-CODE
 11691        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11692        IF NO-CONVERSION-ERROR
 11693           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11694
 11695******************************************************************
 11696*                                                                *
 11697*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11698*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11699*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11700*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11701*                                                                *
 11702******************************************************************
 11703
 11704     IF PB-EXT-DAYS-PROCESSING
 11705          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11706                                         PB-I-LF-EXPIRE-DT
 11707                                         PB-I-AH-EXPIRE-DT
 11708          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11709          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11710          MOVE +1                     TO DC-ELAPSED-MONTHS
 11711          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11712          SET BIN-PLUS-ELAPSED        TO TRUE
 11713*         MOVE 6                      TO DC-OPTION-CODE
 11714          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11715          IF NO-CONVERSION-ERROR
 11716             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11717
 11718******************************************************************
 11719*                                                                *
 11720*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11721*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11722*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11723*        (EXPIRE DATE - (TERM -1))  *  -1.
 11724*                                                                *
 11725******************************************************************
 11726
 11727     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 215
* EL050.cbl
 11728        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11729           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11730              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11731              MOVE PB-I-AH-TERM      TO WS-TERM
 11732           ELSE
 11733              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11734              MOVE PB-I-LF-TERM      TO WS-TERM
 11735        ELSE
 11736           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11737              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11738              MOVE PB-I-LF-TERM      TO WS-TERM
 11739           ELSE
 11740              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11741              MOVE PB-I-AH-TERM      TO WS-TERM.
 11742
 11743     IF PB-EXPIRE-DT-PROCESSING
 11744        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11745        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11746        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11747        MOVE ZERO                TO DC-ELAPSED-DAYS
 11748                                    DC-ODD-DAYS-OVER
 11749          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11750          SET BIN-PLUS-ELAPSED    TO TRUE
 11751*         MOVE 6                  TO DC-OPTION-CODE
 11752          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11753          IF NO-CONVERSION-ERROR
 11754             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11755
 11756******************************************************************
 11757*                                                                *
 11758*            1ST PAYMENT DATE PROCESSING                         *
 11759*                                                                *
 11760******************************************************************
 11761
 11762     IF PB-1ST-PMT-DT-PROCESSING
 11763        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11764                                    PB-I-AH-EXPIRE-DT
 11765        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11766
 11767     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11768         NEXT SENTENCE
 11769     ELSE
 11770         MOVE ER-2680                 TO WS-ERROR
 11771         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11772         GO TO 3060-ORIG-TERM-CHECK.
 11773
 11774     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11775     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11776     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11777*    MOVE 1                      TO DC-OPTION-CODE.
 11778     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11779                                    DC-ELAPSED-DAYS
 11780                                    DC-ODD-DAYS-OVER.
 11781
 11782     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11783
 11784     IF DATE-CONVERSION-ERROR
 11785        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 216
* EL050.cbl
 11786
 11787     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11788     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11789        AND (WS-LF-COVERAGE-TYPE = 'L')
 11790        IF (DC-ELAPSED-MONTHS > 1)
 11791                      OR
 11792           ((DC-ELAPSED-MONTHS = 1)
 11793           AND (DC-ODD-DAYS-OVER > 0))
 11794           MOVE ER-2882          TO WS-ERROR
 11795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796        END-IF
 11797     END-IF
 11798     IF PB-EXT-DAYS-PROCESSING
 11799        CONTINUE
 11800     ELSE
 11801        IF DC-ELAPSED-MONTHS = +0
 11802           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11803        ELSE
 11804           IF (WS-LF-EARNINGS-CALC = '4')
 11805              AND (DC-ELAPSED-MONTHS > ZERO)
 11806              AND (DC-ELAPSED-DAYS > ZERO)
 11807              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11808           ELSE
 11809              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11810                                 THRU 6499-EXIT
 11811              MOVE WS-ODD-DAYS-OVER
 11812                                 TO PB-I-EXTENTION-DAYS
 11813           END-IF
 11814        END-IF
 11815     END-IF
 11816******************************************************************
 11817*                                                                *
 11818*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11819*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11820*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11821*            AND ANY ODD DAYS.                                   *
 11822*                                                                *
 11823******************************************************************
 11824
 11825     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11826                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11827     IF WS-LF-EARNINGS-CALC NOT = '4'
 11828        IF DC-ELAPSED-DAYS > ZEROS
 11829           MOVE ER-2681          TO WS-ERROR
 11830           PERFORM 9900-ERROR-FORMAT
 11831                                 THRU 9900-EXIT
 11832        END-IF
 11833     END-IF
 11834
 11835     IF WS-LF-EARNINGS-CALC NOT = '4'
 11836        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11837           MOVE ER-2681          TO WS-ERROR
 11838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11839
 11840     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11841        (PB-I-LF-TERM NOT = ZERO) AND
 11842         NOT NO-LIFE-COVERAGE
 11843          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 217
* EL050.cbl
 11844          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11845          IF WS-LF-EARNINGS-CALC = '4'
 11846             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11847             PB-I-PAY-FREQUENCY
 11848          END-IF
 11849          MOVE ZERO              TO DC-ELAPSED-DAYS
 11850                                    DC-ODD-DAYS-OVER
 11851          MOVE 1                 TO DC-END-OF-MONTH
 11852          SET BIN-PLUS-ELAPSED        TO TRUE
 11853*         MOVE 6                 TO DC-OPTION-CODE
 11854          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11855          IF NO-CONVERSION-ERROR
 11856             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11857             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11858                (WS-LF-SPECIAL-CALC-CD = 'L')
 11859                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11860                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11861                  MOVE +1             TO DC-ELAPSED-MONTHS
 11862                  SET BIN-PLUS-ELAPSED  TO TRUE
 11863*                 MOVE 6              TO DC-OPTION-CODE
 11864                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11865                  IF NO-CONVERSION-ERROR
 11866                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11867
 11868* okay, i had to move the new att age edit down here because the
 11869* expiration date could get recalculated and i need the exp date
 11870     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11871        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11872        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11873        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11874           AND ZEROS
 11875           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11876           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11877           SET ELAPSED-BETWEEN-BIN TO TRUE
 11878           PERFORM 8500-DATE-CONVERT
 11879                                 THRU 8500-EXIT
 11880           IF NO-CONVERSION-ERROR
 11881              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11882                 MOVE ER-2669       TO WS-ERROR
 11883*                PERFORM 9900-ERROR-FORMAT
 11884*                                THRU 9900-EXIT
 11885              END-IF
 11886           END-IF
 11887        ELSE
 11888           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11889           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11890              MOVE ER-2669       TO WS-ERROR
 11891*             PERFORM 9900-ERROR-FORMAT
 11892*                                THRU 9900-EXIT
 11893           ELSE
 11894              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11895                 MOVE ER-1570    TO WS-ERROR
 11896                 PERFORM 9900-ERROR-FORMAT
 11897                                 THRU 9900-EXIT
 11898              END-IF
 11899           END-IF
 11900        END-IF
 11901        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 218
* EL050.cbl
 11902           AND ZEROS
 11903           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11904           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11905           SET ELAPSED-BETWEEN-BIN TO TRUE
 11906           PERFORM 8500-DATE-CONVERT
 11907                                 THRU 8500-EXIT
 11908           IF NO-CONVERSION-ERROR
 11909              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11910                 MOVE ER-2669       TO WS-ERROR
 11911*                PERFORM 9900-ERROR-FORMAT
 11912*                                THRU 9900-EXIT
 11913              END-IF
 11914           END-IF
 11915        ELSE
 11916           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11917             (PB-I-LF-TERM / 12)
 11918           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11919              MOVE ER-2669       TO WS-ERROR
 11920*             PERFORM 9900-ERROR-FORMAT
 11921*                                THRU 9900-EXIT
 11922           ELSE
 11923              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11924                 MOVE ER-1571    TO WS-ERROR
 11925                 PERFORM 9900-ERROR-FORMAT
 11926                                 THRU 9900-EXIT
 11927              END-IF
 11928           END-IF
 11929        END-IF
 11930        IF WS-ERROR = ER-2669
 11931           PERFORM 9900-ERROR-FORMAT
 11932                                 THRU 9900-EXIT
 11933        END-IF
 11934     END-IF
 11935     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11936        (PB-I-AH-TERM NOT = ZERO) AND
 11937         NOT NO-AH-COVERAGE
 11938          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11939             AND (PB-COMPANY-ID = 'DCC')
 11940             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11941             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11942          ELSE
 11943             IF WS-LF-EARNINGS-CALC = '4'
 11944                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11945                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11946                PB-I-PAY-FREQUENCY
 11947             ELSE
 11948                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11949                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11950             END-IF
 11951          END-IF
 11952          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11953                                         DC-ODD-DAYS-OVER
 11954          MOVE 1                      TO DC-END-OF-MONTH
 11955          SET BIN-PLUS-ELAPSED        TO TRUE
 11956*         MOVE 6                      TO DC-OPTION-CODE
 11957          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11958          IF NO-CONVERSION-ERROR
 11959             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 219
* EL050.cbl
 11960     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11961        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11962        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11963        IF PB-I-BIRTHDAY > LOW-VALUES
 11964           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11965           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11966           SET ELAPSED-BETWEEN-BIN TO TRUE
 11967           PERFORM 8500-DATE-CONVERT
 11968                                 THRU 8500-EXIT
 11969           IF NO-CONVERSION-ERROR
 11970              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11971                 MOVE ER-3054       TO WS-ERROR
 11972*                PERFORM 9900-ERROR-FORMAT
 11973*                                THRU 9900-EXIT
 11974              END-IF
 11975           END-IF
 11976        ELSE
 11977           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11978           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11979              MOVE ER-3054       TO WS-ERROR
 11980*             PERFORM 9900-ERROR-FORMAT
 11981*                                THRU 9900-EXIT
 11982           END-IF
 11983        END-IF
 11984        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11985           AND ZEROS
 11986           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11987           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11988           SET ELAPSED-BETWEEN-BIN TO TRUE
 11989           PERFORM 8500-DATE-CONVERT
 11990                                 THRU 8500-EXIT
 11991           IF NO-CONVERSION-ERROR
 11992              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11993                 MOVE ER-3054       TO WS-ERROR
 11994*                PERFORM 9900-ERROR-FORMAT
 11995*                                THRU 9900-EXIT
 11996              END-IF
 11997           END-IF
 11998        ELSE
 11999           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12000             (PB-I-AH-TERM / 12)
 12001           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12002              MOVE ER-3054       TO WS-ERROR
 12003*             PERFORM 9900-ERROR-FORMAT
 12004*                                THRU 9900-EXIT
 12005           END-IF
 12006        END-IF
 12007        IF WS-ERROR = ER-3054
 12008           PERFORM 9900-ERROR-FORMAT
 12009                                 THRU 9900-EXIT
 12010        END-IF
 12011     END-IF
 12012     MOVE SPACE                       TO DC-END-OF-MONTH.
 12013
 12014     IF PB-COMPANY-ID = 'NCB'
 12015        GO TO 3040-EDIT-EXTENSION-DAYS.
 12016
 12017     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 220
* EL050.cbl
 12018       AND
 12019        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12020        NEXT SENTENCE
 12021     ELSE
 12022        GO TO 3040-EDIT-EXTENSION-DAYS.
 12023
 12024     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12025        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12026        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12027     ELSE
 12028        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12029        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12030
 12031     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12032*    MOVE '1'      TO DC-OPTION-CODE
 12033     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12034     IF (NO-CONVERSION-ERROR)
 12035        AND (DC-ELAPSED-MONTHS > +1)
 12036        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12037        MOVE ER-2668   TO WS-ERROR
 12038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12039
 12040 3040-EDIT-EXTENSION-DAYS.
 12041
 12042     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12043        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12044         GO TO 3050-EDIT-TERM-IN-DAYS
 12045     ELSE
 12046         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12047
 12048     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12049         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12050     ELSE
 12051        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12052           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12053           MOVE ER-2681         TO WS-ERROR
 12054           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12055
 12056     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12057        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12058        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12059         GO TO 3060-ORIG-TERM-CHECK.
 12060
 12061     GO TO 3060-ORIG-TERM-CHECK.
 12062
 12063 3050-EDIT-TERM-IN-DAYS.
 12064
 12065     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12066
 12067     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12068         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12069     ELSE
 12070         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12071            MOVE ER-2682         TO WS-ERROR
 12072            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12073
 12074     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12075                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 221
* EL050.cbl
 12076     IF WS-WORK-TERM GREATER THAN ZERO
 12077         ADD +1 TO PB-I-LF-TERM.
 12078
 12079     IF NOT NO-AH-COVERAGE
 12080         MOVE ER-2684            TO WS-ERROR
 12081         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12082
 12083
 12084 3060-ORIG-TERM-CHECK.
 12085
 12086******************************************************************
 12087*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12088******************************************************************
 12089
 12090     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12091        NEXT SENTENCE
 12092     ELSE
 12093        IF NOT NO-LIFE-COVERAGE
 12094           IF PB-I-LF-TERM NUMERIC
 12095              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12096              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12097              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12098                  NEXT SENTENCE
 12099           ELSE
 12100              MOVE ER-2647       TO WS-ERROR
 12101              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12102
 12103     IF NOT NO-AH-COVERAGE
 12104         IF PB-I-AH-TERM NUMERIC
 12105            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12106            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12107            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12108             NEXT SENTENCE
 12109          ELSE
 12110              MOVE ER-2658       TO WS-ERROR
 12111              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12112
 12113     IF PB-COMPANY-ID = 'NCB'
 12114        GO TO 3070-LOAN-TERM-CHECK.
 12115
 12116     IF POLICY-HAS-AH
 12117       AND
 12118        POLICY-HAS-LIFE
 12119       AND
 12120        PB-I-LF-TERM NUMERIC
 12121       AND
 12122        PB-I-AH-TERM NUMERIC
 12123        NEXT SENTENCE
 12124     ELSE
 12125        GO TO 3070-LOAN-TERM-CHECK.
 12126
 12127     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12128     IF WS-TEX-FACT-2 LESS THAN +0
 12129        MULTIPLY +1 BY WS-TEX-FACT-2.
 12130
 12131     IF WS-TEX-FACT-2 GREATER THAN +1
 12132        MOVE ER-2668             TO WS-ERROR
 12133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 222
* EL050.cbl
 12134
 12135 3070-LOAN-TERM-CHECK.
 12136
 12137     IF (WS-LF-BENEFIT-CD = ZERO)
 12138         OR (NO-LF-BENEFIT-MATCH)
 12139            GO TO 3125-EDIT-PMT-FREQ.
 12140*    IF PB-COMPANY-ID NOT = 'DCC'
 12141*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12142*          AND 'V' AND 'W' AND 'X'
 12143*          GO TO 3125-EDIT-PMT-FREQ
 12144*       END-IF
 12145*    ELSE
 12146*       IF WS-AH-DCC-TRUNC = 'T'
 12147*          CONTINUE
 12148*       ELSE
 12149*          GO TO 3125-EDIT-PMT-FREQ
 12150*       END-IF
 12151*    END-IF
 12152     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12153                    OR
 12154        ((PB-COMPANY-ID = 'DCC')
 12155        AND (WS-AH-DCC-TRUNC = 'T'))
 12156        CONTINUE
 12157     ELSE
 12158        GO TO 3125-EDIT-PMT-FREQ
 12159     END-IF
 12160     IF PB-I-LOAN-TERM NOT NUMERIC
 12161         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12162
 12163     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12164        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12165        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12166        PB-I-LOAN-TERM NOT GREATER THAN +360
 12167         NEXT SENTENCE
 12168     ELSE
 12169         MOVE ER-2648            TO WS-ERROR
 12170         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12171
 12172     IF WS-STATE-ABBREVIATION = 'NC'
 12173        IF PB-I-LOAN-TERM > +59
 12174           CONTINUE
 12175        ELSE
 12176           MOVE ER-2792          TO WS-ERROR
 12177           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12178        END-IF
 12179     END-IF
 12180
 12181     .
 12182 3125-EDIT-PMT-FREQ.
 12183     IF (WS-LF-BENEFIT-CD = ZERO)
 12184         OR (NO-LF-BENEFIT-MATCH)
 12185            GO TO 3127-EDIT-LOAN-OFFICER.
 12186     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12187                    OR
 12188        ((PB-COMPANY-ID = 'DCC')
 12189        AND (WS-AH-DCC-TRUNC = 'T'))
 12190                    OR
 12191         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 223
* EL050.cbl
 12192        CONTINUE
 12193     ELSE
 12194        IF (PB-I-LOAN-TERM > ZEROS)
 12195           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12196           MOVE ER-1575          TO WS-ERROR
 12197           PERFORM 9900-ERROR-FORMAT
 12198                                 THRU 9900-EXIT
 12199        END-IF
 12200     END-IF
 12201     IF WS-LF-EARNINGS-CALC NOT = '4'
 12202         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12203            MOVE ER-2653         TO WS-ERROR
 12204            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12205            GO TO 3127-EDIT-LOAN-OFFICER
 12206         ELSE
 12207            GO TO 3127-EDIT-LOAN-OFFICER.
 12208
 12209     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12210         MOVE ER-2655            TO WS-ERROR
 12211         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12212         GO TO 3127-EDIT-LOAN-OFFICER.
 12213
 12214     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12215         MOVE ER-2654            TO WS-ERROR
 12216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12217         GO TO 3127-EDIT-LOAN-OFFICER.
 12218
 12219     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12220         GIVING WS-TEX-FACT-2
 12221             REMAINDER WS-TEX-FACT-3.
 12222
 12223*    IF WS-TEX-FACT-3 NOT = ZERO
 12224*       MOVE ER-2654             TO WS-ERROR
 12225*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12226
 12227
 12228 3127-EDIT-LOAN-OFFICER.
 12229
 12230     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12231        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12232           MOVE ER-2690          TO WS-ERROR
 12233           PERFORM 9900-ERROR-FORMAT
 12234                                 THRU 9900-EXIT
 12235        ELSE
 12236           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12237           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12238           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12239           MOVE PB-SV-STATE      TO LOFC-STATE
 12240           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12241           MOVE PB-I-LOAN-OFFICER
 12242                                 TO LOFC-CODE
 12243           PERFORM 8586-READ-LOAN-OFFICER
 12244                                 THRU 8586-EXIT
 12245           IF (NOT LOFC-MASTER-FOUND)
 12246              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12247              MOVE ER-3006       TO WS-ERROR
 12248              PERFORM 9900-ERROR-FORMAT
 12249                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 224
* EL050.cbl
 12250           END-IF
 12251        END-IF
 12252     END-IF
 12253     .
 12254 3129-EDIT-APR.
 12255
 12256     IF (WS-LF-BENEFIT-CD = ZERO)
 12257        OR (NO-LF-BENEFIT-MATCH)
 12258        IF PB-COMPANY-ID NOT = 'DCC'
 12259           GO TO 3130-EDIT-AGE
 12260*       ELSE
 12261*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12262*             GO TO 3130-EDIT-AGE
 12263*          END-IF
 12264        END-IF
 12265     END-IF
 12266
 12267     IF (WS-STATE-ABBREVIATION = 'OH')
 12268         AND (PB-I-RATE-CLASS NOT = 'L ')
 12269         AND (PB-I-LF-TERM GREATER THAN 60)
 12270         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12271         GO TO 3129-APR-CONT.
 12272
 12273     IF (WS-STATE-ABBREVIATION = 'RI')
 12274         AND (PB-I-LF-TERM GREATER THAN 60)
 12275         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12276         GO TO 3129-APR-CONT.
 12277
 12278     IF (WS-STATE-ABBREVIATION = 'UT')
 12279         AND (PB-I-LF-TERM GREATER THAN 62)
 12280         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12281         AND (PB-CERT-EFF-DT LESS WS-830901)
 12282         GO TO 3129-APR-CONT.
 12283
 12284     IF PB-COMPANY-ID = 'LAP'
 12285        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12286           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12287              MOVE ER-2656         TO WS-ERROR
 12288              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12289              GO TO 3130-EDIT-AGE.
 12290
 12291     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12292        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12293        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12294        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12295         GO TO 3130-EDIT-AGE.
 12296
 12297 3129-APR-CONT.
 12298     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12299         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12300         GO TO 3130-EDIT-AGE.
 12301
 12302     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12303        AND (PB-COMPANY-ID = 'DCC')
 12304        AND (PB-I-LOAN-APR = ZERO)
 12305        MOVE ER-2657             TO WS-ERROR
 12306        PERFORM 9900-ERROR-FORMAT
 12307                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 225
* EL050.cbl
 12308        GO TO 3130-EDIT-AGE
 12309     END-IF
 12310     IF PB-I-LOAN-APR = ZERO
 12311        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12312     END-IF
 12313
 12314     IF PB-I-LOAN-APR = ZERO
 12315        MOVE ER-2656             TO WS-ERROR
 12316        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12317        GO TO 3130-EDIT-AGE.
 12318
 12319*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12320     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12321        MOVE ER-2657             TO WS-ERROR
 12322        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12323
 12324 3130-EDIT-AGE.
 12325
 12326******************************************************************
 12327*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12328******************************************************************
 12329
 12330     IF NOT NO-LIFE-COVERAGE
 12331        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12332           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12333               MOVE ER-2628             TO WS-ERROR
 12334               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12335
 12336     IF NOT NO-AH-COVERAGE
 12337        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12338           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12339               MOVE ER-2628         TO WS-ERROR
 12340               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12341
 12342 3133-SEX-CODE.
 12343     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12344         IF WS-DEFAULT-SEX = 'M'
 12345             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12346          ELSE
 12347             IF WS-DEFAULT-SEX = 'F'
 12348             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12349
 12350     IF PB-I-INSURED-SEX = '1'
 12351         MOVE 'M' TO PB-I-INSURED-SEX.
 12352
 12353     IF PB-I-INSURED-SEX = '2'
 12354         MOVE 'F' TO PB-I-INSURED-SEX.
 12355
 12356 3134-SIG-SW-EDIT.
 12357     IF PB-I-SIG-SW = SPACE
 12358         MOVE 'N'                TO  PB-I-SIG-SW.
 12359
 12360     IF PB-COMPANY-ID = 'NCL'
 12361         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12362             NEXT SENTENCE
 12363         ELSE
 12364             MOVE ER-1923        TO  WS-ERROR
 12365             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 226
* EL050.cbl
 12366     ELSE
 12367     IF PB-COMPANY-ID = 'CRI'
 12368         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12369             NEXT SENTENCE
 12370         ELSE
 12371             MOVE ER-2606        TO  WS-ERROR
 12372             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12373     ELSE
 12374     IF PB-COMPANY-ID = 'TMS'
 12375         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12376             NEXT SENTENCE
 12377         ELSE
 12378             MOVE ER-2689        TO  WS-ERROR
 12379             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12380     ELSE
 12381         IF PB-I-SIG-SW = 'Y' OR 'N'
 12382             NEXT SENTENCE
 12383         ELSE
 12384             MOVE ER-2651        TO  WS-ERROR
 12385             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12386
 12387     IF PB-COMPANY-ID = 'FLA'
 12388         IF (WS-EDIT-AGE GREATER 54  OR
 12389             WS-AH-EDIT-AGE GREATER 54)  AND
 12390            PB-I-SIG-SW = 'N'
 12391            MOVE ER-2651         TO  WS-ERROR
 12392            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12393
 12394 3135-NAME-EDIT.
 12395
 12396     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12397        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12398        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12399           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12400                                 TO PB-I-JOINT-FIRST-NAME
 12401        END-PERFORM
 12402     END-IF
 12403     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12404        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12405        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12406           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12407                                 TO PB-I-JOINT-LAST-NAME
 12408        END-PERFORM
 12409     END-IF
 12410     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12411        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12412        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12413           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12414                                 TO PB-I-INSURED-FIRST-NAME
 12415        END-PERFORM
 12416     END-IF
 12417     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12418        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12419        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12420           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12421                                 TO PB-I-INSURED-LAST-NAME
 12422        END-PERFORM
 12423     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 227
* EL050.cbl
 12424     IF PB-I-INSURED-LAST-NAME = SPACES
 12425       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12426       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12427           MOVE ER-2660    TO WS-ERROR
 12428           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12429
 12430 3136-EDIT-SEX.
 12431
 12432******************************************************************
 12433*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12434******************************************************************
 12435
 12436     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12437        (WS-AH-SPECIAL-CALC-CD = 'O')
 12438        NEXT SENTENCE
 12439     ELSE
 12440        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12441           NEXT SENTENCE
 12442        ELSE
 12443           MOVE ER-2629            TO WS-ERROR
 12444           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12445
 12446 3137-EDIT-EFF-DATE.
 12447
 12448     IF PB-REISSUED-CERT       OR
 12449        PB-POLICY-IS-DECLINED  OR
 12450        PB-POLICY-IS-VOIDED
 12451         GO TO 3139-EDIT-COVERAGE-CODES.
 12452
 12453     MOVE SPACE                  TO WS-2671-SW
 12454                                    WS-2672-SW.
 12455
 12456     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12457         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12458             MOVE ER-2703        TO WS-ERROR
 12459             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12460             GO TO 3139-EDIT-COVERAGE-CODES.
 12461
 12462     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12463         GO TO 3139-EDIT-COVERAGE-CODES.
 12464
 12465     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12466     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12467*    MOVE '1'                    TO DC-OPTION-CODE.
 12468     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12469     MOVE +0                     TO DC-ELAPSED-MONTHS
 12470                                    DC-ELAPSED-DAYS.
 12471     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12472
 12473     IF DATE-CONVERSION-ERROR
 12474         GO TO 3139-EDIT-COVERAGE-CODES.
 12475
 12476     IF DC-ELAPSED-DAYS GREATER +180
 12477         MOVE ER-2672            TO WS-ERROR
 12478         MOVE 'Y'                TO WS-2672-SW
 12479         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12480     END-IF
 12481
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 228
* EL050.cbl
 12482     IF WS-ERROR = ER-2671  AND
 12483        PB-COMPANY-ID  = 'LBL'
 12484        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12485        MOVE SPACE               TO WS-2671-SW
 12486        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12487
 12488     IF PB-ISSUE-DATE-FORCED  AND
 12489      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12490         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12491         MOVE ER-2673            TO WS-ERROR
 12492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12493         MOVE SPACE              TO WS-2671-SW
 12494                                    WS-2672-SW.
 12495
 12496     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12497         IF PB-ISSUE-DATE-FORCED
 12498             MOVE ER-2600          TO  WS-ERROR
 12499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12500         ELSE
 12501             MOVE ER-2692          TO  WS-ERROR
 12502             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12503
 12504
 12505 3139-EDIT-COVERAGE-CODES.
 12506
 12507     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12508        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12509        MOVE ER-2787             TO WS-ERROR
 12510        PERFORM 9900-ERROR-FORMAT
 12511                                 THRU 9900-EXIT
 12512     END-IF
 12513     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12514        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12515                                 > 250000.00
 12516           MOVE ER-2719          TO WS-ERROR
 12517           PERFORM 9900-ERROR-FORMAT
 12518                                 THRU 9900-EXIT
 12519        END-IF
 12520     END-IF
 12521
 12522     IF PB-POLICY-IS-DECLINED  OR
 12523        PB-POLICY-IS-VOIDED
 12524         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12525
 12526     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12527        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12528         MOVE ER-2630                TO WS-ERROR
 12529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12530
 12531     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12532        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12533        PB-I-LF-PREMIUM-AMT = ZERO
 12534         GO TO 3140-CHECK-AH-FOR-ZERO.
 12535
 12536     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12537        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12538        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12539         GO TO 3140-CHECK-AH-FOR-ZERO.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 229
* EL050.cbl
 12540
 12541     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12542        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12543        MOVE ER-2631             TO WS-ERROR
 12544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12545     END-IF
 12546
 12547
 12548******************************************************************
 12549*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12550******************************************************************
 12551
 12552     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12553        NEXT SENTENCE
 12554     ELSE
 12555        IF PB-I-LF-BENEFIT-AMT = ZERO
 12556           MOVE ER-2632             TO WS-ERROR
 12557           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12558
 12559
 12560******************************************************************
 12561*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12562******************************************************************
 12563
 12564     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12565        CONTINUE
 12566     ELSE
 12567        IF PB-I-LF-PREMIUM-AMT = ZERO
 12568           IF (NOT PB-COMP-LF-PREM)
 12569              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12570              MOVE ER-2633       TO WS-ERROR
 12571              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12572           END-IF
 12573        END-IF
 12574     END-IF
 12575     .
 12576 3140-CHECK-AH-FOR-ZERO.
 12577
 12578     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12579        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12580        PB-I-AH-PREMIUM-AMT = ZERO
 12581         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12582
 12583     IF PB-COMPANY-ID = 'CSL'  AND
 12584        PB-I-AH-BENEFIT-CD = ZERO  AND
 12585        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12586        PB-I-AH-PREMIUM-AMT = ZERO
 12587         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12588
 12589     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12590        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12591        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12592         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12593
 12594     IF PB-I-AH-BENEFIT-CD = ZERO
 12595         MOVE ER-2634            TO WS-ERROR
 12596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12597
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 230
* EL050.cbl
 12598******************************************************************
 12599*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12600******************************************************************
 12601
 12602     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12603        NEXT SENTENCE
 12604     ELSE
 12605        IF PB-I-AH-BENEFIT-AMT = ZERO
 12606           MOVE ER-2635             TO WS-ERROR
 12607           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12608
 12609******************************************************************
 12610*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12611******************************************************************
 12612
 12613     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12614        NEXT SENTENCE
 12615     ELSE
 12616        IF PB-I-AH-PREMIUM-AMT = ZERO
 12617            IF NOT PB-COMP-AH-PREM
 12618                MOVE ER-2636    TO WS-ERROR
 12619                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12620
 12621
 12622 3140-EDIT-MAX-AMT-SIZES.
 12623* CUSTOM CODE FOR CLIENT    'DMD'
 12624     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12625                                     WS-RES-MUNI-TAX
 12626                                     PB-I-STATE-TAX
 12627                                     PB-I-MUNI-TAX.
 12628
 12629     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12630
 12631     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12632        GO TO 3150-RATE-OUTSTAND-BAL.
 12633
 12634     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12635        GO TO 3150-RATE-OUTSTAND-BAL.
 12636
 12637     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12638        GO TO 3150-RATE-OUTSTAND-BAL.
 12639
 12640     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12641                             OR 'RIC')
 12642        GO TO 3150-RATE-OUTSTAND-BAL.
 12643
 12644     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12645        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12646            GO TO 3150-RATE-OUTSTAND-BAL
 12647        ELSE
 12648           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12649               GO TO 3150-RATE-OUTSTAND-BAL.
 12650
 12651     IF NOT PB-NO-MONTHS-SKIPPED
 12652        GO TO 3150-RATE-OUTSTAND-BAL.
 12653
 12654     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12655        GO TO 3150-RATE-OUTSTAND-BAL.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 231
* EL050.cbl
 12656
 12657     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12658        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12659           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12660             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12661           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12662           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12663              MOVE ER-2693     TO WS-ERROR
 12664              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12665              GO TO 3150-RATE-OUTSTAND-BAL
 12666           ELSE
 12667              GO TO 3150-RATE-OUTSTAND-BAL.
 12668
 12669 3150-RATE-OUTSTAND-BAL.
 12670
 12671* DMD RATING TEST
 12672     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12673         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12674         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12675         MOVE ER-2687                 TO WS-ERROR
 12676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12677         MOVE 'B'                     TO PB-I-OB-FLAG
 12678         GO TO 3260-EDIT-CONTINUE.
 12679
 12680     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12681         IF  WS-ERROR    EQUAL    ER-2693
 12682             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12683                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12684                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12685                 MOVE  +0            TO  WS-ERROR.
 12686
 12687     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12688         IF  WS-ERROR    EQUAL    ER-2693
 12689             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12690                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12691                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12692                 MOVE  +0            TO  WS-ERROR.
 12693
 12694     IF PLAN-MASTER-AH-SW = 'Y'
 12695        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12696            IF  WS-ERROR    EQUAL    ER-2693
 12697              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12698                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12699                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12700                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12701                 MOVE  ER-1910           TO  WS-ERROR
 12702                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12703
 12704     IF PLAN-MASTER-AH-SW = 'Y'
 12705        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12706            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12707               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12708               MOVE  ER-1910           TO  WS-ERROR
 12709               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12710
 12711     IF PLAN-MASTER-AH-SW = 'Y'
 12712        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12713            IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 232
* EL050.cbl
 12714                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12715                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12716                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12717                 MOVE  +0       TO  WS-ERROR.
 12718
 12719     IF WS-ERROR = ER-2693
 12720        IF PB-COMPANY-ID = 'JAL' AND
 12721           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12722           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12723           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12724
 12725     IF WS-ERROR = ER-2693
 12726        IF PB-COMPANY-ID = 'NCL'  AND
 12727           PB-I-AH-BENEFIT-CD = 'OA'
 12728           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12729           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12730
 12731     IF WS-ERROR = ER-2693
 12732        IF PB-COMPANY-ID = 'CNL' AND
 12733           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12734           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12735           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12736
 12737     IF WS-ERROR = ER-2693
 12738        IF PB-COMPANY-ID = 'HER'
 12739           IF WS-LEVEL
 12740              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12741              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12742
 12743     IF ((LF-BENEFIT-FOUND) AND
 12744         (NOT NO-LIFE-COVERAGE)  AND
 12745         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12746       OR   ((AH-BENEFIT-FOUND) AND
 12747             (NOT NO-AH-COVERAGE)    AND
 12748             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12749         NEXT SENTENCE
 12750     ELSE
 12751         GO TO 3215-EDIT-RATES.
 12752
 12753     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12754        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12755           MOVE ER-2674          TO WS-ERROR
 12756           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12757           GO TO 3215-EDIT-RATES.
 12758
 12759     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12760        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12761           MOVE ER-2674          TO WS-ERROR
 12762           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12763           GO TO 3215-EDIT-RATES.
 12764
 12765     MOVE 'B'                    TO PB-I-OB-FLAG.
 12766
 12767     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12768         NEXT SENTENCE
 12769     ELSE
 12770         IF NOT NO-LIFE-COVERAGE
 12771             IF WS-ACCT-LF-OB-RT = ZERO
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 233
* EL050.cbl
 12772                MOVE ER-2641    TO WS-ERROR
 12773                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12774
 12775     IF PB-COMPANY-ID = 'CRI'
 12776       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12777         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12778         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12779         IF WS-ERROR = ER-2675
 12780            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12781            MOVE ER-2687              TO WS-ERROR
 12782            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12783         ELSE
 12784            MOVE ER-2687              TO WS-ERROR
 12785            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12786
 12787
 12788     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12789         NEXT SENTENCE
 12790     ELSE
 12791         IF NOT NO-AH-COVERAGE
 12792             IF WS-ACCT-AH-OB-RT = ZERO
 12793                MOVE ER-2642    TO WS-ERROR
 12794                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12795
 12796     IF PB-COMPANY-ID = 'CRI'
 12797       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12798         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12799         IF WS-ERROR = ER-2676
 12800            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12801            MOVE ER-2687              TO WS-ERROR
 12802            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12803         ELSE
 12804            MOVE ER-2687              TO WS-ERROR
 12805            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12806
 12807     IF PB-COMPANY-ID NOT = 'GIC'
 12808         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12809            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12810     ELSE
 12811         IF PB-I-LF-PREM-CALC = ZEROS
 12812             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12813                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12814
 12815     IF PB-COMPANY-ID NOT = 'GIC'
 12816         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12817            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12818     ELSE
 12819         IF PB-I-AH-PREM-CALC = ZEROS
 12820             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12821                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12822
 12823     MOVE ZEROS TO PB-I-MORT-CODE.
 12824
 12825     GO TO 3260-EDIT-CONTINUE.
 12826
 12827
 12828 3215-EDIT-RATES.
 12829     IF ACCOUNT-MAST-FOUND
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 234
* EL050.cbl
 12830         NEXT SENTENCE
 12831     ELSE
 12832         GO TO 3999-END-EDIT.
 12833
 12834 3220-CHECK-LF-RATES.
 12835
 12836     IF PB-COMPANY-ID = 'DCC'
 12837        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12838        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12839        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12840           AND (NOT WS-LF-CASH))
 12841                           OR
 12842           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12843           AND (NOT WS-AH-CASH)))
 12844                       AND
 12845           (PB-I-ENTRY-STATUS NOT = '5')
 12846           MOVE 'M'              TO PB-BATCH-ENTRY
 12847                                    PB-I-ENTRY-STATUS
 12848        END-IF
 12849     END-IF
 12850     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12851                                    PB-I-AH-PREM-CALC
 12852                                    PB-I-LF-ALT-PREM-CALC
 12853                                    PB-I-LF-ALT-RATE
 12854                                    PB-I-LF-REI-RATE
 12855                                    PB-I-LF-ALT-REI-RATE
 12856                                    PB-I-AH-REI-RATE
 12857                                    PB-I-TOT-FEES-CALC.
 12858
 12859     IF PB-COMPANY-ID EQUAL 'DMD'
 12860        NEXT SENTENCE
 12861     ELSE
 12862        MOVE ZEROS               TO PB-I-LF-RATE
 12863                                    PB-I-AH-RATE.
 12864
 12865     IF PB-I-TOT-FEES NOT NUMERIC
 12866        MOVE ZEROS               TO PB-I-TOT-FEES
 12867     END-IF
 12868     IF PB-I-LIVES NOT NUMERIC
 12869         MOVE ZERO               TO PB-I-LIVES.
 12870
 12871     IF PB-I-NUM-BILLED NOT NUMERIC
 12872         MOVE ZERO               TO PB-I-NUM-BILLED.
 12873
 12874     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12875        MOVE +0                  TO PB-I-LF-PREM-TAX
 12876     END-IF
 12877
 12878     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12879        MOVE +0                  TO PB-I-AH-PREM-TAX
 12880     END-IF
 12881
 12882     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12883        PB-I-PAY-FREQUENCY = ZEROS
 12884            MOVE 12 TO CP-PAY-FREQUENCY
 12885     ELSE
 12886            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12887
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 235
* EL050.cbl
 12888     IF PB-I-STATE-TAX NOT NUMERIC
 12889         MOVE ZEROS               TO PB-I-STATE-TAX.
 12890
 12891     IF PB-I-MUNI-TAX NOT NUMERIC
 12892         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12893
 12894     MOVE SPACES                 TO CP-BEN-CATEGORY
 12895     IF PB-COMPANY-ID  = 'CSL'  AND
 12896        PB-I-LF-TERM NOT = ZERO
 12897        COMPUTE WS-PAYMENT-AMT =
 12898             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12899        COMPUTE WS-CSL-AMT1 =
 12900             PB-I-LF-TERM * AM-MAX-MON-BEN
 12901        COMPUTE WS-CSL-AMT2 =
 12902             WS-PAYMENT-AMT * PB-I-LF-TERM
 12903        IF CP-PAY-FREQUENCY NOT = 12
 12904           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12905           MOVE '8' TO WS-CSL-CALC-CD
 12906        ELSE
 12907           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 12908              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12909               AM-MAX-TOT-BEN
 12910               MOVE '6' TO WS-CSL-CALC-CD
 12911           ELSE
 12912              IF (WS-CSL-AMT1  GREATER THAN
 12913                 AM-MAX-TOT-BEN) AND
 12914                 (WS-CSL-AMT2  GREATER THAN
 12915                 AM-MAX-TOT-BEN)
 12916                 MOVE '7' TO WS-CSL-CALC-CD
 12917              ELSE
 12918                 MOVE '5' TO WS-CSL-CALC-CD.
 12919
 12920     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12921         NEXT SENTENCE
 12922     ELSE
 12923         GO TO 3300-CHECK-AH-RATES.
 12924
 12925*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12926
 12927     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12928        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12929              OR
 12930           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12931           MOVE ER-2618          TO WS-ERROR
 12932           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933           GO TO 3300-CHECK-AH-RATES.
 12934
 12935     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12936           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12937                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12938
 12939     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12940         MOVE ER-2687             TO WS-ERROR
 12941         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12942         MOVE 'Z000'              TO PB-I-MORT-CODE
 12943         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12944         GO TO 3300-CHECK-AH-RATES.
 12945
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 236
* EL050.cbl
 12946     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12947        IF PB-I-LIVES = ZERO
 12948           MOVE ER-2688          TO WS-ERROR
 12949           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12950
 12951     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12952
 12953     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12954     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12955     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12956     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12957     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12958     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12959     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12960     MOVE '3'                    TO CP-PROCESS-TYPE.
 12961     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12962     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12963
 12964******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12965     IF PB-COMPANY-ID EQUAL 'CDL'
 12966         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12967            CP-EARN-AS-NET-PAY)
 12968             IF PB-CERT-EFF-DT GREATER  WS-931231
 12969                 MOVE '1'        TO CP-EARNING-METHOD.
 12970*******
 12971
 12972     MOVE PB-SV-STATE            TO CP-STATE.
 12973     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12974     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12975     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12976     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12977     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12978                                    CP-RATING-BENEFIT-AMT.
 12979     IF CP-STATE-STD-ABBRV = 'OR'
 12980         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12981                                         PB-I-LF-ALT-BENEFIT-AMT.
 12982     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12983     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12984     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12985     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12986     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12987     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12988     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12989     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12990     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12991                                    CP-REMAINING-TERM
 12992                                    CP-LOAN-TERM.
 12993
 12994     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 12995         NEXT SENTENCE
 12996     ELSE
 12997         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 12998             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12999                                           PB-I-LF-PREMIUM-AMT.
 13000
 13001     IF PB-COMPANY-ID EQUAL 'CSL'
 13002        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13003           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 237
* EL050.cbl
 13004                                         PB-I-LF-PREMIUM-AMT.
 13005
 13006     IF PB-COMPANY-ID EQUAL 'NCB'
 13007         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13008            CP-EARN-AS-NET-PAY
 13009             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13010                 PB-I-LF-PREMIUM-AMT.
 13011
 13012     IF (CP-TRUNCATED-LIFE)
 13013        or ((pb-company-id = 'AHL')
 13014           and (pb-i-loan-term > pb-i-lf-term))
 13015        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13016
 13017     IF PB-COMPANY-ID EQUAL 'CRI'
 13018        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13019
 13020     IF CP-TERM-IS-DAYS
 13021         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13022     ELSE
 13023         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13024     IF PB-COMPANY-ID = 'DCC'
 13025        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13026        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13027        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13028        IF WS-LF-BEN-CATEGORY = 'D'
 13029           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13030           MOVE PB-I-LIFE-COMMISSION
 13031                                 TO CP-DCC-ACT-COMM
 13032           MOVE WS-LF-BEN-CATEGORY
 13033                                 TO CP-BEN-CATEGORY
 13034        END-IF
 13035        IF (CP-BENEFIT-CD (1:1) = 'P')
 13036           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13037           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13038        END-IF
 13039     END-IF
 13040     IF PB-COMPANY-ID = 'CSL'
 13041         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13042         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13043         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13044
 13045     IF PB-COMPANY-ID = 'CSL'
 13046        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13047
 13048     IF (CP-SPECIAL-CALC-CD = 'H')
 13049        OR (PB-COMPANY-ID = 'DCC')
 13050         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13051                                    TO CP-ALTERNATE-BENEFIT
 13052         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13053
 13054     IF (PB-COMPANY-ID = 'CID')
 13055        AND (WS-LF-EARNINGS-CALC = 'B')
 13056        AND (CP-STATE-STD-ABBRV = 'MN')
 13057        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13058                                 TO CP-ALTERNATE-BENEFIT
 13059        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13060     END-IF
 13061     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 238
* EL050.cbl
 13062     MOVE 'R'                   TO CP-RATE-FILE.
 13063     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13064
 13065     IF CP-ERROR-RATE-NOT-FOUND
 13066        MOVE ER-2641            TO WS-ERROR
 13067        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13068        GO TO 3300-CHECK-AH-RATES.
 13069
 13070     IF PB-COMPANY-ID EQUAL 'CRI'
 13071        IF CP-ERROR-NO-LIMITS-CRI
 13072           IF NOT ACCOUNT-LIFE-CHECKED
 13073              MOVE ER-2607      TO WS-ERROR
 13074              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13075
 13076******************************************************************
 13077*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13078*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13079******************************************************************
 13080
 13081* CALC LIFE AGE AT EXPIRATION.
 13082
 13083     COMPUTE WS-AGE-AT-EXPIRE =
 13084          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13085
 13086*    IF PB-STATE = 'CO' OR 'UT'
 13087*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13088*        MOVE 'F'            TO PB-FATAL-FLAG
 13089*        MOVE ER-2709        TO WS-ERROR
 13090*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13091*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13092
 13093*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13094*        MOVE 'X'            TO PB-FATAL-FLAG
 13095*        MOVE ER-2718        TO WS-ERROR
 13096*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13097*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13098
 13099* CALC A & H AGE AT EXPIRATION.
 13100
 13101     COMPUTE WS-AGE-AT-EXPIRE =
 13102          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13103
 13104*    IF PB-STATE = 'CO' OR 'UT'
 13105*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13106*        MOVE 'F'            TO PB-FATAL-FLAG
 13107*        MOVE ER-2709        TO WS-ERROR
 13108*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13109*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13110
 13111*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13112*        MOVE 'X'            TO PB-FATAL-FLAG
 13113*        MOVE ER-2718        TO WS-ERROR
 13114*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13115*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13116
 13117     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13118        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13119
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 239
* EL050.cbl
 13120     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13121        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13122
 13123     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13124        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13125
 13126     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13127         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13128         MOVE ER-2639        TO WS-ERROR
 13129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13130
 13131
 13132******************************************************************
 13133*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13134******************************************************************
 13135
 13136 PREMIUM-EDITING-IS-BYPASSED.
 13137     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13138        AND (CP-R-MAX-ATT-AGE > +0)
 13139        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13140        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13141           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13142           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13143           MOVE '1'              TO DC-OPTION-CODE
 13144           PERFORM 8500-DATE-CONVERT
 13145                                 THRU 8500-EXIT
 13146           IF NO-CONVERSION-ERROR
 13147              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13148                 MOVE ER-2661       TO WS-ERROR
 13149*                PERFORM 9900-ERROR-FORMAT
 13150*                                THRU 9900-EXIT
 13151              END-IF
 13152           END-IF
 13153        ELSE
 13154           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13155           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13156              MOVE ER-2661       TO WS-ERROR
 13157*             PERFORM 9900-ERROR-FORMAT
 13158*                                THRU 9900-EXIT
 13159           ELSE
 13160              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13161                 MOVE ER-1570    TO WS-ERROR
 13162                 PERFORM 9900-ERROR-FORMAT
 13163                                 THRU 9900-EXIT
 13164              END-IF
 13165           END-IF
 13166        END-IF
 13167        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13168           MOVE PB-I-JOINT-BIRTHDAY
 13169                                 TO DC-BIN-DATE-1
 13170           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13171           MOVE '1'              TO DC-OPTION-CODE
 13172           PERFORM 8500-DATE-CONVERT
 13173                                 THRU 8500-EXIT
 13174           IF NO-CONVERSION-ERROR
 13175              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13176                 MOVE ER-2661       TO WS-ERROR
 13177*                PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 240
* EL050.cbl
 13178*                                THRU 9900-EXIT
 13179              END-IF
 13180           ELSE
 13181              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13182           END-IF
 13183        ELSE
 13184           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13185             (PB-I-LF-TERM / 12)
 13186           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13187              MOVE ER-2661       TO WS-ERROR
 13188*             PERFORM 9900-ERROR-FORMAT
 13189*                                THRU 9900-EXIT
 13190           ELSE
 13191              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13192                 MOVE ER-1571    TO WS-ERROR
 13193                 PERFORM 9900-ERROR-FORMAT
 13194                                 THRU 9900-EXIT
 13195              END-IF
 13196           END-IF
 13197        END-IF
 13198        IF WS-ERROR = ER-2661
 13199           PERFORM 9900-ERROR-FORMAT
 13200                                 THRU 9900-EXIT
 13201        END-IF
 13202     END-IF
 13203*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13204*       MOVE ER-2661             TO WS-ERROR
 13205*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13206
 13207     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13208        MOVE ER-2662             TO WS-ERROR
 13209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13210
 13211     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13212        MOVE ER-2677             TO WS-ERROR
 13213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13214
 13215     IF CP-ERROR-LOAN-TERM
 13216        MOVE ER-2648             TO WS-ERROR
 13217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13218
 13219 3221-CHECK-ERROR-RATE-OPEN.
 13220
 13221     IF CP-ERROR-RATE-FILE-NOTOPEN
 13222         GO TO 3990-FILES-NOT-OPEN.
 13223
 13224     IF PB-COMPANY-ID NOT = 'DMD'
 13225        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13226     END-IF
 13227     .
 13228 3221-CONTINUE.
 13229     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13230                                    WS-DCC-AH-RATE
 13231     IF PB-COMPANY-ID = 'DCC'
 13232        IF WS-LF-BEN-CATEGORY = 'D'
 13233           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13234              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13235        END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 241
* EL050.cbl
 13236     END-IF
 13237     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13238*   X'A4FF' = 12/31/2009
 13239     IF (PB-COMPANY-ID = 'CID')
 13240        AND (WS-LF-EARNINGS-CALC = 'B')
 13241        AND (CP-STATE-STD-ABBRV = 'MN')
 13242        AND (PB-CERT-EFF-DT > X'A4FF')
 13243        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13244     END-IF
 13245     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13246
 13247     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13248     IF (PB-COMPANY-ID = 'DCC')
 13249        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13250        AND (PB-I-POLICY-IS-MONTHLY)
 13251        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13252        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13253     END-IF
 13254     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13255     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13256     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13257     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13258     IF (PB-COMPANY-ID = 'DCC')
 13259        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13260        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13261        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13262        MOVE ER-2786             TO WS-ERROR
 13263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13264     END-IF
 13265
 13266     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13267
 13268******************************************************************
 13269*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13270******************************************************************
 13271     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13272        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13273
 13274     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13275        GO TO 3225-CHECK-ALT-LIFE-RATE
 13276     ELSE
 13277       IF PB-I-LF-RATE = ZERO
 13278          MOVE ER-2641          TO WS-ERROR
 13279          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13280
 13281 3225-CHECK-ALT-LIFE-RATE.
 13282
 13283     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13284        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13285        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13286         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13287
 13288     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13289         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13290             AND PB-COMPANY-ID NOT = 'DCC')
 13291                   OR
 13292              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13293              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 242
* EL050.cbl
 13294              AND PB-COMPANY-ID NOT = 'DCC')
 13295             MOVE ER-2720        TO  WS-ERROR
 13296             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13297             GO TO 3225-RATING-CONT
 13298         ELSE
 13299             GO TO 3225-RATING-CONT.
 13300     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13301        AND (AM-GPCD = 01 OR 06 OR 15)
 13302        MOVE ER-2798             TO WS-ERROR
 13303        PERFORM 9900-ERROR-FORMAT
 13304                                 THRU 9900-EXIT
 13305*       GO TO 3225-RATING-CONT
 13306     END-IF
 13307     IF (PB-COMPANY-ID = 'CID')
 13308        AND (WS-LF-EARNINGS-CALC = 'B')
 13309        AND (CP-STATE-STD-ABBRV = 'MN')
 13310        AND (PB-CERT-EFF-DT > X'A4FF')
 13311        GO TO 3225-RATING-CONT
 13312     END-IF
 13313     IF PB-COMPANY-ID = 'DCC'
 13314        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13315           AND (PB-I-POLICY-IS-MONTHLY)
 13316           GO TO 3225-RATING-CONT
 13317        END-IF
 13318     END-IF
 13319
 13320     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13321        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13322        CP-EARN-AS-REG-BALLOON
 13323        NEXT SENTENCE
 13324     ELSE
 13325        MOVE '2'                 TO CP-EARNING-METHOD.
 13326
 13327 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13328
 13329     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13330
 13331     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13332        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13333        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13334         NEXT SENTENCE
 13335     ELSE
 13336         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13337
 13338     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13339     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13340     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13341                                     CP-RATING-BENEFIT-AMT.
 13342     IF CP-STATE-STD-ABBRV = 'OR'
 13343         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13344                                         PB-I-LF-ALT-BENEFIT-AMT.
 13345     IF PB-COMPANY-ID = 'DCC'
 13346        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13347     END-IF
 13348     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13349     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13350     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13351                                    CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 243
* EL050.cbl
 13352                                    CP-LOAN-TERM.
 13353     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13354        ADD +1                   TO CP-ORIGINAL-TERM
 13355                                    CP-REMAINING-TERM
 13356                                    CP-LOAN-TERM.
 13357
 13358     MOVE 'R'                   TO CP-RATE-FILE.
 13359     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13360
 13361     IF CP-ERROR-RATE-NOT-FOUND
 13362         MOVE ER-2641            TO WS-ERROR
 13363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13364         GO TO 3300-CHECK-AH-RATES.
 13365
 13366     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13367     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13368
 13369     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13370         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13371
 13372     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13373                               + PB-I-LF-ALT-BENEFIT-AMT.
 13374
 13375     IF ACCOUNT-LIFE-CHECKED  OR
 13376        PB-POLICY-IS-VOIDED   OR
 13377        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13378        GO TO 3225-CONTINUE.
 13379
 13380     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13381        GO TO 3225-CONTINUE.
 13382
 13383     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13384                             EC-RT-LF-MAX-TOT-BEN
 13385        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13386        MOVE ER-2639       TO WS-ERROR
 13387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13388
 13389 3225-CONTINUE.
 13390     IF PB-I-LF-ALT-RATE = ZERO
 13391         MOVE ER-2659            TO WS-ERROR
 13392         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13393
 13394     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13395        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13396        MOVE ER-2698             TO WS-ERROR
 13397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13398
 13399 3225-RATING-CONT.
 13400
 13401     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13402         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13403         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13404         MOVE ER-2687             TO WS-ERROR
 13405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13406         GO TO 3290-EDIT-LF-REIN-RATE.
 13407
 13408* DMD RATING TEST
 13409     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 244
* EL050.cbl
 13410         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13411         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13412         MOVE ER-2687                 TO WS-ERROR
 13413         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13414         GO TO 3290-EDIT-LF-REIN-RATE.
 13415
 13416 3230-CLIENT-MORT-CD-SPECIALS.
 13417
 13418     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13419     SET BIN-TO-GREG          TO TRUE.
 13420*    MOVE ' '                 TO DC-OPTION-CODE.
 13421     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13422     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13423
 13424 C-POS-3230-MORT-CD.
 13425     IF PB-COMPANY-ID = 'POS' AND
 13426        PB-SV-CARRIER = '2'
 13427         NEXT SENTENCE
 13428     ELSE
 13429         GO TO C-POS-3240-MORT-CD.
 13430
 13431     IF PB-SV-GROUPING = '030'
 13432        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13433         MOVE '2350' TO PB-I-MORT-CODE
 13434      ELSE
 13435         MOVE '3300' TO PB-I-MORT-CODE.
 13436
 13437
 13438 C-POS-3240-MORT-CD.
 13439     IF PB-COMPANY-ID = 'POS' AND
 13440        PB-SV-CARRIER = '1'
 13441         NEXT SENTENCE
 13442     ELSE
 13443         GO TO 3230-CONTINUE.
 13444
 13445     IF PB-SV-STATE = '45' OR '47'
 13446        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13447         MOVE '5200' TO PB-I-MORT-CODE
 13448     ELSE
 13449         MOVE '8300' TO PB-I-MORT-CODE.
 13450
 13451 3230-CONTINUE.
 13452
 13453     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13454        GO TO 3240-CONTINUE
 13455     END-IF
 13456
 13457     IF PB-CERT-EFF-DT > WS-971231
 13458        GO TO 3240-CONTINUE
 13459     END-IF
 13460
 13461     IF LF-BENEFIT-FOUND AND
 13462        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13463         MOVE 'F250'       TO PB-I-MORT-CODE
 13464     ELSE
 13465         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13466             MOVE '7250'   TO PB-I-MORT-CODE
 13467         ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 245
* EL050.cbl
 13468             MOVE '4251'   TO PB-I-MORT-CODE
 13469         END-IF
 13470     END-IF
 13471
 13472     .
 13473 3240-CONTINUE.
 13474
 13475     IF PB-COMPANY-ID NOT = 'GNL'
 13476         GO TO 3256-CONTINUE.
 13477
 13478     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13479         MOVE 'A300' TO PB-I-MORT-CODE
 13480     ELSE
 13481         MOVE '8350' TO PB-I-MORT-CODE.
 13482
 13483 3256-CONTINUE.
 13484     IF PB-COMPANY-ID NOT = 'ABL'
 13485         GO TO 3260-EDIT-CONTINUE.
 13486
 13487     IF PB-I-LF-TERM GREATER THAN 59
 13488         MOVE 'F550' TO PB-I-MORT-CODE
 13489     ELSE
 13490         MOVE 'E550' TO PB-I-MORT-CODE.
 13491
 13492 3260-EDIT-CONTINUE.
 13493     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13494
 13495 3290-EDIT-LF-REIN-RATE.
 13496     IF LF-REIN-NSP-NOT-USED
 13497         GO TO 3290-RATING-CONT.
 13498
 13499     IF PB-COMPANY-ID = 'DCC'
 13500        GO TO 3290-RATING-CONT.
 13501     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13502     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13503     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13504     MOVE '3'                   TO CP-PROCESS-TYPE.
 13505     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13506
 13507******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13508     IF PB-COMPANY-ID EQUAL 'CDL'
 13509         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13510            CP-EARN-AS-NET-PAY)
 13511             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13512*            MOVE SPACE          TO DC-OPTION-CODE
 13513             SET BIN-TO-GREG     TO TRUE
 13514             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13515***  Y2K PROJ 7744
 13516             IF DC-GREG-DATE-CYMD GREATER 19931231
 13517                 MOVE '1'        TO CP-EARNING-METHOD.
 13518***  Y2K PROJ 7744
 13519*******
 13520
 13521     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13522     MOVE PB-SV-STATE           TO CP-STATE.
 13523     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13524     MOVE ZERO                  TO CP-DEVIATION-CODE
 13525                                   CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 246
* EL050.cbl
 13526     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13527     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13528                                   CP-RATING-BENEFIT-AMT.
 13529
 13530************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13531     IF PB-COMPANY-ID EQUAL 'NCB'
 13532         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13533            CP-EARN-AS-NET-PAY
 13534             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13535                 PB-I-LF-PREMIUM-AMT.
 13536************
 13537
 13538     IF CP-STATE-STD-ABBRV = 'OR'
 13539         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13540                                         PB-I-LF-ALT-BENEFIT-AMT.
 13541     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13542     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13543     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13544     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13545     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13546     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13547     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13548     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13549                                   CP-REMAINING-TERM
 13550                                   CP-LOAN-TERM.
 13551     IF CP-TRUNCATED-LIFE
 13552        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13553
 13554     IF CP-TERM-IS-DAYS
 13555         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13556     ELSE
 13557         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13558
 13559     IF PB-COMPANY-ID = 'DCC'
 13560        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13561     END-IF
 13562     IF PB-COMPANY-ID NOT = 'TIC'
 13563          MOVE ZERO          TO CP-CLASS-CODE.
 13564
 13565     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13566
 13567     MOVE 'R'                   TO CP-RATE-FILE.
 13568     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13569
 13570     IF CP-ERROR-RATE-NOT-FOUND
 13571        IF PB-I-OB
 13572           MOVE ER-2625      TO WS-ERROR
 13573           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13574           GO TO 3299-EDIT-CONTINUE
 13575        ELSE
 13576           MOVE ER-2643      TO WS-ERROR
 13577           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13578           GO TO 3299-EDIT-CONTINUE.
 13579
 13580     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13581
 13582     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13583     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 247
* EL050.cbl
 13584
 13585     IF PB-I-LF-REI-RATE = ZERO
 13586         MOVE ER-2643        TO WS-ERROR
 13587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13588
 13589 3290-CHECK-ALT-REIN-RATE.
 13590
 13591     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13592        GO TO 3290-RATING-CONT.
 13593
 13594     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13595     MOVE '2'                    TO CP-EARNING-METHOD.
 13596     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13597     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13598     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13599     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13600                                     CP-RATING-BENEFIT-AMT.
 13601     IF CP-STATE-STD-ABBRV = 'OR'
 13602         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13603                                         PB-I-LF-ALT-BENEFIT-AMT.
 13604     IF PB-COMPANY-ID = 'DCC'
 13605        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13606     END-IF
 13607     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13608     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13609     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13610                                    CP-REMAINING-TERM
 13611                                    CP-LOAN-TERM.
 13612     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13613        ADD +1                   TO CP-ORIGINAL-TERM
 13614                                    CP-REMAINING-TERM
 13615                                    CP-LOAN-TERM.
 13616
 13617     MOVE 'R'                   TO CP-RATE-FILE.
 13618     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13619
 13620     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13621
 13622     IF PB-I-LF-ALT-REI-RATE = ZERO
 13623         MOVE ER-2643            TO WS-ERROR
 13624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13625
 13626 3290-RATING-CONT.
 13627
 13628     IF PB-I-OB
 13629*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13630        GO TO 3300-CHECK-AH-RATES.
 13631
 13632 3299-EDIT-CONTINUE.
 13633
 13634     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13635         NEXT SENTENCE
 13636     ELSE
 13637         MOVE ER-2620           TO WS-ERROR
 13638         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13639
 13640 3300-CHECK-AH-RATES.
 13641     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 248
* EL050.cbl
 13642         NEXT SENTENCE
 13643     ELSE
 13644         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13645
 13646     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13647        ((CF-COMPANY-ID = 'DMD') AND
 13648                (NO-DMD-RATING))
 13649         MOVE ER-2687             TO WS-ERROR
 13650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13651         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13652         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13653
 13654     IF PB-I-OB
 13655        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13656
 13657     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13658         MOVE ER-2687             TO WS-ERROR
 13659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13660         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13661         GO TO 3999-END-EDIT.
 13662
 13663*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13664
 13665     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13666        IF PB-I-AH-CRIT-PER = ZERO
 13667           IF PB-COMPANY-ID = 'DCC'
 13668              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13669              CONTINUE
 13670           ELSE
 13671              MOVE ER-2618       TO WS-ERROR
 13672              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13673              GO TO 3999-END-EDIT
 13674           END-IF
 13675        END-IF
 13676     END-IF
 13677     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13678     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13679     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13680     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13681     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13682     MOVE PB-SV-STATE            TO CP-STATE.
 13683     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13684     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13685     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13686*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13687     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13688     MOVE '3'                    TO CP-PROCESS-TYPE.
 13689     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13690     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13691                                    CP-RATING-BENEFIT-AMT.
 13692     IF PB-COMPANY-ID = 'CID'
 13693               OR
 13694        CP-STATE-STD-ABBRV = 'OR'
 13695         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13696                                         PB-I-AH-TERM.
 13697     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13698        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13699           AND (PB-I-POLICY-IS-MONTHLY)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 249
* EL050.cbl
 13700           MOVE PB-I-LF-BENEFIT-AMT
 13701                                 TO CP-NET-BENEFIT-AMT
 13702           move pb-i-ah-premium-amt to cp-original-premium
 13703        END-IF
 13704     END-IF
 13705     MOVE SPACES                 TO CP-BEN-CATEGORY
 13706     IF PB-COMPANY-ID = 'DCC'
 13707        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13708        EVALUATE TRUE
 13709           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13710              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13711              MOVE PB-I-LF-BENEFIT-AMT
 13712                                 TO CP-RATING-BENEFIT-AMT
 13713              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13714           WHEN WS-AH-BEN-CATEGORY = 'G'
 13715              MOVE PB-I-UNPAID-CASH-PRICE
 13716                                 TO CP-RATING-BENEFIT-AMT
 13717           WHEN WS-AH-BEN-CATEGORY = 'D'
 13718              MOVE WS-AH-PMF-COMM
 13719                                 TO CP-DCC-PMF-COMM
 13720              MOVE PB-I-AH-COMMISSION
 13721                                 TO CP-DCC-ACT-COMM
 13722        END-EVALUATE
 13723     END-IF
 13724     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13725     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13726     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13727     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13728     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13729     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13730     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13731                                    CP-REMAINING-TERM
 13732                                    WS-WORK-TERM.
 13733     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13734
 13735     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13736     SET BIN-TO-GREG             TO TRUE.
 13737*    MOVE ' '                    TO DC-OPTION-CODE.
 13738     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13739     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13740
 13741     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13742     IF NOT VALID-SKIP-CODE
 13743         MOVE ER-2683            TO WS-ERROR
 13744         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13745         GO TO 3320-RATE-CONTINUE.
 13746
 13747     IF PB-NO-MONTHS-SKIPPED
 13748         GO TO 3320-RATE-CONTINUE.
 13749
 13750     MOVE SPACE TO NUMBER-OF-MONTHS.
 13751
 13752     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13753         MOVE 'S'                TO SK-MO (6).
 13754     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13755         MOVE 'S'                TO SK-MO (7).
 13756     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13757         MOVE 'S'                TO SK-MO (8).
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 250
* EL050.cbl
 13758     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13759         MOVE 'S'                TO SK-MO (9).
 13760     IF PB-I-SKIP-CODE = 'A'
 13761         MOVE 'S'                TO SK-MO (10).
 13762
 13763     MOVE 1                      TO SUB2.
 13764     MOVE PB-I-AH-TERM           TO SUB3.
 13765     MOVE WS-MONTH               TO SUB1.
 13766     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13767     GO TO 3320-RATE-CONTINUE.
 13768
 13769 3310-GET-SKIP-MO.
 13770     IF SUB1 = 13
 13771         MOVE 1                  TO SUB1.
 13772
 13773     IF SK-MO (SUB1) = 'S'
 13774         SUBTRACT 1 FROM WS-WORK-TERM.
 13775
 13776     ADD 1 TO SUB2
 13777              SUB1.
 13778
 13779 3320-RATE-CONTINUE.
 13780
 13781     IF WS-WORK-TERM = ZERO
 13782         MOVE 1                  TO WS-WORK-TERM.
 13783
 13784     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13785                                    CP-LOAN-TERM.
 13786
 13787     IF PB-COMPANY-ID EQUAL 'DMD'
 13788         NEXT SENTENCE
 13789     ELSE
 13790         MOVE ZERO               TO PB-I-AH-RATE
 13791                                    PB-I-AH-REI-RATE.
 13792
 13793
 13794     IF PB-COMPANY-ID EQUAL 'CRI'
 13795        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13796
 13797     IF PB-COMPANY-ID = 'CSL'
 13798         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13799         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13800         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13801         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13802
 13803     IF PB-COMPANY-ID = 'DCC'
 13804        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13805           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13806              PB-I-RATE-DEV-PCT-LF
 13807        END-IF
 13808        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13809                                 TO CP-ALTERNATE-BENEFIT
 13810        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13811        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13812        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13813     END-IF
 13814     IF (PB-COMPANY-ID = 'CID')
 13815        AND (WS-LF-EARNINGS-CALC = 'B')
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 251
* EL050.cbl
 13816        AND (CP-STATE-STD-ABBRV = 'MN')
 13817        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13818     ELSE
 13819        MOVE ' '                 TO CP-AH-BALLOON-SW
 13820     END-IF
 13821     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13822     MOVE 'R'                   TO CP-RATE-FILE.
 13823     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13824
 13825     IF CP-ERROR-RATE-NOT-FOUND
 13826        IF PB-I-OB
 13827           MOVE ER-2624          TO WS-ERROR
 13828           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13829           GO TO 3340-CALCULATE-PREMIUM-AMT
 13830        ELSE
 13831           MOVE ER-2642          TO WS-ERROR
 13832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13833           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13834
 13835     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13836        CP-ERROR-DIV-BY-ZERO
 13837           MOVE ER-3782          TO WS-ERROR
 13838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13839
 13840     IF PB-COMPANY-ID EQUAL 'CRI'
 13841        IF CP-ERROR-NO-LIMITS-CRI
 13842           IF NOT ACCOUNT-AH-CHECKED
 13843              MOVE ER-2607          TO WS-ERROR
 13844              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13845
 13846     IF ACCOUNT-AH-CHECKED
 13847        NEXT SENTENCE
 13848     ELSE
 13849       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13850          MOVE ER-2640           TO WS-ERROR
 13851          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13852
 13853     IF PB-COMPANY-ID = 'CRI'
 13854         IF WS-ERROR = ER-2640
 13855             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13856     IF ACCOUNT-AH-CHECKED
 13857        CONTINUE
 13858     ELSE
 13859        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13860           AND (CP-R-MAX-ATT-AGE > +0)
 13861           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13862           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13863              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13864              MOVE PB-I-AH-EXPIRE-DT
 13865                                 TO DC-BIN-DATE-2
 13866              MOVE '1'           TO DC-OPTION-CODE
 13867              PERFORM 8500-DATE-CONVERT
 13868                                 THRU 8500-EXIT
 13869              IF NO-CONVERSION-ERROR
 13870                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13871                    MOVE ER-2661       TO WS-ERROR
 13872*                   PERFORM 9900-ERROR-FORMAT
 13873*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 252
* EL050.cbl
 13874                 END-IF
 13875              END-IF
 13876           ELSE
 13877              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13878              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13879                 MOVE ER-2661    TO WS-ERROR
 13880*                PERFORM 9900-ERROR-FORMAT
 13881*                                THRU 9900-EXIT
 13882              ELSE
 13883                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13884                    MOVE ER-1570 TO WS-ERROR
 13885                    PERFORM 9900-ERROR-FORMAT
 13886                                 THRU 9900-EXIT
 13887                 END-IF
 13888              END-IF
 13889           END-IF
 13890           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13891              MOVE PB-I-JOINT-BIRTHDAY
 13892                                    TO DC-BIN-DATE-1
 13893              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13894              MOVE '1'              TO DC-OPTION-CODE
 13895              PERFORM 8500-DATE-CONVERT
 13896                                    THRU 8500-EXIT
 13897              IF NO-CONVERSION-ERROR
 13898                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13899                    MOVE ER-2661       TO WS-ERROR
 13900*                   PERFORM 9900-ERROR-FORMAT
 13901*                                   THRU 9900-EXIT
 13902                 END-IF
 13903              END-IF
 13904           ELSE
 13905              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13906                (PB-I-AH-TERM / 12)
 13907              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13908                 MOVE ER-2661       TO WS-ERROR
 13909*                PERFORM 9900-ERROR-FORMAT
 13910*                                   THRU 9900-EXIT
 13911              ELSE
 13912                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13913                    MOVE ER-1571 TO WS-ERROR
 13914                    PERFORM 9900-ERROR-FORMAT
 13915                                 THRU 9900-EXIT
 13916                 END-IF
 13917              END-IF
 13918           END-IF
 13919           IF WS-ERROR = ER-2661
 13920              PERFORM 9900-ERROR-FORMAT
 13921                                    THRU 9900-EXIT
 13922           END-IF
 13923        END-IF
 13924     END-IF
 13925*    IF ACCOUNT-AH-CHECKED
 13926*       NEXT SENTENCE
 13927*    ELSE
 13928*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13929*          MOVE ER-2661          TO WS-ERROR
 13930*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13931
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 253
* EL050.cbl
 13932     IF ACCOUNT-AH-CHECKED
 13933        NEXT SENTENCE
 13934     ELSE
 13935        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13936           MOVE ER-2663          TO WS-ERROR
 13937           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13938
 13939     IF ACCOUNT-AH-CHECKED OR
 13940        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13941         PB-POLICY-IS-VOIDED
 13942        NEXT SENTENCE
 13943     ELSE
 13944        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13945           MOVE ER-2667            TO WS-ERROR
 13946           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13947
 13948     IF PB-COMPANY-ID = 'CRI'
 13949         IF WS-ERROR = ER-2667
 13950             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13951
 13952     IF ACCOUNT-AH-CHECKED
 13953        NEXT SENTENCE
 13954     ELSE
 13955        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13956           MOVE ER-2678            TO WS-ERROR
 13957           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13958
 13959     IF CP-ERROR-RATE-FILE-NOTOPEN
 13960         GO TO 3990-FILES-NOT-OPEN.
 13961
 13962 3321-CONTINUE.
 13963     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13964     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13965     IF (PB-COMPANY-ID = 'DCC')
 13966        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13967        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13968                                    PB-I-LF-ALT-PREM-CALC
 13969        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13970        IF WS-AH-BEN-CATEGORY = 'G'
 13971           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13972           + PB-I-ADDL-CLP)
 13973           * (1 + WS-TOL-CLP-PCT)
 13974*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13975        ELSE
 13976           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13977           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13978*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13979        END-IF
 13980        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13981                                 TO PB-I-AH-PREM-CALC
 13982        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13983           MOVE ER-8152          TO WS-ERROR
 13984           PERFORM 9900-ERROR-FORMAT
 13985                                 THRU 9900-EXIT
 13986        ELSE
 13987           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 13988                 PB-I-ADDL-CLP)
 13989              MOVE ER-8148       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 254
* EL050.cbl
 13990              PERFORM 9900-ERROR-FORMAT
 13991                                 THRU 9900-EXIT
 13992           END-IF
 13993        END-IF
 13994     END-IF
 13995     IF (PB-COMPANY-ID = 'DCC')
 13996        AND (PB-I-POLICY-IS-MONTHLY)
 13997        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13998        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 13999        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14000           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14001        END-IF
 14002     END-IF
 14003     IF (PB-COMPANY-ID = 'DCC')
 14004        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14005        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14006        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14007        MOVE ER-2786             TO WS-ERROR
 14008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14009     END-IF
 14010     MOVE +0                     TO PB-I-AH-CLP
 14011     IF PB-COMPANY-ID = 'DCC'
 14012        IF WS-AH-BEN-CATEGORY = 'D'
 14013           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14014              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14015        ELSE
 14016           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14017              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14018           END-IF
 14019        END-IF
 14020     END-IF
 14021     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14022
 14023     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14024         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14025
 14026     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14027         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14028
 14029     IF PB-COMPANY-ID = 'CRI'
 14030         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14031            PB-I-PAYMENT-AMOUNT = ZERO
 14032             NEXT SENTENCE
 14033         ELSE
 14034             COMPUTE PB-I-AH-PREM-CALC =
 14035                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14036                 (CP-PREMIUM-RATE / 100)
 14037             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14038                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14039                                             PB-I-RATE-DEV-PCT-AH.
 14040
 14041     IF PB-I-AH-RATE  = ZERO
 14042         MOVE ER-2642            TO WS-ERROR
 14043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14044
 14045     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14046     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14047     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 255
* EL050.cbl
 14048     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14049     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14050     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14051
 14052     IF (PB-COMPANY-ID = 'DCC')
 14053        AND (WS-AH-BEN-CATEGORY = 'G')
 14054        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14055        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14056        IF CP-DEVIATION-CODE NOT = '000'
 14057           MOVE '000'            TO CP-DEVIATION-CODE
 14058           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14059           IF NO-CP-ERROR
 14060              COMPUTE PB-I-DDF-IU-RATE-UP =
 14061              PB-I-AH-CLP - CP-CALC-PREMIUM
 14062           ELSE
 14063              MOVE ER-3057        TO WS-ERROR
 14064              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14065           END-IF
 14066        END-IF
 14067     END-IF
 14068     .
 14069 3335-EDIT-AH-REIN-NSP-RATE.
 14070     IF AH-REIN-NSP-NOT-USED
 14071         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14072
 14073     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14074     IF PB-COMPANY-ID = 'DCC'
 14075         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14076     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14077     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14078     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14079     MOVE PB-SV-STATE            TO CP-STATE.
 14080     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14081     MOVE ZERO                   TO CP-DEVIATION-CODE
 14082                                    CP-RATE-DEV-PCT.
 14083*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14084     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14085     MOVE '3'                    TO CP-PROCESS-TYPE.
 14086     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14087     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14088                                    CP-RATING-BENEFIT-AMT.
 14089     IF CP-STATE-STD-ABBRV = 'OR'
 14090         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14091                                         PB-I-AH-TERM.
 14092     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14093     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14094     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14095     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14096     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14097     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14098                                    CP-REMAINING-TERM
 14099                                    WS-WORK-TERM.
 14100     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14101     IF PB-COMPANY-ID = 'DCC'
 14102        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14103     END-IF
 14104     IF  PB-COMPANY-ID = 'TIC'
 14105         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 256
* EL050.cbl
 14106            MOVE ZERO TO CP-CLASS-CODE.
 14107
 14108     IF PB-COMPANY-ID NOT = 'TIC'
 14109          MOVE ZERO          TO CP-CLASS-CODE.
 14110
 14111     MOVE ZERO               TO CP-DEVIATION-CODE.
 14112
 14113     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14114
 14115     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14116
 14117     MOVE 'R'                   TO CP-RATE-FILE.
 14118     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14119
 14120     IF CP-ERROR-RATE-NOT-FOUND
 14121         MOVE ER-2645        TO WS-ERROR
 14122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14123         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14124
 14125     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14126
 14127     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14128     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14129
 14130     IF PB-I-AH-REI-RATE = ZERO
 14131         MOVE ER-2645        TO WS-ERROR
 14132         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14133
 14134
 14135 3340-CALCULATE-PREMIUM-AMT.
 14136
 14137     IF PB-COMPANY-ID = 'NCL'
 14138         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14139             WS-AH-SPECIAL-CALC-CD = 'O')
 14140             GO TO 3999-END-EDIT.
 14141
 14142     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14143                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14144                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14145                         OR 'AHL'
 14146         NEXT SENTENCE
 14147     ELSE
 14148         IF WS-STATE-ABBREVIATION = 'CT'
 14149             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14150                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14151                 COMPUTE PB-I-LF-PREM-CALC =
 14152                                     PB-I-LF-PREM-CALC * .90
 14153                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14154                                     PB-I-LF-ALT-PREM-CALC * .90
 14155                 COMPUTE PB-I-AH-PREM-CALC =
 14156                                     PB-I-AH-PREM-CALC * .90.
 14157
 14158     IF PB-COMP-LF-PREM
 14159        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14160        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14161
 14162     IF PB-COMP-AH-PREM
 14163        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 257
* EL050.cbl
 14164
 14165 3340-CHECK-DCC-TOT-FEES.
 14166     IF (PB-COMPANY-ID = 'DCC')
 14167        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14168        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14169        AND (PB-I-POLICY-IS-MONTHLY)
 14170        CONTINUE
 14171     ELSE
 14172        GO TO 3340-EDIT-LF-AH-TOL
 14173     END-IF
 14174     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14175     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14176     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14177        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14178           PB-I-RATE-DEV-PCT-LF
 14179     END-IF
 14180     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14181        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14182           PB-I-RATE-DEV-PCT-AH
 14183     END-IF
 14184     MOVE 'N'                    TO CP-BEN-CATEGORY
 14185     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14186
 14187     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14188     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14189     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14190     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14191     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14192     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14193     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14194     MOVE '3'                    TO CP-PROCESS-TYPE.
 14195     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14196     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14197
 14198     MOVE PB-SV-STATE            TO CP-STATE.
 14199     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14200     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14201     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14202     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14203     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14204                                    CP-RATING-BENEFIT-AMT.
 14205     IF CP-STATE-STD-ABBRV = 'OR'
 14206         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14207                                         PB-I-LF-ALT-BENEFIT-AMT.
 14208     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14209     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14210     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14211     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14212     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14213     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14214     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14215     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14216     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14217                                    CP-REMAINING-TERM
 14218                                    CP-LOAN-TERM.
 14219
 14220     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14221         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 258
* EL050.cbl
 14222     ELSE
 14223         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14224             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14225                                           PB-I-LF-PREMIUM-AMT.
 14226
 14227     IF CP-TRUNCATED-LIFE
 14228        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14229
 14230     IF CP-TERM-IS-DAYS
 14231         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14232     ELSE
 14233         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14234
 14235     IF PB-COMPANY-ID = 'DCC'
 14236        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14237     END-IF
 14238     IF CP-SPECIAL-CALC-CD = 'H'
 14239         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14240                                    TO CP-ALTERNATE-BENEFIT
 14241         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14242     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14243     MOVE 'R'                    TO CP-RATE-FILE
 14244     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14245     IF NOT CP-ERROR-RATE-NOT-FOUND
 14246        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14247        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14248           AND (CP-BENEFIT-CD (1:1) = 'S')
 14249           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14250                                    PB-I-LF-PREMIUM-AMT
 14251        END-IF
 14252     ELSE
 14253        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14254     END-IF
 14255     .
 14256 3340-EDIT-LF-AH-TOL.
 14257
 14258***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14259***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14260***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14261***
 14262     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14263         PB-I-AH-PREMIUM-AMT
 14264          GIVING WS-CALC-WORK.
 14265
 14266     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14267        AND WS-CALC-WORK NOT = ZERO
 14268         MOVE ER-2649            TO WS-ERROR
 14269         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14270
 14271     SUBTRACT PB-I-LF-PREM-CALC
 14272             FROM PB-I-LF-PREMIUM-AMT
 14273                 GIVING WS-UNSIGN-WRK1.
 14274
 14275     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14276             FROM PB-I-LF-ALT-PREMIUM-AMT
 14277                 GIVING WS-UNSIGN-WRK4.
 14278
 14279     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 259
* EL050.cbl
 14280                                + WS-UNSIGN-WRK4.
 14281
 14282     SUBTRACT PB-I-AH-PREM-CALC
 14283             FROM PB-I-AH-PREMIUM-AMT
 14284                 GIVING WS-UNSIGN-WRK2.
 14285
 14286******************************************************************
 14287*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14288******************************************************************
 14289
 14290     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14291         MOVE ZERO TO WS-UNSIGN-WRK1.
 14292
 14293     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14294         MOVE ZERO TO WS-UNSIGN-WRK2.
 14295
 14296     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14297             GIVING WS-UNSIGN-WRK3.
 14298
 14299 3342-CONTINUE.
 14300
 14301     IF (PB-I-LF-RATE = ZERO  AND
 14302         PB-I-AH-RATE = ZERO)
 14303         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14304            WS-AH-SPECIAL-CALC-CD = 'O'
 14305              NEXT SENTENCE
 14306         ELSE
 14307             GO TO 3345-EDIT-CONTINUE.
 14308
 14309     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14310         NEXT SENTENCE
 14311     ELSE
 14312     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14313        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14314           IF (PB-REISSUED-CERT         OR
 14315               PB-POLICY-IS-DECLINED    OR
 14316               PB-POLICY-IS-VOIDED)
 14317              NEXT SENTENCE
 14318           ELSE
 14319              IF WS-PREM-REJECT-SW = SPACE
 14320                 MOVE ER-2652    TO WS-ERROR
 14321                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14322                 GO TO 3344-CHECK-AH
 14323              ELSE
 14324                 MOVE ER-2650    TO WS-ERROR
 14325                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14326                 GO TO 3344-CHECK-AH.
 14327
 14328***
 14329***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14330***
 14331
 14332     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14333         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14334            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14335             (1 + WS-TOL-LF-PREM-PCT)
 14336         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14337            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 260
* EL050.cbl
 14338             (1 - WS-TOL-LF-PREM-PCT)
 14339     ELSE
 14340         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14341         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14342
 14343***
 14344***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14345***
 14346
 14347     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14348         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14349          WS-TOL-LF-PREM.
 14350
 14351     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14352         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14353          WS-TOL-LF-PREM.
 14354
 14355     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14356        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14357
 14358     IF (PB-REISSUED-CERT        OR
 14359         PB-POLICY-IS-DECLINED   OR
 14360         PB-POLICY-IS-VOIDED)
 14361        NEXT SENTENCE
 14362     ELSE
 14363     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14364           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14365       OR
 14366        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14367           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14368       AND
 14369        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14370           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14371         OR
 14372          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14373           LESS WS-TOL-LF-LOW-PREM-PCT))
 14374              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14375                  MOVE ER-2652   TO  WS-ERROR
 14376                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14377              ELSE
 14378                  MOVE ER-2650   TO  WS-ERROR
 14379                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14380
 14381*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14382*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14383*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14384*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14385
 14386     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14387        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14388                      OR
 14389           ((PB-COMPANY-ID = 'DCC')
 14390           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14391           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14392           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14393        END-IF
 14394     END-IF
 14395
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 261
* EL050.cbl
 14396     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14397        IF WS-COMP-MAX-CAP GREATER THAN +0
 14398           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14399              IF (PB-REISSUED-CERT         OR
 14400                  PB-POLICY-IS-DECLINED    OR
 14401                  PB-POLICY-IS-VOIDED)
 14402                 NEXT SENTENCE
 14403              ELSE
 14404                  MOVE ER-2646   TO  WS-ERROR
 14405                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14406
 14407 3344-CVL-TOLERANCE-CHECK.
 14408
 14409      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14410          GO TO 3344-CHECK-AH.
 14411
 14412      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14413          GO TO 3344-CHECK-AH.
 14414
 14415      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14416                                     WS-UNSIGN-WRK6.
 14417
 14418      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14419          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14420                                 + PB-I-LF-PREMIUM-AMT
 14421                                 - PB-I-LF-PREM-CALC.
 14422
 14423      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14424          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14425                                 + PB-I-LF-ALT-PREMIUM-AMT
 14426                                 - PB-I-LF-ALT-PREM-CALC.
 14427
 14428      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14429          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14430              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14431                 MOVE ER-2652    TO  WS-ERROR
 14432                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14433              ELSE
 14434                 MOVE ER-2650    TO  WS-ERROR
 14435                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14436
 14437      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14438          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14439              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14440                 MOVE ER-2652    TO  WS-ERROR
 14441                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14442              ELSE
 14443                 MOVE ER-2650    TO  WS-ERROR
 14444                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14445
 14446 3344-CHECK-AH.
 14447
 14448****************************************************************
 14449***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14450***
 14451
 14452     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14453         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 262
* EL050.cbl
 14454             (1 + WS-TOL-AH-PREM-PCT)
 14455         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14456             (1 - WS-TOL-AH-PREM-PCT)
 14457     ELSE
 14458         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14459         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14460
 14461***
 14462***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14463***
 14464
 14465     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14466         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14467
 14468     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14469         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14470
 14471     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14472        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14473
 14474     IF (PB-REISSUED-CERT)
 14475        OR (PB-POLICY-IS-DECLINED)
 14476        OR (PB-POLICY-IS-VOIDED)
 14477        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14478        CONTINUE
 14479     ELSE
 14480        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14481            OR
 14482           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14483           AND
 14484           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14485           OR
 14486           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14487           IF WS-PREM-REJECT-SW = SPACE
 14488              MOVE ER-3052       TO WS-ERROR
 14489              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14490           ELSE
 14491              MOVE ER-3050       TO WS-ERROR
 14492              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14493           END-IF
 14494        END-IF
 14495     END-IF
 14496
 14497     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14498         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14499             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14500             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14501
 14502     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14503        IF WS-COMP-MAX-CAP GREATER THAN +0
 14504           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14505              IF (PB-REISSUED-CERT         OR
 14506                  PB-POLICY-IS-DECLINED    OR
 14507                  PB-POLICY-IS-VOIDED)
 14508                 NEXT SENTENCE
 14509              ELSE
 14510                  MOVE ER-2646   TO  WS-ERROR
 14511                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 263
* EL050.cbl
 14512
 14513     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14514        (WS-COMP-MAX-CAP EQUAL +0)
 14515           GO TO 3345-EDIT-CONTINUE.
 14516
 14517     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14518        GREATER THAN WS-COMP-MAX-CAP
 14519           MOVE ER-2646          TO  WS-ERROR
 14520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14521
 14522 3345-EDIT-CONTINUE.
 14523
 14524*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14525*       IF PB-ENTRY-BATCH   NUMERIC
 14526*          IF PB-ISSUE
 14527*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14528*          ELSE
 14529*              IF PB-CANCELLATION
 14530*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14531
 14532*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14533*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14534*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14535*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14536*        ELSE
 14537*            MOVE  ER-1909            TO  WS-ERROR
 14538*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14539
 14540     IF PB-I-POLICY-ACCEPTED
 14541        IF PB-POLICY-IS-DECLINED  OR
 14542           PB-REISSUED-CERT  OR
 14543           PB-REIN-ONLY-CERT  OR
 14544           PB-POLICY-IS-VOIDED
 14545            MOVE  ER-1891         TO  WS-ERROR
 14546            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14547        ELSE
 14548            MOVE SPACE            TO  PB-BATCH-ENTRY
 14549            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14550
 14551     IF PB-I-POLICY-DECLINED
 14552        IF PB-REISSUED-CERT  OR
 14553           PB-REIN-ONLY-CERT  OR
 14554           PB-POLICY-IS-VOIDED
 14555            MOVE  ER-1906         TO  WS-ERROR
 14556            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14557        ELSE
 14558            MOVE  'D'             TO  PB-BATCH-ENTRY
 14559                                      PB-I-ENTRY-STATUS.
 14560
 14561     IF PB-I-NEEDS-UNDERWRITING
 14562        IF PB-POLICY-IS-DECLINED OR
 14563           PB-REISSUED-CERT  OR
 14564           PB-REIN-ONLY-CERT  OR
 14565           PB-POLICY-IS-VOIDED
 14566            MOVE  ER-1907         TO  WS-ERROR
 14567            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14568        ELSE
 14569            MOVE 'U'              TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 264
* EL050.cbl
 14570                                      PB-I-ENTRY-STATUS.
 14571
 14572     IF PB-NEEDS-UNDERWRITING
 14573        MOVE  ER-1901             TO  WS-ERROR
 14574        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14575     IF PB-COMPANY-ID = 'DCC'
 14576        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14577        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14578        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14579           AND (NOT WS-LF-CASH))
 14580                           OR
 14581           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14582           AND (NOT WS-AH-CASH)))
 14583                       AND
 14584           (PB-I-ENTRY-STATUS NOT = '5')
 14585           MOVE 'M'              TO PB-BATCH-ENTRY
 14586                                    PB-I-ENTRY-STATUS
 14587        END-IF
 14588     END-IF
 14589     IF  PB-COMPANY-ID NOT = 'NCL'
 14590         GO TO 3999-END-EDIT.
 14591
 14592     IF PB-REISSUED-CERT  OR
 14593        PB-POLICY-IS-DECLINED  OR
 14594        PB-POLICY-IS-VOIDED  OR
 14595        PB-I-OB
 14596         GO TO 3999-END-EDIT.
 14597
 14598     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14599         MOVE  ER-2644            TO  WS-ERROR
 14600         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14601         GO TO 3999-END-EDIT.
 14602
 14603     MOVE 'N'                     TO  FORM-MASTER-SW.
 14604     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14605
 14606     IF NOT FORM-MASTER-FOUND
 14607         GO TO 3999-END-EDIT.
 14608
 14609     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14610                                      FORM-MASTER-AH-SW.
 14611
 14612     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14613         MOVE  +1                 TO SUB6
 14614         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14615
 14616     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14617         MOVE  +1                 TO SUB6
 14618         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14619
 14620     IF LF-FORM-MASTER-FOUND  OR
 14621        AH-FORM-MASTER-FOUND
 14622         GO TO 3360-CHECK-FORM-LIMITS
 14623     ELSE
 14624         GO TO 3999-END-EDIT.
 14625
 14626******************************************************************
 14627*                  3350-GET-ERFORM                               *
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 265
* EL050.cbl
 14628*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14629*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14630******************************************************************
 14631
 14632 3350-GET-ERFORM.
 14633
 14634     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14635         GO TO  3350-ERFORM-GETMAIN.
 14636
 14637     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14638     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14639     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14640     MOVE 'Y'                     TO FORM-MASTER-SW.
 14641
 14642     IF PB-CANCELLATION
 14643         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14644            PB-SV-STATE          EQUAL   FO-STATE       AND
 14645            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14646              GO TO 3350-EXIT
 14647         ELSE
 14648             NEXT SENTENCE
 14649     ELSE
 14650         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14651            PB-SV-STATE          EQUAL   FO-STATE       AND
 14652            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14653              GO TO 3350-EXIT.
 14654
 14655 3350-ERFORM-GETMAIN.
 14656
 14657     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14658     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14659
 14660 3350-ERFORM-READ.
 14661
 14662     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14663     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14664     IF PB-CANCELLATION
 14665         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14666     ELSE
 14667         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14668     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14669
 14670     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14671
 14672     IF FORM-MASTER-FOUND
 14673       IF PB-CANCELLATION
 14674          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14675             PB-SV-STATE          EQUAL   FO-STATE       AND
 14676             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14677              GO  TO 3350-EXIT
 14678          ELSE
 14679              NEXT SENTENCE
 14680       ELSE
 14681          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14682             PB-SV-STATE          EQUAL   FO-STATE       AND
 14683             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14684              GO  TO 3350-EXIT.
 14685
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 266
* EL050.cbl
 14686     MOVE  'N'                    TO  FORM-MASTER-SW.
 14687     MOVE  ER-1895                TO  WS-ERROR.
 14688     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14689
 14690 3350-EXIT.
 14691      EXIT.
 14692
 14693******************************************************************
 14694*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14695*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14696*   VALID FOR THE POLICY FORM USED.                              *
 14697******************************************************************
 14698
 14699 3355-EDIT-FORM-LF-BENEFITS.
 14700
 14701     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14702        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14703         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14704         GO TO   3355-EXIT.
 14705
 14706     IF  SUB6    LESS THAN   +40
 14707         ADD  +1      TO  SUB6
 14708         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14709
 14710     MOVE  ER-1896         TO  WS-ERROR.
 14711     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14712
 14713 3355-EXIT.
 14714      EXIT.
 14715
 14716******************************************************************
 14717*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14718*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14719*   VALID FOR THE POLICY FORM USED.                              *
 14720******************************************************************
 14721
 14722 3356-EDIT-FORM-AH-BENEFITS.
 14723
 14724     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14725        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14726         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14727         GO TO  3356-EXIT.
 14728
 14729      IF  SUB6    LESS THAN     +40
 14730          ADD  +1      TO  SUB6
 14731          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14732
 14733     MOVE  ER-1897         TO  WS-ERROR.
 14734     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14735
 14736 3356-EXIT.
 14737      EXIT.
 14738
 14739******************************************************************
 14740*                  3357-BENEFIT-SEARCH                           *
 14741*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14742*   CANCELLATIONS ONLY.                                          *
 14743******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 267
* EL050.cbl
 14744 3357-BENEFIT-SEARCH.
 14745     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14746         MOVE +1                          TO SUB6
 14747         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14748
 14749     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14750         MOVE +1                          TO SUB6
 14751         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14752
 14753 3357-EXIT.
 14754     EXIT.
 14755
 14756******************************************************************
 14757*                  3358-BENEFIT-LIFE-SEARCH                      *
 14758*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14759*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14760*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14761******************************************************************
 14762 3358-BENEFIT-LIFE-SEARCH.
 14763     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14764       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14765         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14766           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14767              IF FO-PLAN-REFUND-METHOD (SUB6)
 14768                     IS GREATER THAN SPACES
 14769                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14770                                          WS-LF-REFUND-CALC
 14771                 GO TO 3358-EXIT.
 14772
 14773     IF SUB6 LESS THAN +40
 14774         ADD +1                 TO SUB6
 14775         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14776
 14777 3358-EXIT.
 14778     EXIT.
 14779******************************************************************
 14780*                  3359-BENEFIT-AH-SEARCH                        *
 14781*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14782*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14783*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14784******************************************************************
 14785 3359-BENEFIT-AH-SEARCH.
 14786     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14787       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14788         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14789           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14790              IF FO-PLAN-REFUND-METHOD (SUB6)
 14791                      IS GREATER THAN SPACES
 14792                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14793                                          WS-AH-REFUND-CALC
 14794                 GO TO 3359-EXIT.
 14795
 14796     IF SUB6 LESS THAN +40
 14797         ADD +1                 TO SUB6
 14798         GO TO 3359-BENEFIT-AH-SEARCH.
 14799
 14800 3359-EXIT.
 14801     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 268
* EL050.cbl
 14802
 14803******************************************************************
 14804*                  3360-CHECK-FORM-LIMITS                        *
 14805*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14806*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14807******************************************************************
 14808
 14809 3360-CHECK-FORM-LIMITS.
 14810
 14811     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14812         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14813
 14814     IF NOT LF-FORM-MASTER-FOUND
 14815         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14816
 14817 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14818
 14819     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14820       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14821        WS-LF-JOINT-INDICATOR = 'J'  AND
 14822        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14823         IF PB-COMPANY-ID = 'NCL'
 14824            MOVE  ER-1911          TO  WS-ERROR
 14825            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14826         ELSE
 14827            MOVE  ER-1892          TO  WS-ERROR
 14828            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14829
 14830 3360-CHECK-FORM-LF-ATT-AGE.
 14831
 14832     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14833
 14834     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14835         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14836         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14837            IF PB-COMPANY-ID = 'NCL'
 14838                MOVE  ER-1913      TO  WS-ERROR
 14839                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14840            ELSE
 14841                MOVE  ER-1894      TO  WS-ERROR
 14842                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14843
 14844 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14845
 14846     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14847         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14848         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14849            IF PB-COMPANY-ID = 'NCL'
 14850                MOVE  ER-1914      TO  WS-ERROR
 14851                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14852            ELSE
 14853                MOVE  ER-1899      TO  WS-ERROR
 14854                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14855
 14856 3360-CHECK-FORM-LF-TERM-BAMT.
 14857
 14858     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14859         FO-LF-MAX-TERM   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 269
* EL050.cbl
 14860         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14861           IF  PB-COMPANY-ID = 'NCL'
 14862               MOVE  ER-1916       TO  WS-ERROR
 14863               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14864           ELSE
 14865               MOVE  ER-1902       TO  WS-ERROR
 14866               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14867
 14868     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14869                                    PB-I-LF-ALT-BENEFIT-AMT.
 14870
 14871     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14872         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14873         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14874             IF  PB-COMPANY-ID = 'NCL'
 14875                 MOVE  ER-1918     TO  WS-ERROR
 14876                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14877             ELSE
 14878                 MOVE  ER-1904     TO  WS-ERROR
 14879                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14880
 14881******************************************************************
 14882*                  3360-CHECK-FORM-AH-LIMITS                     *
 14883*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14884*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14885******************************************************************
 14886
 14887 3360-CHECK-FORM-AH-LIMITS.
 14888
 14889     IF NOT AH-FORM-MASTER-FOUND
 14890         GO TO 3999-END-EDIT.
 14891
 14892 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14893
 14894     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14895       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14896        WS-AH-JOINT-INDICATOR = 'J'  AND
 14897        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14898         IF PB-COMPANY-ID = 'NCL'
 14899            MOVE  ER-1912          TO  WS-ERROR
 14900            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14901         ELSE
 14902            MOVE  ER-1893          TO  WS-ERROR
 14903            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14904
 14905 3360-CHECK-FORM-AH-ATT-AGE.
 14906
 14907     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14908
 14909     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14910         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14911         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14912            IF PB-COMPANY-ID = 'NCL'
 14913                MOVE  ER-1913      TO  WS-ERROR
 14914                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14915            ELSE
 14916                MOVE  ER-1894      TO  WS-ERROR
 14917                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 270
* EL050.cbl
 14918
 14919 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14920
 14921     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14922         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14923         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14924            IF PB-COMPANY-ID = 'NCL'
 14925                MOVE  ER-1915      TO  WS-ERROR
 14926                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14927            ELSE
 14928                MOVE  ER-1900      TO  WS-ERROR
 14929                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14930
 14931 3360-CHECK-FORM-AH-TERM-BAMT.
 14932
 14933     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14934         FO-AH-MAX-TERM    GREATER THAN  +0
 14935         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14936             IF  PB-COMPANY-ID = 'NCL'
 14937                 MOVE  ER-1917     TO  WS-ERROR
 14938                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14939             ELSE
 14940                  MOVE  ER-1903    TO  WS-ERROR
 14941                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14942
 14943     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14944         FO-MAX-AH-AMT    GREATER THAN  +0
 14945         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14946             IF  PB-COMPANY-ID = 'NCL'
 14947                 MOVE  ER-1919     TO  WS-ERROR
 14948                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14949             ELSE
 14950                 MOVE  ER-1905     TO  WS-ERROR
 14951                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14952
 14953     GO TO 3999-END-EDIT.
 14954
 14955******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 271
* EL050.cbl
 14957******************************************************************
 14958*                  E D I T   C A N C E L                         *
 14959******************************************************************
 14960
 14961 3700-EDIT-CANCEL.
 14962     IF PB-COMPANY-ID = 'DMD'
 14963         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14964                                         WS-RES-MUNI-TAX
 14965                                         PB-CI-STATE-TAX
 14966                                         PB-CI-MUNI-TAX
 14967         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14968
 14969*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14970*       IF PB-ENTRY-BATCH  NUMERIC
 14971*          IF PB-CANCELLATION
 14972*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14973*          ELSE
 14974*             IF PB-ISSUE
 14975*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14976
 14977     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14978        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14979     END-IF
 14980*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14981*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14982
 14983     IF CM-ENTRY-STATUS = 'V'
 14984        MOVE ER-2780             TO WS-ERROR
 14985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14986        GO TO 3999-END-EDIT.
 14987
 14988     IF CM-ENTRY-STATUS = 'D'
 14989        MOVE ER-2781             TO WS-ERROR
 14990        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14991        GO TO 3999-END-EDIT.
 14992
 14993     IF CM-ENTRY-STATUS = 'U'
 14994        MOVE ER-2782             TO WS-ERROR
 14995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14996
 14997***************************************************************
 14998*                                                             *
 14999*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15000*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15001*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15002*   OF ANOTHER COVERAGE.                                      *
 15003*                                                             *
 15004***************************************************************
 15005
 15006     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15007                                    PB-C-AH-CANCEL-VOID-SW.
 15008
 15009     IF PB-C-LF-CANCEL-AMT = ZERO
 15010        NEXT SENTENCE
 15011     ELSE
 15012        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15013           AND
 15014           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 272
* EL050.cbl
 15015               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15016               MOVE ER-2745           TO WS-ERROR
 15017               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15018
 15019     IF PB-C-AH-CANCEL-AMT = ZERO
 15020        NEXT SENTENCE
 15021     ELSE
 15022        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15023           AND
 15024           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15025               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15026               MOVE ER-2745           TO WS-ERROR
 15027               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15028
 15029     IF WS-LF-EARNINGS-CALC = '4'
 15030        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15031
 15032     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15033     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15034     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15035     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15036     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15037     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15038
 15039     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15040                                      PB-C-AH-REF-CALC.
 15041     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15042
 15043******************************************************************
 15044*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15045*             TO VALIDATE COVERAGE.                              *
 15046******************************************************************
 15047
 15048     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15049        PB-C-LF-CANCEL-AMT = ZEROS
 15050          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15051      ELSE
 15052          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15053
 15054     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15055        PB-C-AH-CANCEL-AMT = ZEROS
 15056          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15057      ELSE
 15058          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15059
 15060     EVALUATE TRUE
 15061         WHEN PB-CANCEL-FORCE             OR
 15062              PB-CANCEL-DATE-FORCED       OR
 15063              PB-FORCE-OFF
 15064                  IF PB-COMPANY-ID = 'ACE'
 15065                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15066                  END-IF
 15067         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15068               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15069              (PB-COMPANY-ID = 'ACE' )
 15070                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15071         WHEN OTHER
 15072              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 273
* EL050.cbl
 15073                 MOVE ER-2794              TO WS-ERROR
 15074              ELSE
 15075                 MOVE ER-2749              TO WS-ERROR
 15076              END-IF
 15077              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15078     END-EVALUATE.
 15079
 15080
 15081*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15082*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15083*            MOVE  ER-1909            TO  WS-ERROR
 15084*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15085*        ELSE
 15086*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15087
 15088     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15089     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15090        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15091     ELSE
 15092        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15093     END-IF
 15094     .
 15095 3705-EDIT-CANCEL-DT.
 15096
 15097     IF LF-COVERAGE-CANCELLED
 15098        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15099         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15100         MOVE WS-CURRENT-MONTH-END
 15101                                 TO DC-BIN-DATE-2
 15102         SET ELAPSED-BETWEEN-BIN TO TRUE
 15103*        MOVE 1                  TO DC-OPTION-CODE
 15104         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15105         IF DATE-CONVERSION-ERROR
 15106            NEXT SENTENCE
 15107          ELSE
 15108             IF DC-ELAPSED-DAYS GREATER +180
 15109                IF PB-CANCEL-DATE-FORCED  OR
 15110                   PB-CANCEL-DATE-FORCED-NO-FEE
 15111                      MOVE ER-2751  TO WS-ERROR
 15112                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15113                 ELSE
 15114                   MOVE ER-2752  TO WS-ERROR
 15115                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15116
 15117     IF AH-COVERAGE-CANCELLED
 15118        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15119         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15120         MOVE WS-CURRENT-MONTH-END
 15121                                 TO DC-BIN-DATE-2
 15122         SET ELAPSED-BETWEEN-BIN TO TRUE
 15123*        MOVE 1                  TO DC-OPTION-CODE
 15124         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15125         IF DATE-CONVERSION-ERROR
 15126            NEXT SENTENCE
 15127          ELSE
 15128             IF DC-ELAPSED-DAYS GREATER +180
 15129                IF PB-CANCEL-DATE-FORCED OR
 15130                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 274
* EL050.cbl
 15131                      MOVE ER-2751  TO WS-ERROR
 15132                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15133                 ELSE
 15134                   MOVE ER-2752  TO WS-ERROR
 15135                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15136
 15137     IF WS-ERROR = ER-2752
 15138        AND (PB-COMPANY-ID = 'ABL'
 15139         OR  PB-COMPANY-ID = 'FGL'
 15140         OR  PB-COMPANY-ID = 'IST'
 15141         OR  PB-COMPANY-ID = 'JHL'
 15142         OR  PB-COMPANY-ID = 'LAP'
 15143         OR  PB-COMPANY-ID = 'LBL'
 15144         OR  PB-COMPANY-ID = 'NCB'
 15145         OR  PB-COMPANY-ID = 'NLI'
 15146         OR  PB-COMPANY-ID = 'OFI'
 15147         OR  PB-COMPANY-ID = 'PLI'
 15148         OR  PB-COMPANY-ID = 'TAO'
 15149         OR  PB-COMPANY-ID = 'TIC'
 15150         OR  PB-COMPANY-ID = 'HER'
 15151         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15152         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15153            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15154            MOVE ER-2762     TO WS-ERROR
 15155            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15156
 15157     IF LF-COVERAGE-CANCELLED
 15158        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15159        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15160             MOVE ER-2733         TO WS-ERROR
 15161             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15162
 15163     IF AH-COVERAGE-CANCELLED
 15164        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15165        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15166              MOVE ER-2733        TO WS-ERROR
 15167              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15168
 15169     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15170        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15171        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15172           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15173            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15174              IF PB-COMPANY-ID NOT = 'LAP'
 15175               MOVE ER-2704            TO WS-ERROR
 15176               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15177
 15178     IF CERT-WAS-NOT-FOUND
 15179         GO TO 3999-END-EDIT.
 15180
 15181     IF PB-COMPANY-ID EQUAL 'CDC'
 15182        IF LF-COVERAGE-CANCELLED
 15183           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15184            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15185            MOVE PB-C-LF-CANCEL-DT
 15186                                 TO DC-BIN-DATE-2
 15187            SET ELAPSED-BETWEEN-BIN TO TRUE
 15188*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 275
* EL050.cbl
 15189            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15190            IF DATE-CONVERSION-ERROR
 15191               NEXT SENTENCE
 15192             ELSE
 15193                IF DC-ELAPSED-DAYS GREATER +60
 15194                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15195
 15196     IF PB-COMPANY-ID EQUAL 'CDC'
 15197        IF AH-COVERAGE-CANCELLED
 15198           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15199            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15200            MOVE PB-C-AH-CANCEL-DT
 15201                                 TO DC-BIN-DATE-2
 15202            MOVE +0              TO DC-ELAPSED-DAYS
 15203                                    DC-ELAPSED-MONTHS
 15204            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15205*           MOVE 1               TO DC-OPTION-CODE
 15206            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15207            IF DATE-CONVERSION-ERROR
 15208               NEXT SENTENCE
 15209             ELSE
 15210                IF DC-ELAPSED-DAYS GREATER +60
 15211                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15212
 15213     MOVE +0                     TO DC-ELAPSED-DAYS
 15214                                    DC-ELAPSED-MONTHS.
 15215
 15216     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15217        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15218          MOVE 'Z'                TO PB-CI-OB-FLAG
 15219          MOVE ER-2767            TO WS-ERROR
 15220          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15221          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15222          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15223          GO TO 3775-OVER-REF-CHK
 15224        ELSE
 15225          MOVE ZEROS              TO PB-CI-LIVES
 15226                                     PB-C-LIVES
 15227          IF PB-CI-OB-FLAG NOT = 'B'
 15228             MOVE SPACE           TO PB-CI-OB-FLAG.
 15229
 15230     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15231         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15232     ELSE
 15233         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15234
 15235     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15236        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15237            MOVE ER-2760         TO WS-ERROR
 15238            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15239
 15240     IF LF-COVERAGE-CANCELLED
 15241        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15242         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15243            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15244               MOVE ER-2774       TO WS-ERROR
 15245               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15246
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 276
* EL050.cbl
 15247     IF AH-COVERAGE-CANCELLED
 15248        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15249         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15250            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15251               MOVE ER-2775       TO WS-ERROR
 15252               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15253
 15254     IF LF-COVERAGE-CANCELLED
 15255        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15256         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15257            MOVE ER-2776         TO WS-ERROR
 15258            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15259
 15260     IF AH-COVERAGE-CANCELLED
 15261        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15262         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15263            MOVE ER-2777         TO WS-ERROR
 15264            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15265
 15266     IF LF-COVERAGE-CANCELLED
 15267        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15268         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15269         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15270         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15271*        MOVE 6                    TO DC-OPTION-CODE
 15272         SET BIN-PLUS-ELAPSED      TO TRUE
 15273         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15274         IF DATE-CONVERSION-ERROR
 15275            NEXT SENTENCE
 15276          ELSE
 15277            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15278              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15279                             OR  'FIA'
 15280                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15281               ELSE
 15282                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15283                MOVE ER-2731       TO WS-ERROR
 15284                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15285
 15286 3705-EDIT-AH-CANCEL-DT.
 15287
 15288     IF AH-COVERAGE-CANCELLED
 15289        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15290         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15291         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15292         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15293*        MOVE 6                    TO DC-OPTION-CODE
 15294         SET BIN-PLUS-ELAPSED      TO TRUE
 15295         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15296         IF DATE-CONVERSION-ERROR
 15297            NEXT SENTENCE
 15298          ELSE
 15299            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15300              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15301                              OR 'FIA'
 15302                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15303              ELSE
 15304               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 277
* EL050.cbl
 15305               MOVE ER-2771       TO WS-ERROR
 15306               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15307
 15308 3705-EDIT-CONTINUED.
 15309
 15310*    IF LF-COVERAGE-CANCELLED
 15311*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15312*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15313*            MOVE ER-2727         TO WS-ERROR
 15314*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15315*
 15316*    IF AH-COVERAGE-CANCELLED
 15317*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15318*        IF PB-COMPANY-ID = 'ACE'
 15319*           MOVE ER-2727        TO WS-ERROR
 15320*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15321*        ELSE
 15322*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15323*              MOVE ER-2727     TO WS-ERROR
 15324*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15325
 15326     IF PB-COMPANY-ID = 'ACE'
 15327       IF AH-COVERAGE-CANCELLED
 15328         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15329           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15330              MOVE ER-2732      TO WS-ERROR
 15331              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15332
 15333     IF PB-COMPANY-ID      EQUAL   'HER'
 15334        IF WS-ERROR        EQUAL   ER-2727
 15335            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15336            MOVE  ER-2725          TO  WS-ERROR
 15337            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15338
 15339     IF PB-C-CLAIM-CREATED-CANCEL
 15340            MOVE ER-2748         TO WS-ERROR
 15341            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15342
 15343     IF PB-C-LAST-NAME NOT = SPACES
 15344         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15345            MOVE ER-2747         TO WS-ERROR
 15346            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15347
 15348 3710-EDIT-LUMP-SUM-PRIOR.
 15349
 15350     IF AH-COVERAGE-CANCELLED
 15351         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15352             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15353                MOVE ER-2735    TO WS-ERROR
 15354                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15355
 15356     IF LF-COVERAGE-CANCELLED
 15357         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15358             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15359                MOVE ER-2735    TO WS-ERROR
 15360                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15361
 15362 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 278
* EL050.cbl
 15363
 15364*    IF LF-COVERAGE-CANCELLED
 15365*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15366*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15367*           (NOT PB-CI-OB)
 15368*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15369*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15370*                   MOVE ER-2732  TO WS-ERROR
 15371*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15372*
 15373*    IF AH-COVERAGE-CANCELLED
 15374*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15375*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15376*           (NOT PB-CI-OB)
 15377*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15378*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15379*                   MOVE ER-2732  TO WS-ERROR
 15380*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15381
 15382     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15383         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15384            (NOT PB-COMP-LF-CANCEL)
 15385             NEXT SENTENCE
 15386         ELSE
 15387           IF PB-C-LF-CANCEL-VOIDED
 15388              NEXT SENTENCE
 15389           ELSE
 15390              MOVE ER-2753      TO WS-ERROR
 15391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15392
 15393     IF CANCEL-FUTURE-DT
 15394         GO TO 3999-END-EDIT.
 15395
 15396 3715-GET-REMAIN-TERM-LF.
 15397
 15398     IF NO-LF-BENEFIT-MATCH  OR
 15399        WS-LF-BENEFIT-CD = ZEROS
 15400        GO TO 3730-GET-AH-REMAIN-TERM.
 15401
 15402     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15403     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15404     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15405     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15406     MOVE PB-SV-STATE            TO CP-STATE.
 15407     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15408     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15409     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15410     MOVE '2'                    TO CP-PROCESS-TYPE.
 15411     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15412     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15413     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15414     IF (PB-COMPANY-ID = 'CID')
 15415        AND (CP-STATE-STD-ABBRV = 'WI')
 15416        MOVE '7'                 TO CP-REM-TERM-METHOD
 15417        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15418     ELSE
 15419        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15420        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 279
* EL050.cbl
 15421                                 TO CP-REM-TRM-CALC-OPTION
 15422     END-IF
 15423**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15424     IF (PB-COMPANY-ID = 'CID')
 15425        AND (CP-STATE-STD-ABBRV = 'MO')
 15426        AND (PB-CERT-EFF-DT >= X'9B41')
 15427        AND (PB-CERT-EFF-DT <= X'A2FB')
 15428        MOVE '7'                 TO CP-REM-TERM-METHOD
 15429        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15430     END-IF
 15431     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15432                                    CP-LOAN-TERM.
 15433     IF CP-TRUNCATED-LIFE
 15434        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15435
 15436     IF CP-TERM-IS-DAYS
 15437         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15438     ELSE
 15439         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15440
 15441     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15442
 15443     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15444
 15445     IF LF-COVERAGE-CANCELLED
 15446        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15447        NEXT SENTENCE
 15448      ELSE
 15449          GO TO 3730-GET-AH-REMAIN-TERM.
 15450
 15451 3720-GET-LF-REFUND.
 15452
 15453     IF PB-C-LF-CANCEL-VOIDED OR
 15454        PB-C-AH-CANCEL-VOIDED
 15455        GO TO 3780-UPDATE-CANCEL-CERT.
 15456
 15457     IF PB-COMPANY-ID EQUAL 'BOA'
 15458         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15459         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15460         GO TO 3730-GET-AH-REMAIN-TERM.
 15461
 15462     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15463        (WS-AH-SPECIAL-CALC-CD = 'M')
 15464         MOVE ER-2767            TO WS-ERROR
 15465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15466         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15467         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15468         GO TO 3780-UPDATE-CANCEL-CERT.
 15469
 15470     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15471
 15472     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15473     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15474     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15475     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15476     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15477     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15478     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 280
* EL050.cbl
 15479        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15480        IF PDEF-MASTER-FOUND
 15481           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15482              (V1 > +8)
 15483              OR (PD-PROD-CODE (V1) = 'L')
 15484           END-PERFORM
 15485           IF V1 < +9
 15486              MOVE PD-MAX-AMT (V1)
 15487                           TO CP-R-MAX-TOT-BEN
 15488                              EC-AM-LF-MAX-TOT-BEN
 15489           END-IF
 15490        ELSE
 15491        MOVE ' '                 TO PDEF-MASTER-SW
 15492        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15493        MOVE PB-STATE            TO ERPDEF-STATE
 15494        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15495        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15496        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15497        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15498        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15499        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15500        IF PDEF-MASTER-FOUND
 15501           MOVE 'N'              TO PDEF-MASTER-SW
 15502           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15503           IF PDEF-MASTER-FOUND
 15504              IF (ERPDEF-KEY-SAVE (1:16) =
 15505                           PD-CONTROL-PRIMARY (1:16))
 15506                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15507                 CONTINUE
 15508              ELSE
 15509                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15510                 IF (ERPDEF-KEY-SAVE (1:16) =
 15511                           PD-CONTROL-PRIMARY (1:16))
 15512                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15513                    CONTINUE
 15514                 ELSE
 15515                    MOVE 'N'     TO PDEF-MASTER-SW
 15516                 END-IF
 15517              END-IF
 15518              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15519
 15520              IF PDEF-MASTER-FOUND
 15521                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15522                    (V1 > +8)
 15523                    OR (PD-PROD-CODE (V1) = 'L')
 15524                 END-PERFORM
 15525                 IF V1 < +9
 15526                    MOVE PD-MAX-AMT (V1)
 15527                                 TO CP-R-MAX-TOT-BEN
 15528                                    EC-AM-LF-MAX-TOT-BEN
 15529                 END-IF
 15530              END-IF
 15531           END-IF
 15532           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15533        END-IF
 15534        END-IF
 15535     END-IF
 15536     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 281
* EL050.cbl
 15537
 15538     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15539
 15540     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15541                                    PB-C-LF-REM-TERM.
 15542
 15543     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15544     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15545
 15546     IF PB-COMPANY-ID EQUAL 'FLC'
 15547        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15548           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15549           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15550                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15551                    - CM-LF-ITD-DEATH-AMT
 15552           IF PB-C-LF-REF-CALC LESS THAN +0
 15553              MOVE +0            TO PB-C-LF-REF-CALC
 15554              GO TO 3730-GET-AH-REMAIN-TERM
 15555           ELSE
 15556              GO TO 3730-GET-AH-REMAIN-TERM.
 15557
 15558     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15559                            OR '4' OR '5' OR '6' OR '8'
 15560                            OR '9' OR 'G'
 15561        MOVE PB-C-LF-REFUND-OVERRIDE
 15562                                 TO CP-EARNING-METHOD.
 15563
 15564     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15565     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15566     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15567                                    CP-RATING-BENEFIT-AMT.
 15568     IF CP-STATE-STD-ABBRV = 'OR'
 15569         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15570                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15571     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15572     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15573     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15574     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15575     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15576     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15577     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15578     IF WS-DEFAULT-APR NOT NUMERIC
 15579         MOVE ZEROS TO WS-DEFAULT-APR.
 15580****   N O T E   ****
 15581*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15582*      THE OH HARD CODING IN ELCRFNDP
 15583
 15584     IF PB-COMPANY-ID = 'CID'
 15585        IF CP-STATE-STD-ABBRV = 'OH'
 15586           MOVE WS-LF-EARNINGS-CALC
 15587                                 TO CP-EARNING-METHOD
 15588        END-IF
 15589     END-IF
 15590
 15591****   N O T E   ****
 15592
 15593     IF CP-EARN-AS-NET-PAY
 15594         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 282
* EL050.cbl
 15595            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15596                MOVE WS-DEFAULT-APR
 15597                                 TO  CP-LOAN-APR
 15598                MOVE ER-3780     TO  WS-ERROR
 15599                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15600            ELSE
 15601                MOVE ER-3781     TO  WS-ERROR
 15602                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15603     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15604     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15605
 15606     IF CP-REFUND-TYPE-USED NOT = SPACE
 15607         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15608
 15609     IF CP-ERROR-RATE-IS-ZERO OR
 15610        CP-ERROR-RATE-NOT-FOUND
 15611        MOVE ER-2740             TO WS-ERROR
 15612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15613
 15614     IF CP-ERROR-RATE-FILE-NOTOPEN
 15615        MOVE ER-2617             TO WS-ERROR
 15616        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15617
 15618     IF PB-COMPANY-ID = 'DCC'
 15619        AND PB-CI-ENTRY-STATUS = 'M'
 15620        MOVE +0                  TO PB-C-LF-REF-CALC
 15621     ELSE
 15622        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15623     END-IF
 15624
 15625     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15626         GO TO 3730-GET-AH-REMAIN-TERM.
 15627
 15628*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15629*       ADD +1                   TO PB-C-LF-REM-TERM
 15630*                                   CP-REMAINING-TERM
 15631*                                   CP-ORIGINAL-TERM.
 15632
 15633     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15634     MOVE '2'                    TO CP-EARNING-METHOD
 15635                                    CP-RATING-METHOD.
 15636     IF PB-COMPANY-ID = 'CID'
 15637        IF (CP-STATE-STD-ABBRV = 'MN')
 15638           AND (PB-CERT-EFF-DT > X'A4FF')
 15639           AND (WS-LF-EARNINGS-CALC = 'B')
 15640           MOVE '5'              TO CP-EARNING-METHOD
 15641           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15642        END-IF
 15643     END-IF
 15644     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15645                                        CP-REMAINING-BENEFIT
 15646                                        CP-RATING-BENEFIT-AMT.
 15647     IF CP-STATE-STD-ABBRV = 'OR'
 15648         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15649                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15650     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15651     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15652
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 283
* EL050.cbl
 15653     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15654
 15655     IF CP-ERROR-RATE-IS-ZERO OR
 15656        CP-ERROR-RATE-NOT-FOUND
 15657        MOVE ER-2740             TO WS-ERROR
 15658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15659
 15660     IF CP-ERROR-RATE-FILE-NOTOPEN
 15661        MOVE ER-2617             TO WS-ERROR
 15662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15663
 15664     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15665
 15666******************************************************************
 15667
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 284
* EL050.cbl
 15669 3730-GET-AH-REMAIN-TERM.
 15670     IF NO-AH-BENEFIT-MATCH  OR
 15671        WS-AH-BENEFIT-CD = ZEROS
 15672         GO TO 3770-CHECK-REFUNDS.
 15673
 15674     IF PB-CI-AH-LUMP-SUM-DISAB
 15675         IF  PB-C-AH-CANCEL-AMT = ZERO
 15676            IF NOT PB-COMP-AH-CANCEL
 15677             GO TO 3770-CHECK-REFUNDS.
 15678
 15679     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15680     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15681     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15682     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15683     MOVE PB-SV-STATE            TO CP-STATE.
 15684     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15685     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15686     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15687     MOVE '2'                    TO CP-PROCESS-TYPE.
 15688     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15689     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15690     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15691     IF (PB-COMPANY-ID = 'CID')
 15692        AND (CP-STATE-STD-ABBRV = 'WI')
 15693        MOVE '7'                 TO CP-REM-TERM-METHOD
 15694        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15695     ELSE
 15696        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15697        MOVE WS-REM-TRM-CALC-OPTION
 15698                                 TO CP-REM-TRM-CALC-OPTION
 15699     END-IF
 15700     IF (PB-COMPANY-ID = 'CID')
 15701        AND (CP-STATE-STD-ABBRV = 'MO')
 15702        AND (PB-CERT-EFF-DT >= X'9B41')
 15703        AND (PB-CERT-EFF-DT <= X'A2FB')
 15704        MOVE '7'                 TO CP-REM-TERM-METHOD
 15705        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15706     END-IF
 15707     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15708                                    CP-LOAN-TERM.
 15709     IF NOT CP-TERM-IS-DAYS
 15710         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15711
 15712     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15713
 15714     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15715
 15716     IF AH-COVERAGE-CANCELLED
 15717        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15718        NEXT SENTENCE
 15719      ELSE
 15720         GO TO 3770-CHECK-REFUNDS.
 15721
 15722 3740-GET-AH-REFUND.
 15723
 15724     IF PB-C-LF-CANCEL-VOIDED OR
 15725        PB-C-AH-CANCEL-VOIDED
 15726        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 285
* EL050.cbl
 15727
 15728     IF PB-COMPANY-ID = 'BOA'
 15729         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15730         GO TO 3770-CHECK-REFUNDS.
 15731
 15732     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15733*    MOVE ' '                    TO DC-OPTION-CODE
 15734     SET BIN-TO-GREG             TO TRUE
 15735     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15736     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15737                                    PB-C-AH-REM-TERM.
 15738     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15739     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15740
 15741     IF PB-COMPANY-ID EQUAL 'FLC'
 15742        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15743           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15744           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15745                    - CM-AH-ITD-AH-PMT)
 15746           IF PB-C-AH-REF-CALC LESS THAN +0
 15747              MOVE +0            TO PB-C-AH-REF-CALC
 15748              GO TO 3770-CHECK-REFUNDS
 15749           ELSE
 15750              GO TO 3770-CHECK-REFUNDS.
 15751
 15752     IF PB-COMPANY-ID = 'DCC'
 15753        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15754            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15755           MOVE 'S'              TO CP-EARNING-METHOD
 15756        END-IF
 15757     END-IF
 15758     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15759                            OR '4' OR '5' OR '6' OR '8'
 15760                            OR '9' OR 'G' OR 'S'
 15761        MOVE PB-C-AH-REFUND-OVERRIDE
 15762                                 TO CP-EARNING-METHOD.
 15763
 15764     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15765     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15766     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15767                                    CP-RATING-BENEFIT-AMT.
 15768     IF CP-STATE-STD-ABBRV = 'OR'
 15769         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15770                                         PB-CI-AH-TERM.
 15771     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15772     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15773     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15774     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15775     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15776     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15777
 15778     IF CP-STATE-STD-ABBRV = 'OH'
 15779        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15780                                AND 'CID' AND 'DCC' AND 'AHL')
 15781           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15782              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15783              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15784              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 286
* EL050.cbl
 15785           END-IF
 15786        END-IF
 15787        IF PB-COMPANY-ID = 'CID'
 15788           IF NO-LIFE-COVERAGE
 15789              IF CP-CRITICAL-PERIOD
 15790                 MOVE '2'       TO CP-EARNING-METHOD
 15791              ELSE
 15792                 MOVE '6'       TO CP-EARNING-METHOD
 15793              END-IF
 15794           ELSE
 15795              IF WS-LF-COVERAGE-TYPE = 'L'
 15796                 MOVE '2'       TO CP-EARNING-METHOD
 15797              ELSE
 15798                 IF (PB-CI-LF-TERM > +60) OR
 15799                    (WS-LF-EARNINGS-CALC = '5')
 15800                    IF CP-CRITICAL-PERIOD
 15801                       MOVE '2'  TO CP-EARNING-METHOD
 15802                    ELSE
 15803                       MOVE '6'  TO CP-EARNING-METHOD
 15804                    END-IF
 15805                 ELSE
 15806                    MOVE '1'     TO CP-EARNING-METHOD
 15807                 END-IF
 15808              END-IF
 15809           END-IF
 15810        END-IF
 15811     END-IF
 15812
 15813*    IF CP-STATE-STD-ABBRV = 'VA'
 15814*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15815*          IF CP-ORIGINAL-TERM GREATER 61
 15816*             MOVE '6' TO CP-EARNING-METHOD
 15817*          ELSE
 15818*             MOVE '1' TO CP-EARNING-METHOD.
 15819
 15820     IF WS-DEFAULT-APR NOT NUMERIC
 15821         MOVE ZEROS TO WS-DEFAULT-APR.
 15822     IF CP-EARN-AS-NET-PAY
 15823         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15824            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15825                MOVE WS-DEFAULT-APR
 15826                                 TO  CP-LOAN-APR
 15827                MOVE ER-3780     TO  WS-ERROR
 15828                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15829            ELSE
 15830                MOVE ER-3781     TO  WS-ERROR
 15831                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15832     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15833     IF PB-COMPANY-ID = 'DCC'
 15834        AND CP-CANCEL-REASON = 'R'
 15835        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15836        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15837     END-IF
 15838     IF PB-COMPANY-ID = 'DCC'
 15839        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15840        AND (CP-EARNING-METHOD = 'D')
 15841        AND (CP-CANCEL-REASON NOT = 'R')
 15842        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 287
* EL050.cbl
 15843     ELSE
 15844        GO TO 3750-CONTINUE
 15845     END-IF
 15846     MOVE ' '                    TO DD-IU-SW
 15847     IF NOT PDEF-MASTER-FOUND
 15848        MOVE ' '                 TO PDEF-MASTER-SW
 15849        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15850        MOVE PB-STATE            TO ERPDEF-STATE
 15851        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15852        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15853        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15854        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15855        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15856        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15857        IF PDEF-MASTER-FOUND
 15858           MOVE 'N'              TO PDEF-MASTER-SW
 15859           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15860           IF PDEF-MASTER-FOUND
 15861              IF (ERPDEF-KEY-SAVE (1:16) =
 15862                           PD-CONTROL-PRIMARY (1:16))
 15863                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15864                 CONTINUE
 15865              ELSE
 15866                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15867                 IF (ERPDEF-KEY-SAVE (1:16) =
 15868                           PD-CONTROL-PRIMARY (1:16))
 15869                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15870                    CONTINUE
 15871                 ELSE
 15872                    MOVE ER-2740 TO WS-ERROR
 15873                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15874                    GO TO 3770-CHECK-REFUNDS
 15875                 END-IF
 15876              END-IF
 15877           END-IF
 15878           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15879        END-IF
 15880     END-IF
 15881     IF PDEF-MASTER-FOUND
 15882        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15883           (V1 > +8)
 15884           OR (PD-PROD-CODE (V1) = 'I')
 15885        END-PERFORM
 15886        IF V1 < +9
 15887           SET DD-IU-PRESENT        TO TRUE
 15888        END-IF
 15889        IF WS-AH-DCC-TRUNC = 'T'
 15890           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 15891        ELSE
 15892           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 15893        END-IF
 15894        EVALUATE TRUE
 15895           WHEN WS-TERM > +168
 15896              MOVE 15               TO V1
 15897           WHEN WS-TERM > +156
 15898              MOVE 14               TO V1
 15899           WHEN WS-TERM > +144
 15900              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 288
* EL050.cbl
 15901           WHEN WS-TERM > +132
 15902              MOVE 12               TO V1
 15903           WHEN WS-TERM > +120
 15904              MOVE 11               TO V1
 15905           WHEN WS-TERM > +108
 15906              MOVE 10               TO V1
 15907           WHEN WS-TERM > +96
 15908              MOVE 9                TO V1
 15909           WHEN WS-TERM > +84
 15910              MOVE 8                TO V1
 15911           WHEN WS-TERM > +72
 15912              MOVE 7                TO V1
 15913           WHEN WS-TERM > +60
 15914              MOVE 6                TO V1
 15915           WHEN WS-TERM > +48
 15916              MOVE 5                TO V1
 15917           WHEN WS-TERM > +36
 15918              MOVE 4                TO V1
 15919           WHEN WS-TERM > +24
 15920              MOVE 3                TO V1
 15921           WHEN WS-TERM > +12
 15922              MOVE 2                TO V1
 15923           WHEN OTHER
 15924              MOVE 1                TO V1
 15925        END-EVALUATE
 15926
 15927        EVALUATE TRUE
 15928*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15929*             < +13)
 15930*             AND (DD-IU-PRESENT)
 15931*             MOVE 2                TO V2
 15932*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15933*             MOVE 1                TO V2
 15934           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15935              MOVE 2                TO V2
 15936           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15937              MOVE 3                TO V2
 15938           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15939              MOVE 4                TO V2
 15940           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15941              MOVE 5                TO V2
 15942           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15943              MOVE 6                TO V2
 15944           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15945              MOVE 7                TO V2
 15946           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15947              MOVE 8                TO V2
 15948           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 15949              MOVE 9                TO V2
 15950           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 15951              MOVE 10               TO V2
 15952           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 15953              MOVE 11               TO V2
 15954           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 15955              MOVE 12               TO V2
 15956           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 15957              MOVE 13               TO V2
 15958           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 289
* EL050.cbl
 15959              MOVE 14               TO V2
 15960           WHEN OTHER
 15961              MOVE 15               TO V2
 15962        END-EVALUATE
 15963
 15964        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15965                                 TO CP-DDF-LO-FACT
 15966        MOVE PD-UEP-FACTOR (V1 V2)
 15967                                 TO CP-DDF-HI-FACT
 15968
 15969        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15970        MOVE CM-AH-CLP     TO CP-DDF-CLP
 15971        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 15972           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15973        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15974        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15975        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15976           + PD-1ST-YR-ADMIN-ALLOW
 15977
 15978        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15979*       IF PI-CLP-YN = 'Y'
 15980*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 15981*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 15982*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 15983*       END-IF
 15984
 15985        IF DD-IU-PRESENT
 15986           MOVE 'I'              TO CP-EARNING-METHOD
 15987        END-IF
 15988        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15989                                     CP-CLP-RATE-UP
 15990        IF CP-IU-RATE-UP NOT = ZEROS
 15991           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 15992              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 15993           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 15994              / (1 - WS-WORK-FACT)
 15995        END-IF
 15996     END-IF
 15997     .
 15998 3750-CONTINUE.
 15999     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16000
 16001     IF CP-REFUND-TYPE-USED NOT = SPACE
 16002         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16003
 16004     IF CP-ERROR-RATE-IS-ZERO OR
 16005        CP-ERROR-RATE-NOT-FOUND
 16006        MOVE ER-2740             TO WS-ERROR
 16007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16008
 16009     IF CP-ERROR-RATE-FILE-NOTOPEN
 16010        MOVE ER-2617             TO WS-ERROR
 16011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16012     IF PB-COMPANY-ID = 'DCC'
 16013        AND PB-CI-ENTRY-STATUS = 'M'
 16014        MOVE +0                  TO PB-C-AH-REF-CALC
 16015     ELSE
 16016        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 290
* EL050.cbl
 16017     END-IF
 16018     IF PB-COMPANY-ID = 'DCC'
 16019        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16020        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16021        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16022        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16023        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16024        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16025        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16026        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16027        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16028     END-IF
 16029     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 291
* EL050.cbl
 16031
 16032 3770-CHECK-REFUNDS.
 16033
 16034     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16035        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16036           MOVE ER-2766          TO WS-ERROR
 16037           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16038           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16039           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16040              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16041
 16042     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16043        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16044           MOVE ER-2766          TO WS-ERROR
 16045           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16046           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16047           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16048              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16049
 16050     IF PB-COMP-LF-CANCEL
 16051        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16052        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16053           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16054              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16055
 16056     IF PB-COMP-AH-CANCEL
 16057        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16058        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16059           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16060              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16061
 16062     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16063             GIVING WS-UNSIGN-WRK1
 16064     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16065             GIVING WS-UNSIGN-WRK2.
 16066
 16067     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16068         MOVE ZERO TO WS-UNSIGN-WRK1.
 16069
 16070     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16071         MOVE ZERO TO WS-UNSIGN-WRK2.
 16072
 16073     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16074
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 292
* EL050.cbl
 16076
 16077 3772-CONTINUE.
 16078
 16079**********************************
 16080*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16081*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16082*** DOUBLES THE TOLERANCE AMOUNT.
 16083***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16084**********************************
 16085     IF PB-COMPANY-ID = 'MON'
 16086     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16087         IF WS-REF-REJECT-SW = SPACE
 16088             MOVE ER-2754        TO WS-ERROR
 16089             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16090           ELSE
 16091             MOVE ER-2736        TO WS-ERROR
 16092             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16093**********************************
 16094
 16095 3773-CONTINUE.
 16096
 16097     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16098        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16099           MOVE ER-2723          TO WS-ERROR
 16100           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16101
 16102     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16103        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16104           MOVE ER-2724          TO WS-ERROR
 16105           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16106
 16107     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16108         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16109             (1 + WS-LF-REFUND-OVS-PCT)
 16110     ELSE
 16111         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16112
 16113     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16114         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16115             (1 - WS-TOL-LF-REFUND-PCT)
 16116     ELSE
 16117         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16118
 16119     IF (PB-COMPANY-ID = 'DCC')
 16120        AND (PB-CI-ENTRY-STATUS = 'M')
 16121        AND (PB-C-LF-CANCEL-AMT > +0)
 16122        MOVE ER-3843             TO WS-ERROR
 16123        PERFORM 9900-ERROR-FORMAT
 16124                                 THRU 9900-EXIT
 16125     END-IF
 16126     EVALUATE TRUE
 16127        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16128           CONTINUE
 16129        WHEN PB-C-LF-CANCEL-AMT = +0
 16130                 AND PB-C-LF-REF-CALC > +0
 16131           CONTINUE
 16132        WHEN WS-LF-REFUND-OVS-AMT = 0
 16133                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 293
* EL050.cbl
 16134           CONTINUE
 16135        WHEN OTHER
 16136           IF WS-TOL-LF-REFUND  = +0
 16137              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16138           END-IF
 16139           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16140                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16141                          (PB-C-LF-CANCEL-AMT))
 16142              CONTINUE
 16143           ELSE
 16144              IF WS-LF-REFUND-OVS-AMT = +0
 16145                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16146              END-IF
 16147              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16148                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16149                                       PB-C-LF-CANCEL-AMT)
 16150                 CONTINUE
 16151              ELSE
 16152                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16153                   MOVE ER-2754   TO  WS-ERROR
 16154                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16155                 ELSE
 16156                    MOVE ER-2736   TO  WS-ERROR
 16157                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16158                 END-IF
 16159              END-IF
 16160           END-IF
 16161     END-EVALUATE.
 16162
 16163     EVALUATE TRUE
 16164        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16165           CONTINUE
 16166        WHEN PB-C-LF-CANCEL-AMT = +0
 16167                 AND PB-C-LF-REF-CALC > +0
 16168           CONTINUE
 16169        WHEN OTHER
 16170           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16171               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16172              CONTINUE
 16173           ELSE
 16174              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16175               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16176                CONTINUE
 16177              ELSE
 16178                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16179                     MOVE ER-2754   TO  WS-ERROR
 16180                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16181                 ELSE
 16182                     MOVE ER-2736   TO  WS-ERROR
 16183                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16184                 END-IF
 16185              END-IF
 16186           END-IF
 16187     END-EVALUATE.
 16188
 16189     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16190         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16191             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 294
* EL050.cbl
 16192     ELSE
 16193         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16194
 16195     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16196         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16197             (1 - WS-TOL-AH-REFUND-PCT)
 16198     ELSE
 16199         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16200
 16201     IF (PB-COMPANY-ID = 'DCC')
 16202        AND (PB-CI-ENTRY-STATUS = 'M')
 16203        AND (PB-C-AH-CANCEL-AMT > +0)
 16204        MOVE ER-3843             TO WS-ERROR
 16205        PERFORM 9900-ERROR-FORMAT
 16206                                 THRU 9900-EXIT
 16207     END-IF
 16208     EVALUATE TRUE
 16209        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16210           CONTINUE
 16211*       WHEN PB-C-AH-REF-CALC = +0 AND
 16212*                  PB-C-AH-CANCEL-AMT > +0
 16213        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16214                   PB-C-AH-REF-CALC > +0
 16215           CONTINUE
 16216        WHEN WS-AH-REFUND-OVS-AMT = +0
 16217                AND WS-TOL-AH-REFUND = +0
 16218           CONTINUE
 16219        WHEN OTHER
 16220           IF WS-TOL-AH-REFUND = +0
 16221              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16222           END-IF
 16223           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16224               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16225                                         PB-C-AH-CANCEL-AMT)
 16226              CONTINUE
 16227           ELSE
 16228              IF WS-AH-REFUND-OVS-AMT = +0
 16229                 MOVE +9999999.99 TO
 16230                         WS-AH-REFUND-OVS-AMT
 16231              END-IF
 16232              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16233                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16234                                         PB-C-AH-CANCEL-AMT)
 16235                 CONTINUE
 16236              ELSE
 16237                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16238                    MOVE ER-2754   TO  WS-ERROR
 16239                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16240                 ELSE
 16241                    MOVE ER-2736   TO  WS-ERROR
 16242                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16243                 END-IF
 16244              END-IF
 16245           END-IF
 16246     END-EVALUATE.
 16247
 16248     EVALUATE TRUE
 16249        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 295
* EL050.cbl
 16250           CONTINUE
 16251*       WHEN PB-C-AH-REF-CALC > +0 AND
 16252*                  PB-C-AH-CANCEL-AMT = +0
 16253        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16254                   PB-C-AH-REF-CALC = +0
 16255           CONTINUE
 16256        WHEN OTHER
 16257           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16258               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16259              CONTINUE
 16260           ELSE
 16261              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16262                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16263                 CONTINUE
 16264              ELSE
 16265                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16266                     MOVE ER-2754   TO  WS-ERROR
 16267                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16268                 ELSE
 16269                     MOVE ER-2736   TO  WS-ERROR
 16270                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16271                 END-IF
 16272              END-IF
 16273           END-IF
 16274     END-EVALUATE.
 16275
 16276     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16277        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16278        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16279           AND  PB-C-LF-REF-CALC < +1.00
 16280           AND  PB-C-AH-REF-CALC < +1.00
 16281           CONTINUE
 16282        ELSE
 16283           IF (PB-COMPANY-ID = 'DCC')
 16284              AND (PB-CI-ENTRY-STATUS = 'M')
 16285              CONTINUE
 16286           ELSE
 16287              MOVE ER-2741       TO WS-ERROR
 16288              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16289           END-IF
 16290        END-IF
 16291     END-IF
 16292
 16293     IF (PB-C-LF-CANCEL-AMT = ZERO
 16294        AND WS-LF-BENEFIT-CD NOT = ZERO
 16295        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16296        AND PB-C-LF-REF-CALC NOT = ZERO)
 16297        OR
 16298        (PB-C-LF-CANCEL-AMT = ZERO
 16299        AND WS-LF-BENEFIT-CD NOT = ZERO
 16300        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16301             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16302                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16303                NEXT SENTENCE
 16304             ELSE
 16305                MOVE ER-2739        TO WS-ERROR
 16306                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16307
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 296
* EL050.cbl
 16308     IF (PB-C-AH-CANCEL-AMT = ZERO
 16309        AND WS-AH-BENEFIT-CD NOT = ZERO
 16310        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16311        AND PB-C-AH-REF-CALC NOT = ZERO)
 16312        OR
 16313        (PB-C-AH-CANCEL-AMT = ZERO
 16314        AND WS-AH-BENEFIT-CD NOT = ZERO
 16315        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16316             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16317                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16318                NEXT SENTENCE
 16319             ELSE
 16320                MOVE ER-2738        TO WS-ERROR
 16321                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16322
 16323 3775-OVER-REF-CHK.
 16324
 16325     IF PB-CI-ENTRY-STATUS = '5'
 16326        GO TO 3780-UPDATE-CANCEL-CERT.
 16327
 16328     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16329                              PB-CI-LF-ALT-PREMIUM-AMT.
 16330
 16331     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16332        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16333                                 PB-C-LF-REF-CALC
 16334      ELSE
 16335        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16336                                 PB-C-LF-CANCEL-AMT.
 16337
 16338     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16339        MOVE ER-2755             TO WS-ERROR
 16340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16341
 16342     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16343
 16344     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16345        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16346                                 PB-C-AH-REF-CALC
 16347      ELSE
 16348        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16349                                 PB-C-AH-CANCEL-AMT.
 16350
 16351     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16352        MOVE ER-2778             TO WS-ERROR
 16353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16354
 16355     IF PB-CI-OB-FLAG NOT = 'Z'
 16356        NEXT SENTENCE
 16357       ELSE
 16358         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16359            MOVE ER-2757           TO WS-ERROR
 16360            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16361
 16362 3780-UPDATE-CANCEL-CERT.
 16363
 16364     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16365        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 297
* EL050.cbl
 16366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16367
 16368     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16369         MOVE ER-2729              TO WS-ERROR
 16370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16371
 16372     IF PB-CI-LF-BENEFIT-CD = ZERO
 16373         GO TO 3780-UPDATE-CONT-1.
 16374
 16375     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16376         GO TO 3780-UPDATE-CONT-1.
 16377
 16378     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16379       AND
 16380        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16381       AND
 16382        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16383       AND
 16384        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16385            NEXT SENTENCE
 16386       ELSE
 16387        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16388          AND
 16389***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16390***       AND
 16391           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16392            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16393               MOVE ER-2730      TO WS-ERROR
 16394               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16395               GO TO 3999-END-EDIT
 16396            ELSE
 16397               GO TO 3999-END-EDIT
 16398        ELSE
 16399            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16400               MOVE ER-2765           TO WS-ERROR
 16401               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16402               GO TO 3785-CHECK-NH.
 16403*              GO TO 3999-END-EDIT.
 16404
 16405 3780-UPDATE-CONT-1.
 16406     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16407
 16408     IF PB-CI-AH-BENEFIT-CD = ZERO
 16409         GO TO 3780-UPDATE-CONT-2.
 16410
 16411     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16412         GO TO 3780-UPDATE-CONT-2.
 16413
 16414     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16415
 16416     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16417       AND
 16418        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16419       AND
 16420        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16421       AND
 16422        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16423            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 298
* EL050.cbl
 16424       ELSE
 16425        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16426          AND
 16427***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16428***       AND
 16429           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16430           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16431            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16432               MOVE ER-2773      TO WS-ERROR
 16433               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16434               GO TO 3999-END-EDIT
 16435            ELSE
 16436               GO TO 3999-END-EDIT
 16437            END-IF
 16438           ELSE
 16439             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16440                MOVE ER-2890 TO WS-ERROR
 16441                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16442                GO TO 3999-END-EDIT
 16443             ELSE
 16444                GO TO 3785-CHECK-NH
 16445             END-IF
 16446           END-IF
 16447          ELSE
 16448            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16449              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16450                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16451                   MOVE ER-2890 TO WS-ERROR
 16452                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16453                   GO TO 3999-END-EDIT
 16454                ELSE
 16455                   MOVE ER-2765 TO WS-ERROR
 16456                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16457                   GO TO 3785-CHECK-NH
 16458                END-IF
 16459              ELSE
 16460               MOVE ER-2765      TO WS-ERROR
 16461               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16462               GO TO 3785-CHECK-NH.
 16463*              GO TO 3999-END-EDIT.
 16464
 16465 3780-UPDATE-CONT-2.
 16466
 16467     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16468        AND WS-LF-BENEFIT-CD = ZERO
 16469           MOVE ER-2743           TO WS-ERROR
 16470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16471
 16472     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16473        AND WS-AH-BENEFIT-CD = ZERO
 16474           MOVE ER-2744           TO WS-ERROR
 16475           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16476
 16477     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16478        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16479        AND
 16480        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16481         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 299
* EL050.cbl
 16482           MOVE ER-2746           TO WS-ERROR
 16483           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16484
 16485     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16486       AND
 16487        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16488             MOVE ER-2737        TO WS-ERROR
 16489             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16490
 16491     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16492       AND
 16493        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16494             MOVE ER-2737        TO WS-ERROR
 16495             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16496
 16497     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16498         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16499             OR 'CID' OR 'DCC' OR 'AHL'
 16500             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16501         ELSE
 16502             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16503                 MOVE ER-2768    TO WS-ERROR
 16504                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16505             ELSE
 16506                 MOVE ER-2756    TO WS-ERROR
 16507                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508
 16509     IF CERT-PEND-ISSUE-RETURNED
 16510        MOVE ER-2772             TO WS-ERROR
 16511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16512 3785-CHECK-NH.
 16513     IF PB-STATE NOT = 'NH'
 16514        GO TO 3999-END-EDIT
 16515     END-IF
 16516
 16517     MOVE ER-2796                TO WS-ERROR
 16518     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16519     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16520        OR (CM-NH-INTERFACE-SW = 'Y')
 16521        MOVE ER-2793             TO WS-ERROR
 16522        PERFORM 9900-ERROR-FORMAT
 16523                                 THRU 9900-EXIT
 16524     END-IF
 16525     MOVE +0                     TO WS-PAYMENT-AMT
 16526     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16527        GO TO 3999-END-EDIT
 16528     END-IF
 16529     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16530        GO TO 3999-END-EDIT
 16531     END-IF
 16532     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16533     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16534     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16535        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16536     END-IF
 16537     MOVE '1'                    TO DC-OPTION-CODE
 16538     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16539     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 300
* EL050.cbl
 16540        IF DC-ELAPSED-DAYS < +16
 16541           GO TO 3999-END-EDIT
 16542        END-IF
 16543     END-IF
 16544     MOVE +0                     TO DC-ELAPSED-DAYS
 16545     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16546     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16547     MOVE '1'                    TO DC-OPTION-CODE
 16548     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16549     IF NO-CONVERSION-ERROR
 16550        IF DC-ELAPSED-DAYS > +30
 16551           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16552        ELSE
 16553           GO TO 3999-END-EDIT
 16554        END-IF
 16555     ELSE
 16556        GO TO 3999-END-EDIT
 16557     END-IF
 16558     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16559        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16560           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16561     IF WS-PAYMENT-AMT < 600.00
 16562        GO TO 3999-END-EDIT
 16563     END-IF
 16564     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16565
 16566     IF (ERMAIL-FOUND = ' ')
 16567         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16568         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16569        GO TO 3999-END-EDIT
 16570     END-IF
 16571     MOVE ER-2795                TO WS-ERROR
 16572     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16573
 16574     GO TO 3999-END-EDIT.
 16575******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 301
* EL050.cbl
 16577 3990-FILES-NOT-OPEN.
 16578
 16579     MOVE ER-2617                TO WS-ERROR.
 16580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16581     GO TO 9990-RETURN.
 16582
 16583 3999-END-EDIT.
 16584
 16585     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16586
 16587     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16588         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16589         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16590             PERFORM 9250-UNLOCK-RETURN
 16591             GO TO 9990-RETURN
 16592          ELSE
 16593             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16594             GO TO 9990-RETURN.
 16595
 16596     IF PB-CANCELLATION
 16597          GO TO 9990-RETURN.
 16598
 16599     IF CERT-WAS-NOT-FOUND
 16600        MOVE SPACES              TO CERTIFICATE-MASTER.
 16601
 16602     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16603
 16604     IF CERT-WAS-FOUND
 16605         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16606             PERFORM 9250-UNLOCK-RETURN
 16607          ELSE
 16608            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16609      ELSE
 16610         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16611
 16612     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16613        IF PB-COMPANY-ID = 'DCC' AND
 16614           (PB-CARRIER = '2' OR '4' OR '6')
 16615              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16616        END-IF
 16617     END-IF.
 16618
 16619     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16620     IF ((PB-COMPANY-ID = 'DCC')
 16621        AND (WS-NO-SECURE-PAY))
 16622                  OR
 16623        (WS-LF-SPECIAL-CALC-CD = 'O'
 16624        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16625        SET SKIP-ADDR-EDIT       TO TRUE
 16626     END-IF
 16627     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16628        AND (NOT SKIP-ADDR-EDIT)
 16629        MOVE ER-2963             TO WS-ERROR
 16630        PERFORM 9900-ERROR-FORMAT
 16631                                 THRU 9900-EXIT
 16632        GO TO 9990-RETURN
 16633     END-IF
 16634     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 302
* EL050.cbl
 16635     IF ERPNDM-FOUND NOT = 'X'
 16636        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16637           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16638           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16639           AND (NOT SKIP-ADDR-EDIT)
 16640           MOVE ER-2694          TO WS-ERROR
 16641           PERFORM 9900-ERROR-FORMAT
 16642                                 THRU 9900-EXIT
 16643        END-IF
 16644        MOVE ' '                 TO STATE-RECORD-ERROR
 16645        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16646        MOVE PM-STATE            TO CNTL-ACCESS
 16647        MOVE '3'                 TO CNTL-REC-TYPE
 16648        MOVE +0                  TO CNTL-SEQ-NO
 16649        MOVE '0'                 TO RC-SW-2
 16650        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16651        IF (NO-STATE-RECORD)
 16652           OR (CF-RECORD-TYPE NOT = '3')
 16653           OR (PM-STATE NOT = CF-STATE-CODE)
 16654           IF (PM-STATE = SPACES)
 16655              AND (SKIP-ADDR-EDIT)
 16656              CONTINUE
 16657           ELSE
 16658              MOVE ER-2963       TO WS-ERROR
 16659              PERFORM 9900-ERROR-FORMAT
 16660                                 THRU 9900-EXIT
 16661           END-IF
 16662        END-IF
 16663        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16664           MOVE ER-2883          TO WS-ERROR
 16665           PERFORM 9900-ERROR-FORMAT
 16666                                 THRU 9900-EXIT
 16667        END-IF
 16668        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16669           MOVE ' '                 TO STATE-RECORD-ERROR
 16670           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16671           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16672           MOVE '3'                 TO CNTL-REC-TYPE
 16673           MOVE +0                  TO CNTL-SEQ-NO
 16674           MOVE '0'                 TO RC-SW-2
 16675           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16676           IF NO-STATE-RECORD
 16677              OR (CF-RECORD-TYPE NOT = '3')
 16678              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16679              MOVE ER-2964          TO WS-ERROR
 16680              PERFORM 9900-ERROR-FORMAT
 16681                                    THRU 9900-EXIT
 16682           END-IF
 16683        END-IF
 16684     ELSE
 16685        IF NOT SKIP-ADDR-EDIT
 16686           MOVE ER-2393          TO WS-ERROR
 16687           PERFORM 9900-ERROR-FORMAT
 16688                                 THRU 9900-EXIT
 16689        END-IF
 16690     END-IF
 16691
 16692     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 303
* EL050.cbl
 16693
 16694     IF (ERMAIL-FOUND = ' ' AND
 16695        ERPNDM-FOUND = ' ')
 16696        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16697           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16698           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16699          OR
 16700           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16701          OR
 16702           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16703           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16704           GO TO 3999-UNLOCK-ERMAIL.
 16705
 16706     IF ERPNDM-FOUND = 'X'
 16707        GO TO 3999-UNLOCK-ERMAIL.
 16708
 16709     IF PM-INSURED-LAST-NAME      = SPACES
 16710        AND PM-INSURED-FIRST-NAME = SPACES
 16711        AND PM-ADDRESS-LINE-1     = SPACES
 16712        AND PM-ADDRESS-LINE-2     = SPACES
 16713        AND PM-CITY-STATE         = SPACES
 16714        AND PM-CRED-BENE-NAME     = SPACES
 16715        AND PM-CRED-BENE-ADDR     = SPACES
 16716        AND PM-CRED-BENE-CTYST    = SPACES
 16717        GO TO 3999-UNLOCK-ERMAIL
 16718     END-IF
 16719
 16720     MOVE SPACES                 TO MAILING-DATA.
 16721
 16722     MOVE 'MA'                   TO MA-RECORD-ID.
 16723     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16724     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16725     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16726     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16727     MOVE PB-SV-STATE            TO MA-STATE.
 16728     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16729     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16730
 16731     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16732     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16733
 16734     IF ERMAIL-FOUND = ' '
 16735        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16736     ELSE
 16737        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16738        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16739        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16740
 16741     GO TO 9990-RETURN.
 16742
 16743 3999-UNLOCK-ERMAIL.
 16744     IF ERMAIL-FOUND = ' '
 16745        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16746
 16747     GO TO 9990-RETURN.
 16748******************************************************************
 16749
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 304
* EL050.cbl
 16751 4000-UPDATE-CANCELLED-CERT.
 16752     IF CERT-WAS-NOT-FOUND
 16753        GO TO 4299-EXIT.
 16754
 16755*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16756     IF PB-C-NH-INT-ON-REFS > ZEROS
 16757        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16758     END-IF
 16759     IF PB-C-REF-INTERFACE-SW = 'Y'
 16760        MOVE PB-C-REF-INTERFACE-SW
 16761                                 TO CM-NH-INTERFACE-SW
 16762     END-IF
 16763     IF PB-C-POST-CARD-IND = 'Y'
 16764        MOVE +8                  TO SUB
 16765        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16766        IF ERMAIL-FOUND = ' '
 16767           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16768              (SUB > +7)
 16769              OR (MA-MAIL-STATUS (SUB) = '1')
 16770           END-PERFORM
 16771        END-IF
 16772        IF (SUB > +7)
 16773           OR (ERMAIL-FOUND = 'X')
 16774           MOVE ER-3789          TO WS-ERROR
 16775           PERFORM 9900-ERROR-FORMAT
 16776                                 THRU 9900-EXIT
 16777        END-IF
 16778     ELSE
 16779        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16780     END-IF
 16781     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16782
 16783     IF PB-CI-OB-FLAG = 'Z'
 16784        GO TO 4150-SUMMARY-CERT-CANCEL.
 16785
 16786     IF PB-C-LF-CANCEL-VOIDED
 16787         PERFORM 4200-REVERSE-LF-CANCEL.
 16788     IF PB-C-AH-CANCEL-VOIDED
 16789         PERFORM 4200-REVERSE-AH-CANCEL.
 16790
 16791 4100-APPLY-LF-CANCEL.
 16792
 16793     MOVE +0                     TO WS-SUB.
 16794
 16795 4100-CHECK-LF-ERRORS.
 16796
 16797     ADD +1                       TO WS-SUB.
 16798
 16799     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16800        IF LF-COVERAGE-CANCELLED
 16801           GO TO 4100-LF-CANCEL-CONT
 16802        ELSE
 16803           GO TO 4100-UPDATE-LF-COVERAGE.
 16804
 16805     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16806                                   ER-2729 OR
 16807                                   ER-2730 OR
 16808                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 305
* EL050.cbl
 16809                                   ER-2732 OR
 16810                                   ER-2737 OR
 16811                                   ER-2740 OR
 16812                                   ER-2743 OR
 16813                                   ER-2749 OR
 16814                                   ER-2750 OR
 16815                                   ER-2755 OR
 16816                                   ER-2757 OR
 16817                                   ER-2760 OR
 16818                                   ER-2772 OR
 16819                                   ER-2774 OR
 16820                                   ER-2776 OR
 16821                                   ER-2794
 16822        GO TO 4100-UPDATE-LF-COVERAGE.
 16823
 16824     GO TO 4100-CHECK-LF-ERRORS.
 16825
 16826 4100-UPDATE-LF-COVERAGE.
 16827
 16828     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16829     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16830     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16831        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16832     END-IF
 16833     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16834                                      TO CM-CREDIT-INTERFACE-SW-2.
 16835     IF CM-LF-CANCEL-DT = LOW-VALUE
 16836         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16837
 16838     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16839         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16840                                         CM-LF-STATUS-AT-CANCEL.
 16841
 16842     GO TO 4100-APPLY-AH-CANCEL.
 16843
 16844 4100-LF-CANCEL-CONT.
 16845     IF PB-C-LF-CANCEL-VOIDED
 16846         GO TO 4100-APPLY-AH-CANCEL.
 16847
 16848     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16849         GO TO 4100-APPLY-AH-CANCEL.
 16850
 16851     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16852        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16853           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16854        ELSE
 16855           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16856
 16857     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16858     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16859
 16860     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16861         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16862
 16863     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16864        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16865         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16866         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 306
* EL050.cbl
 16867
 16868     IF PB-RECORD-RETURNED
 16869        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16870      ELSE
 16871        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16872
 16873 4100-APPLY-AH-CANCEL.
 16874
 16875     MOVE +0                      TO WS-SUB.
 16876
 16877 4100-CHECK-AH-ERRORS.
 16878
 16879     ADD +1                       TO WS-SUB.
 16880
 16881     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16882        IF AH-COVERAGE-CANCELLED
 16883           GO TO 4100-AH-CANCEL-CONT
 16884        ELSE
 16885           GO TO 4100-UPDATE-AH-COVERAGE.
 16886
 16887     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16888                                   ER-2729 OR
 16889                                   ER-2732 OR
 16890                                   ER-2737 OR
 16891                                   ER-2740 OR
 16892                                   ER-2744 OR
 16893                                   ER-2749 OR
 16894                                   ER-2750 OR
 16895                                   ER-2755 OR
 16896                                   ER-2757 OR
 16897                                   ER-2760 OR
 16898                                   ER-2771 OR
 16899                                   ER-2772 OR
 16900                                   ER-2773 OR
 16901                                   ER-2775 OR
 16902                                   ER-2777 OR
 16903                                   ER-2794
 16904        GO TO 4100-UPDATE-AH-COVERAGE.
 16905
 16906     GO TO 4100-CHECK-AH-ERRORS.
 16907
 16908 4100-UPDATE-AH-COVERAGE.
 16909
 16910     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16911     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16912     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16913     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16914                                      TO CM-CREDIT-INTERFACE-SW-2.
 16915     IF CM-AH-CANCEL-DT = LOW-VALUE
 16916         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16917
 16918     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16919         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16920                                         CM-AH-STATUS-AT-CANCEL.
 16921
 16922     IF LF-COVERAGE-CANCELLED
 16923         IF PB-RECORD-RETURNED
 16924              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 307
* EL050.cbl
 16925          ELSE
 16926              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16927
 16928     GO TO 4299-EXIT.
 16929
 16930 4100-AH-CANCEL-CONT.
 16931     IF PB-C-AH-CANCEL-VOIDED
 16932         GO TO 4299-EXIT.
 16933
 16934     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16935         GO TO 4299-EXIT.
 16936
 16937     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16938        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16939           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16940        ELSE
 16941           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16942
 16943     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16944     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16945
 16946     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16947         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16948
 16949     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16950         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16951         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16952
 16953     IF PB-RECORD-RETURNED
 16954        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16955      ELSE
 16956        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16957
 16958     GO TO 4299-EXIT.
 16959
 16960 4150-SUMMARY-CERT-CANCEL.
 16961     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16962
 16963     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16964        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16965                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16966     ELSE
 16967        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16968                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16969
 16970     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16971        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16972                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16973     ELSE
 16974        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16975                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16976
 16977     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16978        NEXT SENTENCE
 16979     ELSE
 16980        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16981
 16982     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 308
* EL050.cbl
 16983
 16984 4200-REVERSE-LF-CANCEL.
 16985     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 16986
 16987     IF CM-LF-CANCEL-APPLIED
 16988        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16989        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16990        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16991
 16992     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16993
 16994     IF PB-RECORD-RETURNED
 16995        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16996       ELSE
 16997        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16998
 16999 4200-REVERSE-LF-EXIT.
 17000       EXIT.
 17001
 17002 4200-REVERSE-AH-CANCEL.
 17003     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17004
 17005     IF CM-AH-CANCEL-APPLIED
 17006        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17007        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17008        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17009
 17010     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17011
 17012     IF PB-RECORD-RETURNED
 17013        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17014       ELSE
 17015        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17016
 17017 4200-REVERSE-AH-EXIT.
 17018       EXIT.
 17019
 17020 4299-EXIT.
 17021       EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 309
* EL050.cbl
 17023
 17024 4500-UPDATE-NEW-CERT.
 17025     IF CERT-WAS-FOUND
 17026         NEXT SENTENCE
 17027       ELSE
 17028         GO TO 4520-BUILD-NEW-KEY.
 17029
 17030     IF  CLASIC-CREATED-CERT
 17031         GO TO 4999-EXIT.
 17032
 17033     IF  CERT-WAS-CREATED-FOR-CLAIM
 17034         GO TO 4520-BUILD-NEW-KEY.
 17035
 17036     IF CERT-ADDED-BATCH
 17037        IF CM-RECORD-ID = 'CM'
 17038            GO TO 4999-EXIT.
 17039
 17040 4520-BUILD-NEW-KEY.
 17041* BUILD CONTROL PRIMARY
 17042
 17043     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17044                                       CM-COMPANY-CD-A1
 17045                                       CM-COMPANY-CD-A2
 17046                                       CM-COMPANY-CD-A4
 17047                                       CM-COMPANY-CD-A5.
 17048
 17049     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17050     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17051     MOVE PB-SV-STATE               TO CM-STATE.
 17052     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17053     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17054     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17055     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17056
 17057     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17058
 17059     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17060     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17061     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17062     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17063
 17064     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17065        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17066
 17067     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17068         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17069         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17070         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17071         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17072     ELSE
 17073         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17074
 17075     IF PB-COMPANY-ID   EQUAL  'CRI'
 17076         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17077         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17078         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17079         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17080         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 310
* EL050.cbl
 17081
 17082     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17083        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17084         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17085
 17086     IF PB-COMPANY-ID  = 'LBL'
 17087        IF PB-I-JOINT-COVERAGE
 17088            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17089                                           PB-I-MEMBER-NO
 17090            GO TO 4550-CONT-CERT-PROCESS.
 17091
 17092     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17093        NEXT SENTENCE
 17094     ELSE
 17095        GO TO 4540-BUILD-MEMBER-NO.
 17096
 17097******************************************************************
 17098*                                                                *
 17099*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17100*    FOR 'MON'.                                                  *
 17101*                                                                *
 17102******************************************************************
 17103
 17104     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17105     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17106     MOVE +1                     TO WS-SUB1
 17107                                    WS-SUB2.
 17108
 17109 4530-EDIT-MEMB-NAME.
 17110
 17111     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17112        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17113        ADD +1                       TO WS-SUB2.
 17114
 17115     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17116        ADD +1                       TO WS-SUB1
 17117        GO TO 4530-EDIT-MEMB-NAME.
 17118
 17119     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17120     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17121     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17122*    MOVE SPACE                      TO DC-OPTION-CODE.
 17123     SET  BIN-TO-GREG                TO TRUE.
 17124     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17125     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17126
 17127     GO TO 4550-CONT-CERT-PROCESS.
 17128
 17129******************************************************************
 17130*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17131******************************************************************
 17132
 17133 4540-BUILD-MEMBER-NO.
 17134
 17135     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17136         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17137         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17138         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 311
* EL050.cbl
 17139         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17140     ELSE
 17141         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17142
 17143     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17144        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17145         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17146
 17147 4550-CONT-CERT-PROCESS.
 17148
 17149*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17150*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17151*    ELSE
 17152*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17153
 17154     IF CERT-WAS-CREATED-FOR-CLAIM
 17155        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17156        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17157
 17158     IF CERT-AND-CLAIM-ONLINE
 17159        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17160        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17161
 17162     MOVE 'CM'                     TO CM-RECORD-ID.
 17163     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17164
 17165     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17166        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17167        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17168     ELSE
 17169        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17170        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17171
 17172     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17173     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17174     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17175     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17176     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17177     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17178     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17179                                      CM-LF-ITD-CANCEL-AMT
 17180                                      CM-LF-ITD-DEATH-AMT
 17181                                      CM-AH-ITD-AH-PMT
 17182                                      CM-AH-ITD-LUMP-PMT
 17183                                      CM-AH-ITD-CANCEL-AMT
 17184                                      CM-LF-NSP-PREMIUM-AMT
 17185                                      CM-AH-NSP-PREMIUM-AMT.
 17186*                                     CM-CLAIM-DEDUCT-WITHHELD
 17187*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17188     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17189     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17190     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17191     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17192     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17193     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17194     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17195     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17196     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 312
* EL050.cbl
 17197     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17198     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17199     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17200
 17201     IF PB-I-LIVES NOT NUMERIC
 17202         MOVE ZERO                 TO PB-I-LIVES.
 17203
 17204     IF PB-I-NUM-BILLED NOT NUMERIC
 17205         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17206
 17207     MOVE PB-I-LIVES               TO CM-LIVES.
 17208     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17209
 17210     IF PB-COMPANY-ID EQUAL  'DMD'
 17211         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17212         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17213
 17214     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17215     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17216     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17217     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17218     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17219     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17220
 17221     IF PB-I-LF-POLICY-FEE NUMERIC
 17222        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17223     ELSE
 17224        MOVE +0                    TO CM-LF-POLICY-FEE.
 17225
 17226     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17227        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17228        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17229     ELSE
 17230        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17231
 17232     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17233     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17234     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17235     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17236     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17237     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17238     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17239     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17240     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17241
 17242     IF PB-I-AH-POLICY-FEE NUMERIC
 17243        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17244     ELSE
 17245        MOVE +0                    TO CM-AH-POLICY-FEE.
 17246
 17247     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17248        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17249     ELSE
 17250        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17251
 17252     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17253     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17254
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 313
* EL050.cbl
 17255     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17256                                      CM-LF-DEATH-EXIT-DT
 17257                                      CM-AH-SETTLEMENT-EXIT-DT.
 17258
 17259*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17260*                       'TIH' OR 'OFL' OR 'FLA' OR
 17261*                       'TII' OR 'TMS' OR 'CRI' OR
 17262*                       'NCL'
 17263     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17264
 17265     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17266         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17267            MOVE '2'                TO CM-PREMIUM-TYPE.
 17268
 17269     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17270         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17271            MOVE '2'                TO CM-PREMIUM-TYPE.
 17272
 17273     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17274         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17275     ELSE
 17276         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17277         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17278
 17279     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17280     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17281     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17282     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17283     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17284     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17285     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17286     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17287
 17288     IF PB-NO-MONTHS-SKIPPED
 17289         MOVE SPACE                 TO CM-SKIP-CODE
 17290     ELSE
 17291         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17292
 17293     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17294     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17295                                       CM-LF-STATUS-AT-CANCEL.
 17296
 17297     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17298     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17299                                       CM-AH-STATUS-AT-CANCEL.
 17300
 17301     MOVE '1'                       TO CM-ENTRY-STATUS.
 17302
 17303     IF PB-REISSUED-CERT
 17304        MOVE '5'                    TO CM-ENTRY-STATUS.
 17305
 17306     IF PB-MONTHLY-CERT
 17307        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17308
 17309     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17310     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17311     IF PB-POLICY-IS-DECLINED
 17312        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 314
* EL050.cbl
 17313
 17314     IF PB-POLICY-IS-VOIDED
 17315        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17316
 17317     IF PB-NEEDS-UNDERWRITING
 17318        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17319
 17320     IF PB-REIN-ONLY-CERT
 17321        MOVE '9'                    TO CM-ENTRY-STATUS.
 17322
 17323     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17324         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17325     ELSE
 17326         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17327
 17328     IF PB-RECORD-RETURNED
 17329        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17330      ELSE
 17331        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17332
 17333     IF PB-I-MAIL-ADDRS-PRESENT
 17334        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17335
 17336     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17337                                       CM-ENTRY-DT.
 17338
 17339 4999-EXIT.
 17340     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 315
* EL050.cbl
 17342
 17343 5000-PROCESS-REPS.
 17344     MOVE ' '                    TO AGTC-MASTER-SW
 17345     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17346     MOVE CO-TYPE                TO AGTC-TYPE
 17347     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17348     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17349     IF (AGTC-MASTER-SW NOT = 'N')
 17350        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17351        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17352        PERFORM 8583-READ-ERAGTC-NEXT
 17353                                 THRU 8583-EXIT
 17354     END-IF
 17355     IF AGTC-MASTER-SW = 'N'
 17356        CONTINUE
 17357     ELSE
 17358        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17359           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17360              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17361              MOVE 'Y'           TO AGTC-MASTER-SW
 17362           END-IF
 17363        END-IF
 17364     END-IF
 17365     .
 17366 5000-EXIT.
 17367     EXIT.
 17368 6370-EDIT-INPUT-LF-CODE.
 17369     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17370        MOVE +1                  TO SUB
 17371        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17372        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17373        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17374        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17375        GO TO 6370-SEARCH-LOOP.
 17376
 17377     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17378
 17379     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17380     MOVE SPACES                 TO CNTL-ACCESS.
 17381*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17382     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17383     MOVE +0                     TO CNTL-SEQ-NO.
 17384     MOVE '4' TO RC-SW-2.
 17385     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17386
 17387     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17388        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17389        GO TO 6370-NO-LF-FOUND.
 17390
 17391     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17392     MOVE +1                     TO SUB.
 17393
 17394 6370-SEARCH-LOOP.
 17395     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17396         GO TO 6370-NO-LF-FOUND.
 17397
 17398     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17399         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 316
* EL050.cbl
 17400         GO TO 6370-HER-NET-PAY-CHECK.
 17401
 17402     ADD 1   TO SUB.
 17403*    IF SUB GREATER 120
 17404     IF SUB GREATER 200
 17405         GO TO 6370-NO-LF-FOUND.
 17406
 17407     GO TO 6370-SEARCH-LOOP.
 17408
 17409 6370-NO-LF-FOUND.
 17410
 17411     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17412
 17413 6370-HER-NET-PAY-CHECK.
 17414
 17415     IF PB-COMPANY-ID = 'CID'
 17416        IF PB-SV-STATE = 'CA' OR 'MN'
 17417           IF PB-I-LF-BENEFIT-CD = '02'
 17418              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17419           ELSE
 17420              IF PB-I-LF-BENEFIT-CD = '04'
 17421                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17422              END-IF
 17423           END-IF
 17424        END-IF
 17425     END-IF
 17426
 17427     IF PB-COMPANY-ID NOT = 'HER'
 17428         GO TO 6370-EXIT.
 17429
 17430     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17431         GO TO 6370-EXIT.
 17432
 17433     IF PB-I-LF-TERM NOT NUMERIC
 17434         MOVE ZEROS              TO PB-I-LF-TERM.
 17435
 17436     IF PB-I-LOAN-TERM NOT NUMERIC
 17437         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17438
 17439     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17440         GO TO 6370-EXIT.
 17441
 17442     IF PB-I-LF-BENEFIT-CD = '33'
 17443         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17444
 17445     IF PB-I-LF-BENEFIT-CD = '34'
 17446         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17447
 17448 6370-EXIT.
 17449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 317
* EL050.cbl
 17451
 17452 6380-EDIT-INPUT-AH-CODE.
 17453     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17454        MOVE +1                  TO SUB
 17455        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17456        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17457        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17458        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17459        GO TO 6380-SEARCH-LOOP.
 17460
 17461     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17462
 17463     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17464     MOVE SPACES                 TO CNTL-ACCESS.
 17465     MOVE 'A'                    TO CNTL-REC-TYPE.
 17466*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17467     MOVE +0                     TO CNTL-SEQ-NO.
 17468     MOVE '5' TO RC-SW-2.
 17469     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17470
 17471     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17472        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17473        GO TO 6380-NO-AH-FOUND.
 17474
 17475     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17476     MOVE +1 TO SUB.
 17477
 17478 6380-SEARCH-LOOP.
 17479     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17480         GO TO 6380-NO-AH-FOUND.
 17481
 17482     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17483         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17484         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17485
 17486     ADD 1   TO SUB.
 17487     IF SUB GREATER THAN 96
 17488*    IF SUB GREATER THAN 300
 17489         GO TO 6380-NO-AH-FOUND.
 17490
 17491     GO TO 6380-SEARCH-LOOP.
 17492
 17493 6380-NO-AH-FOUND.
 17494
 17495     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17496
 17497     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17498         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17499     ELSE
 17500         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17501
 17502 6380-CSO-AH-ONLY-CHECKS.
 17503
 17504     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17505        NEXT SENTENCE
 17506      ELSE
 17507        GO TO 6380-EXIT.
 17508
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 318
* EL050.cbl
 17509     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17510         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17511
 17512
 17513     GO TO 6380-EXIT
 17514     .
 17515 6380-CSO-LIFE-WITH-AH-CHECKS.
 17516
 17517
 17518     .
 17519 6380-EXIT.
 17520     EXIT.
 17521
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 319
* EL050.cbl
 17523
 17524 6400-COMPUTE-EXTENSION-DAYS.
 17525
 17526******************************************************************
 17527*                                                                *
 17528*                   COMPUTE EXTENSION DAYS                       *
 17529*                                                                *
 17530*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17531*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17532*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17533*    THE EXTENSION DAYS.                                         *
 17534*                                                                *
 17535******************************************************************
 17536
 17537     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17538     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17539
 17540******************************************************************
 17541*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17542*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17543******************************************************************
 17544
 17545     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17546        COMPUTE WS-ODD-DAYS-OVER =
 17547               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17548     ELSE
 17549        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17550
 17551     IF WS-ODD-DAYS-OVER = ZEROS
 17552           GO TO 6499-EXIT
 17553     ELSE
 17554        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17555           IF WS-WDF-MONTH = 02
 17556              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17557              ADD 2       TO  WS-ODD-DAYS-OVER
 17558              GO TO 6499-EXIT
 17559           ELSE
 17560              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17561                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17562                 GO TO 6499-EXIT
 17563               ELSE
 17564                 GO TO 6499-EXIT
 17565        ELSE
 17566           GO TO 6499-EXIT.
 17567
 17568 6412-CHECK-TO-DAY.
 17569
 17570        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17571           IF WS-WDT-DAY = 28
 17572              ADD 2              TO WS-ODD-DAYS-OVER
 17573           ELSE
 17574              IF WS-WDT-DAY = 29
 17575                 ADD 1           TO WS-ODD-DAYS-OVER
 17576              ELSE
 17577                 NEXT SENTENCE
 17578        ELSE
 17579           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17580              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 320
* EL050.cbl
 17581
 17582     GO TO 6499-EXIT.
 17583
 17584
 17585 6415-CHECK-LEAP-YEAR.
 17586
 17587     IF DC-DAYS-IN-MONTH = 29
 17588        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17589
 17590 6415-EXIT.
 17591     EXIT.
 17592
 17593 6499-EXIT.
 17594      EXIT.
 17595
 17596 6500-END.
 17597     EXIT.
 17598
 17599
 17600******************************************************************
 17601************* PROCEDURE DIVISION FOR EL050 ***********************
 17602********************** ELC50PD END *******************************
 17603
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 321
* EL050.cbl
 17605
 17606**START***********************************************************
 17607*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17608*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17609******************************************************************
 17610*
 17611 6600-GET-STATE-MUNICIPAL-TAX.
 17612
 17613     IF PB-COMPANY-ID NOT = 'DMD'
 17614         GO TO 6640-EXIT.
 17615
 17616     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17617     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17618     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17619*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17620*
 17621***  Y2K PROJ 7744
 17622     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17623     SET BIN-TO-GREG          TO TRUE.
 17624     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17625
 17626     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17627
 17628     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17629     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17630
 17631
 17632* EXEC CICS HANDLE CONDITION
 17633*        INVREQ    (6610-START-BROWSE)
 17634*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17635*        NOTFND    (6630-END-OF-FILE)
 17636*    END-EXEC.
 17637*    MOVE '"$8JI                 ! # #00017619' TO DFHEIV0
 17638     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17640     MOVE X'2320233030303137363139' TO DFHEIV0(25:11)
 17641     CALL 'kxdfhei1' USING DFHEIV0
 17642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17643
 17644
 17645 6610-START-BROWSE.
 17646
 17647
 17648* EXEC CICS HANDLE CONDITION
 17649*        NOTFND    (6630-END-OF-FILE)
 17650*        DISABLED  (6630-ERRESS-PROBLEM)
 17651*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17652*        ENDFILE   (6630-END-OF-FILE)
 17653*    END-EXEC.
 17654*    MOVE '"$IcJ''                ! $ #00017627' TO DFHEIV0
 17655     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17657     MOVE X'2420233030303137363237' TO DFHEIV0(25:11)
 17658     CALL 'kxdfhei1' USING DFHEIV0
 17659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17660
 17661
 17662
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 322
* EL050.cbl
 17663* EXEC CICS STARTBR
 17664*        DATASET (FILE-ID-ERRESS)
 17665*        RIDFLD  (WS-ERRESS-KEY)
 17666*        GTEQ
 17667*    END-EXEC.
 17668     MOVE 0
 17669       TO DFHEIV11
 17670*    MOVE '&,         G          &   #00017634' TO DFHEIV0
 17671     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17672     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17673     MOVE X'2020233030303137363334' TO DFHEIV0(25:11)
 17674     CALL 'kxdfhei1' USING DFHEIV0,
 17675           FILE-ID-ERRESS,
 17676           WS-ERRESS-KEY,
 17677           DFHEIV99,
 17678           DFHEIV11,
 17679           DFHEIV99
 17680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17681
 17682
 17683 6620-READ-NEXT-ERRESS-MASTER.
 17684
 17685
 17686* EXEC CICS HANDLE CONDITION
 17687*        NOTFND    (6630-END-OF-FILE)
 17688*        ENDFILE   (6630-END-OF-FILE)
 17689*        DISABLED  (6630-ERRESS-PROBLEM)
 17690*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17691*    END-EXEC.
 17692*    MOVE '"$I''cJ                ! % #00017642' TO DFHEIV0
 17693     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17695     MOVE X'2520233030303137363432' TO DFHEIV0(25:11)
 17696     CALL 'kxdfhei1' USING DFHEIV0
 17697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17698
 17699
 17700
 17701* EXEC CICS READNEXT
 17702*        DATASET (FILE-ID-ERRESS)
 17703*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17704*        RIDFLD  (WS-ERRESS-KEY)
 17705*    END-EXEC.
 17706     MOVE LENGTH OF
 17707      RESIDENT-STATE-TAX-MASTER
 17708       TO DFHEIV12
 17709     MOVE 0
 17710       TO DFHEIV11
 17711*    MOVE '&.IL                  )   #00017649' TO DFHEIV0
 17712     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17713     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17714     MOVE X'2020233030303137363439' TO DFHEIV0(25:11)
 17715     CALL 'kxdfhei1' USING DFHEIV0,
 17716           FILE-ID-ERRESS,
 17717           RESIDENT-STATE-TAX-MASTER,
 17718           DFHEIV12,
 17719           WS-ERRESS-KEY,
 17720           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 323
* EL050.cbl
 17721           DFHEIV11,
 17722           DFHEIV99,
 17723           DFHEIV99
 17724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17725
 17726
 17727     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17728
 17729* EXEC CICS ENDBR
 17730*            DATASET (FILE-ID-ERRESS)
 17731*       END-EXEC
 17732     MOVE 0
 17733       TO DFHEIV11
 17734*    MOVE '&2                    $   #00017656' TO DFHEIV0
 17735     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17736     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17737     MOVE X'2020233030303137363536' TO DFHEIV0(25:11)
 17738     CALL 'kxdfhei1' USING DFHEIV0,
 17739           FILE-ID-ERRESS,
 17740           DFHEIV11,
 17741           DFHEIV99
 17742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17743        GO TO 6630-END-OF-FILE.
 17744
 17745     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17746        NEXT SENTENCE
 17747      ELSE
 17748        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17749
 17750*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17751*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17752*
 17753     MOVE +2                     TO WS-SUB1.
 17754
 17755     IF PB-ISSUE
 17756     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17757        MOVE +1                  TO WS-SUB1.
 17758
 17759     IF PB-CANCELLATION
 17760     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17761        MOVE +1                  TO WS-SUB1.
 17762*
 17763*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17764*
 17765***  Y2K PROJ 7744
 17766     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17767***  Y2K PROJ 7744
 17768
 17769*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17770* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17771* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17772
 17773     ADD 1                    TO WS-YEAR-YY.
 17774
 17775     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17776         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17777                              TO WS-RES-STATE-TAX
 17778         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 324
* EL050.cbl
 17779                              TO WS-RES-MUNI-TAX
 17780     ELSE
 17781         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17782                              TO WS-RES-STATE-TAX
 17783         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17784                              TO WS-RES-MUNI-TAX.
 17785
 17786*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17787
 17788     IF PB-CANCELLATION
 17789         GO TO 6640-CANCEL-TAX.
 17790
 17791     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17792         COMPUTE PB-I-STATE-TAX ROUNDED =
 17793                                   PB-I-LF-PREMIUM-AMT
 17794                                 * WS-RES-STATE-TAX
 17795         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17796                                   PB-I-LF-PREMIUM-AMT
 17797                                 * WS-RES-MUNI-TAX
 17798     ELSE
 17799     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17800         COMPUTE PB-I-STATE-TAX ROUNDED =
 17801                                   PB-I-AH-PREMIUM-AMT
 17802                                 * WS-RES-STATE-TAX
 17803         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17804                                   PB-I-AH-PREMIUM-AMT
 17805                                 * WS-RES-MUNI-TAX.
 17806
 17807
 17808* EXEC CICS ENDBR
 17809*         DATASET (FILE-ID-ERRESS)
 17810*    END-EXEC.
 17811     MOVE 0
 17812       TO DFHEIV11
 17813*    MOVE '&2                    $   #00017723' TO DFHEIV0
 17814     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17815     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17816     MOVE X'2020233030303137373233' TO DFHEIV0(25:11)
 17817     CALL 'kxdfhei1' USING DFHEIV0,
 17818           FILE-ID-ERRESS,
 17819           DFHEIV11,
 17820           DFHEIV99
 17821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17822
 17823
 17824     GO TO 6640-EXIT.
 17825
 17826 6640-CANCEL-TAX.
 17827     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17828
 17829     IF PB-C-LF-CANCEL-AMT > ZEROS
 17830         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17831                                   PB-C-LF-CANCEL-AMT
 17832                                 * WS-RES-STATE-TAX
 17833         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17834                                   PB-C-LF-CANCEL-AMT
 17835                                *  WS-RES-MUNI-TAX
 17836     ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 325
* EL050.cbl
 17837     IF PB-C-AH-CANCEL-AMT > ZEROS
 17838         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17839                                   PB-C-AH-CANCEL-AMT
 17840                                 * WS-RES-STATE-TAX
 17841         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17842                                   PB-C-AH-CANCEL-AMT
 17843                                *  WS-RES-MUNI-TAX.
 17844
 17845
 17846* EXEC CICS ENDBR
 17847*         DATASET (FILE-ID-ERRESS)
 17848*    END-EXEC.
 17849     MOVE 0
 17850       TO DFHEIV11
 17851*    MOVE '&2                    $   #00017748' TO DFHEIV0
 17852     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17853     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17854     MOVE X'2020233030303137373438' TO DFHEIV0(25:11)
 17855     CALL 'kxdfhei1' USING DFHEIV0,
 17856           FILE-ID-ERRESS,
 17857           DFHEIV11,
 17858           DFHEIV99
 17859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17860
 17861
 17862     GO TO 6640-EXIT.
 17863
 17864 6630-END-OF-FILE.
 17865     MOVE ER-8002              TO WS-ERROR.
 17866     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17867
 17868     GO TO 6640-EXIT.
 17869
 17870 6630-ERRESS-PROBLEM.
 17871     MOVE ER-8044              TO WS-ERROR.
 17872     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17873
 17874 6640-EXIT.
 17875     EXIT.
 17876
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 326
* EL050.cbl
 17878 6650-GET-RES-STATE-COMM.
 17879
 17880     IF PB-COMPANY-ID NOT = 'DMD'
 17881         GO TO 6700-COMM-EXIT.
 17882
 17883     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17884     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17885     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17886     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17887     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17888     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17889     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17890
 17891*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17892*
 17893***  Y2K PROJ 7744
 17894     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17895     SET BIN-TO-GREG          TO TRUE.
 17896     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17897
 17898     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17899***  Y2K PROJ 7744
 17900
 17901     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17902
 17903
 17904* EXEC CICS HANDLE CONDITION
 17905*        INVREQ    (6660-START-BROWSE)
 17906*        DISABLED  (6690-ERRESC-PROBLEM)
 17907*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17908*        NOTFND    (6690-END-OF-FILE)
 17909*    END-EXEC.
 17910*    MOVE '"$8cJI                ! & #00017793' TO DFHEIV0
 17911     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17913     MOVE X'2620233030303137373933' TO DFHEIV0(25:11)
 17914     CALL 'kxdfhei1' USING DFHEIV0
 17915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17916
 17917
 17918
 17919* EXEC CICS RESETBR
 17920*        DATASET (FILE-ID-ERRESC)
 17921*        RIDFLD  (WS-ERRESC-KEY)
 17922*    END-EXEC.
 17923     MOVE 0
 17924       TO DFHEIV11
 17925*    MOVE '&4         G          &   #00017800' TO DFHEIV0
 17926     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17927     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17928     MOVE X'2020233030303137383030' TO DFHEIV0(25:11)
 17929     CALL 'kxdfhei1' USING DFHEIV0,
 17930           FILE-ID-ERRESC,
 17931           WS-ERRESC-KEY,
 17932           DFHEIV99,
 17933           DFHEIV11,
 17934           DFHEIV99
 17935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 327
* EL050.cbl
 17936
 17937
 17938 6660-START-BROWSE.
 17939
 17940
 17941* EXEC CICS HANDLE CONDITION
 17942*        NOTFND    (6690-END-OF-FILE)
 17943*        DISABLED  (6690-ERRESC-PROBLEM)
 17944*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17945*        ENDFILE   (6690-END-OF-FILE)
 17946*    END-EXEC.
 17947*    MOVE '"$IcJ''                ! '' #00017807' TO DFHEIV0
 17948     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17950     MOVE X'2720233030303137383037' TO DFHEIV0(25:11)
 17951     CALL 'kxdfhei1' USING DFHEIV0
 17952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17953
 17954
 17955
 17956* EXEC CICS STARTBR
 17957*        DATASET (FILE-ID-ERRESC)
 17958*        RIDFLD  (WS-ERRESC-KEY)
 17959*        GTEQ
 17960*    END-EXEC.
 17961     MOVE 0
 17962       TO DFHEIV11
 17963*    MOVE '&,         G          &   #00017814' TO DFHEIV0
 17964     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17965     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17966     MOVE X'2020233030303137383134' TO DFHEIV0(25:11)
 17967     CALL 'kxdfhei1' USING DFHEIV0,
 17968           FILE-ID-ERRESC,
 17969           WS-ERRESC-KEY,
 17970           DFHEIV99,
 17971           DFHEIV11,
 17972           DFHEIV99
 17973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17974
 17975
 17976     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17977
 17978 6670-READ-NEXT-ERRESC-MASTER.
 17979
 17980
 17981* EXEC CICS HANDLE CONDITION
 17982*        NOTFND    (6690-END-OF-FILE)
 17983*        DISABLED  (6690-ERRESC-PROBLEM)
 17984*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17985*        ENDFILE   (6690-END-OF-FILE)
 17986*    END-EXEC.
 17987*    MOVE '"$IcJ''                ! ( #00017824' TO DFHEIV0
 17988     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17990     MOVE X'2820233030303137383234' TO DFHEIV0(25:11)
 17991     CALL 'kxdfhei1' USING DFHEIV0
 17992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17993
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 328
* EL050.cbl
 17994
 17995
 17996* EXEC CICS READNEXT
 17997*        DATASET (FILE-ID-ERRESC)
 17998*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 17999*        RIDFLD  (ERRESC-RECORD-KEY)
 18000*    END-EXEC.
 18001     MOVE LENGTH OF
 18002      ACCOUNT-RESIDENT-ST-COMMISSION
 18003       TO DFHEIV12
 18004     MOVE 0
 18005       TO DFHEIV11
 18006*    MOVE '&.IL                  )   #00017831' TO DFHEIV0
 18007     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18008     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18009     MOVE X'2020233030303137383331' TO DFHEIV0(25:11)
 18010     CALL 'kxdfhei1' USING DFHEIV0,
 18011           FILE-ID-ERRESC,
 18012           ACCOUNT-RESIDENT-ST-COMMISSION,
 18013           DFHEIV12,
 18014           ERRESC-RECORD-KEY,
 18015           DFHEIV99,
 18016           DFHEIV11,
 18017           DFHEIV99,
 18018           DFHEIV99
 18019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18020
 18021
 18022     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18023        NEXT SENTENCE
 18024     ELSE
 18025
 18026* EXEC CICS ENDBR
 18027*            DATASET (FILE-ID-ERRESC)
 18028*       END-EXEC
 18029     MOVE 0
 18030       TO DFHEIV11
 18031*    MOVE '&2                    $   #00017840' TO DFHEIV0
 18032     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18033     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18034     MOVE X'2020233030303137383430' TO DFHEIV0(25:11)
 18035     CALL 'kxdfhei1' USING DFHEIV0,
 18036           FILE-ID-ERRESC,
 18037           DFHEIV11,
 18038           DFHEIV99
 18039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18040        GO TO 6690-END-OF-FILE.
 18041
 18042     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18043
 18044* EXEC CICS ENDBR
 18045*            DATASET (FILE-ID-ERRESC)
 18046*       END-EXEC
 18047     MOVE 0
 18048       TO DFHEIV11
 18049*    MOVE '&2                    $   #00017846' TO DFHEIV0
 18050     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 329
* EL050.cbl
 18052     MOVE X'2020233030303137383436' TO DFHEIV0(25:11)
 18053     CALL 'kxdfhei1' USING DFHEIV0,
 18054           FILE-ID-ERRESC,
 18055           DFHEIV11,
 18056           DFHEIV99
 18057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18058        GO TO 6690-END-OF-FILE.
 18059
 18060     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18061        NEXT SENTENCE
 18062      ELSE
 18063        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18064
 18065* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18066*
 18067     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18068
 18069     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18070
 18071     IF WS-SUB1 > ZERO
 18072         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18073             PERFORM 6680-SET-COMMISSION
 18074         ELSE
 18075             PERFORM 6680-SET-TABLE-CODE.
 18076
 18077
 18078* EXEC CICS ENDBR
 18079*         DATASET (FILE-ID-ERRESC)
 18080*    END-EXEC.
 18081     MOVE 0
 18082       TO DFHEIV11
 18083*    MOVE '&2                    $   #00017868' TO DFHEIV0
 18084     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18085     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18086     MOVE X'2020233030303137383638' TO DFHEIV0(25:11)
 18087     CALL 'kxdfhei1' USING DFHEIV0,
 18088           FILE-ID-ERRESC,
 18089           DFHEIV11,
 18090           DFHEIV99
 18091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18092
 18093
 18094     GO TO 6700-COMM-EXIT.
 18095
 18096 6680-SET-TABLE-CODE.
 18097     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18098        MOVE ZEROS             TO WS-SUB1
 18099     ELSE
 18100* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18101* TO COMPUTE AH COMMISSION.
 18102        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18103        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18104        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18105        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18106        PERFORM 6680-READ-CTBL-TABLE
 18107        IF WS-CTBL-READ-SW NOT = 'Y'
 18108           MOVE ZEROS          TO WS-SUB1.
 18109
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 330
* EL050.cbl
 18110 6680-READ-CTBL-TABLE.
 18111*
 18112* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18113* TO COMPUTE LIFE COMMISSION
 18114
 18115     IF CTBL-SW = '0540'
 18116        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18117        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18118        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18119
 18120     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18121
 18122     IF CTBL-TABLE-FOUND
 18123        IF CTBL-SW = '0530'
 18124             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18125                                    * PB-I-AH-TERM
 18126             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18127             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18128        ELSE
 18129             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18130             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18131             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18132     ELSE
 18133        IF FIRST-TIME-THROUGH
 18134            GO TO 6680-READ-CTBL-TABLE
 18135        ELSE
 18136            MOVE ZEROS         TO WS-SUB1.
 18137
 18138 6680-SET-COMMISSION.
 18139     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18140           MOVE ZEROS          TO WS-SUB1
 18141       ELSE
 18142           MOVE RESC-COMMISSION-PER (WS-SUB)
 18143                               TO WS-COMMISSION
 18144           IF CTBL-SW = '0530'
 18145               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18146           ELSE
 18147               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18148
 18149 6680-SEARCH-CATEGORY.
 18150     ADD +1                   TO WS-SUB.
 18151     IF WS-SUB > +12
 18152         GO TO 6680-EXIT.
 18153
 18154     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18155          MOVE WS-SUB         TO WS-SUB1
 18156          GO TO 6680-EXIT.
 18157
 18158     GO TO 6680-SEARCH-CATEGORY.
 18159
 18160 6680-EXIT.
 18161     EXIT.
 18162
 18163 6690-END-OF-FILE.
 18164     GO TO 6700-COMM-EXIT.
 18165
 18166 6690-ERRESC-PROBLEM.
 18167      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 331
* EL050.cbl
 18168      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18169
 18170      GO TO 6700-COMM-EXIT.
 18171
 18172 6700-COMM-EXIT.
 18173     EXIT.
 18174
 18175 7000-GET-RATE.
 18176
 18177* EXEC CICS LINK
 18178*        PROGRAM    ('ELRATE')
 18179*        COMMAREA   (CALCULATION-PASS-AREA)
 18180*        LENGTH     (CP-COMM-LENGTH)
 18181*    END-EXEC.
 18182     MOVE 'ELRATE' TO DFHEIV1
 18183*    MOVE '."C                   ''   #00017954' TO DFHEIV0
 18184     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18185     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18186     MOVE X'2020233030303137393534' TO DFHEIV0(25:11)
 18187     CALL 'kxdfhei1' USING DFHEIV0,
 18188           DFHEIV1,
 18189           CALCULATION-PASS-AREA,
 18190           CP-COMM-LENGTH,
 18191           DFHEIV99,
 18192           DFHEIV99,
 18193           DFHEIV99
 18194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18195
 18196
 18197 7000-EXIT.
 18198     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 332
* EL050.cbl
 18200 7100-FIND-BENEFIT-IN-STATE.
 18201     MOVE 'N'                    TO BEN-SEARCH-SW.
 18202
 18203     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18204         VARYING SUB3 FROM 1 BY 1 UNTIL
 18205            ((SUB3 GREATER 50) OR
 18206              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18207               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18208
 18209     IF SUB3 NOT = 51
 18210         MOVE 'Y'                TO BEN-SEARCH-SW.
 18211
 18212     GO TO 7199-EXIT.
 18213
 18214 7100-BENEFIT-DUMMY.
 18215
 18216 7100-DUMMY-EXIT.
 18217     EXIT.
 18218
 18219 7199-EXIT.
 18220     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 333
* EL050.cbl
 18222 7200-FIND-BENEFIT.
 18223     MOVE 'N'                    TO BEN-SEARCH-SW.
 18224
 18225     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18226         VARYING SUB3 FROM 1 BY 1 UNTIL
 18227            ((SUB3 GREATER 8) OR
 18228            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18229
 18230     IF SUB3 NOT = 9
 18231         MOVE 'Y'                TO BEN-SEARCH-SW.
 18232
 18233     GO TO 7200-EXIT.
 18234
 18235 7200-BENEFIT-DUMMY.
 18236
 18237 7200-DUMMY-EXIT.
 18238     EXIT.
 18239
 18240 7200-EXIT.
 18241     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 334
* EL050.cbl
 18243 7250-LOOK-FOR-RESCINDED-CLAIM.
 18244     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18245                                    W-CL-COMP-CD.
 18246     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18247                                    W-CL-CERT-NO.
 18248
 18249
 18250* EXEC CICS HANDLE CONDITION
 18251*        NOTFND  (7250-CONTINUE)
 18252*        ENDFILE (7250-CONTINUE)
 18253*    END-EXEC.
 18254*    MOVE '"$I''                  ! ) #00018012' TO DFHEIV0
 18255     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18256     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18257     MOVE X'2920233030303138303132' TO DFHEIV0(25:11)
 18258     CALL 'kxdfhei1' USING DFHEIV0
 18259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18260
 18261
 18262
 18263* EXEC CICS IGNORE CONDITION
 18264*        DUPKEY
 18265*    END-EXEC.
 18266*    MOVE '"*$                   !   #00018017' TO DFHEIV0
 18267     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18269     MOVE X'2020233030303138303137' TO DFHEIV0(25:11)
 18270     CALL 'kxdfhei1' USING DFHEIV0
 18271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18272
 18273
 18274
 18275* EXEC CICS STARTBR
 18276*        DATASET   (CLMS-ID)
 18277*        RIDFLD    (ELMSTR-KEY)
 18278*        GENERIC   EQUAL
 18279*        KEYLENGTH (ELMSTR-LENGTH)
 18280*    END-EXEC.
 18281     MOVE 0
 18282       TO DFHEIV11
 18283*    MOVE '&,   KG    E          &   #00018021' TO DFHEIV0
 18284     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18285     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18286     MOVE X'2020233030303138303231' TO DFHEIV0(25:11)
 18287     CALL 'kxdfhei1' USING DFHEIV0,
 18288           CLMS-ID,
 18289           ELMSTR-KEY,
 18290           ELMSTR-LENGTH,
 18291           DFHEIV11,
 18292           DFHEIV99
 18293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18294
 18295
 18296     MOVE 'Y'                    TO W-BROWSE-SW.
 18297
 18298 7250-NEXT-CLAIM.
 18299
 18300
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 335
* EL050.cbl
 18301* EXEC CICS READNEXT
 18302*        DATASET   (CLMS-ID)
 18303*        RIDFLD    (ELMSTR-KEY)
 18304*        SET       (ADDRESS OF CLAIM-MASTER)
 18305*    END-EXEC.
 18306     MOVE 0
 18307       TO DFHEIV11
 18308*    MOVE '&.S                   )   #00018032' TO DFHEIV0
 18309     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18310     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18311     MOVE X'2020233030303138303332' TO DFHEIV0(25:11)
 18312     CALL 'kxdfhei1' USING DFHEIV0,
 18313           CLMS-ID,
 18314           DFHEIV20,
 18315           DFHEIV99,
 18316           ELMSTR-KEY,
 18317           DFHEIV99,
 18318           DFHEIV11,
 18319           DFHEIV99,
 18320           DFHEIV99
 18321     SET ADDRESS OF CLAIM-MASTER TO
 18322         DFHEIV20
 18323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18324
 18325
 18326     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18327        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18328         GO TO 7250-CONTINUE
 18329     END-IF.
 18330
 18331     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18332        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18333        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18334        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18335        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18336         GO TO 7250-NEXT-CLAIM
 18337     END-IF.
 18338
 18339     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18340        OR (CL-CLAIM-TYPE = 'I')
 18341        OR (CL-CLAIM-TYPE = 'G')
 18342          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18343              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18344              GO TO 7250-CONTINUE
 18345          END-IF
 18346     END-IF.
 18347
 18348     GO TO 7250-NEXT-CLAIM.
 18349
 18350 7250-CONTINUE.
 18351
 18352     IF W-BROWSE-SW = 'Y'
 18353
 18354* EXEC CICS ENDBR
 18355*            DATASET   (CLMS-ID)
 18356*        END-EXEC
 18357     MOVE 0
 18358       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 336
* EL050.cbl
 18359*    MOVE '&2                    $   #00018065' TO DFHEIV0
 18360     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18361     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18362     MOVE X'2020233030303138303635' TO DFHEIV0(25:11)
 18363     CALL 'kxdfhei1' USING DFHEIV0,
 18364           CLMS-ID,
 18365           DFHEIV11,
 18366           DFHEIV99
 18367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18368         MOVE 'N' TO W-BROWSE-SW
 18369     END-IF.
 18370
 18371 7250-EXIT.
 18372     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 337
* EL050.cbl
 18374 7300-CHECK-FOR-OPEN-CLMS.
 18375
 18376*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18377*    MOVE SPACES                 TO CNTL-ACCESS.
 18378*    MOVE '1'                    TO CNTL-REC-TYPE.
 18379*    MOVE +0                     TO CNTL-SEQ-NO.
 18380
 18381*    MOVE '3'                    TO RC-SW-1.
 18382*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18383
 18384*    IF NOT CF-COMPANY-MASTER
 18385*         PERFORM 0099-COMPANY-NOT-FOUND
 18386*         GO TO 7300-EXIT.
 18387
 18388     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18389                                    W-CL-COMP-CD.
 18390     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18391                                    W-CL-CERT-NO.
 18392
 18393
 18394* EXEC CICS HANDLE CONDITION
 18395*        NOTFND  (7300-CONTINUE)
 18396*        ENDFILE (7300-CONTINUE)
 18397*    END-EXEC.
 18398*    MOVE '"$I''                  ! * #00018093' TO DFHEIV0
 18399     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18401     MOVE X'2A20233030303138303933' TO DFHEIV0(25:11)
 18402     CALL 'kxdfhei1' USING DFHEIV0
 18403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18404
 18405
 18406
 18407* EXEC CICS IGNORE CONDITION
 18408*        DUPKEY
 18409*    END-EXEC.
 18410*    MOVE '"*$                   !   #00018098' TO DFHEIV0
 18411     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18413     MOVE X'2020233030303138303938' TO DFHEIV0(25:11)
 18414     CALL 'kxdfhei1' USING DFHEIV0
 18415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18416
 18417
 18418
 18419* EXEC CICS STARTBR
 18420*        DATASET   (CLMS-ID)
 18421*        RIDFLD    (ELMSTR-KEY)
 18422*        GENERIC   EQUAL
 18423*        KEYLENGTH (ELMSTR-LENGTH)
 18424*    END-EXEC.
 18425     MOVE 0
 18426       TO DFHEIV11
 18427*    MOVE '&,   KG    E          &   #00018102' TO DFHEIV0
 18428     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18429     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18430     MOVE X'2020233030303138313032' TO DFHEIV0(25:11)
 18431     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 338
* EL050.cbl
 18432           CLMS-ID,
 18433           ELMSTR-KEY,
 18434           ELMSTR-LENGTH,
 18435           DFHEIV11,
 18436           DFHEIV99
 18437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18438
 18439
 18440     MOVE 'Y'                    TO W-BROWSE-SW.
 18441
 18442 7300-NEXT-CLAIM.
 18443
 18444
 18445* EXEC CICS READNEXT
 18446*        DATASET   (CLMS-ID)
 18447*        RIDFLD    (ELMSTR-KEY)
 18448*        SET       (ADDRESS OF CLAIM-MASTER)
 18449*    END-EXEC.
 18450     MOVE 0
 18451       TO DFHEIV11
 18452*    MOVE '&.S                   )   #00018113' TO DFHEIV0
 18453     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18454     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18455     MOVE X'2020233030303138313133' TO DFHEIV0(25:11)
 18456     CALL 'kxdfhei1' USING DFHEIV0,
 18457           CLMS-ID,
 18458           DFHEIV20,
 18459           DFHEIV99,
 18460           ELMSTR-KEY,
 18461           DFHEIV99,
 18462           DFHEIV11,
 18463           DFHEIV99,
 18464           DFHEIV99
 18465     SET ADDRESS OF CLAIM-MASTER TO
 18466         DFHEIV20
 18467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18468
 18469
 18470     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18471        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18472         GO TO 7300-CONTINUE.
 18473
 18474     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18475        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18476        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18477        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18478        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18479         GO TO 7300-NEXT-CLAIM.
 18480
 18481*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18482     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18483        OR (CL-CLAIM-TYPE = 'I')
 18484        OR (CL-CLAIM-TYPE = 'G')
 18485        IF CLAIM-IS-OPEN
 18486           EVALUATE TRUE
 18487             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18488                 MOVE ER-2884      TO WS-ERROR
 18489             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 339
* EL050.cbl
 18490                 MOVE ER-2887      TO WS-ERROR
 18491             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18492                 MOVE ER-2886      TO WS-ERROR
 18493             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18494                 MOVE ER-2888      TO WS-ERROR
 18495             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18496                 MOVE ER-2885      TO WS-ERROR
 18497             WHEN OTHER
 18498                 MOVE ER-2768      TO WS-ERROR
 18499           END-EVALUATE
 18500           IF PB-C-AH-CANCEL-VOIDED OR
 18501              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18502                NOT AH-COVERAGE-CANCELLED)
 18503               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18504               MOVE ER-2768      TO WS-ERROR
 18505           END-IF
 18506           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18507           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18508              PB-FORCE-CODE NOT EQUAL '8'
 18509               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18510           END-IF
 18511           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18512           GO TO 7300-CONTINUE
 18513        ELSE
 18514           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18515*****THIS IS A RESCISSION OR REFORMATION
 18516              IF (AH-COVERAGE-CANCELLED AND
 18517                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18518                    MOVE ER-2890 TO WS-ERROR
 18519                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18520                    GO TO 7300-CONTINUE
 18521              END-IF
 18522           ELSE
 18523              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18524                 MOVE ER-2756        TO WS-ERROR
 18525                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18526                 GO TO 7300-CONTINUE
 18527              END-IF
 18528           END-IF
 18529        END-IF
 18530     ELSE
 18531*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18532        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18533           IF CLAIM-IS-OPEN
 18534              MOVE ER-2889      TO WS-ERROR
 18535              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18536              GO TO 7300-CONTINUE
 18537           ELSE
 18538              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18539*****THIS IS A RESCISSION OR REFORMATION
 18540                 IF (LF-COVERAGE-CANCELLED AND
 18541                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18542                       MOVE ER-2890 TO WS-ERROR
 18543                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18544                       GO TO 7300-CONTINUE
 18545                 END-IF
 18546              ELSE
 18547                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 340
* EL050.cbl
 18548                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18549                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18550                    (LF-COVERAGE-CANCELLED AND
 18551                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18552                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18553                       MOVE ER-2965 TO WS-ERROR
 18554                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18555                       GO TO 7300-CONTINUE
 18556                 END-IF
 18557                 IF LF-COVERAGE-CANCELLED
 18558                  IF CL-TOTAL-PAID-AMT > 0
 18559                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18560                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18561                        MOVE ER-2891 TO WS-ERROR
 18562                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18563                        GO TO 7300-CONTINUE
 18564                      END-IF
 18565                    ELSE
 18566                      MOVE ER-2892 TO WS-ERROR
 18567                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18568                      GO TO 7300-CONTINUE
 18569                    END-IF
 18570                  END-IF
 18571                 END-IF
 18572              END-IF
 18573           END-IF
 18574        END-IF
 18575     END-IF
 18576
 18577     GO TO 7300-NEXT-CLAIM.
 18578
 18579 7300-CONTINUE.
 18580
 18581     IF W-BROWSE-SW = 'Y'
 18582
 18583* EXEC CICS ENDBR
 18584*            DATASET   (CLMS-ID)
 18585*        END-EXEC.
 18586     MOVE 0
 18587       TO DFHEIV11
 18588*    MOVE '&2                    $   #00018231' TO DFHEIV0
 18589     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18590     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18591     MOVE X'2020233030303138323331' TO DFHEIV0(25:11)
 18592     CALL 'kxdfhei1' USING DFHEIV0,
 18593           CLMS-ID,
 18594           DFHEIV11,
 18595           DFHEIV99
 18596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18597
 18598
 18599 7300-EXIT.
 18600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 341
* EL050.cbl
 18602
 18603 7400-GET-REMAIN-TERM.
 18604
 18605* EXEC CICS LINK
 18606*        PROGRAM    ('ELRTRM')
 18607*        COMMAREA   (CALCULATION-PASS-AREA)
 18608*        LENGTH     (CP-COMM-LENGTH)
 18609*    END-EXEC.
 18610     MOVE 'ELRTRM' TO DFHEIV1
 18611*    MOVE '."C                   ''   #00018240' TO DFHEIV0
 18612     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18614     MOVE X'2020233030303138323430' TO DFHEIV0(25:11)
 18615     CALL 'kxdfhei1' USING DFHEIV0,
 18616           DFHEIV1,
 18617           CALCULATION-PASS-AREA,
 18618           CP-COMM-LENGTH,
 18619           DFHEIV99,
 18620           DFHEIV99,
 18621           DFHEIV99
 18622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18623
 18624
 18625 7400-EXIT.
 18626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 342
* EL050.cbl
 18628
 18629 7500-GET-REMAIN-AMOUNT.
 18630
 18631* EXEC CICS LINK
 18632*        PROGRAM    ('ELRAMT')
 18633*        COMMAREA   (CALCULATION-PASS-AREA)
 18634*        LENGTH     (CP-COMM-LENGTH)
 18635*    END-EXEC.
 18636     MOVE 'ELRAMT' TO DFHEIV1
 18637*    MOVE '."C                   ''   #00018251' TO DFHEIV0
 18638     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18639     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18640     MOVE X'2020233030303138323531' TO DFHEIV0(25:11)
 18641     CALL 'kxdfhei1' USING DFHEIV0,
 18642           DFHEIV1,
 18643           CALCULATION-PASS-AREA,
 18644           CP-COMM-LENGTH,
 18645           DFHEIV99,
 18646           DFHEIV99,
 18647           DFHEIV99
 18648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18649
 18650
 18651 7500-EXIT.
 18652     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 343
* EL050.cbl
 18654
 18655 7600-GET-REFUND.
 18656
 18657* EXEC CICS LINK
 18658*        PROGRAM    ('ELRFND')
 18659*        COMMAREA   (CALCULATION-PASS-AREA)
 18660*        LENGTH     (CP-COMM-LENGTH)
 18661*    END-EXEC.
 18662     MOVE 'ELRFND' TO DFHEIV1
 18663*    MOVE '."C                   ''   #00018262' TO DFHEIV0
 18664     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18665     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18666     MOVE X'2020233030303138323632' TO DFHEIV0(25:11)
 18667     CALL 'kxdfhei1' USING DFHEIV0,
 18668           DFHEIV1,
 18669           CALCULATION-PASS-AREA,
 18670           CP-COMM-LENGTH,
 18671           DFHEIV99,
 18672           DFHEIV99,
 18673           DFHEIV99
 18674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18675
 18676
 18677 7600-EXIT.
 18678     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 344
* EL050.cbl
 18680 7700-CALL-DL1.
 18681
 18682* EXEC CICS LINK
 18683*        PROGRAM    ('DLO001')
 18684*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18685*        LENGTH     (DLO001-COMM-LENGTH)
 18686*    END-EXEC.
 18687     MOVE 'DLO001' TO DFHEIV1
 18688*    MOVE '."C                   ''   #00018272' TO DFHEIV0
 18689     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18690     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18691     MOVE X'2020233030303138323732' TO DFHEIV0(25:11)
 18692     CALL 'kxdfhei1' USING DFHEIV0,
 18693           DFHEIV1,
 18694           WS-DLO-MASTER-POLICY-FORM,
 18695           DLO001-COMM-LENGTH,
 18696           DFHEIV99,
 18697           DFHEIV99,
 18698           DFHEIV99
 18699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18700
 18701
 18702 7700-EXIT.
 18703     EXIT.
 18704
 18705 7710-CALL-DL2.
 18706
 18707* EXEC CICS LINK
 18708*        PROGRAM    ('DLO002')
 18709*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18710*        LENGTH     (DLO002-COMM-LENGTH)
 18711*    END-EXEC.
 18712     MOVE 'DLO002' TO DFHEIV1
 18713*    MOVE '."C                   ''   #00018282' TO DFHEIV0
 18714     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18715     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18716     MOVE X'2020233030303138323832' TO DFHEIV0(25:11)
 18717     CALL 'kxdfhei1' USING DFHEIV0,
 18718           DFHEIV1,
 18719           WS-DLO-INTERNAL-POLICY-FORM,
 18720           DLO002-COMM-LENGTH,
 18721           DFHEIV99,
 18722           DFHEIV99,
 18723           DFHEIV99
 18724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18725
 18726
 18727 7710-EXIT.
 18728     EXIT.
 18729
 18730 7720-CALL-DL3.
 18731
 18732* EXEC CICS LINK
 18733*        PROGRAM    ('DLO003')
 18734*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18735*        LENGTH     (DLO003-COMM-LENGTH)
 18736*    END-EXEC.
 18737     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 345
* EL050.cbl
 18738*    MOVE '."C                   ''   #00018292' TO DFHEIV0
 18739     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18740     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18741     MOVE X'2020233030303138323932' TO DFHEIV0(25:11)
 18742     CALL 'kxdfhei1' USING DFHEIV0,
 18743           DFHEIV1,
 18744           WS-DLO-VALID-BANK-ID,
 18745           DLO003-COMM-LENGTH,
 18746           DFHEIV99,
 18747           DFHEIV99,
 18748           DFHEIV99
 18749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18750
 18751
 18752 7720-EXIT.
 18753     EXIT.
 18754
 18755 7730-CALL-DL7.
 18756
 18757* EXEC CICS LINK
 18758*        PROGRAM    ('DLO007')
 18759*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18760*        LENGTH     (DLO007-COMM-LENGTH)
 18761*    END-EXEC.
 18762     MOVE 'DLO007' TO DFHEIV1
 18763*    MOVE '."C                   ''   #00018302' TO DFHEIV0
 18764     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18766     MOVE X'2020233030303138333032' TO DFHEIV0(25:11)
 18767     CALL 'kxdfhei1' USING DFHEIV0,
 18768           DFHEIV1,
 18769           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18770           DLO007-COMM-LENGTH,
 18771           DFHEIV99,
 18772           DFHEIV99,
 18773           DFHEIV99
 18774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18775
 18776
 18777 7730-EXIT.
 18778     EXIT.
 18779
 18780 7740-CALL-DL11.
 18781
 18782* EXEC CICS LINK
 18783*        PROGRAM    ('DLO011')
 18784*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18785*        LENGTH     (DLO011-COMM-LENGTH)
 18786*    END-EXEC.
 18787     MOVE 'DLO011' TO DFHEIV1
 18788*    MOVE '."C                   ''   #00018312' TO DFHEIV0
 18789     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18791     MOVE X'2020233030303138333132' TO DFHEIV0(25:11)
 18792     CALL 'kxdfhei1' USING DFHEIV0,
 18793           DFHEIV1,
 18794           WS-DLO-PREM-RATES-BEN-TYPE,
 18795           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 346
* EL050.cbl
 18796           DFHEIV99,
 18797           DFHEIV99,
 18798           DFHEIV99
 18799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18800
 18801
 18802 7740-EXIT.
 18803     EXIT.
 18804
 18805 7750-CALL-DL17.
 18806
 18807* EXEC CICS LINK
 18808*        PROGRAM    ('DLO017')
 18809*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18810*        LENGTH     (DLO017-COMM-LENGTH)
 18811*    END-EXEC.
 18812     MOVE 'DLO017' TO DFHEIV1
 18813*    MOVE '."C                   ''   #00018322' TO DFHEIV0
 18814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18816     MOVE X'2020233030303138333232' TO DFHEIV0(25:11)
 18817     CALL 'kxdfhei1' USING DFHEIV0,
 18818           DFHEIV1,
 18819           WS-DLO-VALID-RATE-CODE,
 18820           DLO017-COMM-LENGTH,
 18821           DFHEIV99,
 18822           DFHEIV99,
 18823           DFHEIV99
 18824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18825
 18826
 18827 7750-EXIT.
 18828     EXIT.
 18829
 18830 7755-CALL-DL19.
 18831
 18832* EXEC CICS LINK
 18833*        PROGRAM    ('DLO019')
 18834*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18835*        LENGTH     (DLO019-COMM-LENGTH)
 18836*    END-EXEC.
 18837     MOVE 'DLO019' TO DFHEIV1
 18838*    MOVE '."C                   ''   #00018332' TO DFHEIV0
 18839     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18841     MOVE X'2020233030303138333332' TO DFHEIV0(25:11)
 18842     CALL 'kxdfhei1' USING DFHEIV0,
 18843           DFHEIV1,
 18844           WS-DLO-ORIG-COV-CAT,
 18845           DLO019-COMM-LENGTH,
 18846           DFHEIV99,
 18847           DFHEIV99,
 18848           DFHEIV99
 18849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18850
 18851
 18852 7755-EXIT.
 18853     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 347
* EL050.cbl
 18854
 18855 7760-CALL-DL21.
 18856
 18857* EXEC CICS LINK
 18858*        PROGRAM    ('DLO021')
 18859*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18860*        LENGTH     (DLO021-COMM-LENGTH)
 18861*    END-EXEC.
 18862     MOVE 'DLO021' TO DFHEIV1
 18863*    MOVE '."C                   ''   #00018342' TO DFHEIV0
 18864     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18866     MOVE X'2020233030303138333432' TO DFHEIV0(25:11)
 18867     CALL 'kxdfhei1' USING DFHEIV0,
 18868           DFHEIV1,
 18869           WS-DLO-VALID-LOAN-OFFICER,
 18870           DLO021-COMM-LENGTH,
 18871           DFHEIV99,
 18872           DFHEIV99,
 18873           DFHEIV99
 18874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18875
 18876
 18877 7760-EXIT.
 18878     EXIT.
 18879
 18880 7770-CALL-DL22.
 18881
 18882* EXEC CICS LINK
 18883*        PROGRAM    ('DLO022')
 18884*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18885*        LENGTH     (DLO022-COMM-LENGTH)
 18886*    END-EXEC.
 18887     MOVE 'DLO022' TO DFHEIV1
 18888*    MOVE '."C                   ''   #00018352' TO DFHEIV0
 18889     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18891     MOVE X'2020233030303138333532' TO DFHEIV0(25:11)
 18892     CALL 'kxdfhei1' USING DFHEIV0,
 18893           DFHEIV1,
 18894           WS-DLO-VALID-STATE-CODE,
 18895           DLO022-COMM-LENGTH,
 18896           DFHEIV99,
 18897           DFHEIV99,
 18898           DFHEIV99
 18899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18900
 18901
 18902 7770-EXIT.
 18903     EXIT.
 18904
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 348
* EL050.cbl
 18906
 18907 7800-REWRITE-CERT.
 18908******************************************************************
 18909*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18910*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18911******************************************************************
 18912
 18913     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18914        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18915        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18916        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18917
 18918* EXEC CICS REWRITE
 18919*                  DATASET (CERT-ID)
 18920*                  FROM    (CERTIFICATE-MASTER)
 18921*              END-EXEC
 18922     MOVE LENGTH OF
 18923      CERTIFICATE-MASTER
 18924       TO DFHEIV11
 18925*    MOVE '&& L                  %   #00018373' TO DFHEIV0
 18926     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18927     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18928     MOVE X'2020233030303138333733' TO DFHEIV0(25:11)
 18929     CALL 'kxdfhei1' USING DFHEIV0,
 18930           CERT-ID,
 18931           CERTIFICATE-MASTER,
 18932           DFHEIV11,
 18933           DFHEIV99
 18934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18935        GO TO 7800-EXIT.
 18936
 18937       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18938       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18939
 18940 7800-EXIT.
 18941      EXIT.
 18942
 18943 7900-DELETE-CERT.
 18944
 18945* EXEC CICS DELETE
 18946*        DATASET (CERT-ID)
 18947*    END-EXEC.
 18948*    MOVE '&(                    &   #00018386' TO DFHEIV0
 18949     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18950     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18951     MOVE X'2020233030303138333836' TO DFHEIV0(25:11)
 18952     CALL 'kxdfhei1' USING DFHEIV0,
 18953           CERT-ID,
 18954           DFHEIV99,
 18955           DFHEIV99,
 18956           DFHEIV99,
 18957           DFHEIV99
 18958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18959
 18960
 18961 7900-EXIT.
 18962     EXIT.
 18963
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 349
* EL050.cbl
 18964 8000-WRITE-CERT.
 18965
 18966* EXEC CICS HANDLE CONDITION
 18967*        DUPKEY    (8000-FREE-MAIN)
 18968*    END-EXEC.
 18969*    MOVE '"$$                   ! + #00018394' TO DFHEIV0
 18970     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18972     MOVE X'2B20233030303138333934' TO DFHEIV0(25:11)
 18973     CALL 'kxdfhei1' USING DFHEIV0
 18974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18975
 18976
 18977
 18978* EXEC CICS WRITE
 18979*        DATASET     (CERT-ID)
 18980*        FROM        (CERTIFICATE-MASTER)
 18981*        RIDFLD      (ELCERT-KEY)
 18982*    END-EXEC.
 18983     MOVE LENGTH OF
 18984      CERTIFICATE-MASTER
 18985       TO DFHEIV11
 18986*    MOVE '&$ L                  ''   #00018398' TO DFHEIV0
 18987     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18989     MOVE X'2020233030303138333938' TO DFHEIV0(25:11)
 18990     CALL 'kxdfhei1' USING DFHEIV0,
 18991           CERT-ID,
 18992           CERTIFICATE-MASTER,
 18993           DFHEIV11,
 18994           ELCERT-KEY,
 18995           DFHEIV99,
 18996           DFHEIV99
 18997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18998
 18999
 19000 8000-FREE-MAIN.
 19001
 19002 8000-EXIT.
 19003      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 350
* EL050.cbl
 19005
 19006 8100-READ-ERPNDM.
 19007
 19008* EXEC CICS HANDLE CONDITION
 19009*         NOTFND     (8100-NOTFND)
 19010*         ENDFILE    (8100-NOTFND)
 19011*    END-EXEC.
 19012*    MOVE '"$I''                  ! , #00018411' TO DFHEIV0
 19013     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19015     MOVE X'2C20233030303138343131' TO DFHEIV0(25:11)
 19016     CALL 'kxdfhei1' USING DFHEIV0
 19017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19018
 19019
 19020     MOVE SPACES                 TO ERPNDM-FOUND.
 19021     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19022
 19023
 19024* EXEC CICS READ
 19025*         DATASET   (FILE-ERPNDM)
 19026*         RIDFLD    (PM-CONTROL-PRIMARY)
 19027*         INTO      (PENDING-MAILING-DATA)
 19028*    END-EXEC.
 19029     MOVE LENGTH OF
 19030      PENDING-MAILING-DATA
 19031       TO DFHEIV11
 19032*    MOVE '&"IL       E          (   #00018419' TO DFHEIV0
 19033     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19035     MOVE X'2020233030303138343139' TO DFHEIV0(25:11)
 19036     CALL 'kxdfhei1' USING DFHEIV0,
 19037           FILE-ERPNDM,
 19038           PENDING-MAILING-DATA,
 19039           DFHEIV11,
 19040           PM-CONTROL-PRIMARY,
 19041           DFHEIV99,
 19042           DFHEIV99,
 19043           DFHEIV99
 19044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19045
 19046
 19047     GO TO 8100-EXIT.
 19048
 19049 8100-NOTFND.
 19050
 19051     MOVE 'X'                    TO ERPNDM-FOUND.
 19052     MOVE ER-2694                TO WS-ERROR.
 19053     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19054     MOVE ER-2883                TO WS-ERROR
 19055     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19056     .
 19057 8100-EXIT.
 19058     EXIT.
 19059
 19060 8110-READ-ERMAIL.
 19061
 19062* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 351
* EL050.cbl
 19063*         NOTFND     (8110-NOTFND)
 19064*         ENDFILE    (8110-NOTFND)
 19065*    END-EXEC.
 19066*    MOVE '"$I''                  ! - #00018439' TO DFHEIV0
 19067     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19069     MOVE X'2D20233030303138343339' TO DFHEIV0(25:11)
 19070     CALL 'kxdfhei1' USING DFHEIV0
 19071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19072
 19073
 19074     MOVE SPACES                 TO ERMAIL-FOUND.
 19075     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19076     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19077     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19078     MOVE PB-SV-STATE            TO MA-STATE.
 19079
 19080
 19081* EXEC CICS READ
 19082*         UPDATE
 19083*         DATASET   (FILE-ERMAIL)
 19084*         RIDFLD    (MA-CONTROL-PRIMARY)
 19085*         INTO      (MAILING-DATA)
 19086*    END-EXEC.
 19087     MOVE LENGTH OF
 19088      MAILING-DATA
 19089       TO DFHEIV11
 19090*    MOVE '&"IL       EU         (   #00018450' TO DFHEIV0
 19091     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19092     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19093     MOVE X'2020233030303138343530' TO DFHEIV0(25:11)
 19094     CALL 'kxdfhei1' USING DFHEIV0,
 19095           FILE-ERMAIL,
 19096           MAILING-DATA,
 19097           DFHEIV11,
 19098           MA-CONTROL-PRIMARY,
 19099           DFHEIV99,
 19100           DFHEIV99,
 19101           DFHEIV99
 19102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19103
 19104
 19105     GO TO 8110-EXIT.
 19106
 19107 8110-NOTFND.
 19108     MOVE 'X'                    TO ERMAIL-FOUND.
 19109
 19110 8110-EXIT.
 19111     EXIT.
 19112
 19113 8120-REWRITE-ERMAIL.
 19114
 19115* EXEC CICS REWRITE
 19116*         DATASET    (FILE-ERMAIL)
 19117*         FROM       (MAILING-DATA)
 19118*    END-EXEC.
 19119     MOVE LENGTH OF
 19120      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 352
* EL050.cbl
 19121       TO DFHEIV11
 19122*    MOVE '&& L                  %   #00018466' TO DFHEIV0
 19123     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19124     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303138343636' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0,
 19127           FILE-ERMAIL,
 19128           MAILING-DATA,
 19129           DFHEIV11,
 19130           DFHEIV99
 19131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19132
 19133
 19134 8120-EXIT.
 19135     EXIT.
 19136
 19137 8130-WRITE-ERMAIL.
 19138
 19139* EXEC CICS HANDLE CONDITION
 19140*         DUPKEY   (8130-EXIT)
 19141*    END-EXEC.
 19142*    MOVE '"$$                   ! . #00018475' TO DFHEIV0
 19143     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19145     MOVE X'2E20233030303138343735' TO DFHEIV0(25:11)
 19146     CALL 'kxdfhei1' USING DFHEIV0
 19147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19148
 19149
 19150
 19151* EXEC CICS WRITE
 19152*         DATASET     (FILE-ERMAIL)
 19153*         RIDFLD      (MA-CONTROL-PRIMARY)
 19154*         FROM        (MAILING-DATA)
 19155*    END-EXEC.
 19156     MOVE LENGTH OF
 19157      MAILING-DATA
 19158       TO DFHEIV11
 19159*    MOVE '&$ L                  ''   #00018479' TO DFHEIV0
 19160     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19161     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19162     MOVE X'2020233030303138343739' TO DFHEIV0(25:11)
 19163     CALL 'kxdfhei1' USING DFHEIV0,
 19164           FILE-ERMAIL,
 19165           MAILING-DATA,
 19166           DFHEIV11,
 19167           MA-CONTROL-PRIMARY,
 19168           DFHEIV99,
 19169           DFHEIV99
 19170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19171
 19172
 19173 8130-EXIT.
 19174     EXIT.
 19175
 19176 8140-UNLOCK-ERMAIL.
 19177
 19178* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 353
* EL050.cbl
 19179*         DATASET   (FILE-ERMAIL)
 19180*    END-EXEC.
 19181*    MOVE '&*                    #   #00018489' TO DFHEIV0
 19182     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19183     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19184     MOVE X'2020233030303138343839' TO DFHEIV0(25:11)
 19185     CALL 'kxdfhei1' USING DFHEIV0,
 19186           FILE-ERMAIL,
 19187           DFHEIV99
 19188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19189
 19190
 19191 8140-EXIT.
 19192     EXIT.
 19193
 19194 8180-UPDATE-VIN-NUMBER.
 19195
 19196* EXEC CICS HANDLE CONDITION
 19197*        NOTFND   (8180-NOTFND)
 19198*    END-EXEC.
 19199*    MOVE '"$I                   ! / #00018497' TO DFHEIV0
 19200     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19202     MOVE X'2F20233030303138343937' TO DFHEIV0(25:11)
 19203     CALL 'kxdfhei1' USING DFHEIV0
 19204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19205
 19206
 19207     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19208     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19209
 19210
 19211* EXEC CICS READ
 19212*        UPDATE
 19213*        DATASET  (CRTT-ID)
 19214*        RIDFLD   (WS-ELCRTT-KEY)
 19215*        INTO     (CERTIFICATE-TRAILERS)
 19216*    END-EXEC.
 19217     MOVE LENGTH OF
 19218      CERTIFICATE-TRAILERS
 19219       TO DFHEIV11
 19220*    MOVE '&"IL       EU         (   #00018504' TO DFHEIV0
 19221     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19222     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19223     MOVE X'2020233030303138353034' TO DFHEIV0(25:11)
 19224     CALL 'kxdfhei1' USING DFHEIV0,
 19225           CRTT-ID,
 19226           CERTIFICATE-TRAILERS,
 19227           DFHEIV11,
 19228           WS-ELCRTT-KEY,
 19229           DFHEIV99,
 19230           DFHEIV99,
 19231           DFHEIV99
 19232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19233
 19234
 19235     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19236         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 354
* EL050.cbl
 19237
 19238* EXEC CICS REWRITE
 19239*           DATASET  (CRTT-ID)
 19240*           FROM     (CERTIFICATE-TRAILERS)
 19241*        END-EXEC
 19242     MOVE LENGTH OF
 19243      CERTIFICATE-TRAILERS
 19244       TO DFHEIV11
 19245*    MOVE '&& L                  %   #00018513' TO DFHEIV0
 19246     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19247     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19248     MOVE X'2020233030303138353133' TO DFHEIV0(25:11)
 19249     CALL 'kxdfhei1' USING DFHEIV0,
 19250           CRTT-ID,
 19251           CERTIFICATE-TRAILERS,
 19252           DFHEIV11,
 19253           DFHEIV99
 19254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19255     ELSE
 19256
 19257* EXEC CICS UNLOCK
 19258*          DATASET  (CRTT-ID)
 19259*       END-EXEC
 19260*    MOVE '&*                    #   #00018518' TO DFHEIV0
 19261     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19262     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19263     MOVE X'2020233030303138353138' TO DFHEIV0(25:11)
 19264     CALL 'kxdfhei1' USING DFHEIV0,
 19265           CRTT-ID,
 19266           DFHEIV99
 19267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19268     END-IF.
 19269
 19270     GO TO 8180-EXIT.
 19271
 19272 8180-NOTFND.
 19273
 19274     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19275     MOVE 'CS'         TO CS-RECORD-ID.
 19276     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19277     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19278     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19279     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19280
 19281* EXEC CICS WRITE
 19282*       DATASET  (CRTT-ID)
 19283*       RIDFLD   (WS-ELCRTT-KEY)
 19284*       FROM     (CERTIFICATE-TRAILERS)
 19285*    END-EXEC.
 19286     MOVE LENGTH OF
 19287      CERTIFICATE-TRAILERS
 19288       TO DFHEIV11
 19289*    MOVE '&$ L                  ''   #00018533' TO DFHEIV0
 19290     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19291     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19292     MOVE X'2020233030303138353333' TO DFHEIV0(25:11)
 19293     CALL 'kxdfhei1' USING DFHEIV0,
 19294           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 355
* EL050.cbl
 19295           CERTIFICATE-TRAILERS,
 19296           DFHEIV11,
 19297           WS-ELCRTT-KEY,
 19298           DFHEIV99,
 19299           DFHEIV99
 19300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19301
 19302
 19303 8180-EXIT.
 19304     EXIT.
 19305
 19306 8190-UPDATE-REFUND-CLAIM-FLAG.
 19307
 19308* EXEC CICS HANDLE CONDITION
 19309*        NOTFND   (8190-NOTFND)
 19310*    END-EXEC.
 19311*    MOVE '"$I                   ! 0 #00018543' TO DFHEIV0
 19312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19314     MOVE X'3020233030303138353433' TO DFHEIV0(25:11)
 19315     CALL 'kxdfhei1' USING DFHEIV0
 19316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19317
 19318
 19319     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19320     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19321
 19322
 19323* EXEC CICS READ
 19324*        UPDATE
 19325*        DATASET  (CRTT-ID)
 19326*        RIDFLD   (WS-ELCRTT-KEY)
 19327*        INTO     (CERTIFICATE-TRAILERS)
 19328*    END-EXEC.
 19329     MOVE LENGTH OF
 19330      CERTIFICATE-TRAILERS
 19331       TO DFHEIV11
 19332*    MOVE '&"IL       EU         (   #00018550' TO DFHEIV0
 19333     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19334     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19335     MOVE X'2020233030303138353530' TO DFHEIV0(25:11)
 19336     CALL 'kxdfhei1' USING DFHEIV0,
 19337           CRTT-ID,
 19338           CERTIFICATE-TRAILERS,
 19339           DFHEIV11,
 19340           WS-ELCRTT-KEY,
 19341           DFHEIV99,
 19342           DFHEIV99,
 19343           DFHEIV99
 19344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19345
 19346
 19347     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19348
 19349* EXEC CICS REWRITE
 19350*       DATASET  (CRTT-ID)
 19351*       FROM     (CERTIFICATE-TRAILERS)
 19352*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 356
* EL050.cbl
 19353     MOVE LENGTH OF
 19354      CERTIFICATE-TRAILERS
 19355       TO DFHEIV11
 19356*    MOVE '&& L                  %   #00018558' TO DFHEIV0
 19357     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19358     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19359     MOVE X'2020233030303138353538' TO DFHEIV0(25:11)
 19360     CALL 'kxdfhei1' USING DFHEIV0,
 19361           CRTT-ID,
 19362           CERTIFICATE-TRAILERS,
 19363           DFHEIV11,
 19364           DFHEIV99
 19365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19366
 19367
 19368     GO TO 8190-EXIT.
 19369
 19370 8190-NOTFND.
 19371
 19372     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19373     MOVE 'CS'         TO CS-RECORD-ID.
 19374     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19375     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19376     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19377     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19378
 19379* EXEC CICS WRITE
 19380*       DATASET  (CRTT-ID)
 19381*       RIDFLD   (WS-ELCRTT-KEY)
 19382*       FROM     (CERTIFICATE-TRAILERS)
 19383*    END-EXEC.
 19384     MOVE LENGTH OF
 19385      CERTIFICATE-TRAILERS
 19386       TO DFHEIV11
 19387*    MOVE '&$ L                  ''   #00018573' TO DFHEIV0
 19388     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19389     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19390     MOVE X'2020233030303138353733' TO DFHEIV0(25:11)
 19391     CALL 'kxdfhei1' USING DFHEIV0,
 19392           CRTT-ID,
 19393           CERTIFICATE-TRAILERS,
 19394           DFHEIV11,
 19395           WS-ELCRTT-KEY,
 19396           DFHEIV99,
 19397           DFHEIV99
 19398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19399
 19400
 19401 8190-EXIT.
 19402     EXIT.
 19403
 19404 8200-READ-REIN-TABLE.
 19405
 19406* EXEC CICS HANDLE CONDITION
 19407*         NOTFND   (8200-NOTFND)
 19408*    END-EXEC.
 19409*    MOVE '"$I                   ! 1 #00018583' TO DFHEIV0
 19410     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 357
* EL050.cbl
 19411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19412     MOVE X'3120233030303138353833' TO DFHEIV0(25:11)
 19413     CALL 'kxdfhei1' USING DFHEIV0
 19414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19415
 19416
 19417
 19418* EXEC CICS READ
 19419*        DATASET     (REIN-ID)
 19420*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19421*        RIDFLD      (ERREIN-KEY)
 19422*    END-EXEC.
 19423*    MOVE '&"S        E          (   #00018587' TO DFHEIV0
 19424     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19426     MOVE X'2020233030303138353837' TO DFHEIV0(25:11)
 19427     CALL 'kxdfhei1' USING DFHEIV0,
 19428           REIN-ID,
 19429           DFHEIV20,
 19430           DFHEIV99,
 19431           ERREIN-KEY,
 19432           DFHEIV99,
 19433           DFHEIV99,
 19434           DFHEIV99
 19435     SET ADDRESS OF REINSURANCE-RECORD TO
 19436         DFHEIV20
 19437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19438
 19439
 19440     GO TO 8200-EXIT.
 19441
 19442 8200-NOTFND.
 19443     MOVE 'N'             TO WS-REIN-READ-SW.
 19444
 19445 8200-EXIT.
 19446      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 358
* EL050.cbl
 19448
 19449 8300-READ-CTBL-TABLE.
 19450
 19451* EXEC CICS HANDLE CONDITION
 19452*        NOTFND    (8300-NOTFND)
 19453*        DISABLED  (8300-ERRESS-PROBLEM)
 19454*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19455*        ENDFILE   (8300-NOTFND)
 19456*    END-EXEC.
 19457*    MOVE '"$IcJ''                ! 2 #00018603' TO DFHEIV0
 19458     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19460     MOVE X'3220233030303138363033' TO DFHEIV0(25:11)
 19461     CALL 'kxdfhei1' USING DFHEIV0
 19462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19463
 19464
 19465
 19466* EXEC CICS READ
 19467*        DATASET     (CTBL-ID)
 19468*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19469*        RIDFLD      (ERCTBL-KEY)
 19470*    END-EXEC.
 19471*    MOVE '&"S        E          (   #00018610' TO DFHEIV0
 19472     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19473     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19474     MOVE X'2020233030303138363130' TO DFHEIV0(25:11)
 19475     CALL 'kxdfhei1' USING DFHEIV0,
 19476           CTBL-ID,
 19477           DFHEIV20,
 19478           DFHEIV99,
 19479           ERCTBL-KEY,
 19480           DFHEIV99,
 19481           DFHEIV99,
 19482           DFHEIV99
 19483     SET ADDRESS OF COMM-TABLE-RECORD TO
 19484         DFHEIV20
 19485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19486
 19487
 19488     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19489
 19490     GO TO 8300-EXIT.
 19491
 19492 8300-NOTFND.
 19493
 19494     IF CTBL-SW = '0530'
 19495         MOVE 'AA'                     TO WS-AH-COMP-CD
 19496         MOVE '0550'                   TO CTBL-SW
 19497         MOVE '1'                      TO WS-CTBL-READ-SW
 19498         GO TO 8300-EXIT.
 19499
 19500     IF CTBL-SW = '0540'
 19501         MOVE 'AA'                     TO WS-LF-COMP-CD
 19502         MOVE '0550'                   TO CTBL-SW
 19503         MOVE '1'                      TO WS-CTBL-READ-SW
 19504         GO TO 8300-EXIT.
 19505
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 359
* EL050.cbl
 19506     IF CTBL-SW = '0550'
 19507         MOVE '2'                      TO WS-CTBL-READ-SW
 19508         GO TO 8300-EXIT.
 19509
 19510     GO TO 8300-EXIT.
 19511
 19512 8300-ERRESS-PROBLEM.
 19513
 19514      MOVE ER-8050              TO WS-ERROR.
 19515      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19516
 19517     GO TO 8300-EXIT.
 19518
 19519 8300-EXIT.
 19520      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 360
* EL050.cbl
 19522
 19523
 19524 8400-GETMAIN-ERFORM.
 19525
 19526
 19527* EXEC CICS   GETMAIN
 19528*        LENGTH  (500)
 19529*        SET     (ADDRESS OF FORM-MASTER)
 19530*    END-EXEC.
 19531     MOVE 500
 19532       TO DFHEIV11
 19533*    MOVE '," L                  $   #00018654' TO DFHEIV0
 19534     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19535     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19536     MOVE X'2020233030303138363534' TO DFHEIV0(25:11)
 19537     CALL 'kxdfhei1' USING DFHEIV0,
 19538           DFHEIV20,
 19539           DFHEIV11,
 19540           DFHEIV99
 19541     SET ADDRESS OF FORM-MASTER TO
 19542         DFHEIV20
 19543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19544
 19545
 19546     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19547
 19548 8400-EXIT.
 19549      EXIT.
 19550
 19551 8450-READ-FORM-MASTER.
 19552
 19553
 19554* EXEC CICS  HANDLE CONDITION
 19555*        NOTFND   (8450-FORM-NOT-FOUND)
 19556*        ENDFILE  (8450-FORM-NOT-FOUND)
 19557*    END-EXEC.
 19558*    MOVE '"$I''                  ! 3 #00018666' TO DFHEIV0
 19559     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19561     MOVE X'3320233030303138363636' TO DFHEIV0(25:11)
 19562     CALL 'kxdfhei1' USING DFHEIV0
 19563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19564
 19565
 19566
 19567* EXEC CICS   READ
 19568*        DATASET   (FORM-ID)
 19569*        RIDFLD    (ERFORM-KEY)
 19570*        INTO      (FORM-MASTER)
 19571*        GTEQ
 19572*    END-EXEC.
 19573     MOVE LENGTH OF
 19574      FORM-MASTER
 19575       TO DFHEIV11
 19576*    MOVE '&"IL       G          (   #00018671' TO DFHEIV0
 19577     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19579     MOVE X'2020233030303138363731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 361
* EL050.cbl
 19580     CALL 'kxdfhei1' USING DFHEIV0,
 19581           FORM-ID,
 19582           FORM-MASTER,
 19583           DFHEIV11,
 19584           ERFORM-KEY,
 19585           DFHEIV99,
 19586           DFHEIV99,
 19587           DFHEIV99
 19588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19589
 19590
 19591     MOVE  'Y'           TO  FORM-MASTER-SW.
 19592
 19593     GO TO  8450-EXIT.
 19594
 19595 8450-FORM-NOT-FOUND.
 19596
 19597     MOVE  'N'           TO  FORM-MASTER-SW.
 19598
 19599 8450-EXIT.
 19600      EXIT.
 19601
 19602 8500-DATE-CONVERT.
 19603
 19604* EXEC CICS LINK
 19605*        PROGRAM    ('ELDATCV')
 19606*        COMMAREA   (DATE-CONVERSION-DATA)
 19607*        LENGTH     (DC-COMM-LENGTH)
 19608*    END-EXEC.
 19609     MOVE 'ELDATCV' TO DFHEIV1
 19610*    MOVE '."C                   ''   #00018690' TO DFHEIV0
 19611     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19613     MOVE X'2020233030303138363930' TO DFHEIV0(25:11)
 19614     CALL 'kxdfhei1' USING DFHEIV0,
 19615           DFHEIV1,
 19616           DATE-CONVERSION-DATA,
 19617           DC-COMM-LENGTH,
 19618           DFHEIV99,
 19619           DFHEIV99,
 19620           DFHEIV99
 19621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19622
 19623
 19624 8500-EXIT.
 19625     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 362
* EL050.cbl
 19627
 19628 8555-RELOAD-CONTROL-FILE.
 19629     CONTINUE.
 19630
 19631 8555-EXIT.
 19632     EXIT.
 19633
 19634 8557-GETMAIN-ERPLAN.
 19635
 19636
 19637* EXEC CICS GETMAIN
 19638*        LENGTH    (840)
 19639*        SET       (ADDRESS OF PLAN-RECORDS)
 19640*    END-EXEC.
 19641     MOVE 840
 19642       TO DFHEIV11
 19643*    MOVE '," L                  $   #00018708' TO DFHEIV0
 19644     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19646     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 19647     CALL 'kxdfhei1' USING DFHEIV0,
 19648           DFHEIV20,
 19649           DFHEIV11,
 19650           DFHEIV99
 19651     SET ADDRESS OF PLAN-RECORDS TO
 19652         DFHEIV20
 19653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19654
 19655
 19656     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19657
 19658 8557-EXIT.
 19659     EXIT.
 19660
 19661 8560-GETMAIN.
 19662
 19663* EXEC CICS GETMAIN
 19664*        LENGTH    (2000)
 19665*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19666*    END-EXEC.
 19667     MOVE 2000
 19668       TO DFHEIV11
 19669*    MOVE '," L                  $   #00018719' TO DFHEIV0
 19670     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19672     MOVE X'2020233030303138373139' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0,
 19674           DFHEIV20,
 19675           DFHEIV11,
 19676           DFHEIV99
 19677     SET ADDRESS OF ACCOUNT-MASTER TO
 19678         DFHEIV20
 19679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19680
 19681
 19682     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19683
 19684 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 363
* EL050.cbl
 19685     EXIT.
 19686
 19687 8570-START-ACCOUNT-MASTER.
 19688
 19689* EXEC CICS HANDLE CONDITION
 19690*        NOTFND    (0199-ACCT-NOT-FOUND)
 19691*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19692*    END-EXEC.
 19693*    MOVE '"$I''                  ! 4 #00018730' TO DFHEIV0
 19694     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19696     MOVE X'3420233030303138373330' TO DFHEIV0(25:11)
 19697     CALL 'kxdfhei1' USING DFHEIV0
 19698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19699
 19700
 19701
 19702* EXEC CICS STARTBR
 19703*        DATASET    (ACCT-ID)
 19704*        RIDFLD     (ERACCT-KEY)
 19705*        GTEQ
 19706*    END-EXEC.
 19707     MOVE 0
 19708       TO DFHEIV11
 19709*    MOVE '&,         G          &   #00018735' TO DFHEIV0
 19710     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19712     MOVE X'2020233030303138373335' TO DFHEIV0(25:11)
 19713     CALL 'kxdfhei1' USING DFHEIV0,
 19714           ACCT-ID,
 19715           ERACCT-KEY,
 19716           DFHEIV99,
 19717           DFHEIV11,
 19718           DFHEIV99
 19719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19720
 19721
 19722 8570-EXIT.
 19723     EXIT.
 19724
 19725 8580-READ-ACCOUNT-MASTER.
 19726
 19727* EXEC CICS HANDLE CONDITION
 19728*        NOTFND    (0199-ACCT-NOT-FOUND)
 19729*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19730*    END-EXEC.
 19731*    MOVE '"$I''                  ! 5 #00018745' TO DFHEIV0
 19732     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19734     MOVE X'3520233030303138373435' TO DFHEIV0(25:11)
 19735     CALL 'kxdfhei1' USING DFHEIV0
 19736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19737
 19738
 19739
 19740* EXEC CICS READNEXT
 19741*        DATASET     (ACCT-ID)
 19742*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 364
* EL050.cbl
 19743*        RIDFLD      (ERACCT-KEY)
 19744*    END-EXEC.
 19745     MOVE LENGTH OF
 19746      ACCOUNT-MASTER
 19747       TO DFHEIV12
 19748     MOVE 0
 19749       TO DFHEIV11
 19750*    MOVE '&.IL                  )   #00018750' TO DFHEIV0
 19751     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19752     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19753     MOVE X'2020233030303138373530' TO DFHEIV0(25:11)
 19754     CALL 'kxdfhei1' USING DFHEIV0,
 19755           ACCT-ID,
 19756           ACCOUNT-MASTER,
 19757           DFHEIV12,
 19758           ERACCT-KEY,
 19759           DFHEIV99,
 19760           DFHEIV11,
 19761           DFHEIV99,
 19762           DFHEIV99
 19763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19764
 19765
 19766 8580-EXIT.
 19767     EXIT.
 19768
 19769 8582-READ-COMPENSATION-MASTER.
 19770
 19771* EXEC CICS HANDLE CONDITION
 19772*        NOTFND    (8582-COMP-NOT-FOUND)
 19773*        ENDFILE   (8582-COMP-NOT-FOUND)
 19774*    END-EXEC.
 19775*    MOVE '"$I''                  ! 6 #00018760' TO DFHEIV0
 19776     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19778     MOVE X'3620233030303138373630' TO DFHEIV0(25:11)
 19779     CALL 'kxdfhei1' USING DFHEIV0
 19780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19781
 19782
 19783
 19784* EXEC CICS READ
 19785*        DATASET     (COMP-ID)
 19786*        INTO        (COMPENSATION-MASTER)
 19787*        RIDFLD      (ERCOMP-KEY)
 19788*    END-EXEC.
 19789     MOVE LENGTH OF
 19790      COMPENSATION-MASTER
 19791       TO DFHEIV11
 19792*    MOVE '&"IL       E          (   #00018765' TO DFHEIV0
 19793     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19794     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19795     MOVE X'2020233030303138373635' TO DFHEIV0(25:11)
 19796     CALL 'kxdfhei1' USING DFHEIV0,
 19797           COMP-ID,
 19798           COMPENSATION-MASTER,
 19799           DFHEIV11,
 19800           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 365
* EL050.cbl
 19801           DFHEIV99,
 19802           DFHEIV99,
 19803           DFHEIV99
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
 19807     MOVE 'Y'                    TO COMP-MASTER-SW
 19808
 19809     GO TO 8582-EXIT
 19810     .
 19811 8582-COMP-NOT-FOUND.
 19812
 19813     MOVE 'N'                    TO COMP-MASTER-SW.
 19814
 19815 8582-EXIT.
 19816     EXIT.
 19817
 19818 8583-READ-ERAGTC.
 19819
 19820* EXEC CICS HANDLE CONDITION
 19821*        NOTFND    (8583-AGTC-NOT-FOUND)
 19822*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19823*    END-EXEC.
 19824*    MOVE '"$I''                  ! 7 #00018783' TO DFHEIV0
 19825     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19827     MOVE X'3720233030303138373833' TO DFHEIV0(25:11)
 19828     CALL 'kxdfhei1' USING DFHEIV0
 19829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19830
 19831
 19832
 19833* EXEC CICS STARTBR
 19834*        DATASET    (AGTC-ID)
 19835*        RIDFLD     (ERAGTC-KEY)
 19836*        GTEQ
 19837*    END-EXEC.
 19838     MOVE 0
 19839       TO DFHEIV11
 19840*    MOVE '&,         G          &   #00018788' TO DFHEIV0
 19841     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19842     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19843     MOVE X'2020233030303138373838' TO DFHEIV0(25:11)
 19844     CALL 'kxdfhei1' USING DFHEIV0,
 19845           AGTC-ID,
 19846           ERAGTC-KEY,
 19847           DFHEIV99,
 19848           DFHEIV11,
 19849           DFHEIV99
 19850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19851
 19852
 19853 8583-READ-ERAGTC-NEXT.
 19854
 19855* EXEC CICS READNEXT
 19856*        DATASET     (AGTC-ID)
 19857*        INTO        (AGENT-COMMISSIONS)
 19858*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 366
* EL050.cbl
 19859*    END-EXEC.
 19860     MOVE LENGTH OF
 19861      AGENT-COMMISSIONS
 19862       TO DFHEIV12
 19863     MOVE 0
 19864       TO DFHEIV11
 19865*    MOVE '&.IL                  )   #00018795' TO DFHEIV0
 19866     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19867     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19868     MOVE X'2020233030303138373935' TO DFHEIV0(25:11)
 19869     CALL 'kxdfhei1' USING DFHEIV0,
 19870           AGTC-ID,
 19871           AGENT-COMMISSIONS,
 19872           DFHEIV12,
 19873           ERAGTC-KEY,
 19874           DFHEIV99,
 19875           DFHEIV11,
 19876           DFHEIV99,
 19877           DFHEIV99
 19878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19879
 19880
 19881*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19882
 19883     GO TO 8583-EXIT
 19884     .
 19885 8583-AGTC-NOT-FOUND.
 19886
 19887     MOVE 'N'                    TO AGTC-MASTER-SW.
 19888
 19889 8583-EXIT.
 19890     EXIT.
 19891
 19892 8584-READ-BANK-CROSS-REF.
 19893
 19894* EXEC CICS HANDLE CONDITION
 19895*        NOTFND    (8584-BXRF-NOT-FOUND)
 19896*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19897*    END-EXEC.
 19898*    MOVE '"$I''                  ! 8 #00018813' TO DFHEIV0
 19899     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19901     MOVE X'3820233030303138383133' TO DFHEIV0(25:11)
 19902     CALL 'kxdfhei1' USING DFHEIV0
 19903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19904
 19905
 19906
 19907* EXEC CICS READ
 19908*        DATASET     (BXRF-ID)
 19909*        INTO        (BANK-CROSS-REFERENCE)
 19910*        RIDFLD      (ERBXRF-KEY)
 19911*        LENGTH      (BXRF-REC-LENGTH)
 19912*    END-EXEC.
 19913*    MOVE '&"IL       E          (   #00018818' TO DFHEIV0
 19914     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19916     MOVE X'2020233030303138383138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 367
* EL050.cbl
 19917     CALL 'kxdfhei1' USING DFHEIV0,
 19918           BXRF-ID,
 19919           BANK-CROSS-REFERENCE,
 19920           BXRF-REC-LENGTH,
 19921           ERBXRF-KEY,
 19922           DFHEIV99,
 19923           DFHEIV99,
 19924           DFHEIV99
 19925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19926
 19927
 19928     MOVE 'Y'                    TO BXRF-MASTER-SW
 19929
 19930     GO TO 8584-EXIT
 19931     .
 19932 8584-BXRF-NOT-FOUND.
 19933
 19934     MOVE 'N'                    TO BXRF-MASTER-SW.
 19935
 19936 8584-EXIT.
 19937     EXIT.
 19938
 19939 8585-READ-PLAN-MASTER.
 19940
 19941
 19942* EXEC CICS HANDLE CONDITION
 19943*        NOTFND    (8585-PLAN-NOT-FOUND)
 19944*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19945*    END-EXEC.
 19946*    MOVE '"$I''                  ! 9 #00018838' TO DFHEIV0
 19947     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19949     MOVE X'3920233030303138383338' TO DFHEIV0(25:11)
 19950     CALL 'kxdfhei1' USING DFHEIV0
 19951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19952
 19953
 19954
 19955* EXEC CICS READ
 19956*        DATASET     (PLAN-ID)
 19957*        INTO        (PLAN-MASTER)
 19958*        RIDFLD      (ERPLAN-KEY)
 19959*    END-EXEC.
 19960     MOVE LENGTH OF
 19961      PLAN-MASTER
 19962       TO DFHEIV11
 19963*    MOVE '&"IL       E          (   #00018843' TO DFHEIV0
 19964     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19966     MOVE X'2020233030303138383433' TO DFHEIV0(25:11)
 19967     CALL 'kxdfhei1' USING DFHEIV0,
 19968           PLAN-ID,
 19969           PLAN-MASTER,
 19970           DFHEIV11,
 19971           ERPLAN-KEY,
 19972           DFHEIV99,
 19973           DFHEIV99,
 19974           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 368
* EL050.cbl
 19975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19976
 19977
 19978     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19979
 19980     GO TO 8585-EXIT.
 19981
 19982 8585-PLAN-NOT-FOUND.
 19983
 19984     MOVE 'N'                    TO PLAN-MASTER-SW.
 19985
 19986 8585-EXIT.
 19987     EXIT.
 19988
 19989 8586-READ-LOAN-OFFICER.
 19990
 19991* EXEC CICS READ
 19992*        DATASET     (LOFC-ID)
 19993*        INTO        (LOAN-OFFICER-MASTER)
 19994*        RIDFLD      (ERLOFC-KEY)
 19995*        RESP        (WS-RESPONSE)
 19996*    END-EXEC
 19997     MOVE LENGTH OF
 19998      LOAN-OFFICER-MASTER
 19999       TO DFHEIV11
 20000*    MOVE '&"IL       E          (  N#00018861' TO DFHEIV0
 20001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20003     MOVE X'204E233030303138383631' TO DFHEIV0(25:11)
 20004     CALL 'kxdfhei1' USING DFHEIV0,
 20005           LOFC-ID,
 20006           LOAN-OFFICER-MASTER,
 20007           DFHEIV11,
 20008           ERLOFC-KEY,
 20009           DFHEIV99,
 20010           DFHEIV99,
 20011           DFHEIV99
 20012     MOVE EIBRESP  TO WS-RESPONSE
 20013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20014
 20015     IF WS-RESP-NORMAL
 20016        MOVE 'Y'                 TO LOFC-MASTER-SW
 20017     ELSE
 20018        MOVE 'N'                 TO LOFC-MASTER-SW
 20019     END-IF
 20020     .
 20021 8586-EXIT.
 20022     EXIT.
 20023 8587-START-ERPDEF.
 20024
 20025* EXEC CICS STARTBR
 20026*       DATASET   (PDEF-ID)
 20027*       RIDFLD    (ERPDEF-KEY)
 20028*       GTEQ
 20029*       RESP      (WS-RESPONSE)
 20030*    END-EXEC
 20031     MOVE 0
 20032       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 369
* EL050.cbl
 20033*    MOVE '&,         G          &  N#00018877' TO DFHEIV0
 20034     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20035     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20036     MOVE X'204E233030303138383737' TO DFHEIV0(25:11)
 20037     CALL 'kxdfhei1' USING DFHEIV0,
 20038           PDEF-ID,
 20039           ERPDEF-KEY,
 20040           DFHEIV99,
 20041           DFHEIV11,
 20042           DFHEIV99
 20043     MOVE EIBRESP  TO WS-RESPONSE
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20045     IF WS-RESP-NORMAL
 20046        MOVE 'Y'                 TO PDEF-MASTER-SW
 20047     ELSE
 20048        MOVE 'N'                 TO PDEF-MASTER-SW
 20049     END-IF
 20050     .
 20051 8587-EXIT.
 20052     EXIT.
 20053 8588-READ-ERPDEF.
 20054
 20055* EXEC CICS READNEXT
 20056*       DATASET   (PDEF-ID)
 20057*       RIDFLD    (ERPDEF-KEY)
 20058*       INTO      (PRODUCT-MASTER)
 20059*       RESP      (WS-RESPONSE)
 20060*    END-EXEC
 20061     MOVE LENGTH OF
 20062      PRODUCT-MASTER
 20063       TO DFHEIV12
 20064     MOVE 0
 20065       TO DFHEIV11
 20066*    MOVE '&.IL                  )  N#00018892' TO DFHEIV0
 20067     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20068     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20069     MOVE X'204E233030303138383932' TO DFHEIV0(25:11)
 20070     CALL 'kxdfhei1' USING DFHEIV0,
 20071           PDEF-ID,
 20072           PRODUCT-MASTER,
 20073           DFHEIV12,
 20074           ERPDEF-KEY,
 20075           DFHEIV99,
 20076           DFHEIV11,
 20077           DFHEIV99,
 20078           DFHEIV99
 20079     MOVE EIBRESP  TO WS-RESPONSE
 20080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20081     IF WS-RESP-NORMAL
 20082        MOVE 'Y'                 TO PDEF-MASTER-SW
 20083     ELSE
 20084        MOVE 'N'                 TO PDEF-MASTER-SW
 20085     END-IF
 20086     .
 20087 8588-EXIT.
 20088     EXIT.
 20089 8589-ENDBR-ERPDEF.
 20090
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 370
* EL050.cbl
 20091* EXEC CICS ENDBR
 20092*       DATASET   (PDEF-ID)
 20093*    END-EXEC
 20094     MOVE 0
 20095       TO DFHEIV11
 20096*    MOVE '&2                    $   #00018907' TO DFHEIV0
 20097     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20098     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20099     MOVE X'2020233030303138393037' TO DFHEIV0(25:11)
 20100     CALL 'kxdfhei1' USING DFHEIV0,
 20101           PDEF-ID,
 20102           DFHEIV11,
 20103           DFHEIV99
 20104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20105     .
 20106 8589-EXIT.
 20107     EXIT.
 20108 8590-READ-CERT-MASTER.
 20109     IF PB-COMPANY-ID = 'UCL'
 20110         GO TO 8690-READ-CERT-MASTER-UCL.
 20111
 20112
 20113* EXEC CICS HANDLE CONDITION
 20114*         NOTFND    (0299-CERT-NOT-FOUND)
 20115*    END-EXEC.
 20116*    MOVE '"$I                   ! : #00018917' TO DFHEIV0
 20117     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20118     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20119     MOVE X'3A20233030303138393137' TO DFHEIV0(25:11)
 20120     CALL 'kxdfhei1' USING DFHEIV0
 20121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20122
 20123
 20124
 20125* EXEC CICS READ
 20126*        DATASET     (CERT-ID)
 20127*        INTO        (CERTIFICATE-MASTER)
 20128*        RIDFLD      (ELCERT-KEY)
 20129*        UPDATE
 20130*    END-EXEC.
 20131     MOVE LENGTH OF
 20132      CERTIFICATE-MASTER
 20133       TO DFHEIV11
 20134*    MOVE '&"IL       EU         (   #00018921' TO DFHEIV0
 20135     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20136     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20137     MOVE X'2020233030303138393231' TO DFHEIV0(25:11)
 20138     CALL 'kxdfhei1' USING DFHEIV0,
 20139           CERT-ID,
 20140           CERTIFICATE-MASTER,
 20141           DFHEIV11,
 20142           ELCERT-KEY,
 20143           DFHEIV99,
 20144           DFHEIV99,
 20145           DFHEIV99
 20146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20147
 20148
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 371
* EL050.cbl
 20149 8590-EXIT.
 20150     EXIT.
 20151
 20152 8690-READ-CERT-MASTER-UCL.
 20153
 20154* EXEC CICS HANDLE CONDITION
 20155*         NOTFND    (8700-READ-CERT-MASTER)
 20156*    END-EXEC.
 20157*    MOVE '"$I                   ! ; #00018932' TO DFHEIV0
 20158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20160     MOVE X'3B20233030303138393332' TO DFHEIV0(25:11)
 20161     CALL 'kxdfhei1' USING DFHEIV0
 20162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20163
 20164
 20165 8690-READ-CERT-CONT.
 20166
 20167* EXEC CICS READ
 20168*        DATASET     (CERT-ID)
 20169*        INTO        (CERTIFICATE-MASTER)
 20170*        RIDFLD      (ELCERT-KEY)
 20171*        UPDATE
 20172*    END-EXEC.
 20173     MOVE LENGTH OF
 20174      CERTIFICATE-MASTER
 20175       TO DFHEIV11
 20176*    MOVE '&"IL       EU         (   #00018937' TO DFHEIV0
 20177     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20178     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20179     MOVE X'2020233030303138393337' TO DFHEIV0(25:11)
 20180     CALL 'kxdfhei1' USING DFHEIV0,
 20181           CERT-ID,
 20182           CERTIFICATE-MASTER,
 20183           DFHEIV11,
 20184           ELCERT-KEY,
 20185           DFHEIV99,
 20186           DFHEIV99,
 20187           DFHEIV99
 20188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20189
 20190
 20191     GO TO 8590-EXIT.
 20192
 20193 8700-READ-CERT-MASTER.
 20194     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20195     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20196
 20197* EXEC CICS HANDLE CONDITION
 20198*         DUPKEY    (8720-COMP-ACCOUNTS)
 20199*         ENDFILE   (8730-END-BROWSE)
 20200*         NOTFND    (8740-NOT-FOUND)
 20201*    END-EXEC.
 20202*    MOVE '"$$''I                 ! < #00018949' TO DFHEIV0
 20203     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20205     MOVE X'3C20233030303138393439' TO DFHEIV0(25:11)
 20206     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 372
* EL050.cbl
 20207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20208
 20209
 20210
 20211* EXEC CICS STARTBR
 20212*        DATASET     ('ELCERT5')
 20213*        RIDFLD      (ELCERT2-KEY)
 20214*        EQUAL
 20215*    END-EXEC.
 20216     MOVE 'ELCERT5' TO DFHEIV1
 20217     MOVE 0
 20218       TO DFHEIV11
 20219*    MOVE '&,         E          &   #00018955' TO DFHEIV0
 20220     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20222     MOVE X'2020233030303138393535' TO DFHEIV0(25:11)
 20223     CALL 'kxdfhei1' USING DFHEIV0,
 20224           DFHEIV1,
 20225           ELCERT2-KEY,
 20226           DFHEIV99,
 20227           DFHEIV11,
 20228           DFHEIV99
 20229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20230
 20231
 20232 8710-READ-NEXT.
 20233
 20234* EXEC CICS READNEXT
 20235*        DATASET     ('ELCERT5')
 20236*        INTO        (CERTIFICATE-MASTER)
 20237*        RIDFLD      (ELCERT2-KEY)
 20238*    END-EXEC.
 20239     MOVE LENGTH OF
 20240      CERTIFICATE-MASTER
 20241       TO DFHEIV12
 20242     MOVE 'ELCERT5' TO DFHEIV1
 20243     MOVE 0
 20244       TO DFHEIV11
 20245*    MOVE '&.IL                  )   #00018962' TO DFHEIV0
 20246     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20248     MOVE X'2020233030303138393632' TO DFHEIV0(25:11)
 20249     CALL 'kxdfhei1' USING DFHEIV0,
 20250           DFHEIV1,
 20251           CERTIFICATE-MASTER,
 20252           DFHEIV12,
 20253           ELCERT2-KEY,
 20254           DFHEIV99,
 20255           DFHEIV11,
 20256           DFHEIV99,
 20257           DFHEIV99
 20258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20259
 20260
 20261 8720-COMP-ACCOUNTS.
 20262
 20263* EXEC CICS ENTER
 20264*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 373
* EL050.cbl
 20265*         FROM (PB-C-LAST-NAME)
 20266*    END-EXEC.
 20267     MOVE 001
 20268       TO DFHEIV11
 20269*    MOVE ':$F                   %   #00018969' TO DFHEIV0
 20270     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20271     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20272     MOVE X'2020233030303138393639' TO DFHEIV0(25:11)
 20273     CALL 'kxdfhei1' USING DFHEIV0,
 20274           DFHEIV11,
 20275           PB-C-LAST-NAME,
 20276           DFHEIV99,
 20277           DFHEIV99
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281
 20282* EXEC CICS ENTER
 20283*         TRACEID (002)
 20284*         FROM (CM-INSURED-LAST-NAME)
 20285*    END-EXEC.
 20286     MOVE 002
 20287       TO DFHEIV11
 20288*    MOVE ':$F                   %   #00018974' TO DFHEIV0
 20289     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20290     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20291     MOVE X'2020233030303138393734' TO DFHEIV0(25:11)
 20292     CALL 'kxdfhei1' USING DFHEIV0,
 20293           DFHEIV11,
 20294           CM-INSURED-LAST-NAME,
 20295           DFHEIV99,
 20296           DFHEIV99
 20297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20298
 20299
 20300     IF PB-CERT-NO NOT = CM-CERT-NO
 20301         GO TO 8730-END-BROWSE.
 20302
 20303     IF PB-ACCOUNT = CM-ACCOUNT
 20304         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20305             MOVE ER-2799        TO WS-ERROR
 20306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20307             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20308             GO TO 8730-END-BROWSE.
 20309
 20310     GO TO 8710-READ-NEXT.
 20311
 20312 8730-END-BROWSE.
 20313
 20314* EXEC CICS ENDBR
 20315*         DATASET    ('ELCERT5')
 20316*    END-EXEC.
 20317     MOVE 'ELCERT5' TO DFHEIV1
 20318     MOVE 0
 20319       TO DFHEIV11
 20320*    MOVE '&2                    $   #00018992' TO DFHEIV0
 20321     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 374
* EL050.cbl
 20323     MOVE X'2020233030303138393932' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0,
 20325           DFHEIV1,
 20326           DFHEIV11,
 20327           DFHEIV99
 20328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20329
 20330
 20331 8740-NOT-FOUND.
 20332     GO TO 0299-CERT-NOT-FOUND.
 20333
 20334 8750-START-ELSTAT.
 20335
 20336* EXEC CICS STARTBR
 20337*       DATASET   (STAT-ID)
 20338*       RIDFLD    (ELSTAT-KEY)
 20339*       GTEQ
 20340*       RESP      (WS-RESPONSE)
 20341*    END-EXEC
 20342     MOVE 0
 20343       TO DFHEIV11
 20344*    MOVE '&,         G          &  N#00019000' TO DFHEIV0
 20345     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20347     MOVE X'204E233030303139303030' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           STAT-ID,
 20350           ELSTAT-KEY,
 20351           DFHEIV99,
 20352           DFHEIV11,
 20353           DFHEIV99
 20354     MOVE EIBRESP  TO WS-RESPONSE
 20355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20356     IF WS-RESP-NORMAL
 20357        MOVE 'Y'                 TO STAT-MASTER-SW
 20358     ELSE
 20359        MOVE 'N'                 TO STAT-MASTER-SW
 20360     END-IF
 20361     .
 20362 8750-EXIT.
 20363     EXIT.
 20364 8752-READ-ELSTAT.
 20365
 20366* EXEC CICS READNEXT
 20367*       DATASET   (STAT-ID)
 20368*       RIDFLD    (ELSTAT-KEY)
 20369*       INTO      (STATE-FILE)
 20370*       RESP      (WS-RESPONSE)
 20371*    END-EXEC
 20372     MOVE LENGTH OF
 20373      STATE-FILE
 20374       TO DFHEIV12
 20375     MOVE 0
 20376       TO DFHEIV11
 20377*    MOVE '&.IL                  )  N#00019015' TO DFHEIV0
 20378     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20379     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20380     MOVE X'204E233030303139303135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 375
* EL050.cbl
 20381     CALL 'kxdfhei1' USING DFHEIV0,
 20382           STAT-ID,
 20383           STATE-FILE,
 20384           DFHEIV12,
 20385           ELSTAT-KEY,
 20386           DFHEIV99,
 20387           DFHEIV11,
 20388           DFHEIV99,
 20389           DFHEIV99
 20390     MOVE EIBRESP  TO WS-RESPONSE
 20391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20392     IF WS-RESP-NORMAL
 20393        MOVE 'Y'                 TO STAT-MASTER-SW
 20394     ELSE
 20395        MOVE 'N'                 TO STAT-MASTER-SW
 20396     END-IF
 20397     .
 20398 8752-EXIT.
 20399     EXIT.
 20400 8800-GET-COMP-RATE.
 20401     MOVE +1 TO IB.
 20402     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20403         ADD +9 TO IB
 20404         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20405             ADD +9 TO IB
 20406             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20407                MOVE ZEROS       TO WS-WK-RATE
 20408                GO TO 8800-EXIT.
 20409
 20410     IF PB-I-AGE GREATER CT-AGE (1)
 20411         ADD +3 TO IB
 20412         IF PB-I-AGE GREATER CT-AGE (2)
 20413             ADD +3 TO IB
 20414             IF PB-I-AGE GREATER CT-AGE (3)
 20415                MOVE ZEROS       TO WS-WK-RATE
 20416                GO TO 8800-EXIT.
 20417
 20418     IF WS-WORK-TERM GREATER CT-TRM (1)
 20419         ADD +1 TO IB
 20420         IF WS-WORK-TERM GREATER CT-TRM (2)
 20421             ADD +1 TO IB
 20422             IF WS-WORK-TERM GREATER CT-TRM (3)
 20423                MOVE ZEROS       TO WS-WK-RATE
 20424                GO TO 8800-EXIT.
 20425
 20426     IF CT-RT (IB) NOT NUMERIC
 20427         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20428         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20429         GO TO 8800-GET-COMP-RATE.
 20430
 20431     MOVE CT-RT (IB) TO WS-WK-RATE.
 20432
 20433 8800-EXIT.
 20434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 376
* EL050.cbl
 20436 8900-ADDRESS-FILE.
 20437     IF ERACCT-FILE-ADDRESSED
 20438         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20439         GO TO 8900-ADDRESS-EXIT.
 20440
 20441     IF ELCNTL-FILE-ADDRESSED
 20442         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20443         GO TO 8900-ADDRESS-EXIT.
 20444
 20445     IF ERPLAN-FILE-ADDRESSED
 20446         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20447         GO TO 8900-ADDRESS-EXIT.
 20448
 20449     IF ERFORM-FILE-ADDRESSED
 20450         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20451         GO TO 8900-ADDRESS-EXIT.
 20452
 20453 8900-ADDRESS-EXIT.
 20454     EXIT.
 20455
 20456 9000-READ-CONTROL.
 20457
 20458* EXEC CICS HANDLE CONDITION
 20459*        NOTFND    (9000-NOTFND)
 20460*    END-EXEC.
 20461*    MOVE '"$I                   ! = #00019086' TO DFHEIV0
 20462     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20464     MOVE X'3D20233030303139303836' TO DFHEIV0(25:11)
 20465     CALL 'kxdfhei1' USING DFHEIV0
 20466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20467
 20468
 20469
 20470* EXEC CICS READ
 20471*        DATASET     (CNTL-ID)
 20472*        SET         (ADDRESS OF CONTROL-FILE)
 20473*        RIDFLD      (ELCNTL-KEY)
 20474*        GTEQ
 20475*    END-EXEC.
 20476*    MOVE '&"S        G          (   #00019090' TO DFHEIV0
 20477     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20479     MOVE X'2020233030303139303930' TO DFHEIV0(25:11)
 20480     CALL 'kxdfhei1' USING DFHEIV0,
 20481           CNTL-ID,
 20482           DFHEIV20,
 20483           DFHEIV99,
 20484           ELCNTL-KEY,
 20485           DFHEIV99,
 20486           DFHEIV99,
 20487           DFHEIV99
 20488     SET ADDRESS OF CONTROL-FILE TO
 20489         DFHEIV20
 20490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20491
 20492
 20493     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 377
* EL050.cbl
 20494
 20495 9000-NOTFND.
 20496     IF RC-SW-1 = '1'
 20497        MOVE ER-2616              TO WS-ERROR
 20498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20499        GO TO 9000-EXIT.
 20500
 20501     IF RC-SW-1 = '2'
 20502        MOVE ER-2602              TO WS-ERROR
 20503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20504
 20505 9000-EXIT.
 20506      EXIT.
 20507
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 378
* EL050.cbl
 20509 9100-READ-CONTROL.
 20510
 20511* EXEC CICS HANDLE CONDITION
 20512*        NOTFND  (9100-NOTFND)
 20513*        ENDFILE (9100-NOTFND)
 20514*    END-EXEC.
 20515*    MOVE '"$I''                  ! > #00019114' TO DFHEIV0
 20516     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20518     MOVE X'3E20233030303139313134' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0
 20520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20521
 20522
 20523
 20524* EXEC CICS READ
 20525*        DATASET     (CNTL-ID)
 20526*        INTO        (CONTROL-FILE)
 20527*        RIDFLD      (ELCNTL-KEY)
 20528*        GTEQ
 20529*    END-EXEC.
 20530     MOVE LENGTH OF
 20531      CONTROL-FILE
 20532       TO DFHEIV11
 20533*    MOVE '&"IL       G          (   #00019119' TO DFHEIV0
 20534     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20536     MOVE X'2020233030303139313139' TO DFHEIV0(25:11)
 20537     CALL 'kxdfhei1' USING DFHEIV0,
 20538           CNTL-ID,
 20539           CONTROL-FILE,
 20540           DFHEIV11,
 20541           ELCNTL-KEY,
 20542           DFHEIV99,
 20543           DFHEIV99,
 20544           DFHEIV99
 20545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20546
 20547
 20548     GO TO 9100-EXIT.
 20549
 20550 9100-NOTFND.
 20551     IF RC-SW-2 = '0'
 20552        MOVE '1'                  TO STATE-RECORD-ERROR
 20553        GO TO 9100-EXIT
 20554     END-IF
 20555     IF RC-SW-2 = '1'
 20556        MOVE '1'                  TO LF-BENEFIT-ERROR
 20557        MOVE ER-2604              TO WS-ERROR
 20558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20559        GO TO 9100-EXIT.
 20560
 20561     IF RC-SW-2 = '2'
 20562        MOVE '1'                  TO AH-BENEFIT-ERROR
 20563        MOVE ER-2605              TO WS-ERROR
 20564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20565        GO TO 9100-EXIT.
 20566
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 379
* EL050.cbl
 20567     IF RC-SW-2 = '3'
 20568         MOVE ER-2603           TO WS-ERROR
 20569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20570         GO TO 9100-EXIT.
 20571
 20572     IF RC-SW-2 = '4'
 20573         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20574         GO TO 9100-EXIT.
 20575
 20576     IF RC-SW-2 = '5'
 20577         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20578         IF WS-AH-INPUT-CD-1 = SPACE
 20579             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20580         ELSE
 20581             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20582
 20583 9100-EXIT.
 20584      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 380
* EL050.cbl
 20586 9200-CONTROL-GETMAIN.
 20587
 20588* EXEC CICS GETMAIN
 20589*         LENGTH   (750)
 20590*         SET      (ADDRESS OF CONTROL-FILE)
 20591*    END-EXEC.
 20592     MOVE 750
 20593       TO DFHEIV11
 20594*    MOVE '," L                  $   #00019165' TO DFHEIV0
 20595     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20596     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20597     MOVE X'2020233030303139313635' TO DFHEIV0(25:11)
 20598     CALL 'kxdfhei1' USING DFHEIV0,
 20599           DFHEIV20,
 20600           DFHEIV11,
 20601           DFHEIV99
 20602     SET ADDRESS OF CONTROL-FILE TO
 20603         DFHEIV20
 20604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20605
 20606
 20607     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20608
 20609 9200-EXIT.
 20610     EXIT.
 20611
 20612 9250-UNLOCK-RETURN.
 20613
 20614* EXEC CICS UNLOCK
 20615*        DATASET   (CERT-ID)
 20616*    END-EXEC.
 20617*    MOVE '&*                    #   #00019176' TO DFHEIV0
 20618     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20619     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20620     MOVE X'2020233030303139313736' TO DFHEIV0(25:11)
 20621     CALL 'kxdfhei1' USING DFHEIV0,
 20622           CERT-ID,
 20623           DFHEIV99
 20624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20625
 20626
 20627 9300-ABEND.
 20628     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20629
 20630
 20631* EXEC CICS LINK
 20632*        PROGRAM   ('EL004')
 20633*        COMMAREA  (WS-ERROR-LINE)
 20634*        LENGTH    (72)
 20635*    END-EXEC.
 20636     MOVE 'EL004' TO DFHEIV1
 20637     MOVE 72
 20638       TO DFHEIV11
 20639*    MOVE '."C                   ''   #00019183' TO DFHEIV0
 20640     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20642     MOVE X'2020233030303139313833' TO DFHEIV0(25:11)
 20643     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 381
* EL050.cbl
 20644           DFHEIV1,
 20645           WS-ERROR-LINE,
 20646           DFHEIV11,
 20647           DFHEIV99,
 20648           DFHEIV99,
 20649           DFHEIV99
 20650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20651
 20652
 20653     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20654
 20655
 20656* EXEC CICS ABEND
 20657*        ABCODE ('EL50')
 20658*    END-EXEC.
 20659     MOVE 'EL50' TO DFHEIV5
 20660*    MOVE '.,A                   "   #00019191' TO DFHEIV0
 20661     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20662     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20663     MOVE X'2020233030303139313931' TO DFHEIV0(25:11)
 20664     CALL 'kxdfhei1' USING DFHEIV0,
 20665           DFHEIV5
 20666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20667
 20668
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 382
* EL050.cbl
 20670
 20671******************************************************************
 20672*                                                                *
 20673*            E R R O R   F O R M A T   R O U T I N E             *
 20674*                                                                *
 20675******************************************************************
 20676
 20677 9900-ERROR-FORMAT.
 20678
 20679     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20680                    PB-COMMON-ERROR (2) OR
 20681                    PB-COMMON-ERROR (3) OR
 20682                    PB-COMMON-ERROR (4) OR
 20683                    PB-COMMON-ERROR (5) OR
 20684                    PB-COMMON-ERROR (6) OR
 20685                    PB-COMMON-ERROR (7) OR
 20686                    PB-COMMON-ERROR (8) OR
 20687                    PB-COMMON-ERROR (9) OR
 20688                    PB-COMMON-ERROR (10)
 20689        GO TO 9900-EXIT.
 20690
 20691     IF PB-NO-OF-ERRORS = +10
 20692        GO TO 9900-EXIT.
 20693
 20694     ADD +1  TO PB-NO-OF-ERRORS.
 20695     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20696                                       (PB-NO-OF-ERRORS).
 20697 9900-EXIT.
 20698     EXIT.
 20699
 20700 9990-RETURN.
 20701     IF BROWSE-STARTED
 20702
 20703* EXEC CICS ENDBR
 20704*            DATASET  (ACCT-ID)
 20705*       END-EXEC.
 20706     MOVE 0
 20707       TO DFHEIV11
 20708*    MOVE '&2                    $   #00019228' TO DFHEIV0
 20709     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20711     MOVE X'2020233030303139323238' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0,
 20713           ACCT-ID,
 20714           DFHEIV11,
 20715           DFHEIV99
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719 9990-EXIT.
 20720     EXIT.
 20721
 20722 9999-RETURN.
 20723     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20724
 20725
 20726* EXEC CICS RETURN
 20727*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 383
* EL050.cbl
 20728*    MOVE '.(                    &   #00019238' TO DFHEIV0
 20729     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20730     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20731     MOVE X'2020233030303139323338' TO DFHEIV0(25:11)
 20732     CALL 'kxdfhei1' USING DFHEIV0,
 20733           DFHEIV99,
 20734           DFHEIV99,
 20735           DFHEIV99,
 20736           DFHEIV99,
 20737           DFHEIV99
 20738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20739
 20740
 20741
 20742* GOBACK.
 20743     MOVE '9%                    "   ' TO DFHEIV0
 20744     MOVE 'EL050' TO DFHEIV1
 20745     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20746     GOBACK.
 20747
 20748 9999-DFHBACK SECTION.
 20749     MOVE '9%                    "   ' TO DFHEIV0
 20750     MOVE 'EL050' TO DFHEIV1
 20751     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20752     GOBACK.
 20753 9999-DFHEXIT.
 20754     IF DFHEIGDJ EQUAL 0001
 20755         NEXT SENTENCE
 20756     ELSE IF DFHEIGDJ EQUAL 2
 20757         GO TO 9300-ABEND,
 20758               3990-FILES-NOT-OPEN
 20759         DEPENDING ON DFHEIGDI
 20760     ELSE IF DFHEIGDJ EQUAL 3
 20761         GO TO 6610-START-BROWSE,
 20762               6630-ERRESS-PROBLEM,
 20763               6630-END-OF-FILE
 20764         DEPENDING ON DFHEIGDI
 20765     ELSE IF DFHEIGDJ EQUAL 4
 20766         GO TO 6630-END-OF-FILE,
 20767               6630-ERRESS-PROBLEM,
 20768               6630-ERRESS-PROBLEM,
 20769               6630-END-OF-FILE
 20770         DEPENDING ON DFHEIGDI
 20771     ELSE IF DFHEIGDJ EQUAL 5
 20772         GO TO 6630-END-OF-FILE,
 20773               6630-END-OF-FILE,
 20774               6630-ERRESS-PROBLEM,
 20775               6630-ERRESS-PROBLEM
 20776         DEPENDING ON DFHEIGDI
 20777     ELSE IF DFHEIGDJ EQUAL 6
 20778         GO TO 6660-START-BROWSE,
 20779               6690-ERRESC-PROBLEM,
 20780               6690-ERRESC-PROBLEM,
 20781               6690-END-OF-FILE
 20782         DEPENDING ON DFHEIGDI
 20783     ELSE IF DFHEIGDJ EQUAL 7
 20784         GO TO 6690-END-OF-FILE,
 20785               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 384
* EL050.cbl
 20786               6690-ERRESC-PROBLEM,
 20787               6690-END-OF-FILE
 20788         DEPENDING ON DFHEIGDI
 20789     ELSE IF DFHEIGDJ EQUAL 8
 20790         GO TO 6690-END-OF-FILE,
 20791               6690-ERRESC-PROBLEM,
 20792               6690-ERRESC-PROBLEM,
 20793               6690-END-OF-FILE
 20794         DEPENDING ON DFHEIGDI
 20795     ELSE IF DFHEIGDJ EQUAL 9
 20796         GO TO 7250-CONTINUE,
 20797               7250-CONTINUE
 20798         DEPENDING ON DFHEIGDI
 20799     ELSE IF DFHEIGDJ EQUAL 10
 20800         GO TO 7300-CONTINUE,
 20801               7300-CONTINUE
 20802         DEPENDING ON DFHEIGDI
 20803     ELSE IF DFHEIGDJ EQUAL 11
 20804         GO TO 8000-FREE-MAIN
 20805         DEPENDING ON DFHEIGDI
 20806     ELSE IF DFHEIGDJ EQUAL 12
 20807         GO TO 8100-NOTFND,
 20808               8100-NOTFND
 20809         DEPENDING ON DFHEIGDI
 20810     ELSE IF DFHEIGDJ EQUAL 13
 20811         GO TO 8110-NOTFND,
 20812               8110-NOTFND
 20813         DEPENDING ON DFHEIGDI
 20814     ELSE IF DFHEIGDJ EQUAL 14
 20815         GO TO 8130-EXIT
 20816         DEPENDING ON DFHEIGDI
 20817     ELSE IF DFHEIGDJ EQUAL 15
 20818         GO TO 8180-NOTFND
 20819         DEPENDING ON DFHEIGDI
 20820     ELSE IF DFHEIGDJ EQUAL 16
 20821         GO TO 8190-NOTFND
 20822         DEPENDING ON DFHEIGDI
 20823     ELSE IF DFHEIGDJ EQUAL 17
 20824         GO TO 8200-NOTFND
 20825         DEPENDING ON DFHEIGDI
 20826     ELSE IF DFHEIGDJ EQUAL 18
 20827         GO TO 8300-NOTFND,
 20828               8300-ERRESS-PROBLEM,
 20829               8300-ERRESS-PROBLEM,
 20830               8300-NOTFND
 20831         DEPENDING ON DFHEIGDI
 20832     ELSE IF DFHEIGDJ EQUAL 19
 20833         GO TO 8450-FORM-NOT-FOUND,
 20834               8450-FORM-NOT-FOUND
 20835         DEPENDING ON DFHEIGDI
 20836     ELSE IF DFHEIGDJ EQUAL 20
 20837         GO TO 0199-ACCT-NOT-FOUND,
 20838               0199-ACCT-NOT-FOUND
 20839         DEPENDING ON DFHEIGDI
 20840     ELSE IF DFHEIGDJ EQUAL 21
 20841         GO TO 0199-ACCT-NOT-FOUND,
 20842               0199-ACCT-NOT-FOUND
 20843         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 03-Apr-12 08:59 Page 385
* EL050.cbl
 20844     ELSE IF DFHEIGDJ EQUAL 22
 20845         GO TO 8582-COMP-NOT-FOUND,
 20846               8582-COMP-NOT-FOUND
 20847         DEPENDING ON DFHEIGDI
 20848     ELSE IF DFHEIGDJ EQUAL 23
 20849         GO TO 8583-AGTC-NOT-FOUND,
 20850               8583-AGTC-NOT-FOUND
 20851         DEPENDING ON DFHEIGDI
 20852     ELSE IF DFHEIGDJ EQUAL 24
 20853         GO TO 8584-BXRF-NOT-FOUND,
 20854               8584-BXRF-NOT-FOUND
 20855         DEPENDING ON DFHEIGDI
 20856     ELSE IF DFHEIGDJ EQUAL 25
 20857         GO TO 8585-PLAN-NOT-FOUND,
 20858               8585-PLAN-NOT-FOUND
 20859         DEPENDING ON DFHEIGDI
 20860     ELSE IF DFHEIGDJ EQUAL 26
 20861         GO TO 0299-CERT-NOT-FOUND
 20862         DEPENDING ON DFHEIGDI
 20863     ELSE IF DFHEIGDJ EQUAL 27
 20864         GO TO 8700-READ-CERT-MASTER
 20865         DEPENDING ON DFHEIGDI
 20866     ELSE IF DFHEIGDJ EQUAL 28
 20867         GO TO 8720-COMP-ACCOUNTS,
 20868               8730-END-BROWSE,
 20869               8740-NOT-FOUND
 20870         DEPENDING ON DFHEIGDI
 20871     ELSE IF DFHEIGDJ EQUAL 29
 20872         GO TO 9000-NOTFND
 20873         DEPENDING ON DFHEIGDI
 20874     ELSE IF DFHEIGDJ EQUAL 30
 20875         GO TO 9100-NOTFND,
 20876               9100-NOTFND
 20877         DEPENDING ON DFHEIGDI.
 20878     MOVE '9%                    "   ' TO DFHEIV0
 20879     MOVE 'EL050' TO DFHEIV1
 20880     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20881     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39416     Code:       84464
