* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56******************************************************************
    57
    58 ENVIRONMENT DIVISION.
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   3
* EL633.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER  PIC X(32)  VALUE '********************************'.
    64 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    65 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    66
    67*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    68*77  SV-COFA PIC X(42)  VALUE SPACES.
    69*77  K-SPACE PIC X(11)  VALUE SPACES.
    70
    71 01  DATE-WORK-AREAS.
    72     05  WS-GREG-STORE.
    73         10  WS-GS-MM  PIC XX.
    74         10  FILLER    PIC X.
    75         10  WS-GS-DD  PIC XX.
    76         10  FILLER    PIC X.
    77         10  WS-GS-YY  PIC XX.
    78     05  WS-SDTE-STORE.
    79         10  WS-SS-MM  PIC XX.
    80         10  WS-SS-DD  PIC XX.
    81         10  WS-SS-YY  PIC XX.
    82*                            COPY ELCSCTM.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCTM                             *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-MESSAGE.
    93     12  FILLER                          PIC X(30)
    94            VALUE '** LOGIC SECURITY VIOLATION -'.
    95     12  SM-READ                         PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' PGM='.
    98     12  SM-PGM                          PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' OPR='.
   101     12  SM-PROCESSOR-ID                 PIC X(4).
   102     12  FILLER                          PIC X(6)
   103            VALUE ' TERM='.
   104     12  SM-TERMID                       PIC X(4).
   105     12  FILLER                          PIC XX   VALUE SPACE.
   106     12  SM-JUL-DATE                     PIC 9(5).
   107     12  FILLER                          PIC X    VALUE SPACE.
   108     12  SM-TIME                         PIC 99.99.
   109
   110*                            COPY ELCSCRTY.
   111******************************************************************
   112*                                                                *
   113*                                                                *
   114*                            ELCSCRTY                            *
   115*                            VMOD=2.001                          *
   116*                                                                *
   117*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   118*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   4
* EL633.cbl
   119*        SAVED IN PI-SECURITY-ADDRESS.                           *
   120*                                                                *
   121******************************************************************
   122 01  SECURITY-CONTROL.
   123     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   124     12  FILLER                       PIC XX    VALUE 'SC'.
   125     12  SC-CREDIT-CODES.
   126         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   127             20  SC-CREDIT-DISPLAY    PIC X.
   128             20  SC-CREDIT-UPDATE     PIC X.
   129     12  SC-CLAIMS-CODES.
   130         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   131             20  SC-CLAIMS-DISPLAY    PIC X.
   132             20  SC-CLAIMS-UPDATE     PIC X.
   133
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   5
* EL633.cbl
   135
   136 01  STANDARD-AREAS.
   137     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   138     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   139     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   140     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   141     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   142     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   143     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   144     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   145     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   146     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   147     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   148     12  PGM-NAME            PIC  X(8).
   149     12  TIME-IN             PIC S9(7).
   150     12  TIME-OUT-R  REDEFINES  TIME-IN.
   151         16  FILLER          PIC  X.
   152         16  TIME-OUT        PIC  99V99.
   153         16  FILLER          PIC  X(2).
   154     12  EL640               PIC  X(8)       VALUE 'EL640'.
   155     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   156     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   157     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   158     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   159     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   160     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   161     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   162     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   163     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   164     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   165     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   166     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   167     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   168     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   169     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   170     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   171     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   172         88  PYAJ-1ST-READ                   VALUE 'Y'.
   173     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   174         88  FIRST-ADD                       VALUE 'Y'.
   175     12  ZERO-NDX            PIC  9          VALUE ZERO.
   176     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   177     12  WORK-SEQ-TIME       PIC  9(6).
   178     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   179         16  WORK-SEQ-HHMMS  PIC  9(5).
   180         16  FILLER          PIC  9.
   181     12  WORK-DATE-JULIAN.
   182         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   183         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   184     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   185     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   186         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   187                                                    'S' 'T' 'U'
   188                                                    'X' 'Y' 'Z'
   189                                                    'F'.
   190     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   191         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   192     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   6
* EL633.cbl
   193         88  FORCE-SHOW                      VALUE  'Y'.
   194
   195     12  WS-EOM-DTS OCCURS 13  TIMES
   196                              INDEXED BY PINDEX.
   197         16  WS-EOM-DT               PIC XX.
   198*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   199
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   7
* EL633.cbl
   201     12  WS-ERROR-CODES.
   202         16  ER-0000         PIC  X(4)       VALUE '0000'.
   203         16  ER-0008         PIC  X(4)       VALUE '0008'.
   204         16  ER-0023         PIC  X(4)       VALUE '0023'.
   205         16  ER-0029         PIC  X(4)       VALUE '0029'.
   206         16  ER-0070         PIC  X(4)       VALUE '0070'.
   207         16  ER-0587         PIC  X(4)       VALUE '0587'.
   208         16  ER-2056         PIC  X(4)       VALUE '2056'.
   209         16  ER-2230         PIC  X(4)       VALUE '2230'.
   210         16  ER-2231         PIC  X(4)       VALUE '2231'.
   211         16  ER-2232         PIC  X(4)       VALUE '2232'.
   212         16  ER-2233         PIC  X(4)       VALUE '2233'.
   213         16  ER-2234         PIC  X(4)       VALUE '2234'.
   214         16  ER-2235         PIC  X(4)       VALUE '2235'.
   215         16  ER-2236         PIC  X(4)       VALUE '2236'.
   216         16  ER-2237         PIC  X(4)       VALUE '2237'.
   217         16  ER-2238         PIC  X(4)       VALUE '2238'.
   218         16  ER-2239         PIC  X(4)       VALUE '2239'.
   219         16  ER-2244         PIC  X(4)       VALUE '2244'.
   220         16  ER-2245         PIC  X(4)       VALUE '2245'.
   221         16  ER-2246         PIC  X(4)       VALUE '2246'.
   222         16  ER-2370         PIC  X(4)       VALUE '2370'.
   223         16  ER-2432         PIC  X(4)       VALUE '2432'.
   224         16  ER-2449         PIC  X(4)       VALUE '2449'.
   225         16  ER-2587         PIC  X(4)       VALUE '2587'.
   226         16  ER-2588         PIC  X(4)       VALUE '2588'.
   227         16  ER-2595         PIC  X(4)       VALUE '2595'.
   228         16  ER-2596         PIC  X(4)       VALUE '2596'.
   229         16  ER-2763         PIC  X(4)       VALUE '2763'.
   230         16  ER-2929         PIC  X(4)       VALUE '2929'.
   231         16  ER-2957         PIC  X(4)       VALUE '2957'.
   232         16  ER-2958         PIC  X(4)       VALUE '2958'.
   233*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   234         16  ER-2960         PIC  X(4)       VALUE '2960'.
   235         16  ER-3020         PIC  X(4)       VALUE '3020'.
   236
   237*************************************************************
   238*                      TABLE OF STATE NAMES
   239*************************************************************
   240
   241 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   242     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   243                                   'CD' 'CO' 'CT' 'DC' 'DE'
   244                                   'FL' 'GA' 'GM' 'HI' 'IA'
   245                                   'ID' 'IL' 'IN' 'KS' 'KY'
   246                                   'LA' 'MA' 'MD' 'ME' 'MI'
   247                                   'MN' 'MO' 'MS' 'MT' 'MX'
   248                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   249                                   'NM' 'NV' 'NY' 'OF' 'OH'
   250                                   'OK' 'OR' 'PA' 'PI' 'PR'
   251                                   'RI' 'SC' 'SD' 'TN' 'TX'
   252                                   'UT' 'VA' 'VI' 'VT' 'WA'
   253                                   'WI' 'WV' 'WY'.
   254
   255 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   256     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   257                                 '1108125100'
   258                                 '1721211400'
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   8
* EL633.cbl
   259                                 '1825011200'
   260                                 '1825011300'
   261                                 '1825091000'
   262                                 '1825099050'
   263                                 '8505700033'
   264                                 '8506400030'
   265                                 '8507200020'
   266                                 '8507200010'.
   267     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   268                                     '2725040320'
   269                                     '2725040330'
   270                                     '2725040310'
   271                                     '8506400030'
   272                                     '8507200010'
   273                                     '1108121250'.
   274     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   275                                     '2725040110'
   276                                     '2725040120'
   277                                     '2725040130'
   278                                     '2725020400'.
   279
   280     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   281                                     '1825013200'
   282                                     '1825013300'
   283                                     '1825013400'
   284                                     '8506400030'
   285                                     '8507200010'
   286                                     '8507200020'
   287                                     '1108121010'.
   288
   289*01  WS-ACCT-BREAK.
   290*    05  WS-ACCT-1               PIC X.
   291*    05  FILLER                  PIC X(6).
   292*
   293 01  WORK-AREA.
   294     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   295     12  QID.
   296         16  QID-TERM        PIC X(04).
   297         16  FILLER          PIC X(04)       VALUE '633A'.
   298     12  DEEDIT-FIELD        PIC X(11).
   299     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   300     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   301     12  DATE-TEST-AREA      PIC  9(6).
   302     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   303         16  DATE-TEST-MM    PIC  99.
   304         16  DATE-TEST-DD    PIC  99.
   305         16  DATE-TEST-YY    PIC  99.
   306     12  DIVIDE-RESULT       PIC  99.
   307     12  DIVIDE-REMAINDER    PIC  9.
   308     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   309     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   310     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   311     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   312     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   313     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   314     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   315     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   316
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page   9
* EL633.cbl
   317 01  ACCESS-KEYS.
   318     12  ERPYAJ-KEY.
   319         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   320         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   321         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   322         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   323         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   324         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   325         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   326
   327     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   328     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   329
   330     12  ERCHKQ-KEY.
   331         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   332         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   333         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   334     12  ERCOMP-KEY.
   335         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   336         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   337         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   338         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   339         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   340         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   341*    12  COFA-KEY-X.
   342*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   343*        16  COFA-ACCOUNT.
   344*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   345*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   346*
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  10
* EL633.cbl
   348*                                    COPY ELCDATE.
   349******************************************************************
   350*                                                                *
   351*                                                                *
   352*                            ELCDATE.                            *
   353*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   354*                            VMOD=2.003
   355*                                                                *
   356*                                                                *
   357*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   358*                 LENGTH = 200                                   *
   359******************************************************************
   360
   361 01  DATE-CONVERSION-DATA.
   362     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   363     12  DC-OPTION-CODE                PIC X.
   364         88  BIN-TO-GREG                VALUE ' '.
   365         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   366         88  EDIT-GREG-TO-BIN           VALUE '2'.
   367         88  YMD-GREG-TO-BIN            VALUE '3'.
   368         88  MDY-GREG-TO-BIN            VALUE '4'.
   369         88  JULIAN-TO-BIN              VALUE '5'.
   370         88  BIN-PLUS-ELAPSED           VALUE '6'.
   371         88  FIND-CENTURY               VALUE '7'.
   372         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   373         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   374         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   375         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   376         88  JULIAN-TO-BIN-3            VALUE 'C'.
   377         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   378         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   379         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   380         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   381         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   382         88  CHECK-LEAP-YEAR            VALUE 'H'.
   383         88  BIN-3-TO-GREG              VALUE 'I'.
   384         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   385         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   386         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   387         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   388         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   389         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   390         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   391         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   392         88  THREE-CHARACTER-BIN
   393                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   394         88  GREGORIAN-TO-BIN
   395                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   396         88  BIN-TO-GREGORIAN
   397                  VALUES ' ' '1' 'I' '8' 'G'.
   398         88  JULIAN-TO-BINARY
   399                  VALUES '5' 'C' 'E' 'F'.
   400     12  DC-ERROR-CODE                 PIC X.
   401         88  NO-CONVERSION-ERROR        VALUE ' '.
   402         88  DATE-CONVERSION-ERROR
   403                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   404         88  DATE-IS-ZERO               VALUE '1'.
   405         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  11
* EL633.cbl
   406         88  DATE-IS-INVALID            VALUE '3'.
   407         88  DATE1-GREATER-DATE2        VALUE '4'.
   408         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   409         88  DATE-INVALID-OPTION        VALUE '9'.
   410         88  INVALID-CENTURY            VALUE 'A'.
   411         88  ONLY-CENTURY               VALUE 'B'.
   412         88  ONLY-LEAP-YEAR             VALUE 'C'.
   413         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   414     12  DC-END-OF-MONTH               PIC X.
   415         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   416     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   417         88  USE-NORMAL-PROCESS         VALUE ' '.
   418         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   419         88  ADJUST-UP-100-YRS          VALUE '2'.
   420     12  FILLER                        PIC X.
   421     12  DC-CONVERSION-DATES.
   422         16  DC-BIN-DATE-1             PIC XX.
   423         16  DC-BIN-DATE-2             PIC XX.
   424         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   425         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   426                       DC-GREG-DATE-1-EDIT.
   427             20  DC-EDIT1-MONTH        PIC 99.
   428             20  SLASH1-1              PIC X.
   429             20  DC-EDIT1-DAY          PIC 99.
   430             20  SLASH1-2              PIC X.
   431             20  DC-EDIT1-YEAR         PIC 99.
   432         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   433         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   434                     DC-GREG-DATE-2-EDIT.
   435             20  DC-EDIT2-MONTH        PIC 99.
   436             20  SLASH2-1              PIC X.
   437             20  DC-EDIT2-DAY          PIC 99.
   438             20  SLASH2-2              PIC X.
   439             20  DC-EDIT2-YEAR         PIC 99.
   440         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   441         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   442                     DC-GREG-DATE-1-YMD.
   443             20  DC-YMD-YEAR           PIC 99.
   444             20  DC-YMD-MONTH          PIC 99.
   445             20  DC-YMD-DAY            PIC 99.
   446         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   447         16  DC-GREG-DATE-1-MDY-R REDEFINES
   448                      DC-GREG-DATE-1-MDY.
   449             20  DC-MDY-MONTH          PIC 99.
   450             20  DC-MDY-DAY            PIC 99.
   451             20  DC-MDY-YEAR           PIC 99.
   452         16  DC-GREG-DATE-1-ALPHA.
   453             20  DC-ALPHA-MONTH        PIC X(10).
   454             20  DC-ALPHA-DAY          PIC 99.
   455             20  FILLER                PIC XX.
   456             20  DC-ALPHA-CENTURY.
   457                 24 DC-ALPHA-CEN-N     PIC 99.
   458             20  DC-ALPHA-YEAR         PIC 99.
   459         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   460         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   461         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   462         16  DC-JULIAN-DATE            PIC 9(05).
   463         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  12
* EL633.cbl
   464                                       PIC 9(05).
   465         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   466             20  DC-JULIAN-YEAR        PIC 99.
   467             20  DC-JULIAN-DAYS        PIC 999.
   468         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   469         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   470         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   471     12  DATE-CONVERSION-VARIBLES.
   472         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   473         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   474             20  FILLER                PIC 9(3).
   475             20  HOLD-CEN-1-CCYY.
   476                 24  HOLD-CEN-1-CC     PIC 99.
   477                 24  HOLD-CEN-1-YY     PIC 99.
   478             20  HOLD-CEN-1-MO         PIC 99.
   479             20  HOLD-CEN-1-DA         PIC 99.
   480         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   481             20  HOLD-CEN-1-R-MO       PIC 99.
   482             20  HOLD-CEN-1-R-DA       PIC 99.
   483             20  HOLD-CEN-1-R-CCYY.
   484                 24  HOLD-CEN-1-R-CC   PIC 99.
   485                 24  HOLD-CEN-1-R-YY   PIC 99.
   486             20  FILLER                PIC 9(3).
   487         16  HOLD-CENTURY-1-X.
   488             20  FILLER                PIC X(3)  VALUE SPACES.
   489             20  HOLD-CEN-1-X-CCYY.
   490                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   491                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   492             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   493             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   494         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   495             20  HOLD-CEN-1-R-X-MO     PIC XX.
   496             20  HOLD-CEN-1-R-X-DA     PIC XX.
   497             20  HOLD-CEN-1-R-X-CCYY.
   498                 24  HOLD-CEN-1-R-X-CC PIC XX.
   499                 24  HOLD-CEN-1-R-X-YY PIC XX.
   500             20  FILLER                PIC XXX.
   501         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   502         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   503         16  DC-JULIAN-DATE-1          PIC 9(07).
   504         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   505             20  DC-JULIAN-1-CCYY.
   506                 24  DC-JULIAN-1-CC    PIC 99.
   507                 24  DC-JULIAN-1-YR    PIC 99.
   508             20  DC-JULIAN-DA-1        PIC 999.
   509         16  DC-JULIAN-DATE-2          PIC 9(07).
   510         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   511             20  DC-JULIAN-2-CCYY.
   512                 24  DC-JULIAN-2-CC    PIC 99.
   513                 24  DC-JULIAN-2-YR    PIC 99.
   514             20  DC-JULIAN-DA-2        PIC 999.
   515         16  DC-GREG-DATE-A-EDIT.
   516             20  DC-EDITA-MONTH        PIC 99.
   517             20  SLASHA-1              PIC X VALUE '/'.
   518             20  DC-EDITA-DAY          PIC 99.
   519             20  SLASHA-2              PIC X VALUE '/'.
   520             20  DC-EDITA-CCYY.
   521                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  13
* EL633.cbl
   522                 24  DC-EDITA-YEAR     PIC 99.
   523         16  DC-GREG-DATE-B-EDIT.
   524             20  DC-EDITB-MONTH        PIC 99.
   525             20  SLASHB-1              PIC X VALUE '/'.
   526             20  DC-EDITB-DAY          PIC 99.
   527             20  SLASHB-2              PIC X VALUE '/'.
   528             20  DC-EDITB-CCYY.
   529                 24  DC-EDITB-CENT     PIC 99.
   530                 24  DC-EDITB-YEAR     PIC 99.
   531         16  DC-GREG-DATE-CYMD         PIC 9(08).
   532         16  DC-GREG-DATE-CYMD-R REDEFINES
   533                              DC-GREG-DATE-CYMD.
   534             20  DC-CYMD-CEN           PIC 99.
   535             20  DC-CYMD-YEAR          PIC 99.
   536             20  DC-CYMD-MONTH         PIC 99.
   537             20  DC-CYMD-DAY           PIC 99.
   538         16  DC-GREG-DATE-MDCY         PIC 9(08).
   539         16  DC-GREG-DATE-MDCY-R REDEFINES
   540                              DC-GREG-DATE-MDCY.
   541             20  DC-MDCY-MONTH         PIC 99.
   542             20  DC-MDCY-DAY           PIC 99.
   543             20  DC-MDCY-CEN           PIC 99.
   544             20  DC-MDCY-YEAR          PIC 99.
   545    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   546        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   547    12  DC-EL310-DATE                  PIC X(21).
   548    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  14
* EL633.cbl
   550*                                    COPY ELCLOGOF.
   551******************************************************************
   552*                                                                *
   553*                                                                *
   554*                            ELCLOGOF.                           *
   555*                            VMOD=2.001                          *
   556*                                                                *
   557*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   558*                                                                *
   559******************************************************************
   560 01  CLASIC-LOGOFF.
   561     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   562     12  LOGOFF-TEXT.
   563         16  FILLER          PIC X(5)    VALUE SPACES.
   564         16  LOGOFF-MSG.
   565             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   566             20  FILLER      PIC X       VALUE SPACES.
   567             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   568         16  FILLER          PIC X(80)
   569           VALUE '* YOU ARE NOW LOGGED OFF'.
   570         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   571         16  FILLER          PIC X       VALUE QUOTE.
   572         16  LOGOFF-SYS-MSG  PIC X(17)
   573           VALUE 'S CLAS-IC SYSTEM '.
   574     12  TEXT-MESSAGES.
   575         16  UNACCESS-MSG    PIC X(29)
   576             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   577         16  PGMIDERR-MSG    PIC X(17)
   578             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  15
* EL633.cbl
   580*                                    COPY ELCATTR.
   581******************************************************************
   582*                                                                *
   583*                            ELCATTR.                            *
   584*                            VMOD=2.001                          *
   585*                                                                *
   586*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   587*                                                                *
   588*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   589*                                                                *
   590*                   POS 1   P=PROTECTED                          *
   591*                           U=UNPROTECTED                        *
   592*                           S=ASKIP                              *
   593*                   POS 2   A=ALPHA/NUMERIC                      *
   594*                           N=NUMERIC                            *
   595*                   POS 3   N=NORMAL                             *
   596*                           B=BRIGHT                             *
   597*                           D=DARK                               *
   598*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   599*                           OF=MODIFIED DATA TAG OFF             *
   600*                                                                *
   601*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   602******************************************************************
   603 01  ATTRIBUTE-LIST.
   604     12  AL-PABOF            PIC X       VALUE 'Y'.
   605     12  AL-PABON            PIC X       VALUE 'Z'.
   606     12  AL-PADOF            PIC X       VALUE '%'.
   607     12  AL-PADON            PIC X       VALUE '_'.
   608     12  AL-PANOF            PIC X       VALUE '-'.
   609     12  AL-PANON            PIC X       VALUE '/'.
   610     12  AL-SABOF            PIC X       VALUE '8'.
   611     12  AL-SABON            PIC X       VALUE '9'.
   612     12  AL-SADOF            PIC X       VALUE '@'.
   613     12  AL-SADON            PIC X       VALUE QUOTE.
   614     12  AL-SANOF            PIC X       VALUE '0'.
   615     12  AL-SANON            PIC X       VALUE '1'.
   616     12  AL-UABOF            PIC X       VALUE 'H'.
   617     12  AL-UABON            PIC X       VALUE 'I'.
   618     12  AL-UADOF            PIC X       VALUE '<'.
   619     12  AL-UADON            PIC X       VALUE '('.
   620     12  AL-UANOF            PIC X       VALUE ' '.
   621     12  AL-UANON            PIC X       VALUE 'A'.
   622     12  AL-UNBOF            PIC X       VALUE 'Q'.
   623     12  AL-UNBON            PIC X       VALUE 'R'.
   624     12  AL-UNDOF            PIC X       VALUE '*'.
   625     12  AL-UNDON            PIC X       VALUE ')'.
   626     12  AL-UNNOF            PIC X       VALUE '&'.
   627     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  16
* EL633.cbl
   629*                                    COPY ELCEMIB.
   630******************************************************************
   631*                                                                *
   632*                                                                *
   633*                            ELCEMIB.                            *
   634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   635*                            VMOD=2.005                          *
   636*                                                                *
   637*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   638*                                                                *
   639******************************************************************
   640 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   641     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   642     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   643     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   644     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   645     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   646     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   647     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   648     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   649     12  EMI-SWITCH1             PIC X        VALUE '1'.
   650         88  EMI-NO-ERRORS                    VALUE '1'.
   651         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   652         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   653     12  EMI-SWITCH2             PIC X        VALUE '1'.
   654         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   655     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   656         88  EMI-AREA1-EMPTY                  VALUE '1'.
   657         88  EMI-AREA1-FULL                   VALUE '2'.
   658     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   659         88  EMI-AREA2-EMPTY                  VALUE '1'.
   660         88  EMI-AREA2-FULL                   VALUE '2'.
   661     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   662         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   663         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   664         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   665         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   666         88  EMI-BYPASS-FATALS                VALUE 'X'.
   667     12  EMI-ERROR-LINES.
   668         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   669         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   670         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   671         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   672             20  EMI-ERR-CODES OCCURS 10 TIMES.
   673                 24  EMI-ERR-NUM         PIC X(4).
   674                 24  EMI-FILLER          PIC X.
   675                 24  EMI-SEV             PIC X.
   676                 24  FILLER              PIC X.
   677             20  FILLER                  PIC X(02).
   678     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   679         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   680             20  EMI-ERROR-NUMBER    PIC X(4).
   681             20  EMI-FILL            PIC X.
   682             20  EMI-SEVERITY        PIC X.
   683             20  FILLER              PIC X.
   684             20  EMI-ERROR-TEXT.
   685                 24  EMI-TEXT-VARIABLE   PIC X(10).
   686                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  17
* EL633.cbl
   687     12  EMI-SEVERITY-SAVE           PIC X.
   688         88  EMI-NOTE                    VALUE 'N'.
   689         88  EMI-WARNING                 VALUE 'W'.
   690         88  EMI-FORCABLE                VALUE 'F'.
   691         88  EMI-FATAL                   VALUE 'X'.
   692     12  EMI-MESSAGE-FLAG            PIC X.
   693         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   694         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   695     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   696     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   697         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   698         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   699         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   700     12  emi-claim-no                pic x(7).
   701     12  emi-claim-type              pic x(6).
   702     12  FILLER                      PIC X(124)  VALUE SPACES.
   703     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   704     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   705     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   706     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  18
* EL633.cbl
   708*                                    COPY ELCINTF.
   709******************************************************************
   710*                                                                *
   711*                                                                *
   712*                            ELCINTF.                            *
   713*                            VMOD=2.017                          *
   714*                                                                *
   715*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   716*                                                                *
   717*       LENGTH = 1024                                            *
   718*                                                                *
   719******************************************************************
   720*                   C H A N G E   L O G
   721*
   722* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   723*-----------------------------------------------------------------
   724*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   725* EFFECTIVE    NUMBER
   726*-----------------------------------------------------------------
   727* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   728******************************************************************
   729 01  PROGRAM-INTERFACE-BLOCK.
   730     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   731     12  PI-CALLING-PROGRAM              PIC X(8).
   732     12  PI-SAVED-PROGRAM-1              PIC X(8).
   733     12  PI-SAVED-PROGRAM-2              PIC X(8).
   734     12  PI-SAVED-PROGRAM-3              PIC X(8).
   735     12  PI-SAVED-PROGRAM-4              PIC X(8).
   736     12  PI-SAVED-PROGRAM-5              PIC X(8).
   737     12  PI-SAVED-PROGRAM-6              PIC X(8).
   738     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   739     12  PI-COMPANY-ID                   PIC XXX.
   740     12  PI-COMPANY-CD                   PIC X.
   741
   742     12  PI-COMPANY-PASSWORD             PIC X(8).
   743
   744     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   745
   746     12  PI-CONTROL-IN-PROGRESS.
   747         16  PI-CARRIER                  PIC X.
   748         16  PI-GROUPING                 PIC X(6).
   749         16  PI-STATE                    PIC XX.
   750         16  PI-ACCOUNT                  PIC X(10).
   751         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   752                                         PIC X(10).
   753         16  PI-CLAIM-CERT-GRP.
   754             20  PI-CLAIM-NO             PIC X(7).
   755             20  PI-CERT-NO.
   756                 25  PI-CERT-PRIME       PIC X(10).
   757                 25  PI-CERT-SFX         PIC X.
   758             20  PI-CERT-EFF-DT          PIC XX.
   759         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   760             20  PI-PLAN-CODE            PIC X(2).
   761             20  PI-REVISION-NUMBER      PIC X(3).
   762             20  PI-PLAN-EFF-DT          PIC X(2).
   763             20  PI-PLAN-EXP-DT          PIC X(2).
   764             20  FILLER                  PIC X(11).
   765         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  19
* EL633.cbl
   766             20  PI-OE-REFERENCE-1.
   767                 25  PI-OE-REF-1-PRIME   PIC X(18).
   768                 25  PI-OE-REF-1-SUFF    PIC XX.
   769
   770     12  PI-SESSION-IN-PROGRESS          PIC X.
   771         88  CLAIM-SESSION                   VALUE '1'.
   772         88  CREDIT-SESSION                  VALUE '2'.
   773         88  WARRANTY-SESSION                VALUE '3'.
   774         88  MORTGAGE-SESSION                VALUE '4'.
   775         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   776
   777
   778*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   779
   780     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   781     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   782
   783     12  PI-CREDIT-USER                  PIC X.
   784         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   785         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   786
   787     12  PI-CLAIM-USER                   PIC X.
   788         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   789         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   790
   791     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   792         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   793         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   794         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   795         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   796         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   797
   798     12  PI-PROCESSOR-ID                 PIC X(4).
   799
   800     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   801
   802     12  PI-MEMBER-CAPTION               PIC X(10).
   803
   804     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   805         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   806
   807     12  PI-LIFE-OVERRIDE-L1             PIC X.
   808     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   809     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   810     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   811
   812     12  PI-AH-OVERRIDE-L1               PIC X.
   813     12  PI-AH-OVERRIDE-L2               PIC XX.
   814     12  PI-AH-OVERRIDE-L6               PIC X(6).
   815     12  PI-AH-OVERRIDE-L12              PIC X(12).
   816
   817     12  PI-NEW-SYSTEM                   PIC X(2).
   818
   819     12  PI-PRIMARY-CERT-NO              PIC X(11).
   820     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   821         88  PI-USES-PAID-TO                 VALUE '1'.
   822     12  PI-CRDTCRD-SYSTEM.
   823         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  20
* EL633.cbl
   824             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   825             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   826         16  PI-CC-MONTH-END-DT          PIC XX.
   827     12  PI-PROCESSOR-PRINTER            PIC X(4).
   828
   829     12  PI-OE-REFERENCE-2.
   830         16  PI-OE-REF-2-PRIME           PIC X(10).
   831         16  PI-OE-REF-2-SUFF            PIC X.
   832
   833     12  PI-REM-TRM-CALC-OPTION          PIC X.
   834
   835     12  PI-LANGUAGE-TYPE                PIC X.
   836             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   837             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   838             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   839
   840     12  PI-POLICY-LINKAGE-IND           PIC X.
   841         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   842         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   843                                                   LOW-VALUES.
   844
   845     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   846     12  PI-CLAIM-PW-SESSION             PIC X(1).
   847         88  PI-CLAIM-CREDIT                 VALUE '1'.
   848         88  PI-CLAIM-CONVEN                 VALUE '2'.
   849
   850     12  PI-PROCESSOR-CSR-IND            PIC X.
   851         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   852         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   853
   854     12  FILLER                          PIC X(3).
   855
   856     12  PI-SYSTEM-LEVEL                 PIC X(145).
   857
   858     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   859         PI-SYSTEM-LEVEL.
   860
   861         16  PI-ENTRY-CODES.
   862             20  PI-ENTRY-CD-1           PIC X.
   863             20  PI-ENTRY-CD-2           PIC X.
   864
   865         16  PI-RETURN-CODES.
   866             20  PI-RETURN-CD-1          PIC X.
   867             20  PI-RETURN-CD-2          PIC X.
   868
   869         16  PI-UPDATE-STATUS-SAVE.
   870             20  PI-UPDATE-BY            PIC X(4).
   871             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   872
   873         16  PI-LOWER-CASE-LETTERS       PIC X.
   874             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   875
   876*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   877*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   878*            88  CARRIER-CLM-CNTL            VALUE '2'.
   879
   880         16  PI-CERT-ACCESS-CONTROL      PIC X.
   881             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  21
* EL633.cbl
   882             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   883             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   884             88  ACCNT-CNTL                  VALUE '3'.
   885             88  CARR-ACCNT-CNTL             VALUE '4'.
   886
   887         16  PI-PROCESSOR-CAP-LIST.
   888             20  PI-SYSTEM-CONTROLS.
   889                24 PI-SYSTEM-DISPLAY     PIC X.
   890                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   891                24 PI-SYSTEM-MODIFY      PIC X.
   892                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   893             20  FILLER                  PIC XX.
   894             20  PI-DISPLAY-CAP          PIC X.
   895                 88  DISPLAY-CAP             VALUE 'Y'.
   896             20  PI-MODIFY-CAP           PIC X.
   897                 88  MODIFY-CAP              VALUE 'Y'.
   898             20  PI-MSG-AT-LOGON-CAP     PIC X.
   899                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   900             20  PI-FORCE-CAP            PIC X.
   901                 88  FORCE-CAP               VALUE 'Y'.
   902
   903         16  PI-PROGRAM-CONTROLS.
   904             20  PI-PGM-PRINT-OPT        PIC X.
   905             20  PI-PGM-FORMAT-OPT       PIC X.
   906             20  PI-PGM-PROCESS-OPT      PIC X.
   907             20  PI-PGM-TOTALS-OPT       PIC X.
   908
   909         16  PI-HELP-INTERFACE.
   910             20  PI-LAST-ERROR-NO        PIC X(4).
   911             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   912
   913         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   914             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   915
   916         16  PI-CR-CONTROL-IN-PROGRESS.
   917             20  PI-CR-CARRIER           PIC X.
   918             20  PI-CR-GROUPING          PIC X(6).
   919             20  PI-CR-STATE             PIC XX.
   920             20  PI-CR-ACCOUNT           PIC X(10).
   921             20  PI-CR-FIN-RESP          PIC X(10).
   922             20  PI-CR-TYPE              PIC X.
   923
   924         16  PI-CR-BATCH-NUMBER          PIC X(6).
   925
   926         16  PI-CR-MONTH-END-DT          PIC XX.
   927
   928         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   929             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   930             88  PI-ZERO-CARRIER             VALUE '1'.
   931             88  PI-ZERO-GROUPING            VALUE '2'.
   932             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   933
   934         16  PI-CARRIER-SECURITY         PIC X.
   935             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   936
   937         16  PI-ACCOUNT-SECURITY         PIC X(10).
   938             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   939             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  22
* EL633.cbl
   940
   941         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   942             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   943                                         INDEXED BY PI-ACCESS-NDX
   944                                         PIC X.
   945
   946         16  PI-GA-BILLING-CONTROL       PIC X.
   947             88  PI-GA-BILLING               VALUE '1'.
   948
   949         16  PI-MAIL-PROCESSING          PIC X.
   950             88  PI-MAIL-YES                 VALUE 'Y'.
   951
   952         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   953
   954         16  PI-AR-SYSTEM.
   955             20  PI-AR-PROCESSING-CNTL   PIC X.
   956                 88  PI-AR-PROCESSING        VALUE 'Y'.
   957             20  PI-AR-SUMMARY-CODE      PIC X(6).
   958             20  PI-AR-MONTH-END-DT      PIC XX.
   959
   960         16  PI-MP-SYSTEM.
   961             20  PI-MORTGAGE-USER            PIC X.
   962                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   963                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   964             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   965                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   966                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   967                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   968                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   969                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   970             20  PI-MP-MONTH-END-DT          PIC XX.
   971             20  PI-MP-REFERENCE-NO.
   972                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   973                 24  PI-MP-REFERENCE-SFX     PIC XX.
   974
   975         16  PI-LABEL-CONTROL            PIC X(01).
   976             88  PI-CREATE-LABELS                    VALUE 'Y'.
   977             88  PI-BYPASS-LABELS                    VALUE 'N'.
   978
   979         16  PI-BILL-GROUPING-CODE       PIC X(01).
   980             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   981
   982         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   983             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   984             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   985
   986         16  FILLER                      PIC X(14).
   987
   988     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   989******************************************************************
   990     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   991         16  PI-PYAJ-FILE-SW             PIC  X.
   992             88  END-OF-ACCT                 VALUE 'A'.
   993             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   994             88  END-OF-FILE                 VALUE 'X'.
   995             88  TOP-OF-FILE                 VALUE 'T'.
   996             88  PAGE-FULL                   VALUE 'F'.
   997             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  23
* EL633.cbl
   998             88  NOT-OPEN                    VALUE 'Z'.
   999         16  PI-PREV-FUNCTION            PIC  X.
  1000         16  PI-SAV-FUNCTION             PIC  X.
  1001         16  PI-PREV-PFKEY               PIC  X.
  1002         16  PI-SEQ-NOS.
  1003             20  FILLER  OCCURS 13 TIMES
  1004                             INDEXED BY NDX.
  1005                 24  PI-REC-TYPE         PIC  X.
  1006                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1007         16  PI-SAV-ENDING-PYAJ-KEY.
  1008             20  PI-SAV-COMP-CD          PIC  X.
  1009             20  PI-SAV-COMP-CONTROL.
  1010                 24  PI-SAV-CARRIER      PIC  X.
  1011                 24  PI-SAV-GROUPING     PIC  X(6).
  1012                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1013                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1014                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1015                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1016         16  PI-START-PYAJ-KEY           PIC  X(33).
  1017         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1018         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1019         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1020         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1021         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1022             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1023         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1024         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1025         16  PI-FRST-RECORD-TYPE         PIC  X.
  1026         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1027         16  PI-PREV-RECORD-TYPE         PIC  X.
  1028         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1029         16  PI-LAST-RECORD-TYPE         PIC  X.
  1030         16  PI-PAGE-SW                  PIC  X.
  1031             88  FIRST-PAGE                          VALUE 'Y'.
  1032         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  24
* EL633.cbl
  1034*                            COPY ELCJPFX.
  1035******************************************************************
  1036*                                                                *
  1037*                                                                *
  1038*                            ELCJPFX.                            *
  1039*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1040*                            VMOD=2.002                          *
  1041*                                                                *
  1042*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1043*                                                                *
  1044*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1045*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1046*        ELCNTL - CONTROL FILE                                   *
  1047*        ELMSTR - CLAIM MASTERS                                  *
  1048*        ELTRLR - ACTIVITY TRAILERS                              *
  1049*        ELCHKQ - CHECK QUE                                      *
  1050******************************************************************
  1051 01  JOURNAL-RECORD.
  1052     12  jp-date                     pic s9(5) comp-3.
  1053     12  jp-time                     pic s9(7) comp-3.
  1054     12  JP-USER-ID                  PIC X(4).
  1055     12  JP-FILE-ID                  PIC X(8).
  1056     12  JP-PROGRAM-ID               PIC X(8).
  1057     12  JP-RECORD-TYPE              PIC X.
  1058         88 JP-ADD              VALUE 'A'.
  1059         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1060         88 JP-AFTER-CHANGE     VALUE 'C'.
  1061         88 JP-DELETE           VALUE 'D'.
  1062         88 JP-GENERIC-DELETE   VALUE 'G'.
  1063         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1064         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1065     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1066     12  JP-RECORD-AREA
  1067
  1068
  1069                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  25
* EL633.cbl
  1071*                            COPY ELCAID.
  1072******************************************************************
  1073*                                                                *
  1074*                            ELCAID.                             *
  1075*                            VMOD=2.001                          *
  1076*                                                                *
  1077*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1078*                                                                *
  1079*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1080*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1081******************************************************************
  1082
  1083 01  DFHAID.
  1084   02  DFHNULL   PIC  X  VALUE  ' '.
  1085   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1086   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1087   02  DFHPEN    PIC  X  VALUE  '='.
  1088   02  DFHOPID   PIC  X  VALUE  'W'.
  1089   02  DFHPA1    PIC  X  VALUE  '%'.
  1090   02  DFHPA2    PIC  X  VALUE  '>'.
  1091   02  DFHPA3    PIC  X  VALUE  ','.
  1092   02  DFHPF1    PIC  X  VALUE  '1'.
  1093   02  DFHPF2    PIC  X  VALUE  '2'.
  1094   02  DFHPF3    PIC  X  VALUE  '3'.
  1095   02  DFHPF4    PIC  X  VALUE  '4'.
  1096   02  DFHPF5    PIC  X  VALUE  '5'.
  1097   02  DFHPF6    PIC  X  VALUE  '6'.
  1098   02  DFHPF7    PIC  X  VALUE  '7'.
  1099   02  DFHPF8    PIC  X  VALUE  '8'.
  1100   02  DFHPF9    PIC  X  VALUE  '9'.
  1101   02  DFHPF10   PIC  X  VALUE  ':'.
  1102   02  DFHPF11   PIC  X  VALUE  '#'.
  1103   02  DFHPF12   PIC  X  VALUE  '@'.
  1104   02  DFHPF13   PIC  X  VALUE  'A'.
  1105   02  DFHPF14   PIC  X  VALUE  'B'.
  1106   02  DFHPF15   PIC  X  VALUE  'C'.
  1107   02  DFHPF16   PIC  X  VALUE  'D'.
  1108   02  DFHPF17   PIC  X  VALUE  'E'.
  1109   02  DFHPF18   PIC  X  VALUE  'F'.
  1110   02  DFHPF19   PIC  X  VALUE  'G'.
  1111   02  DFHPF20   PIC  X  VALUE  'H'.
  1112   02  DFHPF21   PIC  X  VALUE  'I'.
  1113*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1114   02  DFHPF22   PIC  X  VALUE  '['.
  1115   02  DFHPF23   PIC  X  VALUE  '.'.
  1116   02  DFHPF24   PIC  X  VALUE  '<'.
  1117   02  DFHMSRE   PIC  X  VALUE  'X'.
  1118   02  DFHSTRF   PIC  X  VALUE  'h'.
  1119   02  DFHTRIG   PIC  X  VALUE  '"'.
  1120
  1121 01  FILLER  REDEFINES  DFHAID.
  1122     12  FILLER              PIC  X(8).
  1123     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  26
* EL633.cbl
  1125*                            COPY EL633S.
  1126 01  EL633AI.
  1127     05  FILLER            PIC  X(0012).
  1128*    -------------------------------
  1129     05  DATEL PIC S9(0004) COMP.
  1130     05  DATEF PIC  X(0001).
  1131     05  FILLER REDEFINES DATEF.
  1132         10  DATEA PIC  X(0001).
  1133     05  DATEI PIC  X(0008).
  1134*    -------------------------------
  1135     05  TIMEL PIC S9(0004) COMP.
  1136     05  TIMEF PIC  X(0001).
  1137     05  FILLER REDEFINES TIMEF.
  1138         10  TIMEA PIC  X(0001).
  1139     05  TIMEI PIC  X(0005).
  1140*    -------------------------------
  1141     05  CMPNYIDL PIC S9(0004) COMP.
  1142     05  CMPNYIDF PIC  X(0001).
  1143     05  FILLER REDEFINES CMPNYIDF.
  1144         10  CMPNYIDA PIC  X(0001).
  1145     05  CMPNYIDI PIC  X(0003).
  1146*    -------------------------------
  1147     05  USERIDL PIC S9(0004) COMP.
  1148     05  USERIDF PIC  X(0001).
  1149     05  FILLER REDEFINES USERIDF.
  1150         10  USERIDA PIC  X(0001).
  1151     05  USERIDI PIC  X(0004).
  1152*    -------------------------------
  1153     05  MAINTL PIC S9(0004) COMP.
  1154     05  MAINTF PIC  X(0001).
  1155     05  FILLER REDEFINES MAINTF.
  1156         10  MAINTA PIC  X(0001).
  1157     05  MAINTI PIC  X(0001).
  1158*    -------------------------------
  1159     05  CARRIERL PIC S9(0004) COMP.
  1160     05  CARRIERF PIC  X(0001).
  1161     05  FILLER REDEFINES CARRIERF.
  1162         10  CARRIERA PIC  X(0001).
  1163     05  CARRIERI PIC  X(0001).
  1164*    -------------------------------
  1165     05  GROUPL PIC S9(0004) COMP.
  1166     05  GROUPF PIC  X(0001).
  1167     05  FILLER REDEFINES GROUPF.
  1168         10  GROUPA PIC  X(0001).
  1169     05  GROUPI PIC  X(0006).
  1170*    -------------------------------
  1171     05  FINRESPL PIC S9(0004) COMP.
  1172     05  FINRESPF PIC  X(0001).
  1173     05  FILLER REDEFINES FINRESPF.
  1174         10  FINRESPA PIC  X(0001).
  1175     05  FINRESPI PIC  X(0010).
  1176*    -------------------------------
  1177     05  ACCTL PIC S9(0004) COMP.
  1178     05  ACCTF PIC  X(0001).
  1179     05  FILLER REDEFINES ACCTF.
  1180         10  ACCTA PIC  X(0001).
  1181     05  ACCTI PIC  X(0010).
  1182*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  27
* EL633.cbl
  1183     05  MSAAC1L PIC S9(0004) COMP.
  1184     05  MSAAC1F PIC  X(0001).
  1185     05  FILLER REDEFINES MSAAC1F.
  1186         10  MSAAC1A PIC  X(0001).
  1187     05  MSAAC1I PIC  X(0010).
  1188*    -------------------------------
  1189     05  MSAST1L PIC S9(0004) COMP.
  1190     05  MSAST1F PIC  X(0001).
  1191     05  FILLER REDEFINES MSAST1F.
  1192         10  MSAST1A PIC  X(0001).
  1193     05  MSAST1I PIC  X(0002).
  1194*    -------------------------------
  1195     05  MSACN1L PIC S9(0004) COMP.
  1196     05  MSACN1F PIC  X(0001).
  1197     05  FILLER REDEFINES MSACN1F.
  1198         10  MSACN1A PIC  X(0001).
  1199     05  MSACN1I PIC  X(0001).
  1200*    -------------------------------
  1201     05  MSACM1L PIC S9(0004) COMP.
  1202     05  MSACM1F PIC  X(0001).
  1203     05  FILLER REDEFINES MSACM1F.
  1204         10  MSACM1A PIC  X(0001).
  1205     05  MSACM1I PIC  X(0010).
  1206*    -------------------------------
  1207     05  TYPE1L PIC S9(0004) COMP.
  1208     05  TYPE1F PIC  X(0001).
  1209     05  FILLER REDEFINES TYPE1F.
  1210         10  TYPE1A PIC  X(0001).
  1211     05  TYPE1I PIC  X(0001).
  1212*    -------------------------------
  1213     05  AMT1L PIC S9(0004) COMP.
  1214     05  AMT1F PIC  X(0001).
  1215     05  FILLER REDEFINES AMT1F.
  1216         10  AMT1A PIC  X(0001).
  1217     05  AMT1I PIC  X(0011).
  1218*    -------------------------------
  1219     05  VOID1L PIC S9(0004) COMP.
  1220     05  VOID1F PIC  X(0001).
  1221     05  FILLER REDEFINES VOID1F.
  1222         10  VOID1A PIC  X(0001).
  1223     05  VOID1I PIC  X(0001).
  1224*    -------------------------------
  1225     05  MDT1L PIC S9(0004) COMP.
  1226     05  MDT1F PIC  X(0001).
  1227     05  FILLER REDEFINES MDT1F.
  1228         10  MDT1A PIC  X(0001).
  1229     05  MDT1I PIC  X(0006).
  1230*    -------------------------------
  1231     05  BDT1L PIC S9(0004) COMP.
  1232     05  BDT1F PIC  X(0001).
  1233     05  FILLER REDEFINES BDT1F.
  1234         10  BDT1A PIC  X(0001).
  1235     05  BDT1I PIC  X(0006).
  1236*    -------------------------------
  1237     05  SDT1L PIC S9(0004) COMP.
  1238     05  SDT1F PIC  X(0001).
  1239     05  FILLER REDEFINES SDT1F.
  1240         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  28
* EL633.cbl
  1241     05  SDT1I PIC  X(0006).
  1242*    -------------------------------
  1243     05  MSAAC2L PIC S9(0004) COMP.
  1244     05  MSAAC2F PIC  X(0001).
  1245     05  FILLER REDEFINES MSAAC2F.
  1246         10  MSAAC2A PIC  X(0001).
  1247     05  MSAAC2I PIC  X(0010).
  1248*    -------------------------------
  1249     05  MSAST2L PIC S9(0004) COMP.
  1250     05  MSAST2F PIC  X(0001).
  1251     05  FILLER REDEFINES MSAST2F.
  1252         10  MSAST2A PIC  X(0001).
  1253     05  MSAST2I PIC  X(0002).
  1254*    -------------------------------
  1255     05  MSACN2L PIC S9(0004) COMP.
  1256     05  MSACN2F PIC  X(0001).
  1257     05  FILLER REDEFINES MSACN2F.
  1258         10  MSACN2A PIC  X(0001).
  1259     05  MSACN2I PIC  X(0001).
  1260*    -------------------------------
  1261     05  MSACM2L PIC S9(0004) COMP.
  1262     05  MSACM2F PIC  X(0001).
  1263     05  FILLER REDEFINES MSACM2F.
  1264         10  MSACM2A PIC  X(0001).
  1265     05  MSACM2I PIC  X(0010).
  1266*    -------------------------------
  1267     05  TYPE2L PIC S9(0004) COMP.
  1268     05  TYPE2F PIC  X(0001).
  1269     05  FILLER REDEFINES TYPE2F.
  1270         10  TYPE2A PIC  X(0001).
  1271     05  TYPE2I PIC  X(0001).
  1272*    -------------------------------
  1273     05  AMT2L PIC S9(0004) COMP.
  1274     05  AMT2F PIC  X(0001).
  1275     05  FILLER REDEFINES AMT2F.
  1276         10  AMT2A PIC  X(0001).
  1277     05  AMT2I PIC  X(0011).
  1278*    -------------------------------
  1279     05  VOID2L PIC S9(0004) COMP.
  1280     05  VOID2F PIC  X(0001).
  1281     05  FILLER REDEFINES VOID2F.
  1282         10  VOID2A PIC  X(0001).
  1283     05  VOID2I PIC  X(0001).
  1284*    -------------------------------
  1285     05  MDT2L PIC S9(0004) COMP.
  1286     05  MDT2F PIC  X(0001).
  1287     05  FILLER REDEFINES MDT2F.
  1288         10  MDT2A PIC  X(0001).
  1289     05  MDT2I PIC  X(0006).
  1290*    -------------------------------
  1291     05  BDT2L PIC S9(0004) COMP.
  1292     05  BDT2F PIC  X(0001).
  1293     05  FILLER REDEFINES BDT2F.
  1294         10  BDT2A PIC  X(0001).
  1295     05  BDT2I PIC  X(0006).
  1296*    -------------------------------
  1297     05  SDT2L PIC S9(0004) COMP.
  1298     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  29
* EL633.cbl
  1299     05  FILLER REDEFINES SDT2F.
  1300         10  SDT2A PIC  X(0001).
  1301     05  SDT2I PIC  X(0006).
  1302*    -------------------------------
  1303     05  MSAAC3L PIC S9(0004) COMP.
  1304     05  MSAAC3F PIC  X(0001).
  1305     05  FILLER REDEFINES MSAAC3F.
  1306         10  MSAAC3A PIC  X(0001).
  1307     05  MSAAC3I PIC  X(0010).
  1308*    -------------------------------
  1309     05  MSAST3L PIC S9(0004) COMP.
  1310     05  MSAST3F PIC  X(0001).
  1311     05  FILLER REDEFINES MSAST3F.
  1312         10  MSAST3A PIC  X(0001).
  1313     05  MSAST3I PIC  X(0002).
  1314*    -------------------------------
  1315     05  MSACN3L PIC S9(0004) COMP.
  1316     05  MSACN3F PIC  X(0001).
  1317     05  FILLER REDEFINES MSACN3F.
  1318         10  MSACN3A PIC  X(0001).
  1319     05  MSACN3I PIC  X(0001).
  1320*    -------------------------------
  1321     05  MSACM3L PIC S9(0004) COMP.
  1322     05  MSACM3F PIC  X(0001).
  1323     05  FILLER REDEFINES MSACM3F.
  1324         10  MSACM3A PIC  X(0001).
  1325     05  MSACM3I PIC  X(0010).
  1326*    -------------------------------
  1327     05  TYPE3L PIC S9(0004) COMP.
  1328     05  TYPE3F PIC  X(0001).
  1329     05  FILLER REDEFINES TYPE3F.
  1330         10  TYPE3A PIC  X(0001).
  1331     05  TYPE3I PIC  X(0001).
  1332*    -------------------------------
  1333     05  AMT3L PIC S9(0004) COMP.
  1334     05  AMT3F PIC  X(0001).
  1335     05  FILLER REDEFINES AMT3F.
  1336         10  AMT3A PIC  X(0001).
  1337     05  AMT3I PIC  X(0011).
  1338*    -------------------------------
  1339     05  VOID3L PIC S9(0004) COMP.
  1340     05  VOID3F PIC  X(0001).
  1341     05  FILLER REDEFINES VOID3F.
  1342         10  VOID3A PIC  X(0001).
  1343     05  VOID3I PIC  X(0001).
  1344*    -------------------------------
  1345     05  MDT3L PIC S9(0004) COMP.
  1346     05  MDT3F PIC  X(0001).
  1347     05  FILLER REDEFINES MDT3F.
  1348         10  MDT3A PIC  X(0001).
  1349     05  MDT3I PIC  X(0006).
  1350*    -------------------------------
  1351     05  BDT3L PIC S9(0004) COMP.
  1352     05  BDT3F PIC  X(0001).
  1353     05  FILLER REDEFINES BDT3F.
  1354         10  BDT3A PIC  X(0001).
  1355     05  BDT3I PIC  X(0006).
  1356*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  30
* EL633.cbl
  1357     05  SDT3L PIC S9(0004) COMP.
  1358     05  SDT3F PIC  X(0001).
  1359     05  FILLER REDEFINES SDT3F.
  1360         10  SDT3A PIC  X(0001).
  1361     05  SDT3I PIC  X(0006).
  1362*    -------------------------------
  1363     05  MSAAC4L PIC S9(0004) COMP.
  1364     05  MSAAC4F PIC  X(0001).
  1365     05  FILLER REDEFINES MSAAC4F.
  1366         10  MSAAC4A PIC  X(0001).
  1367     05  MSAAC4I PIC  X(0010).
  1368*    -------------------------------
  1369     05  MSAST4L PIC S9(0004) COMP.
  1370     05  MSAST4F PIC  X(0001).
  1371     05  FILLER REDEFINES MSAST4F.
  1372         10  MSAST4A PIC  X(0001).
  1373     05  MSAST4I PIC  X(0002).
  1374*    -------------------------------
  1375     05  MSACN4L PIC S9(0004) COMP.
  1376     05  MSACN4F PIC  X(0001).
  1377     05  FILLER REDEFINES MSACN4F.
  1378         10  MSACN4A PIC  X(0001).
  1379     05  MSACN4I PIC  X(0001).
  1380*    -------------------------------
  1381     05  MSACM4L PIC S9(0004) COMP.
  1382     05  MSACM4F PIC  X(0001).
  1383     05  FILLER REDEFINES MSACM4F.
  1384         10  MSACM4A PIC  X(0001).
  1385     05  MSACM4I PIC  X(0010).
  1386*    -------------------------------
  1387     05  TYPE4L PIC S9(0004) COMP.
  1388     05  TYPE4F PIC  X(0001).
  1389     05  FILLER REDEFINES TYPE4F.
  1390         10  TYPE4A PIC  X(0001).
  1391     05  TYPE4I PIC  X(0001).
  1392*    -------------------------------
  1393     05  AMT4L PIC S9(0004) COMP.
  1394     05  AMT4F PIC  X(0001).
  1395     05  FILLER REDEFINES AMT4F.
  1396         10  AMT4A PIC  X(0001).
  1397     05  AMT4I PIC  X(0011).
  1398*    -------------------------------
  1399     05  VOID4L PIC S9(0004) COMP.
  1400     05  VOID4F PIC  X(0001).
  1401     05  FILLER REDEFINES VOID4F.
  1402         10  VOID4A PIC  X(0001).
  1403     05  VOID4I PIC  X(0001).
  1404*    -------------------------------
  1405     05  MDT4L PIC S9(0004) COMP.
  1406     05  MDT4F PIC  X(0001).
  1407     05  FILLER REDEFINES MDT4F.
  1408         10  MDT4A PIC  X(0001).
  1409     05  MDT4I PIC  X(0006).
  1410*    -------------------------------
  1411     05  BDT4L PIC S9(0004) COMP.
  1412     05  BDT4F PIC  X(0001).
  1413     05  FILLER REDEFINES BDT4F.
  1414         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  31
* EL633.cbl
  1415     05  BDT4I PIC  X(0006).
  1416*    -------------------------------
  1417     05  SDT4L PIC S9(0004) COMP.
  1418     05  SDT4F PIC  X(0001).
  1419     05  FILLER REDEFINES SDT4F.
  1420         10  SDT4A PIC  X(0001).
  1421     05  SDT4I PIC  X(0006).
  1422*    -------------------------------
  1423     05  MSAAC5L PIC S9(0004) COMP.
  1424     05  MSAAC5F PIC  X(0001).
  1425     05  FILLER REDEFINES MSAAC5F.
  1426         10  MSAAC5A PIC  X(0001).
  1427     05  MSAAC5I PIC  X(0010).
  1428*    -------------------------------
  1429     05  MSAST5L PIC S9(0004) COMP.
  1430     05  MSAST5F PIC  X(0001).
  1431     05  FILLER REDEFINES MSAST5F.
  1432         10  MSAST5A PIC  X(0001).
  1433     05  MSAST5I PIC  X(0002).
  1434*    -------------------------------
  1435     05  MSACN5L PIC S9(0004) COMP.
  1436     05  MSACN5F PIC  X(0001).
  1437     05  FILLER REDEFINES MSACN5F.
  1438         10  MSACN5A PIC  X(0001).
  1439     05  MSACN5I PIC  X(0001).
  1440*    -------------------------------
  1441     05  MSACM5L PIC S9(0004) COMP.
  1442     05  MSACM5F PIC  X(0001).
  1443     05  FILLER REDEFINES MSACM5F.
  1444         10  MSACM5A PIC  X(0001).
  1445     05  MSACM5I PIC  X(0010).
  1446*    -------------------------------
  1447     05  TYPE5L PIC S9(0004) COMP.
  1448     05  TYPE5F PIC  X(0001).
  1449     05  FILLER REDEFINES TYPE5F.
  1450         10  TYPE5A PIC  X(0001).
  1451     05  TYPE5I PIC  X(0001).
  1452*    -------------------------------
  1453     05  AMT5L PIC S9(0004) COMP.
  1454     05  AMT5F PIC  X(0001).
  1455     05  FILLER REDEFINES AMT5F.
  1456         10  AMT5A PIC  X(0001).
  1457     05  AMT5I PIC  X(0011).
  1458*    -------------------------------
  1459     05  VOID5L PIC S9(0004) COMP.
  1460     05  VOID5F PIC  X(0001).
  1461     05  FILLER REDEFINES VOID5F.
  1462         10  VOID5A PIC  X(0001).
  1463     05  VOID5I PIC  X(0001).
  1464*    -------------------------------
  1465     05  MDT5L PIC S9(0004) COMP.
  1466     05  MDT5F PIC  X(0001).
  1467     05  FILLER REDEFINES MDT5F.
  1468         10  MDT5A PIC  X(0001).
  1469     05  MDT5I PIC  X(0006).
  1470*    -------------------------------
  1471     05  BDT5L PIC S9(0004) COMP.
  1472     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  32
* EL633.cbl
  1473     05  FILLER REDEFINES BDT5F.
  1474         10  BDT5A PIC  X(0001).
  1475     05  BDT5I PIC  X(0006).
  1476*    -------------------------------
  1477     05  SDT5L PIC S9(0004) COMP.
  1478     05  SDT5F PIC  X(0001).
  1479     05  FILLER REDEFINES SDT5F.
  1480         10  SDT5A PIC  X(0001).
  1481     05  SDT5I PIC  X(0006).
  1482*    -------------------------------
  1483     05  MSAAC6L PIC S9(0004) COMP.
  1484     05  MSAAC6F PIC  X(0001).
  1485     05  FILLER REDEFINES MSAAC6F.
  1486         10  MSAAC6A PIC  X(0001).
  1487     05  MSAAC6I PIC  X(0010).
  1488*    -------------------------------
  1489     05  MSAST6L PIC S9(0004) COMP.
  1490     05  MSAST6F PIC  X(0001).
  1491     05  FILLER REDEFINES MSAST6F.
  1492         10  MSAST6A PIC  X(0001).
  1493     05  MSAST6I PIC  X(0002).
  1494*    -------------------------------
  1495     05  MSACN6L PIC S9(0004) COMP.
  1496     05  MSACN6F PIC  X(0001).
  1497     05  FILLER REDEFINES MSACN6F.
  1498         10  MSACN6A PIC  X(0001).
  1499     05  MSACN6I PIC  X(0001).
  1500*    -------------------------------
  1501     05  MSACM6L PIC S9(0004) COMP.
  1502     05  MSACM6F PIC  X(0001).
  1503     05  FILLER REDEFINES MSACM6F.
  1504         10  MSACM6A PIC  X(0001).
  1505     05  MSACM6I PIC  X(0010).
  1506*    -------------------------------
  1507     05  TYPE6L PIC S9(0004) COMP.
  1508     05  TYPE6F PIC  X(0001).
  1509     05  FILLER REDEFINES TYPE6F.
  1510         10  TYPE6A PIC  X(0001).
  1511     05  TYPE6I PIC  X(0001).
  1512*    -------------------------------
  1513     05  AMT6L PIC S9(0004) COMP.
  1514     05  AMT6F PIC  X(0001).
  1515     05  FILLER REDEFINES AMT6F.
  1516         10  AMT6A PIC  X(0001).
  1517     05  AMT6I PIC  X(0011).
  1518*    -------------------------------
  1519     05  VOID6L PIC S9(0004) COMP.
  1520     05  VOID6F PIC  X(0001).
  1521     05  FILLER REDEFINES VOID6F.
  1522         10  VOID6A PIC  X(0001).
  1523     05  VOID6I PIC  X(0001).
  1524*    -------------------------------
  1525     05  MDT6L PIC S9(0004) COMP.
  1526     05  MDT6F PIC  X(0001).
  1527     05  FILLER REDEFINES MDT6F.
  1528         10  MDT6A PIC  X(0001).
  1529     05  MDT6I PIC  X(0006).
  1530*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  33
* EL633.cbl
  1531     05  BDT6L PIC S9(0004) COMP.
  1532     05  BDT6F PIC  X(0001).
  1533     05  FILLER REDEFINES BDT6F.
  1534         10  BDT6A PIC  X(0001).
  1535     05  BDT6I PIC  X(0006).
  1536*    -------------------------------
  1537     05  SDT6L PIC S9(0004) COMP.
  1538     05  SDT6F PIC  X(0001).
  1539     05  FILLER REDEFINES SDT6F.
  1540         10  SDT6A PIC  X(0001).
  1541     05  SDT6I PIC  X(0006).
  1542*    -------------------------------
  1543     05  MSAAC7L PIC S9(0004) COMP.
  1544     05  MSAAC7F PIC  X(0001).
  1545     05  FILLER REDEFINES MSAAC7F.
  1546         10  MSAAC7A PIC  X(0001).
  1547     05  MSAAC7I PIC  X(0010).
  1548*    -------------------------------
  1549     05  MSAST7L PIC S9(0004) COMP.
  1550     05  MSAST7F PIC  X(0001).
  1551     05  FILLER REDEFINES MSAST7F.
  1552         10  MSAST7A PIC  X(0001).
  1553     05  MSAST7I PIC  X(0002).
  1554*    -------------------------------
  1555     05  MSACN7L PIC S9(0004) COMP.
  1556     05  MSACN7F PIC  X(0001).
  1557     05  FILLER REDEFINES MSACN7F.
  1558         10  MSACN7A PIC  X(0001).
  1559     05  MSACN7I PIC  X(0001).
  1560*    -------------------------------
  1561     05  MSACM7L PIC S9(0004) COMP.
  1562     05  MSACM7F PIC  X(0001).
  1563     05  FILLER REDEFINES MSACM7F.
  1564         10  MSACM7A PIC  X(0001).
  1565     05  MSACM7I PIC  X(0010).
  1566*    -------------------------------
  1567     05  TYPE7L PIC S9(0004) COMP.
  1568     05  TYPE7F PIC  X(0001).
  1569     05  FILLER REDEFINES TYPE7F.
  1570         10  TYPE7A PIC  X(0001).
  1571     05  TYPE7I PIC  X(0001).
  1572*    -------------------------------
  1573     05  AMT7L PIC S9(0004) COMP.
  1574     05  AMT7F PIC  X(0001).
  1575     05  FILLER REDEFINES AMT7F.
  1576         10  AMT7A PIC  X(0001).
  1577     05  AMT7I PIC  X(0011).
  1578*    -------------------------------
  1579     05  VOID7L PIC S9(0004) COMP.
  1580     05  VOID7F PIC  X(0001).
  1581     05  FILLER REDEFINES VOID7F.
  1582         10  VOID7A PIC  X(0001).
  1583     05  VOID7I PIC  X(0001).
  1584*    -------------------------------
  1585     05  MDT7L PIC S9(0004) COMP.
  1586     05  MDT7F PIC  X(0001).
  1587     05  FILLER REDEFINES MDT7F.
  1588         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  34
* EL633.cbl
  1589     05  MDT7I PIC  X(0006).
  1590*    -------------------------------
  1591     05  BDT7L PIC S9(0004) COMP.
  1592     05  BDT7F PIC  X(0001).
  1593     05  FILLER REDEFINES BDT7F.
  1594         10  BDT7A PIC  X(0001).
  1595     05  BDT7I PIC  X(0006).
  1596*    -------------------------------
  1597     05  SDT7L PIC S9(0004) COMP.
  1598     05  SDT7F PIC  X(0001).
  1599     05  FILLER REDEFINES SDT7F.
  1600         10  SDT7A PIC  X(0001).
  1601     05  SDT7I PIC  X(0006).
  1602*    -------------------------------
  1603     05  MSAAC8L PIC S9(0004) COMP.
  1604     05  MSAAC8F PIC  X(0001).
  1605     05  FILLER REDEFINES MSAAC8F.
  1606         10  MSAAC8A PIC  X(0001).
  1607     05  MSAAC8I PIC  X(0010).
  1608*    -------------------------------
  1609     05  MSAST8L PIC S9(0004) COMP.
  1610     05  MSAST8F PIC  X(0001).
  1611     05  FILLER REDEFINES MSAST8F.
  1612         10  MSAST8A PIC  X(0001).
  1613     05  MSAST8I PIC  X(0002).
  1614*    -------------------------------
  1615     05  MSACN8L PIC S9(0004) COMP.
  1616     05  MSACN8F PIC  X(0001).
  1617     05  FILLER REDEFINES MSACN8F.
  1618         10  MSACN8A PIC  X(0001).
  1619     05  MSACN8I PIC  X(0001).
  1620*    -------------------------------
  1621     05  MSACM8L PIC S9(0004) COMP.
  1622     05  MSACM8F PIC  X(0001).
  1623     05  FILLER REDEFINES MSACM8F.
  1624         10  MSACM8A PIC  X(0001).
  1625     05  MSACM8I PIC  X(0010).
  1626*    -------------------------------
  1627     05  TYPE8L PIC S9(0004) COMP.
  1628     05  TYPE8F PIC  X(0001).
  1629     05  FILLER REDEFINES TYPE8F.
  1630         10  TYPE8A PIC  X(0001).
  1631     05  TYPE8I PIC  X(0001).
  1632*    -------------------------------
  1633     05  AMT8L PIC S9(0004) COMP.
  1634     05  AMT8F PIC  X(0001).
  1635     05  FILLER REDEFINES AMT8F.
  1636         10  AMT8A PIC  X(0001).
  1637     05  AMT8I PIC  X(0011).
  1638*    -------------------------------
  1639     05  VOID8L PIC S9(0004) COMP.
  1640     05  VOID8F PIC  X(0001).
  1641     05  FILLER REDEFINES VOID8F.
  1642         10  VOID8A PIC  X(0001).
  1643     05  VOID8I PIC  X(0001).
  1644*    -------------------------------
  1645     05  MDT8L PIC S9(0004) COMP.
  1646     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  35
* EL633.cbl
  1647     05  FILLER REDEFINES MDT8F.
  1648         10  MDT8A PIC  X(0001).
  1649     05  MDT8I PIC  X(0006).
  1650*    -------------------------------
  1651     05  BDT8L PIC S9(0004) COMP.
  1652     05  BDT8F PIC  X(0001).
  1653     05  FILLER REDEFINES BDT8F.
  1654         10  BDT8A PIC  X(0001).
  1655     05  BDT8I PIC  X(0006).
  1656*    -------------------------------
  1657     05  SDT8L PIC S9(0004) COMP.
  1658     05  SDT8F PIC  X(0001).
  1659     05  FILLER REDEFINES SDT8F.
  1660         10  SDT8A PIC  X(0001).
  1661     05  SDT8I PIC  X(0006).
  1662*    -------------------------------
  1663     05  MSAAC9L PIC S9(0004) COMP.
  1664     05  MSAAC9F PIC  X(0001).
  1665     05  FILLER REDEFINES MSAAC9F.
  1666         10  MSAAC9A PIC  X(0001).
  1667     05  MSAAC9I PIC  X(0010).
  1668*    -------------------------------
  1669     05  MSAST9L PIC S9(0004) COMP.
  1670     05  MSAST9F PIC  X(0001).
  1671     05  FILLER REDEFINES MSAST9F.
  1672         10  MSAST9A PIC  X(0001).
  1673     05  MSAST9I PIC  X(0002).
  1674*    -------------------------------
  1675     05  MSACN9L PIC S9(0004) COMP.
  1676     05  MSACN9F PIC  X(0001).
  1677     05  FILLER REDEFINES MSACN9F.
  1678         10  MSACN9A PIC  X(0001).
  1679     05  MSACN9I PIC  X(0001).
  1680*    -------------------------------
  1681     05  MSACM9L PIC S9(0004) COMP.
  1682     05  MSACM9F PIC  X(0001).
  1683     05  FILLER REDEFINES MSACM9F.
  1684         10  MSACM9A PIC  X(0001).
  1685     05  MSACM9I PIC  X(0010).
  1686*    -------------------------------
  1687     05  TYPE9L PIC S9(0004) COMP.
  1688     05  TYPE9F PIC  X(0001).
  1689     05  FILLER REDEFINES TYPE9F.
  1690         10  TYPE9A PIC  X(0001).
  1691     05  TYPE9I PIC  X(0001).
  1692*    -------------------------------
  1693     05  AMT9L PIC S9(0004) COMP.
  1694     05  AMT9F PIC  X(0001).
  1695     05  FILLER REDEFINES AMT9F.
  1696         10  AMT9A PIC  X(0001).
  1697     05  AMT9I PIC  X(0011).
  1698*    -------------------------------
  1699     05  VOID9L PIC S9(0004) COMP.
  1700     05  VOID9F PIC  X(0001).
  1701     05  FILLER REDEFINES VOID9F.
  1702         10  VOID9A PIC  X(0001).
  1703     05  VOID9I PIC  X(0001).
  1704*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  36
* EL633.cbl
  1705     05  MDT9L PIC S9(0004) COMP.
  1706     05  MDT9F PIC  X(0001).
  1707     05  FILLER REDEFINES MDT9F.
  1708         10  MDT9A PIC  X(0001).
  1709     05  MDT9I PIC  X(0006).
  1710*    -------------------------------
  1711     05  BDT9L PIC S9(0004) COMP.
  1712     05  BDT9F PIC  X(0001).
  1713     05  FILLER REDEFINES BDT9F.
  1714         10  BDT9A PIC  X(0001).
  1715     05  BDT9I PIC  X(0006).
  1716*    -------------------------------
  1717     05  SDT9L PIC S9(0004) COMP.
  1718     05  SDT9F PIC  X(0001).
  1719     05  FILLER REDEFINES SDT9F.
  1720         10  SDT9A PIC  X(0001).
  1721     05  SDT9I PIC  X(0006).
  1722*    -------------------------------
  1723     05  MSAAC10L PIC S9(0004) COMP.
  1724     05  MSAAC10F PIC  X(0001).
  1725     05  FILLER REDEFINES MSAAC10F.
  1726         10  MSAAC10A PIC  X(0001).
  1727     05  MSAAC10I PIC  X(0010).
  1728*    -------------------------------
  1729     05  MSAST10L PIC S9(0004) COMP.
  1730     05  MSAST10F PIC  X(0001).
  1731     05  FILLER REDEFINES MSAST10F.
  1732         10  MSAST10A PIC  X(0001).
  1733     05  MSAST10I PIC  X(0002).
  1734*    -------------------------------
  1735     05  MSACN10L PIC S9(0004) COMP.
  1736     05  MSACN10F PIC  X(0001).
  1737     05  FILLER REDEFINES MSACN10F.
  1738         10  MSACN10A PIC  X(0001).
  1739     05  MSACN10I PIC  X(0001).
  1740*    -------------------------------
  1741     05  MSACM10L PIC S9(0004) COMP.
  1742     05  MSACM10F PIC  X(0001).
  1743     05  FILLER REDEFINES MSACM10F.
  1744         10  MSACM10A PIC  X(0001).
  1745     05  MSACM10I PIC  X(0010).
  1746*    -------------------------------
  1747     05  TYPE10L PIC S9(0004) COMP.
  1748     05  TYPE10F PIC  X(0001).
  1749     05  FILLER REDEFINES TYPE10F.
  1750         10  TYPE10A PIC  X(0001).
  1751     05  TYPE10I PIC  X(0001).
  1752*    -------------------------------
  1753     05  AMT10L PIC S9(0004) COMP.
  1754     05  AMT10F PIC  X(0001).
  1755     05  FILLER REDEFINES AMT10F.
  1756         10  AMT10A PIC  X(0001).
  1757     05  AMT10I PIC  X(0011).
  1758*    -------------------------------
  1759     05  VOID10L PIC S9(0004) COMP.
  1760     05  VOID10F PIC  X(0001).
  1761     05  FILLER REDEFINES VOID10F.
  1762         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  37
* EL633.cbl
  1763     05  VOID10I PIC  X(0001).
  1764*    -------------------------------
  1765     05  MDT10L PIC S9(0004) COMP.
  1766     05  MDT10F PIC  X(0001).
  1767     05  FILLER REDEFINES MDT10F.
  1768         10  MDT10A PIC  X(0001).
  1769     05  MDT10I PIC  X(0006).
  1770*    -------------------------------
  1771     05  BDT10L PIC S9(0004) COMP.
  1772     05  BDT10F PIC  X(0001).
  1773     05  FILLER REDEFINES BDT10F.
  1774         10  BDT10A PIC  X(0001).
  1775     05  BDT10I PIC  X(0006).
  1776*    -------------------------------
  1777     05  SDT10L PIC S9(0004) COMP.
  1778     05  SDT10F PIC  X(0001).
  1779     05  FILLER REDEFINES SDT10F.
  1780         10  SDT10A PIC  X(0001).
  1781     05  SDT10I PIC  X(0006).
  1782*    -------------------------------
  1783     05  MSAAC11L PIC S9(0004) COMP.
  1784     05  MSAAC11F PIC  X(0001).
  1785     05  FILLER REDEFINES MSAAC11F.
  1786         10  MSAAC11A PIC  X(0001).
  1787     05  MSAAC11I PIC  X(0010).
  1788*    -------------------------------
  1789     05  MSAST11L PIC S9(0004) COMP.
  1790     05  MSAST11F PIC  X(0001).
  1791     05  FILLER REDEFINES MSAST11F.
  1792         10  MSAST11A PIC  X(0001).
  1793     05  MSAST11I PIC  X(0002).
  1794*    -------------------------------
  1795     05  MSACN11L PIC S9(0004) COMP.
  1796     05  MSACN11F PIC  X(0001).
  1797     05  FILLER REDEFINES MSACN11F.
  1798         10  MSACN11A PIC  X(0001).
  1799     05  MSACN11I PIC  X(0001).
  1800*    -------------------------------
  1801     05  MSACM11L PIC S9(0004) COMP.
  1802     05  MSACM11F PIC  X(0001).
  1803     05  FILLER REDEFINES MSACM11F.
  1804         10  MSACM11A PIC  X(0001).
  1805     05  MSACM11I PIC  X(0010).
  1806*    -------------------------------
  1807     05  TYPE11L PIC S9(0004) COMP.
  1808     05  TYPE11F PIC  X(0001).
  1809     05  FILLER REDEFINES TYPE11F.
  1810         10  TYPE11A PIC  X(0001).
  1811     05  TYPE11I PIC  X(0001).
  1812*    -------------------------------
  1813     05  AMT11L PIC S9(0004) COMP.
  1814     05  AMT11F PIC  X(0001).
  1815     05  FILLER REDEFINES AMT11F.
  1816         10  AMT11A PIC  X(0001).
  1817     05  AMT11I PIC  X(0011).
  1818*    -------------------------------
  1819     05  VOID11L PIC S9(0004) COMP.
  1820     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  38
* EL633.cbl
  1821     05  FILLER REDEFINES VOID11F.
  1822         10  VOID11A PIC  X(0001).
  1823     05  VOID11I PIC  X(0001).
  1824*    -------------------------------
  1825     05  MDT11L PIC S9(0004) COMP.
  1826     05  MDT11F PIC  X(0001).
  1827     05  FILLER REDEFINES MDT11F.
  1828         10  MDT11A PIC  X(0001).
  1829     05  MDT11I PIC  X(0006).
  1830*    -------------------------------
  1831     05  BDT11L PIC S9(0004) COMP.
  1832     05  BDT11F PIC  X(0001).
  1833     05  FILLER REDEFINES BDT11F.
  1834         10  BDT11A PIC  X(0001).
  1835     05  BDT11I PIC  X(0006).
  1836*    -------------------------------
  1837     05  SDT11L PIC S9(0004) COMP.
  1838     05  SDT11F PIC  X(0001).
  1839     05  FILLER REDEFINES SDT11F.
  1840         10  SDT11A PIC  X(0001).
  1841     05  SDT11I PIC  X(0006).
  1842*    -------------------------------
  1843     05  MSAAC12L PIC S9(0004) COMP.
  1844     05  MSAAC12F PIC  X(0001).
  1845     05  FILLER REDEFINES MSAAC12F.
  1846         10  MSAAC12A PIC  X(0001).
  1847     05  MSAAC12I PIC  X(0010).
  1848*    -------------------------------
  1849     05  MSAST12L PIC S9(0004) COMP.
  1850     05  MSAST12F PIC  X(0001).
  1851     05  FILLER REDEFINES MSAST12F.
  1852         10  MSAST12A PIC  X(0001).
  1853     05  MSAST12I PIC  X(0002).
  1854*    -------------------------------
  1855     05  MSACN12L PIC S9(0004) COMP.
  1856     05  MSACN12F PIC  X(0001).
  1857     05  FILLER REDEFINES MSACN12F.
  1858         10  MSACN12A PIC  X(0001).
  1859     05  MSACN12I PIC  X(0001).
  1860*    -------------------------------
  1861     05  MSACM12L PIC S9(0004) COMP.
  1862     05  MSACM12F PIC  X(0001).
  1863     05  FILLER REDEFINES MSACM12F.
  1864         10  MSACM12A PIC  X(0001).
  1865     05  MSACM12I PIC  X(0010).
  1866*    -------------------------------
  1867     05  TYPE12L PIC S9(0004) COMP.
  1868     05  TYPE12F PIC  X(0001).
  1869     05  FILLER REDEFINES TYPE12F.
  1870         10  TYPE12A PIC  X(0001).
  1871     05  TYPE12I PIC  X(0001).
  1872*    -------------------------------
  1873     05  AMT12L PIC S9(0004) COMP.
  1874     05  AMT12F PIC  X(0001).
  1875     05  FILLER REDEFINES AMT12F.
  1876         10  AMT12A PIC  X(0001).
  1877     05  AMT12I PIC  X(0011).
  1878*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  39
* EL633.cbl
  1879     05  VOID12L PIC S9(0004) COMP.
  1880     05  VOID12F PIC  X(0001).
  1881     05  FILLER REDEFINES VOID12F.
  1882         10  VOID12A PIC  X(0001).
  1883     05  VOID12I PIC  X(0001).
  1884*    -------------------------------
  1885     05  MDT12L PIC S9(0004) COMP.
  1886     05  MDT12F PIC  X(0001).
  1887     05  FILLER REDEFINES MDT12F.
  1888         10  MDT12A PIC  X(0001).
  1889     05  MDT12I PIC  X(0006).
  1890*    -------------------------------
  1891     05  BDT12L PIC S9(0004) COMP.
  1892     05  BDT12F PIC  X(0001).
  1893     05  FILLER REDEFINES BDT12F.
  1894         10  BDT12A PIC  X(0001).
  1895     05  BDT12I PIC  X(0006).
  1896*    -------------------------------
  1897     05  SDT12L PIC S9(0004) COMP.
  1898     05  SDT12F PIC  X(0001).
  1899     05  FILLER REDEFINES SDT12F.
  1900         10  SDT12A PIC  X(0001).
  1901     05  SDT12I PIC  X(0006).
  1902*    -------------------------------
  1903     05  MSAAC13L PIC S9(0004) COMP.
  1904     05  MSAAC13F PIC  X(0001).
  1905     05  FILLER REDEFINES MSAAC13F.
  1906         10  MSAAC13A PIC  X(0001).
  1907     05  MSAAC13I PIC  X(0010).
  1908*    -------------------------------
  1909     05  MSAST13L PIC S9(0004) COMP.
  1910     05  MSAST13F PIC  X(0001).
  1911     05  FILLER REDEFINES MSAST13F.
  1912         10  MSAST13A PIC  X(0001).
  1913     05  MSAST13I PIC  X(0002).
  1914*    -------------------------------
  1915     05  MSACN13L PIC S9(0004) COMP.
  1916     05  MSACN13F PIC  X(0001).
  1917     05  FILLER REDEFINES MSACN13F.
  1918         10  MSACN13A PIC  X(0001).
  1919     05  MSACN13I PIC  X(0001).
  1920*    -------------------------------
  1921     05  MSACM13L PIC S9(0004) COMP.
  1922     05  MSACM13F PIC  X(0001).
  1923     05  FILLER REDEFINES MSACM13F.
  1924         10  MSACM13A PIC  X(0001).
  1925     05  MSACM13I PIC  X(0010).
  1926*    -------------------------------
  1927     05  TYPE13L PIC S9(0004) COMP.
  1928     05  TYPE13F PIC  X(0001).
  1929     05  FILLER REDEFINES TYPE13F.
  1930         10  TYPE13A PIC  X(0001).
  1931     05  TYPE13I PIC  X(0001).
  1932*    -------------------------------
  1933     05  AMT13L PIC S9(0004) COMP.
  1934     05  AMT13F PIC  X(0001).
  1935     05  FILLER REDEFINES AMT13F.
  1936         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  40
* EL633.cbl
  1937     05  AMT13I PIC  X(0011).
  1938*    -------------------------------
  1939     05  VOID13L PIC S9(0004) COMP.
  1940     05  VOID13F PIC  X(0001).
  1941     05  FILLER REDEFINES VOID13F.
  1942         10  VOID13A PIC  X(0001).
  1943     05  VOID13I PIC  X(0001).
  1944*    -------------------------------
  1945     05  MDT13L PIC S9(0004) COMP.
  1946     05  MDT13F PIC  X(0001).
  1947     05  FILLER REDEFINES MDT13F.
  1948         10  MDT13A PIC  X(0001).
  1949     05  MDT13I PIC  X(0006).
  1950*    -------------------------------
  1951     05  BDT13L PIC S9(0004) COMP.
  1952     05  BDT13F PIC  X(0001).
  1953     05  FILLER REDEFINES BDT13F.
  1954         10  BDT13A PIC  X(0001).
  1955     05  BDT13I PIC  X(0006).
  1956*    -------------------------------
  1957     05  SDT13L PIC S9(0004) COMP.
  1958     05  SDT13F PIC  X(0001).
  1959     05  FILLER REDEFINES SDT13F.
  1960         10  SDT13A PIC  X(0001).
  1961     05  SDT13I PIC  X(0006).
  1962*    -------------------------------
  1963     05  ERRMSG1L PIC S9(0004) COMP.
  1964     05  ERRMSG1F PIC  X(0001).
  1965     05  FILLER REDEFINES ERRMSG1F.
  1966         10  ERRMSG1A PIC  X(0001).
  1967     05  ERRMSG1I PIC  X(0079).
  1968*    -------------------------------
  1969     05  ERRMSG2L PIC S9(0004) COMP.
  1970     05  ERRMSG2F PIC  X(0001).
  1971     05  FILLER REDEFINES ERRMSG2F.
  1972         10  ERRMSG2A PIC  X(0001).
  1973     05  ERRMSG2I PIC  X(0079).
  1974*    -------------------------------
  1975     05  PFENTERL PIC S9(0004) COMP.
  1976     05  PFENTERF PIC  X(0001).
  1977     05  FILLER REDEFINES PFENTERF.
  1978         10  PFENTERA PIC  X(0001).
  1979     05  PFENTERI PIC  9(2).
  1980 01  EL633AO REDEFINES EL633AI.
  1981     05  FILLER            PIC  X(0012).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  DATEO PIC  X(0008).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  TIMEO PIC  99.99.
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  CMPNYIDO PIC  X(0003).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  USERIDO PIC  X(0004).
  1994*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  41
* EL633.cbl
  1995     05  FILLER            PIC  X(0003).
  1996     05  MAINTO PIC  X(0001).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  CARRIERO PIC  X(0001).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  GROUPO PIC  X(0006).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  FINRESPO PIC  X(0010).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  ACCTO PIC  X(0010).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  MSAAC1O PIC  X(0010).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  MSAST1O PIC  X(0002).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  MSACN1O PIC  X(0001).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  MSACM1O PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  TYPE1O PIC  X(0001).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  AMT1O PIC  X(0011).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  VOID1O PIC  X(0001).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  MDT1O PIC  X(0006).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  BDT1O PIC  X(0006).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  SDT1O PIC  X(0006).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  MSAAC2O PIC  X(0010).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  MSAST2O PIC  X(0002).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  MSACN2O PIC  X(0001).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  MSACM2O PIC  X(0010).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  42
* EL633.cbl
  2053     05  TYPE2O PIC  X(0001).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  AMT2O PIC  X(0011).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  VOID2O PIC  X(0001).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  MDT2O PIC  X(0006).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  BDT2O PIC  X(0006).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  SDT2O PIC  X(0006).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  MSAAC3O PIC  X(0010).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  MSAST3O PIC  X(0002).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  MSACN3O PIC  X(0001).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  MSACM3O PIC  X(0010).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  TYPE3O PIC  X(0001).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  AMT3O PIC  X(0011).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  VOID3O PIC  X(0001).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  MDT3O PIC  X(0006).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  BDT3O PIC  X(0006).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  SDT3O PIC  X(0006).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  MSAAC4O PIC  X(0010).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  MSAST4O PIC  X(0002).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  MSACN4O PIC  X(0001).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  43
* EL633.cbl
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  TYPE4O PIC  X(0001).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  AMT4O PIC  X(0011).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  VOID4O PIC  X(0001).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  MDT4O PIC  X(0006).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  BDT4O PIC  X(0006).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  SDT4O PIC  X(0006).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  MSAAC5O PIC  X(0010).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  MSAST5O PIC  X(0002).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  MSACN5O PIC  X(0001).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  MSACM5O PIC  X(0010).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  TYPE5O PIC  X(0001).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  AMT5O PIC  X(0011).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  VOID5O PIC  X(0001).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  MDT5O PIC  X(0006).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  BDT5O PIC  X(0006).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  SDT5O PIC  X(0006).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  MSAAC6O PIC  X(0010).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  MSAST6O PIC  X(0002).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  MSACN6O PIC  X(0001).
  2168*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  44
* EL633.cbl
  2169     05  FILLER            PIC  X(0003).
  2170     05  MSACM6O PIC  X(0010).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  TYPE6O PIC  X(0001).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  AMT6O PIC  X(0011).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  VOID6O PIC  X(0001).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  MDT6O PIC  X(0006).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  BDT6O PIC  X(0006).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  SDT6O PIC  X(0006).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  MSAAC7O PIC  X(0010).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  MSAST7O PIC  X(0002).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  MSACN7O PIC  X(0001).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  MSACM7O PIC  X(0010).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  TYPE7O PIC  X(0001).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  AMT7O PIC  X(0011).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  VOID7O PIC  X(0001).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  MDT7O PIC  X(0006).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  BDT7O PIC  X(0006).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  SDT7O PIC  X(0006).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  MSAAC8O PIC  X(0010).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  MSAST8O PIC  X(0002).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  45
* EL633.cbl
  2227     05  MSACN8O PIC  X(0001).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  MSACM8O PIC  X(0010).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  TYPE8O PIC  X(0001).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  AMT8O PIC  X(0011).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  VOID8O PIC  X(0001).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  MDT8O PIC  X(0006).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  BDT8O PIC  X(0006).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  SDT8O PIC  X(0006).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  MSAAC9O PIC  X(0010).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  MSAST9O PIC  X(0002).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  MSACN9O PIC  X(0001).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  MSACM9O PIC  X(0010).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  TYPE9O PIC  X(0001).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  AMT9O PIC  X(0011).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  VOID9O PIC  X(0001).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  MDT9O PIC  X(0006).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  BDT9O PIC  X(0006).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  SDT9O PIC  X(0006).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  MSAAC10O PIC  X(0010).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  46
* EL633.cbl
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  MSACN10O PIC  X(0001).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  MSACM10O PIC  X(0010).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  TYPE10O PIC  X(0001).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  AMT10O PIC  X(0011).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  VOID10O PIC  X(0001).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  MDT10O PIC  X(0006).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  BDT10O PIC  X(0006).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  SDT10O PIC  X(0006).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  MSAAC11O PIC  X(0010).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  MSAST11O PIC  X(0002).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  MSACN11O PIC  X(0001).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  MSACM11O PIC  X(0010).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  TYPE11O PIC  X(0001).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  AMT11O PIC  X(0011).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  VOID11O PIC  X(0001).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  MDT11O PIC  X(0006).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  BDT11O PIC  X(0006).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  SDT11O PIC  X(0006).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  MSAAC12O PIC  X(0010).
  2342*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  47
* EL633.cbl
  2343     05  FILLER            PIC  X(0003).
  2344     05  MSAST12O PIC  X(0002).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  MSACN12O PIC  X(0001).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  MSACM12O PIC  X(0010).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  TYPE12O PIC  X(0001).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  AMT12O PIC  X(0011).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  VOID12O PIC  X(0001).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  MDT12O PIC  X(0006).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  BDT12O PIC  X(0006).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  SDT12O PIC  X(0006).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  MSAAC13O PIC  X(0010).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  MSAST13O PIC  X(0002).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  MSACN13O PIC  X(0001).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  MSACM13O PIC  X(0010).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  TYPE13O PIC  X(0001).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  AMT13O PIC  X(0011).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  VOID13O PIC  X(0001).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  MDT13O PIC  X(0006).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  BDT13O PIC  X(0006).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  SDT13O PIC  X(0006).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  48
* EL633.cbl
  2401     05  ERRMSG1O PIC  X(0079).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  ERRMSG2O PIC  X(0079).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  PFENTERO PIC  X(0002).
  2408*    -------------------------------
  2409
  2410 01  MAP-EL633A  REDEFINES  EL633AI.
  2411     12  FILLER                  PIC  X(87).
  2412     12  DATA-AREA       OCCURS 13 TIMES
  2413                             INDEXED BY PINDX.
  2414         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2415         16  GL-ACCT-ATTRB       PIC  X.
  2416         16  GL-ACCT             PIC  X(10).
  2417         16  WSL-COMM  REDEFINES GL-ACCT.
  2418             20  WSL-COMM-DTE.
  2419                 24  WSL-MO      PIC  X(2).
  2420                 24  WSL-DA      PIC  X(2).
  2421                 24  WSL-YR      PIC  X(2).
  2422             20  WSL-COMM-REST   PIC  X(4).
  2423         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2424         16  GL-STATE-ATTRB      PIC  X.
  2425         16  GL-STATE            PIC  X(02).
  2426         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2427         16  GL-CANC-ATTRB       PIC  X.
  2428         16  GL-CANC             PIC  X.
  2429         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2430         16  GL-COMM-ATTRB       PIC  X.
  2431         16  GL-COMM             PIC  X(10).
  2432         16  RTYPE-LEN           PIC S9(4)              COMP.
  2433         16  RTYPE-ATTRB         PIC  X.
  2434         16  RTYPE               PIC  X.
  2435         16  AMT-LEN             PIC S9(4)              COMP.
  2436         16  AMT-ATTRB           PIC  X.
  2437         16  AMT                 PIC S9(9)V9(2).
  2438         16  AMTO  REDEFINES
  2439             AMT                 PIC Z(7).9(2)-.
  2440         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2441         16  VOID-SW-ATTRB       PIC  X.
  2442         16  VOID-SW             PIC  X.
  2443         16  MDTE-LEN            PIC S9(4)              COMP.
  2444         16  MDTE-ATTRB          PIC  X.
  2445         16  MDTE                PIC  X(6).
  2446         16  BDTE-LEN            PIC S9(4)              COMP.
  2447         16  BDTE-ATTRB          PIC  X.
  2448         16  BDTE                PIC  X(6).
  2449         16  SDTE-LEN            PIC S9(4)              COMP.
  2450         16  SDTE-ATTRB          PIC  X.
  2451         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  49
* EL633.cbl
  2453****************************************************************
  2454*
  2455* Copyright (c) 2007 by Clerity Solutions, Inc.
  2456* All rights reserved.
  2457*
  2458****************************************************************
  2459 01  DFHEIV.
  2460   02  DFHEIV0               PIC X(35).
  2461   02  DFHEIV1               PIC X(08).
  2462   02  DFHEIV2               PIC X(08).
  2463   02  DFHEIV3               PIC X(08).
  2464   02  DFHEIV4               PIC X(06).
  2465   02  DFHEIV5               PIC X(04).
  2466   02  DFHEIV6               PIC X(04).
  2467   02  DFHEIV7               PIC X(02).
  2468   02  DFHEIV8               PIC X(02).
  2469   02  DFHEIV9               PIC X(01).
  2470   02  DFHEIV10              PIC S9(7) COMP-3.
  2471   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2472   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2473   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2474   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2475   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2476   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2477   02  DFHEIV17              PIC X(04).
  2478   02  DFHEIV18              PIC X(04).
  2479   02  DFHEIV19              PIC X(04).
  2480   02  DFHEIV20              USAGE IS POINTER.
  2481   02  DFHEIV21              USAGE IS POINTER.
  2482   02  DFHEIV22              USAGE IS POINTER.
  2483   02  DFHEIV23              USAGE IS POINTER.
  2484   02  DFHEIV24              USAGE IS POINTER.
  2485   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2486   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2487   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2488   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2489   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2490   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2491   02  FILLER                PIC X(02).
  2492   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2493   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2494   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2495   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2496   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2497 LINKAGE  SECTION.
  2498*****************************************************************
  2499*                                                               *
  2500* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2501* All rights reserved.                                          *
  2502*                                                               *
  2503*****************************************************************
  2504 01  dfheiblk.
  2505     02  eibtime          pic s9(7) comp-3.
  2506     02  eibdate          pic s9(7) comp-3.
  2507     02  eibtrnid         pic x(4).
  2508     02  eibtaskn         pic s9(7) comp-3.
  2509     02  eibtrmid         pic x(4).
  2510     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  50
* EL633.cbl
  2511     02  eibcposn         pic s9(4) comp.
  2512     02  eibcalen         pic s9(4) comp.
  2513     02  eibaid           pic x(1).
  2514     02  eibfiller1       pic x(1).
  2515     02  eibfn            pic x(2).
  2516     02  eibfiller2       pic x(2).
  2517     02  eibrcode         pic x(6).
  2518     02  eibfiller3       pic x(2).
  2519     02  eibds            pic x(8).
  2520     02  eibreqid         pic x(8).
  2521     02  eibrsrce         pic x(8).
  2522     02  eibsync          pic x(1).
  2523     02  eibfree          pic x(1).
  2524     02  eibrecv          pic x(1).
  2525     02  eibsend          pic x(1).
  2526     02  eibatt           pic x(1).
  2527     02  eibeoc           pic x(1).
  2528     02  eibfmh           pic x(1).
  2529     02  eibcompl         pic x(1).
  2530     02  eibsig           pic x(1).
  2531     02  eibconf          pic x(1).
  2532     02  eiberr           pic x(1).
  2533     02  eibrldbk         pic x(1).
  2534     02  eiberrcd         pic x(4).
  2535     02  eibsynrb         pic x(1).
  2536     02  eibnodat         pic x(1).
  2537     02  eibfiller5       pic x(2).
  2538     02  eibresp          pic 9(09) comp.
  2539     02  eibresp2         pic 9(09) comp.
  2540     02  dfheigdj         pic s9(4) comp.
  2541     02  dfheigdk         pic s9(4) comp.
  2542 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  51
* EL633.cbl
  2543/
  2544*                            COPY ERCCHKQ.
  2545******************************************************************
  2546*                                                                *
  2547*                                                                *
  2548*                            ERCCHKQ                             *
  2549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2550*                            VMOD=2.005                          *
  2551*                                                                *
  2552*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2553*                                                                *
  2554*   FILE TYPE = VSAM,KSDS                                        *
  2555*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2556*                                                                *
  2557*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2558*       ALTERNATE PATH  = NONE                                   *
  2559*                                                                *
  2560*   LOG = YES                                                    *
  2561*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2562******************************************************************
  2563 01  CHECK-QUE.
  2564     12  CQ-RECORD-ID                PIC XX.
  2565         88  VALID-CQ-ID                     VALUE 'CQ'.
  2566
  2567     12  CQ-CONTROL-PRIMARY.
  2568         16  CQ-COMPANY-CD           PIC X.
  2569         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2570         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2571
  2572     12  CQ-ENTRY-TYPE               PIC X.
  2573             88  CHECK-ON-QUE           VALUE 'Q'.
  2574             88  ALIGNMENT-CHECK        VALUE 'A'.
  2575             88  MANUAL-CHECK           VALUE 'M'.
  2576             88  SPOILED-CHECK          VALUE 'S'.
  2577             88  VOIDED-CHECK           VALUE 'V'.
  2578             88  PAYMENT-ABORTED        VALUE 'X'.
  2579
  2580     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2581
  2582     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2583         CQ-CREDIT-MASTER-CNTL.
  2584         16  CQ-PYAJ-CARRIER         PIC X.
  2585         16  CQ-PYAJ-GROUPING        PIC X(6).
  2586         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2587         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2588         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2589         16  CQ-PYAJ-REC-TYPE        PIC X.
  2590         16  FILLER                  PIC X(18).
  2591
  2592     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2593         CQ-CREDIT-MASTER-CNTL.
  2594         16  CQ-CHEK-CARRIER         PIC X.
  2595         16  CQ-CHEK-GROUPING        PIC X(6).
  2596         16  CQ-CHEK-STATE           PIC XX.
  2597         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2598         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2599         16  CQ-CHEK-CERT-NO.
  2600             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  52
* EL633.cbl
  2601             20  CQ-CHEK-CERT-SFX    PIC X.
  2602         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2603         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2604         16  FILLER                  PIC X(06).
  2605
  2606     12  CQ-CHECK-NUMBER             PIC X(7).
  2607     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2608     12  CQ-PAYMENT-TYPE             PIC X.
  2609             88  CQ-BILLING-CREDIT         VALUE '1'.
  2610             88  CQ-REFUND-PMT             VALUE '2'.
  2611             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2612     12  CQ-VOID-INDICATOR           PIC X.
  2613             88  CHECK-IS-VOID             VALUE 'V'.
  2614     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2615     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2616     12  CQ-CHECK-BY-USER            PIC X(4).
  2617     12  CQ-PRE-NUMBERING-SW         PIC X.
  2618       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2619       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2620
  2621     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2622     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2623     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2624     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2625
  2626     12  CQ-LETTERS-IND              PIC X.
  2627         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2628
  2629******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  53
* EL633.cbl
  2630/
  2631*                            COPY ERCPYAJ.
  2632******************************************************************
  2633*                                                                *
  2634*                            ERCPYAJ                             *
  2635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2636*                            VMOD=2.015                          *
  2637*                                                                *
  2638*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2639*                                                                *
  2640*                                                                *
  2641*   FILE TYPE = VSAM,KSDS                                        *
  2642*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2643*                                                                *
  2644*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2645*       ALTERNATE PATHS = NONE                                   *
  2646*                                                                *
  2647*   LOG = YES                                                    *
  2648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2649******************************************************************
  2650******************************************************************
  2651*                   C H A N G E   L O G
  2652*
  2653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2654*-----------------------------------------------------------------
  2655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2656* EFFECTIVE    NUMBER
  2657*-----------------------------------------------------------------
  2658* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2659* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2660******************************************************************
  2661
  2662 01  PENDING-PAY-ADJ.
  2663     12  PY-RECORD-ID                     PIC XX.
  2664         88  VALID-PY-ID                        VALUE 'PY'.
  2665
  2666     12  PY-CONTROL-PRIMARY.
  2667         16  PY-COMPANY-CD                PIC X.
  2668         16  PY-CARRIER                   PIC X.
  2669         16  PY-GROUPING                  PIC X(6).
  2670         16  PY-FIN-RESP                  PIC X(10).
  2671         16  PY-ACCOUNT                   PIC X(10).
  2672         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2673                                          PIC X(10).
  2674         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2675         16  PY-RECORD-TYPE               PIC X.
  2676             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2677             88  PY-DEPOSIT                   VALUE 'D'.
  2678             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2679             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2680             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2681             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2682             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2683             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2684             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2685             88  PY-FICA-ENTRY                VALUE 'F'.
  2686             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2687             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  54
* EL633.cbl
  2688             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2689
  2690     12  PY-PYMT-TYPE                     PIC X.
  2691             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2692             88  PY-REINS-PYMT                VALUE 'R'.
  2693             88  PY-EXP-PYMT                  VALUE 'E'.
  2694
  2695     12  PY-BIL-INV                       PIC X(6).
  2696     12  PY-REF-NO                        PIC X(12).
  2697
  2698     12  PY-LAST-MAINT-DT                 PIC XX.
  2699     12  PY-LAST-MAINT-BY                 PIC X(4).
  2700     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2701
  2702     12  PY-PYADJ-RECORD.
  2703         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2704         16  PY-ENTRY-COMMENT             PIC X(30).
  2705         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2706             20  PY-GL-ACCOUNT            PIC X(10).
  2707             20  PY-GL-STATE              PIC X(02).
  2708             20  PY-GL-CANC-SW            PIC X(01).
  2709                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2710                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2711             20  PY-GL-COMMENT            PIC X(10).
  2712             20  FILLER      REDEFINES PY-GL-COMMENT.
  2713                 24  PY-GL-CHECK-NO       PIC 9(06).
  2714                 24  FILLER               PIC X(04).
  2715             20  FILLER                   PIC X(07).
  2716         16  PY-SAVE-ACCOUNT              PIC X(10).
  2717         16  PY-SAVE-TYPE                 PIC X(01).
  2718
  2719         16  PY-LETTERS.
  2720             20  PY-LETTER OCCURS 3 TIMES
  2721                           INDEXED BY PY-LET-NDX
  2722                                          PIC X(04).
  2723
  2724         16  PY-ERCOMP-TYPE               PIC X.
  2725             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2726             88  PY-GA-TYPE                   VALUE 'G'.
  2727             88  PY-BANK-TYPE                 VALUE 'B'.
  2728         16  FILLER                       PIC X(05).
  2729
  2730     12  PY-RECORD-STATUS.
  2731         16  PY-CREDIT-SELECT-DT          PIC XX.
  2732         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2733         16  PY-BILLED-DATE               PIC XX.
  2734         16  PY-REPORTED-DT               PIC XX.
  2735         16  PY-PMT-APPLIED               PIC X.
  2736             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2737             88  PY-GA-PMT                    VALUE 'G'.
  2738             88  PY-OVWRITE-PMT               VALUE 'O'.
  2739             88  PY-NON-AR-PMT                VALUE 'N'.
  2740         16  FILLER                       PIC X(5).
  2741         16  PY-INPUT-DT                  PIC XX.
  2742         16  PY-CHECK-NUMBER              PIC X(6).
  2743         16  PY-VOID-SW                   PIC X.
  2744             88  PY-CHECK-VOIDED              VALUE 'V'.
  2745         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  55
* EL633.cbl
  2746             88  PY-BILLING-CHECK             VALUE 'B'.
  2747             88  PY-REFUND-CHECK              VALUE 'R'.
  2748             88  PY-GA-CHECK                  VALUE 'G'.
  2749             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2750             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2751         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2752         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2753         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2754         16  PY-BILL-FLAG                 PIC X.
  2755             88  PY-BILLED                    VALUE 'B'.
  2756         16  PY-AR-FLAG                   PIC X.
  2757             88  PY-AR-CYCLE                  VALUE 'C'.
  2758             88  PY-AR-MONTH-END              VALUE 'M'.
  2759         16  PY-AR-DATE                   PIC XX.
  2760
  2761     12  PY-GL-CODES.
  2762         16  PY-GL-DB                     PIC X(14).
  2763         16  PY-GL-CR                     PIC X(14).
  2764         16  PY-GL-FLAG                   PIC X.
  2765         16  PY-GL-DATE                   PIC XX.
  2766
  2767     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2768     12  FILLER                           PIC X(3).
  2769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  56
* EL633.cbl
  2770/
  2771*                            COPY ERCCOMP.
  2772******************************************************************
  2773*                                                                *
  2774*                                                                *
  2775*                            ERCCOMP                             *
  2776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2777*                            VMOD=2.019                          *
  2778*                                                                *
  2779*   ONLINE CREDIT SYSTEM                                         *
  2780*                                                                *
  2781*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2782*                                                                *
  2783*   FILE TYPE = VSAM,KSDS                                        *
  2784*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2785*                                                                *
  2786*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2787*       ALTERNATE PATH = NONE                                    *
  2788*                                                                *
  2789*   LOG = NO                                                     *
  2790*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2791*                                                                *
  2792******************************************************************
  2793*                   C H A N G E   L O G
  2794*
  2795* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2796*-----------------------------------------------------------------
  2797*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2798* EFFECTIVE    NUMBER
  2799*-----------------------------------------------------------------
  2800* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2801* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2802* 092205    2005050300006  PEMA  ADD LEASE FEE
  2803* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2804* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2805* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2806* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2807* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2808* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2809******************************************************************
  2810
  2811 01  COMPENSATION-MASTER.
  2812     12  CO-RECORD-ID                          PIC XX.
  2813         88  VALID-CO-ID                          VALUE 'CO'.
  2814
  2815     12  CO-CONTROL-PRIMARY.
  2816         16  CO-COMPANY-CD                     PIC X.
  2817         16  CO-CONTROL.
  2818             20  CO-CTL-1.
  2819                 24  CO-CARR-GROUP.
  2820                     28  CO-CARRIER            PIC X.
  2821                     28  CO-GROUPING.
  2822                         32  CO-GROUP-PREFIX   PIC XXX.
  2823                         32  CO-GROUP-PRIME    PIC XXX.
  2824                 24  CO-RESP-NO.
  2825                     28  CO-RESP-PREFIX        PIC X(4).
  2826                     28  CO-RESP-PRIME         PIC X(6).
  2827             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  57
* EL633.cbl
  2828                 24  CO-ACCOUNT.
  2829                     28  CO-ACCT-PREFIX        PIC X(4).
  2830                     28  CO-ACCT-PRIME         PIC X(6).
  2831         16  CO-TYPE                           PIC X.
  2832             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2833             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2834             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2835
  2836     12  CO-MAINT-INFORMATION.
  2837         16  CO-LAST-MAINT-DT                  PIC XX.
  2838         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2839         16  CO-LAST-MAINT-USER                PIC X(4).
  2840     12  FILLER                                PIC XX.
  2841     12  CO-STMT-TYPE                          PIC XXX.
  2842     12  CO-COMP-TYPE                          PIC X.
  2843         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2844     12  CO-STMT-OWNER                         PIC X(4).
  2845     12  CO-BALANCE-CONTROL                    PIC X.
  2846         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2847         88  CO-NO-BALANCE                        VALUE 'N'.
  2848
  2849     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2850         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2851         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2852         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2853
  2854     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2855         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2856         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2857
  2858     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2859     12  CO-GA-DIRECT-DEP                      PIC X.
  2860     12  CO-FUTURE-SPACE                       PIC X.
  2861         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2862
  2863     12  CO-ACCT-NAME                          PIC X(30).
  2864     12  CO-MAIL-NAME                          PIC X(30).
  2865     12  CO-ADDR-1                             PIC X(30).
  2866     12  CO-ADDR-2                             PIC X(30).
  2867     12  CO-ADDR-3.
  2868         16  CO-ADDR-CITY                      PIC X(27).
  2869         16  CO-ADDR-STATE                     PIC XX.
  2870     12  CO-CSO-1099                           PIC X.
  2871     12  CO-ZIP.
  2872         16  CO-ZIP-PRIME.
  2873             20  CO-ZIP-PRI-1ST                PIC X.
  2874                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2875             20  FILLER                        PIC X(4).
  2876         16  CO-ZIP-PLUS4                      PIC X(4).
  2877     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2878         16  CO-CAN-POSTAL-1                   PIC XXX.
  2879         16  CO-CAN-POSTAL-2                   PIC XXX.
  2880         16  FILLER                            PIC XXX.
  2881     12  CO-SOC-SEC                            PIC X(13).
  2882     12  CO-TELEPHONE.
  2883         16  CO-AREA-CODE                      PIC XXX.
  2884         16  CO-PREFIX                         PIC XXX.
  2885         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  58
* EL633.cbl
  2886
  2887     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2888
  2889     12  CO-AR-BAL-LEVEL                       PIC X.
  2890         88  CO-AR-REF-LVL                        VALUE '1'.
  2891         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2892         88  CO-AR-BILL-LVL                       VALUE '2'.
  2893         88  CO-AR-AGT-LVL                        VALUE '3'.
  2894         88  CO-AR-FR-LVL                         VALUE '4'.
  2895
  2896     12  CO-AR-NORMAL-PRINT                    PIC X.
  2897         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2898         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2899
  2900     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2901
  2902     12  CO-AR-REPORTING                       PIC X.
  2903         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2904         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2905
  2906     12  CO-AR-PULL-CHECK                      PIC X.
  2907         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2908         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2909
  2910     12  CO-AR-BALANCE-PRINT                   PIC X.
  2911         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2912
  2913     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2914         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2915         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2916         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2917
  2918     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2919
  2920     12  CO-USER-CODE                          PIC X.
  2921     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2922
  2923******************************************************************
  2924*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2925*    THE LAST MONTH END RUN.
  2926******************************************************************
  2927
  2928     12  CO-LAST-ACTIVITY-DATE.
  2929         16  CO-ACT-YEAR                       PIC 99.
  2930         16  CO-ACT-MONTH                      PIC 99.
  2931         16  CO-ACT-DAY                        PIC 99.
  2932
  2933     12  CO-LAST-STMT-DT.
  2934         16  CO-LAST-STMT-YEAR                 PIC 99.
  2935         16  CO-LAST-STMT-MONTH                PIC 99.
  2936         16  CO-LAST-STMT-DAY                  PIC 99.
  2937
  2938     12  CO-MO-END-TOTALS.
  2939         16  CO-MONTHLY-TOTALS.
  2940             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2941             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2942             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2943             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  59
* EL633.cbl
  2944             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2945
  2946         16  CO-AGING-TOTALS.
  2947             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2948             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2949             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2950             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2951
  2952         16  CO-YTD-TOTALS.
  2953             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2954             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2955
  2956         16  CO-OVER-UNDER-TOTALS.
  2957             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2958             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2959
  2960     12  CO-MISCELLANEOUS-TOTALS.
  2961         16  CO-FICA-TOTALS.
  2962             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2963             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2964
  2965         16  CO-CLAIM-TOTALS.
  2966             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2967             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2968
  2969******************************************************************
  2970*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2971*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2972******************************************************************
  2973
  2974     12  CO-CURRENT-TOTALS.
  2975         16  CO-CURRENT-LAST-STMT-DT.
  2976             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2977             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2978             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2979
  2980         16  CO-CURRENT-MONTHLY-TOTALS.
  2981             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2982             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2983             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2984             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2985             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2986
  2987         16  CO-CURRENT-AGING-TOTALS.
  2988             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2989             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2990             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2991             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2992
  2993         16  CO-CURRENT-YTD-TOTALS.
  2994             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2995             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2996
  2997     12  CO-PAID-COMM-TOTALS.
  2998         16  CO-YTD-PAID-COMMS.
  2999             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3000             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3001
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  60
* EL633.cbl
  3002     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3003         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3004         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3005
  3006     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3007         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3008         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3009         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3010         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3011         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3012         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3013         88  CO-FINAL-LETTER                  VALUE 'F'.
  3014         88  CO-RECONCILING                   VALUE 'R'.
  3015         88  CO-PHONE-CALL                    VALUE 'P'.
  3016         88  CO-LEGAL                         VALUE 'L'.
  3017         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3018         88  CO-WRITE-OFF                     VALUE 'W'.
  3019         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3020
  3021     12  CO-CSR-CODE                       PIC X(4).
  3022
  3023     12  CO-GA-STATUS-INFO.
  3024         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3025         16  CO-GA-TERMINATION-DT          PIC XX.
  3026         16  CO-GA-STATUS-CODE             PIC X.
  3027             88  CO-GA-ACTIVE                 VALUE 'A'.
  3028             88  CO-GA-INACTIVE               VALUE 'I'.
  3029             88  CO-GA-PENDING                VALUE 'P'.
  3030         16  CO-GA-COMMENTS.
  3031             20  CO-GA-COMMENT-1           PIC X(40).
  3032             20  CO-GA-COMMENT-2           PIC X(40).
  3033             20  CO-GA-COMMENT-3           PIC X(40).
  3034             20  CO-GA-COMMENT-4           PIC X(40).
  3035
  3036     12  CO-RPTCD2                         PIC X(10).
  3037     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3038         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3039         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3040
  3041     12  CO-TYPE-AGENT                     PIC X(01).
  3042         88  CO-CORPORATION                   VALUE 'C'.
  3043         88  CO-PARTNERSHIP                   VALUE 'P'.
  3044         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3045         88  CO-TRUST                         VALUE 'T'.
  3046         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3047
  3048     12  CO-FAXNO.
  3049         16  CO-FAX-AREA-CODE                  PIC XXX.
  3050         16  CO-FAX-PREFIX                     PIC XXX.
  3051         16  CO-FAX-PHONE                      PIC X(4).
  3052
  3053     12  CO-BANK-INFORMATION.
  3054         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3055         16  CO-BANK-TRANSIT-NON REDEFINES
  3056             CO-BANK-TRANSIT-NO                PIC 9(8).
  3057
  3058         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3059     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  61
* EL633.cbl
  3060                  CO-BANK-INFORMATION.
  3061         16  CO-MD-GL-ACCT                     PIC X(10).
  3062         16  CO-MD-DIV                         PIC XX.
  3063         16  CO-MD-CENTER                      PIC X(4).
  3064         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3065         16  CO-CREATE-AP-CHECK                PIC X.
  3066         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3067         16  FILLER                            PIC XXX.
  3068     12  CO-ACH-STATUS                         PIC X.
  3069         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3070         88  CO-ACH-PENDING                        VALUE 'P'.
  3071
  3072     12  CO-BILL-SW                            PIC X.
  3073     12  CO-CONTROL-NAME                       PIC X(30).
  3074     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3075     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3076     12  CO-CLP-STATE                          PIC XX.
  3077     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3078     12  CO-SPP-REFUND-EDIT                    PIC X.
  3079
  3080******************************************************************
  3081*
  3082*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  62
* EL633.cbl
  3083/
  3084 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3085                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3086 0000-DFHEXIT SECTION.
  3087     MOVE '9#                    $   ' TO DFHEIV0.
  3088     MOVE 'EL633' TO DFHEIV1.
  3089     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3090
  3091     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3092     MOVE EIBTRMID               TO  QID-TERM.
  3093     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3094
  3095     IF EIBCALEN = ZERO
  3096         GO TO 8800-UNAUTHORIZED-ACCESS.
  3097
  3098     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3099         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3100
  3101     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3102     MOVE '5'                    TO  DC-OPTION-CODE.
  3103
  3104     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3105
  3106     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3107     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3108
  3109     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3110         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3111             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3112             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3113             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3114             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3115             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3116             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3117             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3118             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3119         ELSE
  3120             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3121             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3122             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3123             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3124             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3125             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3126             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3127             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3128
  3129     MOVE LOW-VALUES             TO  EL633AI.
  3130
  3131     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3132     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3133     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3134     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3135
  3136     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3137                                     TOTAL-ACCT-NET.
  3138
  3139     IF RETURNED-FROM = XCTL-6331 OR
  3140                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  63
* EL633.cbl
  3141                        XCTL-642  OR
  3142                        XCTL-652
  3143         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3144
  3145     IF EIBTRNID NOT = TRANS-ID
  3146         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3147         MOVE 'Y'                TO  PI-PAGE-SW
  3148         MOVE ZEROS              TO  PI-SEQ-NOS
  3149         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3150                                     PI-SAV-ACCT-NET
  3151                                     PI-SAV-PREV-AMT
  3152                                     PI-SAV-PREV-NET
  3153         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3154             EIBTRNID NOT = EL642-TRANS-ID  AND
  3155             EIBTRNID NOT = EL652-TRANS-ID) OR
  3156             PI-CR-FIN-RESP = SPACES
  3157             GO TO 8100-SEND-INITIAL-MAP
  3158         ELSE
  3159             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3160                            EL640-TRANS-ID   OR
  3161                            EL642-TRANS-ID)  AND
  3162                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3163                GO TO 8100-SEND-INITIAL-MAP
  3164             ELSE
  3165                 MOVE DFHENTER   TO  EIBAID
  3166                 MOVE 'S'        TO  MAINTI
  3167                 MOVE PI-CR-CARRIER
  3168                                 TO  CARRIERI
  3169                 MOVE PI-CR-GROUPING
  3170                                 TO  GROUPI
  3171                 MOVE PI-CR-FIN-RESP
  3172                                 TO  FINRESPI
  3173                 MOVE PI-CR-ACCOUNT
  3174                                 TO  ACCTI
  3175                 MOVE 1          TO  CARRIERL  MAINTA
  3176                 MOVE 3          TO  GROUPL
  3177                 MOVE 6          TO  FINRESPL  ACCTL
  3178                 GO TO 0400-VALIDATE-KEY-DATA.
  3179
  3180
  3181* EXEC CICS HANDLE CONDITION
  3182*        PGMIDERR  (9600-PGMID-ERROR)
  3183*        ERROR     (9990-ABEND)
  3184*    END-EXEC.
  3185*    MOVE '"$L.                  ! " #00003176' TO DFHEIV0
  3186     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3188     MOVE X'2220233030303033313736' TO DFHEIV0(25:11)
  3189     CALL 'kxdfhei1' USING DFHEIV0
  3190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3191
  3192
  3193     IF EIBAID = DFHCLEAR
  3194         GO TO 9400-CLEAR.
  3195
  3196     IF PI-PROCESSOR-ID = 'LGXX'
  3197         GO TO 0200-RECEIVE.
  3198
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  64
* EL633.cbl
  3199
  3200* EXEC CICS READQ TS
  3201*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3202*        INTO   (SECURITY-CONTROL)
  3203*        LENGTH (SC-COMM-LENGTH)
  3204*        ITEM   (SC-ITEM)
  3205*    END-EXEC.
  3206*    MOVE '*$II   L              ''   #00003187' TO DFHEIV0
  3207     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3208     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3209     MOVE X'2020233030303033313837' TO DFHEIV0(25:11)
  3210     CALL 'kxdfhei1' USING DFHEIV0,
  3211           PI-SECURITY-TEMP-STORE-ID,
  3212           SECURITY-CONTROL,
  3213           SC-COMM-LENGTH,
  3214           SC-ITEM,
  3215           DFHEIV99,
  3216           DFHEIV99
  3217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3218
  3219
  3220     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3221     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3222
  3223     IF NOT DISPLAY-CAP
  3224         MOVE 'READ'          TO SM-READ
  3225         PERFORM 9995-SECURITY-VIOLATION
  3226         MOVE ER-0070         TO  EMI-ERROR
  3227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3228         GO TO 8100-SEND-INITIAL-MAP.
  3229
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  65
* EL633.cbl
  3231 0200-RECEIVE.
  3232
  3233     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3234         MOVE ER-0008            TO  EMI-ERROR
  3235         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3236         MOVE -1                 TO  MAINTL
  3237         GO TO 8200-SEND-DATAONLY.
  3238
  3239
  3240* EXEC CICS RECEIVE
  3241*        MAP     (MAP-NAME)
  3242*        MAPSET  (MAPSET-NAME)
  3243*        INTO    (EL633AI)
  3244*    END-EXEC.
  3245     MOVE LENGTH OF
  3246      EL633AI
  3247       TO DFHEIV11
  3248*    MOVE '8"T I  L              ''   #00003213' TO DFHEIV0
  3249     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3251     MOVE X'2020233030303033323133' TO DFHEIV0(25:11)
  3252     CALL 'kxdfhei1' USING DFHEIV0,
  3253           MAP-NAME,
  3254           EL633AI,
  3255           DFHEIV11,
  3256           MAPSET-NAME,
  3257           DFHEIV99,
  3258           DFHEIV99
  3259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3260
  3261
  3262     IF MAINTI = 'S' AND
  3263        EIBAID = DFHENTER
  3264         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3265                                     PI-SAV-ACCT-NET
  3266                                     PI-SAV-PREV-AMT
  3267                                     PI-SAV-PREV-NET
  3268                                     PI-FRST-FILE-SEQ-NO
  3269         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3270
  3271     IF PFENTERL = ZERO
  3272         GO TO 0300-CHECK-PFKEYS.
  3273
  3274     IF (PFENTERI  IS NUMERIC)
  3275       AND (PFENTERI GREATER 0 AND LESS 25)
  3276         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3277     ELSE
  3278         MOVE ER-0029               TO  EMI-ERROR
  3279         GO TO 0320-INPUT-ERROR.
  3280
  3281 0300-CHECK-PFKEYS.
  3282     IF EIBAID = DFHPF23
  3283         GO TO 8810-PF23.
  3284
  3285     IF EIBAID = DFHPF24
  3286         GO TO 9200-RETURN-MAIN-MENU.
  3287
  3288     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  66
* EL633.cbl
  3289         GO TO 9500-PF12.
  3290
  3291     IF EIBAID = DFHPF3
  3292         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3293             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3294             MOVE XCTL-652       TO  PGM-NAME
  3295             IF ERCOMP-KEY  NOT =      SPACES
  3296                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3297                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3298                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3299                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3300             END-IF
  3301
  3302             IF PI-CR-ACCOUNT = LOW-VALUES
  3303                 MOVE 'G'        TO  PI-CR-TYPE
  3304                 GO TO 9300-XCTL
  3305             ELSE
  3306                 MOVE 'A'        TO  PI-CR-TYPE
  3307                 GO TO 9300-XCTL
  3308         ELSE
  3309            MOVE ER-3020         TO  EMI-ERROR
  3310            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3311            GO TO 8100-SEND-INITIAL-MAP.
  3312
  3313     IF EIBAID = DFHPF4
  3314         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3315         MOVE XCTL-6331          TO  PGM-NAME
  3316         GO TO 9300-XCTL.
  3317
  3318     IF EIBAID = DFHPF5
  3319         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3320         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3321         MOVE XCTL-640           TO  PGM-NAME
  3322         IF PI-CR-ACCOUNT = LOW-VALUES
  3323             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3324             IF ACCTI = LOW-VALUES
  3325                MOVE 'G'         TO  PI-CR-TYPE
  3326             END-IF
  3327             GO TO 9300-XCTL
  3328         ELSE
  3329             MOVE 'A'        TO  PI-CR-TYPE
  3330             GO TO 9300-XCTL.
  3331
  3332     IF EIBAID = DFHPF6
  3333        IF PI-GA-BILLING
  3334            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3335            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3336            MOVE XCTL-642        TO  PGM-NAME
  3337            IF PI-CR-ACCOUNT = LOW-VALUES
  3338                 MOVE 'G'        TO  PI-CR-TYPE
  3339                 GO TO 9300-XCTL
  3340             ELSE
  3341                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3342                 GO TO 9300-XCTL
  3343        ELSE
  3344            MOVE ER-2929         TO  EMI-ERROR
  3345            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3346            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  67
* EL633.cbl
  3347            IF PFENTERL = ZERO
  3348                MOVE -1          TO  MAINTL
  3349                GO TO 8200-SEND-DATAONLY
  3350            ELSE
  3351                MOVE -1          TO  PFENTERL
  3352                GO TO 8200-SEND-DATAONLY.
  3353
  3354     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3355         GO TO 0400-VALIDATE-KEY-DATA.
  3356
  3357 0320-INPUT-ERROR.
  3358     MOVE ER-0029                TO  EMI-ERROR.
  3359
  3360     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3361
  3362     MOVE AL-UNBON               TO  PFENTERA.
  3363
  3364     IF PFENTERL = ZERO
  3365         MOVE -1                 TO  MAINTL
  3366     ELSE
  3367         MOVE -1                 TO  PFENTERL.
  3368
  3369     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  68
* EL633.cbl
  3371 0400-VALIDATE-KEY-DATA.
  3372     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3373         NEXT SENTENCE
  3374       ELSE
  3375        IF MAINTI NOT = 'S'
  3376         MOVE 'UPDATE'       TO SM-READ
  3377         PERFORM 9995-SECURITY-VIOLATION
  3378         MOVE ER-0070        TO EMI-ERROR
  3379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3380         GO TO 8100-SEND-INITIAL-MAP.
  3381
  3382     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3383
  3384     IF EIBAID = DFHPF1
  3385         GO TO 4000-BROWSE-FRWD.
  3386
  3387     IF EIBAID   = DFHPF1   AND
  3388        CARRIERL = ZEROS    AND
  3389        GROUPL   = ZEROS    AND
  3390        FINRESPL = ZEROS    AND
  3391        ACCTL    = ZEROS
  3392         GO TO 4000-BROWSE-FRWD.
  3393
  3394     IF PI-PROCESSOR-ID = 'LGXX'
  3395         IF MAINTI = 'C'
  3396             MOVE AL-UANON       TO MAINTA
  3397             MOVE MAINTI         TO PI-SAV-FUNCTION
  3398             GO TO CSO-BRANCH
  3399         END-IF
  3400     END-IF.
  3401
  3402     IF MAINTI = 'C' OR  'S'
  3403         MOVE AL-UANON           TO  MAINTA
  3404         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3405     ELSE
  3406         MOVE -1                 TO  MAINTL
  3407         MOVE ER-0023            TO  EMI-ERROR
  3408         MOVE AL-UABON           TO  MAINTA
  3409         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3410
  3411 CSO-BRANCH.
  3412
  3413     IF MAINTI = 'C'
  3414       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3415         MOVE -1                 TO  MAINTL
  3416         MOVE ER-2056            TO  EMI-ERROR
  3417         MOVE AL-UABON           TO  MAINTA
  3418         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3419
  3420     IF CARRIERL = ZEROS  AND
  3421        GROUPL   = ZEROS  AND
  3422        FINRESPL = ZEROS  AND
  3423        ACCTL    = ZEROS
  3424         MOVE -1                 TO  CARRIERL
  3425         MOVE ER-2231            TO  EMI-ERROR
  3426         MOVE AL-UABON           TO  CARRIERA
  3427                                     GROUPA
  3428                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  69
* EL633.cbl
  3429                                     ACCTA
  3430         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3431         GO TO 8200-SEND-DATAONLY.
  3432
  3433     IF CARRIERL NOT = ZEROS
  3434         MOVE AL-UANON           TO  CARRIERA
  3435         MOVE CARRIERI           TO  COMP-CARRIER
  3436                                     PI-SAV-CARRIER
  3437                                     PI-CR-CARRIER
  3438         IF CARRIERI NOT = ZEROS
  3439           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3440             MOVE ER-2587        TO  EMI-ERROR
  3441             MOVE -1             TO  CARRIERL
  3442             MOVE AL-UABON       TO  CARRIERA
  3443             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3444         ELSE
  3445             NEXT SENTENCE
  3446     ELSE
  3447         MOVE LOW-VALUES          TO  COMP-CARRIER
  3448                                      PI-SAV-CARRIER.
  3449
  3450     IF CARRIERL NOT = ZEROS
  3451         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3452             IF PI-CARRIER-SECURITY = CARRIERI
  3453                 NEXT SENTENCE
  3454             ELSE
  3455                 MOVE -1         TO  CARRIERL
  3456                 MOVE ER-2370    TO  EMI-ERROR
  3457                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3458
  3459     IF GROUPL NOT = ZEROS
  3460         MOVE AL-UANON           TO  GROUPA
  3461         MOVE GROUPI             TO  COMP-GROUPING
  3462                                     PI-SAV-GROUPING
  3463                                     PI-CR-GROUPING
  3464         IF GROUPI NOT = ZEROS
  3465           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3466             MOVE ER-2588        TO  EMI-ERROR
  3467             MOVE -1             TO  GROUPL
  3468             MOVE AL-UABON       TO  GROUPA
  3469             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3470         ELSE
  3471             NEXT SENTENCE
  3472     ELSE
  3473         MOVE LOW-VALUES         TO  COMP-GROUPING
  3474                                     PI-SAV-GROUPING.
  3475
  3476     IF FINRESPL NOT = ZEROS
  3477         MOVE AL-UANON           TO  FINRESPA
  3478         MOVE FINRESPI           TO  COMP-FIN-RESP
  3479                                     PI-SAV-FIN-RESP
  3480                                     PI-CR-FIN-RESP
  3481     ELSE
  3482         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3483                                     PI-SAV-FIN-RESP.
  3484
  3485     IF ACCTL NOT = ZEROS
  3486         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  70
* EL633.cbl
  3487         MOVE ACCTI              TO  COMP-ACCOUNT
  3488                                     PI-SAV-ACCOUNT
  3489                                     PI-CR-ACCOUNT
  3490     ELSE
  3491         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3492                                     PI-SAV-ACCOUNT
  3493                                     PI-CR-ACCOUNT.
  3494
  3495     IF EMI-ERROR = ZEROS
  3496         NEXT SENTENCE
  3497     ELSE
  3498         IF EIBTRNID = EL640-TRANS-ID OR
  3499            EIBTRNID = EL642-TRANS-ID OR
  3500            EIBTRNID = EL6331-TRANS-ID
  3501             GO TO 8100-SEND-INITIAL-MAP
  3502         ELSE
  3503             GO TO 8200-SEND-DATAONLY.
  3504
  3505     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3506
  3507     IF MAINTI = 'S'
  3508         IF EIBAID = DFHPF1              OR  DFHENTER
  3509             GO TO 4000-BROWSE-FRWD
  3510         ELSE
  3511             GO TO 4100-BROWSE-BKWD.
  3512
  3513     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3514     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3515
  3516
  3517* EXEC CICS HANDLE CONDITION
  3518*        NOTFND   (0410-NO-COMP-MSTR)
  3519*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3520*        END-EXEC.
  3521*    MOVE '"$IJ                  ! # #00003473' TO DFHEIV0
  3522     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3524     MOVE X'2320233030303033343733' TO DFHEIV0(25:11)
  3525     CALL 'kxdfhei1' USING DFHEIV0
  3526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3527
  3528
  3529
  3530* EXEC CICS READ
  3531*        DATASET  (COMP-FILE-ID)
  3532*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3533*        RIDFLD   (ERCOMP-KEY)
  3534*        GTEQ
  3535*        END-EXEC.
  3536*    MOVE '&"S        G          (   #00003478' TO DFHEIV0
  3537     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3539     MOVE X'2020233030303033343738' TO DFHEIV0(25:11)
  3540     CALL 'kxdfhei1' USING DFHEIV0,
  3541           COMP-FILE-ID,
  3542           DFHEIV20,
  3543           DFHEIV99,
  3544           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  71
* EL633.cbl
  3545           DFHEIV99,
  3546           DFHEIV99,
  3547           DFHEIV99
  3548     SET ADDRESS OF COMPENSATION-MASTER TO
  3549         DFHEIV20
  3550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3551
  3552
  3553     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3554        COMP-CARRIER  = CO-CARRIER     AND
  3555        COMP-GROUPING = CO-GROUPING    AND
  3556        COMP-FIN-RESP = CO-RESP-NO    AND
  3557        COMP-ACCOUNT  = CO-ACCOUNT
  3558         NEXT SENTENCE
  3559     ELSE
  3560         GO TO 0410-NO-COMP-MSTR.
  3561
  3562     IF PI-COMPANY-ID = 'NCL'
  3563         IF CO-GA-INACTIVE
  3564             GO TO 0420-INACTIVE-COMP.
  3565
  3566     IF MAINTI = 'C'
  3567         GO TO 1000-EDIT-DATA.
  3568
  3569     IF EIBAID = DFHPF1
  3570       OR DFHENTER
  3571         GO TO 4000-BROWSE-FRWD.
  3572
  3573     IF EIBAID = DFHPF2
  3574         GO TO 4100-BROWSE-BKWD.
  3575
  3576 0410-NO-COMP-MSTR.
  3577     MOVE ER-2230                TO  EMI-ERROR.
  3578     MOVE -1                     TO  CARRIERL.
  3579     MOVE AL-UABON               TO  CARRIERA
  3580                                     GROUPA
  3581                                     FINRESPA
  3582                                     ACCTA.
  3583
  3584     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3585
  3586     GO TO 8200-SEND-DATAONLY.
  3587
  3588 0420-INACTIVE-COMP.
  3589     MOVE ER-2763                TO  EMI-ERROR.
  3590     MOVE -1                     TO  CARRIERL.
  3591     MOVE AL-UABON               TO  CARRIERA
  3592                                     GROUPA
  3593                                     FINRESPA
  3594                                     ACCTA.
  3595
  3596     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3597
  3598     GO TO 8200-SEND-DATAONLY.
  3599
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  72
* EL633.cbl
  3601 0500-CREATE-TEMP-STORAGE.
  3602
  3603     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3604
  3605
  3606* EXEC CICS WRITEQ TS
  3607*        QUEUE  (QID)
  3608*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3609*        LENGTH (PI-COMM-LENGTH)
  3610*    END-EXEC.
  3611*    MOVE '*"                    ''   #00003537' TO DFHEIV0
  3612     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3614     MOVE X'2020233030303033353337' TO DFHEIV0(25:11)
  3615     CALL 'kxdfhei1' USING DFHEIV0,
  3616           QID,
  3617           PROGRAM-INTERFACE-BLOCK,
  3618           PI-COMM-LENGTH,
  3619           DFHEIV99,
  3620           DFHEIV99,
  3621           DFHEIV99
  3622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3623
  3624
  3625 0590-EXIT.
  3626      EXIT.
  3627
  3628 0600-RECOVER-TEMP-STORAGE.
  3629
  3630* EXEC CICS READQ TS
  3631*        QUEUE  (QID)
  3632*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3633*        LENGTH (PI-COMM-LENGTH)
  3634*    END-EXEC.
  3635*    MOVE '*$I    L              ''   #00003547' TO DFHEIV0
  3636     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3637     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3638     MOVE X'2020233030303033353437' TO DFHEIV0(25:11)
  3639     CALL 'kxdfhei1' USING DFHEIV0,
  3640           QID,
  3641           PROGRAM-INTERFACE-BLOCK,
  3642           PI-COMM-LENGTH,
  3643           DFHEIV99,
  3644           DFHEIV99,
  3645           DFHEIV99
  3646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3647
  3648
  3649     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3650
  3651 0690-EXIT.
  3652      EXIT.
  3653
  3654 0800-DELETE-TS.
  3655
  3656* EXEC CICS HANDLE CONDITION
  3657*        QIDERR (0890-EXIT)
  3658*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  73
* EL633.cbl
  3659*    MOVE '"$N                   ! $ #00003559' TO DFHEIV0
  3660     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3662     MOVE X'2420233030303033353539' TO DFHEIV0(25:11)
  3663     CALL 'kxdfhei1' USING DFHEIV0
  3664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3665
  3666
  3667
  3668* EXEC CICS DELETEQ TS
  3669*        QUEUE  (QID)
  3670*    END-EXEC.
  3671*    MOVE '*&                    #   #00003563' TO DFHEIV0
  3672     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3673     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3674     MOVE X'2020233030303033353633' TO DFHEIV0(25:11)
  3675     CALL 'kxdfhei1' USING DFHEIV0,
  3676           QID,
  3677           DFHEIV99
  3678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3679
  3680
  3681
  3682* EXEC CICS SYNCPOINT
  3683*    END-EXEC.
  3684*    MOVE '6"                    !   #00003567' TO DFHEIV0
  3685     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3687     MOVE X'2020233030303033353637' TO DFHEIV0(25:11)
  3688     CALL 'kxdfhei1' USING DFHEIV0
  3689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3690
  3691
  3692 0890-EXIT.
  3693      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  74
* EL633.cbl
  3695
  3696 1000-EDIT-DATA.
  3697     SET PINDX                   TO  1.
  3698
  3699     .
  3700 1010-EDIT-LOOP.
  3701     SET NDX                     TO  PINDX.
  3702     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3703        GL-STATE-LEN (PINDX) = ZEROS   AND
  3704        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3705        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3706        RTYPE-LEN (PINDX)     = ZEROS  AND
  3707        AMT-LEN (PINDX)       = ZEROS  AND
  3708        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3709        SDTE-LEN (PINDX)      = ZEROS
  3710         GO TO 1020-INCREMENT-PINDX.
  3711
  3712     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3713         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3714         IF PI-COMPANY-ID NOT = 'WSL'
  3715             NEXT SENTENCE
  3716         ELSE
  3717             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3718             MOVE '4'                   TO  DC-OPTION-CODE
  3719             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3720             IF NO-CONVERSION-ERROR
  3721                 NEXT SENTENCE
  3722             ELSE
  3723                 MOVE ER-2595    TO  EMI-ERROR
  3724                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3725                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3726                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3727     ELSE
  3728         IF PI-COMPANY-ID = 'WSL'
  3729           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3730             MOVE ER-2596        TO  EMI-ERROR
  3731             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3732             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3733             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3734
  3735
  3736     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3737*        MOVE K-SPACE            TO COFA-FILLER
  3738*        MOVE '0001'             TO COFA-COMPANY-X
  3739*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3740         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3741     ELSE
  3742         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3743             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3744             MOVE ER-2957        TO EMI-ERROR
  3745             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3746             PERFORM 9900-ERROR-FORMAT THRU
  3747                     9900-EXIT
  3748             GO TO 1040-CONTINUE-EDIT
  3749         ELSE
  3750             GO TO 1040-CONTINUE-EDIT
  3751         END-IF
  3752     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  75
* EL633.cbl
  3753
  3754     IF (PI-COMPANY-ID = 'DCC')
  3755        AND (RTYPE (PINDX) = 'P')
  3756        GO TO 1040-CONTINUE-EDIT
  3757     END-IF
  3758     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3759        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3760     ELSE
  3761        MOVE SPACES              TO CHECK-GL-ACCT
  3762     END-IF
  3763
  3764     EVALUATE TRUE
  3765        WHEN (PI-COMPANY-ID = 'DCC')
  3766           AND (CO-CARRIER = '1' OR '2')
  3767           AND (VALID-DCC-GL-ACCOUNT)
  3768           GO TO 1040-CONTINUE-EDIT
  3769        WHEN (PI-COMPANY-ID = 'DCC')
  3770           AND (CO-CARRIER = '3' OR '4')
  3771           AND VALID-CSI-GL-ACCOUNT
  3772           GO TO 1040-CONTINUE-EDIT
  3773        WHEN (PI-COMPANY-ID = 'DCC')
  3774           AND (CO-CARRIER = '5' OR '6' or '7')
  3775           AND (VALID-CCC-GL-ACCOUNT)
  3776           GO TO 1040-CONTINUE-EDIT
  3777        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3778           AND (VALID-GL-ACCOUNT)
  3779           GO TO 1040-CONTINUE-EDIT
  3780     END-EVALUATE
  3781*    EXEC CICS HANDLE CONDITION
  3782*         NOTFND (1040-NO-COFA-MSTR)
  3783*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3784*    END-EXEC.
  3785*
  3786*    EXEC CICS READ
  3787*         DATASET (COFA-FILE-ID)
  3788*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3789*         RIDFLD  (COFA-KEY-X)
  3790*    END-EXEC.
  3791*
  3792*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3793*    GO TO 1040-CONTINUE-EDIT.
  3794*
  3795*1040-NO-COFA-MSTR.
  3796
  3797     MOVE ER-2960                TO EMI-ERROR.
  3798     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3799     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3800     PERFORM 9900-ERROR-FORMAT THRU
  3801             9900-EXIT.
  3802
  3803 1040-CONTINUE-EDIT.
  3804
  3805*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3806     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3807         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3808         IF NOT VALID-STATE-CODE
  3809             MOVE -1             TO GL-STATE-LEN (PINDX)
  3810             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  76
* EL633.cbl
  3811             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3812             PERFORM 9900-ERROR-FORMAT THRU
  3813                     9900-EXIT
  3814         ELSE
  3815             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3816         END-IF
  3817     END-IF.
  3818
  3819 1040-CSO-SKIP.
  3820
  3821     IF GL-CANC (PINDX) = LOW-VALUES
  3822         MOVE SPACES             TO GL-CANC (PINDX)
  3823     END-IF.
  3824
  3825     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3826         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3827         IF NOT VALID-CANC-TYPE
  3828             MOVE -1             TO GL-CANC-LEN (PINDX)
  3829             MOVE ER-2958        TO EMI-ERROR
  3830             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3831             PERFORM 9900-ERROR-FORMAT THRU
  3832                     9900-EXIT
  3833         ELSE
  3834             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3835         END-IF
  3836     END-IF.
  3837
  3838     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3839        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3840        IF (PI-COMPANY-ID = 'DCC')
  3841           AND (RTYPE (PINDX) = 'P')
  3842           SET VALID-REC-TYPE   TO TRUE
  3843        END-IF
  3844         IF NOT VALID-REC-TYPE
  3845             MOVE -1             TO  RTYPE-LEN (PINDX)
  3846             MOVE ER-2234        TO  EMI-ERROR
  3847             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3848             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3849         ELSE
  3850             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3851     ELSE
  3852         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3853             MOVE -1             TO  RTYPE-LEN (PINDX)
  3854             MOVE ER-2235        TO  EMI-ERROR
  3855             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3856             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3857
  3858     IF AMT-LEN (PINDX) NOT = ZEROS
  3859
  3860* EXEC CICS BIF DEEDIT
  3861*           FIELD (AMT (PINDX))
  3862*           LENGTH (11)
  3863*       END-EXEC
  3864     MOVE 11
  3865       TO DFHEIV11
  3866*    MOVE '@"L                   #   #00003737' TO DFHEIV0
  3867     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3868     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  77
* EL633.cbl
  3869     MOVE X'2020233030303033373337' TO DFHEIV0(25:11)
  3870     CALL 'kxdfhei1' USING DFHEIV0,
  3871           AMT(PINDX),
  3872           DFHEIV11
  3873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3874         IF AMT (PINDX) = ZEROS
  3875             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3876                 NEXT SENTENCE
  3877             ELSE
  3878                 MOVE ER-2245    TO  EMI-ERROR
  3879                 MOVE -1         TO  AMT-LEN(PINDX)
  3880                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3881                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3882         ELSE
  3883             IF AMT (PINDX) NUMERIC
  3884                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3885             ELSE
  3886                 MOVE ER-2245    TO  EMI-ERROR
  3887                 MOVE -1         TO  AMT-LEN(PINDX)
  3888                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3889                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3890     ELSE
  3891         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3892             MOVE -1             TO  AMT-LEN (PINDX)
  3893             MOVE ER-2236        TO  EMI-ERROR
  3894             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3895             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3896
  3897     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3898         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3899           AND (PI-REC-TYPE (NDX) = 'C')
  3900             IF VOID-SW (PINDX) = 'V'
  3901                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3902             ELSE
  3903                 MOVE ER-2246    TO  EMI-ERROR
  3904                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3905                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3906                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3907         ELSE
  3908             MOVE ER-2449        TO  EMI-ERROR
  3909             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3910             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3911             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3912
  3913     IF SDTE-LEN (PINDX) = ZEROS
  3914        GO TO 1020-INCREMENT-PINDX.
  3915
  3916     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3917
  3918     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3919     PERFORM 8600-DEEDIT.
  3920
  3921     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3922        GO TO 1015-DAY-ERROR.
  3923
  3924     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3925     MOVE '4'                    TO  DC-OPTION-CODE.
  3926     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  78
* EL633.cbl
  3927
  3928     IF NO-CONVERSION-ERROR
  3929        SET PINDEX               TO  PINDX
  3930        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3931     ELSE
  3932        GO TO 1015-DAY-ERROR.
  3933
  3934     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3935
  3936     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3937         IF DATE-TEST-DD  NOT = 30
  3938             GO TO 1015-DAY-ERROR
  3939         ELSE
  3940             GO TO 1020-INCREMENT-PINDX.
  3941
  3942     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3943                             8  OR  10  OR  12
  3944         IF DATE-TEST-DD  NOT = 31
  3945             GO TO 1015-DAY-ERROR
  3946         ELSE
  3947             GO TO 1020-INCREMENT-PINDX.
  3948
  3949     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3950         REMAINDER  DIVIDE-REMAINDER.
  3951
  3952     IF (DATE-TEST-YY = ZERO)
  3953       OR (DIVIDE-REMAINDER NOT = ZERO)
  3954         IF DATE-TEST-DD  NOT = 28
  3955             GO TO 1015-DAY-ERROR
  3956         ELSE
  3957             GO TO 1020-INCREMENT-PINDX
  3958     ELSE
  3959         IF DATE-TEST-DD = 29
  3960             GO TO 1020-INCREMENT-PINDX.
  3961
  3962 1015-DAY-ERROR.
  3963     MOVE -1                     TO  SDTE-LEN (PINDX).
  3964     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3965     MOVE ER-0587                TO  EMI-ERROR.
  3966
  3967     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3968
  3969 1020-INCREMENT-PINDX.
  3970     SET PINDX  UP  BY  1.
  3971
  3972     IF PINDX  IS NOT GREATER THAN  13
  3973         GO TO 1010-EDIT-LOOP.
  3974
  3975     IF EMI-ERROR = ZEROS
  3976         NEXT SENTENCE
  3977     ELSE
  3978         MOVE 'S'                TO  PI-PREV-FUNCTION
  3979         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  79
* EL633.cbl
  3981 2000-UPDATE-THE-FILE.
  3982     SET PINDX                   TO  ZERO-NDX.
  3983*    SET NDX                     TO  ZERO-NDX.
  3984*    SET NDX  UP  BY  1.
  3985
  3986     IF PI-PYAJ-FILE-SW = 'B'
  3987         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3988         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3989     ELSE
  3990         MOVE PI-LAST-FILE-SEQ-NO
  3991                                 TO  PI-SAV-FILE-SEQ-NO
  3992         MOVE PI-LAST-RECORD-TYPE
  3993                                 TO  PI-SAV-RECORD-TYPE.
  3994
  3995 2100-UPDATE-LOOP.
  3996     SET PINDX  UP  BY  1.
  3997     SET NDX                     TO  PINDX.
  3998
  3999     IF PINDX  IS GREATER THAN  13
  4000         GO TO 2200-UPDATE-COMPLETE.
  4001
  4002     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4003        GL-STATE-LEN (PINDX) = ZEROS AND
  4004        GL-CANC-LEN (PINDX)   = ZEROS AND
  4005        GL-COMM-LEN (PINDX)   = ZEROS AND
  4006        RTYPE-LEN (PINDX)   = ZEROS  AND
  4007        AMT-LEN (PINDX)     = ZEROS  AND
  4008        VOID-SW-LEN (PINDX) = ZEROS  AND
  4009        SDTE-LEN (PINDX)    = ZEROS
  4010         GO TO 2100-UPDATE-LOOP.
  4011
  4012
  4013* EXEC CICS BIF DEEDIT
  4014*         FIELD (AMT (PINDX))
  4015*         LENGTH (11)
  4016*    END-EXEC.
  4017     MOVE 11
  4018       TO DFHEIV11
  4019*    MOVE '@"L                   #   #00003879' TO DFHEIV0
  4020     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4021     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4022     MOVE X'2020233030303033383739' TO DFHEIV0(25:11)
  4023     CALL 'kxdfhei1' USING DFHEIV0,
  4024           AMT(PINDX),
  4025           DFHEIV11
  4026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4027
  4028
  4029     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4030         NEXT SENTENCE
  4031     ELSE
  4032         GO TO 2110-ADD-RECORD.
  4033
  4034
  4035* EXEC CICS HANDLE CONDITION
  4036*        NOTFND  (2110-ADD-RECORD)
  4037*    END-EXEC.
  4038*    MOVE '"$I                   ! % #00003889' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  80
* EL633.cbl
  4039     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4041     MOVE X'2520233030303033383839' TO DFHEIV0(25:11)
  4042     CALL 'kxdfhei1' USING DFHEIV0
  4043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4044
  4045
  4046     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4047     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4048     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4049
  4050
  4051* EXEC CICS READ
  4052*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4053*        DATASET  (PYAJ-FILE-ID)
  4054*        RIDFLD   (ERPYAJ-KEY)
  4055*        UPDATE
  4056*    END-EXEC.
  4057*    MOVE '&"S        EU         (   #00003897' TO DFHEIV0
  4058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4059     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4060     MOVE X'2020233030303033383937' TO DFHEIV0(25:11)
  4061     CALL 'kxdfhei1' USING DFHEIV0,
  4062           PYAJ-FILE-ID,
  4063           DFHEIV20,
  4064           DFHEIV99,
  4065           ERPYAJ-KEY,
  4066           DFHEIV99,
  4067           DFHEIV99,
  4068           DFHEIV99
  4069     SET ADDRESS OF PENDING-PAY-ADJ TO
  4070         DFHEIV20
  4071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4072
  4073
  4074
  4075     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4076        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4077            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4078            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4079            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4080
  4081     IF AMT-LEN (PINDX) NOT = ZEROS
  4082         IF AMT (PINDX) = ZEROS
  4083             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4084                 GO TO 2120-DELETE-RECORD
  4085             ELSE
  4086                 MOVE ER-2244       TO  EMI-ERROR
  4087                 MOVE -1            TO  AMT-LEN (PINDX)
  4088                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4089                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4090                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4091
  4092* EXEC CICS UNLOCK
  4093*                    DATASET  (PYAJ-FILE-ID)
  4094*                END-EXEC
  4095*    MOVE '&*                    #   #00003921' TO DFHEIV0
  4096     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  81
* EL633.cbl
  4097     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4098     MOVE X'2020233030303033393231' TO DFHEIV0(25:11)
  4099     CALL 'kxdfhei1' USING DFHEIV0,
  4100           PYAJ-FILE-ID,
  4101           DFHEIV99
  4102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4103                 GO TO 8200-SEND-DATAONLY.
  4104
  4105     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4106     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4107     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4108
  4109     PERFORM 8400-LOG-JOURNAL-RECORD.
  4110
  4111     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4112     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4113     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4114
  4115     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4116         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4117     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4118         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4119     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4120         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4121     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4122         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4123     IF AMT-LEN (PINDX) NOT = ZEROS
  4124         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4125
  4126     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4127         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4128
  4129     IF SDTE-LEN (PINDX) NOT = ZEROS
  4130        SET PINDEX               TO  PINDX
  4131        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4132
  4133     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4134     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4135     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4136
  4137
  4138* EXEC CICS REWRITE
  4139*        DATASET  (PYAJ-FILE-ID)
  4140*        FROM     (PENDING-PAY-ADJ)
  4141*    END-EXEC.
  4142     MOVE LENGTH OF
  4143      PENDING-PAY-ADJ
  4144       TO DFHEIV11
  4145*    MOVE '&& L                  %   #00003958' TO DFHEIV0
  4146     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4147     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4148     MOVE X'2020233030303033393538' TO DFHEIV0(25:11)
  4149     CALL 'kxdfhei1' USING DFHEIV0,
  4150           PYAJ-FILE-ID,
  4151           PENDING-PAY-ADJ,
  4152           DFHEIV11,
  4153           DFHEIV99
  4154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  82
* EL633.cbl
  4155
  4156
  4157     PERFORM 8400-LOG-JOURNAL-RECORD.
  4158
  4159     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  83
* EL633.cbl
  4161 2110-ADD-RECORD.
  4162
  4163* EXEC CICS GETMAIN
  4164*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4165*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4166*        INITIMG  (GETMAIN-SPACE)
  4167*    END-EXEC.
  4168*    MOVE ',"IL                  $   #00003968' TO DFHEIV0
  4169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4171     MOVE X'2020233030303033393638' TO DFHEIV0(25:11)
  4172     CALL 'kxdfhei1' USING DFHEIV0,
  4173           DFHEIV20,
  4174           ERPYAJ-RECORD-LENGTH,
  4175           GETMAIN-SPACE
  4176     SET ADDRESS OF PENDING-PAY-ADJ TO
  4177         DFHEIV20
  4178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4179
  4180
  4181     MOVE 'PY'                   TO  PY-RECORD-ID.
  4182     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4183     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4184     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4185     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4186     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4187
  4188     ADD +1                      TO  WORK-SEQ-NO.
  4189     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4190
  4191     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4192     MOVE GL-STATE (PINDX)       TO  PY-GL-STATE.
  4193     MOVE GL-CANC (PINDX)        TO  PY-GL-CANC-SW.
  4194     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4195
  4196     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4197     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4198     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4199        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4200     END-IF
  4201     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4202     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4203     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4204                                     PY-INPUT-DT.
  4205     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4206                                     PY-CHECK-QUE-SEQUENCE.
  4207     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4208                                     PY-BILLED-DATE
  4209                                     PY-AR-DATE
  4210                                     PY-REPORTED-DT
  4211                                     PY-CHECK-WRITTEN-DT.
  4212     IF SDTE-LEN (PINDX) = ZEROS
  4213         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4214         GO TO 2115-WRITE-REC
  4215     END-IF.
  4216
  4217     IF SDTE (PINDX) IS NUMERIC
  4218         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  84
* EL633.cbl
  4219         MOVE '4'            TO  DC-OPTION-CODE
  4220         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4221         IF DATE-CONVERSION-ERROR
  4222             MOVE PI-CR-MONTH-END-DT
  4223                             TO  PY-CREDIT-SELECT-DT
  4224         ELSE
  4225             MOVE DC-BIN-DATE-1
  4226                             TO  PY-CREDIT-SELECT-DT
  4227         END-IF
  4228     ELSE
  4229         MOVE PI-CR-MONTH-END-DT
  4230                             TO  PY-CREDIT-SELECT-DT
  4231     END-IF
  4232
  4233     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4234         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4235         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4236
  4237     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4238         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4239         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4240
  4241     MOVE 'N'                    TO  FIRST-ADD-SW.
  4242
  4243     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4244     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4245     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4246 2115-WRITE-REC.
  4247
  4248* EXEC CICS WRITE
  4249*        DATASET  (PYAJ-FILE-ID)
  4250*        FROM     (PENDING-PAY-ADJ)
  4251*        RIDFLD   (PY-CONTROL-PRIMARY)
  4252*    END-EXEC.
  4253     MOVE LENGTH OF
  4254      PENDING-PAY-ADJ
  4255       TO DFHEIV11
  4256*    MOVE '&$ L                  ''   #00004040' TO DFHEIV0
  4257     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4258     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4259     MOVE X'2020233030303034303430' TO DFHEIV0(25:11)
  4260     CALL 'kxdfhei1' USING DFHEIV0,
  4261           PYAJ-FILE-ID,
  4262           PENDING-PAY-ADJ,
  4263           DFHEIV11,
  4264           PY-CONTROL-PRIMARY,
  4265           DFHEIV99,
  4266           DFHEIV99
  4267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4268
  4269
  4270     PERFORM 8400-LOG-JOURNAL-RECORD.
  4271
  4272     GO TO 2100-UPDATE-LOOP.
  4273
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  85
* EL633.cbl
  4275 2120-DELETE-RECORD.
  4276     IF PY-RECORD-TYPE NOT = 'C'
  4277         GO TO 2120-DELETE-CONT.
  4278
  4279     IF PY-CHECK-QUE-CONTROL = ZEROS
  4280       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4281         GO TO 2120-DELETE-CONT.
  4282
  4283
  4284* EXEC CICS HANDLE CONDITION
  4285*        NOTFND  (2120-DELETE-CONT)
  4286*    END-EXEC.
  4287*    MOVE '"$I                   ! & #00004059' TO DFHEIV0
  4288     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4290     MOVE X'2620233030303034303539' TO DFHEIV0(25:11)
  4291     CALL 'kxdfhei1' USING DFHEIV0
  4292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4293
  4294
  4295     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4296     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4297     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4298
  4299
  4300* EXEC CICS READ
  4301*        SET      (ADDRESS OF CHECK-QUE)
  4302*        DATASET  (CHKQ-FILE-ID)
  4303*        RIDFLD   (ERCHKQ-KEY)
  4304*        UPDATE
  4305*    END-EXEC.
  4306*    MOVE '&"S        EU         (   #00004067' TO DFHEIV0
  4307     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4308     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4309     MOVE X'2020233030303034303637' TO DFHEIV0(25:11)
  4310     CALL 'kxdfhei1' USING DFHEIV0,
  4311           CHKQ-FILE-ID,
  4312           DFHEIV20,
  4313           DFHEIV99,
  4314           ERCHKQ-KEY,
  4315           DFHEIV99,
  4316           DFHEIV99,
  4317           DFHEIV99
  4318     SET ADDRESS OF CHECK-QUE TO
  4319         DFHEIV20
  4320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4321
  4322
  4323*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4324*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4325*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4326*
  4327*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4328
  4329
  4330* EXEC CICS DELETE
  4331*        DATASET  (CHKQ-FILE-ID)
  4332*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  86
* EL633.cbl
  4333*    MOVE '&(                    &   #00004080' TO DFHEIV0
  4334     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4335     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4336     MOVE X'2020233030303034303830' TO DFHEIV0(25:11)
  4337     CALL 'kxdfhei1' USING DFHEIV0,
  4338           CHKQ-FILE-ID,
  4339           DFHEIV99,
  4340           DFHEIV99,
  4341           DFHEIV99,
  4342           DFHEIV99
  4343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4344
  4345
  4346 2120-DELETE-CONT.
  4347*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4348*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4349*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4350*
  4351*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4352
  4353     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4354         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4355         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4356         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4357                                     PI-SAV-ACCT-NET
  4358                                     PI-SAV-PREV-AMT
  4359                                     PI-SAV-PREV-NET.
  4360
  4361
  4362* EXEC CICS DELETE
  4363*        DATASET(PYAJ-FILE-ID)
  4364*    END-EXEC.
  4365*    MOVE '&(                    &   #00004099' TO DFHEIV0
  4366     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4367     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4368     MOVE X'2020233030303034303939' TO DFHEIV0(25:11)
  4369     CALL 'kxdfhei1' USING DFHEIV0,
  4370           PYAJ-FILE-ID,
  4371           DFHEIV99,
  4372           DFHEIV99,
  4373           DFHEIV99,
  4374           DFHEIV99
  4375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4376
  4377
  4378     GO TO 2100-UPDATE-LOOP.
  4379
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  87
* EL633.cbl
  4381
  4382 2190-CHANGE-RECORD-TYPE.
  4383
  4384*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4385*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4386*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4387*
  4388*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4389
  4390
  4391* EXEC CICS DELETE
  4392*        DATASET(PYAJ-FILE-ID)
  4393*    END-EXEC.
  4394*    MOVE '&(                    &   #00004115' TO DFHEIV0
  4395     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4397     MOVE X'2020233030303034313135' TO DFHEIV0(25:11)
  4398     CALL 'kxdfhei1' USING DFHEIV0,
  4399           PYAJ-FILE-ID,
  4400           DFHEIV99,
  4401           DFHEIV99,
  4402           DFHEIV99,
  4403           DFHEIV99
  4404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4405
  4406
  4407
  4408* EXEC CICS GETMAIN
  4409*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4410*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4411*        INITIMG  (GETMAIN-SPACE)
  4412*    END-EXEC.
  4413*    MOVE ',"IL                  $   #00004119' TO DFHEIV0
  4414     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4415     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4416     MOVE X'2020233030303034313139' TO DFHEIV0(25:11)
  4417     CALL 'kxdfhei1' USING DFHEIV0,
  4418           DFHEIV20,
  4419           ERPYAJ-RECORD-LENGTH,
  4420           GETMAIN-SPACE
  4421     SET ADDRESS OF PENDING-PAY-ADJ TO
  4422         DFHEIV20
  4423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4424
  4425
  4426*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4427*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4428
  4429     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4430     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4431                                    PYAJ-RECORD-TYPE.
  4432
  4433
  4434* EXEC CICS HANDLE CONDITION
  4435*        DUPREC (2190-DUP-RECORD)
  4436*    END-EXEC.
  4437*    MOVE '"$%                   ! '' #00004132' TO DFHEIV0
  4438     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  88
* EL633.cbl
  4439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4440     MOVE X'2720233030303034313332' TO DFHEIV0(25:11)
  4441     CALL 'kxdfhei1' USING DFHEIV0
  4442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4443
  4444
  4445*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4446*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4447*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4448
  4449 2190-RETRY-WRITE.
  4450
  4451
  4452* EXEC CICS WRITE
  4453*        DATASET  (PYAJ-FILE-ID)
  4454*        FROM     (PENDING-PAY-ADJ)
  4455*        RIDFLD   (PY-CONTROL-PRIMARY)
  4456*    END-EXEC.
  4457     MOVE LENGTH OF
  4458      PENDING-PAY-ADJ
  4459       TO DFHEIV11
  4460*    MOVE '&$ L                  ''   #00004142' TO DFHEIV0
  4461     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4462     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4463     MOVE X'2020233030303034313432' TO DFHEIV0(25:11)
  4464     CALL 'kxdfhei1' USING DFHEIV0,
  4465           PYAJ-FILE-ID,
  4466           PENDING-PAY-ADJ,
  4467           DFHEIV11,
  4468           PY-CONTROL-PRIMARY,
  4469           DFHEIV99,
  4470           DFHEIV99
  4471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4472
  4473
  4474*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4475
  4476
  4477* EXEC CICS READ
  4478*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4479*        DATASET  (PYAJ-FILE-ID)
  4480*        RIDFLD   (ERPYAJ-KEY)
  4481*        UPDATE
  4482*    END-EXEC.
  4483*    MOVE '&"S        EU         (   #00004150' TO DFHEIV0
  4484     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4485     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4486     MOVE X'2020233030303034313530' TO DFHEIV0(25:11)
  4487     CALL 'kxdfhei1' USING DFHEIV0,
  4488           PYAJ-FILE-ID,
  4489           DFHEIV20,
  4490           DFHEIV99,
  4491           ERPYAJ-KEY,
  4492           DFHEIV99,
  4493           DFHEIV99,
  4494           DFHEIV99
  4495     SET ADDRESS OF PENDING-PAY-ADJ TO
  4496         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  89
* EL633.cbl
  4497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4498
  4499
  4500     GO TO 2190-EXIT.
  4501
  4502 2190-DUP-RECORD.
  4503
  4504     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4505
  4506     GO TO 2190-RETRY-WRITE.
  4507
  4508 2190-EXIT.
  4509     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  90
* EL633.cbl
  4511
  4512 2200-UPDATE-COMPLETE.
  4513     IF EIBAID = DFHPF1
  4514         GO TO 4000-BROWSE-FRWD.
  4515
  4516     IF EIBAID = DFHPF2
  4517         GO TO 4100-BROWSE-BKWD.
  4518
  4519     MOVE LOW-VALUES             TO  EL633AI.
  4520
  4521     MOVE ER-0000                TO  EMI-ERROR.
  4522     MOVE -1                     TO  MAINTL.
  4523
  4524     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4525
  4526     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4527     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4528
  4529*    GO TO 4000-BROWSE-FRWD.
  4530
  4531*    GO TO 8100-SEND-INITIAL-MAP.
  4532
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  91
* EL633.cbl
  4534 4000-BROWSE-FRWD.
  4535     MOVE '1'                     TO  PI-PREV-PFKEY.
  4536     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4537
  4538     IF EIBAID = DFHPF1
  4539         IF PAGE-FULL
  4540             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4541                                      TO  PYAJ-FILE-SEQ-NO
  4542             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4543             MOVE 'N'                 TO  PYAJ-READ-SW
  4544             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4545             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4546             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4547             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4548         ELSE
  4549             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4550                                          PI-SAV-ACCT-NET
  4551                                          PI-SAV-PREV-AMT
  4552                                          PI-SAV-PREV-NET
  4553             MOVE 'Y'                 TO  PI-PAGE-SW
  4554             IF NOT END-OF-FILE
  4555                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4556                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4557             END-IF
  4558             IF TOP-OF-FILE
  4559                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4560                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4561                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4562             ELSE
  4563                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4564                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4565     ELSE
  4566         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4567         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4568         IF MAINTI = 'S'
  4569             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4570             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4571
  4572
  4573     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4574
  4575     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4576         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4577
  4578 4000-BROWSE-FRWD-FOR-PREV.
  4579*    IF END-OF-FILE
  4580*        IF EIBAID = DFHPF1
  4581*           IF PI-TOTAL-DISPLAYED
  4582*              NEXT SENTENCE
  4583*           ELSE
  4584*              MOVE -1                 TO  MAINTL
  4585*              MOVE ER-2237            TO  EMI-ERROR
  4586*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4587*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4588*              SET PINDX               TO  +2
  4589*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4590*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4591*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  92
* EL633.cbl
  4592*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4593*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4594*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4595*                                          PI-SAV-ACCT-NET
  4596*              GO TO 8100-SEND-INITIAL-MAP.
  4597*
  4598*     IF END-OF-FILE
  4599*        IF EIBAID = DFHPF1
  4600*           MOVE -1             TO  MAINTL
  4601*           MOVE ER-2237        TO  EMI-ERROR
  4602*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4603*           GO TO 8200-SEND-DATAONLY.
  4604*
  4605     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4606
  4607     IF NO-RECORDS
  4608        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4609        MOVE LOW-VALUES         TO  EL633AO
  4610        MOVE ER-2239            TO  EMI-ERROR
  4611        MOVE -1                 TO  MAINTL
  4612        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4613        GO TO 8100-SEND-INITIAL-MAP.
  4614
  4615     IF NOT-OPEN
  4616         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4617
  4618     MOVE LOW-VALUES             TO  EL633AO.
  4619     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4620
  4621     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4622          VARYING  PINDX  FROM  1  BY  1
  4623             UNTIL  END-OF-ACCT
  4624                 OR  END-OF-FILE
  4625                     OR  PAGE-FULL
  4626                         OR  NO-RECORDS.
  4627
  4628     IF NO-RECORDS
  4629         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4630         MOVE LOW-VALUES         TO  EL633AO
  4631         MOVE ER-2239            TO  EMI-ERROR
  4632         MOVE -1                 TO  MAINTL
  4633         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4634         GO TO 8100-SEND-INITIAL-MAP.
  4635
  4636     IF END-OF-FILE
  4637         IF EIBAID = DFHPF2
  4638             MOVE ER-2238        TO  EMI-ERROR
  4639             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4640             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4641         ELSE
  4642             MOVE ER-2237        TO  EMI-ERROR
  4643             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4644
  4645     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4646                                     PI-SAV-FUNCTION.
  4647
  4648     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  93
* EL633.cbl
  4650 4100-BROWSE-BKWD.
  4651     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4652                                      PI-TOTAL-DISPLAYED-SW.
  4653     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4654     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4655     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4656     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4657                                      PI-SAV-ACCT-NET
  4658                                      PI-SAV-PREV-AMT
  4659                                      PI-SAV-PREV-NET.
  4660
  4661     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4662
  4663     IF NO-RECORDS
  4664         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4665         MOVE LOW-VALUES         TO  EL633AO
  4666         MOVE ER-2239            TO  EMI-ERROR
  4667         MOVE -1                 TO  MAINTL
  4668         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4669         GO TO 8100-SEND-INITIAL-MAP.
  4670
  4671     IF NOT-OPEN
  4672         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4673
  4674
  4675* EXEC CICS READNEXT
  4676*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4677*        DATASET  (PYAJ-FILE-ID)
  4678*        RIDFLD   (ERPYAJ-KEY)
  4679*    END-EXEC.
  4680     MOVE 0
  4681       TO DFHEIV11
  4682*    MOVE '&.S                   )   #00004331' TO DFHEIV0
  4683     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4684     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4685     MOVE X'2020233030303034333331' TO DFHEIV0(25:11)
  4686     CALL 'kxdfhei1' USING DFHEIV0,
  4687           PYAJ-FILE-ID,
  4688           DFHEIV20,
  4689           DFHEIV99,
  4690           ERPYAJ-KEY,
  4691           DFHEIV99,
  4692           DFHEIV11,
  4693           DFHEIV99,
  4694           DFHEIV99
  4695     SET ADDRESS OF PENDING-PAY-ADJ TO
  4696         DFHEIV20
  4697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4698
  4699
  4700     IF FIRST-PAGE OR
  4701        PI-PREV-PFKEY = '2'
  4702         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4703         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4704
  4705     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4706
  4707     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  94
* EL633.cbl
  4708     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4709     MOVE '2'                     TO  PI-PREV-PFKEY.
  4710
  4711     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  95
* EL633.cbl
  4713 5000-START-BROWSE.
  4714
  4715* EXEC CICS HANDLE CONDITION
  4716*        NOTOPEN  (5010-NOT-OPEN)
  4717*        NOTFND   (5020-NO-RECORDS)
  4718*        ENDFILE  (5020-NO-RECORDS)
  4719*    END-EXEC.
  4720*    MOVE '"$JI''                 ! ( #00004351' TO DFHEIV0
  4721     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4723     MOVE X'2820233030303034333531' TO DFHEIV0(25:11)
  4724     CALL 'kxdfhei1' USING DFHEIV0
  4725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4726
  4727
  4728
  4729* EXEC CICS STARTBR
  4730*        DATASET  (PYAJ-FILE-ID)
  4731*        RIDFLD   (ERPYAJ-KEY)
  4732*    END-EXEC.
  4733     MOVE 0
  4734       TO DFHEIV11
  4735*    MOVE '&,         G          &   #00004357' TO DFHEIV0
  4736     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4737     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4738     MOVE X'2020233030303034333537' TO DFHEIV0(25:11)
  4739     CALL 'kxdfhei1' USING DFHEIV0,
  4740           PYAJ-FILE-ID,
  4741           ERPYAJ-KEY,
  4742           DFHEIV99,
  4743           DFHEIV11,
  4744           DFHEIV99
  4745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4746
  4747
  4748     GO TO 5030-EXIT.
  4749
  4750 5010-NOT-OPEN.
  4751     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4752
  4753     GO TO 5030-EXIT.
  4754
  4755 5020-NO-RECORDS.
  4756     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4757     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4758
  4759 5030-EXIT.
  4760     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  96
* EL633.cbl
  4762 5100-READ-PREVIOUS.
  4763
  4764* EXEC CICS HANDLE CONDITION
  4765*        ENDFILE  (5110-END-OF-FILE)
  4766*        NOTFND   (5110-END-OF-FILE)
  4767*    END-EXEC.
  4768*    MOVE '"$''I                  ! ) #00004377' TO DFHEIV0
  4769     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4771     MOVE X'2920233030303034333737' TO DFHEIV0(25:11)
  4772     CALL 'kxdfhei1' USING DFHEIV0
  4773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4774
  4775
  4776
  4777* EXEC CICS READPREV
  4778*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4779*        DATASET  (PYAJ-FILE-ID)
  4780*        RIDFLD   (ERPYAJ-KEY)
  4781*    END-EXEC.
  4782     MOVE 0
  4783       TO DFHEIV11
  4784*    MOVE '&0S                   )   #00004382' TO DFHEIV0
  4785     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4786     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4787     MOVE X'2020233030303034333832' TO DFHEIV0(25:11)
  4788     CALL 'kxdfhei1' USING DFHEIV0,
  4789           PYAJ-FILE-ID,
  4790           DFHEIV20,
  4791           DFHEIV99,
  4792           ERPYAJ-KEY,
  4793           DFHEIV99,
  4794           DFHEIV11,
  4795           DFHEIV99,
  4796           DFHEIV99
  4797     SET ADDRESS OF PENDING-PAY-ADJ TO
  4798         DFHEIV20
  4799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4800
  4801
  4802     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4803         IF PI-CARRIER-SECURITY = PY-CARRIER
  4804             NEXT SENTENCE
  4805         ELSE
  4806             GO TO 5110-END-OF-FILE.
  4807
  4808     GO TO 5120-EXIT.
  4809
  4810 5110-END-OF-FILE.
  4811     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4812     MOVE ER-2238                TO  EMI-ERROR.
  4813     MOVE -1                     TO  PFENTERL.
  4814
  4815     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4816
  4817     GO TO 8200-SEND-DATAONLY.
  4818
  4819 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  97
* EL633.cbl
  4820     EXIT.
  4821
  4822 5200-END-BROWSE.
  4823
  4824* EXEC CICS ENDBR
  4825*        DATASET  (PYAJ-FILE-ID)
  4826*    END-EXEC.
  4827     MOVE 0
  4828       TO DFHEIV11
  4829*    MOVE '&2                    $   #00004409' TO DFHEIV0
  4830     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4832     MOVE X'2020233030303034343039' TO DFHEIV0(25:11)
  4833     CALL 'kxdfhei1' USING DFHEIV0,
  4834           PYAJ-FILE-ID,
  4835           DFHEIV11,
  4836           DFHEIV99
  4837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4838
  4839
  4840 5200-EXIT.
  4841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  98
* EL633.cbl
  4843 6000-READ-AND-FORMAT-SCREEN.
  4844
  4845* EXEC CICS HANDLE CONDITION
  4846*        ENDFILE  (6100-END-OF-FILE)
  4847*        NOTFND   (6100-END-OF-FILE)
  4848*    END-EXEC.
  4849*    MOVE '"$''I                  ! * #00004417' TO DFHEIV0
  4850     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4852     MOVE X'2A20233030303034343137' TO DFHEIV0(25:11)
  4853     CALL 'kxdfhei1' USING DFHEIV0
  4854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4855
  4856
  4857*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4858*    INITIALIZE  PI-SEQ-NOS.
  4859
  4860 6010-READ-NEXT.
  4861
  4862
  4863* EXEC CICS READNEXT
  4864*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4865*        DATASET  (PYAJ-FILE-ID)
  4866*        RIDFLD   (ERPYAJ-KEY)
  4867*    END-EXEC.
  4868     MOVE 0
  4869       TO DFHEIV11
  4870*    MOVE '&.S                   )   #00004427' TO DFHEIV0
  4871     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4872     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4873     MOVE X'2020233030303034343237' TO DFHEIV0(25:11)
  4874     CALL 'kxdfhei1' USING DFHEIV0,
  4875           PYAJ-FILE-ID,
  4876           DFHEIV20,
  4877           DFHEIV99,
  4878           ERPYAJ-KEY,
  4879           DFHEIV99,
  4880           DFHEIV11,
  4881           DFHEIV99,
  4882           DFHEIV99
  4883     SET ADDRESS OF PENDING-PAY-ADJ TO
  4884         DFHEIV20
  4885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4886
  4887
  4888     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4889       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4890         GO TO 6100-END-OF-FILE.
  4891
  4892     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4893         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4894             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4895                 GO TO 6100-END-OF-FILE.
  4896
  4897     IF PYAJ-1ST-READ
  4898       AND EIBAID NOT = DFHENTER
  4899       AND NOT PAGE-FULL
  4900         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page  99
* EL633.cbl
  4901         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4902         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4903         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4904         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4905
  4906     IF PYAJ-1ST-READ
  4907         MOVE PI-SAV-ENDING-PYAJ-KEY
  4908                                 TO  PI-START-PYAJ-KEY.
  4909
  4910     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4911        PI-SAV-CARRIER  = PY-CARRIER     AND
  4912        PI-SAV-GROUPING = PY-GROUPING    AND
  4913        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4914        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4915         NEXT SENTENCE
  4916     ELSE
  4917         IF PYAJ-1ST-READ
  4918             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4919             MOVE SPACE          TO  PYAJ-READ-SW
  4920             GO TO 6200-EXIT
  4921         ELSE
  4922             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4923             IF PINDX  IS LESS THAN  12
  4924                 SET PINDX  UP  BY  1
  4925                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4926                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4927                 SET PINDX  UP  BY  1
  4928                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4929                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4930                     GO TO 6200-EXIT
  4931             ELSE
  4932                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4933                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4934                 SET PINDX  UP  BY  1
  4935                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4936                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4937                 GO TO 6200-EXIT.
  4938
  4939*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4940
  4941     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4942         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4943
  4944*    SET PINDX  UP  BY +1.
  4945
  4946     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4947
  4948     IF PINDX  IS GREATER THAN  13
  4949         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4950         MOVE +13                TO  PI-FULL-INDX
  4951         MOVE PI-FRST-FILE-SEQ-NO
  4952                                 TO  PI-LAST-FILE-SEQ-NO
  4953         MOVE PI-FRST-RECORD-TYPE
  4954                                 TO  PI-LAST-RECORD-TYPE
  4955         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4956         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4957         GO TO 6200-EXIT.
  4958
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 100
* EL633.cbl
  4959     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4960     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4961
  4962     IF PYAJ-1ST-READ
  4963         MOVE SPACE              TO  PYAJ-READ-SW.
  4964
  4965     IF PINDX = 1
  4966         MOVE PI-PREV-FILE-SEQ-NO
  4967                                 TO  PI-FRST-FILE-SEQ-NO
  4968         MOVE PI-PREV-RECORD-TYPE
  4969                                 TO  PI-FRST-RECORD-TYPE
  4970         MOVE PI-PREV-FILE-SEQ-NO
  4971                                 TO  PI-LAST-FILE-SEQ-NO
  4972         MOVE PI-PREV-RECORD-TYPE
  4973                                 TO  PI-LAST-RECORD-TYPE.
  4974
  4975     SET NDX                     TO  PINDX.
  4976     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4977
  4978     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4979
  4980     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4981     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4982     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4983     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4984     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4985
  4986     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4987
  4988     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4989         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4990     ELSE
  4991         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  4992
  4993     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  4994                                     PI-REC-TYPE (NDX).
  4995
  4996     IF PY-VOID-SW NOT = SPACE
  4997         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  4998
  4999     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5000         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5001     ELSE
  5002         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5003                                     PREV-BIN-MAINT-DT
  5004         MOVE SPACE              TO  DC-OPTION-CODE
  5005         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5006* DAN    MOVE DC-GREG-DATE-1-EDIT
  5007         MOVE DC-GREG-DATE-1-MDY
  5008                                 TO  MDTE (PINDX)
  5009                                     PREV-MAINT-DT.
  5010
  5011*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5012     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5013         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5014         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5015*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5016*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 101
* EL633.cbl
  5017     END-IF.
  5018
  5019     IF PY-BILLED-DATE NOT = LOW-VALUES
  5020         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5021                                     AMT-ATTRB (PINDX)
  5022                                     VOID-SW-ATTRB (PINDX)
  5023         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5024             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5025         ELSE
  5026             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5027                                     PREV-BIN-BL-DT
  5028             MOVE SPACE          TO  DC-OPTION-CODE
  5029             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5030* DAN        MOVE DC-GREG-DATE-1-EDIT
  5031             MOVE DC-GREG-DATE-1-MDY
  5032                                 TO  BDTE (PINDX)
  5033                                     PREV-BL-DT.
  5034
  5035     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5036         NEXT SENTENCE
  5037     ELSE
  5038         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5039                                     AMT-ATTRB     (PINDX).
  5040
  5041     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5042         MOVE PY-CREDIT-SELECT-DT
  5043                                 TO  DC-BIN-DATE-1
  5044         MOVE SPACE              TO  DC-OPTION-CODE
  5045         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5046
  5047         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5048         MOVE WS-GS-MM             TO  WS-SS-MM
  5049         MOVE WS-GS-DD             TO  WS-SS-DD
  5050         MOVE WS-GS-YY             TO  WS-SS-YY
  5051         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5052     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5053        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5054         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5055                                    AMT-ATTRB      (PINDX)
  5056                                    GL-ACCT-ATTRB  (PINDX)
  5057                                    GL-COMM-ATTRB  (PINDX)
  5058                                    VOID-SW-ATTRB  (PINDX)
  5059                                    GL-STATE-ATTRB (PINDX)
  5060                                    GL-CANC-ATTRB  (PINDX)
  5061                                    SDTE-ATTRB     (PINDX)
  5062
  5063     END-IF
  5064
  5065*    GO TO 6010-READ-NEXT.
  5066     GO TO 6200-EXIT.
  5067
  5068 6100-END-OF-FILE.
  5069     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5070
  5071     IF PINDX  IS LESS THAN  12
  5072         SET PINDX  UP  BY  1
  5073         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5074         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 102
* EL633.cbl
  5075         SET PINDX  UP  BY  1
  5076         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5077         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5078         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5079     ELSE
  5080         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5081         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5082         SET PINDX  UP  BY  1
  5083         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5084         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5085
  5086 6200-EXIT.
  5087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 103
* EL633.cbl
  5089 7000-PYAJ-FILE-NOTOPEN.
  5090     MOVE -1                     TO  MAINTL.
  5091     MOVE ER-2232                TO  EMI-ERROR.
  5092
  5093     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5094
  5095     GO TO 8200-SEND-DATAONLY.
  5096
  5097 7100-COMP-FILE-NOTOPEN.
  5098     MOVE -1                     TO  MAINTL.
  5099     MOVE ER-2233                TO  EMI-ERROR.
  5100
  5101     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5102
  5103     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 104
* EL633.cbl
  5105*
  5106*7100-COFA-FILE-NOTOPEN.
  5107*    MOVE -1                     TO PFENTERL.
  5108*    MOVE ER-2959                TO EMI-ERROR.
  5109*    PERFORM 9900-ERROR-FORMAT THRU
  5110*            9900-EXIT.
  5111*    GO TO 8200-SEND-DATAONLY.
  5112*
  5113 8100-SEND-INITIAL-MAP.
  5114     MOVE WS-CURRENT-DT          TO  DATEO.
  5115     MOVE EIBTIME                TO  TIME-IN.
  5116     MOVE TIME-OUT               TO  TIMEO.
  5117     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5118     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5119     MOVE -1                     TO  MAINTL.
  5120     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5121     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5122
  5123     IF EIBTRNID = TRANS-ID
  5124       OR EL640-TRANS-ID
  5125       OR EL642-TRANS-ID
  5126       OR EL652-TRANS-ID
  5127       OR EL6331-TRANS-ID
  5128         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5129             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5130             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5131             MOVE PI-SAV-GROUPING  TO  GROUPO
  5132             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5133             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5134             MOVE AL-UANON         TO  MAINTA
  5135                                       CARRIERA
  5136                                       GROUPA
  5137                                       FINRESPA
  5138                                       ACCTA
  5139         ELSE
  5140             NEXT SENTENCE.
  5141
  5142
  5143* EXEC CICS SEND
  5144*        MAP     (MAP-NAME)
  5145*        MAPSET  (MAPSET-NAME)
  5146*        FROM    (EL633AO)
  5147*        ERASE
  5148*        CURSOR
  5149*        END-EXEC.
  5150     MOVE LENGTH OF
  5151      EL633AO
  5152       TO DFHEIV12
  5153     MOVE -1
  5154       TO DFHEIV11
  5155*    MOVE '8$     CT  E    H L F ,   #00004687' TO DFHEIV0
  5156     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5157     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5158     MOVE X'2020233030303034363837' TO DFHEIV0(25:11)
  5159     CALL 'kxdfhei1' USING DFHEIV0,
  5160           MAP-NAME,
  5161           EL633AO,
  5162           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 105
* EL633.cbl
  5163           MAPSET-NAME,
  5164           DFHEIV99,
  5165           DFHEIV99,
  5166           DFHEIV99,
  5167           DFHEIV11,
  5168           DFHEIV99,
  5169           DFHEIV99,
  5170           DFHEIV99
  5171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5172
  5173
  5174     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 106
* EL633.cbl
  5176 8200-SEND-DATAONLY.
  5177     MOVE WS-CURRENT-DT          TO  DATEO.
  5178     MOVE EIBTIME                TO  TIME-IN.
  5179     MOVE TIME-OUT               TO  TIMEO.
  5180     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5181     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5182     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5183     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5184
  5185
  5186* EXEC CICS SEND
  5187*        MAP     (MAP-NAME)
  5188*        MAPSET  (MAPSET-NAME)
  5189*        FROM    (EL633AO)
  5190*        DATAONLY
  5191*        CURSOR
  5192*    END-EXEC.
  5193     MOVE LENGTH OF
  5194      EL633AO
  5195       TO DFHEIV12
  5196     MOVE -1
  5197       TO DFHEIV11
  5198*    MOVE '8$D    CT       H L F ,   #00004706' TO DFHEIV0
  5199     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5200     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5201     MOVE X'2020233030303034373036' TO DFHEIV0(25:11)
  5202     CALL 'kxdfhei1' USING DFHEIV0,
  5203           MAP-NAME,
  5204           EL633AO,
  5205           DFHEIV12,
  5206           MAPSET-NAME,
  5207           DFHEIV99,
  5208           DFHEIV99,
  5209           DFHEIV99,
  5210           DFHEIV11,
  5211           DFHEIV99,
  5212           DFHEIV99,
  5213           DFHEIV99
  5214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5215
  5216
  5217     GO TO 9100-RETURN-TRAN.
  5218
  5219 8300-SEND-TEXT.
  5220
  5221* EXEC CICS SEND TEXT
  5222*        FROM    (LOGOFF-TEXT)
  5223*        LENGTH  (LOGOFF-LENGTH)
  5224*        ERASE
  5225*        FREEKB
  5226*    END-EXEC.
  5227*    MOVE '8&      T  E F  H   F -   #00004717' TO DFHEIV0
  5228     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5229     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5230     MOVE X'2020233030303034373137' TO DFHEIV0(25:11)
  5231     CALL 'kxdfhei1' USING DFHEIV0,
  5232           LOGOFF-TEXT,
  5233           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 107
* EL633.cbl
  5234           DFHEIV99,
  5235           DFHEIV99,
  5236           DFHEIV99,
  5237           DFHEIV99,
  5238           DFHEIV99,
  5239           DFHEIV99,
  5240           DFHEIV99,
  5241           DFHEIV99,
  5242           DFHEIV99,
  5243           DFHEIV99
  5244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5245
  5246
  5247
  5248* EXEC CICS RETURN
  5249*    END-EXEC.
  5250*    MOVE '.(                    ''   #00004724' TO DFHEIV0
  5251     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5252     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5253     MOVE X'2020233030303034373234' TO DFHEIV0(25:11)
  5254     CALL 'kxdfhei1' USING DFHEIV0,
  5255           DFHEIV99,
  5256           DFHEIV99,
  5257           DFHEIV99,
  5258           DFHEIV99,
  5259           DFHEIV99,
  5260           DFHEIV99
  5261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5262
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 108
* EL633.cbl
  5264 8400-LOG-JOURNAL-RECORD.
  5265*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5266*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5267
  5268*    EXEC CICS JOURNAL
  5269*        JFILEID  (PI-JOURNAL-FILE-ID)
  5270*        JTYPEID  ('EL')
  5271*        FROM     (JOURNAL-RECORD)
  5272*        LENGTH   (223)
  5273*        END-EXEC.
  5274
  5275 8500-DATE-CONVERT.
  5276
  5277* EXEC CICS LINK
  5278*        PROGRAM   (LINK-CLDATCV)
  5279*        COMMAREA  (DATE-CONVERSION-DATA)
  5280*        LENGTH    (DC-COMM-LENGTH)
  5281*    END-EXEC.
  5282*    MOVE '."C                   (   #00004739' TO DFHEIV0
  5283     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5285     MOVE X'2020233030303034373339' TO DFHEIV0(25:11)
  5286     CALL 'kxdfhei1' USING DFHEIV0,
  5287           LINK-CLDATCV,
  5288           DATE-CONVERSION-DATA,
  5289           DC-COMM-LENGTH,
  5290           DFHEIV99,
  5291           DFHEIV99,
  5292           DFHEIV99,
  5293           DFHEIV99
  5294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5295
  5296
  5297 8500-EXIT.
  5298     EXIT.
  5299
  5300 8600-DEEDIT.
  5301
  5302* EXEC CICS BIF DEEDIT
  5303*        FIELD   (DEEDIT-FIELD)
  5304*        LENGTH  (11)
  5305*    END-EXEC.
  5306     MOVE 11
  5307       TO DFHEIV11
  5308*    MOVE '@"L                   #   #00004749' TO DFHEIV0
  5309     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5311     MOVE X'2020233030303034373439' TO DFHEIV0(25:11)
  5312     CALL 'kxdfhei1' USING DFHEIV0,
  5313           DEEDIT-FIELD,
  5314           DFHEIV11
  5315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5316
  5317
  5318 8600-EXIT.
  5319     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 109
* EL633.cbl
  5321 8800-UNAUTHORIZED-ACCESS.
  5322     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5323
  5324     GO TO 8300-SEND-TEXT.
  5325
  5326 8810-PF23.
  5327     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5328     MOVE XCTL-005               TO  PGM-NAME.
  5329
  5330     GO TO 9300-XCTL.
  5331
  5332 9100-RETURN-TRAN.
  5333     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5334     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5335
  5336
  5337* EXEC CICS RETURN
  5338*        TRANSID   (TRANS-ID)
  5339*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5340*        LENGTH    (PI-COMM-LENGTH)
  5341*    END-EXEC.
  5342*    MOVE '.(CT                  ''   #00004772' TO DFHEIV0
  5343     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5344     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5345     MOVE X'2020233030303034373732' TO DFHEIV0(25:11)
  5346     CALL 'kxdfhei1' USING DFHEIV0,
  5347           TRANS-ID,
  5348           PROGRAM-INTERFACE-BLOCK,
  5349           PI-COMM-LENGTH,
  5350           DFHEIV99,
  5351           DFHEIV99,
  5352           DFHEIV99
  5353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5354
  5355
  5356 9200-RETURN-MAIN-MENU.
  5357     MOVE XCTL-626               TO  PGM-NAME.
  5358
  5359     GO TO 9300-XCTL.
  5360
  5361 9300-XCTL.
  5362
  5363* EXEC CICS XCTL
  5364*        PROGRAM   (PGM-NAME)
  5365*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5366*        LENGTH    (PI-COMM-LENGTH)
  5367*    END-EXEC.
  5368*    MOVE '.$C                   %   #00004784' TO DFHEIV0
  5369     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5370     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5371     MOVE X'2020233030303034373834' TO DFHEIV0(25:11)
  5372     CALL 'kxdfhei1' USING DFHEIV0,
  5373           PGM-NAME,
  5374           PROGRAM-INTERFACE-BLOCK,
  5375           PI-COMM-LENGTH,
  5376           DFHEIV99
  5377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5378
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 110
* EL633.cbl
  5379
  5380 9400-CLEAR.
  5381     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5382
  5383     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5384     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5385                                     PI-SAV-COMP-CONTROL.
  5386
  5387     GO TO 9300-XCTL.
  5388
  5389 9500-PF12.
  5390     MOVE XCTL-010               TO  PGM-NAME.
  5391
  5392     GO TO 9300-XCTL.
  5393
  5394 9600-PGMID-ERROR.
  5395
  5396* EXEC CICS HANDLE CONDITION
  5397*        PGMIDERR  (8300-SEND-TEXT)
  5398*    END-EXEC.
  5399*    MOVE '"$L                   ! + #00004805' TO DFHEIV0
  5400     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5402     MOVE X'2B20233030303034383035' TO DFHEIV0(25:11)
  5403     CALL 'kxdfhei1' USING DFHEIV0
  5404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5405
  5406
  5407     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5408     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5409     MOVE XCTL-005               TO  PGM-NAME.
  5410     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5411     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5412
  5413     GO TO 9300-XCTL.
  5414
  5415 9900-ERROR-FORMAT.
  5416     IF NOT EMI-ERRORS-COMPLETE
  5417         MOVE LINK-001           TO  PGM-NAME
  5418
  5419* EXEC CICS LINK
  5420*            PROGRAM   (PGM-NAME)
  5421*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5422*            LENGTH    (EMI-COMM-LENGTH)
  5423*        END-EXEC.
  5424*    MOVE '."C                   (   #00004820' TO DFHEIV0
  5425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5427     MOVE X'2020233030303034383230' TO DFHEIV0(25:11)
  5428     CALL 'kxdfhei1' USING DFHEIV0,
  5429           PGM-NAME,
  5430           ERROR-MESSAGE-INTERFACE-BLOCK,
  5431           EMI-COMM-LENGTH,
  5432           DFHEIV99,
  5433           DFHEIV99,
  5434           DFHEIV99,
  5435           DFHEIV99
  5436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 111
* EL633.cbl
  5437
  5438
  5439 9900-EXIT.
  5440     EXIT.
  5441
  5442 9990-ABEND.
  5443     MOVE LINK-004               TO  PGM-NAME.
  5444     MOVE DFHEIBLK               TO  EMI-LINE1.
  5445
  5446
  5447* EXEC CICS LINK
  5448*        PROGRAM   (PGM-NAME)
  5449*        COMMAREA  (EMI-LINE1)
  5450*        LENGTH    (72)
  5451*    END-EXEC.
  5452     MOVE 72
  5453       TO DFHEIV11
  5454*    MOVE '."C                   (   #00004833' TO DFHEIV0
  5455     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5457     MOVE X'2020233030303034383333' TO DFHEIV0(25:11)
  5458     CALL 'kxdfhei1' USING DFHEIV0,
  5459           PGM-NAME,
  5460           EMI-LINE1,
  5461           DFHEIV11,
  5462           DFHEIV99,
  5463           DFHEIV99,
  5464           DFHEIV99,
  5465           DFHEIV99
  5466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5467
  5468
  5469     MOVE -1                     TO  PFENTERL.
  5470
  5471     GO TO 8200-SEND-DATAONLY.
  5472
  5473 9995-SECURITY-VIOLATION.
  5474*                            COPY ELCSCTP.
  5475******************************************************************
  5476*                                                                *
  5477*                            ELCSCTP                             *
  5478*                            VMOD=2.001                          *
  5479*                                                                *
  5480*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5481******************************************************************
  5482
  5483
  5484     MOVE EIBDATE          TO SM-JUL-DATE.
  5485     MOVE EIBTRMID         TO SM-TERMID.
  5486     MOVE THIS-PGM         TO SM-PGM.
  5487     MOVE EIBTIME          TO TIME-IN.
  5488     MOVE TIME-OUT         TO SM-TIME.
  5489     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5490
  5491
  5492* EXEC CICS LINK
  5493*         PROGRAM  ('EL003')
  5494*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 112
* EL633.cbl
  5495*         LENGTH   (80)
  5496*    END-EXEC.
  5497     MOVE 'EL003' TO DFHEIV1
  5498     MOVE 80
  5499       TO DFHEIV11
  5500*    MOVE '."C                   (   #00004861' TO DFHEIV0
  5501     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5503     MOVE X'2020233030303034383631' TO DFHEIV0(25:11)
  5504     CALL 'kxdfhei1' USING DFHEIV0,
  5505           DFHEIV1,
  5506           SECURITY-MESSAGE,
  5507           DFHEIV11,
  5508           DFHEIV99,
  5509           DFHEIV99,
  5510           DFHEIV99,
  5511           DFHEIV99
  5512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5513
  5514
  5515******************************************************************
  5516
  5517
  5518 9995-EXIT.
  5519     EXIT.
  5520
  5521
  5522 9999-DFHBACK SECTION.
  5523     MOVE '9%                    "   ' TO DFHEIV0
  5524     MOVE 'EL633' TO DFHEIV1
  5525     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5526     GOBACK.
  5527 9999-DFHEXIT.
  5528     IF DFHEIGDJ EQUAL 0001
  5529         NEXT SENTENCE
  5530     ELSE IF DFHEIGDJ EQUAL 2
  5531         GO TO 9600-PGMID-ERROR,
  5532               9990-ABEND
  5533         DEPENDING ON DFHEIGDI
  5534     ELSE IF DFHEIGDJ EQUAL 3
  5535         GO TO 0410-NO-COMP-MSTR,
  5536               7100-COMP-FILE-NOTOPEN
  5537         DEPENDING ON DFHEIGDI
  5538     ELSE IF DFHEIGDJ EQUAL 4
  5539         GO TO 0890-EXIT
  5540         DEPENDING ON DFHEIGDI
  5541     ELSE IF DFHEIGDJ EQUAL 5
  5542         GO TO 2110-ADD-RECORD
  5543         DEPENDING ON DFHEIGDI
  5544     ELSE IF DFHEIGDJ EQUAL 6
  5545         GO TO 2120-DELETE-CONT
  5546         DEPENDING ON DFHEIGDI
  5547     ELSE IF DFHEIGDJ EQUAL 7
  5548         GO TO 2190-DUP-RECORD
  5549         DEPENDING ON DFHEIGDI
  5550     ELSE IF DFHEIGDJ EQUAL 8
  5551         GO TO 5010-NOT-OPEN,
  5552               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 14-Aug-14 14:07 Page 113
* EL633.cbl
  5553               5020-NO-RECORDS
  5554         DEPENDING ON DFHEIGDI
  5555     ELSE IF DFHEIGDJ EQUAL 9
  5556         GO TO 5110-END-OF-FILE,
  5557               5110-END-OF-FILE
  5558         DEPENDING ON DFHEIGDI
  5559     ELSE IF DFHEIGDJ EQUAL 10
  5560         GO TO 6100-END-OF-FILE,
  5561               6100-END-OF-FILE
  5562         DEPENDING ON DFHEIGDI
  5563     ELSE IF DFHEIGDJ EQUAL 11
  5564         GO TO 8300-SEND-TEXT
  5565         DEPENDING ON DFHEIGDI.
  5566     MOVE '9%                    "   ' TO DFHEIV0
  5567     MOVE 'EL633' TO DFHEIV1
  5568     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5569     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5640     Code:       16742
