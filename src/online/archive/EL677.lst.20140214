* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL677.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 15:42:06.
     7*                            VMOD=2.024
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL677.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    26 ENVIRONMENT DIVISION.
    27
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL677.cbl
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    34 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.024 *********'.
    35
    36*                            COPY ELCSCTM.
    37******************************************************************
    38*                                                                *
    39*                                                                *
    40*                            ELCSCTM                             *
    41*                            VMOD=2.001                          *
    42*                                                                *
    43*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    44*                                                                *
    45******************************************************************
    46 01  SECURITY-MESSAGE.
    47     12  FILLER                          PIC X(30)
    48            VALUE '** LOGIC SECURITY VIOLATION -'.
    49     12  SM-READ                         PIC X(6).
    50     12  FILLER                          PIC X(5)
    51            VALUE ' PGM='.
    52     12  SM-PGM                          PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' OPR='.
    55     12  SM-PROCESSOR-ID                 PIC X(4).
    56     12  FILLER                          PIC X(6)
    57            VALUE ' TERM='.
    58     12  SM-TERMID                       PIC X(4).
    59     12  FILLER                          PIC XX   VALUE SPACE.
    60     12  SM-JUL-DATE                     PIC 9(5).
    61     12  FILLER                          PIC X    VALUE SPACE.
    62     12  SM-TIME                         PIC 99.99.
    63
    64*                            COPY ELCSCRTY.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCRTY                            *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    72*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    73*        SAVED IN PI-SECURITY-ADDRESS.                           *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-CONTROL.
    77     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    78     12  FILLER                       PIC XX    VALUE 'SC'.
    79     12  SC-CREDIT-CODES.
    80         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    81             20  SC-CREDIT-DISPLAY    PIC X.
    82             20  SC-CREDIT-UPDATE     PIC X.
    83     12  SC-CLAIMS-CODES.
    84         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    85             20  SC-CLAIMS-DISPLAY    PIC X.
    86             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL677.cbl
    87
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL677.cbl
    89
    90 01  WS-DATE-AREA.
    91     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    92     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
    93     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    94
    95 01  STANDARD-AREAS.
    96     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
    97     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
    98     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
    99     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   100     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   101     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   102     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   103     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   104     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   105     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   106     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   107     12  TIME-OUT-R  REDEFINES TIME-IN.
   108         16  FILLER                  PIC X.
   109         16  TIME-OUT                PIC 99V99.
   110         16  FILLER                  PIC XX.
   111     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   112     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   113     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   114     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   115     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   116     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   117     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   118     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   119     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   120     12  ELLETR-FILE-ID              PIC X(8)    VALUE 'ELLETR'.
   121     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   122     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   123     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   124     12  ERCHKQ-FILE-ID              PIC X(8)    VALUE 'ERCHKQ'.
   125     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   126     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   127     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   128     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   129     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   130     12  ELBENE-FILE-ID              PIC X(8)    VALUE 'ELBENE'.
   131     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   132     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   133     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   134     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   135     12  QID.
   136         16  QID-TERM                PIC X(4)    VALUE SPACES.
   137         16  FILLER                  PIC X(4)    VALUE '677A'.
   138
   139 01  WORK-AREAS.
   140     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   141     12  WS-AM-WK REDEFINES WS-AM-WORK.
   142         16  WS-AM-NUM               PIC S9(7)V99.
   143         16  WS-AM-SIGN              PIC X.
   144     12  WS-CHECK-WORK.
   145         16  FILLER                  PIC X        VALUE SPACE.
   146         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL677.cbl
   147     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   148     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   149     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   150     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   151     12  WS-DED                      PIC S9(5)V99 VALUE +0.
   152     12  WS-ADDL                     PIC S9(5)V99 VALUE +0.
   153     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   154     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   155     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   156     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   157     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   158     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   159     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   160         WS-DT-DEEDIT-FIELD.
   161         16  FILLER                  PIC X(4).
   162         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   163     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   164     12  WS-DEEDIT-FIELD-V0          REDEFINES
   165         WS-DEEDIT-FIELD-A           PIC S9(15).
   166
   167     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   168     12  W-LETTER-IND                PIC X       VALUE SPACES.
   169         88 W-LETTER-NOT-FOUND                   VALUE 'Y'.
   170     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   171         88 WS-CERT-FOUND                        VALUE 'Y'.
   172         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   173     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   174         88 WS-PNDB-FOUND                        VALUE 'Y'.
   175         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   176     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   177         88  WS-PROCESS-CERT                     VALUE 'Y'.
   178     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   179         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   180     12  WS-PY-ENTRY-COMMENT.
   181         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   182         16  FILLER                  PIC X(13)   VALUE
   183            ' MISC. CHECK '.
   184         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   185         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   186     12  WS-PY-REF-COMMENT.
   187         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   188         16  FILLER                  PIC X(13)   VALUE
   189            ' REFUND PYMT '.
   190         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   191         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   192     12  WS-PY-END-COMMENT.
   193         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   194         16  FILLER                  PIC X(13)   VALUE
   195            ' ENDORSEMENT '.
   196         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   197         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   198     12  WS-PY-DED-COMMENT.
   199         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   200         16  FILLER                  PIC X(13)   VALUE
   201            ' STAT DEDUCT '.
   202         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   203         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   204     12  WS-PY-ADDL-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL677.cbl
   205         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   206         16  FILLER                  PIC X(13)   VALUE
   207            ' ADDL CHARGE '.
   208         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   209         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   210     12  WS-PY-REVERSAL-COMMENT.
   211         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   212         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   213            ' VOID REFUND '.
   214         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   215         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   216     12  WS-TMS-ENTRY-COMMENT.
   217         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   218         16  FILLER                  PIC XX      VALUE SPACES.
   219         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   220     12  WS-ZIP-CODE.
   221         16  WS-ZIP-PRIME.
   222             20  WS-ZIP-PRI-1ST      PIC X.
   223                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   224             20  FILLER              PIC X(4).
   225         16  WS-ZIP-PLUS4            PIC X(4).
   226     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   227         16  WS-CAN-POST1-1          PIC XXX.
   228         16  WS-CAN-POST1-2.
   229             20  WS-CAN-POST-4TH     PIC X.
   230             20  FILLER              PIC XX.
   231         16  FILLER                  PIC XXX.
   232     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   233         16  WS-CAN-POST2-1          PIC XXX.
   234         16  FILLER                  PIC X.
   235         16  WS-CAN-POST2-2          PIC XXX.
   236         16  FILLER                  PIC XX.
   237
   238*                                    COPY ELCNWA.
   239*****************************************************************
   240*                                                               *
   241*                                                               *
   242*                            ELCNWA.                            *
   243*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   244*                            VMOD=2.003                         *
   245*                                                               *
   246*            M O V E   N A M E   W O R K   A R E A.             *
   247*                                                               *
   248*****************************************************************.
   249
   250 01  WS-NAME-WORK-AREA.
   251     05  WS-INSURED-LAST-NAME        PIC X(15).
   252     05  WS-INSURED-1ST-NAME         PIC X(12).
   253     05  WS-INSURED-MID-INIT         PIC X.
   254
   255     05  WS-NAME-WORK.
   256         10  WS-NW                   PIC X
   257             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   258
   259     05  WS-NAME-WORK2.
   260         10  WS-NW2                  PIC X
   261             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   262                                        NWA-INDEX0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL677.cbl
   263
   264     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   265                                     COMP-3.
   266
   267
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL677.cbl
   269 01  ACCESS-KEYS.
   270     12  ELLETR-KEY.
   271         16 ELLETR-COMPANY-CD        PIC  X(01)  VALUE SPACES.
   272         16 ELLETR-FORM-NO           PIC  X(12)  VALUE SPACES.
   273         16 ELLETR-LINE-SEQ          PIC S9(04)  VALUE +0    COMP.
   274
   275     12  ELCNTL-KEY.
   276         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   277         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   278         16 ELCNTL-ACCESS.
   279             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   280             20  FILLER              PIC X       VALUE SPACES.
   281             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   282         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   283
   284     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   285
   286     12  ERACCT-KEY.
   287         16  ERACCT-CO               PIC X       VALUE SPACES.
   288         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   289         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   290         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   291         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   292         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   293         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   294
   295     12  SAVE-ERACCT-KEY.
   296         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   297         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   298         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   299         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   300         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   301         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   302         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   303
   304     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   305
   306     12  ERCOMP-KEY.
   307         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   308         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   309         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   310         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   311         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   312         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   313
   314     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   315
   316     12  ELCERT-KEY.
   317         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   318         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   319         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   320         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   321         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   322         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   323         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   324         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   325
   326     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL677.cbl
   327
   328     12  ERPNDB-PRIMARY-KEY.
   329         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   330         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   331         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   332         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   333
   334     12  ERPNDB-ALT-KEY.
   335         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   336         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   337         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   338         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   339         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   340         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   341         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   342         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   343         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   344         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   345
   346     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   347
   348     12  ERPNDM-PRIMARY-KEY.
   349         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   350         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   351         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   352         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   353
   354     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   355
   356     12  ERCHEK-KEY.
   357         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   358         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   359         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   360         16  CHEK-STATE              PIC XX      VALUE SPACES.
   361         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   362         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   363         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   364         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   365         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   366
   367     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   368
   369     12  ERCHKQ-KEY.
   370         16 CHKQ-COMPANY-CD          PIC X       VALUE SPACE.
   371         16 CHKQ-CONTROL-NUMBER      PIC S9(8)   VALUE ZEROS COMP.
   372         16 CHKQ-SEQUENCE-NUMBER     PIC S9(4)   VALUE ZEROS COMP.
   373
   374     12  ERCHKQ-RECORD-LENGTH        PIC S9(4)   VALUE +100  COMP.
   375
   376     12  ELBENE-KEY.
   377         16  ELBENE-COMPANY-CD       PIC X       VALUE SPACE.
   378         16  ELBENE-BENEFICIARY      PIC X(6)    VALUE SPACE.
   379
   380     12  ELBENE-RECORD-LENGTH        PIC S9(4)   VALUE +170  COMP.
   381
   382     12  ERPYAJ-KEY.
   383         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   384         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL677.cbl
   385         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   386         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   387         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   388         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   389         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   390
   391     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   392
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL677.cbl
   394 01  ERROR-NUMBERS.
   395     12  ER-0000                     PIC X(4)    VALUE '0000'.
   396     12  ER-0004                     PIC X(4)    VALUE '0004'.
   397     12  ER-0008                     PIC X(4)    VALUE '0008'.
   398     12  ER-0013                     PIC X(4)    VALUE '0013'.
   399     12  ER-0022                     PIC X(4)    VALUE '0022'.
   400     12  ER-0023                     PIC X(4)    VALUE '0023'.
   401     12  ER-0026                     PIC X(4)    VALUE '0026'.
   402     12  ER-0029                     PIC X(4)    VALUE '0029'.
   403     12  ER-0070                     PIC X(4)    VALUE '0070'.
   404     12  ER-0194                     PIC X(4)    VALUE '0194'.
   405     12  ER-0195                     PIC X(4)    VALUE '0195'.
   406     12  ER-0196                     PIC X(4)    VALUE '0196'.
   407     12  ER-0197                     PIC X(4)    VALUE '0197'.
   408     12  ER-0203                     PIC X(4)    VALUE '0203'.
   409     12  ER-0215                     PIC X(4)    VALUE '0215'.
   410     12  ER-0216                     PIC X(4)    VALUE '0216'.
   411     12  ER-0433                     PIC X(4)    VALUE '0433'.
   412     12  ER-0565                     PIC X(4)    VALUE '0565'.
   413     12  ER-1159                     PIC X(4)    VALUE '1159'.
   414     12  ER-1162                     PIC X(4)    VALUE '1162'.
   415     12  ER-2056                     PIC X(4)    VALUE '2056'.
   416     12  ER-2208                     PIC X(4)    VALUE '2208'.
   417     12  ER-2209                     PIC X(4)    VALUE '2209'.
   418     12  ER-2210                     PIC X(4)    VALUE '2210'.
   419     12  ER-2230                     PIC X(4)    VALUE '2230'.
   420     12  ER-2237                     PIC X(4)    VALUE '2237'.
   421     12  ER-2238                     PIC X(4)    VALUE '2238'.
   422     12  ER-2294                     PIC X(4)    VALUE '2294'.
   423     12  ER-2394                     PIC X(4)    VALUE '2394'.
   424     12  ER-2438                     PIC X(4)    VALUE '2438'.
   425     12  ER-2439                     PIC X(4)    VALUE '2439'.
   426     12  ER-2583                     PIC X(4)    VALUE '2583'.
   427     12  ER-2600                     PIC X(4)    VALUE '2600'.
   428     12  ER-2726                     PIC X(4)    VALUE '2726'.
   429     12  ER-2905                     PIC X(4)    VALUE '2905'.
   430     12  ER-2906                     PIC X(4)    VALUE '2906'.
   431     12  ER-2907                     PIC X(4)    VALUE '2907'.
   432     12  ER-2908                     PIC X(4)    VALUE '2908'.
   433     12  ER-2909                     PIC X(4)    VALUE '2909'.
   434     12  ER-3044                     PIC X(4)    VALUE '3044'.
   435     12  ER-3046                     PIC X(4)    VALUE '3046'.
   436     12  ER-3047                     PIC X(4)    VALUE '3047'.
   437     12  ER-3445                     PIC X(4)    VALUE '3445'.
   438     12  ER-7389                     PIC X(4)    VALUE '7389'.
   439
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL677.cbl
   441*                                    COPY ELCLOGOF.
   442******************************************************************
   443*                                                                *
   444*                                                                *
   445*                            ELCLOGOF.                           *
   446*                            VMOD=2.001                          *
   447*                                                                *
   448*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   449*                                                                *
   450******************************************************************
   451 01  CLASIC-LOGOFF.
   452     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   453     12  LOGOFF-TEXT.
   454         16  FILLER          PIC X(5)    VALUE SPACES.
   455         16  LOGOFF-MSG.
   456             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   457             20  FILLER      PIC X       VALUE SPACES.
   458             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   459         16  FILLER          PIC X(80)
   460           VALUE '* YOU ARE NOW LOGGED OFF'.
   461         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   462         16  FILLER          PIC X       VALUE QUOTE.
   463         16  LOGOFF-SYS-MSG  PIC X(17)
   464           VALUE 'S CLAS-IC SYSTEM '.
   465     12  TEXT-MESSAGES.
   466         16  UNACCESS-MSG    PIC X(29)
   467             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   468         16  PGMIDERR-MSG    PIC X(17)
   469             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL677.cbl
   471*                                    COPY ELCDATE.
   472******************************************************************
   473*                                                                *
   474*                                                                *
   475*                            ELCDATE.                            *
   476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   477*                            VMOD=2.003
   478*                                                                *
   479*                                                                *
   480*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   481*                 LENGTH = 200                                   *
   482******************************************************************
   483
   484 01  DATE-CONVERSION-DATA.
   485     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   486     12  DC-OPTION-CODE                PIC X.
   487         88  BIN-TO-GREG                VALUE ' '.
   488         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   489         88  EDIT-GREG-TO-BIN           VALUE '2'.
   490         88  YMD-GREG-TO-BIN            VALUE '3'.
   491         88  MDY-GREG-TO-BIN            VALUE '4'.
   492         88  JULIAN-TO-BIN              VALUE '5'.
   493         88  BIN-PLUS-ELAPSED           VALUE '6'.
   494         88  FIND-CENTURY               VALUE '7'.
   495         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   496         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   497         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   498         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   499         88  JULIAN-TO-BIN-3            VALUE 'C'.
   500         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   501         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   502         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   503         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   504         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   505         88  CHECK-LEAP-YEAR            VALUE 'H'.
   506         88  BIN-3-TO-GREG              VALUE 'I'.
   507         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   508         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   509         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   510         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   511         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   512         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   513         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   514         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   515         88  THREE-CHARACTER-BIN
   516                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   517         88  GREGORIAN-TO-BIN
   518                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   519         88  BIN-TO-GREGORIAN
   520                  VALUES ' ' '1' 'I' '8' 'G'.
   521         88  JULIAN-TO-BINARY
   522                  VALUES '5' 'C' 'E' 'F'.
   523     12  DC-ERROR-CODE                 PIC X.
   524         88  NO-CONVERSION-ERROR        VALUE ' '.
   525         88  DATE-CONVERSION-ERROR
   526                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   527         88  DATE-IS-ZERO               VALUE '1'.
   528         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL677.cbl
   529         88  DATE-IS-INVALID            VALUE '3'.
   530         88  DATE1-GREATER-DATE2        VALUE '4'.
   531         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   532         88  DATE-INVALID-OPTION        VALUE '9'.
   533         88  INVALID-CENTURY            VALUE 'A'.
   534         88  ONLY-CENTURY               VALUE 'B'.
   535         88  ONLY-LEAP-YEAR             VALUE 'C'.
   536         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   537     12  DC-END-OF-MONTH               PIC X.
   538         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   539     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   540         88  USE-NORMAL-PROCESS         VALUE ' '.
   541         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   542         88  ADJUST-UP-100-YRS          VALUE '2'.
   543     12  FILLER                        PIC X.
   544     12  DC-CONVERSION-DATES.
   545         16  DC-BIN-DATE-1             PIC XX.
   546         16  DC-BIN-DATE-2             PIC XX.
   547         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   548         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   549                       DC-GREG-DATE-1-EDIT.
   550             20  DC-EDIT1-MONTH        PIC 99.
   551             20  SLASH1-1              PIC X.
   552             20  DC-EDIT1-DAY          PIC 99.
   553             20  SLASH1-2              PIC X.
   554             20  DC-EDIT1-YEAR         PIC 99.
   555         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   556         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   557                     DC-GREG-DATE-2-EDIT.
   558             20  DC-EDIT2-MONTH        PIC 99.
   559             20  SLASH2-1              PIC X.
   560             20  DC-EDIT2-DAY          PIC 99.
   561             20  SLASH2-2              PIC X.
   562             20  DC-EDIT2-YEAR         PIC 99.
   563         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   564         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   565                     DC-GREG-DATE-1-YMD.
   566             20  DC-YMD-YEAR           PIC 99.
   567             20  DC-YMD-MONTH          PIC 99.
   568             20  DC-YMD-DAY            PIC 99.
   569         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   570         16  DC-GREG-DATE-1-MDY-R REDEFINES
   571                      DC-GREG-DATE-1-MDY.
   572             20  DC-MDY-MONTH          PIC 99.
   573             20  DC-MDY-DAY            PIC 99.
   574             20  DC-MDY-YEAR           PIC 99.
   575         16  DC-GREG-DATE-1-ALPHA.
   576             20  DC-ALPHA-MONTH        PIC X(10).
   577             20  DC-ALPHA-DAY          PIC 99.
   578             20  FILLER                PIC XX.
   579             20  DC-ALPHA-CENTURY.
   580                 24 DC-ALPHA-CEN-N     PIC 99.
   581             20  DC-ALPHA-YEAR         PIC 99.
   582         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   583         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   584         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   585         16  DC-JULIAN-DATE            PIC 9(05).
   586         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL677.cbl
   587                                       PIC 9(05).
   588         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   589             20  DC-JULIAN-YEAR        PIC 99.
   590             20  DC-JULIAN-DAYS        PIC 999.
   591         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   592         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   593         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   594     12  DATE-CONVERSION-VARIBLES.
   595         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   596         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   597             20  FILLER                PIC 9(3).
   598             20  HOLD-CEN-1-CCYY.
   599                 24  HOLD-CEN-1-CC     PIC 99.
   600                 24  HOLD-CEN-1-YY     PIC 99.
   601             20  HOLD-CEN-1-MO         PIC 99.
   602             20  HOLD-CEN-1-DA         PIC 99.
   603         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   604             20  HOLD-CEN-1-R-MO       PIC 99.
   605             20  HOLD-CEN-1-R-DA       PIC 99.
   606             20  HOLD-CEN-1-R-CCYY.
   607                 24  HOLD-CEN-1-R-CC   PIC 99.
   608                 24  HOLD-CEN-1-R-YY   PIC 99.
   609             20  FILLER                PIC 9(3).
   610         16  HOLD-CENTURY-1-X.
   611             20  FILLER                PIC X(3)  VALUE SPACES.
   612             20  HOLD-CEN-1-X-CCYY.
   613                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   614                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   615             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   616             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   617         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   618             20  HOLD-CEN-1-R-X-MO     PIC XX.
   619             20  HOLD-CEN-1-R-X-DA     PIC XX.
   620             20  HOLD-CEN-1-R-X-CCYY.
   621                 24  HOLD-CEN-1-R-X-CC PIC XX.
   622                 24  HOLD-CEN-1-R-X-YY PIC XX.
   623             20  FILLER                PIC XXX.
   624         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   625         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   626         16  DC-JULIAN-DATE-1          PIC 9(07).
   627         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   628             20  DC-JULIAN-1-CCYY.
   629                 24  DC-JULIAN-1-CC    PIC 99.
   630                 24  DC-JULIAN-1-YR    PIC 99.
   631             20  DC-JULIAN-DA-1        PIC 999.
   632         16  DC-JULIAN-DATE-2          PIC 9(07).
   633         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   634             20  DC-JULIAN-2-CCYY.
   635                 24  DC-JULIAN-2-CC    PIC 99.
   636                 24  DC-JULIAN-2-YR    PIC 99.
   637             20  DC-JULIAN-DA-2        PIC 999.
   638         16  DC-GREG-DATE-A-EDIT.
   639             20  DC-EDITA-MONTH        PIC 99.
   640             20  SLASHA-1              PIC X VALUE '/'.
   641             20  DC-EDITA-DAY          PIC 99.
   642             20  SLASHA-2              PIC X VALUE '/'.
   643             20  DC-EDITA-CCYY.
   644                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL677.cbl
   645                 24  DC-EDITA-YEAR     PIC 99.
   646         16  DC-GREG-DATE-B-EDIT.
   647             20  DC-EDITB-MONTH        PIC 99.
   648             20  SLASHB-1              PIC X VALUE '/'.
   649             20  DC-EDITB-DAY          PIC 99.
   650             20  SLASHB-2              PIC X VALUE '/'.
   651             20  DC-EDITB-CCYY.
   652                 24  DC-EDITB-CENT     PIC 99.
   653                 24  DC-EDITB-YEAR     PIC 99.
   654         16  DC-GREG-DATE-CYMD         PIC 9(08).
   655         16  DC-GREG-DATE-CYMD-R REDEFINES
   656                              DC-GREG-DATE-CYMD.
   657             20  DC-CYMD-CEN           PIC 99.
   658             20  DC-CYMD-YEAR          PIC 99.
   659             20  DC-CYMD-MONTH         PIC 99.
   660             20  DC-CYMD-DAY           PIC 99.
   661         16  DC-GREG-DATE-MDCY         PIC 9(08).
   662         16  DC-GREG-DATE-MDCY-R REDEFINES
   663                              DC-GREG-DATE-MDCY.
   664             20  DC-MDCY-MONTH         PIC 99.
   665             20  DC-MDCY-DAY           PIC 99.
   666             20  DC-MDCY-CEN           PIC 99.
   667             20  DC-MDCY-YEAR          PIC 99.
   668    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   669        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   670    12  DC-EL310-DATE                  PIC X(21).
   671    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL677.cbl
   673*                                    COPY ELCATTR.
   674******************************************************************
   675*                                                                *
   676*                            ELCATTR.                            *
   677*                            VMOD=2.001                          *
   678*                                                                *
   679*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   680*                                                                *
   681*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   682*                                                                *
   683*                   POS 1   P=PROTECTED                          *
   684*                           U=UNPROTECTED                        *
   685*                           S=ASKIP                              *
   686*                   POS 2   A=ALPHA/NUMERIC                      *
   687*                           N=NUMERIC                            *
   688*                   POS 3   N=NORMAL                             *
   689*                           B=BRIGHT                             *
   690*                           D=DARK                               *
   691*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   692*                           OF=MODIFIED DATA TAG OFF             *
   693*                                                                *
   694*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   695******************************************************************
   696 01  ATTRIBUTE-LIST.
   697     12  AL-PABOF            PIC X       VALUE 'Y'.
   698     12  AL-PABON            PIC X       VALUE 'Z'.
   699     12  AL-PADOF            PIC X       VALUE '%'.
   700     12  AL-PADON            PIC X       VALUE '_'.
   701     12  AL-PANOF            PIC X       VALUE '-'.
   702     12  AL-PANON            PIC X       VALUE '/'.
   703     12  AL-SABOF            PIC X       VALUE '8'.
   704     12  AL-SABON            PIC X       VALUE '9'.
   705     12  AL-SADOF            PIC X       VALUE '@'.
   706     12  AL-SADON            PIC X       VALUE QUOTE.
   707     12  AL-SANOF            PIC X       VALUE '0'.
   708     12  AL-SANON            PIC X       VALUE '1'.
   709     12  AL-UABOF            PIC X       VALUE 'H'.
   710     12  AL-UABON            PIC X       VALUE 'I'.
   711     12  AL-UADOF            PIC X       VALUE '<'.
   712     12  AL-UADON            PIC X       VALUE '('.
   713     12  AL-UANOF            PIC X       VALUE ' '.
   714     12  AL-UANON            PIC X       VALUE 'A'.
   715     12  AL-UNBOF            PIC X       VALUE 'Q'.
   716     12  AL-UNBON            PIC X       VALUE 'R'.
   717     12  AL-UNDOF            PIC X       VALUE '*'.
   718     12  AL-UNDON            PIC X       VALUE ')'.
   719     12  AL-UNNOF            PIC X       VALUE '&'.
   720     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL677.cbl
   722*                                    COPY ELCEMIB.
   723******************************************************************
   724*                                                                *
   725*                                                                *
   726*                            ELCEMIB.                            *
   727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   728*                            VMOD=2.005                          *
   729*                                                                *
   730*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   731*                                                                *
   732******************************************************************
   733 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   734     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   735     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   736     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   737     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   738     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   739     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   740     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   741     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   742     12  EMI-SWITCH1             PIC X        VALUE '1'.
   743         88  EMI-NO-ERRORS                    VALUE '1'.
   744         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   745         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   746     12  EMI-SWITCH2             PIC X        VALUE '1'.
   747         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   748     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   749         88  EMI-AREA1-EMPTY                  VALUE '1'.
   750         88  EMI-AREA1-FULL                   VALUE '2'.
   751     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   752         88  EMI-AREA2-EMPTY                  VALUE '1'.
   753         88  EMI-AREA2-FULL                   VALUE '2'.
   754     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   755         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   756         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   757         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   758         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   759         88  EMI-BYPASS-FATALS                VALUE 'X'.
   760     12  EMI-ERROR-LINES.
   761         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   762         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   763         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   764         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   765             20  EMI-ERR-CODES OCCURS 10 TIMES.
   766                 24  EMI-ERR-NUM         PIC X(4).
   767                 24  EMI-FILLER          PIC X.
   768                 24  EMI-SEV             PIC X.
   769                 24  FILLER              PIC X.
   770             20  FILLER                  PIC X(02).
   771     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   772         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   773             20  EMI-ERROR-NUMBER    PIC X(4).
   774             20  EMI-FILL            PIC X.
   775             20  EMI-SEVERITY        PIC X.
   776             20  FILLER              PIC X.
   777             20  EMI-ERROR-TEXT.
   778                 24  EMI-TEXT-VARIABLE   PIC X(10).
   779                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL677.cbl
   780     12  EMI-SEVERITY-SAVE           PIC X.
   781         88  EMI-NOTE                    VALUE 'N'.
   782         88  EMI-WARNING                 VALUE 'W'.
   783         88  EMI-FORCABLE                VALUE 'F'.
   784         88  EMI-FATAL                   VALUE 'X'.
   785     12  EMI-MESSAGE-FLAG            PIC X.
   786         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   787         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   788     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   789     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   790         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   791         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   792         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   793     12  FILLER                      PIC X(137)  VALUE SPACES.
   794     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   795     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   796     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   797     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL677.cbl
   799*                                    COPY ELCINTF.
   800******************************************************************
   801*                                                                *
   802*                                                                *
   803*                            ELCINTF.                            *
   804*                            VMOD=2.017                          *
   805*                                                                *
   806*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   807*                                                                *
   808*       LENGTH = 1024                                            *
   809*                                                                *
   810******************************************************************
   811 01  PROGRAM-INTERFACE-BLOCK.
   812     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   813     12  PI-CALLING-PROGRAM              PIC X(8).
   814     12  PI-SAVED-PROGRAM-1              PIC X(8).
   815     12  PI-SAVED-PROGRAM-2              PIC X(8).
   816     12  PI-SAVED-PROGRAM-3              PIC X(8).
   817     12  PI-SAVED-PROGRAM-4              PIC X(8).
   818     12  PI-SAVED-PROGRAM-5              PIC X(8).
   819     12  PI-SAVED-PROGRAM-6              PIC X(8).
   820     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   821     12  PI-COMPANY-ID                   PIC XXX.
   822     12  PI-COMPANY-CD                   PIC X.
   823
   824     12  PI-COMPANY-PASSWORD             PIC X(8).
   825
   826     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   827
   828     12  PI-CONTROL-IN-PROGRESS.
   829         16  PI-CARRIER                  PIC X.
   830         16  PI-GROUPING                 PIC X(6).
   831         16  PI-STATE                    PIC XX.
   832         16  PI-ACCOUNT                  PIC X(10).
   833         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   834                                         PIC X(10).
   835         16  PI-CLAIM-CERT-GRP.
   836             20  PI-CLAIM-NO             PIC X(7).
   837             20  PI-CERT-NO.
   838                 25  PI-CERT-PRIME       PIC X(10).
   839                 25  PI-CERT-SFX         PIC X.
   840             20  PI-CERT-EFF-DT          PIC XX.
   841         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   842             20  PI-PLAN-CODE            PIC X(2).
   843             20  PI-REVISION-NUMBER      PIC X(3).
   844             20  PI-PLAN-EFF-DT          PIC X(2).
   845             20  PI-PLAN-EXP-DT          PIC X(2).
   846             20  FILLER                  PIC X(11).
   847         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   848             20  PI-OE-REFERENCE-1.
   849                 25  PI-OE-REF-1-PRIME   PIC X(18).
   850                 25  PI-OE-REF-1-SUFF    PIC XX.
   851
   852     12  PI-SESSION-IN-PROGRESS          PIC X.
   853         88  CLAIM-SESSION                   VALUE '1'.
   854         88  CREDIT-SESSION                  VALUE '2'.
   855         88  WARRANTY-SESSION                VALUE '3'.
   856         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL677.cbl
   857         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   858
   859
   860*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   861
   862     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   863     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   864
   865     12  PI-CREDIT-USER                  PIC X.
   866         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   867         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   868
   869     12  PI-CLAIM-USER                   PIC X.
   870         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   871         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   872
   873     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   874         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   875         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   876         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   877         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   878         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   879
   880     12  PI-PROCESSOR-ID                 PIC X(4).
   881
   882     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   883
   884     12  PI-MEMBER-CAPTION               PIC X(10).
   885
   886     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   887         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   888
   889     12  PI-LIFE-OVERRIDE-L1             PIC X.
   890     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   891     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   892     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   893
   894     12  PI-AH-OVERRIDE-L1               PIC X.
   895     12  PI-AH-OVERRIDE-L2               PIC XX.
   896     12  PI-AH-OVERRIDE-L6               PIC X(6).
   897     12  PI-AH-OVERRIDE-L12              PIC X(12).
   898
   899     12  PI-NEW-SYSTEM                   PIC X(2).
   900
   901     12  PI-PRIMARY-CERT-NO              PIC X(11).
   902     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   903         88  PI-USES-PAID-TO                 VALUE '1'.
   904     12  PI-CRDTCRD-SYSTEM.
   905         16  PI-CRDTCRD-USER             PIC X.
   906             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   907             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   908         16  PI-CC-MONTH-END-DT          PIC XX.
   909     12  PI-PROCESSOR-PRINTER            PIC X(4).
   910
   911     12  PI-OE-REFERENCE-2.
   912         16  PI-OE-REF-2-PRIME           PIC X(10).
   913         16  PI-OE-REF-2-SUFF            PIC X.
   914
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL677.cbl
   915     12  PI-REM-TRM-CALC-OPTION          PIC X.
   916
   917     12  PI-LANGUAGE-TYPE                PIC X.
   918             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   919             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   920             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   921
   922     12  PI-POLICY-LINKAGE-IND           PIC X.
   923         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   924         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   925                                                   LOW-VALUES.
   926
   927     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   928     12  PI-CLAIM-PW-SESSION             PIC X(1).
   929         88  PI-CLAIM-CREDIT                 VALUE '1'.
   930         88  PI-CLAIM-CONVEN                 VALUE '2'.
   931     12  FILLER                          PIC X(4).
   932
   933     12  PI-SYSTEM-LEVEL                 PIC X(145).
   934
   935     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   936         PI-SYSTEM-LEVEL.
   937
   938         16  PI-ENTRY-CODES.
   939             20  PI-ENTRY-CD-1           PIC X.
   940             20  PI-ENTRY-CD-2           PIC X.
   941
   942         16  PI-RETURN-CODES.
   943             20  PI-RETURN-CD-1          PIC X.
   944             20  PI-RETURN-CD-2          PIC X.
   945
   946         16  PI-UPDATE-STATUS-SAVE.
   947             20  PI-UPDATE-BY            PIC X(4).
   948             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   949
   950         16  PI-LOWER-CASE-LETTERS       PIC X.
   951             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   952
   953*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   954*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   955*            88  CARRIER-CLM-CNTL            VALUE '2'.
   956
   957         16  PI-CERT-ACCESS-CONTROL      PIC X.
   958             88  ST-ACCNT-CNTL               VALUE ' '.
   959             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   960             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   961             88  ACCNT-CNTL                  VALUE '3'.
   962             88  CARR-ACCNT-CNTL             VALUE '4'.
   963
   964         16  PI-PROCESSOR-CAP-LIST.
   965             20  PI-SYSTEM-CONTROLS.
   966                24 PI-SYSTEM-DISPLAY     PIC X.
   967                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   968                24 PI-SYSTEM-MODIFY      PIC X.
   969                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   970             20  FILLER                  PIC XX.
   971             20  PI-DISPLAY-CAP          PIC X.
   972                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL677.cbl
   973             20  PI-MODIFY-CAP           PIC X.
   974                 88  MODIFY-CAP              VALUE 'Y'.
   975             20  PI-MSG-AT-LOGON-CAP     PIC X.
   976                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   977             20  PI-FORCE-CAP            PIC X.
   978                 88  FORCE-CAP               VALUE 'Y'.
   979
   980         16  PI-PROGRAM-CONTROLS.
   981             20  PI-PGM-PRINT-OPT        PIC X.
   982             20  PI-PGM-FORMAT-OPT       PIC X.
   983             20  PI-PGM-PROCESS-OPT      PIC X.
   984             20  PI-PGM-TOTALS-OPT       PIC X.
   985
   986         16  PI-HELP-INTERFACE.
   987             20  PI-LAST-ERROR-NO        PIC X(4).
   988             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   989
   990         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   991             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   992
   993         16  PI-CR-CONTROL-IN-PROGRESS.
   994             20  PI-CR-CARRIER           PIC X.
   995             20  PI-CR-GROUPING          PIC X(6).
   996             20  PI-CR-STATE             PIC XX.
   997             20  PI-CR-ACCOUNT           PIC X(10).
   998             20  PI-CR-FIN-RESP          PIC X(10).
   999             20  PI-CR-TYPE              PIC X.
  1000
  1001         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1002
  1003         16  PI-CR-MONTH-END-DT          PIC XX.
  1004
  1005         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1006             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1007             88  PI-ZERO-CARRIER             VALUE '1'.
  1008             88  PI-ZERO-GROUPING            VALUE '2'.
  1009             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1010
  1011         16  PI-CARRIER-SECURITY         PIC X.
  1012             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1013
  1014         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1015             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1016             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1017
  1018         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1019             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1020                                         INDEXED BY PI-ACCESS-NDX
  1021                                         PIC X.
  1022
  1023         16  PI-GA-BILLING-CONTROL       PIC X.
  1024             88  PI-GA-BILLING               VALUE '1'.
  1025
  1026         16  PI-MAIL-PROCESSING          PIC X.
  1027             88  PI-MAIL-YES                 VALUE 'Y'.
  1028
  1029         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1030
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL677.cbl
  1031         16  PI-AR-SYSTEM.
  1032             20  PI-AR-PROCESSING-CNTL   PIC X.
  1033                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1034             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1035             20  PI-AR-MONTH-END-DT      PIC XX.
  1036
  1037         16  PI-MP-SYSTEM.
  1038             20  PI-MORTGAGE-USER            PIC X.
  1039                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1040                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1041             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1042                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1043                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1044                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1045                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1046                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1047             20  PI-MP-MONTH-END-DT          PIC XX.
  1048             20  PI-MP-REFERENCE-NO.
  1049                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1050                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1051
  1052         16  PI-LABEL-CONTROL            PIC X(01).
  1053             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1054             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1055
  1056         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1057             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1058
  1059         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1060             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1061             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1062
  1063         16  FILLER                      PIC X(14).
  1064
  1065     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1066******************************************************************
  1067     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1068         16  PI-EOF-SW               PIC X.
  1069             88  PI-FILE-EOF                     VALUE 'Y'.
  1070         16  PI-PREV-MAINT           PIC X.
  1071         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1072         16  PI-ERCHEK-KEY.
  1073             20  PI-CHEK-COMP-CD     PIC X.
  1074             20  PI-CHEK-CARRIER     PIC X.
  1075             20  PI-CHEK-GROUPING    PIC X(6).
  1076             20  PI-CHEK-STATE       PIC XX.
  1077             20  PI-CHEK-ACCOUNT     PIC X(10).
  1078             20  PI-CHEK-EFF-DT      PIC XX.
  1079             20  PI-CHEK-CERT-NO     PIC X(10).
  1080             20  PI-CHEK-SUF-NO      PIC X.
  1081             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1082         16  PI-ACCOUNT-ADDRESS.
  1083             20  PI-AM-NAME          PIC X(30).
  1084             20  PI-AM-ADDRS         PIC X(30).
  1085             20  PI-AM-CITY          PIC X(30).
  1086             20  PI-AM-ZIP-CODE.
  1087                 24  PI-AM-ZIP-PRIME PIC X(5).
  1088                 24  PI-AM-ZIP-PLUS4 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL677.cbl
  1089         16  PI-PROCESS-CERT-SW          PIC X.
  1090             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1091         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1092             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1093         16  PI-PAYTO1                   PIC X(30).
  1094         16  PI-REFERENCE                PIC X(12).
  1095         16  PI-CANC-DT                  PIC XX.
  1096         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1097         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1098         16  PI-INSURED-NAME             PIC X(28).
  1099         16  PI-PFKEY                    PIC XXX.
  1100             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1101             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1102         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1103         16  PI-TYPE                     PIC X.
  1104         16  FILLER                      PIC X(405).
  1105
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL677.cbl
  1107*                                    COPY ELCAID.
  1108******************************************************************
  1109*                                                                *
  1110*                            ELCAID.                             *
  1111*                            VMOD=2.001                          *
  1112*                                                                *
  1113*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1114*                                                                *
  1115*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1116*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1117******************************************************************
  1118
  1119 01  DFHAID.
  1120   02  DFHNULL   PIC  X  VALUE  ' '.
  1121   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1122   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1123   02  DFHPEN    PIC  X  VALUE  '='.
  1124   02  DFHOPID   PIC  X  VALUE  'W'.
  1125   02  DFHPA1    PIC  X  VALUE  '%'.
  1126   02  DFHPA2    PIC  X  VALUE  '>'.
  1127   02  DFHPA3    PIC  X  VALUE  ','.
  1128   02  DFHPF1    PIC  X  VALUE  '1'.
  1129   02  DFHPF2    PIC  X  VALUE  '2'.
  1130   02  DFHPF3    PIC  X  VALUE  '3'.
  1131   02  DFHPF4    PIC  X  VALUE  '4'.
  1132   02  DFHPF5    PIC  X  VALUE  '5'.
  1133   02  DFHPF6    PIC  X  VALUE  '6'.
  1134   02  DFHPF7    PIC  X  VALUE  '7'.
  1135   02  DFHPF8    PIC  X  VALUE  '8'.
  1136   02  DFHPF9    PIC  X  VALUE  '9'.
  1137   02  DFHPF10   PIC  X  VALUE  ':'.
  1138   02  DFHPF11   PIC  X  VALUE  '#'.
  1139   02  DFHPF12   PIC  X  VALUE  '@'.
  1140   02  DFHPF13   PIC  X  VALUE  'A'.
  1141   02  DFHPF14   PIC  X  VALUE  'B'.
  1142   02  DFHPF15   PIC  X  VALUE  'C'.
  1143   02  DFHPF16   PIC  X  VALUE  'D'.
  1144   02  DFHPF17   PIC  X  VALUE  'E'.
  1145   02  DFHPF18   PIC  X  VALUE  'F'.
  1146   02  DFHPF19   PIC  X  VALUE  'G'.
  1147   02  DFHPF20   PIC  X  VALUE  'H'.
  1148   02  DFHPF21   PIC  X  VALUE  'I'.
  1149*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1150   02  DFHPF22   PIC  X  VALUE  '['.
  1151   02  DFHPF23   PIC  X  VALUE  '.'.
  1152   02  DFHPF24   PIC  X  VALUE  '<'.
  1153   02  DFHMSRE   PIC  X  VALUE  'X'.
  1154   02  DFHSTRF   PIC  X  VALUE  'h'.
  1155   02  DFHTRIG   PIC  X  VALUE  '"'.
  1156 01  FILLER    REDEFINES DFHAID.
  1157     12  FILLER                      PIC X(8).
  1158     12  PF-VALUES                   PIC X       OCCURS 24.
  1159     12  FILLER                      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL677.cbl
  1161*                                    COPY EL677S.
  1162 01  EL677AI.
  1163     05  FILLER            PIC  X(0012).
  1164*    -------------------------------
  1165     05  DATEL PIC S9(0004) COMP.
  1166     05  DATEF PIC  X(0001).
  1167     05  FILLER REDEFINES DATEF.
  1168         10  DATEA PIC  X(0001).
  1169     05  DATEI PIC  X(0008).
  1170*    -------------------------------
  1171     05  TIMEL PIC S9(0004) COMP.
  1172     05  TIMEF PIC  X(0001).
  1173     05  FILLER REDEFINES TIMEF.
  1174         10  TIMEA PIC  X(0001).
  1175     05  TIMEI PIC  X(0005).
  1176*    -------------------------------
  1177     05  MAINTL PIC S9(0004) COMP.
  1178     05  MAINTF PIC  X(0001).
  1179     05  FILLER REDEFINES MAINTF.
  1180         10  MAINTA PIC  X(0001).
  1181     05  MAINTI PIC  X(0001).
  1182*    -------------------------------
  1183     05  CARRIERL PIC S9(0004) COMP.
  1184     05  CARRIERF PIC  X(0001).
  1185     05  FILLER REDEFINES CARRIERF.
  1186         10  CARRIERA PIC  X(0001).
  1187     05  CARRIERI PIC  X(0001).
  1188*    -------------------------------
  1189     05  GROUPL PIC S9(0004) COMP.
  1190     05  GROUPF PIC  X(0001).
  1191     05  FILLER REDEFINES GROUPF.
  1192         10  GROUPA PIC  X(0001).
  1193     05  GROUPI PIC  X(0006).
  1194*    -------------------------------
  1195     05  STATEL PIC S9(0004) COMP.
  1196     05  STATEF PIC  X(0001).
  1197     05  FILLER REDEFINES STATEF.
  1198         10  STATEA PIC  X(0001).
  1199     05  STATEI PIC  X(0002).
  1200*    -------------------------------
  1201     05  ACCTL PIC S9(0004) COMP.
  1202     05  ACCTF PIC  X(0001).
  1203     05  FILLER REDEFINES ACCTF.
  1204         10  ACCTA PIC  X(0001).
  1205     05  ACCTI PIC  X(0010).
  1206*    -------------------------------
  1207     05  EFFDTL PIC S9(0004) COMP.
  1208     05  EFFDTF PIC  X(0001).
  1209     05  FILLER REDEFINES EFFDTF.
  1210         10  EFFDTA PIC  X(0001).
  1211     05  EFFDTI PIC  X(0008).
  1212*    -------------------------------
  1213     05  CERTNOL PIC S9(0004) COMP.
  1214     05  CERTNOF PIC  X(0001).
  1215     05  FILLER REDEFINES CERTNOF.
  1216         10  CERTNOA PIC  X(0001).
  1217     05  CERTNOI PIC  X(0010).
  1218*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL677.cbl
  1219     05  SFXL PIC S9(0004) COMP.
  1220     05  SFXF PIC  X(0001).
  1221     05  FILLER REDEFINES SFXF.
  1222         10  SFXA PIC  X(0001).
  1223     05  SFXI PIC  X(0001).
  1224*    -------------------------------
  1225     05  SEQL PIC S9(0004) COMP.
  1226     05  SEQF PIC  X(0001).
  1227     05  FILLER REDEFINES SEQF.
  1228         10  SEQA PIC  X(0001).
  1229     05  SEQI PIC  99.
  1230*    -------------------------------
  1231     05  PAYTO1AL PIC S9(0004) COMP.
  1232     05  PAYTO1AF PIC  X(0001).
  1233     05  FILLER REDEFINES PAYTO1AF.
  1234         10  PAYTO1AA PIC  X(0001).
  1235     05  PAYTO1AI PIC  X(0030).
  1236*    -------------------------------
  1237     05  CREATEDL PIC S9(0004) COMP.
  1238     05  CREATEDF PIC  X(0001).
  1239     05  FILLER REDEFINES CREATEDF.
  1240         10  CREATEDA PIC  X(0001).
  1241     05  CREATEDI PIC  X(0008).
  1242*    -------------------------------
  1243     05  CBYL PIC S9(0004) COMP.
  1244     05  CBYF PIC  X(0001).
  1245     05  FILLER REDEFINES CBYF.
  1246         10  CBYA PIC  X(0001).
  1247     05  CBYI PIC  X(0004).
  1248*    -------------------------------
  1249     05  PAYTO1L PIC S9(0004) COMP.
  1250     05  PAYTO1F PIC  X(0001).
  1251     05  FILLER REDEFINES PAYTO1F.
  1252         10  PAYTO1A PIC  X(0001).
  1253     05  PAYTO1I PIC  X(0030).
  1254*    -------------------------------
  1255     05  PAYEEL PIC S9(0004) COMP.
  1256     05  PAYEEF PIC  X(0001).
  1257     05  FILLER REDEFINES PAYEEF.
  1258         10  PAYEEA PIC  X(0001).
  1259     05  PAYEEI PIC  X(0006).
  1260*    -------------------------------
  1261     05  PAYTO2L PIC S9(0004) COMP.
  1262     05  PAYTO2F PIC  X(0001).
  1263     05  FILLER REDEFINES PAYTO2F.
  1264         10  PAYTO2A PIC  X(0001).
  1265     05  PAYTO2I PIC  X(0030).
  1266*    -------------------------------
  1267     05  VOIDEDL PIC S9(0004) COMP.
  1268     05  VOIDEDF PIC  X(0001).
  1269     05  FILLER REDEFINES VOIDEDF.
  1270         10  VOIDEDA PIC  X(0001).
  1271     05  VOIDEDI PIC  X(0008).
  1272*    -------------------------------
  1273     05  VBYL PIC S9(0004) COMP.
  1274     05  VBYF PIC  X(0001).
  1275     05  FILLER REDEFINES VBYF.
  1276         10  VBYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL677.cbl
  1277     05  VBYI PIC  X(0004).
  1278*    -------------------------------
  1279     05  PAYTO3L PIC S9(0004) COMP.
  1280     05  PAYTO3F PIC  X(0001).
  1281     05  FILLER REDEFINES PAYTO3F.
  1282         10  PAYTO3A PIC  X(0001).
  1283     05  PAYTO3I PIC  X(0030).
  1284*    -------------------------------
  1285     05  PAYTO4L PIC S9(0004) COMP.
  1286     05  PAYTO4F PIC  X(0001).
  1287     05  FILLER REDEFINES PAYTO4F.
  1288         10  PAYTO4A PIC  X(0001).
  1289     05  PAYTO4I PIC  X(0030).
  1290*    -------------------------------
  1291     05  PRINTEDL PIC S9(0004) COMP.
  1292     05  PRINTEDF PIC  X(0001).
  1293     05  FILLER REDEFINES PRINTEDF.
  1294         10  PRINTEDA PIC  X(0001).
  1295     05  PRINTEDI PIC  X(0008).
  1296*    -------------------------------
  1297     05  PTOZIPL PIC S9(0004) COMP.
  1298     05  PTOZIPF PIC  X(0001).
  1299     05  FILLER REDEFINES PTOZIPF.
  1300         10  PTOZIPA PIC  X(0001).
  1301     05  PTOZIPI PIC  X(0009).
  1302*    -------------------------------
  1303     05  OFFLINEL PIC S9(0004) COMP.
  1304     05  OFFLINEF PIC  X(0001).
  1305     05  FILLER REDEFINES OFFLINEF.
  1306         10  OFFLINEA PIC  X(0001).
  1307     05  OFFLINEI PIC  X(0001).
  1308*    -------------------------------
  1309     05  AMOUNTL PIC S9(0004) COMP.
  1310     05  AMOUNTF PIC  X(0001).
  1311     05  FILLER REDEFINES AMOUNTF.
  1312         10  AMOUNTA PIC  X(0001).
  1313     05  AMOUNTI PIC  S9(9)V99.
  1314*    -------------------------------
  1315     05  CHECKL PIC S9(0004) COMP.
  1316     05  CHECKF PIC  X(0001).
  1317     05  FILLER REDEFINES CHECKF.
  1318         10  CHECKA PIC  X(0001).
  1319     05  CHECKI PIC  X(0007).
  1320*    -------------------------------
  1321     05  TYPEL PIC S9(0004) COMP.
  1322     05  TYPEF PIC  X(0001).
  1323     05  FILLER REDEFINES TYPEF.
  1324         10  TYPEA PIC  X(0001).
  1325     05  TYPEI PIC  X(0001).
  1326*    -------------------------------
  1327     05  REFDESCL PIC S9(0004) COMP.
  1328     05  REFDESCF PIC  X(0001).
  1329     05  FILLER REDEFINES REFDESCF.
  1330         10  REFDESCA PIC  X(0001).
  1331     05  REFDESCI PIC  X(0011).
  1332*    -------------------------------
  1333     05  REFL PIC S9(0004) COMP.
  1334     05  REFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL677.cbl
  1335     05  FILLER REDEFINES REFF.
  1336         10  REFA PIC  X(0001).
  1337     05  REFI PIC  X(0012).
  1338*    -------------------------------
  1339     05  REASONL PIC S9(0004) COMP.
  1340     05  REASONF PIC  X(0001).
  1341     05  FILLER REDEFINES REASONF.
  1342         10  REASONA PIC  X(0001).
  1343     05  REASONI PIC  X(0025).
  1344*    -------------------------------
  1345     05  VREASONL PIC S9(0004) COMP.
  1346     05  VREASONF PIC  X(0001).
  1347     05  FILLER REDEFINES VREASONF.
  1348         10  VREASONA PIC  X(0001).
  1349     05  VREASONI PIC  X(0024).
  1350*    -------------------------------
  1351     05  LETTER1L PIC S9(0004) COMP.
  1352     05  LETTER1F PIC  X(0001).
  1353     05  FILLER REDEFINES LETTER1F.
  1354         10  LETTER1A PIC  X(0001).
  1355     05  LETTER1I PIC  X(0004).
  1356*    -------------------------------
  1357     05  LETTER2L PIC S9(0004) COMP.
  1358     05  LETTER2F PIC  X(0001).
  1359     05  FILLER REDEFINES LETTER2F.
  1360         10  LETTER2A PIC  X(0001).
  1361     05  LETTER2I PIC  X(0004).
  1362*    -------------------------------
  1363     05  LETTER3L PIC S9(0004) COMP.
  1364     05  LETTER3F PIC  X(0001).
  1365     05  FILLER REDEFINES LETTER3F.
  1366         10  LETTER3A PIC  X(0001).
  1367     05  LETTER3I PIC  X(0004).
  1368*    -------------------------------
  1369     05  STUB1L PIC S9(0004) COMP.
  1370     05  STUB1F PIC  X(0001).
  1371     05  FILLER REDEFINES STUB1F.
  1372         10  STUB1A PIC  X(0001).
  1373     05  STUB1I PIC  X(0050).
  1374*    -------------------------------
  1375     05  DEDDESCL PIC S9(0004) COMP.
  1376     05  DEDDESCF PIC  X(0001).
  1377     05  FILLER REDEFINES DEDDESCF.
  1378         10  DEDDESCA PIC  X(0001).
  1379     05  DEDDESCI PIC  X(0011).
  1380*    -------------------------------
  1381     05  DEDAMTL PIC S9(0004) COMP.
  1382     05  DEDAMTF PIC  X(0001).
  1383     05  FILLER REDEFINES DEDAMTF.
  1384         10  DEDAMTA PIC  X(0001).
  1385     05  DEDAMTI PIC  S9(6)V99.
  1386*    -------------------------------
  1387     05  STUB2L PIC S9(0004) COMP.
  1388     05  STUB2F PIC  X(0001).
  1389     05  FILLER REDEFINES STUB2F.
  1390         10  STUB2A PIC  X(0001).
  1391     05  STUB2I PIC  X(0050).
  1392*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL677.cbl
  1393     05  ADDDESCL PIC S9(0004) COMP.
  1394     05  ADDDESCF PIC  X(0001).
  1395     05  FILLER REDEFINES ADDDESCF.
  1396         10  ADDDESCA PIC  X(0001).
  1397     05  ADDDESCI PIC  X(0011).
  1398*    -------------------------------
  1399     05  ADDLCHGL PIC S9(0004) COMP.
  1400     05  ADDLCHGF PIC  X(0001).
  1401     05  FILLER REDEFINES ADDLCHGF.
  1402         10  ADDLCHGA PIC  X(0001).
  1403     05  ADDLCHGI PIC  S9(6)V99.
  1404*    -------------------------------
  1405     05  STUB3L PIC S9(0004) COMP.
  1406     05  STUB3F PIC  X(0001).
  1407     05  FILLER REDEFINES STUB3F.
  1408         10  STUB3A PIC  X(0001).
  1409     05  STUB3I PIC  X(0050).
  1410*    -------------------------------
  1411     05  STUB4L PIC S9(0004) COMP.
  1412     05  STUB4F PIC  X(0001).
  1413     05  FILLER REDEFINES STUB4F.
  1414         10  STUB4A PIC  X(0001).
  1415     05  STUB4I PIC  X(0020).
  1416*    -------------------------------
  1417     05  ERRMSG1L PIC S9(0004) COMP.
  1418     05  ERRMSG1F PIC  X(0001).
  1419     05  FILLER REDEFINES ERRMSG1F.
  1420         10  ERRMSG1A PIC  X(0001).
  1421     05  ERRMSG1I PIC  X(0079).
  1422*    -------------------------------
  1423     05  ERRMSG2L PIC S9(0004) COMP.
  1424     05  ERRMSG2F PIC  X(0001).
  1425     05  FILLER REDEFINES ERRMSG2F.
  1426         10  ERRMSG2A PIC  X(0001).
  1427     05  ERRMSG2I PIC  X(0079).
  1428*    -------------------------------
  1429     05  PFENTERL PIC S9(0004) COMP.
  1430     05  PFENTERF PIC  X(0001).
  1431     05  FILLER REDEFINES PFENTERF.
  1432         10  PFENTERA PIC  X(0001).
  1433     05  PFENTERI PIC  9(2).
  1434 01  EL677AO REDEFINES EL677AI.
  1435     05  FILLER            PIC  X(0012).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  DATEO PIC  X(0008).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  TIMEO PIC  99.99.
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  MAINTO PIC  X(0001).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  CARRIERO PIC  X(0001).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  GROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL677.cbl
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  STATEO PIC  X(0002).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  ACCTO PIC  X(0010).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  EFFDTO PIC  99B99B99.
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  CERTNOO PIC  X(0010).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  SFXO PIC  X(0001).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  SEQO PIC  99.
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  PAYTO1AO PIC  X(0030).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  CREATEDO PIC  X(0008).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  CBYO PIC  X(0004).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  PAYTO1O PIC  X(0030).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  PAYEEO PIC  X(0006).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  PAYTO2O PIC  X(0030).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  VOIDEDO PIC  X(0008).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  VBYO PIC  X(0004).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  PAYTO3O PIC  X(0030).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  PAYTO4O PIC  X(0030).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  PRINTEDO PIC  99B99B99.
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  PTOZIPO PIC  X(0009).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  OFFLINEO PIC  X(0001).
  1508*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL677.cbl
  1509     05  FILLER            PIC  X(0003).
  1510     05  AMOUNTO PIC  Z(7).ZZ-.
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  CHECKO PIC  X(0007).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  TYPEO PIC  X(0001).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  REFDESCO PIC  X(0011).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  REFO PIC  X(0012).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  REASONO PIC  X(0025).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  VREASONO PIC  X(0024).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  LETTER1O PIC  X(0004).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  LETTER2O PIC  X(0004).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  LETTER3O PIC  X(0004).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  STUB1O PIC  X(0050).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  DEDDESCO PIC  X(0011).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  DEDAMTO PIC  Z(5).ZZ.
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  STUB2O PIC  X(0050).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  ADDDESCO PIC  X(0011).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  ADDLCHGO PIC  Z(5).ZZ.
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  STUB3O PIC  X(0050).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  STUB4O PIC  X(0020).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  ERRMSG1O PIC  X(0079).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL677.cbl
  1567     05  ERRMSG2O PIC  X(0079).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  PFENTERO PIC  99.
  1571*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL677.cbl
  1573****************************************************************
  1574*
  1575* Copyright (c) 2007 by Clerity Solutions, Inc.
  1576* All rights reserved.
  1577*
  1578****************************************************************
  1579 01  DFHEIV.
  1580   02  DFHEIV0               PIC X(35).
  1581   02  DFHEIV1               PIC X(08).
  1582   02  DFHEIV2               PIC X(08).
  1583   02  DFHEIV3               PIC X(08).
  1584   02  DFHEIV4               PIC X(06).
  1585   02  DFHEIV5               PIC X(04).
  1586   02  DFHEIV6               PIC X(04).
  1587   02  DFHEIV7               PIC X(02).
  1588   02  DFHEIV8               PIC X(02).
  1589   02  DFHEIV9               PIC X(01).
  1590   02  DFHEIV10              PIC S9(7) COMP-3.
  1591   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1592   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1593   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1594   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1595   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1596   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1597   02  DFHEIV17              PIC X(04).
  1598   02  DFHEIV18              PIC X(04).
  1599   02  DFHEIV19              PIC X(04).
  1600   02  DFHEIV20              USAGE IS POINTER.
  1601   02  DFHEIV21              USAGE IS POINTER.
  1602   02  DFHEIV22              USAGE IS POINTER.
  1603   02  DFHEIV23              USAGE IS POINTER.
  1604   02  DFHEIV24              USAGE IS POINTER.
  1605   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1606   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1607   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1608   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1609   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1610   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1611   02  FILLER                PIC X(02).
  1612   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1613   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1614   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1615   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1616   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1617 LINKAGE  SECTION.
  1618*****************************************************************
  1619*                                                               *
  1620* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1621* All rights reserved.                                          *
  1622*                                                               *
  1623*****************************************************************
  1624 01  dfheiblk.
  1625     02  eibtime          pic s9(7) comp-3.
  1626     02  eibdate          pic s9(7) comp-3.
  1627     02  eibtrnid         pic x(4).
  1628     02  eibtaskn         pic s9(7) comp-3.
  1629     02  eibtrmid         pic x(4).
  1630     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL677.cbl
  1631     02  eibcposn         pic s9(4) comp.
  1632     02  eibcalen         pic s9(4) comp.
  1633     02  eibaid           pic x(1).
  1634     02  eibfiller1       pic x(1).
  1635     02  eibfn            pic x(2).
  1636     02  eibfiller2       pic x(2).
  1637     02  eibrcode         pic x(6).
  1638     02  eibfiller3       pic x(2).
  1639     02  eibds            pic x(8).
  1640     02  eibreqid         pic x(8).
  1641     02  eibrsrce         pic x(8).
  1642     02  eibsync          pic x(1).
  1643     02  eibfree          pic x(1).
  1644     02  eibrecv          pic x(1).
  1645     02  eibsend          pic x(1).
  1646     02  eibatt           pic x(1).
  1647     02  eibeoc           pic x(1).
  1648     02  eibfmh           pic x(1).
  1649     02  eibcompl         pic x(1).
  1650     02  eibsig           pic x(1).
  1651     02  eibconf          pic x(1).
  1652     02  eiberr           pic x(1).
  1653     02  eibrldbk         pic x(1).
  1654     02  eiberrcd         pic x(4).
  1655     02  eibsynrb         pic x(1).
  1656     02  eibnodat         pic x(1).
  1657     02  eibfiller5       pic x(2).
  1658     02  eibresp          pic 9(09) comp.
  1659     02  eibresp2         pic 9(09) comp.
  1660     02  dfheigdj         pic s9(4) comp.
  1661     02  dfheigdk         pic s9(4) comp.
  1662 01  DFHCOMMAREA                     PIC X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL677.cbl
  1664
  1665*                                    COPY ELCCNTL.
  1666******************************************************************
  1667*                                                                *
  1668*                                                                *
  1669*                            ELCCNTL.                            *
  1670*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1671*                            VMOD=2.059                          *
  1672*                                                                *
  1673*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1674*                                                                *
  1675*   FILE TYPE = VSAM,KSDS                                        *
  1676*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1677*                                                                *
  1678*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1679*       ALTERNATE INDEX = NONE                                   *
  1680*                                                                *
  1681*   LOG = YES                                                    *
  1682*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1683******************************************************************
  1684*                   C H A N G E   L O G
  1685*
  1686* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1687*-----------------------------------------------------------------
  1688*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1689* EFFECTIVE    NUMBER
  1690*-----------------------------------------------------------------
  1691* 082503                   PEMA  ADD BENEFIT GROUP
  1692* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1693* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1694* 092705    2005050300006  PEMA  ADD SPP LEASES
  1695* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1696* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1697* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1698* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1699******************************************************************
  1700*
  1701 01  CONTROL-FILE.
  1702     12  CF-RECORD-ID                       PIC XX.
  1703         88  VALID-CF-ID                        VALUE 'CF'.
  1704
  1705     12  CF-CONTROL-PRIMARY.
  1706         16  CF-COMPANY-ID                  PIC XXX.
  1707         16  CF-RECORD-TYPE                 PIC X.
  1708             88  CF-COMPANY-MASTER              VALUE '1'.
  1709             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1710             88  CF-STATE-MASTER                VALUE '3'.
  1711             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1712             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1713             88  CF-CARRIER-MASTER              VALUE '6'.
  1714             88  CF-MORTALITY-MASTER            VALUE '7'.
  1715             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1716             88  CF-TERMINAL-MASTER             VALUE '9'.
  1717             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1718             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1719             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1720             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1721             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL677.cbl
  1722             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1723             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1724             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1725             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1726         16  CF-ACCESS-CD-GENL              PIC X(4).
  1727         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1728             20  CF-PROCESSOR               PIC X(4).
  1729         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1730             20  CF-STATE-CODE              PIC XX.
  1731             20  FILLER                     PIC XX.
  1732         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1733             20  FILLER                     PIC XX.
  1734             20  CF-HI-BEN-IN-REC           PIC XX.
  1735         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1736             20  FILLER                     PIC XXX.
  1737             20  CF-CARRIER-CNTL            PIC X.
  1738         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1739             20  FILLER                     PIC XX.
  1740             20  CF-HI-TYPE-IN-REC          PIC 99.
  1741         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1742             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1743                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1744             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1745             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1746         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1747             20  FILLER                     PIC X.
  1748             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1749         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1750             20  FILLER                     PIC XX.
  1751             20  CF-MORTGAGE-PLAN           PIC XX.
  1752         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1753
  1754     12  CF-LAST-MAINT-DT                   PIC XX.
  1755     12  CF-LAST-MAINT-BY                   PIC X(4).
  1756     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1757
  1758     12  CF-RECORD-BODY                     PIC X(728).
  1759
  1760
  1761****************************************************************
  1762*             COMPANY MASTER RECORD                            *
  1763****************************************************************
  1764
  1765     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1766         16  CF-COMPANY-ADDRESS.
  1767             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1768             20  CF-CL-IN-CARE-OF           PIC X(30).
  1769             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1770             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1771             20  CF-CL-CITY-STATE           PIC X(30).
  1772             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1773             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1774         16  CF-COMPANY-CD                  PIC X.
  1775         16  CF-COMPANY-PASSWORD            PIC X(8).
  1776         16  CF-SECURITY-OPTION             PIC X.
  1777             88  ALL-SECURITY                   VALUE '1'.
  1778             88  COMPANY-VERIFY                 VALUE '2'.
  1779             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL677.cbl
  1780             88  NO-SECURITY                    VALUE '4'.
  1781             88  ALL-BUT-TERM                   VALUE '5'.
  1782         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1783             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1784         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1785             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1786         16  CF-INFORCE-LOCATION            PIC X.
  1787             88  CERTS-ARE-ONLINE               VALUE '1'.
  1788             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1789             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1790         16  CF-LOWER-CASE-LETTERS          PIC X.
  1791         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1792             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1793             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1794             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1795             88  CF-ACCNT-CNTL                  VALUE '3'.
  1796             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1797
  1798         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1799         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1800
  1801         16  CF-LGX-CREDIT-USER             PIC X.
  1802             88  CO-IS-NOT-USER                 VALUE 'N'.
  1803             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1804
  1805         16 CF-CREDIT-CALC-CODES.
  1806             20  CF-CR-REM-TERM-CALC PIC X.
  1807               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1808               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1809               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1810               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1811               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1812               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1813               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1814             20  CF-CR-R78-METHOD           PIC X.
  1815               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1816               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1817
  1818         16  CF-CLAIM-CONTROL-COUNTS.
  1819             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1820                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1821
  1822             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1823                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1824
  1825             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1826                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1827
  1828             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1829                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1830
  1831         16  CF-CURRENT-MONTH-END           PIC XX.
  1832
  1833         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1834             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1835             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1836             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1837             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL677.cbl
  1838                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1839                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1840             20  CF-CO-PREM-REJECT-SW       PIC X.
  1841                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1842                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1843             20  CF-CO-REF-REJECT-SW        PIC X.
  1844                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1845                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1846
  1847         16  CF-CO-REPORTING-DT             PIC XX.
  1848         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1849         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1850           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1851           88  CF-CO-MONTH-END                  VALUE '1'.
  1852
  1853         16  CF-LGX-CLAIM-USER              PIC X.
  1854             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1855             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1856
  1857         16  CF-CREDIT-EDIT-CONTROLS.
  1858             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1859             20  CF-MIN-AGE                 PIC 99.
  1860             20  CF-DEFAULT-AGE             PIC 99.
  1861             20  CF-MIN-TERM                PIC S999      COMP-3.
  1862             20  CF-MAX-TERM                PIC S999      COMP-3.
  1863             20  CF-DEFAULT-SEX             PIC X.
  1864             20  CF-JOINT-AGE-INPUT         PIC X.
  1865                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1866             20  CF-BIRTH-DATE-INPUT        PIC X.
  1867                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1868             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1869                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1870                 88  CF-ZERO-CARRIER            VALUE '1'.
  1871                 88  CF-ZERO-GROUPING           VALUE '2'.
  1872                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1873             20  CF-EDIT-SW                 PIC X.
  1874                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1875             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1876             20  CF-CR-PR-METHOD            PIC X.
  1877               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1878               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1879             20  FILLER                     PIC X.
  1880
  1881         16  CF-CREDIT-MISC-CONTROLS.
  1882             20  CF-REIN-TABLE-SW           PIC X.
  1883                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1884             20  CF-COMP-TABLE-SW           PIC X.
  1885                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1886             20  CF-EXPERIENCE-RETENTION-AGE
  1887                                            PIC S9        COMP-3.
  1888             20  CF-CONVERSION-DT           PIC XX.
  1889             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1890             20  CF-RUN-FREQUENCY-SW        PIC X.
  1891                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1892                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1893
  1894             20  CF-CR-CHECK-NO-CONTROL.
  1895                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL677.cbl
  1896                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1897                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1898                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1899                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1900                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1901
  1902                 24  CF-CR-CHECK-COUNT       REDEFINES
  1903                     CF-CR-CHECK-COUNTER      PIC X(4).
  1904
  1905                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1906                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1907
  1908                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1909                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1910                 24  CF-MAIL-PROCESSING       PIC X.
  1911                     88  MAIL-PROCESSING          VALUE 'Y'.
  1912
  1913         16  CF-MISC-SYSTEM-CONTROL.
  1914             20  CF-SYSTEM-C                 PIC X.
  1915                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1916             20  CF-SYSTEM-D                 PIC X.
  1917                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1918             20  CF-SOC-SEC-NO-SW            PIC X.
  1919                 88  SOC-SEC-NO-USED             VALUE '1'.
  1920             20  CF-MEMBER-NO-SW             PIC X.
  1921                 88  MEMBER-NO-USED              VALUE '1'.
  1922             20  CF-TAX-ID-NUMBER            PIC X(11).
  1923             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1924             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1925                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1926                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1927                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1928                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1929             20  CF-SYSTEM-E                 PIC X.
  1930                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1931
  1932         16  CF-LGX-LIFE-USER               PIC X.
  1933             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1934             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1935
  1936         16  CF-CR-MONTH-END-DT             PIC XX.
  1937
  1938         16  CF-FILE-MAINT-DATES.
  1939             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1940                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1941             20  CF-LAST-BATCH       REDEFINES
  1942                 CF-LAST-BATCH-NO               PIC X(4).
  1943             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1944             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1945             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1946             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1947             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1948             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1949             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1950             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1951             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1952             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1953
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL677.cbl
  1954         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1955         16  FILLER                         PIC X.
  1956
  1957         16  CF-ALT-MORT-CODE               PIC X(4).
  1958         16  CF-MEMBER-CAPTION              PIC X(10).
  1959
  1960         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1961             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1962             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1963             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1964             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1965             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1966
  1967         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1968
  1969         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1970         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1971         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1972         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1973
  1974         16  CF-AH-OVERRIDE-L1              PIC X.
  1975         16  CF-AH-OVERRIDE-L2              PIC XX.
  1976         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1977         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1978
  1979         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1980         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1981
  1982         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1983         16  CF-AR-LAST-EL860-DT            PIC XX.
  1984         16  CF-MP-MONTH-END-DT             PIC XX.
  1985
  1986         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1987         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1988             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1989
  1990         16  CF-AR-MONTH-END-DT             PIC XX.
  1991
  1992         16  CF-CRDTCRD-USER                PIC X.
  1993             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1994             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1995
  1996         16  CF-CC-MONTH-END-DT             PIC XX.
  1997
  1998         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1999
  2000         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2001             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2002             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2003             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2004         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2005         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2006         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2007         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2008             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2009             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2010         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2011         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL677.cbl
  2012         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2013             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2014         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2015
  2016         16  CF-CL-ZIP-CODE.
  2017             20  CF-CL-ZIP-PRIME.
  2018                 24  CF-CL-ZIP-1ST          PIC X.
  2019                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2020                 24  FILLER                 PIC X(4).
  2021             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2022         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2023             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2024             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2025             20  FILLER                     PIC XXX.
  2026
  2027         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2028         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2029         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2030         16  CF-CO-OPTION-START-DATE        PIC XX.
  2031         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2032           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2033                                                      '3' '4'.
  2034           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2035           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2036           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2037           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2038           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2039           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2040
  2041         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2042
  2043         16  CF-PAYMENT-APPROVAL-LEVELS.
  2044             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2045             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2046             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2047             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2048             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2049             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2050
  2051         16  CF-END-USER-REPORTING-USER     PIC X.
  2052             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2053             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2054
  2055         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2056             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2057             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2058
  2059         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2060
  2061         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2062         16  FILLER                         PIC X.
  2063
  2064         16  CF-CREDIT-ARCHIVE-CNTL.
  2065             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2066             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2067             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2068
  2069         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL677.cbl
  2070
  2071         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2072             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2073             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2074
  2075         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2076             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2077             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2078
  2079         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2080
  2081         16  CF-CO-ACH-ID-CODE              PIC  X.
  2082             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2083             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2084             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2085         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2086         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2087         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2088         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2089         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2090         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2091         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2092         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2093         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2094                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2095         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2096                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2097
  2098         16  CF-CO-OVER-SHORT.
  2099             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2100             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2101
  2102*         16  FILLER                         PIC X(102).
  2103         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2104             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2105             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2106
  2107         16  CF-AH-APPROVAL-DAYS.
  2108             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2109             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2110             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2111             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2112
  2113         16  FILLER                         PIC X(82).
  2114****************************************************************
  2115*             PROCESSOR/USER RECORD                            *
  2116****************************************************************
  2117
  2118     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2119         16  CF-PROCESSOR-NAME              PIC X(30).
  2120         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2121         16  CF-PROCESSOR-TITLE             PIC X(26).
  2122         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2123                 88  MESSAGE-YES                VALUE 'Y'.
  2124                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2125
  2126*****************************************************
  2127****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL677.cbl
  2128****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2129****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2130****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2131*****************************************************
  2132
  2133         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2134             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2135             20  CF-APPLICATION-FORCE       PIC X.
  2136             20  CF-INDIVIDUAL-APP.
  2137                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2138                     28  CF-BROWSE-APP      PIC X.
  2139                     28  CF-UPDATE-APP      PIC X.
  2140
  2141         16  CF-CURRENT-TERM-ON             PIC X(4).
  2142         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2143             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2144             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2145             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2146             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2147             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2148             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2149             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2150         16  CF-PROCESSOR-CARRIER           PIC X.
  2151             88  NO-CARRIER-SECURITY            VALUE ' '.
  2152         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2153             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2154         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2155             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2156         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2157             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2158
  2159         16  CF-PROC-SYS-ACCESS-SW.
  2160             20  CF-PROC-CREDIT-CLAIMS-SW.
  2161                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2162                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2163                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2164                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2165             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2166                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2167                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2168             20  CF-PROC-LIFE-GNRLDGR-SW.
  2169                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2170                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2171                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2172                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2173             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2174                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2175                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2176         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2177             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2178             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2179         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2180
  2181         16  CF-APPROVAL-LEVEL                  PIC X.
  2182             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2183             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2184             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2185             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL677.cbl
  2186
  2187         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2188
  2189         16  CF-LANGUAGE-TYPE                   PIC X.
  2190             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2191             88  CF-LANG-IS-FR                      VALUE 'F'.
  2192         16  FILLER                             PIC  X(240).
  2193
  2194****************************************************************
  2195*             PROCESSOR/REMINDERS RECORD                       *
  2196****************************************************************
  2197
  2198     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2199         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2200             20  CF-START-REMIND-DT         PIC XX.
  2201             20  CF-END-REMIND-DT           PIC XX.
  2202             20  CF-REMINDER-TEXT           PIC X(50).
  2203         16  FILLER                         PIC X(296).
  2204
  2205
  2206****************************************************************
  2207*             STATE MASTER RECORD                              *
  2208****************************************************************
  2209
  2210     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2211         16  CF-STATE-ABBREVIATION          PIC XX.
  2212         16  CF-STATE-NAME                  PIC X(25).
  2213         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2214         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2215             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2216             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2217             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2218             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2219                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2220                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2221             20  CF-ST-PREM-REJECT-SW       PIC X.
  2222                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2223                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2224             20  CF-ST-REF-REJECT-SW        PIC X.
  2225                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2226                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2227         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2228         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2229         16  CF-ST-REFUND-RULES.
  2230             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2231             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2232             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2233         16  CF-ST-FST-PMT-EXTENSION.
  2234             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2235             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2236                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2237                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2238                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2239                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2240         16  CF-ST-STATE-CALL.
  2241             20  CF-ST-CALL-UNEARNED        PIC X.
  2242             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2243             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL677.cbl
  2244         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2245             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2246             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2247         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2248         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2249         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2250         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2251         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2252         16  FILLER                         PIC X.
  2253         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2254             20  CF-ST-BENEFIT-CD           PIC XX.
  2255             20  CF-ST-BENEFIT-KIND         PIC X.
  2256                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2257                 88  CF-ST-AH-KIND              VALUE 'A'.
  2258             20  CF-ST-REM-TERM-CALC        PIC X.
  2259                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2260                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2261                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2262                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2263                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2264                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2265                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2266                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2267
  2268             20  CF-ST-REFUND-CALC          PIC X.
  2269                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2270                 88  ST-REFD-BY-R78             VALUE '1'.
  2271                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2272                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2273                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2274                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2275                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2276                 88  ST-REFD-UTAH               VALUE '7'.
  2277                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2278                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2279                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2280
  2281             20  CF-ST-EARNING-CALC         PIC X.
  2282                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2283                 88  ST-EARN-BY-R78             VALUE '1'.
  2284                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2285                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2286                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2287                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2288                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2289                 88  ST-EARN-MEAN               VALUE '8'.
  2290                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2291
  2292             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2293                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2294                 88  ST-OVRD-BY-R78             VALUE '1'.
  2295                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2296                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2297                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2298                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2299                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2300                 88  ST-OVRD-MEAN               VALUE '8'.
  2301                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL677.cbl
  2302             20  FILLER                     PIC X.
  2303
  2304         16  CF-ST-COMMISSION-CAPS.
  2305             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2306             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2307             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2308             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2309         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2310                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2311
  2312         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2313
  2314         16  CF-ST-STATUTORY-INTEREST.
  2315             20  CF-ST-STAT-DATE-FROM       PIC X.
  2316                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2317                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2318             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2319             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2320             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2321             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2322             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2323
  2324         16  CF-ST-OVER-SHORT.
  2325             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2326             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2327
  2328         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2329
  2330         16  CF-ST-RT-CALC                  PIC X.
  2331
  2332         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2333         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2334         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2335         16  CF-ST-RF-LR-CALC               PIC X.
  2336         16  CF-ST-RF-LL-CALC               PIC X.
  2337         16  CF-ST-RF-LN-CALC               PIC X.
  2338         16  CF-ST-RF-AH-CALC               PIC X.
  2339         16  CF-ST-RF-CP-CALC               PIC X.
  2340*        16  FILLER                         PIC X(206).
  2341*CIDMOD         16  FILLER                         PIC X(192).
  2342         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2343             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2344         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2345         16  FILLER                         PIC X(187).
  2346
  2347****************************************************************
  2348*             BENEFIT MASTER RECORD                            *
  2349****************************************************************
  2350
  2351     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2352         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2353             20  CF-BENEFIT-CODE            PIC XX.
  2354             20  CF-BENEFIT-NUMERIC  REDEFINES
  2355                 CF-BENEFIT-CODE            PIC XX.
  2356             20  CF-BENEFIT-ALPHA           PIC XXX.
  2357             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2358             20  CF-BENEFIT-COMMENT         PIC X(10).
  2359
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL677.cbl
  2360             20  CF-LF-COVERAGE-TYPE        PIC X.
  2361                 88  CF-REDUCING                VALUE 'R'.
  2362                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2363
  2364             20  CF-SPECIAL-CALC-CD         PIC X.
  2365                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2366                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2367                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2368                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2369                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2370                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2371                 88  CF-FARM-PLAN               VALUE 'F'.
  2372                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2373                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2374                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2375                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2376                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2377                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2378                 88  CF-PRUDENTIAL              VALUE 'P'.
  2379                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2380                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2381                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2382                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2383                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2384                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2385
  2386             20  CF-JOINT-INDICATOR         PIC X.
  2387                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2388
  2389*            20  FILLER                     PIC X(12).
  2390             20  FILLER                     PIC X(11).
  2391             20  CF-BENEFIT-CATEGORY        PIC X.
  2392             20  CF-LOAN-TYPE               PIC X(8).
  2393
  2394             20  CF-CO-REM-TERM-CALC        PIC X.
  2395                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2396                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2397                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2398                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2399                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2400
  2401             20  CF-CO-EARNINGS-CALC        PIC X.
  2402                 88  CO-EARN-BY-R78             VALUE '1'.
  2403                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2404                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2405                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2406                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2407                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2408                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2409                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2410
  2411             20  CF-CO-REFUND-CALC          PIC X.
  2412                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2413                 88  CO-REFD-BY-R78             VALUE '1'.
  2414                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2415                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2416                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2417                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL677.cbl
  2418                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2419                 88  CO-REFD-MEAN               VALUE '8'.
  2420                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2421                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2422                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2423
  2424             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2425                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2426                 88  CO-OVRD-BY-R78             VALUE '1'.
  2427                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2428                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2429                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2430                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2431                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2432                 88  CO-OVRD-MEAN               VALUE '8'.
  2433                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2434
  2435             20  CF-CO-BEN-I-G-CD           PIC X.
  2436                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2437                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2438                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2439
  2440         16  FILLER                         PIC X(304).
  2441
  2442
  2443****************************************************************
  2444*             CARRIER MASTER RECORD                            *
  2445****************************************************************
  2446
  2447     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2448         16  CF-ADDRESS-DATA.
  2449             20  CF-MAIL-TO-NAME            PIC X(30).
  2450             20  CF-IN-CARE-OF              PIC X(30).
  2451             20  CF-ADDRESS-LINE-1          PIC X(30).
  2452             20  CF-ADDRESS-LINE-2          PIC X(30).
  2453             20  CF-CITY-STATE              PIC X(30).
  2454             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2455             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2456
  2457         16  CF-CLAIM-NO-CONTROL.
  2458             20  CF-CLAIM-NO-METHOD         PIC X.
  2459                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2460                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2461                 88  CLAIM-NO-SEQ               VALUE '3'.
  2462                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2463             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2464                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2465                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2466                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2467
  2468         16  CF-CHECK-NO-CONTROL.
  2469             20  CF-CHECK-NO-METHOD         PIC X.
  2470                 88  CHECK-NO-MANUAL            VALUE '1'.
  2471                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2472                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2473                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2474             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2475                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL677.cbl
  2476
  2477         16  CF-DOMICILE-STATE              PIC XX.
  2478
  2479         16  CF-EXPENSE-CONTROLS.
  2480             20  CF-EXPENSE-METHOD          PIC X.
  2481                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2482                 88  DOLLARS-PER-PMT            VALUE '2'.
  2483                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2484                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2485             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2486             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2487
  2488         16  CF-CORRESPONDENCE-CONTROL.
  2489             20  CF-LETTER-RESEND-OPT       PIC X.
  2490                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2491                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2492             20  FILLER                     PIC X(4).
  2493
  2494         16  CF-RESERVE-CONTROLS.
  2495             20  CF-MANUAL-SW               PIC X.
  2496                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2497             20  CF-FUTURE-SW               PIC X.
  2498                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2499             20  CF-PTC-SW                  PIC X.
  2500                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2501             20  CF-IBNR-SW                 PIC X.
  2502                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2503             20  CF-PTC-LF-SW               PIC X.
  2504                 88  CF-LF-PTC-USED             VALUE '1'.
  2505             20  CF-CDT-ACCESS-METHOD       PIC X.
  2506                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2507                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2508                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2509             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2510
  2511         16  CF-CLAIM-CALC-METHOD           PIC X.
  2512             88  360-PLUS-MONTHS                VALUE '1'.
  2513             88  365-PLUS-MONTHS                VALUE '2'.
  2514             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2515             88  360-DAILY                      VALUE '4'.
  2516             88  365-DAILY                      VALUE '5'.
  2517
  2518         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2519         16  FILLER                         PIC X(11).
  2520
  2521         16  CF-LIMIT-AMOUNTS.
  2522             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2523             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2524             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2525             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2526             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2527             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2528             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2529             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2530             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2531             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2532
  2533         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL677.cbl
  2534         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2535         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2536
  2537         16  CF-ZIP-CODE.
  2538             20  CF-ZIP-PRIME.
  2539                 24  CF-ZIP-1ST             PIC X.
  2540                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2541                 24  FILLER                 PIC X(4).
  2542             20  CF-ZIP-PLUS4               PIC X(4).
  2543         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2544             20  CF-CAN-POSTAL-1            PIC XXX.
  2545             20  CF-CAN-POSTAL-2            PIC XXX.
  2546             20  FILLER                     PIC XXX.
  2547
  2548         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2549         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2550         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2551
  2552         16  CF-RATING-SWITCH               PIC X.
  2553             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2554             88  CF-NO-RATING                   VALUE 'N'.
  2555
  2556         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2557
  2558         16  CF-CARRIER-OVER-SHORT.
  2559             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2560             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2561
  2562         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2563         16  CF-SECPAY-SWITCH               PIC X.
  2564             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2565             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2566         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2567         16  FILLER                         PIC X(448).
  2568*        16  FILLER                         PIC X(452).
  2569
  2570
  2571****************************************************************
  2572*             MORTALITY MASTER RECORD                          *
  2573****************************************************************
  2574
  2575     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2576         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2577                                INDEXED BY CF-MORT-NDX.
  2578             20  CF-MORT-TABLE              PIC X(5).
  2579             20  CF-MORT-TABLE-TYPE         PIC X.
  2580                 88  CF-MORT-JOINT              VALUE 'J'.
  2581                 88  CF-MORT-SINGLE             VALUE 'S'.
  2582                 88  CF-MORT-COMBINED           VALUE 'C'.
  2583                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2584                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2585             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2586             20  CF-MORT-AGE-METHOD         PIC XX.
  2587                 88  CF-AGE-LAST                VALUE 'AL'.
  2588                 88  CF-AGE-NEAR                VALUE 'AN'.
  2589             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2590             20  CF-MORT-ADJUSTMENT-DIRECTION
  2591                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL677.cbl
  2592                 88  CF-MINUS                   VALUE '-'.
  2593                 88  CF-PLUS                    VALUE '+'.
  2594             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2595             20  CF-MORT-JOINT-CODE         PIC X.
  2596                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2597             20  CF-MORT-PC-Q               PIC X.
  2598                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2599             20  CF-MORT-TABLE-CODE         PIC X(4).
  2600             20  CF-MORT-COMMENTS           PIC X(15).
  2601             20  FILLER                     PIC X(14).
  2602
  2603         16  FILLER                         PIC X(251).
  2604
  2605
  2606****************************************************************
  2607*             BUSSINESS TYPE MASTER RECORD                     *
  2608****************************************************************
  2609
  2610     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2611* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2612* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2613* AND RECORD 05 IS TYPES 81-99
  2614         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2615             20  CF-BUSINESS-TITLE          PIC  X(19).
  2616             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2617                                            PIC S9V9(4) COMP-3.
  2618             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2619             20  FILLER                     PIC  X.
  2620         16  FILLER                         PIC  X(248).
  2621
  2622
  2623****************************************************************
  2624*             TERMINAL MASTER RECORD                           *
  2625****************************************************************
  2626
  2627     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2628
  2629         16  CF-COMPANY-TERMINALS.
  2630             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2631                                  PIC X(4).
  2632         16  FILLER               PIC X(248).
  2633
  2634
  2635****************************************************************
  2636*             LIFE EDIT MASTER RECORD                          *
  2637****************************************************************
  2638
  2639     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2640         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2641             20  CF-LIFE-CODE-IN            PIC XX.
  2642             20  CF-LIFE-CODE-OUT           PIC XX.
  2643         16  FILLER                         PIC X(248).
  2644
  2645
  2646****************************************************************
  2647*             AH EDIT MASTER RECORD                            *
  2648****************************************************************
  2649
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL677.cbl
  2650     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2651         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2652             20  CF-AH-CODE-IN              PIC XXX.
  2653             20  CF-AH-CODE-OUT             PIC XX.
  2654         16  FILLER                         PIC X(248).
  2655
  2656
  2657****************************************************************
  2658*             CREDIBILITY TABLES                               *
  2659****************************************************************
  2660
  2661     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2662         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2663                             INDEXED BY CF-CRDB-NDX.
  2664             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2665             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2666             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2667         16  FILLER                         PIC  X(332).
  2668
  2669
  2670****************************************************************
  2671*             REPORT CUSTOMIZATION RECORD                      *
  2672****************************************************************
  2673
  2674     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2675         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2676             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2677             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2678             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2679**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2680****       A T-TRANSFER.                                   ****
  2681             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2682
  2683         16  FILLER                         PIC XX.
  2684
  2685         16  CF-CARRIER-CNTL-OPT.
  2686             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2687                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2688                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2689             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2690                                            PIC X.
  2691         16  CF-GROUP-CNTL-OPT.
  2692             20  CF-GROUP-OPT-SEQ           PIC 9.
  2693                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2694                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2695             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2696                                            PIC X(6).
  2697         16  CF-STATE-CNTL-OPT.
  2698             20  CF-STATE-OPT-SEQ           PIC 9.
  2699                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2700                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2701             20  CF-STATE-SELECT OCCURS 3 TIMES
  2702                                            PIC XX.
  2703         16  CF-ACCOUNT-CNTL-OPT.
  2704             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2705                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2706                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2707             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL677.cbl
  2708                                            PIC X(10).
  2709         16  CF-BUS-TYP-CNTL-OPT.
  2710             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2711                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2712                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2713             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2714                                            PIC XX.
  2715         16  CF-LF-TYP-CNTL-OPT.
  2716             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2717                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2718                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2719             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2720                                            PIC XX.
  2721         16  CF-AH-TYP-CNTL-OPT.
  2722             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2723                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2724                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2725             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2726                                            PIC XX.
  2727         16  CF-REPTCD1-CNTL-OPT.
  2728             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2729                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2730                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2731             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2732                                            PIC X(10).
  2733         16  CF-REPTCD2-CNTL-OPT.
  2734             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2735                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2736                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2737             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2738                                            PIC X(10).
  2739         16  CF-USER1-CNTL-OPT.
  2740             20  CF-USER1-OPT-SEQ           PIC 9.
  2741                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2742                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2743             20  CF-USER1-SELECT OCCURS 3 TIMES
  2744                                            PIC X(10).
  2745         16  CF-USER2-CNTL-OPT.
  2746             20  CF-USER2-OPT-SEQ           PIC 9.
  2747                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2748                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2749             20  CF-USER2-SELECT OCCURS 3 TIMES
  2750                                            PIC X(10).
  2751         16  CF-USER3-CNTL-OPT.
  2752             20  CF-USER3-OPT-SEQ           PIC 9.
  2753                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2754                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2755             20  CF-USER3-SELECT OCCURS 3 TIMES
  2756                                            PIC X(10).
  2757         16  CF-USER4-CNTL-OPT.
  2758             20  CF-USER4-OPT-SEQ           PIC 9.
  2759                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2760                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2761             20  CF-USER4-SELECT OCCURS 3 TIMES
  2762                                            PIC X(10).
  2763         16  CF-USER5-CNTL-OPT.
  2764             20  CF-USER5-OPT-SEQ           PIC 9.
  2765                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL677.cbl
  2766                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2767             20  CF-USER5-SELECT OCCURS 3 TIMES
  2768                                            PIC X(10).
  2769         16  CF-REINS-CNTL-OPT.
  2770             20  CF-REINS-OPT-SEQ           PIC 9.
  2771                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2772                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2773             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2774                 24  CF-REINS-PRIME         PIC XXX.
  2775                 24  CF-REINS-SUB           PIC XXX.
  2776
  2777         16  CF-AGENT-CNTL-OPT.
  2778             20  CF-AGENT-OPT-SEQ           PIC 9.
  2779                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2780                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2781             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2782                                            PIC X(10).
  2783
  2784         16  FILLER                         PIC X(43).
  2785
  2786         16  CF-LOSS-RATIO-SELECT.
  2787             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2788             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2789         16  CF-ENTRY-DATE-SELECT.
  2790             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2791             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2792         16  CF-EFFECTIVE-DATE-SELECT.
  2793             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2794             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2795
  2796         16  CF-EXCEPTION-LIST-IND          PIC X.
  2797             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2798
  2799         16  FILLER                         PIC X(318).
  2800
  2801****************************************************************
  2802*                  EXCEPTION REPORTING RECORD                  *
  2803****************************************************************
  2804
  2805     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2806         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2807             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2808
  2809         16  CF-COMBINED-LIFE-AH-OPT.
  2810             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2811             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2812             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2813             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2814
  2815         16  CF-LIFE-OPT.
  2816             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2817             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2818             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2819             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2820             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2821             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2822             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2823             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL677.cbl
  2824             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2825             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2826
  2827         16  CF-AH-OPT.
  2828             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2829             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2830             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2831             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2832             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2833             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2834             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2835             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2836             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2837             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2838
  2839         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2840             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2841             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2842             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2843
  2844         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2845
  2846         16  FILLER                         PIC X(673).
  2847
  2848
  2849****************************************************************
  2850*             MORTGAGE SYSTEM PLAN RECORD                      *
  2851****************************************************************
  2852
  2853     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2854         16  CF-PLAN-TYPE                   PIC X.
  2855             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2856             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2857             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2858         16  CF-PLAN-ABBREV                 PIC XXX.
  2859         16  CF-PLAN-DESCRIPT               PIC X(10).
  2860         16  CF-PLAN-NOTES                  PIC X(20).
  2861         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2862         16  CF-PLAN-UNDERWRITING.
  2863             20  CF-PLAN-TERM-DATA.
  2864                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2865                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2866             20  CF-PLAN-AGE-DATA.
  2867                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2868                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2869                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2870             20  CF-PLAN-BENEFIT-DATA.
  2871                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2872                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2873                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2874                                            PIC S9(7)V99  COMP-3.
  2875         16  CF-PLAN-POLICY-FORMS.
  2876             20  CF-POLICY-FORM             PIC X(12).
  2877             20  CF-MASTER-APPLICATION      PIC X(12).
  2878             20  CF-MASTER-POLICY           PIC X(12).
  2879         16  CF-PLAN-RATING.
  2880             20  CF-RATE-CODE               PIC X(5).
  2881             20  CF-SEX-RATING              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL677.cbl
  2882                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2883                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2884             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2885             20  CF-SUB-STD-TYPE            PIC X.
  2886                 88  CF-PCT-OF-PREM            VALUE '1'.
  2887                 88  CF-PCT-OF-BENE            VALUE '2'.
  2888         16  CF-PLAN-PREM-TOLERANCES.
  2889             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2890             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2891         16  CF-PLAN-PYMT-TOLERANCES.
  2892             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2893             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2894         16  CF-PLAN-MISC-DATA.
  2895             20  FILLER                     PIC X.
  2896             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2897             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2898         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2899         16  CF-PLAN-IND-GRP                PIC X.
  2900             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2901                                                     '1'.
  2902             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2903                                                     '2'.
  2904         16  CF-MIB-SEARCH-SW               PIC X.
  2905             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2906             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2907             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2908             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2909         16  CF-ALPHA-SEARCH-SW             PIC X.
  2910             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2911             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2912             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2913             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2914             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2915             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2916             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2917             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2918             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2919             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2920                                                     'A' 'B' 'C'
  2921                                                     'X' 'Y' 'Z'.
  2922         16  CF-EFF-DT-RULE-SW              PIC X.
  2923             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2924             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2925             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2926             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2927             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2928         16  FILLER                         PIC X(4).
  2929         16  CF-HEALTH-QUESTIONS            PIC X.
  2930             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2931         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2932         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2933         16  CF-PLAN-SNGL-JNT               PIC X.
  2934             88  CF-COMBINED-PLAN              VALUE 'C'.
  2935             88  CF-JNT-PLAN                   VALUE 'J'.
  2936             88  CF-SNGL-PLAN                  VALUE 'S'.
  2937         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2938         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2939         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL677.cbl
  2940         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2941         16  CF-RERATE-CNTL                 PIC  X.
  2942             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2943             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2944             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2945             88  CF-AUTO-RECALC                 VALUE '4'.
  2946         16  CF-BENEFIT-TYPE                PIC  X.
  2947             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2948             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2949         16  CF-POLICY-FEE                  PIC S999V99
  2950                                                    COMP-3.
  2951         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2952         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2953         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2954         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2955         16  FILLER                         PIC  X(32).
  2956         16  CF-TERMINATION-FORM            PIC  X(04).
  2957         16  FILLER                         PIC  X(08).
  2958         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2959                                                       COMP-3.
  2960         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2961         16  CF-ISSUE-LETTER                PIC  X(4).
  2962         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2963         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2964             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2965             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2966         16  CF-MP-REFUND-CALC              PIC X.
  2967             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2968             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2969             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2970             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2971             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2972             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2973             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2974             88  CF-MP-REFD-MEAN                VALUE '8'.
  2975         16  CF-ALT-RATE-CODE               PIC  X(5).
  2976
  2977
  2978         16  FILLER                         PIC X(498).
  2979****************************************************************
  2980*             MORTGAGE COMPANY MASTER RECORD                   *
  2981****************************************************************
  2982
  2983     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2984         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2985         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2986             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2987             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2988             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2989             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2990             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2991
  2992         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2993         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2994         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2995         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2996         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2997
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL677.cbl
  2998         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2999             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3000         16  CF-MP-RECON-USE-IND            PIC X(1).
  3001             88  CF-MP-USE-RECON             VALUE 'Y'.
  3002         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3003             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3004         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3005             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3006             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3007         16  FILLER                         PIC X(1).
  3008         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3009             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3010         16  CF-MORTG-MIB-VERSION           PIC X.
  3011             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3012             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3013             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3014         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3015             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3016                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3017             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3018                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3019             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3020                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3021             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3022                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3023             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3024                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3025             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3026                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3027         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3028         16  FILLER                         PIC X(7).
  3029         16  CF-MORTG-DESTINATION-SYMBOL.
  3030             20  CF-MORTG-MIB-COMM          PIC X(5).
  3031             20  CF-MORTG-MIB-TERM          PIC X(5).
  3032         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3033             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3034         16  FILLER                         PIC X(03).
  3035         16  CF-MP-CHECK-NO-CONTROL.
  3036             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3037                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3038                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3039                                                ' ' LOW-VALUES.
  3040                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3041                                               VALUE '3'.
  3042         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3043         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3044         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3045             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3046                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3047             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3048                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3049             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3050                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3051             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3052                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3053             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3054                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3055             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL677.cbl
  3056                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3057         16  CF-MORTG-BILLING-AREA.
  3058             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3059                                            PIC X.
  3060         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3061         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3062         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3063         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3064             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3065             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3066         16  FILLER                         PIC X.
  3067         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3068             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3069             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3070         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3071         16  FILLER                         PIC X(8).
  3072         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3073         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3074         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3075         16  CF-ACH-COMPANY-ID.
  3076             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3077                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3078                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3079                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3080             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3081         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3082             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3083         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3084             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3085             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3086         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3087         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3088         16  FILLER                         PIC X(536).
  3089
  3090****************************************************************
  3091*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3092****************************************************************
  3093
  3094     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3095         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3096             20  CF-FEMALE-HEIGHT.
  3097                 24  CF-FEMALE-FT           PIC 99.
  3098                 24  CF-FEMALE-IN           PIC 99.
  3099             20  CF-FEMALE-MIN-WT           PIC 999.
  3100             20  CF-FEMALE-MAX-WT           PIC 999.
  3101         16  FILLER                         PIC X(428).
  3102
  3103     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3104         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3105             20  CF-MALE-HEIGHT.
  3106                 24  CF-MALE-FT             PIC 99.
  3107                 24  CF-MALE-IN             PIC 99.
  3108             20  CF-MALE-MIN-WT             PIC 999.
  3109             20  CF-MALE-MAX-WT             PIC 999.
  3110         16  FILLER                         PIC X(428).
  3111******************************************************************
  3112*             AUTOMATIC ACTIVITY RECORD                          *
  3113******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL677.cbl
  3114     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3115         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3116             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3117             20  CF-SYS-LETTER-ID           PIC X(04).
  3118             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3119             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3120             20  CF-SYS-RESET-SW            PIC X(01).
  3121             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3122             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3123
  3124         16  FILLER                         PIC X(50).
  3125
  3126         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3127             20  CF-USER-ACTIVE-SW          PIC X(01).
  3128             20  CF-USER-LETTER-ID          PIC X(04).
  3129             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3130             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3131             20  CF-USER-RESET-SW           PIC X(01).
  3132             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3133             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3134             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3135
  3136         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL677.cbl
  3138*                                    COPY ERCCHEK.
  3139******************************************************************
  3140*                                                                *
  3141*                                                                *
  3142*                            ERCCHEK                             *
  3143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3144*                            VMOD=2.008                          *
  3145*                                                                *
  3146*   FILE DESCRIPTION = CHECK RECORDS                             *
  3147*                                                                *
  3148*   FILE TYPE = VSAM,KSDS                                        *
  3149*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3150*                                                                *
  3151*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3152*       ALTERNATE INDEX = NONE                                   *
  3153*                                                                *
  3154*   LOG = YES                                                    *
  3155*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3156******************************************************************
  3157 01  CHECK-RECORDS.
  3158     12  CH-RECORD-ID                      PIC XX.
  3159         88  VALID-CH-ID                      VALUE 'CH'.
  3160
  3161     12  CH-CONTROL-PRIMARY.
  3162         16  CH-COMPANY-CD                 PIC X.
  3163         16  CH-CARRIER                    PIC X.
  3164         16  CH-GROUPING                   PIC X(6).
  3165         16  CH-STATE                      PIC XX.
  3166         16  CH-ACCOUNT                    PIC X(10).
  3167         16  CH-CERT-EFF-DT                PIC XX.
  3168         16  CH-CERT-NO.
  3169             20  CH-CERT-PRIME             PIC X(10).
  3170             20  CH-CERT-SFX               PIC X.
  3171         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3172
  3173     12  CH-RECORDED-DT                    PIC XX.
  3174     12  CH-RECORDED-BY                    PIC X(4).
  3175     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3176
  3177     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3178     12  CH-CHECK-NO                       PIC X(7).
  3179     12  CH-REASON-FOR-CHECK               PIC X(25).
  3180     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3181     12  CH-OFFLINE-CHECK-IND              PIC X.
  3182         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  3183
  3184     12  CH-PAYEE-INFO.
  3185         16  CH-PAYEE-NAME-1               PIC X(30).
  3186         16  CH-PAYEE-NAME-2               PIC X(30).
  3187         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3188         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3189         16  CH-PAYEE-CITY-ST              PIC X(30).
  3190         16  CH-PAYEE-ZIP-CODE.
  3191             20  CH-PAYEE-ZIP.
  3192                 24  CH-ZIP-PRI-1ST        PIC X.
  3193                     88  CH-CANADIAN-POST-CODE
  3194                                           VALUES 'A' THRU 'Z'.
  3195                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL677.cbl
  3196             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3197         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3198             20  CH-CAN-POSTAL-1           PIC XXX.
  3199             20  CH-CAN-POSTAL-2           PIC XXX.
  3200             20  FILLER                    PIC XXX.
  3201
  3202     12  CH-CHECK-STUB-TEXT.
  3203         16  CH-STUB-LINE-1                PIC X(50).
  3204         16  CH-STUB-LINE-2                PIC X(50).
  3205         16  CH-STUB-LINE-3                PIC X(50).
  3206         16  FILLER.
  3207           18  CH-STUB-LINE-4              PIC X(20).
  3208           18  CH-LIENHOLDER-NAME          PIC X(30).
  3209
  3210     12  CH-COMPENSATION-CONTROL.
  3211         16  CH-COMP-CARRIER               PIC X.
  3212         16  CH-COMP-GROUPING              PIC X(6).
  3213         16  CH-COMP-FIN-RESP              PIC X(10).
  3214         16  CH-COMP-ACCOUNT               PIC X(10).
  3215
  3216     12  CH-CREDIT-SELECT-DT               PIC XX.
  3217     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3218     12  CH-PAYEE-CODE                     PIC X(6).
  3219
  3220     12  CH-VOID-DATA.
  3221         20  CH-VOID-DT                    PIC XX.
  3222         20  CH-VOID-BY                    PIC X(4).
  3223         20  CH-VOID-REASON                PIC X(25).
  3224
  3225     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3226             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3227     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3228
  3229     12  CH-CHECK-REFERENCE                PIC X(12).
  3230     12  CH-CHECK-ORIGIN-SW                PIC X.
  3231             88  CH-REFUND-CHECK              VALUE 'R'.
  3232             88  CH-MAINT-CHECK               VALUE 'M'.
  3233
  3234     12  CH-CANC-DT                        PIC XX.
  3235     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3236     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3237
  3238     12  CH-INSURED-NAME                   PIC X(28).
  3239
  3240     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  3241     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  3242
  3243     12  CH-LETTER-TABLE.
  3244         16  CH-LETTERS OCCURS 3 TIMES
  3245                        INDEXED BY CH-LT-NDX
  3246                                           PIC X(04).
  3247
  3248     12  FILLER                            PIC X(07).
  3249
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL677.cbl
  3251*                                    COPY ERCCHKQ.
  3252******************************************************************
  3253*                                                                *
  3254*                                                                *
  3255*                            ERCCHKQ                             *
  3256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3257*                            VMOD=2.005                          *
  3258*                                                                *
  3259*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  3260*                                                                *
  3261*   FILE TYPE = VSAM,KSDS                                        *
  3262*   RECORD SIZE = 100  RECFORM = FIXED                           *
  3263*                                                                *
  3264*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  3265*       ALTERNATE PATH  = NONE                                   *
  3266*                                                                *
  3267*   LOG = YES                                                    *
  3268*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3269******************************************************************
  3270 01  CHECK-QUE.
  3271     12  CQ-RECORD-ID                PIC XX.
  3272         88  VALID-CQ-ID                     VALUE 'CQ'.
  3273
  3274     12  CQ-CONTROL-PRIMARY.
  3275         16  CQ-COMPANY-CD           PIC X.
  3276         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  3277         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  3278
  3279     12  CQ-ENTRY-TYPE               PIC X.
  3280             88  CHECK-ON-QUE           VALUE 'Q'.
  3281             88  ALIGNMENT-CHECK        VALUE 'A'.
  3282             88  MANUAL-CHECK           VALUE 'M'.
  3283             88  SPOILED-CHECK          VALUE 'S'.
  3284             88  VOIDED-CHECK           VALUE 'V'.
  3285             88  PAYMENT-ABORTED        VALUE 'X'.
  3286
  3287     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  3288
  3289     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  3290         CQ-CREDIT-MASTER-CNTL.
  3291         16  CQ-PYAJ-CARRIER         PIC X.
  3292         16  CQ-PYAJ-GROUPING        PIC X(6).
  3293         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  3294         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  3295         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  3296         16  CQ-PYAJ-REC-TYPE        PIC X.
  3297         16  FILLER                  PIC X(18).
  3298
  3299     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  3300         CQ-CREDIT-MASTER-CNTL.
  3301         16  CQ-CHEK-CARRIER         PIC X.
  3302         16  CQ-CHEK-GROUPING        PIC X(6).
  3303         16  CQ-CHEK-STATE           PIC XX.
  3304         16  CQ-CHEK-ACCOUNT         PIC X(10).
  3305         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  3306         16  CQ-CHEK-CERT-NO.
  3307             20  CQ-CHEK-CERT-PRIME  PIC X(10).
  3308             20  CQ-CHEK-CERT-SFX    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL677.cbl
  3309         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  3310         16  CQ-CHEK-FIN-RESP        PIC X(10).
  3311         16  FILLER                  PIC X(06).
  3312
  3313     12  CQ-CHECK-NUMBER             PIC X(7).
  3314     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  3315     12  CQ-PAYMENT-TYPE             PIC X.
  3316             88  CQ-BILLING-CREDIT         VALUE '1'.
  3317             88  CQ-REFUND-PMT             VALUE '2'.
  3318             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  3319     12  CQ-VOID-INDICATOR           PIC X.
  3320             88  CHECK-IS-VOID             VALUE 'V'.
  3321     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  3322     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  3323     12  CQ-CHECK-BY-USER            PIC X(4).
  3324     12  CQ-PRE-NUMBERING-SW         PIC X.
  3325       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  3326       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  3327
  3328     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  3329     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  3330     12  CQ-ACCOUNT-AGENT            PIC X(10).
  3331     12  CQ-CHECK-VOIDED-DT          PIC XX.
  3332
  3333     12  CQ-LETTERS-IND              PIC X.
  3334         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  3335
  3336******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL677.cbl
  3338*                                    COPY ERCACCT.
  3339******************************************************************
  3340*                                                                *
  3341*                                                                *
  3342*                            ERCACCT                             *
  3343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3344*                            VMOD=2.031                          *
  3345*                                                                *
  3346*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3347*                                                                *
  3348*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3349*   VSAM ACCOUNT MASTER FILES.                                   *
  3350*                                                                *
  3351*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3352*                                                                *
  3353*   FILE TYPE = VSAM,KSDS                                        *
  3354*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3355*                                                                *
  3356*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3357*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3358*                                                                *
  3359*   LOG = NO                                                     *
  3360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3361*                                                                *
  3362*                                                                *
  3363******************************************************************
  3364*                   C H A N G E   L O G
  3365*
  3366* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3367*-----------------------------------------------------------------
  3368*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3369* EFFECTIVE    NUMBER
  3370*-----------------------------------------------------------------
  3371* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3372* 092705    2005050300006  PEMA  ADD SPP LEASES
  3373* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3374* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3375******************************************************************
  3376
  3377 01  ACCOUNT-MASTER.
  3378     12  AM-RECORD-ID                      PIC XX.
  3379         88  VALID-AM-ID                      VALUE 'AM'.
  3380
  3381     12  AM-CONTROL-PRIMARY.
  3382         16  AM-COMPANY-CD                 PIC X.
  3383         16  AM-MSTR-CNTRL.
  3384             20  AM-CONTROL-A.
  3385                 24  AM-CARRIER            PIC X.
  3386                 24  AM-GROUPING.
  3387                     28 AM-GROUPING-PREFIX PIC XXX.
  3388                     28 AM-GROUPING-PRIME  PIC XXX.
  3389                 24  AM-STATE              PIC XX.
  3390                 24  AM-ACCOUNT.
  3391                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3392                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3393             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3394                                           PIC X(19).
  3395             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL677.cbl
  3396                 24  AM-EXPIRATION-DT      PIC XX.
  3397                 24  FILLER                PIC X(4).
  3398             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3399                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3400
  3401     12  AM-CONTROL-BY-VAR-GRP.
  3402         16  AM-COMPANY-CD-A1              PIC X.
  3403         16  AM-VG-CARRIER                 PIC X.
  3404         16  AM-VG-GROUPING                PIC X(6).
  3405         16  AM-VG-STATE                   PIC XX.
  3406         16  AM-VG-ACCOUNT                 PIC X(10).
  3407         16  AM-VG-DATE.
  3408             20  AM-VG-EXPIRATION-DT       PIC XX.
  3409             20  FILLER                    PIC X(4).
  3410         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3411                                           PIC 9(11)      COMP-3.
  3412     12  AM-MAINT-INFORMATION.
  3413         16  AM-LAST-MAINT-DT              PIC XX.
  3414         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3415         16  AM-LAST-MAINT-USER            PIC X(4).
  3416         16  FILLER                        PIC XX.
  3417
  3418     12  AM-EFFECTIVE-DT                   PIC XX.
  3419     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3420
  3421     12  AM-PREV-DATES  COMP-3.
  3422         16  AM-PREV-EXP-DT                PIC 9(11).
  3423         16  AM-PREV-EFF-DT                PIC 9(11).
  3424
  3425     12  AM-REPORT-CODE-1                  PIC X(10).
  3426     12  AM-REPORT-CODE-2                  PIC X(10).
  3427
  3428     12  AM-CITY-CODE                      PIC X(4).
  3429     12  AM-COUNTY-PARISH                  PIC X(6).
  3430
  3431     12  AM-NAME                           PIC X(30).
  3432     12  AM-PERSON                         PIC X(30).
  3433     12  AM-ADDRS                          PIC X(30).
  3434     12  AM-CITY.
  3435         16  AM-ADDR-CITY                  PIC X(28).
  3436         16  AM-ADDR-STATE                 PIC XX.
  3437     12  AM-ZIP.
  3438         16  AM-ZIP-PRIME.
  3439             20  AM-ZIP-PRI-1ST            PIC X.
  3440                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3441             20  FILLER                    PIC X(4).
  3442         16  AM-ZIP-PLUS4                  PIC X(4).
  3443     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3444         16  AM-CAN-POSTAL-1               PIC XXX.
  3445         16  AM-CAN-POSTAL-2               PIC XXX.
  3446         16  FILLER                        PIC XXX.
  3447     12  AM-TEL-NO.
  3448         16  AM-AREA-CODE                  PIC 999.
  3449         16  AM-TEL-PRE                    PIC 999.
  3450         16  AM-TEL-NBR                    PIC 9(4).
  3451     12  AM-TEL-LOC                        PIC X.
  3452         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3453         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL677.cbl
  3454
  3455     12  AM-COMM-STRUCTURE.
  3456         16  AM-DEFN-1.
  3457             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3458                 24  AM-AGT.
  3459                     28  AM-AGT-PREFIX     PIC X(4).
  3460                     28  AM-AGT-PRIME      PIC X(6).
  3461                 24  AM-COM-TYP            PIC X.
  3462                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3463                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3464                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3465                 24  AM-RECALC-LV-INDIC    PIC X.
  3466                 24  AM-RETRO-LV-INDIC     PIC X.
  3467                 24  AM-GL-CODES           PIC X.
  3468                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3469                 24  FILLER                PIC X(01).
  3470         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3471             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3472                 24  FILLER                PIC X(11).
  3473                 24  AM-L-COMA             PIC XXX.
  3474                 24  AM-J-COMA             PIC XXX.
  3475                 24  AM-A-COMA             PIC XXX.
  3476                 24  FILLER                PIC X(6).
  3477
  3478     12  AM-COMM-CHANGE-STATUS             PIC X.
  3479         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3480
  3481     12  AM-CSR-CODE                       PIC X(4).
  3482
  3483     12  AM-BILLING-STATUS                 PIC X.
  3484         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3485         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3486     12  AM-AUTO-REFUND-SW                 PIC X.
  3487         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3488         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3489     12  AM-GPCD                           PIC 99.
  3490     12  AM-IG                             PIC X.
  3491         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3492         88  AM-HAS-GROUP                     VALUE '2'.
  3493     12  AM-STATUS                         PIC X.
  3494         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3495         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3496         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3497         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3498         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3499     12  AM-REMIT-TO                       PIC 99.
  3500     12  AM-ID-NO                          PIC X(11).
  3501
  3502     12  AM-CAL-TABLE                      PIC XX.
  3503     12  AM-LF-DEVIATION                   PIC XXX.
  3504     12  AM-AH-DEVIATION                   PIC XXX.
  3505     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3506     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3507     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3508     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3509     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3510     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3511
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL677.cbl
  3512     12  AM-USER-FIELDS.
  3513         16  AM-FLD-1                      PIC XX.
  3514         16  AM-FLD-2                      PIC XX.
  3515         16  AM-FLD-3                      PIC XX.
  3516         16  AM-FLD-4                      PIC XX.
  3517         16  AM-FLD-5                      PIC XX.
  3518
  3519     12  AM-1ST-PROD-DATE.
  3520         16  AM-1ST-PROD-YR                PIC XX.
  3521         16  AM-1ST-PROD-MO                PIC XX.
  3522         16  AM-1ST-PROD-DA                PIC XX.
  3523     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3524     12  AM-CERTS-PURGED-DATE.
  3525         16  AM-PUR-YR                     PIC XX.
  3526         16  AM-PUR-MO                     PIC XX.
  3527         16  AM-PUR-DA                     PIC XX.
  3528     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3529     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3530     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3531     12  AM-INACTIVE-DATE.
  3532         16  AM-INA-MO                     PIC 99.
  3533         16  AM-INA-DA                     PIC 99.
  3534         16  AM-INA-YR                     PIC 99.
  3535     12  AM-AR-HI-CERT-DATE                PIC XX.
  3536
  3537     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3538     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3539
  3540     12  AM-OB-PAYMENT-MODE                PIC X.
  3541         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3542         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3543         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3544         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3545
  3546     12  AM-AH-ONLY-INDICATOR              PIC X.
  3547         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3548         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3549
  3550     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3551
  3552     12  AM-OVER-SHORT.
  3553         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3554         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3555
  3556     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3557     12  AM-DCC-CLP-STATE                  PIC XX.
  3558
  3559     12  AM-RECALC-COMM                    PIC X.
  3560     12  AM-RECALC-REIN                    PIC X.
  3561
  3562     12  AM-REI-TABLE                      PIC XXX.
  3563     12  AM-REI-ET-LF                      PIC X.
  3564     12  AM-REI-ET-AH                      PIC X.
  3565     12  AM-REI-PE-LF                      PIC X.
  3566     12  AM-REI-PE-AH                      PIC X.
  3567     12  AM-REI-PRT-ST                     PIC X.
  3568     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3569     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL677.cbl
  3570     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3571     12  AM-REI-GROUP-A                    PIC X(6).
  3572     12  AM-REI-MORT                       PIC X(4).
  3573     12  AM-REI-PRT-OW                     PIC X.
  3574     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3575     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3576     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3577     12  AM-REI-GROUP-B                    PIC X(6).
  3578
  3579     12  AM-TRUST-TYPE                     PIC X(2).
  3580
  3581     12  AM-EMPLOYER-STMT-USED             PIC X.
  3582     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3583
  3584     12  AM-STD-AH-TYPE                    PIC XX.
  3585     12  AM-EARN-METHODS.
  3586         16  AM-EARN-METHOD-R              PIC X.
  3587             88 AM-REF-RL-R78                 VALUE 'R'.
  3588             88 AM-REF-RL-PR                  VALUE 'P'.
  3589             88 AM-REF-RL-MEAN                VALUE 'M'.
  3590             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3591         16  AM-EARN-METHOD-L              PIC X.
  3592             88 AM-REF-LL-R78                 VALUE 'R'.
  3593             88 AM-REF-LL-PR                  VALUE 'P'.
  3594             88 AM-REF-LL-MEAN                VALUE 'M'.
  3595             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3596         16  AM-EARN-METHOD-A              PIC X.
  3597             88 AM-REF-AH-R78                 VALUE 'R'.
  3598             88 AM-REF-AH-PR                  VALUE 'P'.
  3599             88 AM-REF-AH-MEAN                VALUE 'M'.
  3600             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3601             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3602             88 AM-REF-AH-NET                 VALUE 'N'.
  3603
  3604     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3605     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3606     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3607
  3608     12  AM-RET-Y-N                        PIC X.
  3609     12  AM-RET-P-E                        PIC X.
  3610     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3611     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3612     12  AM-RET-GRP                        PIC X(6).
  3613     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3614         16  AM-POOL-PRIME                 PIC XXX.
  3615         16  AM-POOL-SUB                   PIC XXX.
  3616     12  AM-RETRO-EARNINGS.
  3617         16  AM-RET-EARN-R                 PIC X.
  3618         16  AM-RET-EARN-L                 PIC X.
  3619         16  AM-RET-EARN-A                 PIC X.
  3620     12  AM-RET-ST-TAX-USE                 PIC X.
  3621         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3622         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3623     12  AM-RETRO-BEG-EARNINGS.
  3624         16  AM-RET-BEG-EARN-R             PIC X.
  3625         16  AM-RET-BEG-EARN-L             PIC X.
  3626         16  AM-RET-BEG-EARN-A             PIC X.
  3627     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL677.cbl
  3628     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3629
  3630     12  AM-USER-SELECT-OPTIONS.
  3631         16  AM-USER-SELECT-1              PIC X(10).
  3632         16  AM-USER-SELECT-2              PIC X(10).
  3633         16  AM-USER-SELECT-3              PIC X(10).
  3634         16  AM-USER-SELECT-4              PIC X(10).
  3635         16  AM-USER-SELECT-5              PIC X(10).
  3636
  3637     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3638
  3639     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3640
  3641     12  AM-RPT045A-SWITCH                 PIC X.
  3642         88  RPT045A-OFF                   VALUE 'N'.
  3643
  3644     12  AM-INSURANCE-LIMITS.
  3645         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3646         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3647
  3648     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3649         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3650
  3651     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3652         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3653         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3654
  3655     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3656
  3657     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3658     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3659     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3660     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3661     12  FILLER                            PIC X(5).
  3662     12  AM-REPORT-CODE-3                  PIC X(10).
  3663*    12  FILLER                            PIC X(22).
  3664
  3665     12  AM-RESERVE-DATE.
  3666         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3667         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3668         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3669
  3670     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3671     12  AM-NOTIFICATION-TYPES.
  3672         16  AM-NOTIF-OF-LETTERS           PIC X.
  3673         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3674         16  AM-NOTIF-OF-REPORTS           PIC X.
  3675         16  AM-NOTIF-OF-STATUS            PIC X.
  3676
  3677     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3678         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3679         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3680         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3681         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3682
  3683     12  AM-BENEFIT-CONTROLS.
  3684         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3685             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL677.cbl
  3686             20  AM-BENEFIT-TYPE           PIC X.
  3687             20  AM-BENEFIT-REVISION       PIC XXX.
  3688             20  AM-BENEFIT-REM-TERM       PIC X.
  3689             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3690             20  FILLER                    PIC XX.
  3691         16  FILLER                        PIC X(80).
  3692
  3693     12  AM-TRANSFER-DATA.
  3694         16  AM-TRANSFERRED-FROM.
  3695             20  AM-TRNFROM-CARRIER        PIC X.
  3696             20  AM-TRNFROM-GROUPING.
  3697                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3698                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3699             20  AM-TRNFROM-STATE          PIC XX.
  3700             20  AM-TRNFROM-ACCOUNT.
  3701                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3702                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3703             20  AM-TRNFROM-DTE            PIC XX.
  3704         16  AM-TRANSFERRED-TO.
  3705             20  AM-TRNTO-CARRIER          PIC X.
  3706             20  AM-TRNTO-GROUPING.
  3707                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3708                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3709             20  AM-TRNTO-STATE            PIC XX.
  3710             20  AM-TRNTO-ACCOUNT.
  3711                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3712                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3713             20  AM-TRNTO-DTE              PIC XX.
  3714         16  FILLER                        PIC X(10).
  3715
  3716     12  AM-SAVED-REMIT-TO                 PIC 99.
  3717
  3718     12  AM-COMM-STRUCTURE-SAVED.
  3719         16  AM-DEFN-1-SAVED.
  3720             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3721                 24  AM-AGT-SV             PIC X(10).
  3722                 24  AM-COM-TYP-SV         PIC X.
  3723                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3724                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3725                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3726                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3727                 24  FILLER                PIC X.
  3728                 24  AM-GL-CODES-SV        PIC X.
  3729                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3730                 24  FILLER                PIC X.
  3731         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3732             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3733                 24  FILLER                PIC X(11).
  3734                 24  AM-L-COMA-SV          PIC XXX.
  3735                 24  AM-J-COMA-SV          PIC XXX.
  3736                 24  AM-A-COMA-SV          PIC XXX.
  3737                 24  FILLER                PIC X(6).
  3738
  3739     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3740         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3741            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3742            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3743            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL677.cbl
  3744
  3745     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3746     12  FILLER                            PIC X(120).
  3747
  3748     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3749         16  AM-CONTROL-NAME               PIC X(30).
  3750         16  AM-EXECUTIVE-ONE.
  3751             20  AM-EXEC1-NAME             PIC X(15).
  3752             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3753                                                          COMP-3.
  3754             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3755                                                          COMP-3.
  3756         16  AM-EXECUTIVE-TWO.
  3757             20  AM-EXEC2-NAME             PIC X(15).
  3758             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3759                                                          COMP-3.
  3760             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3761                                                          COMP-3.
  3762
  3763     12  AM-RETRO-ADDITIONAL-DATA.
  3764         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3765         16  AM-RETRO-PREM-P-E             PIC X.
  3766         16  AM-RETRO-CLMS-P-I             PIC X.
  3767         16  AM-RETRO-RET-BRACKET-LF.
  3768             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3769                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3770                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3771             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3772                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3773                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3774             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3775                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3776                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3777         16  AM-RETRO-RET-BRACKET-AH.
  3778             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3779                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3780                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3781                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3782             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3783                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3784                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3785             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3786                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3787                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3788
  3789     12  AM-COMMENTS.
  3790         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3791
  3792     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3793         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3794         16  AM-FLI-BILLING-CODE           PIC X.
  3795         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3796         16  AM-FLI-UNITED-IDENT           PIC X.
  3797         16  AM-FLI-INTEREST-LOST-DATA.
  3798             20  AM-FLI-BANK-NO            PIC X(5).
  3799             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3800             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3801             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL677.cbl
  3802         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3803             20  AM-FLI-AGT                PIC X(9).
  3804             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3805             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3806         16  FILLER                        PIC X(102).
  3807
  3808     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3809         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3810             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3811             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3812             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3813             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3814             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3815         16  FILLER                          PIC X(10).
  3816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL677.cbl
  3818*                                    COPY ERCCOMP.
  3819******************************************************************
  3820*                                                                *
  3821*                                                                *
  3822*                            ERCCOMP                             *
  3823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3824*                            VMOD=2.019                          *
  3825*                                                                *
  3826*   ONLINE CREDIT SYSTEM                                         *
  3827*                                                                *
  3828*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  3829*                                                                *
  3830*   FILE TYPE = VSAM,KSDS                                        *
  3831*   RECORD SIZE = 700   RECFORM = FIXED                          *
  3832*                                                                *
  3833*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  3834*       ALTERNATE PATH = NONE                                    *
  3835*                                                                *
  3836*   LOG = NO                                                     *
  3837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3838*                                                                *
  3839******************************************************************
  3840*                   C H A N G E   L O G
  3841*
  3842* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3843*-----------------------------------------------------------------
  3844*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3845* EFFECTIVE    NUMBER
  3846*-----------------------------------------------------------------
  3847* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3848* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  3849* 092205    2005050300006  PEMA  ADD LEASE FEE
  3850* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  3851* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  3852* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  3853* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3854* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  3855******************************************************************
  3856
  3857 01  COMPENSATION-MASTER.
  3858     12  CO-RECORD-ID                          PIC XX.
  3859         88  VALID-CO-ID                          VALUE 'CO'.
  3860
  3861     12  CO-CONTROL-PRIMARY.
  3862         16  CO-COMPANY-CD                     PIC X.
  3863         16  CO-CONTROL.
  3864             20  CO-CTL-1.
  3865                 24  CO-CARR-GROUP.
  3866                     28  CO-CARRIER            PIC X.
  3867                     28  CO-GROUPING.
  3868                         32  CO-GROUP-PREFIX   PIC XXX.
  3869                         32  CO-GROUP-PRIME    PIC XXX.
  3870                 24  CO-RESP-NO.
  3871                     28  CO-RESP-PREFIX        PIC X(4).
  3872                     28  CO-RESP-PRIME         PIC X(6).
  3873             20  CO-CTL-2.
  3874                 24  CO-ACCOUNT.
  3875                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL677.cbl
  3876                     28  CO-ACCT-PRIME         PIC X(6).
  3877         16  CO-TYPE                           PIC X.
  3878             88  CO-COMPANY-TYPE                  VALUE 'C'.
  3879             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  3880             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  3881
  3882     12  CO-MAINT-INFORMATION.
  3883         16  CO-LAST-MAINT-DT                  PIC XX.
  3884         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  3885         16  CO-LAST-MAINT-USER                PIC X(4).
  3886     12  FILLER                                PIC XX.
  3887     12  CO-STMT-TYPE                          PIC XXX.
  3888     12  CO-COMP-TYPE                          PIC X.
  3889         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  3890     12  CO-STMT-OWNER                         PIC X(4).
  3891     12  CO-BALANCE-CONTROL                    PIC X.
  3892         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  3893         88  CO-NO-BALANCE                        VALUE 'N'.
  3894
  3895     12  CO-INTERNAL-CONTROL-1                 PIC X.
  3896         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  3897         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  3898         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  3899
  3900     12  CO-INTERNAL-CONTROL-2                 PIC X.
  3901         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  3902         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  3903
  3904     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  3905     12  CO-GA-DIRECT-DEP                      PIC X.
  3906     12  CO-FUTURE-SPACE                       PIC X.
  3907         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  3908
  3909     12  CO-ACCT-NAME                          PIC X(30).
  3910     12  CO-MAIL-NAME                          PIC X(30).
  3911     12  CO-ADDR-1                             PIC X(30).
  3912     12  CO-ADDR-2                             PIC X(30).
  3913     12  CO-ADDR-3.
  3914         16  CO-ADDR-CITY                      PIC X(27).
  3915         16  CO-ADDR-STATE                     PIC XX.
  3916     12  CO-CSO-1099                           PIC X.
  3917     12  CO-ZIP.
  3918         16  CO-ZIP-PRIME.
  3919             20  CO-ZIP-PRI-1ST                PIC X.
  3920                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3921             20  FILLER                        PIC X(4).
  3922         16  CO-ZIP-PLUS4                      PIC X(4).
  3923     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  3924         16  CO-CAN-POSTAL-1                   PIC XXX.
  3925         16  CO-CAN-POSTAL-2                   PIC XXX.
  3926         16  FILLER                            PIC XXX.
  3927     12  CO-SOC-SEC                            PIC X(13).
  3928     12  CO-TELEPHONE.
  3929         16  CO-AREA-CODE                      PIC XXX.
  3930         16  CO-PREFIX                         PIC XXX.
  3931         16  CO-PHONE                          PIC X(4).
  3932
  3933     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL677.cbl
  3934
  3935     12  CO-AR-BAL-LEVEL                       PIC X.
  3936         88  CO-AR-REF-LVL                        VALUE '1'.
  3937         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  3938         88  CO-AR-BILL-LVL                       VALUE '2'.
  3939         88  CO-AR-AGT-LVL                        VALUE '3'.
  3940         88  CO-AR-FR-LVL                         VALUE '4'.
  3941
  3942     12  CO-AR-NORMAL-PRINT                    PIC X.
  3943         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  3944         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  3945
  3946     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  3947
  3948     12  CO-AR-REPORTING                       PIC X.
  3949         88  CO-AR-NET-REPORT                     VALUE 'N'.
  3950         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  3951
  3952     12  CO-AR-PULL-CHECK                      PIC X.
  3953         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  3954         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  3955
  3956     12  CO-AR-BALANCE-PRINT                   PIC X.
  3957         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  3958
  3959     12  CO-AR-LAST-RUN-CODE                   PIC X.
  3960         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  3961         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  3962         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  3963
  3964     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  3965
  3966     12  CO-USER-CODE                          PIC X.
  3967     12  CO-REPORT-GROUP-ID                    PIC X(12).
  3968
  3969******************************************************************
  3970*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  3971*    THE LAST MONTH END RUN.
  3972******************************************************************
  3973
  3974     12  CO-LAST-ACTIVITY-DATE.
  3975         16  CO-ACT-YEAR                       PIC 99.
  3976         16  CO-ACT-MONTH                      PIC 99.
  3977         16  CO-ACT-DAY                        PIC 99.
  3978
  3979     12  CO-LAST-STMT-DT.
  3980         16  CO-LAST-STMT-YEAR                 PIC 99.
  3981         16  CO-LAST-STMT-MONTH                PIC 99.
  3982         16  CO-LAST-STMT-DAY                  PIC 99.
  3983
  3984     12  CO-MO-END-TOTALS.
  3985         16  CO-MONTHLY-TOTALS.
  3986             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  3987             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  3988             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  3989             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  3990             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  3991
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL677.cbl
  3992         16  CO-AGING-TOTALS.
  3993             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  3994             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  3995             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  3996             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  3997
  3998         16  CO-YTD-TOTALS.
  3999             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4000             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4001
  4002         16  CO-OVER-UNDER-TOTALS.
  4003             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4004             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4005
  4006     12  CO-MISCELLANEOUS-TOTALS.
  4007         16  CO-FICA-TOTALS.
  4008             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4009             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4010
  4011         16  CO-CLAIM-TOTALS.
  4012             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4013             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4014
  4015******************************************************************
  4016*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4017*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4018******************************************************************
  4019
  4020     12  CO-CURRENT-TOTALS.
  4021         16  CO-CURRENT-LAST-STMT-DT.
  4022             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4023             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4024             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4025
  4026         16  CO-CURRENT-MONTHLY-TOTALS.
  4027             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4028             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4029             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4030             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4031             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4032
  4033         16  CO-CURRENT-AGING-TOTALS.
  4034             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4035             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4036             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4037             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4038
  4039         16  CO-CURRENT-YTD-TOTALS.
  4040             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4041             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4042
  4043     12  CO-PAID-COMM-TOTALS.
  4044         16  CO-YTD-PAID-COMMS.
  4045             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4046             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4047
  4048     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4049         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL677.cbl
  4050         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4051
  4052     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4053         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4054         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4055         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4056         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4057         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4058         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4059         88  CO-FINAL-LETTER                  VALUE 'F'.
  4060         88  CO-RECONCILING                   VALUE 'R'.
  4061         88  CO-PHONE-CALL                    VALUE 'P'.
  4062         88  CO-LEGAL                         VALUE 'L'.
  4063         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4064         88  CO-WRITE-OFF                     VALUE 'W'.
  4065         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4066
  4067     12  CO-CSR-CODE                       PIC X(4).
  4068
  4069     12  CO-GA-STATUS-INFO.
  4070         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4071         16  CO-GA-TERMINATION-DT          PIC XX.
  4072         16  CO-GA-STATUS-CODE             PIC X.
  4073             88  CO-GA-ACTIVE                 VALUE 'A'.
  4074             88  CO-GA-INACTIVE               VALUE 'I'.
  4075             88  CO-GA-PENDING                VALUE 'P'.
  4076         16  CO-GA-COMMENTS.
  4077             20  CO-GA-COMMENT-1           PIC X(40).
  4078             20  CO-GA-COMMENT-2           PIC X(40).
  4079             20  CO-GA-COMMENT-3           PIC X(40).
  4080             20  CO-GA-COMMENT-4           PIC X(40).
  4081
  4082     12  CO-RPTCD2                         PIC X(10).
  4083
  4084     12  CO-TYPE-AGENT                     PIC X(01).
  4085         88  CO-CORPORATION                   VALUE 'C'.
  4086         88  CO-PARTNERSHIP                   VALUE 'P'.
  4087         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4088         88  CO-TRUST                         VALUE 'T'.
  4089         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4090
  4091     12  CO-FAXNO.
  4092         16  CO-FAX-AREA-CODE                  PIC XXX.
  4093         16  CO-FAX-PREFIX                     PIC XXX.
  4094         16  CO-FAX-PHONE                      PIC X(4).
  4095
  4096     12  CO-BANK-INFORMATION.
  4097         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4098         16  CO-BANK-TRANSIT-NON REDEFINES
  4099             CO-BANK-TRANSIT-NO                PIC 9(8).
  4100
  4101         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4102     12  CO-MISC-DEDUCT-INFO REDEFINES
  4103                  CO-BANK-INFORMATION.
  4104         16  CO-MD-GL-ACCT                     PIC X(10).
  4105         16  CO-MD-DIV                         PIC XX.
  4106         16  CO-MD-CENTER                      PIC X(4).
  4107         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL677.cbl
  4108         16  CO-CREATE-AP-CHECK                PIC X.
  4109         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4110         16  FILLER                            PIC XXX.
  4111     12  CO-ACH-STATUS                         PIC X.
  4112         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4113         88  CO-ACH-PENDING                        VALUE 'P'.
  4114
  4115     12  CO-BILL-SW                            PIC X.
  4116     12  CO-CONTROL-NAME                       PIC X(30).
  4117     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4118     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4119     12  CO-CLP-STATE                          PIC XX.
  4120     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4121     12  CO-SPP-REFUND-EDIT                    PIC X.
  4122
  4123******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL677.cbl
  4125*                                    COPY ELCCERT.
  4126******************************************************************
  4127*                                                                *
  4128*                            ELCCERT.                            *
  4129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4130*                            VMOD=2.013                          *
  4131*                                                                *
  4132*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4133*                                                                *
  4134*   FILE TYPE = VSAM,KSDS                                        *
  4135*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4136*                                                                *
  4137*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4138*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4139*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4140*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4141*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4142*                                                                *
  4143*   LOG = YES                                                    *
  4144*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4145******************************************************************
  4146*                   C H A N G E   L O G
  4147*
  4148* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4149*-----------------------------------------------------------------
  4150*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4151* EFFECTIVE    NUMBER
  4152*-----------------------------------------------------------------
  4153* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4154* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4155* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4156* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4157* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4158* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4159* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4160******************************************************************
  4161
  4162 01  CERTIFICATE-MASTER.
  4163     12  CM-RECORD-ID                      PIC XX.
  4164         88  VALID-CM-ID                      VALUE 'CM'.
  4165
  4166     12  CM-CONTROL-PRIMARY.
  4167         16  CM-COMPANY-CD                 PIC X.
  4168         16  CM-CARRIER                    PIC X.
  4169         16  CM-GROUPING.
  4170             20  CM-GROUPING-PREFIX        PIC X(3).
  4171             20  CM-GROUPING-PRIME         PIC X(3).
  4172         16  CM-STATE                      PIC XX.
  4173         16  CM-ACCOUNT.
  4174             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4175             20  CM-ACCOUNT-PRIME          PIC X(6).
  4176         16  CM-CERT-EFF-DT                PIC XX.
  4177         16  CM-CERT-NO.
  4178             20  CM-CERT-PRIME             PIC X(10).
  4179             20  CM-CERT-SFX               PIC X.
  4180
  4181     12  CM-CONTROL-BY-NAME.
  4182         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL677.cbl
  4183         16  CM-INSURED-LAST-NAME          PIC X(15).
  4184         16  CM-INSURED-INITIALS.
  4185             20  CM-INSURED-INITIAL1       PIC X.
  4186             20  CM-INSURED-INITIAL2       PIC X.
  4187
  4188     12  CM-CONTROL-BY-SSN.
  4189         16  CM-COMPANY-CD-A2              PIC X.
  4190         16  CM-SOC-SEC-NO.
  4191             20  CM-SSN-STATE              PIC XX.
  4192             20  CM-SSN-ACCOUNT            PIC X(6).
  4193             20  CM-SSN-LN3.
  4194                 25  CM-INSURED-INITIALS-A2.
  4195                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4196                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4197                 25 CM-PART-LAST-NAME-A2         PIC X.
  4198
  4199     12  CM-CONTROL-BY-CERT-NO.
  4200         16  CM-COMPANY-CD-A4              PIC X.
  4201         16  CM-CERT-NO-A4                 PIC X(11).
  4202
  4203     12  CM-CONTROL-BY-MEMB.
  4204         16  CM-COMPANY-CD-A5              PIC X.
  4205         16  CM-MEMBER-NO.
  4206             20  CM-MEMB-STATE             PIC XX.
  4207             20  CM-MEMB-ACCOUNT           PIC X(6).
  4208             20  CM-MEMB-LN4.
  4209                 25  CM-INSURED-INITIALS-A5.
  4210                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4211                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4212                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4213
  4214     12  CM-INSURED-PROFILE-DATA.
  4215         16  CM-INSURED-FIRST-NAME.
  4216             20  CM-INSURED-1ST-INIT       PIC X.
  4217             20  FILLER                    PIC X(9).
  4218         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4219         16  CM-INSURED-SEX                PIC X.
  4220             88  CM-SEX-MALE                  VALUE 'M'.
  4221             88  CM-SEX-FEMAL                 VALUE 'F'.
  4222         16  CM-INSURED-JOINT-AGE          PIC 99.
  4223         16  CM-JOINT-INSURED-NAME.
  4224             20  CM-JT-LAST-NAME           PIC X(15).
  4225             20  CM-JT-FIRST-NAME.
  4226                 24  CM-JT-1ST-INIT        PIC X.
  4227                 24  FILLER                PIC X(9).
  4228             20  CM-JT-INITIAL             PIC X.
  4229
  4230     12  CM-LIFE-DATA.
  4231         16  CM-LF-BENEFIT-CD              PIC XX.
  4232         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4233         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4234         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4235         16  CM-LF-DEV-CODE                PIC XXX.
  4236         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4237         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4238         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4239         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4240         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL677.cbl
  4241         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4242         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4243         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4244         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4245         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4246         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4247         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4248         16  FILLER                        PIC XX.
  4249
  4250     12  CM-AH-DATA.
  4251         16  CM-AH-BENEFIT-CD              PIC XX.
  4252         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4253         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4254         16  CM-AH-DEV-CODE                PIC XXX.
  4255         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4256         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4257         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4258         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4259         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4260         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4261         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4262         16  CM-AH-PAID-THRU-DT            PIC XX.
  4263             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4264         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4265         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4266         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4267         16  FILLER                        PIC X.
  4268
  4269     12  CM-LOAN-INFORMATION.
  4270         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4271         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4272         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4273         16  CM-PAY-FREQUENCY              PIC S99.
  4274         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4275         16  CM-RATE-CLASS                 PIC XX.
  4276         16  CM-BENEFICIARY                PIC X(25).
  4277         16  CM-POLICY-FORM-NO             PIC X(12).
  4278         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4279         16  CM-LAST-ADD-ON-DT             PIC XX.
  4280         16  CM-DEDUCTIBLE-AMOUNTS.
  4281             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4282             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4283         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4284             20  CM-RESIDENT-STATE         PIC XX.
  4285             20  CM-RATE-CODE              PIC X(4).
  4286             20  FILLER                    PIC XX.
  4287         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4288             20  CM-LOAN-OFFICER           PIC X(5).
  4289             20  FILLER                    PIC XXX.
  4290         16  CM-CSR-CODE                   PIC XXX.
  4291         16  CM-UNDERWRITING-CODE          PIC X.
  4292             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4293         16  CM-POST-CARD-IND              PIC X.
  4294         16  CM-NH-INTERFACE-SW            PIC X.
  4295         16  CM-PREMIUM-TYPE               PIC X.
  4296             88  CM-SING-PRM                  VALUE '1'.
  4297             88  CM-O-B-COVERAGE              VALUE '2'.
  4298             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL677.cbl
  4299         16  CM-IND-GRP-TYPE               PIC X.
  4300             88  CM-INDIVIDUAL                VALUE 'I'.
  4301             88  CM-GROUP                     VALUE 'G'.
  4302         16  CM-SKIP-CODE                  PIC X.
  4303             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4304             88  SKIP-JULY                    VALUE '1'.
  4305             88  SKIP-AUGUST                  VALUE '2'.
  4306             88  SKIP-SEPTEMBER               VALUE '3'.
  4307             88  SKIP-JULY-AUG                VALUE '4'.
  4308             88  SKIP-AUG-SEPT                VALUE '5'.
  4309             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4310             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4311             88  SKIP-JUNE                    VALUE '8'.
  4312             88  SKIP-JUNE-JULY               VALUE '9'.
  4313             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4314             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4315         16  CM-PAYMENT-MODE               PIC X.
  4316             88  PAY-MONTHLY                  VALUE SPACE.
  4317             88  PAY-WEEKLY                   VALUE '1'.
  4318             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4319             88  PAY-BI-WEEKLY                VALUE '3'.
  4320             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4321         16  CM-LOAN-NUMBER                PIC X(8).
  4322         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4323         16  CM-OLD-LOF                    PIC XXX.
  4324*        16  CM-LOAN-OFFICER               PIC XXX.
  4325         16  CM-REIN-TABLE                 PIC XXX.
  4326         16  CM-SPECIAL-REIN-CODE          PIC X.
  4327         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4328         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4329         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4330
  4331     12  CM-STATUS-DATA.
  4332         16  CM-ENTRY-STATUS               PIC X.
  4333         16  CM-ENTRY-DT                   PIC XX.
  4334
  4335         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4336         16  CM-LF-CANCEL-DT               PIC XX.
  4337         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4338
  4339         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4340         16  CM-LF-DEATH-DT                PIC XX.
  4341         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4342
  4343         16  CM-LF-CURRENT-STATUS          PIC X.
  4344             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4345                                                'M' '4' '5' '9'.
  4346             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4347             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4348             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4349             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4350             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4351             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4352             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4353             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4354             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4355             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4356             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL677.cbl
  4357             88  CM-LF-VOIDED                 VALUE 'V'.
  4358
  4359         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4360         16  CM-AH-CANCEL-DT               PIC XX.
  4361         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4362
  4363         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4364         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4365         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4366
  4367         16  CM-AH-CURRENT-STATUS          PIC X.
  4368             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4369                                                'M' '4' '5' '9'.
  4370             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4371             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4372             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4373             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4374             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4375             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4376             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4377             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4378             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4379             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4380             88  CM-AH-DECLINED               VALUE 'D'.
  4381             88  CM-AH-VOIDED                 VALUE 'V'.
  4382
  4383         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4384             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4385             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4386             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4387         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4388
  4389         16  CM-ENTRY-BATCH                PIC X(6).
  4390         16  CM-LF-EXIT-BATCH              PIC X(6).
  4391         16  CM-AH-EXIT-BATCH              PIC X(6).
  4392         16  CM-LAST-MONTH-END             PIC XX.
  4393
  4394     12  CM-NOTE-SW                        PIC X.
  4395         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4396         88  CERT-NOTES-PRESENT               VALUE '1'.
  4397         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4398         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4399         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4400         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4401         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4402         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4403     12  CM-COMP-EXCP-SW                   PIC X.
  4404         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4405         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4406     12  CM-INSURED-ADDRESS-SW             PIC X.
  4407         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4408         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4409
  4410*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4411     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4412     12  FILLER                            PIC X.
  4413
  4414*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL677.cbl
  4415     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4416     12  FILLER                            PIC X.
  4417*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4418     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4419
  4420     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4421         88  CERT-ADDED-BATCH                 VALUE ' '.
  4422         88  CERT-ADDED-ONLINE                VALUE '1'.
  4423         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4424         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4425         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4426     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4427         88  CERT-AS-LOADED                   VALUE ' '.
  4428         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4429         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4430         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4431         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4432         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4433         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4434         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4435
  4436     12  CM-ACCOUNT-COMM-PCTS.
  4437         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4438         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4439
  4440     12  CM-USER-FIELD                     PIC X.
  4441     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4442     12  CM-CLP-STATE                      PIC XX.
  4443     12  CM-USER-RESERVED                  PIC XXX.
  4444******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL677.cbl
  4446*                                    COPY ERCPNDB.
  4447******************************************************************
  4448*                                                                *
  4449*                                                                *
  4450*                            ERCPNDB.                            *
  4451*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4452*                            VMOD=2.025                          *
  4453*                                                                *
  4454*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4455*                                                                *
  4456******************************************************************
  4457*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4458*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4459******************************************************************
  4460*                                                                *
  4461*                                                                *
  4462*   FILE TYPE = VSAM,KSDS                                        *
  4463*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4464*                                                                *
  4465*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4466*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4467*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4468*                                                 RKP=13,LEN=36  *
  4469*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4470*                                      AND CHG-SEQ.)             *
  4471*                                                RKP=49,LEN=11   *
  4472*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4473*                                      AND CHG-SEQ.)             *
  4474*                                                RKP=60,LEN=15   *
  4475*                                                                *
  4476*   LOG = NO                                                     *
  4477*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4478******************************************************************
  4479******************************************************************
  4480*                   C H A N G E   L O G
  4481*
  4482* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4483*-----------------------------------------------------------------
  4484*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4485* EFFECTIVE    NUMBER
  4486*-----------------------------------------------------------------
  4487* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4488* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4489* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4490* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4491* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4492* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4493* 032306                   PEMA  ADD BOW LOAN NUMBER
  4494* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4495* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4496* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4497* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4498* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4499* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4500* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4501******************************************************************
  4502
  4503 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL677.cbl
  4504     12  PB-RECORD-ID                     PIC XX.
  4505         88  VALID-PB-ID                        VALUE 'PB'.
  4506
  4507     12  PB-CONTROL-PRIMARY.
  4508         16  PB-COMPANY-CD                PIC X.
  4509         16  PB-ENTRY-BATCH               PIC X(6).
  4510         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4511         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4512
  4513     12  PB-CONTROL-BY-ACCOUNT.
  4514         16  PB-COMPANY-CD-A1             PIC X.
  4515         16  PB-CARRIER                   PIC X.
  4516         16  PB-GROUPING.
  4517             20  PB-GROUPING-PREFIX       PIC XXX.
  4518             20  PB-GROUPING-PRIME        PIC XXX.
  4519         16  PB-STATE                     PIC XX.
  4520         16  PB-ACCOUNT.
  4521             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4522             20  PB-ACCOUNT-PRIME         PIC X(6).
  4523         16  PB-CERT-EFF-DT               PIC XX.
  4524         16  PB-CERT-NO.
  4525             20  PB-CERT-PRIME            PIC X(10).
  4526             20  PB-CERT-SFX              PIC X.
  4527         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4528
  4529         16  PB-RECORD-TYPE               PIC X.
  4530             88  PB-MAILING-DATA                VALUE '0'.
  4531             88  PB-ISSUE                       VALUE '1'.
  4532             88  PB-CANCELLATION                VALUE '2'.
  4533             88  PB-BATCH-TRAILER               VALUE '9'.
  4534
  4535     12  PB-CONTROL-BY-ORIG-BATCH.
  4536         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4537         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4538         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4539         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4540
  4541     12  PB-CONTROL-BY-CSR.
  4542         16  PB-CSR-COMPANY-CD            PIC X.
  4543         16  PB-CSR-ID                    PIC X(4).
  4544         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4545         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4546         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4547******************************************************************
  4548*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4549******************************************************************
  4550
  4551     12  PB-LAST-MAINT-DT                 PIC XX.
  4552     12  PB-LAST-MAINT-BY                 PIC X(4).
  4553     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4554
  4555     12  PB-RECORD-BODY                   PIC X(375).
  4556
  4557     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4558         16  PB-CERT-ORIGIN               PIC X.
  4559             88  CLASIC-CREATED-CERT         VALUE '1'.
  4560         16  PB-I-NAME.
  4561             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL677.cbl
  4562             20  PB-I-INSURED-FIRST-NAME.
  4563                 24  PB-I-INSURED-1ST-INIT PIC X.
  4564                 24  FILLER                PIC X(9).
  4565             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4566         16  PB-I-AGE                     PIC S99   COMP-3.
  4567         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4568         16  PB-I-BIRTHDAY                PIC XX.
  4569         16  PB-I-INSURED-SEX             PIC X.
  4570             88  PB-SEX-MALE     VALUE 'M'.
  4571             88  PB-SEX-FEMALE   VALUE 'F'.
  4572
  4573         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4574         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4575         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4576         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4577         16  PB-I-SKIP-CODE               PIC X.
  4578             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4579             88  PB-SKIP-JULY              VALUE '1'.
  4580             88  PB-SKIP-AUGUST            VALUE '2'.
  4581             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4582             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4583             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4584             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4585             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4586             88  PB-SKIP-JUNE              VALUE '8'.
  4587             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4588             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4589             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4590         16  PB-I-TERM-TYPE               PIC X.
  4591             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4592             88  PB-PAID-WEEKLY            VALUE 'W'.
  4593             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4594             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4595             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4596         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4597         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4598         16  PB-I-DATA-ENTRY-SW           PIC X.
  4599             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4600             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4601             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4602             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4603         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4604         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4605*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4606         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4607         16  FILLER                       PIC X.
  4608
  4609         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4610             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4611             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4612                                                   '90' THRU '99'.
  4613         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4614                                          PIC XX.
  4615         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4616         16  PB-I-AMOUNT-FINANCED REDEFINES
  4617                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4618         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4619         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL677.cbl
  4620                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4621         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4622         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4623         16  PB-I-CLP-AMOUNT REDEFINES
  4624                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4625         16  PB-I-LF-CALC-FLAG            PIC X.
  4626             88 PB-COMP-LF-PREM               VALUE '?'.
  4627         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4628         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4629         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4630         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4631         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4632         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4633         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4634         16  PB-I-LF-ABBR                 PIC XXX.
  4635         16  PB-I-LF-INPUT-CD             PIC XX.
  4636
  4637         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4638             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4639             88  PB-INVALID-AH               VALUE '  ' '00'
  4640                                                   '90' THRU '99'.
  4641         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4642         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4643         16  PB-I-AH-CALC-FLAG            PIC X.
  4644             88 PB-COMP-AH-PREM                  VALUE '?'.
  4645         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4646         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4647         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4648         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4649         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4650         16  PB-I-AH-ABBR                 PIC XXX.
  4651         16  PB-I-AH-INPUT-CD             PIC XXX.
  4652
  4653         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4654         16  PB-I-REIN-TABLE              PIC XXX.
  4655         16  PB-I-BUSINESS-TYPE           PIC 99.
  4656         16  PB-I-INDV-GRP-CD             PIC X.
  4657         16  PB-I-MORT-CODE.
  4658             20  PB-I-TABLE               PIC X.
  4659             20  PB-I-INTEREST            PIC XX.
  4660             20  PB-I-MORT-TYP            PIC X.
  4661         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4662         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4663         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4664         16  PB-I-INDV-GRP-OVRD           PIC X.
  4665         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4666         16  PB-I-SIG-SW                  PIC X.
  4667             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4668         16  PB-I-RATE-CLASS              PIC XX.
  4669         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4670         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4671         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4672         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4673         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4674         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4675         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4676         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4677         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL677.cbl
  4678             88  PB-I-OB                      VALUE 'B'.
  4679             88  PB-I-SUMMARY                 VALUE 'Z'.
  4680         16  PB-I-ENTRY-STATUS            PIC X.
  4681             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4682                                              'M' '5' '9' '2'.
  4683             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4684             88  PB-I-POLICY-PENDING          VALUE '2'.
  4685             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4686             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4687             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4688             88  PB-I-REIN-ONLY               VALUE '9'.
  4689             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4690             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4691             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4692             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4693         16  PB-I-INT-CODE                PIC X.
  4694             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4695             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4696         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4697         16  PB-I-SOC-SEC-NO              PIC X(11).
  4698         16  PB-I-MEMBER-NO               PIC X(12).
  4699         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4700*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4701         16  PB-I-OLD-LOF                 PIC XXX.
  4702         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4703         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4704         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4705         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4706         16  PB-I-LIFE-INDICATOR          PIC X.
  4707             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4708         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4709         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4710             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4711             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4712         16  PB-I-1ST-PMT-DT              PIC XX.
  4713         16  PB-I-JOINT-INSURED.
  4714             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4715             20 PB-I-JOINT-FIRST-NAME.
  4716                24  PB-I-JOINT-FIRST-INIT PIC X.
  4717                24  FILLER                PIC X(9).
  4718             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4719*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4720         16  PB-I-BENEFICIARY-NAME.
  4721             20  PB-I-BANK-NUMBER         PIC X(10).
  4722             20  FILLER                   PIC X(15).
  4723         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4724         16  PB-I-REFERENCE               PIC X(12).
  4725         16  FILLER REDEFINES PB-I-REFERENCE.
  4726             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4727             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4728             20  PB-I-CLP-STATE           PIC XX.
  4729         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4730             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4731             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4732             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4733         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4734         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4735         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL677.cbl
  4736         16  PB-I-RATE-CODE               PIC X(4).
  4737         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4738         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4739         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4740         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4741         16  PB-I-BANK-NOCHRGB            PIC 99.
  4742         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4743         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4744
  4745     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4746         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4747             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4748         16  PB-C-CANCEL-ORIGIN           PIC X.
  4749             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4750         16  PB-C-LF-CANCEL-DT            PIC XX.
  4751         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4752         16  PB-C-LF-CALC-REQ             PIC X.
  4753             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4754         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4755         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4756         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4757             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4758         16  PB-C-AH-CANCEL-DT            PIC XX.
  4759         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4760         16  PB-C-AH-CALC-REQ             PIC X.
  4761             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4762         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4763         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4764         16  PB-C-LAST-NAME               PIC X(15).
  4765         16  PB-C-REFUND-SW               PIC X.
  4766             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4767             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4768         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4769         16  PB-C-PAYEE-CODE              PIC X(6).
  4770         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4771         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4772         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4773         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4774         16  PB-C-REFERENCE               PIC X(12).
  4775         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4776         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4777         16  PB-C-POST-CARD-IND           PIC X.
  4778         16  PB-C-CANCEL-REASON           PIC X.
  4779         16  PB-C-REF-INTERFACE-SW        PIC X.
  4780         16  FILLER                       PIC X(09).
  4781*        16  FILLER                       PIC X(18).
  4782         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4783*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4784         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4785         16  PB-CANCELED-CERT-DATA.
  4786             20  PB-CI-INSURED-NAME.
  4787                 24  PB-CI-LAST-NAME      PIC X(15).
  4788                 24  PB-CI-INITIALS       PIC XX.
  4789             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4790             20  PB-CI-INSURED-SEX        PIC X.
  4791             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4792             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4793             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL677.cbl
  4794             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4795             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4796             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4797             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4798             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4799             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4800             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4801             20  PB-CI-RATE-CLASS         PIC XX.
  4802             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4803             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4804             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4805             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4806             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4807             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4808             20  PB-CI-LF-ABBR            PIC X(3).
  4809             20  PB-CI-AH-ABBR            PIC X(3).
  4810             20  PB-CI-OB-FLAG            PIC X.
  4811                 88  PB-CI-OB                VALUE 'B'.
  4812             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4813                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4814                                           'M' '4' '5' '9' '2'.
  4815                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4816                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4817                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4818                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4819                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4820                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4821                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4822                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4823                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4824                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4825                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4826                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4827             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4828                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4829                                           'M' '4' '5' '9' '2'.
  4830                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4831                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4832                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4833                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4834                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4835                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4836                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4837                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4838                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4839                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4840                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4841                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4842             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4843             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4844             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4845             20  PB-CI-MEMBER-NO          PIC X(12).
  4846             20  PB-CI-INT-CODE           PIC X.
  4847                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4848                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4849             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4850             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4851             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL677.cbl
  4852                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4853                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4854             20  PB-CI-ENTRY-STATUS       PIC X.
  4855             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4856             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4857             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4858             20  PB-CI-DEATH-DT           PIC XX.
  4859             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4860             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4861             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4862             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4863             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4864             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4865             20  PB-CI-ENTRY-DT              PIC XX.
  4866             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4867             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4868             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4869             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4870             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4871             20  PB-CI-OLD-LOF               PIC XXX.
  4872*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4873             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4874             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4875             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4876             20  PB-CI-INDV-GRP-CD           PIC X.
  4877             20  PB-CI-BENEFICIARY-NAME.
  4878                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4879                 24  FILLER                  PIC X(15).
  4880             20  PB-CI-NOTE-SW               PIC X.
  4881             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4882             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4883             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4884             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4885             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4886             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4887             20  PB-CI-FIRST-NAME            PIC X(10).
  4888
  4889         16  FILLER                       PIC X(17).
  4890*032306  16  FILLER                       PIC X(27).
  4891*        16  FILLER                       PIC X(46).
  4892
  4893     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4894         16  FILLER                       PIC X(10).
  4895         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4896         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4897         16  PB-M-INSURED-MID-INIT        PIC X.
  4898         16  PB-M-INSURED-AGE             PIC 99.
  4899         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4900         16  PB-M-INSURED-SEX             PIC X.
  4901         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4902         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4903         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4904         16  PB-M-INSURED-CITY-STATE.
  4905             20  PB-M-INSURED-CITY        PIC X(28).
  4906             20  PB-M-INSURED-STATE       PIC XX.
  4907         16  PB-M-INSURED-ZIP-CODE.
  4908             20  PB-M-INSURED-ZIP-PRIME.
  4909                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL677.cbl
  4910                     88  PB-M-CANADIAN-POST-CODE
  4911                                             VALUE 'A' THRU 'Z'.
  4912                 24  FILLER               PIC X(4).
  4913             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4914         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4915                                        PB-M-INSURED-ZIP-CODE.
  4916             20  PM-M-INS-CAN-POST1       PIC XXX.
  4917             20  PM-M-INS-CAN-POST2       PIC XXX.
  4918             20  FILLER                   PIC XXX.
  4919         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4920         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4921         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4922         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4923         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4924         16  PB-M-CRED-BENE-CITYST.
  4925             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4926             20  PB-M-CRED-BENE-STATE     PIC XX.
  4927         16  FILLER                       PIC X(92).
  4928
  4929     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4930         16  FILLER                       PIC X(10).
  4931         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4932         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4933         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4934         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4935         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4936         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4937         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4938         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4939         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4940         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4941         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4942         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4943         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4944         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4945         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4946         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4947         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4948         16  PB-ACCOUNT-NAME              PIC X(30).
  4949         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4950         16  PB-REFERENCE                 PIC X(12).
  4951         16  PB-B-RECEIVED-DT             PIC XX.
  4952         16  FILLER                       PIC X(234).
  4953
  4954     12  PB-RECORD-STATUS.
  4955         16  PB-CREDIT-SELECT-DT          PIC XX.
  4956         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4957         16  PB-BILLED-DT                 PIC XX.
  4958         16  PB-BILLING-STATUS            PIC X.
  4959             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4960             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4961             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4962         16  PB-RECORD-BILL               PIC X.
  4963             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4964             88  PB-RECORD-RETURNED           VALUE 'R'.
  4965             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4966             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4967             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL677.cbl
  4968             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4969         16  PB-BATCH-ENTRY               PIC X.
  4970             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4971             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4972             88  PB-REISSUED-CERT             VALUE 'E'.
  4973             88  PB-MONTHLY-CERT              VALUE 'M'.
  4974             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4975             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4976             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4977         16  PB-FORCE-CODE                PIC X.
  4978             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4979             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4980             88  PB-CANCEL-FORCE              VALUE '8'.
  4981             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4982             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4983             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4984             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4985             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4986             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4987             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4988         16  PB-FATAL-FLAG                PIC X.
  4989             88  PB-FATAL-ERRORS              VALUE 'X'.
  4990         16  PB-FORCE-ER-CD               PIC X.
  4991             88  PB-FORCE-ERRORS              VALUE 'F'.
  4992             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4993         16  PB-WARN-ER-CD                PIC X.
  4994             88  PB-WARNING-ERRORS            VALUE 'W'.
  4995         16  FILLER                       PIC X.
  4996         16  PB-OUT-BAL-CD                PIC X.
  4997             88  PB-OUT-OF-BAL                VALUE 'O'.
  4998         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4999         16  PB-AH-OVERRIDE-L1            PIC X.
  5000         16  PB-INPUT-DT                  PIC XX.
  5001         16  PB-INPUT-BY                  PIC X(4).
  5002         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5003         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5004         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5005         16  PB-LF-EARNING-METHOD         PIC X.
  5006         16  PB-AH-EARNING-METHOD         PIC X.
  5007         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5008         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5009         16  PB-REIN-CD                   PIC XXX.
  5010         16  PB-LF-REFUND-TYPE            PIC X.
  5011         16  PB-AH-REFUND-TYPE            PIC X.
  5012         16  PB-ACCT-EFF-DT               PIC XX.
  5013         16  PB-ACCT-EXP-DT               PIC XX.
  5014         16  PB-COMPANY-ID                PIC X(3).
  5015         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5016         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5017         16  PB-SV-CARRIER                PIC X.
  5018         16  PB-SV-GROUPING               PIC X(6).
  5019         16  PB-SV-STATE                  PIC XX.
  5020         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5021         16  PB-GA-BILLING-INFO.
  5022             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5023                                          PIC XX.
  5024         16  PB-SV-REMIT-TO  REDEFINES
  5025             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL677.cbl
  5026         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5027         16  PB-I-LOAN-OFFICER            PIC X(5).
  5028         16  PB-I-VIN                     PIC X(17).
  5029
  5030         16  FILLER                       PIC X(04).
  5031         16  IMNET-BYPASS-SW              PIC X.
  5032
  5033******************************************************************
  5034*                COMMON EDIT ERRORS                              *
  5035******************************************************************
  5036
  5037     12  PB-COMMON-ERRORS.
  5038         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5039                                           PIC S9(4)     COMP.
  5040
  5041******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL677.cbl
  5043*                                    COPY ERCPNDM.
  5044******************************************************************
  5045*                                                                *
  5046*                                                                *
  5047*                            ERCPNDM                             *
  5048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5049*                            VMOD=2.003                          *
  5050*                                                                *
  5051*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5052*                                                                *
  5053*   FILE TYPE = VSAM,KSDS                                        *
  5054*   RECORD SIZE = 374   RECFORM = FIX                            *
  5055*                                                                *
  5056*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5057*   ALTERNATE PATH    = NOT USED                                 *
  5058*                                                                *
  5059*   LOG = YES                                                    *
  5060*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5061******************************************************************
  5062*                   C H A N G E   L O G
  5063*
  5064* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5065*-----------------------------------------------------------------
  5066*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5067* EFFECTIVE    NUMBER
  5068*-----------------------------------------------------------------
  5069* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5070* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5071* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5072******************************************************************
  5073
  5074 01  PENDING-MAILING-DATA.
  5075     12  PM-RECORD-ID                      PIC XX.
  5076         88  VALID-MA-ID                       VALUE 'PM'.
  5077
  5078     12  PM-CONTROL-PRIMARY.
  5079         16  PM-COMPANY-CD                 PIC X.
  5080         16  PM-ENTRY-BATCH                PIC X(6).
  5081         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5082         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5083
  5084     12  FILLER                            PIC X(14).
  5085
  5086     12  PM-ACCESS-CONTROL.
  5087         16  PM-SOURCE-SYSTEM              PIC XX.
  5088             88  PM-FROM-CREDIT                VALUE 'CR'.
  5089             88  PM-FROM-VSI                   VALUE 'VS'.
  5090             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5091             88  PM-FROM-OTHER                 VALUE 'OT'.
  5092         16  PM-RECORD-ADD-DT              PIC XX.
  5093         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5094         16  PM-LAST-MAINT-DT              PIC XX.
  5095         16  PM-LAST-MAINT-BY              PIC XXXX.
  5096         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5097
  5098     12  PM-PROFILE-INFO.
  5099         16  PM-QUALIFY-CODE-1             PIC XX.
  5100         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL677.cbl
  5101         16  PM-QUALIFY-CODE-3             PIC XX.
  5102         16  PM-QUALIFY-CODE-4             PIC XX.
  5103         16  PM-QUALIFY-CODE-5             PIC XX.
  5104
  5105         16  PM-INSURED-LAST-NAME          PIC X(15).
  5106         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5107         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5108         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5109         16  PM-INSURED-BIRTH-DT           PIC XX.
  5110         16  PM-INSURED-SEX                PIC X.
  5111             88  PM-SEX-MALE                   VALUE 'M'.
  5112             88  PM-SEX-FEMALE                 VALUE 'F'.
  5113         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5114
  5115         16  PM-ADDRESS-CORRECTED          PIC X.
  5116         16  PM-JOINT-BIRTH-DT             PIC XX.
  5117*        16  FILLER                        PIC X(12).
  5118
  5119         16  PM-ADDRESS-LINE-1             PIC X(30).
  5120         16  PM-ADDRESS-LINE-2             PIC X(30).
  5121         16  PM-CITY-STATE.
  5122             20  PM-CITY                   PIC X(28).
  5123             20  PM-STATE                  PIC XX.
  5124         16  PM-ZIP.
  5125             20  PM-ZIP-CODE.
  5126                 24  PM-ZIP-1              PIC X.
  5127                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5128                 24  FILLER                PIC X(4).
  5129             20  PM-ZIP-PLUS4              PIC X(4).
  5130         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5131             20  PM-CAN-POST1              PIC XXX.
  5132             20  PM-CAN-POST2              PIC XXX.
  5133             20  FILLER                    PIC XXX.
  5134
  5135         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5136
  5137         16  FILLER                        PIC X(03).
  5138
  5139     12  PM-CRED-BENE-INFO.
  5140         16  PM-CRED-BENE-NAME             PIC X(25).
  5141         16  PM-CRED-BENE-ADDR             PIC X(30).
  5142         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5143         16  PM-CRED-BENE-CTYST.
  5144             20  PM-CRED-BENE-CITY         PIC X(28).
  5145             20  PM-CRED-BENE-STATE        PIC XX.
  5146         16  PM-CRED-BENE-ZIP.
  5147             20  PM-CB-ZIP-CODE.
  5148                 24  PM-CB-ZIP-1           PIC X.
  5149                     88  PM-CB-CANADIAN-POST-CODE
  5150                                  VALUE 'A' THRU 'Z'.
  5151                 24  FILLER                PIC X(4).
  5152             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5153         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5154             20  PM-CB-CAN-POST1           PIC XXX.
  5155             20  PM-CB-CAN-POST2           PIC XXX.
  5156             20  FILLER                    PIC XXX.
  5157     12  PM-POST-CARD-MAIL-DATA.
  5158         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL677.cbl
  5159             20  PM-MAIL-TYPE              PIC X.
  5160                 88  PM-12MO-MAILING           VALUE '1'.
  5161                 88  PM-EXP-MAILING            VALUE '2'.
  5162             20  PM-MAIL-STATUS            PIC X.
  5163                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5164                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5165                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5166             20  PM-MAIL-DATE              PIC XX.
  5167     12  FILLER                            PIC XX.
  5168     12  FILLER                            PIC X(12).
  5169*    12  FILLER                            PIC X(30).
  5170
  5171******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL677.cbl
  5173*                                    COPY ERCMAIL.
  5174******************************************************************
  5175*                                                                *
  5176*                                                                *
  5177*                            ERCMAIL                             *
  5178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5179*                            VMOD=2.003                          *
  5180*                                                                *
  5181*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5182*                                                                *
  5183*   FILE TYPE = VSAM,KSDS                                        *
  5184*   RECORD SIZE = 374   RECFORM = FIX                            *
  5185*                                                                *
  5186*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5187*   ALTERNATE PATH    = NOT USED                                 *
  5188*                                                                *
  5189*   LOG = YES                                                    *
  5190*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5191******************************************************************
  5192*                   C H A N G E   L O G
  5193*
  5194* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5195*-----------------------------------------------------------------
  5196*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5197* EFFECTIVE    NUMBER
  5198*-----------------------------------------------------------------
  5199* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5200* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5201* 111108                   PEMA  ADD CRED BENE ADDR2
  5202******************************************************************
  5203
  5204 01  MAILING-DATA.
  5205     12  MA-RECORD-ID                      PIC XX.
  5206         88  VALID-MA-ID                       VALUE 'MA'.
  5207
  5208     12  MA-CONTROL-PRIMARY.
  5209         16  MA-COMPANY-CD                 PIC X.
  5210         16  MA-CARRIER                    PIC X.
  5211         16  MA-GROUPING.
  5212             20  MA-GROUPING-PREFIX        PIC XXX.
  5213             20  MA-GROUPING-PRIME         PIC XXX.
  5214         16  MA-STATE                      PIC XX.
  5215         16  MA-ACCOUNT.
  5216             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5217             20  MA-ACCOUNT-PRIME          PIC X(6).
  5218         16  MA-CERT-EFF-DT                PIC XX.
  5219         16  MA-CERT-NO.
  5220             20  MA-CERT-PRIME             PIC X(10).
  5221             20  MA-CERT-SFX               PIC X.
  5222
  5223     12  FILLER                            PIC XX.
  5224
  5225     12  MA-ACCESS-CONTROL.
  5226         16  MA-SOURCE-SYSTEM              PIC XX.
  5227             88  MA-FROM-CREDIT                VALUE 'CR'.
  5228             88  MA-FROM-VSI                   VALUE 'VS'.
  5229             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5230             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL677.cbl
  5231         16  MA-RECORD-ADD-DT              PIC XX.
  5232         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5233         16  MA-LAST-MAINT-DT              PIC XX.
  5234         16  MA-LAST-MAINT-BY              PIC XXXX.
  5235         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5236
  5237     12  MA-PROFILE-INFO.
  5238         16  MA-QUALIFY-CODE-1             PIC XX.
  5239         16  MA-QUALIFY-CODE-2             PIC XX.
  5240         16  MA-QUALIFY-CODE-3             PIC XX.
  5241         16  MA-QUALIFY-CODE-4             PIC XX.
  5242         16  MA-QUALIFY-CODE-5             PIC XX.
  5243
  5244         16  MA-INSURED-LAST-NAME          PIC X(15).
  5245         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5246         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5247         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5248         16  MA-INSURED-BIRTH-DT           PIC XX.
  5249         16  MA-INSURED-SEX                PIC X.
  5250             88  MA-SEX-MALE                   VALUE 'M'.
  5251             88  MA-SEX-FEMALE                 VALUE 'F'.
  5252         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5253
  5254         16  MA-ADDRESS-CORRECTED          PIC X.
  5255         16  MA-JOINT-BIRTH-DT             PIC XX.
  5256*        16  FILLER                        PIC X(12).
  5257
  5258         16  MA-ADDRESS-LINE-1             PIC X(30).
  5259         16  MA-ADDRESS-LINE-2             PIC X(30).
  5260         16  MA-CITY-STATE.
  5261             20  MA-CITY                   PIC X(28).
  5262             20  MA-ADDR-STATE             PIC XX.
  5263         16  MA-ZIP.
  5264             20  MA-ZIP-CODE.
  5265                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5266                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5267                 24  FILLER                PIC X(4).
  5268             20  MA-ZIP-PLUS4              PIC X(4).
  5269         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5270             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5271             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5272             20  FILLER                    PIC X(3).
  5273
  5274         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5275
  5276         16  FILLER                        PIC XXX.
  5277*        16  FILLER                        PIC X(10).
  5278
  5279     12  MA-CRED-BENE-INFO.
  5280         16  MA-CRED-BENE-NAME                 PIC X(25).
  5281         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5282         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5283         16  MA-CRED-BENE-CTYST.
  5284             20  MA-CRED-BENE-CITY             PIC X(28).
  5285             20  MA-CRED-BENE-STATE            PIC XX.
  5286         16  MA-CRED-BENE-ZIP.
  5287             20  MA-CB-ZIP-CODE.
  5288                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL677.cbl
  5289                     88  MA-CB-CANADIAN-POST-CODE
  5290                                           VALUE 'A' THRU 'Z'.
  5291                 24  FILLER                    PIC X(4).
  5292             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5293         16  MA-CB-CANADIAN-POSTAL-CODE
  5294                            REDEFINES MA-CRED-BENE-ZIP.
  5295             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5296             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5297             20  FILLER                        PIC X(3).
  5298     12  MA-POST-CARD-MAIL-DATA.
  5299         16  MA-MAIL-DATA OCCURS 7.
  5300             20  MA-MAIL-TYPE              PIC X.
  5301                 88  MA-12MO-MAILING           VALUE '1'.
  5302                 88  MA-EXP-MAILING            VALUE '2'.
  5303             20  MA-MAIL-STATUS            PIC X.
  5304                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5305                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5306                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5307             20  MA-MAIL-DATE              PIC XX.
  5308     12  FILLER                            PIC XX.
  5309     12  FILLER                            PIC XX.
  5310*    12  FILLER                            PIC X(30).
  5311******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL677.cbl
  5313*                                    COPY ELCBENE.
  5314******************************************************************
  5315*                                                                *
  5316*                            ELCBENE.                            *
  5317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5318*                            VMOD=2.006                          *
  5319*                                                                *
  5320*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  5321*                                                                *
  5322*   FILE TYPE = VSAM,KSDS                                        *
  5323*   RECORD SIZE = 500   RECFORM = FIX                            *
  5324*                                                                *
  5325*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  5326*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  5327*                                                                *
  5328*   LOG = YES                                                    *
  5329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5330*                                                                *
  5331*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  5332******************************************************************
  5333
  5334 01  BENEFICIARY-MASTER.
  5335     12  BE-RECORD-ID                PIC XX.
  5336         88  VALID-BE-ID                VALUE 'BE'.
  5337
  5338     12  BE-CONTROL-PRIMARY.
  5339         16  BE-COMPANY-CD           PIC X.
  5340         16  BE-RECORD-TYPE          PIC X.
  5341             88  BENEFICIARY-RECORD  VALUE 'B'.
  5342             88  ADJUSTOR-RECORD     VALUE 'A'.
  5343         16  BE-BENEFICIARY          PIC X(10).
  5344     12  BE-CONTROL-BY-NAME.
  5345         16  BE-COMPANY-CD-A1        PIC X.
  5346         16  BE-RECORD-TYPE-A1       PIC X.
  5347         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  5348         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  5349
  5350     12  BE-LAST-MAINT-DT            PIC XX.
  5351     12  BE-LAST-MAINT-BY            PIC X(4).
  5352     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5353
  5354     12  BE-ADDRESS-DATA.
  5355         16  BE-MAIL-TO-NAME         PIC X(30).
  5356         16  BE-ADDRESS-LINE-1       PIC X(30).
  5357         16  BE-ADDRESS-LINE-2       PIC X(30).
  5358         16  BE-ADDRESS-LINE-3       PIC X(30).
  5359         16  BE-CITY-STATE.
  5360             20  BE-CITY             PIC X(28).
  5361             20  BE-STATE            PIC XX.
  5362         16  BE-ZIP-CODE.
  5363             20  BE-ZIP-PRIME.
  5364                 24  BE-ZIP-1ST      PIC X.
  5365                     88  BE-CANADIAN-POST-CODE
  5366                                         VALUE 'A' THRU 'Z'.
  5367                 24  FILLER          PIC X(4).
  5368             20  BE-ZIP-PLUS4        PIC X(4).
  5369         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  5370             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL677.cbl
  5371             20  BE-CAN-POSTAL-2     PIC XXX.
  5372             20  FILLER              PIC XXX.
  5373         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  5374         16  BE-GROUP-CHECKS-Y-N     PIC X.
  5375
  5376******************************************************************
  5377*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  5378*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  5379******************************************************************
  5380     12  BE-CARRIER                  PIC X.
  5381
  5382     12  BE-ADDRESS-DATA2.
  5383         16  BE-MAIL-TO-NAME2        PIC X(30).
  5384         16  BE-ADDRESS-LINE-12      PIC X(30).
  5385         16  BE-ADDRESS-LINE-22      PIC X(30).
  5386         16  BE-ADDRESS-LINE-32      PIC X(30).
  5387         16  BE-CITY-STATE2.
  5388             20  BE-CITY2            PIC X(28).
  5389             20  BE-STATE2           PIC XX.
  5390         16  BE-ZIP-CODE2.
  5391             20  BE-ZIP-PRIME2.
  5392                 24  BE-ZIP-1ST2     PIC X.
  5393                     88  BE-CANADIAN-POST-CODE2
  5394                                         VALUE 'A' THRU 'Z'.
  5395                 24  FILLER          PIC X(4).
  5396             20  BE-ZIP-PLUS42       PIC X(4).
  5397         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  5398             20  BE-CAN-POSTAL-12    PIC XXX.
  5399             20  BE-CAN-POSTAL-22    PIC XXX.
  5400             20  FILLER              PIC XXX.
  5401         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  5402         16  BE-BILLING-STMT-DATA.
  5403             20  BE-BSR              PIC X.
  5404                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  5405                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  5406             20  BE-BSR-FROM         PIC X(30).
  5407             20  BE-BSR-DEPT         PIC X(30).
  5408             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  5409             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  5410             20  BE-OUTPUT-TYPE      PIC X.
  5411                 88  BE-FAX-OUTPUT         VALUE 'F'.
  5412                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  5413
  5414     12  FILLER                      PIC X(28).
  5415******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL677.cbl
  5417*                                    COPY ERCPYAJ.
  5418******************************************************************
  5419*                                                                *
  5420*                            ERCPYAJ                             *
  5421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5422*                            VMOD=2.015                          *
  5423*                                                                *
  5424*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5425*                                                                *
  5426*                                                                *
  5427*   FILE TYPE = VSAM,KSDS                                        *
  5428*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5429*                                                                *
  5430*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5431*       ALTERNATE PATHS = NONE                                   *
  5432*                                                                *
  5433*   LOG = YES                                                    *
  5434*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5435******************************************************************
  5436******************************************************************
  5437*                   C H A N G E   L O G
  5438*
  5439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5440*-----------------------------------------------------------------
  5441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5442* EFFECTIVE    NUMBER
  5443*-----------------------------------------------------------------
  5444* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5445* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5446******************************************************************
  5447
  5448 01  PENDING-PAY-ADJ.
  5449     12  PY-RECORD-ID                     PIC XX.
  5450         88  VALID-PY-ID                        VALUE 'PY'.
  5451
  5452     12  PY-CONTROL-PRIMARY.
  5453         16  PY-COMPANY-CD                PIC X.
  5454         16  PY-CARRIER                   PIC X.
  5455         16  PY-GROUPING                  PIC X(6).
  5456         16  PY-FIN-RESP                  PIC X(10).
  5457         16  PY-ACCOUNT                   PIC X(10).
  5458         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5459                                          PIC X(10).
  5460         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5461         16  PY-RECORD-TYPE               PIC X.
  5462             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5463             88  PY-DEPOSIT                   VALUE 'D'.
  5464             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5465             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5466             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5467             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5468             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5469             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5470             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5471             88  PY-FICA-ENTRY                VALUE 'F'.
  5472             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5473             88  PY-POLICY-FEE                VALUE 'W'.
  5474             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL677.cbl
  5475
  5476     12  PY-PYMT-TYPE                     PIC X.
  5477             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5478             88  PY-REINS-PYMT                VALUE 'R'.
  5479             88  PY-EXP-PYMT                  VALUE 'E'.
  5480
  5481     12  PY-BIL-INV                       PIC X(6).
  5482     12  PY-REF-NO                        PIC X(12).
  5483
  5484     12  PY-LAST-MAINT-DT                 PIC XX.
  5485     12  PY-LAST-MAINT-BY                 PIC X(4).
  5486     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5487
  5488     12  PY-PYADJ-RECORD.
  5489         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5490         16  PY-ENTRY-COMMENT             PIC X(30).
  5491         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5492             20  PY-GL-ACCOUNT            PIC X(10).
  5493             20  PY-GL-STATE              PIC X(02).
  5494             20  PY-GL-CANC-SW            PIC X(01).
  5495                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5496                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5497             20  PY-GL-COMMENT            PIC X(10).
  5498             20  FILLER      REDEFINES PY-GL-COMMENT.
  5499                 24  PY-GL-CHECK-NO       PIC 9(06).
  5500                 24  FILLER               PIC X(04).
  5501             20  FILLER                   PIC X(07).
  5502         16  PY-SAVE-ACCOUNT              PIC X(10).
  5503         16  PY-SAVE-TYPE                 PIC X(01).
  5504
  5505         16  PY-LETTERS.
  5506             20  PY-LETTER OCCURS 3 TIMES
  5507                           INDEXED BY PY-LET-NDX
  5508                                          PIC X(04).
  5509
  5510         16  PY-ERCOMP-TYPE               PIC X.
  5511             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5512             88  PY-GA-TYPE                   VALUE 'G'.
  5513             88  PY-BANK-TYPE                 VALUE 'B'.
  5514         16  FILLER                       PIC X(05).
  5515
  5516     12  PY-RECORD-STATUS.
  5517         16  PY-CREDIT-SELECT-DT          PIC XX.
  5518         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5519         16  PY-BILLED-DATE               PIC XX.
  5520         16  PY-REPORTED-DT               PIC XX.
  5521         16  PY-PMT-APPLIED               PIC X.
  5522             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5523             88  PY-GA-PMT                    VALUE 'G'.
  5524             88  PY-OVWRITE-PMT               VALUE 'O'.
  5525             88  PY-NON-AR-PMT                VALUE 'N'.
  5526         16  FILLER                       PIC X(5).
  5527         16  PY-INPUT-DT                  PIC XX.
  5528         16  PY-CHECK-NUMBER              PIC X(6).
  5529         16  PY-VOID-SW                   PIC X.
  5530             88  PY-CHECK-VOIDED              VALUE 'V'.
  5531         16  PY-CHECK-ORIGIN-SW           PIC X.
  5532             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL677.cbl
  5533             88  PY-REFUND-CHECK              VALUE 'R'.
  5534             88  PY-GA-CHECK                  VALUE 'G'.
  5535             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5536             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5537         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5538         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5539         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5540         16  PY-BILL-FLAG                 PIC X.
  5541             88  PY-BILLED                    VALUE 'B'.
  5542         16  PY-AR-FLAG                   PIC X.
  5543             88  PY-AR-CYCLE                  VALUE 'C'.
  5544             88  PY-AR-MONTH-END              VALUE 'M'.
  5545         16  PY-AR-DATE                   PIC XX.
  5546
  5547     12  PY-GL-CODES.
  5548         16  PY-GL-DB                     PIC X(14).
  5549         16  PY-GL-CR                     PIC X(14).
  5550         16  PY-GL-FLAG                   PIC X.
  5551         16  PY-GL-DATE                   PIC XX.
  5552
  5553     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5554     12  FILLER                           PIC X(3).
  5555******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL677.cbl
  5557*                                    COPY ELCTEXT.
  5558******************************************************************
  5559*                                                                *
  5560*                                                                *
  5561*                            ELCTEXT.                            *
  5562*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5563*                            VMOD=2.008                          *
  5564*                                                                *
  5565*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5566*                                     FORM LETTERS,              *
  5567*                                     CERT FORM DISPLAY.
  5568*                                                                *
  5569*   FILE TYPE = VSAM,KSDS                                        *
  5570*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5571*                                                                *
  5572*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5573*       ALTERNATE INDEX = NONE                                   *
  5574*                                                                *
  5575*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5576*       ALTERNATE INDEX = NONE                                   *
  5577*                                                                *
  5578*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5579*       ALTERNATE INDEX = NONE                                   *
  5580*                                                                *
  5581*   LOG = NO                                                     *
  5582*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5583******************************************************************
  5584 01  TEXT-FILES.
  5585     12  TEXT-FILE-ID                PIC XX.
  5586         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5587         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5588         88  HELP-FILE-TEXT             VALUE 'TH'.
  5589
  5590     12  TX-CONTROL-PRIMARY.
  5591         16  TX-COMPANY-CD           PIC X.
  5592             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5593         16  TX-ACCESS-CD-GENL       PIC X(12).
  5594
  5595         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5596             20  TX-LETTER-NO        PIC X(4).
  5597             20  FILLER              PIC X(8).
  5598
  5599         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5600             20  TX-FORM-NO          PIC X(12).
  5601
  5602         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5603             20  TX-HELP-TYPE        PIC X.
  5604                 88  HELP-FOR-GENERAL   VALUE ' '.
  5605                 88  HELP-BY-SCREEN     VALUE 'S'.
  5606                 88  HELP-BY-ERROR      VALUE 'E'.
  5607             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5608                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5609             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5610                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5611             20  FILLER              PIC X(4).
  5612
  5613         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5614
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL677.cbl
  5615     12  TX-PROCESS-CONTROL          PIC XX.
  5616         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5617
  5618     12  TX-TEXT-LINE                PIC X(70).
  5619
  5620     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5621         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5622         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5623         88  TX-VALID-FORM-SQUEEZE-VALUE
  5624                                        VALUE 'Y' ' '.
  5625
  5626     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5627         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5628         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5629         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5630         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5631         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5632         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5633         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5634                                              'K' 'N' ' '
  5635                                              'Z'.
  5636
  5637     12  TX-ARCHIVE-SW               PIC X.
  5638         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5639         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5640         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5641
  5642     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5643     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5644
  5645     12  TX-BSR-CODE                 PIC X.
  5646         88  TX-BSR-LETTER              VALUE 'B'.
  5647         88  TX-NON-BSR-LETTER          VALUE ' '.
  5648
  5649     12  FILLER                      PIC X.
  5650*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL677.cbl
  5652
  5653 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5654                          CHECK-RECORDS CHECK-QUE
  5655                          ACCOUNT-MASTER COMPENSATION-MASTER
  5656                          CERTIFICATE-MASTER PENDING-BUSINESS
  5657                          PENDING-MAILING-DATA MAILING-DATA
  5658                          BENEFICIARY-MASTER PENDING-PAY-ADJ
  5659                          TEXT-FILES.
  5660 0000-DFHEXIT SECTION.
  5661     MOVE '9#                    $   ' TO DFHEIV0.
  5662     MOVE 'EL677' TO DFHEIV1.
  5663     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5664
  5665     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5666     MOVE '5'                    TO  DC-OPTION-CODE.
  5667     PERFORM 8500-DATE-CONVERT.
  5668     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5669     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5670     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5671
  5672     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5673
  5674     IF PI-AMOUNT NOT NUMERIC
  5675         MOVE ZEROS              TO  PI-AMOUNT.
  5676
  5677     IF EIBCALEN = 0
  5678         GO TO 8800-UNAUTHORIZED-ACCESS.
  5679
  5680     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5681     MOVE 2                      TO  EMI-SWITCH2.
  5682     MOVE EIBTRMID               TO  QID-TERM.
  5683
  5684     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5685         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5686
  5687     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5688         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5689             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5690             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5691             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5692             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5693             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5694             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5695             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5696             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5697         ELSE
  5698             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5699             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5700             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5701             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5702             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5703             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5704             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5705             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5706
  5707     MOVE LOW-VALUES             TO  EL677AI.
  5708
  5709     IF EIBTRNID NOT = TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL677.cbl
  5710         IF PI-TO-EL677-FROM-EL1273
  5711             MOVE 'S'            TO MAINTI
  5712             MOVE 1              TO MAINTL
  5713             MOVE AL-UABON       TO MAINTA
  5714             MOVE DFHENTER       TO EIBAID
  5715             GO TO 5000-BROWSE-FILE.
  5716
  5717     IF EIBTRNID NOT = TRANS-ID
  5718         IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5719             PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5720             PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5721             IF PI-PROCESS-BENEFICIARY
  5722                GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5723             ELSE
  5724                GO TO 6300-BUILD-CERT-SCREEN
  5725         ELSE
  5726             IF EIBTRNID NOT = EL6311-TRANS-ID
  5727                GO TO 8100-SEND-INITIAL-MAP
  5728             ELSE
  5729                PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5730                IF PI-PROCESS-BENEFICIARY
  5731                   GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5732                ELSE
  5733                   GO TO 6300-BUILD-CERT-SCREEN.
  5734
  5735     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5736                                     PI-CHEK-COMP-CD.
  5737
  5738
  5739* EXEC CICS HANDLE CONDITION
  5740*        PGMIDERR  (9600-PGMID-ERROR)
  5741*        ERROR     (9990-ABEND)
  5742*    END-EXEC.
  5743*    MOVE '"$L.                  ! " #00005734' TO DFHEIV0
  5744     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5746     MOVE X'2220233030303035373334' TO DFHEIV0(25:11)
  5747     CALL 'kxdfhei1' USING DFHEIV0
  5748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5749
  5750
  5751     IF EIBAID = DFHCLEAR
  5752         GO TO 9400-CLEAR.
  5753
  5754     IF PI-PROCESSOR-ID = 'LGXX'
  5755         GO TO 0200-RECEIVE.
  5756
  5757
  5758* EXEC CICS READQ TS
  5759*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5760*        INTO   (SECURITY-CONTROL)
  5761*        LENGTH (SC-COMM-LENGTH)
  5762*        ITEM   (SC-ITEM)
  5763*    END-EXEC.
  5764*    MOVE '*$II   L              ''   #00005745' TO DFHEIV0
  5765     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5767     MOVE X'2020233030303035373435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL677.cbl
  5768     CALL 'kxdfhei1' USING DFHEIV0,
  5769           PI-SECURITY-TEMP-STORE-ID,
  5770           SECURITY-CONTROL,
  5771           SC-COMM-LENGTH,
  5772           SC-ITEM,
  5773           DFHEIV99,
  5774           DFHEIV99
  5775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5776
  5777
  5778     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5779     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5780
  5781     IF NOT DISPLAY-CAP
  5782         MOVE 'READ'          TO SM-READ
  5783         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5784         MOVE ER-0070         TO  EMI-ERROR
  5785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5786         GO TO 8100-SEND-INITIAL-MAP.
  5787
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL677.cbl
  5789
  5790 0200-RECEIVE.
  5791     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5792         MOVE ER-1159            TO  EMI-ERROR
  5793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5794         MOVE -1                 TO  PFENTERL
  5795         GO TO 8200-SEND-DATAONLY.
  5796
  5797
  5798* EXEC CICS HANDLE CONDITION
  5799*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5800*    END-EXEC.
  5801*    MOVE '"$?                   ! # #00005771' TO DFHEIV0
  5802     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5804     MOVE X'2320233030303035373731' TO DFHEIV0(25:11)
  5805     CALL 'kxdfhei1' USING DFHEIV0
  5806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5807
  5808
  5809
  5810* EXEC CICS RECEIVE
  5811*        MAP      (EL677A)
  5812*        MAPSET   (MAPSET-NAME)
  5813*        INTO     (EL677AI)
  5814*    END-EXEC.
  5815     MOVE LENGTH OF
  5816      EL677AI
  5817       TO DFHEIV11
  5818*    MOVE '8"T I  L              ''   #00005775' TO DFHEIV0
  5819     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5821     MOVE X'2020233030303035373735' TO DFHEIV0(25:11)
  5822     CALL 'kxdfhei1' USING DFHEIV0,
  5823           EL677A,
  5824           EL677AI,
  5825           DFHEIV11,
  5826           MAPSET-NAME,
  5827           DFHEIV99,
  5828           DFHEIV99
  5829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5830
  5831
  5832     IF PFENTERL GREATER ZERO
  5833         IF EIBAID NOT = DFHENTER
  5834             MOVE ER-0004        TO  EMI-ERROR
  5835             MOVE AL-UNBOF       TO  PFENTERA
  5836             MOVE -1             TO  PFENTERL
  5837             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5838             GO TO 8200-SEND-DATAONLY
  5839         ELSE
  5840             IF (PFENTERI NUMERIC) AND
  5841                (PFENTERI GREATER 0 AND LESS 25)
  5842                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  5843             ELSE
  5844                 MOVE ER-0029    TO  EMI-ERROR
  5845                 MOVE AL-UNBOF   TO  PFENTERA
  5846                 MOVE -1         TO  PFENTERL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL677.cbl
  5847                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5848                 GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL677.cbl
  5850
  5851 0300-CHECK-PFKEYS.
  5852     IF EIBAID = DFHPF23
  5853         GO TO 8810-PF23.
  5854
  5855     IF EIBAID = DFHPF24
  5856         GO TO 9200-RETURN-MAIN-MENU.
  5857
  5858     IF EIBAID = DFHPF12
  5859         GO TO 9500-PF12.
  5860
  5861     IF EIBAID = DFHPF1 OR DFHPF2
  5862         GO TO 5000-BROWSE-FILE.
  5863
  5864     IF EIBAID = DFHPF3
  5865         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  5866         MOVE 'PF3'              TO  PI-PFKEY
  5867         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  5868         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  5869             GO TO 9400-CLEAR
  5870         ELSE
  5871             MOVE XCTL-1273      TO  PGM-NAME
  5872             GO TO 9300-XCTL.
  5873
  5874     IF EIBAID = DFHPF4
  5875         IF NOT FORCE-CAP
  5876             MOVE ER-0433        TO EMI-ERROR
  5877             MOVE -1             TO PFENTERL
  5878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5879             GO TO 8200-SEND-DATAONLY.
  5880
  5881     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  5882                             DFHPF5 OR DFHPF6
  5883         GO TO 1000-EDIT-DATA.
  5884
  5885     IF EIBAID = DFHPF7
  5886         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  5887         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  5888         MOVE XCTL-114           TO  PGM-NAME
  5889         GO TO 9300-XCTL.
  5890
  5891 0320-INPUT-ERROR.
  5892     MOVE ER-0029                TO  EMI-ERROR.
  5893     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5894     MOVE -1                     TO  PFENTERL.
  5895     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL677.cbl
  5897
  5898 1000-EDIT-DATA.
  5899     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V'
  5900         MOVE AL-UANON           TO MAINTA
  5901         IF MAINTI = 'C' OR 'V'
  5902             IF PI-PREV-MAINT = 'S'  OR  'C'
  5903                 NEXT SENTENCE
  5904             ELSE
  5905                 MOVE ER-2056    TO  EMI-ERROR
  5906                 MOVE -1         TO  MAINTL
  5907                 MOVE AL-UABON   TO  MAINTA
  5908                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5909                 GO TO 1100-EDIT-COMPLETE
  5910         ELSE
  5911             NEXT SENTENCE
  5912     ELSE
  5913         IF EIBAID = DFHPF5 OR DFHPF6
  5914            NEXT SENTENCE
  5915         ELSE
  5916            MOVE ER-0023            TO  EMI-ERROR
  5917            MOVE -1                 TO  MAINTL
  5918            MOVE AL-UABON           TO  MAINTA
  5919            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5920
  5921     IF MODIFY-CAP
  5922         NEXT SENTENCE
  5923       ELSE
  5924         IF MAINTI NOT = 'S'
  5925            MOVE 'UPDATE'       TO SM-READ
  5926            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5927            MOVE ER-0070        TO EMI-ERROR
  5928            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5929            GO TO 8100-SEND-INITIAL-MAP.
  5930
  5931     IF CARRIERI NOT = LOW-VALUES
  5932         MOVE AL-UANON           TO  CARRIERA
  5933         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  5934         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  5935                                     PI-CARRIER
  5936     ELSE
  5937         MOVE -1                 TO  CARRIERL
  5938         MOVE AL-UABON           TO  CARRIERA
  5939         MOVE ER-0194            TO  EMI-ERROR
  5940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5941
  5942     IF GROUPI NOT = LOW-VALUES
  5943         MOVE AL-UANON           TO  GROUPA
  5944         MOVE GROUPI             TO  PI-CHEK-GROUPING
  5945                                     PI-GROUPING
  5946     ELSE
  5947         MOVE -1                 TO  GROUPL
  5948         MOVE AL-UABON           TO  GROUPA
  5949         MOVE ER-0195            TO  EMI-ERROR
  5950         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5951
  5952     IF STATEI NOT = LOW-VALUES
  5953         MOVE AL-UANON           TO  STATEA
  5954         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL677.cbl
  5955         MOVE STATEI             TO  PI-CHEK-STATE
  5956                                     PI-STATE
  5957     ELSE
  5958         MOVE -1                 TO  STATEL
  5959         MOVE AL-UABON           TO  STATEA
  5960         MOVE ER-0196            TO  EMI-ERROR
  5961         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5962
  5963     IF EFFDTL GREATER ZERO
  5964         MOVE EFFDTI             TO  WS-DEEDIT-FIELD-A
  5965         PERFORM 8700-DEEDIT
  5966         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  5967             MOVE WS-DEEDIT-FIELD-V0 TO  EFFDTO
  5968             INSPECT EFFDTI CONVERTING SPACES TO '/'
  5969             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  5970             MOVE '4'                TO  DC-OPTION-CODE
  5971             PERFORM 8500-DATE-CONVERT
  5972             IF DC-ERROR-CODE NOT = SPACES
  5973                 MOVE ER-0215        TO  EMI-ERROR
  5974                 PERFORM 9900-ERROR-FORMAT
  5975                 MOVE -1             TO  EFFDTL
  5976                 MOVE AL-UABON       TO  EFFDTA
  5977               ELSE
  5978                 MOVE AL-UANON       TO  EFFDTA
  5979                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  5980                                         PI-CERT-EFF-DT
  5981           ELSE
  5982             MOVE ER-0215        TO  EMI-ERROR
  5983             PERFORM 9900-ERROR-FORMAT
  5984             MOVE -1             TO  EFFDTL
  5985             MOVE AL-UABON       TO  EFFDTA
  5986       ELSE
  5987         MOVE ER-0216            TO  EMI-ERROR
  5988         PERFORM 9900-ERROR-FORMAT
  5989         MOVE -1                 TO  EFFDTL
  5990         MOVE AL-UABOF           TO  EFFDTA.
  5991
  5992     IF ACCTI NOT = LOW-VALUES
  5993         MOVE AL-UANON           TO  ACCTA
  5994         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  5995         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  5996                                     PI-ACCOUNT
  5997     ELSE
  5998         MOVE -1                 TO  ACCTL
  5999         MOVE AL-UABON           TO  ACCTA
  6000         MOVE ER-0197            TO  EMI-ERROR
  6001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6002
  6003     IF CERTNOI NOT = LOW-VALUES
  6004         MOVE AL-UANON           TO  CERTNOA
  6005         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6006                                     PI-CERT-PRIME
  6007     ELSE
  6008         MOVE -1                 TO  CERTNOL
  6009         MOVE AL-UABON           TO  CERTNOA
  6010         MOVE ER-0203            TO  EMI-ERROR
  6011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6012
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL677.cbl
  6013     IF SFXI  = LOW-VALUES
  6014         MOVE SPACE              TO  SFXI.
  6015
  6016     MOVE AL-UANON               TO  SFXA.
  6017
  6018     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6019                                     PI-CERT-SFX.
  6020     IF SEQI = LOW-VALUES
  6021         MOVE +1                 TO  SEQI.
  6022
  6023     MOVE AL-UNNON               TO  SEQA.
  6024     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6025
  6026     IF PAYTO1AL > 0
  6027         MOVE PAYTO1AI           TO  PI-PAYTO1
  6028     ELSE
  6029         MOVE SPACES             TO  PI-PAYTO1.
  6030
  6031     IF AMOUNTL > 0
  6032
  6033* EXEC CICS BIF DEEDIT
  6034*            FIELD   (AMOUNTI)
  6035*            LENGTH  (11)
  6036*        END-EXEC
  6037     MOVE 11
  6038       TO DFHEIV11
  6039*    MOVE '@"L                   #   #00005981' TO DFHEIV0
  6040     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6041     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6042     MOVE X'2020233030303035393831' TO DFHEIV0(25:11)
  6043     CALL 'kxdfhei1' USING DFHEIV0,
  6044           AMOUNTI,
  6045           DFHEIV11
  6046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6047         MOVE AMOUNTI            TO  PI-AMOUNT
  6048     ELSE
  6049         MOVE ZEROS              TO  PI-AMOUNT.
  6050
  6051     IF TYPEL > 0
  6052         MOVE TYPEI              TO  PI-TYPE
  6053     ELSE
  6054         MOVE SPACE              TO  PI-TYPE.
  6055
  6056     IF REFL > 0
  6057         MOVE REFI               TO  PI-REFERENCE
  6058     ELSE
  6059         MOVE SPACES             TO  PI-REFERENCE.
  6060
  6061     IF EIBAID = DFHPF5
  6062        IF EMI-ERROR = ZEROS
  6063          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6064        ELSE
  6065          GO TO 1100-EDIT-COMPLETE.
  6066
  6067     IF EIBAID = DFHPF6
  6068        IF EMI-ERROR = ZEROS
  6069           GO TO 6300-BUILD-CERT-SCREEN
  6070         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL677.cbl
  6071           GO TO 1100-EDIT-COMPLETE.
  6072
  6073     IF MAINTI = 'A'
  6074        IF (PAYTO1L NOT GREATER +0) OR
  6075           (PAYTO2L NOT GREATER +0)
  6076           IF (PAYTO1I NOT EQUAL SPACES AND LOW-VALUES) OR
  6077              (PAYTO2I NOT EQUAL SPACES AND LOW-VALUES)
  6078                NEXT SENTENCE
  6079           ELSE
  6080                MOVE -1               TO  PAYTO1L
  6081                MOVE ER-2907          TO  EMI-ERROR
  6082                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6083
  6084     IF MAINTI = 'A'
  6085         IF EIBAID NOT = DFHPF4
  6086             MOVE DFHENTER       TO  EIBAID
  6087             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6088
  6089     IF MAINTI = 'S' OR 'V'
  6090         GO TO 1100-EDIT-COMPLETE.
  6091
  6092     IF OFFLINEL GREATER +0
  6093         IF OFFLINEI NOT = 'Y' AND 'N'
  6094             MOVE -1             TO  OFFLINEL
  6095             MOVE ER-2909        TO  EMI-ERROR
  6096             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6097         ELSE
  6098             IF OFFLINEI = 'Y'  AND
  6099               (CHECKI = LOW-VALUES  OR  ZEROS  OR  SPACES)
  6100                 MOVE -1         TO  CHECKL
  6101                 MOVE AL-UABON   TO  CHECKA
  6102                 MOVE ER-2438    TO  EMI-ERROR
  6103                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6104
  6105     IF PRINTEDL GREATER THAN +0
  6106         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6107         PERFORM 8700-DEEDIT
  6108         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6109             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6110             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6111             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6112             MOVE '4'                TO  DC-OPTION-CODE
  6113             PERFORM 8500-DATE-CONVERT
  6114             IF DC-ERROR-CODE NOT = SPACES
  6115                 MOVE ER-3046        TO  EMI-ERROR
  6116                 PERFORM 9900-ERROR-FORMAT
  6117                 MOVE -1             TO  PRINTEDL
  6118                 MOVE AL-UABON       TO  PRINTEDA
  6119                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6120             ELSE
  6121                 MOVE AL-UANON       TO  PRINTEDA
  6122                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6123         ELSE
  6124             MOVE ER-3046        TO  EMI-ERROR
  6125             PERFORM 9900-ERROR-FORMAT
  6126             MOVE -1             TO  PRINTEDL
  6127             MOVE AL-UABON       TO  PRINTEDA
  6128             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL677.cbl
  6129
  6130     IF PRINTEDL GREATER THAN +0
  6131         IF OFFLINEI NOT = 'Y'
  6132             MOVE -1             TO PRINTEDL
  6133             MOVE AL-UABON       TO PRINTEDA
  6134             MOVE ER-3047        TO EMI-ERROR
  6135             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6136
  6137     IF AMOUNTL = ZEROS
  6138         GO TO 1050-CK-AMT.
  6139
  6140
  6141* EXEC CICS BIF DEEDIT
  6142*        FIELD   (AMOUNTI)
  6143*        LENGTH  (11)
  6144*    END-EXEC.
  6145     MOVE 11
  6146       TO DFHEIV11
  6147*    MOVE '@"L                   #   #00006078' TO DFHEIV0
  6148     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6149     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6150     MOVE X'2020233030303036303738' TO DFHEIV0(25:11)
  6151     CALL 'kxdfhei1' USING DFHEIV0,
  6152           AMOUNTI,
  6153           DFHEIV11
  6154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6155
  6156
  6157     IF AMOUNTI NOT NUMERIC     OR
  6158        AMOUNTI LESS THAN ZERO  OR
  6159       (AMOUNTI = ZEROS  AND
  6160               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6161          MOVE ER-1159            TO  EMI-ERROR
  6162          MOVE -1                 TO  AMOUNTL
  6163          MOVE AL-UNBON           TO  AMOUNTA
  6164          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6165          GO TO 1100-EDIT-COMPLETE.
  6166
  6167     MOVE AMOUNTI                TO  WS-AM-WORK.
  6168
  6169     IF WS-AM-SIGN = SPACES
  6170         MOVE WS-AM-NUM          TO  WS-AMT
  6171         ADD 0                   TO  WS-AMT
  6172       ELSE
  6173         MOVE AMOUNTI            TO  WS-AMT
  6174         ADD 0                   TO  WS-AMT.
  6175
  6176      MOVE WS-AMT                TO  AMOUNTO.
  6177      MOVE AL-UNNON              TO  AMOUNTA.
  6178
  6179 1050-CK-AMT.
  6180     IF AMOUNTL = ZEROS AND
  6181        MAINTI  = 'A'
  6182         MOVE ER-1159            TO  EMI-ERROR
  6183         MOVE -1                 TO  AMOUNTL
  6184         MOVE AL-UNBON           TO  AMOUNTA
  6185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6186
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL677.cbl
  6187     MOVE AL-UANON              TO  TYPEA.
  6188
  6189     IF TYPEL GREATER THAN ZEROS
  6190         IF TYPEI = 'R' OR 'M' OR 'E'
  6191             NEXT SENTENCE
  6192         ELSE
  6193             MOVE ER-3044    TO  EMI-ERROR
  6194             MOVE -1         TO  TYPEL
  6195             MOVE AL-UABON   TO  TYPEA
  6196             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6197     ELSE
  6198         IF MAINTI  = 'A'
  6199             MOVE ER-3044    TO  EMI-ERROR
  6200             MOVE -1         TO  TYPEL
  6201             MOVE AL-UABON   TO  TYPEA
  6202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6203
  6204     IF  LETTER1I GREATER THAN SPACES
  6205         MOVE LETTER1I           TO ELLETR-FORM-NO
  6206         PERFORM 1220-CHECK-ON-LETTER THRU 1220-EXIT
  6207
  6208         IF  W-LETTER-NOT-FOUND
  6209             MOVE ER-7389        TO EMI-ERROR
  6210             MOVE -1             TO LETTER1L
  6211             MOVE AL-UABON       TO LETTER1A
  6212             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6213
  6214     IF  LETTER2I GREATER THAN SPACES
  6215         MOVE LETTER2I           TO ELLETR-FORM-NO
  6216         PERFORM 1220-CHECK-ON-LETTER THRU 1220-EXIT
  6217
  6218         IF  W-LETTER-NOT-FOUND
  6219             MOVE ER-7389        TO EMI-ERROR
  6220             MOVE -1             TO LETTER2L
  6221             MOVE AL-UABON       TO LETTER2A
  6222             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6223
  6224     IF  LETTER3I GREATER THAN SPACES
  6225         MOVE LETTER3I           TO ELLETR-FORM-NO
  6226         PERFORM 1220-CHECK-ON-LETTER THRU 1220-EXIT
  6227
  6228         IF  W-LETTER-NOT-FOUND
  6229             MOVE ER-7389        TO EMI-ERROR
  6230             MOVE -1             TO LETTER3L
  6231             MOVE AL-UABON       TO LETTER3A
  6232             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6233
  6234     IF  LETTER1I NOT GREATER THAN SPACES
  6235
  6236         IF  LETTER2I GREATER THAN SPACES
  6237             MOVE LETTER2I       TO LETTER1I
  6238             MOVE +4             TO LETTER1L
  6239             MOVE AL-UANON       TO LETTER1A
  6240             MOVE LETTER3I       TO LETTER2I
  6241             MOVE +4             TO LETTER2L
  6242             MOVE AL-UANON       TO LETTER2A
  6243             MOVE SPACES         TO LETTER3I
  6244
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL677.cbl
  6245         ELSE
  6246             IF  LETTER3I GREATER THAN SPACES
  6247                 MOVE LETTER3I   TO LETTER1I
  6248                 MOVE +4         TO LETTER1L
  6249                 MOVE AL-UANON   TO LETTER1A
  6250                 MOVE SPACES     TO LETTER3I
  6251                                    LETTER2I
  6252
  6253             ELSE
  6254                 NEXT SENTENCE
  6255
  6256     ELSE
  6257         IF  LETTER2I NOT GREATER THAN SPACES
  6258
  6259             IF  LETTER3I GREATER THAN SPACES
  6260                 MOVE LETTER3I   TO LETTER2I
  6261                 MOVE +4         TO LETTER2L
  6262                 MOVE AL-UANON   TO LETTER2A
  6263                 MOVE SPACES     TO LETTER3I.
  6264
  6265     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  6266         GO TO 1100-EDIT-COMPLETE.
  6267
  6268     IF DEDAMTL NOT = ZEROS
  6269
  6270* EXEC CICS BIF DEEDIT
  6271*            FIELD   (DEDAMTI)
  6272*            LENGTH  (08)
  6273*        END-EXEC
  6274     MOVE 08
  6275       TO DFHEIV11
  6276*    MOVE '@"L                   #   #00006195' TO DFHEIV0
  6277     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6278     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6279     MOVE X'2020233030303036313935' TO DFHEIV0(25:11)
  6280     CALL 'kxdfhei1' USING DFHEIV0,
  6281           DEDAMTI,
  6282           DFHEIV11
  6283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6284         MOVE DEDAMTI        TO WS-DED
  6285         MOVE WS-DED         TO DEDAMTO
  6286         MOVE AL-UNNON       TO DEDAMTA.
  6287
  6288     IF ADDLCHGL NOT = ZEROS
  6289
  6290* EXEC CICS BIF DEEDIT
  6291*            FIELD   (ADDLCHGI)
  6292*            LENGTH  (08)
  6293*        END-EXEC
  6294     MOVE 08
  6295       TO DFHEIV11
  6296*    MOVE '@"L                   #   #00006204' TO DFHEIV0
  6297     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6298     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6299     MOVE X'2020233030303036323034' TO DFHEIV0(25:11)
  6300     CALL 'kxdfhei1' USING DFHEIV0,
  6301           ADDLCHGI,
  6302           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL677.cbl
  6303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6304         MOVE ADDLCHGI       TO WS-ADDL
  6305         MOVE WS-ADDL        TO ADDLCHGO
  6306         MOVE AL-UNNON       TO ADDLCHGA.
  6307
  6308 1100-EDIT-COMPLETE.
  6309
  6310     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6311       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6312        EIBAID NOT = DFHPF4)
  6313         GO TO 8200-SEND-DATAONLY.
  6314
  6315     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6316
  6317     IF MAINTI = 'A'
  6318         GO TO 2000-ADD-RECORD.
  6319
  6320     IF MAINTI = 'C' OR 'V'
  6321         GO TO 3000-CHANGE-RECORD.
  6322
  6323     IF MAINTI = 'S'
  6324         GO TO 5000-BROWSE-FILE.
  6325
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL677.cbl
  6327
  6328 1200-VERIFY-CARRIER-ID.
  6329     MOVE SPACES                 TO ELCNTL-KEY.
  6330     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6331     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6332     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6333     MOVE +0                     TO ELCNTL-SEQ.
  6334
  6335
  6336* EXEC CICS HANDLE CONDITION
  6337*        NOTFND   (1290-NO-CARRIER)
  6338*    END-EXEC.
  6339*    MOVE '"$I                   ! $ #00006239' TO DFHEIV0
  6340     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6342     MOVE X'2420233030303036323339' TO DFHEIV0(25:11)
  6343     CALL 'kxdfhei1' USING DFHEIV0
  6344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6345
  6346
  6347
  6348* EXEC CICS READ
  6349*        DATASET   (ELCNTL-FILE-ID)
  6350*        SET       (ADDRESS OF CONTROL-FILE)
  6351*        RIDFLD    (ELCNTL-KEY)
  6352*    END-EXEC.
  6353*    MOVE '&"S        E          (   #00006243' TO DFHEIV0
  6354     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6356     MOVE X'2020233030303036323433' TO DFHEIV0(25:11)
  6357     CALL 'kxdfhei1' USING DFHEIV0,
  6358           ELCNTL-FILE-ID,
  6359           DFHEIV20,
  6360           DFHEIV99,
  6361           ELCNTL-KEY,
  6362           DFHEIV99,
  6363           DFHEIV99,
  6364           DFHEIV99
  6365     SET ADDRESS OF CONTROL-FILE TO
  6366         DFHEIV20
  6367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6368
  6369
  6370     GO TO 1200-EXIT.
  6371
  6372 1290-NO-CARRIER.
  6373     MOVE ER-2208                TO EMI-ERROR.
  6374     MOVE -1                     TO CARRIERL.
  6375     MOVE AL-UABON               TO CARRIERA.
  6376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6377
  6378 1200-EXIT.
  6379      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL677.cbl
  6381 1220-CHECK-ON-LETTER.
  6382
  6383     MOVE SPACES                 TO W-LETTER-IND.
  6384
  6385     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD.
  6386     MOVE +1                     TO ELLETR-LINE-SEQ.
  6387
  6388
  6389* EXEC CICS HANDLE CONDITION
  6390*        NOTFND   (1220-LETR-NOT-FOUND)
  6391*        ENDFILE  (1220-LETR-NOT-FOUND)
  6392*        NOTOPEN  (8035-LETR-NOT-OPEN)
  6393*    END-EXEC.
  6394*    MOVE '"$I''J                 ! % #00006267' TO DFHEIV0
  6395     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6397     MOVE X'2520233030303036323637' TO DFHEIV0(25:11)
  6398     CALL 'kxdfhei1' USING DFHEIV0
  6399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6400
  6401
  6402
  6403* EXEC CICS READ
  6404*        SET     (ADDRESS OF TEXT-FILES)
  6405*        DATASET (ELLETR-FILE-ID)
  6406*        RIDFLD  (ELLETR-KEY)
  6407*    END-EXEC.
  6408*    MOVE '&"S        E          (   #00006273' TO DFHEIV0
  6409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6411     MOVE X'2020233030303036323733' TO DFHEIV0(25:11)
  6412     CALL 'kxdfhei1' USING DFHEIV0,
  6413           ELLETR-FILE-ID,
  6414           DFHEIV20,
  6415           DFHEIV99,
  6416           ELLETR-KEY,
  6417           DFHEIV99,
  6418           DFHEIV99,
  6419           DFHEIV99
  6420     SET ADDRESS OF TEXT-FILES TO
  6421         DFHEIV20
  6422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6423
  6424
  6425     GO TO 1220-EXIT.
  6426
  6427 1220-LETR-NOT-FOUND.
  6428
  6429     MOVE 'Y'                    TO W-LETTER-IND.
  6430
  6431 1220-EXIT.
  6432      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL677.cbl
  6434
  6435 1300-VERIFY-STATE-ID.
  6436     MOVE SPACES                 TO ELCNTL-KEY.
  6437     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6438     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6439     MOVE STATEI                 TO ELCNTL-STATE.
  6440     MOVE +0                     TO ELCNTL-SEQ.
  6441
  6442
  6443* EXEC CICS HANDLE CONDITION
  6444*        NOTFND   (1380-NO-STATE)
  6445*    END-EXEC.
  6446*    MOVE '"$I                   ! & #00006296' TO DFHEIV0
  6447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6449     MOVE X'2620233030303036323936' TO DFHEIV0(25:11)
  6450     CALL 'kxdfhei1' USING DFHEIV0
  6451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6452
  6453
  6454
  6455* EXEC CICS READ
  6456*        DATASET   (ELCNTL-FILE-ID)
  6457*        SET       (ADDRESS OF CONTROL-FILE)
  6458*        RIDFLD    (ELCNTL-KEY)
  6459*    END-EXEC.
  6460*    MOVE '&"S        E          (   #00006300' TO DFHEIV0
  6461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6462     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6463     MOVE X'2020233030303036333030' TO DFHEIV0(25:11)
  6464     CALL 'kxdfhei1' USING DFHEIV0,
  6465           ELCNTL-FILE-ID,
  6466           DFHEIV20,
  6467           DFHEIV99,
  6468           ELCNTL-KEY,
  6469           DFHEIV99,
  6470           DFHEIV99,
  6471           DFHEIV99
  6472     SET ADDRESS OF CONTROL-FILE TO
  6473         DFHEIV20
  6474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6475
  6476
  6477     GO TO 1390-EXIT.
  6478
  6479 1380-NO-STATE.
  6480     MOVE ER-2209                TO EMI-ERROR.
  6481     MOVE -1                     TO STATEL.
  6482     MOVE AL-UABON               TO STATEA.
  6483     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6484
  6485 1390-EXIT.
  6486      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL677.cbl
  6488
  6489 1400-VERIFY-ACCOUNT.
  6490     IF EIBAID = DFHPF5
  6491         GO TO 1410-BUILD-ACCOUNT-KEY.
  6492
  6493     IF MAINTL GREATER +0
  6494         NEXT SENTENCE
  6495       ELSE
  6496         GO TO 1490-EXIT.
  6497
  6498     IF MAINTI = 'A' OR 'C' OR 'V'
  6499         NEXT SENTENCE
  6500       ELSE
  6501         GO TO 1490-EXIT.
  6502
  6503 1410-BUILD-ACCOUNT-KEY.
  6504     MOVE CARRIERI               TO ERACCT-CARRIER.
  6505     MOVE GROUPI                 TO ERACCT-GROUPING
  6506     MOVE STATEI                 TO ERACCT-STATE.
  6507     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6508     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6509
  6510     MOVE '2'                    TO DC-OPTION-CODE.
  6511     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6512
  6513     PERFORM 8500-DATE-CONVERT.
  6514     IF DATE-CONVERSION-ERROR
  6515        GO TO 1480-ACCOUNT-INVALID.
  6516
  6517     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6518
  6519     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6520
  6521
  6522* EXEC CICS HANDLE CONDITION
  6523*        NOTFND   (1480-ACCOUNT-INVALID)
  6524*        ENDFILE  (1480-ACCOUNT-INVALID)
  6525*    END-EXEC.
  6526*    MOVE '"$I''                  ! '' #00006350' TO DFHEIV0
  6527     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6529     MOVE X'2720233030303036333530' TO DFHEIV0(25:11)
  6530     CALL 'kxdfhei1' USING DFHEIV0
  6531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6532
  6533
  6534
  6535* EXEC CICS STARTBR
  6536*        DATASET   (ERACCT-FILE-ID)
  6537*        RIDFLD    (ERACCT-KEY)
  6538*    END-EXEC.
  6539     MOVE 0
  6540       TO DFHEIV11
  6541*    MOVE '&,         G          &   #00006355' TO DFHEIV0
  6542     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6544     MOVE X'2020233030303036333535' TO DFHEIV0(25:11)
  6545     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL677.cbl
  6546           ERACCT-FILE-ID,
  6547           ERACCT-KEY,
  6548           DFHEIV99,
  6549           DFHEIV11,
  6550           DFHEIV99
  6551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6552
  6553
  6554 1420-READNEXT-ACCOUNT-MASTER.
  6555
  6556* EXEC CICS READNEXT
  6557*        DATASET   (ERACCT-FILE-ID)
  6558*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6559*        RIDFLD    (ERACCT-KEY)
  6560*    END-EXEC.
  6561     MOVE 0
  6562       TO DFHEIV11
  6563*    MOVE '&.S                   )   #00006361' TO DFHEIV0
  6564     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6565     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6566     MOVE X'2020233030303036333631' TO DFHEIV0(25:11)
  6567     CALL 'kxdfhei1' USING DFHEIV0,
  6568           ERACCT-FILE-ID,
  6569           DFHEIV20,
  6570           DFHEIV99,
  6571           ERACCT-KEY,
  6572           DFHEIV99,
  6573           DFHEIV11,
  6574           DFHEIV99,
  6575           DFHEIV99
  6576     SET ADDRESS OF ACCOUNT-MASTER TO
  6577         DFHEIV20
  6578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6579
  6580
  6581     IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6582        SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6583        SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6584        SV-ACCT-STATE    NOT = AM-STATE        OR
  6585        SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6586          GO TO 1480-ACCOUNT-INVALID.
  6587
  6588     IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6589         GO TO 1480-ACCOUNT-INVALID.
  6590
  6591     IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6592         GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6593
  6594     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6595     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6596     MOVE AM-STATE               TO PI-CR-STATE.
  6597     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6598
  6599     MOVE AM-NAME                TO PI-AM-NAME.
  6600     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6601     MOVE AM-CITY                TO PI-AM-CITY.
  6602     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6603
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL677.cbl
  6604     MOVE +0                     TO WS-SUB.
  6605
  6606 1430-FIND-ACC-AGT.
  6607     ADD +1                      TO WS-SUB.
  6608
  6609     IF  WS-SUB GREATER +10
  6610         GO TO 1480-ACCOUNT-INVALID.
  6611
  6612     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F' OR 'S')
  6613         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6614       ELSE
  6615         GO TO 1430-FIND-ACC-AGT.
  6616
  6617     MOVE AL-UANON               TO CARRIERA
  6618                                    GROUPA
  6619                                    STATEA.
  6620
  6621     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6622
  6623     GO TO 1490-EXIT.
  6624
  6625 1480-ACCOUNT-INVALID.
  6626     MOVE -1                     TO CARRIERL
  6627     MOVE AL-UANON               TO CARRIERA
  6628                                    GROUPA
  6629                                    STATEA
  6630                                    ACCTA.
  6631     MOVE ER-2210                TO EMI-ERROR.
  6632     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6633     GO TO 8200-SEND-DATAONLY.
  6634
  6635 1490-EXIT.
  6636      EXIT.
  6637
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL677.cbl
  6639 1500-VERIFY-PENDING-BUS-REC.
  6640
  6641* EXEC CICS HANDLE CONDITION
  6642*        NOTFND   (1590-EXIT)
  6643*    END-EXEC.
  6644*    MOVE '"$I                   ! ( #00006426' TO DFHEIV0
  6645     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6647     MOVE X'2820233030303036343236' TO DFHEIV0(25:11)
  6648     CALL 'kxdfhei1' USING DFHEIV0
  6649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6650
  6651
  6652     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6653
  6654     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6655     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6656     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6657     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6658     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6659     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6660     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6661     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6662     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6663     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6664
  6665     IF ST-ACCNT-CNTL  OR
  6666        ACCNT-CNTL
  6667          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6668
  6669     IF ST-ACCNT-CNTL      OR
  6670        CARR-ST-ACCNT-CNTL OR
  6671        ACCNT-CNTL         OR
  6672        CARR-ACCNT-CNTL
  6673          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6674
  6675     IF ACCNT-CNTL OR
  6676        CARR-ACCNT-CNTL
  6677          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6678
  6679
  6680* EXEC CICS READ
  6681*         DATASET   (ERPNDB-ALT-FILE-ID)
  6682*         SET       (ADDRESS OF PENDING-BUSINESS)
  6683*         RIDFLD    (ERPNDB-ALT-KEY)
  6684*     END-EXEC.
  6685*    MOVE '&"S        E          (   #00006457' TO DFHEIV0
  6686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6688     MOVE X'2020233030303036343537' TO DFHEIV0(25:11)
  6689     CALL 'kxdfhei1' USING DFHEIV0,
  6690           ERPNDB-ALT-FILE-ID,
  6691           DFHEIV20,
  6692           DFHEIV99,
  6693           ERPNDB-ALT-KEY,
  6694           DFHEIV99,
  6695           DFHEIV99,
  6696           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL677.cbl
  6697     SET ADDRESS OF PENDING-BUSINESS TO
  6698         DFHEIV20
  6699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6700
  6701
  6702     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6703
  6704     IF PB-C-PAYEE-CODE GREATER SPACES
  6705        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6706
  6707     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6708     MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6709
  6710     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6711     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6712
  6713     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6714         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6715     ELSE
  6716         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6717
  6718     IF MAINTI = 'A' OR 'C'
  6719       IF PB-C-REFUND-CREATED
  6720           MOVE -1               TO  MAINTL
  6721           MOVE ER-3445          TO  EMI-ERROR
  6722           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6723
  6724 1590-EXIT.
  6725      EXIT.
  6726
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL677.cbl
  6728 2000-ADD-RECORD.
  6729
  6730* EXEC CICS GETMAIN
  6731*        SET      (ADDRESS OF CHECK-RECORDS)
  6732*        LENGTH   (600)
  6733*        INITIMG  (GETMAIN-SPACE)
  6734*    END-EXEC.
  6735     MOVE 600
  6736       TO DFHEIV11
  6737*    MOVE ',"IL                  $   #00006490' TO DFHEIV0
  6738     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6739     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6740     MOVE X'2020233030303036343930' TO DFHEIV0(25:11)
  6741     CALL 'kxdfhei1' USING DFHEIV0,
  6742           DFHEIV20,
  6743           DFHEIV11,
  6744           GETMAIN-SPACE
  6745     SET ADDRESS OF CHECK-RECORDS TO
  6746         DFHEIV20
  6747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6748
  6749
  6750     MOVE 'CH'                   TO CH-RECORD-ID.
  6751     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6752     MOVE CARRIERI               TO CH-CARRIER.
  6753     MOVE GROUPI                 TO CH-GROUPING.
  6754     MOVE STATEI                 TO CH-STATE.
  6755     MOVE ACCTI                  TO CH-ACCOUNT.
  6756
  6757     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6758     MOVE '2'                    TO DC-OPTION-CODE.
  6759     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6760     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6761
  6762     MOVE CERTNOI                TO CH-CERT-PRIME.
  6763     MOVE SFXI                   TO CH-CERT-SFX.
  6764
  6765     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6766
  6767     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY.
  6768     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6769
  6770     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6771     MOVE '5'                    TO DC-OPTION-CODE.
  6772     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6773     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT.
  6774
  6775     MOVE 'N'                    TO CH-OFFLINE-CHECK-IND.
  6776
  6777     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6778                                    CH-VOID-DT
  6779                                    CH-CREDIT-ACCEPT-DT
  6780                                    CH-CANC-DT.
  6781     MOVE ZEROS                  TO CH-LF-REFUND
  6782                                    CH-AH-REFUND
  6783                                    CH-DEDUCT-WITHHELD
  6784                                    CH-ADDITIONAL-CHARGE.
  6785
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL677.cbl
  6786     PERFORM 4000-ADD-CHANGE THRU 4090-EXIT.
  6787
  6788     IF PI-COMPANY-ID = 'LAP'  OR  'RMC'
  6789         COMPUTE WS-AMT-PAID = CH-LF-REFUND + CH-AH-REFUND
  6790         IF CH-AMOUNT-PAID = WS-AMT-PAID
  6791             COMPUTE WS-AMT-PAID = CH-LF-REFUND + CH-AH-REFUND
  6792                                           - CH-DEDUCT-WITHHELD
  6793             IF WS-AMT-PAID GREATER THAN ZERO
  6794                 MOVE WS-AMT-PAID    TO CH-AMOUNT-PAID
  6795                                        AMOUNTO
  6796             ELSE
  6797                 MOVE ZEROS          TO CH-AMOUNT-PAID
  6798                                        AMOUNTO.
  6799
  6800     IF PI-COMPANY-ID = 'LAP'  OR  'RMC'
  6801         IF CH-AMOUNT-PAID = ZEROS
  6802             MOVE 'DEDUCT '          TO CH-CHECK-NO
  6803                                        CHECKO
  6804             MOVE 'Y'                TO CH-OFFLINE-CHECK-IND
  6805                                        OFFLINEO.
  6806
  6807     IF PI-COMPANY-ID = 'LAP'  OR  'RMC'
  6808         IF CH-MAINT-CHECK  AND
  6809            CH-CERT-PRIME = 'AGENTCREDT'
  6810             COMPUTE CH-AH-REFUND = CH-AMOUNT-PAID +
  6811                                    CH-DEDUCT-WITHHELD +
  6812                                    CH-ADDITIONAL-CHARGE.
  6813
  6814     IF MANUAL-CHECK-WRITTEN
  6815       IF CH-CHECK-WRITTEN-DT = LOW-VALUES
  6816           MOVE CH-RECORDED-DT       TO  CH-CHECK-WRITTEN-DT
  6817           MOVE DC-GREG-DATE-1-EDIT  TO  PRINTEDI.
  6818
  6819     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6820       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6821        EIBAID NOT = DFHPF4)
  6822         GO TO 8200-SEND-DATAONLY.
  6823
  6824     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6825     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6826     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6827     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6828     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6829
  6830
  6831 2100-WRITE-RECORD.
  6832
  6833* EXEC CICS HANDLE CONDITION
  6834*        DUPREC (2200-DUPREC)
  6835*    END-EXEC.
  6836*    MOVE '"$%                   ! ) #00006578' TO DFHEIV0
  6837     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6839     MOVE X'2920233030303036353738' TO DFHEIV0(25:11)
  6840     CALL 'kxdfhei1' USING DFHEIV0
  6841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6842
  6843
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL677.cbl
  6844     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  6845     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  6846                                    CH-CHECK-QUE-SEQUENCE.
  6847
  6848
  6849* EXEC CICS WRITE
  6850*        DATASET  (ERCHEK-FILE-ID)
  6851*        FROM     (CHECK-RECORDS)
  6852*        RIDFLD   (CH-CONTROL-PRIMARY)
  6853*    END-EXEC.
  6854     MOVE LENGTH OF
  6855      CHECK-RECORDS
  6856       TO DFHEIV11
  6857*    MOVE '&$ L                  ''   #00006586' TO DFHEIV0
  6858     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6859     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6860     MOVE X'2020233030303036353836' TO DFHEIV0(25:11)
  6861     CALL 'kxdfhei1' USING DFHEIV0,
  6862           ERCHEK-FILE-ID,
  6863           CHECK-RECORDS,
  6864           DFHEIV11,
  6865           CH-CONTROL-PRIMARY,
  6866           DFHEIV99,
  6867           DFHEIV99
  6868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6869
  6870
  6871     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  6872             ERCHEK-RECORD-LENGTH + 23.
  6873
  6874     PERFORM 6200-UPDATE-PENDING-BUS-REC THRU 6290-EXIT.
  6875
  6876     PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
  6877
  6878     IF EMI-NO-ERRORS
  6879         MOVE ER-0000            TO EMI-ERROR
  6880     ELSE
  6881         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  6882            EIBAID = DFHPF4
  6883             MOVE ER-2600        TO EMI-ERROR.
  6884
  6885     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6886
  6887     MOVE LOW-VALUES             TO EL677AI.
  6888
  6889     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  6890     MOVE PI-CHEK-GROUPING       TO GROUPO.
  6891     MOVE PI-CHEK-STATE          TO STATEO.
  6892     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  6893
  6894     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  6895     MOVE SPACE                  TO DC-OPTION-CODE.
  6896     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6897     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  6898
  6899     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  6900     MOVE PI-CHEK-SUF-NO         TO SFXO.
  6901     MOVE PI-CHEK-SEQUENCE       TO SEQO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL677.cbl
  6902
  6903     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  6904                                    ACCTA     EFFDTA  CERTNOA
  6905                                    SFXA.
  6906     MOVE AL-UNNON               TO SEQA.
  6907     GO TO 8100-SEND-INITIAL-MAP.
  6908
  6909 2200-DUPREC.
  6910     ADD +1 TO CH-SEQUENCE-NO.
  6911     MOVE CH-SEQUENCE-NO         TO SEQO
  6912                                    PI-CHEK-SEQUENCE
  6913                                    CHEK-RECORD-SEQ.
  6914     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL677.cbl
  6916
  6917 2500-WRITE-PAY-ADJ.
  6918
  6919     PERFORM 2600-READ-CONTROL-FILE THRU 2690-EXIT.
  6920
  6921     IF CH-AMOUNT-PAID = ZEROS
  6922         GO TO 2510-CONTINUE.
  6923
  6924     IF CR-CHECK-NO-AUTO-SEQ
  6925         IF CR-CHECK-CNT-RESET-VALUE
  6926             MOVE +1             TO CF-CR-CHECK-COUNTER
  6927         ELSE
  6928             ADD +1              TO CF-CR-CHECK-COUNTER.
  6929
  6930     IF CR-CHECK-NO-MANUAL
  6931         IF CHECKL = ZEROS
  6932             MOVE ER-2438        TO EMI-ERROR
  6933             MOVE -1             TO CHECKL
  6934             MOVE AL-UNBON       TO CHECKA
  6935             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6936             GO TO 8200-SEND-DATAONLY.
  6937
  6938     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  6939     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  6940
  6941 2510-CONTINUE.
  6942
  6943     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  6944         GO TO 2580-HANDLE-ELCNTL-FILE.
  6945
  6946     IF CH-DEDUCT-WITHHELD = ZEROS
  6947         GO TO 2515-CONTINUE.
  6948
  6949     IF CH-AMOUNT-PAID = ZEROS
  6950         PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT
  6951     ELSE
  6952         ADD +1  TO  PY-FILE-SEQ-NO.
  6953
  6954     MOVE CH-DEDUCT-WITHHELD     TO PY-ENTRY-AMT.
  6955     MOVE WS-PY-DED-COMMENT      TO PY-ENTRY-COMMENT.
  6956     MOVE SPACES                 TO PY-CHECK-NUMBER.
  6957
  6958     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  6959
  6960 2515-CONTINUE.
  6961
  6962     IF CH-ADDITIONAL-CHARGE = ZEROS
  6963         GO TO 2580-HANDLE-ELCNTL-FILE.
  6964
  6965     IF CH-AMOUNT-PAID = ZEROS  AND
  6966        CH-DEDUCT-WITHHELD = ZEROS
  6967         PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT
  6968     ELSE
  6969         ADD +1  TO  PY-FILE-SEQ-NO.
  6970
  6971     MOVE CH-ADDITIONAL-CHARGE   TO PY-ENTRY-AMT.
  6972     MOVE WS-PY-ADDL-COMMENT     TO PY-ENTRY-COMMENT.
  6973     MOVE SPACES                 TO PY-CHECK-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL677.cbl
  6974
  6975     GO TO 2570-WRITE-ERPYAJ-RECORD.
  6976
  6977 2550-BUILD-ERPYAJ-RECORD.
  6978
  6979
  6980* EXEC CICS GETMAIN
  6981*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  6982*        LENGTH  (200)
  6983*        INITIMG (GETMAIN-SPACE)
  6984*    END-EXEC.
  6985     MOVE 200
  6986       TO DFHEIV11
  6987*    MOVE ',"IL                  $   #00006700' TO DFHEIV0
  6988     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6989     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6990     MOVE X'2020233030303036373030' TO DFHEIV0(25:11)
  6991     CALL 'kxdfhei1' USING DFHEIV0,
  6992           DFHEIV20,
  6993           DFHEIV11,
  6994           GETMAIN-SPACE
  6995     SET ADDRESS OF PENDING-PAY-ADJ TO
  6996         DFHEIV20
  6997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6998
  6999
  7000     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7001     MOVE 'PY'                   TO PY-RECORD-ID.
  7002     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7003
  7004     MOVE CARRIERI               TO PY-CARRIER.
  7005     IF PI-ZERO-CARRIER  OR
  7006        PI-ZERO-CAR-GROUP
  7007         MOVE ZERO               TO PY-CARRIER.
  7008
  7009     MOVE GROUPI                 TO PY-GROUPING.
  7010     IF PI-ZERO-GROUPING  OR
  7011        PI-ZERO-CAR-GROUP
  7012         MOVE ZERO               TO PY-GROUPING.
  7013
  7014     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7015     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7016     MOVE 'C'                    TO PY-RECORD-TYPE.
  7017     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7018
  7019     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
  7020                                    WS-PY-REF-DATE
  7021                                    WS-PY-END-DATE
  7022                                    WS-PY-DED-DATE
  7023                                    WS-PY-ADDL-DATE.
  7024     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7025     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7026                                    WS-PY-REF-CERT
  7027                                    WS-PY-END-CERT
  7028                                    WS-PY-DED-CERT
  7029                                    WS-PY-ADDL-CERT
  7030                                    WS-TMS-PY-CERT.
  7031     IF SFXI NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL677.cbl
  7032         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7033                                    WS-PY-REF-SUFFIX
  7034                                    WS-PY-END-SUFFIX
  7035                                    WS-PY-DED-SUFFIX
  7036                                    WS-PY-ADDL-SUFFIX
  7037     ELSE
  7038         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7039                                    WS-PY-REF-SUFFIX
  7040                                    WS-PY-END-SUFFIX
  7041                                    WS-PY-DED-SUFFIX
  7042                                    WS-PY-ADDL-SUFFIX.
  7043
  7044     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7045         MOVE WS-TMS-ENTRY-COMMENT
  7046                                 TO PY-ENTRY-COMMENT
  7047     ELSE
  7048         IF TYPEI EQUAL 'R'
  7049             MOVE WS-PY-REF-COMMENT
  7050                                 TO PY-ENTRY-COMMENT
  7051         ELSE
  7052             IF TYPEI EQUAL 'E'
  7053                 MOVE WS-PY-END-COMMENT
  7054                                 TO PY-ENTRY-COMMENT
  7055             ELSE
  7056                 MOVE WS-PY-ENTRY-COMMENT
  7057                                 TO PY-ENTRY-COMMENT.
  7058
  7059     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7060
  7061     IF CR-CHECK-NO-AUTO-SEQ  OR
  7062        CR-CHECK-NO-MANUAL  OR
  7063        MANUAL-CHECK-WRITTEN
  7064         MOVE CH-CHECK-NO        TO WS-CHECK-WORK
  7065         MOVE WS-CHECK-NO        TO PY-CHECK-NUMBER.
  7066
  7067     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7068     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7069     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7070                                    PY-INPUT-DT.
  7071     MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7072                                    PY-CHECK-QUE-SEQUENCE.
  7073     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7074                                    PY-REPORTED-DT
  7075                                    PY-CHECK-WRITTEN-DT
  7076                                    PY-BILLED-DATE
  7077                                    PY-AR-DATE
  7078                                    PY-GL-DATE.
  7079     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7080     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7081     MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7082
  7083     IF PI-AR-PROCESSING
  7084         MOVE 'B'                TO PY-PYMT-TYPE
  7085         MOVE 'A'                TO PY-PMT-APPLIED.
  7086
  7087 2559-BUILD-EXIT.
  7088     EXIT.
  7089
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL677.cbl
  7090 2570-WRITE-ERPYAJ-RECORD.
  7091
  7092
  7093* EXEC CICS HANDLE CONDITION
  7094*        DUPREC (2577-DUPREC)
  7095*    END-EXEC.
  7096*    MOVE '"$%                   ! * #00006798' TO DFHEIV0
  7097     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7099     MOVE X'2A20233030303036373938' TO DFHEIV0(25:11)
  7100     CALL 'kxdfhei1' USING DFHEIV0
  7101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7102
  7103
  7104
  7105* EXEC CICS WRITE
  7106*        DATASET (ERPYAJ-FILE-ID)
  7107*        FROM    (PENDING-PAY-ADJ)
  7108*        RIDFLD  (PY-CONTROL-PRIMARY)
  7109*    END-EXEC.
  7110     MOVE LENGTH OF
  7111      PENDING-PAY-ADJ
  7112       TO DFHEIV11
  7113*    MOVE '&$ L                  ''   #00006802' TO DFHEIV0
  7114     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7115     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7116     MOVE X'2020233030303036383032' TO DFHEIV0(25:11)
  7117     CALL 'kxdfhei1' USING DFHEIV0,
  7118           ERPYAJ-FILE-ID,
  7119           PENDING-PAY-ADJ,
  7120           DFHEIV11,
  7121           PY-CONTROL-PRIMARY,
  7122           DFHEIV99,
  7123           DFHEIV99
  7124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7125
  7126
  7127     GO TO 2579-WRITE-EXIT.
  7128
  7129 2577-DUPREC.
  7130     ADD +1 TO PY-FILE-SEQ-NO.
  7131
  7132     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7133
  7134 2579-WRITE-EXIT.
  7135     EXIT.
  7136
  7137 2580-HANDLE-ELCNTL-FILE.
  7138
  7139     IF CR-CHECK-NO-AUTO-SEQ
  7140         PERFORM 2700-REWRITE-CONTROL-FILE THRU 2790-EXIT
  7141     ELSE
  7142
  7143* EXEC CICS UNLOCK
  7144*            DATASET (ELCNTL-FILE-ID)
  7145*        END-EXEC.
  7146*    MOVE '&*                    #   #00006823' TO DFHEIV0
  7147     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL677.cbl
  7148     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7149     MOVE X'2020233030303036383233' TO DFHEIV0(25:11)
  7150     CALL 'kxdfhei1' USING DFHEIV0,
  7151           ELCNTL-FILE-ID,
  7152           DFHEIV99
  7153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7154
  7155
  7156 2590-EXIT.
  7157      EXIT.
  7158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL677.cbl
  7160
  7161 2600-READ-CONTROL-FILE.
  7162     MOVE SPACES                 TO ELCNTL-KEY.
  7163     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7164     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7165     MOVE +0                     TO ELCNTL-SEQ.
  7166
  7167
  7168* EXEC CICS HANDLE CONDITION
  7169*        NOTFND   (2680-NO-CO-MASTER)
  7170*    END-EXEC.
  7171*    MOVE '"$I                   ! + #00006838' TO DFHEIV0
  7172     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7174     MOVE X'2B20233030303036383338' TO DFHEIV0(25:11)
  7175     CALL 'kxdfhei1' USING DFHEIV0
  7176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7177
  7178
  7179
  7180* EXEC CICS READ
  7181*        DATASET   (ELCNTL-FILE-ID)
  7182*        SET       (ADDRESS OF CONTROL-FILE)
  7183*        RIDFLD    (ELCNTL-KEY)
  7184*    END-EXEC.
  7185*    MOVE '&"S        E          (   #00006842' TO DFHEIV0
  7186     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7188     MOVE X'2020233030303036383432' TO DFHEIV0(25:11)
  7189     CALL 'kxdfhei1' USING DFHEIV0,
  7190           ELCNTL-FILE-ID,
  7191           DFHEIV20,
  7192           DFHEIV99,
  7193           ELCNTL-KEY,
  7194           DFHEIV99,
  7195           DFHEIV99,
  7196           DFHEIV99
  7197     SET ADDRESS OF CONTROL-FILE TO
  7198         DFHEIV20
  7199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7200
  7201
  7202     GO TO 2690-EXIT.
  7203
  7204 2680-NO-CO-MASTER.
  7205     MOVE ER-0022                TO  EMI-ERROR.
  7206     MOVE -1                     TO  CARRIERL.
  7207     MOVE AL-UABON               TO  CARRIERA.
  7208     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7209
  7210 2690-EXIT.
  7211      EXIT.
  7212
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL677.cbl
  7214 2700-REWRITE-CONTROL-FILE.
  7215
  7216* EXEC CICS READ
  7217*        DATASET   (ELCNTL-FILE-ID)
  7218*        SET       (ADDRESS OF CONTROL-FILE)
  7219*        RIDFLD    (ELCNTL-KEY)
  7220*        UPDATE
  7221*    END-EXEC.
  7222*    MOVE '&"S        EU         (   #00006861' TO DFHEIV0
  7223     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7224     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7225     MOVE X'2020233030303036383631' TO DFHEIV0(25:11)
  7226     CALL 'kxdfhei1' USING DFHEIV0,
  7227           ELCNTL-FILE-ID,
  7228           DFHEIV20,
  7229           DFHEIV99,
  7230           ELCNTL-KEY,
  7231           DFHEIV99,
  7232           DFHEIV99,
  7233           DFHEIV99
  7234     SET ADDRESS OF CONTROL-FILE TO
  7235         DFHEIV20
  7236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7237
  7238
  7239
  7240* EXEC CICS REWRITE
  7241*         DATASET (ELCNTL-FILE-ID)
  7242*         FROM    (CONTROL-FILE)
  7243*     END-EXEC.
  7244     MOVE LENGTH OF
  7245      CONTROL-FILE
  7246       TO DFHEIV11
  7247*    MOVE '&& L                  %   #00006868' TO DFHEIV0
  7248     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7249     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7250     MOVE X'2020233030303036383638' TO DFHEIV0(25:11)
  7251     CALL 'kxdfhei1' USING DFHEIV0,
  7252           ELCNTL-FILE-ID,
  7253           CONTROL-FILE,
  7254           DFHEIV11,
  7255           DFHEIV99
  7256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7257
  7258
  7259 2790-EXIT.
  7260      EXIT.
  7261
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL677.cbl
  7263 3000-CHANGE-RECORD.
  7264
  7265* EXEC CICS HANDLE CONDITION
  7266*        NOTFND (3900-RECORD-NOTFND)
  7267*    END-EXEC.
  7268*    MOVE '"$I                   ! , #00006878' TO DFHEIV0
  7269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7271     MOVE X'2C20233030303036383738' TO DFHEIV0(25:11)
  7272     CALL 'kxdfhei1' USING DFHEIV0
  7273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7274
  7275
  7276
  7277* EXEC CICS READ
  7278*        DATASET  (ERCHEK-FILE-ID)
  7279*        SET      (ADDRESS OF CHECK-RECORDS)
  7280*        RIDFLD   (PI-ERCHEK-KEY)
  7281*        UPDATE
  7282*    END-EXEC.
  7283*    MOVE '&"S        EU         (   #00006882' TO DFHEIV0
  7284     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7285     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7286     MOVE X'2020233030303036383832' TO DFHEIV0(25:11)
  7287     CALL 'kxdfhei1' USING DFHEIV0,
  7288           ERCHEK-FILE-ID,
  7289           DFHEIV20,
  7290           DFHEIV99,
  7291           PI-ERCHEK-KEY,
  7292           DFHEIV99,
  7293           DFHEIV99,
  7294           DFHEIV99
  7295     SET ADDRESS OF CHECK-RECORDS TO
  7296         DFHEIV20
  7297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7298
  7299
  7300     IF CH-LF-REFUND NOT NUMERIC
  7301         MOVE ZEROS              TO CH-LF-REFUND.
  7302     IF CH-AH-REFUND NOT NUMERIC
  7303         MOVE ZEROS              TO CH-AH-REFUND.
  7304     IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7305         MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7306     IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7307         MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7308
  7309     IF VREASONL NOT = ZEROS
  7310         MOVE VREASONI           TO  CH-VOID-REASON.
  7311
  7312     IF MAINTI = 'V'
  7313         GO TO 3100-REWRITE-RECORD.
  7314
  7315     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7316
  7317     PERFORM 4000-ADD-CHANGE THRU 4090-EXIT.
  7318
  7319     IF MANUAL-CHECK-WRITTEN
  7320       IF CH-CHECK-WRITTEN-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL677.cbl
  7321           MOVE EIBDATE              TO DC-JULIAN-YYDDD
  7322           MOVE '5'                  TO DC-OPTION-CODE
  7323           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7324           MOVE DC-BIN-DATE-1        TO  CH-CHECK-WRITTEN-DT
  7325           MOVE DC-GREG-DATE-1-EDIT  TO  PRINTEDI.
  7326
  7327     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7328       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7329        EIBAID NOT = DFHPF4)
  7330         GO TO 8200-SEND-DATAONLY.
  7331
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL677.cbl
  7333
  7334 3100-REWRITE-RECORD.
  7335     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7336
  7337     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7338     MOVE '5'                    TO DC-OPTION-CODE.
  7339     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7340
  7341     IF MAINTI = 'C'
  7342       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7343       IF MANUAL-CHECK-WRITTEN
  7344           PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7345
  7346     IF MAINTI = 'V'
  7347        IF CH-VOID-DT = LOW-VALUES
  7348           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7349           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7350           PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7351           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7352           PERFORM 6200-UPDATE-PENDING-BUS-REC THRU 6290-EXIT
  7353        ELSE
  7354           MOVE -1               TO MAINTL
  7355           MOVE ER-2583          TO EMI-ERROR
  7356           MOVE AL-UABON         TO MAINTA
  7357           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7358           GO TO 8200-SEND-DATAONLY.
  7359
  7360     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7361
  7362
  7363* EXEC CICS REWRITE
  7364*        DATASET  (ERCHEK-FILE-ID)
  7365*        FROM     (CHECK-RECORDS)
  7366*    END-EXEC.
  7367     MOVE LENGTH OF
  7368      CHECK-RECORDS
  7369       TO DFHEIV11
  7370*    MOVE '&& L                  %   #00006951' TO DFHEIV0
  7371     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7372     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7373     MOVE X'2020233030303036393531' TO DFHEIV0(25:11)
  7374     CALL 'kxdfhei1' USING DFHEIV0,
  7375           ERCHEK-FILE-ID,
  7376           CHECK-RECORDS,
  7377           DFHEIV11,
  7378           DFHEIV99
  7379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7380
  7381
  7382     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7383        (MAINTI EQUAL 'C')          AND
  7384        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7385            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7386
  7387     IF EMI-NO-ERRORS
  7388         MOVE ER-0000            TO EMI-ERROR
  7389     ELSE
  7390         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL677.cbl
  7391            EIBAID = DFHPF4
  7392             MOVE ER-2600        TO EMI-ERROR.
  7393
  7394     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7395
  7396     MOVE LOW-VALUES             TO EL677AI.
  7397
  7398     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7399     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7400     MOVE PI-CHEK-STATE          TO STATEO.
  7401     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7402
  7403     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7404     MOVE SPACE                  TO DC-OPTION-CODE.
  7405     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7406     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7407
  7408     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7409     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7410     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7411
  7412     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7413                                    OFFLINEA  ACCTA   EFFDTA
  7414                                    CERTNOA   SFXA.
  7415
  7416     MOVE AL-UNNON               TO SEQA.
  7417     GO TO 8100-SEND-INITIAL-MAP.
  7418
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL677.cbl
  7420 3200-PAY-ADJS-REVERSAL.
  7421
  7422     IF CH-AMOUNT-PAID NOT = ZEROS
  7423         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7424         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7425
  7426     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7427         GO TO 3290-EXIT.
  7428
  7429     IF CH-DEDUCT-WITHHELD = ZEROS
  7430         GO TO 3210-CONTINUE.
  7431
  7432     IF CH-AMOUNT-PAID = ZEROS
  7433         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7434     ELSE
  7435         ADD +1  TO  PY-FILE-SEQ-NO.
  7436
  7437     COMPUTE PY-ENTRY-AMT = CH-DEDUCT-WITHHELD * (-1).
  7438
  7439     MOVE ' VOID DEDUCT '        TO WS-PY-REVERSAL-TYPE.
  7440     MOVE WS-PY-REVERSAL-COMMENT TO PY-ENTRY-COMMENT.
  7441     MOVE SPACES                 TO PY-CHECK-NUMBER.
  7442
  7443     PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7444
  7445 3210-CONTINUE.
  7446
  7447     IF CH-ADDITIONAL-CHARGE = ZEROS
  7448         GO TO 3290-EXIT.
  7449
  7450     IF CH-AMOUNT-PAID = ZEROS  AND
  7451        CH-DEDUCT-WITHHELD = ZEROS
  7452         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7453     ELSE
  7454         ADD +1  TO  PY-FILE-SEQ-NO.
  7455
  7456     COMPUTE PY-ENTRY-AMT = CH-ADDITIONAL-CHARGE * (-1).
  7457
  7458     MOVE ' VOID ADDCHG '        TO WS-PY-REVERSAL-TYPE.
  7459     MOVE WS-PY-REVERSAL-COMMENT TO PY-ENTRY-COMMENT.
  7460     MOVE SPACES                 TO PY-CHECK-NUMBER.
  7461
  7462     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7463
  7464 3250-BUILD-ERPYAJ-REVERSAL.
  7465
  7466
  7467* EXEC CICS GETMAIN
  7468*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7469*        LENGTH  (200)
  7470*        INITIMG (GETMAIN-SPACE)
  7471*    END-EXEC.
  7472     MOVE 200
  7473       TO DFHEIV11
  7474*    MOVE ',"IL                  $   #00007040' TO DFHEIV0
  7475     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7476     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7477     MOVE X'2020233030303037303430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL677.cbl
  7478     CALL 'kxdfhei1' USING DFHEIV0,
  7479           DFHEIV20,
  7480           DFHEIV11,
  7481           GETMAIN-SPACE
  7482     SET ADDRESS OF PENDING-PAY-ADJ TO
  7483         DFHEIV20
  7484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7485
  7486
  7487     MOVE 'PY'                   TO PY-RECORD-ID.
  7488     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7489
  7490     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7491     IF PI-ZERO-CARRIER  OR
  7492        PI-ZERO-CAR-GROUP
  7493         MOVE ZERO               TO PY-CARRIER.
  7494
  7495     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7496     IF PI-ZERO-GROUPING  OR
  7497        PI-ZERO-CAR-GROUP
  7498         MOVE ZERO               TO PY-GROUPING.
  7499
  7500     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7501     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7502     MOVE 'C'                    TO PY-RECORD-TYPE.
  7503     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7504
  7505     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-REVERSAL-DATE.
  7506     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7507     MOVE CERTNOI                TO WS-PY-REVERSAL-CERT
  7508                                    WS-TMS-PY-CERT.
  7509     IF SFXI NOT = LOW-VALUES
  7510         MOVE SFXI               TO WS-PY-REVERSAL-SUFFIX
  7511     ELSE
  7512         MOVE SPACE              TO WS-PY-REVERSAL-SUFFIX.
  7513
  7514     IF PI-COMPANY-ID EQUAL 'LGX' OR 'TMS'
  7515         MOVE WS-TMS-ENTRY-COMMENT   TO PY-ENTRY-COMMENT
  7516     ELSE
  7517         IF CH-MAINT-CHECK
  7518             MOVE ' VOID MISC.  '    TO WS-PY-REVERSAL-TYPE
  7519             MOVE WS-PY-REVERSAL-COMMENT TO PY-ENTRY-COMMENT
  7520         ELSE
  7521             MOVE ' VOID REFUND '    TO WS-PY-REVERSAL-TYPE
  7522             MOVE WS-PY-REVERSAL-COMMENT TO PY-ENTRY-COMMENT.
  7523
  7524     COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7525
  7526     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7527     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7528
  7529     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7530     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7531     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7532                                    PY-INPUT-DT.
  7533     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7534                                    PY-CHECK-QUE-SEQUENCE.
  7535     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL677.cbl
  7536                                    PY-BILLED-DATE
  7537                                    PY-REPORTED-DT
  7538                                    PY-CHECK-WRITTEN-DT
  7539                                    PY-AR-DATE
  7540                                    PY-GL-DATE.
  7541     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7542     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7543     MOVE 'V'                    TO PY-VOID-SW.
  7544     MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7545
  7546     IF PI-AR-PROCESSING
  7547         MOVE 'B'                TO PY-PYMT-TYPE
  7548         MOVE 'A'                TO PY-PMT-APPLIED.
  7549
  7550 3259-BUILD-EXIT.
  7551     EXIT.
  7552
  7553 3280-WRITE-ERPYAJ-REVERSAL.
  7554
  7555
  7556* EXEC CICS HANDLE CONDITION
  7557*        DUPREC (3287-DUPREC)
  7558*    END-EXEC.
  7559*    MOVE '"$%                   ! - #00007114' TO DFHEIV0
  7560     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7562     MOVE X'2D20233030303037313134' TO DFHEIV0(25:11)
  7563     CALL 'kxdfhei1' USING DFHEIV0
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7565
  7566
  7567
  7568* EXEC CICS WRITE
  7569*        DATASET (ERPYAJ-FILE-ID)
  7570*        FROM    (PENDING-PAY-ADJ)
  7571*        RIDFLD  (PY-CONTROL-PRIMARY)
  7572*    END-EXEC.
  7573     MOVE LENGTH OF
  7574      PENDING-PAY-ADJ
  7575       TO DFHEIV11
  7576*    MOVE '&$ L                  ''   #00007118' TO DFHEIV0
  7577     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7578     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7579     MOVE X'2020233030303037313138' TO DFHEIV0(25:11)
  7580     CALL 'kxdfhei1' USING DFHEIV0,
  7581           ERPYAJ-FILE-ID,
  7582           PENDING-PAY-ADJ,
  7583           DFHEIV11,
  7584           PY-CONTROL-PRIMARY,
  7585           DFHEIV99,
  7586           DFHEIV99
  7587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7588
  7589
  7590     GO TO 3289-WRITE-EXIT.
  7591
  7592 3287-DUPREC.
  7593     ADD +1 TO PY-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL677.cbl
  7594
  7595     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7596
  7597 3289-WRITE-EXIT.
  7598     EXIT.
  7599
  7600 3290-EXIT.
  7601      EXIT.
  7602
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL677.cbl
  7604 3300-UPDATE-ERPYAJ.
  7605
  7606
  7607* EXEC CICS GETMAIN
  7608*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7609*        LENGTH  (200)
  7610*        INITIMG (GETMAIN-SPACE)
  7611*    END-EXEC.
  7612     MOVE 200
  7613       TO DFHEIV11
  7614*    MOVE ',"IL                  $   #00007140' TO DFHEIV0
  7615     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7616     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7617     MOVE X'2020233030303037313430' TO DFHEIV0(25:11)
  7618     CALL 'kxdfhei1' USING DFHEIV0,
  7619           DFHEIV20,
  7620           DFHEIV11,
  7621           GETMAIN-SPACE
  7622     SET ADDRESS OF PENDING-PAY-ADJ TO
  7623         DFHEIV20
  7624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7625
  7626
  7627     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7628     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7629     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7630     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7631     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7632     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7633     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7634
  7635
  7636* EXEC CICS HANDLE CONDITION
  7637*        NOTFND   (3390-EXIT)
  7638*        ENDFILE  (3390-EXIT)
  7639*    END-EXEC.
  7640*    MOVE '"$I''                  ! . #00007154' TO DFHEIV0
  7641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7643     MOVE X'2E20233030303037313534' TO DFHEIV0(25:11)
  7644     CALL 'kxdfhei1' USING DFHEIV0
  7645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7646
  7647
  7648 3320-READNEXT-ERPYAJ.
  7649
  7650
  7651* EXEC CICS READ
  7652*        DATASET  (ERPYAJ-FILE-ID)
  7653*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7654*        RIDFLD   (ERPYAJ-KEY)
  7655*        GTEQ
  7656*    END-EXEC.
  7657*    MOVE '&"S        G          (   #00007161' TO DFHEIV0
  7658     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7659     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7660     MOVE X'2020233030303037313631' TO DFHEIV0(25:11)
  7661     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL677.cbl
  7662           ERPYAJ-FILE-ID,
  7663           DFHEIV20,
  7664           DFHEIV99,
  7665           ERPYAJ-KEY,
  7666           DFHEIV99,
  7667           DFHEIV99,
  7668           DFHEIV99
  7669     SET ADDRESS OF PENDING-PAY-ADJ TO
  7670         DFHEIV20
  7671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7672
  7673
  7674     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7675
  7676     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7677        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7678        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7679        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7680        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7681        (PY-RECORD-TYPE   NOT = 'C')
  7682          GO TO 3390-EXIT.
  7683
  7684     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7685         ADD +1 TO PYAJ-FILE-SEQ-NO
  7686         GO TO 3320-READNEXT-ERPYAJ.
  7687
  7688
  7689* EXEC CICS READ UPDATE
  7690*        DATASET   (ERPYAJ-FILE-ID)
  7691*        RIDFLD    (ERPYAJ-KEY)
  7692*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7693*    END-EXEC.
  7694*    MOVE '&"S        EU         (   #00007182' TO DFHEIV0
  7695     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7696     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7697     MOVE X'2020233030303037313832' TO DFHEIV0(25:11)
  7698     CALL 'kxdfhei1' USING DFHEIV0,
  7699           ERPYAJ-FILE-ID,
  7700           DFHEIV20,
  7701           DFHEIV99,
  7702           ERPYAJ-KEY,
  7703           DFHEIV99,
  7704           DFHEIV99,
  7705           DFHEIV99
  7706     SET ADDRESS OF PENDING-PAY-ADJ TO
  7707         DFHEIV20
  7708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7709
  7710
  7711     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7712     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7713
  7714     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7715
  7716     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7717     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7718     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7719
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL677.cbl
  7720
  7721* EXEC CICS REWRITE
  7722*        DATASET  (ERPYAJ-FILE-ID)
  7723*        FROM     (PENDING-PAY-ADJ)
  7724*    END-EXEC.
  7725     MOVE LENGTH OF
  7726      PENDING-PAY-ADJ
  7727       TO DFHEIV11
  7728*    MOVE '&& L                  %   #00007197' TO DFHEIV0
  7729     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7730     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7731     MOVE X'2020233030303037313937' TO DFHEIV0(25:11)
  7732     CALL 'kxdfhei1' USING DFHEIV0,
  7733           ERPYAJ-FILE-ID,
  7734           PENDING-PAY-ADJ,
  7735           DFHEIV11,
  7736           DFHEIV99
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7738
  7739
  7740 3390-EXIT.
  7741      EXIT.
  7742
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL677.cbl
  7744 3700-UPDATE-ERCHKQ.
  7745     MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  7746     MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  7747     MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  7748
  7749
  7750* EXEC CICS HANDLE CONDITION
  7751*        NOTFND (3780-CHECK-NOTFND)
  7752*    END-EXEC.
  7753*    MOVE '"$I                   ! / #00007211' TO DFHEIV0
  7754     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7756     MOVE X'2F20233030303037323131' TO DFHEIV0(25:11)
  7757     CALL 'kxdfhei1' USING DFHEIV0
  7758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7759
  7760
  7761
  7762* EXEC CICS READ
  7763*        DATASET  (ERCHKQ-FILE-ID)
  7764*        SET      (ADDRESS OF CHECK-QUE)
  7765*        RIDFLD   (ERCHKQ-KEY)
  7766*        UPDATE
  7767*    END-EXEC.
  7768*    MOVE '&"S        EU         (   #00007215' TO DFHEIV0
  7769     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7770     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7771     MOVE X'2020233030303037323135' TO DFHEIV0(25:11)
  7772     CALL 'kxdfhei1' USING DFHEIV0,
  7773           ERCHKQ-FILE-ID,
  7774           DFHEIV20,
  7775           DFHEIV99,
  7776           ERCHKQ-KEY,
  7777           DFHEIV99,
  7778           DFHEIV99,
  7779           DFHEIV99
  7780     SET ADDRESS OF CHECK-QUE TO
  7781         DFHEIV20
  7782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7783
  7784
  7785     IF MAINTI = 'C'
  7786         IF MANUAL-CHECK-WRITTEN
  7787             MOVE 'M'                 TO CQ-ENTRY-TYPE
  7788             MOVE +1                  TO CQ-TIMES-PRINTED
  7789             MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  7790             MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  7791             MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  7792
  7793     IF MAINTI = 'V'
  7794         MOVE 'V'                TO CQ-ENTRY-TYPE
  7795                                    CQ-VOID-INDICATOR
  7796         MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  7797
  7798     MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  7799
  7800
  7801* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL677.cbl
  7802*        DATASET  (ERCHKQ-FILE-ID)
  7803*        FROM     (CHECK-QUE)
  7804*    END-EXEC.
  7805     MOVE LENGTH OF
  7806      CHECK-QUE
  7807       TO DFHEIV11
  7808*    MOVE '&& L                  %   #00007237' TO DFHEIV0
  7809     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7810     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7811     MOVE X'2020233030303037323337' TO DFHEIV0(25:11)
  7812     CALL 'kxdfhei1' USING DFHEIV0,
  7813           ERCHKQ-FILE-ID,
  7814           CHECK-QUE,
  7815           DFHEIV11,
  7816           DFHEIV99
  7817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7818
  7819
  7820     GO TO 3790-EXIT.
  7821
  7822 3780-CHECK-NOTFND.
  7823     MOVE ER-2905                TO EMI-ERROR.
  7824     MOVE -1                     TO CARRIERL
  7825     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7826                                    ACCTA     EFFDTA  CERTNOA
  7827                                    SFXA      SEQA.
  7828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7829
  7830 3790-EXIT.
  7831      EXIT.
  7832
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL677.cbl
  7834
  7835 3900-RECORD-NOTFND.
  7836     MOVE ER-2908                TO EMI-ERROR.
  7837     MOVE -1                     TO CARRIERL
  7838     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7839                                    ACCTA     EFFDTA  CERTNOA
  7840                                    SFXA      SEQA.
  7841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7842     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL677.cbl
  7844 4000-ADD-CHANGE.
  7845     IF PAYTO1AL NOT = ZEROS
  7846         IF PI-COMPANY-ID = 'TMS'
  7847             MOVE PAYTO1AI       TO CH-LIENHOLDER-NAME
  7848         ELSE
  7849             MOVE PAYTO1AI       TO CH-PAYEE-NAME-1.
  7850
  7851     IF PAYTO1L NOT = ZEROS
  7852         MOVE PAYTO1I            TO CH-PAYEE-NAME-2.
  7853
  7854     IF PAYTO2L NOT = ZEROS
  7855         MOVE PAYTO2I            TO CH-PAYEE-ADDRESS-1.
  7856
  7857     IF PAYTO3L NOT = ZEROS
  7858         MOVE PAYTO3I            TO CH-PAYEE-ADDRESS-2.
  7859
  7860     IF PAYTO4L NOT = ZEROS
  7861         MOVE PAYTO4I            TO CH-PAYEE-CITY-ST.
  7862
  7863     IF PAYEEI GREATER SPACES
  7864        MOVE PAYEEI              TO CH-PAYEE-CODE.
  7865
  7866     IF PTOZIPL  =  ZEROS
  7867         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  7868         GO TO 4050-CK-REST.
  7869
  7870     MOVE PTOZIPI                TO WS-ZIP-CODE.
  7871
  7872     IF NOT WS-CANADIAN-POST-CODE
  7873         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  7874         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  7875         GO TO 4050-CK-REST.
  7876
  7877     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  7878     IF WS-CAN-POST-4TH = SPACE OR '-'
  7879         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  7880         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  7881     ELSE
  7882         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  7883         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  7884
  7885 4050-CK-REST.
  7886
  7887     IF OFFLINEL NOT = ZEROS
  7888         MOVE OFFLINEI           TO  CH-OFFLINE-CHECK-IND.
  7889
  7890     IF PRINTEDL NOT = ZEROS
  7891       IF CH-OFFLINE-CHECK-IND = 'Y'
  7892           MOVE WS-CHK-PRINT-DT  TO CH-CHECK-WRITTEN-DT.
  7893
  7894     IF AMOUNTL NOT = ZEROS
  7895         MOVE WS-AMT             TO CH-AMOUNT-PAID
  7896         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  7897
  7898     IF CHECKL NOT = ZEROS
  7899         MOVE CHECKI             TO CH-CHECK-NO.
  7900
  7901     IF REASONL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL677.cbl
  7902         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  7903
  7904     IF DEDAMTL NOT = ZEROS
  7905         MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  7906                                    DEDAMTO.
  7907
  7908     IF ADDLCHGL NOT = ZEROS
  7909         MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  7910                                    ADDLCHGO.
  7911
  7912     IF STUB1L NOT = ZEROS
  7913         MOVE STUB1I             TO CH-STUB-LINE-1.
  7914
  7915     IF STUB2L NOT = ZEROS
  7916         MOVE STUB2I             TO CH-STUB-LINE-2.
  7917
  7918     IF STUB3L NOT = ZEROS
  7919         MOVE STUB3I             TO CH-STUB-LINE-3.
  7920
  7921     IF STUB4L NOT = ZEROS
  7922         MOVE STUB4I             TO CH-STUB-LINE-4.
  7923
  7924     IF TYPEL NOT = ZEROS
  7925         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  7926
  7927     MOVE LETTER1I               TO CH-LETTERS (1).
  7928     MOVE LETTER2I               TO CH-LETTERS (2).
  7929     MOVE LETTER3I               TO CH-LETTERS (3).
  7930
  7931     MOVE SPACES                 TO CH-CHECK-REFERENCE.
  7932     IF CH-CHECK-ORIGIN-SW = 'R'
  7933         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  7934         MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
  7935         MOVE PI-CANC-DT             TO CH-CANC-DT
  7936         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  7937         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  7938         MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  7939
  7940     IF PI-AR-PROCESSING AND
  7941        REFL NOT = ZERO
  7942         MOVE REFI                   TO CH-CHECK-REFERENCE.
  7943
  7944 4090-EXIT.
  7945      EXIT.
  7946
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL677.cbl
  7948
  7949 5000-BROWSE-FILE.
  7950
  7951* EXEC CICS HANDLE CONDITION
  7952*        NOTFND   (5900-END-OF-FILE)
  7953*        ENDFILE  (5900-END-OF-FILE)
  7954*    END-EXEC.
  7955*    MOVE '"$I''                  ! 0 #00007372' TO DFHEIV0
  7956     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7958     MOVE X'3020233030303037333732' TO DFHEIV0(25:11)
  7959     CALL 'kxdfhei1' USING DFHEIV0
  7960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7961
  7962
  7963     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  7964
  7965     IF SEQI = LOW-VALUES
  7966         MOVE +1                 TO CHEK-RECORD-SEQ.
  7967
  7968     IF EIBAID = DFHPF2
  7969         GO TO 5100-BROWSE-BKWD.
  7970
  7971 5010-READ-LOOP.
  7972     IF EIBAID = DFHPF1
  7973         ADD +1                  TO CHEK-RECORD-SEQ.
  7974
  7975
  7976* EXEC CICS READ
  7977*        DATASET  (ERCHEK-FILE-ID)
  7978*        SET      (ADDRESS OF CHECK-RECORDS)
  7979*        RIDFLD   (ERCHEK-KEY)
  7980*        GTEQ
  7981*    END-EXEC.
  7982*    MOVE '&"S        G          (   #00007389' TO DFHEIV0
  7983     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7985     MOVE X'2020233030303037333839' TO DFHEIV0(25:11)
  7986     CALL 'kxdfhei1' USING DFHEIV0,
  7987           ERCHEK-FILE-ID,
  7988           DFHEIV20,
  7989           DFHEIV99,
  7990           ERCHEK-KEY,
  7991           DFHEIV99,
  7992           DFHEIV99,
  7993           DFHEIV99
  7994     SET ADDRESS OF CHECK-RECORDS TO
  7995         DFHEIV20
  7996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7997
  7998
  7999     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8000         IF EIBAID = DFHENTER
  8001             GO TO 5800-NO-RECORD
  8002         ELSE
  8003             GO TO 5900-END-OF-FILE.
  8004
  8005     IF PI-TO-EL677-FROM-EL1273
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL677.cbl
  8006        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8007           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8008           PI-CHEK-STATE      = CH-STATE       AND
  8009           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8010           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8011           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8012           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8013              GO TO 5500-FORMAT-SCREEN
  8014            ELSE
  8015              IF EIBAID = DFHPF1
  8016                  GO TO 5900-END-OF-FILE
  8017                ELSE
  8018                  GO TO 5800-NO-RECORD.
  8019
  8020     IF EIBAID = DFHENTER
  8021        IF CHEK-CARRIER    = CH-CARRIER     AND
  8022           CHEK-GROUPING   = CH-GROUPING    AND
  8023           CHEK-STATE      = CH-STATE       AND
  8024           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8025           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8026           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8027           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8028           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8029              GO TO 5500-FORMAT-SCREEN
  8030        ELSE
  8031              GO TO 5800-NO-RECORD.
  8032
  8033     GO TO 5500-FORMAT-SCREEN.
  8034
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL677.cbl
  8036
  8037 5100-BROWSE-BKWD.
  8038
  8039* EXEC CICS STARTBR
  8040*        DATASET  (ERCHEK-FILE-ID)
  8041*        RIDFLD   (ERCHEK-KEY)
  8042*    END-EXEC.
  8043     MOVE 0
  8044       TO DFHEIV11
  8045*    MOVE '&,         G          &   #00007435' TO DFHEIV0
  8046     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8047     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8048     MOVE X'2020233030303037343335' TO DFHEIV0(25:11)
  8049     CALL 'kxdfhei1' USING DFHEIV0,
  8050           ERCHEK-FILE-ID,
  8051           ERCHEK-KEY,
  8052           DFHEIV99,
  8053           DFHEIV11,
  8054           DFHEIV99
  8055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8056
  8057
  8058
  8059* EXEC CICS READPREV
  8060*        DATASET  (ERCHEK-FILE-ID)
  8061*        SET      (ADDRESS OF CHECK-RECORDS)
  8062*        RIDFLD   (ERCHEK-KEY)
  8063*    END-EXEC.
  8064     MOVE 0
  8065       TO DFHEIV11
  8066*    MOVE '&0S                   )   #00007440' TO DFHEIV0
  8067     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8068     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8069     MOVE X'2020233030303037343430' TO DFHEIV0(25:11)
  8070     CALL 'kxdfhei1' USING DFHEIV0,
  8071           ERCHEK-FILE-ID,
  8072           DFHEIV20,
  8073           DFHEIV99,
  8074           ERCHEK-KEY,
  8075           DFHEIV99,
  8076           DFHEIV11,
  8077           DFHEIV99,
  8078           DFHEIV99
  8079     SET ADDRESS OF CHECK-RECORDS TO
  8080         DFHEIV20
  8081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8082
  8083
  8084 5110-READ-LOOP.
  8085     IF PI-FILE-EOF
  8086         MOVE SPACE              TO PI-EOF-SW
  8087     ELSE
  8088
  8089* EXEC CICS READPREV
  8090*            DATASET  (ERCHEK-FILE-ID)
  8091*            SET      (ADDRESS OF CHECK-RECORDS)
  8092*            RIDFLD   (ERCHEK-KEY)
  8093*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL677.cbl
  8094     MOVE 0
  8095       TO DFHEIV11
  8096*    MOVE '&0S                   )   #00007450' TO DFHEIV0
  8097     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8098     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8099     MOVE X'2020233030303037343530' TO DFHEIV0(25:11)
  8100     CALL 'kxdfhei1' USING DFHEIV0,
  8101           ERCHEK-FILE-ID,
  8102           DFHEIV20,
  8103           DFHEIV99,
  8104           ERCHEK-KEY,
  8105           DFHEIV99,
  8106           DFHEIV11,
  8107           DFHEIV99,
  8108           DFHEIV99
  8109     SET ADDRESS OF CHECK-RECORDS TO
  8110         DFHEIV20
  8111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8112
  8113
  8114     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8115         GO TO 5900-END-OF-FILE.
  8116
  8117     IF PI-TO-EL677-FROM-EL1273
  8118        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8119           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8120           PI-CHEK-STATE      = CH-STATE       AND
  8121           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8122           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8123           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8124           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8125              GO TO 5500-FORMAT-SCREEN
  8126            ELSE
  8127              GO TO 5900-END-OF-FILE.
  8128
  8129     GO TO 5500-FORMAT-SCREEN.
  8130
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL677.cbl
  8132*                          COPY ELCNPD.
  8133*****************************************************************
  8134*                                                               *
  8135*                                                               *
  8136*                            ELCNPD                             *
  8137*                            VMOD=2.001                         *
  8138*****************************************************************
  8139
  8140 5200-MOVE-NAME.
  8141*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8142*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8143*            BLANKS.                                            *
  8144*                                                               *
  8145*                  FIELD               VALUE                    *
  8146*                                                               *
  8147*                LAST NAME (CL15)      SMITH                    *
  8148*                1ST NAME  (CL12)      JOHN                     *
  8149*                MID NAME  (CL1)       A                        *
  8150*                                                               *
  8151*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8152*         *                                                     *
  8153*         *              JOHN A. SMITH                          *
  8154*         *                                                     *
  8155*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8156*         *  STORAGE COPYBOOK:                                  *
  8157*         *                                                     *
  8158*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8159*         *******************************************************.
  8160
  8161     MOVE SPACES                 TO  WS-NAME-WORK
  8162                                     WS-NAME-WORK2.
  8163     MOVE ZERO                   TO  WS-NAME-SW.
  8164     SET NWA-INDEX TO +1.
  8165
  8166     IF WS-INSURED-1ST-NAME = SPACES  AND
  8167        WS-INSURED-MID-INIT = SPACES
  8168         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8169         GO TO 5200-EXIT.
  8170
  8171     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8172     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8173
  8174     SET NWA-INDEX UP BY +1
  8175     IF WS-INSURED-MID-INIT NOT = SPACES
  8176        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8177        SET NWA-INDEX UP BY +1
  8178        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8179        SET NWA-INDEX UP BY +2.
  8180
  8181     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8182     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8183
  8184
  8185 5200-EXIT.
  8186     EXIT.
  8187
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL677.cbl
  8189 5300-MOVE-NAME SECTION.
  8190     IF WS-NAME-SW GREATER THAN +1
  8191         GO TO 5390-EXIT.
  8192
  8193     IF WS-NAME-WORK2 = SPACES
  8194         GO TO 5390-EXIT.
  8195
  8196     SET NWA-INDEX2 TO +1.
  8197     SET NWA-INDEX3 TO +2.
  8198
  8199 5310-MOVE-NAME.
  8200     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8201
  8202     IF NWA-INDEX LESS THAN +30
  8203        SET NWA-INDEX UP BY +1
  8204     ELSE
  8205        ADD +2  TO  WS-NAME-SW
  8206        GO TO 5390-EXIT.
  8207
  8208     IF NWA-INDEX2 LESS THAN +20
  8209         SET NWA-INDEX2 UP BY +1
  8210         SET NWA-INDEX3 UP BY +1.
  8211
  8212     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8213        WS-NW2 (NWA-INDEX3) = SPACES
  8214        GO TO 5390-EXIT.
  8215
  8216     GO TO 5310-MOVE-NAME.
  8217
  8218 5390-EXIT.
  8219     EXIT.
  8220
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL677.cbl
  8223 5500-FORMAT-SCREEN.
  8224     MOVE LOW-VALUES             TO  EL677AI.
  8225     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8226     MOVE +1                     TO  MAINTL.
  8227     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8228     MOVE CH-CARRIER             TO  CARRIERO.
  8229     MOVE CH-GROUPING            TO  GROUPO.
  8230     MOVE CH-STATE               TO  STATEO.
  8231     MOVE CH-ACCOUNT             TO  ACCTO.
  8232
  8233     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8234     MOVE SPACE                  TO  DC-OPTION-CODE.
  8235     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8236     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8237
  8238     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8239     MOVE CH-CERT-SFX            TO  SFXO.
  8240     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8241
  8242     MOVE AL-UANON               TO  CARRIERA
  8243                                     GROUPA
  8244                                     STATEA
  8245                                     ACCTA
  8246                                     EFFDTA
  8247                                     CERTNOA
  8248                                     SFXA.
  8249     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8250
  8251     IF PI-COMPANY-ID = 'TMS'
  8252         MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8253         MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8254     ELSE
  8255         MOVE CH-PAYEE-NAME-1    TO  PAYTO1AO
  8256         MOVE CH-PAYEE-NAME-2    TO  PAYTO1O.
  8257
  8258     MOVE CH-PAYEE-ADDRESS-1     TO  PAYTO2O.
  8259     MOVE CH-PAYEE-ADDRESS-2     TO  PAYTO3O.
  8260     MOVE CH-PAYEE-CITY-ST       TO  PAYTO4O.
  8261     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8262
  8263     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8264         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8265         MOVE AL-UANON           TO  PTOZIPA.
  8266
  8267     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8268     MOVE SPACE                  TO  DC-OPTION-CODE.
  8269     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8270     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8271
  8272     MOVE CH-RECORDED-BY         TO  CBYO.
  8273
  8274     IF MANUAL-CHECK-WRITTEN
  8275        MOVE 'Y'                 TO  OFFLINEO
  8276      ELSE
  8277        MOVE 'N'                 TO  OFFLINEO.
  8278
  8279     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8280         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL677.cbl
  8281     ELSE
  8282         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8283         MOVE SPACE                  TO  DC-OPTION-CODE
  8284         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8285         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8286         MOVE CH-VOID-BY             TO  VBYO.
  8287
  8288     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8289         NEXT SENTENCE
  8290     ELSE
  8291         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8292         MOVE SPACE                  TO  DC-OPTION-CODE
  8293         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8294         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8295
  8296     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8297     MOVE AL-SANOF               TO  AMOUNTA.
  8298     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8299     MOVE AL-SANOF               TO  TYPEA.
  8300     MOVE CH-CHECK-NO            TO  CHECKO.
  8301     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8302     MOVE CH-VOID-REASON         TO  VREASONO.
  8303
  8304     IF PI-AR-PROCESSING
  8305         MOVE CH-CHECK-REFERENCE
  8306                                 TO  REFO.
  8307
  8308     MOVE CH-STUB-LINE-1         TO  STUB1O.
  8309     MOVE CH-STUB-LINE-2         TO  STUB2O.
  8310     MOVE CH-STUB-LINE-3         TO  STUB3O.
  8311     MOVE CH-STUB-LINE-4         TO  STUB4O.
  8312
  8313     IF  CH-LETTERS (1) GREATER THAN SPACES
  8314         MOVE CH-LETTERS (1)     TO LETTER1O
  8315
  8316     ELSE
  8317         MOVE SPACES             TO LETTER1O.
  8318
  8319     IF  CH-LETTERS (2) GREATER THAN SPACES
  8320         MOVE CH-LETTERS (2)     TO LETTER2O
  8321
  8322     ELSE
  8323         MOVE SPACES             TO LETTER2O.
  8324
  8325     IF  CH-LETTERS (3) GREATER THAN SPACES
  8326         MOVE CH-LETTERS (3)     TO LETTER3O
  8327
  8328     ELSE
  8329         MOVE SPACES             TO LETTER3O.
  8330
  8331
  8332     IF CH-LF-REFUND NOT NUMERIC
  8333         MOVE ZEROS              TO CH-LF-REFUND.
  8334     IF CH-AH-REFUND NOT NUMERIC
  8335         MOVE ZEROS              TO CH-AH-REFUND.
  8336     IF CH-DEDUCT-WITHHELD NOT NUMERIC
  8337         MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  8338     IF CH-ADDITIONAL-CHARGE NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL677.cbl
  8339         MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  8340
  8341     MOVE CH-DEDUCT-WITHHELD     TO  DEDAMTO.
  8342     MOVE AL-SANOF               TO  DEDAMTA.
  8343     MOVE CH-ADDITIONAL-CHARGE   TO  ADDLCHGO.
  8344     MOVE AL-SANOF               TO  ADDLCHGA.
  8345
  8346     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
  8347        CH-VOID-DT          GREATER LOW-VALUES
  8348        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8349                                     STUB1A    STUB2A   STUB3A
  8350                                     STUB4A    PAYTO1A  SFXA
  8351                                     PAYTO2A   PAYTO3A  PAYTO4A
  8352                                     OFFLINEA  PTOZIPA  PAYTO1AA
  8353                                     LETTER1A  LETTER2A LETTER3A
  8354                                     PRINTEDA
  8355     ELSE
  8356        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8357                                     ACCTA     EFFDTA   CERTNOA
  8358                                     CHECKA    REASONA  VREASONA
  8359                                     STUB1A    STUB2A   STUB3A
  8360                                     STUB4A    PAYTO1A  SFXA
  8361                                     PAYTO2A   PAYTO3A  PAYTO4A
  8362                                     LETTER1A  LETTER2A LETTER3A
  8363                                     OFFLINEA  PAYTO1AA PRINTEDA.
  8364
  8365     MOVE AL-UNNON               TO SEQA.
  8366
  8367     GO TO 8100-SEND-INITIAL-MAP.
  8368
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL677.cbl
  8370
  8371 5800-NO-RECORD.
  8372     MOVE ER-1162                TO  EMI-ERROR.
  8373     MOVE -1                     TO  CARRIERL.
  8374     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8375                                     ACCTA     EFFDTA  CERTNOA
  8376                                     SFXA      SEQA.
  8377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8378
  8379     IF NOT PI-TO-EL677-FROM-EL1273
  8380         GO TO 8200-SEND-DATAONLY.
  8381
  8382     MOVE CHEK-CARRIER           TO  CARRIERO.
  8383     MOVE CHEK-GROUPING          TO  GROUPO.
  8384     MOVE CHEK-STATE             TO  STATEO.
  8385     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8386
  8387     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8388     MOVE SPACE                  TO  DC-OPTION-CODE.
  8389     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8390     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8391
  8392     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8393     MOVE CHEK-SUF-NO            TO  SFXO.
  8394     GO TO 8100-SEND-INITIAL-MAP.
  8395
  8396 5900-END-OF-FILE.
  8397     IF EIBAID = DFHPF1
  8398         MOVE 'Y'                TO  PI-EOF-SW
  8399         MOVE ER-2237            TO  EMI-ERROR
  8400     ELSE
  8401     IF EIBAID = DFHENTER
  8402        GO TO 5800-NO-RECORD
  8403     ELSE
  8404         MOVE SPACES             TO  PI-ERCHEK-KEY
  8405         MOVE ER-2238            TO  EMI-ERROR.
  8406
  8407     MOVE -1                     TO  MAINTL.
  8408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8409     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL677.cbl
  8411
  8412 6000-VERIFY-COMP-MASTER.
  8413
  8414* EXEC CICS HANDLE CONDITION
  8415*        NOTFND   (6070-NO-COMP-MSTR)
  8416*    END-EXEC.
  8417*    MOVE '"$I                   ! 1 #00007755' TO DFHEIV0
  8418     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8420     MOVE X'3120233030303037373535' TO DFHEIV0(25:11)
  8421     CALL 'kxdfhei1' USING DFHEIV0
  8422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8423
  8424
  8425     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  8426
  8427     IF NOT PI-ZERO-CARRIER AND
  8428        NOT PI-ZERO-CAR-GROUP
  8429         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  8430     ELSE
  8431         MOVE ZEROS              TO  ERCOMP-CARRIER.
  8432
  8433     IF NOT PI-ZERO-GROUPING  AND
  8434        NOT PI-ZERO-CAR-GROUP
  8435         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  8436     ELSE
  8437         MOVE ZEROS              TO  ERCOMP-GROUPING.
  8438
  8439     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  8440     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  8441     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  8442
  8443
  8444* EXEC CICS READ
  8445*         DATASET   (ERCOMP-FILE-ID)
  8446*         SET       (ADDRESS OF COMPENSATION-MASTER)
  8447*         RIDFLD    (ERCOMP-KEY)
  8448*     END-EXEC.
  8449*    MOVE '&"S        E          (   #00007777' TO DFHEIV0
  8450     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8452     MOVE X'2020233030303037373737' TO DFHEIV0(25:11)
  8453     CALL 'kxdfhei1' USING DFHEIV0,
  8454           ERCOMP-FILE-ID,
  8455           DFHEIV20,
  8456           DFHEIV99,
  8457           ERCOMP-KEY,
  8458           DFHEIV99,
  8459           DFHEIV99,
  8460           DFHEIV99
  8461     SET ADDRESS OF COMPENSATION-MASTER TO
  8462         DFHEIV20
  8463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8464
  8465
  8466     GO TO 6090-EXIT.
  8467
  8468 6070-NO-COMP-MSTR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL677.cbl
  8469     MOVE -1                     TO  CARRIERL.
  8470     MOVE ER-2230                TO  EMI-ERROR.
  8471     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8472     GO TO 8200-SEND-DATAONLY.
  8473
  8474 6090-EXIT.
  8475      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL677.cbl
  8477 6100-VERIFY-CERTIFICATE.
  8478
  8479* EXEC CICS HANDLE CONDITION
  8480*        NOTFND   (6170-NO-CERTIFICATE)
  8481*    END-EXEC.
  8482*    MOVE '"$I                   ! 2 #00007795' TO DFHEIV0
  8483     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8485     MOVE X'3220233030303037373935' TO DFHEIV0(25:11)
  8486     CALL 'kxdfhei1' USING DFHEIV0
  8487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8488
  8489
  8490     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8491     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8492     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  8493     MOVE PI-STATE               TO  ELCERT-STATE.
  8494     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8495     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8496     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8497     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8498
  8499     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8500
  8501     MOVE SPACES                 TO  PI-REFERENCE
  8502                                     PI-INSURED-NAME.
  8503     MOVE LOW-VALUES             TO  PI-CANC-DT.
  8504     MOVE ZEROS                  TO  PI-LF-REFUND
  8505                                     PI-AH-REFUND.
  8506
  8507
  8508* EXEC CICS READ
  8509*         DATASET   (ELCERT-FILE-ID)
  8510*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8511*         RIDFLD    (ELCERT-KEY)
  8512*     END-EXEC.
  8513*    MOVE '&"S        E          (   #00007816' TO DFHEIV0
  8514     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8516     MOVE X'2020233030303037383136' TO DFHEIV0(25:11)
  8517     CALL 'kxdfhei1' USING DFHEIV0,
  8518           ELCERT-FILE-ID,
  8519           DFHEIV20,
  8520           DFHEIV99,
  8521           ELCERT-KEY,
  8522           DFHEIV99,
  8523           DFHEIV99,
  8524           DFHEIV99
  8525     SET ADDRESS OF CERTIFICATE-MASTER TO
  8526         DFHEIV20
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8528
  8529
  8530     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  8531
  8532     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  8533     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  8534     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL677.cbl
  8535         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  8536     ELSE
  8537         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  8538             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  8539     MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  8540
  8541     GO TO 6190-EXIT.
  8542
  8543 6170-NO-CERTIFICATE.
  8544     MOVE -1                     TO  CARRIERL.
  8545     MOVE ER-2726                TO  EMI-ERROR.
  8546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8547
  8548 6190-EXIT.
  8549      EXIT.
  8550
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL677.cbl
  8552 6200-UPDATE-PENDING-BUS-REC.
  8553
  8554* EXEC CICS HANDLE CONDITION
  8555*        NOTFND   (6290-EXIT)
  8556*    END-EXEC.
  8557*    MOVE '"$I                   ! 3 #00007845' TO DFHEIV0
  8558     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8560     MOVE X'3320233030303037383435' TO DFHEIV0(25:11)
  8561     CALL 'kxdfhei1' USING DFHEIV0
  8562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8563
  8564
  8565     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  8566     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  8567     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  8568     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  8569     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  8570     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  8571     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  8572     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  8573     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  8574     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  8575
  8576     IF ST-ACCNT-CNTL  OR
  8577        ACCNT-CNTL
  8578          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  8579
  8580     IF ST-ACCNT-CNTL      OR
  8581        CARR-ST-ACCNT-CNTL OR
  8582        ACCNT-CNTL         OR
  8583        CARR-ACCNT-CNTL
  8584          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  8585
  8586     IF ACCNT-CNTL OR
  8587        CARR-ACCNT-CNTL
  8588          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  8589
  8590
  8591* EXEC CICS READ
  8592*         DATASET   (ERPNDB-ALT-FILE-ID)
  8593*         SET       (ADDRESS OF PENDING-BUSINESS)
  8594*         RIDFLD    (ERPNDB-ALT-KEY)
  8595*     END-EXEC.
  8596*    MOVE '&"S        E          (   #00007874' TO DFHEIV0
  8597     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8599     MOVE X'2020233030303037383734' TO DFHEIV0(25:11)
  8600     CALL 'kxdfhei1' USING DFHEIV0,
  8601           ERPNDB-ALT-FILE-ID,
  8602           DFHEIV20,
  8603           DFHEIV99,
  8604           ERPNDB-ALT-KEY,
  8605           DFHEIV99,
  8606           DFHEIV99,
  8607           DFHEIV99
  8608     SET ADDRESS OF PENDING-BUSINESS TO
  8609         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL677.cbl
  8610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8611
  8612
  8613     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  8614
  8615
  8616* EXEC CICS READ
  8617*         DATASET   (ERPNDB-FILE-ID)
  8618*         SET       (ADDRESS OF PENDING-BUSINESS)
  8619*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  8620*         UPDATE
  8621*     END-EXEC.
  8622*    MOVE '&"S        EU         (   #00007882' TO DFHEIV0
  8623     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8624     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8625     MOVE X'2020233030303037383832' TO DFHEIV0(25:11)
  8626     CALL 'kxdfhei1' USING DFHEIV0,
  8627           ERPNDB-FILE-ID,
  8628           DFHEIV20,
  8629           DFHEIV99,
  8630           ERPNDB-PRIMARY-KEY,
  8631           DFHEIV99,
  8632           DFHEIV99,
  8633           DFHEIV99
  8634     SET ADDRESS OF PENDING-BUSINESS TO
  8635         DFHEIV20
  8636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8637
  8638
  8639     MOVE 'Y'                    TO  PB-C-REFUND-SW.
  8640
  8641*    IF MAINTI = 'V'
  8642*       MOVE SPACE               TO  PB-C-REFUND-SW
  8643*    ELSE
  8644*       MOVE 'Y'                 TO  PB-C-REFUND-SW.
  8645
  8646
  8647* EXEC CICS REWRITE
  8648*        DATASET  (ERPNDB-FILE-ID)
  8649*        FROM     (PENDING-BUSINESS)
  8650*    END-EXEC.
  8651     MOVE LENGTH OF
  8652      PENDING-BUSINESS
  8653       TO DFHEIV11
  8654*    MOVE '&& L                  %   #00007896' TO DFHEIV0
  8655     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8656     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8657     MOVE X'2020233030303037383936' TO DFHEIV0(25:11)
  8658     CALL 'kxdfhei1' USING DFHEIV0,
  8659           ERPNDB-FILE-ID,
  8660           PENDING-BUSINESS,
  8661           DFHEIV11,
  8662           DFHEIV99
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8664
  8665
  8666 6290-EXIT.
  8667      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL677.cbl
  8668
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL677.cbl
  8670 6300-BUILD-CERT-SCREEN.
  8671     MOVE LOW-VALUES             TO  EL677AI.
  8672     MOVE 'A'                    TO  MAINTI.
  8673     MOVE AL-UANON               TO  MAINTA.
  8674     MOVE +1                     TO  MAINTL.
  8675
  8676     MOVE PI-CARRIER             TO  CARRIERO.
  8677     MOVE PI-GROUPING            TO  GROUPO.
  8678     MOVE PI-STATE               TO  STATEO.
  8679     MOVE PI-ACCOUNT             TO  ACCTO.
  8680     MOVE PI-CERT-PRIME          TO  CERTNOO.
  8681     MOVE PI-CERT-SFX            TO  SFXO.
  8682     MOVE PI-AMOUNT              TO  AMOUNTO.
  8683     MOVE PI-TYPE                TO  TYPEO.
  8684     MOVE PI-REFERENCE           TO  REFO.
  8685     MOVE PI-PAYTO1              TO  PAYTO1AO.
  8686     MOVE AL-UANON               TO  CARRIERA
  8687                                     GROUPA
  8688                                     STATEA
  8689                                     ACCTA
  8690                                     CERTNOA
  8691                                     SFXA
  8692                                     PAYTO1A
  8693                                     PAYTO1AA
  8694                                     AMOUNTA
  8695                                     TYPEA.
  8696     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8697     MOVE ' '                    TO  DC-OPTION-CODE.
  8698     PERFORM 8500-DATE-CONVERT.
  8699
  8700     IF NO-CONVERSION-ERROR
  8701         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  8702         MOVE AL-UANON            TO  EFFDTA
  8703         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  8704         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  8705     ELSE
  8706         GO TO 8200-SEND-DATAONLY.
  8707
  8708     IF WS-CERT-NOT-FOUND
  8709         GO TO 8100-SEND-INITIAL-MAP.
  8710
  8711     IF WS-PNDB-FOUND
  8712         COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  8713                                    PB-C-AH-CANCEL-AMT
  8714         MOVE 'R'                TO  TYPEO
  8715         IF PI-AR-PROCESSING
  8716             MOVE AL-UANON       TO  REFA
  8717             MOVE PB-C-REFERENCE TO  REFO
  8718         END-IF
  8719     ELSE
  8720         COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  8721                                    CM-AH-ITD-CANCEL-AMT.
  8722
  8723     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  8724     MOVE 'R'                     TO  TYPEO.
  8725
  8726     IF CM-INSURED-FIRST-NAME GREATER SPACES
  8727         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL677.cbl
  8728         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  8729     ELSE
  8730         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  8731         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  8732
  8733     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  8734
  8735     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  8736
  8737     MOVE WS-NAME-WORK             TO PI-INSURED-NAME.
  8738
  8739     IF PI-COMPANY-ID = 'TMS'
  8740         MOVE WS-NAME-WORK         TO PAYTO1I
  8741                                      PI-PAYTO1
  8742         MOVE AL-UANON             TO PAYTO1A
  8743     ELSE
  8744         MOVE WS-NAME-WORK         TO PAYTO1AI
  8745                                      PI-PAYTO1
  8746         MOVE AL-UANON             TO PAYTO1AA.
  8747
  8748*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  8749*    MOVE AL-UANON                 TO PAYTO1AA.
  8750
  8751     IF PI-MAIL-YES
  8752         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  8753
  8754     GO TO 8100-SEND-INITIAL-MAP.
  8755
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL677.cbl
  8757
  8758 6400-MAILING-ADDRESS.
  8759
  8760* EXEC CICS HANDLE CONDITION
  8761*        NOTFND   (6470-NO-ADDRESS)
  8762*    END-EXEC.
  8763*    MOVE '"$I                   ! 4 #00007994' TO DFHEIV0
  8764     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8766     MOVE X'3420233030303037393934' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771
  8772* EXEC CICS READ
  8773*        DATASET   (ERMAIL-FILE-ID)
  8774*        SET       (ADDRESS OF MAILING-DATA)
  8775*        RIDFLD    (ELCERT-KEY)
  8776*    END-EXEC.
  8777*    MOVE '&"S        E          (   #00007998' TO DFHEIV0
  8778     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8780     MOVE X'2020233030303037393938' TO DFHEIV0(25:11)
  8781     CALL 'kxdfhei1' USING DFHEIV0,
  8782           ERMAIL-FILE-ID,
  8783           DFHEIV20,
  8784           DFHEIV99,
  8785           ELCERT-KEY,
  8786           DFHEIV99,
  8787           DFHEIV99,
  8788           DFHEIV99
  8789     SET ADDRESS OF MAILING-DATA TO
  8790         DFHEIV20
  8791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8792
  8793
  8794     MOVE MA-ADDRESS-LINE-1      TO PAYTO2I.
  8795     MOVE MA-ADDRESS-LINE-2      TO PAYTO3I.
  8796     MOVE MA-CITY-STATE          TO PAYTO4I.
  8797     MOVE MA-ZIP                 TO PTOZIPI.
  8798     MOVE AL-UANON               TO PAYTO2A
  8799                                    PAYTO3A
  8800                                    PAYTO4A
  8801                                    PTOZIPA.
  8802
  8803     GO TO 6490-EXIT.
  8804
  8805 6470-NO-ADDRESS.
  8806     MOVE -1                     TO  PAYTO2L.
  8807     MOVE ER-2394                TO  EMI-ERROR.
  8808     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8809
  8810 6490-EXIT.
  8811      EXIT.
  8812
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL677.cbl
  8814
  8815 6500-BUILD-ACCOUNT-SCREEN.
  8816     MOVE LOW-VALUES             TO  EL677AI.
  8817     MOVE PI-CARRIER             TO  CARRIERO.
  8818     MOVE PI-GROUPING            TO  GROUPO.
  8819     MOVE PI-STATE               TO  STATEO.
  8820     MOVE PI-ACCOUNT             TO  ACCTO.
  8821     MOVE PI-CERT-PRIME          TO  CERTNOO.
  8822     MOVE PI-CERT-SFX            TO  SFXO.
  8823     MOVE PI-AMOUNT              TO  AMOUNTO.
  8824     MOVE PI-TYPE                TO  TYPEO.
  8825     MOVE PI-REFERENCE           TO  REFO.
  8826     MOVE PI-PAYTO1              TO  PAYTO1AO.
  8827     MOVE AL-UANON               TO  CARRIERA
  8828                                     GROUPA
  8829                                     STATEA
  8830                                     ACCTA
  8831                                     SFXA
  8832                                     CERTNOA
  8833                                     AMOUNTA
  8834                                     TYPEA
  8835                                     REFA
  8836                                     PAYTO1AA.
  8837     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8838     MOVE ' '                    TO  DC-OPTION-CODE.
  8839
  8840     PERFORM 8500-DATE-CONVERT.
  8841     IF NO-CONVERSION-ERROR
  8842        MOVE DC-GREG-DATE-1-EDIT TO EFFDTI
  8843        MOVE AL-UANON       TO  EFFDTA
  8844     ELSE
  8845        GO TO 8100-SEND-INITIAL-MAP.
  8846
  8847     MOVE PI-AM-NAME             TO PAYTO1I.
  8848     MOVE PI-AM-ADDRS            TO PAYTO2I.
  8849     MOVE PI-AM-CITY             TO PAYTO3I.
  8850     MOVE PI-AM-ZIP-CODE         TO PTOZIPI.
  8851
  8852     MOVE AL-UANON               TO PAYTO1A
  8853                                    PAYTO2A
  8854                                    PAYTO3A
  8855                                    PTOZIPA.
  8856
  8857     MOVE 'A'                    TO  MAINTI.
  8858     MOVE AL-UANON               TO  MAINTA.
  8859     MOVE +1                     TO  MAINTL.
  8860
  8861     GO TO 8100-SEND-INITIAL-MAP.
  8862
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL677.cbl
  8864
  8865 6600-BUILD-BENEFICIARY-SCREEN.
  8866     MOVE LOW-VALUES             TO  EL677AI.
  8867     MOVE 'A'                    TO  MAINTI.
  8868     MOVE AL-UANON               TO  MAINTA.
  8869     MOVE +1                     TO  MAINTL.
  8870
  8871     MOVE PI-CARRIER             TO  CARRIERO.
  8872     MOVE PI-GROUPING            TO  GROUPO.
  8873     MOVE PI-STATE               TO  STATEO.
  8874     MOVE PI-ACCOUNT             TO  ACCTO.
  8875     MOVE PI-CERT-PRIME          TO  CERTNOO.
  8876     MOVE PI-CERT-SFX            TO  SFXO.
  8877     MOVE AL-UANON               TO  CARRIERA
  8878                                     GROUPA
  8879                                     STATEA
  8880                                     ACCTA
  8881                                     SFXA
  8882                                     CERTNOA.
  8883     MOVE PB-C-PAYEE-CODE        TO  PAYEEO.
  8884     MOVE AL-SANON               TO  PAYEEA.
  8885     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8886     MOVE ' '                    TO  DC-OPTION-CODE.
  8887
  8888     PERFORM 8500-DATE-CONVERT.
  8889
  8890     IF NO-CONVERSION-ERROR
  8891         MOVE DC-GREG-DATE-1-EDIT TO EFFDTI
  8892         MOVE AL-UANON            TO EFFDTA.
  8893
  8894     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  8895
  8896
  8897* EXEC CICS HANDLE CONDITION
  8898*        NOTFND   (6670-NO-BENEFICIARY)
  8899*    END-EXEC.
  8900*    MOVE '"$I                   ! 5 #00008106' TO DFHEIV0
  8901     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8903     MOVE X'3520233030303038313036' TO DFHEIV0(25:11)
  8904     CALL 'kxdfhei1' USING DFHEIV0
  8905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8906
  8907
  8908     MOVE PI-COMPANY-CD          TO ELBENE-COMPANY-CD.
  8909     MOVE PB-C-PAYEE-CODE        TO ELBENE-BENEFICIARY.
  8910
  8911
  8912* EXEC CICS READ
  8913*        DATASET   (ELBENE-FILE-ID)
  8914*        SET       (ADDRESS OF BENEFICIARY-MASTER)
  8915*        RIDFLD    (ELBENE-KEY)
  8916*    END-EXEC.
  8917*    MOVE '&"S        E          (   #00008113' TO DFHEIV0
  8918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8920     MOVE X'2020233030303038313133' TO DFHEIV0(25:11)
  8921     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL677.cbl
  8922           ELBENE-FILE-ID,
  8923           DFHEIV20,
  8924           DFHEIV99,
  8925           ELBENE-KEY,
  8926           DFHEIV99,
  8927           DFHEIV99,
  8928           DFHEIV99
  8929     SET ADDRESS OF BENEFICIARY-MASTER TO
  8930         DFHEIV20
  8931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8932
  8933
  8934     MOVE BE-MAIL-TO-NAME        TO PAYTO1I.
  8935     MOVE BE-ADDRESS-LINE-1      TO PAYTO2I.
  8936     MOVE BE-ADDRESS-LINE-2      TO PAYTO3I.
  8937     MOVE BE-CITY-STATE          TO PAYTO4I.
  8938     MOVE BE-ZIP-CODE            TO PTOZIPI.
  8939     MOVE AL-UANON               TO PAYTO1A
  8940                                    PAYTO2A
  8941                                    PAYTO3A
  8942                                    PAYTO4A
  8943                                    PTOZIPA.
  8944
  8945     IF WS-CERT-FOUND
  8946         MOVE CM-BENEFICIARY      TO PAYTO1AI
  8947         MOVE AL-UANON            TO PAYTO1AA.
  8948
  8949     GO TO 8100-SEND-INITIAL-MAP.
  8950
  8951 6670-NO-BENEFICIARY.
  8952     MOVE -1                     TO  PAYTO1L.
  8953     MOVE ER-0565                TO  EMI-ERROR.
  8954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8955
  8956     GO TO 8100-SEND-INITIAL-MAP.
  8957
  8958 6690-EXIT.
  8959      EXIT.
  8960
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL677.cbl
  8962 7000-SET-PI-AREA.
  8963     MOVE CARRIERI               TO  PI-CARRIER
  8964                                     PI-CHEK-CARRIER.
  8965     MOVE GROUPI                 TO  PI-GROUPING
  8966                                     PI-CHEK-GROUPING.
  8967     MOVE STATEI                 TO  PI-STATE
  8968                                     PI-CHEK-STATE.
  8969     MOVE ACCTI                  TO  PI-ACCOUNT
  8970                                     PI-CHEK-ACCOUNT.
  8971     MOVE CERTNOI                TO  PI-CERT-PRIME
  8972                                     PI-CHEK-CERT-NO.
  8973     IF SFXI NOT = LOW-VALUES
  8974         MOVE SFXI               TO  PI-CERT-SFX
  8975                                     PI-CHEK-SUF-NO
  8976     ELSE
  8977         MOVE SPACE              TO  PI-CERT-SFX
  8978                                     PI-CHEK-SUF-NO.
  8979
  8980     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  8981     MOVE '2'                    TO  DC-OPTION-CODE.
  8982     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8983     IF DATE-CONVERSION-ERROR
  8984         MOVE ER-0215            TO  EMI-ERROR
  8985         MOVE -1                 TO  EFFDTL
  8986         MOVE AL-UNBON           TO  EFFDTA
  8987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8988         GO TO 8200-SEND-DATAONLY
  8989     ELSE
  8990         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  8991                                     PI-CHEK-EFF-DT.
  8992
  8993 7090-EXIT.
  8994      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL677.cbl
  8996 7100-CREATE-TEMP-STORAGE.
  8997     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  8998
  8999
  9000* EXEC CICS WRITEQ TS
  9001*        QUEUE   (QID)
  9002*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9003*        LENGTH  (PI-COMM-LENGTH)
  9004*    END-EXEC.
  9005*    MOVE '*"                    ''   #00008184' TO DFHEIV0
  9006     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  9007     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9008     MOVE X'2020233030303038313834' TO DFHEIV0(25:11)
  9009     CALL 'kxdfhei1' USING DFHEIV0,
  9010           QID,
  9011           PROGRAM-INTERFACE-BLOCK,
  9012           PI-COMM-LENGTH,
  9013           DFHEIV99,
  9014           DFHEIV99,
  9015           DFHEIV99
  9016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9017
  9018
  9019 7100-EXIT.
  9020      EXIT.
  9021
  9022 7200-RECOVER-TEMP-STORAGE.
  9023
  9024* EXEC CICS READQ TS
  9025*        QUEUE   (QID)
  9026*        INTO    (PROGRAM-INTERFACE-BLOCK)
  9027*        LENGTH  (PI-COMM-LENGTH)
  9028*    END-EXEC.
  9029*    MOVE '*$I    L              ''   #00008194' TO DFHEIV0
  9030     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9031     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9032     MOVE X'2020233030303038313934' TO DFHEIV0(25:11)
  9033     CALL 'kxdfhei1' USING DFHEIV0,
  9034           QID,
  9035           PROGRAM-INTERFACE-BLOCK,
  9036           PI-COMM-LENGTH,
  9037           DFHEIV99,
  9038           DFHEIV99,
  9039           DFHEIV99
  9040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9041
  9042
  9043     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9044
  9045 7200-EXIT.
  9046      EXIT.
  9047
  9048 7300-DELETE-TEMP-STORAGE.
  9049
  9050* EXEC CICS HANDLE CONDITION
  9051*        QIDERR  (7300-EXIT)
  9052*    END-EXEC.
  9053*    MOVE '"$N                   ! 6 #00008206' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL677.cbl
  9054     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9055     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9056     MOVE X'3620233030303038323036' TO DFHEIV0(25:11)
  9057     CALL 'kxdfhei1' USING DFHEIV0
  9058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9059
  9060
  9061
  9062* EXEC CICS DELETEQ TS
  9063*        QUEUE  (QID)
  9064*    END-EXEC.
  9065*    MOVE '*&                    #   #00008210' TO DFHEIV0
  9066     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9067     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9068     MOVE X'2020233030303038323130' TO DFHEIV0(25:11)
  9069     CALL 'kxdfhei1' USING DFHEIV0,
  9070           QID,
  9071           DFHEIV99
  9072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9073
  9074
  9075 7300-EXIT.
  9076      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL677.cbl
  9078 8035-LETR-NOT-OPEN.
  9079
  9080     MOVE ER-0013                TO EMI-ERROR.
  9081     MOVE -1                     TO LETTER1L
  9082     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9083     GO TO 8200-SEND-DATAONLY.
  9084
  9085 8035-EXIT.
  9086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL677.cbl
  9088 8100-SEND-INITIAL-MAP.
  9089     MOVE SAVE-DATE              TO  DATEO.
  9090     MOVE EIBTIME                TO  TIME-IN.
  9091     MOVE TIME-OUT               TO  TIMEO.
  9092     MOVE -1                     TO  MAINTL.
  9093     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9094     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9095
  9096     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  9097         MOVE AL-SADOF           TO  DEDDESCA
  9098                                     DEDAMTA
  9099                                     ADDDESCA
  9100                                     ADDLCHGA.
  9101
  9102     IF NOT PI-AR-PROCESSING
  9103         MOVE AL-SADOF           TO  REFDESCA.
  9104
  9105
  9106* EXEC CICS SEND
  9107*        MAP      (EL677A)
  9108*        MAPSET   (MAPSET-NAME)
  9109*        FROM     (EL677AO)
  9110*        ERASE
  9111*        CURSOR
  9112*    END-EXEC.
  9113     MOVE LENGTH OF
  9114      EL677AO
  9115       TO DFHEIV12
  9116     MOVE -1
  9117       TO DFHEIV11
  9118*    MOVE '8$     CT  E    H L F ,   #00008244' TO DFHEIV0
  9119     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9120     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9121     MOVE X'2020233030303038323434' TO DFHEIV0(25:11)
  9122     CALL 'kxdfhei1' USING DFHEIV0,
  9123           EL677A,
  9124           EL677AO,
  9125           DFHEIV12,
  9126           MAPSET-NAME,
  9127           DFHEIV99,
  9128           DFHEIV99,
  9129           DFHEIV99,
  9130           DFHEIV11,
  9131           DFHEIV99,
  9132           DFHEIV99,
  9133           DFHEIV99
  9134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9135
  9136
  9137     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL677.cbl
  9139 8200-SEND-DATAONLY.
  9140     MOVE SAVE-DATE              TO  DATEO.
  9141     MOVE EIBTIME                TO  TIME-IN.
  9142     MOVE TIME-OUT               TO  TIMEO.
  9143     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9144     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9145
  9146     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  9147         MOVE AL-SADOF           TO  DEDDESCA
  9148                                     DEDAMTA
  9149                                     ADDDESCA
  9150                                     ADDLCHGA.
  9151
  9152
  9153* EXEC CICS SEND
  9154*        MAP     (EL677A)
  9155*        MAPSET  (MAPSET-NAME)
  9156*        FROM    (EL677AO)
  9157*        DATAONLY
  9158*        CURSOR
  9159*    END-EXEC.
  9160     MOVE LENGTH OF
  9161      EL677AO
  9162       TO DFHEIV12
  9163     MOVE -1
  9164       TO DFHEIV11
  9165*    MOVE '8$D    CT       H L F ,   #00008267' TO DFHEIV0
  9166     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9167     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9168     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  9169     CALL 'kxdfhei1' USING DFHEIV0,
  9170           EL677A,
  9171           EL677AO,
  9172           DFHEIV12,
  9173           MAPSET-NAME,
  9174           DFHEIV99,
  9175           DFHEIV99,
  9176           DFHEIV99,
  9177           DFHEIV11,
  9178           DFHEIV99,
  9179           DFHEIV99,
  9180           DFHEIV99
  9181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9182
  9183
  9184     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL677.cbl
  9186 8300-SEND-TEXT.
  9187
  9188* EXEC CICS SEND TEXT
  9189*        FROM     (LOGOFF-TEXT)
  9190*        LENGTH   (LOGOFF-LENGTH)
  9191*        ERASE
  9192*        FREEKB
  9193*    END-EXEC.
  9194*    MOVE '8&      T  E F  H   F -   #00008278' TO DFHEIV0
  9195     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9196     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9197     MOVE X'2020233030303038323738' TO DFHEIV0(25:11)
  9198     CALL 'kxdfhei1' USING DFHEIV0,
  9199           LOGOFF-TEXT,
  9200           LOGOFF-LENGTH,
  9201           DFHEIV99,
  9202           DFHEIV99,
  9203           DFHEIV99,
  9204           DFHEIV99,
  9205           DFHEIV99,
  9206           DFHEIV99,
  9207           DFHEIV99,
  9208           DFHEIV99,
  9209           DFHEIV99,
  9210           DFHEIV99
  9211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9212
  9213
  9214
  9215* EXEC CICS RETURN
  9216*    END-EXEC.
  9217*    MOVE '.(                    &   #00008285' TO DFHEIV0
  9218     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9220     MOVE X'2020233030303038323835' TO DFHEIV0(25:11)
  9221     CALL 'kxdfhei1' USING DFHEIV0,
  9222           DFHEIV99,
  9223           DFHEIV99,
  9224           DFHEIV99,
  9225           DFHEIV99,
  9226           DFHEIV99
  9227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9228
  9229
  9230 8500-DATE-CONVERT.
  9231     MOVE LINK-ELDATCV           TO  PGM-NAME.
  9232
  9233
  9234* EXEC CICS LINK
  9235*        PROGRAM    (PGM-NAME)
  9236*        COMMAREA   (DATE-CONVERSION-DATA)
  9237*        LENGTH     (DC-COMM-LENGTH)
  9238*    END-EXEC.
  9239*    MOVE '."C                   ''   #00008291' TO DFHEIV0
  9240     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9241     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9242     MOVE X'2020233030303038323931' TO DFHEIV0(25:11)
  9243     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL677.cbl
  9244           PGM-NAME,
  9245           DATE-CONVERSION-DATA,
  9246           DC-COMM-LENGTH,
  9247           DFHEIV99,
  9248           DFHEIV99,
  9249           DFHEIV99
  9250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9251
  9252
  9253 8500-EXIT.
  9254      EXIT.
  9255
  9256 8600-DEEDIT.
  9257
  9258* EXEC CICS BIF DEEDIT
  9259*        FIELD   (WS-DEEDIT-FIELD)
  9260*        LENGTH  (10)
  9261*    END-EXEC.
  9262     MOVE 10
  9263       TO DFHEIV11
  9264*    MOVE '@"L                   #   #00008301' TO DFHEIV0
  9265     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9266     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9267     MOVE X'2020233030303038333031' TO DFHEIV0(25:11)
  9268     CALL 'kxdfhei1' USING DFHEIV0,
  9269           WS-DEEDIT-FIELD,
  9270           DFHEIV11
  9271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9272
  9273
  9274 8600-EXIT.
  9275      EXIT.
  9276
  9277 8700-DEEDIT.
  9278
  9279* EXEC CICS BIF DEEDIT
  9280*        FIELD   (WS-DT-DEEDIT-FIELD)
  9281*        LENGTH  (10)
  9282*    END-EXEC.
  9283     MOVE 10
  9284       TO DFHEIV11
  9285*    MOVE '@"L                   #   #00008310' TO DFHEIV0
  9286     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9287     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9288     MOVE X'2020233030303038333130' TO DFHEIV0(25:11)
  9289     CALL 'kxdfhei1' USING DFHEIV0,
  9290           WS-DT-DEEDIT-FIELD,
  9291           DFHEIV11
  9292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9293
  9294
  9295 8700-EXIT.
  9296      EXIT.
  9297
  9298 8800-UNAUTHORIZED-ACCESS.
  9299     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9300     GO TO 8300-SEND-TEXT.
  9301
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL677.cbl
  9302 8810-PF23.
  9303     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9304     MOVE XCTL-005               TO  PGM-NAME.
  9305     GO TO 9300-XCTL.
  9306
  9307
  9308 9100-RETURN-TRAN.
  9309     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9310     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9311
  9312* EXEC CICS RETURN
  9313*        TRANSID  (TRANS-ID)
  9314*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9315*        LENGTH   (PI-COMM-LENGTH)
  9316*    END-EXEC.
  9317*    MOVE '.(CT                  &   #00008331' TO DFHEIV0
  9318     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9320     MOVE X'2020233030303038333331' TO DFHEIV0(25:11)
  9321     CALL 'kxdfhei1' USING DFHEIV0,
  9322           TRANS-ID,
  9323           PROGRAM-INTERFACE-BLOCK,
  9324           PI-COMM-LENGTH,
  9325           DFHEIV99,
  9326           DFHEIV99
  9327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9328
  9329
  9330
  9331* GOBACK.
  9332     MOVE '9%                    "   ' TO DFHEIV0
  9333     MOVE 'EL677' TO DFHEIV1
  9334     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9335     GOBACK.
  9336
  9337 9200-RETURN-MAIN-MENU.
  9338     MOVE XCTL-626               TO  PGM-NAME.
  9339     GO TO 9300-XCTL.
  9340
  9341 9300-XCTL.
  9342
  9343* EXEC CICS XCTL
  9344*        PROGRAM    (PGM-NAME)
  9345*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9346*        LENGTH     (PI-COMM-LENGTH)
  9347*    END-EXEC.
  9348*    MOVE '.$C                   $   #00008344' TO DFHEIV0
  9349     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9350     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9351     MOVE X'2020233030303038333434' TO DFHEIV0(25:11)
  9352     CALL 'kxdfhei1' USING DFHEIV0,
  9353           PGM-NAME,
  9354           PROGRAM-INTERFACE-BLOCK,
  9355           PI-COMM-LENGTH
  9356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9357
  9358
  9359 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL677.cbl
  9360     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9361     MOVE SPACES                 TO  PI-PFKEY.
  9362     GO TO 9300-XCTL.
  9363
  9364 9500-PF12.
  9365     MOVE XCTL-010               TO  PGM-NAME.
  9366     GO TO 9300-XCTL.
  9367
  9368 9600-PGMID-ERROR.
  9369
  9370* EXEC CICS HANDLE CONDITION
  9371*        PGMIDERR    (8300-SEND-TEXT)
  9372*    END-EXEC.
  9373*    MOVE '"$L                   ! 7 #00008360' TO DFHEIV0
  9374     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9376     MOVE X'3720233030303038333630' TO DFHEIV0(25:11)
  9377     CALL 'kxdfhei1' USING DFHEIV0
  9378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9379
  9380
  9381     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9382     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9383     MOVE XCTL-005               TO  PGM-NAME.
  9384     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9385     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9386
  9387     GO TO 9300-XCTL.
  9388
  9389 9900-ERROR-FORMAT.
  9390     IF NOT EMI-ERRORS-COMPLETE
  9391         MOVE LINK-001           TO  PGM-NAME
  9392
  9393* EXEC CICS LINK
  9394*            PROGRAM    (PGM-NAME)
  9395*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  9396*            LENGTH     (EMI-COMM-LENGTH)
  9397*        END-EXEC.
  9398*    MOVE '."C                   ''   #00008375' TO DFHEIV0
  9399     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9401     MOVE X'2020233030303038333735' TO DFHEIV0(25:11)
  9402     CALL 'kxdfhei1' USING DFHEIV0,
  9403           PGM-NAME,
  9404           ERROR-MESSAGE-INTERFACE-BLOCK,
  9405           EMI-COMM-LENGTH,
  9406           DFHEIV99,
  9407           DFHEIV99,
  9408           DFHEIV99
  9409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9410
  9411
  9412 9900-EXIT.
  9413      EXIT.
  9414
  9415 9990-ABEND.
  9416     MOVE LINK-004               TO  PGM-NAME.
  9417     MOVE DFHEIBLK               TO  EMI-LINE1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL677.cbl
  9418
  9419* EXEC CICS LINK
  9420*        PROGRAM   (PGM-NAME)
  9421*        COMMAREA  (EMI-LINE1)
  9422*        LENGTH    (72)
  9423*    END-EXEC.
  9424     MOVE 72
  9425       TO DFHEIV11
  9426*    MOVE '."C                   ''   #00008387' TO DFHEIV0
  9427     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9429     MOVE X'2020233030303038333837' TO DFHEIV0(25:11)
  9430     CALL 'kxdfhei1' USING DFHEIV0,
  9431           PGM-NAME,
  9432           EMI-LINE1,
  9433           DFHEIV11,
  9434           DFHEIV99,
  9435           DFHEIV99,
  9436           DFHEIV99
  9437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9438
  9439
  9440     GO TO 8200-SEND-DATAONLY.
  9441
  9442 9995-SECURITY-VIOLATION.
  9443*                            COPY ELCSCTP.
  9444******************************************************************
  9445*                                                                *
  9446*                            ELCSCTP                             *
  9447*                            VMOD=2.001                          *
  9448*                                                                *
  9449*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9450******************************************************************
  9451
  9452
  9453     MOVE EIBDATE          TO SM-JUL-DATE.
  9454     MOVE EIBTRMID         TO SM-TERMID.
  9455     MOVE THIS-PGM         TO SM-PGM.
  9456     MOVE EIBTIME          TO TIME-IN.
  9457     MOVE TIME-OUT         TO SM-TIME.
  9458     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9459
  9460
  9461* EXEC CICS LINK
  9462*         PROGRAM  ('EL003')
  9463*         COMMAREA (SECURITY-MESSAGE)
  9464*         LENGTH   (80)
  9465*    END-EXEC.
  9466     MOVE 'EL003' TO DFHEIV1
  9467     MOVE 80
  9468       TO DFHEIV11
  9469*    MOVE '."C                   ''   #00008413' TO DFHEIV0
  9470     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9472     MOVE X'2020233030303038343133' TO DFHEIV0(25:11)
  9473     CALL 'kxdfhei1' USING DFHEIV0,
  9474           DFHEIV1,
  9475           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL677.cbl
  9476           DFHEIV11,
  9477           DFHEIV99,
  9478           DFHEIV99,
  9479           DFHEIV99
  9480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9481
  9482
  9483******************************************************************
  9484
  9485
  9486 9995-EXIT.
  9487     EXIT.
  9488
  9489
  9490 9999-DFHBACK SECTION.
  9491     MOVE '9%                    "   ' TO DFHEIV0
  9492     MOVE 'EL677' TO DFHEIV1
  9493     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9494     GOBACK.
  9495 9999-DFHEXIT.
  9496     IF DFHEIGDJ EQUAL 0001
  9497         NEXT SENTENCE
  9498     ELSE IF DFHEIGDJ EQUAL 2
  9499         GO TO 9600-PGMID-ERROR,
  9500               9990-ABEND
  9501         DEPENDING ON DFHEIGDI
  9502     ELSE IF DFHEIGDJ EQUAL 3
  9503         GO TO 8100-SEND-INITIAL-MAP
  9504         DEPENDING ON DFHEIGDI
  9505     ELSE IF DFHEIGDJ EQUAL 4
  9506         GO TO 1290-NO-CARRIER
  9507         DEPENDING ON DFHEIGDI
  9508     ELSE IF DFHEIGDJ EQUAL 5
  9509         GO TO 1220-LETR-NOT-FOUND,
  9510               1220-LETR-NOT-FOUND,
  9511               8035-LETR-NOT-OPEN
  9512         DEPENDING ON DFHEIGDI
  9513     ELSE IF DFHEIGDJ EQUAL 6
  9514         GO TO 1380-NO-STATE
  9515         DEPENDING ON DFHEIGDI
  9516     ELSE IF DFHEIGDJ EQUAL 7
  9517         GO TO 1480-ACCOUNT-INVALID,
  9518               1480-ACCOUNT-INVALID
  9519         DEPENDING ON DFHEIGDI
  9520     ELSE IF DFHEIGDJ EQUAL 8
  9521         GO TO 1590-EXIT
  9522         DEPENDING ON DFHEIGDI
  9523     ELSE IF DFHEIGDJ EQUAL 9
  9524         GO TO 2200-DUPREC
  9525         DEPENDING ON DFHEIGDI
  9526     ELSE IF DFHEIGDJ EQUAL 10
  9527         GO TO 2577-DUPREC
  9528         DEPENDING ON DFHEIGDI
  9529     ELSE IF DFHEIGDJ EQUAL 11
  9530         GO TO 2680-NO-CO-MASTER
  9531         DEPENDING ON DFHEIGDI
  9532     ELSE IF DFHEIGDJ EQUAL 12
  9533         GO TO 3900-RECORD-NOTFND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL677.cbl
  9534         DEPENDING ON DFHEIGDI
  9535     ELSE IF DFHEIGDJ EQUAL 13
  9536         GO TO 3287-DUPREC
  9537         DEPENDING ON DFHEIGDI
  9538     ELSE IF DFHEIGDJ EQUAL 14
  9539         GO TO 3390-EXIT,
  9540               3390-EXIT
  9541         DEPENDING ON DFHEIGDI
  9542     ELSE IF DFHEIGDJ EQUAL 15
  9543         GO TO 3780-CHECK-NOTFND
  9544         DEPENDING ON DFHEIGDI
  9545     ELSE IF DFHEIGDJ EQUAL 16
  9546         GO TO 5900-END-OF-FILE,
  9547               5900-END-OF-FILE
  9548         DEPENDING ON DFHEIGDI
  9549     ELSE IF DFHEIGDJ EQUAL 17
  9550         GO TO 6070-NO-COMP-MSTR
  9551         DEPENDING ON DFHEIGDI
  9552     ELSE IF DFHEIGDJ EQUAL 18
  9553         GO TO 6170-NO-CERTIFICATE
  9554         DEPENDING ON DFHEIGDI
  9555     ELSE IF DFHEIGDJ EQUAL 19
  9556         GO TO 6290-EXIT
  9557         DEPENDING ON DFHEIGDI
  9558     ELSE IF DFHEIGDJ EQUAL 20
  9559         GO TO 6470-NO-ADDRESS
  9560         DEPENDING ON DFHEIGDI
  9561     ELSE IF DFHEIGDJ EQUAL 21
  9562         GO TO 6670-NO-BENEFICIARY
  9563         DEPENDING ON DFHEIGDI
  9564     ELSE IF DFHEIGDJ EQUAL 22
  9565         GO TO 7300-EXIT
  9566         DEPENDING ON DFHEIGDI
  9567     ELSE IF DFHEIGDJ EQUAL 23
  9568         GO TO 8300-SEND-TEXT
  9569         DEPENDING ON DFHEIGDI.
  9570     MOVE '9%                    "   ' TO DFHEIV0
  9571     MOVE 'EL677' TO DFHEIV1
  9572     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9573     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5364     Code:       22765
