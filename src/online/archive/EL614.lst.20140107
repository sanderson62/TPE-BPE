* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   1
* EL614.cbl
* Options: int("EL614.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL614.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL614.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL614.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL614 .
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.    PABLO.
     7*           COLLEYVILLE TX.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   2
* EL614.cbl
    14*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.
    19*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    20*    FOR THE  EOB   CODES IN THE CLAIM SYSTEM.
    21*
    22*    SCREENS     - EL614A - EOB CODE MAINTENANCE
    23*
    24*    ENTERED BY  - EL101 - SYSTEM ADMINISTRATION MENU
    25*                  EL156 - PAYMENT WORKSHEET
    26*                  EL6317 - CERTIFICATE VERIFICATION
    27*    EXIT TO     - EL101 - SYSTEM ADMINISTRATION MENU
    28*                  EL156 - PAYMENT WORKSHEET
    29*                  EL6317 - CERTIFICATE VERIFICATION
    30*    COMMAREA    - PASSED
    31*
    32*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    33*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    34*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    35*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    36*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    37*                  MAINTENANCE TYPE INDICATED.
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 083110    2009122800001  PEMA  NEW PROGRAM
    47* 011811    2009122800001  AJRA  FIX SELECTION
    48* 042211    2011040600001  PEMA  FIX ISSUE NO RECORDS FOUND
    49* 081511    2011022800001  PEMA  ADMIN SERV NAPERSOFT CHANGES
    50* 121012    2012101700002  AJRA  HIGHLIGHT REASON CODES
    51******************************************************************
    52 ENVIRONMENT DIVISION.
    53 DATA DIVISION.
    54 WORKING-STORAGE SECTION.
    55 01  DFH-START PIC X(04).
    56 77  FILLER  PIC X(32)  VALUE '********************************'.
    57 77  FILLER  PIC X(32)  VALUE '*   EL614  WORKING STORAGE     *'.
    58 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    59 77  CI1                PIC S999  COMP-3 VALUE +0.
    60 77  B1                 PIC S999  COMP-3 VALUE +0.
    61 77  S1                 PIC S999  COMP-3 VALUE +0.
    62 77  S2                 PIC S999  COMP-3 VALUE +0.
    63 77  E1                 PIC S999  COMP-3 VALUE +0.
    64 77  WS-DUP-EOB-SW      PIC X VALUE ' '.
    65     88  FOUND-DUP-EOB     VALUE 'Y'.
    66*    COPY ELCSCTM.
    67******************************************************************
    68*                                                                *
    69*                                                                *
    70*                            ELCSCTM                             *
    71*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   3
* EL614.cbl
    72*                                                                *
    73*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-MESSAGE.
    77     12  FILLER                          PIC X(30)
    78            VALUE '** LOGIC SECURITY VIOLATION -'.
    79     12  SM-READ                         PIC X(6).
    80     12  FILLER                          PIC X(5)
    81            VALUE ' PGM='.
    82     12  SM-PGM                          PIC X(6).
    83     12  FILLER                          PIC X(5)
    84            VALUE ' OPR='.
    85     12  SM-PROCESSOR-ID                 PIC X(4).
    86     12  FILLER                          PIC X(6)
    87            VALUE ' TERM='.
    88     12  SM-TERMID                       PIC X(4).
    89     12  FILLER                          PIC XX   VALUE SPACE.
    90     12  SM-JUL-DATE                     PIC 9(5).
    91     12  FILLER                          PIC X    VALUE SPACE.
    92     12  SM-TIME                         PIC 99.99.
    93
    94*    COPY ELCSCRTY.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCSCRTY                            *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   102*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   103*        SAVED IN PI-SECURITY-ADDRESS.                           *
   104*                                                                *
   105******************************************************************
   106 01  SECURITY-CONTROL.
   107     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   108     12  FILLER                       PIC XX    VALUE 'SC'.
   109     12  SC-CREDIT-CODES.
   110         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   111             20  SC-CREDIT-DISPLAY    PIC X.
   112             20  SC-CREDIT-UPDATE     PIC X.
   113     12  SC-CLAIMS-CODES.
   114         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   115             20  SC-CLAIMS-DISPLAY    PIC X.
   116             20  SC-CLAIMS-UPDATE     PIC X.
   117 01  WS-PASSED-FROM-CALL-PGM     PIC X(60)  VALUE SPACES.
   118 01  WS-DATE-AREA.
   119     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   120    05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   121 01  WS-SELECTED-EOB-CODES.
   122     05  WS-SELECTED-CODES OCCURS 12.
   123         10  WS-SEL-EOB-CODE PIC XXXX.
   124         10  FILLER          PIC X.
   125 01  FILLER                          COMP-3.
   126     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   127     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   128     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   129     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   4
* EL614.cbl
   130     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   131       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   132       88  INITIAL-TRANSACTION                       VALUE +2.
   133       88  CHANGE-SUCCESSFUL                         VALUE +3.
   134     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   135     05  TIME-OUT                    REDEFINES
   136         TIME-IN                     PIC S9(3)V9(4).
   137 01  FILLER                          COMP SYNC.
   138     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   139     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   140     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   141     05  ELEOBC-LENGTH               PIC S9(4)   VALUE +350.
   142     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   143 01  FILLER.
   144     05  SC-ITEM             PIC S9(4) COMP VALUE +1.
   145     05  DEEDIT-FIELD        PIC  X(10).
   146     05  DEEDIT-FIELD-V0  REDEFINES
   147         DEEDIT-FIELD        PIC S9(10).
   148     05  WS-RESPONSE             PIC S9(8)   COMP.
   149         88  RESP-NORMAL              VALUE +00.
   150         88  RESP-ERROR               VALUE +01.
   151         88  RESP-NOTFND              VALUE +13.
   152         88  RESP-NOTOPEN             VALUE +19.
   153         88  RESP-ENDFILE             VALUE +20.
   154     05  WS-ELEOBC-KEY.
   155         10  WS-COMPANY-CD           PIC X      VALUE LOW-VALUES.
   156         10  WS-EOB-REC-TYPE         PIC X      VALUE LOW-VALUES.
   157         10  WS-EOB-CODE             PIC X(4)   VALUE LOW-VALUES.
   158         10  FILLER                  PIC X(9)   VALUE LOW-VALUES.
   159     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL614S'.
   160     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL614A'.
   161     05  FILLER                      REDEFINES
   162         WS-MAP-NAME.
   163         10  FILLER                  PIC XX.
   164         10  WS-MAP-NUMBER           PIC X(4).
   165         10  FILLER                  PIC XX.
   166     05  THIS-PGM                    PIC X(8)  VALUE 'EL614'.
   167     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   168     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   169     05  WS-SPACE                    PIC X       VALUE SPACE.
   170     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAI'.
   171     05  WS-TEMP-STORAGE-KEY.
   172         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   173         10  FILLER                  PIC X(4)    VALUE '614'.
   174     05  WS-REASON-CODE-PASSED       PIC X(26).
   175     05  WS-TABLE-CODE.
   176         10  WS-TAB-CODE-1           PIC X(1).
   177         10  WS-TAB-CODE-2-4         PIC X(3).
   178     05  WS-SCREEN-CODE.
   179         10  WS-SCR-CODE-1-3         PIC X(3).
   180         10  WS-SCR-CODE-4           PIC X(1).
   181     05  WS-ERROR-MESSAGE-AREA.
   182         10  ER-0000                 PIC 9(4)   VALUE 0000.
   183         10  ER-0004                 PIC 9(4)   VALUE 0004.
   184         10  ER-0006                 PIC 9(4)   VALUE 0006.
   185         10  ER-0008                 PIC 9(4)   VALUE 0008.
   186         10  ER-0023                 PIC 9(4)   VALUE 0023.
   187         10  ER-0029                 PIC 9(4)   VALUE 0029.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   5
* EL614.cbl
   188         10  ER-0070                 PIC 9(4)   VALUE 0070.
   189         10  ER-0150                 PIC 9(4)   VALUE 0150.
   190         10  ER-0491                 PIC 9(4)   VALUE 0491.
   191         10  ER-1079                 PIC 9(4)   VALUE 1079.
   192         10  ER-1257                 PIC 9(4)   VALUE 1257.
   193         10  ER-1258                 PIC 9(4)   VALUE 1258.
   194         10  ER-2261                 PIC 9(4)   VALUE 2261.
   195         10  ER-3800                 PIC 9(4)   VALUE 3800.
   196         10  ER-3801                 PIC 9(4)   VALUE 3801.
   197         10  ER-3802                 PIC 9(4)   VALUE 3802.
   198         10  ER-3803                 PIC 9(4)   VALUE 3803.
   199         10  ER-3804                 PIC 9(4)   VALUE 3804.
   200         10  ER-3805                 PIC 9(4)   VALUE 3805.
   201         10  ER-3806                 PIC 9(4)   VALUE 3806.
   202         10  ER-3807                 PIC 9(4)   VALUE 3807.
   203         10  ER-3840                 PIC 9(4)   VALUE 3840.
   204         10  ER-3841                 PIC 9(4)   VALUE 3841.
   205         10  ER-3842                 PIC 9(4)   VALUE 3842.
   206         10  ER-7220                 PIC 9(4)   VALUE 7220.
   207         10  ER-7698                 PIC 9(4)   VALUE 7698.
   208         10  ER-9999                 PIC 9(4)   VALUE 9999.
   209*    COPY ELCINTF.
   210******************************************************************
   211*                                                                *
   212*                                                                *
   213*                            ELCINTF.                            *
   214*                            VMOD=2.017                          *
   215*                                                                *
   216*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   217*                                                                *
   218*       LENGTH = 1024                                            *
   219*                                                                *
   220******************************************************************
   221*                   C H A N G E   L O G
   222*
   223* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   224*-----------------------------------------------------------------
   225*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   226* EFFECTIVE    NUMBER
   227*-----------------------------------------------------------------
   228* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   229******************************************************************
   230 01  PROGRAM-INTERFACE-BLOCK.
   231     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   232     12  PI-CALLING-PROGRAM              PIC X(8).
   233     12  PI-SAVED-PROGRAM-1              PIC X(8).
   234     12  PI-SAVED-PROGRAM-2              PIC X(8).
   235     12  PI-SAVED-PROGRAM-3              PIC X(8).
   236     12  PI-SAVED-PROGRAM-4              PIC X(8).
   237     12  PI-SAVED-PROGRAM-5              PIC X(8).
   238     12  PI-SAVED-PROGRAM-6              PIC X(8).
   239     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   240     12  PI-COMPANY-ID                   PIC XXX.
   241     12  PI-COMPANY-CD                   PIC X.
   242
   243     12  PI-COMPANY-PASSWORD             PIC X(8).
   244
   245     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   6
* EL614.cbl
   246
   247     12  PI-CONTROL-IN-PROGRESS.
   248         16  PI-CARRIER                  PIC X.
   249         16  PI-GROUPING                 PIC X(6).
   250         16  PI-STATE                    PIC XX.
   251         16  PI-ACCOUNT                  PIC X(10).
   252         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   253                                         PIC X(10).
   254         16  PI-CLAIM-CERT-GRP.
   255             20  PI-CLAIM-NO             PIC X(7).
   256             20  PI-CERT-NO.
   257                 25  PI-CERT-PRIME       PIC X(10).
   258                 25  PI-CERT-SFX         PIC X.
   259             20  PI-CERT-EFF-DT          PIC XX.
   260         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   261             20  PI-PLAN-CODE            PIC X(2).
   262             20  PI-REVISION-NUMBER      PIC X(3).
   263             20  PI-PLAN-EFF-DT          PIC X(2).
   264             20  PI-PLAN-EXP-DT          PIC X(2).
   265             20  FILLER                  PIC X(11).
   266         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   267             20  PI-OE-REFERENCE-1.
   268                 25  PI-OE-REF-1-PRIME   PIC X(18).
   269                 25  PI-OE-REF-1-SUFF    PIC XX.
   270
   271     12  PI-SESSION-IN-PROGRESS          PIC X.
   272         88  CLAIM-SESSION                   VALUE '1'.
   273         88  CREDIT-SESSION                  VALUE '2'.
   274         88  WARRANTY-SESSION                VALUE '3'.
   275         88  MORTGAGE-SESSION                VALUE '4'.
   276         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   277
   278
   279*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   280
   281     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   282     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   283
   284     12  PI-CREDIT-USER                  PIC X.
   285         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   286         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   287
   288     12  PI-CLAIM-USER                   PIC X.
   289         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   290         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   291
   292     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   293         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   294         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   295         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   296         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   297         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   298
   299     12  PI-PROCESSOR-ID                 PIC X(4).
   300
   301     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   302
   303     12  PI-MEMBER-CAPTION               PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   7
* EL614.cbl
   304
   305     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   306         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   307
   308     12  PI-LIFE-OVERRIDE-L1             PIC X.
   309     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   310     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   311     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   312
   313     12  PI-AH-OVERRIDE-L1               PIC X.
   314     12  PI-AH-OVERRIDE-L2               PIC XX.
   315     12  PI-AH-OVERRIDE-L6               PIC X(6).
   316     12  PI-AH-OVERRIDE-L12              PIC X(12).
   317
   318     12  PI-NEW-SYSTEM                   PIC X(2).
   319
   320     12  PI-PRIMARY-CERT-NO              PIC X(11).
   321     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   322         88  PI-USES-PAID-TO                 VALUE '1'.
   323     12  PI-CRDTCRD-SYSTEM.
   324         16  PI-CRDTCRD-USER             PIC X.
   325             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   326             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   327         16  PI-CC-MONTH-END-DT          PIC XX.
   328     12  PI-PROCESSOR-PRINTER            PIC X(4).
   329
   330     12  PI-OE-REFERENCE-2.
   331         16  PI-OE-REF-2-PRIME           PIC X(10).
   332         16  PI-OE-REF-2-SUFF            PIC X.
   333
   334     12  PI-REM-TRM-CALC-OPTION          PIC X.
   335
   336     12  PI-LANGUAGE-TYPE                PIC X.
   337             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   338             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   339             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   340
   341     12  PI-POLICY-LINKAGE-IND           PIC X.
   342         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   343         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   344                                                   LOW-VALUES.
   345
   346     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   347     12  PI-CLAIM-PW-SESSION             PIC X(1).
   348         88  PI-CLAIM-CREDIT                 VALUE '1'.
   349         88  PI-CLAIM-CONVEN                 VALUE '2'.
   350
   351     12  PI-PROCESSOR-CSR-IND            PIC X.
   352         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   353         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   354
   355     12  FILLER                          PIC X(3).
   356
   357     12  PI-SYSTEM-LEVEL                 PIC X(145).
   358
   359     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   360         PI-SYSTEM-LEVEL.
   361
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   8
* EL614.cbl
   362         16  PI-ENTRY-CODES.
   363             20  PI-ENTRY-CD-1           PIC X.
   364             20  PI-ENTRY-CD-2           PIC X.
   365
   366         16  PI-RETURN-CODES.
   367             20  PI-RETURN-CD-1          PIC X.
   368             20  PI-RETURN-CD-2          PIC X.
   369
   370         16  PI-UPDATE-STATUS-SAVE.
   371             20  PI-UPDATE-BY            PIC X(4).
   372             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   373
   374         16  PI-LOWER-CASE-LETTERS       PIC X.
   375             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   376
   377*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   378*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   379*            88  CARRIER-CLM-CNTL            VALUE '2'.
   380
   381         16  PI-CERT-ACCESS-CONTROL      PIC X.
   382             88  ST-ACCNT-CNTL               VALUE ' '.
   383             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   384             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   385             88  ACCNT-CNTL                  VALUE '3'.
   386             88  CARR-ACCNT-CNTL             VALUE '4'.
   387
   388         16  PI-PROCESSOR-CAP-LIST.
   389             20  PI-SYSTEM-CONTROLS.
   390                24 PI-SYSTEM-DISPLAY     PIC X.
   391                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   392                24 PI-SYSTEM-MODIFY      PIC X.
   393                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   394             20  FILLER                  PIC XX.
   395             20  PI-DISPLAY-CAP          PIC X.
   396                 88  DISPLAY-CAP             VALUE 'Y'.
   397             20  PI-MODIFY-CAP           PIC X.
   398                 88  MODIFY-CAP              VALUE 'Y'.
   399             20  PI-MSG-AT-LOGON-CAP     PIC X.
   400                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   401             20  PI-FORCE-CAP            PIC X.
   402                 88  FORCE-CAP               VALUE 'Y'.
   403
   404         16  PI-PROGRAM-CONTROLS.
   405             20  PI-PGM-PRINT-OPT        PIC X.
   406             20  PI-PGM-FORMAT-OPT       PIC X.
   407             20  PI-PGM-PROCESS-OPT      PIC X.
   408             20  PI-PGM-TOTALS-OPT       PIC X.
   409
   410         16  PI-HELP-INTERFACE.
   411             20  PI-LAST-ERROR-NO        PIC X(4).
   412             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   413
   414         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   415             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   416
   417         16  PI-CR-CONTROL-IN-PROGRESS.
   418             20  PI-CR-CARRIER           PIC X.
   419             20  PI-CR-GROUPING          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page   9
* EL614.cbl
   420             20  PI-CR-STATE             PIC XX.
   421             20  PI-CR-ACCOUNT           PIC X(10).
   422             20  PI-CR-FIN-RESP          PIC X(10).
   423             20  PI-CR-TYPE              PIC X.
   424
   425         16  PI-CR-BATCH-NUMBER          PIC X(6).
   426
   427         16  PI-CR-MONTH-END-DT          PIC XX.
   428
   429         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   430             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   431             88  PI-ZERO-CARRIER             VALUE '1'.
   432             88  PI-ZERO-GROUPING            VALUE '2'.
   433             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   434
   435         16  PI-CARRIER-SECURITY         PIC X.
   436             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   437
   438         16  PI-ACCOUNT-SECURITY         PIC X(10).
   439             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   440             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   441
   442         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   443             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   444                                         INDEXED BY PI-ACCESS-NDX
   445                                         PIC X.
   446
   447         16  PI-GA-BILLING-CONTROL       PIC X.
   448             88  PI-GA-BILLING               VALUE '1'.
   449
   450         16  PI-MAIL-PROCESSING          PIC X.
   451             88  PI-MAIL-YES                 VALUE 'Y'.
   452
   453         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   454
   455         16  PI-AR-SYSTEM.
   456             20  PI-AR-PROCESSING-CNTL   PIC X.
   457                 88  PI-AR-PROCESSING        VALUE 'Y'.
   458             20  PI-AR-SUMMARY-CODE      PIC X(6).
   459             20  PI-AR-MONTH-END-DT      PIC XX.
   460
   461         16  PI-MP-SYSTEM.
   462             20  PI-MORTGAGE-USER            PIC X.
   463                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   464                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   465             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   466                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   467                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   468                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   469                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   470                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   471             20  PI-MP-MONTH-END-DT          PIC XX.
   472             20  PI-MP-REFERENCE-NO.
   473                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   474                 24  PI-MP-REFERENCE-SFX     PIC XX.
   475
   476         16  PI-LABEL-CONTROL            PIC X(01).
   477             88  PI-CREATE-LABELS                    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  10
* EL614.cbl
   478             88  PI-BYPASS-LABELS                    VALUE 'N'.
   479
   480         16  PI-BILL-GROUPING-CODE       PIC X(01).
   481             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   482
   483         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   484             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   485             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   486
   487         16  FILLER                      PIC X(14).
   488
   489     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   490******************************************************************
   491     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   492         16  PI-SELECTED-EOB-CODES.
   493             20  PI-SELECTED-CODES OCCURS 12.
   494                 24  PI-EOB-CODE     PIC XXXX.
   495                 24  FILLER          PIC X.
   496         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   497         16  PI-MODE                 PIC X.
   498             88  ADD-FUNCTION         VALUE 'A'.
   499         16  PI-DN-RCODE             PIC XXXX.
   500         16  PI-DN-TOP-KEY           PIC X(15).
   501         16  PI-DN-BOT-KEY           PIC X(15).
   502         16  PI-DN-KEYS OCCURS 17.
   503             20  PI-DN-KEY           PIC X(15).
   504         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   505         16  PI-BROWSE-SW            PIC S9     COMP-3.
   506         16  PI-SHOW-SW              PIC S9     COMP-3.
   507         16  PI-CHANGE-SW            PIC S9     COMP-3.
   508         16  PI-RECORD-TYPE          PIC X.
   509         16  pi-FILLER                  PIC X(255).
   510         16  PI-REASON-CODE-IND.
   511             20 PI-REASON-CODE-FLAG  OCCURS 26 TIMES PIC X(1).
   512         16  PI-EXPANDED-VIEW        PIC X(1).
   513         16  FILLER                  PIC X(1).
   514*    COPY EL614S.
   515 01  EL614AI.
   516     05  FILLER            PIC  X(0012).
   517*    -------------------------------
   518     05  ADATEL PIC S9(0004) COMP.
   519     05  ADATEF PIC  X(0001).
   520     05  FILLER REDEFINES ADATEF.
   521         10  ADATEA PIC  X(0001).
   522     05  ADATEI PIC  X(0008).
   523*    -------------------------------
   524     05  ATIMEL PIC S9(0004) COMP.
   525     05  ATIMEF PIC  X(0001).
   526     05  FILLER REDEFINES ATIMEF.
   527         10  ATIMEA PIC  X(0001).
   528     05  ATIMEI PIC  X(0005).
   529*    -------------------------------
   530     05  SELHL PIC S9(0004) COMP.
   531     05  SELHF PIC  X(0001).
   532     05  FILLER REDEFINES SELHF.
   533         10  SELHA PIC  X(0001).
   534     05  SELHI PIC  X(0003).
   535*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  11
* EL614.cbl
   536     05  SEL01L PIC S9(0004) COMP.
   537     05  SEL01F PIC  X(0001).
   538     05  FILLER REDEFINES SEL01F.
   539         10  SEL01A PIC  X(0001).
   540     05  SEL01I PIC  X(0001).
   541*    -------------------------------
   542     05  EOBCD01L PIC S9(0004) COMP.
   543     05  EOBCD01F PIC  X(0001).
   544     05  FILLER REDEFINES EOBCD01F.
   545         10  EOBCD01A PIC  X(0001).
   546     05  EOBCD01I PIC  X(0004).
   547*    -------------------------------
   548     05  DESC01L PIC S9(0004) COMP.
   549     05  DESC01F PIC  X(0001).
   550     05  FILLER REDEFINES DESC01F.
   551         10  DESC01A PIC  X(0001).
   552     05  DESC01I PIC  X(0060).
   553*    -------------------------------
   554     05  SEL02L PIC S9(0004) COMP.
   555     05  SEL02F PIC  X(0001).
   556     05  FILLER REDEFINES SEL02F.
   557         10  SEL02A PIC  X(0001).
   558     05  SEL02I PIC  X(0001).
   559*    -------------------------------
   560     05  EOBCD02L PIC S9(0004) COMP.
   561     05  EOBCD02F PIC  X(0001).
   562     05  FILLER REDEFINES EOBCD02F.
   563         10  EOBCD02A PIC  X(0001).
   564     05  EOBCD02I PIC  X(0004).
   565*    -------------------------------
   566     05  DESC02L PIC S9(0004) COMP.
   567     05  DESC02F PIC  X(0001).
   568     05  FILLER REDEFINES DESC02F.
   569         10  DESC02A PIC  X(0001).
   570     05  DESC02I PIC  X(0060).
   571*    -------------------------------
   572     05  SEL03L PIC S9(0004) COMP.
   573     05  SEL03F PIC  X(0001).
   574     05  FILLER REDEFINES SEL03F.
   575         10  SEL03A PIC  X(0001).
   576     05  SEL03I PIC  X(0001).
   577*    -------------------------------
   578     05  EOBCD03L PIC S9(0004) COMP.
   579     05  EOBCD03F PIC  X(0001).
   580     05  FILLER REDEFINES EOBCD03F.
   581         10  EOBCD03A PIC  X(0001).
   582     05  EOBCD03I PIC  X(0004).
   583*    -------------------------------
   584     05  DESC03L PIC S9(0004) COMP.
   585     05  DESC03F PIC  X(0001).
   586     05  FILLER REDEFINES DESC03F.
   587         10  DESC03A PIC  X(0001).
   588     05  DESC03I PIC  X(0060).
   589*    -------------------------------
   590     05  SEL04L PIC S9(0004) COMP.
   591     05  SEL04F PIC  X(0001).
   592     05  FILLER REDEFINES SEL04F.
   593         10  SEL04A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  12
* EL614.cbl
   594     05  SEL04I PIC  X(0001).
   595*    -------------------------------
   596     05  EOBCD04L PIC S9(0004) COMP.
   597     05  EOBCD04F PIC  X(0001).
   598     05  FILLER REDEFINES EOBCD04F.
   599         10  EOBCD04A PIC  X(0001).
   600     05  EOBCD04I PIC  X(0004).
   601*    -------------------------------
   602     05  DESC04L PIC S9(0004) COMP.
   603     05  DESC04F PIC  X(0001).
   604     05  FILLER REDEFINES DESC04F.
   605         10  DESC04A PIC  X(0001).
   606     05  DESC04I PIC  X(0060).
   607*    -------------------------------
   608     05  SEL05L PIC S9(0004) COMP.
   609     05  SEL05F PIC  X(0001).
   610     05  FILLER REDEFINES SEL05F.
   611         10  SEL05A PIC  X(0001).
   612     05  SEL05I PIC  X(0001).
   613*    -------------------------------
   614     05  EOBCD05L PIC S9(0004) COMP.
   615     05  EOBCD05F PIC  X(0001).
   616     05  FILLER REDEFINES EOBCD05F.
   617         10  EOBCD05A PIC  X(0001).
   618     05  EOBCD05I PIC  X(0004).
   619*    -------------------------------
   620     05  DESC05L PIC S9(0004) COMP.
   621     05  DESC05F PIC  X(0001).
   622     05  FILLER REDEFINES DESC05F.
   623         10  DESC05A PIC  X(0001).
   624     05  DESC05I PIC  X(0060).
   625*    -------------------------------
   626     05  SEL06L PIC S9(0004) COMP.
   627     05  SEL06F PIC  X(0001).
   628     05  FILLER REDEFINES SEL06F.
   629         10  SEL06A PIC  X(0001).
   630     05  SEL06I PIC  X(0001).
   631*    -------------------------------
   632     05  EOBCD06L PIC S9(0004) COMP.
   633     05  EOBCD06F PIC  X(0001).
   634     05  FILLER REDEFINES EOBCD06F.
   635         10  EOBCD06A PIC  X(0001).
   636     05  EOBCD06I PIC  X(0004).
   637*    -------------------------------
   638     05  DESC06L PIC S9(0004) COMP.
   639     05  DESC06F PIC  X(0001).
   640     05  FILLER REDEFINES DESC06F.
   641         10  DESC06A PIC  X(0001).
   642     05  DESC06I PIC  X(0060).
   643*    -------------------------------
   644     05  SEL07L PIC S9(0004) COMP.
   645     05  SEL07F PIC  X(0001).
   646     05  FILLER REDEFINES SEL07F.
   647         10  SEL07A PIC  X(0001).
   648     05  SEL07I PIC  X(0001).
   649*    -------------------------------
   650     05  EOBCD07L PIC S9(0004) COMP.
   651     05  EOBCD07F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  13
* EL614.cbl
   652     05  FILLER REDEFINES EOBCD07F.
   653         10  EOBCD07A PIC  X(0001).
   654     05  EOBCD07I PIC  X(0004).
   655*    -------------------------------
   656     05  DESC07L PIC S9(0004) COMP.
   657     05  DESC07F PIC  X(0001).
   658     05  FILLER REDEFINES DESC07F.
   659         10  DESC07A PIC  X(0001).
   660     05  DESC07I PIC  X(0060).
   661*    -------------------------------
   662     05  SEL08L PIC S9(0004) COMP.
   663     05  SEL08F PIC  X(0001).
   664     05  FILLER REDEFINES SEL08F.
   665         10  SEL08A PIC  X(0001).
   666     05  SEL08I PIC  X(0001).
   667*    -------------------------------
   668     05  EOBCD08L PIC S9(0004) COMP.
   669     05  EOBCD08F PIC  X(0001).
   670     05  FILLER REDEFINES EOBCD08F.
   671         10  EOBCD08A PIC  X(0001).
   672     05  EOBCD08I PIC  X(0004).
   673*    -------------------------------
   674     05  DESC08L PIC S9(0004) COMP.
   675     05  DESC08F PIC  X(0001).
   676     05  FILLER REDEFINES DESC08F.
   677         10  DESC08A PIC  X(0001).
   678     05  DESC08I PIC  X(0060).
   679*    -------------------------------
   680     05  SEL09L PIC S9(0004) COMP.
   681     05  SEL09F PIC  X(0001).
   682     05  FILLER REDEFINES SEL09F.
   683         10  SEL09A PIC  X(0001).
   684     05  SEL09I PIC  X(0001).
   685*    -------------------------------
   686     05  EOBCD09L PIC S9(0004) COMP.
   687     05  EOBCD09F PIC  X(0001).
   688     05  FILLER REDEFINES EOBCD09F.
   689         10  EOBCD09A PIC  X(0001).
   690     05  EOBCD09I PIC  X(0004).
   691*    -------------------------------
   692     05  DESC09L PIC S9(0004) COMP.
   693     05  DESC09F PIC  X(0001).
   694     05  FILLER REDEFINES DESC09F.
   695         10  DESC09A PIC  X(0001).
   696     05  DESC09I PIC  X(0060).
   697*    -------------------------------
   698     05  SEL10L PIC S9(0004) COMP.
   699     05  SEL10F PIC  X(0001).
   700     05  FILLER REDEFINES SEL10F.
   701         10  SEL10A PIC  X(0001).
   702     05  SEL10I PIC  X(0001).
   703*    -------------------------------
   704     05  EOBCD10L PIC S9(0004) COMP.
   705     05  EOBCD10F PIC  X(0001).
   706     05  FILLER REDEFINES EOBCD10F.
   707         10  EOBCD10A PIC  X(0001).
   708     05  EOBCD10I PIC  X(0004).
   709*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  14
* EL614.cbl
   710     05  DESC10L PIC S9(0004) COMP.
   711     05  DESC10F PIC  X(0001).
   712     05  FILLER REDEFINES DESC10F.
   713         10  DESC10A PIC  X(0001).
   714     05  DESC10I PIC  X(0060).
   715*    -------------------------------
   716     05  SEL11L PIC S9(0004) COMP.
   717     05  SEL11F PIC  X(0001).
   718     05  FILLER REDEFINES SEL11F.
   719         10  SEL11A PIC  X(0001).
   720     05  SEL11I PIC  X(0001).
   721*    -------------------------------
   722     05  EOBCD11L PIC S9(0004) COMP.
   723     05  EOBCD11F PIC  X(0001).
   724     05  FILLER REDEFINES EOBCD11F.
   725         10  EOBCD11A PIC  X(0001).
   726     05  EOBCD11I PIC  X(0004).
   727*    -------------------------------
   728     05  DESC11L PIC S9(0004) COMP.
   729     05  DESC11F PIC  X(0001).
   730     05  FILLER REDEFINES DESC11F.
   731         10  DESC11A PIC  X(0001).
   732     05  DESC11I PIC  X(0060).
   733*    -------------------------------
   734     05  SEL12L PIC S9(0004) COMP.
   735     05  SEL12F PIC  X(0001).
   736     05  FILLER REDEFINES SEL12F.
   737         10  SEL12A PIC  X(0001).
   738     05  SEL12I PIC  X(0001).
   739*    -------------------------------
   740     05  EOBCD12L PIC S9(0004) COMP.
   741     05  EOBCD12F PIC  X(0001).
   742     05  FILLER REDEFINES EOBCD12F.
   743         10  EOBCD12A PIC  X(0001).
   744     05  EOBCD12I PIC  X(0004).
   745*    -------------------------------
   746     05  DESC12L PIC S9(0004) COMP.
   747     05  DESC12F PIC  X(0001).
   748     05  FILLER REDEFINES DESC12F.
   749         10  DESC12A PIC  X(0001).
   750     05  DESC12I PIC  X(0060).
   751*    -------------------------------
   752     05  SEL13L PIC S9(0004) COMP.
   753     05  SEL13F PIC  X(0001).
   754     05  FILLER REDEFINES SEL13F.
   755         10  SEL13A PIC  X(0001).
   756     05  SEL13I PIC  X(0001).
   757*    -------------------------------
   758     05  EOBCD13L PIC S9(0004) COMP.
   759     05  EOBCD13F PIC  X(0001).
   760     05  FILLER REDEFINES EOBCD13F.
   761         10  EOBCD13A PIC  X(0001).
   762     05  EOBCD13I PIC  X(0004).
   763*    -------------------------------
   764     05  DESC13L PIC S9(0004) COMP.
   765     05  DESC13F PIC  X(0001).
   766     05  FILLER REDEFINES DESC13F.
   767         10  DESC13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  15
* EL614.cbl
   768     05  DESC13I PIC  X(0060).
   769*    -------------------------------
   770     05  SEL14L PIC S9(0004) COMP.
   771     05  SEL14F PIC  X(0001).
   772     05  FILLER REDEFINES SEL14F.
   773         10  SEL14A PIC  X(0001).
   774     05  SEL14I PIC  X(0001).
   775*    -------------------------------
   776     05  EOBCD14L PIC S9(0004) COMP.
   777     05  EOBCD14F PIC  X(0001).
   778     05  FILLER REDEFINES EOBCD14F.
   779         10  EOBCD14A PIC  X(0001).
   780     05  EOBCD14I PIC  X(0004).
   781*    -------------------------------
   782     05  DESC14L PIC S9(0004) COMP.
   783     05  DESC14F PIC  X(0001).
   784     05  FILLER REDEFINES DESC14F.
   785         10  DESC14A PIC  X(0001).
   786     05  DESC14I PIC  X(0060).
   787*    -------------------------------
   788     05  SEL15L PIC S9(0004) COMP.
   789     05  SEL15F PIC  X(0001).
   790     05  FILLER REDEFINES SEL15F.
   791         10  SEL15A PIC  X(0001).
   792     05  SEL15I PIC  X(0001).
   793*    -------------------------------
   794     05  EOBCD15L PIC S9(0004) COMP.
   795     05  EOBCD15F PIC  X(0001).
   796     05  FILLER REDEFINES EOBCD15F.
   797         10  EOBCD15A PIC  X(0001).
   798     05  EOBCD15I PIC  X(0004).
   799*    -------------------------------
   800     05  DESC15L PIC S9(0004) COMP.
   801     05  DESC15F PIC  X(0001).
   802     05  FILLER REDEFINES DESC15F.
   803         10  DESC15A PIC  X(0001).
   804     05  DESC15I PIC  X(0060).
   805*    -------------------------------
   806     05  SEL16L PIC S9(0004) COMP.
   807     05  SEL16F PIC  X(0001).
   808     05  FILLER REDEFINES SEL16F.
   809         10  SEL16A PIC  X(0001).
   810     05  SEL16I PIC  X(0001).
   811*    -------------------------------
   812     05  EOBCD16L PIC S9(0004) COMP.
   813     05  EOBCD16F PIC  X(0001).
   814     05  FILLER REDEFINES EOBCD16F.
   815         10  EOBCD16A PIC  X(0001).
   816     05  EOBCD16I PIC  X(0004).
   817*    -------------------------------
   818     05  DESC16L PIC S9(0004) COMP.
   819     05  DESC16F PIC  X(0001).
   820     05  FILLER REDEFINES DESC16F.
   821         10  DESC16A PIC  X(0001).
   822     05  DESC16I PIC  X(0060).
   823*    -------------------------------
   824     05  SEL17L PIC S9(0004) COMP.
   825     05  SEL17F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  16
* EL614.cbl
   826     05  FILLER REDEFINES SEL17F.
   827         10  SEL17A PIC  X(0001).
   828     05  SEL17I PIC  X(0001).
   829*    -------------------------------
   830     05  EOBCD17L PIC S9(0004) COMP.
   831     05  EOBCD17F PIC  X(0001).
   832     05  FILLER REDEFINES EOBCD17F.
   833         10  EOBCD17A PIC  X(0001).
   834     05  EOBCD17I PIC  X(0004).
   835*    -------------------------------
   836     05  DESC17L PIC S9(0004) COMP.
   837     05  DESC17F PIC  X(0001).
   838     05  FILLER REDEFINES DESC17F.
   839         10  DESC17A PIC  X(0001).
   840     05  DESC17I PIC  X(0060).
   841*    -------------------------------
   842     05  AEMSGL PIC S9(0004) COMP.
   843     05  AEMSGF PIC  X(0001).
   844     05  FILLER REDEFINES AEMSGF.
   845         10  AEMSGA PIC  X(0001).
   846     05  AEMSGI PIC  X(0079).
   847*    -------------------------------
   848     05  APFKL PIC S9(0004) COMP.
   849     05  APFKF PIC  X(0001).
   850     05  FILLER REDEFINES APFKF.
   851         10  APFKA PIC  X(0001).
   852     05  APFKI PIC  S99.
   853*    -------------------------------
   854     05  F3KEYL PIC S9(0004) COMP.
   855     05  F3KEYF PIC  X(0001).
   856     05  FILLER REDEFINES F3KEYF.
   857         10  F3KEYA PIC  X(0001).
   858     05  F3KEYI PIC  X(0019).
   859*    -------------------------------
   860     05  F5KEYL PIC S9(0004) COMP.
   861     05  F5KEYF PIC  X(0001).
   862     05  FILLER REDEFINES F5KEYF.
   863         10  F5KEYA PIC  X(0001).
   864     05  F5KEYI PIC  X(0025).
   865 01  EL614AO REDEFINES EL614AI.
   866     05  FILLER            PIC  X(0012).
   867*    -------------------------------
   868     05  FILLER            PIC  X(0003).
   869     05  ADATEO PIC  X(0008).
   870*    -------------------------------
   871     05  FILLER            PIC  X(0003).
   872     05  ATIMEO PIC  99.99.
   873*    -------------------------------
   874     05  FILLER            PIC  X(0003).
   875     05  SELHO PIC  X(0003).
   876*    -------------------------------
   877     05  FILLER            PIC  X(0003).
   878     05  SEL01O PIC  X(0001).
   879*    -------------------------------
   880     05  FILLER            PIC  X(0003).
   881     05  EOBCD01O PIC  X(0004).
   882*    -------------------------------
   883     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  17
* EL614.cbl
   884     05  DESC01O PIC  X(0060).
   885*    -------------------------------
   886     05  FILLER            PIC  X(0003).
   887     05  SEL02O PIC  X(0001).
   888*    -------------------------------
   889     05  FILLER            PIC  X(0003).
   890     05  EOBCD02O PIC  X(0004).
   891*    -------------------------------
   892     05  FILLER            PIC  X(0003).
   893     05  DESC02O PIC  X(0060).
   894*    -------------------------------
   895     05  FILLER            PIC  X(0003).
   896     05  SEL03O PIC  X(0001).
   897*    -------------------------------
   898     05  FILLER            PIC  X(0003).
   899     05  EOBCD03O PIC  X(0004).
   900*    -------------------------------
   901     05  FILLER            PIC  X(0003).
   902     05  DESC03O PIC  X(0060).
   903*    -------------------------------
   904     05  FILLER            PIC  X(0003).
   905     05  SEL04O PIC  X(0001).
   906*    -------------------------------
   907     05  FILLER            PIC  X(0003).
   908     05  EOBCD04O PIC  X(0004).
   909*    -------------------------------
   910     05  FILLER            PIC  X(0003).
   911     05  DESC04O PIC  X(0060).
   912*    -------------------------------
   913     05  FILLER            PIC  X(0003).
   914     05  SEL05O PIC  X(0001).
   915*    -------------------------------
   916     05  FILLER            PIC  X(0003).
   917     05  EOBCD05O PIC  X(0004).
   918*    -------------------------------
   919     05  FILLER            PIC  X(0003).
   920     05  DESC05O PIC  X(0060).
   921*    -------------------------------
   922     05  FILLER            PIC  X(0003).
   923     05  SEL06O PIC  X(0001).
   924*    -------------------------------
   925     05  FILLER            PIC  X(0003).
   926     05  EOBCD06O PIC  X(0004).
   927*    -------------------------------
   928     05  FILLER            PIC  X(0003).
   929     05  DESC06O PIC  X(0060).
   930*    -------------------------------
   931     05  FILLER            PIC  X(0003).
   932     05  SEL07O PIC  X(0001).
   933*    -------------------------------
   934     05  FILLER            PIC  X(0003).
   935     05  EOBCD07O PIC  X(0004).
   936*    -------------------------------
   937     05  FILLER            PIC  X(0003).
   938     05  DESC07O PIC  X(0060).
   939*    -------------------------------
   940     05  FILLER            PIC  X(0003).
   941     05  SEL08O PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  18
* EL614.cbl
   942*    -------------------------------
   943     05  FILLER            PIC  X(0003).
   944     05  EOBCD08O PIC  X(0004).
   945*    -------------------------------
   946     05  FILLER            PIC  X(0003).
   947     05  DESC08O PIC  X(0060).
   948*    -------------------------------
   949     05  FILLER            PIC  X(0003).
   950     05  SEL09O PIC  X(0001).
   951*    -------------------------------
   952     05  FILLER            PIC  X(0003).
   953     05  EOBCD09O PIC  X(0004).
   954*    -------------------------------
   955     05  FILLER            PIC  X(0003).
   956     05  DESC09O PIC  X(0060).
   957*    -------------------------------
   958     05  FILLER            PIC  X(0003).
   959     05  SEL10O PIC  X(0001).
   960*    -------------------------------
   961     05  FILLER            PIC  X(0003).
   962     05  EOBCD10O PIC  X(0004).
   963*    -------------------------------
   964     05  FILLER            PIC  X(0003).
   965     05  DESC10O PIC  X(0060).
   966*    -------------------------------
   967     05  FILLER            PIC  X(0003).
   968     05  SEL11O PIC  X(0001).
   969*    -------------------------------
   970     05  FILLER            PIC  X(0003).
   971     05  EOBCD11O PIC  X(0004).
   972*    -------------------------------
   973     05  FILLER            PIC  X(0003).
   974     05  DESC11O PIC  X(0060).
   975*    -------------------------------
   976     05  FILLER            PIC  X(0003).
   977     05  SEL12O PIC  X(0001).
   978*    -------------------------------
   979     05  FILLER            PIC  X(0003).
   980     05  EOBCD12O PIC  X(0004).
   981*    -------------------------------
   982     05  FILLER            PIC  X(0003).
   983     05  DESC12O PIC  X(0060).
   984*    -------------------------------
   985     05  FILLER            PIC  X(0003).
   986     05  SEL13O PIC  X(0001).
   987*    -------------------------------
   988     05  FILLER            PIC  X(0003).
   989     05  EOBCD13O PIC  X(0004).
   990*    -------------------------------
   991     05  FILLER            PIC  X(0003).
   992     05  DESC13O PIC  X(0060).
   993*    -------------------------------
   994     05  FILLER            PIC  X(0003).
   995     05  SEL14O PIC  X(0001).
   996*    -------------------------------
   997     05  FILLER            PIC  X(0003).
   998     05  EOBCD14O PIC  X(0004).
   999*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  19
* EL614.cbl
  1000     05  FILLER            PIC  X(0003).
  1001     05  DESC14O PIC  X(0060).
  1002*    -------------------------------
  1003     05  FILLER            PIC  X(0003).
  1004     05  SEL15O PIC  X(0001).
  1005*    -------------------------------
  1006     05  FILLER            PIC  X(0003).
  1007     05  EOBCD15O PIC  X(0004).
  1008*    -------------------------------
  1009     05  FILLER            PIC  X(0003).
  1010     05  DESC15O PIC  X(0060).
  1011*    -------------------------------
  1012     05  FILLER            PIC  X(0003).
  1013     05  SEL16O PIC  X(0001).
  1014*    -------------------------------
  1015     05  FILLER            PIC  X(0003).
  1016     05  EOBCD16O PIC  X(0004).
  1017*    -------------------------------
  1018     05  FILLER            PIC  X(0003).
  1019     05  DESC16O PIC  X(0060).
  1020*    -------------------------------
  1021     05  FILLER            PIC  X(0003).
  1022     05  SEL17O PIC  X(0001).
  1023*    -------------------------------
  1024     05  FILLER            PIC  X(0003).
  1025     05  EOBCD17O PIC  X(0004).
  1026*    -------------------------------
  1027     05  FILLER            PIC  X(0003).
  1028     05  DESC17O PIC  X(0060).
  1029*    -------------------------------
  1030     05  FILLER            PIC  X(0003).
  1031     05  AEMSGO PIC  X(0079).
  1032*    -------------------------------
  1033     05  FILLER            PIC  X(0003).
  1034     05  APFKO PIC  X(0002).
  1035*    -------------------------------
  1036     05  FILLER            PIC  X(0003).
  1037     05  F3KEYO PIC  X(0019).
  1038*    -------------------------------
  1039     05  FILLER            PIC  X(0003).
  1040     05  F5KEYO PIC  X(0025).
  1041*    -------------------------------
  1042 01  EL614AO-R REDEFINES EL614AI.
  1043     05  FILLER                      PIC X(37).
  1044     05  WS-MAP-LINE                 OCCURS 17
  1045                                     INDEXED BY M1 M2 N1.
  1046         10  SELL                    PIC S9(4)  COMP.
  1047         10  SELA                    PIC X.
  1048         10  SELI                    PIC X.
  1049         10  RCODEL                  PIC S9(4)  COMP.
  1050         10  RCODEA                  PIC X.
  1051         10  RCODEO                  PIC XXXX.
  1052         10  RCODEI                  REDEFINES
  1053             RCODEO                  PIC XXXX.
  1054         10  DESCL                   PIC S9(4)   COMP.
  1055         10  DESCA                   PIC X.
  1056         10  DESCO                   PIC X(60).
  1057         10  DESCI                   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  20
* EL614.cbl
  1058             DESCO                   PIC X(60).
  1059     05  FILLER                      PIC X(137).
  1060*    COPY ELCJPFX.
  1061******************************************************************
  1062*                                                                *
  1063*                                                                *
  1064*                            ELCJPFX.                            *
  1065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1066*                            VMOD=2.002                          *
  1067*                                                                *
  1068*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1069*                                                                *
  1070*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1071*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1072*        ELCNTL - CONTROL FILE                                   *
  1073*        ELMSTR - CLAIM MASTERS                                  *
  1074*        ELTRLR - ACTIVITY TRAILERS                              *
  1075*        ELCHKQ - CHECK QUE                                      *
  1076******************************************************************
  1077 01  JOURNAL-RECORD.
  1078     12  JP-USER-ID                  PIC X(4).
  1079     12  JP-FILE-ID                  PIC X(8).
  1080     12  JP-PROGRAM-ID               PIC X(8).
  1081     12  JP-RECORD-TYPE              PIC X.
  1082         88 JP-ADD              VALUE 'A'.
  1083         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1084         88 JP-AFTER-CHANGE     VALUE 'C'.
  1085         88 JP-DELETE           VALUE 'D'.
  1086         88 JP-GENERIC-DELETE   VALUE 'G'.
  1087         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1088         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1089     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1090     12  JP-RECORD-AREA
  1091
  1092
  1093                                     PIC X(750).
  1094*                                COPY ELCEOBC.
  1095******************************************************************
  1096*                                                                *
  1097*                                                                *
  1098*                            ELCEOBC                             *
  1099*                            VMOD=2.001                          *
  1100*                                                                *
  1101*   CLAIM SYSTEM EOB CODE TABLE                                  *
  1102*                                                                *
  1103*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1104*   VSAM EOB CODE TABLE                                          *
  1105*                                                                *
  1106*   FILE DESCRIPTION = EOB CODE TABLE                            *
  1107*                                                                *
  1108*   FILE TYPE = VSAM,KSDS                                        *
  1109*   RECORD SIZE = 350   RECFORM = FIX                            *
  1110*                                                                *
  1111*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  1112*                                                                *
  1113*   LOG = NO                                                     *
  1114*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1115*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  21
* EL614.cbl
  1116*                                                                *
  1117******************************************************************
  1118*                   C H A N G E   L O G
  1119*
  1120* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1121*-----------------------------------------------------------------
  1122*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1123* EFFECTIVE    NUMBER
  1124*-----------------------------------------------------------------
  1125* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  1126* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  1127******************************************************************
  1128 01  EOB-CODES.
  1129     12  EO-RECORD-ID                      PIC XX.
  1130         88  VALID-DN-ID                      VALUE 'EO'.
  1131     12  EO-CONTROL-PRIMARY.
  1132         16  EO-COMPANY-CD                 PIC X.
  1133         16  EO-RECORD-TYPE                PIC X.
  1134             88  EO-EOB-RECS                  VALUE '1'.
  1135             88  EO-VERIF-RECS                VALUE '2'.
  1136             88  EO-GCE-RECS                  VALUE '3'.
  1137         16  EO-EOB-CODE                   PIC X(4).
  1138         16  FILLER                        PIC X(9).
  1139     12  EO-MAINT-INFORMATION.
  1140         16  EO-LAST-MAINT-DT              PIC XX.
  1141         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1142         16  EO-LAST-MAINT-USER            PIC X(4).
  1143         16  FILLER                        PIC XX.
  1144     12  EO-DESCRIPTION                    PIC X(275).
  1145     12  FILLER                            PIC X(46).
  1146******************************************************************
  1147*    COPY ELCEMIB.
  1148******************************************************************
  1149*                                                                *
  1150*                                                                *
  1151*                            ELCEMIB.                            *
  1152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1153*                            VMOD=2.005                          *
  1154*                                                                *
  1155*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1156*                                                                *
  1157******************************************************************
  1158 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1159     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1160     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1161     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1162     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1163     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1164     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1165     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1166     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1167     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1168         88  EMI-NO-ERRORS                    VALUE '1'.
  1169         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1170         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1171     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1172         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1173     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  22
* EL614.cbl
  1174         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1175         88  EMI-AREA1-FULL                   VALUE '2'.
  1176     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1177         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1178         88  EMI-AREA2-FULL                   VALUE '2'.
  1179     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1180         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1181         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1182         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1183         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1184         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1185     12  EMI-ERROR-LINES.
  1186         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1187         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1188         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1189         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1190             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1191                 24  EMI-ERR-NUM         PIC X(4).
  1192                 24  EMI-FILLER          PIC X.
  1193                 24  EMI-SEV             PIC X.
  1194                 24  FILLER              PIC X.
  1195             20  FILLER                  PIC X(02).
  1196     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1197         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1198             20  EMI-ERROR-NUMBER    PIC X(4).
  1199             20  EMI-FILL            PIC X.
  1200             20  EMI-SEVERITY        PIC X.
  1201             20  FILLER              PIC X.
  1202             20  EMI-ERROR-TEXT.
  1203                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1204                 24  FILLER          PIC X(55).
  1205     12  EMI-SEVERITY-SAVE           PIC X.
  1206         88  EMI-NOTE                    VALUE 'N'.
  1207         88  EMI-WARNING                 VALUE 'W'.
  1208         88  EMI-FORCABLE                VALUE 'F'.
  1209         88  EMI-FATAL                   VALUE 'X'.
  1210     12  EMI-MESSAGE-FLAG            PIC X.
  1211         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1212         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1213     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1214     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1215         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1216         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1217         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1218     12  FILLER                      PIC X(137)  VALUE SPACES.
  1219     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1220     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1221     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1222     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1223*    COPY ELCDATE.
  1224******************************************************************
  1225*                                                                *
  1226*                                                                *
  1227*                            ELCDATE.                            *
  1228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1229*                            VMOD=2.003
  1230*                                                                *
  1231*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  23
* EL614.cbl
  1232*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1233*                 LENGTH = 200                                   *
  1234******************************************************************
  1235
  1236 01  DATE-CONVERSION-DATA.
  1237     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1238     12  DC-OPTION-CODE                PIC X.
  1239         88  BIN-TO-GREG                VALUE ' '.
  1240         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1241         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1242         88  YMD-GREG-TO-BIN            VALUE '3'.
  1243         88  MDY-GREG-TO-BIN            VALUE '4'.
  1244         88  JULIAN-TO-BIN              VALUE '5'.
  1245         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1246         88  FIND-CENTURY               VALUE '7'.
  1247         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1248         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1249         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1250         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1251         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1252         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1253         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1254         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1255         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1256         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1257         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1258         88  BIN-3-TO-GREG              VALUE 'I'.
  1259         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1260         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1261         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1262         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1263         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1264         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1265         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1266         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1267         88  THREE-CHARACTER-BIN
  1268                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1269         88  GREGORIAN-TO-BIN
  1270                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1271         88  BIN-TO-GREGORIAN
  1272                  VALUES ' ' '1' 'I' '8' 'G'.
  1273         88  JULIAN-TO-BINARY
  1274                  VALUES '5' 'C' 'E' 'F'.
  1275     12  DC-ERROR-CODE                 PIC X.
  1276         88  NO-CONVERSION-ERROR        VALUE ' '.
  1277         88  DATE-CONVERSION-ERROR
  1278                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1279         88  DATE-IS-ZERO               VALUE '1'.
  1280         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1281         88  DATE-IS-INVALID            VALUE '3'.
  1282         88  DATE1-GREATER-DATE2        VALUE '4'.
  1283         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1284         88  DATE-INVALID-OPTION        VALUE '9'.
  1285         88  INVALID-CENTURY            VALUE 'A'.
  1286         88  ONLY-CENTURY               VALUE 'B'.
  1287         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1288         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1289     12  DC-END-OF-MONTH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  24
* EL614.cbl
  1290         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1291     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1292         88  USE-NORMAL-PROCESS         VALUE ' '.
  1293         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1294         88  ADJUST-UP-100-YRS          VALUE '2'.
  1295     12  FILLER                        PIC X.
  1296     12  DC-CONVERSION-DATES.
  1297         16  DC-BIN-DATE-1             PIC XX.
  1298         16  DC-BIN-DATE-2             PIC XX.
  1299         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1300         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1301                       DC-GREG-DATE-1-EDIT.
  1302             20  DC-EDIT1-MONTH        PIC 99.
  1303             20  SLASH1-1              PIC X.
  1304             20  DC-EDIT1-DAY          PIC 99.
  1305             20  SLASH1-2              PIC X.
  1306             20  DC-EDIT1-YEAR         PIC 99.
  1307         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1308         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1309                     DC-GREG-DATE-2-EDIT.
  1310             20  DC-EDIT2-MONTH        PIC 99.
  1311             20  SLASH2-1              PIC X.
  1312             20  DC-EDIT2-DAY          PIC 99.
  1313             20  SLASH2-2              PIC X.
  1314             20  DC-EDIT2-YEAR         PIC 99.
  1315         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1316         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1317                     DC-GREG-DATE-1-YMD.
  1318             20  DC-YMD-YEAR           PIC 99.
  1319             20  DC-YMD-MONTH          PIC 99.
  1320             20  DC-YMD-DAY            PIC 99.
  1321         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1322         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1323                      DC-GREG-DATE-1-MDY.
  1324             20  DC-MDY-MONTH          PIC 99.
  1325             20  DC-MDY-DAY            PIC 99.
  1326             20  DC-MDY-YEAR           PIC 99.
  1327         16  DC-GREG-DATE-1-ALPHA.
  1328             20  DC-ALPHA-MONTH        PIC X(10).
  1329             20  DC-ALPHA-DAY          PIC 99.
  1330             20  FILLER                PIC XX.
  1331             20  DC-ALPHA-CENTURY.
  1332                 24 DC-ALPHA-CEN-N     PIC 99.
  1333             20  DC-ALPHA-YEAR         PIC 99.
  1334         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1335         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1336         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1337         16  DC-JULIAN-DATE            PIC 9(05).
  1338         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1339                                       PIC 9(05).
  1340         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1341             20  DC-JULIAN-YEAR        PIC 99.
  1342             20  DC-JULIAN-DAYS        PIC 999.
  1343         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1344         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1345         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1346     12  DATE-CONVERSION-VARIBLES.
  1347         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  25
* EL614.cbl
  1348         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1349             20  FILLER                PIC 9(3).
  1350             20  HOLD-CEN-1-CCYY.
  1351                 24  HOLD-CEN-1-CC     PIC 99.
  1352                 24  HOLD-CEN-1-YY     PIC 99.
  1353             20  HOLD-CEN-1-MO         PIC 99.
  1354             20  HOLD-CEN-1-DA         PIC 99.
  1355         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1356             20  HOLD-CEN-1-R-MO       PIC 99.
  1357             20  HOLD-CEN-1-R-DA       PIC 99.
  1358             20  HOLD-CEN-1-R-CCYY.
  1359                 24  HOLD-CEN-1-R-CC   PIC 99.
  1360                 24  HOLD-CEN-1-R-YY   PIC 99.
  1361             20  FILLER                PIC 9(3).
  1362         16  HOLD-CENTURY-1-X.
  1363             20  FILLER                PIC X(3)  VALUE SPACES.
  1364             20  HOLD-CEN-1-X-CCYY.
  1365                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1366                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1367             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1368             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1369         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1370             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1371             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1372             20  HOLD-CEN-1-R-X-CCYY.
  1373                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1374                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1375             20  FILLER                PIC XXX.
  1376         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1377         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1378         16  DC-JULIAN-DATE-1          PIC 9(07).
  1379         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1380             20  DC-JULIAN-1-CCYY.
  1381                 24  DC-JULIAN-1-CC    PIC 99.
  1382                 24  DC-JULIAN-1-YR    PIC 99.
  1383             20  DC-JULIAN-DA-1        PIC 999.
  1384         16  DC-JULIAN-DATE-2          PIC 9(07).
  1385         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1386             20  DC-JULIAN-2-CCYY.
  1387                 24  DC-JULIAN-2-CC    PIC 99.
  1388                 24  DC-JULIAN-2-YR    PIC 99.
  1389             20  DC-JULIAN-DA-2        PIC 999.
  1390         16  DC-GREG-DATE-A-EDIT.
  1391             20  DC-EDITA-MONTH        PIC 99.
  1392             20  SLASHA-1              PIC X VALUE '/'.
  1393             20  DC-EDITA-DAY          PIC 99.
  1394             20  SLASHA-2              PIC X VALUE '/'.
  1395             20  DC-EDITA-CCYY.
  1396                 24  DC-EDITA-CENT     PIC 99.
  1397                 24  DC-EDITA-YEAR     PIC 99.
  1398         16  DC-GREG-DATE-B-EDIT.
  1399             20  DC-EDITB-MONTH        PIC 99.
  1400             20  SLASHB-1              PIC X VALUE '/'.
  1401             20  DC-EDITB-DAY          PIC 99.
  1402             20  SLASHB-2              PIC X VALUE '/'.
  1403             20  DC-EDITB-CCYY.
  1404                 24  DC-EDITB-CENT     PIC 99.
  1405                 24  DC-EDITB-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  26
* EL614.cbl
  1406         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1407         16  DC-GREG-DATE-CYMD-R REDEFINES
  1408                              DC-GREG-DATE-CYMD.
  1409             20  DC-CYMD-CEN           PIC 99.
  1410             20  DC-CYMD-YEAR          PIC 99.
  1411             20  DC-CYMD-MONTH         PIC 99.
  1412             20  DC-CYMD-DAY           PIC 99.
  1413         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1414         16  DC-GREG-DATE-MDCY-R REDEFINES
  1415                              DC-GREG-DATE-MDCY.
  1416             20  DC-MDCY-MONTH         PIC 99.
  1417             20  DC-MDCY-DAY           PIC 99.
  1418             20  DC-MDCY-CEN           PIC 99.
  1419             20  DC-MDCY-YEAR          PIC 99.
  1420    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1421        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1422    12  DC-EL310-DATE                  PIC X(21).
  1423    12  FILLER                         PIC X(28).
  1424*    COPY ELCLOGOF.
  1425******************************************************************
  1426*                                                                *
  1427*                                                                *
  1428*                            ELCLOGOF.                           *
  1429*                            VMOD=2.001                          *
  1430*                                                                *
  1431*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1432*                                                                *
  1433******************************************************************
  1434 01  CLASIC-LOGOFF.
  1435     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1436     12  LOGOFF-TEXT.
  1437         16  FILLER          PIC X(5)    VALUE SPACES.
  1438         16  LOGOFF-MSG.
  1439             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1440             20  FILLER      PIC X       VALUE SPACES.
  1441             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1442         16  FILLER          PIC X(80)
  1443           VALUE '* YOU ARE NOW LOGGED OFF'.
  1444         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1445         16  FILLER          PIC X       VALUE QUOTE.
  1446         16  LOGOFF-SYS-MSG  PIC X(17)
  1447           VALUE 'S CLAS-IC SYSTEM '.
  1448     12  TEXT-MESSAGES.
  1449         16  UNACCESS-MSG    PIC X(29)
  1450             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1451         16  PGMIDERR-MSG    PIC X(17)
  1452             VALUE 'PROGRAM NOT FOUND'.
  1453*    COPY ELCATTR.
  1454******************************************************************
  1455*                                                                *
  1456*                            ELCATTR.                            *
  1457*                            VMOD=2.001                          *
  1458*                                                                *
  1459*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1460*                                                                *
  1461*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1462*                                                                *
  1463*                   POS 1   P=PROTECTED                          *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  27
* EL614.cbl
  1464*                           U=UNPROTECTED                        *
  1465*                           S=ASKIP                              *
  1466*                   POS 2   A=ALPHA/NUMERIC                      *
  1467*                           N=NUMERIC                            *
  1468*                   POS 3   N=NORMAL                             *
  1469*                           B=BRIGHT                             *
  1470*                           D=DARK                               *
  1471*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1472*                           OF=MODIFIED DATA TAG OFF             *
  1473*                                                                *
  1474*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1475******************************************************************
  1476 01  ATTRIBUTE-LIST.
  1477     12  AL-PABOF            PIC X       VALUE 'Y'.
  1478     12  AL-PABON            PIC X       VALUE 'Z'.
  1479     12  AL-PADOF            PIC X       VALUE '%'.
  1480     12  AL-PADON            PIC X       VALUE '_'.
  1481     12  AL-PANOF            PIC X       VALUE '-'.
  1482     12  AL-PANON            PIC X       VALUE '/'.
  1483     12  AL-SABOF            PIC X       VALUE '8'.
  1484     12  AL-SABON            PIC X       VALUE '9'.
  1485     12  AL-SADOF            PIC X       VALUE '@'.
  1486     12  AL-SADON            PIC X       VALUE QUOTE.
  1487     12  AL-SANOF            PIC X       VALUE '0'.
  1488     12  AL-SANON            PIC X       VALUE '1'.
  1489     12  AL-UABOF            PIC X       VALUE 'H'.
  1490     12  AL-UABON            PIC X       VALUE 'I'.
  1491     12  AL-UADOF            PIC X       VALUE '<'.
  1492     12  AL-UADON            PIC X       VALUE '('.
  1493     12  AL-UANOF            PIC X       VALUE ' '.
  1494     12  AL-UANON            PIC X       VALUE 'A'.
  1495     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1496     12  AL-UNBON            PIC X       VALUE 'R'.
  1497     12  AL-UNDOF            PIC X       VALUE '*'.
  1498     12  AL-UNDON            PIC X       VALUE ')'.
  1499     12  AL-UNNOF            PIC X       VALUE '&'.
  1500     12  AL-UNNON            PIC X       VALUE 'J'.
  1501*    COPY ELCAID.
  1502******************************************************************
  1503*                                                                *
  1504*                            ELCAID.                             *
  1505*                            VMOD=2.001                          *
  1506*                                                                *
  1507*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1508*                                                                *
  1509*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1510*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1511******************************************************************
  1512
  1513 01  DFHAID.
  1514   02  DFHNULL   PIC  X  VALUE  ' '.
  1515   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1516   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1517   02  DFHPEN    PIC  X  VALUE  '='.
  1518   02  DFHOPID   PIC  X  VALUE  'W'.
  1519   02  DFHPA1    PIC  X  VALUE  '%'.
  1520   02  DFHPA2    PIC  X  VALUE  '>'.
  1521   02  DFHPA3    PIC  X  VALUE  ','.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  28
* EL614.cbl
  1522   02  DFHPF1    PIC  X  VALUE  '1'.
  1523   02  DFHPF2    PIC  X  VALUE  '2'.
  1524   02  DFHPF3    PIC  X  VALUE  '3'.
  1525   02  DFHPF4    PIC  X  VALUE  '4'.
  1526   02  DFHPF5    PIC  X  VALUE  '5'.
  1527   02  DFHPF6    PIC  X  VALUE  '6'.
  1528   02  DFHPF7    PIC  X  VALUE  '7'.
  1529   02  DFHPF8    PIC  X  VALUE  '8'.
  1530   02  DFHPF9    PIC  X  VALUE  '9'.
  1531   02  DFHPF10   PIC  X  VALUE  ':'.
  1532   02  DFHPF11   PIC  X  VALUE  '#'.
  1533   02  DFHPF12   PIC  X  VALUE  '@'.
  1534   02  DFHPF13   PIC  X  VALUE  'A'.
  1535   02  DFHPF14   PIC  X  VALUE  'B'.
  1536   02  DFHPF15   PIC  X  VALUE  'C'.
  1537   02  DFHPF16   PIC  X  VALUE  'D'.
  1538   02  DFHPF17   PIC  X  VALUE  'E'.
  1539   02  DFHPF18   PIC  X  VALUE  'F'.
  1540   02  DFHPF19   PIC  X  VALUE  'G'.
  1541   02  DFHPF20   PIC  X  VALUE  'H'.
  1542   02  DFHPF21   PIC  X  VALUE  'I'.
  1543*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1544   02  DFHPF22   PIC  X  VALUE  '['.
  1545   02  DFHPF23   PIC  X  VALUE  '.'.
  1546   02  DFHPF24   PIC  X  VALUE  '<'.
  1547   02  DFHMSRE   PIC  X  VALUE  'X'.
  1548   02  DFHSTRF   PIC  X  VALUE  'h'.
  1549   02  DFHTRIG   PIC  X  VALUE  '"'.
  1550 01  FILLER    REDEFINES DFHAID.
  1551     05  FILLER                      PIC X(8).
  1552     05  PF-VALUES                   PIC X
  1553         OCCURS 24 TIMES.
  1554****************************************************************
  1555*
  1556* Copyright (c) 2007 by Clerity Solutions, Inc.
  1557* All rights reserved.
  1558*
  1559****************************************************************
  1560 01  DFHEIV.
  1561   02  DFHEIV0               PIC X(35).
  1562   02  DFHEIV1               PIC X(08).
  1563   02  DFHEIV2               PIC X(08).
  1564   02  DFHEIV3               PIC X(08).
  1565   02  DFHEIV4               PIC X(06).
  1566   02  DFHEIV5               PIC X(04).
  1567   02  DFHEIV6               PIC X(04).
  1568   02  DFHEIV7               PIC X(02).
  1569   02  DFHEIV8               PIC X(02).
  1570   02  DFHEIV9               PIC X(01).
  1571   02  DFHEIV10              PIC S9(7) COMP-3.
  1572   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1573   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1574   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1575   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1576   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1577   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1578   02  DFHEIV17              PIC X(04).
  1579   02  DFHEIV18              PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  29
* EL614.cbl
  1580   02  DFHEIV19              PIC X(04).
  1581   02  DFHEIV20              USAGE IS POINTER.
  1582   02  DFHEIV21              USAGE IS POINTER.
  1583   02  DFHEIV22              USAGE IS POINTER.
  1584   02  DFHEIV23              USAGE IS POINTER.
  1585   02  DFHEIV24              USAGE IS POINTER.
  1586   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1587   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1588   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1589   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1590   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1591   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1592   02  FILLER                PIC X(02).
  1593   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1594   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1595   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1596   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1597   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1598 LINKAGE  SECTION.
  1599*****************************************************************
  1600*                                                               *
  1601* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1602* All rights reserved.                                          *
  1603*                                                               *
  1604*****************************************************************
  1605 01  dfheiblk.
  1606     02  eibtime          pic s9(7) comp-3.
  1607     02  eibdate          pic s9(7) comp-3.
  1608     02  eibtrnid         pic x(4).
  1609     02  eibtaskn         pic s9(7) comp-3.
  1610     02  eibtrmid         pic x(4).
  1611     02  dfheigdi         pic s9(4) comp.
  1612     02  eibcposn         pic s9(4) comp.
  1613     02  eibcalen         pic s9(4) comp.
  1614     02  eibaid           pic x(1).
  1615     02  eibfiller1       pic x(1).
  1616     02  eibfn            pic x(2).
  1617     02  eibfiller2       pic x(2).
  1618     02  eibrcode         pic x(6).
  1619     02  eibfiller3       pic x(2).
  1620     02  eibds            pic x(8).
  1621     02  eibreqid         pic x(8).
  1622     02  eibrsrce         pic x(8).
  1623     02  eibsync          pic x(1).
  1624     02  eibfree          pic x(1).
  1625     02  eibrecv          pic x(1).
  1626     02  eibsend          pic x(1).
  1627     02  eibatt           pic x(1).
  1628     02  eibeoc           pic x(1).
  1629     02  eibfmh           pic x(1).
  1630     02  eibcompl         pic x(1).
  1631     02  eibsig           pic x(1).
  1632     02  eibconf          pic x(1).
  1633     02  eiberr           pic x(1).
  1634     02  eibrldbk         pic x(1).
  1635     02  eiberrcd         pic x(4).
  1636     02  eibsynrb         pic x(1).
  1637     02  eibnodat         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  30
* EL614.cbl
  1638     02  eibfiller5       pic x(2).
  1639     02  eibresp          pic 9(09) comp.
  1640     02  eibresp2         pic 9(09) comp.
  1641     02  dfheigdj         pic s9(4) comp.
  1642     02  dfheigdk         pic s9(4) comp.
  1643 01  DFHCOMMAREA                     PIC X(1024).
  1644 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1645 0000-DFHEXIT SECTION.
  1646     MOVE '9#                    $   ' TO DFHEIV0.
  1647     MOVE 'EL614' TO DFHEIV1.
  1648     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1649     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1650     MOVE '5'                   TO DC-OPTION-CODE.
  1651     PERFORM 8500-DATE-CONVERSION
  1652                                THRU 8500-EXIT
  1653     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1654     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1655     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1656     MOVE +1                    TO  EMI-NUMBER-OF-LINES
  1657                                    EMI-SWITCH2.
  1658     IF EIBCALEN NOT > ZERO
  1659        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1660        GO TO 8300-SEND-TEXT
  1661     END-IF
  1662
  1663* EXEC CICS HANDLE CONDITION
  1664*        PGMIDERR (9600-PGMIDERR)
  1665*        ERROR    (9990-ERROR)
  1666*    END-EXEC
  1667*    MOVE '"$L.                  ! " #00001658' TO DFHEIV0
  1668     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1670     MOVE X'2220233030303031363538' TO DFHEIV0(25:11)
  1671     CALL 'kxdfhei1' USING DFHEIV0
  1672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1673     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1674        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1675           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1676           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1677           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1678           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1679           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1680           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1681           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1682           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1683        ELSE
  1684           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1685           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1686           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1687           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1688           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1689           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1690           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1691           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1692        END-IF
  1693     END-IF
  1694     IF EIBTRNID NOT = WS-TRANS-ID
  1695        GO TO 1000-INITIAL-SCREEN
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  31
* EL614.cbl
  1696     END-IF
  1697     IF EIBAID = DFHCLEAR
  1698        GO TO 9400-CLEAR
  1699     END-IF
  1700     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1701        MOVE LOW-VALUES          TO EL614AO
  1702        MOVE -1                  TO APFKL
  1703        MOVE ER-0008             TO EMI-ERROR
  1704        GO TO 8200-SEND-DATAONLY
  1705     END-IF
  1706
  1707* EXEC CICS RECEIVE
  1708*        INTO   (EL614AO)
  1709*        MAPSET (WS-MAPSET-NAME)
  1710*        MAP    (WS-MAP-NAME)
  1711*    END-EXEC
  1712     MOVE LENGTH OF
  1713      EL614AO
  1714       TO DFHEIV11
  1715*    MOVE '8"T I  L              ''   #00001695' TO DFHEIV0
  1716     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1718     MOVE X'2020233030303031363935' TO DFHEIV0(25:11)
  1719     CALL 'kxdfhei1' USING DFHEIV0,
  1720           WS-MAP-NAME,
  1721           EL614AO,
  1722           DFHEIV11,
  1723           WS-MAPSET-NAME,
  1724           DFHEIV99,
  1725           DFHEIV99
  1726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1727     display ' received map ' el614ao
  1728     IF APFKL > ZERO
  1729        IF EIBAID NOT = DFHENTER
  1730           MOVE ER-0004          TO EMI-ERROR
  1731           MOVE AL-UNBOF         TO APFKA
  1732           MOVE -1               TO APFKL
  1733           GO TO 8200-SEND-DATAONLY
  1734        ELSE
  1735           IF APFKO NUMERIC AND
  1736              (APFKO > ZERO AND LESS '25')
  1737              MOVE PF-VALUES (APFKI)
  1738                                 TO  EIBAID
  1739           ELSE
  1740              MOVE ER-0029       TO  EMI-ERROR
  1741              MOVE AL-UNBOF      TO  APFKA
  1742              MOVE -1            TO  APFKL
  1743              GO TO 8200-SEND-DATAONLY
  1744           END-IF
  1745        END-IF
  1746     END-IF
  1747     IF EIBAID = DFHPF12
  1748        MOVE 'EL010'             TO THIS-PGM
  1749        GO TO 9300-XCTL
  1750     END-IF
  1751     IF EIBAID = DFHPF23
  1752        GO TO 9000-RETURN-CICS
  1753     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  32
* EL614.cbl
  1754     IF EIBAID = DFHPF24
  1755        IF CREDIT-SESSION
  1756           MOVE 'EL626'          TO THIS-PGM
  1757           GO TO 9300-XCTL
  1758        ELSE
  1759           MOVE 'EL126'          TO THIS-PGM
  1760           GO TO 9300-XCTL
  1761        END-IF
  1762     END-IF
  1763     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2
  1764        OR DFHPF3 OR DFHPF4 OR DFHPF5
  1765        CONTINUE
  1766     ELSE
  1767        MOVE ER-0008             TO EMI-ERROR
  1768        MOVE -1                  TO APFKL
  1769        GO TO 8200-SEND-DATAONLY
  1770     END-IF
  1771     IF EIBAID = DFHPF1 OR DFHPF2 OR DFHPF3
  1772        OR DFHPF4 OR DFHENTER OR DFHPF5
  1773        MOVE 'S'                 TO PI-MODE
  1774     ELSE
  1775        MOVE AL-UABOF            TO APFKA
  1776        MOVE -1                  TO APFKL
  1777        MOVE ER-0023             TO EMI-ERROR
  1778        PERFORM 9900-ERROR-FORMAT
  1779     END-IF
  1780     IF EMI-FATAL-CTR > ZERO
  1781        GO TO 8200-SEND-DATAONLY
  1782     END-IF
  1783     IF PI-MODE EQUAL 'S'
  1784        GO TO 2000-PROCESS-SHOW
  1785     END-IF
  1786     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL614'
  1787                                 TO LOGOFF-MSG
  1788     GO TO 8300-SEND-TEXT
  1789     .
  1790 1000-INITIAL-SCREEN.
  1791     DISPLAY ' MADE 1000 INITIAL '
  1792     MOVE PI-PROGRAM-WORK-AREA (1:60)
  1793                                 TO WS-PASSED-FROM-CALL-PGM
  1794     MOVE PI-REASON-CODE-IND     TO WS-REASON-CODE-PASSED
  1795     EVALUATE TRUE
  1796        WHEN PI-RETURN-TO-PROGRAM = 'EL156'
  1797           MOVE WS-PASSED-FROM-CALL-PGM
  1798                                 TO PI-PROGRAM-WORK-AREA
  1799           MOVE '1'              TO PI-RECORD-TYPE
  1800        WHEN PI-RETURN-TO-PROGRAM = 'EL6316'
  1801           MOVE WS-PASSED-FROM-CALL-PGM
  1802                                 TO PI-PROGRAM-WORK-AREA
  1803           MOVE '4'              TO PI-RECORD-TYPE
  1804           DISPLAY ' MOVING 4 TO RECORD TYPE '
  1805        WHEN PI-RETURN-TO-PROGRAM = 'EL6317'
  1806           MOVE WS-PASSED-FROM-CALL-PGM
  1807                                 TO PI-PROGRAM-WORK-AREA
  1808           MOVE '2'              TO PI-RECORD-TYPE
  1809           DISPLAY ' MOVING 2 TO RECORD TYPE '
  1810        WHEN PI-RETURN-TO-PROGRAM = 'EL6318'
  1811           MOVE WS-PASSED-FROM-CALL-PGM
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  33
* EL614.cbl
  1812                                 TO PI-PROGRAM-WORK-AREA
  1813           MOVE WS-REASON-CODE-PASSED TO PI-REASON-CODE-IND
  1814           MOVE 'N'              TO PI-EXPANDED-VIEW
  1815           MOVE '3'              TO PI-RECORD-TYPE
  1816           DISPLAY ' MOVING 3 TO RECORD TYPE '
  1817        WHEN OTHER
  1818           MOVE SPACES           TO PI-PROGRAM-WORK-AREA
  1819                                    WS-PASSED-FROM-CALL-PGM
  1820                                    PI-RECORD-TYPE
  1821     END-EVALUATE
  1822     MOVE PI-COMPANY-CD          TO PI-DN-TOP-KEY (1:1)
  1823                                    PI-DN-BOT-KEY (1:1)
  1824                                    WS-ELEOBC-KEY
  1825     MOVE PI-RECORD-TYPE         TO WS-EOB-REC-TYPE
  1826                                    PI-DN-TOP-KEY (2:1)
  1827                                    PI-DN-BOT-KEY (2:1)
  1828     MOVE ZERO                   TO PI-1ST-TIME-SW
  1829                                    PI-LINE-COUNT
  1830                                    PI-BROWSE-SW
  1831                                    PI-SHOW-SW
  1832                                    PI-CHANGE-SW
  1833     MOVE LOW-VALUES             TO EL614AO
  1834     GO TO 7000-BROWSE-FWD
  1835     .
  1836 2000-PROCESS-SHOW.
  1837**  THE FIRST THING TO DO IS CHECK
  1838**  FOR PF4 (CLEAR SELECTED CODES) IF PRESSED
  1839**  SPACE OUT THE PRIOR SELECTIONS. NEXT CHECK
  1840**  THE SELECTED CODES
  1841**  AGAINST THE TABLE AND SYNC THEM UP.
  1842**  IF THEY SPACE ONE OUT THEN GET RID OF IT FROM THE
  1843**  TABLE
  1844     display ' made it to 2000 process '
  1845     IF EIBAID = DFHPF4
  1846        MOVE SPACES              TO PI-SELECTED-EOB-CODES
  1847        MOVE PI-DN-TOP-KEY    TO WS-ELEOBC-KEY
  1848        GO TO 7000-BROWSE-FWD
  1849     END-IF
  1850
  1851     IF EIBAID = DFHPF5
  1852         IF PI-EXPANDED-VIEW = 'Y'
  1853             MOVE 'N'        TO PI-EXPANDED-VIEW
  1854         ELSE
  1855             MOVE 'Y'        TO PI-EXPANDED-VIEW
  1856         END-IF
  1857         MOVE PI-DN-TOP-KEY    TO WS-ELEOBC-KEY
  1858         GO TO 7000-BROWSE-FWD
  1859     END-IF
  1860     display ' 2000 return to pgm ' pi-return-to-program
  1861     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317' OR 'EL6318'
  1862        OR 'EL6316'
  1863        display ' made past if '
  1864        PERFORM VARYING M1 FROM +1 BY +1 UNTIL
  1865           M1 > +17
  1866           IF SELL (M1) > +0
  1867              display ' sell > 0 ' sell (m1)
  1868              IF SELI (M1) = SPACES
  1869                display ' sell = sp ' sell (m1)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  34
* EL614.cbl
  1870                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1871                    E1 > +12
  1872                    IF PI-EOB-CODE (E1) = RCODEI (M1)
  1873                       MOVE SPACES TO PI-EOB-CODE (E1)
  1874                    END-IF
  1875                 END-PERFORM
  1876              ELSE
  1877                 MOVE ' '       TO WS-DUP-EOB-SW
  1878                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1879                    E1 > +12
  1880                    IF RCODEI (M1) = PI-EOB-CODE (E1)
  1881                      display ' rcd = pi '
  1882                       SET FOUND-DUP-EOB TO TRUE
  1883                    END-IF
  1884                 END-PERFORM
  1885                 IF NOT FOUND-DUP-EOB
  1886                   display ' no dups '
  1887                    PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1888                       (PI-EOB-CODE (E1) = SPACES)
  1889                       OR (E1 > +12)
  1890                    END-PERFORM
  1891                    IF E1 < +13
  1892                      display ' e1 < 13 ' rcodei (m1)
  1893                       MOVE RCODEI (M1) TO PI-EOB-CODE (E1)
  1894                    END-IF
  1895                 END-IF
  1896              END-IF
  1897           END-IF
  1898        END-PERFORM
  1899     END-IF
  1900     display ' eob codes ' PI-SELECTED-EOB-CODES
  1901     EVALUATE TRUE
  1902        WHEN EIBAID = DFHPF2
  1903           MOVE PI-DN-TOP-KEY    TO WS-ELEOBC-KEY
  1904           GO TO 8000-BROWSE-BWD
  1905        WHEN EIBAID = DFHPF1
  1906           MOVE PI-DN-BOT-KEY    TO WS-ELEOBC-KEY
  1907           GO TO 7000-BROWSE-FWD
  1908        WHEN EIBAID = DFHPF3
  1909           PERFORM 6100-FORMAT-EOB-CODES
  1910                                 THRU 6100-EXIT
  1911           GO TO 9400-CLEAR
  1912        WHEN OTHER
  1913*          MOVE PI-COMPANY-CD    TO WS-ELEOBC-KEY
  1914*          GO TO 7000-BROWSE-FWD
  1915           MOVE -1 TO SELL (1)
  1916           GO TO 8200-SEND-DATAONLY
  1917     END-EVALUATE
  1918     .
  1919 6100-FORMAT-EOB-CODES.
  1920**  THIS ROUTINE JUST ELIMINATES ANY EOB CODES THAT
  1921**  WERE "UN SELECTED"
  1922     display ' made it to 6100 '
  1923     MOVE SPACES                 TO WS-SELECTED-EOB-CODES
  1924     MOVE +1                     TO E1 S1
  1925     PERFORM UNTIL E1 > +12
  1926        IF PI-EOB-CODE (E1) NOT = SPACES
  1927           MOVE PI-EOB-CODE (E1) TO WS-SEL-EOB-CODE (S1)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  35
* EL614.cbl
  1928           ADD +1                TO S1
  1929        END-IF
  1930        ADD +1                   TO E1
  1931     END-PERFORM
  1932     MOVE WS-SELECTED-EOB-CODES  TO PI-SELECTED-EOB-CODES
  1933     .
  1934 6100-EXIT.
  1935     EXIT.
  1936 7000-BROWSE-FWD.
  1937     SET M1  TO +1
  1938
  1939* EXEC CICS STARTBR
  1940*        DATASET   ('ELEOBC')
  1941*        RIDFLD    (WS-ELEOBC-KEY)
  1942*        GTEQ
  1943*        RESP      (WS-RESPONSE)
  1944*    END-EXEC
  1945     MOVE 'ELEOBC' TO DFHEIV1
  1946     MOVE 0
  1947       TO DFHEIV11
  1948*    MOVE '&,         G          &  N#00001911' TO DFHEIV0
  1949     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1950     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1951     MOVE X'204E233030303031393131' TO DFHEIV0(25:11)
  1952     CALL 'kxdfhei1' USING DFHEIV0,
  1953           DFHEIV1,
  1954           WS-ELEOBC-KEY,
  1955           DFHEIV99,
  1956           DFHEIV11,
  1957           DFHEIV99
  1958     MOVE EIBRESP  TO WS-RESPONSE
  1959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1960     EVALUATE TRUE
  1961        WHEN RESP-ENDFILE
  1962           GO TO 7030-END-FILE
  1963        WHEN RESP-NORMAL
  1964           CONTINUE
  1965        WHEN RESP-NOTFND
  1966           GO TO 7040-NOT-FOUND
  1967     END-EVALUATE
  1968     MOVE LOW-VALUES             TO EL614AO
  1969     MOVE ZERO                   TO PI-LINE-COUNT
  1970     MOVE +1                     TO PI-BROWSE-SW
  1971     MOVE +0                     TO CI1
  1972     .
  1973 7010-READ-NEXT.
  1974
  1975* EXEC CICS READNEXT
  1976*        INTO    (EOB-CODES)
  1977*        DATASET ('ELEOBC')
  1978*        RIDFLD  (WS-ELEOBC-KEY)
  1979*        RESP    (WS-RESPONSE)
  1980*    END-EXEC
  1981     MOVE LENGTH OF
  1982      EOB-CODES
  1983       TO DFHEIV12
  1984     MOVE 'ELEOBC' TO DFHEIV1
  1985     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  36
* EL614.cbl
  1986       TO DFHEIV11
  1987*    MOVE '&.IL                  )  N#00001931' TO DFHEIV0
  1988     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1989     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1990     MOVE X'204E233030303031393331' TO DFHEIV0(25:11)
  1991     CALL 'kxdfhei1' USING DFHEIV0,
  1992           DFHEIV1,
  1993           EOB-CODES,
  1994           DFHEIV12,
  1995           WS-ELEOBC-KEY,
  1996           DFHEIV99,
  1997           DFHEIV11,
  1998           DFHEIV99,
  1999           DFHEIV99
  2000     MOVE EIBRESP  TO WS-RESPONSE
  2001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2002     EVALUATE TRUE
  2003        WHEN RESP-ENDFILE
  2004           GO TO 7030-END-FILE
  2005        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2006           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2007               AND (PI-RECORD-TYPE NOT = SPACES))
  2008           GO TO 7030-END-FILE
  2009        WHEN RESP-NORMAL
  2010           CONTINUE
  2011        WHEN RESP-NOTFND
  2012           GO TO 7040-NOT-FOUND
  2013        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2014           GO TO 7030-END-FILE
  2015     END-EVALUATE
  2016     ADD +1                      TO WS-RECORD-COUNT
  2017                                    CI1
  2018     MOVE EO-CONTROL-PRIMARY     TO PI-DN-BOT-KEY
  2019     MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2020     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2021         MOVE EO-EOB-CODE        TO WS-TABLE-CODE
  2022         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
  2023         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
  2024         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
  2025     ELSE
  2026         MOVE EO-EOB-CODE        TO RCODEO (M1)
  2027     END-IF
  2028     MOVE EO-DESCRIPTION         TO DESCO (M1)
  2029
  2030     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2031        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2032          S2 > +26
  2033            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
  2034               MOVE AL-SABON TO RCODEA (M1)
  2035               MOVE AL-SABOF TO DESCA (M1)
  2036            END-IF
  2037        END-PERFORM
  2038     END-IF
  2039     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
  2040        OR 'EL6316'
  2041        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2042           E1 > +12
  2043           IF EO-EOB-CODE = PI-EOB-CODE (E1)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  37
* EL614.cbl
  2044              MOVE 'S'           TO SELI (M1)
  2045              MOVE +1            TO SELL (M1)
  2046           END-IF
  2047        END-PERFORM
  2048     END-IF
  2049     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2050        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2051           E1 > +12
  2052           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
  2053           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
  2054           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
  2055           IF EO-EOB-CODE = WS-TABLE-CODE
  2056              MOVE 'S'           TO SELI (M1)
  2057              MOVE +1            TO SELL (M1)
  2058           END-IF
  2059        END-PERFORM
  2060     END-IF
  2061     IF M1 = +1
  2062        MOVE EO-CONTROL-PRIMARY  TO PI-DN-TOP-KEY
  2063     END-IF
  2064
  2065     IF PI-EXPANDED-VIEW = 'Y'
  2066         IF EO-DESCRIPTION (61:60) > SPACES AND M1 < +17
  2067             SET N1 TO M1
  2068             SET M1 UP BY +1
  2069             ADD +1 TO CI1
  2070             MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2071             MOVE EO-DESCRIPTION (61:60) TO DESCO (M1)
  2072             MOVE DESCA (N1)    TO DESCA (M1)
  2073             MOVE AL-SADOF      TO SELA (M1)
  2074         END-IF
  2075         IF EO-DESCRIPTION (121:60) > SPACES AND M1 < +17
  2076             SET N1 TO M1
  2077             SET M1 UP BY +1
  2078             ADD +1 TO CI1
  2079             MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2080             MOVE EO-DESCRIPTION (121:60) TO DESCO (M1)
  2081             MOVE DESCA (N1)    TO DESCA (M1)
  2082             MOVE AL-SADOF      TO SELA (M1)
  2083         END-IF
  2084         IF EO-DESCRIPTION (181:60) > SPACES AND M1 < +17
  2085             SET N1 TO M1
  2086             SET M1 UP BY +1
  2087             ADD +1 TO CI1
  2088             MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2089             MOVE EO-DESCRIPTION (181:60) TO DESCO (M1)
  2090             MOVE DESCA (N1)    TO DESCA (M1)
  2091             MOVE AL-SADOF      TO SELA (M1)
  2092         END-IF
  2093         IF EO-DESCRIPTION (241:35) > SPACES AND M1 < +17
  2094             SET N1 TO M1
  2095             SET M1 UP BY +1
  2096             ADD +1 TO CI1
  2097             MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2098             MOVE EO-DESCRIPTION (241:35) TO DESCO (M1)
  2099             MOVE DESCA (N1)    TO DESCA (M1)
  2100             MOVE AL-SADOF      TO SELA (M1)
  2101         END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  38
* EL614.cbl
  2102     END-IF
  2103     IF M1 < +17
  2104        SET M1 UP BY +1
  2105        GO TO 7010-READ-NEXT
  2106     END-IF
  2107     IF PI-BROWSE-SW = +1
  2108
  2109* EXEC CICS ENDBR
  2110*          DATASET ('ELEOBC')
  2111*       END-EXEC
  2112     MOVE 'ELEOBC' TO DFHEIV1
  2113     MOVE 0
  2114       TO DFHEIV11
  2115*    MOVE '&2                    $   #00002043' TO DFHEIV0
  2116     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2117     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2118     MOVE X'2020233030303032303433' TO DFHEIV0(25:11)
  2119     CALL 'kxdfhei1' USING DFHEIV0,
  2120           DFHEIV1,
  2121           DFHEIV11,
  2122           DFHEIV99
  2123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2124        MOVE +0                  TO PI-BROWSE-SW
  2125     END-IF
  2126     MOVE ER-0000                TO EMI-ERROR
  2127     GO TO 8100-SEND-INITIAL-MAP
  2128     .
  2129 7030-END-FILE.
  2130
  2131     IF PI-BROWSE-SW = +1
  2132
  2133* EXEC CICS ENDBR
  2134*          DATASET ('ELEOBC')
  2135*       END-EXEC
  2136     MOVE 'ELEOBC' TO DFHEIV1
  2137     MOVE 0
  2138       TO DFHEIV11
  2139*    MOVE '&2                    $   #00002054' TO DFHEIV0
  2140     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2141     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2142     MOVE X'2020233030303032303534' TO DFHEIV0(25:11)
  2143     CALL 'kxdfhei1' USING DFHEIV0,
  2144           DFHEIV1,
  2145           DFHEIV11,
  2146           DFHEIV99
  2147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2148        MOVE +0                  TO PI-BROWSE-SW
  2149     END-IF
  2150     IF EMI-ERROR = ER-1257
  2151        MOVE ER-7220             TO  EMI-ERROR
  2152     ELSE
  2153        MOVE ER-1258             TO  EMI-ERROR
  2154     END-IF
  2155     MOVE -1                     TO  APFKL
  2156     MOVE AL-UABOF               TO  APFKA
  2157     GO TO 8100-SEND-INITIAL-MAP
  2158     .
  2159 7040-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  39
* EL614.cbl
  2160
  2161     IF PI-BROWSE-SW = +1
  2162
  2163* EXEC CICS ENDBR
  2164*          DATASET ('ELEOBC')
  2165*       END-EXEC
  2166     MOVE 'ELEOBC' TO DFHEIV1
  2167     MOVE 0
  2168       TO DFHEIV11
  2169*    MOVE '&2                    $   #00002071' TO DFHEIV0
  2170     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2172     MOVE X'2020233030303032303731' TO DFHEIV0(25:11)
  2173     CALL 'kxdfhei1' USING DFHEIV0,
  2174           DFHEIV1,
  2175           DFHEIV11,
  2176           DFHEIV99
  2177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2178        MOVE +0                  TO PI-BROWSE-SW
  2179     END-IF
  2180     MOVE ER-0006                TO  EMI-ERROR
  2181     MOVE -1                     TO  APFKL
  2182     MOVE AL-UABOF               TO  APFKA
  2183     IF EIBTRNID NOT = WS-TRANS-ID
  2184        GO TO 8100-SEND-INITIAL-MAP
  2185     ELSE
  2186        GO TO 8200-SEND-DATAONLY
  2187     END-IF
  2188     .
  2189*****************************************************************
  2190 8000-BROWSE-BWD.
  2191*****************************************************************
  2192     SET M1                      TO +17
  2193     MOVE +18                    TO CI1
  2194
  2195* EXEC CICS STARTBR
  2196*       DATASET ('ELEOBC')
  2197*       RIDFLD  (WS-ELEOBC-KEY)
  2198*       GTEQ
  2199*       RESP    (WS-RESPONSE)
  2200*    END-EXEC
  2201     MOVE 'ELEOBC' TO DFHEIV1
  2202     MOVE 0
  2203       TO DFHEIV11
  2204*    MOVE '&,         G          &  N#00002090' TO DFHEIV0
  2205     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2206     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2207     MOVE X'204E233030303032303930' TO DFHEIV0(25:11)
  2208     CALL 'kxdfhei1' USING DFHEIV0,
  2209           DFHEIV1,
  2210           WS-ELEOBC-KEY,
  2211           DFHEIV99,
  2212           DFHEIV11,
  2213           DFHEIV99
  2214     MOVE EIBRESP  TO WS-RESPONSE
  2215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2216     EVALUATE TRUE
  2217        WHEN RESP-ENDFILE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  40
* EL614.cbl
  2218           GO TO 8020-END-FILE
  2219        WHEN RESP-NORMAL
  2220           CONTINUE
  2221        WHEN RESP-NOTFND
  2222           GO TO 8030-NOT-FOUND
  2223     END-EVALUATE
  2224     MOVE LOW-VALUES             TO EL614AO
  2225     MOVE ZERO                   TO PI-LINE-COUNT
  2226     MOVE +1                     TO PI-BROWSE-SW
  2227     .
  2228 8010-READ-PREV.
  2229
  2230* EXEC CICS READPREV
  2231*       INTO    (EOB-CODES)
  2232*       DATASET ('ELEOBC')
  2233*       RIDFLD  (WS-ELEOBC-KEY)
  2234*       RESP    (WS-RESPONSE)
  2235*    END-EXEC
  2236     MOVE LENGTH OF
  2237      EOB-CODES
  2238       TO DFHEIV12
  2239     MOVE 'ELEOBC' TO DFHEIV1
  2240     MOVE 0
  2241       TO DFHEIV11
  2242*    MOVE '&0IL                  )  N#00002109' TO DFHEIV0
  2243     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
  2244     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2245     MOVE X'204E233030303032313039' TO DFHEIV0(25:11)
  2246     CALL 'kxdfhei1' USING DFHEIV0,
  2247           DFHEIV1,
  2248           EOB-CODES,
  2249           DFHEIV12,
  2250           WS-ELEOBC-KEY,
  2251           DFHEIV99,
  2252           DFHEIV11,
  2253           DFHEIV99,
  2254           DFHEIV99
  2255     MOVE EIBRESP  TO WS-RESPONSE
  2256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2257     EVALUATE TRUE
  2258        WHEN RESP-ENDFILE
  2259           MOVE ER-1257             TO EMI-ERROR
  2260           GO TO 8020-END-FILE
  2261        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2262           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2263               AND (PI-RECORD-TYPE NOT = SPACES))
  2264           MOVE ER-1257             TO EMI-ERROR
  2265           GO TO 8020-END-FILE
  2266        WHEN RESP-NORMAL
  2267           CONTINUE
  2268        WHEN RESP-NOTFND
  2269           GO TO 8030-NOT-FOUND
  2270     END-EVALUATE
  2271     IF EO-COMPANY-CD NOT = PI-COMPANY-CD
  2272        MOVE ER-1257             TO EMI-ERROR
  2273        GO TO 8020-END-FILE
  2274     END-IF
  2275     ADD +1                      TO WS-RECORD-COUNT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  41
* EL614.cbl
  2276     SUBTRACT +1                 FROM CI1
  2277
  2278     IF PI-EXPANDED-VIEW = 'Y'
  2279         EVALUATE TRUE
  2280           WHEN EO-DESCRIPTION (241:35) > SPACES
  2281             IF M1 < +5
  2282                 GO TO 8020-END-FILE
  2283             ELSE
  2284                 SET M1 DOWN BY +4
  2285                 SUBTRACT +4 FROM CI1
  2286             END-IF
  2287           WHEN EO-DESCRIPTION (181:60) > SPACES
  2288             IF M1 < +4
  2289                 GO TO 8020-END-FILE
  2290             ELSE
  2291                 SET M1 DOWN BY +3
  2292                 SUBTRACT +3 FROM CI1
  2293             END-IF
  2294           WHEN EO-DESCRIPTION (121:60) > SPACES
  2295             IF M1 < +3
  2296                 GO TO 8020-END-FILE
  2297             ELSE
  2298                 SET M1 DOWN BY +2
  2299                 SUBTRACT +2 FROM CI1
  2300             END-IF
  2301           WHEN EO-DESCRIPTION (61:60) > SPACES
  2302             IF M1 < +2
  2303                 GO TO 8020-END-FILE
  2304             ELSE
  2305                 SET M1 DOWN BY +1
  2306                 SUBTRACT +1 FROM CI1
  2307             END-IF
  2308         END-EVALUATE
  2309     END-IF
  2310     MOVE EO-CONTROL-PRIMARY     TO PI-DN-TOP-KEY
  2311     MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2312     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2313         MOVE EO-EOB-CODE        TO WS-TABLE-CODE
  2314         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
  2315         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
  2316         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
  2317     ELSE
  2318         MOVE EO-EOB-CODE        TO RCODEO (M1)
  2319     END-IF
  2320     MOVE EO-DESCRIPTION         TO DESCO  (M1)
  2321
  2322     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2323        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2324          S2 > +26
  2325            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
  2326               MOVE AL-SABON TO RCODEA (M1)
  2327               MOVE AL-SABOF TO DESCA (M1)
  2328            END-IF
  2329        END-PERFORM
  2330     END-IF
  2331     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
  2332        OR 'EL6316'
  2333        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  42
* EL614.cbl
  2334           E1 > +12
  2335           IF EO-EOB-CODE = PI-EOB-CODE (E1)
  2336              MOVE 'S'           TO SELI (M1)
  2337              MOVE +1            TO SELL (M1)
  2338           END-IF
  2339        END-PERFORM
  2340     END-IF
  2341     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2342        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2343           E1 > +12
  2344           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
  2345           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
  2346           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
  2347           IF EO-EOB-CODE = WS-TABLE-CODE
  2348              MOVE 'S'           TO SELI (M1)
  2349              MOVE +1            TO SELL (M1)
  2350           END-IF
  2351        END-PERFORM
  2352     END-IF
  2353     IF M1 = +17
  2354        MOVE EO-CONTROL-PRIMARY  TO PI-DN-BOT-KEY
  2355     END-IF
  2356
  2357     SET M2 TO M1
  2358     IF PI-EXPANDED-VIEW = 'Y'
  2359         IF EO-DESCRIPTION (61:60) > SPACES
  2360             SET N1 TO M1
  2361             SET M1 UP BY +1
  2362             MOVE EO-DESCRIPTION (61:60) TO DESCO (M1)
  2363             MOVE DESCA (N1)    TO DESCA (M1)
  2364             MOVE AL-SADOF      TO SELA (M1)
  2365         END-IF
  2366         IF EO-DESCRIPTION (121:60) > SPACES
  2367             SET N1 TO M1
  2368             SET M1 UP BY +1
  2369             MOVE EO-DESCRIPTION (121:60) TO DESCO (M1)
  2370             MOVE DESCA (N1)    TO DESCA (M1)
  2371             MOVE AL-SADOF      TO SELA (M1)
  2372         END-IF
  2373         IF EO-DESCRIPTION (181:60) > SPACES
  2374             SET N1 TO M1
  2375             SET M1 UP BY +1
  2376             MOVE EO-DESCRIPTION (181:60) TO DESCO (M1)
  2377             MOVE DESCA (N1)    TO DESCA (M1)
  2378             MOVE AL-SADOF      TO SELA (M1)
  2379         END-IF
  2380         IF EO-DESCRIPTION (241:35) > SPACES
  2381             SET N1 TO M1
  2382             SET M1 UP BY +1
  2383             MOVE EO-DESCRIPTION (241:35) TO DESCO (M1)
  2384             MOVE DESCA (N1)    TO DESCA (M1)
  2385             MOVE AL-SADOF      TO SELA (M1)
  2386         END-IF
  2387     END-IF
  2388     SET M1 TO M2
  2389     IF M1 > +1
  2390        SET M1                   DOWN BY +1
  2391        GO TO 8010-READ-PREV
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  43
* EL614.cbl
  2392     END-IF
  2393     IF PI-BROWSE-SW = +1
  2394
  2395* EXEC CICS ENDBR
  2396*          DATASET ('ELEOBC')
  2397*       END-EXEC
  2398     MOVE 'ELEOBC' TO DFHEIV1
  2399     MOVE 0
  2400       TO DFHEIV11
  2401*    MOVE '&2                    $   #00002252' TO DFHEIV0
  2402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2404     MOVE X'2020233030303032323532' TO DFHEIV0(25:11)
  2405     CALL 'kxdfhei1' USING DFHEIV0,
  2406           DFHEIV1,
  2407           DFHEIV11,
  2408           DFHEIV99
  2409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2410        MOVE +0                  TO PI-BROWSE-SW
  2411     END-IF
  2412     MOVE ER-0000                TO EMI-ERROR
  2413     GO TO 8100-SEND-INITIAL-MAP
  2414     .
  2415 8020-END-FILE.
  2416
  2417     IF PI-BROWSE-SW = +1
  2418
  2419* EXEC CICS ENDBR
  2420*          DATASET ('ELEOBC')
  2421*       END-EXEC
  2422     MOVE 'ELEOBC' TO DFHEIV1
  2423     MOVE 0
  2424       TO DFHEIV11
  2425*    MOVE '&2                    $   #00002263' TO DFHEIV0
  2426     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2427     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2428     MOVE X'2020233030303032323633' TO DFHEIV0(25:11)
  2429     CALL 'kxdfhei1' USING DFHEIV0,
  2430           DFHEIV1,
  2431           DFHEIV11,
  2432           DFHEIV99
  2433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2434        MOVE +0                  TO PI-BROWSE-SW
  2435     END-IF
  2436     IF M1 > +1
  2437        MOVE PI-DN-TOP-KEY       TO WS-ELEOBC-KEY
  2438        GO TO 7000-BROWSE-FWD
  2439     END-IF
  2440
  2441     IF PI-EXPANDED-VIEW = 'Y'
  2442        MOVE PI-DN-TOP-KEY       TO WS-ELEOBC-KEY
  2443        GO TO 7000-BROWSE-FWD
  2444     END-IF
  2445
  2446     MOVE ER-1257                TO EMI-ERROR
  2447     MOVE -1                     TO  APFKL
  2448     MOVE AL-UABOF               TO  APFKA
  2449     GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  44
* EL614.cbl
  2450     .
  2451 8030-NOT-FOUND.
  2452
  2453     IF PI-BROWSE-SW = +1
  2454
  2455* EXEC CICS ENDBR
  2456*          DATASET ('ELEOBC')
  2457*       END-EXEC
  2458     MOVE 'ELEOBC' TO DFHEIV1
  2459     MOVE 0
  2460       TO DFHEIV11
  2461*    MOVE '&2                    $   #00002286' TO DFHEIV0
  2462     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2464     MOVE X'2020233030303032323836' TO DFHEIV0(25:11)
  2465     CALL 'kxdfhei1' USING DFHEIV0,
  2466           DFHEIV1,
  2467           DFHEIV11,
  2468           DFHEIV99
  2469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2470        MOVE +0                  TO PI-BROWSE-SW
  2471     END-IF
  2472     MOVE ER-0006                TO  EMI-ERROR
  2473     MOVE -1                     TO  APFKL
  2474     MOVE AL-UABOF               TO  APFKA
  2475     GO TO 8200-SEND-DATAONLY
  2476     .
  2477*****************************************************************
  2478 8100-SEND-INITIAL-MAP.
  2479*****************************************************************
  2480     MOVE -1                     TO  APFKL.
  2481     MOVE ZERO                   TO  PI-BROWSE-SW.
  2482     MOVE SAVE-DATE              TO  ADATEO.
  2483     MOVE EIBTIME                TO  TIME-IN.
  2484     MOVE TIME-OUT               TO  ATIMEO.
  2485     IF EMI-ERROR NOT = ZERO
  2486         PERFORM 9900-ERROR-FORMAT
  2487     END-IF
  2488     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO
  2489     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2490           'EL6318' AND 'EL6316'
  2491        MOVE AL-SADOF            TO SELHA
  2492                                    F3KEYA
  2493        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2494           S1 > +17
  2495           MOVE AL-SADOF         TO SELA (S1)
  2496        END-PERFORM
  2497     END-IF
  2498
  2499     IF PI-EXPANDED-VIEW = 'Y'
  2500         MOVE 'PF5=UNEXPAND DESCRIPTIONS' TO F5KEYO
  2501     ELSE
  2502         MOVE 'PF5=EXPAND DESCRIPTIONS  ' TO F5KEYO
  2503     END-IF
  2504
  2505* EXEC CICS SEND
  2506*        FROM   (EL614AO)
  2507*        MAPSET (WS-MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  45
* EL614.cbl
  2508*        MAP    (WS-MAP-NAME)
  2509*        CURSOR ERASE
  2510*    END-EXEC.
  2511     MOVE LENGTH OF
  2512      EL614AO
  2513       TO DFHEIV12
  2514     MOVE -1
  2515       TO DFHEIV11
  2516*    MOVE '8$     CT  E    H L F ,   #00002323' TO DFHEIV0
  2517     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2518     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2519     MOVE X'2020233030303032333233' TO DFHEIV0(25:11)
  2520     CALL 'kxdfhei1' USING DFHEIV0,
  2521           WS-MAP-NAME,
  2522           EL614AO,
  2523           DFHEIV12,
  2524           WS-MAPSET-NAME,
  2525           DFHEIV99,
  2526           DFHEIV99,
  2527           DFHEIV99,
  2528           DFHEIV11,
  2529           DFHEIV99,
  2530           DFHEIV99,
  2531           DFHEIV99
  2532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2533
  2534     GO TO 9100-RETURN-TRAN
  2535     .
  2536 8100-EXIT.
  2537      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  46
* EL614.cbl
  2539*****************************************************************
  2540 8200-SEND-DATAONLY.
  2541*****************************************************************
  2542     MOVE SAVE-DATE              TO  ADATEO.
  2543     MOVE EIBTIME                TO  TIME-IN.
  2544     MOVE TIME-OUT               TO  ATIMEO.
  2545     IF EMI-ERROR NOT = ZERO
  2546         PERFORM 9900-ERROR-FORMAT.
  2547     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO.
  2548     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2549           'EL6318' AND 'EL6316'
  2550        MOVE AL-SADOF            TO SELHA
  2551                                    F3KEYA
  2552        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2553           S1 > +17
  2554           MOVE AL-SADOF         TO SELA (S1)
  2555        END-PERFORM
  2556     END-IF
  2557
  2558* EXEC CICS SEND DATAONLY
  2559*        FROM   (EL614AO)
  2560*        MAPSET (WS-MAPSET-NAME)
  2561*        MAP    (WS-MAP-NAME)
  2562*        CURSOR
  2563*    END-EXEC.
  2564     MOVE LENGTH OF
  2565      EL614AO
  2566       TO DFHEIV12
  2567     MOVE -1
  2568       TO DFHEIV11
  2569*    MOVE '8$D    CT       H L F ,   #00002352' TO DFHEIV0
  2570     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2571     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2572     MOVE X'2020233030303032333532' TO DFHEIV0(25:11)
  2573     CALL 'kxdfhei1' USING DFHEIV0,
  2574           WS-MAP-NAME,
  2575           EL614AO,
  2576           DFHEIV12,
  2577           WS-MAPSET-NAME,
  2578           DFHEIV99,
  2579           DFHEIV99,
  2580           DFHEIV99,
  2581           DFHEIV11,
  2582           DFHEIV99,
  2583           DFHEIV99,
  2584           DFHEIV99
  2585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2586
  2587     GO TO 9100-RETURN-TRAN
  2588     .
  2589 8200-EXIT.
  2590      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  47
* EL614.cbl
  2592*****************************************************************
  2593 8300-SEND-TEXT.
  2594*****************************************************************
  2595
  2596* EXEC CICS SEND TEXT
  2597*        FROM   (LOGOFF-TEXT)
  2598*        LENGTH (LOGOFF-LENGTH)
  2599*        ERASE  FREEKB
  2600*    END-EXEC.
  2601*    MOVE '8&      T  E F  H   F -   #00002366' TO DFHEIV0
  2602     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2603     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2604     MOVE X'2020233030303032333636' TO DFHEIV0(25:11)
  2605     CALL 'kxdfhei1' USING DFHEIV0,
  2606           LOGOFF-TEXT,
  2607           LOGOFF-LENGTH,
  2608           DFHEIV99,
  2609           DFHEIV99,
  2610           DFHEIV99,
  2611           DFHEIV99,
  2612           DFHEIV99,
  2613           DFHEIV99,
  2614           DFHEIV99,
  2615           DFHEIV99,
  2616           DFHEIV99,
  2617           DFHEIV99
  2618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2619
  2620
  2621* EXEC CICS RETURN
  2622*    END-EXEC.
  2623*    MOVE '.(                    ''   #00002371' TO DFHEIV0
  2624     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2625     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2626     MOVE X'2020233030303032333731' TO DFHEIV0(25:11)
  2627     CALL 'kxdfhei1' USING DFHEIV0,
  2628           DFHEIV99,
  2629           DFHEIV99,
  2630           DFHEIV99,
  2631           DFHEIV99,
  2632           DFHEIV99,
  2633           DFHEIV99
  2634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2635
  2636 8300-EXIT.
  2637      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  48
* EL614.cbl
  2639*****************************************************************
  2640 8400-LOG-JOURNAL-RECORD.
  2641*****************************************************************
  2642     IF PI-JOURNAL-FILE-ID = 0
  2643         GO TO 8400-EXIT.
  2644     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2645     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  2646     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2647*    EXEC CICS JOURNAL
  2648*        JFILEID (PI-JOURNAL-FILE-ID)
  2649*        JTYPEID (WS-JOURNAL-TYPE-ID)
  2650*        FROM    (JOURNAL-RECORD)
  2651*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  2652*    END-EXEC.
  2653 8400-EXIT.
  2654      EXIT.
  2655*****************************************************************
  2656 8500-DATE-CONVERSION.
  2657*****************************************************************
  2658
  2659* EXEC CICS LINK
  2660*        PROGRAM  ('ELDATCV')
  2661*        COMMAREA (DATE-CONVERSION-DATA)
  2662*        LENGTH   (DC-COMM-LENGTH)
  2663*    END-EXEC.
  2664     MOVE 'ELDATCV' TO DFHEIV1
  2665*    MOVE '."C                   (   #00002395' TO DFHEIV0
  2666     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2668     MOVE X'2020233030303032333935' TO DFHEIV0(25:11)
  2669     CALL 'kxdfhei1' USING DFHEIV0,
  2670           DFHEIV1,
  2671           DATE-CONVERSION-DATA,
  2672           DC-COMM-LENGTH,
  2673           DFHEIV99,
  2674           DFHEIV99,
  2675           DFHEIV99,
  2676           DFHEIV99
  2677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2678
  2679 8500-EXIT.
  2680      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  49
* EL614.cbl
  2682*****************************************************************
  2683 9000-RETURN-CICS.
  2684*****************************************************************
  2685     MOVE 'EL005'                TO  THIS-PGM.
  2686     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2687     PERFORM 9300-XCTL.
  2688 9000-EXIT.
  2689      EXIT.
  2690*****************************************************************
  2691 9100-RETURN-TRAN.
  2692*****************************************************************
  2693     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2694     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2695
  2696* EXEC CICS RETURN
  2697*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2698*        LENGTH   (PI-COMM-LENGTH)
  2699*        TRANSID  (WS-TRANS-ID)
  2700*    END-EXEC.
  2701*    MOVE '.(CT                  ''   #00002416' TO DFHEIV0
  2702     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2704     MOVE X'2020233030303032343136' TO DFHEIV0(25:11)
  2705     CALL 'kxdfhei1' USING DFHEIV0,
  2706           WS-TRANS-ID,
  2707           PROGRAM-INTERFACE-BLOCK,
  2708           PI-COMM-LENGTH,
  2709           DFHEIV99,
  2710           DFHEIV99,
  2711           DFHEIV99
  2712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2713
  2714 9100-EXIT.
  2715      EXIT.
  2716*****************************************************************
  2717 9300-XCTL.
  2718*****************************************************************
  2719     MOVE DFHENTER               TO  EIBAID.
  2720
  2721* EXEC CICS XCTL
  2722*        PROGRAM  (THIS-PGM)
  2723*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2724*        LENGTH   (PI-COMM-LENGTH)
  2725*    END-EXEC.
  2726*    MOVE '.$C                   %   #00002427' TO DFHEIV0
  2727     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2728     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2729     MOVE X'2020233030303032343237' TO DFHEIV0(25:11)
  2730     CALL 'kxdfhei1' USING DFHEIV0,
  2731           THIS-PGM,
  2732           PROGRAM-INTERFACE-BLOCK,
  2733           PI-COMM-LENGTH,
  2734           DFHEIV99
  2735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2736
  2737 9300-EXIT.
  2738      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  50
* EL614.cbl
  2740*****************************************************************
  2741 9400-CLEAR.
  2742*****************************************************************
  2743     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  2744     display ' el614 - returning to ' this-pgm
  2745     display ' pi 1 60' pi-program-WORK-AREA (1:60)
  2746     PERFORM 9300-XCTL.
  2747 9400-EXIT.
  2748      EXIT.
  2749*****************************************************************
  2750 9600-PGMIDERR.
  2751*****************************************************************
  2752
  2753* EXEC CICS HANDLE CONDITION
  2754*        PGMIDERR (8300-SEND-TEXT)
  2755*    END-EXEC.
  2756*    MOVE '"$L                   ! # #00002447' TO DFHEIV0
  2757     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2759     MOVE X'2320233030303032343437' TO DFHEIV0(25:11)
  2760     CALL 'kxdfhei1' USING DFHEIV0
  2761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2762
  2763     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2764                                     LOGOFF-PGM.
  2765     MOVE 'EL005'                TO  THIS-PGM.
  2766     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2767     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2768     PERFORM 9300-XCTL.
  2769 9600-EXIT.
  2770      EXIT.
  2771*****************************************************************
  2772 9900-ERROR-FORMAT.
  2773*****************************************************************
  2774     IF EMI-ERRORS-COMPLETE
  2775         ADD +1             TO  EMI-FATAL-CTR
  2776         MOVE ZERO          TO  EMI-ERROR
  2777         GO TO 9900-EXIT.
  2778
  2779* EXEC CICS LINK
  2780*        PROGRAM  ('EL001')
  2781*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2782*        LENGTH   (EMI-COMM-LENGTH)
  2783*    END-EXEC.
  2784     MOVE 'EL001' TO DFHEIV1
  2785*    MOVE '."C                   (   #00002465' TO DFHEIV0
  2786     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2787     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2788     MOVE X'2020233030303032343635' TO DFHEIV0(25:11)
  2789     CALL 'kxdfhei1' USING DFHEIV0,
  2790           DFHEIV1,
  2791           ERROR-MESSAGE-INTERFACE-BLOCK,
  2792           EMI-COMM-LENGTH,
  2793           DFHEIV99,
  2794           DFHEIV99,
  2795           DFHEIV99,
  2796           DFHEIV99
  2797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  51
* EL614.cbl
  2798
  2799     MOVE ZERO              TO  EMI-ERROR.
  2800 9900-EXIT.
  2801      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  52
* EL614.cbl
  2803*****************************************************************
  2804 9990-ERROR.
  2805*****************************************************************
  2806     MOVE DFHEIBLK               TO EMI-LINE1.
  2807
  2808* EXEC CICS LINK
  2809*        PROGRAM   ('EL004')
  2810*        COMMAREA  (EMI-LINE1)
  2811*        LENGTH    (72)
  2812*    END-EXEC.
  2813     MOVE 'EL004' TO DFHEIV1
  2814     MOVE 72
  2815       TO DFHEIV11
  2816*    MOVE '."C                   (   #00002478' TO DFHEIV0
  2817     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2819     MOVE X'2020233030303032343738' TO DFHEIV0(25:11)
  2820     CALL 'kxdfhei1' USING DFHEIV0,
  2821           DFHEIV1,
  2822           EMI-LINE1,
  2823           DFHEIV11,
  2824           DFHEIV99,
  2825           DFHEIV99,
  2826           DFHEIV99,
  2827           DFHEIV99
  2828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2829
  2830     PERFORM 8200-SEND-DATAONLY.
  2831     GO TO 9100-RETURN-TRAN.
  2832 9990-EXIT.
  2833      EXIT.
  2834*****************************************************************
  2835 9995-SECURITY-VIOLATION.
  2836*****************************************************************
  2837*           COPY ELCSCTP.
  2838******************************************************************
  2839*                                                                *
  2840*                            ELCSCTP                             *
  2841*                            VMOD=2.001                          *
  2842*                                                                *
  2843*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2844******************************************************************
  2845
  2846
  2847     MOVE EIBDATE          TO SM-JUL-DATE.
  2848     MOVE EIBTRMID         TO SM-TERMID.
  2849     MOVE THIS-PGM         TO SM-PGM.
  2850     MOVE EIBTIME          TO TIME-IN.
  2851     MOVE TIME-OUT         TO SM-TIME.
  2852     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2853
  2854
  2855* EXEC CICS LINK
  2856*         PROGRAM  ('EL003')
  2857*         COMMAREA (SECURITY-MESSAGE)
  2858*         LENGTH   (80)
  2859*    END-EXEC.
  2860     MOVE 'EL003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:18 Page  53
* EL614.cbl
  2861     MOVE 80
  2862       TO DFHEIV11
  2863*    MOVE '."C                   (   #00002507' TO DFHEIV0
  2864     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2866     MOVE X'2020233030303032353037' TO DFHEIV0(25:11)
  2867     CALL 'kxdfhei1' USING DFHEIV0,
  2868           DFHEIV1,
  2869           SECURITY-MESSAGE,
  2870           DFHEIV11,
  2871           DFHEIV99,
  2872           DFHEIV99,
  2873           DFHEIV99,
  2874           DFHEIV99
  2875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2876
  2877
  2878******************************************************************
  2879
  2880 9995-EXIT.
  2881      EXIT.
  2882 9999-LAST-PARAGRAPH SECTION.
  2883
  2884* GOBACK.
  2885     MOVE '9%                    "   ' TO DFHEIV0
  2886     MOVE 'EL614' TO DFHEIV1
  2887     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2888     GOBACK.
  2889
  2890 9999-DFHBACK SECTION.
  2891     MOVE '9%                    "   ' TO DFHEIV0
  2892     MOVE 'EL614' TO DFHEIV1
  2893     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2894     GOBACK.
  2895 9999-DFHEXIT.
  2896     IF DFHEIGDJ EQUAL 0001
  2897         NEXT SENTENCE
  2898     ELSE IF DFHEIGDJ EQUAL 2
  2899         GO TO 9600-PGMIDERR,
  2900               9990-ERROR
  2901         DEPENDING ON DFHEIGDI
  2902     ELSE IF DFHEIGDJ EQUAL 3
  2903         GO TO 8300-SEND-TEXT
  2904         DEPENDING ON DFHEIGDI.
  2905     MOVE '9%                    "   ' TO DFHEIV0
  2906     MOVE 'EL614' TO DFHEIV1
  2907     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2908     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6228     Code:        8987
