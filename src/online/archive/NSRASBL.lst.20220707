* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.   NSRASBL.
     4*AUTHOR.     PABLO
     5*            COLLEYVILLE, TEXAS.
     6*REMARKS.    EXECUTED FROM NSRASLTR
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   2
* NSRASBL.cbl
    14*-----------------------------------------------------------------
    15* 060611    2011022800001  PEMA  NEW PROGRAM
    16* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    17* 071212    2011022800001  AJRA  ADD UNDW ID
    18* 072312    2011022800001  AJRA    ADD NEW FIELDS
    19* 090612  IR2012090600001  AJRA  NAPERSOFT
    20* 091112  IR2012091100002  AJRA  FIX AKA
    21* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    22* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    23* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    24* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    25* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    26* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    27* 110612    2012101700002  AJRA  ADD NEW FIELDS
    28* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    29* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    30* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    31* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    32* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    33* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    34* 011514    2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    35* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    36* 121015  CR2015100900001  TANA  ADD VIN NUMBER
    37* 020916  CR2016010700001  TANA  CALL SQL LOOKUP NAPERSOFT TABLE
    38* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    39* 061821  CR2017031500001  TANA  FIX LOOKUP TABLE READ FOR CCM8
    40******************************************************************
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 working-storage section.
    44 01  DFH-START PIC X(04).
    45 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    46 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    47 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    48 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    49 77  SAVE-NEXT-BUS-DT-EDIT-A     PIC X(10)   VALUE SPACES.
    50 77  SAVE-CYCLE-DAY-OF-WEEK      PIC S9   COMP-3 VALUE +0.
    51 77  S1                          PIC S999 COMP-3 VALUE +0.
    52 77  E1                          PIC S999 COMP-3 VALUE +0.
    53 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    54 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    55 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    56 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    57 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    58 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    59 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    60 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    61 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    62 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    63 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    64 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    65     88  FOUND-BENE                  VALUE 'Y'.
    66 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    67 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    68 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    69 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    70     88  END-OF-ERPNDB              VALUE 'Y'.
    71 77  WS-ERACCT-SW                PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   3
* NSRASBL.cbl
    72     88  ACCT-FOUND                 VALUE 'Y'.
    73 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    74     88  CERT-FOUND                 VALUE 'Y'.
    75     88  CERT-NOT-FOUND             VALUE 'N'.
    76 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    77     88  ENDT-FOUND                 VALUE 'Y'.
    78     88  ENDT-NOT-FOUND             VALUE 'N'.
    79 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    80     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    81 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    82 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    83 77  WS-LF-EARN                  PIC X     VALUE ' '.
    84 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    85 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    86 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    87 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    88 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    89 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    90 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    91 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    92 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    93 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    98 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    99 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
   100 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
   101 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
   102     88  PROCESS-ISSUE               VALUE 'I'.
   103     88  PROCESS-CANCEL              VALUE 'C'.
   104 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
   105 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
   106 77  WS-DIFF                     PIC 999 VALUE ZEROS.
   107 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
   108 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   109 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   110 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   111 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
*  112 EXEC SQL
*  113    INCLUDE SQLDA
*  114 END-EXEC
   115 01 SQLDA sync.
   116    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   117    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   118    05 SQLN                  PIC S9(4) COMP-5 value 0.
   119    05 SQLD                  PIC S9(4) COMP-5 value 0.
   120    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   121       10 SQLTYPE            PIC S9(4) COMP-5.
   122       10 SQLLEN             PIC S9(4) COMP-5.
   123$IF P64 SET
   124X      *> For 64-bit environments, ensure that SQLDATA is
   125X      *> aligned on an 8-byte boundary.
   126X      10 FILLER             PIC S9(9) COMP-5.
   127$END
   128       10 SQLDATA            USAGE POINTER.
   129       10 SQLIND             USAGE POINTER.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   4
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130       10 SQLNAME.
   131          15 SQLNAMEL        PIC S9(4) COMP-5.
   132          15 SQLNAMEC        PIC X(30).
   133
   134* Values for SQLTYPE
   135
   136 78  ESQL-DATE-CHAR              VALUE 384.
   137 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   138 78  ESQL-DATE-REC               VALUE 386.
   139 78  ESQL-DATE-REC-NULL          VALUE 387.
   140 78  ESQL-TIME-CHAR              VALUE 388.
   141 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   142 78  ESQL-TIME-REC               VALUE 390.
   143 78  ESQL-TIME-REC-NULL          VALUE 391.
   144 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   145 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   146 78  ESQL-TIMESTAMP-REC          VALUE 394.
   147 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   148 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   149 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   150 78  ESQL-TS-OFFSET-REC          VALUE 398.
   151 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   152 78  ESQL-LONGVARBINARY          VALUE 404.
   153 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   154 78  ESQL-LONGVARCHAR            VALUE 408.
   155 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   156 78  ESQL-BINARY                 VALUE 444.
   157 78  ESQL-BINARY-NULL            VALUE 445.
   158 78  ESQL-VARBINARY              VALUE 446.
   159 78  ESQL-VARBINARY-NULL         VALUE 447.
   160 78  ESQL-VARCHAR                VALUE 448.
   161 78  ESQL-VARCHAR-NULL           VALUE 449.
   162
   163 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   164 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   165
   166 78  ESQL-CHAR                   VALUE 452.
   167 78  ESQL-CHAR-NULL              VALUE 453.
   168
   169 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   170 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   171
   172 78  ESQL-DOUBLE                 VALUE 480.
   173 78  ESQL-DOUBLE-NULL            VALUE 481.
   174 78  ESQL-REAL                   VALUE 482.
   175 78  ESQL-REAL-NULL              VALUE 483.
   176 78  ESQL-DECIMAL                VALUE 484.
   177 78  ESQL-DECIMAL-NULL           VALUE 485.
   178 78  ESQL-INTEGER                VALUE 496.
   179 78  ESQL-INTEGER-NULL           VALUE 497.
   180 78  ESQL-SMALLINT               VALUE 500.
   181 78  ESQL-SMALLINT-NULL          VALUE 501.
   182 78  ESQL-TINYINT                VALUE 502.
   183 78  ESQL-TINYINT-NULL           VALUE 503.
   184
*  185 EXEC SQL
*  186    INCLUDE SQLCA
*  187 END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   5
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188 01 SQLCA.
   189     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   190     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   191     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   192     05  SQLERRM.
   193         49  SQLERRML    PIC S9(4) COMP-5.
   194         49  SQLERRMC    PIC X(70).
   195     05  SQLERRP         PIC X(8).
   196     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   197     05  SQLWARN.
   198         10  SQLWARN0    PIC X.
   199         10  SQLWARN1    PIC X.
   200         10  SQLWARN2    PIC X.
   201         10  SQLWARN3    PIC X.
   202         10  SQLWARN4    PIC X.
   203         10  SQLWARN5    PIC X.
   204         10  SQLWARN6    PIC X.
   205         10  SQLWARN7    PIC X.
   206     05  SQLEXT.
   207         10  SQLWARN8    PIC X.
   208         10  SQLWARN9    PIC X.
   209         10  SQLWARN10   PIC X.
   210         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   211     05  SQLSTATE    PIC X(5).
   212
   213 EXEC SQL
   214    BEGIN DECLARE SECTION
   215 END-EXEC
   216
   217 01  SQLCMD                      PIC X(1024).
   218 01  SVR                         PIC X(32).
   219 01  USR                         PIC X(32).
   220 01  PASS                        PIC X(32).
   221 01  USR-PASS                    PIC X(64).
   222
   223 01  WS-SQL-DATA.
   224     05  WS-CYCLE-DATE           PIC X(10).
   225     05  WS-NEXT-BUS-DT          PIC X(10).
   226     05  WS-LOOKUPID             PIC X(4).
   227     05  WS-LOOKUPNAME           PIC X(4).
   228     05  WS-LOOKUP-VALUE         PIC X(100).
   229
   230 EXEC SQL
   231    END DECLARE SECTION
   232 END-EXEC
   233
   234
   235 01  P pointer.
   236 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   237 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   238 01  var-ptr pointer.
   239 01  env-var-len                 pic 9(4)  binary.
   240 01  rc                          pic 9(9)  binary.
   241
   242 01  WS-KIXHOST                  PIC X(10).
   243 01  WS-KIXSYS.
   244     05  WS-KIX-FIL1             PIC X(10).
   245     05  WS-KIX-APPS             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   6
* NSRASBL.cbl
   246     05  WS-KIX-ENV              PIC X(10).
   247     05  WS-KIX-MYENV            PIC X(10).
   248     05  WS-KIX-SYS              PIC X(10).
   249
   250 01  WS-CALC-FIELDS.
   251     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   252     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   253     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   254     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   255     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   256     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   257     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   258     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   259     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   260     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   261     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   262     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   263     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   264     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   265     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   266     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   267     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   268     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   269     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   270     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   271     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   272     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   273     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   274     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   275     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   276     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   277     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   278     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   279     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   280     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   281     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   282     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   283     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   284     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   285     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   286     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   287     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   288     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   289     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   290     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   291     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   292     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   293 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   294 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   295 01 response-code         pic s9(8) comp.
   296 01 display-response      pic 9(8).
   297 01 bl-index              pic 9(8) comp.
   298 01 max-last-name         pic x(18).
   299 01 first-initial         pic x.
   300 01 name-in-range-flag    pic 9.
   301 01 max-entries           pic s9(8) comp value 100.
   302 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   303 01 lower-case    pic x(26) value
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   7
* NSRASBL.cbl
   304            "abcdefghijklmnopqrstuvwxyz".
   305 01 upper-case    pic x(26) value
   306            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   307
   308*                                COPY ELCVADS.
   309******************************************************************
   310*                                                                *
   311*                                                                *
   312*                            ELCVADS.                            *
   313*                                                                *
   314*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   315*   ELVADS                  LENGTH = 350                         *
   316******************************************************************
   317******************************************************************
   318*                   C H A N G E   L O G
   319*
   320* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   321*-----------------------------------------------------------------
   322*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   323* EFFECTIVE    NUMBER
   324*-----------------------------------------------------------------
   325* 100111    2011022800001  AJRA  NAPERSOFT
   326******************************************************************
   327
   328 01  VIRGINIA-DISCLOSURE.
   329     12  VD-COMPANY-CD              PIC X.
   330     12  VD-CARRIER                 PIC X.
   331     12  VD-GROUPING.
   332         20  VD-GROUPING-PREFIX     PIC XXX.
   333         20  VD-GROUPING-PRIME      PIC XXX.
   334     12  VD-STATE                   PIC XX.
   335     12  VD-ACCOUNT.
   336         20  VD-ACCOUNT-PREFIX      PIC X(4).
   337         20  VD-ACCOUNT-PRIME       PIC X(6).
   338     12  VD-CERT-EFF-DT             PIC XX.
   339     12  VD-CERT-NO.
   340         20  VD-CERT-PRIME          PIC X(10).
   341         20  VD-CERT-SFX            PIC X.
   342     12  VD-ENTRY-BATCH             PIC X(6).
   343     12  VD-CSR-ID                  PIC X(4).
   344     12  VD-NAME.
   345         20  VD-INSURED-LAST-NAME   PIC X(15).
   346         20  VD-INSURED-FIRST-NAME.
   347             24  VD-INSURED-1ST-INIT PIC X.
   348             24  FILLER             PIC X(9).
   349         20  VD-INSURED-MIDDLE-INIT PIC X.
   350     12  VD-JOINT-INSURED.
   351         20 VD-JOINT-LAST-NAME      PIC X(15).
   352         20 VD-JOINT-FIRST-NAME.
   353            24  VD-JOINT-FIRST-INIT PIC X.
   354            24  FILLER              PIC X(9).
   355         20 VD-JOINT-MIDDLE-INIT    PIC X.
   356     12  VD-INSURED-ADDRESS-1       PIC X(30).
   357     12  VD-INSURED-ADDRESS-2       PIC X(30).
   358     12  VD-INSURED-CITY-STATE.
   359         20  VD-INSURED-CITY        PIC X(28).
   360         20  VD-INSURED-STATE       PIC XX.
   361     12  VD-INSURED-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   8
* NSRASBL.cbl
   362         20  VD-INSURED-ZIP-PRIME.
   363             24  VD-INSURED-ZIP-1   PIC X.
   364                 88  VD-CANADIAN-POST-CODE
   365                                       VALUE 'A' THRU 'Z'.
   366             24  FILLER             PIC X(4).
   367         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   368     12  VD-BENEFICIARY-NAME        PIC X(30).
   369     12  VD-ACCOUNT-NAME            PIC X(30).
   370     12  VD-LOAN-TERM               PIC S999   COMP-3.
   371     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   372     12  VD-1ST-PMT-DT              PIC XX.
   373     12  VD-LIFE-BENEFIT-CD         PIC XX.
   374         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   375         88  VD-INVALID-LIFE           VALUE '  ' '00'
   376                                             '90' THRU '99'.
   377     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   378                                    PIC XX.
   379     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   380     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   381     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   382     12  VD-LF-TERM                 PIC S999   COMP-3.
   383     12  VD-AH-BENEFIT-CD           PIC XX.
   384         88  VD-VALID-AH               VALUE '01' THRU '89'.
   385         88  VD-INVALID-AH             VALUE '  ' '00'
   386                                             '90' THRU '99'.
   387     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   388     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   389     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   390     12  VD-AH-TERM                 PIC S999   COMP-3.
   391     12  VD-LETTER-ID               PIC X(4).
   392     12  VD-PROC-ID                 PIC X(4).
   393     12  VD-COMP-ID                 PIC X(3).
   394     12  VD-CURRENT-DATE            PIC XX.
   395     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   396     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   397     12  FILLER                     PIC X(32).
   398 01  WS-PASS-AREA.
   399     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   400     05  WS-PASS-VADS-REC    PIC X(350).
   401
   402*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   403*                         COPY ELCZREC.
   404******************************************************************
   405*                                                                *
   406*                                                                *
   407*                            ELCZREC.                            *
   408*                                                                *
   409*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   410*                                                                *
   411******************************************************************
   412*-----------------------------------------------------------------
   413*                   C H A N G E   L O G
   414*
   415* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   416*-----------------------------------------------------------------
   417*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   418* EFFECTIVE    NUMBER
   419*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page   9
* NSRASBL.cbl
   420* 122011    2011022800001  AJRA  NEW FILE
   421* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   422* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   423* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   424* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   425*-----------------------------------------------------------------
   426 01  W-Z-CONTROL-DATA.
   427     05  W-NUMBER-OF-COPIES      PIC  9.
   428     05  FILLER                  PIC  X.
   429     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   430     05  FILLER                  PIC  X.
   431     05  W-DAYS-TO-RESEND        PIC  999.
   432     05  FILLER                  PIC  X.
   433     05  W-FORM-TO-RESEND        PIC  X(4).
   434     05  W-ADD-BAR-CODE          PIC  X.
   435     05  W-PROMPT-LETTER         PIC  X.
   436     05  W-HAS-RETURN-ENV        PIC  X.
   437     05  W-ENCLOSURE-CD          PIC  XXX.
   438     05  W-SIG-FLAG-DEFAULT      PIC  X.
   439     05  W-AUTO-CLOSE-IND        PIC  X.
   440     05  FILLER                  PIC  X.
   441     05  W-LETTER-TO-BENE        PIC  X.
   442     05  FILLER                  PIC  X.
   443     05  W-LETTER-TO-ACCT        PIC  X.
   444     05  FILLER                  PIC  X.
   445     05  W-LETTER-TYPE           PIC  X.
   446     05  FILLER                  PIC  X.
   447     05  W-PRINT-CERTIFICATE     PIC  X.
   448     05  FILLER                  PIC  X.
   449     05  W-REFUND-REQUIRED       PIC  X.
   450     05  FILLER                  PIC  X.
   451     05  W-ONBASE-CODE           PIC  XX.
   452     05  FILLER                  PIC  X.
   453     05  W-ACCT-SUMM             PIC  X.
   454     05  FILLER                  PIC  X.
   455     05  W-CSO-SUMM              PIC  X.
   456     05  FILLER                  PIC  X.
   457     05  W-REASONS-REQUIRED      PIC  X.
   458     05  FILLER                  PIC  X(29).
   459 01  MISC.
   460     12  WS-RESPONSE             PIC S9(8)   COMP.
   461         88  RESP-NORMAL                  VALUE +00.
   462         88  RESP-NOTFND                  VALUE +13.
   463         88  RESP-DUPREC                  VALUE +14.
   464         88  RESP-DUPKEY                  VALUE +15.
   465         88  RESP-NOTOPEN                 VALUE +19.
   466         88  RESP-ENDFILE                 VALUE +20.
   467
   468     12  WS-EDIT-A-DATE.
   469         16  WS-EDIT-A-MM                 PIC X(2).
   470         16  FILLER                       PIC X(1).
   471         16  WS-EDIT-A-DD                 PIC X(2).
   472         16  FILLER                       PIC X(1).
   473         16  WS-EDIT-A-CCYY.
   474             20  WS-EDIT-A-CC             PIC X(2).
   475             20  WS-EDIT-A-YY             PIC X(2).
   476 01  srch-commarea.
   477*                                copy ELCADLTRSPI.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  10
* NSRASBL.cbl
   478******************************************************************
   479*                   C H A N G E   L O G
   480*
   481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   482*-----------------------------------------------------------------
   483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   484* EFFECTIVE    NUMBER
   485*-----------------------------------------------------------------
   486* 060611    2011022800001  PEMA  NEW COPYBOOK
   487* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   488* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   489******************************************************************
   490****************************************
   491*  commarea for NaperSoft On Demand Admin services letters
   492*  (business logic input & output)
   493****************************************
   494     03  BL-INPUT.
   495         05  BL-DATA-SRCE        PIC X.
   496         05  BL-LETTER-ID        PIC XXXX.
   497         05  BL-CARRIER          PIC X.
   498         05  BL-GROUP            PIC X(6).
   499         05  BL-STATE            PIC XX.
   500         05  BL-ACCOUNT          PIC X(10).
   501         05  BL-EFF-DT           PIC X(10).
   502         05  BL-CERT-NO          PIC X(11).
   503         05  BL-BATCH-NO         PIC X(6).
   504         05  BL-BATCH-SEQ        PIC 9(8).
   505         05  BL-RESP-NO          PIC X(10).
   506         05  BL-NO-OF-COPIES     PIC 99.
   507         05  BL-PROC-ID          PIC XXXX.
   508         05  BL-COMP-ID          PIC XXX.
   509         05  BL-PRINT-NOW-SW     PIC X.
   510         05  BL-ENC-CD           PIC XXX.
   511         05  BL-RESEND-DT        PIC X(10).
   512         05  BL-FOLLOW-UP-DT     PIC X(10).
   513         05  BL-ARCHIVE-NO       PIC 9(8).
   514         05  BL-FUNC             PIC X(8).
   515         05  BL-COMMENTS         PIC X(100).
   516         05  FILLER REDEFINES BL-COMMENTS.
   517             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   518             10  BL-LETTER-TO-ACCT PIC X.
   519             10  BL-LETTER-TO-BENE PIC X.
   520             10  BL-WRITE-ERARCH   PIC X.
   521                 88  ERARCH-QWS      VALUE 'Q'.
   522                 88  ERARCH-BATCH    VALUE 'B'.
   523                 88  ERARCH-TEMP     VALUE 'T'.
   524             10  BL-PROCESS-TYPE PIC X(07).
   525             10  BL-CERT-FORM-ID PIC X(05).
   526             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   527             10  BL-SOURCE-SCREEN PIC X(8).
   528             10  FILLER          PIC X(25).
   529     03  BL-OUTPUT.
   530         05  BL-STATUS                   PIC X.
   531             88  BL-OK                      VALUE "P".
   532             88  BL-FAIL                  VALUE "F".
   533         05  BL-MESSAGE          PIC X(50).
   534     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   535     03  FILLER                  PIC X(31).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  11
* NSRASBL.cbl
   536 01  filler                      pic x(500).
   537 01  WS-SAVE-CARRIER-INFO.
   538     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   539     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   540     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   541     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   542     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   543     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   544     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   545     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   546 01  WS-SAVE-STATE-INFO.
   547     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   548     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   549 01  WS-SAVE-LFBEN-INFO.
   550     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   551     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   552     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   553 01  WS-SAVE-AHBEN-INFO.
   554     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   555     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   556     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   557     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   558 01  WS-ERPNDB-KEY.
   559     05  WS-ERPNDB-COMPANY-CD    PIC X.
   560     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   561     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   562     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   563 01  WS-ELENCC-KEY.
   564     05  WS-ELENCC-COMPANY-CD    PIC X.
   565     05  WS-ELENCC-REC-TYPE      PIC X.
   566     05  WS-ELENCC-ENC-CODE      PIC X(5).
   567     05  F                       PIC X(9).
   568 01  WS-ELCERT-KEY.
   569     05  WS-ELCERT-COMPANY-CD    PIC X.
   570     05  WS-ELCERT-CARRIER       PIC X.
   571     05  WS-ELCERT-GROUP         PIC X(6).
   572     05  WS-ELCERT-STATE         PIC XX.
   573     05  WS-ELCERT-ACCOUNT       PIC X(10).
   574     05  WS-ELCERT-EFF-DT        PIC XX.
   575     05  WS-ELCERT-CERT-NO       PIC X(11).
   576 01  WS-ELCRTT-KEY.
   577     05  WS-ELCRTT-PRIMARY       PIC X(33).
   578     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   579
   580 01  WS-ERENDT-KEY.
   581     05  WS-ERENDT-COMPANY-CD    PIC X.
   582     05  WS-ERENDT-CARRIER       PIC X.
   583     05  WS-ERENDT-GROUP         PIC X(6).
   584     05  WS-ERENDT-STATE         PIC XX.
   585     05  WS-ERENDT-ACCOUNT       PIC X(10).
   586     05  WS-ERENDT-EFF-DT        PIC XX.
   587     05  WS-ERENDT-CERT-NO       PIC X(11).
   588     05  WS-ERENDT-REC-TYPE      PIC X.
   589     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   590
   591 01  WS-ERENDT-KEY-BY-ARCH.
   592     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   593     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  12
* NSRASBL.cbl
   594 01  WS-ERCOMP-KEY.
   595     05  WS-ERCOMP-COMPANY-CD    PIC X.
   596     05  WS-ERCOMP-CARRIER       PIC X.
   597     05  WS-ERCOMP-GROUP         PIC X(6).
   598     05  WS-ERCOMP-RESP-NO       PIC X(10).
   599     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   600     05  WS-ERCOMP-REC-TYPE      PIC X.
   601 01  WS-ERMAIL-KEY.
   602     05  WS-ERMAIL-COMPANY-CD    PIC X.
   603     05  WS-ERMAIL-CARRIER       PIC X.
   604     05  WS-ERMAIL-GROUP         PIC X(6).
   605     05  WS-ERMAIL-STATE         PIC XX.
   606     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   607     05  WS-ERMAIL-EFF-DT        PIC XX.
   608     05  WS-ERMAIL-CERT-NO       PIC X(11).
   609 01  WS-ERACCT-KEY.
   610     05  WS-ERACCT-COMPANY-CD    PIC X.
   611     05  WS-ERACCT-CARRIER       PIC X.
   612     05  WS-ERACCT-GROUP         PIC X(6).
   613     05  WS-ERACCT-STATE         PIC XX.
   614     05  WS-ERACCT-ACCOUNT       PIC X(10).
   615     05  WS-ERACCT-EXP-DT        PIC XX.
   616     05  FILLER                  PIC XXXX.
   617 01  WS-ELLETR-KEY.
   618     05  WS-ELLETR-COMPANY-CD    PIC X.
   619     05  WS-ELLETR-LETTER-ID     PIC X(12).
   620     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   621 01  WS-ELCNTL-KEY.
   622     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   623     05  WS-ELCNTL-REC-TYPE      PIC X.
   624     05  WS-ELCNTL-GENL.
   625         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   626         10  WS-ELCNTL-BEN-CD.
   627             15  F               PIC X.
   628             15  WS-ELCNTL-CARR  PIC X.
   629     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   630*                                COPY ELCDATE.
   631******************************************************************
   632*                                                                *
   633*                                                                *
   634*                            ELCDATE.                            *
   635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   636*                            VMOD=2.003
   637*                                                                *
   638*                                                                *
   639*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   640*                 LENGTH = 200                                   *
   641******************************************************************
   642
   643 01  DATE-CONVERSION-DATA.
   644     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   645     12  DC-OPTION-CODE                PIC X.
   646         88  BIN-TO-GREG                VALUE ' '.
   647         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   648         88  EDIT-GREG-TO-BIN           VALUE '2'.
   649         88  YMD-GREG-TO-BIN            VALUE '3'.
   650         88  MDY-GREG-TO-BIN            VALUE '4'.
   651         88  JULIAN-TO-BIN              VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  13
* NSRASBL.cbl
   652         88  BIN-PLUS-ELAPSED           VALUE '6'.
   653         88  FIND-CENTURY               VALUE '7'.
   654         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   655         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   656         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   657         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   658         88  JULIAN-TO-BIN-3            VALUE 'C'.
   659         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   660         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   661         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   662         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   663         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   664         88  CHECK-LEAP-YEAR            VALUE 'H'.
   665         88  BIN-3-TO-GREG              VALUE 'I'.
   666         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   667         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   668         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   669         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   670         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   671         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   672         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   673         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   674         88  THREE-CHARACTER-BIN
   675                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   676         88  GREGORIAN-TO-BIN
   677                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   678         88  BIN-TO-GREGORIAN
   679                  VALUES ' ' '1' 'I' '8' 'G'.
   680         88  JULIAN-TO-BINARY
   681                  VALUES '5' 'C' 'E' 'F'.
   682     12  DC-ERROR-CODE                 PIC X.
   683         88  NO-CONVERSION-ERROR        VALUE ' '.
   684         88  DATE-CONVERSION-ERROR
   685                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   686         88  DATE-IS-ZERO               VALUE '1'.
   687         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   688         88  DATE-IS-INVALID            VALUE '3'.
   689         88  DATE1-GREATER-DATE2        VALUE '4'.
   690         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   691         88  DATE-INVALID-OPTION        VALUE '9'.
   692         88  INVALID-CENTURY            VALUE 'A'.
   693         88  ONLY-CENTURY               VALUE 'B'.
   694         88  ONLY-LEAP-YEAR             VALUE 'C'.
   695         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   696     12  DC-END-OF-MONTH               PIC X.
   697         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   698     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   699         88  USE-NORMAL-PROCESS         VALUE ' '.
   700         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   701         88  ADJUST-UP-100-YRS          VALUE '2'.
   702     12  FILLER                        PIC X.
   703     12  DC-CONVERSION-DATES.
   704         16  DC-BIN-DATE-1             PIC XX.
   705         16  DC-BIN-DATE-2             PIC XX.
   706         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   707         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   708                       DC-GREG-DATE-1-EDIT.
   709             20  DC-EDIT1-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  14
* NSRASBL.cbl
   710             20  SLASH1-1              PIC X.
   711             20  DC-EDIT1-DAY          PIC 99.
   712             20  SLASH1-2              PIC X.
   713             20  DC-EDIT1-YEAR         PIC 99.
   714         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   715         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   716                     DC-GREG-DATE-2-EDIT.
   717             20  DC-EDIT2-MONTH        PIC 99.
   718             20  SLASH2-1              PIC X.
   719             20  DC-EDIT2-DAY          PIC 99.
   720             20  SLASH2-2              PIC X.
   721             20  DC-EDIT2-YEAR         PIC 99.
   722         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   723         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   724                     DC-GREG-DATE-1-YMD.
   725             20  DC-YMD-YEAR           PIC 99.
   726             20  DC-YMD-MONTH          PIC 99.
   727             20  DC-YMD-DAY            PIC 99.
   728         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   729         16  DC-GREG-DATE-1-MDY-R REDEFINES
   730                      DC-GREG-DATE-1-MDY.
   731             20  DC-MDY-MONTH          PIC 99.
   732             20  DC-MDY-DAY            PIC 99.
   733             20  DC-MDY-YEAR           PIC 99.
   734         16  DC-GREG-DATE-1-ALPHA.
   735             20  DC-ALPHA-MONTH        PIC X(10).
   736             20  DC-ALPHA-DAY          PIC 99.
   737             20  FILLER                PIC XX.
   738             20  DC-ALPHA-CENTURY.
   739                 24 DC-ALPHA-CEN-N     PIC 99.
   740             20  DC-ALPHA-YEAR         PIC 99.
   741         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   742         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   743         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   744         16  DC-JULIAN-DATE            PIC 9(05).
   745         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   746                                       PIC 9(05).
   747         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   748             20  DC-JULIAN-YEAR        PIC 99.
   749             20  DC-JULIAN-DAYS        PIC 999.
   750         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   751         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   752         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   753     12  DATE-CONVERSION-VARIBLES.
   754         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   755         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   756             20  FILLER                PIC 9(3).
   757             20  HOLD-CEN-1-CCYY.
   758                 24  HOLD-CEN-1-CC     PIC 99.
   759                 24  HOLD-CEN-1-YY     PIC 99.
   760             20  HOLD-CEN-1-MO         PIC 99.
   761             20  HOLD-CEN-1-DA         PIC 99.
   762         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   763             20  HOLD-CEN-1-R-MO       PIC 99.
   764             20  HOLD-CEN-1-R-DA       PIC 99.
   765             20  HOLD-CEN-1-R-CCYY.
   766                 24  HOLD-CEN-1-R-CC   PIC 99.
   767                 24  HOLD-CEN-1-R-YY   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  15
* NSRASBL.cbl
   768             20  FILLER                PIC 9(3).
   769         16  HOLD-CENTURY-1-X.
   770             20  FILLER                PIC X(3)  VALUE SPACES.
   771             20  HOLD-CEN-1-X-CCYY.
   772                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   773                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   774             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   775             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   776         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   777             20  HOLD-CEN-1-R-X-MO     PIC XX.
   778             20  HOLD-CEN-1-R-X-DA     PIC XX.
   779             20  HOLD-CEN-1-R-X-CCYY.
   780                 24  HOLD-CEN-1-R-X-CC PIC XX.
   781                 24  HOLD-CEN-1-R-X-YY PIC XX.
   782             20  FILLER                PIC XXX.
   783         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   784         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   785         16  DC-JULIAN-DATE-1          PIC 9(07).
   786         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   787             20  DC-JULIAN-1-CCYY.
   788                 24  DC-JULIAN-1-CC    PIC 99.
   789                 24  DC-JULIAN-1-YR    PIC 99.
   790             20  DC-JULIAN-DA-1        PIC 999.
   791         16  DC-JULIAN-DATE-2          PIC 9(07).
   792         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   793             20  DC-JULIAN-2-CCYY.
   794                 24  DC-JULIAN-2-CC    PIC 99.
   795                 24  DC-JULIAN-2-YR    PIC 99.
   796             20  DC-JULIAN-DA-2        PIC 999.
   797         16  DC-GREG-DATE-A-EDIT.
   798             20  DC-EDITA-MONTH        PIC 99.
   799             20  SLASHA-1              PIC X VALUE '/'.
   800             20  DC-EDITA-DAY          PIC 99.
   801             20  SLASHA-2              PIC X VALUE '/'.
   802             20  DC-EDITA-CCYY.
   803                 24  DC-EDITA-CENT     PIC 99.
   804                 24  DC-EDITA-YEAR     PIC 99.
   805         16  DC-GREG-DATE-B-EDIT.
   806             20  DC-EDITB-MONTH        PIC 99.
   807             20  SLASHB-1              PIC X VALUE '/'.
   808             20  DC-EDITB-DAY          PIC 99.
   809             20  SLASHB-2              PIC X VALUE '/'.
   810             20  DC-EDITB-CCYY.
   811                 24  DC-EDITB-CENT     PIC 99.
   812                 24  DC-EDITB-YEAR     PIC 99.
   813         16  DC-GREG-DATE-CYMD         PIC 9(08).
   814         16  DC-GREG-DATE-CYMD-R REDEFINES
   815                              DC-GREG-DATE-CYMD.
   816             20  DC-CYMD-CEN           PIC 99.
   817             20  DC-CYMD-YEAR          PIC 99.
   818             20  DC-CYMD-MONTH         PIC 99.
   819             20  DC-CYMD-DAY           PIC 99.
   820         16  DC-GREG-DATE-MDCY         PIC 9(08).
   821         16  DC-GREG-DATE-MDCY-R REDEFINES
   822                              DC-GREG-DATE-MDCY.
   823             20  DC-MDCY-MONTH         PIC 99.
   824             20  DC-MDCY-DAY           PIC 99.
   825             20  DC-MDCY-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  16
* NSRASBL.cbl
   826             20  DC-MDCY-YEAR          PIC 99.
   827    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   828        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   829    12  DC-EL310-DATE                  PIC X(21).
   830    12  FILLER                         PIC X(28).
   831*                                COPY NSCASEXTR.
   832******************************************************************
   833*                                                                *
   834*                                                                *
   835*                            NSCASEXTR.                          *
   836*                            VMOD=2.001                          *
   837*                                                                *
   838*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   839*                                                                *
   840*   FILE TYPE = VSAM,KSDS                                        *
   841*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   842*                                                                *
   843*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   844*                                                                *
   845*   LOG = NO                                                     *
   846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   847******************************************************************
   848*-----------------------------------------------------------------
   849*                   C H A N G E   L O G
   850*
   851* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   852*-----------------------------------------------------------------
   853*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   854* EFFECTIVE    NUMBER
   855*-----------------------------------------------------------------
   856* 072211    2011022800001  PEMA  NEW FILE
   857*-----------------------------------------------------------------
   858 01 NSAS-EXTRACT-RECORD.
   859    05  NSAS-CONTROL-PRIMARY.
   860        10  NSAS-COMPANY-CD      PIC X.
   861        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   862        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   863    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   864    05  FILLER                   PIC X(143).
   865*                                COPY ERCPNDB.
   866******************************************************************
   867*                                                                *
   868*                                                                *
   869*                            ERCPNDB.                            *
   870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   871*                            VMOD=2.025                          *
   872*                                                                *
   873*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   874*                                                                *
   875******************************************************************
   876*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   877*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   878******************************************************************
   879*                                                                *
   880*                                                                *
   881*   FILE TYPE = VSAM,KSDS                                        *
   882*   RECORD SIZE = 585  RECFORM = FIXED                           *
   883*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  17
* NSRASBL.cbl
   884*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   885*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   886*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   887*                                                 RKP=13,LEN=36  *
   888*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   889*                                      AND CHG-SEQ.)             *
   890*                                                RKP=49,LEN=11   *
   891*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   892*                                      AND CHG-SEQ.)             *
   893*                                                RKP=60,LEN=15   *
   894*                                                                *
   895*   LOG = NO                                                     *
   896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   897******************************************************************
   898******************************************************************
   899*                   C H A N G E   L O G
   900*
   901* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   902*-----------------------------------------------------------------
   903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   904* EFFECTIVE    NUMBER
   905*-----------------------------------------------------------------
   906* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   907* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   908* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   909* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   910* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   911* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   912* 032306                   PEMA  ADD BOW LOAN NUMBER
   913* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   914* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   915* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   916* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   917* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   918* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   919* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   920* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   921* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   922* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   923* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
   924* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   925* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
   926******************************************************************
   927
   928 01  PENDING-BUSINESS.
   929     12  PB-RECORD-ID                     PIC XX.
   930         88  VALID-PB-ID                        VALUE 'PB'.
   931
   932     12  PB-CONTROL-PRIMARY.
   933         16  PB-COMPANY-CD                PIC X.
   934         16  PB-ENTRY-BATCH               PIC X(6).
   935         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   936         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   937
   938     12  PB-CONTROL-BY-ACCOUNT.
   939         16  PB-COMPANY-CD-A1             PIC X.
   940         16  PB-CARRIER                   PIC X.
   941         16  PB-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  18
* NSRASBL.cbl
   942             20  PB-GROUPING-PREFIX       PIC XXX.
   943             20  PB-GROUPING-PRIME        PIC XXX.
   944         16  PB-STATE                     PIC XX.
   945         16  PB-ACCOUNT.
   946             20  PB-ACCOUNT-PREFIX        PIC X(4).
   947             20  PB-ACCOUNT-PRIME         PIC X(6).
   948         16  PB-CERT-EFF-DT               PIC XX.
   949         16  PB-CERT-NO.
   950             20  PB-CERT-PRIME            PIC X(10).
   951             20  PB-CERT-SFX              PIC X.
   952         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   953
   954         16  PB-RECORD-TYPE               PIC X.
   955             88  PB-MAILING-DATA                VALUE '0'.
   956             88  PB-ISSUE                       VALUE '1'.
   957             88  PB-CANCELLATION                VALUE '2'.
   958             88  PB-BATCH-TRAILER               VALUE '9'.
   959
   960     12  PB-CONTROL-BY-ORIG-BATCH.
   961         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   962         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   963         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   964         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   965
   966     12  PB-CONTROL-BY-CSR.
   967         16  PB-CSR-COMPANY-CD            PIC X.
   968         16  PB-CSR-ID                    PIC X(4).
   969         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   970         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   971         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   972******************************************************************
   973*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   974******************************************************************
   975
   976     12  PB-LAST-MAINT-DT                 PIC XX.
   977     12  PB-LAST-MAINT-BY                 PIC X(4).
   978     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   979
   980     12  PB-RECORD-BODY                   PIC X(375).
   981
   982     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   983         16  PB-CERT-ORIGIN               PIC X.
   984             88  CLASIC-CREATED-CERT         VALUE '1'.
   985         16  PB-I-NAME.
   986             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   987             20  PB-I-INSURED-FIRST-NAME.
   988                 24  PB-I-INSURED-1ST-INIT PIC X.
   989                 24  FILLER                PIC X(9).
   990             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   991         16  PB-I-AGE                     PIC S99   COMP-3.
   992         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   993         16  PB-I-BIRTHDAY                PIC XX.
   994         16  PB-I-INSURED-SEX             PIC X.
   995             88  PB-SEX-MALE     VALUE 'M'.
   996             88  PB-SEX-FEMALE   VALUE 'F'.
   997
   998         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   999         16  PB-I-AH-TERM                 PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  19
* NSRASBL.cbl
  1000         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1001         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1002         16  PB-I-SKIP-CODE               PIC X.
  1003             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1004             88  PB-SKIP-JULY              VALUE '1'.
  1005             88  PB-SKIP-AUGUST            VALUE '2'.
  1006             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1007             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1008             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1009             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1010             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1011             88  PB-SKIP-JUNE              VALUE '8'.
  1012             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1013             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1014             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1015         16  PB-I-TERM-TYPE               PIC X.
  1016             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1017             88  PB-PAID-WEEKLY            VALUE 'W'.
  1018             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1019             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1020             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1021         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1022         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1023         16  PB-I-DATA-ENTRY-SW           PIC X.
  1024             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1025             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1026             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1027             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1028         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1029         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1030*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1031         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1032         16  PB-I-LETTER-REQD             PIC X.
  1033
  1034         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1035             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1036             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1037                                                   '90' THRU '99'.
  1038         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1039                                          PIC XX.
  1040         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1041         16  PB-I-AMOUNT-FINANCED REDEFINES
  1042                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1043         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1044         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1045                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1046         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1047         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1048         16  PB-I-CLP-AMOUNT REDEFINES
  1049                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1050         16  PB-I-LF-CALC-FLAG            PIC X.
  1051             88 PB-COMP-LF-PREM               VALUE '?'.
  1052         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1053         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1054         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1055         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1056         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1057         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  20
* NSRASBL.cbl
  1058         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1059         16  PB-I-LF-ABBR                 PIC XXX.
  1060         16  PB-I-LF-INPUT-CD             PIC XX.
  1061
  1062         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1063             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1064             88  PB-INVALID-AH               VALUE '  ' '00'
  1065                                                   '90' THRU '99'.
  1066         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1067         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1068         16  PB-I-AH-CALC-FLAG            PIC X.
  1069             88 PB-COMP-AH-PREM                  VALUE '?'.
  1070         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1071         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1072         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  1073         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1074         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1075         16  PB-I-AH-ABBR                 PIC XXX.
  1076         16  PB-I-AH-INPUT-CD             PIC XXX.
  1077
  1078         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1079         16  PB-I-REIN-TABLE              PIC XXX.
  1080         16  PB-I-BUSINESS-TYPE           PIC 99.
  1081         16  PB-I-INDV-GRP-CD             PIC X.
  1082         16  PB-I-MORT-CODE.
  1083             20  PB-I-TABLE               PIC X.
  1084             20  PB-I-INTEREST            PIC XX.
  1085             20  PB-I-MORT-TYP            PIC X.
  1086         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1087         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1088         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1089         16  PB-I-INDV-GRP-OVRD           PIC X.
  1090         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1091         16  PB-I-SIG-SW                  PIC X.
  1092             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1093         16  PB-I-RATE-CLASS              PIC XX.
  1094         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1095         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1096         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1097         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1098         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1099         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1100         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1101         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1102         16  PB-I-OB-FLAG                 PIC X.
  1103             88  PB-I-OB                      VALUE 'B'.
  1104             88  PB-I-SUMMARY                 VALUE 'Z'.
  1105         16  PB-I-ENTRY-STATUS            PIC X.
  1106             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1107                                              'M' '5' '9' '2'.
  1108             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1109             88  PB-I-POLICY-PENDING          VALUE '2'.
  1110             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1111             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1112             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  1113             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1114             88  PB-I-REIN-ONLY               VALUE '9'.
  1115             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  21
* NSRASBL.cbl
  1116             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1117             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1118             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1119         16  PB-I-INT-CODE                PIC X.
  1120             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1121             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1122         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1123         16  PB-I-SOC-SEC-NO              PIC X(11).
  1124         16  PB-I-MEMBER-NO               PIC X(12).
  1125         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1126*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1127         16  PB-I-OLD-LOF                 PIC XXX.
  1128         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1129         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1130         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1131         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1132         16  PB-I-LIFE-INDICATOR          PIC X.
  1133             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1134         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1135         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1136                                          PIC S9(5)V99    COMP-3.
  1137         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1138             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1139             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1140         16  PB-I-1ST-PMT-DT              PIC XX.
  1141         16  PB-I-JOINT-INSURED.
  1142             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1143             20 PB-I-JOINT-FIRST-NAME.
  1144                24  PB-I-JOINT-FIRST-INIT PIC X.
  1145                24  FILLER                PIC X(9).
  1146             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1147*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1148         16  PB-I-BENEFICIARY-NAME.
  1149             20  PB-I-BANK-NUMBER         PIC X(10).
  1150             20  FILLER                   PIC X(15).
  1151         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1152         16  PB-I-REFERENCE               PIC X(12).
  1153         16  FILLER REDEFINES PB-I-REFERENCE.
  1154             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1155             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1156             20  PB-I-CLP-STATE           PIC XX.
  1157         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1158             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1159             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1160             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1161         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1162         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1163         16  PB-I-RESIDENT-STATE          PIC XX.
  1164         16  PB-I-RATE-CODE               PIC X(4).
  1165         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1166         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1167         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1168         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1169         16  PB-I-BANK-NOCHRGB            PIC 99.
  1170         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1171         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1172
  1173     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  22
* NSRASBL.cbl
  1174         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1175             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1176         16  PB-C-CANCEL-ORIGIN           PIC X.
  1177             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1178         16  PB-C-LF-CANCEL-DT            PIC XX.
  1179         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1180         16  PB-C-LF-CALC-REQ             PIC X.
  1181             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1182         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1183         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1184         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1185             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1186         16  PB-C-AH-CANCEL-DT            PIC XX.
  1187         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1188         16  PB-C-AH-CALC-REQ             PIC X.
  1189             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1190         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1191         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1192         16  PB-C-LAST-NAME               PIC X(15).
  1193         16  PB-C-REFUND-SW               PIC X.
  1194             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1195             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1196         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1197         16  PB-C-PAYEE-CODE              PIC X(6).
  1198         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1199         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1200         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1201         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1202         16  PB-C-REFERENCE               PIC X(12).
  1203         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1204         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1205         16  PB-C-POST-CARD-IND           PIC X.
  1206         16  PB-C-CANCEL-REASON           PIC X.
  1207         16  PB-C-REF-INTERFACE-SW        PIC X.
  1208         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1209         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1210         16  FILLER                       PIC X(01).
  1211*        16  FILLER                       PIC X(18).
  1212         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1213*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1214         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  1215         16  PB-CANCELED-CERT-DATA.
  1216             20  PB-CI-INSURED-NAME.
  1217                 24  PB-CI-LAST-NAME      PIC X(15).
  1218                 24  PB-CI-INITIALS       PIC XX.
  1219             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1220             20  PB-CI-INSURED-SEX        PIC X.
  1221             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1222             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1223             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1224             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1225             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1226             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1227             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1228             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1229             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1230             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1231             20  PB-CI-RATE-CLASS         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  23
* NSRASBL.cbl
  1232             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1233             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1234             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1235             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1236             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1237             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1238             20  PB-CI-LF-ABBR            PIC X(3).
  1239             20  PB-CI-AH-ABBR            PIC X(3).
  1240             20  PB-CI-OB-FLAG            PIC X.
  1241                 88  PB-CI-OB                VALUE 'B'.
  1242             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1243                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1244                                           'M' '4' '5' '9' '2'.
  1245                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1246                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1247                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1248                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1249                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1250                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  1251                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1252                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1253                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1254                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1255                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1256                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1257                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1258             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1259                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1260                                           'M' '4' '5' '9' '2'.
  1261                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1262                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1263                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1264                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1265                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1266                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  1267                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1268                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1269                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1270                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1271                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1272                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1273                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1274             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1275             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1276             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1277             20  PB-CI-MEMBER-NO          PIC X(12).
  1278             20  PB-CI-INT-CODE           PIC X.
  1279                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1280                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1281             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1282             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1283             20  PB-CI-COMP-EXCP-SW       PIC X.
  1284                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1285                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1286             20  PB-CI-ENTRY-STATUS       PIC X.
  1287             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1288             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1289             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  24
* NSRASBL.cbl
  1290             20  PB-CI-DEATH-DT           PIC XX.
  1291             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1292             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1293             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1294             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1295             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1296             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1297             20  PB-CI-ENTRY-DT              PIC XX.
  1298             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1299             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1300             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1301             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1302             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1303             20  PB-CI-OLD-LOF               PIC XXX.
  1304*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1305             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1306             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1307             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1308             20  PB-CI-INDV-GRP-CD           PIC X.
  1309             20  PB-CI-BENEFICIARY-NAME.
  1310                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1311                 24  FILLER                  PIC X(15).
  1312             20  PB-CI-NOTE-SW               PIC X.
  1313             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1314             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1315             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1316             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1317             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1318             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1319             20  PB-CI-FIRST-NAME            PIC X(10).
  1320             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1321
  1322         16  FILLER                       PIC X(13).
  1323*032306  16  FILLER                       PIC X(27).
  1324*        16  FILLER                       PIC X(46).
  1325
  1326     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1327         16  FILLER                       PIC X(10).
  1328         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1329         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1330         16  PB-M-INSURED-MID-INIT        PIC X.
  1331         16  PB-M-INSURED-AGE             PIC 99.
  1332         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1333         16  PB-M-INSURED-SEX             PIC X.
  1334         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1335         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1336         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1337         16  PB-M-INSURED-CITY-STATE.
  1338             20  PB-M-INSURED-CITY        PIC X(28).
  1339             20  PB-M-INSURED-STATE       PIC XX.
  1340         16  PB-M-INSURED-ZIP-CODE.
  1341             20  PB-M-INSURED-ZIP-PRIME.
  1342                 24  PB-M-INSURED-ZIP-1   PIC X.
  1343                     88  PB-M-CANADIAN-POST-CODE
  1344                                             VALUE 'A' THRU 'Z'.
  1345                 24  FILLER               PIC X(4).
  1346             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1347         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  25
* NSRASBL.cbl
  1348                                        PB-M-INSURED-ZIP-CODE.
  1349             20  PM-M-INS-CAN-POST1       PIC XXX.
  1350             20  PM-M-INS-CAN-POST2       PIC XXX.
  1351             20  FILLER                   PIC XXX.
  1352         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1353         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1354         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1355         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1356         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1357         16  PB-M-CRED-BENE-CITYST.
  1358             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1359             20  PB-M-CRED-BENE-STATE     PIC XX.
  1360         16  FILLER                       PIC X(92).
  1361
  1362     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1363         16  FILLER                       PIC X(10).
  1364         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1365         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1366         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1367         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1368         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1369         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1370         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1371         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1372         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1373         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1374         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1375         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1376         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1377         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1378         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1379         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1380         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1381         16  PB-ACCOUNT-NAME              PIC X(30).
  1382         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1383         16  PB-REFERENCE                 PIC X(12).
  1384         16  PB-B-RECEIVED-DT             PIC XX.
  1385         16  FILLER                       PIC X(234).
  1386
  1387     12  PB-RECORD-STATUS.
  1388         16  PB-CREDIT-SELECT-DT          PIC XX.
  1389         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1390         16  PB-BILLED-DT                 PIC XX.
  1391         16  PB-BILLING-STATUS            PIC X.
  1392             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1393             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1394             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1395         16  PB-RECORD-BILL               PIC X.
  1396             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1397             88  PB-RECORD-RETURNED           VALUE 'R'.
  1398             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1399             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1400             88  PB-OVERRIDE-AH               VALUE 'A'.
  1401             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1402         16  PB-BATCH-ENTRY               PIC X.
  1403             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1404             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1405             88  PB-REISSUED-CERT             VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  26
* NSRASBL.cbl
  1406             88  PB-CASH-CERT                 VALUE 'C'.
  1407             88  PB-MONTHLY-CERT              VALUE 'M'.
  1408             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1409             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1410             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1411         16  PB-FORCE-CODE                PIC X.
  1412             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1413             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1414             88  PB-CANCEL-FORCE              VALUE '8'.
  1415             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1416             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1417             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1418             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1419             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1420             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1421             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  1422             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1423         16  PB-FATAL-FLAG                PIC X.
  1424             88  PB-FATAL-ERRORS              VALUE 'X'.
  1425         16  PB-FORCE-ER-CD               PIC X.
  1426             88  PB-FORCE-ERRORS              VALUE 'F'.
  1427             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1428         16  PB-WARN-ER-CD                PIC X.
  1429             88  PB-WARNING-ERRORS            VALUE 'W'.
  1430         16  FILLER                       PIC X.
  1431         16  PB-OUT-BAL-CD                PIC X.
  1432             88  PB-OUT-OF-BAL                VALUE 'O'.
  1433         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1434         16  PB-AH-OVERRIDE-L1            PIC X.
  1435         16  PB-INPUT-DT                  PIC XX.
  1436         16  PB-INPUT-BY                  PIC X(4).
  1437         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1438         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1439         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1440         16  PB-LF-EARNING-METHOD         PIC X.
  1441         16  PB-AH-EARNING-METHOD         PIC X.
  1442         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1443         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1444         16  PB-REIN-CD                   PIC XXX.
  1445         16  PB-LF-REFUND-TYPE            PIC X.
  1446         16  PB-AH-REFUND-TYPE            PIC X.
  1447         16  PB-ACCT-EFF-DT               PIC XX.
  1448         16  PB-ACCT-EXP-DT               PIC XX.
  1449         16  PB-COMPANY-ID                PIC X(3).
  1450         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1451         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1452         16  PB-SV-CARRIER                PIC X.
  1453         16  PB-SV-GROUPING               PIC X(6).
  1454         16  PB-SV-STATE                  PIC XX.
  1455         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1456         16  PB-GA-BILLING-INFO.
  1457             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1458                                          PIC XX.
  1459         16  PB-SV-REMIT-TO  REDEFINES
  1460             PB-GA-BILLING-INFO           PIC X(10).
  1461         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1462         16  PB-I-LOAN-OFFICER            PIC X(5).
  1463         16  PB-I-VIN                     PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  27
* NSRASBL.cbl
  1464
  1465         16  FILLER                       PIC X(04).
  1466         16  IMNET-BYPASS-SW              PIC X.
  1467
  1468******************************************************************
  1469*                COMMON EDIT ERRORS                              *
  1470******************************************************************
  1471
  1472     12  PB-COMMON-ERRORS.
  1473         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1474                                           PIC S9(4)     COMP.
  1475
  1476******************************************************************
  1477*                                COPY ERCENDT.
  1478******************************************************************
  1479*                                                                *
  1480*                                                                *
  1481*                            ERCENDT.                            *
  1482*                            VMOD=2.001                          *
  1483*                                                                *
  1484*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1485*                                                                *
  1486*   FILE TYPE = VSAM,KSDS                                        *
  1487*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1488*                                                                *
  1489*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1490*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1491*                                                                *
  1492*   LOG = NO                                                     *
  1493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1494******************************************************************
  1495*-----------------------------------------------------------------
  1496*                   C H A N G E   L O G
  1497*
  1498* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1499*-----------------------------------------------------------------
  1500*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1501* EFFECTIVE    NUMBER
  1502*-----------------------------------------------------------------
  1503* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1504*                                WITH OPEN CLAIMS
  1505* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1506* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1507* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1508* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1509*-----------------------------------------------------------------
  1510 01  ENDORSEMENT-RECORD.
  1511     12  EN-RECORD-ID                PIC XX.
  1512         88  VALID-EN-ID                VALUE 'EN'.
  1513     12  EN-CONTROL-PRIMARY.
  1514         16  EN-COMPANY-CD           PIC X.
  1515         16  EN-CARRIER              PIC X.
  1516         16  EN-GROUPING             PIC X(6).
  1517         16  EN-STATE                PIC XX.
  1518         16  EN-ACCOUNT              PIC X(10).
  1519         16  EN-CERT-EFF-DT          PIC XX.
  1520         16  EN-CERT-NO.
  1521             20  EN-CERT-PRIME       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  28
* NSRASBL.cbl
  1522             20  EN-CERT-SFX         PIC X.
  1523         16  EN-REC-TYPE             PIC X.
  1524             88  EN-ISSUE               VALUE 'I'.
  1525             88  EN-CANCELLATION        VALUE 'C'.
  1526         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1527     12  EN-CONTROL-BY-ARCH-NO.
  1528         16  EN-COMPANY-CD-A1              PIC X.
  1529         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1530     12  EN-LAST-MAINT-DT            PIC XX.
  1531     12  EN-LAST-MAINT-BY            PIC X(4).
  1532     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1533     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1534     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1535         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1536         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1537         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1538         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1539         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1540         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1541         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1542         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1543         16  EN-LF-ORIG-BENCD        PIC XX.
  1544         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1545         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1546         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1547         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1548         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1549         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1550*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1551         16  EN-ORIG-CRED-BENE       PIC X(25).
  1552         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1553         16  FILLER                  PIC X.
  1554         16  EN-AH-ORIG-BENCD        PIC XX.
  1555         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1556         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1557         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1558         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1559*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1560*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1561         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1562         16  F                       PIC X(09).
  1563         16  EN-AH-ORIG-CP           PIC 99.
  1564         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1565         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1566         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1567         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1568         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1569         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1570         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1571         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1572         16  EN-LF-NEW-BENCD         PIC XX.
  1573         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1574         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1575         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1576         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1577         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1578         16  EN-LF-NEW-EXP-DT        PIC XX.
  1579         16  EN-NEW-CRED-BENE        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  29
* NSRASBL.cbl
  1580         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1581         16  FILLER                  PIC X.
  1582         16  EN-AH-NEW-BENCD         PIC XX.
  1583         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1584         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1585         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1586         16  EN-AH-NEW-EXP-DT        PIC XX.
  1587*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1588*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1589*        16  F                       PIC X(12).
  1590         16  EN-AH-NEW-CP            PIC 99.
  1591         16  EN-SIG-SW               PIC X.
  1592         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1593         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1594         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1595         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1596         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1597         16  FILLER                  PIC X(33).
  1598     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1599         16  EN-LF-ORIG-REF-DT       PIC XX.
  1600         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1601         16  EN-AH-ORIG-REF-DT       PIC XX.
  1602         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1603         16  EN-LF-NEW-REF-DT        PIC XX.
  1604         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1605         16  EN-AH-NEW-REF-DT        PIC XX.
  1606         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1607         16  EN-FLAG-CERT            PIC X.
  1608         16  EN-INS-LAST-NAME        PIC X(15).
  1609         16  EN-INS-FIRST-NAME       PIC X(10).
  1610         16  EN-INS-MIDDLE-INIT      PIC X.
  1611         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1612         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1613         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1614         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1615         16  FILLER                  PIC X(262).
  1616     12  EN-MONEY-SW             PIC X.
  1617     12  EN-HEALTH-APP           PIC X.
  1618     12  EN-VOUCHER-SW           PIC X.
  1619     12  EN-PAYEE                PIC X(14).
  1620     12  EN-INPUT-DT             PIC XX.
  1621     12  EN-PROCESS-DT           PIC XX.
  1622     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1623     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1624     12  EN-REASON-CODES.
  1625         16  F OCCURS 12.
  1626             20  EN-REASON-CODE  PIC X(4).
  1627     12  EN-TEMPLATE-USED        PIC X(8).
  1628     12  EN-DOCU-TYPE            PIC X.
  1629         88  EN-VERI-DOCU          VALUE 'V'.
  1630         88  EN-GCE-DOCU           VALUE 'G'.
  1631         88  EN-CANC-DOCU          VALUE 'C'.
  1632     12  EN-COMMENTS1            PIC X(13).
  1633     12  EN-COMMENTS2            PIC X(70).
  1634     12  EN-COMM-CHGBK           PIC X.
  1635         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1636         88  EN-CHG-ACCT           VALUE 'Y'.
  1637     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  30
* NSRASBL.cbl
  1638     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1639     12  EN-BATCH-NUMBER         PIC X(6).
  1640     12  EN-ACCT-SUMM            PIC X.
  1641     12  EN-CSO-SUMM             PIC X.
  1642     12  en-check-type           pic x.
  1643     12  FILLER                  PIC X(12).
  1644******************************************************************
  1645*                                COPY ERCMAIL.
  1646******************************************************************
  1647*                                                                *
  1648*                                                                *
  1649*                            ERCMAIL                             *
  1650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1651*                            VMOD=2.003                          *
  1652*                                                                *
  1653*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1654*                                                                *
  1655*   FILE TYPE = VSAM,KSDS                                        *
  1656*   RECORD SIZE = 374   RECFORM = FIX                            *
  1657*                                                                *
  1658*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1659*   ALTERNATE PATH    = NOT USED                                 *
  1660*                                                                *
  1661*   LOG = YES                                                    *
  1662*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1663******************************************************************
  1664*                   C H A N G E   L O G
  1665*
  1666* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1667*-----------------------------------------------------------------
  1668*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1669* EFFECTIVE    NUMBER
  1670*-----------------------------------------------------------------
  1671* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1672* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1673* 111108                   PEMA  ADD CRED BENE ADDR2
  1674******************************************************************
  1675
  1676 01  MAILING-DATA.
  1677     12  MA-RECORD-ID                      PIC XX.
  1678         88  VALID-MA-ID                       VALUE 'MA'.
  1679
  1680     12  MA-CONTROL-PRIMARY.
  1681         16  MA-COMPANY-CD                 PIC X.
  1682         16  MA-CARRIER                    PIC X.
  1683         16  MA-GROUPING.
  1684             20  MA-GROUPING-PREFIX        PIC XXX.
  1685             20  MA-GROUPING-PRIME         PIC XXX.
  1686         16  MA-STATE                      PIC XX.
  1687         16  MA-ACCOUNT.
  1688             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1689             20  MA-ACCOUNT-PRIME          PIC X(6).
  1690         16  MA-CERT-EFF-DT                PIC XX.
  1691         16  MA-CERT-NO.
  1692             20  MA-CERT-PRIME             PIC X(10).
  1693             20  MA-CERT-SFX               PIC X.
  1694
  1695     12  FILLER                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  31
* NSRASBL.cbl
  1696
  1697     12  MA-ACCESS-CONTROL.
  1698         16  MA-SOURCE-SYSTEM              PIC XX.
  1699             88  MA-FROM-CREDIT                VALUE 'CR'.
  1700             88  MA-FROM-VSI                   VALUE 'VS'.
  1701             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1702             88  MA-FROM-OTHER                 VALUE 'OT'.
  1703         16  MA-RECORD-ADD-DT              PIC XX.
  1704         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1705         16  MA-LAST-MAINT-DT              PIC XX.
  1706         16  MA-LAST-MAINT-BY              PIC XXXX.
  1707         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1708
  1709     12  MA-PROFILE-INFO.
  1710         16  MA-QUALIFY-CODE-1             PIC XX.
  1711         16  MA-QUALIFY-CODE-2             PIC XX.
  1712         16  MA-QUALIFY-CODE-3             PIC XX.
  1713         16  MA-QUALIFY-CODE-4             PIC XX.
  1714         16  MA-QUALIFY-CODE-5             PIC XX.
  1715
  1716         16  MA-INSURED-LAST-NAME          PIC X(15).
  1717         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1718         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1719         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1720         16  MA-INSURED-BIRTH-DT           PIC XX.
  1721         16  MA-INSURED-SEX                PIC X.
  1722             88  MA-SEX-MALE                   VALUE 'M'.
  1723             88  MA-SEX-FEMALE                 VALUE 'F'.
  1724         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1725
  1726         16  MA-ADDRESS-CORRECTED          PIC X.
  1727         16  MA-JOINT-BIRTH-DT             PIC XX.
  1728*        16  FILLER                        PIC X(12).
  1729
  1730         16  MA-ADDRESS-LINE-1             PIC X(30).
  1731         16  MA-ADDRESS-LINE-2             PIC X(30).
  1732         16  MA-CITY-STATE.
  1733             20  MA-CITY                   PIC X(28).
  1734             20  MA-ADDR-STATE             PIC XX.
  1735         16  MA-ZIP.
  1736             20  MA-ZIP-CODE.
  1737                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1738                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1739                 24  FILLER                PIC X(4).
  1740             20  MA-ZIP-PLUS4              PIC X(4).
  1741         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1742             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1743             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1744             20  FILLER                    PIC X(3).
  1745
  1746         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1747
  1748         16  FILLER                        PIC XXX.
  1749*        16  FILLER                        PIC X(10).
  1750
  1751     12  MA-CRED-BENE-INFO.
  1752         16  MA-CRED-BENE-NAME                 PIC X(25).
  1753         16  MA-CRED-BENE-ADDR                 PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  32
* NSRASBL.cbl
  1754         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1755         16  MA-CRED-BENE-CTYST.
  1756             20  MA-CRED-BENE-CITY             PIC X(28).
  1757             20  MA-CRED-BENE-STATE            PIC XX.
  1758         16  MA-CRED-BENE-ZIP.
  1759             20  MA-CB-ZIP-CODE.
  1760                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1761                     88  MA-CB-CANADIAN-POST-CODE
  1762                                           VALUE 'A' THRU 'Z'.
  1763                 24  FILLER                    PIC X(4).
  1764             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1765         16  MA-CB-CANADIAN-POSTAL-CODE
  1766                            REDEFINES MA-CRED-BENE-ZIP.
  1767             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1768             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1769             20  FILLER                        PIC X(3).
  1770     12  MA-POST-CARD-MAIL-DATA.
  1771         16  MA-MAIL-DATA OCCURS 7.
  1772             20  MA-MAIL-TYPE              PIC X.
  1773                 88  MA-12MO-MAILING           VALUE '1'.
  1774                 88  MA-EXP-MAILING            VALUE '2'.
  1775             20  MA-MAIL-STATUS            PIC X.
  1776                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1777                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1778                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1779             20  MA-MAIL-DATE              PIC XX.
  1780     12  FILLER                            PIC XX.
  1781     12  FILLER                            PIC XX.
  1782*    12  FILLER                            PIC X(30).
  1783******************************************************************
  1784*                                COPY ERCCOMP.
  1785******************************************************************
  1786*                                                                *
  1787*                                                                *
  1788*                            ERCCOMP                             *
  1789*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1790*                            VMOD=2.019                          *
  1791*                                                                *
  1792*   ONLINE CREDIT SYSTEM                                         *
  1793*                                                                *
  1794*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1795*                                                                *
  1796*   FILE TYPE = VSAM,KSDS                                        *
  1797*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1798*                                                                *
  1799*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1800*       ALTERNATE PATH = NONE                                    *
  1801*                                                                *
  1802*   LOG = NO                                                     *
  1803*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1804*                                                                *
  1805******************************************************************
  1806*                   C H A N G E   L O G
  1807*
  1808* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1809*-----------------------------------------------------------------
  1810*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1811* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  33
* NSRASBL.cbl
  1812*-----------------------------------------------------------------
  1813* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1814* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1815* 092205    2005050300006  PEMA  ADD LEASE FEE
  1816* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1817* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1818* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1819* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1820* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1821* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1822******************************************************************
  1823
  1824 01  COMPENSATION-MASTER.
  1825     12  CO-RECORD-ID                          PIC XX.
  1826         88  VALID-CO-ID                          VALUE 'CO'.
  1827
  1828     12  CO-CONTROL-PRIMARY.
  1829         16  CO-COMPANY-CD                     PIC X.
  1830         16  CO-CONTROL.
  1831             20  CO-CTL-1.
  1832                 24  CO-CARR-GROUP.
  1833                     28  CO-CARRIER            PIC X.
  1834                     28  CO-GROUPING.
  1835                         32  CO-GROUP-PREFIX   PIC XXX.
  1836                         32  CO-GROUP-PRIME    PIC XXX.
  1837                 24  CO-RESP-NO.
  1838                     28  CO-RESP-PREFIX        PIC X(4).
  1839                     28  CO-RESP-PRIME         PIC X(6).
  1840             20  CO-CTL-2.
  1841                 24  CO-ACCOUNT.
  1842                     28  CO-ACCT-PREFIX        PIC X(4).
  1843                     28  CO-ACCT-PRIME         PIC X(6).
  1844         16  CO-TYPE                           PIC X.
  1845             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1846             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1847             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1848
  1849     12  CO-MAINT-INFORMATION.
  1850         16  CO-LAST-MAINT-DT                  PIC XX.
  1851         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1852         16  CO-LAST-MAINT-USER                PIC X(4).
  1853     12  FILLER                                PIC XX.
  1854     12  CO-STMT-TYPE                          PIC XXX.
  1855     12  CO-COMP-TYPE                          PIC X.
  1856         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1857     12  CO-STMT-OWNER                         PIC X(4).
  1858     12  CO-BALANCE-CONTROL                    PIC X.
  1859         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1860         88  CO-NO-BALANCE                        VALUE 'N'.
  1861
  1862     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1863         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1864         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1865         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1866
  1867     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1868         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1869         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  34
* NSRASBL.cbl
  1870
  1871     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1872     12  CO-GA-DIRECT-DEP                      PIC X.
  1873     12  CO-FUTURE-SPACE                       PIC X.
  1874         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1875
  1876     12  CO-ACCT-NAME                          PIC X(30).
  1877     12  CO-MAIL-NAME                          PIC X(30).
  1878     12  CO-ADDR-1                             PIC X(30).
  1879     12  CO-ADDR-2                             PIC X(30).
  1880     12  CO-ADDR-3.
  1881         16  CO-ADDR-CITY                      PIC X(27).
  1882         16  CO-ADDR-STATE                     PIC XX.
  1883     12  CO-CSO-1099                           PIC X.
  1884     12  CO-ZIP.
  1885         16  CO-ZIP-PRIME.
  1886             20  CO-ZIP-PRI-1ST                PIC X.
  1887                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1888             20  FILLER                        PIC X(4).
  1889         16  CO-ZIP-PLUS4                      PIC X(4).
  1890     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1891         16  CO-CAN-POSTAL-1                   PIC XXX.
  1892         16  CO-CAN-POSTAL-2                   PIC XXX.
  1893         16  FILLER                            PIC XXX.
  1894     12  CO-SOC-SEC                            PIC X(13).
  1895     12  CO-TELEPHONE.
  1896         16  CO-AREA-CODE                      PIC XXX.
  1897         16  CO-PREFIX                         PIC XXX.
  1898         16  CO-PHONE                          PIC X(4).
  1899
  1900     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1901
  1902     12  CO-AR-BAL-LEVEL                       PIC X.
  1903         88  CO-AR-REF-LVL                        VALUE '1'.
  1904         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1905         88  CO-AR-BILL-LVL                       VALUE '2'.
  1906         88  CO-AR-AGT-LVL                        VALUE '3'.
  1907         88  CO-AR-FR-LVL                         VALUE '4'.
  1908
  1909     12  CO-AR-NORMAL-PRINT                    PIC X.
  1910         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1911         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1912
  1913     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1914
  1915     12  CO-AR-REPORTING                       PIC X.
  1916         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1917         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1918
  1919     12  CO-AR-PULL-CHECK                      PIC X.
  1920         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1921         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1922
  1923     12  CO-AR-BALANCE-PRINT                   PIC X.
  1924         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1925
  1926     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1927         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  35
* NSRASBL.cbl
  1928         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1929         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1930
  1931     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1932
  1933     12  CO-USER-CODE                          PIC X.
  1934     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1935
  1936******************************************************************
  1937*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1938*    THE LAST MONTH END RUN.
  1939******************************************************************
  1940
  1941     12  CO-LAST-ACTIVITY-DATE.
  1942         16  CO-ACT-YEAR                       PIC 99.
  1943         16  CO-ACT-MONTH                      PIC 99.
  1944         16  CO-ACT-DAY                        PIC 99.
  1945
  1946     12  CO-LAST-STMT-DT.
  1947         16  CO-LAST-STMT-YEAR                 PIC 99.
  1948         16  CO-LAST-STMT-MONTH                PIC 99.
  1949         16  CO-LAST-STMT-DAY                  PIC 99.
  1950
  1951     12  CO-MO-END-TOTALS.
  1952         16  CO-MONTHLY-TOTALS.
  1953             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1954             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1955             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1956             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1957             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1958
  1959         16  CO-AGING-TOTALS.
  1960             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1961             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1962             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1963             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1964
  1965         16  CO-YTD-TOTALS.
  1966             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1967             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1968
  1969         16  CO-OVER-UNDER-TOTALS.
  1970             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1971             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1972
  1973     12  CO-MISCELLANEOUS-TOTALS.
  1974         16  CO-FICA-TOTALS.
  1975             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1976             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1977
  1978         16  CO-CLAIM-TOTALS.
  1979             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1980             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1981
  1982******************************************************************
  1983*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1984*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1985******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  36
* NSRASBL.cbl
  1986
  1987     12  CO-CURRENT-TOTALS.
  1988         16  CO-CURRENT-LAST-STMT-DT.
  1989             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1990             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1991             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1992
  1993         16  CO-CURRENT-MONTHLY-TOTALS.
  1994             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1995             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1996             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1997             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1998             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1999
  2000         16  CO-CURRENT-AGING-TOTALS.
  2001             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2002             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2003             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2004             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2005
  2006         16  CO-CURRENT-YTD-TOTALS.
  2007             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2008             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2009
  2010     12  CO-PAID-COMM-TOTALS.
  2011         16  CO-YTD-PAID-COMMS.
  2012             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2013             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2014
  2015     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2016         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2017         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2018
  2019     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2020         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2021         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2022         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2023         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2024         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2025         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2026         88  CO-FINAL-LETTER                  VALUE 'F'.
  2027         88  CO-RECONCILING                   VALUE 'R'.
  2028         88  CO-PHONE-CALL                    VALUE 'P'.
  2029         88  CO-LEGAL                         VALUE 'L'.
  2030         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2031         88  CO-WRITE-OFF                     VALUE 'W'.
  2032         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2033
  2034     12  CO-CSR-CODE                       PIC X(4).
  2035
  2036     12  CO-GA-STATUS-INFO.
  2037         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2038         16  CO-GA-TERMINATION-DT          PIC XX.
  2039         16  CO-GA-STATUS-CODE             PIC X.
  2040             88  CO-GA-ACTIVE                 VALUE 'A'.
  2041             88  CO-GA-INACTIVE               VALUE 'I'.
  2042             88  CO-GA-PENDING                VALUE 'P'.
  2043         16  CO-GA-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  37
* NSRASBL.cbl
  2044             20  CO-GA-COMMENT-1           PIC X(40).
  2045             20  CO-GA-COMMENT-2           PIC X(40).
  2046             20  CO-GA-COMMENT-3           PIC X(40).
  2047             20  CO-GA-COMMENT-4           PIC X(40).
  2048
  2049     12  CO-RPTCD2                         PIC X(10).
  2050     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2051         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2052         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2053
  2054     12  CO-TYPE-AGENT                     PIC X(01).
  2055         88  CO-CORPORATION                   VALUE 'C'.
  2056         88  CO-PARTNERSHIP                   VALUE 'P'.
  2057         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2058         88  CO-TRUST                         VALUE 'T'.
  2059         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2060
  2061     12  CO-FAXNO.
  2062         16  CO-FAX-AREA-CODE                  PIC XXX.
  2063         16  CO-FAX-PREFIX                     PIC XXX.
  2064         16  CO-FAX-PHONE                      PIC X(4).
  2065
  2066     12  CO-BANK-INFORMATION.
  2067         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2068         16  CO-BANK-TRANSIT-NON REDEFINES
  2069             CO-BANK-TRANSIT-NO                PIC 9(8).
  2070
  2071         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2072     12  CO-MISC-DEDUCT-INFO REDEFINES
  2073                  CO-BANK-INFORMATION.
  2074         16  CO-MD-GL-ACCT                     PIC X(10).
  2075         16  CO-MD-DIV                         PIC XX.
  2076         16  CO-MD-CENTER                      PIC X(4).
  2077         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2078         16  CO-CREATE-AP-CHECK                PIC X.
  2079         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2080         16  FILLER                            PIC XXX.
  2081     12  CO-ACH-STATUS                         PIC X.
  2082         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2083         88  CO-ACH-PENDING                        VALUE 'P'.
  2084
  2085     12  CO-BILL-SW                            PIC X.
  2086     12  CO-CONTROL-NAME                       PIC X(30).
  2087     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2088     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2089     12  CO-CLP-STATE                          PIC XX.
  2090     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2091     12  CO-SPP-REFUND-EDIT                    PIC X.
  2092
  2093******************************************************************
  2094*                                COPY ELCCERT.
  2095******************************************************************
  2096*                                                                *
  2097*                            ELCCERT.                            *
  2098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2099*                            VMOD=2.013                          *
  2100*                                                                *
  2101*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  38
* NSRASBL.cbl
  2102*                                                                *
  2103*   FILE TYPE = VSAM,KSDS                                        *
  2104*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2105*                                                                *
  2106*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2107*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2108*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2109*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2110*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2111*                                                                *
  2112*   LOG = YES                                                    *
  2113*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2114******************************************************************
  2115*                   C H A N G E   L O G
  2116*
  2117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2118*-----------------------------------------------------------------
  2119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2120* EFFECTIVE    NUMBER
  2121*-----------------------------------------------------------------
  2122* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2123* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2124* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2125* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2126* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2127* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2128* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2129* 032612  CR2011110200001  PEMA  AHL CHANGES
  2130* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2131* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2132* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2133******************************************************************
  2134
  2135 01  CERTIFICATE-MASTER.
  2136     12  CM-RECORD-ID                      PIC XX.
  2137         88  VALID-CM-ID                      VALUE 'CM'.
  2138
  2139     12  CM-CONTROL-PRIMARY.
  2140         16  CM-COMPANY-CD                 PIC X.
  2141         16  CM-CARRIER                    PIC X.
  2142         16  CM-GROUPING.
  2143             20  CM-GROUPING-PREFIX        PIC X(3).
  2144             20  CM-GROUPING-PRIME         PIC X(3).
  2145         16  CM-STATE                      PIC XX.
  2146         16  CM-ACCOUNT.
  2147             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2148             20  CM-ACCOUNT-PRIME          PIC X(6).
  2149         16  CM-CERT-EFF-DT                PIC XX.
  2150         16  CM-CERT-NO.
  2151             20  CM-CERT-PRIME             PIC X(10).
  2152             20  CM-CERT-SFX               PIC X.
  2153
  2154     12  CM-CONTROL-BY-NAME.
  2155         16  CM-COMPANY-CD-A1              PIC X.
  2156         16  CM-INSURED-LAST-NAME          PIC X(15).
  2157         16  CM-INSURED-INITIALS.
  2158             20  CM-INSURED-INITIAL1       PIC X.
  2159             20  CM-INSURED-INITIAL2       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  39
* NSRASBL.cbl
  2160
  2161     12  CM-CONTROL-BY-SSN.
  2162         16  CM-COMPANY-CD-A2              PIC X.
  2163         16  CM-SOC-SEC-NO.
  2164             20  CM-SSN-STATE              PIC XX.
  2165             20  CM-SSN-ACCOUNT            PIC X(6).
  2166             20  CM-SSN-LN3.
  2167                 25  CM-INSURED-INITIALS-A2.
  2168                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2169                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2170                 25 CM-PART-LAST-NAME-A2         PIC X.
  2171
  2172     12  CM-CONTROL-BY-CERT-NO.
  2173         16  CM-COMPANY-CD-A4              PIC X.
  2174         16  CM-CERT-NO-A4                 PIC X(11).
  2175
  2176     12  CM-CONTROL-BY-MEMB.
  2177         16  CM-COMPANY-CD-A5              PIC X.
  2178         16  CM-MEMBER-NO.
  2179             20  CM-MEMB-STATE             PIC XX.
  2180             20  CM-MEMB-ACCOUNT           PIC X(6).
  2181             20  CM-MEMB-LN4.
  2182                 25  CM-INSURED-INITIALS-A5.
  2183                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2184                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2185                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2186
  2187     12  CM-INSURED-PROFILE-DATA.
  2188         16  CM-INSURED-FIRST-NAME.
  2189             20  CM-INSURED-1ST-INIT       PIC X.
  2190             20  FILLER                    PIC X(9).
  2191         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2192         16  CM-INSURED-SEX                PIC X.
  2193             88  CM-SEX-MALE                  VALUE 'M'.
  2194             88  CM-SEX-FEMAL                 VALUE 'F'.
  2195         16  CM-INSURED-JOINT-AGE          PIC 99.
  2196         16  CM-JOINT-INSURED-NAME.
  2197             20  CM-JT-LAST-NAME           PIC X(15).
  2198             20  CM-JT-FIRST-NAME.
  2199                 24  CM-JT-1ST-INIT        PIC X.
  2200                 24  FILLER                PIC X(9).
  2201             20  CM-JT-INITIAL             PIC X.
  2202
  2203     12  CM-LIFE-DATA.
  2204         16  CM-LF-BENEFIT-CD              PIC XX.
  2205         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2206         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2207         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2208         16  CM-LF-DEV-CODE                PIC XXX.
  2209         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2210         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2211         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2212         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2213         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2214         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2215         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2216         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2217         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  40
* NSRASBL.cbl
  2218         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2219         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2220         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2221         16  cm-temp-epiq                  pic xx.
  2222             88  EPIQ-CLASS                  value 'EQ'.
  2223*        16  FILLER                        PIC XX.
  2224
  2225     12  CM-AH-DATA.
  2226         16  CM-AH-BENEFIT-CD              PIC XX.
  2227         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2228         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2229         16  CM-AH-DEV-CODE                PIC XXX.
  2230         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2231         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2232         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2233         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2234         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2235         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2236         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2237         16  CM-AH-PAID-THRU-DT            PIC XX.
  2238             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2239         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2240         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2241         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2242         16  FILLER                        PIC X.
  2243
  2244     12  CM-LOAN-INFORMATION.
  2245         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2246         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2247                                           PIC S9(5)V99  COMP-3.
  2248         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2249         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2250         16  CM-PAY-FREQUENCY              PIC S99.
  2251         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2252         16  CM-RATE-CLASS                 PIC XX.
  2253         16  CM-BENEFICIARY                PIC X(25).
  2254         16  CM-POLICY-FORM-NO             PIC X(12).
  2255         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2256         16  CM-LAST-ADD-ON-DT             PIC XX.
  2257         16  CM-DEDUCTIBLE-AMOUNTS.
  2258             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2259             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2260         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2261             20  CM-RESIDENT-STATE         PIC XX.
  2262             20  CM-RATE-CODE              PIC X(4).
  2263             20  FILLER                    PIC XX.
  2264         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2265             20  CM-LOAN-OFFICER           PIC X(5).
  2266             20  FILLER                    PIC XXX.
  2267         16  CM-CSR-CODE                   PIC XXX.
  2268         16  CM-UNDERWRITING-CODE          PIC X.
  2269             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2270         16  CM-POST-CARD-IND              PIC X.
  2271         16  CM-REF-INTERFACE-SW           PIC X.
  2272         16  CM-PREMIUM-TYPE               PIC X.
  2273             88  CM-SING-PRM                  VALUE '1'.
  2274             88  CM-O-B-COVERAGE              VALUE '2'.
  2275             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  41
* NSRASBL.cbl
  2276         16  CM-IND-GRP-TYPE               PIC X.
  2277             88  CM-INDIVIDUAL                VALUE 'I'.
  2278             88  CM-GROUP                     VALUE 'G'.
  2279         16  CM-SKIP-CODE                  PIC X.
  2280             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2281             88  SKIP-JULY                    VALUE '1'.
  2282             88  SKIP-AUGUST                  VALUE '2'.
  2283             88  SKIP-SEPTEMBER               VALUE '3'.
  2284             88  SKIP-JULY-AUG                VALUE '4'.
  2285             88  SKIP-AUG-SEPT                VALUE '5'.
  2286             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2287             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2288             88  SKIP-JUNE                    VALUE '8'.
  2289             88  SKIP-JUNE-JULY               VALUE '9'.
  2290             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2291             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2292         16  CM-PAYMENT-MODE               PIC X.
  2293             88  PAY-MONTHLY                  VALUE SPACE.
  2294             88  PAY-WEEKLY                   VALUE '1'.
  2295             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2296             88  PAY-BI-WEEKLY                VALUE '3'.
  2297             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2298         16  CM-LOAN-NUMBER                PIC X(8).
  2299         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2300         16  CM-OLD-LOF                    PIC XXX.
  2301*        16  CM-LOAN-OFFICER               PIC XXX.
  2302         16  CM-REIN-TABLE                 PIC XXX.
  2303         16  CM-SPECIAL-REIN-CODE          PIC X.
  2304         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2305         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2306         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2307
  2308     12  CM-STATUS-DATA.
  2309         16  CM-ENTRY-STATUS               PIC X.
  2310         16  CM-ENTRY-DT                   PIC XX.
  2311
  2312         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2313         16  CM-LF-CANCEL-DT               PIC XX.
  2314         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2315
  2316         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2317         16  CM-LF-DEATH-DT                PIC XX.
  2318         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2319
  2320         16  CM-LF-CURRENT-STATUS          PIC X.
  2321             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2322                                                'M' '4' '5' '9'.
  2323             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2324             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2325             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2326             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2327             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2328             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2329             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2330             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2331             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2332             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2333             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  42
* NSRASBL.cbl
  2334             88  CM-LF-DECLINED               VALUE 'D'.
  2335             88  CM-LF-VOIDED                 VALUE 'V'.
  2336
  2337         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2338         16  CM-AH-CANCEL-DT               PIC XX.
  2339         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2340
  2341         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2342         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2343         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2344
  2345         16  CM-AH-CURRENT-STATUS          PIC X.
  2346             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2347                                                'M' '4' '5' '9'.
  2348             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2349             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2350             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2351             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2352             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2353             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2354             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2355             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2356             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2357             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2358             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2359             88  CM-AH-DECLINED               VALUE 'D'.
  2360             88  CM-AH-VOIDED                 VALUE 'V'.
  2361
  2362         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2363             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2364             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2365             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2366         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2367
  2368         16  CM-ENTRY-BATCH                PIC X(6).
  2369         16  CM-LF-EXIT-BATCH              PIC X(6).
  2370         16  CM-AH-EXIT-BATCH              PIC X(6).
  2371         16  CM-LAST-MONTH-END             PIC XX.
  2372
  2373     12  CM-NOTE-SW                        PIC X.
  2374         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2375         88  CERT-NOTES-PRESENT               VALUE '1'.
  2376         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2377         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2378         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2379         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2380         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2381         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2382     12  CM-COMP-EXCP-SW                   PIC X.
  2383         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2384         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2385     12  CM-INSURED-ADDRESS-SW             PIC X.
  2386         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2387         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2388
  2389*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2390     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2391     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  43
* NSRASBL.cbl
  2392
  2393*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2394     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2395     12  FILLER                            PIC X.
  2396*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2397     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2398
  2399     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2400         88  CERT-ADDED-BATCH                 VALUE ' '.
  2401         88  CERT-ADDED-ONLINE                VALUE '1'.
  2402         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2403         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2404         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2405     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2406         88  CERT-AS-LOADED                   VALUE ' '.
  2407         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2408         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2409         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2410         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2411         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2412         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2413         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2414
  2415     12  CM-ACCOUNT-COMM-PCTS.
  2416         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2417         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2418
  2419     12  CM-USER-FIELD                     PIC X.
  2420     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2421     12  CM-CLP-STATE                      PIC XX.
  2422     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2423     12  CM-USER-RESERVED                  PIC XXX.
  2424     12  FILLER REDEFINES CM-USER-RESERVED.
  2425         16  CM-AH-CLASS-CD                PIC XX.
  2426         16  F                             PIC X.
  2427******************************************************************
  2428*                                COPY ELCCRTO.
  2429******************************************************************
  2430*                                                                *
  2431*                            ELCCRTO.                            *
  2432*                                                                *
  2433*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2434*                                                                *
  2435*   FILE TYPE = VSAM,KSDS                                        *
  2436*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2437*                                                                *
  2438*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2439*                                                                *
  2440*   LOG = YES                                                    *
  2441*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2442******************************************************************
  2443*                   C H A N G E   L O G
  2444*
  2445* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2446*-----------------------------------------------------------------
  2447*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2448* EFFECTIVE    NUMBER
  2449*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  44
* NSRASBL.cbl
  2450* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2451* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2452* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2453* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2454* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2455******************************************************************
  2456 01  ORIGINAL-CERTIFICATE.
  2457     12  OC-RECORD-ID                      PIC XX.
  2458         88  VALID-OC-ID                      VALUE 'OC'.
  2459     12  OC-CONTROL-PRIMARY.
  2460         16  OC-COMPANY-CD                 PIC X.
  2461         16  OC-CARRIER                    PIC X.
  2462         16  OC-GROUPING                   PIC X(6).
  2463         16  OC-STATE                      PIC XX.
  2464         16  OC-ACCOUNT                    PIC X(10).
  2465         16  OC-CERT-EFF-DT                PIC XX.
  2466         16  OC-CERT-NO.
  2467             20  OC-CERT-PRIME             PIC X(10).
  2468             20  OC-CERT-SFX               PIC X.
  2469         16  OC-RECORD-TYPE                PIC X.
  2470         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2471     12  OC-LAST-MAINT-DT                  PIC XX.
  2472     12  OC-LAST-MAINT-BY                  PIC X(4).
  2473     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2474     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2475     12  FILLER                            PIC X(49).
  2476     12  OC-ORIG-REC.
  2477         16  OC-INS-LAST-NAME              PIC X(15).
  2478         16  OC-INS-FIRST-NAME             PIC X(10).
  2479         16  OC-INS-MIDDLE-INIT            PIC X.
  2480         16  OC-INS-AGE                    PIC S999     COMP-3.
  2481         16  OC-JNT-LAST-NAME              PIC X(15).
  2482         16  OC-JNT-FIRST-NAME             PIC X(10).
  2483         16  OC-JNT-MIDDLE-INIT            PIC X.
  2484         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2485         16  OC-LF-BENCD                   PIC XX.
  2486         16  OC-LF-TERM                    PIC S999      COMP-3.
  2487         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2488         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2489         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2490         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2491         16  OC-LF-EXP-DT                  PIC XX.
  2492         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2493         16  OC-LF-CANCEL-DT               PIC XX.
  2494         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2495         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2496         16  OC-AH-BENCD                   PIC XX.
  2497         16  OC-AH-TERM                    PIC S999      COMP-3.
  2498         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2499         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2500         16  OC-AH-EXP-DT                  PIC XX.
  2501         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2502         16  OC-AH-CP                      PIC 99.
  2503         16  OC-AH-CANCEL-DT               PIC XX.
  2504         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2505         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2506         16  OC-CRED-BENE-NAME             PIC X(25).
  2507         16  OC-1ST-PMT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  45
* NSRASBL.cbl
  2508         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2509         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2510         16  OC-ISSUE-TRAN-IND             PIC X.
  2511         16  OC-CANCEL-TRAN-IND            PIC X.
  2512         16  FILLER                        PIC X(211).
  2513
  2514     12  FILLER                            PIC X(50).
  2515******************************************************************
  2516*                                COPY ERCACCT.
  2517******************************************************************
  2518*                                                                *
  2519*                                                                *
  2520*                            ERCACCT                             *
  2521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2522*                            VMOD=2.031                          *
  2523*                                                                *
  2524*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2525*                                                                *
  2526*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2527*   VSAM ACCOUNT MASTER FILES.                                   *
  2528*                                                                *
  2529*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2530*                                                                *
  2531*   FILE TYPE = VSAM,KSDS                                        *
  2532*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2533*                                                                *
  2534*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2535*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2536*                                                                *
  2537*   LOG = NO                                                     *
  2538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2539*                                                                *
  2540*                                                                *
  2541******************************************************************
  2542*                   C H A N G E   L O G
  2543*
  2544* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2545*-----------------------------------------------------------------
  2546*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2547* EFFECTIVE    NUMBER
  2548*-----------------------------------------------------------------
  2549* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2550* 092705    2005050300006  PEMA  ADD SPP LEASES
  2551* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2552* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2553* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2554* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2555* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2556* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2557******************************************************************
  2558
  2559 01  ACCOUNT-MASTER.
  2560     12  AM-RECORD-ID                      PIC XX.
  2561         88  VALID-AM-ID                      VALUE 'AM'.
  2562
  2563     12  AM-CONTROL-PRIMARY.
  2564         16  AM-COMPANY-CD                 PIC X.
  2565         16  AM-MSTR-CNTRL.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  46
* NSRASBL.cbl
  2566             20  AM-CONTROL-A.
  2567                 24  AM-CARRIER            PIC X.
  2568                 24  AM-GROUPING.
  2569                     28 AM-GROUPING-PREFIX PIC XXX.
  2570                     28 AM-GROUPING-PRIME  PIC XXX.
  2571                 24  AM-STATE              PIC XX.
  2572                 24  AM-ACCOUNT.
  2573                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2574                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2575             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2576                                           PIC X(19).
  2577             20  AM-CNTRL-B.
  2578                 24  AM-EXPIRATION-DT      PIC XX.
  2579                 24  FILLER                PIC X(4).
  2580             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2581                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2582
  2583     12  AM-CONTROL-BY-VAR-GRP.
  2584         16  AM-COMPANY-CD-A1              PIC X.
  2585         16  AM-VG-CARRIER                 PIC X.
  2586         16  AM-VG-GROUPING                PIC X(6).
  2587         16  AM-VG-STATE                   PIC XX.
  2588         16  AM-VG-ACCOUNT                 PIC X(10).
  2589         16  AM-VG-DATE.
  2590             20  AM-VG-EXPIRATION-DT       PIC XX.
  2591             20  FILLER                    PIC X(4).
  2592         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2593                                           PIC 9(11)      COMP-3.
  2594     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2595         16  FILLER                        PIC X(10).
  2596         16  AM-VG-KEY3.
  2597             20  AM-VG3-ACCOUNT            PIC X(10).
  2598             20  AM-VG3-EXP-DT             PIC XX.
  2599         16  FILLER                        PIC X(4).
  2600     12  AM-MAINT-INFORMATION.
  2601         16  AM-LAST-MAINT-DT              PIC XX.
  2602         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2603         16  AM-LAST-MAINT-USER            PIC X(4).
  2604         16  FILLER                        PIC XX.
  2605
  2606     12  AM-EFFECTIVE-DT                   PIC XX.
  2607     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2608
  2609     12  AM-PREV-DATES  COMP-3.
  2610         16  AM-PREV-EXP-DT                PIC 9(11).
  2611         16  AM-PREV-EFF-DT                PIC 9(11).
  2612
  2613     12  AM-REPORT-CODE-1                  PIC X(10).
  2614     12  AM-REPORT-CODE-2                  PIC X(10).
  2615
  2616     12  AM-CITY-CODE                      PIC X(4).
  2617     12  AM-COUNTY-PARISH                  PIC X(6).
  2618
  2619     12  AM-NAME                           PIC X(30).
  2620     12  AM-PERSON                         PIC X(30).
  2621     12  AM-ADDRS                          PIC X(30).
  2622     12  AM-CITY.
  2623         16  AM-ADDR-CITY                  PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  47
* NSRASBL.cbl
  2624         16  AM-ADDR-STATE                 PIC XX.
  2625     12  AM-ZIP.
  2626         16  AM-ZIP-PRIME.
  2627             20  AM-ZIP-PRI-1ST            PIC X.
  2628                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2629             20  FILLER                    PIC X(4).
  2630         16  AM-ZIP-PLUS4                  PIC X(4).
  2631     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2632         16  AM-CAN-POSTAL-1               PIC XXX.
  2633         16  AM-CAN-POSTAL-2               PIC XXX.
  2634         16  FILLER                        PIC XXX.
  2635     12  AM-TEL-NO.
  2636         16  AM-AREA-CODE                  PIC 999.
  2637         16  AM-TEL-PRE                    PIC 999.
  2638         16  AM-TEL-NBR                    PIC 9(4).
  2639     12  AM-TEL-LOC                        PIC X.
  2640         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2641         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2642
  2643     12  AM-COMM-STRUCTURE.
  2644         16  AM-DEFN-1.
  2645             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2646                 24  AM-AGT.
  2647                     28  AM-AGT-PREFIX     PIC X(4).
  2648                     28  AM-AGT-PRIME      PIC X(6).
  2649                 24  AM-COM-TYP            PIC X.
  2650                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2651                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2652                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2653                 24  AM-RECALC-LV-INDIC    PIC X.
  2654                 24  AM-RETRO-LV-INDIC     PIC X.
  2655                 24  AM-GL-CODES           PIC X.
  2656                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2657                 24  FILLER                PIC X(01).
  2658         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2659             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2660                 24  FILLER                PIC X(11).
  2661                 24  AM-L-COMA             PIC XXX.
  2662                 24  AM-J-COMA             PIC XXX.
  2663                 24  AM-A-COMA             PIC XXX.
  2664                 24  FILLER                PIC X(6).
  2665
  2666     12  AM-COMM-CHANGE-STATUS             PIC X.
  2667         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2668
  2669     12  AM-CSR-CODE                       PIC X(4).
  2670
  2671     12  AM-BILLING-STATUS                 PIC X.
  2672         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2673         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2674     12  AM-AUTO-REFUND-SW                 PIC X.
  2675         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2676         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2677     12  AM-GPCD                           PIC 99.
  2678     12  AM-IG                             PIC X.
  2679         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2680         88  AM-HAS-GROUP                     VALUE '2'.
  2681     12  AM-STATUS                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  48
* NSRASBL.cbl
  2682         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2683         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2684         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2685         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2686         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2687         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2688         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2689         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2690         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2691         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2692     12  AM-REMIT-TO                       PIC 99.
  2693     12  AM-ID-NO                          PIC X(11).
  2694
  2695     12  AM-CAL-TABLE                      PIC XX.
  2696     12  AM-LF-DEVIATION                   PIC XXX.
  2697     12  AM-AH-DEVIATION                   PIC XXX.
  2698     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2699     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2700     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2701     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2702     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2703     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2704
  2705     12  AM-USER-FIELDS.
  2706         16  AM-FLD-1                      PIC XX.
  2707         16  AM-FLD-2                      PIC XX.
  2708         16  AM-FLD-3                      PIC XX.
  2709         16  AM-FLD-4                      PIC XX.
  2710         16  AM-FLD-5                      PIC XX.
  2711
  2712     12  AM-1ST-PROD-DATE.
  2713         16  AM-1ST-PROD-YR                PIC XX.
  2714         16  AM-1ST-PROD-MO                PIC XX.
  2715         16  AM-1ST-PROD-DA                PIC XX.
  2716     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2717     12  AM-CERTS-PURGED-DATE.
  2718         16  AM-PUR-YR                     PIC XX.
  2719         16  AM-PUR-MO                     PIC XX.
  2720         16  AM-PUR-DA                     PIC XX.
  2721     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2722     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2723     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2724     12  AM-INACTIVE-DATE.
  2725         16  AM-INA-MO                     PIC 99.
  2726         16  AM-INA-DA                     PIC 99.
  2727         16  AM-INA-YR                     PIC 99.
  2728     12  AM-AR-HI-CERT-DATE                PIC XX.
  2729
  2730     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2731     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2732
  2733     12  AM-OB-PAYMENT-MODE                PIC X.
  2734         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2735         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2736         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2737         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2738
  2739     12  AM-AH-ONLY-INDICATOR              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  49
* NSRASBL.cbl
  2740         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2741         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2742
  2743     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2744
  2745     12  AM-OVER-SHORT.
  2746         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2747         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2748
  2749     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2750     12  AM-DCC-CLP-STATE                  PIC XX.
  2751
  2752     12  AM-RECALC-COMM                    PIC X.
  2753     12  AM-RECALC-REIN                    PIC X.
  2754
  2755     12  AM-REI-TABLE                      PIC XXX.
  2756     12  AM-REI-ET-LF                      PIC X.
  2757     12  AM-REI-ET-AH                      PIC X.
  2758     12  AM-REI-PE-LF                      PIC X.
  2759     12  AM-REI-PE-AH                      PIC X.
  2760     12  AM-REI-PRT-ST                     PIC X.
  2761     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2762     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2763     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2764     12  AM-REI-GROUP-A                    PIC X(6).
  2765     12  AM-REI-MORT                       PIC X(4).
  2766     12  AM-REI-PRT-OW                     PIC X.
  2767     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2768     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2769     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2770     12  AM-REI-GROUP-B                    PIC X(6).
  2771
  2772     12  AM-TRUST-TYPE                     PIC X(2).
  2773
  2774     12  AM-EMPLOYER-STMT-USED             PIC X.
  2775     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2776
  2777     12  AM-STD-AH-TYPE                    PIC XX.
  2778     12  AM-EARN-METHODS.
  2779         16  AM-EARN-METHOD-R              PIC X.
  2780             88 AM-REF-RL-R78                 VALUE 'R'.
  2781             88 AM-REF-RL-PR                  VALUE 'P'.
  2782             88 AM-REF-RL-MEAN                VALUE 'M'.
  2783             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2784         16  AM-EARN-METHOD-L              PIC X.
  2785             88 AM-REF-LL-R78                 VALUE 'R'.
  2786             88 AM-REF-LL-PR                  VALUE 'P'.
  2787             88 AM-REF-LL-MEAN                VALUE 'M'.
  2788             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2789         16  AM-EARN-METHOD-A              PIC X.
  2790             88 AM-REF-AH-R78                 VALUE 'R'.
  2791             88 AM-REF-AH-PR                  VALUE 'P'.
  2792             88 AM-REF-AH-MEAN                VALUE 'M'.
  2793             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2794             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2795             88 AM-REF-AH-NET                 VALUE 'N'.
  2796
  2797     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  50
* NSRASBL.cbl
  2798     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2799     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2800
  2801     12  AM-RET-Y-N                        PIC X.
  2802     12  AM-RET-P-E                        PIC X.
  2803     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2804     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2805     12  AM-RET-GRP                        PIC X(6).
  2806     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2807         16  AM-POOL-PRIME                 PIC XXX.
  2808         16  AM-POOL-SUB                   PIC XXX.
  2809     12  AM-RETRO-EARNINGS.
  2810         16  AM-RET-EARN-R                 PIC X.
  2811         16  AM-RET-EARN-L                 PIC X.
  2812         16  AM-RET-EARN-A                 PIC X.
  2813     12  AM-RET-ST-TAX-USE                 PIC X.
  2814         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2815         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2816     12  AM-RETRO-BEG-EARNINGS.
  2817         16  AM-RET-BEG-EARN-R             PIC X.
  2818         16  AM-RET-BEG-EARN-L             PIC X.
  2819         16  AM-RET-BEG-EARN-A             PIC X.
  2820     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2821     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2822
  2823     12  AM-USER-SELECT-OPTIONS.
  2824         16  AM-USER-SELECT-1              PIC X(10).
  2825         16  AM-USER-SELECT-2              PIC X(10).
  2826         16  AM-USER-SELECT-3              PIC X(10).
  2827         16  AM-USER-SELECT-4              PIC X(10).
  2828         16  AM-USER-SELECT-5              PIC X(10).
  2829
  2830     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2831
  2832     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2833
  2834     12  AM-RPT045A-SWITCH                 PIC X.
  2835         88  RPT045A-OFF                   VALUE 'N'.
  2836
  2837     12  AM-INSURANCE-LIMITS.
  2838         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2839         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2840
  2841     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2842         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2843
  2844     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2845         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2846         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2847
  2848     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2849
  2850     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2851     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2852     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2853     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2854     12  AM-DCC-UEF-STATE                  PIC XX.
  2855     12  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  51
* NSRASBL.cbl
  2856     12  AM-REPORT-CODE-3                  PIC X(10).
  2857*    12  FILLER                            PIC X(22).
  2858
  2859     12  AM-RESERVE-DATE.
  2860         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2861         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2862         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2863
  2864     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2865     12  AM-NOTIFICATION-TYPES.
  2866         16  AM-NOTIF-OF-LETTERS           PIC X.
  2867         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2868         16  AM-NOTIF-OF-REPORTS           PIC X.
  2869         16  AM-NOTIF-OF-STATUS            PIC X.
  2870
  2871     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2872         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2873         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2874         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2875         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2876
  2877     12  AM-BENEFIT-CONTROLS.
  2878         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2879             20  AM-BENEFIT-CODE           PIC XX.
  2880             20  AM-BENEFIT-TYPE           PIC X.
  2881             20  AM-BENEFIT-REVISION       PIC XXX.
  2882             20  AM-BENEFIT-REM-TERM       PIC X.
  2883             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2884             20  FILLER                    PIC XX.
  2885         16  FILLER                        PIC X(80).
  2886
  2887     12  AM-TRANSFER-DATA.
  2888         16  AM-TRANSFERRED-FROM.
  2889             20  AM-TRNFROM-CARRIER        PIC X.
  2890             20  AM-TRNFROM-GROUPING.
  2891                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2892                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2893             20  AM-TRNFROM-STATE          PIC XX.
  2894             20  AM-TRNFROM-ACCOUNT.
  2895                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2896                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2897             20  AM-TRNFROM-DTE            PIC XX.
  2898         16  AM-TRANSFERRED-TO.
  2899             20  AM-TRNTO-CARRIER          PIC X.
  2900             20  AM-TRNTO-GROUPING.
  2901                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2902                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2903             20  AM-TRNTO-STATE            PIC XX.
  2904             20  AM-TRNTO-ACCOUNT.
  2905                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2906                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2907             20  AM-TRNTO-DTE              PIC XX.
  2908         16  FILLER                        PIC X(10).
  2909
  2910     12  AM-SAVED-REMIT-TO                 PIC 99.
  2911
  2912     12  AM-COMM-STRUCTURE-SAVED.
  2913         16  AM-DEFN-1-SAVED.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  52
* NSRASBL.cbl
  2914             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2915                 24  AM-AGT-SV             PIC X(10).
  2916                 24  AM-COM-TYP-SV         PIC X.
  2917                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2918                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2919                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2920                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2921                 24  FILLER                PIC X.
  2922                 24  AM-GL-CODES-SV        PIC X.
  2923                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2924                 24  FILLER                PIC X.
  2925         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2926             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2927                 24  FILLER                PIC X(11).
  2928                 24  AM-L-COMA-SV          PIC XXX.
  2929                 24  AM-J-COMA-SV          PIC XXX.
  2930                 24  AM-A-COMA-SV          PIC XXX.
  2931                 24  FILLER                PIC X(6).
  2932
  2933     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2934         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2935            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2936            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2937            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2938
  2939     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2940     12  FILLER                            PIC X(120).
  2941
  2942     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2943         16  AM-CONTROL-NAME               PIC X(30).
  2944         16  AM-EXECUTIVE-ONE.
  2945             20  AM-EXEC1-NAME             PIC X(15).
  2946             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2947                                                          COMP-3.
  2948             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2949                                                          COMP-3.
  2950         16  AM-EXECUTIVE-TWO.
  2951             20  AM-EXEC2-NAME             PIC X(15).
  2952             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2953                                                          COMP-3.
  2954             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2955                                                          COMP-3.
  2956
  2957     12  AM-RETRO-ADDITIONAL-DATA.
  2958         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2959         16  AM-RETRO-PREM-P-E             PIC X.
  2960         16  AM-RETRO-CLMS-P-I             PIC X.
  2961         16  AM-RETRO-RET-BRACKET-LF.
  2962             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2963                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2964                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2965             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2966                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2967                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2968             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2969                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2970                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2971         16  AM-RETRO-RET-BRACKET-AH.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  53
* NSRASBL.cbl
  2972             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2973                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2974                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2975                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2976             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2977                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2978                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2979             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2980                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2981                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2982
  2983     12  AM-COMMENTS.
  2984         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2985
  2986     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2987         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2988         16  AM-FLI-BILLING-CODE           PIC X.
  2989         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2990         16  AM-FLI-UNITED-IDENT           PIC X.
  2991         16  AM-FLI-INTEREST-LOST-DATA.
  2992             20  AM-FLI-BANK-NO            PIC X(5).
  2993             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2994             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2995             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2996         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2997             20  AM-FLI-AGT                PIC X(9).
  2998             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2999             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3000         16  FILLER                        PIC X(102).
  3001
  3002     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3003         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3004             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3005             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3006             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3007             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3008             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3009         16  FILLER                          PIC X(10).
  3010******************************************************************
  3011*                                COPY ELCTEXT.
  3012******************************************************************
  3013*                                                                *
  3014*                                                                *
  3015*                            ELCTEXT.                            *
  3016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3017*                            VMOD=2.008                          *
  3018*                                                                *
  3019*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3020*                                     FORM LETTERS,              *
  3021*                                     CERT FORM DISPLAY.
  3022*                                                                *
  3023*   FILE TYPE = VSAM,KSDS                                        *
  3024*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3025*                                                                *
  3026*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3027*       ALTERNATE INDEX = NONE                                   *
  3028*                                                                *
  3029*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  54
* NSRASBL.cbl
  3030*       ALTERNATE INDEX = NONE                                   *
  3031*                                                                *
  3032*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3033*       ALTERNATE INDEX = NONE                                   *
  3034*                                                                *
  3035*   LOG = NO                                                     *
  3036*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3037******************************************************************
  3038 01  TEXT-FILES.
  3039     12  TEXT-FILE-ID                PIC XX.
  3040         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3041         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3042         88  HELP-FILE-TEXT             VALUE 'TH'.
  3043
  3044     12  TX-CONTROL-PRIMARY.
  3045         16  TX-COMPANY-CD           PIC X.
  3046             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3047         16  TX-ACCESS-CD-GENL       PIC X(12).
  3048
  3049         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3050             20  TX-LETTER-NO        PIC X(4).
  3051             20  FILLER              PIC X(8).
  3052
  3053         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3054             20  TX-FORM-NO          PIC X(12).
  3055
  3056         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3057             20  TX-HELP-TYPE        PIC X.
  3058                 88  HELP-FOR-GENERAL   VALUE ' '.
  3059                 88  HELP-BY-SCREEN     VALUE 'S'.
  3060                 88  HELP-BY-ERROR      VALUE 'E'.
  3061             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3062                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3063             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3064                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3065             20  FILLER              PIC X(4).
  3066
  3067         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3068
  3069     12  TX-PROCESS-CONTROL          PIC XX.
  3070         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3071
  3072     12  TX-TEXT-LINE                PIC X(70).
  3073
  3074     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3075         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3076         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3077         88  TX-VALID-FORM-SQUEEZE-VALUE
  3078                                        VALUE 'Y' ' '.
  3079
  3080     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3081         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3082         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3083         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3084         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3085         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3086         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3087         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  55
* NSRASBL.cbl
  3088                                              'K' 'N' ' '
  3089                                              'Z'.
  3090
  3091     12  TX-ARCHIVE-SW               PIC X.
  3092         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3093         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3094         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3095
  3096     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3097     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3098
  3099     12  TX-BSR-CODE                 PIC X.
  3100         88  TX-BSR-LETTER              VALUE 'B'.
  3101         88  TX-NON-BSR-LETTER          VALUE ' '.
  3102
  3103     12  FILLER                      PIC X.
  3104*****************************************************************
  3105*                                COPY ELCCNTL.
  3106******************************************************************
  3107*                                                                *
  3108*                                                                *
  3109*                            ELCCNTL.                            *
  3110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3111*                            VMOD=2.059                          *
  3112*                                                                *
  3113*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3114*                                                                *
  3115*   FILE TYPE = VSAM,KSDS                                        *
  3116*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3117*                                                                *
  3118*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3119*       ALTERNATE INDEX = NONE                                   *
  3120*                                                                *
  3121*   LOG = YES                                                    *
  3122*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3123******************************************************************
  3124*                   C H A N G E   L O G
  3125*
  3126* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3127*-----------------------------------------------------------------
  3128*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3129* EFFECTIVE    NUMBER
  3130*-----------------------------------------------------------------
  3131* 082503                   PEMA  ADD BENEFIT GROUP
  3132* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3133* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3134* 092705    2005050300006  PEMA  ADD SPP LEASES
  3135* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3136* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3137* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3138* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3139* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3140* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3141* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3142* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3143* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3144* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3145* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  56
* NSRASBL.cbl
  3146******************************************************************
  3147*
  3148 01  CONTROL-FILE.
  3149     12  CF-RECORD-ID                       PIC XX.
  3150         88  VALID-CF-ID                        VALUE 'CF'.
  3151
  3152     12  CF-CONTROL-PRIMARY.
  3153         16  CF-COMPANY-ID                  PIC XXX.
  3154         16  CF-RECORD-TYPE                 PIC X.
  3155             88  CF-COMPANY-MASTER              VALUE '1'.
  3156             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3157             88  CF-STATE-MASTER                VALUE '3'.
  3158             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3159             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3160             88  CF-CARRIER-MASTER              VALUE '6'.
  3161             88  CF-MORTALITY-MASTER            VALUE '7'.
  3162             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3163             88  CF-TERMINAL-MASTER             VALUE '9'.
  3164             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3165             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3166             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3167             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3168             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3169             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3170             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3171             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3172             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3173         16  CF-ACCESS-CD-GENL              PIC X(4).
  3174         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3175             20  CF-PROCESSOR               PIC X(4).
  3176         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3177             20  CF-STATE-CODE              PIC XX.
  3178             20  FILLER                     PIC XX.
  3179         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3180             20  FILLER                     PIC XX.
  3181             20  CF-HI-BEN-IN-REC           PIC XX.
  3182         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3183             20  FILLER                     PIC XXX.
  3184             20  CF-CARRIER-CNTL            PIC X.
  3185         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3186             20  FILLER                     PIC XX.
  3187             20  CF-HI-TYPE-IN-REC          PIC 99.
  3188         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3189             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3190                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3191             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3192             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3193         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3194             20  FILLER                     PIC X.
  3195             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3196         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3197             20  FILLER                     PIC XX.
  3198             20  CF-MORTGAGE-PLAN           PIC XX.
  3199         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3200
  3201     12  CF-LAST-MAINT-DT                   PIC XX.
  3202     12  CF-LAST-MAINT-BY                   PIC X(4).
  3203     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  57
* NSRASBL.cbl
  3204
  3205     12  CF-RECORD-BODY                     PIC X(728).
  3206
  3207
  3208****************************************************************
  3209*             COMPANY MASTER RECORD                            *
  3210****************************************************************
  3211
  3212     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3213         16  CF-COMPANY-ADDRESS.
  3214             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3215             20  CF-CL-IN-CARE-OF           PIC X(30).
  3216             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3217             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3218             20  CF-CL-CITY-STATE           PIC X(30).
  3219             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3220             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3221         16  CF-COMPANY-CD                  PIC X.
  3222         16  CF-COMPANY-PASSWORD            PIC X(8).
  3223         16  CF-SECURITY-OPTION             PIC X.
  3224             88  ALL-SECURITY                   VALUE '1'.
  3225             88  COMPANY-VERIFY                 VALUE '2'.
  3226             88  PROCESSOR-VERIFY               VALUE '3'.
  3227             88  NO-SECURITY                    VALUE '4'.
  3228             88  ALL-BUT-TERM                   VALUE '5'.
  3229         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3230             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3231         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3232             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3233         16  CF-INFORCE-LOCATION            PIC X.
  3234             88  CERTS-ARE-ONLINE               VALUE '1'.
  3235             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3236             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3237         16  CF-LOWER-CASE-LETTERS          PIC X.
  3238         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3239             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3240             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3241             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3242             88  CF-ACCNT-CNTL                  VALUE '3'.
  3243             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3244
  3245         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3246         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3247
  3248         16  CF-LGX-CREDIT-USER             PIC X.
  3249             88  CO-IS-NOT-USER                 VALUE 'N'.
  3250             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3251
  3252         16 CF-CREDIT-CALC-CODES.
  3253             20  CF-CR-REM-TERM-CALC PIC X.
  3254               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3255               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3256               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3257               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3258               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3259               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3260               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3261             20  CF-CR-R78-METHOD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  58
* NSRASBL.cbl
  3262               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3263               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3264
  3265         16  CF-CLAIM-CONTROL-COUNTS.
  3266             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3267                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3268
  3269             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3270                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3271
  3272             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3273                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3274
  3275             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3276                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3277
  3278         16  CF-CURRENT-MONTH-END           PIC XX.
  3279
  3280         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3281             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3282             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3283             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3284             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3285                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3286                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3287             20  CF-CO-PREM-REJECT-SW       PIC X.
  3288                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3289                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3290             20  CF-CO-REF-REJECT-SW        PIC X.
  3291                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3292                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3293
  3294         16  CF-CO-REPORTING-DT             PIC XX.
  3295         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3296         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3297           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3298           88  CF-CO-MONTH-END                  VALUE '1'.
  3299
  3300         16  CF-LGX-CLAIM-USER              PIC X.
  3301             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3302             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3303
  3304         16  CF-CREDIT-EDIT-CONTROLS.
  3305             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3306             20  CF-MIN-AGE                 PIC 99.
  3307             20  CF-DEFAULT-AGE             PIC 99.
  3308             20  CF-MIN-TERM                PIC S999      COMP-3.
  3309             20  CF-MAX-TERM                PIC S999      COMP-3.
  3310             20  CF-DEFAULT-SEX             PIC X.
  3311             20  CF-JOINT-AGE-INPUT         PIC X.
  3312                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3313             20  CF-BIRTH-DATE-INPUT        PIC X.
  3314                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3315             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3316                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3317                 88  CF-ZERO-CARRIER            VALUE '1'.
  3318                 88  CF-ZERO-GROUPING           VALUE '2'.
  3319                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  59
* NSRASBL.cbl
  3320             20  CF-EDIT-SW                 PIC X.
  3321                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3322             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3323             20  CF-CR-PR-METHOD            PIC X.
  3324               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3325               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3326             20  FILLER                     PIC X.
  3327
  3328         16  CF-CREDIT-MISC-CONTROLS.
  3329             20  CF-REIN-TABLE-SW           PIC X.
  3330                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3331             20  CF-COMP-TABLE-SW           PIC X.
  3332                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3333             20  CF-EXPERIENCE-RETENTION-AGE
  3334                                            PIC S9        COMP-3.
  3335             20  CF-CONVERSION-DT           PIC XX.
  3336             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3337             20  CF-RUN-FREQUENCY-SW        PIC X.
  3338                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3339                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3340
  3341             20  CF-CR-CHECK-NO-CONTROL.
  3342                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3343                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3344                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3345                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3346                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3347                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3348
  3349                 24  CF-CR-CHECK-COUNT       REDEFINES
  3350                     CF-CR-CHECK-COUNTER      PIC X(4).
  3351
  3352                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3353                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3354
  3355                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3356                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3357                 24  CF-MAIL-PROCESSING       PIC X.
  3358                     88  MAIL-PROCESSING          VALUE 'Y'.
  3359
  3360         16  CF-MISC-SYSTEM-CONTROL.
  3361             20  CF-SYSTEM-C                 PIC X.
  3362                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3363             20  CF-SYSTEM-D                 PIC X.
  3364                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3365             20  CF-SOC-SEC-NO-SW            PIC X.
  3366                 88  SOC-SEC-NO-USED             VALUE '1'.
  3367             20  CF-MEMBER-NO-SW             PIC X.
  3368                 88  MEMBER-NO-USED              VALUE '1'.
  3369             20  CF-TAX-ID-NUMBER            PIC X(11).
  3370             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3371             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3372                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3373                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3374                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3375                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3376             20  CF-SYSTEM-E                 PIC X.
  3377                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  60
* NSRASBL.cbl
  3378
  3379         16  CF-LGX-LIFE-USER               PIC X.
  3380             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3381             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3382
  3383         16  CF-CR-MONTH-END-DT             PIC XX.
  3384
  3385         16  CF-FILE-MAINT-DATES.
  3386             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3387                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3388             20  CF-LAST-BATCH       REDEFINES
  3389                 CF-LAST-BATCH-NO               PIC X(4).
  3390             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3391             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3392             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3393             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3394             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3395             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3396             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3397             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3398             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3399             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3400
  3401         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3402         16  FILLER                         PIC X.
  3403
  3404         16  CF-ALT-MORT-CODE               PIC X(4).
  3405         16  CF-MEMBER-CAPTION              PIC X(10).
  3406
  3407         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3408             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3409             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3410             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3411             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3412             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3413
  3414         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3415
  3416         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3417         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3418         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3419         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3420
  3421         16  CF-AH-OVERRIDE-L1              PIC X.
  3422         16  CF-AH-OVERRIDE-L2              PIC XX.
  3423         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3424         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3425
  3426         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3427         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3428
  3429         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3430         16  CF-AR-LAST-EL860-DT            PIC XX.
  3431         16  CF-MP-MONTH-END-DT             PIC XX.
  3432
  3433         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3434         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3435             88  CF-CLAIM-PAID-TO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  61
* NSRASBL.cbl
  3436
  3437         16  CF-AR-MONTH-END-DT             PIC XX.
  3438
  3439         16  CF-CRDTCRD-USER                PIC X.
  3440             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3441             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3442
  3443         16  CF-CC-MONTH-END-DT             PIC XX.
  3444
  3445         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3446
  3447         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3448             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3449             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3450             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3451         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3452         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3453         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3454         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3455             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3456             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3457         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3458         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3459         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3460             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3461         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3462
  3463         16  CF-CL-ZIP-CODE.
  3464             20  CF-CL-ZIP-PRIME.
  3465                 24  CF-CL-ZIP-1ST          PIC X.
  3466                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3467                 24  FILLER                 PIC X(4).
  3468             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3469         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3470             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3471             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3472             20  FILLER                     PIC XXX.
  3473
  3474         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3475         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3476         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3477         16  CF-CO-OPTION-START-DATE        PIC XX.
  3478         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3479           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3480                                                      '3' '4'.
  3481           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3482           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3483           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3484           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3485           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3486           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3487
  3488         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3489
  3490         16  CF-PAYMENT-APPROVAL-LEVELS.
  3491             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3492             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3493             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  62
* NSRASBL.cbl
  3494             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3495             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3496             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3497
  3498         16  CF-END-USER-REPORTING-USER     PIC X.
  3499             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3500             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3501
  3502         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3503             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3504             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3505
  3506         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3507
  3508         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3509         16  FILLER                         PIC X.
  3510
  3511         16  CF-CREDIT-ARCHIVE-CNTL.
  3512             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3513             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3514             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3515
  3516         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3517
  3518         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3519             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3520             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3521
  3522         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3523             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3524             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3525
  3526         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3527
  3528         16  CF-CO-ACH-ID-CODE              PIC  X.
  3529             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3530             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3531             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3532         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3533         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3534         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3535         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3536         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3537         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3538         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3539         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3540         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3541                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3542         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3543                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3544
  3545         16  CF-CO-OVER-SHORT.
  3546             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3547             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3548
  3549*         16  FILLER                         PIC X(102).
  3550         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3551             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  63
* NSRASBL.cbl
  3552             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3553
  3554         16  CF-AH-APPROVAL-DAYS.
  3555             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3556             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3557             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3558             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3559
  3560         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3561
  3562         16  CF-APPROV-LEV-5.
  3563             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3564             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3565             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3566
  3567         16  FILLER                         PIC X(68).
  3568****************************************************************
  3569*             PROCESSOR/USER RECORD                            *
  3570****************************************************************
  3571
  3572     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3573         16  CF-PROCESSOR-NAME              PIC X(30).
  3574         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3575         16  CF-PROCESSOR-TITLE             PIC X(26).
  3576         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3577                 88  MESSAGE-YES                VALUE 'Y'.
  3578                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3579
  3580*****************************************************
  3581****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3582****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3583****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3584****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3585*****************************************************
  3586
  3587         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3588             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3589             20  CF-APPLICATION-FORCE       PIC X.
  3590             20  CF-INDIVIDUAL-APP.
  3591                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3592                     28  CF-BROWSE-APP      PIC X.
  3593                     28  CF-UPDATE-APP      PIC X.
  3594
  3595         16  CF-CURRENT-TERM-ON             PIC X(4).
  3596         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3597             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3598             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3599             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3600             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3601             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3602             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3603             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3604         16  CF-PROCESSOR-CARRIER           PIC X.
  3605             88  NO-CARRIER-SECURITY            VALUE ' '.
  3606         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3607             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3608         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3609             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  64
* NSRASBL.cbl
  3610         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3611             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3612
  3613         16  CF-PROC-SYS-ACCESS-SW.
  3614             20  CF-PROC-CREDIT-CLAIMS-SW.
  3615                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3616                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3617                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3618                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3619             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3620                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3621                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3622             20  CF-PROC-LIFE-GNRLDGR-SW.
  3623                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3624                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3625                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3626                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3627             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3628                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3629                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3630         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3631             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3632             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3633         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3634
  3635         16  CF-APPROVAL-LEVEL                  PIC X.
  3636             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3637             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3638             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3639             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3640             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3641
  3642         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3643
  3644         16  CF-LANGUAGE-TYPE                   PIC X.
  3645             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3646             88  CF-LANG-IS-FR                      VALUE 'F'.
  3647
  3648         16  CF-CSR-IND                         PIC X.
  3649         16  FILLER                             PIC X(239).
  3650
  3651****************************************************************
  3652*             PROCESSOR/REMINDERS RECORD                       *
  3653****************************************************************
  3654
  3655     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3656         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3657             20  CF-START-REMIND-DT         PIC XX.
  3658             20  CF-END-REMIND-DT           PIC XX.
  3659             20  CF-REMINDER-TEXT           PIC X(50).
  3660         16  FILLER                         PIC X(296).
  3661
  3662
  3663****************************************************************
  3664*             STATE MASTER RECORD                              *
  3665****************************************************************
  3666
  3667     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  65
* NSRASBL.cbl
  3668         16  CF-STATE-ABBREVIATION          PIC XX.
  3669         16  CF-STATE-NAME                  PIC X(25).
  3670         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3671         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3672             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3673             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3674             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3675             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3676                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3677                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3678             20  CF-ST-PREM-REJECT-SW       PIC X.
  3679                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3680                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3681             20  CF-ST-REF-REJECT-SW        PIC X.
  3682                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3683                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3684         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3685         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3686         16  CF-ST-REFUND-RULES.
  3687             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3688             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3689             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3690         16  CF-ST-FST-PMT-EXTENSION.
  3691             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3692             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3693                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3694                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3695                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3696                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3697         16  CF-ST-STATE-CALL.
  3698             20  CF-ST-CALL-UNEARNED        PIC X.
  3699             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3700             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3701         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3702             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3703             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3704         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3705         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3706         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3707         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3708         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3709         16  FILLER                         PIC X.
  3710         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3711             20  CF-ST-BENEFIT-CD           PIC XX.
  3712             20  CF-ST-BENEFIT-KIND         PIC X.
  3713                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3714                 88  CF-ST-AH-KIND              VALUE 'A'.
  3715             20  CF-ST-REM-TERM-CALC        PIC X.
  3716                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3717                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3718                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3719                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3720                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3721                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3722                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3723                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3724
  3725             20  CF-ST-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  66
* NSRASBL.cbl
  3726                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3727                 88  ST-REFD-BY-R78             VALUE '1'.
  3728                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3729                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3730                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3731                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3732                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3733                 88  ST-REFD-UTAH               VALUE '7'.
  3734                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3735                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3736                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3737
  3738             20  CF-ST-EARNING-CALC         PIC X.
  3739                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3740                 88  ST-EARN-BY-R78             VALUE '1'.
  3741                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3742                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3743                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3744                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3745                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3746                 88  ST-EARN-MEAN               VALUE '8'.
  3747                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3748
  3749             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3750                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3751                 88  ST-OVRD-BY-R78             VALUE '1'.
  3752                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3753                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3754                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3755                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3756                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3757                 88  ST-OVRD-MEAN               VALUE '8'.
  3758                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3759             20  cf-st-extra-periods        pic 9.
  3760*            20  FILLER                     PIC X.
  3761
  3762         16  CF-ST-COMMISSION-CAPS.
  3763             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3764             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3765             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3766             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3767         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3768                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3769                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3770                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3771
  3772         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3773
  3774         16  CF-ST-STATUTORY-INTEREST.
  3775             20  CF-ST-STAT-DATE-FROM       PIC X.
  3776                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3777                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3778             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3779             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3780             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3781             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3782             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3783
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  67
* NSRASBL.cbl
  3784         16  CF-ST-OVER-SHORT.
  3785             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3786             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3787
  3788         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3789
  3790         16  CF-ST-RT-CALC                  PIC X.
  3791
  3792         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3793         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3794         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3795         16  CF-ST-RF-LR-CALC               PIC X.
  3796         16  CF-ST-RF-LL-CALC               PIC X.
  3797         16  CF-ST-RF-LN-CALC               PIC X.
  3798         16  CF-ST-RF-AH-CALC               PIC X.
  3799         16  CF-ST-RF-CP-CALC               PIC X.
  3800*        16  FILLER                         PIC X(206).
  3801*CIDMOD         16  FILLER                         PIC X(192).
  3802         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3803             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3804         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3805         16  CF-ST-VFY-2ND-BENE             PIC X.
  3806         16  CF-ST-CAUSAL-STATE             PIC X.
  3807         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3808         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3809         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3810             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3811         16  CF-ST-NET-ONLY-STATE           PIC X.
  3812             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3813         16  cf-commission-cap-required     pic x.
  3814         16  CF-ST-GA-COMMISSION-CAPS.
  3815             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3816             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3817             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3818             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3819         16  CF-ST-TOT-COMMISSION-CAPS.
  3820             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3821             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3822             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3823             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3824         16  FILLER                         PIC X(156).
  3825
  3826****************************************************************
  3827*             BENEFIT MASTER RECORD                            *
  3828****************************************************************
  3829
  3830     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3831         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3832             20  CF-BENEFIT-CODE            PIC XX.
  3833             20  CF-BENEFIT-NUMERIC  REDEFINES
  3834                 CF-BENEFIT-CODE            PIC XX.
  3835             20  CF-BENEFIT-ALPHA           PIC XXX.
  3836             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3837             20  CF-BENEFIT-COMMENT         PIC X(10).
  3838
  3839             20  CF-LF-COVERAGE-TYPE        PIC X.
  3840                 88  CF-REDUCING                VALUE 'R'.
  3841                 88  CF-LEVEL                   VALUE 'L' 'P'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  68
* NSRASBL.cbl
  3842
  3843             20  CF-SPECIAL-CALC-CD         PIC X.
  3844                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3845                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3846                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3847                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3848                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3849                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3850                 88  CF-FARM-PLAN               VALUE 'F'.
  3851                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3852                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3853                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3854                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3855                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3856                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3857                 88  CF-PRUDENTIAL              VALUE 'P'.
  3858                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3859                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3860                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3861                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3862                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3863                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3864
  3865             20  CF-JOINT-INDICATOR         PIC X.
  3866                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3867
  3868*            20  FILLER                     PIC X(12).
  3869             20  cf-maximum-benefits        pic s999 comp-3.
  3870             20  FILLER                     PIC X(09).
  3871             20  CF-BENEFIT-CATEGORY        PIC X.
  3872             20  CF-LOAN-TYPE               PIC X(8).
  3873
  3874             20  CF-CO-REM-TERM-CALC        PIC X.
  3875                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3876                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3877                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3878                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3879                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3880
  3881             20  CF-CO-EARNINGS-CALC        PIC X.
  3882                 88  CO-EARN-BY-R78             VALUE '1'.
  3883                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3884                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3885                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3886                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3887                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3888                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3889                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3890
  3891             20  CF-CO-REFUND-CALC          PIC X.
  3892                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3893                 88  CO-REFD-BY-R78             VALUE '1'.
  3894                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3895                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3896                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3897                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3898                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3899                 88  CO-REFD-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  69
* NSRASBL.cbl
  3900                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3901                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3902                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3903
  3904             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3905                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3906                 88  CO-OVRD-BY-R78             VALUE '1'.
  3907                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3908                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3909                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3910                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3911                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3912                 88  CO-OVRD-MEAN               VALUE '8'.
  3913                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3914
  3915             20  CF-CO-BEN-I-G-CD           PIC X.
  3916                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3917                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3918                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3919
  3920         16  FILLER                         PIC X(304).
  3921
  3922
  3923****************************************************************
  3924*             CARRIER MASTER RECORD                            *
  3925****************************************************************
  3926
  3927     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3928         16  CF-ADDRESS-DATA.
  3929             20  CF-MAIL-TO-NAME            PIC X(30).
  3930             20  CF-IN-CARE-OF              PIC X(30).
  3931             20  CF-ADDRESS-LINE-1          PIC X(30).
  3932             20  CF-ADDRESS-LINE-2          PIC X(30).
  3933             20  CF-CITY-STATE              PIC X(30).
  3934             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3935             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3936
  3937         16  CF-CLAIM-NO-CONTROL.
  3938             20  CF-CLAIM-NO-METHOD         PIC X.
  3939                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3940                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3941                 88  CLAIM-NO-SEQ               VALUE '3'.
  3942                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3943             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3944                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3945                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3946                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3947
  3948         16  CF-CHECK-NO-CONTROL.
  3949             20  CF-CHECK-NO-METHOD         PIC X.
  3950                 88  CHECK-NO-MANUAL            VALUE '1'.
  3951                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3952                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3953                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3954             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3955                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3956
  3957         16  CF-DOMICILE-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  70
* NSRASBL.cbl
  3958
  3959         16  CF-EXPENSE-CONTROLS.
  3960             20  CF-EXPENSE-METHOD          PIC X.
  3961                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3962                 88  DOLLARS-PER-PMT            VALUE '2'.
  3963                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3964                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3965             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3966             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3967
  3968         16  CF-CORRESPONDENCE-CONTROL.
  3969             20  CF-LETTER-RESEND-OPT       PIC X.
  3970                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3971                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3972             20  FILLER                     PIC X(4).
  3973
  3974         16  CF-RESERVE-CONTROLS.
  3975             20  CF-MANUAL-SW               PIC X.
  3976                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3977             20  CF-FUTURE-SW               PIC X.
  3978                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3979             20  CF-PTC-SW                  PIC X.
  3980                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3981             20  CF-IBNR-SW                 PIC X.
  3982                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3983             20  CF-PTC-LF-SW               PIC X.
  3984                 88  CF-LF-PTC-USED             VALUE '1'.
  3985             20  CF-CDT-ACCESS-METHOD       PIC X.
  3986                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3987                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3988                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3989             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3990
  3991         16  CF-CLAIM-CALC-METHOD           PIC X.
  3992             88  360-PLUS-MONTHS                VALUE '1'.
  3993             88  365-PLUS-MONTHS                VALUE '2'.
  3994             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3995             88  360-DAILY                      VALUE '4'.
  3996             88  365-DAILY                      VALUE '5'.
  3997
  3998         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3999         16  FILLER                         PIC X(11).
  4000
  4001         16  CF-LIMIT-AMOUNTS.
  4002             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4003             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4004             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4005             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4006             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4007             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4008             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4009             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4010             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4011             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4012
  4013         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4014         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4015         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  71
* NSRASBL.cbl
  4016
  4017         16  CF-ZIP-CODE.
  4018             20  CF-ZIP-PRIME.
  4019                 24  CF-ZIP-1ST             PIC X.
  4020                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4021                 24  FILLER                 PIC X(4).
  4022             20  CF-ZIP-PLUS4               PIC X(4).
  4023         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4024             20  CF-CAN-POSTAL-1            PIC XXX.
  4025             20  CF-CAN-POSTAL-2            PIC XXX.
  4026             20  FILLER                     PIC XXX.
  4027
  4028         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4029         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4030         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4031
  4032         16  CF-RATING-SWITCH               PIC X.
  4033             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4034             88  CF-NO-RATING                   VALUE 'N'.
  4035
  4036         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4037
  4038         16  CF-CARRIER-OVER-SHORT.
  4039             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4040             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4041
  4042         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4043         16  CF-SECPAY-SWITCH               PIC X.
  4044             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4045             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4046         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4047         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4048         16  FILLER                         PIC X(444).
  4049*        16  FILLER                         PIC X(452).
  4050
  4051
  4052****************************************************************
  4053*             MORTALITY MASTER RECORD                          *
  4054****************************************************************
  4055
  4056     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4057         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4058                                INDEXED BY CF-MORT-NDX.
  4059             20  CF-MORT-TABLE              PIC X(5).
  4060             20  CF-MORT-TABLE-TYPE         PIC X.
  4061                 88  CF-MORT-JOINT              VALUE 'J'.
  4062                 88  CF-MORT-SINGLE             VALUE 'S'.
  4063                 88  CF-MORT-COMBINED           VALUE 'C'.
  4064                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4065                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4066             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4067             20  CF-MORT-AGE-METHOD         PIC XX.
  4068                 88  CF-AGE-LAST                VALUE 'AL'.
  4069                 88  CF-AGE-NEAR                VALUE 'AN'.
  4070             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4071             20  CF-MORT-ADJUSTMENT-DIRECTION
  4072                                            PIC X.
  4073                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  72
* NSRASBL.cbl
  4074                 88  CF-PLUS                    VALUE '+'.
  4075             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4076             20  CF-MORT-JOINT-CODE         PIC X.
  4077                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4078             20  CF-MORT-PC-Q               PIC X.
  4079                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4080             20  CF-MORT-TABLE-CODE         PIC X(4).
  4081             20  CF-MORT-COMMENTS           PIC X(15).
  4082             20  FILLER                     PIC X(14).
  4083
  4084         16  FILLER                         PIC X(251).
  4085
  4086
  4087****************************************************************
  4088*             BUSSINESS TYPE MASTER RECORD                     *
  4089****************************************************************
  4090
  4091     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4092* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4093* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4094* AND RECORD 05 IS TYPES 81-99
  4095         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4096             20  CF-BUSINESS-TITLE          PIC  X(19).
  4097             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4098                                            PIC S9V9(4) COMP-3.
  4099             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4100             20  FILLER                     PIC  X.
  4101         16  FILLER                         PIC  X(248).
  4102
  4103
  4104****************************************************************
  4105*             TERMINAL MASTER RECORD                           *
  4106****************************************************************
  4107
  4108     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4109
  4110         16  CF-COMPANY-TERMINALS.
  4111             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4112                                  PIC X(4).
  4113         16  FILLER               PIC X(248).
  4114
  4115
  4116****************************************************************
  4117*             LIFE EDIT MASTER RECORD                          *
  4118****************************************************************
  4119
  4120     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4121         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4122             20  CF-LIFE-CODE-IN            PIC XX.
  4123             20  CF-LIFE-CODE-OUT           PIC XX.
  4124         16  FILLER                         PIC X(248).
  4125
  4126
  4127****************************************************************
  4128*             AH EDIT MASTER RECORD                            *
  4129****************************************************************
  4130
  4131     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  73
* NSRASBL.cbl
  4132         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4133             20  CF-AH-CODE-IN              PIC XXX.
  4134             20  CF-AH-CODE-OUT             PIC XX.
  4135         16  FILLER                         PIC X(248).
  4136
  4137
  4138****************************************************************
  4139*             CREDIBILITY TABLES                               *
  4140****************************************************************
  4141
  4142     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4143         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4144                             INDEXED BY CF-CRDB-NDX.
  4145             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4146             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4147             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4148         16  FILLER                         PIC  X(332).
  4149
  4150
  4151****************************************************************
  4152*             REPORT CUSTOMIZATION RECORD                      *
  4153****************************************************************
  4154
  4155     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4156         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4157             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4158             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4159             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4160**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4161****       A T-TRANSFER.                                   ****
  4162             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4163
  4164         16  FILLER                         PIC XX.
  4165
  4166         16  CF-CARRIER-CNTL-OPT.
  4167             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4168                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4169                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4170             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4171                                            PIC X.
  4172         16  CF-GROUP-CNTL-OPT.
  4173             20  CF-GROUP-OPT-SEQ           PIC 9.
  4174                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4175                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4176             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4177                                            PIC X(6).
  4178         16  CF-STATE-CNTL-OPT.
  4179             20  CF-STATE-OPT-SEQ           PIC 9.
  4180                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4181                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4182             20  CF-STATE-SELECT OCCURS 3 TIMES
  4183                                            PIC XX.
  4184         16  CF-ACCOUNT-CNTL-OPT.
  4185             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4186                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4187                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4188             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4189                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  74
* NSRASBL.cbl
  4190         16  CF-BUS-TYP-CNTL-OPT.
  4191             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4192                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4193                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4194             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4195                                            PIC XX.
  4196         16  CF-LF-TYP-CNTL-OPT.
  4197             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4198                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4199                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4200             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4201                                            PIC XX.
  4202         16  CF-AH-TYP-CNTL-OPT.
  4203             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4204                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4205                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4206             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4207                                            PIC XX.
  4208         16  CF-REPTCD1-CNTL-OPT.
  4209             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4210                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4211                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4212             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4213                                            PIC X(10).
  4214         16  CF-REPTCD2-CNTL-OPT.
  4215             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4216                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4217                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4218             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4219                                            PIC X(10).
  4220         16  CF-USER1-CNTL-OPT.
  4221             20  CF-USER1-OPT-SEQ           PIC 9.
  4222                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4223                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4224             20  CF-USER1-SELECT OCCURS 3 TIMES
  4225                                            PIC X(10).
  4226         16  CF-USER2-CNTL-OPT.
  4227             20  CF-USER2-OPT-SEQ           PIC 9.
  4228                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4229                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4230             20  CF-USER2-SELECT OCCURS 3 TIMES
  4231                                            PIC X(10).
  4232         16  CF-USER3-CNTL-OPT.
  4233             20  CF-USER3-OPT-SEQ           PIC 9.
  4234                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4235                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4236             20  CF-USER3-SELECT OCCURS 3 TIMES
  4237                                            PIC X(10).
  4238         16  CF-USER4-CNTL-OPT.
  4239             20  CF-USER4-OPT-SEQ           PIC 9.
  4240                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4241                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4242             20  CF-USER4-SELECT OCCURS 3 TIMES
  4243                                            PIC X(10).
  4244         16  CF-USER5-CNTL-OPT.
  4245             20  CF-USER5-OPT-SEQ           PIC 9.
  4246                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4247                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  75
* NSRASBL.cbl
  4248             20  CF-USER5-SELECT OCCURS 3 TIMES
  4249                                            PIC X(10).
  4250         16  CF-REINS-CNTL-OPT.
  4251             20  CF-REINS-OPT-SEQ           PIC 9.
  4252                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4253                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4254             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4255                 24  CF-REINS-PRIME         PIC XXX.
  4256                 24  CF-REINS-SUB           PIC XXX.
  4257
  4258         16  CF-AGENT-CNTL-OPT.
  4259             20  CF-AGENT-OPT-SEQ           PIC 9.
  4260                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4261                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4262             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4263                                            PIC X(10).
  4264
  4265         16  FILLER                         PIC X(43).
  4266
  4267         16  CF-LOSS-RATIO-SELECT.
  4268             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4269             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4270         16  CF-ENTRY-DATE-SELECT.
  4271             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4272             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4273         16  CF-EFFECTIVE-DATE-SELECT.
  4274             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4275             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4276
  4277         16  CF-EXCEPTION-LIST-IND          PIC X.
  4278             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4279
  4280         16  FILLER                         PIC X(318).
  4281
  4282****************************************************************
  4283*                  EXCEPTION REPORTING RECORD                  *
  4284****************************************************************
  4285
  4286     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4287         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4288             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4289
  4290         16  CF-COMBINED-LIFE-AH-OPT.
  4291             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4292             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4293             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4294             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4295
  4296         16  CF-LIFE-OPT.
  4297             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4298             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4299             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4300             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4301             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4302             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4303             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4304             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4305             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  76
* NSRASBL.cbl
  4306             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4307
  4308         16  CF-AH-OPT.
  4309             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4310             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4311             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4312             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4313             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4314             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4315             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4316             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4317             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4318             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4319
  4320         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4321             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4322             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4323             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4324
  4325         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4326
  4327         16  FILLER                         PIC X(673).
  4328
  4329
  4330****************************************************************
  4331*             MORTGAGE SYSTEM PLAN RECORD                      *
  4332****************************************************************
  4333
  4334     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4335         16  CF-PLAN-TYPE                   PIC X.
  4336             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4337             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4338             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4339         16  CF-PLAN-ABBREV                 PIC XXX.
  4340         16  CF-PLAN-DESCRIPT               PIC X(10).
  4341         16  CF-PLAN-NOTES                  PIC X(20).
  4342         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4343         16  CF-PLAN-UNDERWRITING.
  4344             20  CF-PLAN-TERM-DATA.
  4345                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4346                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4347             20  CF-PLAN-AGE-DATA.
  4348                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4349                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4350                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4351             20  CF-PLAN-BENEFIT-DATA.
  4352                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4353                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4354                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4355                                            PIC S9(7)V99  COMP-3.
  4356         16  CF-PLAN-POLICY-FORMS.
  4357             20  CF-POLICY-FORM             PIC X(12).
  4358             20  CF-MASTER-APPLICATION      PIC X(12).
  4359             20  CF-MASTER-POLICY           PIC X(12).
  4360         16  CF-PLAN-RATING.
  4361             20  CF-RATE-CODE               PIC X(5).
  4362             20  CF-SEX-RATING              PIC X.
  4363                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  77
* NSRASBL.cbl
  4364                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4365             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4366             20  CF-SUB-STD-TYPE            PIC X.
  4367                 88  CF-PCT-OF-PREM            VALUE '1'.
  4368                 88  CF-PCT-OF-BENE            VALUE '2'.
  4369         16  CF-PLAN-PREM-TOLERANCES.
  4370             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4371             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4372         16  CF-PLAN-PYMT-TOLERANCES.
  4373             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4374             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4375         16  CF-PLAN-MISC-DATA.
  4376             20  FILLER                     PIC X.
  4377             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4378             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4379         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4380         16  CF-PLAN-IND-GRP                PIC X.
  4381             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4382                                                     '1'.
  4383             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4384                                                     '2'.
  4385         16  CF-MIB-SEARCH-SW               PIC X.
  4386             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4387             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4388             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4389             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4390         16  CF-ALPHA-SEARCH-SW             PIC X.
  4391             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4392             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4393             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4394             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4395             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4396             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4397             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4398             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4399             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4400             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4401                                                     'A' 'B' 'C'
  4402                                                     'X' 'Y' 'Z'.
  4403         16  CF-EFF-DT-RULE-SW              PIC X.
  4404             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4405             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4406             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4407             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4408             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4409         16  FILLER                         PIC X(4).
  4410         16  CF-HEALTH-QUESTIONS            PIC X.
  4411             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4412         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4413         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4414         16  CF-PLAN-SNGL-JNT               PIC X.
  4415             88  CF-COMBINED-PLAN              VALUE 'C'.
  4416             88  CF-JNT-PLAN                   VALUE 'J'.
  4417             88  CF-SNGL-PLAN                  VALUE 'S'.
  4418         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4419         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4420         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4421         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  78
* NSRASBL.cbl
  4422         16  CF-RERATE-CNTL                 PIC  X.
  4423             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4424             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4425             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4426             88  CF-AUTO-RECALC                 VALUE '4'.
  4427         16  CF-BENEFIT-TYPE                PIC  X.
  4428             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4429             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4430         16  CF-POLICY-FEE                  PIC S999V99
  4431                                                    COMP-3.
  4432         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4433         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4434         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4435         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4436         16  FILLER                         PIC  X(32).
  4437         16  CF-TERMINATION-FORM            PIC  X(04).
  4438         16  FILLER                         PIC  X(08).
  4439         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4440                                                       COMP-3.
  4441         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4442         16  CF-ISSUE-LETTER                PIC  X(4).
  4443         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4444         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4445             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4446             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4447         16  CF-MP-REFUND-CALC              PIC X.
  4448             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4449             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4450             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4451             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4452             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4453             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4454             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4455             88  CF-MP-REFD-MEAN                VALUE '8'.
  4456         16  CF-ALT-RATE-CODE               PIC  X(5).
  4457
  4458
  4459         16  FILLER                         PIC X(498).
  4460****************************************************************
  4461*             MORTGAGE COMPANY MASTER RECORD                   *
  4462****************************************************************
  4463
  4464     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4465         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4466         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4467             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4468             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4469             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4470             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4471             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4472
  4473         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4474         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4475         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4476         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4477         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4478
  4479         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  79
* NSRASBL.cbl
  4480             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4481         16  CF-MP-RECON-USE-IND            PIC X(1).
  4482             88  CF-MP-USE-RECON             VALUE 'Y'.
  4483         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4484             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4485         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4486             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4487             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4488         16  FILLER                         PIC X(1).
  4489         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4490             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4491         16  CF-MORTG-MIB-VERSION           PIC X.
  4492             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4493             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4494             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4495         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4496             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4497                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4498             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4499                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4500             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4501                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4502             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4503                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4504             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4505                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4506             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4507                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4508         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4509         16  FILLER                         PIC X(7).
  4510         16  CF-MORTG-DESTINATION-SYMBOL.
  4511             20  CF-MORTG-MIB-COMM          PIC X(5).
  4512             20  CF-MORTG-MIB-TERM          PIC X(5).
  4513         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4514             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4515         16  FILLER                         PIC X(03).
  4516         16  CF-MP-CHECK-NO-CONTROL.
  4517             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4518                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4519                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4520                                                ' ' LOW-VALUES.
  4521                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4522                                               VALUE '3'.
  4523         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4524         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4525         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4526             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4527                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4528             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4529                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4530             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4531                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4532             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4533                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4534             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4535                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4536             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4537                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  80
* NSRASBL.cbl
  4538         16  CF-MORTG-BILLING-AREA.
  4539             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4540                                            PIC X.
  4541         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4542         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4543         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4544         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4545             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4546             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4547         16  FILLER                         PIC X.
  4548         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4549             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4550             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4551         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4552         16  FILLER                         PIC X(8).
  4553         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4554         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4555         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4556         16  CF-ACH-COMPANY-ID.
  4557             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4558                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4559                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4560                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4561             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4562         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4563             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4564         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4565             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4566             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4567         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4568         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4569         16  FILLER                         PIC X(536).
  4570
  4571****************************************************************
  4572*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4573****************************************************************
  4574
  4575     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4576         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4577             20  CF-FEMALE-HEIGHT.
  4578                 24  CF-FEMALE-FT           PIC 99.
  4579                 24  CF-FEMALE-IN           PIC 99.
  4580             20  CF-FEMALE-MIN-WT           PIC 999.
  4581             20  CF-FEMALE-MAX-WT           PIC 999.
  4582         16  FILLER                         PIC X(428).
  4583
  4584     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4585         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4586             20  CF-MALE-HEIGHT.
  4587                 24  CF-MALE-FT             PIC 99.
  4588                 24  CF-MALE-IN             PIC 99.
  4589             20  CF-MALE-MIN-WT             PIC 999.
  4590             20  CF-MALE-MAX-WT             PIC 999.
  4591         16  FILLER                         PIC X(428).
  4592******************************************************************
  4593*             AUTOMATIC ACTIVITY RECORD                          *
  4594******************************************************************
  4595     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  81
* NSRASBL.cbl
  4596         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4597             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4598             20  CF-SYS-LETTER-ID           PIC X(04).
  4599             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4600             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4601             20  CF-SYS-RESET-SW            PIC X(01).
  4602             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4603             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4604
  4605         16  FILLER                         PIC X(50).
  4606
  4607         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4608             20  CF-USER-ACTIVE-SW          PIC X(01).
  4609             20  CF-USER-LETTER-ID          PIC X(04).
  4610             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4611             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4612             20  CF-USER-RESET-SW           PIC X(01).
  4613             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4614             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4615             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4616
  4617         16  FILLER                         PIC X(246).
  4618*                                COPY NSCASVARS.
  4619******************************************************************
  4620*                   C H A N G E   L O G
  4621*
  4622*        CURRENT SIZE - 6180
  4623*
  4624* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4625*-----------------------------------------------------------------
  4626*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4627* EFFECTIVE    NUMBER
  4628*-----------------------------------------------------------------
  4629* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4630* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4631* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4632* 121015  CR2015100900001  TANA  ADD VIN NUMBER
  4633******************************************************************
  4634 01 NAPER-OUTPUT-DATA.
  4635    05  F                       PIC X(07) VALUE "LETTER=".
  4636    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4637    05  F                       PIC X(08) VALUE "~PROCID=".
  4638    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4639    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4640    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4641    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4642    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4643    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4644    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4645    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4646    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4647    05  F                       PIC X(06) VALUE "~CARR=".
  4648    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4649    05  F                       PIC X(10) VALUE "~GROUPING=".
  4650    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4651    05  F                       PIC X(08) VALUE "~CERTST=".
  4652    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4653    05  F                       PIC X(09) VALUE "~ACCOUNT=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  82
* NSRASBL.cbl
  4654    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4655    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4656    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4657    05  F                       PIC X(07) VALUE "~CRTNO=".
  4658    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4659    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4660    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4661    05  F                       PIC X(08) VALUE "~ILNAME=".
  4662    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4663    05  F                       PIC X(08) VALUE "~IFNAME=".
  4664    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4665    05  F                       PIC X(08) VALUE "~IFINIT=".
  4666    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4667    05  F                       PIC X(08) VALUE "~IMINIT=".
  4668    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4669    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4670    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4671    05  F                       PIC X(06) VALUE "~ISEX=".
  4672    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4673    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4674    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4675    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4676    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4677    05  F                       PIC X(09) VALUE "~INSCITY=".
  4678    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4679    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4680    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4681    05  F                       PIC X(08) VALUE "~INSZIP=".
  4682    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4683    05  F                       PIC X(05) VALUE "~SSN=".
  4684    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4685    05  F                       PIC X(07) VALUE "~MEMNO=".
  4686    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4687    05  F                       PIC X(08) VALUE "~JLNAME=".
  4688    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4689    05  F                       PIC X(08) VALUE "~JFNAME=".
  4690    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4691    05  F                       PIC X(08) VALUE "~JMINIT=".
  4692    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4693    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4694    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4695    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4696    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4697    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4698    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4699    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4700    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4701    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4702    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4703    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4704    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4705    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4706    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4707    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4708    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4709    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4710    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4711    05  F                       PIC X(09) VALUE "~BUSTYPE=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  83
* NSRASBL.cbl
  4712    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4713    05  F                       PIC X(10) VALUE "~BENENAME=".
  4714    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4715    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4716    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4717    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4718    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4719    05  F                       PIC X(10) VALUE "~BENECITY=".
  4720    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4721    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4722    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4723    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4724    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4725    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4726    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4727    05  F                       PIC X(08) VALUE "~RESPNO=".
  4728    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4729    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4730    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4731    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4732    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4733    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4734    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4735    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4736    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4737    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4738    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4739    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4740    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4741    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4742    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4743    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4744    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4745    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4746    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4747    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4748    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4749    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4750    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4751    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4752    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4753    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4754    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4755    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4756    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4757    05  F                       PIC X(07) VALUE "~BATCH=".
  4758    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4759    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4760    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4761    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4762    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4763    05  F                       PIC X(05) VALUE "~APR=".
  4764    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4765    05  F                       PIC X(08) VALUE "~LNTERM=".
  4766    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4767    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4768    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4769    05  F                       PIC X(09) VALUE "~EXTDAYS=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  84
* NSRASBL.cbl
  4770    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4771    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4772    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4773    05  F                       PIC X(07) VALUE "~UCODE=".
  4774    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4775    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4776    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4777    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4778    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4779    05  F                       PIC X(06) VALUE "~SKIP=".
  4780    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4781    05  F                       PIC X(06) VALUE "~MODE=".
  4782    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4783    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4784    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4785    05  F                       PIC X(06) VALUE "~RTBL=".
  4786    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4787    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4788    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4789    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4790    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4791    05  F                       PIC X(08) VALUE "~LFTERM=".
  4792    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4793    05  F                       PIC X(07) VALUE "~LFDEV=".
  4794    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4795    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4796    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4797    05  F                       PIC X(07) VALUE "~LFBEN=".
  4798    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4799    05  F                       PIC X(08) VALUE "~LFPREM=".
  4800    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4801    05  F                       PIC X(08) VALUE "~LFABEN=".
  4802    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4803    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4804    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4805    05  F                       PIC X(07) VALUE "~LFNSP=".
  4806    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4807    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4808    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4809    05  F                       PIC X(07) VALUE "~LFCAN=".
  4810    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4811    05  F                       PIC X(07) VALUE "~LFDTH=".
  4812    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4813    05  F                       PIC X(08) VALUE "~LFRATE=".
  4814    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4815    05  F                       PIC X(09) VALUE "~LFARATE=".
  4816    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4817    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4818    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4819    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4820    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4821    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4822    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4823    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4824    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4825    05  F                       PIC X(07) VALUE "~DTHDT=".
  4826    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4827    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  85
* NSRASBL.cbl
  4828    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4829    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4830    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4831    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4832    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4833    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4834    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4835    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4836    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4837    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4838    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4839    05  F                       PIC X(08) VALUE "~AHTERM=".
  4840    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4841    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4842    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4843    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4844    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4845    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4846    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4847    05  F                       PIC X(07) VALUE "~AHBEN=".
  4848    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4849    05  F                       PIC X(08) VALUE "~AHPREM=".
  4850    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4851    05  F                       PIC X(07) VALUE "~AHNSP=".
  4852    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4853    05  F                       PIC X(07) VALUE "~AHCAN=".
  4854    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4855    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4856    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4857    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4858    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4859    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4860    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4861    05  F                       PIC X(08) VALUE "~AHRATE=".
  4862    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4863    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4864    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4865    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4866    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4867    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4868    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4869    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4870    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4871    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4872    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4873    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4874    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4875    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4876    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4877    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4878    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4879    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4880    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4881    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4882    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4883    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4884    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4885    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  86
* NSRASBL.cbl
  4886                                PIC X(2).
  4887    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4888    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4889    05  F                       PIC X(08) VALUE "~TOTREF=".
  4890    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4891    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4892    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4893    05  F                       PIC X(07) VALUE "~STERM=".
  4894    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4895    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4896    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4897    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4898    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4899    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4900    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4901    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4902    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4903    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4904    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4905    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4906    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4907    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4908    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4909    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4910    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4911    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4912    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4913    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4914    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4915    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4916    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4917    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4918                                PIC X(12).
  4919    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4920    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4921    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4922                                PIC X(12).
  4923    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4924    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4925    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4926    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4927    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4928    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4929    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4930    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4931    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4932                                PIC X(12).
  4933    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4934    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4935    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4936                                PIC X(10).
  4937    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4938    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4939    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4940    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4941    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4942    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4943    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  87
* NSRASBL.cbl
  4944    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4945    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4946    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4947    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4948    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4949    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4950                                PIC X(10).
  4951    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4952    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4953    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4954                                PIC X(10).
  4955    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4956    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4957    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4958    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4959    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4960    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4961    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4962    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4963    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4964    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4965    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4966    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4967    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4968    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4969    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4970    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4971    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4972    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4973    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4974                                PIC X(2).
  4975    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4976    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4977    05  F                       PIC X(08) VALUE "~OSTERM=".
  4978    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4979    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4980    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4981    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4982    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4983    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4984    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4985    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4986    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4987    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4988                                PIC X(09).
  4989    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4990    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4991    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4992    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4993    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4994    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4995    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4996    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4997    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4998                                PIC X(09).
  4999    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  5000    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  5001    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  88
* NSRASBL.cbl
  5002    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  5003    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  5004                                PIC X(09).
  5005    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  5006    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  5007    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  5008                                PIC X(12).
  5009    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  5010    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  5011    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  5012                                PIC X(10).
  5013    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  5014    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  5015    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  5016    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  5017    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  5018                                PIC X(12).
  5019    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  5020    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  5021    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  5022                                PIC X(10).
  5023    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  5024    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  5025    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  5026    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  5027    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  5028    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  5029    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  5030    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  5031    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  5032                                PIC X(09).
  5033    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  5034    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  5035    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  5036                                PIC X(09).
  5037    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  5038    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  5039    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  5040                                PIC X(10).
  5041    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  5042    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  5043    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  5044                                PIC X(10).
  5045    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  5046    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  5047    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  5048    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  5049    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  5050    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  5051    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  5052    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  5053    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  5054    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  5055    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  5056    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  5057    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  5058    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  5059    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  89
* NSRASBL.cbl
  5060                                PIC X(09).
  5061    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  5062    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  5063    05  F                       PIC X(08) VALUE "~NSTERM=".
  5064    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  5065    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  5066                                PIC X(09).
  5067    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  5068    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  5069    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  5070    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  5071    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  5072    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  5073    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  5074    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  5075    05  F                       PIC X(09) VALUE "~BALLOON=".
  5076    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  5077    05  F                       PIC X(10) VALUE "~LEASEIND=".
  5078    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  5079    05  F                       PIC X(09) VALUE "~RESCIND=".
  5080    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  5081    05  F                       PIC X(07) VALUE "~RCD01=".
  5082    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  5083    05  F                       PIC X(07) VALUE "~RCD02=".
  5084    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  5085    05  F                       PIC X(07) VALUE "~RCD03=".
  5086    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  5087    05  F                       PIC X(07) VALUE "~RCD04=".
  5088    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  5089    05  F                       PIC X(07) VALUE "~RCD05=".
  5090    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  5091    05  F                       PIC X(07) VALUE "~RCD06=".
  5092    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  5093    05  F                       PIC X(07) VALUE "~RCD07=".
  5094    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  5095    05  F                       PIC X(07) VALUE "~RCD08=".
  5096    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  5097    05  F                       PIC X(07) VALUE "~RCD09=".
  5098    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  5099    05  F                       PIC X(07) VALUE "~RCD10=".
  5100    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  5101    05  F                       PIC X(07) VALUE "~RCD11=".
  5102    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  5103    05  F                       PIC X(07) VALUE "~RCD12=".
  5104    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  5105    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  5106    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  5107    05  F                       PIC X(08) VALUE "~ARCHNO=".
  5108    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  5109    05  F                       PIC X(06) VALUE "~FORM=".
  5110    05  OUT-FORM                PIC X(03) VALUE SPACES.
  5111    05  F                       PIC X(09) VALUE "~ENCLINE=".
  5112    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  5113    05  F                       PIC X(08) VALUE "~ATTACH=".
  5114    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  5115    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  5116    05  OUT-STACK               PIC X(10) VALUE SPACES.
  5117    05  F                       PIC X(11) VALUE "~STATENAME=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  90
* NSRASBL.cbl
  5118    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  5119    05  F                       PIC X(08) VALUE "~PRTNOW=".
  5120    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  5121    05  F                       PIC X(05) VALUE "~NCB=".
  5122    05  OUT-CHGBACK             PIC X     VALUE ' '.
  5123    05  F                       PIC X(8) VALUE "~CSOAMT=".
  5124    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  5125    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  5126    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  5127    05  F                       PIC X(09) VALUE "~LETRTYP=".
  5128    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  5129    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  5130    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  5131    05  F                       PIC X(08) VALUE "~INSBDT=".
  5132    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  5133    05  F                       PIC X(08) VALUE "~JNTBDT=".
  5134    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  5135    05  F                       PIC X(08) VALUE "~TOTINT=".
  5136    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  5137    05  F                       PIC X(8) VALUE "~TOPREM=".
  5138    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  5139    05  F                       PIC X(7) VALUE "~TOREF=".
  5140    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  5141    05  F                       PIC X(7) VALUE "~CANDT=".
  5142    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  5143    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  5144    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  5145    05  F                       PIC X(08) VALUE "~CERTID=".
  5146    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  5147    05  F                       PIC X(08) VALUE "~UNDWID=".
  5148    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  5149    05  F                       PIC X(8) VALUE "~TNPREM=".
  5150    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  5151    05  F                       PIC X(7) VALUE "~TNREF=".
  5152    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  5153    05  F                       PIC X(8)  VALUE "~COVIND=".
  5154    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  5155    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  5156    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  5157    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  5158    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  5159    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  5160    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  5161    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  5162    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  5163    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  5164    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  5165    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  5166                                PIC X(10).
  5167    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  5168    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5169    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  5170    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5171    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  5172    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5173    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  5174    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5175    05  F                       PIC X(10) VALUE "~LFREFCHG=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  91
* NSRASBL.cbl
  5176    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5177    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  5178    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5179    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  5180    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  5181    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  5182    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5183    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  5184    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5185    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  5186    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  5187    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  5188    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  5189    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  5190    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5191    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  5192    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5193    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  5194    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  5195    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  5196    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  5197    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  5198    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5199    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  5200    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5201    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  5202    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  5203    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  5204    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5205    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5206    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5207    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5208    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5209    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5210    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5211    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5212    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5213    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5214    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5215    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5216    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5217    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5218    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5219    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5220    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5221    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5222    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5223    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5224    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5225    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5226    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5227    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5228    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5229    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5230    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5231    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5232    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5233    05  F                       PIC X(09) VALUE "~CSONAMT=".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  92
* NSRASBL.cbl
  5234    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5235    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5236    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5237    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5238    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5239    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5240    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5241    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5242    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5243    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5244    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5245    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5246    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5247    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5248    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5249    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5250    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5251    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5252    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5253    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5254    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5255    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5256    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5257    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5258    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5259    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5260    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5261    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5262    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5263    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5264    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5265    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5266    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5267    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5268    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5269    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5270    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5271    05  F                       PIC X(7)  VALUE "~VINNO=".
  5272    05  OUT-VIN-NUMBER          PIC X(17) VALUE SPACES.
  5273    05  F                       PIC X(11) VALUE 'EndOfString'.
  5274    05  f                       pic x(2) value spaces.
  5275*                                COPY ERCARCH.
  5276******************************************************************
  5277*                                                                *
  5278*                            ERCARCH.                            *
  5279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5280*                            VMOD=2.002                          *
  5281*                                                                *
  5282*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5283*                                                                *
  5284*   FILE TYPE = VSAM,KSDS                                        *
  5285*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5286*                                                                *
  5287*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5288*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5289*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5290*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5291*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  93
* NSRASBL.cbl
  5292*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5293*                                                                *
  5294*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5295******************************************************************
  5296*                   C H A N G E   L O G
  5297*
  5298* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5299*-----------------------------------------------------------------
  5300*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5301* EFFECTIVE    NUMBER
  5302*-----------------------------------------------------------------
  5303* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5304* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5305* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5306* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  5307******************************************************************
  5308 01  LETTER-ARCHIVE.
  5309     12  LA-RECORD-ID                PIC  X(02).
  5310         88  LA-VALID-ID                VALUE 'LA'.
  5311
  5312     12  LA-CONTROL-PRIMARY.
  5313         16  LA-COMPANY-CD           PIC  X(01).
  5314         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5315
  5316     12  LA-CONTROL-BY-CERT-RESP.
  5317         16  LA-COMPANY-CD-A2        PIC  X(01).
  5318         16  LA-CERT-NO-A2.
  5319             20  LA-CERT-PRIME-A2    PIC  X(10).
  5320             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5321         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5322             20  LA-RESP-PERSON-A2   PIC  X(10).
  5323             20  LA-TYPE-A2          PIC  X(01).
  5324         16  LA-CARRIER-A2           PIC  X(01).
  5325         16  LA-GROUPING-A2          PIC  X(06).
  5326         16  LA-STATE-A2             PIC  X(02).
  5327         16  LA-ACCOUNT-A2           PIC  X(10).
  5328         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5329         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5330
  5331     12  LA-CONTROL-BY-FORM.
  5332         16  LA-COMPANY-CD-A3        PIC  X(01).
  5333         16  LA-FORM-A3              PIC  X(04).
  5334         16  LA-CARRIER-A3           PIC  X(01).
  5335         16  LA-GROUPING-A3          PIC  X(06).
  5336         16  LA-STATE-A3             PIC  X(02).
  5337         16  LA-ACCOUNT-A3           PIC  X(10).
  5338         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5339
  5340     12  LA-CONTROL-BY-PROCESSOR.
  5341         16  LA-COMPANY-CD-A4        PIC  X(01).
  5342         16  LA-PROCESSOR-CD         PIC  X(04).
  5343         16  LA-CARRIER-A4           PIC  X(01).
  5344         16  LA-GROUPING-A4          PIC  X(06).
  5345         16  LA-STATE-A4             PIC  X(02).
  5346         16  LA-ACCOUNT-A4           PIC  X(10).
  5347         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5348
  5349     12  LA-CONTROL-BY-KEY-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  94
* NSRASBL.cbl
  5350         16  LA-COMPANY-CD-A5        PIC  X(01).
  5351         16  LA-CARRIER-A5           PIC  X(01).
  5352         16  LA-GROUPING-A5          PIC  X(06).
  5353         16  LA-STATE-A5             PIC  X(02).
  5354         16  LA-ACCOUNT-A5           PIC  X(10).
  5355         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5356
  5357     12  LA-CONTROL-BY-GROUP-CODE.
  5358         16  LA-COMPANY-CD-A6        PIC  X(01).
  5359         16  LA-ENTRY-A6.
  5360             20  LA-FILLER           PIC  X(02).
  5361             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5362         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5363
  5364     12  FILLER                      PIC  X(09).
  5365
  5366     12  LA-HEADER-RECORD.
  5367         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5368         16  LA-CREATION-DATE        PIC  X(02).
  5369         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5370         16  LA-FINAL-ACT-DATE       REDEFINES
  5371               LA-FOLLOW-UP-DATE     PIC  X(02).
  5372         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5373         16  LA-NO-OF-COPIES         PIC S9(01).
  5374         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5375         16  LA-REPLY-DATE           PIC  X(02).
  5376         16  LA-RESEND-DATES.
  5377             20  LA-RESEND-DATE      PIC  X(02).
  5378             20  LA-SENT-DATE        PIC  X(02).
  5379             20  FILLER              PIC  X(08).
  5380         16  LA-SOURCE-INFORMATION.
  5381             20  LA-DATA-SOURCE      PIC  X(01).
  5382             20  LA-ADDR-SOURCE      PIC  X(01).
  5383         16  LA-STATUS               PIC  X(01).
  5384             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5385             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5386             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5387             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5388             88  LA-STATUS-PURGED         VALUE 'P'.
  5389             88  LA-STATUS-VOIDED         VALUE 'V'.
  5390         16  LA-LAST-RESENT-PRINT-DATE
  5391                                     PIC  X(02).
  5392         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5393             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5394                                          VALUE 'C'.
  5395             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5396                                          VALUE 'F'.
  5397             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5398                                          VALUE 'P'.
  5399         16  LA-PURGED-DATE          PIC  X(02).
  5400         16  LA-VOIDED-DATE          PIC  X(02).
  5401         16  LA-RESEND-LETR          PIC  X(4).
  5402         16  LA-VOID-ONBASE-YN       PIC  X.
  5403         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  5404         16  FILLER                  PIC  X(04).
  5405*        16  LA-RESEND-LETR-2        PIC  X(4).
  5406*        16  LA-RESEND-LETR-3        PIC  X(4).
  5407*        16  FILLER                  PIC  X(59).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  95
* NSRASBL.cbl
  5408         16  LA-ARCHIVE-STATUS       PIC  X.
  5409             88  LA-TEMP                VALUE 'T'.
  5410             88  LA-QWS                 VALUE 'Q'.
  5411             88  LA-BATCH               VALUE 'B'.
  5412         16  LA-FINAL-ACT-IND        PIC  X(1).
  5413         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5414         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5415         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5416                                     PIC X(4).
  5417         16  FILLER                  PIC  X(42).
  5418*        16  FILLER                  PIC  X(71).
  5419         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5420         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5421         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5422                                     PIC  X(4).
  5423         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5424
  5425******************************************************************
  5426*                                COPY ELCCRTT.
  5427******************************************************************
  5428*                                                                *
  5429*                            ELCCRTT.                            *
  5430*                                                                *
  5431*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5432*                                                                *
  5433*   FILE TYPE = VSAM,KSDS                                        *
  5434*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5435*                                                                *
  5436*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5437*                                                                *
  5438*   LOG = YES                                                    *
  5439*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5440******************************************************************
  5441*                   C H A N G E   L O G
  5442*
  5443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5444*-----------------------------------------------------------------
  5445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5446* EFFECTIVE    NUMBER
  5447*-----------------------------------------------------------------
  5448* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5449* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5450* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5451* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5452* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5453* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5454* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5455* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5456* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5457* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5458* 091318  CR2018073000001  PEMA  ADD Refund methods
  5459* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5460******************************************************************
  5461
  5462 01  CERTIFICATE-TRAILERS.
  5463     12  CS-RECORD-ID                      PIC XX.
  5464         88  VALID-CS-ID                      VALUE 'CS'.
  5465
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  96
* NSRASBL.cbl
  5466     12  CS-CONTROL-PRIMARY.
  5467         16  CS-COMPANY-CD                 PIC X.
  5468         16  CS-CARRIER                    PIC X.
  5469         16  CS-GROUPING                   PIC X(6).
  5470         16  CS-STATE                      PIC XX.
  5471         16  CS-ACCOUNT                    PIC X(10).
  5472         16  CS-CERT-EFF-DT                PIC XX.
  5473         16  CS-CERT-NO.
  5474             20  CS-CERT-PRIME             PIC X(10).
  5475             20  CS-CERT-SFX               PIC X.
  5476         16  CS-TRAILER-TYPE               PIC X.
  5477             88  COMM-TRLR           VALUE 'A'.
  5478             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5479             88  CERT-DATA-TRLR      VALUE 'C'.
  5480
  5481     12  CS-DATA-AREA                      PIC X(516).
  5482
  5483     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5484         16  CS-BANK-COMMISSION-AREA.
  5485             20  CS-BANK-COMMS       OCCURS 10.
  5486                 24  CS-AGT                PIC X(10).
  5487                 24  CS-COM-TYP            PIC X.
  5488                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5489                 24  CS-RECALC-LV-INDIC    PIC X.
  5490                 24  FILLER                PIC X(10).
  5491         16  FILLER                        PIC X(256).
  5492
  5493     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5494****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5495         16  CS-MB-CLAIM-DATA OCCURS 24.
  5496             20  CS-CLAIM-NO               PIC X(7).
  5497             20  CS-CLAIM-TYPE             PIC X.
  5498                 88  CS-AH-CLM               VALUE 'A'.
  5499                 88  CS-IU-CLM               VALUE 'I'.
  5500                 88  CS-GP-CLM               VALUE 'G'.
  5501                 88  CS-LF-CLM               VALUE 'L'.
  5502                 88  CS-PR-CLM               VALUE 'P'.
  5503                 88  CS-FL-CLM               VALUE 'F'.
  5504                 88  CS-OT-CLM               VALUE 'O'.
  5505             20  CS-INSURED-TYPE           PIC X.
  5506                 88  CS-PRIM-INSURED          VALUE 'P'.
  5507                 88  CS-CO-BORROWER           VALUE 'C'.
  5508             20  CS-BENEFIT-PERIOD         PIC 99.
  5509             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5510             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5511             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5512         16  FILLER                        PIC X(12).
  5513     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5514         16  CS-VIN-NUMBER                 PIC X(17).
  5515         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5516         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5517         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5518         16  cs-agent-name.
  5519             20  cs-agent-fname            pic x(20).
  5520             20  cs-agent-mi               pic x.
  5521             20  cs-agent-lname            pic x(25).
  5522         16  cs-license-no                 pic x(15).
  5523         16  cs-npn-number                 pic x(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  97
* NSRASBL.cbl
  5524         16  cs-agent-edit-status          pic x.
  5525             88  cs-ae-refer-to-manager      value 'M'.
  5526             88  cs-ae-cover-sheet           value 'C'.
  5527             88  cs-ae-sig-form              value 'S'.
  5528             88  cs-ae-verified              value 'V'.
  5529             88  cs-unidentified-signature   value 'U'.
  5530             88  cs-cert-returned            value 'R'.
  5531             88  cs-accept-no-commission     value 'N'.
  5532         16  cs-year                       pic 9999.
  5533         16  cs-make                       pic x(20).
  5534         16  cs-model                      pic x(20).
  5535         16  cs-future                     pic x(20).
  5536         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5537         16  cs-claim-verification-status  pic x.
  5538             88  cs-clm-ver-eligible         value 'A'.
  5539             88  cs-clm-ver-partial-elig     value 'B'.
  5540             88  cs-clm-ver-not-eligible     value 'C'.
  5541             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5542             88  cs-clm-ver-not-part-elig-rw value 'E'.
  5543             88  cs-clm-ver-ND-CERT          value 'F'.
  5544             88  cs-clm-ver-spec-other       value 'G'.
  5545             88  cs-clam-ver-pratial-corrected
  5546                                             value 'H'.
  5547             88  cs-clm-ver-no-matches       value 'I'.
  5548             88  cs-clm-ver-not-elig-corrected
  5549                                             value 'J'.
  5550             88  cs-clm-ver-needs-review     value 'R'.
  5551             88  cs-clm-ver-sent-to-claims   value 'W'.
  5552         16  CS-LF-REFUND-METHOD           PIC X.
  5553         16  CS-AH-REFUND-METHOD           PIC X.
  5554         16  FILLER                        PIC X(353). *> was 420
  5555*        16  FILLER                        PIC X(496).
  5556 01  FILLER                      PIC X(500)  VALUE SPACES.
  5557*                                COPY ELCENCC.
  5558******************************************************************
  5559*                                                                *
  5560*                                                                *
  5561*                            ELCENCC                             *
  5562*                            VMOD=2.001                          *
  5563*                                                                *
  5564*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5565*                                                                *
  5566*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5567*   A NAPERSOFT DOCUMENT                                         *
  5568*                                                                *
  5569*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5570*                                                                *
  5571*   FILE TYPE = VSAM,KSDS                                        *
  5572*   RECORD SIZE = 400   RECFORM = FIX                            *
  5573*                                                                *
  5574*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5575*                                                                *
  5576*   LOG = NO                                                     *
  5577*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5578*                                                                *
  5579*                                                                *
  5580******************************************************************
  5581*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  98
* NSRASBL.cbl
  5582*
  5583* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5584*-----------------------------------------------------------------
  5585*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5586* EFFECTIVE    NUMBER
  5587*-----------------------------------------------------------------
  5588* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5589* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5590******************************************************************
  5591 01  ENCLOSURE-CODES.
  5592     12  NC-RECORD-ID                      PIC XX.
  5593         88  VALID-NC-ID                      VALUE 'NC'.
  5594     12  NC-CONTROL-PRIMARY.
  5595         16  NC-COMPANY-CD                 PIC X.
  5596         16  NC-REC-TYPE                   PIC X.
  5597             88  NC-CLAIMS                   VALUE '1'.
  5598             88  NC-ADMIN                    VALUE '2'.
  5599         16  NC-ENC-CODE                   PIC X(5).
  5600         16  FILLER                        PIC X(09).
  5601     12  NC-MAINT-INFORMATION.
  5602         16  NC-LAST-MAINT-DT              PIC XX.
  5603         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5604         16  NC-LAST-MAINT-USER            PIC X(4).
  5605         16  FILLER                        PIC XX.
  5606     12  NC-OUTPUT-STACK                   PIC XXX.
  5607     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5608     12  NC-ATTACHMENTS                    PIC X(255).
  5609     12  NC-FUTURE                         PIC X(12).
  5610******************************************************************
  5611****************************************************************
  5612*
  5613* Copyright (c) 2007-2013 Dell Inc.
  5614* All rights reserved.
  5615*
  5616****************************************************************
  5617 01  DFHEIV.
  5618   02  DFHEIV0               PIC X(35).
  5619   02  DFHEIV1               PIC X(08).
  5620   02  DFHEIV2               PIC X(08).
  5621   02  DFHEIV3               PIC X(08).
  5622   02  DFHEIV4               PIC X(06).
  5623   02  DFHEIV5               PIC X(04).
  5624   02  DFHEIV6               PIC X(04).
  5625   02  DFHEIV7               PIC X(02).
  5626   02  DFHEIV8               PIC X(02).
  5627   02  DFHEIV9               PIC X(01).
  5628   02  DFHEIV10              PIC S9(7) COMP-3.
  5629   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5630   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5631   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5632   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5633   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5634   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5635   02  DFHEIV17              PIC X(04).
  5636   02  DFHEIV18              PIC X(04).
  5637   02  DFHEIV19              PIC X(04).
  5638   02  DFHEIV20              USAGE IS POINTER.
  5639   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page  99
* NSRASBL.cbl
  5640   02  DFHEIV22              USAGE IS POINTER.
  5641   02  DFHEIV23              USAGE IS POINTER.
  5642   02  DFHEIV24              USAGE IS POINTER.
  5643   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5644   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5645   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5646   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5647   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5648   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5649   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5650   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5651   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5652   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5653   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5654   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5655   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5656   02  FILLER                PIC X(02).
  5657   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5658   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5659   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5660   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5661   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5662   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5663   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5664 LINKAGE  SECTION.
  5665*****************************************************************
  5666*                                                               *
  5667* Copyright (c) 2007-2013 Dell Inc.                             *
  5668* All rights reserved.                                          *
  5669*                                                               *
  5670*****************************************************************
  5671 01  dfheiblk.
  5672     02  eibtime          pic s9(7) comp-3.
  5673     02  eibdate          pic s9(7) comp-3.
  5674     02  eibtrnid         pic x(4).
  5675     02  eibtaskn         pic s9(7) comp-3.
  5676     02  eibtrmid         pic x(4).
  5677     02  dfheigdi         pic s9(4) comp.
  5678     02  eibcposn         pic s9(4) comp.
  5679     02  eibcalen         pic s9(4) comp.
  5680     02  eibaid           pic x(1).
  5681     02  eibfiller1       pic x(1).
  5682     02  eibfn            pic x(2).
  5683     02  eibfiller2       pic x(2).
  5684     02  eibrcode         pic x(6).
  5685     02  eibfiller3       pic x(2).
  5686     02  eibds            pic x(8).
  5687     02  eibreqid         pic x(8).
  5688     02  eibrsrce         pic x(8).
  5689     02  eibsync          pic x(1).
  5690     02  eibfree          pic x(1).
  5691     02  eibrecv          pic x(1).
  5692     02  eibsend          pic x(1).
  5693     02  eibatt           pic x(1).
  5694     02  eibeoc           pic x(1).
  5695     02  eibfmh           pic x(1).
  5696     02  eibcompl         pic x(1).
  5697     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 100
* NSRASBL.cbl
  5698     02  eibconf          pic x(1).
  5699     02  eiberr           pic x(1).
  5700     02  eibrldbk         pic x(1).
  5701     02  eiberrcd         pic x(4).
  5702     02  eibsynrb         pic x(1).
  5703     02  eibnodat         pic x(1).
  5704     02  eibfiller5       pic x(2).
  5705     02  eibresp          pic s9(8) comp.
  5706     02  eibresp2         pic s9(8) comp.
  5707     02  dfheigdj         pic s9(4) comp.
  5708     02  dfheigdk         pic s9(4) comp.
  5709 01 dfhcommarea                  PIC X(6500).
  5710
  5711 01  var  pic x(30).
  5712 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  5713 0000-DFHEXIT SECTION.
  5714     MOVE '9#                    $   ' TO DFHEIV0.
  5715     MOVE 'NSRASBL' TO DFHEIV1.
  5716     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5717     display ' entering pgm nsrasbl '
  5718     display ' commarea ' dfhcommarea
  5719     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5720     MOVE '5'                    TO DC-OPTION-CODE
  5721     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5722     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5723     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5724     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5725     MOVE DC-DAY-OF-WEEK         TO SAVE-CYCLE-DAY-OF-WEEK
  5726     move dfhcommarea            to srch-commarea
  5727*****************************************************
  5728* The full       key has been established and passed
  5729* to this program via NSRASLTR
  5730*****************************************************
  5731     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5732     display ' input data ' bl-carrier ' ' bl-group ' '
  5733        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5734     MOVE BL-LETTER-ID           TO OUT-LETTER
  5735     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5736     MOVE BL-CARRIER             TO OUT-CARRIER
  5737     MOVE BL-GROUP               TO OUT-GROUPING
  5738     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5739     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5740     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5741     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5742     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5743        DC-EDITA-DAY  DELIMITED BY SIZE
  5744        INTO OUT-CYCLE-DT
  5745     END-STRING
  5746
  5747     set P to address of KIXSYS
  5748     CALL "getenv" using by value P returning var-ptr
  5749     if var-ptr = null then
  5750        display ' kixsys not set '
  5751     else
  5752        set address of var to var-ptr
  5753        move 0 to env-var-len
  5754        inspect var tallying env-var-len
  5755          for characters before X'00'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 101
* NSRASBL.cbl
  5756        unstring var (1:env-var-len) delimited by '/'
  5757        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5758              WS-KIX-SYS
  5759        end-unstring
  5760     end-if
  5761
  5762     set P to address of KIXHOST
  5763     CALL "getenv" using by value P returning var-ptr
  5764     if var-ptr = null then
  5765        display ' kixhost not set '
  5766     else
  5767        set address of var to var-ptr
  5768        move 0 to env-var-len
  5769        inspect var tallying env-var-len
  5770          for characters before X'00'
  5771        MOVE var(1:env-var-len)  to ws-kixhost
  5772        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  5773     end-if
  5774
  5775     MOVE SPACES TO SVR
  5776
  5777**** This routine will connect to the Logic Database on SQL Server
  5778**** and call a stored procedure to determine the next business da
  5779
  5780     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  5781     IF SQLCODE = 0
  5782        PERFORM 4200-GET-NEXT-BUS-DT  THRU 4200-EXIT
  5783        IF SQLCODE = 0
  5784            MOVE WS-NEXT-BUS-DT TO SAVE-NEXT-BUS-DT-EDIT-A
  5785                                   WS-EDIT-A-DATE
  5786            MOVE WS-EDIT-A-YY   TO DC-YMD-YEAR
  5787            MOVE WS-EDIT-A-MM   TO DC-YMD-MONTH
  5788            MOVE WS-EDIT-A-DD   TO DC-YMD-DAY
  5789            MOVE '3'            TO DC-OPTION-CODE
  5790            PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5791            IF NO-CONVERSION-ERROR
  5792               MOVE DC-BIN-DATE-1 TO SAVE-BIN-NEXT-BUS-DT
  5793            ELSE
  5794               MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5795               MOVE '6'         TO DC-OPTION-CODE
  5796               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5797               IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5798                  MOVE 3        TO DC-ELAPSED-DAYS
  5799               ELSE
  5800                 IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5801                    MOVE 2     TO DC-ELAPSED-DAYS
  5802                 ELSE
  5803                    MOVE 1     TO DC-ELAPSED-DAYS
  5804                 END-IF
  5805               END-IF
  5806               PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5807               IF NO-CONVERSION-ERROR
  5808                   MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5809                   MOVE DC-GREG-DATE-A-EDIT TO
  5810                                SAVE-NEXT-BUS-DT-EDIT-A
  5811               ELSE
  5812                   MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5813                   MOVE WS-SAVE-EDIT-A-DATE TO
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 102
* NSRASBL.cbl
  5814                                SAVE-NEXT-BUS-DT-EDIT-A
  5815               END-IF
  5816            END-IF
  5817        ELSE
  5818            MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5819            MOVE '6'         TO DC-OPTION-CODE
  5820            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5821            IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5822               MOVE 3        TO DC-ELAPSED-DAYS
  5823            ELSE
  5824              IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5825                 MOVE 2     TO DC-ELAPSED-DAYS
  5826              ELSE
  5827                 MOVE 1     TO DC-ELAPSED-DAYS
  5828              END-IF
  5829            END-IF
  5830            PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5831            IF NO-CONVERSION-ERROR
  5832                MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5833                MOVE DC-GREG-DATE-A-EDIT TO
  5834                                SAVE-NEXT-BUS-DT-EDIT-A
  5835            ELSE
  5836                MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5837                MOVE WS-SAVE-EDIT-A-DATE TO
  5838                                SAVE-NEXT-BUS-DT-EDIT-A
  5839            END-IF
  5840        END-IF
  5841     ELSE
  5842        MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5843        MOVE '6'         TO DC-OPTION-CODE
  5844        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5845        IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5846           MOVE 3        TO DC-ELAPSED-DAYS
  5847        ELSE
  5848          IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5849             MOVE 2     TO DC-ELAPSED-DAYS
  5850          ELSE
  5851             MOVE 1     TO DC-ELAPSED-DAYS
  5852          END-IF
  5853        END-IF
  5854        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5855        IF NO-CONVERSION-ERROR
  5856            MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5857            MOVE DC-GREG-DATE-A-EDIT TO
  5858                                SAVE-NEXT-BUS-DT-EDIT-A
  5859        ELSE
  5860            MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5861            MOVE WS-SAVE-EDIT-A-DATE TO
  5862                                SAVE-NEXT-BUS-DT-EDIT-A
  5863        END-IF
  5864     END-IF
  5865     PERFORM 4300-DISCONNECT THRU 4300-EXIT
  5866
  5867     MOVE SAVE-NEXT-BUS-DT-EDIT-A  TO WS-EDIT-A-DATE
  5868     STRING WS-EDIT-A-CCYY '-' WS-EDIT-A-MM '-'
  5869           WS-EDIT-A-DD ' 00:00:00.0' DELIMITED BY SIZE
  5870              INTO OUT-NEXT-BUS-DT
  5871     END-STRING
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 103
* NSRASBL.cbl
  5872     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5873        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5874     ELSE
  5875        IF BL-EFF-DT = SPACES
  5876           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5877        ELSE
  5878           IF BL-EFF-DT (9:2) = SPACES
  5879              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5880                     BL-EFF-DT (4:2)
  5881                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5882              END-STRING
  5883           ELSE
  5884              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5885                     BL-EFF-DT (4:2)
  5886                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5887              END-STRING
  5888           END-IF
  5889           MOVE '3'              TO DC-OPTION-CODE
  5890           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5891           IF NO-CONVERSION-ERROR
  5892              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5893           ELSE
  5894              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5895              SET BL-FAIL TO TRUE
  5896              GO TO 0000-RETURN
  5897           END-IF
  5898        END-IF
  5899     END-IF
  5900     perform 0800-init-out-data  thru 0800-exit
  5901     SET BL-FAIL TO TRUE
  5902******************************************************************
  5903* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5904*    1) FROM ACCT MAINT
  5905*    2) FROM CERT UPDATE
  5906*    3) FROM COMP MAINT
  5907*    4) FROM REVIEW AND CORRECTIONS
  5908******************************************************************
  5909     EVALUATE BL-DATA-SRCE
  5910        WHEN '1'
  5911           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5912        WHEN '2'
  5913           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5914        WHEN '3'
  5915           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5916        WHEN '4'
  5917           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5918        WHEN OTHER
  5919           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5920     END-EVALUATE
  5921     IF BL-OK
  5922        display ' bl write erarch ' bl-write-erarch
  5923        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5924        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5925        IF BL-ARCHIVE-NO = ZEROS
  5926           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5927           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5928           display ' arch zeros, new arch ' bl-archive-no
  5929        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 104
* NSRASBL.cbl
  5930        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5931        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5932        display ' bl write erarch ' bl-write-erarch
  5933        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5934           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5935           IF BL-FAIL
  5936              GO TO 0000-RETURN
  5937           END-IF
  5938        END-IF
  5939        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5940        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5941     END-IF
  5942     .
  5943 0000-RETURN.
  5944     move srch-commarea          to dfhcommarea
  5945
  5946* exec cics
  5947*       return
  5948*    end-exec
  5949*    MOVE '.(                    ''   #00005848' TO DFHEIV0
  5950     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5951     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5952     MOVE X'2020233030303035383438' TO DFHEIV0(25:11)
  5953     CALL 'kxdfhei1' USING DFHEIV0,
  5954           DFHEIV99,
  5955           DFHEIV99,
  5956           DFHEIV99,
  5957           DFHEIV99,
  5958           DFHEIV99,
  5959           DFHEIV99
  5960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5961     .
  5962 0100-DATA-SRCE-1.
  5963     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5964     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5965     MOVE ' '                    TO WS-ERACCT-SW
  5966     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5967     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5968     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5969     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5970     MOVE BL-STATE               TO WS-ERACCT-STATE
  5971     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5972     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5973                                    WS-CERT-EFF-DT
  5974     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5975     IF ACCT-FOUND
  5976        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5977        PERFORM 1025-GET-CSR-INFO
  5978                                 THRU 1025-EXIT
  5979        PERFORM 1300-DETERMINE-COMM
  5980                                 THRU 1300-EXIT
  5981        SET BL-OK TO TRUE
  5982     ELSE
  5983        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5984        SET BL-FAIL TO TRUE
  5985     END-IF
  5986     .
  5987 0100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 105
* NSRASBL.cbl
  5988     EXIT.
  5989 0200-DATA-SRCE-2.
  5990     display ' made it to data srce 2 '
  5991     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5992     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5993     MOVE ' '                    TO WS-ELCERT-SW
  5994     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5995     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5996     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5997     MOVE BL-STATE               TO WS-ELCERT-STATE
  5998     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5999     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  6000                                    WS-CERT-EFF-DT
  6001     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  6002
  6003     MOVE ' '                 TO WS-ERACCT-SW
  6004     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  6005     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  6006     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  6007     IF ACCT-FOUND
  6008        MOVE AM-CSR-CODE      TO WS-CSR-ID
  6009        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  6010     END-IF
  6011     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  6012     IF CERT-FOUND
  6013        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  6014        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  6015        MOVE WS-LF-DESC          TO OUT-LF-DESC
  6016        IF WS-LF-EARN = 'B'
  6017           MOVE 'B'              TO OUT-BALLOON-IND
  6018        END-IF
  6019        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  6020        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  6021        MOVE WS-AH-DESC          TO OUT-AH-DESC
  6022        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  6023
  6024        IF BL-ENDT-ARCH-NO > ZERO
  6025           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  6026           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  6027           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6028        ELSE
  6029           IF BL-ARCHIVE-NO > ZERO
  6030              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  6031              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  6032              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6033           END-IF
  6034        END-IF
  6035
  6036        PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  6037*072312 IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  6038        IF WS-LOOKUP-VALUE > SPACES
  6039          AND (OUT-BALLOON-IND = 'B')
  6040           MOVE 'B'              TO OUT-FORM (3:1)
  6041        END-IF
  6042        SET BL-OK TO TRUE
  6043     ELSE
  6044        display ' cert not found ' ws-elcert-cert-no
  6045        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 106
* NSRASBL.cbl
  6046        SET BL-FAIL TO TRUE
  6047     END-IF
  6048     .
  6049 0200-EXIT.
  6050     EXIT.
  6051 0300-DATA-SRCE-3.
  6052     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  6053     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  6054     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  6055     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  6056     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  6057     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  6058     IF WS-ERCOMP-ACCOUNT = SPACES
  6059        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  6060        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  6061     ELSE
  6062        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  6063     END-IF
  6064     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  6065     IF RESP-NORMAL
  6066        MOVE CO-CSR-CODE         TO WS-CSR-ID
  6067        PERFORM 1025-GET-CSR-INFO
  6068                                 THRU 1025-EXIT
  6069        SET BL-OK TO TRUE
  6070     ELSE
  6071        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  6072        SET BL-FAIL TO TRUE
  6073     END-IF
  6074     .
  6075 0300-EXIT.
  6076     EXIT.
  6077 0400-DATA-SRCE-4.
  6078     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  6079     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  6080     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  6081     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  6082     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  6083                                    WS-ELCERT-SW WS-ERENDT-SW
  6084
  6085* EXEC CICS READ
  6086*         DATASET    ('ERPNDB')
  6087*         INTO       (PENDING-BUSINESS)
  6088*         RIDFLD     (WS-ERPNDB-KEY)
  6089*         RESP       (WS-RESPONSE)
  6090*    END-EXEC
  6091     MOVE LENGTH OF
  6092      PENDING-BUSINESS
  6093       TO DFHEIV11
  6094     MOVE 'ERPNDB' TO DFHEIV1
  6095*    MOVE '&"IL       E          (  N#00005974' TO DFHEIV0
  6096     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6098     MOVE X'204E233030303035393734' TO DFHEIV0(25:11)
  6099     CALL 'kxdfhei1' USING DFHEIV0,
  6100           DFHEIV1,
  6101           PENDING-BUSINESS,
  6102           DFHEIV11,
  6103           WS-ERPNDB-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 107
* NSRASBL.cbl
  6104           DFHEIV99,
  6105           DFHEIV99,
  6106           DFHEIV99
  6107     MOVE EIBRESP  TO WS-RESPONSE
  6108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6109     IF RESP-NORMAL
  6110        IF PB-RECORD-TYPE = '1' OR '2'
  6111           MOVE PB-CARRIER       TO BL-CARRIER
  6112           MOVE PB-GROUPING      TO BL-GROUP
  6113           MOVE PB-STATE         TO BL-STATE
  6114           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  6115           MOVE PB-CERT-NO       TO BL-CERT-NO
  6116           MOVE PB-CSR-ID        TO WS-CSR-ID
  6117           IF PB-ISSUE
  6118              SET PROCESS-ISSUE TO TRUE
  6119              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  6120              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  6121              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  6122              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  6123           ELSE
  6124              SET PROCESS-CANCEL TO TRUE
  6125              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  6126              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  6127              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  6128              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  6129           END-IF
  6130           PERFORM 1120-MATCH-CARRIER
  6131                                 THRU 1120-EXIT
  6132           PERFORM 1125-MATCH-STATE
  6133                                 THRU 1125-EXIT
  6134           PERFORM 1130-MATCH-BENCDS
  6135                                 THRU 1130-EXIT
  6136           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  6137           MOVE WS-LF-DESC       TO OUT-LF-DESC
  6138                                    OUT-ORIG-LF-DESC
  6139           IF WS-LF-EARN = 'B'
  6140              MOVE 'B'           TO OUT-BALLOON-IND
  6141           END-IF
  6142           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  6143                                    OUT-ORIG-WAIT-PER
  6144           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  6145                                    OUT-ORIG-RET-ELIM
  6146           MOVE WS-AH-DESC       TO OUT-AH-DESC
  6147                                    OUT-ORIG-AH-DESC
  6148           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  6149                                    OUT-ORIG-BEN-DAYS
  6150           PERFORM 1025-GET-CSR-INFO
  6151                                 THRU 1025-EXIT
  6152
  6153           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  6154           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  6155                                 TO WS-ERACCT-KEY (1:22)
  6156           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  6157           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  6158           IF ACCT-FOUND
  6159              MOVE AM-CSR-CODE      TO WS-CSR-ID
  6160              PERFORM 1025-GET-CSR-INFO
  6161                                    THRU 1025-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 108
* NSRASBL.cbl
  6162              PERFORM 1300-DETERMINE-COMM
  6163                                    THRU 1300-EXIT
  6164           END-IF
  6165
  6166           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  6167                                 TO WS-ELCERT-KEY
  6168           PERFORM 1100-GET-ELCERT
  6169                                 THRU 1100-EXIT
  6170
  6171           IF BL-ENDT-ARCH-NO > ZERO
  6172              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  6173              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  6174              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6175           ELSE
  6176              IF BL-ARCHIVE-NO > ZERO
  6177                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  6178                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  6179                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6180              END-IF
  6181           END-IF
  6182
  6183           SET BL-OK TO TRUE
  6184           PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  6185*072312     IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  6186           IF WS-LOOKUP-VALUE > SPACES
  6187             AND (OUT-BALLOON-IND = 'B')
  6188              MOVE 'B'           TO OUT-FORM (3:1)
  6189           END-IF
  6190        END-IF
  6191     END-IF
  6192     .
  6193 0400-EXIT.
  6194     EXIT.
  6195 0500-SCRUB-DATA.
  6196*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  6197*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  6198*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  6199*   TO A HEX 26 TO GET BY THE DECODER
  6200     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  6201                                 TO M1
  6202     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  6203     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6204        (A1 > M1)
  6205        OR (WS-WORK-FIELD (A1:1) = '*')
  6206        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6207        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6208     END-PERFORM
  6209     IF A1 > M1
  6210        CONTINUE
  6211     ELSE
  6212        MOVE WS-WORK-FIELD (1:A1 - 1)
  6213                                 TO OUT-ACCT-NAME
  6214     END-IF
  6215     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  6216                                 TO M1
  6217     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  6218     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6219        (A1 > M1)
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 109
* NSRASBL.cbl
  6220        OR (WS-WORK-FIELD (A1:1) = '*')
  6221        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6222        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6223     END-PERFORM
  6224     IF A1 > M1
  6225        CONTINUE
  6226     ELSE
  6227        MOVE WS-WORK-FIELD (1:A1 - 1)
  6228                                 TO OUT-BENE-NAME
  6229     END-IF
  6230     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  6231         MOVE '0000000000 '  TO OUT-CERT-NO
  6232     END-IF
  6233     MOVE +1 TO M1
  6234     MOVE SPACES TO BL-RECORD-PASSED-DATA
  6235     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  6236                                 TO NS-LEN
  6237     display ' naper output data length ' ns-len
  6238     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6239        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  6240        OR (A1 > NS-LEN)
  6241        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  6242           CONTINUE
  6243        ELSE
  6244           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  6245              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  6246              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  6247              ADD +1 TO M1
  6248           ELSE
  6249              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  6250                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  6251                 ADD +3 TO M1
  6252              ELSE
  6253                 MOVE NAPER-OUTPUT-DATA (A1:1)
  6254                                 TO BL-RECORD-PASSED-DATA (M1:1)
  6255                 ADD +1 TO M1
  6256              END-IF
  6257           END-IF
  6258        END-IF
  6259     END-PERFORM
  6260     .
  6261 0500-EXIT.
  6262     EXIT.
  6263 0600-GET-ERENDT.
  6264
  6265* EXEC CICS READ
  6266*         DATASET    ('ERENDT2')
  6267*         INTO       (ENDORSEMENT-RECORD)
  6268*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  6269*         RESP       (WS-RESPONSE)
  6270*    END-EXEC
  6271     MOVE LENGTH OF
  6272      ENDORSEMENT-RECORD
  6273       TO DFHEIV11
  6274     MOVE 'ERENDT2' TO DFHEIV1
  6275*    MOVE '&"IL       E          (  N#00006135' TO DFHEIV0
  6276     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 110
* NSRASBL.cbl
  6278     MOVE X'204E233030303036313335' TO DFHEIV0(25:11)
  6279     CALL 'kxdfhei1' USING DFHEIV0,
  6280           DFHEIV1,
  6281           ENDORSEMENT-RECORD,
  6282           DFHEIV11,
  6283           WS-ERENDT-KEY-BY-ARCH,
  6284           DFHEIV99,
  6285           DFHEIV99,
  6286           DFHEIV99
  6287     MOVE EIBRESP  TO WS-RESPONSE
  6288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6289     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  6290         WS-ERENDT-ARCHIVE
  6291     IF (RESP-NORMAL)
  6292        SET ENDT-FOUND TO TRUE
  6293        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  6294        PERFORM 0650-PROCESS-NO-Change
  6295                                 THRU 0650-EXIT
  6296     END-IF
  6297     .
  6298 0600-EXIT.
  6299     EXIT.
  6300 0620-BUILD-ENDT.
  6301     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  6302                                    OUT-NEW-LF-CAN-DT
  6303                                    OUT-ORIG-AH-CAN-DT
  6304                                    OUT-NEW-AH-CAN-DT
  6305                                    OUT-ORIG-CAN-DT
  6306                                    OUT-NEW-CAN-DT
  6307     IF EN-REC-TYPE = 'C'
  6308        GO TO 0620-PROCESS-CANCEL
  6309     END-IF
  6310     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  6311     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  6312     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6313     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  6314     IF WS-LF-EARN = 'B'
  6315        MOVE 'B'                 TO OUT-BALLOON-IND
  6316     END-IF
  6317     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  6318     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  6319     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  6320     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  6321     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  6322     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  6323     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  6324     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  6325         MOVE ZERO                 TO OUT-ORIG-IAGE
  6326     ELSE
  6327         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  6328     END-IF
  6329     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  6330     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  6331     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  6332     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  6333         MOVE ZERO                 TO OUT-ORIG-JAGE
  6334     ELSE
  6335         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 111
* NSRASBL.cbl
  6336     END-IF
  6337     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  6338     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  6339     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  6340     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  6341     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  6342     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  6343     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6344                             EN-LF-ORIG-ALT-PRM-AMT
  6345     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  6346     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  6347         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  6348                                    OUT-ORIG-LF-PRM-A
  6349                                    OUT-ORIG-LF-ALT-BEN-A
  6350                                    OUT-ORIG-LF-ALT-PRM-A
  6351                                    OUT-ORIG-COVERAGE-IND
  6352     ELSE
  6353         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  6354         IF EN-LF-ORIG-PRM-AMT = .01
  6355             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  6356         END-IF
  6357         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6358             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6359         END-IF
  6360         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6361             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6362         END-IF
  6363         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6364             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6365         END-IF
  6366     END-IF
  6367     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6368     MOVE ' '                    TO DC-OPTION-CODE
  6369     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6370     IF NO-CONVERSION-ERROR
  6371        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6372           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6373              INTO OUT-ORIG-LF-EXP-DT
  6374        END-STRING
  6375     END-IF
  6376     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6377     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6378     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6379     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6380     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6381         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6382                                    OUT-ORIG-AH-PRM-A
  6383     ELSE
  6384        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6385            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6386        ELSE
  6387            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6388        END-IF
  6389        IF EN-AH-ORIG-PRM-AMT = .01
  6390            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6391        END-IF
  6392        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6393            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 112
* NSRASBL.cbl
  6394        END-IF
  6395     END-IF
  6396     COMPUTE WS-WORK-PREM =
  6397        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6398           + EN-AH-ORIG-PRM-AMT
  6399     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6400     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6401     MOVE ' '                    TO DC-OPTION-CODE
  6402     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6403     IF NO-CONVERSION-ERROR
  6404        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6405           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6406              INTO OUT-ORIG-AH-EXP-DT
  6407        END-STRING
  6408     END-IF
  6409     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6410                                    OUT-ORIG-MAX-PMTS
  6411     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6412         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6413     END-IF
  6414     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6415     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6416     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6417     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6418         MOVE ZERO                TO OUT-NEW-IAGE
  6419     ELSE
  6420         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6421     END-IF
  6422     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6423     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6424     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6425     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6426         MOVE ZERO                TO OUT-NEW-JAGE
  6427     ELSE
  6428         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6429     END-IF
  6430     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6431     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6432     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6433     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6434     IF WS-LF-EARN = 'B'
  6435        MOVE 'B'                 TO OUT-BALLOON-IND
  6436     END-IF
  6437     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6438     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6439     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6440     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6441     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6442     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6443     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6444     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6445     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6446     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6447     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6448                             EN-LF-NEW-ALT-PRM-AMT
  6449     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6450     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6451         MOVE SPACES             TO OUT-NEW-LF-BEN-A
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 113
* NSRASBL.cbl
  6452                                    OUT-NEW-LF-PRM-A
  6453                                    OUT-NEW-LF-ALT-BEN-A
  6454                                    OUT-NEW-LF-ALT-PRM-A
  6455                                    OUT-NEW-LF-CMB-PREM-A
  6456                                    OUT-NEW-COVERAGE-IND
  6457     ELSE
  6458         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6459     END-IF
  6460    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6461     MOVE ' '                     TO DC-OPTION-CODE
  6462     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6463     IF NO-CONVERSION-ERROR
  6464        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6465           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6466              INTO OUT-NEW-LF-EXP-DT
  6467        END-STRING
  6468     END-IF
  6469     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6470     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6471     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6472     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6473     COMPUTE WS-WORK-PREM =
  6474        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6475           + EN-AH-NEW-PRM-AMT
  6476     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6477     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6478         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6479                                    OUT-NEW-AH-PRM-A
  6480     ELSE
  6481        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6482            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6483        ELSE
  6484            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6485        END-IF
  6486     END-IF
  6487     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6488     MOVE ' '                     TO DC-OPTION-CODE
  6489     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6490     IF NO-CONVERSION-ERROR
  6491        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6492           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6493              INTO OUT-NEW-AH-EXP-DT
  6494        END-STRING
  6495     END-IF
  6496     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6497                                     OUT-NEW-MAX-PMTS
  6498     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6499         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6500     END-IF
  6501     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6502        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6503     ELSE
  6504        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6505     END-IF
  6506     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6507        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6508     ELSE
  6509        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 114
* NSRASBL.cbl
  6510     END-IF
  6511     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6512        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6513     ELSE
  6514        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6515     END-IF
  6516     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6517        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6518     ELSE
  6519        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6520     END-IF
  6521     COMPUTE WS-WORK-PREM =
  6522        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6523        EN-AH-NEW-PRM-AMT) -
  6524        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6525        EN-AH-ORIG-PRM-AMT)
  6526     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6527     IF EN-CSO-PORTION NOT NUMERIC
  6528        MOVE ZEROS               TO EN-CSO-PORTION
  6529     END-IF
  6530     IF EN-ACCT-PORTION NOT NUMERIC
  6531        MOVE ZERO                TO EN-ACCT-PORTION
  6532     END-IF
  6533*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6534*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6535     IF WS-WORK-PREM > +0
  6536        MOVE 'CSO'               TO OUT-PAYEE
  6537     ELSE
  6538      IF WS-WORK-PREM = +0
  6539         MOVE 'ZERO'             TO OUT-PAYEE
  6540      ELSE
  6541         MOVE 'ACCT'             TO OUT-PAYEE
  6542      END-IF
  6543     END-IF
  6544     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6545        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6546     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6547     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6548        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6549     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6550     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6551        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6552        * EN-LF-ORIG-COMM-PCT
  6553     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6554     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6555        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6556     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6557     COMPUTE WS-ACCT-ORIG-PORTION =
  6558        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6559     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6560
  6561     COMPUTE WS-CSO-ORIG-LF-PORT =
  6562       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6563     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6564     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6565       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6566     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6567     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 115
* NSRASBL.cbl
  6568       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6569        WS-ACCT-ORIG-CMB-LF-PORT
  6570     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6571     COMPUTE WS-CSO-ORIG-AH-PORT =
  6572        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6573     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6574     COMPUTE WS-CSO-ORIG-PORTION =
  6575        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6576     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6577     COMPUTE WS-ACCT-NEW-LF-PORT =
  6578        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6579     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6580     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6581        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6582     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6583     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6584        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6585        * EN-LF-NEW-COMM-PCT
  6586     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6587     COMPUTE WS-ACCT-NEW-AH-PORT =
  6588        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6589     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6590     COMPUTE WS-ACCT-NEW-PORTION =
  6591        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6592     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6593
  6594     COMPUTE WS-CSO-NEW-LF-PORT =
  6595       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6596     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6597     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6598       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6599     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6600     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6601       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6602        WS-ACCT-NEW-CMB-LF-PORT
  6603     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6604     COMPUTE WS-CSO-NEW-AH-PORT =
  6605        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6606     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6607     COMPUTE WS-CSO-NEW-PORTION =
  6608        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6609     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6610
  6611     COMPUTE WS-ACCT-LF-PORT-CHG =
  6612        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6613     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6614     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6615        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6616     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6617     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6618        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6619     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6620     COMPUTE WS-ACCT-AH-PORT-CHG =
  6621        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6622     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6623     COMPUTE WS-ACCT-PORTION-CHG =
  6624        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6625     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 116
* NSRASBL.cbl
  6626
  6627     COMPUTE WS-CSO-LF-PORT-CHG =
  6628        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6629     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6630     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6631        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6632     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6633     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6634        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6635     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6636     COMPUTE WS-CSO-AH-PORT-CHG =
  6637        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6638     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6639     COMPUTE WS-CSO-PORTION-CHG =
  6640        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6641     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6642
  6643     COMPUTE WS-WORK-PREM =
  6644         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6645     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6646     COMPUTE WS-WORK-PREM =
  6647         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6648     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6649     COMPUTE WS-WORK-PREM =
  6650        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6651        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6652     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6653     COMPUTE WS-WORK-PREM =
  6654        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6655     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6656
  6657     move en-sig-sw              to out-sig-sw
  6658     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6659     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6660     GO TO 0620-CONTINUE
  6661     .
  6662 0620-PROCESS-CANCEL.
  6663     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6664        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6665        MOVE ' '                 TO DC-OPTION-CODE
  6666        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6667        IF NO-CONVERSION-ERROR
  6668           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6669              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6670                 INTO OUT-ORIG-LF-CAN-DT
  6671           END-STRING
  6672        END-IF
  6673        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6674     END-IF
  6675
  6676     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6677        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6678        MOVE ' '                 TO DC-OPTION-CODE
  6679        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6680        IF NO-CONVERSION-ERROR
  6681           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6682              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6683                 INTO OUT-NEW-LF-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 117
* NSRASBL.cbl
  6684           END-STRING
  6685        END-IF
  6686        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6687     END-IF
  6688
  6689     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6690        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6691        MOVE ' '                    TO DC-OPTION-CODE
  6692        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6693        IF NO-CONVERSION-ERROR
  6694           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6695              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6696                 INTO OUT-ORIG-AH-CAN-DT
  6697           END-STRING
  6698        END-IF
  6699        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6700           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6701        END-IF
  6702     END-IF
  6703
  6704     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6705        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6706        MOVE ' '                    TO DC-OPTION-CODE
  6707        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6708        IF NO-CONVERSION-ERROR
  6709           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6710              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6711                 INTO OUT-NEW-AH-CAN-DT
  6712           END-STRING
  6713        END-IF
  6714        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6715           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6716        END-IF
  6717     END-IF
  6718     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6719     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6720     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6721     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6722     COMPUTE WS-WORK-PREM =
  6723        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6724     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6725     COMPUTE WS-WORK-PREM =
  6726        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6727     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6728     COMPUTE WS-WORK-PREM =
  6729        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6730        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6731     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6732
  6733     COMPUTE WS-WORK-PREM =
  6734        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6735     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6736     COMPUTE WS-WORK-PREM =
  6737        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6738     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6739
  6740*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6741*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 118
* NSRASBL.cbl
  6742     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6743
  6744     IF EN-COMM-CHGBK = 'N'
  6745         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6746                                   OUT-CSO-ORIG-ALT-LF-PORT
  6747         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6748         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6749         COMPUTE WS-CSO-ORIG-PORTION =
  6750             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6751         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6752         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6753                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6754                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6755                                   OUT-ACCT-ORIG-AH-PORT
  6756                                   OUT-ACCT-ORIG-PORTION
  6757
  6758         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6759                                   OUT-CSO-NEW-ALT-LF-PORT
  6760         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6761         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6762         COMPUTE WS-CSO-NEW-PORTION =
  6763             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6764         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6765         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6766                                   OUT-ACCT-NEW-ALT-LF-PORT
  6767                                   OUT-ACCT-NEW-CMB-LF-PORT
  6768                                   OUT-ACCT-NEW-AH-PORT
  6769                                   OUT-ACCT-NEW-PORTION
  6770
  6771         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6772                                   OUT-CSO-ALT-LF-PORT-CHG
  6773         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6774           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6775         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6776         COMPUTE WS-CSO-AH-PORT-CHG =
  6777           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6778         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6779         COMPUTE WS-CSO-PORTION-CHG =
  6780           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6781           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6782         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6783         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6784                                   OUT-ACCT-ALT-LF-PORT-CHG
  6785                                   OUT-ACCT-CMB-LF-PORT-CHG
  6786                                   OUT-ACCT-AH-PORT-CHG
  6787                                   OUT-ACCT-PORTION-CHG
  6788     ELSE
  6789         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6790                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6791         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6792           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6793         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6794                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6795         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6796           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6797         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6798         COMPUTE WS-ACCT-ORIG-PORTION =
  6799            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 119
* NSRASBL.cbl
  6800         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6801
  6802         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6803                                   OUT-CSO-ORIG-ALT-LF-PORT
  6804         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6805           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6806         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6807         COMPUTE WS-CSO-ORIG-AH-PORT =
  6808           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6809         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6810         COMPUTE WS-CSO-ORIG-PORTION =
  6811            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6812         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6813
  6814         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6815                                   OUT-ACCT-NEW-ALT-LF-PORT
  6816         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6817           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6818         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6819         COMPUTE WS-ACCT-NEW-AH-PORT =
  6820           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6821         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6822         COMPUTE WS-ACCT-NEW-PORTION =
  6823            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6824         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6825
  6826         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6827                                   OUT-CSO-NEW-ALT-LF-PORT
  6828         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6829           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6830         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6831         COMPUTE WS-CSO-NEW-AH-PORT =
  6832           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6833         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6834         COMPUTE WS-CSO-NEW-PORTION =
  6835            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6836         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6837
  6838         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6839                                    OUT-ACCT-ALT-LF-PORT-CHG
  6840         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6841            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6842         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6843         COMPUTE WS-ACCT-AH-PORT-CHG =
  6844            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6845         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6846         COMPUTE WS-ACCT-PORTION-CHG =
  6847            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6848         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6849
  6850         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6851                                    OUT-CSO-ALT-LF-PORT-CHG
  6852         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6853            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6854         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6855         COMPUTE WS-CSO-AH-PORT-CHG =
  6856            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6857         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 120
* NSRASBL.cbl
  6858         COMPUTE WS-CSO-PORTION-CHG =
  6859            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6860         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6861
  6862     END-IF
  6863     .
  6864 0620-CONTINUE.
  6865     display ' about to bld reason codes ' en-reason-code (1)
  6866     move en-reason-code (1)     to out-rea-cd1
  6867     move en-reason-code (2)     to out-rea-cd2
  6868     move en-reason-code (3)     to out-rea-cd3
  6869     move en-reason-code (4)     to out-rea-cd4
  6870     move en-reason-code (5)     to out-rea-cd5
  6871     move en-reason-code (6)     to out-rea-cd6
  6872     move en-reason-code (7)     to out-rea-cd7
  6873     move en-reason-code (8)     to out-rea-cd8
  6874     move en-reason-code (9)     to out-rea-cd9
  6875     move en-reason-code (10)    to out-rea-cd10
  6876     move en-reason-code (11)    to out-rea-cd11
  6877     move en-reason-code (12)    to out-rea-cd12
  6878*    PERFORM 1300-DETERMINE-COMM
  6879*                                THRU 1300-EXIT
  6880     .
  6881 0620-EXIT.
  6882     EXIT.
  6883 0650-PROCESS-NO-Change.
  6884     IF EN-REC-TYPE = 'C'
  6885        GO TO 0650-PROCESS-CANCEL
  6886     END-IF
  6887     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6888        AND (OUT-NEW-ILNAME NOT = SPACES))
  6889                      AND
  6890        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6891        AND (OUT-NEW-IFNAME NOT = SPACES))
  6892                      AND
  6893        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6894        AND (OUT-NEW-IFNAME NOT = SPACES))
  6895        move 'No Change'         to out-new-Ifname
  6896        MOVE SPACES              TO OUT-NEW-IMINIT
  6897        move spaces              to out-new-Ilname
  6898     ELSE
  6899         IF OUT-NEW-ILNAME = SPACES
  6900           AND OUT-NEW-IFNAME = SPACES
  6901           AND OUT-NEW-IMINIT = SPACES
  6902           AND OUT-ORIG-ILNAME NOT = SPACES
  6903            MOVE 'None'          TO OUT-NEW-IFNAME
  6904            MOVE SPACES          TO OUT-NEW-IMINIT
  6905            MOVE SPACES          TO OUT-NEW-ILNAME
  6906         END-IF
  6907     END-IF
  6908     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6909        AND (OUT-NEW-JLNAME NOT = SPACES))
  6910                    AND
  6911        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6912        AND (OUT-NEW-JFNAME NOT = SPACES))
  6913                    AND
  6914        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6915        AND (OUT-NEW-JFNAME NOT = SPACES))
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 121
* NSRASBL.cbl
  6916        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6917        MOVE SPACES              TO OUT-NEW-JMINIT
  6918        MOVE SPACES              TO OUT-NEW-JLNAME
  6919     ELSE
  6920         IF OUT-NEW-JLNAME = SPACES
  6921           AND OUT-NEW-JFNAME = SPACES
  6922           AND OUT-NEW-JMINIT = SPACES
  6923           AND OUT-ORIG-JLNAME NOT = SPACES
  6924            MOVE 'None'          TO OUT-NEW-JFNAME
  6925            MOVE SPACES          TO OUT-NEW-JMINIT
  6926            MOVE SPACES          TO OUT-NEW-JLNAME
  6927         END-IF
  6928     END-IF
  6929     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6930        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6931        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6932     ELSE
  6933         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6934           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6935             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6936         END-IF
  6937     END-IF
  6938     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6939        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6940        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6941     ELSE
  6942         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6943           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6944             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6945         END-IF
  6946     END-IF
  6947     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6948        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6949        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6950     ELSE
  6951         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6952           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6953             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6954         END-IF
  6955     END-IF
  6956     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6957        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6958        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6959     ELSE
  6960         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6961           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6962             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6963         END-IF
  6964     END-IF
  6965
  6966     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6967                              EN-LF-ORIG-ALT-PRM-AMT
  6968     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6969                               EN-LF-NEW-ALT-PRM-AMT
  6970     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6971        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6972        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6973     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 122
* NSRASBL.cbl
  6974         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6975           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6976            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6977         END-IF
  6978     END-IF
  6979     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6980        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6981     END-IF
  6982     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6983        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6984        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6985     END-IF
  6986     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6987        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6988        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6989     ELSE
  6990        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6991          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6992            MOVE 'None'          TO OUT-NEW-LF-DESC
  6993        END-IF
  6994     end-if
  6995     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6996       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6997        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6998     END-IF
  6999     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  7000        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  7001        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  7002     ELSE
  7003         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7004           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7005             MOVE ZEROS          TO OUT-NEW-AH-BEN
  7006         END-IF
  7007     END-IF
  7008     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  7009        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  7010        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  7011     ELSE
  7012         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7013           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7014             MOVE ZEROS          TO OUT-NEW-AH-PRM
  7015         END-IF
  7016     END-IF
  7017     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  7018        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  7019        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  7020     ELSE
  7021         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7022           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7023             MOVE 'None'         TO OUT-NEW-AH-DESC
  7024         END-IF
  7025     END-IF
  7026     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  7027         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  7028     END-IF
  7029     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  7030         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  7031     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 123
* NSRASBL.cbl
  7032     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
  7033         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  7034     END-IF
  7035     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  7036         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  7037     END-IF
  7038
  7039     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  7040       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  7041       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  7042       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  7043       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  7044       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  7045        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  7046     END-IF
  7047     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  7048        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  7049        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  7050        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  7051        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  7052        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  7053        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  7054        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  7055     ELSE
  7056         IF (EN-JNT-ORIG-AGE > ZEROS)
  7057           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  7058           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  7059             MOVE 'None'         TO OUT-NEW-JAGE-A
  7060         END-IF
  7061     END-IF
  7062     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  7063        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  7064        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  7065     ELSE
  7066         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  7067           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  7068             MOVE ZEROS          TO OUT-NEW-LF-TERM
  7069         END-IF
  7070     END-IF
  7071     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  7072        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  7073        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  7074     ELSE
  7075         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7076           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7077             MOVE ZEROS          TO OUT-NEW-AH-TERM
  7078         END-IF
  7079     END-IF
  7080     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  7081        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  7082        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  7083                                    OUT-NEW-MAX-PMTS-A
  7084     ELSE
  7085         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7086           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7087             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  7088                                    OUT-NEW-MAX-PMTS-A
  7089         END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 124
* NSRASBL.cbl
  7090     END-IF
  7091     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  7092        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  7093     END-IF
  7094     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  7095       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  7096         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  7097     ELSE
  7098         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7099           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7100             MOVE 'None'         TO OUT-NEW-WAIT-PER
  7101         END-IF
  7102     END-IF
  7103     .
  7104 0650-PROCESS-CANCEL.
  7105     .
  7106 0650-EXIT.
  7107     EXIT.
  7108 0700-WRITE-EXTR.
  7109     display ' made it to 0700 '
  7110     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  7111     IF BL-FAIL
  7112        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  7113        GO TO 0700-EXIT
  7114     END-IF
  7115     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  7116     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  7117     MOVE +0                     TO NSAS-SEQ-NO
  7118     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  7119     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  7120     IF BL-FAIL
  7121        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  7122        GO TO 0700-EXIT
  7123     END-IF
  7124     IF W-LETTER-TO-ACCT NOT = SPACES
  7125        display ' acct ne spaces ' bl-archive-no
  7126        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  7127        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7128        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7129        MOVE +1                  TO NSAS-SEQ-NO
  7130        PERFORM 0720-WRITE-NSASEXTR
  7131                                 THRU 0720-EXIT
  7132        IF BL-FAIL
  7133           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  7134           GO TO 0700-EXIT
  7135        END-IF
  7136     END-IF
  7137     IF W-LETTER-TO-BENE NOT = SPACES
  7138        display ' bene ne spaces ' bl-archive-no
  7139        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  7140        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7141        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7142        MOVE +2                  TO NSAS-SEQ-NO
  7143        PERFORM 0720-WRITE-NSASEXTR
  7144                                 THRU 0720-EXIT
  7145        IF BL-FAIL
  7146           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  7147        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 125
* NSRASBL.cbl
  7148     END-IF
  7149     IF W-PRINT-CERTIFICATE = 'Y' AND
  7150        BL-STATE = 'VA'
  7151           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  7152           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  7153           MOVE BL-CARRIER          TO VD-CARRIER
  7154           MOVE BL-GROUP            TO VD-GROUPING
  7155           MOVE BL-STATE            TO VD-STATE
  7156           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  7157           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  7158           MOVE BL-CERT-NO          TO VD-CERT-NO
  7159           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  7160           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  7161           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  7162           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  7163           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  7164           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  7165           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  7166           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  7167           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  7168           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  7169           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  7170           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  7171           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  7172           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  7173           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  7174           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  7175           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  7176           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  7177           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  7178           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  7179           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  7180           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  7181           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  7182           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  7183           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  7184           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  7185           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  7186           MOVE 'VADS'              TO VD-LETTER-ID
  7187           MOVE OUT-PROC-ID         TO VD-PROC-ID
  7188           MOVE BL-COMP-ID          TO VD-COMP-ID
  7189           MOVE EIBTIME             TO VD-CURRENT-TIME
  7190           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  7191           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  7192           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  7193
  7194* EXEC CICS LINK
  7195*              PROGRAM    (LINK-ELVADS)
  7196*              COMMAREA   (WS-PASS-AREA)
  7197*              LENGTH     (WS-PASS-AREA-LENGTH)
  7198*          END-EXEC
  7199*    MOVE '."C                   (   #00007045' TO DFHEIV0
  7200     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7201     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7202     MOVE X'2020233030303037303435' TO DFHEIV0(25:11)
  7203     CALL 'kxdfhei1' USING DFHEIV0,
  7204           LINK-ELVADS,
  7205           WS-PASS-AREA,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 126
* NSRASBL.cbl
  7206           WS-PASS-AREA-LENGTH,
  7207           DFHEIV99,
  7208           DFHEIV99,
  7209           DFHEIV99,
  7210           DFHEIV99
  7211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7212     END-IF
  7213     .
  7214 0700-EXIT.
  7215     EXIT.
  7216  0710-BUILD-NSASEXTR.
  7217***  i added the extra space in front of the 1st ~
  7218***  only because there may be a letter to acct or bene
  7219     STRING
  7220         OUT-LETTER             ' ~'
  7221         OUT-PROC-ID            '~'
  7222         OUT-PROC-NAME          '~'
  7223         OUT-PROC-TITLE         '~'
  7224         OUT-CSR-NAME           '~'
  7225         OUT-CSR-TITLE          '~'
  7226         OUT-CARRIER            '~'
  7227         OUT-GROUPING           '~'
  7228         OUT-STATE              '~'
  7229         OUT-ACCOUNT            '~'
  7230         OUT-CERT-EFF-DT        '~'
  7231         OUT-CERT-NO            '~'
  7232         OUT-CERT-SFX           '~'
  7233         OUT-ILNAME             '~'
  7234         OUT-IFNAME             '~'
  7235         OUT-IFINIT             '~'
  7236         OUT-IMINIT             '~'
  7237         OUT-IAGE               '~'
  7238         OUT-ISEX               '~'
  7239         OUT-INS-ADDR1          '~'
  7240         OUT-INS-ADDR2          '~'
  7241         OUT-INS-CITY           '~'
  7242         OUT-INS-STATE          '~'
  7243         OUT-INS-ZIP            '~'
  7244         OUT-SOC-SEC-NO         '~'
  7245         OUT-MEMBER-NO          '~'
  7246         OUT-JLNAME             '~'
  7247         OUT-JFNAME             '~'
  7248         OUT-JMINIT             '~'
  7249         OUT-JAGE               '~'
  7250         OUT-ACCT-NAME          '~'
  7251         OUT-ACCT-ADDR1         '~'
  7252         OUT-ACCT-ADDR2         '~'
  7253         OUT-ACCT-CITY          '~'
  7254         OUT-ACCT-STATE         '~'
  7255         OUT-ACCT-ZIP           '~'
  7256         OUT-ACCT-PHONE         '~'
  7257         OUT-ACCT-CNTRL-NAME    '~'
  7258         OUT-ACCT-BUS-TYPE      '~'
  7259         OUT-BENE-NAME          '~'
  7260         OUT-BENE-ADDR1         '~'
  7261         OUT-BENE-ADDR2         '~'
  7262         OUT-BENE-CITY          '~'
  7263         OUT-BENE-STATE         '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 127
* NSRASBL.cbl
  7264         OUT-BENE-ZIP           '~'
  7265         OUT-CARR-NAME          '~'
  7266         OUT-RESP-NO            '~'
  7267         OUT-COMP-NAME          '~'
  7268         OUT-COMP-MAIL-TO       '~'
  7269         OUT-COMP-ADDR1         '~'
  7270         OUT-COMP-ADDR2         '~'
  7271         OUT-COMP-CITY          '~'
  7272         OUT-COMP-STATE         '~'
  7273         OUT-COMP-ZIP           '~'
  7274         OUT-COMP-PHONE         '~'
  7275         OUT-COMP-FAX           '~'
  7276         OUT-COMP-STATUS        '~'
  7277         OUT-BILL-SW            '~'
  7278         OUT-RPT-CD1            '~'
  7279         OUT-RPT-CD2            '~'
  7280         OUT-ENTRY-DT           '~'
  7281         OUT-ENTRY-BATCH        '~'
  7282         OUT-ENTRY-STATUS       '~'
  7283         OUT-1ST-PMT-DT         '~'
  7284         OUT-LOAN-APR           '~'
  7285         OUT-LOAN-TERM          '~'
  7286         OUT-RATE-CLASS         '~'
  7287         OUT-EXT-DAYS           '~'
  7288         OUT-CSR-CODE           '~'
  7289         OUT-UCODE              '~'
  7290         OUT-PREM-TYPE          '~'
  7291         OUT-IND-GRP            '~'
  7292         OUT-SKIP-CD            '~'
  7293         OUT-PMT-MODE           '~'
  7294         OUT-LOAN-OFF           '~'
  7295         OUT-REIN-TABLE         '~'
  7296         OUT-SPEC-REIN          '~'
  7297         OUT-LF-BENCD           '~'
  7298         OUT-LF-TERM            '~'
  7299         OUT-LF-DEV-CD          '~'
  7300         OUT-LF-DEV-PCT         '~'
  7301         OUT-LF-BEN             '~'
  7302         OUT-LF-PRM             '~'
  7303         OUT-LF-ALT-BEN         '~'
  7304         OUT-LF-ALT-PRM         '~'
  7305         OUT-LF-NSP             '~'
  7306         OUT-LF-REM-BEN         '~'
  7307         OUT-LF-REF             '~'
  7308         OUT-LF-DTH             '~'
  7309         OUT-LF-RATE            '~'
  7310         OUT-LF-ALT-RATE        '~'
  7311         OUT-LF-EXP-DT          '~'
  7312         OUT-LF-CUR-STATUS      '~'
  7313         OUT-LF-CAN-DT          '~'
  7314         OUT-LF-CAN-EXIT-DT     '~'
  7315         OUT-LF-DTH-DT          '~'
  7316         OUT-LF-DTH-EXIT-DT     '~'
  7317         OUT-LF-EXIT-BATCH      '~'
  7318         OUT-LF-COMM-PCT        '~'
  7319         OUT-LF-DESC            '~'
  7320         OUT-LF-ABBRV           '~'
  7321         OUT-AH-BENCD           '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 128
* NSRASBL.cbl
  7322         OUT-AH-TERM            '~'
  7323         OUT-CRIT-PER           '~'
  7324         OUT-AH-DEV-CD          '~'
  7325         OUT-AH-DEV-PCT         '~'
  7326         OUT-AH-BEN             '~'
  7327         OUT-AH-PRM             '~'
  7328         OUT-AH-NSP             '~'
  7329         OUT-AH-REF             '~'
  7330         OUT-AH-CLM             '~'
  7331         OUT-AH-TOT-BEN         '~'
  7332         OUT-AH-PDTHRU-DT       '~'
  7333         OUT-AH-RATE            '~'
  7334         OUT-AH-EXP-DT          '~'
  7335         OUT-AH-CUR-STATUS      '~'
  7336         OUT-AH-CAN-DT          '~'
  7337         OUT-AH-CAN-EXIT-DT     '~'
  7338         OUT-AH-EXIT-BATCH      '~'
  7339         OUT-AH-COMM-PCT        '~'
  7340         OUT-AH-DESC            '~'
  7341         OUT-RET-ELIM           '~'
  7342         OUT-BEN-DAYS           '~'
  7343         OUT-WAIT-PER           '~'
  7344         OUT-MAX-PMTS           '~'
  7345         OUT-TOT-PRM            '~'
  7346         OUT-TOT-REF            '~'
  7347         OUT-SCHED-EXP-DT       '~'
  7348         OUT-SCHED-TERM         '~'
  7349         OUT-ORIG-ILNAME        '~'
  7350         OUT-ORIG-IFNAME        '~'
  7351         OUT-ORIG-MINIT         '~'
  7352         OUT-ORIG-IAGE          '~'
  7353         OUT-ORIG-JLNAME        '~'
  7354         OUT-ORIG-JFNAME        '~'
  7355         OUT-ORIG-JMINIT        '~'
  7356         OUT-ORIG-JAGE          '~'
  7357         OUT-ORIG-LF-BENCD      '~'
  7358         OUT-ORIG-LF-TERM       '~'
  7359         OUT-ORIG-LF-BEN        '~'
  7360         OUT-ORIG-LF-PRM        '~'
  7361         OUT-LF-CALC-PRM        '~'
  7362         OUT-ORIG-LF-REF        '~'
  7363         OUT-LF-CALC-REF        '~'
  7364         OUT-ORIG-LF-ALT-BEN    '~'
  7365         OUT-ORIG-LF-ALT-PRM    '~'
  7366         OUT-ORIG-LF-EXP-DT     '~'
  7367         OUT-ORIG-LF-DESC       '~'
  7368         OUT-ORIG-AH-BENCD      '~'
  7369         OUT-ORIG-AH-TERM       '~'
  7370         OUT-ORIG-CRIT-PER      '~'
  7371         OUT-ORIG-AH-BEN        '~'
  7372         OUT-ORIG-AH-PRM        '~'
  7373         OUT-AH-CALC-PRM        '~'
  7374         OUT-ORIG-AH-REF        '~'
  7375         OUT-AH-CALC-REF        '~'
  7376         OUT-ORIG-AH-EXP-DT     '~'
  7377         OUT-ORIG-AH-DESC       '~'
  7378         OUT-ORIG-RET-ELIM      '~'
  7379         OUT-ORIG-BEN-DAYS      '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 129
* NSRASBL.cbl
  7380         OUT-ORIG-WAIT-PER      '~'
  7381         OUT-ORIG-MAX-PMTS      '~'
  7382         OUT-ORIG-SCHED-EXP-DT  '~'
  7383         OUT-ORIG-SCHED-TERM    '~'
  7384         OUT-NEW-ILNAME         '~'
  7385         OUT-NEW-IFNAME         '~'
  7386         OUT-NEW-IMINIT         '~'
  7387         OUT-NEW-IAGE           '~'
  7388         OUT-NEW-JLNAME         '~'
  7389         OUT-NEW-JFNAME         '~'
  7390         OUT-NEW-JMINIT         '~'
  7391         OUT-NEW-JAGE           '~'
  7392         OUT-NEW-LF-BENCD       '~'
  7393         OUT-NEW-LF-TERM        '~'
  7394         OUT-NEW-LF-BEN         '~'
  7395         OUT-NEW-LF-PRM         '~'
  7396         OUT-NEW-LF-REF         '~'
  7397         OUT-NEW-LF-ALT-BEN     '~'
  7398         OUT-NEW-LF-ALT-PRM     '~'
  7399         OUT-NEW-LF-EXP-DT      '~'
  7400         OUT-NEW-LF-DESC        '~'
  7401         OUT-NEW-AH-BENCD       '~'
  7402         OUT-NEW-AH-TERM        '~'
  7403         OUT-NEW-CRIT-PER       '~'
  7404         OUT-NEW-AH-BEN         '~'
  7405         OUT-NEW-AH-PRM         '~'
  7406         OUT-NEW-AH-REF         '~'
  7407         OUT-NEW-AH-EXP-DT      '~'
  7408         OUT-NEW-AH-DESC        '~'
  7409         OUT-NEW-RET-ELIM       '~'
  7410         OUT-NEW-BEN-DAYS       '~'
  7411         OUT-NEW-WAIT-PER       '~'
  7412         OUT-NEW-MAX-PMTS       '~'
  7413         OUT-NEW-SCHED-EXP-DT   '~'
  7414         OUT-NEW-SCHED-TERM     '~'
  7415         OUT-TOT-PRM-CHG        '~'
  7416         OUT-TOT-REF-CHG        '~'
  7417         OUT-PAYEE              '~'
  7418         OUT-SIG-SW             '~'
  7419         OUT-BALLOON-IND        '~'
  7420         OUT-LEASE-IND          '~'
  7421         OUT-RESCIND            '~'
  7422         OUT-REA-CD1            '~'
  7423         OUT-REA-CD2            '~'
  7424         OUT-REA-CD3            '~'
  7425         OUT-REA-CD4            '~'
  7426         OUT-REA-CD5            '~'
  7427         OUT-REA-CD6            '~'
  7428         OUT-REA-CD7            '~'
  7429         OUT-REA-CD8            '~'
  7430         OUT-REA-CD9            '~'
  7431         OUT-REA-CD10           '~'
  7432         OUT-REA-CD11           '~'
  7433         OUT-REA-CD12           '~'
  7434         OUT-CYCLE-DT           '~'
  7435         OUT-ARCH-NO            '~'
  7436         OUT-FORM               '~'
  7437         OUT-ENC-LINE           '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 130
* NSRASBL.cbl
  7438         OUT-ATTACH             '~'
  7439         OUT-STACK              '~'
  7440         OUT-STATE-NAME         '~'
  7441         OUT-PRINT-NOW          '~'
  7442         OUT-CHGBACK            '~'
  7443         OUT-CSO-PORTION        '~'
  7444         OUT-ACCT-PORTION       '~'
  7445         OUT-LETTER-TYPE        '~'
  7446         OUT-PRINT-CERTIFICATE  '~'
  7447         OUT-INS-BIRTHDATE      '~'
  7448         OUT-JNT-BIRTHDATE      '~'
  7449         OUT-TOT-INTEREST       '~'
  7450         OUT-ORIG-TOT-PREM      '~'
  7451         OUT-ORIG-TOT-REF       '~'
  7452         OUT-CANCEL-DT          '~'
  7453         OUT-HEALTH-APP         '~'
  7454         OUT-CERTIFICATE-ID     '~'
  7455         OUT-UNDW-ID            '~'
  7456         OUT-NEW-TOT-PREM       '~'
  7457         OUT-NEW-TOT-REF        '~'
  7458         OUT-COVERAGE-IND       '~'
  7459         OUT-ORIG-COVERAGE-IND  '~'
  7460         OUT-NEW-COVERAGE-IND   '~'
  7461         OUT-LF-CMB-PREM        '~'
  7462         OUT-ORIG-LF-CMB-PREM   '~'
  7463         OUT-NEW-LF-CMB-PREM    '~'
  7464         OUT-LF-PREM-CHG        '~'
  7465         OUT-LF-ALT-PREM-CHG    '~'
  7466         OUT-LF-CMB-PREM-CHG    '~'
  7467         OUT-AH-PREM-CHG        '~'
  7468         OUT-LF-REF-CHG         '~'
  7469         OUT-AH-REF-CHG         '~'
  7470         OUT-ACCT-LF-PORTION    '~'
  7471         OUT-ACCT-ALT-LF-PORT   '~'
  7472         OUT-ACCT-CMB-LF-PORT   '~'
  7473         OUT-ACCT-AH-PORTION    '~'
  7474         OUT-CSO-LF-PORTION     '~'
  7475         OUT-CSO-ALT-LF-PORT    '~'
  7476         OUT-CSO-CMB-LF-PORT    '~'
  7477         OUT-CSO-AH-PORTION     '~'
  7478         OUT-ACCT-ORIG-LF-PORT  '~'
  7479         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7480         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7481         OUT-ACCT-ORIG-AH-PORT  '~'
  7482         OUT-ACCT-ORIG-PORTION  '~'
  7483         OUT-CSO-ORIG-LF-PORT   '~'
  7484         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7485         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7486         OUT-CSO-ORIG-AH-PORT   '~'
  7487         OUT-CSO-ORIG-PORTION   '~'
  7488         OUT-ACCT-NEW-LF-PORT   '~'
  7489         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7490         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7491         OUT-ACCT-NEW-AH-PORT   '~'
  7492         OUT-ACCT-NEW-PORTION   '~'
  7493         OUT-CSO-NEW-LF-PORT    '~'
  7494         OUT-CSO-NEW-ALT-LF-PORT '~'
  7495         OUT-CSO-NEW-CMB-LF-PORT '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 131
* NSRASBL.cbl
  7496         OUT-CSO-NEW-AH-PORT    '~'
  7497         OUT-CSO-NEW-PORTION    '~'
  7498         OUT-ACCT-LF-PORT-CHG   '~'
  7499         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7500         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7501         OUT-ACCT-AH-PORT-CHG   '~'
  7502         OUT-ACCT-PORTION-CHG   '~'
  7503         OUT-CSO-LF-PORT-CHG    '~'
  7504         OUT-CSO-ALT-LF-PORT-CHG '~'
  7505         OUT-CSO-CMB-LF-PORT-CHG '~'
  7506         OUT-CSO-AH-PORT-CHG    '~'
  7507         OUT-CSO-PORTION-CHG    '~'
  7508         OUT-ORIG-LF-CAN-DT     '~'
  7509         OUT-NEW-LF-CAN-DT      '~'
  7510         OUT-ORIG-AH-CAN-DT     '~'
  7511         OUT-NEW-AH-CAN-DT      '~'
  7512         OUT-ORIG-CAN-DT        '~'
  7513         OUT-NEW-CAN-DT         '~'
  7514         OUT-SCREEN-ID          '~'
  7515         OUT-NEXT-BUS-DT        '~'
  7516         OUT-VIN-NUMBER         '~'
  7517            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7518     END-STRING
  7519     .
  7520 0710-exit.
  7521     EXIT.
  7522 0720-WRITE-NSASEXTR.
  7523
  7524* EXEC CICS WRITE
  7525*       DATASET    ('NSASEXTR')
  7526*       FROM       (NSAS-EXTRACT-RECORD)
  7527*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7528*       RESP       (WS-RESPONSE)
  7529*    END-EXEC
  7530     MOVE LENGTH OF
  7531      NSAS-EXTRACT-RECORD
  7532       TO DFHEIV11
  7533     MOVE 'NSASEXTR' TO DFHEIV1
  7534*    MOVE '&$ L                  ''  N#00007361' TO DFHEIV0
  7535     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7536     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7537     MOVE X'204E233030303037333631' TO DFHEIV0(25:11)
  7538     CALL 'kxdfhei1' USING DFHEIV0,
  7539           DFHEIV1,
  7540           NSAS-EXTRACT-RECORD,
  7541           DFHEIV11,
  7542           NSAS-CONTROL-PRIMARY,
  7543           DFHEIV99,
  7544           DFHEIV99
  7545     MOVE EIBRESP  TO WS-RESPONSE
  7546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7547     IF NOT RESP-NORMAL
  7548        display ' bad write nsasextr ' ws-response
  7549        SET BL-FAIL TO TRUE
  7550     END-IF
  7551     .
  7552 0720-EXIT.
  7553     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 132
* NSRASBL.cbl
  7554 0800-init-out-data.
  7555     MOVE ZEROS                  TO OUT-IAGE
  7556                                    OUT-JAGE
  7557                                    OUT-LOAN-APR
  7558                                    OUT-LOAN-TERM
  7559                                    OUT-EXT-DAYS
  7560                                    OUT-LF-TERM
  7561                                    OUT-AH-TERM
  7562                                    OUT-LF-DEV-PCT
  7563                                    OUT-AH-DEV-PCT
  7564                                    OUT-LF-BEN
  7565                                    OUT-AH-BEN
  7566                                    OUT-CRIT-PER
  7567                                    OUT-MAX-PMTS
  7568                                    OUT-SCHED-TERM
  7569                                    OUT-ORIG-IAGE
  7570                                    OUT-ORIG-JAGE
  7571                                    OUT-NEW-IAGE
  7572                                    OUT-NEW-JAGE
  7573                                    OUT-ORIG-LF-TERM
  7574                                    OUT-ORIG-AH-TERM
  7575                                    OUT-NEW-LF-TERM
  7576                                    OUT-NEW-AH-TERM
  7577                                    OUT-ORIG-CRIT-PER
  7578                                    OUT-ORIG-MAX-PMTS
  7579                                    OUT-ORIG-SCHED-TERM
  7580                                    OUT-NEW-SCHED-TERM
  7581                                    OUT-NEW-CRIT-PER
  7582                                    OUT-NEW-MAX-PMTS
  7583                                    OUT-CSO-PORTION
  7584                                    OUT-CSO-LF-PORTION
  7585                                    OUT-CSO-ALT-LF-PORT
  7586                                    OUT-CSO-CMB-LF-PORT
  7587                                    OUT-CSO-AH-PORTION
  7588                                    OUT-ACCT-PORTION
  7589                                    OUT-ACCT-LF-PORTION
  7590                                    OUT-ACCT-ALT-LF-PORT
  7591                                    OUT-ACCT-CMB-LF-PORT
  7592                                    OUT-ACCT-AH-PORTION
  7593                                    OUT-LF-PREM-CHG
  7594                                    OUT-LF-ALT-PREM-CHG
  7595                                    OUT-LF-CMB-PREM-CHG
  7596                                    OUT-AH-PREM-CHG
  7597                                    OUT-LF-REF-CHG
  7598                                    OUT-AH-REF-CHG
  7599     .
  7600 0800-exit.
  7601     exit.
  7602 1000-BUILD-ERARCH.
  7603* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7604*    1) FROM ACCT MAINT
  7605*    2) FROM CERT UPDATE
  7606*    3) FROM COMP MAINT
  7607*    4) FROM REVIEW AND CORRECTIONS
  7608******************************************************************
  7609     MOVE 'LA'                   TO LETTER-ARCHIVE
  7610     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7611                                    LA-ARCHIVE-NO-A2
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 133
* NSRASBL.cbl
  7612                                    LA-ARCHIVE-NO-A3
  7613                                    LA-ARCHIVE-NO-A4
  7614                                    LA-ARCHIVE-NO-A5
  7615                                    LA-ARCHIVE-NO-A6
  7616     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7617                                    LA-COMPANY-CD-A2
  7618                                    LA-COMPANY-CD-A3
  7619                                    LA-COMPANY-CD-A4
  7620                                    LA-COMPANY-CD-A5
  7621                                    LA-COMPANY-CD-A6
  7622     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7623                                    LA-CARRIER-A3
  7624                                    LA-CARRIER-A4
  7625                                    LA-CARRIER-A5
  7626     MOVE BL-GROUP               TO LA-GROUPING-A2
  7627                                    LA-GROUPING-A3
  7628                                    LA-GROUPING-A4
  7629                                    LA-GROUPING-A5
  7630     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7631                                    LA-ACCOUNT-A3
  7632                                    LA-ACCOUNT-A4
  7633                                    LA-ACCOUNT-A5
  7634     MOVE BL-STATE               TO LA-STATE-A2
  7635                                    LA-STATE-A3
  7636                                    LA-STATE-A4
  7637                                    LA-STATE-A5
  7638     IF BL-DATA-SRCE = '2' OR '4'
  7639        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7640        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7641     ELSE
  7642        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7643     END-IF
  7644     IF BL-DATA-SRCE = '4'
  7645        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7646     END-IF
  7647     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7648                                    LA-LAST-UPDATED-BY
  7649     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7650                                    LA-INITIAL-PRINT-DATE
  7651                                    LA-SENT-DATE
  7652                                    LA-REPLY-DATE
  7653                                    LA-RESEND-DATE
  7654                                    LA-FOLLOW-UP-DATE
  7655     MOVE 'A'                    TO LA-STATUS
  7656     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7657     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7658     IF W-DAYS-TO-RESEND NOT NUMERIC
  7659        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7660     END-IF
  7661     IF W-DAYS-TO-RESEND > ZEROS
  7662        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7663        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7664        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7665        MOVE '6'                 TO DC-OPTION-CODE
  7666        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7667        IF NO-CONVERSION-ERROR
  7668           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7669        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 134
* NSRASBL.cbl
  7670     END-IF
  7671     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7672        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7673        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7674        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7675        MOVE '6'                 TO DC-OPTION-CODE
  7676        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7677        IF NO-CONVERSION-ERROR
  7678           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7679        END-IF
  7680     END-IF
  7681
  7682     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7683     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7684     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7685     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7686     IF BL-ENDT-ARCH-NO > ZEROS
  7687        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7688     ELSE
  7689        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7690     END-IF
  7691     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7692                                    LA-LAST-MAINT-DATE
  7693     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7694                                    LA-NO-OF-TEXT-RECORDS
  7695     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7696
  7697* EXEC CICS WRITE
  7698*         DATASET   ('ERARCH')
  7699*         FROM      (LETTER-ARCHIVE)
  7700*         RIDFLD    (LA-CONTROL-PRIMARY)
  7701*         RESP      (WS-RESPONSE)
  7702*    END-EXEC
  7703     MOVE LENGTH OF
  7704      LETTER-ARCHIVE
  7705       TO DFHEIV11
  7706     MOVE 'ERARCH' TO DFHEIV1
  7707*    MOVE '&$ L                  ''  N#00007516' TO DFHEIV0
  7708     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7709     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7710     MOVE X'204E233030303037353136' TO DFHEIV0(25:11)
  7711     CALL 'kxdfhei1' USING DFHEIV0,
  7712           DFHEIV1,
  7713           LETTER-ARCHIVE,
  7714           DFHEIV11,
  7715           LA-CONTROL-PRIMARY,
  7716           DFHEIV99,
  7717           DFHEIV99
  7718     MOVE EIBRESP  TO WS-RESPONSE
  7719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7720     IF NOT RESP-NORMAL
  7721        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7722        la-archive-no
  7723        SET BL-FAIL TO TRUE
  7724     END-IF
  7725     .
  7726 1000-EXIT.
  7727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 135
* NSRASBL.cbl
  7728 1025-GET-CSR-INFO.
  7729     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7730                                    OUT-CSR-TITLE
  7731                                    OUT-PROC-TITLE
  7732                                    OUT-UNDW-ID
  7733     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7734     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7735     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7736     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7737
  7738* EXEC CICS READ
  7739*       INTO    (CONTROL-FILE)
  7740*       DATASET ('ELCNTL')
  7741*       RIDFLD  (WS-ELCNTL-KEY)
  7742*       RESP    (WS-RESPONSE)
  7743*    END-EXEC
  7744     MOVE LENGTH OF
  7745      CONTROL-FILE
  7746       TO DFHEIV11
  7747     MOVE 'ELCNTL' TO DFHEIV1
  7748*    MOVE '&"IL       E          (  N#00007539' TO DFHEIV0
  7749     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7751     MOVE X'204E233030303037353339' TO DFHEIV0(25:11)
  7752     CALL 'kxdfhei1' USING DFHEIV0,
  7753           DFHEIV1,
  7754           CONTROL-FILE,
  7755           DFHEIV11,
  7756           WS-ELCNTL-KEY,
  7757           DFHEIV99,
  7758           DFHEIV99,
  7759           DFHEIV99
  7760     MOVE EIBRESP  TO WS-RESPONSE
  7761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7762     IF RESP-NORMAL
  7763        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7764                                    OUT-PROC-NAME
  7765*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7766*                                   OUT-PROC-TITLE
  7767     END-IF
  7768     IF BL-PROC-ID NOT = PB-CSR-ID
  7769        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7770        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7771        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7772                                    OUT-PROC-TITLE
  7773        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7774
  7775* EXEC CICS READ
  7776*          INTO    (CONTROL-FILE)
  7777*          DATASET ('ELCNTL')
  7778*          RIDFLD  (WS-ELCNTL-KEY)
  7779*          RESP    (WS-RESPONSE)
  7780*       END-EXEC
  7781     MOVE LENGTH OF
  7782      CONTROL-FILE
  7783       TO DFHEIV11
  7784     MOVE 'ELCNTL' TO DFHEIV1
  7785*    MOVE '&"IL       E          (  N#00007557' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 136
* NSRASBL.cbl
  7786     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7787     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7788     MOVE X'204E233030303037353537' TO DFHEIV0(25:11)
  7789     CALL 'kxdfhei1' USING DFHEIV0,
  7790           DFHEIV1,
  7791           CONTROL-FILE,
  7792           DFHEIV11,
  7793           WS-ELCNTL-KEY,
  7794           DFHEIV99,
  7795           DFHEIV99,
  7796           DFHEIV99
  7797     MOVE EIBRESP  TO WS-RESPONSE
  7798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7799        IF RESP-NORMAL
  7800           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7801*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7802        END-IF
  7803     END-IF
  7804     .
  7805 1025-EXIT.
  7806     EXIT.
  7807 1050-GET-ERMAIL.
  7808     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7809
  7810* EXEC CICS READ
  7811*         DATASET    ('ERMAIL')
  7812*         INTO       (MAILING-DATA)
  7813*         RIDFLD     (WS-ERMAIL-KEY)
  7814*         RESP       (WS-RESPONSE)
  7815*    END-EXEC
  7816     MOVE LENGTH OF
  7817      MAILING-DATA
  7818       TO DFHEIV11
  7819     MOVE 'ERMAIL' TO DFHEIV1
  7820*    MOVE '&"IL       E          (  N#00007573' TO DFHEIV0
  7821     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7823     MOVE X'204E233030303037353733' TO DFHEIV0(25:11)
  7824     CALL 'kxdfhei1' USING DFHEIV0,
  7825           DFHEIV1,
  7826           MAILING-DATA,
  7827           DFHEIV11,
  7828           WS-ERMAIL-KEY,
  7829           DFHEIV99,
  7830           DFHEIV99,
  7831           DFHEIV99
  7832     MOVE EIBRESP  TO WS-RESPONSE
  7833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7834     IF RESP-NORMAL
  7835        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7836        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7837        MOVE MA-CITY             TO OUT-INS-CITY
  7838        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7839        MOVE MA-ZIP              TO OUT-INS-ZIP
  7840        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7841        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7842        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7843        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 137
* NSRASBL.cbl
  7844        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7845        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7846        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7847           MOVE MA-INSURED-BIRTH-DT
  7848                                 TO DC-BIN-DATE-1
  7849           MOVE ' '              TO DC-OPTION-CODE
  7850           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7851           IF NO-CONVERSION-ERROR
  7852              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7853                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7854                INTO OUT-INS-BIRTHDATE
  7855              END-STRING
  7856           END-IF
  7857        END-IF
  7858        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7859           MOVE MA-JOINT-BIRTH-DT
  7860                                 TO DC-BIN-DATE-1
  7861           MOVE ' '              TO DC-OPTION-CODE
  7862           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7863           IF NO-CONVERSION-ERROR
  7864              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7865                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7866                INTO OUT-JNT-BIRTHDATE
  7867              END-STRING
  7868           END-IF
  7869        END-IF
  7870     END-IF
  7871     .
  7872 1050-EXIT.
  7873     EXIT.
  7874 1100-GET-ELCERT.
  7875
  7876* EXEC CICS READ
  7877*         DATASET    ('ELCERT')
  7878*         INTO       (CERTIFICATE-MASTER)
  7879*         RIDFLD     (WS-ELCERT-KEY)
  7880*         RESP       (WS-RESPONSE)
  7881*    END-EXEC.
  7882     MOVE LENGTH OF
  7883      CERTIFICATE-MASTER
  7884       TO DFHEIV11
  7885     MOVE 'ELCERT' TO DFHEIV1
  7886*    MOVE '&"IL       E          (  N#00007620' TO DFHEIV0
  7887     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7889     MOVE X'204E233030303037363230' TO DFHEIV0(25:11)
  7890     CALL 'kxdfhei1' USING DFHEIV0,
  7891           DFHEIV1,
  7892           CERTIFICATE-MASTER,
  7893           DFHEIV11,
  7894           WS-ELCERT-KEY,
  7895           DFHEIV99,
  7896           DFHEIV99,
  7897           DFHEIV99
  7898     MOVE EIBRESP  TO WS-RESPONSE
  7899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7900
  7901     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 138
* NSRASBL.cbl
  7902        SET CERT-FOUND TO TRUE
  7903        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7904        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7905     END-IF
  7906     .
  7907 1100-EXIT.
  7908     EXIT.
  7909 1110-BUILD-CERT.
  7910     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7911     MOVE SPACES                 TO OUT-COVERAGE-IND
  7912     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7913     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7914     MOVE CM-CARRIER             TO OUT-CARRIER
  7915     MOVE CM-GROUPING            TO OUT-GROUPING
  7916     MOVE CM-STATE               TO OUT-STATE
  7917     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7918     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7919     MOVE ' '                    TO DC-OPTION-CODE
  7920     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7921     IF NO-CONVERSION-ERROR
  7922        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7923           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7924              INTO OUT-CERT-EFF-DT
  7925        END-STRING
  7926     END-IF
  7927     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7928     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7929                                    OUT-ORIG-ILNAME
  7930     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7931     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7932                                    OUT-ORIG-MINIT
  7933     IF (CM-SSN-STATE = CM-STATE)
  7934        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7935        MOVE SPACES              TO OUT-SOC-SEC-NO
  7936     ELSE
  7937        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7938     END-IF
  7939     IF (CM-MEMB-STATE = CM-STATE)
  7940        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7941        MOVE SPACES              TO OUT-MEMBER-NO
  7942     ELSE
  7943        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7944     END-IF
  7945     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7946                                    OUT-ORIG-IFNAME
  7947     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7948                                    OUT-ORIG-IAGE
  7949     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7950     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7951                                    OUT-ORIG-JAGE
  7952     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7953                                    OUT-ORIG-JLNAME
  7954     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7955                                    OUT-ORIG-JFNAME
  7956     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7957                                    OUT-ORIG-JMINIT
  7958     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7959                                    OUT-ORIG-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 139
* NSRASBL.cbl
  7960     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7961                                    OUT-ORIG-LF-TERM
  7962     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7963     IF CM-LF-DEV-PCT NOT NUMERIC
  7964        MOVE ZEROS               TO CM-LF-DEV-PCT
  7965     END-IF
  7966     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7967     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7968     IF NOT CERT-TRL-REC-NOT-FOUND
  7969         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7970             MOVE ZERO           TO OUT-IAGE
  7971                                    OUT-ORIG-IAGE
  7972         END-IF
  7973         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7974             MOVE ZERO           TO OUT-JAGE
  7975                                    OUT-ORIG-JAGE
  7976         END-IF
  7977         MOVE CS-VIN-NUMBER      TO OUT-VIN-NUMBER
  7978     END-IF
  7979
  7980     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7981        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7982          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7983           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7984             MOVE SPACES          TO OUT-LF-BENCD
  7985                                     WS-LF-BENCD
  7986                                     OUT-LF-CAN-DT
  7987             MOVE ZEROS           TO OUT-LF-TERM
  7988                                     OUT-LF-BEN
  7989                                     OUT-LF-PRM
  7990                                     OUT-LF-ALT-BEN
  7991                                     OUT-LF-ALT-PRM
  7992                                     OUT-LF-COMM-PCT
  7993                                     OUT-LF-NSP
  7994                                     OUT-LF-REM-BEN
  7995                                     WS-WORK-LF-PREM
  7996                                     WS-WORK-ALT-LF-PREM
  7997                                     WS-WORK-CMB-LF-PREM
  7998                                     OUT-LF-REF
  7999                                     OUT-ORIG-LF-REF
  8000                                     WS-WORK-LF-REF
  8001             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  8002             GO TO 1100-LF-CONT
  8003        END-IF
  8004     END-IF
  8005
  8006     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8007        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8008             MOVE SPACES          TO OUT-LF-BENCD
  8009                                     WS-LF-BENCD
  8010                                     OUT-LF-CAN-DT
  8011             MOVE ZEROS           TO OUT-LF-TERM
  8012                                     OUT-LF-BEN
  8013                                     OUT-LF-PRM
  8014                                     OUT-LF-ALT-BEN
  8015                                     OUT-LF-ALT-PRM
  8016                                     OUT-LF-COMM-PCT
  8017                                     OUT-LF-NSP
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 140
* NSRASBL.cbl
  8018                                     OUT-LF-REM-BEN
  8019                                     WS-WORK-LF-PREM
  8020                                     WS-WORK-ALT-LF-PREM
  8021                                     WS-WORK-CMB-LF-PREM
  8022                                     OUT-LF-REF
  8023                                     OUT-ORIG-LF-REF
  8024                                     WS-WORK-LF-REF
  8025             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  8026             GO TO 1100-LF-CONT
  8027        END-IF
  8028     END-IF
  8029     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  8030         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  8031                                    OUT-ORIG-COVERAGE-IND
  8032     END-IF
  8033
  8034     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  8035     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  8036                                    OUT-ORIG-LF-BEN
  8037     IF CM-LF-BENEFIT-AMT = 999999999.99
  8038        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  8039     END-IF
  8040     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  8041                                    OUT-ORIG-LF-PRM
  8042                                    WS-WORK-LF-PREM
  8043     IF CM-LF-PREMIUM-AMT = .01
  8044         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  8045     END-IF
  8046     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  8047        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  8048     END-IF
  8049     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  8050                                    OUT-ORIG-LF-ALT-BEN
  8051     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  8052        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  8053     END-IF
  8054     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  8055        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  8056     END-IF
  8057     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  8058                                    OUT-ORIG-LF-ALT-PRM
  8059                                    WS-WORK-ALT-LF-PREM
  8060     IF CM-LF-ALT-PREMIUM-AMT = .01
  8061         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  8062     END-IF
  8063     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  8064                             CM-LF-ALT-PREMIUM-AMT
  8065     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  8066                                 OUT-ORIG-LF-CMB-PREM
  8067                                 WS-WORK-CMB-LF-PREM
  8068     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  8069        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  8070     END-IF
  8071     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  8072     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  8073     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  8074                                    OUT-ORIG-LF-REF
  8075                                    WS-WORK-LF-REF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 141
* NSRASBL.cbl
  8076     IF CM-LF-DEATH-CLAIM-APPLIED
  8077        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8078            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  8079                                    OUT-ORIG-LF-REF
  8080                                    WS-WORK-LF-REF
  8081     END-IF
  8082     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8083     MOVE ' '                    TO DC-OPTION-CODE
  8084     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8085     IF NO-CONVERSION-ERROR
  8086        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8087           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8088              INTO OUT-LF-CAN-DT
  8089        END-STRING
  8090     END-IF
  8091
  8092     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8093         MOVE ZEROS          TO WS-WORK-LF-PREM
  8094                                WS-WORK-ALT-LF-PREM
  8095                                WS-WORK-CMB-LF-PREM
  8096     END-IF
  8097
  8098      .
  8099 1100-LF-CONT.
  8100
  8101     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  8102     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  8103        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  8104     END-IF
  8105     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  8106     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  8107        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  8108     END-IF
  8109     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  8110     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8111        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  8112          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8113              MOVE SPACES              TO OUT-AH-BENCD
  8114                                          WS-AH-BENCD
  8115                                          OUT-AH-CAN-DT
  8116              MOVE ZEROS               TO OUT-AH-TERM
  8117                                          OUT-AH-BEN
  8118                                          OUT-AH-PRM
  8119                                          OUT-AH-NSP
  8120                                          OUT-AH-COMM-PCT
  8121                                          OUT-CRIT-PER
  8122                                          WS-WORK-AH-PREM
  8123                                          OUT-AH-REF
  8124                                          OUT-ORIG-AH-REF
  8125                                          WS-WORK-AH-REF
  8126              MOVE SPACES              TO OUT-MAX-PMTS-A
  8127                                          OUT-WAIT-PER
  8128                                          OUT-RET-ELIM
  8129                                          OUT-AH-DESC
  8130                                          OUT-BEN-DAYS
  8131              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8132             GO TO 1100-AH-CONT
  8133        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 142
* NSRASBL.cbl
  8134     END-IF
  8135
  8136     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8137        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8138              MOVE SPACES              TO OUT-AH-BENCD
  8139                                          WS-AH-BENCD
  8140                                          OUT-AH-CAN-DT
  8141              MOVE ZEROS               TO OUT-AH-TERM
  8142                                          OUT-AH-BEN
  8143                                          OUT-AH-PRM
  8144                                          OUT-AH-NSP
  8145                                          OUT-AH-COMM-PCT
  8146                                          OUT-CRIT-PER
  8147                                          WS-WORK-AH-PREM
  8148                                          OUT-AH-REF
  8149                                          OUT-ORIG-AH-REF
  8150                                          WS-WORK-AH-REF
  8151              MOVE SPACES              TO OUT-MAX-PMTS-A
  8152                                          OUT-WAIT-PER
  8153                                          OUT-RET-ELIM
  8154                                          OUT-AH-DESC
  8155                                          OUT-BEN-DAYS
  8156              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8157             GO TO 1100-AH-CONT
  8158        END-IF
  8159     END-IF
  8160     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  8161     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  8162                                    OUT-ORIG-AH-BENCD
  8163     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  8164        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  8165           CM-AH-BENEFIT-AMT
  8166        IF OUT-COVERAGE-IND = 'LIFE'
  8167            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  8168                                    OUT-ORIG-COVERAGE-IND
  8169        ELSE
  8170            MOVE 'AH  '          TO OUT-COVERAGE-IND
  8171                                    OUT-ORIG-COVERAGE-IND
  8172        END-IF
  8173     ELSE
  8174        MOVE ZEROS               TO OUT-AH-TOT-BEN
  8175     END-IF
  8176     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  8177                                    OUT-ORIG-AH-TERM
  8178     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  8179                                    OUT-ORIG-CRIT-PER
  8180                                    OUT-MAX-PMTS
  8181                                    OUT-ORIG-MAX-PMTS
  8182     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  8183         MOVE SPACES             TO OUT-MAX-PMTS-A
  8184     END-IF
  8185     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  8186     IF CM-AH-DEV-PCT NOT NUMERIC
  8187        MOVE ZEROS               TO CM-AH-DEV-PCT
  8188     END-IF
  8189     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  8190     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  8191                                    OUT-ORIG-AH-BEN
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 143
* NSRASBL.cbl
  8192     IF CM-AH-BENEFIT-AMT = 9999999.99
  8193        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  8194     END-IF
  8195     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  8196                                    OUT-ORIG-AH-PRM
  8197                                    WS-WORK-AH-PREM
  8198     IF CM-AH-PREMIUM-AMT = .01
  8199         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  8200     END-IF
  8201     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  8202     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  8203                                    OUT-ORIG-AH-REF
  8204                                    WS-WORK-AH-REF
  8205     IF CM-AH-DEATH-CLAIM-APPLIED
  8206        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8207            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  8208                                    OUT-ORIG-AH-REF
  8209                                    WS-WORK-AH-REF
  8210     END-IF
  8211     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8212     MOVE ' '                    TO DC-OPTION-CODE
  8213     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8214     IF NO-CONVERSION-ERROR
  8215        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8216           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8217              INTO OUT-AH-CAN-DT
  8218        END-STRING
  8219     END-IF
  8220
  8221     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8222         MOVE ZEROS          TO WS-WORK-AH-PREM
  8223     END-IF
  8224
  8225      .
  8226 1100-AH-CONT.
  8227
  8228     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  8229     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  8230     MOVE ' '                    TO DC-OPTION-CODE
  8231     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8232     IF NO-CONVERSION-ERROR
  8233        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8234           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8235              INTO OUT-AH-PDTHRU-DT
  8236        END-STRING
  8237     END-IF
  8238     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  8239        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  8240     END-IF
  8241     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  8242     IF CM-LOAN-APR NOT NUMERIC
  8243        MOVE ZEROS               TO CM-LOAN-APR
  8244     END-IF
  8245     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  8246     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  8247     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  8248     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  8249     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 144
* NSRASBL.cbl
  8250     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  8251     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  8252     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  8253     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  8254     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  8255     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8256     MOVE ' '                    TO DC-OPTION-CODE
  8257     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8258     IF NO-CONVERSION-ERROR
  8259        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8260           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8261              INTO OUT-LF-EXP-DT
  8262        END-STRING
  8263     END-IF
  8264     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  8265     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8266     MOVE ' '                    TO DC-OPTION-CODE
  8267     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8268     IF NO-CONVERSION-ERROR
  8269        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8270           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8271              INTO OUT-AH-EXP-DT
  8272        END-STRING
  8273     END-IF
  8274     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  8275     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  8276     MOVE ' '                    TO DC-OPTION-CODE
  8277     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8278     IF NO-CONVERSION-ERROR
  8279        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8280           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8281              INTO OUT-1ST-PMT-DT
  8282        END-STRING
  8283     END-IF
  8284     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  8285     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  8286     MOVE ' '                    TO DC-OPTION-CODE
  8287     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8288     IF NO-CONVERSION-ERROR
  8289        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8290           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8291              INTO OUT-ENTRY-DT
  8292        END-STRING
  8293     END-IF
  8294     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8295     MOVE ' '                    TO DC-OPTION-CODE
  8296     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8297     IF NO-CONVERSION-ERROR
  8298        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8299           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8300              INTO OUT-LF-CAN-EXIT-DT
  8301        END-STRING
  8302     END-IF
  8303     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  8304     MOVE ' '                    TO DC-OPTION-CODE
  8305     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8306     IF NO-CONVERSION-ERROR
  8307        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 145
* NSRASBL.cbl
  8308           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8309              INTO OUT-LF-DTH-DT
  8310        END-STRING
  8311     END-IF
  8312     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  8313     MOVE ' '                    TO DC-OPTION-CODE
  8314     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8315     IF NO-CONVERSION-ERROR
  8316        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8317           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8318              INTO OUT-LF-DTH-EXIT-DT
  8319        END-STRING
  8320     END-IF
  8321     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  8322     IF OUT-AH-CAN-DT NOT = SPACES
  8323        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  8324     ELSE
  8325        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  8326     END-IF
  8327     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8328     MOVE ' '                    TO DC-OPTION-CODE
  8329     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8330     IF NO-CONVERSION-ERROR
  8331        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8332           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8333              INTO OUT-AH-CAN-EXIT-DT
  8334        END-STRING
  8335     END-IF
  8336     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  8337     IF CM-ENTRY-BATCH = LOW-VALUES
  8338        MOVE SPACES              TO CM-ENTRY-BATCH
  8339     END-IF
  8340     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  8341     IF CM-LF-EXIT-BATCH = LOW-VALUES
  8342        MOVE SPACES              TO CM-LF-EXIT-BATCH
  8343     END-IF
  8344     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  8345     IF CM-AH-EXIT-BATCH = LOW-VALUES
  8346        MOVE SPACES              TO CM-AH-EXIT-BATCH
  8347     END-IF
  8348     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  8349     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  8350     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  8351     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  8352     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  8353     COMPUTE WS-WORK-PREM =
  8354        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  8355           + CM-AH-PREMIUM-AMT)
  8356     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  8357                                    OUT-ORIG-TOT-PREM
  8358     COMPUTE WS-WORK-REF =
  8359        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  8360     MOVE WS-WORK-REF            TO OUT-TOT-REF
  8361                                    OUT-ORIG-TOT-REF
  8362     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  8363        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  8364     ELSE
  8365        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 146
* NSRASBL.cbl
  8366     END-IF
  8367     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  8368     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  8369        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  8370     ELSE
  8371        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  8372     END-IF
  8373     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  8374     IF CM-INT-ON-REFS NUMERIC
  8375        IF CM-INT-ON-REFS NOT = ZEROS
  8376           MOVE CM-INT-ON-REFS   TO OUT-TOT-INTEREST
  8377        END-IF
  8378     END-IF
  8379
  8380     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8381        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8382            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8383        END-IF
  8384        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8385            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8386        END-IF
  8387     END-IF
  8388*
  8389*     IF BL-DATA-SRCE = '2'
  8390*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8391*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8392*        END-IF
  8393*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8394*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8395*        END-IF
  8396*     END-IF
  8397
  8398     COMPUTE WS-ACCT-LF-PORTION =
  8399        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8400     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8401                                OUT-ACCT-ORIG-LF-PORT
  8402     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8403        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8404     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8405                                OUT-ACCT-ORIG-ALT-LF-PORT
  8406     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8407        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8408     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8409                                OUT-ACCT-ORIG-CMB-LF-PORT
  8410     COMPUTE WS-ACCT-AH-PORTION =
  8411        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8412     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8413                                OUT-ACCT-ORIG-AH-PORT
  8414     COMPUTE WS-ACCT-PORTION =
  8415        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8416     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8417                                OUT-ACCT-ORIG-PORTION
  8418
  8419     COMPUTE WS-CSO-LF-PORTION =
  8420       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8421     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8422                               OUT-CSO-ORIG-LF-PORT
  8423     COMPUTE WS-CSO-ALT-LF-PORTION =
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 147
* NSRASBL.cbl
  8424       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8425     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8426                                   OUT-CSO-ORIG-ALT-LF-PORT
  8427     COMPUTE WS-CSO-CMB-LF-PORTION =
  8428       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8429     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8430                                   OUT-CSO-ORIG-CMB-LF-PORT
  8431     COMPUTE WS-CSO-AH-PORTION =
  8432        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8433     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8434                               OUT-CSO-ORIG-AH-PORT
  8435     COMPUTE WS-CSO-PORTION =
  8436        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8437     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8438                            OUT-CSO-ORIG-PORTION
  8439     .
  8440 1110-EXIT.
  8441     EXIT.
  8442 1115-MATCH-COMPANY.
  8443     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8444     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8445     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8446
  8447* EXEC CICS READ
  8448*       INTO    (CONTROL-FILE)
  8449*       DATASET ('ELCNTL')
  8450*       RIDFLD  (WS-ELCNTL-KEY)
  8451*       RESP    (WS-RESPONSE)
  8452*    END-EXEC
  8453     MOVE LENGTH OF
  8454      CONTROL-FILE
  8455       TO DFHEIV11
  8456     MOVE 'ELCNTL' TO DFHEIV1
  8457*    MOVE '&"IL       E          (  N#00008171' TO DFHEIV0
  8458     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8460     MOVE X'204E233030303038313731' TO DFHEIV0(25:11)
  8461     CALL 'kxdfhei1' USING DFHEIV0,
  8462           DFHEIV1,
  8463           CONTROL-FILE,
  8464           DFHEIV11,
  8465           WS-ELCNTL-KEY,
  8466           DFHEIV99,
  8467           DFHEIV99,
  8468           DFHEIV99
  8469     MOVE EIBRESP  TO WS-RESPONSE
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8471     IF RESP-NORMAL
  8472        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8473     END-IF
  8474     .
  8475 1115-EXIT.
  8476     EXIT.
  8477 1120-MATCH-CARRIER.
  8478     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8479     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8480     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8481     MOVE +0                     TO WS-ELCNTL-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 148
* NSRASBL.cbl
  8482
  8483* EXEC CICS READ
  8484*       INTO    (CONTROL-FILE)
  8485*       DATASET ('ELCNTL')
  8486*       RIDFLD  (WS-ELCNTL-KEY)
  8487*       RESP    (WS-RESPONSE)
  8488*    END-EXEC
  8489     MOVE LENGTH OF
  8490      CONTROL-FILE
  8491       TO DFHEIV11
  8492     MOVE 'ELCNTL' TO DFHEIV1
  8493*    MOVE '&"IL       E          (  N#00008188' TO DFHEIV0
  8494     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8496     MOVE X'204E233030303038313838' TO DFHEIV0(25:11)
  8497     CALL 'kxdfhei1' USING DFHEIV0,
  8498           DFHEIV1,
  8499           CONTROL-FILE,
  8500           DFHEIV11,
  8501           WS-ELCNTL-KEY,
  8502           DFHEIV99,
  8503           DFHEIV99,
  8504           DFHEIV99
  8505     MOVE EIBRESP  TO WS-RESPONSE
  8506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8507     IF RESP-NORMAL
  8508        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8509     ELSE
  8510        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8511     END-IF
  8512     .
  8513 1120-EXIT.
  8514     EXIT.
  8515 1125-MATCH-STATE.
  8516     MOVE BL-STATE               TO OUT-STATE
  8517     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8518     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8519     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8520     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8521
  8522* EXEC CICS READ
  8523*       INTO    (CONTROL-FILE)
  8524*       DATASET ('ELCNTL')
  8525*       RIDFLD  (WS-ELCNTL-KEY)
  8526*       RESP    (WS-RESPONSE)
  8527*    END-EXEC
  8528     MOVE LENGTH OF
  8529      CONTROL-FILE
  8530       TO DFHEIV11
  8531     MOVE 'ELCNTL' TO DFHEIV1
  8532*    MOVE '&"IL       E          (  N#00008208' TO DFHEIV0
  8533     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8534     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8535     MOVE X'204E233030303038323038' TO DFHEIV0(25:11)
  8536     CALL 'kxdfhei1' USING DFHEIV0,
  8537           DFHEIV1,
  8538           CONTROL-FILE,
  8539           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 149
* NSRASBL.cbl
  8540           WS-ELCNTL-KEY,
  8541           DFHEIV99,
  8542           DFHEIV99,
  8543           DFHEIV99
  8544     MOVE EIBRESP  TO WS-RESPONSE
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8546     IF RESP-NORMAL
  8547        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8548     ELSE
  8549        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8550     END-IF
  8551     .
  8552 1125-EXIT.
  8553     EXIT.
  8554 1130-MATCH-BENCDS.
  8555     MOVE SPACES                 TO WS-LF-ABBRV
  8556                                    WS-LF-DESC
  8557                                    WS-LF-EARN
  8558                                    WS-WAIT-PER
  8559                                    WS-RET-ELIM
  8560                                    WS-AH-DESC
  8561                                    WS-BEN-DAYS
  8562     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8563        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8564     END-IF
  8565     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8566        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8567     END-IF
  8568     .
  8569 1130-EXIT.
  8570     EXIT.
  8571 1140-MATCH-LFBEN.
  8572     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8573     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8574     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8575     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8576
  8577* EXEC CICS READ
  8578*       INTO    (CONTROL-FILE)
  8579*       DATASET ('ELCNTL')
  8580*       RIDFLD  (WS-ELCNTL-KEY)
  8581*       GTEQ
  8582*       RESP    (WS-RESPONSE)
  8583*    END-EXEC
  8584     MOVE LENGTH OF
  8585      CONTROL-FILE
  8586       TO DFHEIV11
  8587     MOVE 'ELCNTL' TO DFHEIV1
  8588*    MOVE '&"IL       G          (  N#00008244' TO DFHEIV0
  8589     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8591     MOVE X'204E233030303038323434' TO DFHEIV0(25:11)
  8592     CALL 'kxdfhei1' USING DFHEIV0,
  8593           DFHEIV1,
  8594           CONTROL-FILE,
  8595           DFHEIV11,
  8596           WS-ELCNTL-KEY,
  8597           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 150
* NSRASBL.cbl
  8598           DFHEIV99,
  8599           DFHEIV99
  8600     MOVE EIBRESP  TO WS-RESPONSE
  8601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8602     IF RESP-NORMAL
  8603        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8604           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8605           OR (S1 > +8)
  8606        END-PERFORM
  8607        IF S1 < + 9
  8608           MOVE CF-BENEFIT-ALPHA (S1)
  8609                                 TO WS-LF-ABBRV
  8610           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8611           MOVE CF-CO-EARNINGS-CALC (S1)
  8612                                 TO WS-LF-EARN
  8613        ELSE
  8614           MOVE 'XX'             TO WS-LF-DESC
  8615           MOVE 'XXX'            TO WS-LF-ABBRV
  8616        END-IF
  8617     ELSE
  8618        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8619     END-IF
  8620     .
  8621 1140-EXIT.
  8622     EXIT.
  8623 1150-MATCH-AHBEN.
  8624     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8625     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8626     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8627     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8628
  8629* EXEC CICS READ
  8630*       INTO    (CONTROL-FILE)
  8631*       DATASET ('ELCNTL')
  8632*       RIDFLD  (WS-ELCNTL-KEY)
  8633*       GTEQ
  8634*       RESP    (WS-RESPONSE)
  8635*    END-EXEC
  8636     MOVE LENGTH OF
  8637      CONTROL-FILE
  8638       TO DFHEIV11
  8639     MOVE 'ELCNTL' TO DFHEIV1
  8640*    MOVE '&"IL       G          (  N#00008277' TO DFHEIV0
  8641     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8643     MOVE X'204E233030303038323737' TO DFHEIV0(25:11)
  8644     CALL 'kxdfhei1' USING DFHEIV0,
  8645           DFHEIV1,
  8646           CONTROL-FILE,
  8647           DFHEIV11,
  8648           WS-ELCNTL-KEY,
  8649           DFHEIV99,
  8650           DFHEIV99,
  8651           DFHEIV99
  8652     MOVE EIBRESP  TO WS-RESPONSE
  8653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8654     IF RESP-NORMAL
  8655        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 151
* NSRASBL.cbl
  8656           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8657           OR (S1 > +8)
  8658        END-PERFORM
  8659        IF S1 < + 9
  8660           MOVE CF-BENEFIT-ALPHA (S1)
  8661                                 TO WS-WAIT-PER
  8662           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8663                                 TO WS-RET-ELIM
  8664           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8665                                 TO WS-BEN-DAYS
  8666           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8667              IF CF-JOINT-INDICATOR (S1) = 'J'
  8668                 MOVE 'Joint Critical Period Disability'
  8669                                 TO WS-AH-DESC
  8670              ELSE
  8671                 MOVE 'Single Critical Period-Primary Only'
  8672                                 TO WS-AH-DESC
  8673              END-IF
  8674           ELSE
  8675              IF CF-JOINT-INDICATOR (S1) = 'J'
  8676                 MOVE 'Joint Disability'
  8677                                 TO WS-AH-DESC
  8678              ELSE
  8679                 MOVE 'Single Disability (Primary Only)'
  8680                                 TO WS-AH-DESC
  8681              END-IF
  8682           END-IF
  8683        ELSE
  8684           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8685        END-IF
  8686     ELSE
  8687        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8688     END-IF
  8689     .
  8690 1150-EXIT.
  8691     EXIT.
  8692
  8693 1160-READ-CERT-TRAILER.
  8694
  8695     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8696     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8697     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8698
  8699
  8700* EXEC CICS HANDLE CONDITION
  8701*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8702*    END-EXEC.
  8703*    MOVE '"$I                   ! " #00008329' TO DFHEIV0
  8704     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8706     MOVE X'2220233030303038333239' TO DFHEIV0(25:11)
  8707     CALL 'kxdfhei1' USING DFHEIV0
  8708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8709
  8710
  8711
  8712* EXEC CICS READ
  8713*        DATASET  ('ELCRTT')
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 152
* NSRASBL.cbl
  8714*        RIDFLD   (WS-ELCRTT-KEY)
  8715*        INTO     (CERTIFICATE-TRAILERS)
  8716*    END-EXEC.
  8717     MOVE LENGTH OF
  8718      CERTIFICATE-TRAILERS
  8719       TO DFHEIV11
  8720     MOVE 'ELCRTT' TO DFHEIV1
  8721*    MOVE '&"IL       E          (   #00008333' TO DFHEIV0
  8722     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8724     MOVE X'2020233030303038333333' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0,
  8726           DFHEIV1,
  8727           CERTIFICATE-TRAILERS,
  8728           DFHEIV11,
  8729           WS-ELCRTT-KEY,
  8730           DFHEIV99,
  8731           DFHEIV99,
  8732           DFHEIV99
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8734
  8735
  8736     GO TO 1160-EXIT.
  8737
  8738 1160-CERT-TRL-REC-NOTFND.
  8739     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8740
  8741 1160-EXIT.
  8742     EXIT.
  8743 1200-GET-ERACCT.
  8744     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8745     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8746                                    OUT-ACCT-ADDR1
  8747                                    OUT-ACCT-ADDR2
  8748                                    OUT-ACCT-CITY
  8749     MOVE ZEROS                  TO WS-CHGBACK
  8750
  8751* EXEC CICS STARTBR
  8752*        DATASET   ('ERACCT')
  8753*        RIDFLD    (WS-ERACCT-KEY)
  8754*        GTEQ
  8755*        RESP      (WS-RESPONSE)
  8756*    END-EXEC
  8757     MOVE 'ERACCT' TO DFHEIV1
  8758     MOVE 0
  8759       TO DFHEIV11
  8760*    MOVE '&,         G          &  N#00008353' TO DFHEIV0
  8761     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8762     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8763     MOVE X'204E233030303038333533' TO DFHEIV0(25:11)
  8764     CALL 'kxdfhei1' USING DFHEIV0,
  8765           DFHEIV1,
  8766           WS-ERACCT-KEY,
  8767           DFHEIV99,
  8768           DFHEIV11,
  8769           DFHEIV99
  8770     MOVE EIBRESP  TO WS-RESPONSE
  8771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 153
* NSRASBL.cbl
  8772     IF RESP-NORMAL
  8773
  8774* EXEC CICS READNEXT
  8775*          INTO    (ACCOUNT-MASTER)
  8776*          DATASET ('ERACCT')
  8777*          RIDFLD  (WS-ERACCT-KEY)
  8778*          RESP    (WS-RESPONSE)
  8779*       END-EXEC
  8780     MOVE LENGTH OF
  8781      ACCOUNT-MASTER
  8782       TO DFHEIV12
  8783     MOVE 'ERACCT' TO DFHEIV1
  8784     MOVE 0
  8785       TO DFHEIV11
  8786*    MOVE '&.IL                  )  N#00008360' TO DFHEIV0
  8787     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8788     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8789     MOVE X'204E233030303038333630' TO DFHEIV0(25:11)
  8790     CALL 'kxdfhei1' USING DFHEIV0,
  8791           DFHEIV1,
  8792           ACCOUNT-MASTER,
  8793           DFHEIV12,
  8794           WS-ERACCT-KEY,
  8795           DFHEIV99,
  8796           DFHEIV11,
  8797           DFHEIV99,
  8798           DFHEIV99
  8799     MOVE EIBRESP  TO WS-RESPONSE
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8801     END-IF
  8802     IF RESP-NORMAL
  8803        PERFORM UNTIL
  8804           NOT (RESP-NORMAL)
  8805           OR (WS-SAVE-ERACCT-KEY NOT =
  8806                        AM-CONTROL-PRIMARY (1:20))
  8807           IF BL-DATA-SRCE = '4' OR '2'
  8808              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8809                 AND >= AM-EFFECTIVE-DT)
  8810                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8811                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8812                    OR (S1 > +10)
  8813                 END-PERFORM
  8814                 IF S1 < +11
  8815                    MOVE AM-COMM-CHARGEBACK (S1)
  8816                                 TO WS-CHGBACK
  8817                 END-IF
  8818              END-IF
  8819           END-IF
  8820           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8821
  8822* EXEC CICS READNEXT
  8823*             INTO    (ACCOUNT-MASTER)
  8824*             DATASET ('ERACCT')
  8825*             RIDFLD  (WS-ERACCT-KEY)
  8826*             RESP    (WS-RESPONSE)
  8827*          END-EXEC
  8828     MOVE LENGTH OF
  8829      ACCOUNT-MASTER
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 154
* NSRASBL.cbl
  8830       TO DFHEIV12
  8831     MOVE 'ERACCT' TO DFHEIV1
  8832     MOVE 0
  8833       TO DFHEIV11
  8834*    MOVE '&.IL                  )  N#00008386' TO DFHEIV0
  8835     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8836     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8837     MOVE X'204E233030303038333836' TO DFHEIV0(25:11)
  8838     CALL 'kxdfhei1' USING DFHEIV0,
  8839           DFHEIV1,
  8840           ACCOUNT-MASTER,
  8841           DFHEIV12,
  8842           WS-ERACCT-KEY,
  8843           DFHEIV99,
  8844           DFHEIV11,
  8845           DFHEIV99,
  8846           DFHEIV99
  8847     MOVE EIBRESP  TO WS-RESPONSE
  8848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8849        END-PERFORM
  8850        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8851        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8852           SET ACCT-FOUND TO TRUE
  8853           MOVE AM-NAME          TO OUT-ACCT-NAME
  8854           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8855           MOVE SPACES           TO OUT-ACCT-ADDR2
  8856           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8857           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8858           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8859           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8860           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8861           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8862           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8863              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8864                 INTO OUT-ACCT-ZIP (6:5)
  8865              END-STRING
  8866           END-IF
  8867           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8868           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8869           MOVE AM-STATE         TO OUT-FORM
  8870           IF AM-ACCOUNT (10:1) = 'L'
  8871              MOVE 'L'           TO OUT-FORM (3:1)
  8872                                    OUT-LEASE-IND
  8873           END-IF
  8874           MOVE AM-CONTROL-PRIMARY (1:8)
  8875                                 TO WS-ERCOMP-KEY
  8876           IF AM-REMIT-TO NOT NUMERIC
  8877              MOVE 01            TO AM-REMIT-TO
  8878           END-IF
  8879           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8880           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8881              (AM-COM-TYP (S1) = 'C' OR 'D')
  8882              OR (S1 > +10)
  8883           END-PERFORM
  8884           IF S1 < +11
  8885              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8886           END-IF
  8887           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 155
* NSRASBL.cbl
  8888           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8889        END-IF
  8890     END-IF
  8891
  8892* EXEC CICS ENDBR
  8893*        DATASET   ('ERACCT')
  8894*    END-EXEC
  8895     MOVE 'ERACCT' TO DFHEIV1
  8896     MOVE 0
  8897       TO DFHEIV11
  8898*    MOVE '&2                    $   #00008434' TO DFHEIV0
  8899     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8901     MOVE X'2020233030303038343334' TO DFHEIV0(25:11)
  8902     CALL 'kxdfhei1' USING DFHEIV0,
  8903           DFHEIV1,
  8904           DFHEIV11,
  8905           DFHEIV99
  8906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8907    .
  8908 1200-EXIT.
  8909     EXIT.
  8910 1225-GET-ERCOMP.
  8911
  8912* EXEC CICS READ
  8913*       INTO    (COMPENSATION-MASTER)
  8914*       DATASET ('ERCOMP')
  8915*       RIDFLD  (WS-ERCOMP-KEY)
  8916*       RESP    (WS-RESPONSE)
  8917*    END-EXEC
  8918     MOVE LENGTH OF
  8919      COMPENSATION-MASTER
  8920       TO DFHEIV11
  8921     MOVE 'ERCOMP' TO DFHEIV1
  8922*    MOVE '&"IL       E          (  N#00008441' TO DFHEIV0
  8923     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8925     MOVE X'204E233030303038343431' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0,
  8927           DFHEIV1,
  8928           COMPENSATION-MASTER,
  8929           DFHEIV11,
  8930           WS-ERCOMP-KEY,
  8931           DFHEIV99,
  8932           DFHEIV99,
  8933           DFHEIV99
  8934     MOVE EIBRESP  TO WS-RESPONSE
  8935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8936     IF RESP-NORMAL
  8937        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8938        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8939        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8940        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8941        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8942        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8943        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8944        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8945        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 156
* NSRASBL.cbl
  8946        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8947        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8948        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8949     END-IF
  8950     .
  8951 1225-EXIT.
  8952     EXIT.
  8953 1250-GET-ELLETR.
  8954     display ' made it to 1250 '
  8955     move spaces                 to W-Z-CONTROL-DATA
  8956     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8957     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8958     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8959
  8960* EXEC CICS READ
  8961*         DATASET    ('ELLETR')
  8962*         INTO       (TEXT-FILES)
  8963*         RIDFLD     (WS-ELLETR-KEY)
  8964*         RESP       (WS-RESPONSE)
  8965*         GTEQ
  8966*    END-EXEC
  8967     MOVE LENGTH OF
  8968      TEXT-FILES
  8969       TO DFHEIV11
  8970     MOVE 'ELLETR' TO DFHEIV1
  8971*    MOVE '&"IL       G          (  N#00008470' TO DFHEIV0
  8972     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8974     MOVE X'204E233030303038343730' TO DFHEIV0(25:11)
  8975     CALL 'kxdfhei1' USING DFHEIV0,
  8976           DFHEIV1,
  8977           TEXT-FILES,
  8978           DFHEIV11,
  8979           WS-ELLETR-KEY,
  8980           DFHEIV99,
  8981           DFHEIV99,
  8982           DFHEIV99
  8983     MOVE EIBRESP  TO WS-RESPONSE
  8984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8985     IF RESP-NORMAL
  8986        IF (LETTER-FILE-TEXT)
  8987           AND (BL-LETTER-ID = TX-LETTER-NO)
  8988           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8989           display ' found good z record '
  8990           PERFORM 1280-PROCESS-Z-CONTROLS
  8991                                 THRU 1280-EXIT
  8992        END-IF
  8993     END-IF
  8994     .
  8995 1250-EXIT.
  8996     EXIT.
  8997 1280-PROCESS-Z-CONTROLS.
  8998     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8999*    IF W-FORM-TO-RESEND > SPACES
  9000*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  9001*    ELSE
  9002*       MOVE SPACES              TO OUT-FORM
  9003*    END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 157
* NSRASBL.cbl
  9004     IF BL-ENC-CD = SPACES OR LOW-VALUES
  9005        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  9006     END-IF
  9007     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  9008     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  9009     .
  9010 1280-EXIT.
  9011     EXIT.
  9012 1300-DETERMINE-COMM.
  9013******************************************************************
  9014* DATA SOURCE MEANINGS  BL-DATA-SRCE
  9015*    1) FROM ACCT MAINT
  9016*    2) FROM CERT UPDATE
  9017*    3) FROM COMP MAINT
  9018*    4) FROM REVIEW AND CORRECTIONS
  9019******************************************************************
  9020     MOVE 'Y'                    TO OUT-CHGBACK
  9021     MOVE ZEROS                  TO WS-DIFF
  9022                                    WS-CHGBK-LIFE-PCT
  9023                                    WS-CHGBK-AH-PCT
  9024     IF BL-DATA-SRCE = '4'
  9025        IF PB-CANCELLATION
  9026           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  9027           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  9028           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  9029           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  9030           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  9031              MOVE PB-C-LF-CANCEL-DT
  9032                                 TO DC-BIN-DATE-2
  9033           END-IF
  9034           MOVE '1'              TO DC-OPTION-CODE
  9035           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9036           IF NO-CONVERSION-ERROR
  9037              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  9038              IF DC-ODD-DAYS-OVER > +1
  9039                 ADD +1          TO WS-DIFF
  9040              END-IF
  9041              IF (WS-CHGBACK = 99)
  9042                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  9043                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  9044                                WS-CHGBK-AH-PCT
  9045                   MOVE 'N'  TO OUT-CHGBACK
  9046              END-IF
  9047           END-IF
  9048        ELSE
  9049           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  9050           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  9051        END-IF
  9052     ELSE
  9053        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  9054        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  9055        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  9056           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  9057           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9058           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  9059           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  9060              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  9061           END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 158
* NSRASBL.cbl
  9062           MOVE '1'              TO DC-OPTION-CODE
  9063           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9064           IF NO-CONVERSION-ERROR
  9065              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  9066              IF DC-ODD-DAYS-OVER > +1
  9067                 ADD +1          TO WS-DIFF
  9068              END-IF
  9069              IF (WS-CHGBACK = 99)
  9070                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  9071                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  9072                                WS-CHGBK-AH-PCT
  9073                   MOVE 'N'  TO OUT-CHGBACK
  9074              END-IF
  9075           END-IF
  9076        END-IF
  9077     END-IF
  9078     .
  9079 1300-EXIT.
  9080     EXIT.
  9081 1500-GET-ARCH-NO.
  9082     DISPLAY ' MADE IT TO 1500 '
  9083     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  9084     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  9085     MOVE SPACES                 TO WS-ELCNTL-GENL
  9086     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  9087
  9088* EXEC CICS READ
  9089*       INTO    (CONTROL-FILE)
  9090*       DATASET ('ELCNTL')
  9091*       RIDFLD  (WS-ELCNTL-KEY)
  9092*       UPDATE
  9093*       RESP    (WS-RESPONSE)
  9094*    END-EXEC
  9095     MOVE LENGTH OF
  9096      CONTROL-FILE
  9097       TO DFHEIV11
  9098     MOVE 'ELCNTL' TO DFHEIV1
  9099*    MOVE '&"IL       EU         (  N#00008579' TO DFHEIV0
  9100     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9101     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9102     MOVE X'204E233030303038353739' TO DFHEIV0(25:11)
  9103     CALL 'kxdfhei1' USING DFHEIV0,
  9104           DFHEIV1,
  9105           CONTROL-FILE,
  9106           DFHEIV11,
  9107           WS-ELCNTL-KEY,
  9108           DFHEIV99,
  9109           DFHEIV99,
  9110           DFHEIV99
  9111     MOVE EIBRESP  TO WS-RESPONSE
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9113     IF RESP-NORMAL
  9114        AND (CF-COMPANY-ID  = BL-COMP-ID)
  9115        AND (CF-RECORD-TYPE = '1')
  9116        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  9117        MOVE CF-CREDIT-LAST-ARCH-NUM
  9118                                 TO WS-ARCHIVE-NO
  9119
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 159
* NSRASBL.cbl
  9120* EXEC CICS REWRITE
  9121*          FROM    (CONTROL-FILE)
  9122*          DATASET ('ELCNTL')
  9123*       END-EXEC
  9124     MOVE LENGTH OF
  9125      CONTROL-FILE
  9126       TO DFHEIV11
  9127     MOVE 'ELCNTL' TO DFHEIV1
  9128*    MOVE '&& L                  %   #00008592' TO DFHEIV0
  9129     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9130     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9131     MOVE X'2020233030303038353932' TO DFHEIV0(25:11)
  9132     CALL 'kxdfhei1' USING DFHEIV0,
  9133           DFHEIV1,
  9134           CONTROL-FILE,
  9135           DFHEIV11,
  9136           DFHEIV99
  9137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9138     ELSE
  9139        MOVE +0                  TO WS-ARCHIVE-NO
  9140     END-IF
  9141    .
  9142 1500-EXIT.
  9143     EXIT.
  9144 1700-GET-ELENCC.
  9145     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  9146     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  9147     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  9148     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  9149        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  9150        OR (E1 > +5)
  9151     END-PERFORM
  9152     IF E1 < +5
  9153        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  9154     END-IF
  9155
  9156* EXEC CICS READ
  9157*        DATASET   ('ELENCC')
  9158*        INTO      (ENCLOSURE-CODES)
  9159*        RIDFLD    (WS-ELENCC-KEY)
  9160*        RESP      (WS-RESPONSE)
  9161*    END-EXEC
  9162     MOVE LENGTH OF
  9163      ENCLOSURE-CODES
  9164       TO DFHEIV11
  9165     MOVE 'ELENCC' TO DFHEIV1
  9166*    MOVE '&"IL       E          (  N#00008613' TO DFHEIV0
  9167     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9169     MOVE X'204E233030303038363133' TO DFHEIV0(25:11)
  9170     CALL 'kxdfhei1' USING DFHEIV0,
  9171           DFHEIV1,
  9172           ENCLOSURE-CODES,
  9173           DFHEIV11,
  9174           WS-ELENCC-KEY,
  9175           DFHEIV99,
  9176           DFHEIV99,
  9177           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 160
* NSRASBL.cbl
  9178     MOVE EIBRESP  TO WS-RESPONSE
  9179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9180     IF NOT RESP-NORMAL
  9181        display ' elencc resp not normal ' ws-response
  9182        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  9183
  9184* EXEC CICS READ
  9185*           DATASET   ('ELENCC')
  9186*           INTO      (ENCLOSURE-CODES)
  9187*           RIDFLD    (WS-ELENCC-KEY)
  9188*           RESP      (WS-RESPONSE)
  9189*       END-EXEC
  9190     MOVE LENGTH OF
  9191      ENCLOSURE-CODES
  9192       TO DFHEIV11
  9193     MOVE 'ELENCC' TO DFHEIV1
  9194*    MOVE '&"IL       E          (  N#00008622' TO DFHEIV0
  9195     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9196     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9197     MOVE X'204E233030303038363232' TO DFHEIV0(25:11)
  9198     CALL 'kxdfhei1' USING DFHEIV0,
  9199           DFHEIV1,
  9200           ENCLOSURE-CODES,
  9201           DFHEIV11,
  9202           WS-ELENCC-KEY,
  9203           DFHEIV99,
  9204           DFHEIV99,
  9205           DFHEIV99
  9206     MOVE EIBRESP  TO WS-RESPONSE
  9207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9208     END-IF
  9209     IF RESP-NORMAL
  9210        display ' elencc resp normal ' ws-response
  9211        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  9212        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  9213        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  9214     END-IF
  9215     .
  9216 1700-EXIT.
  9217     EXIT.
  9218
  9219
  9220 4100-CONNECT-TO-DB.
  9221
  9222     IF SVR > SPACES
  9223        CONTINUE
  9224     ELSE
  9225        MOVE 'NTCSO2_LOGIC'         TO SVR
  9226        MOVE 'sa'                   TO USR
  9227        MOVE 'ntcso2'               TO PASS
  9228     END-IF
  9229
  9230     STRING
  9231         USR DELIMITED SPACE
  9232         "." DELIMITED SIZE
  9233         PASS DELIMITED SPACE INTO USR-PASS
  9234     END-STRING
  9235
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 161
* NSRASBL.cbl
  9236     EXEC SQL
  9237        CONNECT TO :SVR USER :USR-PASS
  9238     END-EXEC
  9239
  9240     IF SQLCODE NOT = 0
  9241        DISPLAY "ERROR: CANNOT CONNECT "
  9242        DISPLAY SQLCODE
  9243        DISPLAY SQLERRMC
  9244        GO TO 4100-EXIT
  9245     END-IF
  9246
  9247     .
  9248 4100-EXIT.
  9249     EXIT.
  9250
  9251
  9252
  9253 4200-GET-NEXT-BUS-DT.
  9254
  9255     MOVE WS-SAVE-EDIT-A-DATE    TO WS-CYCLE-DATE
  9256     MOVE SPACES                 TO WS-NEXT-BUS-DT
  9257
  9258     IF WS-KIXHOST = 'logictest'
  9259        EXEC SQL
  9260          CALL NaperTestCalcNextBusDt
  9261                        @cycledate = :WS-CYCLE-DATE,
  9262                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9263        END-EXEC
  9264     ELSE
  9265        EXEC SQL
  9266          CALL NaperProdCalcNextBusDt
  9267                        @cycledate = :WS-CYCLE-DATE,
  9268                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9269        END-EXEC
  9270     END-IF
  9271
  9272     IF SQLCODE NOT = 0
  9273        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
  9274        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9275        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9276        GO TO 4200-EXIT
  9277     END-IF
  9278
  9279     .
  9280 4200-EXIT.
  9281     EXIT.
  9282
  9283
  9284
  9285 4300-DISCONNECT.
  9286
  9287     EXEC SQL
  9288        DISCONNECT
  9289     END-EXEC
  9290     .
  9291 4300-EXIT.
  9292     EXIT.
  9293
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 162
* NSRASBL.cbl
  9294
  9295 4500-CHECK-BALLOON-STATE.
  9296
  9297     MOVE 'naperadmin'           TO USR
  9298     MOVE 'cCm8naper'            TO PASS
  9299     IF WS-KIXHOST = 'logictest'
  9300        MOVE 'HOVTSTDB01_NaperRepo'
  9301                                 TO SVR
  9302        MOVE '1020'              TO WS-LOOKUPID
  9303     ELSE
  9304        MOVE 'SDVDB01_NaperRepo' TO SVR
  9305        MOVE '1020'              TO WS-LOOKUPID
  9306     END-IF
  9307
  9308     MOVE SPACES                 TO WS-LOOKUP-VALUE
  9309
  9310     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  9311     MOVE CM-STATE TO WS-LOOKUPNAME
  9312     MOVE 'B'      TO WS-LOOKUPNAME (3:1)
  9313
  9314     EXEC SQL
  9315           SELECT LOOKUPVALUE
  9316             INTO :WS-LOOKUP-VALUE
  9317             FROM LOOKUPVALUES
  9318               WHERE LOOKUPID = :WS-LOOKUPID
  9319                 AND LOOKUPNAME = :WS-LOOKUPNAME
  9320     END-EXEC
  9321
  9322     IF SQLCODE = 0
  9323       OR SQLCODE = 100
  9324        CONTINUE
  9325     ELSE
  9326        DISPLAY "ERROR: INVALID BALLOON STATE SELECT "
  9327        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9328        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9329     END-IF
  9330
  9331     PERFORM 4300-DISCONNECT THRU 4300-EXIT.
  9332
  9333 4500-EXIT.
  9334     EXIT.
  9335 9700-DATE-LINK.
  9336
  9337* EXEC CICS LINK
  9338*        PROGRAM   ('ELDATCV')
  9339*        COMMAREA  (DATE-CONVERSION-DATA)
  9340*        LENGTH    (DC-COMM-LENGTH)
  9341*    END-EXEC.
  9342     MOVE 'ELDATCV' TO DFHEIV1
  9343*    MOVE '."C                   (   #00008756' TO DFHEIV0
  9344     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9346     MOVE X'2020233030303038373536' TO DFHEIV0(25:11)
  9347     CALL 'kxdfhei1' USING DFHEIV0,
  9348           DFHEIV1,
  9349           DATE-CONVERSION-DATA,
  9350           DC-COMM-LENGTH,
  9351           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 14:05 Page 163
* NSRASBL.cbl
  9352           DFHEIV99,
  9353           DFHEIV99,
  9354           DFHEIV99
  9355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9356
  9357 9700-EXIT.
  9358      EXIT.
  9359
  9360 9999-DFHBACK SECTION.
  9361     MOVE '9%                    "   ' TO DFHEIV0
  9362     MOVE 'NSRASBL' TO DFHEIV1
  9363     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9364     GOBACK.
  9365 9999-DFHEXIT.
  9366     IF DFHEIGDJ EQUAL 0001
  9367         NEXT SENTENCE
  9368     ELSE IF DFHEIGDJ EQUAL 2
  9369         GO TO 1160-CERT-TRL-REC-NOTFND
  9370         DEPENDING ON DFHEIGDI.
  9371     MOVE '9%                    "   ' TO DFHEIV0
  9372     MOVE 'NSRASBL' TO DFHEIV1
  9373     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9374     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      169132     Code:       58504
