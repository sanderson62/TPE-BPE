* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   1
* EL691.cbl
* Options: int("EL691.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL691.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL691.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL691.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL691.
     5*
     6*AUTHOR.    LOGIC, INC.
     7*           DALLAS, TEXAS.
     8
     9*DATE-COMPILED.
    10
    11*REMARKS.
    12*        THIS PROGRAM PROVIDES THE FUNCTIONS TO BROWSE AND EDIT
    13*    THE DETAIL OF AN ARCHIVED LETTER.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   2
* EL691.cbl
    14
    15*    TRANS ID = EXN1
    16
    17******************************************************************
    18*                   C H A N G E   L O G
    19*
    20* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    21*-----------------------------------------------------------------
    22*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    23* EFFECTIVE    NUMBER
    24*-----------------------------------------------------------------
    25* 071111    2011022800001  AJRA  NAPERSOFT - NEW SCREEN
    26* 100312    2011022800001  AJRA  CHANGE RECEIVED MSG
    27* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTE, ENDT ARCH N
    28* 122612    2012101700002  AJRA  UPDATE BILLING NOTE ON RECEIVED
    29* 100813    2013100700002  AJRA  VERITY RESEND LETTER ID ON CHANGE
    30* 102918  CR2018080300002  PEMA  ADD VOID OB LETTER OPTION
    31* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
    32* 102020 IR2020101300001   PEMA  Correct billing notes
    33******************************************************************
    34
    35 DATA DIVISION.
    36 WORKING-STORAGE SECTION.
    37 01  DFH-START PIC X(04).
    38 77  FILLER  PIC X(32) VALUE '********************************'.
    39 77  FILLER  PIC X(32) VALUE '*    EL691 WORKING STORAGE     *'.
    40 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    41 77  c1                          pic s9(5) comp-3 value +0.
    42 77  n1                          pic s999  comp-3 value +0.
    43 77  w-comment-line-cnt          pic s999 comp-3 value +0.
    44 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    45 77  note-count                  pic s999 comp-3 value +0.
    46 77  ws-build-note-sw            pic x value ' '.
    47     88  finished-with-notes      value 'Y'.
    48 77  ws-ercnot-sw                pic x  value spaces.
    49     88  ercnot-startbr            value 'Y'.
    50
    51 01  P pointer.
    52 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    53 01  var-ptr pointer.
    54 01  env-var-len                 pic 9(4)  binary.
    55 01  rc                          pic 9(9)  binary.
    56
    57 01  WS-KIXSYS.
    58     05  WS-KIX-FIL1             PIC X(10).
    59     05  WS-KIX-APPS             PIC X(10).
    60     05  WS-KIX-ENV              PIC X(10).
    61     05  WS-KIX-MYENV            PIC X(10).
    62     05  WS-KIX-SYS              PIC X(10).
*   63 EXEC SQL
*   64    INCLUDE SQLDA
*   65 END-EXEC
    66 01 SQLDA sync.
    67    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    68    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    69    05 SQLN                  PIC S9(4) COMP-5 value 0.
    70    05 SQLD                  PIC S9(4) COMP-5 value 0.
    71    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   3
* EL691.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72       10 SQLTYPE            PIC S9(4) COMP-5.
    73       10 SQLLEN             PIC S9(4) COMP-5.
    74$IF P64 SET
    75X      *> For 64-bit environments, ensure that SQLDATA is
    76X      *> aligned on an 8-byte boundary.
    77X      10 FILLER             PIC S9(9) COMP-5.
    78$END
    79       10 SQLDATA            USAGE POINTER.
    80       10 SQLIND             USAGE POINTER.
    81       10 SQLNAME.
    82          15 SQLNAMEL        PIC S9(4) COMP-5.
    83          15 SQLNAMEC        PIC X(30).
    84
    85* Values for SQLTYPE
    86
    87 78  ESQL-DATE-CHAR              VALUE 384.
    88 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    89 78  ESQL-DATE-REC               VALUE 386.
    90 78  ESQL-DATE-REC-NULL          VALUE 387.
    91 78  ESQL-TIME-CHAR              VALUE 388.
    92 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    93 78  ESQL-TIME-REC               VALUE 390.
    94 78  ESQL-TIME-REC-NULL          VALUE 391.
    95 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
    96 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
    97 78  ESQL-TIMESTAMP-REC          VALUE 394.
    98 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
    99 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   100 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   101 78  ESQL-TS-OFFSET-REC          VALUE 398.
   102 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   103 78  ESQL-LONGVARBINARY          VALUE 404.
   104 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   105 78  ESQL-LONGVARCHAR            VALUE 408.
   106 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   107 78  ESQL-BINARY                 VALUE 444.
   108 78  ESQL-BINARY-NULL            VALUE 445.
   109 78  ESQL-VARBINARY              VALUE 446.
   110 78  ESQL-VARBINARY-NULL         VALUE 447.
   111 78  ESQL-VARCHAR                VALUE 448.
   112 78  ESQL-VARCHAR-NULL           VALUE 449.
   113
   114 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   115 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   116
   117 78  ESQL-CHAR                   VALUE 452.
   118 78  ESQL-CHAR-NULL              VALUE 453.
   119
   120 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   121 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   122
   123 78  ESQL-DOUBLE                 VALUE 480.
   124 78  ESQL-DOUBLE-NULL            VALUE 481.
   125 78  ESQL-REAL                   VALUE 482.
   126 78  ESQL-REAL-NULL              VALUE 483.
   127 78  ESQL-DECIMAL                VALUE 484.
   128 78  ESQL-DECIMAL-NULL           VALUE 485.
   129 78  ESQL-INTEGER                VALUE 496.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   4
* EL691.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-INTEGER-NULL           VALUE 497.
   131 78  ESQL-SMALLINT               VALUE 500.
   132 78  ESQL-SMALLINT-NULL          VALUE 501.
   133 78  ESQL-TINYINT                VALUE 502.
   134 78  ESQL-TINYINT-NULL           VALUE 503.
*  135 EXEC SQL
*  136    INCLUDE SQLCA
*  137 END-EXEC
   138 01 SQLCA.
   139     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   140     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   141     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   142     05  SQLERRM.
   143         49  SQLERRML    PIC S9(4) COMP-5.
   144         49  SQLERRMC    PIC X(70).
   145     05  SQLERRP         PIC X(8).
   146     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   147     05  SQLWARN.
   148         10  SQLWARN0    PIC X.
   149         10  SQLWARN1    PIC X.
   150         10  SQLWARN2    PIC X.
   151         10  SQLWARN3    PIC X.
   152         10  SQLWARN4    PIC X.
   153         10  SQLWARN5    PIC X.
   154         10  SQLWARN6    PIC X.
   155         10  SQLWARN7    PIC X.
   156     05  SQLEXT.
   157         10  SQLWARN8    PIC X.
   158         10  SQLWARN9    PIC X.
   159         10  SQLWARN10   PIC X.
   160         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   161     05  SQLSTATE    PIC X(5).
   162 EXEC SQL
   163    BEGIN DECLARE SECTION
   164 END-EXEC
   165 01  sqlcmd                      pic x(1024).
   166 01  WS-MOE-DATE                 pic x(10).
   167 01  svr                         pic x(32).
   168 01  usr                         pic x(32).
   169 01  pass                        pic x(32).
   170 01  usr-pass                    pic x(64).
   171 01  ws-sql-code                 pic s9(7) value zeros.
   172 01  ws-dis-sql-code             pic -9999999 value zeros.
   173***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   174***                                                            ***
   175***  These indicators are used to determine if a variable      ***
   176***  is passed nulls from sql. The indicator will be -1        ***
   177***  if the value on sql is nulls and +0 if the value is       ***
   178***  something other than nulls. Here is an example on how     ***
   179***  to use the indicator variables.                           ***
   180***                                                            ***
   181***     EXEC SQL                                               ***
   182***        fetch keyword into                                  ***
   183***           :db-Complete-dt :nu-Complete-date,               ***
   184***           :db-app-by     :nu-app-by,                       ***
   185***           :db-app-date   :nu-app-date,                     ***
   186***           :db-app-batch  :nu-app-batch                     ***
   187***     END-EXEC                                               ***
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   5
* EL691.cbl
   188***                                                            ***
   189***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   190 01  indicator-vaiables-for-nulls.
   191     05  nu-Complete-date        pic s9(4) comp value +0.
   192 01  key-word-key-data.
   193     05  kd-unique-id            pic 9(7).
   194     05  kd-cert-no              pic x(11).
   195 01  key-word-table-data.
   196     05  db-req-date             pic x(10).
   197     05  db-doc-type             pic x(30).
   198     05  db-Cert-no              pic x(11).
   199     05  db-Print-dt             pic x(10).
   200     05  db-Cert-exp-dt          pic x(10).
   201     05  db-cert-state           pic xx.
   202     05  db-key-word-type        pic x(30).
   203     05  db-key-word-value       pic x(30).
   204     05  db-complete-dt          pic x(10).
   205 EXEC SQL
   206    END DECLARE SECTION
   207 END-EXEC
   208
   209 01  W-WORK-AREAS.
   210     12  ws-sql-update-sw        pic x value ' '.
   211         88  sql-update-succeeded    value 'Y'.
   212         88  sql-update-failed       value 'N'.
   213     12  ws-connect-sw           pic x  value ' '.
   214         88  connected-to-db        value 'Y'.
   215     12  ws-cert-sw              pic x value ' '.
   216         88  cert-found             value 'Y'.
   217     12  FILLER                  PIC  X(18)
   218                                      VALUE 'PROGRAM WORK AREA:'.
   219     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   220     12  W-CALL-PGM              PIC  X(08).
   221     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   222     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   223     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   224
   225     12  W-TIME-IN               PIC S9(07).
   226     12  FILLER REDEFINES W-TIME-IN.
   227         16  FILLER              PIC  X(01).
   228         16  W-TIME-OUT          PIC  9(02)V9(02).
   229         16  FILLER              PIC  X(02).
   230
   231     12  W-DEEDIT-FIELD          PIC  X(15).
   232     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   233
   234     12  W-ERROR-COUNT           PIC S9(3)       VALUE ZERO.
   235     12  W-UPDATE-SW             PIC S9          VALUE ZERO.
   236     12  W-RESEND-DATE           PIC XX    VALUE LOW-VALUES.
   237     12  W-SENT-DATE             PIC XX    VALUE LOW-VALUES.
   238     12  W-FINAL-ACT-DATE        PIC XX    VALUE LOW-VALUES.
   239     12  W-RECEIVED-DATE         PIC XX    VALUE LOW-VALUES.
   240     12  W-STOP-LETTER-DATE      PIC XX    VALUE LOW-VALUES.
   241     12  W-RESPONSE              PIC S9(8)   COMP.
   242         88  RESP-NORMAL                  VALUE +00.
   243         88  RESP-NOTFND                  VALUE +13.
   244         88  RESP-DUPREC                  VALUE +14.
   245         88  RESP-DUPKEY                  VALUE +15.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   6
* EL691.cbl
   246         88  RESP-NOTOPEN                 VALUE +19.
   247         88  RESP-ENDFILE                 VALUE +20.
   248         88  resp-lengtherr               value +22.
   249
   250     12  W-ARCH-SAVE-KEY         PIC  X(03).
   251     12  W-ARCH-KEY.
   252         16  W-ARCH-COMPANY-CD   PIC  X(01).
   253         16  W-ARCH-NUMBER       PIC S9(08)      COMP.
   254
   255     12  W-ARCT-KEY.
   256         16  W-ARCT-COMPANY-CD   PIC  X(01).
   257         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
   258         16  W-ARCT-RECORD-TYPE  PIC  X(01).
   259             88  W-ARCT-COMMENT-DATA   VALUE '3'.
   260         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
   261
   262     12  w-stop-letter-comment   pic x(126) value spaces.
   263     12  w-cert-note-comment     pic x(70) value spaces.
   264     12  W-CERT-NOTE-MSG.
   265         16  FILLER              PIC X(29)
   266             VALUE 'REQUESTED DOCUMENT RECEIVED  '.
   267         16  W-CERT-NOTE-RECV-DT PIC X(8).
   268
   269     12  WS-FIND-BILLING-NOTE.
   270         16  WS-FBN-NOTE         PIC X(25).
   271         16  WS-FBN-LTRID        PIC X(4).
   272
   273     12  WS-RECEIVED-NOTE.
   274         16  FILLER              PIC X(12)
   275             VALUE ' - RECEIVED '.
   276         16  WS-BN-RECV-DATE     PIC X(8).
   277
   278     12  WS-Z-RECORD-IND         PIC X(1) VALUE 'N'.
   279         88 Z-RECORD-FOUND                VALUE 'Y'.
   280         88 Z-RECORD-NOT-FOUND            VALUE 'N'.
   281
   282     12  ELCERT-FILE-ID          PIC  X(08)  VALUE 'ELCERT'.
   283     12  ERCNOT-FILE-ID          PIC  X(08)  VALUE 'ERCNOT'.
   284     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   285     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   286     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   287     12  ERCNOT-KEY.
   288         16  ERCNOT-PARTIAL-KEY.
   289             20 ERCNOT-COMPANY-CD    PIC X.
   290             20 ERCNOT-CARRIER       PIC X.
   291             20 ERCNOT-GROUPING      PIC X(06).
   292             20 ERCNOT-STATE         PIC XX.
   293             20 ERCNOT-ACCOUNT       PIC X(10).
   294             20 ERCNOT-EFF-DT        PIC XX.
   295             20 ERCNOT-CERT-NO.
   296                25 ERCNOT-CERT-PRIME PIC X(10).
   297                25 ERCNOT-CERT-SFX   PIC X.
   298             20 ERCNOT-REC-TYP       PIC X.
   299         16 ERCNOT-SEQ           PIC S9(4) COMP.
   300     12  SV-PRIOR-KEY.
   301         16 SV-COMPANY-CD            PIC X.
   302         16 SV-CARRIER               PIC X.
   303         16 SV-GROUPING              PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   7
* EL691.cbl
   304         16 SV-STATE                 PIC XX.
   305         16 SV-ACCOUNT               PIC X(10).
   306         16 SV-EFF-DT                PIC XX.
   307         16 SV-CERT-NO.
   308            20 SV-CERT-PRIME         PIC X(10).
   309            20 SV-CERT-SFX           PIC X(1).
   310         16 SV-REC-TYP               PIC X.
   311         16  SV-NOTE-SEQUENCE        PIC S9(4) COMP.
   312     12  ELCERT-KEY.
   313         16  ELCERT-COMPANY-CD        PIC X.
   314         16  ELCERT-CARRIER           PIC X.
   315         16  ELCERT-GROUPING          PIC X(6).
   316         16  ELCERT-STATE             PIC XX.
   317         16  ELCERT-ACCOUNT           PIC X(10).
   318         16  ELCERT-EFF-DT            PIC XX.
   319         16  ELCERT-CERT-NO.
   320             20  ELCERT-CERT-PRIME    PIC X(10).
   321             20  ELCERT-CERT-SFX      PIC X.
   322     12  ELEOBC-FILE-ID          PIC X(08)  VALUE 'ELEOBC'.
   323     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   324     12  ELEOBC-KEY.
   325         16  EOBC-COMPANY-CD     PIC X.
   326         16  EOBC-REC-TYPE       PIC X.
   327         16  EOBC-CODE           PIC X(4).
   328         16  FILLER              PIC X(9).
   329     12  ERNOTE-FILE-ID          PIC X(08)  VALUE 'ERNOTE'.
   330     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   331     12  ERNOTE-KEY.
   332         16  ERNOTE-COMPANY-CD   PIC X.
   333         16  ERNOTE-CARRIER      PIC X.
   334         16  ERNOTE-GROUPING     PIC X(6).
   335         16  ERNOTE-STATE        PIC XX.
   336         16  ERNOTE-ACCOUNT      PIC X(10).
   337         16  ERNOTE-CERT-EFF-DT  PIC XX.
   338         16  ERNOTE-CERT-PRIME   PIC X(10).
   339         16  ERNOTE-CERT-SFX     PIC X.
   340         16  ernote-record-type  pic x.
   341     12  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
   342     12  ELLETR-KEY.
   343         16  LETR-PART-KEY.
   344             20  LETR-COMPANY-CD PIC X.
   345             20  LETR-LETTER-ID  PIC X(4).
   346         16  LETR-FILLER         PIC X(8).
   347         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   348     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   349 01  w-comment-line-1            pic x(63) value spaces.
   350 01  w-comment-line-2            pic x(63) value spaces.
   351 01  cert-note-records-holder.
   352     05  cert-note-record occurs 500.
   353         10  filler              pic x(48).
   354         10  cnr-rest            pic x(102).
   355
   356
   357 01  FILLER                      PIC  X(22)
   358                                 VALUE 'INTERFACE AREA STARTS:'.
   359*    COPY ELCINTF.
   360******************************************************************
   361*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   8
* EL691.cbl
   362*                                                                *
   363*                            ELCINTF.                            *
   364*                            VMOD=2.017                          *
   365*                                                                *
   366*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   367*                                                                *
   368*       LENGTH = 1024                                            *
   369*                                                                *
   370******************************************************************
   371*                   C H A N G E   L O G
   372*
   373* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   374*-----------------------------------------------------------------
   375*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   376* EFFECTIVE    NUMBER
   377*-----------------------------------------------------------------
   378* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   379******************************************************************
   380 01  PROGRAM-INTERFACE-BLOCK.
   381     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   382     12  PI-CALLING-PROGRAM              PIC X(8).
   383     12  PI-SAVED-PROGRAM-1              PIC X(8).
   384     12  PI-SAVED-PROGRAM-2              PIC X(8).
   385     12  PI-SAVED-PROGRAM-3              PIC X(8).
   386     12  PI-SAVED-PROGRAM-4              PIC X(8).
   387     12  PI-SAVED-PROGRAM-5              PIC X(8).
   388     12  PI-SAVED-PROGRAM-6              PIC X(8).
   389     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   390     12  PI-COMPANY-ID                   PIC XXX.
   391     12  PI-COMPANY-CD                   PIC X.
   392
   393     12  PI-COMPANY-PASSWORD             PIC X(8).
   394
   395     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   396
   397     12  PI-CONTROL-IN-PROGRESS.
   398         16  PI-CARRIER                  PIC X.
   399         16  PI-GROUPING                 PIC X(6).
   400         16  PI-STATE                    PIC XX.
   401         16  PI-ACCOUNT                  PIC X(10).
   402         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   403                                         PIC X(10).
   404         16  PI-CLAIM-CERT-GRP.
   405             20  PI-CLAIM-NO             PIC X(7).
   406             20  PI-CERT-NO.
   407                 25  PI-CERT-PRIME       PIC X(10).
   408                 25  PI-CERT-SFX         PIC X.
   409             20  PI-CERT-EFF-DT          PIC XX.
   410         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   411             20  PI-PLAN-CODE            PIC X(2).
   412             20  PI-REVISION-NUMBER      PIC X(3).
   413             20  PI-PLAN-EFF-DT          PIC X(2).
   414             20  PI-PLAN-EXP-DT          PIC X(2).
   415             20  FILLER                  PIC X(11).
   416         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   417             20  PI-OE-REFERENCE-1.
   418                 25  PI-OE-REF-1-PRIME   PIC X(18).
   419                 25  PI-OE-REF-1-SUFF    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   9
* EL691.cbl
   420
   421     12  PI-SESSION-IN-PROGRESS          PIC X.
   422         88  CLAIM-SESSION                   VALUE '1'.
   423         88  CREDIT-SESSION                  VALUE '2'.
   424         88  WARRANTY-SESSION                VALUE '3'.
   425         88  MORTGAGE-SESSION                VALUE '4'.
   426         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   427
   428
   429*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   430
   431     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   432     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   433
   434     12  PI-CREDIT-USER                  PIC X.
   435         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   436         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   437
   438     12  PI-CLAIM-USER                   PIC X.
   439         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   440         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   441
   442     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   443         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   444         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   445         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   446         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   447         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   448
   449     12  PI-PROCESSOR-ID                 PIC X(4).
   450
   451     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   452
   453     12  PI-MEMBER-CAPTION               PIC X(10).
   454
   455     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   456         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   457
   458     12  PI-LIFE-OVERRIDE-L1             PIC X.
   459     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   460     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   461     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   462
   463     12  PI-AH-OVERRIDE-L1               PIC X.
   464     12  PI-AH-OVERRIDE-L2               PIC XX.
   465     12  PI-AH-OVERRIDE-L6               PIC X(6).
   466     12  PI-AH-OVERRIDE-L12              PIC X(12).
   467
   468     12  PI-NEW-SYSTEM                   PIC X(2).
   469
   470     12  PI-PRIMARY-CERT-NO              PIC X(11).
   471     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   472         88  PI-USES-PAID-TO                 VALUE '1'.
   473     12  PI-CRDTCRD-SYSTEM.
   474         16  PI-CRDTCRD-USER             PIC X.
   475             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   476             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   477         16  PI-CC-MONTH-END-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  10
* EL691.cbl
   478     12  PI-PROCESSOR-PRINTER            PIC X(4).
   479
   480     12  PI-OE-REFERENCE-2.
   481         16  PI-OE-REF-2-PRIME           PIC X(10).
   482         16  PI-OE-REF-2-SUFF            PIC X.
   483
   484     12  PI-REM-TRM-CALC-OPTION          PIC X.
   485
   486     12  PI-LANGUAGE-TYPE                PIC X.
   487             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   488             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   489             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   490
   491     12  PI-POLICY-LINKAGE-IND           PIC X.
   492         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   493         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   494                                                   LOW-VALUES.
   495
   496     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   497     12  PI-CLAIM-PW-SESSION             PIC X(1).
   498         88  PI-CLAIM-CREDIT                 VALUE '1'.
   499         88  PI-CLAIM-CONVEN                 VALUE '2'.
   500
   501     12  PI-PROCESSOR-CSR-IND            PIC X.
   502         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   503         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   504
   505     12  FILLER                          PIC X(3).
   506
   507     12  PI-SYSTEM-LEVEL                 PIC X(145).
   508
   509     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   510         PI-SYSTEM-LEVEL.
   511
   512         16  PI-ENTRY-CODES.
   513             20  PI-ENTRY-CD-1           PIC X.
   514             20  PI-ENTRY-CD-2           PIC X.
   515
   516         16  PI-RETURN-CODES.
   517             20  PI-RETURN-CD-1          PIC X.
   518             20  PI-RETURN-CD-2          PIC X.
   519
   520         16  PI-UPDATE-STATUS-SAVE.
   521             20  PI-UPDATE-BY            PIC X(4).
   522             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   523
   524         16  PI-LOWER-CASE-LETTERS       PIC X.
   525             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   526
   527*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   528*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   529*            88  CARRIER-CLM-CNTL            VALUE '2'.
   530
   531         16  PI-CERT-ACCESS-CONTROL      PIC X.
   532             88  ST-ACCNT-CNTL               VALUE ' '.
   533             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   534             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   535             88  ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  11
* EL691.cbl
   536             88  CARR-ACCNT-CNTL             VALUE '4'.
   537
   538         16  PI-PROCESSOR-CAP-LIST.
   539             20  PI-SYSTEM-CONTROLS.
   540                24 PI-SYSTEM-DISPLAY     PIC X.
   541                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   542                24 PI-SYSTEM-MODIFY      PIC X.
   543                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   544             20  FILLER                  PIC XX.
   545             20  PI-DISPLAY-CAP          PIC X.
   546                 88  DISPLAY-CAP             VALUE 'Y'.
   547             20  PI-MODIFY-CAP           PIC X.
   548                 88  MODIFY-CAP              VALUE 'Y'.
   549             20  PI-MSG-AT-LOGON-CAP     PIC X.
   550                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   551             20  PI-FORCE-CAP            PIC X.
   552                 88  FORCE-CAP               VALUE 'Y'.
   553
   554         16  PI-PROGRAM-CONTROLS.
   555             20  PI-PGM-PRINT-OPT        PIC X.
   556             20  PI-PGM-FORMAT-OPT       PIC X.
   557             20  PI-PGM-PROCESS-OPT      PIC X.
   558             20  PI-PGM-TOTALS-OPT       PIC X.
   559
   560         16  PI-HELP-INTERFACE.
   561             20  PI-LAST-ERROR-NO        PIC X(4).
   562             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   563
   564         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   565             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   566
   567         16  PI-CR-CONTROL-IN-PROGRESS.
   568             20  PI-CR-CARRIER           PIC X.
   569             20  PI-CR-GROUPING          PIC X(6).
   570             20  PI-CR-STATE             PIC XX.
   571             20  PI-CR-ACCOUNT           PIC X(10).
   572             20  PI-CR-FIN-RESP          PIC X(10).
   573             20  PI-CR-TYPE              PIC X.
   574
   575         16  PI-CR-BATCH-NUMBER          PIC X(6).
   576
   577         16  PI-CR-MONTH-END-DT          PIC XX.
   578
   579         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   580             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   581             88  PI-ZERO-CARRIER             VALUE '1'.
   582             88  PI-ZERO-GROUPING            VALUE '2'.
   583             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   584
   585         16  PI-CARRIER-SECURITY         PIC X.
   586             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   587
   588         16  PI-ACCOUNT-SECURITY         PIC X(10).
   589             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   590             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   591
   592         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   593             20  PI-ACCESS-CODE          OCCURS 10 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  12
* EL691.cbl
   594                                         INDEXED BY PI-ACCESS-NDX
   595                                         PIC X.
   596
   597         16  PI-GA-BILLING-CONTROL       PIC X.
   598             88  PI-GA-BILLING               VALUE '1'.
   599
   600         16  PI-MAIL-PROCESSING          PIC X.
   601             88  PI-MAIL-YES                 VALUE 'Y'.
   602
   603         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   604
   605         16  PI-AR-SYSTEM.
   606             20  PI-AR-PROCESSING-CNTL   PIC X.
   607                 88  PI-AR-PROCESSING        VALUE 'Y'.
   608             20  PI-AR-SUMMARY-CODE      PIC X(6).
   609             20  PI-AR-MONTH-END-DT      PIC XX.
   610
   611         16  PI-MP-SYSTEM.
   612             20  PI-MORTGAGE-USER            PIC X.
   613                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   614                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   615             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   616                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   617                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   618                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   619                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   620                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   621             20  PI-MP-MONTH-END-DT          PIC XX.
   622             20  PI-MP-REFERENCE-NO.
   623                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   624                 24  PI-MP-REFERENCE-SFX     PIC XX.
   625
   626         16  PI-LABEL-CONTROL            PIC X(01).
   627             88  PI-CREATE-LABELS                    VALUE 'Y'.
   628             88  PI-BYPASS-LABELS                    VALUE 'N'.
   629
   630         16  PI-BILL-GROUPING-CODE       PIC X(01).
   631             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   632
   633         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   634             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   635             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   636
   637         16  FILLER                      PIC X(14).
   638
   639     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   640******************************************************************
   641     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   642*    COPY ELC1042.
   643******************************************************************
   644*                                                                *
   645*                                                                *
   646*                           ELC1042                              *
   647*                            VMOD=2.002                          *
   648*                                                                *
   649*    NOTE                                                        *
   650*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   651*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  13
* EL691.cbl
   652*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   653*        TO THESE PROGRAMS.                                      *
   654*                                                                *
   655*    NOTE                                                        *
   656*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   657*        USE ONLY!                                               *
   658*                                                                *
   659******************************************************************
   660
   661         16  PI-1042-WA.
   662             20  PI-ACTION       PIC  X(01).
   663                 88 PI-SHOW-MODE           VALUE '1'.
   664                 88 PI-CLEAR-MODE          VALUE '2'.
   665                 88 PI-CREATE-MODE         VALUE '3'.
   666             20  PI-COMM-CONTROL PIC  X(12).
   667             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   668             20  PI-EOF-SW       PIC  X(01).
   669                 88  PI-FILE-EOF           VALUE 'Y'.
   670             20  PI-FILETYP      PIC  X(01).
   671             20  PI-FORM-SQUEEZE-CONTROL
   672                                 PIC  X(01).
   673                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   674                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   675             20  PI-LAST-CONTROL PIC  X(12).
   676             20  PI-TEMP-STOR-ITEMS
   677                                 PIC S9(04) COMP.
   678             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   679             20  PI-UPDATE-SW    PIC  9(01).
   680                 88 ANY-UPDATES            VALUE 1.
   681             20  PI-104-SCREEN-SENT-IND
   682                                 PIC  X(01).
   683                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   684                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   685             20  PI-1042-SCREEN-SENT-IND
   686                                 PIC  X(01).
   687                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   688                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   689             20  PI-1042-ARCHIVE-IND
   690                                 PIC  X(01).
   691                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   692             20  FILLER          PIC  X(29).
   693*    COPY ELC689PI.
   694******************************************************************
   695*                                                                *
   696*                            ELC689PI                            *
   697*                            VMOD=2.003                          *
   698*                                                                *
   699*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   700*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   701*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   702*                                                                *
   703*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   704*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   705*    BETWEEN PROGRAMS.                                           *
   706*                                                                *
   707*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   708*                                                                *
   709*               EL631 - EL689  - EL6891 - EL6892                 *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  14
* EL691.cbl
   710*                                                                *
   711******************************************************************
   712*                   C H A N G E   L O G
   713*
   714* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   715*-----------------------------------------------------------------
   716*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   717* EFFECTIVE    NUMBER
   718*-----------------------------------------------------------------
   719* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   720* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   721* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   722******************************************************************
   723
   724
   725         16  PI-689-WORK-AREA.
   726             20  PI-689-ALT-PRINTER-ID
   727                                 PIC  X(04).
   728             20  PI-689-ARCHIVE-NUMBER
   729                                 PIC  9(08).
   730             20  PI-689-ARCHIVE-SW
   731                                 PIC  X(01).
   732                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   733             20  PI-689-DATA-SOURCE
   734                                 PIC  X(01).
   735                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   736                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   737                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   738                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   739                 88  PI-689-SRC-CHECKS         VALUE '5'.
   740             20  PI-689-ERROR-IND
   741                                 PIC  X(01).
   742                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   743             20  PI-689-ERROR    PIC  9(04).
   744                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   745                 88  PI-689-FATAL-ERROR
   746                     VALUES 0004 0006 0008 0013 0023 0029 0033
   747                            0042 0047 0051 0066 0067 0070
   748                            0168 0169 0174 0175 0176 0177 0179
   749                            0180 0181 0182 0184 0185 0189 0190
   750                            0191
   751                            0215 0279 0280
   752                            0412 0413 0454
   753                            0533 0537
   754                            2055 2114 2208 2209 2216 2232 2369
   755                            2398 2433 2908 2999
   756                            3000 3770 3771 3775
   757                            7250 7365 7367 7368 7369 7370 7371
   758                            7272 7373 7374 7376 7377 7378 7379
   759                            7381 7388 7390 7393 7395 7396 7398
   760                            9095 9096 9281 9298 9299 9320 9327
   761                            9426 9427.
   762                 88  PI-689-STOP-ERROR
   763                     VALUES 0004 0008 0013 0023 0029 0033
   764                            0042 0047 0066 0067 0070
   765                            0168 0169 0174 0175 0176 0177
   766                            0181 0182 0184 0185 0189 0190
   767                            0279 0280
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  15
* EL691.cbl
   768                            0412 0413 0454
   769                            2055 2208 2209 2216 2232
   770                            2398 2999
   771                            3000 3770 3771 3775
   772                            7250 7365 7369 7370 7371
   773                            7272 7373 7374 7376 7377 7378 7379
   774                            7381 7388 7390 7393 7396 7398
   775                            9095 9096 9299 9320 9426.
   776             20  PI-689-FOLLOW-UP-DATE
   777                                 PIC  X(02).
   778             20  PI-689-FORM-NUMBER
   779                                 PIC  X(04).
   780             20  PI-689-LABEL-SOURCE
   781                                 PIC X(01).
   782                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   783                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   784                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   785                 88  PI-689-SOURCE-COMP     VALUE '4'.
   786                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   787                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   788                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   789             20  PI-689-NUMBER-COPIES
   790                                 PIC  9(01).
   791             20  PI-689-NUMBER-LABEL-LINES
   792                                 PIC  9(01).
   793             20  PI-689-NUMBER-TEXT-RECORDS
   794                                 PIC  9(03).
   795             20  PI-689-PRINT-ORDER-SW
   796                                 PIC  X(01).
   797                 88  PI-689-PRINT-FIRST     VALUE '1'.
   798                 88  PI-689-PRINT-SECOND    VALUE '2'.
   799                 88  PI-689-PRINT-LATER     VALUE '3'.
   800                 88  PI-689-PRINT-ONLY      VALUE '4'.
   801             20  PI-689-PRINT-RESTRICTION
   802                                 PIC  X(01).
   803                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   804                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
   805                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   806             20  PI-689-PRINT-SW PIC  X(01).
   807                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   808             20  PI-689-RESEND-DATE-1
   809                                 PIC  X(02).
   810             20  PI-689-RESEND-LETR-1
   811                                 PIC X(4).
   812             20  PI-689-TEMP-STOR-ID
   813                                 PIC  X(08).
   814             20  PI-689-USE-SCREEN-IND
   815                                 PIC  X(01).
   816                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   817             20  PI-689-ARCH-POINTER
   818                                 PIC S9(08) COMP.
   819                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   820             20  PI-689-ARCT-POINTER
   821                                 PIC S9(08) COMP.
   822                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   823             20  PI-689-VARIABLE-DATA-GRP.
   824                 24  PI-689-VARIABLE-DATA-1
   825                                 PIC  X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  16
* EL691.cbl
   826                 24  PI-689-VARIABLE-DATA-2
   827                                 PIC  X(30).
   828                 24  PI-689-VARIABLE-DATA-3
   829                                 PIC  X(30).
   830                 24  PI-689-VARIABLE-DATA-4
   831                                 PIC  X(30).
   832
   833         16  PI-689-KEY-DATA-FIELDS.
   834             20  PI-689-ACCOUNT  PIC  X(10).
   835             20  PI-689-CARRIER  PIC  X(01).
   836             20  PI-689-CERT-NO.
   837                 24  PI-689-CERT-PRIME
   838                                 PIC  X(10).
   839                 24  PI-689-CERT-SFX
   840                                 PIC  X(01).
   841             20  PI-689-CHG-SEQ-NO
   842                                 PIC S9(04)    COMP.
   843             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
   844                                 PIC  X(02).
   845             20  PI-689-ENTRY-BATCH
   846                                 PIC  X(06).
   847             20  PI-689-EFF-DATE PIC  X(02).
   848             20  PI-689-EXP-DATE PIC  X(02).
   849             20  PI-689-GROUPING PIC  X(06).
   850             20  PI-689-RESP-PERSON
   851                                 PIC  X(10).
   852             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   853             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   854                                 PIC  X(04).
   855             20  PI-689-STATE    PIC  X(02).
   856             20  PI-689-TYPE     PIC  X(01).
   857             20  PI-689-CONTROL  PIC S9(08)    COMP.
   858             20  PI-689-ALT-SEQ-NO
   859                                 PIC S9(04)    COMP.
   860         16  PI-689-DATE-EDIT    PIC  X(08).
   861         16  PI-689-FOLLOW-UP-EDIT
   862                                 PIC  X(08).
   863         16  PI-689-RESEND1-EDIT PIC  X(08).
   864         16  PI-689-SEQ-EDIT     PIC  X(08).
   865         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   866         16  PI-689-LBL-OVERRIDE PIC  X(01).
   867             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   868         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   869         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   870         16  PI-690-WORK-AREA.
   871             20  PI-690-ARCHIVE-TABLE.
   872                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
   873                                 PIC S9(08) COMP.
   874             20  PI-690-CURSOR   PIC S9(04) COMP.
   875             20  PI-690-FIRST-DATA.
   876                 24  PI-690-FIRST-CERT-NO.
   877                     28  PI-690-FIRST-CERT-PRIME
   878                                 PIC  X(10).
   879                     28  PI-690-FIRST-SUFFIX
   880                                 PIC  X(01).
   881                 24  PI-690-FIRST-CARRIER
   882                                 PIC  X(01).
   883                 24  PI-690-FIRST-GROUPING
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  17
* EL691.cbl
   884                                 PIC  X(06).
   885                 24  PI-690-FIRST-STATE
   886                                 PIC  X(02).
   887                 24  PI-690-FIRST-ACCOUNT
   888                                 PIC  X(10).
   889                 24  PI-690-FIRST-EFFECT-DATE
   890                                 PIC  X(02).
   891                 24  PI-690-FIRST-ENTRY.
   892                     28  PI-690-FIRST-CONTROL-PREFIX
   893                                 PIC  X(02).
   894                     28  PI-690-FIRST-CONTROL
   895                                 PIC S9(08) COMP.
   896                 24  PI-690-FIRST-FORM
   897                                 PIC  X(04).
   898                 24  PI-690-FIRST-PROCESSOR
   899                                 PIC  X(04).
   900                 24  PI-690-FIRST-ARCHIVE-NO
   901                                 PIC S9(08) COMP.
   902             20  PI-690-INIT-DATA.
   903                 24  PI-690-INIT-CERT-NO.
   904                     28  PI-690-INIT-CERT-PRIME
   905                                 PIC  X(10).
   906                     28  PI-690-INIT-SUFFIX
   907                                 PIC  X(01).
   908                 24  PI-690-INIT-CARRIER
   909                                 PIC  X(01).
   910                 24  PI-690-INIT-GROUPING
   911                                 PIC  X(06).
   912                 24  PI-690-INIT-STATE
   913                                 PIC  X(02).
   914                 24  PI-690-INIT-ACCOUNT
   915                                 PIC  X(10).
   916                 24  PI-690-INIT-EFFECT-DATE
   917                                 PIC  X(02).
   918                 24  PI-690-INIT-EFF-DTE
   919                                 PIC  X(08).
   920                 24  PI-690-INIT-ENTRY.
   921                     28  PI-690-INIT-CONTROL-PREFIX
   922                                 PIC  X(02).
   923                     28  PI-690-INIT-CONTROL
   924                                 PIC S9(08) COMP.
   925                 24  PI-690-INIT-FORM
   926                                 PIC  X(04).
   927                 24  PI-690-INIT-PROCESSOR
   928                                 PIC  X(04).
   929                 24  PI-690-INIT-ARCHIVE-NO
   930                                 PIC S9(08) COMP.
   931             20  PI-690-LAST-DATA.
   932                 24  PI-690-LAST-CERT-NO.
   933                     28  PI-690-LAST-CERT-PRIME
   934                                 PIC  X(10).
   935                     28  PI-690-LAST-SUFFIX
   936                                 PIC  X(01).
   937                 24  PI-690-LAST-CARRIER
   938                                 PIC  X(01).
   939                 24  PI-690-LAST-GROUPING
   940                                 PIC  X(06).
   941                 24  PI-690-LAST-STATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  18
* EL691.cbl
   942                                 PIC  X(02).
   943                 24  PI-690-LAST-ACCOUNT
   944                                 PIC  X(10).
   945                 24  PI-690-LAST-EFFECT-DATE
   946                                 PIC  X(02).
   947                 24  PI-690-LAST-ENTRY.
   948                     28  PI-690-LAST-CONTROL-PREFIX
   949                                 PIC  X(02).
   950                     28  PI-690-LAST-CONTROL
   951                                 PIC S9(08) COMP.
   952                 24  PI-690-LAST-FORM
   953                                 PIC  X(04).
   954                 24  PI-690-LAST-PROCESSOR
   955                                 PIC  X(04).
   956                 24  PI-690-LAST-ARCHIVE-NO
   957                                 PIC S9(08) COMP.
   958             20  PI-690-LAST-ARCH-NDX
   959                                 PIC S9(04) COMP.
   960             20  PI-690-BRWS-TYPE-IND
   961                                 PIC  9(01).
   962                 88  PI-690-BRWS-CERTRP               VALUE 1.
   963                 88  PI-690-BRWS-FORM                 VALUE 2.
   964                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
   965                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
   966                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
   967                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
   968             20  PI-690-LAST-BROWSE-IND
   969                                 PIC  X(01).
   970                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
   971                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
   972             20  PI-690-STATUS-SELECTION-IND
   973                                 PIC  X(01).
   974                 88  PI-690-SELECT-ALL       VALUE 'N'.
   975                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
   976                                               'X' 'P' 'V' 'N'.
   977         16  PI-ARCHIVE-COMPLETE    PIC X(01).
   978         16  PI-ARCHIVE-RECEIVED    PIC X(01).
   979         16  PI-ARCHIVE-STOPPED     PIC X(01).
   980         16  PI-ARCHIVE-FINAL       PIC X(01).
   981         16  PI-COMMENT-INDEX       PIC S9(4) COMP.
   982         16  PI-ARCHIVE-LTRID       PIC X(4).
   983         16  pi-create-date         pic x(08).
   984         16  pi-initial-print-date  pic xx.
   985         16  FILLER              PIC X(49).
   986
   987 01  W-CONSTANT-AREA.
   988     12  FILLER                  PIC  X(18)
   989                                 VALUE 'PROGRAM CONSTANTS:'.
   990     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
   991
   992     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
   993     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
   994     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
   995     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
   996     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
   997     12  W-MAP                   PIC  X(08)  VALUE 'EL691A'.
   998     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
   999         16  FILLER              PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  19
* EL691.cbl
  1000         16  W-MAP-NUM           PIC  X(06).
  1001     12  W-MAPSET                PIC  X(08)  VALUE 'EL691S'.
  1002     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL691'.
  1003     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXN1'.
  1004     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
  1005     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
  1006     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
  1007     12  SLASH                   PIC X       VALUE '/'.
  1008     12  W-ZEROS                 PIC  S9(03) VALUE +0 COMP-3.
  1009     12  W-ADD-ARCT              PIC  X      VALUE 'N'.
  1010     12  W-DONE-ADDING           PIC  X      VALUE 'N'.
  1011     12  W-NEED-COMMENT          PIC  X      VALUE 'N'.
  1012
  1013 01  ERROR-MESSAGES.
  1014     12  ER-0000                 PIC  X(04) VALUE '0000'.
  1015     12  ER-0004                 PIC  X(04) VALUE '0004'.
  1016     12  ER-0029                 PIC  X(04) VALUE '0029'.
  1017     12  ER-0051                 PIC  X(04) VALUE '0051'.
  1018     12  ER-0070                 PIC  X(04) VALUE '0070'.
  1019     12  ER-0249                 PIC  X(04) VALUE '0249'.
  1020     12  ER-0295                 PIC  X(04) VALUE '0295'.
  1021     12  ER-0296                 PIC  X(04) VALUE '0296'.
  1022     12  ER-0539                 PIC  X(04) VALUE '0539'.
  1023     12  ER-0895                 PIC  X(04) VALUE '0895'.
  1024     12  ER-0897                 PIC  X(04) VALUE '0897'.
  1025     12  ER-1236                 PIC  X(04) VALUE '1236'.
  1026     12  ER-3112                 PIC  X(04) VALUE '3112'.
  1027     12  ER-7008                 PIC  X(04) VALUE '7008'.
  1028     12  ER-7330                 PIC  X(04) VALUE '7330'.
  1029     12  ER-7331                 PIC  X(04) VALUE '7331'.
  1030     12  ER-7332                 PIC  X(04) VALUE '7332'.
  1031     12  ER-7333                 PIC  X(04) VALUE '7333'.
  1032     12  ER-7334                 PIC  X(04) VALUE '7334'.
  1033     12  ER-7363                 PIC  X(04) VALUE '7363'.
  1034     12  ER-7364                 PIC  X(04) VALUE '7364'.
  1035     12  ER-7371                 PIC  X(04) VALUE '7371'.
  1036     12  ER-7373                 PIC  X(04) VALUE '7373'.
  1037     12  ER-7388                 PIC  X(04) VALUE '7388'.
  1038     12  ER-9097                 PIC  X(04) VALUE '9097'.
  1039     12  ER-9245                 PIC  X(04) VALUE '9245'.
  1040*                                COPY ELCAID.
  1041******************************************************************
  1042*                                                                *
  1043*                            ELCAID.                             *
  1044*                            VMOD=2.001                          *
  1045*                                                                *
  1046*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1047*                                                                *
  1048*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1049*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1050******************************************************************
  1051
  1052 01  DFHAID.
  1053   02  DFHNULL   PIC  X  VALUE  ' '.
  1054   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1055   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1056   02  DFHPEN    PIC  X  VALUE  '='.
  1057   02  DFHOPID   PIC  X  VALUE  'W'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  20
* EL691.cbl
  1058   02  DFHPA1    PIC  X  VALUE  '%'.
  1059   02  DFHPA2    PIC  X  VALUE  '>'.
  1060   02  DFHPA3    PIC  X  VALUE  ','.
  1061   02  DFHPF1    PIC  X  VALUE  '1'.
  1062   02  DFHPF2    PIC  X  VALUE  '2'.
  1063   02  DFHPF3    PIC  X  VALUE  '3'.
  1064   02  DFHPF4    PIC  X  VALUE  '4'.
  1065   02  DFHPF5    PIC  X  VALUE  '5'.
  1066   02  DFHPF6    PIC  X  VALUE  '6'.
  1067   02  DFHPF7    PIC  X  VALUE  '7'.
  1068   02  DFHPF8    PIC  X  VALUE  '8'.
  1069   02  DFHPF9    PIC  X  VALUE  '9'.
  1070   02  DFHPF10   PIC  X  VALUE  ':'.
  1071   02  DFHPF11   PIC  X  VALUE  '#'.
  1072   02  DFHPF12   PIC  X  VALUE  '@'.
  1073   02  DFHPF13   PIC  X  VALUE  'A'.
  1074   02  DFHPF14   PIC  X  VALUE  'B'.
  1075   02  DFHPF15   PIC  X  VALUE  'C'.
  1076   02  DFHPF16   PIC  X  VALUE  'D'.
  1077   02  DFHPF17   PIC  X  VALUE  'E'.
  1078   02  DFHPF18   PIC  X  VALUE  'F'.
  1079   02  DFHPF19   PIC  X  VALUE  'G'.
  1080   02  DFHPF20   PIC  X  VALUE  'H'.
  1081   02  DFHPF21   PIC  X  VALUE  'I'.
  1082*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1083   02  DFHPF22   PIC  X  VALUE  '['.
  1084   02  DFHPF23   PIC  X  VALUE  '.'.
  1085   02  DFHPF24   PIC  X  VALUE  '<'.
  1086   02  DFHMSRE   PIC  X  VALUE  'X'.
  1087   02  DFHSTRF   PIC  X  VALUE  'h'.
  1088   02  DFHTRIG   PIC  X  VALUE  '"'.
  1089 01  FILLER    REDEFINES DFHAID.
  1090     12  FILLER                  PIC  X(08).
  1091     12  PF-VALUES               PIC  X(01) OCCURS 2.
  1092*                                COPY ELCATTR.
  1093******************************************************************
  1094*                                                                *
  1095*                            ELCATTR.                            *
  1096*                            VMOD=2.001                          *
  1097*                                                                *
  1098*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1099*                                                                *
  1100*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1101*                                                                *
  1102*                   POS 1   P=PROTECTED                          *
  1103*                           U=UNPROTECTED                        *
  1104*                           S=ASKIP                              *
  1105*                   POS 2   A=ALPHA/NUMERIC                      *
  1106*                           N=NUMERIC                            *
  1107*                   POS 3   N=NORMAL                             *
  1108*                           B=BRIGHT                             *
  1109*                           D=DARK                               *
  1110*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1111*                           OF=MODIFIED DATA TAG OFF             *
  1112*                                                                *
  1113*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1114******************************************************************
  1115 01  ATTRIBUTE-LIST.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  21
* EL691.cbl
  1116     12  AL-PABOF            PIC X       VALUE 'Y'.
  1117     12  AL-PABON            PIC X       VALUE 'Z'.
  1118     12  AL-PADOF            PIC X       VALUE '%'.
  1119     12  AL-PADON            PIC X       VALUE '_'.
  1120     12  AL-PANOF            PIC X       VALUE '-'.
  1121     12  AL-PANON            PIC X       VALUE '/'.
  1122     12  AL-SABOF            PIC X       VALUE '8'.
  1123     12  AL-SABON            PIC X       VALUE '9'.
  1124     12  AL-SADOF            PIC X       VALUE '@'.
  1125     12  AL-SADON            PIC X       VALUE QUOTE.
  1126     12  AL-SANOF            PIC X       VALUE '0'.
  1127     12  AL-SANON            PIC X       VALUE '1'.
  1128     12  AL-UABOF            PIC X       VALUE 'H'.
  1129     12  AL-UABON            PIC X       VALUE 'I'.
  1130     12  AL-UADOF            PIC X       VALUE '<'.
  1131     12  AL-UADON            PIC X       VALUE '('.
  1132     12  AL-UANOF            PIC X       VALUE ' '.
  1133     12  AL-UANON            PIC X       VALUE 'A'.
  1134     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1135     12  AL-UNBON            PIC X       VALUE 'R'.
  1136     12  AL-UNDOF            PIC X       VALUE '*'.
  1137     12  AL-UNDON            PIC X       VALUE ')'.
  1138     12  AL-UNNOF            PIC X       VALUE '&'.
  1139     12  AL-UNNON            PIC X       VALUE 'J'.
  1140*                                COPY ELCDATE.
  1141******************************************************************
  1142*                                                                *
  1143*                                                                *
  1144*                            ELCDATE.                            *
  1145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1146*                            VMOD=2.003
  1147*                                                                *
  1148*                                                                *
  1149*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1150*                 LENGTH = 200                                   *
  1151******************************************************************
  1152
  1153 01  DATE-CONVERSION-DATA.
  1154     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1155     12  DC-OPTION-CODE                PIC X.
  1156         88  BIN-TO-GREG                VALUE ' '.
  1157         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1158         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1159         88  YMD-GREG-TO-BIN            VALUE '3'.
  1160         88  MDY-GREG-TO-BIN            VALUE '4'.
  1161         88  JULIAN-TO-BIN              VALUE '5'.
  1162         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1163         88  FIND-CENTURY               VALUE '7'.
  1164         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1165         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1166         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1167         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1168         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1169         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1170         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1171         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1172         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1173         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  22
* EL691.cbl
  1174         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1175         88  BIN-3-TO-GREG              VALUE 'I'.
  1176         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1177         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1178         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1179         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1180         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1181         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1182         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1183         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1184         88  THREE-CHARACTER-BIN
  1185                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1186         88  GREGORIAN-TO-BIN
  1187                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1188         88  BIN-TO-GREGORIAN
  1189                  VALUES ' ' '1' 'I' '8' 'G'.
  1190         88  JULIAN-TO-BINARY
  1191                  VALUES '5' 'C' 'E' 'F'.
  1192     12  DC-ERROR-CODE                 PIC X.
  1193         88  NO-CONVERSION-ERROR        VALUE ' '.
  1194         88  DATE-CONVERSION-ERROR
  1195                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1196         88  DATE-IS-ZERO               VALUE '1'.
  1197         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1198         88  DATE-IS-INVALID            VALUE '3'.
  1199         88  DATE1-GREATER-DATE2        VALUE '4'.
  1200         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1201         88  DATE-INVALID-OPTION        VALUE '9'.
  1202         88  INVALID-CENTURY            VALUE 'A'.
  1203         88  ONLY-CENTURY               VALUE 'B'.
  1204         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1205         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1206     12  DC-END-OF-MONTH               PIC X.
  1207         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1208     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1209         88  USE-NORMAL-PROCESS         VALUE ' '.
  1210         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1211         88  ADJUST-UP-100-YRS          VALUE '2'.
  1212     12  FILLER                        PIC X.
  1213     12  DC-CONVERSION-DATES.
  1214         16  DC-BIN-DATE-1             PIC XX.
  1215         16  DC-BIN-DATE-2             PIC XX.
  1216         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1217         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1218                       DC-GREG-DATE-1-EDIT.
  1219             20  DC-EDIT1-MONTH        PIC 99.
  1220             20  SLASH1-1              PIC X.
  1221             20  DC-EDIT1-DAY          PIC 99.
  1222             20  SLASH1-2              PIC X.
  1223             20  DC-EDIT1-YEAR         PIC 99.
  1224         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1225         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1226                     DC-GREG-DATE-2-EDIT.
  1227             20  DC-EDIT2-MONTH        PIC 99.
  1228             20  SLASH2-1              PIC X.
  1229             20  DC-EDIT2-DAY          PIC 99.
  1230             20  SLASH2-2              PIC X.
  1231             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  23
* EL691.cbl
  1232         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1233         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1234                     DC-GREG-DATE-1-YMD.
  1235             20  DC-YMD-YEAR           PIC 99.
  1236             20  DC-YMD-MONTH          PIC 99.
  1237             20  DC-YMD-DAY            PIC 99.
  1238         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1239         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1240                      DC-GREG-DATE-1-MDY.
  1241             20  DC-MDY-MONTH          PIC 99.
  1242             20  DC-MDY-DAY            PIC 99.
  1243             20  DC-MDY-YEAR           PIC 99.
  1244         16  DC-GREG-DATE-1-ALPHA.
  1245             20  DC-ALPHA-MONTH        PIC X(10).
  1246             20  DC-ALPHA-DAY          PIC 99.
  1247             20  FILLER                PIC XX.
  1248             20  DC-ALPHA-CENTURY.
  1249                 24 DC-ALPHA-CEN-N     PIC 99.
  1250             20  DC-ALPHA-YEAR         PIC 99.
  1251         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1252         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1253         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1254         16  DC-JULIAN-DATE            PIC 9(05).
  1255         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1256                                       PIC 9(05).
  1257         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1258             20  DC-JULIAN-YEAR        PIC 99.
  1259             20  DC-JULIAN-DAYS        PIC 999.
  1260         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1261         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1262         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1263     12  DATE-CONVERSION-VARIBLES.
  1264         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1265         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1266             20  FILLER                PIC 9(3).
  1267             20  HOLD-CEN-1-CCYY.
  1268                 24  HOLD-CEN-1-CC     PIC 99.
  1269                 24  HOLD-CEN-1-YY     PIC 99.
  1270             20  HOLD-CEN-1-MO         PIC 99.
  1271             20  HOLD-CEN-1-DA         PIC 99.
  1272         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1273             20  HOLD-CEN-1-R-MO       PIC 99.
  1274             20  HOLD-CEN-1-R-DA       PIC 99.
  1275             20  HOLD-CEN-1-R-CCYY.
  1276                 24  HOLD-CEN-1-R-CC   PIC 99.
  1277                 24  HOLD-CEN-1-R-YY   PIC 99.
  1278             20  FILLER                PIC 9(3).
  1279         16  HOLD-CENTURY-1-X.
  1280             20  FILLER                PIC X(3)  VALUE SPACES.
  1281             20  HOLD-CEN-1-X-CCYY.
  1282                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1283                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1284             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1285             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1286         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1287             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1288             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1289             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  24
* EL691.cbl
  1290                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1291                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1292             20  FILLER                PIC XXX.
  1293         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1294         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1295         16  DC-JULIAN-DATE-1          PIC 9(07).
  1296         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1297             20  DC-JULIAN-1-CCYY.
  1298                 24  DC-JULIAN-1-CC    PIC 99.
  1299                 24  DC-JULIAN-1-YR    PIC 99.
  1300             20  DC-JULIAN-DA-1        PIC 999.
  1301         16  DC-JULIAN-DATE-2          PIC 9(07).
  1302         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1303             20  DC-JULIAN-2-CCYY.
  1304                 24  DC-JULIAN-2-CC    PIC 99.
  1305                 24  DC-JULIAN-2-YR    PIC 99.
  1306             20  DC-JULIAN-DA-2        PIC 999.
  1307         16  DC-GREG-DATE-A-EDIT.
  1308             20  DC-EDITA-MONTH        PIC 99.
  1309             20  SLASHA-1              PIC X VALUE '/'.
  1310             20  DC-EDITA-DAY          PIC 99.
  1311             20  SLASHA-2              PIC X VALUE '/'.
  1312             20  DC-EDITA-CCYY.
  1313                 24  DC-EDITA-CENT     PIC 99.
  1314                 24  DC-EDITA-YEAR     PIC 99.
  1315         16  DC-GREG-DATE-B-EDIT.
  1316             20  DC-EDITB-MONTH        PIC 99.
  1317             20  SLASHB-1              PIC X VALUE '/'.
  1318             20  DC-EDITB-DAY          PIC 99.
  1319             20  SLASHB-2              PIC X VALUE '/'.
  1320             20  DC-EDITB-CCYY.
  1321                 24  DC-EDITB-CENT     PIC 99.
  1322                 24  DC-EDITB-YEAR     PIC 99.
  1323         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1324         16  DC-GREG-DATE-CYMD-R REDEFINES
  1325                              DC-GREG-DATE-CYMD.
  1326             20  DC-CYMD-CEN           PIC 99.
  1327             20  DC-CYMD-YEAR          PIC 99.
  1328             20  DC-CYMD-MONTH         PIC 99.
  1329             20  DC-CYMD-DAY           PIC 99.
  1330         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1331         16  DC-GREG-DATE-MDCY-R REDEFINES
  1332                              DC-GREG-DATE-MDCY.
  1333             20  DC-MDCY-MONTH         PIC 99.
  1334             20  DC-MDCY-DAY           PIC 99.
  1335             20  DC-MDCY-CEN           PIC 99.
  1336             20  DC-MDCY-YEAR          PIC 99.
  1337    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1338        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1339    12  DC-EL310-DATE                  PIC X(21).
  1340    12  FILLER                         PIC X(28).
  1341*                                COPY ELCTEXT.
  1342******************************************************************
  1343*                                                                *
  1344*                                                                *
  1345*                            ELCTEXT.                            *
  1346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1347*                            VMOD=2.008                          *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  25
* EL691.cbl
  1348*                                                                *
  1349*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1350*                                     FORM LETTERS,              *
  1351*                                     CERT FORM DISPLAY.
  1352*                                                                *
  1353*   FILE TYPE = VSAM,KSDS                                        *
  1354*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1355*                                                                *
  1356*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1357*       ALTERNATE INDEX = NONE                                   *
  1358*                                                                *
  1359*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1360*       ALTERNATE INDEX = NONE                                   *
  1361*                                                                *
  1362*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1363*       ALTERNATE INDEX = NONE                                   *
  1364*                                                                *
  1365*   LOG = NO                                                     *
  1366*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1367******************************************************************
  1368 01  TEXT-FILES.
  1369     12  TEXT-FILE-ID                PIC XX.
  1370         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1371         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1372         88  HELP-FILE-TEXT             VALUE 'TH'.
  1373
  1374     12  TX-CONTROL-PRIMARY.
  1375         16  TX-COMPANY-CD           PIC X.
  1376             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1377         16  TX-ACCESS-CD-GENL       PIC X(12).
  1378
  1379         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1380             20  TX-LETTER-NO        PIC X(4).
  1381             20  FILLER              PIC X(8).
  1382
  1383         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1384             20  TX-FORM-NO          PIC X(12).
  1385
  1386         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1387             20  TX-HELP-TYPE        PIC X.
  1388                 88  HELP-FOR-GENERAL   VALUE ' '.
  1389                 88  HELP-BY-SCREEN     VALUE 'S'.
  1390                 88  HELP-BY-ERROR      VALUE 'E'.
  1391             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1392                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1393             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1394                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1395             20  FILLER              PIC X(4).
  1396
  1397         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1398
  1399     12  TX-PROCESS-CONTROL          PIC XX.
  1400         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1401
  1402     12  TX-TEXT-LINE                PIC X(70).
  1403
  1404     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1405         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  26
* EL691.cbl
  1406         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1407         88  TX-VALID-FORM-SQUEEZE-VALUE
  1408                                        VALUE 'Y' ' '.
  1409
  1410     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1411         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1412         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1413         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1414         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1415         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1416         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1417         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1418                                              'K' 'N' ' '
  1419                                              'Z'.
  1420
  1421     12  TX-ARCHIVE-SW               PIC X.
  1422         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1423         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1424         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1425
  1426     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1427     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1428
  1429     12  TX-BSR-CODE                 PIC X.
  1430         88  TX-BSR-LETTER              VALUE 'B'.
  1431         88  TX-NON-BSR-LETTER          VALUE ' '.
  1432
  1433     12  FILLER                      PIC X.
  1434*****************************************************************
  1435*                                COPY ELCNWA.
  1436*****************************************************************
  1437*                                                               *
  1438*                                                               *
  1439*                            ELCNWA.                            *
  1440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1441*                            VMOD=2.003                         *
  1442*                                                               *
  1443*            M O V E   N A M E   W O R K   A R E A.             *
  1444*                                                               *
  1445*****************************************************************.
  1446
  1447 01  WS-NAME-WORK-AREA.
  1448     05  WS-INSURED-LAST-NAME        PIC X(15).
  1449     05  WS-INSURED-1ST-NAME         PIC X(12).
  1450     05  WS-INSURED-MID-INIT         PIC X.
  1451
  1452     05  WS-NAME-WORK.
  1453         10  WS-NW                   PIC X
  1454             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1455
  1456     05  WS-NAME-WORK2.
  1457         10  WS-NW2                  PIC X
  1458             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1459                                        NWA-INDEX0.
  1460
  1461     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1462                                     COMP-3.
  1463
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  27
* EL691.cbl
  1464*                                COPY ELCEMIB.
  1465******************************************************************
  1466*                                                                *
  1467*                                                                *
  1468*                            ELCEMIB.                            *
  1469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1470*                            VMOD=2.005                          *
  1471*                                                                *
  1472*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1473*                                                                *
  1474******************************************************************
  1475 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1476     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1477     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1478     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1479     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1480     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1481     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1482     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1483     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1484     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1485         88  EMI-NO-ERRORS                    VALUE '1'.
  1486         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1487         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1488     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1489         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1490     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1491         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1492         88  EMI-AREA1-FULL                   VALUE '2'.
  1493     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1494         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1495         88  EMI-AREA2-FULL                   VALUE '2'.
  1496     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1497         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1498         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1499         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1500         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1501         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1502     12  EMI-ERROR-LINES.
  1503         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1504         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1505         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1506         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1507             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1508                 24  EMI-ERR-NUM         PIC X(4).
  1509                 24  EMI-FILLER          PIC X.
  1510                 24  EMI-SEV             PIC X.
  1511                 24  FILLER              PIC X.
  1512             20  FILLER                  PIC X(02).
  1513     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1514         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1515             20  EMI-ERROR-NUMBER    PIC X(4).
  1516             20  EMI-FILL            PIC X.
  1517             20  EMI-SEVERITY        PIC X.
  1518             20  FILLER              PIC X.
  1519             20  EMI-ERROR-TEXT.
  1520                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1521                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  28
* EL691.cbl
  1522     12  EMI-SEVERITY-SAVE           PIC X.
  1523         88  EMI-NOTE                    VALUE 'N'.
  1524         88  EMI-WARNING                 VALUE 'W'.
  1525         88  EMI-FORCABLE                VALUE 'F'.
  1526         88  EMI-FATAL                   VALUE 'X'.
  1527     12  EMI-MESSAGE-FLAG            PIC X.
  1528         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1529         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1530     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1531     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1532         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1533         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1534         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1535     12  emi-claim-no                pic x(7).
  1536     12  emi-claim-type              pic x(6).
  1537     12  FILLER                      PIC X(124)  VALUE SPACES.
  1538     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1539     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1540     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1541     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1542*                                COPY ERCCNOT.
  1543******************************************************************
  1544*                                                                *
  1545*                            ERCCNOT                             *
  1546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1547*                            VMOD=2.003                          *
  1548*                                                                *
  1549*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1550*                                                                *
  1551*        FILE TYPE= VSAM,KSDS                                    *
  1552*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1553*                                                                *
  1554*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1555*                                                                *
  1556*        LOG = YES                                               *
  1557*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1558*                                                                *
  1559******************************************************************
  1560*                   C H A N G E   L O G
  1561*
  1562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1563*-----------------------------------------------------------------
  1564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1565* EFFECTIVE    NUMBER
  1566*-----------------------------------------------------------------
  1567* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1568******************************************************************
  1569
  1570 01  CERT-NOTE-FILE.
  1571     12  CZ-RECORD-ID                PIC  XX.
  1572         88  VALID-CZ-ID                  VALUE 'CZ'.
  1573
  1574     12  CZ-CONTROL-PRIMARY.
  1575         16  CZ-COMPANY-CD           PIC X.
  1576         16  CZ-CARRIER              PIC X.
  1577         16  CZ-GROUPING.
  1578             20 CZ-GROUPING-PREFIX   PIC XXX.
  1579             20 CZ-GROUPING-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  29
* EL691.cbl
  1580         16  CZ-STATE                PIC XX.
  1581         16  CZ-ACCOUNT.
  1582             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1583             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1584         16  CZ-CERT-EFF-DT          PIC XX.
  1585         16  CZ-CERT-NO.
  1586             20  CZ-CERT-PRIME       PIC X(10).
  1587             20  CZ-CERT-SFX         PIC X.
  1588         16  CZ-RECORD-TYPE          PIC X.
  1589             88  CERT-NOTE           VALUE '1'.
  1590             88  CLAIM-CERT-NOTE     VALUE '2'.
  1591         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1592
  1593     12  CZ-LAST-MAINT-DT            PIC XX.
  1594     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1595     12  CZ-LAST-MAINT-USER          PIC X(4).
  1596
  1597     12  CZ-NOTE-INFORMATION.
  1598         16  CZ-NOTE                 PIC X(63).
  1599         16  FILLER                  PIC X(39).
  1600******************************************************************
  1601 01  EMI-SAVE-AREA               PIC X(400).
  1602*                                COPY ELCLOGOF.
  1603******************************************************************
  1604*                                                                *
  1605*                                                                *
  1606*                            ELCLOGOF.                           *
  1607*                            VMOD=2.001                          *
  1608*                                                                *
  1609*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1610*                                                                *
  1611******************************************************************
  1612 01  CLASIC-LOGOFF.
  1613     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1614     12  LOGOFF-TEXT.
  1615         16  FILLER          PIC X(5)    VALUE SPACES.
  1616         16  LOGOFF-MSG.
  1617             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1618             20  FILLER      PIC X       VALUE SPACES.
  1619             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1620         16  FILLER          PIC X(80)
  1621           VALUE '* YOU ARE NOW LOGGED OFF'.
  1622         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1623         16  FILLER          PIC X       VALUE QUOTE.
  1624         16  LOGOFF-SYS-MSG  PIC X(17)
  1625           VALUE 'S CLAS-IC SYSTEM '.
  1626     12  TEXT-MESSAGES.
  1627         16  UNACCESS-MSG    PIC X(29)
  1628             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1629         16  PGMIDERR-MSG    PIC X(17)
  1630             VALUE 'PROGRAM NOT FOUND'.
  1631*                                COPY ELCSCTM.
  1632******************************************************************
  1633*                                                                *
  1634*                                                                *
  1635*                            ELCSCTM                             *
  1636*                            VMOD=2.001                          *
  1637*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  30
* EL691.cbl
  1638*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  1639*                                                                *
  1640******************************************************************
  1641 01  SECURITY-MESSAGE.
  1642     12  FILLER                          PIC X(30)
  1643            VALUE '** LOGIC SECURITY VIOLATION -'.
  1644     12  SM-READ                         PIC X(6).
  1645     12  FILLER                          PIC X(5)
  1646            VALUE ' PGM='.
  1647     12  SM-PGM                          PIC X(6).
  1648     12  FILLER                          PIC X(5)
  1649            VALUE ' OPR='.
  1650     12  SM-PROCESSOR-ID                 PIC X(4).
  1651     12  FILLER                          PIC X(6)
  1652            VALUE ' TERM='.
  1653     12  SM-TERMID                       PIC X(4).
  1654     12  FILLER                          PIC XX   VALUE SPACE.
  1655     12  SM-JUL-DATE                     PIC 9(5).
  1656     12  FILLER                          PIC X    VALUE SPACE.
  1657     12  SM-TIME                         PIC 99.99.
  1658
  1659*                                COPY ELCSCRTY.
  1660******************************************************************
  1661*                                                                *
  1662*                                                                *
  1663*                            ELCSCRTY                            *
  1664*                            VMOD=2.001                          *
  1665*                                                                *
  1666*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1667*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1668*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1669*                                                                *
  1670******************************************************************
  1671 01  SECURITY-CONTROL.
  1672     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1673     12  FILLER                       PIC XX    VALUE 'SC'.
  1674     12  SC-CREDIT-CODES.
  1675         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1676             20  SC-CREDIT-DISPLAY    PIC X.
  1677             20  SC-CREDIT-UPDATE     PIC X.
  1678     12  SC-CLAIMS-CODES.
  1679         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1680             20  SC-CLAIMS-DISPLAY    PIC X.
  1681             20  SC-CLAIMS-UPDATE     PIC X.
  1682*                                COPY EL691S.
  1683 01  EL691AI.
  1684     05  FILLER            PIC  X(0012).
  1685*    -------------------------------
  1686     05  RUNDTEL PIC S9(0004) COMP.
  1687     05  RUNDTEF PIC  X(0001).
  1688     05  FILLER REDEFINES RUNDTEF.
  1689         10  RUNDTEA PIC  X(0001).
  1690     05  RUNDTEI PIC  X(0008).
  1691*    -------------------------------
  1692     05  RUNTIMEL PIC S9(0004) COMP.
  1693     05  RUNTIMEF PIC  X(0001).
  1694     05  FILLER REDEFINES RUNTIMEF.
  1695         10  RUNTIMEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  31
* EL691.cbl
  1696     05  RUNTIMEI PIC  X(0005).
  1697*    -------------------------------
  1698     05  COMPANYL PIC S9(0004) COMP.
  1699     05  COMPANYF PIC  X(0001).
  1700     05  FILLER REDEFINES COMPANYF.
  1701         10  COMPANYA PIC  X(0001).
  1702     05  COMPANYI PIC  X(0003).
  1703*    -------------------------------
  1704     05  USERIDL PIC S9(0004) COMP.
  1705     05  USERIDF PIC  X(0001).
  1706     05  FILLER REDEFINES USERIDF.
  1707         10  USERIDA PIC  X(0001).
  1708     05  USERIDI PIC  X(0004).
  1709*    -------------------------------
  1710     05  CARRIERL PIC S9(0004) COMP.
  1711     05  CARRIERF PIC  X(0001).
  1712     05  FILLER REDEFINES CARRIERF.
  1713         10  CARRIERA PIC  X(0001).
  1714     05  CARRIERI PIC  X(0001).
  1715*    -------------------------------
  1716     05  GROUPL PIC S9(0004) COMP.
  1717     05  GROUPF PIC  X(0001).
  1718     05  FILLER REDEFINES GROUPF.
  1719         10  GROUPA PIC  X(0001).
  1720     05  GROUPI PIC  X(0006).
  1721*    -------------------------------
  1722     05  STATEL PIC S9(0004) COMP.
  1723     05  STATEF PIC  X(0001).
  1724     05  FILLER REDEFINES STATEF.
  1725         10  STATEA PIC  X(0001).
  1726     05  STATEI PIC  X(0002).
  1727*    -------------------------------
  1728     05  ACCTL PIC S9(0004) COMP.
  1729     05  ACCTF PIC  X(0001).
  1730     05  FILLER REDEFINES ACCTF.
  1731         10  ACCTA PIC  X(0001).
  1732     05  ACCTI PIC  X(0010).
  1733*    -------------------------------
  1734     05  CERTL PIC S9(0004) COMP.
  1735     05  CERTF PIC  X(0001).
  1736     05  FILLER REDEFINES CERTF.
  1737         10  CERTA PIC  X(0001).
  1738     05  CERTI PIC  X(0010).
  1739*    -------------------------------
  1740     05  SFXL PIC S9(0004) COMP.
  1741     05  SFXF PIC  X(0001).
  1742     05  FILLER REDEFINES SFXF.
  1743         10  SFXA PIC  X(0001).
  1744     05  SFXI PIC  X(0001).
  1745*    -------------------------------
  1746     05  MAINTL PIC S9(0004) COMP.
  1747     05  MAINTF PIC  X(0001).
  1748     05  FILLER REDEFINES MAINTF.
  1749         10  MAINTA PIC  X(0001).
  1750     05  MAINTI PIC  X(0001).
  1751*    -------------------------------
  1752     05  MAINTBYL PIC S9(0004) COMP.
  1753     05  MAINTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  32
* EL691.cbl
  1754     05  FILLER REDEFINES MAINTBYF.
  1755         10  MAINTBYA PIC  X(0001).
  1756     05  MAINTBYI PIC  X(0004).
  1757*    -------------------------------
  1758     05  MAINTDTL PIC S9(0004) COMP.
  1759     05  MAINTDTF PIC  X(0001).
  1760     05  FILLER REDEFINES MAINTDTF.
  1761         10  MAINTDTA PIC  X(0001).
  1762     05  MAINTDTI PIC  X(0008).
  1763*    -------------------------------
  1764     05  MAINTTML PIC S9(0004) COMP.
  1765     05  MAINTTMF PIC  X(0001).
  1766     05  FILLER REDEFINES MAINTTMF.
  1767         10  MAINTTMA PIC  X(0001).
  1768     05  MAINTTMI PIC  X(0005).
  1769*    -------------------------------
  1770     05  ARCHNOL PIC S9(0004) COMP.
  1771     05  ARCHNOF PIC  X(0001).
  1772     05  FILLER REDEFINES ARCHNOF.
  1773         10  ARCHNOA PIC  X(0001).
  1774     05  ARCHNOI PIC  X(0008).
  1775*    -------------------------------
  1776     05  ENDARCHL PIC S9(0004) COMP.
  1777     05  ENDARCHF PIC  X(0001).
  1778     05  FILLER REDEFINES ENDARCHF.
  1779         10  ENDARCHA PIC  X(0001).
  1780     05  ENDARCHI PIC  X(0008).
  1781*    -------------------------------
  1782     05  FORMNOL PIC S9(0004) COMP.
  1783     05  FORMNOF PIC  X(0001).
  1784     05  FILLER REDEFINES FORMNOF.
  1785         10  FORMNOA PIC  X(0001).
  1786     05  FORMNOI PIC  X(0004).
  1787*    -------------------------------
  1788     05  RESFORML PIC S9(0004) COMP.
  1789     05  RESFORMF PIC  X(0001).
  1790     05  FILLER REDEFINES RESFORMF.
  1791         10  RESFORMA PIC  X(0001).
  1792     05  RESFORMI PIC  X(0004).
  1793*    -------------------------------
  1794     05  CREATDTL PIC S9(0004) COMP.
  1795     05  CREATDTF PIC  X(0001).
  1796     05  FILLER REDEFINES CREATDTF.
  1797         10  CREATDTA PIC  X(0001).
  1798     05  CREATDTI PIC  X(0008).
  1799*    -------------------------------
  1800     05  RESENDL PIC S9(0004) COMP.
  1801     05  RESENDF PIC  X(0001).
  1802     05  FILLER REDEFINES RESENDF.
  1803         10  RESENDA PIC  X(0001).
  1804     05  RESENDI PIC  X(0008).
  1805*    -------------------------------
  1806     05  CREATBYL PIC S9(0004) COMP.
  1807     05  CREATBYF PIC  X(0001).
  1808     05  FILLER REDEFINES CREATBYF.
  1809         10  CREATBYA PIC  X(0001).
  1810     05  CREATBYI PIC  X(0004).
  1811*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  33
* EL691.cbl
  1812     05  PRINTDTL PIC S9(0004) COMP.
  1813     05  PRINTDTF PIC  X(0001).
  1814     05  FILLER REDEFINES PRINTDTF.
  1815         10  PRINTDTA PIC  X(0001).
  1816     05  PRINTDTI PIC  X(0008).
  1817*    -------------------------------
  1818     05  RESPRNTL PIC S9(0004) COMP.
  1819     05  RESPRNTF PIC  X(0001).
  1820     05  FILLER REDEFINES RESPRNTF.
  1821         10  RESPRNTA PIC  X(0001).
  1822     05  RESPRNTI PIC  X(0008).
  1823*    -------------------------------
  1824     05  STCOMPL PIC S9(0004) COMP.
  1825     05  STCOMPF PIC  X(0001).
  1826     05  FILLER REDEFINES STCOMPF.
  1827         10  STCOMPA PIC  X(0001).
  1828     05  STCOMPI PIC  X(0019).
  1829*    -------------------------------
  1830     05  REPLYL PIC S9(0004) COMP.
  1831     05  REPLYF PIC  X(0001).
  1832     05  FILLER REDEFINES REPLYF.
  1833         10  REPLYA PIC  X(0001).
  1834     05  REPLYI PIC  X(0008).
  1835*    -------------------------------
  1836     05  STRECVL PIC S9(0004) COMP.
  1837     05  STRECVF PIC  X(0001).
  1838     05  FILLER REDEFINES STRECVF.
  1839         10  STRECVA PIC  X(0001).
  1840     05  STRECVI PIC  X(0019).
  1841*    -------------------------------
  1842     05  STOPDTEL PIC S9(0004) COMP.
  1843     05  STOPDTEF PIC  X(0001).
  1844     05  FILLER REDEFINES STOPDTEF.
  1845         10  STOPDTEA PIC  X(0001).
  1846     05  STOPDTEI PIC  X(0008).
  1847*    -------------------------------
  1848     05  STSTOPL PIC S9(0004) COMP.
  1849     05  STSTOPF PIC  X(0001).
  1850     05  FILLER REDEFINES STSTOPF.
  1851         10  STSTOPA PIC  X(0001).
  1852     05  STSTOPI PIC  X(0019).
  1853*    -------------------------------
  1854     05  OBVYNL PIC S9(0004) COMP.
  1855     05  OBVYNF PIC  X(0001).
  1856     05  FILLER REDEFINES OBVYNF.
  1857         10  OBVYNA PIC  X(0001).
  1858     05  OBVYNI PIC  X(0001).
  1859*    -------------------------------
  1860     05  FINDATEL PIC S9(0004) COMP.
  1861     05  FINDATEF PIC  X(0001).
  1862     05  FILLER REDEFINES FINDATEF.
  1863         10  FINDATEA PIC  X(0001).
  1864     05  FINDATEI PIC  X(0008).
  1865*    -------------------------------
  1866     05  STFINLL PIC S9(0004) COMP.
  1867     05  STFINLF PIC  X(0001).
  1868     05  FILLER REDEFINES STFINLF.
  1869         10  STFINLA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  34
* EL691.cbl
  1870     05  STFINLI PIC  X(0019).
  1871*    -------------------------------
  1872     05  OBUIDL PIC S9(0004) COMP.
  1873     05  OBUIDF PIC  X(0001).
  1874     05  FILLER REDEFINES OBUIDF.
  1875         10  OBUIDA PIC  X(0001).
  1876     05  OBUIDI PIC  X(0005).
  1877*    -------------------------------
  1878     05  FINLACTL PIC S9(0004) COMP.
  1879     05  FINLACTF PIC  X(0001).
  1880     05  FILLER REDEFINES FINLACTF.
  1881         10  FINLACTA PIC  X(0001).
  1882     05  FINLACTI PIC  X(0001).
  1883*    -------------------------------
  1884     05  COMMENTL PIC S9(0004) COMP.
  1885     05  COMMENTF PIC  X(0001).
  1886     05  FILLER REDEFINES COMMENTF.
  1887         10  COMMENTA PIC  X(0001).
  1888     05  COMMENTI PIC  X(0069).
  1889*    -------------------------------
  1890     05  ERRMSG1L PIC S9(0004) COMP.
  1891     05  ERRMSG1F PIC  X(0001).
  1892     05  FILLER REDEFINES ERRMSG1F.
  1893         10  ERRMSG1A PIC  X(0001).
  1894     05  ERRMSG1I PIC  X(0079).
  1895*    -------------------------------
  1896     05  ERRMSG2L PIC S9(0004) COMP.
  1897     05  ERRMSG2F PIC  X(0001).
  1898     05  FILLER REDEFINES ERRMSG2F.
  1899         10  ERRMSG2A PIC  X(0001).
  1900     05  ERRMSG2I PIC  X(0079).
  1901 01  EL691AO REDEFINES EL691AI.
  1902     05  FILLER            PIC  X(0012).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  RUNDTEO PIC  X(0008).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  RUNTIMEO PIC  99.99.
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  COMPANYO PIC  X(0003).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  USERIDO PIC  X(0004).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  CARRIERO PIC  X(0001).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  GROUPO PIC  X(0006).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  STATEO PIC  X(0002).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  ACCTO PIC  X(0010).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  35
* EL691.cbl
  1928     05  FILLER            PIC  X(0003).
  1929     05  CERTO PIC  X(0010).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  SFXO PIC  X(0001).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  MAINTO PIC  X(0001).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  MAINTBYO PIC  X(0004).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  MAINTDTO PIC  99B99B99.
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  MAINTTMO PIC  99.99.
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  ARCHNOO PIC  X(0008).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  ENDARCHO PIC  X(0008).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  FORMNOO PIC  X(0004).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  RESFORMO PIC  X(0004).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  CREATDTO PIC  99B99B99.
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  RESENDO PIC  99B99B99.
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  CREATBYO PIC  X(0004).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  PRINTDTO PIC  99B99B99.
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  RESPRNTO PIC  99B99B99.
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  STCOMPO PIC  X(0019).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  REPLYO PIC  99B99B99.
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  STRECVO PIC  X(0019).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  STOPDTEO PIC  99B99B99.
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  36
* EL691.cbl
  1986     05  STSTOPO PIC  X(0019).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  OBVYNO PIC  X(0001).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  FINDATEO PIC  99B99B99.
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  STFINLO PIC  X(0019).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  OBUIDO PIC  ZZZ99.
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  FINLACTO PIC  X(0001).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  COMMENTO PIC  X(0069).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  ERRMSG1O PIC  X(0079).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  ERRMSG2O PIC  X(0079).
  2011*    -------------------------------
  2012****************************************************************
  2013*
  2014* Copyright (c) 2007-2013 Dell Inc.
  2015* All rights reserved.
  2016*
  2017****************************************************************
  2018 01  DFHEIV.
  2019   02  DFHEIV0               PIC X(35).
  2020   02  DFHEIV1               PIC X(08).
  2021   02  DFHEIV2               PIC X(08).
  2022   02  DFHEIV3               PIC X(08).
  2023   02  DFHEIV4               PIC X(06).
  2024   02  DFHEIV5               PIC X(04).
  2025   02  DFHEIV6               PIC X(04).
  2026   02  DFHEIV7               PIC X(02).
  2027   02  DFHEIV8               PIC X(02).
  2028   02  DFHEIV9               PIC X(01).
  2029   02  DFHEIV10              PIC S9(7) COMP-3.
  2030   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2031   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2032   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2033   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2034   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2035   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2036   02  DFHEIV17              PIC X(04).
  2037   02  DFHEIV18              PIC X(04).
  2038   02  DFHEIV19              PIC X(04).
  2039   02  DFHEIV20              USAGE IS POINTER.
  2040   02  DFHEIV21              USAGE IS POINTER.
  2041   02  DFHEIV22              USAGE IS POINTER.
  2042   02  DFHEIV23              USAGE IS POINTER.
  2043   02  DFHEIV24              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  37
* EL691.cbl
  2044   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2045   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2046   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2047   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2048   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2049   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2050   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2051   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2052   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2053   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2054   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2055   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2056   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2057   02  FILLER                PIC X(02).
  2058   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2059   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2060   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2061   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2062   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2063   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2064   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2065 LINKAGE  SECTION.
  2066*****************************************************************
  2067*                                                               *
  2068* Copyright (c) 2007-2013 Dell Inc.                             *
  2069* All rights reserved.                                          *
  2070*                                                               *
  2071*****************************************************************
  2072 01  dfheiblk.
  2073     02  eibtime          pic s9(7) comp-3.
  2074     02  eibdate          pic s9(7) comp-3.
  2075     02  eibtrnid         pic x(4).
  2076     02  eibtaskn         pic s9(7) comp-3.
  2077     02  eibtrmid         pic x(4).
  2078     02  dfheigdi         pic s9(4) comp.
  2079     02  eibcposn         pic s9(4) comp.
  2080     02  eibcalen         pic s9(4) comp.
  2081     02  eibaid           pic x(1).
  2082     02  eibfiller1       pic x(1).
  2083     02  eibfn            pic x(2).
  2084     02  eibfiller2       pic x(2).
  2085     02  eibrcode         pic x(6).
  2086     02  eibfiller3       pic x(2).
  2087     02  eibds            pic x(8).
  2088     02  eibreqid         pic x(8).
  2089     02  eibrsrce         pic x(8).
  2090     02  eibsync          pic x(1).
  2091     02  eibfree          pic x(1).
  2092     02  eibrecv          pic x(1).
  2093     02  eibsend          pic x(1).
  2094     02  eibatt           pic x(1).
  2095     02  eibeoc           pic x(1).
  2096     02  eibfmh           pic x(1).
  2097     02  eibcompl         pic x(1).
  2098     02  eibsig           pic x(1).
  2099     02  eibconf          pic x(1).
  2100     02  eiberr           pic x(1).
  2101     02  eibrldbk         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  38
* EL691.cbl
  2102     02  eiberrcd         pic x(4).
  2103     02  eibsynrb         pic x(1).
  2104     02  eibnodat         pic x(1).
  2105     02  eibfiller5       pic x(2).
  2106     02  eibresp          pic s9(8) comp.
  2107     02  eibresp2         pic s9(8) comp.
  2108     02  dfheigdj         pic s9(4) comp.
  2109     02  dfheigdk         pic s9(4) comp.
  2110 01  DFHCOMMAREA                 PIC X(1024).
  2111*                                COPY ERCARCH.
  2112******************************************************************
  2113*                                                                *
  2114*                            ERCARCH.                            *
  2115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2116*                            VMOD=2.002                          *
  2117*                                                                *
  2118*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2119*                                                                *
  2120*   FILE TYPE = VSAM,KSDS                                        *
  2121*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2122*                                                                *
  2123*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2124*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2125*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2126*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2127*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2128*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2129*                                                                *
  2130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2131******************************************************************
  2132*                   C H A N G E   L O G
  2133*
  2134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2135*-----------------------------------------------------------------
  2136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2137* EFFECTIVE    NUMBER
  2138*-----------------------------------------------------------------
  2139* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2140* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2141* 110612    2012101700002  AJRA  ADD NEW FIELDS
  2142* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  2143******************************************************************
  2144 01  LETTER-ARCHIVE.
  2145     12  LA-RECORD-ID                PIC  X(02).
  2146         88  LA-VALID-ID                VALUE 'LA'.
  2147
  2148     12  LA-CONTROL-PRIMARY.
  2149         16  LA-COMPANY-CD           PIC  X(01).
  2150         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2151
  2152     12  LA-CONTROL-BY-CERT-RESP.
  2153         16  LA-COMPANY-CD-A2        PIC  X(01).
  2154         16  LA-CERT-NO-A2.
  2155             20  LA-CERT-PRIME-A2    PIC  X(10).
  2156             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2157         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2158             20  LA-RESP-PERSON-A2   PIC  X(10).
  2159             20  LA-TYPE-A2          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  39
* EL691.cbl
  2160         16  LA-CARRIER-A2           PIC  X(01).
  2161         16  LA-GROUPING-A2          PIC  X(06).
  2162         16  LA-STATE-A2             PIC  X(02).
  2163         16  LA-ACCOUNT-A2           PIC  X(10).
  2164         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2165         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2166
  2167     12  LA-CONTROL-BY-FORM.
  2168         16  LA-COMPANY-CD-A3        PIC  X(01).
  2169         16  LA-FORM-A3              PIC  X(04).
  2170         16  LA-CARRIER-A3           PIC  X(01).
  2171         16  LA-GROUPING-A3          PIC  X(06).
  2172         16  LA-STATE-A3             PIC  X(02).
  2173         16  LA-ACCOUNT-A3           PIC  X(10).
  2174         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2175
  2176     12  LA-CONTROL-BY-PROCESSOR.
  2177         16  LA-COMPANY-CD-A4        PIC  X(01).
  2178         16  LA-PROCESSOR-CD         PIC  X(04).
  2179         16  LA-CARRIER-A4           PIC  X(01).
  2180         16  LA-GROUPING-A4          PIC  X(06).
  2181         16  LA-STATE-A4             PIC  X(02).
  2182         16  LA-ACCOUNT-A4           PIC  X(10).
  2183         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2184
  2185     12  LA-CONTROL-BY-KEY-FIELDS.
  2186         16  LA-COMPANY-CD-A5        PIC  X(01).
  2187         16  LA-CARRIER-A5           PIC  X(01).
  2188         16  LA-GROUPING-A5          PIC  X(06).
  2189         16  LA-STATE-A5             PIC  X(02).
  2190         16  LA-ACCOUNT-A5           PIC  X(10).
  2191         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2192
  2193     12  LA-CONTROL-BY-GROUP-CODE.
  2194         16  LA-COMPANY-CD-A6        PIC  X(01).
  2195         16  LA-ENTRY-A6.
  2196             20  LA-FILLER           PIC  X(02).
  2197             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2198         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2199
  2200     12  FILLER                      PIC  X(09).
  2201
  2202     12  LA-HEADER-RECORD.
  2203         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2204         16  LA-CREATION-DATE        PIC  X(02).
  2205         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2206         16  LA-FINAL-ACT-DATE       REDEFINES
  2207               LA-FOLLOW-UP-DATE     PIC  X(02).
  2208         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2209         16  LA-NO-OF-COPIES         PIC S9(01).
  2210         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2211         16  LA-REPLY-DATE           PIC  X(02).
  2212         16  LA-RESEND-DATES.
  2213             20  LA-RESEND-DATE      PIC  X(02).
  2214             20  LA-SENT-DATE        PIC  X(02).
  2215             20  FILLER              PIC  X(08).
  2216         16  LA-SOURCE-INFORMATION.
  2217             20  LA-DATA-SOURCE      PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  40
* EL691.cbl
  2218             20  LA-ADDR-SOURCE      PIC  X(01).
  2219         16  LA-STATUS               PIC  X(01).
  2220             88  LA-STATUS-ACTIVE         VALUE 'A'.
  2221             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2222             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2223             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2224             88  LA-STATUS-PURGED         VALUE 'P'.
  2225             88  LA-STATUS-VOIDED         VALUE 'V'.
  2226         16  LA-LAST-RESENT-PRINT-DATE
  2227                                     PIC  X(02).
  2228         16  LA-PRINT-RESTRICTION    PIC  X(01).
  2229             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2230                                          VALUE 'C'.
  2231             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2232                                          VALUE 'F'.
  2233             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2234                                          VALUE 'P'.
  2235         16  LA-PURGED-DATE          PIC  X(02).
  2236         16  LA-VOIDED-DATE          PIC  X(02).
  2237         16  LA-RESEND-LETR          PIC  X(4).
  2238         16  LA-VOID-ONBASE-YN       PIC  X.
  2239         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  2240         16  FILLER                  PIC  X(04).
  2241*        16  LA-RESEND-LETR-2        PIC  X(4).
  2242*        16  LA-RESEND-LETR-3        PIC  X(4).
  2243*        16  FILLER                  PIC  X(59).
  2244         16  LA-ARCHIVE-STATUS       PIC  X.
  2245             88  LA-TEMP                VALUE 'T'.
  2246             88  LA-QWS                 VALUE 'Q'.
  2247             88  LA-BATCH               VALUE 'B'.
  2248         16  LA-FINAL-ACT-IND        PIC  X(1).
  2249         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2250         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  2251         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  2252                                     PIC X(4).
  2253         16  FILLER                  PIC  X(42).
  2254*        16  FILLER                  PIC  X(71).
  2255         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2256         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2257         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2258                                     PIC  X(4).
  2259         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2260
  2261******************************************************************
  2262*                                COPY ERCARCT.
  2263******************************************************************
  2264*                                                                *
  2265*                            ERCARCT.                            *
  2266*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2267*                            VMOD=2.002                          *
  2268*                                                                *
  2269*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  2270*                                                                *
  2271*   FILE TYPE = VSAM,KSDS                                        *
  2272*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  2273*                                                                *
  2274*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  2275*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  41
* EL691.cbl
  2276*   LOG = NO                                                     *
  2277*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2278******************************************************************
  2279*                   C H A N G E   L O G
  2280*
  2281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2282*-----------------------------------------------------------------
  2283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2284* EFFECTIVE    NUMBER
  2285*-----------------------------------------------------------------
  2286* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2287******************************************************************
  2288 01  LETTER-ARCHIVE-TEXT.
  2289     12  LT-RECORD-ID                PIC  X(02).
  2290         88  LT-VALID-ID                VALUE 'LT'.
  2291
  2292     12  LT-CONTROL-PRIMARY.
  2293         16  LT-COMPANY-CD           PIC  X(01).
  2294         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  2295         16  LT-RECORD-TYPE          PIC  X(01).
  2296             88  LT-ADDRESS-DATA        VALUE '1'.
  2297             88  LT-TEXT-DATA           VALUE '2'.
  2298             88  LT-COMMENT-DATA        VALUE '3'.
  2299         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  2300
  2301     12  FILLER                      PIC  X(28).
  2302     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  2303
  2304     12  LT-TEXT-RECORD.
  2305         16  LT-LETTER-TEXT OCCURS 20 TIMES
  2306                            INDEXED BY LT-NDX.
  2307             20  LT-TEXT-LINE        PIC  X(70).
  2308             20  LT-SKIP-CONTROL     PIC  X(02).
  2309                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  2310                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  2311             20  FILLER              PIC  X(08).
  2312
  2313     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  2314         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  2315             20  LT-COMMENT-LINE     PIC X(69).
  2316             20  LT-COMMENT-CHG-DT   PIC X(02).
  2317             20  LT-COMMENT-CHG-BY   PIC X(04).
  2318             20  FILLER              PIC X(05).
  2319
  2320*                                COPY ELCCERT.
  2321******************************************************************
  2322*                                                                *
  2323*                            ELCCERT.                            *
  2324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2325*                            VMOD=2.013                          *
  2326*                                                                *
  2327*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2328*                                                                *
  2329*   FILE TYPE = VSAM,KSDS                                        *
  2330*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2331*                                                                *
  2332*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2333*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  42
* EL691.cbl
  2334*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2335*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2336*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2337*                                                                *
  2338*   LOG = YES                                                    *
  2339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2340******************************************************************
  2341*                   C H A N G E   L O G
  2342*
  2343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2344*-----------------------------------------------------------------
  2345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2346* EFFECTIVE    NUMBER
  2347*-----------------------------------------------------------------
  2348* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2349* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2350* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2351* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2352* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2353* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2354* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2355* 032612  CR2011110200001  PEMA  AHL CHANGES
  2356* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2357* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2358* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2359******************************************************************
  2360
  2361 01  CERTIFICATE-MASTER.
  2362     12  CM-RECORD-ID                      PIC XX.
  2363         88  VALID-CM-ID                      VALUE 'CM'.
  2364
  2365     12  CM-CONTROL-PRIMARY.
  2366         16  CM-COMPANY-CD                 PIC X.
  2367         16  CM-CARRIER                    PIC X.
  2368         16  CM-GROUPING.
  2369             20  CM-GROUPING-PREFIX        PIC X(3).
  2370             20  CM-GROUPING-PRIME         PIC X(3).
  2371         16  CM-STATE                      PIC XX.
  2372         16  CM-ACCOUNT.
  2373             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2374             20  CM-ACCOUNT-PRIME          PIC X(6).
  2375         16  CM-CERT-EFF-DT                PIC XX.
  2376         16  CM-CERT-NO.
  2377             20  CM-CERT-PRIME             PIC X(10).
  2378             20  CM-CERT-SFX               PIC X.
  2379
  2380     12  CM-CONTROL-BY-NAME.
  2381         16  CM-COMPANY-CD-A1              PIC X.
  2382         16  CM-INSURED-LAST-NAME          PIC X(15).
  2383         16  CM-INSURED-INITIALS.
  2384             20  CM-INSURED-INITIAL1       PIC X.
  2385             20  CM-INSURED-INITIAL2       PIC X.
  2386
  2387     12  CM-CONTROL-BY-SSN.
  2388         16  CM-COMPANY-CD-A2              PIC X.
  2389         16  CM-SOC-SEC-NO.
  2390             20  CM-SSN-STATE              PIC XX.
  2391             20  CM-SSN-ACCOUNT            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  43
* EL691.cbl
  2392             20  CM-SSN-LN3.
  2393                 25  CM-INSURED-INITIALS-A2.
  2394                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2395                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2396                 25 CM-PART-LAST-NAME-A2         PIC X.
  2397
  2398     12  CM-CONTROL-BY-CERT-NO.
  2399         16  CM-COMPANY-CD-A4              PIC X.
  2400         16  CM-CERT-NO-A4                 PIC X(11).
  2401
  2402     12  CM-CONTROL-BY-MEMB.
  2403         16  CM-COMPANY-CD-A5              PIC X.
  2404         16  CM-MEMBER-NO.
  2405             20  CM-MEMB-STATE             PIC XX.
  2406             20  CM-MEMB-ACCOUNT           PIC X(6).
  2407             20  CM-MEMB-LN4.
  2408                 25  CM-INSURED-INITIALS-A5.
  2409                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2410                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2411                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2412
  2413     12  CM-INSURED-PROFILE-DATA.
  2414         16  CM-INSURED-FIRST-NAME.
  2415             20  CM-INSURED-1ST-INIT       PIC X.
  2416             20  FILLER                    PIC X(9).
  2417         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2418         16  CM-INSURED-SEX                PIC X.
  2419             88  CM-SEX-MALE                  VALUE 'M'.
  2420             88  CM-SEX-FEMAL                 VALUE 'F'.
  2421         16  CM-INSURED-JOINT-AGE          PIC 99.
  2422         16  CM-JOINT-INSURED-NAME.
  2423             20  CM-JT-LAST-NAME           PIC X(15).
  2424             20  CM-JT-FIRST-NAME.
  2425                 24  CM-JT-1ST-INIT        PIC X.
  2426                 24  FILLER                PIC X(9).
  2427             20  CM-JT-INITIAL             PIC X.
  2428
  2429     12  CM-LIFE-DATA.
  2430         16  CM-LF-BENEFIT-CD              PIC XX.
  2431         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2432         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2433         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2434         16  CM-LF-DEV-CODE                PIC XXX.
  2435         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2436         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2437         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2438         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2439         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2440         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2441         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2442         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2443         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2444         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2445         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2446         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2447         16  cm-temp-epiq                  pic xx.
  2448             88  EPIQ-CLASS                  value 'EQ'.
  2449*        16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  44
* EL691.cbl
  2450
  2451     12  CM-AH-DATA.
  2452         16  CM-AH-BENEFIT-CD              PIC XX.
  2453         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2454         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2455         16  CM-AH-DEV-CODE                PIC XXX.
  2456         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2457         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2458         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2459         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2460         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2461         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2462         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2463         16  CM-AH-PAID-THRU-DT            PIC XX.
  2464             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2465         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2466         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2467         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2468         16  FILLER                        PIC X.
  2469
  2470     12  CM-LOAN-INFORMATION.
  2471         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2472         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2473                                           PIC S9(5)V99  COMP-3.
  2474         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2475         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2476         16  CM-PAY-FREQUENCY              PIC S99.
  2477         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2478         16  CM-RATE-CLASS                 PIC XX.
  2479         16  CM-BENEFICIARY                PIC X(25).
  2480         16  CM-POLICY-FORM-NO             PIC X(12).
  2481         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2482         16  CM-LAST-ADD-ON-DT             PIC XX.
  2483         16  CM-DEDUCTIBLE-AMOUNTS.
  2484             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2485             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2486         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2487             20  CM-RESIDENT-STATE         PIC XX.
  2488             20  CM-RATE-CODE              PIC X(4).
  2489             20  FILLER                    PIC XX.
  2490         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2491             20  CM-LOAN-OFFICER           PIC X(5).
  2492             20  FILLER                    PIC XXX.
  2493         16  CM-CSR-CODE                   PIC XXX.
  2494         16  CM-UNDERWRITING-CODE          PIC X.
  2495             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2496         16  CM-POST-CARD-IND              PIC X.
  2497         16  CM-REF-INTERFACE-SW           PIC X.
  2498         16  CM-PREMIUM-TYPE               PIC X.
  2499             88  CM-SING-PRM                  VALUE '1'.
  2500             88  CM-O-B-COVERAGE              VALUE '2'.
  2501             88  CM-OPEN-END                  VALUE '3'.
  2502         16  CM-IND-GRP-TYPE               PIC X.
  2503             88  CM-INDIVIDUAL                VALUE 'I'.
  2504             88  CM-GROUP                     VALUE 'G'.
  2505         16  CM-SKIP-CODE                  PIC X.
  2506             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2507             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  45
* EL691.cbl
  2508             88  SKIP-AUGUST                  VALUE '2'.
  2509             88  SKIP-SEPTEMBER               VALUE '3'.
  2510             88  SKIP-JULY-AUG                VALUE '4'.
  2511             88  SKIP-AUG-SEPT                VALUE '5'.
  2512             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2513             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2514             88  SKIP-JUNE                    VALUE '8'.
  2515             88  SKIP-JUNE-JULY               VALUE '9'.
  2516             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2517             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2518         16  CM-PAYMENT-MODE               PIC X.
  2519             88  PAY-MONTHLY                  VALUE SPACE.
  2520             88  PAY-WEEKLY                   VALUE '1'.
  2521             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2522             88  PAY-BI-WEEKLY                VALUE '3'.
  2523             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2524         16  CM-LOAN-NUMBER                PIC X(8).
  2525         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2526         16  CM-OLD-LOF                    PIC XXX.
  2527*        16  CM-LOAN-OFFICER               PIC XXX.
  2528         16  CM-REIN-TABLE                 PIC XXX.
  2529         16  CM-SPECIAL-REIN-CODE          PIC X.
  2530         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2531         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2532         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2533
  2534     12  CM-STATUS-DATA.
  2535         16  CM-ENTRY-STATUS               PIC X.
  2536         16  CM-ENTRY-DT                   PIC XX.
  2537
  2538         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2539         16  CM-LF-CANCEL-DT               PIC XX.
  2540         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2541
  2542         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2543         16  CM-LF-DEATH-DT                PIC XX.
  2544         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2545
  2546         16  CM-LF-CURRENT-STATUS          PIC X.
  2547             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2548                                                'M' '4' '5' '9'.
  2549             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2550             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2551             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2552             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2553             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2554             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2555             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2556             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2557             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2558             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2559             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2560             88  CM-LF-DECLINED               VALUE 'D'.
  2561             88  CM-LF-VOIDED                 VALUE 'V'.
  2562
  2563         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2564         16  CM-AH-CANCEL-DT               PIC XX.
  2565         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  46
* EL691.cbl
  2566
  2567         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2568         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2569         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2570
  2571         16  CM-AH-CURRENT-STATUS          PIC X.
  2572             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2573                                                'M' '4' '5' '9'.
  2574             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2575             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2576             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2577             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2578             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2579             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2580             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2581             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2582             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2583             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2584             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2585             88  CM-AH-DECLINED               VALUE 'D'.
  2586             88  CM-AH-VOIDED                 VALUE 'V'.
  2587
  2588         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2589             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2590             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2591             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2592         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2593
  2594         16  CM-ENTRY-BATCH                PIC X(6).
  2595         16  CM-LF-EXIT-BATCH              PIC X(6).
  2596         16  CM-AH-EXIT-BATCH              PIC X(6).
  2597         16  CM-LAST-MONTH-END             PIC XX.
  2598
  2599     12  CM-NOTE-SW                        PIC X.
  2600         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2601         88  CERT-NOTES-PRESENT               VALUE '1'.
  2602         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2603         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2604         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2605         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2606         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2607         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2608     12  CM-COMP-EXCP-SW                   PIC X.
  2609         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2610         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2611     12  CM-INSURED-ADDRESS-SW             PIC X.
  2612         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2613         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2614
  2615*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2616     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2617     12  FILLER                            PIC X.
  2618
  2619*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2620     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2621     12  FILLER                            PIC X.
  2622*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2623     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  47
* EL691.cbl
  2624
  2625     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2626         88  CERT-ADDED-BATCH                 VALUE ' '.
  2627         88  CERT-ADDED-ONLINE                VALUE '1'.
  2628         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2629         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2630         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2631     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2632         88  CERT-AS-LOADED                   VALUE ' '.
  2633         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2634         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2635         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2636         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2637         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2638         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2639         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2640
  2641     12  CM-ACCOUNT-COMM-PCTS.
  2642         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2643         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2644
  2645     12  CM-USER-FIELD                     PIC X.
  2646     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2647     12  CM-CLP-STATE                      PIC XX.
  2648     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2649     12  CM-USER-RESERVED                  PIC XXX.
  2650     12  FILLER REDEFINES CM-USER-RESERVED.
  2651         16  CM-AH-CLASS-CD                PIC XX.
  2652         16  F                             PIC X.
  2653******************************************************************
  2654*                                COPY ELCEOBC.
  2655******************************************************************
  2656*                                                                *
  2657*                                                                *
  2658*                            ELCEOBC                             *
  2659*                            VMOD=2.001                          *
  2660*                                                                *
  2661*   CLAIM SYSTEM EOB CODE TABLE                                  *
  2662*                                                                *
  2663*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2664*   VSAM EOB CODE TABLE                                          *
  2665*                                                                *
  2666*   FILE DESCRIPTION = EOB CODE TABLE                            *
  2667*                                                                *
  2668*   FILE TYPE = VSAM,KSDS                                        *
  2669*   RECORD SIZE = 350   RECFORM = FIX                            *
  2670*                                                                *
  2671*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  2672*                                                                *
  2673*   LOG = NO                                                     *
  2674*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2675*                                                                *
  2676*                                                                *
  2677******************************************************************
  2678*                   C H A N G E   L O G
  2679*
  2680* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2681*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  48
* EL691.cbl
  2682*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2683* EFFECTIVE    NUMBER
  2684*-----------------------------------------------------------------
  2685* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  2686* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  2687* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  2688******************************************************************
  2689 01  EOB-CODES.
  2690     12  EO-RECORD-ID                      PIC XX.
  2691         88  VALID-DN-ID                      VALUE 'EO'.
  2692     12  EO-CONTROL-PRIMARY.
  2693         16  EO-COMPANY-CD                 PIC X.
  2694         16  EO-RECORD-TYPE                PIC X.
  2695             88  EO-EOB-RECS                  VALUE '1'.
  2696             88  EO-VERIF-RECS                VALUE '2'.
  2697             88  EO-GCE-RECS                  VALUE '3'.
  2698             88  EO-CANC-RECS                 VALUE '4'.
  2699             88  EO-BILL-NOTE-RECS            VALUE '5'.
  2700         16  EO-EOB-CODE                   PIC X(4).
  2701         16  FILLER                        PIC X(9).
  2702     12  EO-MAINT-INFORMATION.
  2703         16  EO-LAST-MAINT-DT              PIC XX.
  2704         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2705         16  EO-LAST-MAINT-USER            PIC X(4).
  2706         16  FILLER                        PIC XX.
  2707     12  EO-DESCRIPTION                    PIC X(275).
  2708     12  FILLER                            PIC X(46).
  2709******************************************************************
  2710*                                COPY ERCNOTE.
  2711******************************************************************
  2712*                                                                *
  2713*                                                                *
  2714*                            ERCNOTE                             *
  2715*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2716*                            VMOD=2.003                          *
  2717*                                                                *
  2718*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2719*                                                                *
  2720*        FILE TYPE= VSAM,KSDS                                    *
  2721*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2722*                                                                *
  2723*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  2724*                                                                *
  2725*        LOG = YES                                               *
  2726*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2727*                                                                *
  2728******************************************************************
  2729*                   C H A N G E   L O G
  2730*
  2731* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2732*-----------------------------------------------------------------
  2733*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2734* EFFECTIVE    NUMBER
  2735*-----------------------------------------------------------------
  2736* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2737*                                FILE WILL CONTAIN BILLING NOTES O
  2738* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  2739******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  49
* EL691.cbl
  2740
  2741 01  CERTIFICATE-NOTE.
  2742     12  CN-RECORD-ID                PIC  XX.
  2743         88  VALID-CN-ID                  VALUE 'CN'.
  2744
  2745     12  CN-CONTROL-PRIMARY.
  2746         16  CN-COMPANY-CD           PIC X.
  2747         16  CN-CARRIER              PIC X.
  2748         16  CN-GROUPING.
  2749             20 CN-GROUPING-PREFIX   PIC XXX.
  2750             20 CN-GROUPING-PRIME    PIC XXX.
  2751         16  CN-STATE                PIC XX.
  2752         16  CN-ACCOUNT.
  2753             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2754             20 CN-ACCOUNT-PRIME     PIC X(6).
  2755         16  CN-CERT-EFF-DT          PIC XX.
  2756         16  CN-CERT-NO.
  2757             20  CN-CERT-PRIME       PIC X(10).
  2758             20  CN-CERT-SFX         PIC X.
  2759         16  CN-RECORD-TYPE          PIC X.
  2760             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  2761             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  2762     12  CN-BILLING-START-LINE-NO    PIC 99.
  2763     12  CN-BILLING-END-LINE-NO      PIC 99.
  2764
  2765     12  CN-LINES.
  2766         16  CN-LINE OCCURS 10       PIC X(77).
  2767
  2768     12  CN-LAST-MAINT-DT            PIC XX.
  2769     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2770     12  CN-LAST-MAINT-USER          PIC X(4).
  2771     12  FILLER                      PIC X(5).
  2772******************************************************************
  2773 01  var                         pic x(30).
  2774 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  2775                          LETTER-ARCHIVE-TEXT
  2776                          CERTIFICATE-MASTER EOB-CODES
  2777                          CERTIFICATE-NOTE VAR.
  2778 0000-DFHEXIT SECTION.
  2779     MOVE '9#                    $   ' TO DFHEIV0.
  2780     MOVE 'EL691' TO DFHEIV1.
  2781     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2782     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2783
  2784     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2785     MOVE '5'                    TO DC-OPTION-CODE.
  2786     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  2787     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  2788     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  2789                                    W-CURRENT-SAVE.
  2790
  2791     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2792     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2793                                 TO EMI-SAVE-AREA.
  2794
  2795     IF  EIBCALEN EQUAL 0
  2796         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  2797         GO TO 8300-SEND-TEXT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  50
* EL691.cbl
  2798     END-IF.
  2799     set P to address of KIXSYS
  2800     CALL "getenv" using by value P returning var-ptr
  2801     if var-ptr = null then
  2802        display ' kixsys not set '
  2803     else
  2804        set address of var to var-ptr
  2805        move 0 to env-var-len
  2806        inspect var tallying env-var-len
  2807          for characters before X'00'
  2808        unstring var (1:env-var-len) delimited by '/'
  2809           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2810              WS-KIX-SYS
  2811        end-unstring
  2812     end-if
  2813     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  2814         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  2815             MOVE PI-SAVED-PROGRAM-5
  2816                                 TO PI-SAVED-PROGRAM-6
  2817             MOVE PI-SAVED-PROGRAM-4
  2818                                 TO PI-SAVED-PROGRAM-5
  2819             MOVE PI-SAVED-PROGRAM-3
  2820                                 TO PI-SAVED-PROGRAM-4
  2821             MOVE PI-SAVED-PROGRAM-2
  2822                                 TO PI-SAVED-PROGRAM-3
  2823             MOVE PI-SAVED-PROGRAM-1
  2824                                 TO PI-SAVED-PROGRAM-2
  2825             MOVE PI-RETURN-TO-PROGRAM
  2826                                 TO PI-SAVED-PROGRAM-1
  2827             MOVE PI-CALLING-PROGRAM
  2828                                 TO PI-RETURN-TO-PROGRAM
  2829             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  2830         ELSE
  2831             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  2832             MOVE PI-RETURN-TO-PROGRAM
  2833                                     TO PI-CALLING-PROGRAM
  2834             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  2835             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  2836             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  2837             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  2838             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  2839             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  2840             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  2841         END-IF
  2842     ELSE
  2843         GO TO 0200-RECEIVE
  2844     END-IF.
  2845
  2846     GO TO 1000-SHOW.
  2847
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  51
* EL691.cbl
  2849
  2850 0200-RECEIVE.
  2851
  2852
  2853* EXEC CICS HANDLE AID
  2854*        CLEAR    (9300-DFHCLEAR)
  2855*        PA1      (9200-PA)
  2856*        PA2      (9200-PA)
  2857*        PA3      (9200-PA)
  2858*    END-EXEC.
  2859*    MOVE '"&=!"#               V! " #00002755' TO DFHEIV0
  2860     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2861     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2862     MOVE X'2220233030303032373535' TO DFHEIV0(25:11)
  2863     CALL 'kxdfhei1' USING DFHEIV0
  2864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2865
  2866
  2867
  2868* EXEC CICS HANDLE CONDITION
  2869*        PGMIDERR (9700-PGMID-ERROR)
  2870*        ERROR    (9800-ABEND)
  2871*    END-EXEC.
  2872*    MOVE '"$L.                  ! # #00002762' TO DFHEIV0
  2873     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2875     MOVE X'2320233030303032373632' TO DFHEIV0(25:11)
  2876     CALL 'kxdfhei1' USING DFHEIV0
  2877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2878
  2879
  2880
  2881* EXEC CICS RECEIVE
  2882*        MAP      (W-MAP)
  2883*        MAPSET   (W-MAPSET)
  2884*        INTO     (EL691AI)
  2885*    END-EXEC.
  2886     MOVE LENGTH OF
  2887      EL691AI
  2888       TO DFHEIV11
  2889*    MOVE '8"T I  L              ''   #00002767' TO DFHEIV0
  2890     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2891     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2892     MOVE X'2020233030303032373637' TO DFHEIV0(25:11)
  2893     CALL 'kxdfhei1' USING DFHEIV0,
  2894           W-MAP,
  2895           EL691AI,
  2896           DFHEIV11,
  2897           W-MAPSET,
  2898           DFHEIV99,
  2899           DFHEIV99
  2900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2901
  2902
  2903     IF  NOT DISPLAY-CAP
  2904         MOVE 'READ'             TO SM-READ
  2905         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2906         MOVE ER-9097            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  52
* EL691.cbl
  2907         MOVE -1                 TO MAINTL
  2908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2909         GO TO 8100-SEND-INITIAL-MAP
  2910     END-IF.
  2911
  2912
  2913 0300-CHECK-PFKEYS.
  2914
  2915     IF  EIBAID EQUAL DFHPF23
  2916         MOVE EIBAID             TO PI-ENTRY-CD-1
  2917         MOVE W-XCTL-005         TO W-CALL-PGM
  2918         GO TO 9400-XCTL
  2919     END-IF.
  2920
  2921     IF  EIBAID EQUAL DFHPF24
  2922         MOVE W-XCTL-626         TO W-CALL-PGM
  2923         GO TO 9400-XCTL
  2924     END-IF.
  2925
  2926     IF  EIBAID EQUAL DFHPF6
  2927         move pi-689-chg-seq-nox(1:1)
  2928                                 to PI-PROGRAM-WORK-AREA(1:1)
  2929         MOVE W-XCTL-1279        TO W-CALL-PGM
  2930         GO TO 9400-XCTL
  2931     END-IF
  2932
  2933     IF  MAINTI EQUAL 'C'  AND
  2934         EIBAID EQUAL DFHENTER
  2935          GO TO 0700-PROCESS-CHANGES
  2936     END-IF.
  2937
  2938     MOVE ER-0029                TO EMI-ERROR.
  2939
  2940
  2941 0320-INPUT-ERROR.
  2942
  2943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2944     MOVE -1                     TO  MAINTL.
  2945     GO TO 8200-SEND-DATAONLY.
  2946
  2947
  2948 0700-PROCESS-CHANGES.
  2949
  2950     IF  NOT MODIFY-CAP
  2951         MOVE 'UPDATE'           TO SM-READ
  2952         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2953         MOVE ER-0070            TO EMI-ERROR
  2954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2955         MOVE -1                 TO MAINTL
  2956         GO TO 8100-SEND-INITIAL-MAP
  2957     END-IF.
  2958
  2959     IF RESFORML > ZEROS
  2960        AND RESFORMI > SPACES
  2961        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  2962        MOVE RESFORMI            TO LETR-LETTER-ID
  2963        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  2964        MOVE SPACES              TO LETR-FILLER
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  53
* EL691.cbl
  2965        MOVE 0                   TO LETR-SEQ-NO
  2966        PERFORM 1500-CHECK-Z-RECORD THRU 1500-EXIT
  2967        IF Z-RECORD-NOT-FOUND
  2968           MOVE ER-1236          TO EMI-ERROR
  2969           MOVE -1               TO RESFORML
  2970           MOVE AL-UABON         TO RESFORMA
  2971           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2972        END-IF
  2973     END-IF
  2974
  2975     MOVE 'N'                    TO W-NEED-COMMENT.
  2976
  2977     IF RESENDL GREATER ZERO
  2978         MOVE 'Y'                TO W-NEED-COMMENT
  2979         IF RESENDI = SPACES
  2980             MOVE AL-UANON       TO  RESENDA
  2981             MOVE +1             TO  W-UPDATE-SW
  2982             MOVE LOW-VALUES     TO  W-RESEND-DATE
  2983         ELSE
  2984             MOVE RESENDI       TO  W-DEEDIT-FIELD
  2985             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2986             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2987                 MOVE W-DEEDIT-FIELD-V0  TO  RESENDO
  2988                 INSPECT RESENDI CONVERTING SPACES TO SLASH
  2989                 MOVE '4'        TO  DC-OPTION-CODE
  2990                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2991                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2992                 IF DC-ERROR-CODE NOT = SPACES
  2993                     MOVE ER-0295         TO  EMI-ERROR
  2994                     MOVE -1              TO  RESENDL
  2995                     MOVE AL-UABON        TO  RESENDA
  2996                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2997                 ELSE
  2998                     MOVE AL-UANON       TO  RESENDA
  2999                     MOVE +1             TO  W-UPDATE-SW
  3000                     MOVE DC-BIN-DATE-1  TO  W-RESEND-DATE
  3001                 END-IF
  3002             ELSE
  3003                 MOVE ER-0295    TO  EMI-ERROR
  3004                 MOVE -1         TO  RESENDL
  3005                 MOVE AL-UABON   TO  RESENDA
  3006                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3007             END-IF
  3008         END-IF
  3009     END-IF.
  3010
  3011     IF FINDATEL GREATER ZERO
  3012         IF FINDATEI = SPACES
  3013             MOVE AL-UANON       TO  FINDATEA
  3014             MOVE +1             TO  W-UPDATE-SW
  3015             MOVE LOW-VALUES     TO  W-FINAL-ACT-DATE
  3016             MOVE SPACES         TO  PI-ARCHIVE-FINAL
  3017         ELSE
  3018             MOVE 'Y'             TO  PI-ARCHIVE-FINAL
  3019             MOVE FINDATEI        TO  W-DEEDIT-FIELD
  3020             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3021             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3022                 MOVE W-DEEDIT-FIELD-V0  TO  FINDATEO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  54
* EL691.cbl
  3023                 INSPECT FINDATEI CONVERTING SPACES TO SLASH
  3024                 MOVE '4'                 TO  DC-OPTION-CODE
  3025                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  3026                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3027                 IF DC-ERROR-CODE NOT = SPACES
  3028                     MOVE ER-0296        TO  EMI-ERROR
  3029                     MOVE -1             TO  FINDATEL
  3030                     MOVE AL-UABON       TO  FINDATEA
  3031                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3032                 ELSE
  3033                     MOVE AL-UANON       TO  FINDATEA
  3034                     MOVE +1             TO  W-UPDATE-SW
  3035                     MOVE DC-BIN-DATE-1  TO  W-FINAL-ACT-DATE
  3036                 END-IF
  3037             ELSE
  3038                 MOVE ER-0296    TO  EMI-ERROR
  3039                 MOVE -1         TO  FINDATEL
  3040                 MOVE AL-UABON   TO  FINDATEA
  3041                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3042             END-IF
  3043         END-IF
  3044     END-IF.
  3045
  3046     IF REPLYL GREATER ZERO
  3047         IF REPLYI = SPACES
  3048             MOVE AL-UANON       TO  REPLYA
  3049             MOVE +1             TO  W-UPDATE-SW
  3050             MOVE LOW-VALUES     TO  W-RECEIVED-DATE
  3051             MOVE SPACES         TO  PI-ARCHIVE-RECEIVED
  3052                                     WS-RECEIVED-NOTE
  3053             PERFORM 4500-UPDATE-BILL-NOTE THRU 4500-EXIT
  3054         ELSE
  3055             MOVE 'Y'            TO  PI-ARCHIVE-RECEIVED
  3056             MOVE REPLYI         TO  W-DEEDIT-FIELD
  3057             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3058             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3059                 MOVE W-DEEDIT-FIELD-V0  TO  REPLYO
  3060                 INSPECT REPLYI CONVERTING SPACES TO SLASH
  3061                 MOVE '4'        TO  DC-OPTION-CODE
  3062                 MOVE W-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  3063                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3064                 IF DC-ERROR-CODE NOT = SPACES
  3065                     MOVE ER-9245        TO  EMI-ERROR
  3066                     MOVE -1             TO  REPLYL
  3067                     MOVE AL-UABON       TO  REPLYA
  3068                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3069                 ELSE
  3070                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  3071                       MOVE ER-0539      TO  EMI-ERROR
  3072                       MOVE -1           TO  REPLYL
  3073                       MOVE AL-UABON     TO  REPLYA
  3074                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3075                   ELSE
  3076                       MOVE AL-UANON     TO  REPLYA
  3077                       MOVE +1           TO  W-UPDATE-SW
  3078                       MOVE DC-BIN-DATE-1 TO W-RECEIVED-DATE
  3079                       MOVE DC-GREG-DATE-1-EDIT TO
  3080                                        W-CERT-NOTE-RECV-DT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  55
* EL691.cbl
  3081                                        WS-BN-RECV-DATE
  3082                   END-IF
  3083                 END-IF
  3084             ELSE
  3085                 MOVE ER-9245    TO  EMI-ERROR
  3086                 MOVE -1         TO  REPLYL
  3087                 MOVE AL-UABON   TO  REPLYA
  3088                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3089             END-IF
  3090         END-IF
  3091     END-IF.
  3092
  3093     IF STOPDTEL GREATER ZERO
  3094         IF STOPDTEI = SPACES
  3095             MOVE AL-UANON       TO  STOPDTEA
  3096             MOVE +1             TO  W-UPDATE-SW
  3097             MOVE LOW-VALUES     TO  W-STOP-LETTER-DATE
  3098             MOVE SPACES         TO  PI-ARCHIVE-STOPPED
  3099             MOVE AL-UANOF       TO  RESENDA
  3100                                     RESFORMA
  3101                                     FINDATEA
  3102                                     FINLACTA
  3103                                     REPLYA
  3104                                     COMMENTA
  3105         ELSE
  3106             MOVE 'Y'            TO  PI-ARCHIVE-STOPPED
  3107             MOVE 'Y'            TO  W-NEED-COMMENT
  3108             MOVE STOPDTEI       TO  W-DEEDIT-FIELD
  3109             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3110             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3111                 MOVE W-DEEDIT-FIELD-V0  TO  STOPDTEO
  3112                 INSPECT STOPDTEI CONVERTING SPACES TO SLASH
  3113                 MOVE '4'        TO  DC-OPTION-CODE
  3114                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  3115                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3116                 IF DC-ERROR-CODE NOT = SPACES
  3117                     MOVE ER-0897         TO  EMI-ERROR
  3118                     MOVE -1              TO  STOPDTEL
  3119                     MOVE AL-UABON        TO  STOPDTEA
  3120                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3121                 ELSE
  3122                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  3123                       MOVE ER-0895      TO  EMI-ERROR
  3124                       MOVE -1           TO  STOPDTEL
  3125                       MOVE AL-UABON     TO  STOPDTEA
  3126                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3127                   ELSE
  3128                     MOVE AL-UANON       TO  STOPDTEA
  3129                     MOVE +1             TO  W-UPDATE-SW
  3130                     MOVE DC-BIN-DATE-1  TO  W-STOP-LETTER-DATE
  3131                   END-IF
  3132                 END-IF
  3133             ELSE
  3134                 MOVE ER-0897    TO  EMI-ERROR
  3135                 MOVE -1         TO  STOPDTEL
  3136                 MOVE AL-UABON   TO  STOPDTEA
  3137                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3138             END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  56
* EL691.cbl
  3139         END-IF
  3140     END-IF.
  3141
  3142     IF W-NEED-COMMENT = 'Y'  AND
  3143        COMMENTL NOT > ZERO
  3144           MOVE -1         TO  COMMENTL
  3145           MOVE ER-7363    TO  EMI-ERROR
  3146           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3147     END-IF.
  3148     if (stopdtel > zeros)
  3149        and (PI-ARCHIVE-STOPPED = 'Y')
  3150        and (pi-initial-print-date <> low-values)
  3151        if obvyni not = 'Y' AND 'N'
  3152           move -1               to obvynl
  3153           move al-uabon         to obvyna
  3154           move er-7364          to emi-error
  3155           perform 9900-error-format
  3156                                 thru 9900-exit
  3157        end-if
  3158     end-if
  3159     if obvynl > zeros
  3160        and pi-archive-stopped <> 'Y'
  3161        move -1                  to stopdtel
  3162        move al-uabon            to stopdtea
  3163        move er-7333             to emi-error
  3164        perform 9900-error-format
  3165                                 thru 9900-exit
  3166     end-if
  3167     IF COMMENTL GREATER ZERO
  3168      OR  RESFORML GREATER ZERO
  3169      OR  FINLACTL GREATER ZERO
  3170      or obvynl > 0
  3171         MOVE +1          TO  W-UPDATE-SW
  3172     END-IF.
  3173
  3174     IF W-ERROR-COUNT GREATER ZERO
  3175         GO TO 8200-SEND-DATAONLY
  3176     END-IF.
  3177
  3178     IF W-UPDATE-SW NOT GREATER ZERO
  3179         MOVE ER-3112    TO  EMI-ERROR
  3180         MOVE -1         TO  MAINTL
  3181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3182         GO TO 8200-SEND-DATAONLY
  3183     END-IF.
  3184
  3185     IF PI-ARCHIVE-STOPPED = 'Y'
  3186        MOVE AL-SANOF       TO RESENDA
  3187                               RESFORMA
  3188                               FINDATEA
  3189                               FINLACTA
  3190                               REPLYA
  3191*                              COMMENTA
  3192     END-IF.
  3193
  3194     PERFORM 3000-READ-FOR-UPDATE THRU 3000-EXIT.
  3195
  3196     IF RESENDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  57
* EL691.cbl
  3197         MOVE W-RESEND-DATE      TO  LA-RESEND-DATE
  3198     END-IF.
  3199
  3200     IF FINDATEL GREATER ZERO
  3201         MOVE W-FINAL-ACT-DATE   TO  LA-FINAL-ACT-DATE
  3202     END-IF.
  3203     IF REPLYL GREATER ZERO  *> its really received date
  3204        MOVE W-RECEIVED-DATE     TO LA-REPLY-DATE
  3205        IF W-RECEIVED-DATE <> LOW-VALUES
  3206           move w-cert-note-msg  to w-comment-line-1
  3207           move +1               to w-comment-line-cnt
  3208           PERFORM 4000-ADD-CERT-NOTE
  3209                                 THRU 4099-EXIT
  3210           PERFORM 4500-UPDATE-BILL-NOTE
  3211                                 THRU 4500-EXIT
  3212        END-IF
  3213     END-IF
  3214     IF RESFORML GREATER ZERO
  3215        MOVE RESFORMI            TO  LA-RESEND-LETR
  3216     END-IF.
  3217
  3218     IF FINLACTL GREATER ZERO
  3219        MOVE FINLACTI            TO  LA-FINAL-ACT-IND
  3220     END-IF.
  3221
  3222     IF STOPDTEL GREATER ZERO
  3223        MOVE W-STOP-LETTER-DATE  TO  LA-VOIDED-DATE
  3224     END-IF.
  3225     perform 1620-read-elcert    thru 1620-exit
  3226
  3227     IF (OBVYNL > ZERO)
  3228        and (obvyni <> la-void-onbase-yn)
  3229        if (obvyni = 'N')
  3230           and (la-void-onbase-yn = spaces)
  3231           continue
  3232        else
  3233           if la-initial-print-date <> low-values
  3234              perform 1600-update-obkeywords
  3235                                 thru 1600-exit
  3236           end-if
  3237        end-if
  3238        MOVE OBVYNI              TO LA-VOID-ONBASE-YN
  3239     end-if
  3240
  3241     if (not cert-found)
  3242        or (sql-update-failed)
  3243        or ((la-initial-print-date = low-values)
  3244              and
  3245            (la-void-onbase-yn = 'Y'))
  3246
  3247* exec cics unlock
  3248*          dataset (W-ARCH-FILE-ID)
  3249*       end-exec
  3250*    MOVE '&*                    #   #00003116' TO DFHEIV0
  3251     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3252     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3253     MOVE X'2020233030303033313136' TO DFHEIV0(25:11)
  3254     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  58
* EL691.cbl
  3255           W-ARCH-FILE-ID,
  3256           DFHEIV99
  3257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3258        if connected-to-db
  3259           move ' '              to ws-connect-sw
  3260           display ' about to disconnect '
  3261           exec sql
  3262              disconnect
  3263           end-exec
  3264        end-if
  3265     end-if
  3266
  3267     if not cert-found
  3268        move er-0249             to emi-error
  3269        move -1                  to maintl
  3270        perform 9900-error-format thru 9900-exit
  3271        go to 8200-send-dataonly
  3272     end-if
  3273
  3274     if sql-update-failed
  3275        move er-7331             to emi-error
  3276        move -1                  to maintl
  3277        perform 9900-error-format thru 9900-exit
  3278        go to 8200-send-dataonly
  3279     end-if
  3280
  3281     if (la-void-onbase-yn = 'Y')
  3282        and (la-initial-print-date = low-values)
  3283        move er-7334             to emi-error
  3284        move -1                  to maintl
  3285        perform 9900-error-format thru 9900-exit
  3286        go to 8200-send-dataonly
  3287     end-if
  3288
  3289     if sql-update-succeeded
  3290        display ' about to commit work '
  3291        exec sql
  3292           commit work
  3293        end-exec
  3294     end-if
  3295     if connected-to-db
  3296        display ' about to disconnect all '
  3297        exec sql
  3298           disconnect
  3299        end-exec
  3300        move ' ' to ws-connect-sw
  3301     end-if
  3302     PERFORM 3100-REWRITE THRU 3100-EXIT.
  3303
  3304     IF COMMENTL NOT GREATER ZERO
  3305
  3306         MOVE ER-0000            TO  EMI-ERROR
  3307         MOVE ' '                TO  MAINTO
  3308         MOVE -1                 TO  MAINTL
  3309         MOVE AL-UANOF           TO  MAINTA
  3310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3311         GO TO 1000-SHOW
  3312     END-IF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  59
* EL691.cbl
  3313     if (commentl > zeros)
  3314        and (commenti not = spaces)
  3315        move commenti            to w-cert-note-comment
  3316        perform 4160-check-comment thru 4160-exit
  3317        PERFORM 4000-ADD-CERT-NOTE
  3318                                 THRU 4099-EXIT
  3319     end-if
  3320     PERFORM 3200-READ-ARCT-FOR-UPDATE THRU 3200-EXIT.
  3321
  3322     IF PI-COMMENT-INDEX EQUAL +20
  3323         MOVE ER-0051    TO  EMI-ERROR
  3324         MOVE -1         TO  MAINTL
  3325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3326         GO TO 8200-SEND-DATAONLY
  3327     END-IF
  3328
  3329     SET PI-COMMENT-INDEX UP BY +1.
  3330     SET LC-NDX TO PI-COMMENT-INDEX.
  3331     MOVE COMMENTI        TO  LT-COMMENT-LINE (LC-NDX)
  3332     MOVE W-SAVE-BIN-DATE TO  LT-COMMENT-CHG-DT (LC-NDX).
  3333     MOVE PI-PROCESSOR-ID TO  LT-COMMENT-CHG-BY (LC-NDX).
  3334     ADD +1               TO  LT-NUM-LINES-ON-RECORD.
  3335
  3336
  3337     IF W-ADD-ARCT = 'N'
  3338         PERFORM 3300-REWRITE-ARCT THRU 3300-EXIT
  3339     ELSE
  3340         PERFORM 3350-INSERT-ARCT THRU 3350-EXIT
  3341     END-IF.
  3342
  3343
  3344     MOVE ER-0000                TO  EMI-ERROR.
  3345     MOVE ' '                    TO  MAINTO.
  3346     MOVE -1                     TO  MAINTL.
  3347     MOVE AL-UANOF               TO  MAINTA.
  3348     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3349     GO TO 1000-SHOW.
  3350
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  60
* EL691.cbl
  3352
  3353 1000-SHOW.
  3354***************************************************************
  3355*     THIS ROUTINE WILL READ THE ARCHIVE FILE WITH THE        *
  3356*     ARCHIVE NUMBER SPECIFIED FROM THE PRIOR SCREEN.         *
  3357***************************************************************
  3358     MOVE LOW-VALUES              TO W-ARCT-KEY.
  3359     MOVE PI-COMPANY-CD           TO W-ARCH-COMPANY-CD
  3360                                     W-ARCT-COMPANY-CD.
  3361     MOVE PI-689-ARCHIVE-NUMBER   TO W-ARCH-NUMBER
  3362                                     W-ARCT-ARCHIVE-NO.
  3363     MOVE '3'                     TO W-ARCT-RECORD-TYPE.
  3364     MOVE +0                      TO W-ARCT-LINE-SEQ-NO.
  3365
  3366
  3367* EXEC CICS HANDLE CONDITION
  3368*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3369*         NOTFND     (1070-ARCH-NOT-FOUND)
  3370*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3371*    END-EXEC.
  3372*    MOVE '"$JI''                 ! $ #00003227' TO DFHEIV0
  3373     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3375     MOVE X'2420233030303033323237' TO DFHEIV0(25:11)
  3376     CALL 'kxdfhei1' USING DFHEIV0
  3377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3378
  3379
  3380
  3381* EXEC CICS READ
  3382*        DATASET (W-ARCH-FILE-ID)
  3383*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3384*        RIDFLD  (W-ARCH-KEY)
  3385*    END-EXEC.
  3386*    MOVE '&"S        E          (   #00003233' TO DFHEIV0
  3387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3389     MOVE X'2020233030303033323333' TO DFHEIV0(25:11)
  3390     CALL 'kxdfhei1' USING DFHEIV0,
  3391           W-ARCH-FILE-ID,
  3392           DFHEIV20,
  3393           DFHEIV99,
  3394           W-ARCH-KEY,
  3395           DFHEIV99,
  3396           DFHEIV99,
  3397           DFHEIV99
  3398     SET ADDRESS OF LETTER-ARCHIVE TO
  3399         DFHEIV20
  3400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3401
  3402
  3403     MOVE LA-FORM-A3             TO FORMNOO.
  3404     MOVE LA-FORM-A3             TO PI-ARCHIVE-LTRID
  3405     MOVE LA-ARCHIVE-NO          TO ARCHNOO.
  3406     MOVE LA-CARRIER-A2          TO CARRIERO.
  3407     MOVE LA-GROUPING-A2         TO GROUPO.
  3408     MOVE LA-STATE-A2            TO STATEO.
  3409     MOVE LA-ACCOUNT-A2          TO ACCTO.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  61
* EL691.cbl
  3410     MOVE LA-CERT-PRIME-A2       TO CERTO.
  3411     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  3412
  3413     IF LA-ENDT-ARCH-NO-X EQUAL LOW-VALUES OR SPACES
  3414          MOVE SPACES            TO ENDARCHO
  3415     ELSE
  3416          MOVE LA-ENDT-ARCH-NO   TO ENDARCHO
  3417     END-IF
  3418
  3419     IF  LA-CREATION-DATE EQUAL LOW-VALUES OR SPACES
  3420         MOVE SPACES             TO CREATDTI
  3421                                    pi-create-date
  3422     ELSE
  3423         MOVE LA-CREATION-DATE   TO DC-BIN-DATE-1
  3424         MOVE ' '                TO DC-OPTION-CODE
  3425         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3426         MOVE DC-GREG-DATE-1-EDIT TO CREATDTI
  3427                                     pi-create-date
  3428     END-IF.
  3429
  3430     MOVE LA-PROCESSOR-CD        TO CREATBYI.
  3431
  3432     IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES OR SPACES
  3433         MOVE SPACES             TO PRINTDTI
  3434         move low-values         to pi-initial-print-date
  3435     ELSE
  3436         move la-initial-print-date
  3437                                 to pi-initial-print-date
  3438         MOVE LA-INITIAL-PRINT-DATE TO DC-BIN-DATE-1
  3439         MOVE ' '                TO DC-OPTION-CODE
  3440         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3441         MOVE DC-GREG-DATE-1-EDIT TO PRINTDTI
  3442     END-IF.
  3443
  3444     IF  LA-RESEND-DATE = LOW-VALUES OR SPACES
  3445         MOVE SPACES             TO RESENDI
  3446     ELSE
  3447         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  3448         MOVE ' '                TO DC-OPTION-CODE
  3449         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3450         MOVE DC-GREG-DATE-1-EDIT TO RESENDI
  3451     END-IF.
  3452
  3453     MOVE LA-RESEND-LETR         TO RESFORMI.
  3454
  3455     IF  LA-SENT-DATE = LOW-VALUES OR SPACES
  3456         MOVE SPACES             TO RESPRNTI
  3457         MOVE SPACES             TO PI-ARCHIVE-COMPLETE
  3458     ELSE
  3459         MOVE 'Y'                TO PI-ARCHIVE-COMPLETE
  3460         MOVE LA-SENT-DATE     TO DC-BIN-DATE-1
  3461         MOVE ' '                TO DC-OPTION-CODE
  3462         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3463         MOVE DC-GREG-DATE-1-EDIT TO RESPRNTI
  3464     END-IF.
  3465
  3466     IF  LA-FINAL-ACT-DATE EQUAL LOW-VALUES OR SPACES
  3467         MOVE SPACES             TO FINDATEI
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  62
* EL691.cbl
  3468         MOVE SPACES             TO PI-ARCHIVE-FINAL
  3469     ELSE
  3470         MOVE 'Y'                TO PI-ARCHIVE-FINAL
  3471         MOVE LA-FINAL-ACT-DATE  TO DC-BIN-DATE-1
  3472         MOVE ' '                TO DC-OPTION-CODE
  3473         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3474         MOVE DC-GREG-DATE-1-EDIT TO FINDATEI
  3475     END-IF.
  3476
  3477     MOVE LA-FINAL-ACT-IND       TO FINLACTI.
  3478
  3479     IF  LA-REPLY-DATE = LOW-VALUES OR SPACES
  3480         MOVE SPACES             TO REPLYI
  3481         MOVE SPACES             TO PI-ARCHIVE-RECEIVED
  3482     ELSE
  3483         MOVE 'Y'                TO PI-ARCHIVE-RECEIVED
  3484         MOVE LA-REPLY-DATE      TO DC-BIN-DATE-1
  3485         MOVE ' '                TO DC-OPTION-CODE
  3486         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3487         MOVE DC-GREG-DATE-1-EDIT TO REPLYI
  3488     END-IF.
  3489
  3490     IF  LA-VOIDED-DATE = LOW-VALUES OR SPACES
  3491         MOVE SPACES             TO STOPDTEI
  3492         MOVE SPACES             TO PI-ARCHIVE-STOPPED
  3493     ELSE
  3494         MOVE 'Y'                TO PI-ARCHIVE-STOPPED
  3495         MOVE LA-VOIDED-DATE     TO DC-BIN-DATE-1
  3496         MOVE ' '                TO DC-OPTION-CODE
  3497         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3498         MOVE DC-GREG-DATE-1-EDIT TO STOPDTEI
  3499     END-IF.
  3500     if LA-VOID-ONBASE-YN not = spaces
  3501        move LA-VOID-ONBASE-YN   to obvyno
  3502     end-if
  3503     if la-onbase-unique-id numeric
  3504        move la-onbase-unique-id to obuido
  3505     end-if
  3506     IF LA-LAST-MAINT-DATE = LOW-VALUES OR SPACES
  3507         MOVE SPACES             TO MAINTDTI
  3508     ELSE
  3509         MOVE LA-LAST-MAINT-DATE TO DC-BIN-DATE-1
  3510         MOVE ' '                TO DC-OPTION-CODE
  3511         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3512         MOVE DC-GREG-DATE-1-EDIT TO MAINTDTI
  3513     END-IF.
  3514
  3515     IF LA-LAST-MAINT-TIMEX = LOW-VALUES OR SPACES
  3516         MOVE ZEROES             TO MAINTTMO
  3517     ELSE
  3518         MOVE LA-LAST-MAINT-TIME TO W-TIME-IN
  3519         MOVE W-TIME-OUT         TO MAINTTMO
  3520     END-IF.
  3521
  3522     MOVE LA-LAST-UPDATED-BY     TO MAINTBYI.
  3523
  3524     IF (LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  3525       OR (LA-VOIDED-DATE  NOT EQUAL LOW-VALUES AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  63
* EL691.cbl
  3526          MOVE AL-SANOF          TO RESENDA
  3527                                    RESFORMA
  3528                                    FINDATEA
  3529                                    FINLACTA
  3530                                    REPLYA
  3531                                    COMMENTA
  3532     END-IF.
  3533
  3534     IF LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES
  3535         MOVE AL-SANOF           TO STOPDTEA
  3536     END-IF.
  3537
  3538
  3539* EXEC CICS HANDLE CONDITION
  3540*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  3541*         NOTFND     (1000-ARCT-NOT-FOUND)
  3542*         ENDFILE    (1000-ARCT-NOT-FOUND)
  3543*    END-EXEC.
  3544*    MOVE '"$JI''                 ! % #00003374' TO DFHEIV0
  3545     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3547     MOVE X'2520233030303033333734' TO DFHEIV0(25:11)
  3548     CALL 'kxdfhei1' USING DFHEIV0
  3549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3550
  3551
  3552
  3553* EXEC CICS READ
  3554*        DATASET  (W-ARCT-FILE-ID)
  3555*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3556*        RIDFLD   (W-ARCT-KEY)
  3557*    END-EXEC.
  3558*    MOVE '&"S        E          (   #00003380' TO DFHEIV0
  3559     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3560     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3561     MOVE X'2020233030303033333830' TO DFHEIV0(25:11)
  3562     CALL 'kxdfhei1' USING DFHEIV0,
  3563           W-ARCT-FILE-ID,
  3564           DFHEIV20,
  3565           DFHEIV99,
  3566           W-ARCT-KEY,
  3567           DFHEIV99,
  3568           DFHEIV99,
  3569           DFHEIV99
  3570     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3571         DFHEIV20
  3572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3573
  3574
  3575     SET LC-NDX TO W-ZEROS.
  3576     PERFORM 20 TIMES
  3577         SET LC-NDX UP BY +1
  3578         IF LT-COMMENT-LINE (LC-NDX) > SPACES
  3579             MOVE LT-COMMENT-LINE (LC-NDX) TO COMMENTI
  3580             SET PI-COMMENT-INDEX TO LC-NDX
  3581         END-IF
  3582     END-PERFORM.
  3583
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  64
* EL691.cbl
  3584     MOVE -1                     TO MAINTL.
  3585     GO TO 8100-SEND-INITIAL-MAP.
  3586
  3587 1000-ARCT-NOT-FOUND.
  3588
  3589     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3590     MOVE -1                     TO MAINTL.
  3591     GO TO 8100-SEND-INITIAL-MAP.
  3592
  3593 1000-EXIT.
  3594     EXIT.
  3595
  3596
  3597 1070-ARCH-NOT-FOUND.
  3598
  3599     MOVE ER-7371                TO EMI-ERROR.
  3600     MOVE -1                     TO ARCHNOL.
  3601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3602     GO TO 8100-SEND-INITIAL-MAP.
  3603
  3604
  3605 1500-CHECK-Z-RECORD.
  3606
  3607     MOVE 'N' TO WS-Z-RECORD-IND
  3608
  3609
  3610* EXEC CICS STARTBR
  3611*         DATASET    ('ELLETR')
  3612*         RIDFLD     (ELLETR-KEY)
  3613*         GTEQ
  3614*         RESP      (W-RESPONSE)
  3615*    END-EXEC.
  3616     MOVE 'ELLETR' TO DFHEIV1
  3617     MOVE 0
  3618       TO DFHEIV11
  3619*    MOVE '&,         G          &  N#00003420' TO DFHEIV0
  3620     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3621     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3622     MOVE X'204E233030303033343230' TO DFHEIV0(25:11)
  3623     CALL 'kxdfhei1' USING DFHEIV0,
  3624           DFHEIV1,
  3625           ELLETR-KEY,
  3626           DFHEIV99,
  3627           DFHEIV11,
  3628           DFHEIV99
  3629     MOVE EIBRESP  TO W-RESPONSE
  3630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3631
  3632     IF NOT RESP-NORMAL
  3633         GO TO 1500-ENDBR
  3634     END-IF.
  3635
  3636 1500-READNEXT.
  3637
  3638
  3639* EXEC CICS READNEXT
  3640*        DATASET   ('ELLETR')
  3641*        INTO      (TEXT-FILES)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  65
* EL691.cbl
  3642*        RIDFLD    (ELLETR-KEY)
  3643*        RESP      (W-RESPONSE)
  3644*    END-EXEC
  3645     MOVE LENGTH OF
  3646      TEXT-FILES
  3647       TO DFHEIV12
  3648     MOVE 'ELLETR' TO DFHEIV1
  3649     MOVE 0
  3650       TO DFHEIV11
  3651*    MOVE '&.IL                  )  N#00003432' TO DFHEIV0
  3652     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3653     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3654     MOVE X'204E233030303033343332' TO DFHEIV0(25:11)
  3655     CALL 'kxdfhei1' USING DFHEIV0,
  3656           DFHEIV1,
  3657           TEXT-FILES,
  3658           DFHEIV12,
  3659           ELLETR-KEY,
  3660           DFHEIV99,
  3661           DFHEIV11,
  3662           DFHEIV99,
  3663           DFHEIV99
  3664     MOVE EIBRESP  TO W-RESPONSE
  3665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3666     IF RESP-NORMAL
  3667        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  3668           GO TO 1500-ENDBR
  3669        END-IF
  3670
  3671        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  3672           MOVE 'Y' TO WS-Z-RECORD-IND
  3673           GO TO 1500-ENDBR
  3674        ELSE
  3675           GO TO 1500-READNEXT
  3676        END-IF
  3677     ELSE
  3678        GO TO 1500-ENDBR
  3679     END-IF.
  3680
  3681 1500-ENDBR.
  3682
  3683
  3684* EXEC CICS ENDBR
  3685*        DATASET     ('ELLETR')
  3686*    END-EXEC.
  3687     MOVE 'ELLETR' TO DFHEIV1
  3688     MOVE 0
  3689       TO DFHEIV11
  3690*    MOVE '&2                    $   #00003455' TO DFHEIV0
  3691     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3692     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3693     MOVE X'2020233030303033343535' TO DFHEIV0(25:11)
  3694     CALL 'kxdfhei1' USING DFHEIV0,
  3695           DFHEIV1,
  3696           DFHEIV11,
  3697           DFHEIV99
  3698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3699
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  66
* EL691.cbl
  3700
  3701 1500-EXIT.
  3702      EXIT.
  3703 1600-update-obkeywords.
  3704
  3705     if not connected-to-db
  3706        perform 1700-CONNECT-TO-DB
  3707                                 thru 1700-exit
  3708     end-if
  3709
  3710*    perform 1620-read-elcert    thru 1620-exit
  3711*    if not cert-found
  3712*       go to 1600-exit
  3713*    end-if
  3714
  3715     if obvyni = 'N'
  3716        if la-onbase-unique-id numeric
  3717           and la-onbase-unique-id > 0
  3718           perform 1610-void-void thru 1610-exit
  3719           go to 1600-exit
  3720        end-if
  3721     end-if
  3722
  3723***  If I get here I assume they are voiding the letter
  3724***  I am using a stored procedure so I can get back the
  3725***  unique id from the insert and update the erarch
  3726***  record with it.  May come in handy down the road
  3727
  3728     if obvyni = 'Y'
  3729        and (la-onbase-unique-id not numeric
  3730           or la-onbase-unique-id = zeros)
  3731        continue
  3732     else
  3733        go to 1600-exit
  3734     end-if
  3735
  3736     move 'CID Certs'            to db-doc-type
  3737     move 'Status'               to db-key-word-type
  3738     move 'V'                    to db-key-word-value
  3739     move cm-state               to db-cert-state
  3740     move cm-cert-prime          to db-cert-no
  3741     move cm-lf-loan-expire-dt   to dc-bin-date-1
  3742     if cm-ah-loan-expire-dt > cm-lf-loan-expire-dt
  3743        move cm-ah-loan-expire-dt
  3744                                 to dc-bin-date-1
  3745     end-if
  3746     move ' '                    to dc-option-code
  3747     perform 9500-LINK-DATE-CONVERT thru 9500-exit
  3748     if no-conversion-error
  3749        move dc-greg-date-a-edit to db-cert-exp-dt
  3750        inspect db-cert-exp-dt
  3751           converting '/' to '-'
  3752     end-if
  3753     move la-initial-print-date  to dc-bin-date-1
  3754     move ' '                    to dc-option-code
  3755     perform 9500-LINK-DATE-CONVERT thru 9500-exit
  3756     if no-conversion-error
  3757        move dc-greg-date-a-edit to db-print-dt
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  67
* EL691.cbl
  3758        inspect db-print-dt
  3759           converting '/' to '-'
  3760     end-if
  3761
  3762     EXEC SQL
  3763        CALL sp_OBKeyWordChgs_ADD
  3764           @DocType       =  :db-doc-type,
  3765           @CertNo        =  :db-cert-no,
  3766           @PrintDt       =  :db-print-dt,
  3767           @CertExpDt     =  :db-cert-exp-dt,
  3768           @CertSt        =  :db-cert-state,
  3769           @KeyWordType   =  :db-key-word-type,
  3770           @KeyWordValue  =  :db-key-word-value,
  3771           @RetValue      = :kd-unique-id OUT
  3772     END-EXEC
  3773
  3774     if sqlcode not = 0
  3775        move sqlcode             to ws-sql-code
  3776        move ws-sql-code         to ws-dis-sql-code
  3777        display ' Error: Cannot INSERT row ' kd-unique-id
  3778        display ' sql return code        ' ws-dis-sql-code
  3779        display ' sql err mess           ' sqlerrmc
  3780        set sql-update-failed to true
  3781     else
  3782        move kd-unique-id        to la-onbase-unique-id
  3783                                    obuido
  3784        set sql-update-succeeded to true
  3785     end-if
  3786
  3787     .
  3788 1600-exit.
  3789     exit.
  3790
  3791 1610-void-void.
  3792
  3793     move la-onbase-unique-id    to kd-unique-id
  3794     EXEC SQL
  3795        SELECT
  3796           RequestDate,
  3797           KeyWordType,
  3798           KeyWordValue,
  3799           CompletionDate
  3800        INTO
  3801           :db-req-date,
  3802           :db-key-word-type,
  3803           :db-key-word-value,
  3804           :db-complete-dt  :nu-Complete-date
  3805        FROM
  3806           OBKeyWordChgs
  3807        where
  3808           :kd-unique-id = UniqueID
  3809     END-EXEC
  3810
  3811     if sqlcode not = 0
  3812        move sqlcode             to ws-sql-code
  3813        move ws-sql-code         to ws-dis-sql-code
  3814        display ' Error: Cannot read row ' kd-unique-id
  3815        display ' sql return code        ' ws-dis-sql-code
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  68
* EL691.cbl
  3816        display ' sql err mess           ' sqlerrmc
  3817        go to 1610-exit
  3818     end-if
  3819     if nu-complete-date = -1
  3820        display ' complete date is null '
  3821     end-if
  3822     if nu-complete-date = -1  *> isnull
  3823        and db-key-word-type = 'Status'
  3824        and obvyni <> 'Y'
  3825        and db-key-word-value = 'V'
  3826
  3827        EXEC SQL
  3828           DELETE
  3829              OBKeyWordChgs
  3830           WHERE
  3831              UniqueID = :kd-unique-id
  3832        END-EXEC
  3833
  3834        if sqlcode = 0
  3835           display ' delete succeeded '
  3836           set sql-update-succeeded to true
  3837           move zeros            to la-onbase-unique-id
  3838        else
  3839           display ' delete not successful ' sqlcode
  3840           set sql-update-failed to true
  3841        end-if
  3842     end-if
  3843
  3844     .
  3845 1610-exit.
  3846     exit.
  3847
  3848 1620-read-elcert.
  3849
  3850     move la-company-cd          to elcert-key
  3851     move la-carrier-a2          to elcert-carrier
  3852     move la-grouping-a2         to elcert-grouping
  3853     move la-state-a2            to elcert-state
  3854     move la-account-a2          to elcert-account
  3855     move la-effect-date-a2      to elcert-eff-dt
  3856     move la-cert-no-a2          to elcert-cert-no
  3857
  3858
  3859* exec cics read
  3860*       dataset    ('ELCERT')
  3861*       ridfld     (elcert-key)
  3862*       SET        (ADDRESS OF CERTIFICATE-MASTER)
  3863*       resp       (w-response)
  3864*    end-exec
  3865     MOVE 'ELCERT' TO DFHEIV1
  3866*    MOVE '&"S        E          (  N#00003616' TO DFHEIV0
  3867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3869     MOVE X'204E233030303033363136' TO DFHEIV0(25:11)
  3870     CALL 'kxdfhei1' USING DFHEIV0,
  3871           DFHEIV1,
  3872           DFHEIV20,
  3873           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  69
* EL691.cbl
  3874           elcert-key,
  3875           DFHEIV99,
  3876           DFHEIV99,
  3877           DFHEIV99
  3878     SET ADDRESS OF CERTIFICATE-MASTER TO
  3879         DFHEIV20
  3880     MOVE EIBRESP  TO w-response
  3881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3882
  3883     if resp-normal
  3884        set cert-found to true
  3885     end-if
  3886
  3887     .
  3888 1620-exit.
  3889     exit.
  3890
  3891 1700-CONNECT-TO-DB.
  3892
  3893     move 'NTSQLTST2_PEMA'       to svr
  3894     move 'sa'                   to usr
  3895     move 'sql2008r2'            to pass
  3896
  3897     if ws-kix-myenv = 'cid1p'
  3898        move 'NTCSO2_Logic'      to svr
  3899        move 'sa'                to usr
  3900        move 'ntcso2'            to pass
  3901     end-if
  3902
  3903     string
  3904         usr delimited space
  3905         "." delimited size
  3906         pass delimited space into usr-pass
  3907     end-string
  3908
  3909     EXEC SQL
  3910        CONNECT TO :svr USER :usr-pass
  3911     END-EXEC
  3912
  3913     if sqlcode not = 0
  3914        move sqlcode             to ws-sql-code
  3915        move ws-sql-code         to ws-dis-sql-code
  3916        display ' Error: Cannot Connect  ' kd-unique-id
  3917        display ' sql return code        ' ws-dis-sql-code
  3918        display ' sql err mess           ' sqlerrmc
  3919        move er-7332             to emi-error
  3920        perform 9900-error-format thru 9900-exit
  3921        go to 8200-send-dataonly
  3922     end-if
  3923
  3924     set connected-to-db to true
  3925     display ' good connection '
  3926
  3927     .
  3928 1700-EXIT.
  3929     EXIT.
  3930 3000-READ-FOR-UPDATE.
  3931
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  70
* EL691.cbl
  3932
  3933* EXEC CICS HANDLE CONDITION
  3934*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3935*         NOTFND     (1070-ARCH-NOT-FOUND)
  3936*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3937*    END-EXEC.
  3938*    MOVE '"$JI''                 ! & #00003672' TO DFHEIV0
  3939     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3941     MOVE X'2620233030303033363732' TO DFHEIV0(25:11)
  3942     CALL 'kxdfhei1' USING DFHEIV0
  3943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3944
  3945
  3946     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
  3947     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCH-NUMBER
  3948
  3949
  3950* EXEC CICS READ
  3951*        DATASET (W-ARCH-FILE-ID)
  3952*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3953*        RIDFLD  (W-ARCH-KEY)
  3954*        UPDATE
  3955*    END-EXEC.
  3956*    MOVE '&"S        EU         (   #00003681' TO DFHEIV0
  3957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3958     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3959     MOVE X'2020233030303033363831' TO DFHEIV0(25:11)
  3960     CALL 'kxdfhei1' USING DFHEIV0,
  3961           W-ARCH-FILE-ID,
  3962           DFHEIV20,
  3963           DFHEIV99,
  3964           W-ARCH-KEY,
  3965           DFHEIV99,
  3966           DFHEIV99,
  3967           DFHEIV99
  3968     SET ADDRESS OF LETTER-ARCHIVE TO
  3969         DFHEIV20
  3970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3971
  3972
  3973 3000-EXIT.
  3974     EXIT.
  3975
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  71
* EL691.cbl
  3977
  3978 3100-REWRITE.
  3979
  3980     MOVE PI-PROCESSOR-ID        TO  LA-LAST-UPDATED-BY
  3981                                     MAINTBYI.
  3982     MOVE W-SAVE-BIN-DATE        TO  LA-LAST-MAINT-DATE.
  3983     MOVE W-SAVE-DATE            TO  MAINTDTI.
  3984
  3985     MOVE EIBTIME                TO  LA-LAST-MAINT-TIME
  3986                                     W-TIME-IN.
  3987     MOVE W-TIME-OUT             TO  MAINTTMO.
  3988
  3989
  3990* EXEC CICS REWRITE
  3991*        DATASET (W-ARCH-FILE-ID)
  3992*        FROM    (LETTER-ARCHIVE)
  3993*    END-EXEC.
  3994     MOVE LENGTH OF
  3995      LETTER-ARCHIVE
  3996       TO DFHEIV11
  3997*    MOVE '&& L                  %   #00003704' TO DFHEIV0
  3998     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3999     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4000     MOVE X'2020233030303033373034' TO DFHEIV0(25:11)
  4001     CALL 'kxdfhei1' USING DFHEIV0,
  4002           W-ARCH-FILE-ID,
  4003           LETTER-ARCHIVE,
  4004           DFHEIV11,
  4005           DFHEIV99
  4006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4007
  4008
  4009 3100-EXIT.
  4010     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  72
* EL691.cbl
  4012 3200-READ-ARCT-FOR-UPDATE.
  4013
  4014
  4015* EXEC CICS HANDLE CONDITION
  4016*         NOTFND     (3200-NOT-FOUND)
  4017*         ENDFILE    (3200-NOT-FOUND)
  4018*    END-EXEC.
  4019*    MOVE '"$I''                  ! '' #00003714' TO DFHEIV0
  4020     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4021     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4022     MOVE X'2720233030303033373134' TO DFHEIV0(25:11)
  4023     CALL 'kxdfhei1' USING DFHEIV0
  4024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4025
  4026
  4027     MOVE PI-COMPANY-CD TO W-ARCT-COMPANY-CD.
  4028     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCT-ARCHIVE-NO.
  4029     MOVE '3'                   TO W-ARCT-RECORD-TYPE.
  4030     MOVE +0                    TO W-ARCT-LINE-SEQ-NO.
  4031
  4032
  4033* EXEC CICS READ
  4034*        DATASET  (W-ARCT-FILE-ID)
  4035*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  4036*        RIDFLD   (W-ARCT-KEY)
  4037*        UPDATE
  4038*    END-EXEC.
  4039*    MOVE '&"S        EU         (   #00003724' TO DFHEIV0
  4040     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4041     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4042     MOVE X'2020233030303033373234' TO DFHEIV0(25:11)
  4043     CALL 'kxdfhei1' USING DFHEIV0,
  4044           W-ARCT-FILE-ID,
  4045           DFHEIV20,
  4046           DFHEIV99,
  4047           W-ARCT-KEY,
  4048           DFHEIV99,
  4049           DFHEIV99,
  4050           DFHEIV99
  4051     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  4052         DFHEIV20
  4053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4054
  4055
  4056     MOVE 'N' TO W-ADD-ARCT.
  4057     GO TO 3200-EXIT.
  4058
  4059 3200-NOT-FOUND.
  4060
  4061
  4062* EXEC CICS GETMAIN
  4063*         SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  4064*         LENGTH   (W-ARCT-LENGTH)
  4065*    END-EXEC.
  4066*    MOVE '," L                  $   #00003736' TO DFHEIV0
  4067     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4068     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4069     MOVE X'2020233030303033373336' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  73
* EL691.cbl
  4070     CALL 'kxdfhei1' USING DFHEIV0,
  4071           DFHEIV20,
  4072           W-ARCT-LENGTH,
  4073           DFHEIV99
  4074     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  4075         DFHEIV20
  4076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4077
  4078
  4079     MOVE 'Y'                    TO W-ADD-ARCT.
  4080     MOVE LOW-VALUES             TO LETTER-ARCHIVE-TEXT.
  4081     MOVE 'LT'                   TO LT-RECORD-ID.
  4082     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
  4083     MOVE PI-689-ARCHIVE-NUMBER  TO LT-ARCHIVE-NO.
  4084     MOVE '3'                    TO LT-RECORD-TYPE.
  4085     MOVE +0                     TO LT-LINE-SEQ-NO.
  4086     MOVE +0                     TO LT-NUM-LINES-ON-RECORD.
  4087     SET PI-COMMENT-INDEX        TO W-ZEROS.
  4088
  4089 3200-EXIT.
  4090     EXIT.
  4091
  4092 3300-REWRITE-ARCT.
  4093
  4094
  4095* EXEC CICS REWRITE
  4096*        DATASET (W-ARCT-FILE-ID)
  4097*        FROM    (LETTER-ARCHIVE-TEXT)
  4098*    END-EXEC.
  4099     MOVE LENGTH OF
  4100      LETTER-ARCHIVE-TEXT
  4101       TO DFHEIV11
  4102*    MOVE '&& L                  %   #00003756' TO DFHEIV0
  4103     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4104     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4105     MOVE X'2020233030303033373536' TO DFHEIV0(25:11)
  4106     CALL 'kxdfhei1' USING DFHEIV0,
  4107           W-ARCT-FILE-ID,
  4108           LETTER-ARCHIVE-TEXT,
  4109           DFHEIV11,
  4110           DFHEIV99
  4111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4112
  4113
  4114 3300-EXIT.
  4115     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  74
* EL691.cbl
  4117
  4118 3350-INSERT-ARCT.
  4119
  4120* EXEC CICS WRITE
  4121*         DATASET   (W-ARCT-FILE-ID)
  4122*         FROM      (LETTER-ARCHIVE-TEXT)
  4123*         RIDFLD    (LT-CONTROL-PRIMARY)
  4124*    END-EXEC.
  4125     MOVE LENGTH OF
  4126      LETTER-ARCHIVE-TEXT
  4127       TO DFHEIV11
  4128*    MOVE '&$ L                  ''   #00003766' TO DFHEIV0
  4129     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4131     MOVE X'2020233030303033373636' TO DFHEIV0(25:11)
  4132     CALL 'kxdfhei1' USING DFHEIV0,
  4133           W-ARCT-FILE-ID,
  4134           LETTER-ARCHIVE-TEXT,
  4135           DFHEIV11,
  4136           LT-CONTROL-PRIMARY,
  4137           DFHEIV99,
  4138           DFHEIV99
  4139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4140
  4141
  4142 3350-EXIT.
  4143     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  75
* EL691.cbl
  4145
  4146
  4147 4000-ADD-CERT-NOTE.
  4148
  4149     MOVE SPACES                 TO  ERCNOT-KEY
  4150                                     ELCERT-KEY.
  4151     move spaces                 to cert-note-records-holder
  4152                                    ws-build-note-sw
  4153                                    ws-ercnot-sw
  4154     move +0                     to c1
  4155     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  4156                                     ELCERT-COMPANY-CD.
  4157     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  4158                                     ELCERT-CARRIER.
  4159     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  4160                                     ELCERT-GROUPING.
  4161     MOVE PI-STATE               TO  ERCNOT-STATE
  4162                                     ELCERT-STATE.
  4163     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  4164                                     ELCERT-ACCOUNT.
  4165     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  4166                                     ELCERT-EFF-DT.
  4167     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  4168                                     ELCERT-CERT-PRIME.
  4169     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  4170                                     ELCERT-CERT-SFX.
  4171     MOVE '1'                    TO  ERCNOT-REC-TYP
  4172     MOVE ZEROS                  TO  ERCNOT-SEQ.
  4173     MOVE ERCNOT-KEY             TO  SV-PRIOR-KEY.
  4174
  4175* EXEC CICS STARTBR
  4176*       DATASET    ('ERCNOT')
  4177*       RIDFLD     (ercnot-key)
  4178*       GTEQ
  4179*       RESP       (W-RESPONSE)
  4180*    END-EXEC
  4181     MOVE 'ERCNOT' TO DFHEIV1
  4182     MOVE 0
  4183       TO DFHEIV11
  4184*    MOVE '&,         G          &  N#00003804' TO DFHEIV0
  4185     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4186     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4187     MOVE X'204E233030303033383034' TO DFHEIV0(25:11)
  4188     CALL 'kxdfhei1' USING DFHEIV0,
  4189           DFHEIV1,
  4190           ercnot-key,
  4191           DFHEIV99,
  4192           DFHEIV11,
  4193           DFHEIV99
  4194     MOVE EIBRESP  TO W-RESPONSE
  4195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4196
  4197     IF RESP-NORMAL
  4198        set ercnot-startbr to true
  4199*       display ' resp normal startbr '
  4200        perform until finished-with-notes
  4201
  4202* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  76
* EL691.cbl
  4203*             DATASET    ('ERCNOT')
  4204*             RIDFLD     (ercnot-key)
  4205*             INTO       (cert-note-file)
  4206*             resp       (w-response)
  4207*          end-exec
  4208     MOVE LENGTH OF
  4209      cert-note-file
  4210       TO DFHEIV12
  4211     MOVE 'ERCNOT' TO DFHEIV1
  4212     MOVE 0
  4213       TO DFHEIV11
  4214*    MOVE '&.IL                  )  N#00003815' TO DFHEIV0
  4215     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4216     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4217     MOVE X'204E233030303033383135' TO DFHEIV0(25:11)
  4218     CALL 'kxdfhei1' USING DFHEIV0,
  4219           DFHEIV1,
  4220           cert-note-file,
  4221           DFHEIV12,
  4222           ercnot-key,
  4223           DFHEIV99,
  4224           DFHEIV11,
  4225           DFHEIV99,
  4226           DFHEIV99
  4227     MOVE EIBRESP  TO w-response
  4228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4229           if (resp-normal)
  4230              and (cz-control-primary (1:33) =
  4231                 sv-prior-key (1:33))
  4232              if cz-record-type = '1'
  4233                 add +1 to c1
  4234                 move cert-note-file
  4235                                 to cert-note-record (c1)
  4236              end-if
  4237           else
  4238              set finished-with-notes to true
  4239           end-if
  4240        end-perform
  4241     end-if
  4242
  4243     if ercnot-startbr
  4244*       display ' about to endbr ercnot '
  4245
  4246* exec cics endbr
  4247*          dataset    ('ERCNOT')
  4248*       end-exec
  4249     MOVE 'ERCNOT' TO DFHEIV1
  4250     MOVE 0
  4251       TO DFHEIV11
  4252*    MOVE '&2                    $   #00003837' TO DFHEIV0
  4253     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4254     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4255     MOVE X'2020233030303033383337' TO DFHEIV0(25:11)
  4256     CALL 'kxdfhei1' USING DFHEIV0,
  4257           DFHEIV1,
  4258           DFHEIV11,
  4259           DFHEIV99
  4260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  77
* EL691.cbl
  4261     end-if
  4262     move c1                     to note-count
  4263
  4264     if c1 = +0
  4265        perform 4100-add-note    thru 4100-exit
  4266     else
  4267        perform 4120-delete-cert-notes
  4268                                 thru 4120-exit
  4269        if resp-normal
  4270           perform 4100-add-note thru 4100-exit
  4271           if resp-normal
  4272              perform 4140-put-back-cert-notes
  4273                                 thru 4140-exit
  4274              if resp-normal
  4275                 display 'NOTE SUCCESSFULLY ADDED'
  4276              else
  4277                 display ' something wrong with put back '
  4278              end-if
  4279           else
  4280              display ' something went wrong with adding note '
  4281           end-if
  4282        else
  4283           display ' something went wrong with generic delete '
  4284        end-if
  4285     end-if
  4286
  4287     .
  4288 4099-EXIT.
  4289     EXIT.
  4290
  4291
  4292 4100-add-note.
  4293
  4294***  Need to check how long the note is
  4295
  4296     if w-comment-line-cnt = +0
  4297        go to 4100-exit
  4298     end-if
  4299
  4300     move 'CZ'                to cert-note-file
  4301     move sv-prior-key        to cz-control-primary
  4302     move '1'                 to cz-record-type
  4303     move +1                  to cz-note-sequence
  4304     move w-save-bin-date     to cz-last-maint-dt
  4305     move eibtime             to cz-last-maint-hhmmss
  4306     move pi-processor-id     to cz-last-maint-user
  4307     move w-comment-line-1    to cz-note
  4308
  4309     .
  4310 4100-write.
  4311
  4312
  4313* exec cics write
  4314*       dataset   ('ERCNOT')
  4315*       from      (cert-note-file)
  4316*       ridfld    (cz-control-primary)
  4317*       resp      (w-response)
  4318*    end-exec
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  78
* EL691.cbl
  4319     MOVE LENGTH OF
  4320      cert-note-file
  4321       TO DFHEIV11
  4322     MOVE 'ERCNOT' TO DFHEIV1
  4323*    MOVE '&$ L                  ''  N#00003891' TO DFHEIV0
  4324     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4326     MOVE X'204E233030303033383931' TO DFHEIV0(25:11)
  4327     CALL 'kxdfhei1' USING DFHEIV0,
  4328           DFHEIV1,
  4329           cert-note-file,
  4330           DFHEIV11,
  4331           cz-control-primary,
  4332           DFHEIV99,
  4333           DFHEIV99
  4334     MOVE EIBRESP  TO w-response
  4335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4336     if not resp-normal
  4337        display ' error-ercnot-write ' w-response ' '
  4338           cz-control-primary (2:33)
  4339        go to 4100-exit
  4340     else
  4341        display 'NOTE SUCCESSFULLY ADDED'
  4342     end-if
  4343
  4344     if w-comment-line-cnt > +1
  4345        move w-comment-line-2    to cz-note
  4346        add +1 to cz-note-sequence
  4347        move +0                  to w-comment-line-cnt
  4348        go to 4100-write
  4349     end-if
  4350
  4351     .
  4352 4100-exit.
  4353     exit.
  4354
  4355
  4356
  4357 4120-delete-cert-notes.
  4358
  4359     move sv-prior-key (1:33)    to ercnot-key
  4360     move '1'                    to ercnot-rec-typ
  4361     move +0                     to ercnot-seq
  4362
  4363* exec cics delete
  4364*       dataset    ('ERCNOT')
  4365*       keylength  (ws-cert-note-generic-key-len)
  4366*       ridfld     (ercnot-key (1:34))
  4367*       generic
  4368*       resp       (w-response)
  4369*    end-exec
  4370     MOVE 'ERCNOT' TO DFHEIV1
  4371*    MOVE '&(  RKG               &  N#00003923' TO DFHEIV0
  4372     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  4373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4374     MOVE X'204E233030303033393233' TO DFHEIV0(25:11)
  4375     CALL 'kxdfhei1' USING DFHEIV0,
  4376           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  79
* EL691.cbl
  4377           ercnot-key(1 : 34),
  4378           ws-cert-note-generic-key-len,
  4379           DFHEIV99,
  4380           DFHEIV99
  4381     MOVE EIBRESP  TO w-response
  4382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4383
  4384     .
  4385 4120-exit.
  4386     exit.
  4387
  4388 4140-put-back-cert-notes.
  4389
  4390     perform varying c1 from +1 by +1 until
  4391        c1 > note-count
  4392        move cert-note-record (c1)
  4393                                 to cert-note-file
  4394        add +2                   to cz-note-sequence
  4395*       display ' about to write ' cz-control-primary (2:19) ' '
  4396*          cz-control-primary (23:11) ' ' cz-note-sequence ' '
  4397*           cz-record-type ' ' cz-note-information
  4398
  4399* exec cics write
  4400*          dataset ('ERCNOT')
  4401*          FROM    (cert-note-file)
  4402*          ridfld  (cz-control-primary)
  4403*          resp    (w-response)
  4404*       end-exec
  4405     MOVE LENGTH OF
  4406      cert-note-file
  4407       TO DFHEIV11
  4408     MOVE 'ERCNOT' TO DFHEIV1
  4409*    MOVE '&$ L                  ''  N#00003945' TO DFHEIV0
  4410     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4412     MOVE X'204E233030303033393435' TO DFHEIV0(25:11)
  4413     CALL 'kxdfhei1' USING DFHEIV0,
  4414           DFHEIV1,
  4415           cert-note-file,
  4416           DFHEIV11,
  4417           cz-control-primary,
  4418           DFHEIV99,
  4419           DFHEIV99
  4420     MOVE EIBRESP  TO w-response
  4421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4422        if not resp-normal
  4423           display ' error-ercnot-write subsequ ' w-response ' '
  4424              cz-control-primary (2:33)
  4425           move +999             to c1
  4426        end-if
  4427     end-perform
  4428
  4429    .
  4430 4140-exit.
  4431     exit.
  4432
  4433 4160-check-comment.
  4434
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  80
* EL691.cbl
  4435     string
  4436        w-cert-note-comment ' ' delimited by '  '
  4437        la-form-a3 ' ' delimited by size
  4438        la-processor-cd ' ' delimited by size
  4439        pi-create-date delimited by size
  4440           into w-stop-letter-comment
  4441     end-string
  4442
  4443     perform varying n1 from +126 by -1 until
  4444        w-stop-letter-comment(n1:1) <> space
  4445     end-perform
  4446     if n1 < +64
  4447        move +1                  to w-comment-line-cnt
  4448        move w-stop-letter-comment
  4449                                 to w-comment-line-1
  4450        go to 4160-exit
  4451     end-if
  4452
  4453     move +2                     to w-comment-line-cnt
  4454
  4455     perform varying n1 from n1 by -1 until
  4456        ((w-stop-letter-comment(n1:1) = ' ')
  4457            and
  4458         (n1 < +64))
  4459        or (n1 < +1)
  4460     end-perform
  4461
  4462     if n1 < +1
  4463        move w-stop-letter-comment(1:63)
  4464                                 to w-comment-line-1
  4465        move w-stop-letter-comment(64:63)
  4466                                 to w-comment-line-2
  4467     else
  4468        move w-stop-letter-comment(1:n1)
  4469                                 to w-comment-line-1
  4470        move w-stop-letter-comment(n1 + 1:126 - n1)
  4471                                 to w-comment-line-2
  4472     end-if
  4473
  4474     .
  4475 4160-exit.
  4476     exit.
  4477 4500-UPDATE-BILL-NOTE SECTION.
  4478
  4479
  4480* EXEC CICS GETMAIN
  4481*         SET      (ADDRESS OF EOB-CODES)
  4482*         LENGTH   (ELEOBC-LENGTH)
  4483*    END-EXEC
  4484*    MOVE '," L                  $   #00004008' TO DFHEIV0
  4485     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4486     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4487     MOVE X'2020233030303034303038' TO DFHEIV0(25:11)
  4488     CALL 'kxdfhei1' USING DFHEIV0,
  4489           DFHEIV20,
  4490           ELEOBC-LENGTH,
  4491           DFHEIV99
  4492     SET ADDRESS OF EOB-CODES TO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  81
* EL691.cbl
  4493         DFHEIV20
  4494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4495
  4496     MOVE LOW-VALUES             TO ELEOBC-KEY
  4497     MOVE PI-COMPANY-CD          TO EOBC-COMPANY-CD
  4498     MOVE '5'                    TO EOBC-REC-TYPE
  4499
  4500
  4501* EXEC CICS STARTBR
  4502*        DATASET   (ELEOBC-FILE-ID)
  4503*        RIDFLD    (ELEOBC-KEY)
  4504*        GTEQ
  4505*        RESP      (W-RESPONSE)
  4506*    END-EXEC
  4507     MOVE 0
  4508       TO DFHEIV11
  4509*    MOVE '&,         G          &  N#00004017' TO DFHEIV0
  4510     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4512     MOVE X'204E233030303034303137' TO DFHEIV0(25:11)
  4513     CALL 'kxdfhei1' USING DFHEIV0,
  4514           ELEOBC-FILE-ID,
  4515           ELEOBC-KEY,
  4516           DFHEIV99,
  4517           DFHEIV11,
  4518           DFHEIV99
  4519     MOVE EIBRESP  TO W-RESPONSE
  4520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4521
  4522     IF NOT RESP-NORMAL
  4523        GO TO 4500-EXIT
  4524     END-IF
  4525      .
  4526 4500-READNEXT-ELEOBC.
  4527
  4528
  4529* EXEC CICS READNEXT
  4530*       INTO    (EOB-CODES)
  4531*       DATASET (ELEOBC-FILE-ID)
  4532*       RIDFLD  (ELEOBC-KEY)
  4533*       RESP    (W-RESPONSE)
  4534*    END-EXEC
  4535     MOVE LENGTH OF
  4536      EOB-CODES
  4537       TO DFHEIV12
  4538     MOVE 0
  4539       TO DFHEIV11
  4540*    MOVE '&.IL                  )  N#00004030' TO DFHEIV0
  4541     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4543     MOVE X'204E233030303034303330' TO DFHEIV0(25:11)
  4544     CALL 'kxdfhei1' USING DFHEIV0,
  4545           ELEOBC-FILE-ID,
  4546           EOB-CODES,
  4547           DFHEIV12,
  4548           ELEOBC-KEY,
  4549           DFHEIV99,
  4550           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  82
* EL691.cbl
  4551           DFHEIV99,
  4552           DFHEIV99
  4553     MOVE EIBRESP  TO W-RESPONSE
  4554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4555
  4556     IF RESP-NORMAL
  4557         IF EO-RECORD-TYPE NOT = '5'
  4558             GO TO 4500-EXIT
  4559         END-IF
  4560     ELSE
  4561         GO TO 4500-EXIT
  4562     END-IF
  4563
  4564     IF EO-RECORD-TYPE = '5' AND
  4565        EO-EOB-CODE = PI-ARCHIVE-LTRID
  4566           CONTINUE
  4567     ELSE
  4568         GO TO 4500-READNEXT-ELEOBC
  4569     END-IF
  4570
  4571     MOVE SPACES TO WS-FIND-BILLING-NOTE
  4572     MOVE EO-DESCRIPTION TO WS-FBN-NOTE
  4573     MOVE PI-ARCHIVE-LTRID TO WS-FBN-LTRID
  4574
  4575
  4576* EXEC CICS GETMAIN
  4577*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  4578*         LENGTH   (ERNOTE-LENGTH)
  4579*    END-EXEC
  4580*    MOVE '," L                  $   #00004056' TO DFHEIV0
  4581     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4582     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4583     MOVE X'2020233030303034303536' TO DFHEIV0(25:11)
  4584     CALL 'kxdfhei1' USING DFHEIV0,
  4585           DFHEIV20,
  4586           ERNOTE-LENGTH,
  4587           DFHEIV99
  4588     SET ADDRESS OF CERTIFICATE-NOTE TO
  4589         DFHEIV20
  4590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4591
  4592     MOVE PI-COMPANY-CD          TO  ERNOTE-COMPANY-CD
  4593     MOVE PI-CARRIER             TO  ERNOTE-CARRIER
  4594     MOVE PI-GROUPING            TO  ERNOTE-GROUPING
  4595     MOVE PI-STATE               TO  ERNOTE-STATE
  4596     MOVE PI-ACCOUNT             TO  ERNOTE-ACCOUNT
  4597     MOVE PI-CERT-EFF-DT         TO  ERNOTE-CERT-EFF-DT
  4598     MOVE PI-CERT-PRIME          TO  ERNOTE-CERT-PRIME
  4599     MOVE PI-CERT-SFX            TO  ERNOTE-CERT-SFX
  4600     move '1'                    to  ernote-record-type
  4601
  4602
  4603* EXEC CICS READ
  4604*       DATASET    (ERNOTE-FILE-ID)
  4605*       RIDFLD     (ERNOTE-KEY)
  4606*       INTO       (CERTIFICATE-NOTE)
  4607*       RESP       (W-RESPONSE)
  4608*       UPDATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  83
* EL691.cbl
  4609*    END-EXEC
  4610     MOVE LENGTH OF
  4611      CERTIFICATE-NOTE
  4612       TO DFHEIV11
  4613*    MOVE '&"IL       EU         (  N#00004071' TO DFHEIV0
  4614     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4616     MOVE X'204E233030303034303731' TO DFHEIV0(25:11)
  4617     CALL 'kxdfhei1' USING DFHEIV0,
  4618           ERNOTE-FILE-ID,
  4619           CERTIFICATE-NOTE,
  4620           DFHEIV11,
  4621           ERNOTE-KEY,
  4622           DFHEIV99,
  4623           DFHEIV99,
  4624           DFHEIV99
  4625     MOVE EIBRESP  TO W-RESPONSE
  4626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4627
  4628     IF RESP-NORMAL
  4629       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  4630           (NOTE-SUB > +10) OR
  4631           (CN-LINE (NOTE-SUB) (1:29) =
  4632                             WS-FIND-BILLING-NOTE (1:29))
  4633       END-PERFORM
  4634       IF CN-LINE (NOTE-SUB) (1:29) NOT =
  4635                              WS-FIND-BILLING-NOTE (1:29)
  4636
  4637* EXEC CICS UNLOCK
  4638*           DATASET    (ERNOTE-FILE-ID)
  4639*        END-EXEC
  4640*    MOVE '&*                    #   #00004087' TO DFHEIV0
  4641     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4642     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4643     MOVE X'2020233030303034303837' TO DFHEIV0(25:11)
  4644     CALL 'kxdfhei1' USING DFHEIV0,
  4645           ERNOTE-FILE-ID,
  4646           DFHEIV99
  4647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4648         GO TO 4500-EXIT
  4649       END-IF
  4650
  4651       MOVE WS-RECEIVED-NOTE TO CN-LINE (NOTE-SUB) (50:20)
  4652       MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  4653       MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
  4654       MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  4655
  4656* EXEC CICS REWRITE
  4657*         DATASET    (ERNOTE-FILE-ID)
  4658*         FROM       (CERTIFICATE-NOTE)
  4659*         RESP       (W-RESPONSE)
  4660*      END-EXEC
  4661     MOVE LENGTH OF
  4662      CERTIFICATE-NOTE
  4663       TO DFHEIV11
  4664*    MOVE '&& L                  %  N#00004097' TO DFHEIV0
  4665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  84
* EL691.cbl
  4667     MOVE X'204E233030303034303937' TO DFHEIV0(25:11)
  4668     CALL 'kxdfhei1' USING DFHEIV0,
  4669           ERNOTE-FILE-ID,
  4670           CERTIFICATE-NOTE,
  4671           DFHEIV11,
  4672           DFHEIV99
  4673     MOVE EIBRESP  TO W-RESPONSE
  4674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4675
  4676       .
  4677
  4678 4500-EXIT.
  4679     EXIT.
  4680
  4681
  4682 4800-CERTIFICATE-UPDATE SECTION.
  4683
  4684
  4685* EXEC CICS HANDLE CONDITION
  4686*        NOTFND   (4899-EXIT)
  4687*    END-EXEC.
  4688*    MOVE '"$I                   ! ( #00004111' TO DFHEIV0
  4689     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4691     MOVE X'2820233030303034313131' TO DFHEIV0(25:11)
  4692     CALL 'kxdfhei1' USING DFHEIV0
  4693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4694
  4695
  4696
  4697* EXEC CICS READ
  4698*    EQUAL
  4699*    DATASET   (ELCERT-FILE-ID)
  4700*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  4701*    RIDFLD    (ELCERT-KEY)
  4702*    UPDATE
  4703*    RESP      (W-RESPONSE)
  4704*    END-EXEC.
  4705*    MOVE '&"S        EU         (  N#00004115' TO DFHEIV0
  4706     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4707     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4708     MOVE X'204E233030303034313135' TO DFHEIV0(25:11)
  4709     CALL 'kxdfhei1' USING DFHEIV0,
  4710           ELCERT-FILE-ID,
  4711           DFHEIV20,
  4712           DFHEIV99,
  4713           ELCERT-KEY,
  4714           DFHEIV99,
  4715           DFHEIV99,
  4716           DFHEIV99
  4717     SET ADDRESS OF CERTIFICATE-MASTER TO
  4718         DFHEIV20
  4719     MOVE EIBRESP  TO W-RESPONSE
  4720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4721
  4722
  4723     IF RESP-NORMAL
  4724        IF CM-NOTE-SW = ' '
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  85
* EL691.cbl
  4725           MOVE '1'        TO CM-NOTE-SW
  4726        ELSE
  4727           IF CM-NOTE-SW = '2'
  4728              MOVE '3'      TO CM-NOTE-SW
  4729           ELSE
  4730              IF CM-NOTE-SW = '4'
  4731                  MOVE '5'    TO CM-NOTE-SW
  4732              ELSE
  4733                 IF CM-NOTE-SW = '6'
  4734                    MOVE '7'  TO CM-NOTE-SW
  4735                 END-IF
  4736              END-IF
  4737           END-IF
  4738        END-IF
  4739
  4740* EXEC CICS REWRITE
  4741*          FROM      (CERTIFICATE-MASTER)
  4742*          DATASET   (ELCERT-FILE-ID)
  4743*       END-EXEC
  4744     MOVE LENGTH OF
  4745      CERTIFICATE-MASTER
  4746       TO DFHEIV11
  4747*    MOVE '&& L                  %   #00004140' TO DFHEIV0
  4748     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4749     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4750     MOVE X'2020233030303034313430' TO DFHEIV0(25:11)
  4751     CALL 'kxdfhei1' USING DFHEIV0,
  4752           ELCERT-FILE-ID,
  4753           CERTIFICATE-MASTER,
  4754           DFHEIV11,
  4755           DFHEIV99
  4756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4757     END-IF.
  4758
  4759 4899-EXIT.
  4760      EXIT.
  4761
  4762
  4763
  4764 8010-ARCH-NOT-OPEN.
  4765
  4766     MOVE ER-7388                TO EMI-ERROR.
  4767     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4768     MOVE -1                     TO MAINTL.
  4769     GO TO 8200-SEND-DATAONLY.
  4770
  4771 8015-ARCT-NOT-OPEN.
  4772
  4773     MOVE ER-7373                TO EMI-ERROR.
  4774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4775     MOVE -1                     TO MAINTL.
  4776     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  86
* EL691.cbl
  4778
  4779 8100-SEND-INITIAL-MAP.
  4780
  4781     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4782
  4783     IF  NOT EMI-NO-ERRORS
  4784         MOVE EMI-MESSAGE-AREA (1)
  4785                                 TO ERRMSG1O
  4786     ELSE
  4787         MOVE SPACES             TO ERRMSG1O
  4788     END-IF.
  4789
  4790
  4791* EXEC CICS SEND
  4792*        MAP    (W-MAP)
  4793*        MAPSET (W-MAPSET)
  4794*        FROM   (EL691AO)
  4795*        ERASE
  4796*        CURSOR
  4797*    END-EXEC.
  4798     MOVE LENGTH OF
  4799      EL691AO
  4800       TO DFHEIV12
  4801     MOVE -1
  4802       TO DFHEIV11
  4803*    MOVE '8$     CT  E    H L F ,   #00004177' TO DFHEIV0
  4804     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4805     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4806     MOVE X'2020233030303034313737' TO DFHEIV0(25:11)
  4807     CALL 'kxdfhei1' USING DFHEIV0,
  4808           W-MAP,
  4809           EL691AO,
  4810           DFHEIV12,
  4811           W-MAPSET,
  4812           DFHEIV99,
  4813           DFHEIV99,
  4814           DFHEIV99,
  4815           DFHEIV11,
  4816           DFHEIV99,
  4817           DFHEIV99,
  4818           DFHEIV99
  4819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4820
  4821
  4822     GO TO 9000-RETURN-TRANS.
  4823
  4824 8100-EXIT.
  4825     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  87
* EL691.cbl
  4827
  4828 8200-SEND-DATAONLY.
  4829
  4830     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4831
  4832     IF  NOT EMI-NO-ERRORS
  4833         MOVE EMI-MESSAGE-AREA (1)
  4834                                 TO ERRMSG1O
  4835     ELSE
  4836         MOVE SPACES             TO ERRMSG1O
  4837     END-IF.
  4838
  4839
  4840* EXEC CICS SEND
  4841*        MAP    (W-MAP)
  4842*        MAPSET (W-MAPSET)
  4843*        FROM   (EL691AO)
  4844*        DATAONLY
  4845*        CURSOR
  4846*    END-EXEC.
  4847     MOVE LENGTH OF
  4848      EL691AO
  4849       TO DFHEIV12
  4850     MOVE -1
  4851       TO DFHEIV11
  4852*    MOVE '8$D    CT       H L F ,   #00004202' TO DFHEIV0
  4853     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4854     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4855     MOVE X'2020233030303034323032' TO DFHEIV0(25:11)
  4856     CALL 'kxdfhei1' USING DFHEIV0,
  4857           W-MAP,
  4858           EL691AO,
  4859           DFHEIV12,
  4860           W-MAPSET,
  4861           DFHEIV99,
  4862           DFHEIV99,
  4863           DFHEIV99,
  4864           DFHEIV11,
  4865           DFHEIV99,
  4866           DFHEIV99,
  4867           DFHEIV99
  4868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4869
  4870
  4871     GO TO 9000-RETURN-TRANS.
  4872
  4873 8200-EXIT.
  4874     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  88
* EL691.cbl
  4876
  4877 8300-SEND-TEXT.
  4878
  4879
  4880* EXEC CICS SEND TEXT
  4881*        FROM    (LOGOFF-TEXT)
  4882*        LENGTH  (LOGOFF-LENGTH)
  4883*        ERASE
  4884*        FREEKB
  4885*    END-EXEC.
  4886*    MOVE '8&      T  E F  H   F -   #00004218' TO DFHEIV0
  4887     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4888     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4889     MOVE X'2020233030303034323138' TO DFHEIV0(25:11)
  4890     CALL 'kxdfhei1' USING DFHEIV0,
  4891           LOGOFF-TEXT,
  4892           LOGOFF-LENGTH,
  4893           DFHEIV99,
  4894           DFHEIV99,
  4895           DFHEIV99,
  4896           DFHEIV99,
  4897           DFHEIV99,
  4898           DFHEIV99,
  4899           DFHEIV99,
  4900           DFHEIV99,
  4901           DFHEIV99,
  4902           DFHEIV99
  4903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4904
  4905
  4906     GO TO 9000-RETURN-TRANS.
  4907
  4908 8300-EXIT.
  4909     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  89
* EL691.cbl
  4911
  4912 8600-DEEDIT.
  4913
  4914
  4915* EXEC CICS BIF DEEDIT
  4916*         FIELD    (W-DEEDIT-FIELD)
  4917*         LENGTH   (15)
  4918*    END-EXEC.
  4919     MOVE 15
  4920       TO DFHEIV11
  4921*    MOVE '@"L                   #   #00004233' TO DFHEIV0
  4922     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4923     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4924     MOVE X'2020233030303034323333' TO DFHEIV0(25:11)
  4925     CALL 'kxdfhei1' USING DFHEIV0,
  4926           W-DEEDIT-FIELD,
  4927           DFHEIV11
  4928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4929
  4930
  4931 8600-EXIT.
  4932     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  90
* EL691.cbl
  4934
  4935 9000-RETURN-TRANS.
  4936
  4937     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  4938     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
  4939
  4940* EXEC CICS RETURN
  4941*        TRANSID    (W-TRANSACTION)
  4942*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4943*        LENGTH     (PI-COMM-LENGTH)
  4944*    END-EXEC.
  4945*    MOVE '.(CT                  ''   #00004246' TO DFHEIV0
  4946     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4947     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4948     MOVE X'2020233030303034323436' TO DFHEIV0(25:11)
  4949     CALL 'kxdfhei1' USING DFHEIV0,
  4950           W-TRANSACTION,
  4951           PROGRAM-INTERFACE-BLOCK,
  4952           PI-COMM-LENGTH,
  4953           DFHEIV99,
  4954           DFHEIV99,
  4955           DFHEIV99
  4956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4957
  4958
  4959 9000-EXIT.
  4960     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  91
* EL691.cbl
  4962
  4963 9200-PA.
  4964
  4965     MOVE ER-7008                TO EMI-ERROR.
  4966     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4967     MOVE -1                     TO MAINTL.
  4968     GO TO 8200-SEND-DATAONLY.
  4969
  4970 9200-EXIT.
  4971     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  92
* EL691.cbl
  4973
  4974 9300-DFHCLEAR.
  4975
  4976     MOVE PI-RETURN-TO-PROGRAM TO W-CALL-PGM.
  4977     GO TO 9400-XCTL.
  4978
  4979 9300-EXIT.
  4980     EXIT.
  4981
  4982 9400-XCTL.
  4983
  4984
  4985* EXEC CICS XCTL
  4986*        PROGRAM  (W-CALL-PGM)
  4987*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4988*        LENGTH   (PI-COMM-LENGTH)
  4989*    END-EXEC.
  4990*    MOVE '.$C                   %   #00004277' TO DFHEIV0
  4991     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4992     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4993     MOVE X'2020233030303034323737' TO DFHEIV0(25:11)
  4994     CALL 'kxdfhei1' USING DFHEIV0,
  4995           W-CALL-PGM,
  4996           PROGRAM-INTERFACE-BLOCK,
  4997           PI-COMM-LENGTH,
  4998           DFHEIV99
  4999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5000
  5001
  5002 9400-EXIT.
  5003     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  93
* EL691.cbl
  5005
  5006 9500-LINK-DATE-CONVERT.
  5007
  5008
  5009* EXEC CICS LINK
  5010*        PROGRAM    ('ELDATCV')
  5011*        COMMAREA   (DATE-CONVERSION-DATA)
  5012*        LENGTH     (DC-COMM-LENGTH)
  5013*    END-EXEC.
  5014     MOVE 'ELDATCV' TO DFHEIV1
  5015*    MOVE '."C                   (   #00004289' TO DFHEIV0
  5016     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5018     MOVE X'2020233030303034323839' TO DFHEIV0(25:11)
  5019     CALL 'kxdfhei1' USING DFHEIV0,
  5020           DFHEIV1,
  5021           DATE-CONVERSION-DATA,
  5022           DC-COMM-LENGTH,
  5023           DFHEIV99,
  5024           DFHEIV99,
  5025           DFHEIV99,
  5026           DFHEIV99
  5027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5028
  5029
  5030 9500-EXIT.
  5031     EXIT.
  5032
  5033 9600-FORMAT-DATE-TIME.
  5034
  5035     MOVE W-SAVE-DATE            TO RUNDTEO.
  5036     MOVE EIBTIME                TO W-TIME-IN.
  5037     MOVE W-TIME-OUT             TO RUNTIMEO.
  5038     MOVE PI-COMPANY-ID          TO COMPANYO.
  5039     MOVE PI-PROCESSOR-ID        TO USERIDO.
  5040     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  5041
  5042     IF PI-ARCHIVE-COMPLETE = 'Y'
  5043        MOVE AL-SANOF           TO STCOMPA
  5044        MOVE AL-SADOF           TO STRECVA
  5045                                   STSTOPA
  5046                                   STFINLA
  5047     ELSE
  5048       IF PI-ARCHIVE-RECEIVED = 'Y'
  5049           MOVE AL-SANOF        TO STRECVA
  5050           MOVE AL-SADOF        TO STCOMPA
  5051                                   STSTOPA
  5052                                   STFINLA
  5053       ELSE
  5054         IF PI-ARCHIVE-STOPPED = 'Y'
  5055             MOVE AL-SANOF      TO STSTOPA
  5056             MOVE AL-SADOF      TO STCOMPA
  5057                                   STRECVA
  5058                                   STFINLA
  5059         ELSE
  5060           IF PI-ARCHIVE-FINAL = 'Y'
  5061               MOVE AL-SANOF    TO STFINLA
  5062               MOVE AL-SADOF    TO STCOMPA
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  94
* EL691.cbl
  5063                                   STRECVA
  5064                                   STSTOPA
  5065           ELSE
  5066               MOVE AL-SADOF    TO STCOMPA
  5067                                   STRECVA
  5068                                   STSTOPA
  5069                                   STFINLA
  5070           END-IF
  5071         END-IF
  5072       END-IF
  5073     END-IF.
  5074
  5075
  5076 9600-EXIT.
  5077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  95
* EL691.cbl
  5079
  5080 9700-PGMID-ERROR.
  5081
  5082
  5083* EXEC CICS  HANDLE CONDITION
  5084*        PGMIDERR  (8300-SEND-TEXT)
  5085*    END-EXEC.
  5086*    MOVE '"$L                   ! ) #00004347' TO DFHEIV0
  5087     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5089     MOVE X'2920233030303034333437' TO DFHEIV0(25:11)
  5090     CALL 'kxdfhei1' USING DFHEIV0
  5091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5092
  5093
  5094     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  5095     MOVE ' '                    TO PI-ENTRY-CD-1.
  5096     MOVE W-XCTL-005             TO W-CALL-PGM
  5097                                    LOGOFF-PGM.
  5098     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  5099
  5100     PERFORM 9400-XCTL THRU 9400-EXIT.
  5101
  5102 9700-EXIT.
  5103     EXIT.
  5104
  5105 9800-ABEND.
  5106
  5107     MOVE W-LINK-004             TO W-CALL-PGM.
  5108     MOVE DFHEIBLK               TO EMI-LINE1
  5109
  5110
  5111* EXEC CICS  LINK
  5112*        PROGRAM   (W-CALL-PGM)
  5113*        COMMAREA  (EMI-LINE1)
  5114*        LENGTH    (72)
  5115*    END-EXEC.
  5116     MOVE 72
  5117       TO DFHEIV11
  5118*    MOVE '."C                   (   #00004367' TO DFHEIV0
  5119     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5121     MOVE X'2020233030303034333637' TO DFHEIV0(25:11)
  5122     CALL 'kxdfhei1' USING DFHEIV0,
  5123           W-CALL-PGM,
  5124           EMI-LINE1,
  5125           DFHEIV11,
  5126           DFHEIV99,
  5127           DFHEIV99,
  5128           DFHEIV99,
  5129           DFHEIV99
  5130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5131
  5132
  5133     GO TO 8200-SEND-DATAONLY.
  5134
  5135 9800-EXIT.
  5136     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  96
* EL691.cbl
  5138
  5139 9900-ERROR-FORMAT.
  5140
  5141     IF  EMI-ERROR EQUAL ER-9097
  5142         NEXT SENTENCE
  5143     ELSE
  5144         IF  EMI-ERRORS-COMPLETE
  5145                 OR
  5146             EMI-ERROR EQUAL W-LAST-ERROR
  5147             GO TO 9900-EXIT
  5148     END-IF.
  5149
  5150     ADD +1  TO  W-ERROR-COUNT.
  5151     MOVE W-LINK-001             TO W-CALL-PGM.
  5152
  5153
  5154* EXEC CICS LINK
  5155*        PROGRAM    (W-CALL-PGM)
  5156*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  5157*        LENGTH     (EMI-COMM-LENGTH)
  5158*    END-EXEC.
  5159*    MOVE '."C                   (   #00004393' TO DFHEIV0
  5160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5162     MOVE X'2020233030303034333933' TO DFHEIV0(25:11)
  5163     CALL 'kxdfhei1' USING DFHEIV0,
  5164           W-CALL-PGM,
  5165           ERROR-MESSAGE-INTERFACE-BLOCK,
  5166           EMI-COMM-LENGTH,
  5167           DFHEIV99,
  5168           DFHEIV99,
  5169           DFHEIV99,
  5170           DFHEIV99
  5171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5172
  5173
  5174     MOVE EMI-ERROR              TO W-LAST-ERROR.
  5175
  5176 9900-EXIT.
  5177     EXIT.
  5178
  5179 9905-INITIALIZE-SECURITY.
  5180******************************************************************
  5181*                                                                *
  5182*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  5183*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  5184*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  5185*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  5186*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  5187*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  5188*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  5189*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
  5190*                                                                *
  5191*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
  5192*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  5193*                                                                *
  5194******************************************************************
  5195
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  97
* EL691.cbl
  5196     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  5197         MOVE 'Y'                TO PI-DISPLAY-CAP
  5198                                    PI-MODIFY-CAP
  5199     ELSE
  5200
  5201* EXEC CICS READQ TS
  5202*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5203*            INTO   (SECURITY-CONTROL)
  5204*            LENGTH (SC-COMM-LENGTH)
  5205*            ITEM   (1)
  5206*        END-EXEC
  5207     MOVE 1
  5208       TO DFHEIV11
  5209*    MOVE '*$II   L              ''   #00004425' TO DFHEIV0
  5210     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5211     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5212     MOVE X'2020233030303034343235' TO DFHEIV0(25:11)
  5213     CALL 'kxdfhei1' USING DFHEIV0,
  5214           PI-SECURITY-TEMP-STORE-ID,
  5215           SECURITY-CONTROL,
  5216           SC-COMM-LENGTH,
  5217           DFHEIV11,
  5218           DFHEIV99,
  5219           DFHEIV99
  5220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5221         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  5222                                 TO PI-DISPLAY-CAP
  5223         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  5224                                 TO PI-MODIFY-CAP
  5225     END-IF.
  5226
  5227 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  98
* EL691.cbl
  5229
  5230 9995-SECURITY-VIOLATION.
  5231
  5232     MOVE EIBDATE                TO SM-JUL-DATE.
  5233     MOVE EIBTRMID               TO SM-TERMID.
  5234     MOVE W-THIS-PGM             TO SM-PGM.
  5235     MOVE EIBTIME                TO W-TIME-IN.
  5236     MOVE W-TIME-OUT             TO SM-TIME.
  5237     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
  5238
  5239
  5240* EXEC CICS LINK
  5241*         PROGRAM  ('EL003')
  5242*         COMMAREA (SECURITY-MESSAGE)
  5243*         LENGTH   (80)
  5244*    END-EXEC.
  5245     MOVE 'EL003' TO DFHEIV1
  5246     MOVE 80
  5247       TO DFHEIV11
  5248*    MOVE '."C                   (   #00004449' TO DFHEIV0
  5249     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5251     MOVE X'2020233030303034343439' TO DFHEIV0(25:11)
  5252     CALL 'kxdfhei1' USING DFHEIV0,
  5253           DFHEIV1,
  5254           SECURITY-MESSAGE,
  5255           DFHEIV11,
  5256           DFHEIV99,
  5257           DFHEIV99,
  5258           DFHEIV99,
  5259           DFHEIV99
  5260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5261
  5262
  5263 9995-EXIT.
  5264     EXIT.
  5265
  5266 9999-GOBACK.
  5267
  5268
  5269* GOBACK.
  5270     MOVE '9%                    "   ' TO DFHEIV0
  5271     MOVE 'EL691' TO DFHEIV1
  5272     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5273     GOBACK.
  5274
  5275 9999-EXIT.
  5276     EXIT.
  5277
  5278 9999-DFHBACK SECTION.
  5279     MOVE '9%                    "   ' TO DFHEIV0
  5280     MOVE 'EL691' TO DFHEIV1
  5281     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5282     GOBACK.
  5283 9999-DFHEXIT.
  5284     IF DFHEIGDJ EQUAL 0001
  5285         NEXT SENTENCE
  5286     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  99
* EL691.cbl
  5287         GO TO 9300-DFHCLEAR,
  5288               9200-PA,
  5289               9200-PA,
  5290               9200-PA
  5291         DEPENDING ON DFHEIGDI
  5292     ELSE IF DFHEIGDJ EQUAL 3
  5293         GO TO 9700-PGMID-ERROR,
  5294               9800-ABEND
  5295         DEPENDING ON DFHEIGDI
  5296     ELSE IF DFHEIGDJ EQUAL 4
  5297         GO TO 8010-ARCH-NOT-OPEN,
  5298               1070-ARCH-NOT-FOUND,
  5299               1070-ARCH-NOT-FOUND
  5300         DEPENDING ON DFHEIGDI
  5301     ELSE IF DFHEIGDJ EQUAL 5
  5302         GO TO 8015-ARCT-NOT-OPEN,
  5303               1000-ARCT-NOT-FOUND,
  5304               1000-ARCT-NOT-FOUND
  5305         DEPENDING ON DFHEIGDI
  5306     ELSE IF DFHEIGDJ EQUAL 6
  5307         GO TO 8010-ARCH-NOT-OPEN,
  5308               1070-ARCH-NOT-FOUND,
  5309               1070-ARCH-NOT-FOUND
  5310         DEPENDING ON DFHEIGDI
  5311     ELSE IF DFHEIGDJ EQUAL 7
  5312         GO TO 3200-NOT-FOUND,
  5313               3200-NOT-FOUND
  5314         DEPENDING ON DFHEIGDI
  5315     ELSE IF DFHEIGDJ EQUAL 8
  5316         GO TO 4899-EXIT
  5317         DEPENDING ON DFHEIGDI
  5318     ELSE IF DFHEIGDJ EQUAL 9
  5319         GO TO 8300-SEND-TEXT
  5320         DEPENDING ON DFHEIGDI.
  5321     MOVE '9%                    "   ' TO DFHEIV0
  5322     MOVE 'EL691' TO DFHEIV1
  5323     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5324     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      214652     Code:       17983
