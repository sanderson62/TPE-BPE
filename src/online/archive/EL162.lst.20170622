* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   1
* EL162.cbl
* Options: int("EL162.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL162.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL162.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL162.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL162 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/02/95 14:07:28.
     7*                            VMOD=2.015
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX17 - RECORD MAIL RECEIVED
    13*            USED TO REVIEW PENDING MAIL AND TO RECORD
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   2
* EL162.cbl
    14*            INCOMING MAIL.
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    24* 121406    2006081100001  PEMA  ADD RECEIVE DATE EDIT
    25* 051107    2006052500001  AJRA  POPULATE UBY WITH USER ID
    26* 100610    2009122800001  AJRA  BYPASS LETTER W/ RESEND PRINTED D
    27* 102610    2009122800001  AJRA    REPLACE VERIFY W/ STOP DATE
    28* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    29* 010416    2015072900002  TANA  ADD PF7 TO CLAIM MEMO SCREEN
    30******************************************************************
    31
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   3
* EL162.cbl
    33 ENVIRONMENT DIVISION.
    34 DATA DIVISION.
    35 WORKING-STORAGE SECTION.
    36 01  DFH-START PIC X(04).
    37 77  FILLER  PIC X(32)  VALUE '********************************'.
    38 77  FILLER  PIC X(32)  VALUE '*    EL162 WORKING STORAGE     *'.
    39 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.015 *********'.
    40
    41*                            COPY ELCSCTM.
    42******************************************************************
    43*                                                                *
    44*                                                                *
    45*                            ELCSCTM                             *
    46*                            VMOD=2.001                          *
    47*                                                                *
    48*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    49*                                                                *
    50******************************************************************
    51 01  SECURITY-MESSAGE.
    52     12  FILLER                          PIC X(30)
    53            VALUE '** LOGIC SECURITY VIOLATION -'.
    54     12  SM-READ                         PIC X(6).
    55     12  FILLER                          PIC X(5)
    56            VALUE ' PGM='.
    57     12  SM-PGM                          PIC X(6).
    58     12  FILLER                          PIC X(5)
    59            VALUE ' OPR='.
    60     12  SM-PROCESSOR-ID                 PIC X(4).
    61     12  FILLER                          PIC X(6)
    62            VALUE ' TERM='.
    63     12  SM-TERMID                       PIC X(4).
    64     12  FILLER                          PIC XX   VALUE SPACE.
    65     12  SM-JUL-DATE                     PIC 9(5).
    66     12  FILLER                          PIC X    VALUE SPACE.
    67     12  SM-TIME                         PIC 99.99.
    68
    69
    70*                            COPY ELCSCRTY.
    71******************************************************************
    72*                                                                *
    73*                                                                *
    74*                            ELCSCRTY                            *
    75*                            VMOD=2.001                          *
    76*                                                                *
    77*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    78*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    79*        SAVED IN PI-SECURITY-ADDRESS.                           *
    80*                                                                *
    81******************************************************************
    82 01  SECURITY-CONTROL.
    83     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    84     12  FILLER                       PIC XX    VALUE 'SC'.
    85     12  SC-CREDIT-CODES.
    86         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    87             20  SC-CREDIT-DISPLAY    PIC X.
    88             20  SC-CREDIT-UPDATE     PIC X.
    89     12  SC-CLAIMS-CODES.
    90         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   4
* EL162.cbl
    91             20  SC-CLAIMS-DISPLAY    PIC X.
    92             20  SC-CLAIMS-UPDATE     PIC X.
    93
    94 01  WS-DATE-AREA.
    95     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    96     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    97     05  CURRENT-MINUS1-SAVE PIC XX      VALUE SPACES.
    98
    99 01  STANDARD-AREAS.
   100     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   101     12  MAP-NAME.
   102         16  MAP-PRE             PIC XX      VALUE 'EL'.
   103         16  MAP-NUMBER          PIC X(4)    VALUE '162A'.
   104         16  FILLER              PIC XX      VALUE SPACES.
   105     12  MAPSET-NAME             PIC X(8)    VALUE 'EL162S'.
   106     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   107     12  TRANS-ID                PIC X(4)    VALUE 'EX17'.
   108     12  PGM-NAME                PIC X(8).
   109     12  TIME-IN                 PIC S9(7).
   110     12  TIME-OUT-R  REDEFINES TIME-IN.
   111         16  FILLER              PIC X.
   112         16  TIME-OUT            PIC 99V99.
   113         16  FILLER              PIC XX.
   114     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   115     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   116     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   117     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   118     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   119     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   120     12  THIS-PGM                PIC X(8)    VALUE 'EL162'.
   121     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   122     12  PGM-EL132               PIC X(8)    VALUE 'EL132'.
   123     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   124     12  PGM-EL1284              PIC X(8)    VALUE 'EL1284'.
   125     12  ELMSTR-FILE-ID          PIC X(8)    VALUE 'ELMSTR'.
   126     12  ELTRLR-FILE-ID          PIC X(8)    VALUE 'ELTRLR'.
   127     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   128     12  SUB                     PIC S999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   5
* EL162.cbl
   130 01  ERROR-MESSAGES.
   131     12  ER-ZEROS                PIC X(4)    VALUE '0000'.
   132     12  ER-0004                 PIC X(4)    VALUE '0004'.
   133     12  ER-0008                 PIC X(4)    VALUE '0008'.
   134     12  ER-0029                 PIC X(4)    VALUE '0029'.
   135     12  ER-0050                 PIC X(4)    VALUE '0050'.
   136     12  ER-0021                 PIC X(4)    VALUE '0021'.
   137     12  ER-0042                 PIC X(4)    VALUE '0042'.
   138     12  ER-0066                 PIC X(4)    VALUE '0066'.
   139     12  ER-0067                 PIC X(4)    VALUE '0067'.
   140     12  ER-0070                 PIC X(4)    VALUE '0070'.
   141     12  ER-0133                 PIC X(4)    VALUE '0133'.
   142     12  ER-0168                 PIC X(4)    VALUE '0168'.
   143     12  ER-0172                 PIC X(4)    VALUE '0172'.
   144     12  ER-0179                 PIC X(4)    VALUE '0179'.
   145     12  ER-0318                 PIC X(4)    VALUE '0318'.
   146     12  ER-0319                 PIC X(4)    VALUE '0319'.
   147     12  ER-0320                 PIC X(4)    VALUE '0320'.
   148     12  ER-0321                 PIC X(4)    VALUE '0321'.
   149     12  ER-0322                 PIC X(4)    VALUE '0322'.
   150     12  ER-0514                 PIC X(4)    VALUE '0514'.
   151     12  ER-0539                 PIC X(4)    VALUE '0539'.
   152     12  ER-0895                 PIC X(4)    VALUE '0895'.
   153     12  ER-0896                 PIC X(4)    VALUE '0896'.
   154     12  ER-7839                 PIC X(4)    VALUE '7839'.
   155
   156     12  BIN-CURRENT-DATE        PIC XX.
   157     12  INDX-WORK               PIC 9(4).
   158     12  REC-DATA-SW             PIC X       VALUE ' '.
   159         88  REC-DATA                        VALUE '1'.
   160     12  VER-DATA-SW             PIC X       VALUE ' '.
   161         88  VER-DATA                        VALUE '1'.
   162     12  UNSOL-DATA-SW           PIC X       VALUE ' '.
   163         88  UNSOL-DATA                      VALUE '1'.
   164         88  FILE-DATA                       VALUE '2'.
   165     12  ADDR-TYPE               PIC X.
   166     12  ADDR-SEQ                PIC S9(4) COMP.
   167     12  ACTV-LENGTH             PIC S9(4) COMP VALUE +200.
   168     12  USENT-SAVE              PIC XX    VALUE LOW-VALUES.
   169     12  URECDTE-SAVE            PIC XX    VALUE LOW-VALUES.
   170     12  REC-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX     PIC XX.
   171     12  STOP-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX2   PIC XX.
   172     12  DEEDIT-FIELD            PIC X(15).
   173     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   174
   175     12  ACCT-KEY.
   176         16  ACCT-PARTIAL-KEY.
   177             20  ACCT-CO         PIC X.
   178             20  ACCT-CARRIER    PIC X.
   179             20  ACCT-GROUPING   PIC X(6).
   180             20  ACCT-STATE      PIC XX.
   181             20  ACCT-ACCOUNT    PIC X(10).
   182         16  ACCT-EXP-DATE       PIC XX.
   183     12  FILLER                  PIC S9(9)  VALUE +0 COMP.
   184     12  ACCT-SAVE-KEY           PIC X(20).
   185     12  WS-ZIP.
   186         16  WS-ZIP-CODE         PIC X(5).
   187         16  WS-DASH             PIC X     VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   6
* EL162.cbl
   188         16  WS-ZIP-PLUS4        PIC X(4).
   189     12  WS-CANADIAN-POSTAL-CODES REDEFINES WS-ZIP.
   190         16  WS-CAN-POSTAL-CD-1  PIC X(3).
   191         16  WS-DASH-CAN         PIC X.
   192         16  WS-CAN-POSTAL-CD-2  PIC X(3).
   193         16  WS-CAN-FILLER       PIC X(3).
   194     12  WS-WORK-PHONE           PIC X(10)  VALUE ZEROS.
   195     12  WS-NUMERIC-PHONE REDEFINES WS-WORK-PHONE
   196                                 PIC 9(10).
   197     12  WS-REASON               PIC X(70).
   198
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   7
* EL162.cbl
   200*                            COPY ELCDATE.
   201******************************************************************
   202*                                                                *
   203*                                                                *
   204*                            ELCDATE.                            *
   205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   206*                            VMOD=2.003
   207*                                                                *
   208*                                                                *
   209*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   210*                 LENGTH = 200                                   *
   211******************************************************************
   212
   213 01  DATE-CONVERSION-DATA.
   214     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   215     12  DC-OPTION-CODE                PIC X.
   216         88  BIN-TO-GREG                VALUE ' '.
   217         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   218         88  EDIT-GREG-TO-BIN           VALUE '2'.
   219         88  YMD-GREG-TO-BIN            VALUE '3'.
   220         88  MDY-GREG-TO-BIN            VALUE '4'.
   221         88  JULIAN-TO-BIN              VALUE '5'.
   222         88  BIN-PLUS-ELAPSED           VALUE '6'.
   223         88  FIND-CENTURY               VALUE '7'.
   224         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   225         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   226         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   227         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   228         88  JULIAN-TO-BIN-3            VALUE 'C'.
   229         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   230         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   231         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   232         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   233         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   234         88  CHECK-LEAP-YEAR            VALUE 'H'.
   235         88  BIN-3-TO-GREG              VALUE 'I'.
   236         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   237         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   238         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   239         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   240         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   241         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   242         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   243         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   244         88  THREE-CHARACTER-BIN
   245                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   246         88  GREGORIAN-TO-BIN
   247                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   248         88  BIN-TO-GREGORIAN
   249                  VALUES ' ' '1' 'I' '8' 'G'.
   250         88  JULIAN-TO-BINARY
   251                  VALUES '5' 'C' 'E' 'F'.
   252     12  DC-ERROR-CODE                 PIC X.
   253         88  NO-CONVERSION-ERROR        VALUE ' '.
   254         88  DATE-CONVERSION-ERROR
   255                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   256         88  DATE-IS-ZERO               VALUE '1'.
   257         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   8
* EL162.cbl
   258         88  DATE-IS-INVALID            VALUE '3'.
   259         88  DATE1-GREATER-DATE2        VALUE '4'.
   260         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   261         88  DATE-INVALID-OPTION        VALUE '9'.
   262         88  INVALID-CENTURY            VALUE 'A'.
   263         88  ONLY-CENTURY               VALUE 'B'.
   264         88  ONLY-LEAP-YEAR             VALUE 'C'.
   265         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   266     12  DC-END-OF-MONTH               PIC X.
   267         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   268     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   269         88  USE-NORMAL-PROCESS         VALUE ' '.
   270         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   271         88  ADJUST-UP-100-YRS          VALUE '2'.
   272     12  FILLER                        PIC X.
   273     12  DC-CONVERSION-DATES.
   274         16  DC-BIN-DATE-1             PIC XX.
   275         16  DC-BIN-DATE-2             PIC XX.
   276         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   277         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   278                       DC-GREG-DATE-1-EDIT.
   279             20  DC-EDIT1-MONTH        PIC 99.
   280             20  SLASH1-1              PIC X.
   281             20  DC-EDIT1-DAY          PIC 99.
   282             20  SLASH1-2              PIC X.
   283             20  DC-EDIT1-YEAR         PIC 99.
   284         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   285         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   286                     DC-GREG-DATE-2-EDIT.
   287             20  DC-EDIT2-MONTH        PIC 99.
   288             20  SLASH2-1              PIC X.
   289             20  DC-EDIT2-DAY          PIC 99.
   290             20  SLASH2-2              PIC X.
   291             20  DC-EDIT2-YEAR         PIC 99.
   292         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   293         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   294                     DC-GREG-DATE-1-YMD.
   295             20  DC-YMD-YEAR           PIC 99.
   296             20  DC-YMD-MONTH          PIC 99.
   297             20  DC-YMD-DAY            PIC 99.
   298         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   299         16  DC-GREG-DATE-1-MDY-R REDEFINES
   300                      DC-GREG-DATE-1-MDY.
   301             20  DC-MDY-MONTH          PIC 99.
   302             20  DC-MDY-DAY            PIC 99.
   303             20  DC-MDY-YEAR           PIC 99.
   304         16  DC-GREG-DATE-1-ALPHA.
   305             20  DC-ALPHA-MONTH        PIC X(10).
   306             20  DC-ALPHA-DAY          PIC 99.
   307             20  FILLER                PIC XX.
   308             20  DC-ALPHA-CENTURY.
   309                 24 DC-ALPHA-CEN-N     PIC 99.
   310             20  DC-ALPHA-YEAR         PIC 99.
   311         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   312         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   313         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   314         16  DC-JULIAN-DATE            PIC 9(05).
   315         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page   9
* EL162.cbl
   316                                       PIC 9(05).
   317         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   318             20  DC-JULIAN-YEAR        PIC 99.
   319             20  DC-JULIAN-DAYS        PIC 999.
   320         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   321         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   322         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   323     12  DATE-CONVERSION-VARIBLES.
   324         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   325         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   326             20  FILLER                PIC 9(3).
   327             20  HOLD-CEN-1-CCYY.
   328                 24  HOLD-CEN-1-CC     PIC 99.
   329                 24  HOLD-CEN-1-YY     PIC 99.
   330             20  HOLD-CEN-1-MO         PIC 99.
   331             20  HOLD-CEN-1-DA         PIC 99.
   332         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   333             20  HOLD-CEN-1-R-MO       PIC 99.
   334             20  HOLD-CEN-1-R-DA       PIC 99.
   335             20  HOLD-CEN-1-R-CCYY.
   336                 24  HOLD-CEN-1-R-CC   PIC 99.
   337                 24  HOLD-CEN-1-R-YY   PIC 99.
   338             20  FILLER                PIC 9(3).
   339         16  HOLD-CENTURY-1-X.
   340             20  FILLER                PIC X(3)  VALUE SPACES.
   341             20  HOLD-CEN-1-X-CCYY.
   342                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   343                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   344             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   345             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   346         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   347             20  HOLD-CEN-1-R-X-MO     PIC XX.
   348             20  HOLD-CEN-1-R-X-DA     PIC XX.
   349             20  HOLD-CEN-1-R-X-CCYY.
   350                 24  HOLD-CEN-1-R-X-CC PIC XX.
   351                 24  HOLD-CEN-1-R-X-YY PIC XX.
   352             20  FILLER                PIC XXX.
   353         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   354         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   355         16  DC-JULIAN-DATE-1          PIC 9(07).
   356         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   357             20  DC-JULIAN-1-CCYY.
   358                 24  DC-JULIAN-1-CC    PIC 99.
   359                 24  DC-JULIAN-1-YR    PIC 99.
   360             20  DC-JULIAN-DA-1        PIC 999.
   361         16  DC-JULIAN-DATE-2          PIC 9(07).
   362         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   363             20  DC-JULIAN-2-CCYY.
   364                 24  DC-JULIAN-2-CC    PIC 99.
   365                 24  DC-JULIAN-2-YR    PIC 99.
   366             20  DC-JULIAN-DA-2        PIC 999.
   367         16  DC-GREG-DATE-A-EDIT.
   368             20  DC-EDITA-MONTH        PIC 99.
   369             20  SLASHA-1              PIC X VALUE '/'.
   370             20  DC-EDITA-DAY          PIC 99.
   371             20  SLASHA-2              PIC X VALUE '/'.
   372             20  DC-EDITA-CCYY.
   373                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  10
* EL162.cbl
   374                 24  DC-EDITA-YEAR     PIC 99.
   375         16  DC-GREG-DATE-B-EDIT.
   376             20  DC-EDITB-MONTH        PIC 99.
   377             20  SLASHB-1              PIC X VALUE '/'.
   378             20  DC-EDITB-DAY          PIC 99.
   379             20  SLASHB-2              PIC X VALUE '/'.
   380             20  DC-EDITB-CCYY.
   381                 24  DC-EDITB-CENT     PIC 99.
   382                 24  DC-EDITB-YEAR     PIC 99.
   383         16  DC-GREG-DATE-CYMD         PIC 9(08).
   384         16  DC-GREG-DATE-CYMD-R REDEFINES
   385                              DC-GREG-DATE-CYMD.
   386             20  DC-CYMD-CEN           PIC 99.
   387             20  DC-CYMD-YEAR          PIC 99.
   388             20  DC-CYMD-MONTH         PIC 99.
   389             20  DC-CYMD-DAY           PIC 99.
   390         16  DC-GREG-DATE-MDCY         PIC 9(08).
   391         16  DC-GREG-DATE-MDCY-R REDEFINES
   392                              DC-GREG-DATE-MDCY.
   393             20  DC-MDCY-MONTH         PIC 99.
   394             20  DC-MDCY-DAY           PIC 99.
   395             20  DC-MDCY-CEN           PIC 99.
   396             20  DC-MDCY-YEAR          PIC 99.
   397    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   398        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   399    12  DC-EL310-DATE                  PIC X(21).
   400    12  FILLER                         PIC X(28).
   401
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  11
* EL162.cbl
   403*                            COPY ELCLOGOF.
   404******************************************************************
   405*                                                                *
   406*                                                                *
   407*                            ELCLOGOF.                           *
   408*                            VMOD=2.001                          *
   409*                                                                *
   410*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   411*                                                                *
   412******************************************************************
   413 01  CLASIC-LOGOFF.
   414     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   415     12  LOGOFF-TEXT.
   416         16  FILLER          PIC X(5)    VALUE SPACES.
   417         16  LOGOFF-MSG.
   418             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   419             20  FILLER      PIC X       VALUE SPACES.
   420             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   421         16  FILLER          PIC X(80)
   422           VALUE '* YOU ARE NOW LOGGED OFF'.
   423         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   424         16  FILLER          PIC X       VALUE QUOTE.
   425         16  LOGOFF-SYS-MSG  PIC X(17)
   426           VALUE 'S CLAS-IC SYSTEM '.
   427     12  TEXT-MESSAGES.
   428         16  UNACCESS-MSG    PIC X(29)
   429             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   430         16  PGMIDERR-MSG    PIC X(17)
   431             VALUE 'PROGRAM NOT FOUND'.
   432
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  12
* EL162.cbl
   434*                            COPY ELCATTR.
   435******************************************************************
   436*                                                                *
   437*                            ELCATTR.                            *
   438*                            VMOD=2.001                          *
   439*                                                                *
   440*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   441*                                                                *
   442*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   443*                                                                *
   444*                   POS 1   P=PROTECTED                          *
   445*                           U=UNPROTECTED                        *
   446*                           S=ASKIP                              *
   447*                   POS 2   A=ALPHA/NUMERIC                      *
   448*                           N=NUMERIC                            *
   449*                   POS 3   N=NORMAL                             *
   450*                           B=BRIGHT                             *
   451*                           D=DARK                               *
   452*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   453*                           OF=MODIFIED DATA TAG OFF             *
   454*                                                                *
   455*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   456******************************************************************
   457 01  ATTRIBUTE-LIST.
   458     12  AL-PABOF            PIC X       VALUE 'Y'.
   459     12  AL-PABON            PIC X       VALUE 'Z'.
   460     12  AL-PADOF            PIC X       VALUE '%'.
   461     12  AL-PADON            PIC X       VALUE '_'.
   462     12  AL-PANOF            PIC X       VALUE '-'.
   463     12  AL-PANON            PIC X       VALUE '/'.
   464     12  AL-SABOF            PIC X       VALUE '8'.
   465     12  AL-SABON            PIC X       VALUE '9'.
   466     12  AL-SADOF            PIC X       VALUE '@'.
   467     12  AL-SADON            PIC X       VALUE QUOTE.
   468     12  AL-SANOF            PIC X       VALUE '0'.
   469     12  AL-SANON            PIC X       VALUE '1'.
   470     12  AL-UABOF            PIC X       VALUE 'H'.
   471     12  AL-UABON            PIC X       VALUE 'I'.
   472     12  AL-UADOF            PIC X       VALUE '<'.
   473     12  AL-UADON            PIC X       VALUE '('.
   474     12  AL-UANOF            PIC X       VALUE ' '.
   475     12  AL-UANON            PIC X       VALUE 'A'.
   476     12  AL-UNBOF            PIC X       VALUE 'Q'.
   477     12  AL-UNBON            PIC X       VALUE 'R'.
   478     12  AL-UNDOF            PIC X       VALUE '*'.
   479     12  AL-UNDON            PIC X       VALUE ')'.
   480     12  AL-UNNOF            PIC X       VALUE '&'.
   481     12  AL-UNNON            PIC X       VALUE 'J'.
   482
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  13
* EL162.cbl
   484*                            COPY ELCEMIB.
   485******************************************************************
   486*                                                                *
   487*                                                                *
   488*                            ELCEMIB.                            *
   489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   490*                            VMOD=2.005                          *
   491*                                                                *
   492*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   493*                                                                *
   494******************************************************************
   495 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   496     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   497     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   498     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   499     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   500     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   501     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   502     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   503     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   504     12  EMI-SWITCH1             PIC X        VALUE '1'.
   505         88  EMI-NO-ERRORS                    VALUE '1'.
   506         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   507         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   508     12  EMI-SWITCH2             PIC X        VALUE '1'.
   509         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   510     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   511         88  EMI-AREA1-EMPTY                  VALUE '1'.
   512         88  EMI-AREA1-FULL                   VALUE '2'.
   513     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   514         88  EMI-AREA2-EMPTY                  VALUE '1'.
   515         88  EMI-AREA2-FULL                   VALUE '2'.
   516     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   517         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   518         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   519         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   520         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   521         88  EMI-BYPASS-FATALS                VALUE 'X'.
   522     12  EMI-ERROR-LINES.
   523         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   524         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   525         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   526         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   527             20  EMI-ERR-CODES OCCURS 10 TIMES.
   528                 24  EMI-ERR-NUM         PIC X(4).
   529                 24  EMI-FILLER          PIC X.
   530                 24  EMI-SEV             PIC X.
   531                 24  FILLER              PIC X.
   532             20  FILLER                  PIC X(02).
   533     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   534         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   535             20  EMI-ERROR-NUMBER    PIC X(4).
   536             20  EMI-FILL            PIC X.
   537             20  EMI-SEVERITY        PIC X.
   538             20  FILLER              PIC X.
   539             20  EMI-ERROR-TEXT.
   540                 24  EMI-TEXT-VARIABLE   PIC X(10).
   541                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  14
* EL162.cbl
   542     12  EMI-SEVERITY-SAVE           PIC X.
   543         88  EMI-NOTE                    VALUE 'N'.
   544         88  EMI-WARNING                 VALUE 'W'.
   545         88  EMI-FORCABLE                VALUE 'F'.
   546         88  EMI-FATAL                   VALUE 'X'.
   547     12  EMI-MESSAGE-FLAG            PIC X.
   548         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   549         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   550     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   551     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   552         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   553         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   554         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   555     12  emi-claim-no                pic x(7).
   556     12  emi-claim-type              pic x(6).
   557     12  FILLER                      PIC X(124)  VALUE SPACES.
   558     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   559     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   560     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   561     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  15
* EL162.cbl
   563*                            COPY ELCINTF.
   564******************************************************************
   565*                                                                *
   566*                                                                *
   567*                            ELCINTF.                            *
   568*                            VMOD=2.017                          *
   569*                                                                *
   570*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   571*                                                                *
   572*       LENGTH = 1024                                            *
   573*                                                                *
   574******************************************************************
   575*                   C H A N G E   L O G
   576*
   577* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   578*-----------------------------------------------------------------
   579*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   580* EFFECTIVE    NUMBER
   581*-----------------------------------------------------------------
   582* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   583******************************************************************
   584 01  PROGRAM-INTERFACE-BLOCK.
   585     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   586     12  PI-CALLING-PROGRAM              PIC X(8).
   587     12  PI-SAVED-PROGRAM-1              PIC X(8).
   588     12  PI-SAVED-PROGRAM-2              PIC X(8).
   589     12  PI-SAVED-PROGRAM-3              PIC X(8).
   590     12  PI-SAVED-PROGRAM-4              PIC X(8).
   591     12  PI-SAVED-PROGRAM-5              PIC X(8).
   592     12  PI-SAVED-PROGRAM-6              PIC X(8).
   593     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   594     12  PI-COMPANY-ID                   PIC XXX.
   595     12  PI-COMPANY-CD                   PIC X.
   596
   597     12  PI-COMPANY-PASSWORD             PIC X(8).
   598
   599     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   600
   601     12  PI-CONTROL-IN-PROGRESS.
   602         16  PI-CARRIER                  PIC X.
   603         16  PI-GROUPING                 PIC X(6).
   604         16  PI-STATE                    PIC XX.
   605         16  PI-ACCOUNT                  PIC X(10).
   606         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   607                                         PIC X(10).
   608         16  PI-CLAIM-CERT-GRP.
   609             20  PI-CLAIM-NO             PIC X(7).
   610             20  PI-CERT-NO.
   611                 25  PI-CERT-PRIME       PIC X(10).
   612                 25  PI-CERT-SFX         PIC X.
   613             20  PI-CERT-EFF-DT          PIC XX.
   614         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   615             20  PI-PLAN-CODE            PIC X(2).
   616             20  PI-REVISION-NUMBER      PIC X(3).
   617             20  PI-PLAN-EFF-DT          PIC X(2).
   618             20  PI-PLAN-EXP-DT          PIC X(2).
   619             20  FILLER                  PIC X(11).
   620         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  16
* EL162.cbl
   621             20  PI-OE-REFERENCE-1.
   622                 25  PI-OE-REF-1-PRIME   PIC X(18).
   623                 25  PI-OE-REF-1-SUFF    PIC XX.
   624
   625     12  PI-SESSION-IN-PROGRESS          PIC X.
   626         88  CLAIM-SESSION                   VALUE '1'.
   627         88  CREDIT-SESSION                  VALUE '2'.
   628         88  WARRANTY-SESSION                VALUE '3'.
   629         88  MORTGAGE-SESSION                VALUE '4'.
   630         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   631
   632
   633*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   634
   635     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   636     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   637
   638     12  PI-CREDIT-USER                  PIC X.
   639         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   640         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   641
   642     12  PI-CLAIM-USER                   PIC X.
   643         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   644         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   645
   646     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   647         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   648         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   649         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   650         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   651         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   652
   653     12  PI-PROCESSOR-ID                 PIC X(4).
   654
   655     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   656
   657     12  PI-MEMBER-CAPTION               PIC X(10).
   658
   659     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   660         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   661
   662     12  PI-LIFE-OVERRIDE-L1             PIC X.
   663     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   664     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   665     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   666
   667     12  PI-AH-OVERRIDE-L1               PIC X.
   668     12  PI-AH-OVERRIDE-L2               PIC XX.
   669     12  PI-AH-OVERRIDE-L6               PIC X(6).
   670     12  PI-AH-OVERRIDE-L12              PIC X(12).
   671
   672     12  PI-NEW-SYSTEM                   PIC X(2).
   673
   674     12  PI-PRIMARY-CERT-NO              PIC X(11).
   675     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   676         88  PI-USES-PAID-TO                 VALUE '1'.
   677     12  PI-CRDTCRD-SYSTEM.
   678         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  17
* EL162.cbl
   679             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   680             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   681         16  PI-CC-MONTH-END-DT          PIC XX.
   682     12  PI-PROCESSOR-PRINTER            PIC X(4).
   683
   684     12  PI-OE-REFERENCE-2.
   685         16  PI-OE-REF-2-PRIME           PIC X(10).
   686         16  PI-OE-REF-2-SUFF            PIC X.
   687
   688     12  PI-REM-TRM-CALC-OPTION          PIC X.
   689
   690     12  PI-LANGUAGE-TYPE                PIC X.
   691             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   692             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   693             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   694
   695     12  PI-POLICY-LINKAGE-IND           PIC X.
   696         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   697         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   698                                                   LOW-VALUES.
   699
   700     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   701     12  PI-CLAIM-PW-SESSION             PIC X(1).
   702         88  PI-CLAIM-CREDIT                 VALUE '1'.
   703         88  PI-CLAIM-CONVEN                 VALUE '2'.
   704
   705     12  PI-PROCESSOR-CSR-IND            PIC X.
   706         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   707         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   708
   709     12  FILLER                          PIC X(3).
   710
   711     12  PI-SYSTEM-LEVEL                 PIC X(145).
   712
   713     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   714         PI-SYSTEM-LEVEL.
   715
   716         16  PI-ENTRY-CODES.
   717             20  PI-ENTRY-CD-1           PIC X.
   718             20  PI-ENTRY-CD-2           PIC X.
   719
   720         16  PI-RETURN-CODES.
   721             20  PI-RETURN-CD-1          PIC X.
   722             20  PI-RETURN-CD-2          PIC X.
   723
   724         16  PI-UPDATE-STATUS-SAVE.
   725             20  PI-UPDATE-BY            PIC X(4).
   726             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   727
   728         16  PI-LOWER-CASE-LETTERS       PIC X.
   729             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   730
   731*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   732*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   733*            88  CARRIER-CLM-CNTL            VALUE '2'.
   734
   735         16  PI-CERT-ACCESS-CONTROL      PIC X.
   736             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  18
* EL162.cbl
   737             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   738             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   739             88  ACCNT-CNTL                  VALUE '3'.
   740             88  CARR-ACCNT-CNTL             VALUE '4'.
   741
   742         16  PI-PROCESSOR-CAP-LIST.
   743             20  PI-SYSTEM-CONTROLS.
   744                24 PI-SYSTEM-DISPLAY     PIC X.
   745                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   746                24 PI-SYSTEM-MODIFY      PIC X.
   747                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   748             20  FILLER                  PIC XX.
   749             20  PI-DISPLAY-CAP          PIC X.
   750                 88  DISPLAY-CAP             VALUE 'Y'.
   751             20  PI-MODIFY-CAP           PIC X.
   752                 88  MODIFY-CAP              VALUE 'Y'.
   753             20  PI-MSG-AT-LOGON-CAP     PIC X.
   754                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   755             20  PI-FORCE-CAP            PIC X.
   756                 88  FORCE-CAP               VALUE 'Y'.
   757
   758         16  PI-PROGRAM-CONTROLS.
   759             20  PI-PGM-PRINT-OPT        PIC X.
   760             20  PI-PGM-FORMAT-OPT       PIC X.
   761             20  PI-PGM-PROCESS-OPT      PIC X.
   762             20  PI-PGM-TOTALS-OPT       PIC X.
   763
   764         16  PI-HELP-INTERFACE.
   765             20  PI-LAST-ERROR-NO        PIC X(4).
   766             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   767
   768         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   769             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   770
   771         16  PI-CR-CONTROL-IN-PROGRESS.
   772             20  PI-CR-CARRIER           PIC X.
   773             20  PI-CR-GROUPING          PIC X(6).
   774             20  PI-CR-STATE             PIC XX.
   775             20  PI-CR-ACCOUNT           PIC X(10).
   776             20  PI-CR-FIN-RESP          PIC X(10).
   777             20  PI-CR-TYPE              PIC X.
   778
   779         16  PI-CR-BATCH-NUMBER          PIC X(6).
   780
   781         16  PI-CR-MONTH-END-DT          PIC XX.
   782
   783         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   784             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   785             88  PI-ZERO-CARRIER             VALUE '1'.
   786             88  PI-ZERO-GROUPING            VALUE '2'.
   787             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   788
   789         16  PI-CARRIER-SECURITY         PIC X.
   790             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   791
   792         16  PI-ACCOUNT-SECURITY         PIC X(10).
   793             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   794             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  19
* EL162.cbl
   795
   796         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   797             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   798                                         INDEXED BY PI-ACCESS-NDX
   799                                         PIC X.
   800
   801         16  PI-GA-BILLING-CONTROL       PIC X.
   802             88  PI-GA-BILLING               VALUE '1'.
   803
   804         16  PI-MAIL-PROCESSING          PIC X.
   805             88  PI-MAIL-YES                 VALUE 'Y'.
   806
   807         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   808
   809         16  PI-AR-SYSTEM.
   810             20  PI-AR-PROCESSING-CNTL   PIC X.
   811                 88  PI-AR-PROCESSING        VALUE 'Y'.
   812             20  PI-AR-SUMMARY-CODE      PIC X(6).
   813             20  PI-AR-MONTH-END-DT      PIC XX.
   814
   815         16  PI-MP-SYSTEM.
   816             20  PI-MORTGAGE-USER            PIC X.
   817                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   818                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   819             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   820                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   821                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   822                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   823                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   824                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   825             20  PI-MP-MONTH-END-DT          PIC XX.
   826             20  PI-MP-REFERENCE-NO.
   827                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   828                 24  PI-MP-REFERENCE-SFX     PIC XX.
   829
   830         16  PI-LABEL-CONTROL            PIC X(01).
   831             88  PI-CREATE-LABELS                    VALUE 'Y'.
   832             88  PI-BYPASS-LABELS                    VALUE 'N'.
   833
   834         16  PI-BILL-GROUPING-CODE       PIC X(01).
   835             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   836
   837         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   838             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   839             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   840
   841         16  FILLER                      PIC X(14).
   842
   843     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   844******************************************************************
   845     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   846         16  PI-NEXT-TRLR-SUB    PIC S999  COMP-3.
   847         16  PI-ACTV-SAVE        PIC X(20).
   848         16  PI-ACTV-SAVE-SEQ    PIC S9(04) COMP.
   849         16  PI-ACTV-KEY.
   850           18  PI-ACTV-PARTIAL.
   851             20  PI-ACTV-COMP-CD     PIC X.
   852             20  PI-ACTV-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  20
* EL162.cbl
   853             20  PI-ACTV-CLAIM       PIC X(7).
   854             20  PI-ACTV-CERT-NO.
   855                 22  PI-ACTV-CERT-NO-PRIME PIC X(10).
   856                 22  PI-ACTV-CERT-NO-SUFX  PIC X.
   857           18  PI-ACTV-SEQ           PIC S9(4) COMP.
   858
   859         16  PI-DISPLAYED-TRAILER-CODES.
   860             18  PI-TRLRS OCCURS 50 TIMES    PIC S9(4) COMP.
   861         16  PI-CLAM-KEY.
   862             20  PI-CLAM-COMP-CD     PIC X.
   863             20  PI-CLAM-CARRIER     PIC X.
   864             20  PI-CLAM-CLAIM       PIC X(7).
   865             20  PI-CLAM-CERT-NO.
   866                 24  PI-CLAM-CERT-NO-PRIME  PIC X(10).
   867                 24  PI-CLAM-CERT-NO-SUFX   PIC X.
   868         16  PI-DMD-FORCE-ERROR      PIC X.
   869             88  PI-DMD-FORCED             VALUE 'X'.
   870         16  FILLER                  PIC X(473).
   871
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  21
* EL162.cbl
   873*                            COPY ELCAID.
   874******************************************************************
   875*                                                                *
   876*                            ELCAID.                             *
   877*                            VMOD=2.001                          *
   878*                                                                *
   879*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   880*                                                                *
   881*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   882*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   883******************************************************************
   884
   885 01  DFHAID.
   886   02  DFHNULL   PIC  X  VALUE  ' '.
   887   02  DFHENTER  PIC  X  VALUE  QUOTE.
   888   02  DFHCLEAR  PIC  X  VALUE  '_'.
   889   02  DFHPEN    PIC  X  VALUE  '='.
   890   02  DFHOPID   PIC  X  VALUE  'W'.
   891   02  DFHPA1    PIC  X  VALUE  '%'.
   892   02  DFHPA2    PIC  X  VALUE  '>'.
   893   02  DFHPA3    PIC  X  VALUE  ','.
   894   02  DFHPF1    PIC  X  VALUE  '1'.
   895   02  DFHPF2    PIC  X  VALUE  '2'.
   896   02  DFHPF3    PIC  X  VALUE  '3'.
   897   02  DFHPF4    PIC  X  VALUE  '4'.
   898   02  DFHPF5    PIC  X  VALUE  '5'.
   899   02  DFHPF6    PIC  X  VALUE  '6'.
   900   02  DFHPF7    PIC  X  VALUE  '7'.
   901   02  DFHPF8    PIC  X  VALUE  '8'.
   902   02  DFHPF9    PIC  X  VALUE  '9'.
   903   02  DFHPF10   PIC  X  VALUE  ':'.
   904   02  DFHPF11   PIC  X  VALUE  '#'.
   905   02  DFHPF12   PIC  X  VALUE  '@'.
   906   02  DFHPF13   PIC  X  VALUE  'A'.
   907   02  DFHPF14   PIC  X  VALUE  'B'.
   908   02  DFHPF15   PIC  X  VALUE  'C'.
   909   02  DFHPF16   PIC  X  VALUE  'D'.
   910   02  DFHPF17   PIC  X  VALUE  'E'.
   911   02  DFHPF18   PIC  X  VALUE  'F'.
   912   02  DFHPF19   PIC  X  VALUE  'G'.
   913   02  DFHPF20   PIC  X  VALUE  'H'.
   914   02  DFHPF21   PIC  X  VALUE  'I'.
   915*00039    02  DFHPF22   PIC  X  VALUE  ''.
   916   02  DFHPF22   PIC  X  VALUE  '['.
   917   02  DFHPF23   PIC  X  VALUE  '.'.
   918   02  DFHPF24   PIC  X  VALUE  '<'.
   919   02  DFHMSRE   PIC  X  VALUE  'X'.
   920   02  DFHSTRF   PIC  X  VALUE  'h'.
   921   02  DFHTRIG   PIC  X  VALUE  '"'.
   922 01  FILLER    REDEFINES DFHAID.
   923     12  FILLER              PIC X(8).
   924     12  PF-VALUES           PIC X       OCCURS 2.
   925
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  22
* EL162.cbl
   927*                            COPY EL162S.
   928 01  EL162AI.
   929     05  FILLER            PIC  X(0012).
   930*    -------------------------------
   931     05  RUNDTEL PIC S9(0004) COMP.
   932     05  RUNDTEF PIC  X(0001).
   933     05  FILLER REDEFINES RUNDTEF.
   934         10  RUNDTEA PIC  X(0001).
   935     05  RUNDTEI PIC  X(0008).
   936*    -------------------------------
   937     05  RUNTIMEL PIC S9(0004) COMP.
   938     05  RUNTIMEF PIC  X(0001).
   939     05  FILLER REDEFINES RUNTIMEF.
   940         10  RUNTIMEA PIC  X(0001).
   941     05  RUNTIMEI PIC  X(0005).
   942*    -------------------------------
   943     05  CLAIMNOL PIC S9(0004) COMP.
   944     05  CLAIMNOF PIC  X(0001).
   945     05  FILLER REDEFINES CLAIMNOF.
   946         10  CLAIMNOA PIC  X(0001).
   947     05  CLAIMNOI PIC  X(0007).
   948*    -------------------------------
   949     05  TYPEL PIC S9(0004) COMP.
   950     05  TYPEF PIC  X(0001).
   951     05  FILLER REDEFINES TYPEF.
   952         10  TYPEA PIC  X(0001).
   953     05  TYPEI PIC  X(0006).
   954*    -------------------------------
   955     05  CARRL PIC S9(0004) COMP.
   956     05  CARRF PIC  X(0001).
   957     05  FILLER REDEFINES CARRF.
   958         10  CARRA PIC  X(0001).
   959     05  CARRI PIC  X(0001).
   960*    -------------------------------
   961     05  CERTNOL PIC S9(0004) COMP.
   962     05  CERTNOF PIC  X(0001).
   963     05  FILLER REDEFINES CERTNOF.
   964         10  CERTNOA PIC  X(0001).
   965     05  CERTNOI PIC  X(0011).
   966*    -------------------------------
   967     05  LASTNMEL PIC S9(0004) COMP.
   968     05  LASTNMEF PIC  X(0001).
   969     05  FILLER REDEFINES LASTNMEF.
   970         10  LASTNMEA PIC  X(0001).
   971     05  LASTNMEI PIC  X(0015).
   972*    -------------------------------
   973     05  FILEL PIC S9(0004) COMP.
   974     05  FILEF PIC  X(0001).
   975     05  FILLER REDEFINES FILEF.
   976         10  FILEA PIC  X(0001).
   977     05  FILEI PIC  X(0004).
   978*    -------------------------------
   979     05  RECDTE1L PIC S9(0004) COMP.
   980     05  RECDTE1F PIC  X(0001).
   981     05  FILLER REDEFINES RECDTE1F.
   982         10  RECDTE1A PIC  X(0001).
   983     05  RECDTE1I PIC  X(0008).
   984*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  23
* EL162.cbl
   985     05  STOPDT1L PIC S9(0004) COMP.
   986     05  STOPDT1F PIC  X(0001).
   987     05  FILLER REDEFINES STOPDT1F.
   988         10  STOPDT1A PIC  X(0001).
   989     05  STOPDT1I PIC  X(0008).
   990*    -------------------------------
   991     05  SENT1L PIC S9(0004) COMP.
   992     05  SENT1F PIC  X(0001).
   993     05  FILLER REDEFINES SENT1F.
   994         10  SENT1A PIC  X(0001).
   995     05  SENT1I PIC  X(0008).
   996*    -------------------------------
   997     05  BY1L PIC S9(0004) COMP.
   998     05  BY1F PIC  X(0001).
   999     05  FILLER REDEFINES BY1F.
  1000         10  BY1A PIC  X(0001).
  1001     05  BY1I PIC  X(0004).
  1002*    -------------------------------
  1003     05  RESEND1L PIC S9(0004) COMP.
  1004     05  RESEND1F PIC  X(0001).
  1005     05  FILLER REDEFINES RESEND1F.
  1006         10  RESEND1A PIC  X(0001).
  1007     05  RESEND1I PIC  X(0008).
  1008*    -------------------------------
  1009     05  FOLLOW1L PIC S9(0004) COMP.
  1010     05  FOLLOW1F PIC  X(0001).
  1011     05  FILLER REDEFINES FOLLOW1F.
  1012         10  FOLLOW1A PIC  X(0001).
  1013     05  FOLLOW1I PIC  X(0008).
  1014*    -------------------------------
  1015     05  FORM1L PIC S9(0004) COMP.
  1016     05  FORM1F PIC  X(0001).
  1017     05  FILLER REDEFINES FORM1F.
  1018         10  FORM1A PIC  X(0001).
  1019     05  FORM1I PIC  X(0004).
  1020*    -------------------------------
  1021     05  TO1L PIC S9(0004) COMP.
  1022     05  TO1F PIC  X(0001).
  1023     05  FILLER REDEFINES TO1F.
  1024         10  TO1A PIC  X(0001).
  1025     05  TO1I PIC  X(0008).
  1026*    -------------------------------
  1027     05  ARCH1L PIC S9(0004) COMP.
  1028     05  ARCH1F PIC  X(0001).
  1029     05  FILLER REDEFINES ARCH1F.
  1030         10  ARCH1A PIC  X(0001).
  1031     05  ARCH1I PIC  X(0008).
  1032*    -------------------------------
  1033     05  TRLR1L PIC S9(0004) COMP.
  1034     05  TRLR1F PIC  X(0001).
  1035     05  FILLER REDEFINES TRLR1F.
  1036         10  TRLR1A PIC  X(0001).
  1037     05  TRLR1I PIC  X(0004).
  1038*    -------------------------------
  1039     05  TYPE1L PIC S9(0004) COMP.
  1040     05  TYPE1F PIC  X(0001).
  1041     05  FILLER REDEFINES TYPE1F.
  1042         10  TYPE1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  24
* EL162.cbl
  1043     05  TYPE1I PIC  X(0001).
  1044*    -------------------------------
  1045     05  RE1L PIC S9(0004) COMP.
  1046     05  RE1F PIC  X(0001).
  1047     05  FILLER REDEFINES RE1F.
  1048         10  RE1A PIC  X(0001).
  1049     05  RE1I PIC  X(0070).
  1050*    -------------------------------
  1051     05  RECDTE2L PIC S9(0004) COMP.
  1052     05  RECDTE2F PIC  X(0001).
  1053     05  FILLER REDEFINES RECDTE2F.
  1054         10  RECDTE2A PIC  X(0001).
  1055     05  RECDTE2I PIC  X(0008).
  1056*    -------------------------------
  1057     05  STOPDT2L PIC S9(0004) COMP.
  1058     05  STOPDT2F PIC  X(0001).
  1059     05  FILLER REDEFINES STOPDT2F.
  1060         10  STOPDT2A PIC  X(0001).
  1061     05  STOPDT2I PIC  X(0008).
  1062*    -------------------------------
  1063     05  SENT2L PIC S9(0004) COMP.
  1064     05  SENT2F PIC  X(0001).
  1065     05  FILLER REDEFINES SENT2F.
  1066         10  SENT2A PIC  X(0001).
  1067     05  SENT2I PIC  X(0008).
  1068*    -------------------------------
  1069     05  BY2L PIC S9(0004) COMP.
  1070     05  BY2F PIC  X(0001).
  1071     05  FILLER REDEFINES BY2F.
  1072         10  BY2A PIC  X(0001).
  1073     05  BY2I PIC  X(0004).
  1074*    -------------------------------
  1075     05  RESEND2L PIC S9(0004) COMP.
  1076     05  RESEND2F PIC  X(0001).
  1077     05  FILLER REDEFINES RESEND2F.
  1078         10  RESEND2A PIC  X(0001).
  1079     05  RESEND2I PIC  X(0008).
  1080*    -------------------------------
  1081     05  FOLLOW2L PIC S9(0004) COMP.
  1082     05  FOLLOW2F PIC  X(0001).
  1083     05  FILLER REDEFINES FOLLOW2F.
  1084         10  FOLLOW2A PIC  X(0001).
  1085     05  FOLLOW2I PIC  X(0008).
  1086*    -------------------------------
  1087     05  FORM2L PIC S9(0004) COMP.
  1088     05  FORM2F PIC  X(0001).
  1089     05  FILLER REDEFINES FORM2F.
  1090         10  FORM2A PIC  X(0001).
  1091     05  FORM2I PIC  X(0004).
  1092*    -------------------------------
  1093     05  TO2L PIC S9(0004) COMP.
  1094     05  TO2F PIC  X(0001).
  1095     05  FILLER REDEFINES TO2F.
  1096         10  TO2A PIC  X(0001).
  1097     05  TO2I PIC  X(0008).
  1098*    -------------------------------
  1099     05  ARCH2L PIC S9(0004) COMP.
  1100     05  ARCH2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  25
* EL162.cbl
  1101     05  FILLER REDEFINES ARCH2F.
  1102         10  ARCH2A PIC  X(0001).
  1103     05  ARCH2I PIC  X(0008).
  1104*    -------------------------------
  1105     05  TRLR2L PIC S9(0004) COMP.
  1106     05  TRLR2F PIC  X(0001).
  1107     05  FILLER REDEFINES TRLR2F.
  1108         10  TRLR2A PIC  X(0001).
  1109     05  TRLR2I PIC  X(0004).
  1110*    -------------------------------
  1111     05  TYPE2L PIC S9(0004) COMP.
  1112     05  TYPE2F PIC  X(0001).
  1113     05  FILLER REDEFINES TYPE2F.
  1114         10  TYPE2A PIC  X(0001).
  1115     05  TYPE2I PIC  X(0001).
  1116*    -------------------------------
  1117     05  RE2L PIC S9(0004) COMP.
  1118     05  RE2F PIC  X(0001).
  1119     05  FILLER REDEFINES RE2F.
  1120         10  RE2A PIC  X(0001).
  1121     05  RE2I PIC  X(0070).
  1122*    -------------------------------
  1123     05  RECDTE3L PIC S9(0004) COMP.
  1124     05  RECDTE3F PIC  X(0001).
  1125     05  FILLER REDEFINES RECDTE3F.
  1126         10  RECDTE3A PIC  X(0001).
  1127     05  RECDTE3I PIC  X(0008).
  1128*    -------------------------------
  1129     05  STOPDT3L PIC S9(0004) COMP.
  1130     05  STOPDT3F PIC  X(0001).
  1131     05  FILLER REDEFINES STOPDT3F.
  1132         10  STOPDT3A PIC  X(0001).
  1133     05  STOPDT3I PIC  X(0008).
  1134*    -------------------------------
  1135     05  SENT3L PIC S9(0004) COMP.
  1136     05  SENT3F PIC  X(0001).
  1137     05  FILLER REDEFINES SENT3F.
  1138         10  SENT3A PIC  X(0001).
  1139     05  SENT3I PIC  X(0008).
  1140*    -------------------------------
  1141     05  BY3L PIC S9(0004) COMP.
  1142     05  BY3F PIC  X(0001).
  1143     05  FILLER REDEFINES BY3F.
  1144         10  BY3A PIC  X(0001).
  1145     05  BY3I PIC  X(0004).
  1146*    -------------------------------
  1147     05  RESEND3L PIC S9(0004) COMP.
  1148     05  RESEND3F PIC  X(0001).
  1149     05  FILLER REDEFINES RESEND3F.
  1150         10  RESEND3A PIC  X(0001).
  1151     05  RESEND3I PIC  X(0008).
  1152*    -------------------------------
  1153     05  FOLLOW3L PIC S9(0004) COMP.
  1154     05  FOLLOW3F PIC  X(0001).
  1155     05  FILLER REDEFINES FOLLOW3F.
  1156         10  FOLLOW3A PIC  X(0001).
  1157     05  FOLLOW3I PIC  X(0008).
  1158*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  26
* EL162.cbl
  1159     05  FORM3L PIC S9(0004) COMP.
  1160     05  FORM3F PIC  X(0001).
  1161     05  FILLER REDEFINES FORM3F.
  1162         10  FORM3A PIC  X(0001).
  1163     05  FORM3I PIC  X(0004).
  1164*    -------------------------------
  1165     05  TO3L PIC S9(0004) COMP.
  1166     05  TO3F PIC  X(0001).
  1167     05  FILLER REDEFINES TO3F.
  1168         10  TO3A PIC  X(0001).
  1169     05  TO3I PIC  X(0008).
  1170*    -------------------------------
  1171     05  ARCH3L PIC S9(0004) COMP.
  1172     05  ARCH3F PIC  X(0001).
  1173     05  FILLER REDEFINES ARCH3F.
  1174         10  ARCH3A PIC  X(0001).
  1175     05  ARCH3I PIC  X(0008).
  1176*    -------------------------------
  1177     05  TRLR3L PIC S9(0004) COMP.
  1178     05  TRLR3F PIC  X(0001).
  1179     05  FILLER REDEFINES TRLR3F.
  1180         10  TRLR3A PIC  X(0001).
  1181     05  TRLR3I PIC  X(0004).
  1182*    -------------------------------
  1183     05  TYPE3L PIC S9(0004) COMP.
  1184     05  TYPE3F PIC  X(0001).
  1185     05  FILLER REDEFINES TYPE3F.
  1186         10  TYPE3A PIC  X(0001).
  1187     05  TYPE3I PIC  X(0001).
  1188*    -------------------------------
  1189     05  RE3L PIC S9(0004) COMP.
  1190     05  RE3F PIC  X(0001).
  1191     05  FILLER REDEFINES RE3F.
  1192         10  RE3A PIC  X(0001).
  1193     05  RE3I PIC  X(0070).
  1194*    -------------------------------
  1195     05  RECDTE4L PIC S9(0004) COMP.
  1196     05  RECDTE4F PIC  X(0001).
  1197     05  FILLER REDEFINES RECDTE4F.
  1198         10  RECDTE4A PIC  X(0001).
  1199     05  RECDTE4I PIC  X(0008).
  1200*    -------------------------------
  1201     05  STOPDT4L PIC S9(0004) COMP.
  1202     05  STOPDT4F PIC  X(0001).
  1203     05  FILLER REDEFINES STOPDT4F.
  1204         10  STOPDT4A PIC  X(0001).
  1205     05  STOPDT4I PIC  X(0008).
  1206*    -------------------------------
  1207     05  SENT4L PIC S9(0004) COMP.
  1208     05  SENT4F PIC  X(0001).
  1209     05  FILLER REDEFINES SENT4F.
  1210         10  SENT4A PIC  X(0001).
  1211     05  SENT4I PIC  X(0008).
  1212*    -------------------------------
  1213     05  BY4L PIC S9(0004) COMP.
  1214     05  BY4F PIC  X(0001).
  1215     05  FILLER REDEFINES BY4F.
  1216         10  BY4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  27
* EL162.cbl
  1217     05  BY4I PIC  X(0004).
  1218*    -------------------------------
  1219     05  RESEND4L PIC S9(0004) COMP.
  1220     05  RESEND4F PIC  X(0001).
  1221     05  FILLER REDEFINES RESEND4F.
  1222         10  RESEND4A PIC  X(0001).
  1223     05  RESEND4I PIC  X(0008).
  1224*    -------------------------------
  1225     05  FOLLOW4L PIC S9(0004) COMP.
  1226     05  FOLLOW4F PIC  X(0001).
  1227     05  FILLER REDEFINES FOLLOW4F.
  1228         10  FOLLOW4A PIC  X(0001).
  1229     05  FOLLOW4I PIC  X(0008).
  1230*    -------------------------------
  1231     05  FORM4L PIC S9(0004) COMP.
  1232     05  FORM4F PIC  X(0001).
  1233     05  FILLER REDEFINES FORM4F.
  1234         10  FORM4A PIC  X(0001).
  1235     05  FORM4I PIC  X(0004).
  1236*    -------------------------------
  1237     05  TO4L PIC S9(0004) COMP.
  1238     05  TO4F PIC  X(0001).
  1239     05  FILLER REDEFINES TO4F.
  1240         10  TO4A PIC  X(0001).
  1241     05  TO4I PIC  X(0008).
  1242*    -------------------------------
  1243     05  ARCH4L PIC S9(0004) COMP.
  1244     05  ARCH4F PIC  X(0001).
  1245     05  FILLER REDEFINES ARCH4F.
  1246         10  ARCH4A PIC  X(0001).
  1247     05  ARCH4I PIC  X(0008).
  1248*    -------------------------------
  1249     05  TRLR4L PIC S9(0004) COMP.
  1250     05  TRLR4F PIC  X(0001).
  1251     05  FILLER REDEFINES TRLR4F.
  1252         10  TRLR4A PIC  X(0001).
  1253     05  TRLR4I PIC  X(0004).
  1254*    -------------------------------
  1255     05  TYPE4L PIC S9(0004) COMP.
  1256     05  TYPE4F PIC  X(0001).
  1257     05  FILLER REDEFINES TYPE4F.
  1258         10  TYPE4A PIC  X(0001).
  1259     05  TYPE4I PIC  X(0001).
  1260*    -------------------------------
  1261     05  RE4L PIC S9(0004) COMP.
  1262     05  RE4F PIC  X(0001).
  1263     05  FILLER REDEFINES RE4F.
  1264         10  RE4A PIC  X(0001).
  1265     05  RE4I PIC  X(0070).
  1266*    -------------------------------
  1267     05  URECDTEL PIC S9(0004) COMP.
  1268     05  URECDTEF PIC  X(0001).
  1269     05  FILLER REDEFINES URECDTEF.
  1270         10  URECDTEA PIC  X(0001).
  1271     05  URECDTEI PIC  X(0008).
  1272*    -------------------------------
  1273     05  USENTL PIC S9(0004) COMP.
  1274     05  USENTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  28
* EL162.cbl
  1275     05  FILLER REDEFINES USENTF.
  1276         10  USENTA PIC  X(0001).
  1277     05  USENTI PIC  X(0008).
  1278*    -------------------------------
  1279     05  UBYL PIC S9(0004) COMP.
  1280     05  UBYF PIC  X(0001).
  1281     05  FILLER REDEFINES UBYF.
  1282         10  UBYA PIC  X(0001).
  1283     05  UBYI PIC  X(0004).
  1284*    -------------------------------
  1285     05  UFORML PIC S9(0004) COMP.
  1286     05  UFORMF PIC  X(0001).
  1287     05  FILLER REDEFINES UFORMF.
  1288         10  UFORMA PIC  X(0001).
  1289     05  UFORMI PIC  X(0004).
  1290*    -------------------------------
  1291     05  UREL PIC S9(0004) COMP.
  1292     05  UREF PIC  X(0001).
  1293     05  FILLER REDEFINES UREF.
  1294         10  UREA PIC  X(0001).
  1295     05  UREI PIC  X(0070).
  1296*    -------------------------------
  1297     05  ADDR1L PIC S9(0004) COMP.
  1298     05  ADDR1F PIC  X(0001).
  1299     05  FILLER REDEFINES ADDR1F.
  1300         10  ADDR1A PIC  X(0001).
  1301     05  ADDR1I PIC  X(0030).
  1302*    -------------------------------
  1303     05  ADDR2L PIC S9(0004) COMP.
  1304     05  ADDR2F PIC  X(0001).
  1305     05  FILLER REDEFINES ADDR2F.
  1306         10  ADDR2A PIC  X(0001).
  1307     05  ADDR2I PIC  X(0030).
  1308*    -------------------------------
  1309     05  ADDR3L PIC S9(0004) COMP.
  1310     05  ADDR3F PIC  X(0001).
  1311     05  FILLER REDEFINES ADDR3F.
  1312         10  ADDR3A PIC  X(0001).
  1313     05  ADDR3I PIC  X(0030).
  1314*    -------------------------------
  1315     05  ADDR4L PIC S9(0004) COMP.
  1316     05  ADDR4F PIC  X(0001).
  1317     05  FILLER REDEFINES ADDR4F.
  1318         10  ADDR4A PIC  X(0001).
  1319     05  ADDR4I PIC  X(0030).
  1320*    -------------------------------
  1321     05  ZIPL PIC S9(0004) COMP.
  1322     05  ZIPF PIC  X(0001).
  1323     05  FILLER REDEFINES ZIPF.
  1324         10  ZIPA PIC  X(0001).
  1325     05  ZIPI PIC  X(0010).
  1326*    -------------------------------
  1327     05  PHONEL PIC S9(0004) COMP.
  1328     05  PHONEF PIC  X(0001).
  1329     05  FILLER REDEFINES PHONEF.
  1330         10  PHONEA PIC  X(0001).
  1331     05  PHONEI PIC  X(0012).
  1332*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  29
* EL162.cbl
  1333     05  TRLRL PIC S9(0004) COMP.
  1334     05  TRLRF PIC  X(0001).
  1335     05  FILLER REDEFINES TRLRF.
  1336         10  TRLRA PIC  X(0001).
  1337     05  TRLRI PIC  X(0004).
  1338*    -------------------------------
  1339     05  ERRMSG1L PIC S9(0004) COMP.
  1340     05  ERRMSG1F PIC  X(0001).
  1341     05  FILLER REDEFINES ERRMSG1F.
  1342         10  ERRMSG1A PIC  X(0001).
  1343     05  ERRMSG1I PIC  X(0072).
  1344*    -------------------------------
  1345     05  ENTERPFL PIC S9(0004) COMP.
  1346     05  ENTERPFF PIC  X(0001).
  1347     05  FILLER REDEFINES ENTERPFF.
  1348         10  ENTERPFA PIC  X(0001).
  1349     05  ENTERPFI PIC  99.
  1350*    -------------------------------
  1351     05  PF4KEYL PIC S9(0004) COMP.
  1352     05  PF4KEYF PIC  X(0001).
  1353     05  FILLER REDEFINES PF4KEYF.
  1354         10  PF4KEYA PIC  X(0001).
  1355     05  PF4KEYI PIC  X(0015).
  1356*    -------------------------------
  1357     05  PF5KEYL PIC S9(0004) COMP.
  1358     05  PF5KEYF PIC  X(0001).
  1359     05  FILLER REDEFINES PF5KEYF.
  1360         10  PF5KEYA PIC  X(0001).
  1361     05  PF5KEYI PIC  X(0014).
  1362 01  EL162AO REDEFINES EL162AI.
  1363     05  FILLER            PIC  X(0012).
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(0003).
  1366     05  RUNDTEO PIC  X(0008).
  1367*    -------------------------------
  1368     05  FILLER            PIC  X(0003).
  1369     05  RUNTIMEO PIC  99.99.
  1370*    -------------------------------
  1371     05  FILLER            PIC  X(0003).
  1372     05  CLAIMNOO PIC  X(0007).
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(0003).
  1375     05  TYPEO PIC  X(0006).
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  CARRO PIC  X(0001).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  CERTNOO PIC  X(0011).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  LASTNMEO PIC  X(0015).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  FILEO PIC  X(0004).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  RECDTE1O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  30
* EL162.cbl
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  STOPDT1O PIC  X(0008).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  SENT1O PIC  X(0008).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  BY1O PIC  X(0004).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  RESEND1O PIC  X(0008).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  FOLLOW1O PIC  X(0008).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  FORM1O PIC  X(0004).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  TO1O PIC  X(0008).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  ARCH1O PIC  X(0008).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  TRLR1O PIC  9999.
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  TYPE1O PIC  X(0001).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  RE1O PIC  X(0070).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  RECDTE2O PIC  X(0008).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  STOPDT2O PIC  X(0008).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  SENT2O PIC  X(0008).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  BY2O PIC  X(0004).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  RESEND2O PIC  X(0008).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  FOLLOW2O PIC  X(0008).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  FORM2O PIC  X(0004).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  TO2O PIC  X(0008).
  1448*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  31
* EL162.cbl
  1449     05  FILLER            PIC  X(0003).
  1450     05  ARCH2O PIC  X(0008).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  TRLR2O PIC  9999.
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  TYPE2O PIC  X(0001).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  RE2O PIC  X(0070).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  RECDTE3O PIC  X(0008).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  STOPDT3O PIC  X(0008).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  SENT3O PIC  X(0008).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  BY3O PIC  X(0004).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  RESEND3O PIC  X(0008).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  FOLLOW3O PIC  X(0008).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  FORM3O PIC  X(0004).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  TO3O PIC  X(0008).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  ARCH3O PIC  X(0008).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  TRLR3O PIC  9999.
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  TYPE3O PIC  X(0001).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  RE3O PIC  X(0070).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  RECDTE4O PIC  X(0008).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  STOPDT4O PIC  X(0008).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  SENT4O PIC  X(0008).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  32
* EL162.cbl
  1507     05  BY4O PIC  X(0004).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  RESEND4O PIC  X(0008).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  FOLLOW4O PIC  X(0008).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  FORM4O PIC  X(0004).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  TO4O PIC  X(0008).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  ARCH4O PIC  X(0008).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  TRLR4O PIC  9999.
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  TYPE4O PIC  X(0001).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  RE4O PIC  X(0070).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  URECDTEO PIC  99B99B99.
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  USENTO PIC  99B99B99.
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  UBYO PIC  X(0004).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  UFORMO PIC  X(0004).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  UREO PIC  X(0070).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  ADDR1O PIC  X(0030).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  ADDR2O PIC  X(0030).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  ADDR3O PIC  X(0030).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  ADDR4O PIC  X(0030).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  ZIPO PIC  X(0010).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  PHONEO PIC  999B999B9999.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  33
* EL162.cbl
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  TRLRO PIC  9999.
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  ERRMSG1O PIC  X(0072).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  ENTERPFO PIC  X(0002).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  PF4KEYO PIC  X(0015).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  PF5KEYO PIC  X(0014).
  1580*    -------------------------------
  1581
  1582 01  MAP-REDEF REDEFINES EL162AI.
  1583     12  FILLER              PIC X(93).
  1584     12  TRL-LINES.
  1585       14  TRAILER-LINES  OCCURS 4 TIMES INDEXED BY SC-INDX.
  1586         16  SC-RECL         PIC S9(4)  COMP.
  1587         16  SC-RECA         PIC X.
  1588         16  SC-REC          PIC X(8).
  1589         16  SC-REC-O REDEFINES SC-REC PIC 99B99B99.
  1590         16  SC-STOPL        PIC S9(4)  COMP.
  1591         16  SC-STOPA        PIC X.
  1592         16  SC-STOP         PIC X(8).
  1593         16  SC-STOP-O REDEFINES SC-STOP PIC 99B99B99.
  1594         16  FILLER          PIC X(3).
  1595         16  SC-SENT         PIC X(8).
  1596         16  FILLER          PIC X(3).
  1597         16  SC-BY           PIC X(4).
  1598         16  FILLER          PIC X(3).
  1599         16  SC-RESEND       PIC X(8).
  1600         16  FILLER          PIC X(3).
  1601         16  SC-FOLLOWUP     PIC X(8).
  1602         16  FILLER          PIC X(3).
  1603         16  SC-FORM         PIC X(4).
  1604         16  FILLER          PIC X(3).
  1605         16  SC-TO           PIC X(8).
  1606         16  FILLER          PIC X(3).
  1607         16  SC-ARCHIVE      PIC X(8).
  1608         16  FILLER          PIC X(3).
  1609         16  SC-TRLRNO       PIC 9(4).
  1610         16  FILLER          PIC X(3).
  1611         16  SC-TYPE         PIC X.
  1612         16  FILLER          PIC X(3).
  1613         16  SC-REASON       PIC X(70).
  1614
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  34
* EL162.cbl
  1616****************************************************************
  1617*
  1618* Copyright (c) 2007 by Clerity Solutions, Inc.
  1619* All rights reserved.
  1620*
  1621****************************************************************
  1622 01  DFHEIV.
  1623   02  DFHEIV0               PIC X(35).
  1624   02  DFHEIV1               PIC X(08).
  1625   02  DFHEIV2               PIC X(08).
  1626   02  DFHEIV3               PIC X(08).
  1627   02  DFHEIV4               PIC X(06).
  1628   02  DFHEIV5               PIC X(04).
  1629   02  DFHEIV6               PIC X(04).
  1630   02  DFHEIV7               PIC X(02).
  1631   02  DFHEIV8               PIC X(02).
  1632   02  DFHEIV9               PIC X(01).
  1633   02  DFHEIV10              PIC S9(7) COMP-3.
  1634   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1635   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1636   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1637   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1638   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1639   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1640   02  DFHEIV17              PIC X(04).
  1641   02  DFHEIV18              PIC X(04).
  1642   02  DFHEIV19              PIC X(04).
  1643   02  DFHEIV20              USAGE IS POINTER.
  1644   02  DFHEIV21              USAGE IS POINTER.
  1645   02  DFHEIV22              USAGE IS POINTER.
  1646   02  DFHEIV23              USAGE IS POINTER.
  1647   02  DFHEIV24              USAGE IS POINTER.
  1648   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1649   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1651   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1652   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1653   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1654   02  FILLER                PIC X(02).
  1655   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1656   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1657   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1658   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1659   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1660 LINKAGE  SECTION.
  1661*****************************************************************
  1662*                                                               *
  1663* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1664* All rights reserved.                                          *
  1665*                                                               *
  1666*****************************************************************
  1667 01  dfheiblk.
  1668     02  eibtime          pic s9(7) comp-3.
  1669     02  eibdate          pic s9(7) comp-3.
  1670     02  eibtrnid         pic x(4).
  1671     02  eibtaskn         pic s9(7) comp-3.
  1672     02  eibtrmid         pic x(4).
  1673     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  35
* EL162.cbl
  1674     02  eibcposn         pic s9(4) comp.
  1675     02  eibcalen         pic s9(4) comp.
  1676     02  eibaid           pic x(1).
  1677     02  eibfiller1       pic x(1).
  1678     02  eibfn            pic x(2).
  1679     02  eibfiller2       pic x(2).
  1680     02  eibrcode         pic x(6).
  1681     02  eibfiller3       pic x(2).
  1682     02  eibds            pic x(8).
  1683     02  eibreqid         pic x(8).
  1684     02  eibrsrce         pic x(8).
  1685     02  eibsync          pic x(1).
  1686     02  eibfree          pic x(1).
  1687     02  eibrecv          pic x(1).
  1688     02  eibsend          pic x(1).
  1689     02  eibatt           pic x(1).
  1690     02  eibeoc           pic x(1).
  1691     02  eibfmh           pic x(1).
  1692     02  eibcompl         pic x(1).
  1693     02  eibsig           pic x(1).
  1694     02  eibconf          pic x(1).
  1695     02  eiberr           pic x(1).
  1696     02  eibrldbk         pic x(1).
  1697     02  eiberrcd         pic x(4).
  1698     02  eibsynrb         pic x(1).
  1699     02  eibnodat         pic x(1).
  1700     02  eibfiller5       pic x(2).
  1701     02  eibresp          pic 9(09) comp.
  1702     02  eibresp2         pic 9(09) comp.
  1703     02  dfheigdj         pic s9(4) comp.
  1704     02  dfheigdk         pic s9(4) comp.
  1705
  1706 01  DFHCOMMAREA             PIC X(1024).
  1707
  1708*01 PARMLIST .
  1709*    02  FILLER              PIC S9(8)   COMP.
  1710*    02  CLAM-POINTER        PIC S9(8)   COMP.
  1711*    02  ACTV-POINTER        PIC S9(8)   COMP.
  1712*    02  ACCT-POINTER        PIC S9(8)   COMP.
  1713
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  36
* EL162.cbl
  1715*                            COPY ELCMSTR.
  1716******************************************************************
  1717*                                                                *
  1718*                            ELCMSTR.                            *
  1719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1720*                            VMOD=2.012                          *
  1721*                                                                *
  1722*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1723*                                                                *
  1724*   FILE TYPE = VSAM,KSDS                                        *
  1725*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1726*                                                                *
  1727*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1728*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1729*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1730*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1731*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1732*                                                 RKP=75,LEN=21  *
  1733*                                                                *
  1734*   **** NOTE ****                                               *
  1735*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1736*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1737*                                                                *
  1738*   LOG = YES                                                    *
  1739*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1740******************************************************************
  1741*                   C H A N G E   L O G
  1742*
  1743* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1744*-----------------------------------------------------------------
  1745*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1746* EFFECTIVE    NUMBER
  1747*-----------------------------------------------------------------
  1748* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1749* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1750* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1751* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1752* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1753******************************************************************
  1754 01  CLAIM-MASTER.
  1755     12  CL-RECORD-ID                PIC XX.
  1756         88  VALID-CL-ID         VALUE 'CL'.
  1757
  1758     12  CL-CONTROL-PRIMARY.
  1759         16  CL-COMPANY-CD           PIC X.
  1760         16  CL-CARRIER              PIC X.
  1761         16  CL-CLAIM-NO             PIC X(7).
  1762         16  CL-CERT-NO.
  1763             20  CL-CERT-PRIME       PIC X(10).
  1764             20  CL-CERT-SFX         PIC X.
  1765
  1766     12  CL-CONTROL-BY-NAME.
  1767         16  CL-COMPANY-CD-A1        PIC X.
  1768         16  CL-INSURED-LAST-NAME    PIC X(15).
  1769         16  CL-INSURED-NAME.
  1770             20  CL-INSURED-1ST-NAME PIC X(12).
  1771             20  CL-INSURED-MID-INIT PIC X.
  1772
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  37
* EL162.cbl
  1773     12  CL-CONTROL-BY-SSN.
  1774         16  CL-COMPANY-CD-A2        PIC X.
  1775         16  CL-SOC-SEC-NO.
  1776             20  CL-SSN-STATE        PIC XX.
  1777             20  CL-SSN-ACCOUNT      PIC X(6).
  1778             20  CL-SSN-LN3          PIC X(3).
  1779
  1780     12  CL-CONTROL-BY-CERT-NO.
  1781         16  CL-COMPANY-CD-A4        PIC X.
  1782         16  CL-CERT-NO-A4.
  1783             20  CL-CERT-A4-PRIME    PIC X(10).
  1784             20  CL-CERT-A4-SFX      PIC X.
  1785
  1786     12  CL-CONTROL-BY-CCN.
  1787         16  CL-COMPANY-CD-A5        PIC X.
  1788         16  CL-CCN-A5.
  1789             20  CL-CCN.
  1790                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1791                 24  CL-CCN-PRIME-A5 PIC X(12).
  1792             20  CL-CCN-FILLER-A5    PIC X(4).
  1793
  1794     12  CL-INSURED-PROFILE-DATA.
  1795         16  CL-INSURED-BIRTH-DT     PIC XX.
  1796         16  CL-INSURED-SEX-CD       PIC X.
  1797             88  INSURED-IS-MALE        VALUE 'M'.
  1798             88  INSURED-IS-FEMALE      VALUE 'F'.
  1799             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1800         16  CL-INSURED-OCC-CD       PIC X(6).
  1801         16  FILLER                  PIC X(5).
  1802
  1803     12  CL-PROCESSING-INFO.
  1804         16  CL-PROCESSOR-ID         PIC X(4).
  1805         16  CL-CLAIM-STATUS         PIC X.
  1806             88  CLAIM-IS-OPEN          VALUE 'O'.
  1807             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1808         16  CL-CLAIM-TYPE           PIC X.
  1809*            88  AH-CLAIM               VALUE 'A'.
  1810*            88  LIFE-CLAIM             VALUE 'L'.
  1811*            88  PROPERTY-CLAIM         VALUE 'P'.
  1812*            88  IUI-CLAIM              VALUE 'I'.
  1813*            88  GAP-CLAIM              VALUE 'G'.
  1814*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1815         16  CL-CLAIM-PREM-TYPE      PIC X.
  1816             88  SINGLE-PREMIUM         VALUE '1'.
  1817             88  O-B-COVERAGE           VALUE '2'.
  1818             88  OPEN-END-COVERAGE      VALUE '3'.
  1819         16  CL-INCURRED-DT          PIC XX.
  1820         16  CL-REPORTED-DT          PIC XX.
  1821         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1822         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1823         16  CL-LAST-PMT-DT          PIC XX.
  1824         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1825         16  CL-PAID-THRU-DT         PIC XX.
  1826         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1827         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1828         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1829         16  CL-PMT-CALC-METHOD      PIC X.
  1830             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  38
* EL162.cbl
  1831             88  CL-365-DAY-YR          VALUE '2'.
  1832             88  CL-FULL-MONTHS         VALUE '3'.
  1833         16  CL-CAUSE-CD             PIC X(6).
  1834
  1835         16  CL-PRIME-CERT-NO.
  1836             20  CL-PRIME-CERT-PRIME PIC X(10).
  1837             20  CL-PRIME-CERT-SFX   PIC X.
  1838
  1839         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1840             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1841             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1842
  1843         16  CL-MICROFILM-NO         PIC X(10).
  1844         16  FILLER REDEFINES CL-MICROFILM-NO.
  1845             20  CL-BENEFIT-PERIOD   PIC 99.
  1846             20  FILLER              PIC X(8).
  1847         16  CL-PROG-FORM-TYPE       PIC X.
  1848         16  CL-LAST-ADD-ON-DT       PIC XX.
  1849
  1850         16  CL-LAST-REOPEN-DT       PIC XX.
  1851         16  CL-LAST-CLOSE-DT        PIC XX.
  1852         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1853             88  FINAL-PAID             VALUE '1'.
  1854             88  CLAIM-DENIED           VALUE '2'.
  1855             88  AUTO-CLOSE             VALUE '3'.
  1856             88  MANUAL-CLOSE           VALUE '4'.
  1857             88  BENEFITS-CHANGED       VALUE 'C'.
  1858             88  SETUP-ERRORS           VALUE 'E'.
  1859         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1860         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1861         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1862             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1863         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1864         16  FILLER                  PIC X.
  1865
  1866     12  CL-CERTIFICATE-DATA.
  1867         16  CL-CERT-ORIGIN          PIC X.
  1868             88  CERT-WAS-ONLINE        VALUE '1'.
  1869             88  CERT-WAS-CREATED       VALUE '2'.
  1870             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1871         16  CL-CERT-KEY-DATA.
  1872             20  CL-CERT-CARRIER     PIC X.
  1873             20  CL-CERT-GROUPING    PIC X(6).
  1874             20  CL-CERT-STATE       PIC XX.
  1875             20  CL-CERT-ACCOUNT.
  1876                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1877                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1878             20  CL-CERT-EFF-DT      PIC XX.
  1879
  1880     12  CL-STATUS-CONTROLS.
  1881         16  CL-PRIORITY-CD          PIC X.
  1882             88  CONFIDENTIAL-DATA      VALUE '8'.
  1883             88  HIGHEST-PRIORITY       VALUE '9'.
  1884         16  CL-SUPV-ATTN-CD         PIC X.
  1885             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1886             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1887         16  CL-PURGED-DT            PIC XX.
  1888         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  39
* EL162.cbl
  1889         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1890         16  CL-NEXT-RESEND-DT       PIC XX.
  1891         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1892         16  CL-CRITICAL-PERIOD      PIC 99.
  1893*        16  FILLER                  PIC XX.
  1894         16  CL-LAST-MAINT-DT        PIC XX.
  1895         16  CL-LAST-MAINT-USER      PIC X(4).
  1896         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1897         16  CL-LAST-MAINT-TYPE      PIC X.
  1898             88  CLAIM-SET-UP           VALUE ' '.
  1899             88  PAYMENT-MADE           VALUE '1'.
  1900             88  LETTER-SENT            VALUE '2'.
  1901             88  MASTER-WAS-ALTERED     VALUE '3'.
  1902             88  MASTER-WAS-RESTORED    VALUE '4'.
  1903             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1904             88  FILE-CONVERTED         VALUE '6'.
  1905             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1906             88  ERROR-CORRECTION       VALUE 'E'.
  1907         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1908         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1909         16  CL-BENEFICIARY          PIC X(10).
  1910         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1911         16  CL-DENIAL-TYPE          PIC X.
  1912             88  CL-TYPE-DENIAL          VALUE '1'.
  1913             88  CL-TYPE-RESCISSION      VALUE '2'.
  1914             88  CL-TYPE-REFORMATION     VALUE '3'.
  1915             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1916             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1917         16  filler                  pic x(5).
  1918*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1919*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1920*        16  CL-RTW-DT               PIC XX.
  1921
  1922     12  CL-TRAILER-CONTROLS.
  1923         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1924             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1925             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1926             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1927         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1928         16  FILLER                  PIC XX.
  1929         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1930         16  CL-ADDRESS-TRAILER-CNT.
  1931             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1932                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1933             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1934                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1935             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1936                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1937             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1938                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1939             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1940                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1941             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1942                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1943             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1944                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1945
  1946     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  40
* EL162.cbl
  1947         16  CL-CV-REFNO-PRIME       PIC X(18).
  1948         16  CL-CV-REFNO-SFX         PIC XX.
  1949
  1950     12  CL-FILE-LOCATION            PIC X(4).
  1951
  1952     12  CL-PROCESS-ERRORS.
  1953         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1954             88  NO-FATAL-ERRORS        VALUE ZERO.
  1955         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1956             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1957
  1958     12  CL-PRODUCT-CD               PIC X.
  1959
  1960     12  CL-CURRENT-KEY-DATA.
  1961         16  CL-CURRENT-CARRIER      PIC X.
  1962         16  CL-CURRENT-GROUPING     PIC X(6).
  1963         16  CL-CURRENT-STATE        PIC XX.
  1964         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1965
  1966     12  CL-ASSOCIATES               PIC X.
  1967         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1968         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1969         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1970         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1971
  1972     12  CL-ACTIVITY-CODE            PIC 99.
  1973     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1974     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1975
  1976     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1977     12  CL-LAG-REPORT-CODE          PIC 9.
  1978     12  CL-LOAN-TYPE                PIC XX.
  1979     12  CL-LEGAL-STATE              PIC XX.
  1980
  1981     12  CL-YESNOSW                  PIC X.
  1982     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1983         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1984         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1985         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1986     12  cl-insured-type             pic x.
  1987         88  cl-claim-on-primary         value 'P'.
  1988         88  cl-claim-on-co-borrower     value 'C'.
  1989     12  cl-benefit-expiration-dt    PIC XX.
  1990
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  41
* EL162.cbl
  1992*                            COPY ELCTRLR.
  1993******************************************************************
  1994*                                                                *
  1995*                            ELCTRLR.                            *
  1996*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1997*                            VMOD=2.014                          *
  1998*                                                                *
  1999*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  2000*                                                                *
  2001*   FILE TYPE = VSAM,KSDS                                        *
  2002*   RECORD SIZE = 200    RECFORM = FIXED                         *
  2003*                                                                *
  2004*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  2005*       ALTERNATE INDEX = NONE                                   *
  2006*                                                                *
  2007*   LOG = YES                                                    *
  2008*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2009******************************************************************
  2010*                   C H A N G E   L O G
  2011*
  2012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2013*-----------------------------------------------------------------
  2014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2015* EFFECTIVE    NUMBER
  2016*-----------------------------------------------------------------
  2017* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2018* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  2019* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  2020* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  2021* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  2022* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  2023* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  2024* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  2025* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  2026* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  2027* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  2028* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  2029* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  2030* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  2031* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  2032* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2033* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  2034* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  2035* 040814    2014030500002  AJRA  ADD ICD CODES
  2036* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2037******************************************************************
  2038 01  ACTIVITY-TRAILERS.
  2039     12  AT-RECORD-ID                    PIC XX.
  2040         88  VALID-AT-ID                       VALUE 'AT'.
  2041
  2042     12  AT-CONTROL-PRIMARY.
  2043         16  AT-COMPANY-CD               PIC X.
  2044         16  AT-CARRIER                  PIC X.
  2045         16  AT-CLAIM-NO                 PIC X(7).
  2046         16  AT-CERT-NO.
  2047             20  AT-CERT-PRIME           PIC X(10).
  2048             20  AT-CERT-SFX             PIC X.
  2049         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  42
* EL162.cbl
  2050             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  2051             88  AT-LAST-TRL-AVAIL            VALUE +100.
  2052             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  2053             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  2054             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  2055             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  2056             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  2057             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  2058             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  2059             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  2060             88  AT-DIAGNOSIS-TRL             VALUE +90.
  2061             88  AT-BENEFICIARY-TRL           VALUE +91.
  2062             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  2063             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  2064             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  2065             88  AT-ERROR-MSGS-TRL            VALUE +95.
  2066
  2067     12  AT-TRAILER-TYPE                 PIC X.
  2068         88  RESERVE-EXPENSE-TR               VALUE '1'.
  2069         88  PAYMENT-TR                       VALUE '2'.
  2070         88  AUTO-PAY-TR                      VALUE '3'.
  2071         88  CORRESPONDENCE-TR                VALUE '4'.
  2072         88  ADDRESS-TR                       VALUE '5'.
  2073         88  GENERAL-INFO-TR                  VALUE '6'.
  2074         88  AUTO-PROMPT-TR                   VALUE '7'.
  2075         88  DENIAL-TR                        VALUE '8'.
  2076         88  INCURRED-CHG-TR                  VALUE '9'.
  2077         88  FORM-CONTROL-TR                  VALUE 'A'.
  2078
  2079     12  AT-RECORDED-DT                  PIC XX.
  2080     12  AT-RECORDED-BY                  PIC X(4).
  2081     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  2082
  2083     12  AT-TRAILER-BODY                 PIC X(165).
  2084
  2085     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  2086         16  AT-RESERVE-CONTROLS.
  2087             20  AT-MANUAL-SW            PIC X.
  2088                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  2089             20  AT-FUTURE-SW            PIC X.
  2090                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  2091             20  AT-PTC-SW               PIC X.
  2092                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  2093             20  AT-IBNR-SW              PIC X.
  2094                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  2095             20  AT-PTC-LF-SW            PIC X.
  2096                 88  AT-LF-PTC-USED          VALUE '1'.
  2097             20  AT-CDT-ACCESS-METHOD    PIC X.
  2098                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  2099                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  2100                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  2101             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  2102         16  AT-LAST-COMPUTED-DT         PIC XX.
  2103         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  2104         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  2105         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  2106         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2107         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  43
* EL162.cbl
  2108         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  2109         16  AT-EXPENSE-CONTROLS.
  2110             20  AT-EXPENSE-METHOD       PIC X.
  2111                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  2112                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  2113                 88  PERCENT-OF-PMT           VALUE '3'.
  2114                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  2115             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  2116             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  2117         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  2118         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  2119
  2120         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  2121         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  2122
  2123*        16  FILLER                      PIC X(53).
  2124         16  FILLER                      PIC X(47).
  2125
  2126         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  2127         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  2128
  2129         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  2130             20  AT-OPEN-CLOSE-DATE      PIC XX.
  2131             20  AT-OPEN-CLOSE-TYPE      PIC X.
  2132*                    C = CLOSED
  2133*                    O = OPEN
  2134             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  2135*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  2136
  2137     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  2138         16  AT-PAYMENT-TYPE             PIC X.
  2139             88  PARTIAL-PAYMENT                VALUE '1'.
  2140             88  FINAL-PAYMENT                  VALUE '2'.
  2141             88  LUMP-SUM-PAYMENT               VALUE '3'.
  2142             88  ADDITIONAL-PAYMENT             VALUE '4'.
  2143             88  CHARGEABLE-EXPENSE             VALUE '5'.
  2144             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  2145             88  VOIDED-PAYMENT                 VALUE '9'.
  2146             88  TRANSFER                       VALUE 'T'.
  2147             88  LIFE-INTEREST                  VALUE 'I'.
  2148
  2149         16  AT-CLAIM-TYPE               PIC X.
  2150             88  PAID-FOR-AH                    VALUE 'A'.
  2151             88  PAID-FOR-LIFE                  VALUE 'L'.
  2152             88  PAID-FOR-IUI                   VALUE 'I'.
  2153             88  PAID-FOR-GAP                   VALUE 'G'.
  2154             88  PAID-FOR-FAM                   VALUE 'F'.
  2155         16  AT-CLAIM-PREM-TYPE          PIC X.
  2156             88  AT-SINGLE-PREMIUM              VALUE '1'.
  2157             88  AT-O-B-COVERAGE                VALUE '2'.
  2158             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  2159         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  2160         16  AT-CHECK-NO                 PIC X(7).
  2161         16  AT-PAID-FROM-DT             PIC XX.
  2162         16  AT-PAID-THRU-DT             PIC XX.
  2163         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  2164         16  FILLER                      PIC X.
  2165         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  44
* EL162.cbl
  2166         16  AT-PAYMENT-ORIGIN           PIC X.
  2167             88  ONLINE-MANUAL-PMT              VALUE '1'.
  2168             88  ONLINE-AUTO-PMT                VALUE '2'.
  2169             88  OFFLINE-PMT                    VALUE '3'.
  2170         16  AT-CHECK-WRITTEN-DT         PIC XX.
  2171         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  2172         16  AT-VOID-DATA.
  2173             20  AT-VOID-DT              PIC XX.
  2174*00144       20  AT-VOID-REASON          PIC X(30).
  2175             20  AT-VOID-REASON          PIC X(26).
  2176         16  AT-PMT-APPROVED-BY          PIC X(04).
  2177         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  2178         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  2179         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  2180                                         PIC S99V9(5)  COMP-3.
  2181         16  AT-CREDIT-INTERFACE.
  2182             20  AT-PMT-SELECT-DT        PIC XX.
  2183                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  2184             20  AT-PMT-ACCEPT-DT        PIC XX.
  2185                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  2186             20  AT-VOID-SELECT-DT       PIC XX.
  2187                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  2188             20  AT-VOID-ACCEPT-DT       PIC XX.
  2189                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  2190
  2191         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  2192                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  2193                 88  CONVERSION-PAYMENT           VALUE +99999999.
  2194         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  2195
  2196         16  AT-FORCE-CONTROL            PIC X.
  2197             88  PAYMENT-WAS-FORCED           VALUE '1'.
  2198         16  AT-PREV-LAST-PMT-DT         PIC XX.
  2199         16  AT-PREV-PAID-THRU-DT        PIC XX.
  2200         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2201         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  2202         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  2203         16  AT-BENEFIT-TYPE             PIC X.
  2204
  2205         16  AT-EXPENSE-TYPE             PIC X.
  2206         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  2207
  2208         16  AT-PAYEE-TYPE-CD.
  2209             20  AT-PAYEE-TYPE           PIC X.
  2210                 88  INSURED-PAID           VALUE 'I'.
  2211                 88  BENEFICIARY-PAID       VALUE 'B'.
  2212                 88  ACCOUNT-PAID           VALUE 'A'.
  2213                 88  OTHER-1-PAID           VALUE 'O'.
  2214                 88  OTHER-2-PAID           VALUE 'Q'.
  2215                 88  DOCTOR-PAID            VALUE 'P'.
  2216                 88  EMPLOYER-PAID          VALUE 'E'.
  2217             20  AT-PAYEE-SEQ            PIC X.
  2218
  2219         16  AT-CASH-PAYMENT             PIC X.
  2220         16  AT-GROUPED-PAYMENT          PIC X.
  2221         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  2222         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  2223         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  45
* EL162.cbl
  2224         16  AT-VOID-TYPE                PIC X.
  2225             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  2226             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  2227         16  AT-AIG-UNEMP-IND            PIC X.
  2228             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  2229         16  AT-ASSOCIATES               PIC X.
  2230             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  2231             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  2232
  2233         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  2234         16  AT-CV-PMT-CODE              PIC X.
  2235             88  FULL-DEATH-PAYMENT         VALUE '1'.
  2236             88  HALF-DEATH-PAYMENT         VALUE '2'.
  2237             88  FULL-ADD-PAYMENT           VALUE '3'.
  2238             88  HALF-ADD-PAYMENT           VALUE '4'.
  2239             88  FULL-RIDER-PAYMENT         VALUE '5'.
  2240             88  HALF-RIDER-PAYMENT         VALUE '6'.
  2241             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  2242             88  ADDL-PAYMENT               VALUE '8'.
  2243
  2244         16  AT-EOB-CODE1                PIC XXX.
  2245         16  AT-EOB-CODE2                PIC XXX.
  2246         16  AT-EOB-CODE3                PIC XXX.
  2247         16  FILLER REDEFINES AT-EOB-CODE3.
  2248             20  AT-PRINT-CLM-FORM       PIC X.
  2249             20  AT-PRINT-SURVEY         PIC X.
  2250             20  AT-SPECIAL-RELEASE      PIC X.
  2251         16  AT-EOB-CODE4                PIC XXX.
  2252         16  FILLER REDEFINES AT-EOB-CODE4.
  2253             20  AT-INT-PMT-SELECT-DT    PIC XX.
  2254             20  FILLER                  PIC X.
  2255         16  AT-EOB-CODE5                PIC XXX.
  2256         16  FILLER REDEFINES AT-EOB-CODE5.
  2257             20  AT-PMT-PROOF-DT         PIC XX.
  2258             20  FILLER                  PIC X.
  2259
  2260         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  2261             88  AT-PRINT-EOB            VALUE 'Y'.
  2262
  2263         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  2264         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  2265
  2266     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  2267         16  AT-SCHEDULE-START-DT        PIC XX.
  2268         16  AT-SCHEDULE-END-DT          PIC XX.
  2269         16  AT-TERMINATED-DT            PIC XX.
  2270         16  AT-LAST-PMT-TYPE            PIC X.
  2271             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  2272             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  2273         16  AT-FIRST-PMT-DATA.
  2274             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2275             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  2276             20  AT-1ST-PAY-THRU-DT      PIC XX.
  2277         16  AT-REGULAR-PMT-DATA.
  2278             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  2279             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  2280             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  2281         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  46
* EL162.cbl
  2282             20  AT-AUTO-PAYEE-TYPE      PIC X.
  2283                 88  INSURED-PAID-AUTO      VALUE 'I'.
  2284                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  2285                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  2286                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  2287                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  2288             20  AT-AUTO-PAYEE-SEQ       PIC X.
  2289         16  AT-AUTO-PAY-DAY             PIC 99.
  2290         16  AT-AUTO-CASH                PIC X.
  2291             88  AT-CASH                      VALUE 'Y'.
  2292             88  AT-NON-CASH                  VALUE 'N'.
  2293*        16  FILLER                      PIC X(129).
  2294         16  AT-AUTO-END-LETTER          PIC X(4).
  2295         16  FILLER                      PIC X(125).
  2296
  2297         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  2298         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  2299
  2300     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  2301         16  AT-LETTER-SENT-DT           PIC XX.
  2302         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  2303         16  AT-AUTO-RE-SEND-DT          PIC XX.
  2304         16  AT-LETTER-ANSWERED-DT       PIC XX.
  2305         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  2306         16  AT-LETTER-ORIGIN            PIC X.
  2307             88  ONLINE-CREATION              VALUE '1' '3'.
  2308             88  OFFLINE-CREATION             VALUE '2' '4'.
  2309             88  NAPER-ONLINE-CREATION        VALUE '3'.
  2310             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  2311         16  AT-STD-LETTER-FORM          PIC X(4).
  2312         16  AT-REASON-TEXT              PIC X(70).
  2313         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  2314         16  AT-ADDRESEE-TYPE            PIC X.
  2315              88  INSURED-ADDRESEE            VALUE 'I'.
  2316              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  2317              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  2318              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  2319              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  2320              88  OTHER-ADDRESEE-1            VALUE 'O'.
  2321              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  2322         16  AT-ADDRESSEE-NAME           PIC X(30).
  2323         16  AT-INITIAL-PRINT-DATE       PIC XX.
  2324         16  AT-RESEND-PRINT-DATE        PIC XX.
  2325         16  AT-CORR-SOL-UNSOL           PIC X.
  2326         16  AT-LETTER-PURGED-DT         PIC XX.
  2327*
  2328*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  2329*
  2330         16  AT-CSO-REDEFINITION.
  2331             20  AT-RESEND-LETTER-FORM   PIC X(4).
  2332             20  AT-AUTO-CLOSE-IND       PIC X(1).
  2333             20  AT-LETTER-TO-BENE       PIC X(1).
  2334             20  AT-STOP-LETTER-DT       PIC X(2).
  2335             20  FILLER                  PIC X(19).
  2336*             20  FILLER                  PIC X(27).
  2337             20  AT-CSO-LETTER-STATUS    PIC X.
  2338                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  2339                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  47
* EL162.cbl
  2340                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  2341             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  2342             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  2343*
  2344*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  2345*
  2346*        16  FILLER                      PIC X(26).
  2347*
  2348*        16  AT-DMD-BSR-CODE             PIC X.
  2349*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  2350*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  2351*
  2352*        16  AT-DMD-LETTER-STATUS        PIC X.
  2353*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  2354*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  2355*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  2356*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  2357*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  2358
  2359         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  2360         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  2361
  2362     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  2363         16  AT-ADDRESS-TYPE             PIC X.
  2364             88  INSURED-ADDRESS               VALUE 'I'.
  2365             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  2366             88  ACCOUNT-ADDRESS               VALUE 'A'.
  2367             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  2368             88  EMPLOYER-ADDRESS              VALUE 'E'.
  2369             88  OTHER-ADDRESS-1               VALUE 'O'.
  2370             88  OTHER-ADDRESS-2               VALUE 'Q'.
  2371         16  AT-MAIL-TO-NAME             PIC X(30).
  2372         16  AT-ADDRESS-LINE-1           PIC X(30).
  2373         16  AT-ADDRESS-LINE-2           PIC X(30).
  2374         16  AT-CITY-STATE.
  2375             20  AT-CITY                 PIC X(28).
  2376             20  AT-STATE                PIC XX.
  2377         16  AT-ZIP.
  2378             20  AT-ZIP-CODE.
  2379                 24  AT-ZIP-1ST          PIC X.
  2380                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2381                 24  FILLER              PIC X(4).
  2382             20  AT-ZIP-PLUS4            PIC X(4).
  2383         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2384             20  AT-CAN-POSTAL-1         PIC XXX.
  2385             20  AT-CAN-POSTAL-2         PIC XXX.
  2386             20  FILLER                  PIC XXX.
  2387         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2388*         16  FILLER                      PIC X(23).
  2389         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  2390         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  2391         16  FILLER                      PIC X(13).
  2392         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2393         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  2394
  2395     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2396         16  AT-INFO-LINE-1              PIC X(60).
  2397         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  48
* EL162.cbl
  2398             20  AT-NOTE-ERROR-NO OCCURS 15
  2399                                         PIC X(4).
  2400         16  AT-INFO-LINE-2              PIC X(60).
  2401         16  FILLER REDEFINES AT-INFO-LINE-2.
  2402             20  AT-ICD-CODE-1           PIC X(8).
  2403             20  AT-ICD-CODE-2           PIC X(8).
  2404             20  FILLER                  PIC X(44).
  2405         16  AT-INFO-TRAILER-TYPE        PIC X.
  2406             88  AT-ERRORS-NOTE          VALUE 'E'.
  2407             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2408             88  AT-CALL-NOTE            VALUE 'C'.
  2409             88  AT-MAINT-NOTE           VALUE 'M'.
  2410             88  AT-CERT-CHANGE          VALUE 'X'.
  2411             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2412             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2413             88  AT-CERT-CANCELLED       VALUE 'T'.
  2414         16  AT-CALL-TYPE                PIC X.
  2415             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2416             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2417         16  AT-NOTE-CONTINUATION        PIC X.
  2418             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2419         16  AT-EOB-CODES-EXIST          PIC X.
  2420             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2421         16  FILLER                      PIC X(35).
  2422         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2423         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2424
  2425     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  2426         16  AT-PROMPT-LINE-1            PIC X(60).
  2427         16  AT-PROMPT-LINE-2            PIC X(60).
  2428         16  AT-PROMPT-START-DT          PIC XX.
  2429         16  AT-PROMPT-END-DT            PIC XX.
  2430         16  FILLER                      PIC X(35).
  2431         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2432         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2433
  2434     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2435         16  AT-DENIAL-INFO-1            PIC X(60).
  2436         16  AT-DENIAL-INFO-2            PIC X(60).
  2437         16  AT-DENIAL-DT                PIC XX.
  2438         16  AT-RETRACTION-DT            PIC XX.
  2439         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2440*         16  FILLER                      PIC X(31).
  2441         16  AT-DENIAL-PROOF-DT          PIC XX.
  2442         16  FILLER                      PIC X(29).
  2443         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2444         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2445
  2446     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2447         16  AT-OLD-INCURRED-DT          PIC XX.
  2448         16  AT-OLD-REPORTED-DT          PIC XX.
  2449         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2450         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2451         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2452         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2453         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2454         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2455         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  49
* EL162.cbl
  2456         16  AT-OLD-DIAG-CODE            PIC X(6).
  2457         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2458         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2459         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2460         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2461         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2462         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2463         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2464         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2465         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2466         16  FILLER                      PIC X(9).
  2467         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2468
  2469     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2470         16  AT-FORM-SEND-ON-DT          PIC XX.
  2471         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2472         16  AT-FORM-RE-SEND-DT          PIC XX.
  2473         16  AT-FORM-ANSWERED-DT         PIC XX.
  2474         16  AT-FORM-PRINTED-DT          PIC XX.
  2475         16  AT-FORM-REPRINT-DT          PIC XX.
  2476         16  AT-FORM-TYPE                PIC X.
  2477             88  INITIAL-FORM                  VALUE '1'.
  2478             88  PROGRESS-FORM                 VALUE '2'.
  2479         16  AT-INSTRUCT-LN-1            PIC X(28).
  2480         16  AT-INSTRUCT-LN-2            PIC X(28).
  2481         16  AT-INSTRUCT-LN-3            PIC X(28).
  2482         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2483         16  AT-FORM-ADDRESS             PIC X.
  2484             88  FORM-TO-INSURED              VALUE 'I'.
  2485             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2486             88  FORM-TO-OTHER-1              VALUE 'O'.
  2487             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2488         16  AT-RELATED-1.
  2489             20 AT-REL-CARR-1            PIC X.
  2490             20 AT-REL-CLAIM-1           PIC X(7).
  2491             20 AT-REL-CERT-1            PIC X(11).
  2492         16  AT-RELATED-2.
  2493             20 AT-REL-CARR-2            PIC X.
  2494             20 AT-REL-CLAIM-2           PIC X(7).
  2495             20 AT-REL-CERT-2            PIC X(11).
  2496         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2497         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2498         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2499         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2500         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2501         16  AT-STOP-FORM-DT             PIC X(2).
  2502
  2503         16  FILLER                      PIC X(09).
  2504         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2505         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2506******************************************************************
  2507
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  50
* EL162.cbl
  2509*                            COPY ERCACCT.
  2510******************************************************************
  2511*                                                                *
  2512*                                                                *
  2513*                            ERCACCT                             *
  2514*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2515*                            VMOD=2.031                          *
  2516*                                                                *
  2517*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2518*                                                                *
  2519*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2520*   VSAM ACCOUNT MASTER FILES.                                   *
  2521*                                                                *
  2522*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2523*                                                                *
  2524*   FILE TYPE = VSAM,KSDS                                        *
  2525*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2526*                                                                *
  2527*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2528*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2529*                                                                *
  2530*   LOG = NO                                                     *
  2531*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2532*                                                                *
  2533*                                                                *
  2534******************************************************************
  2535*                   C H A N G E   L O G
  2536*
  2537* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2538*-----------------------------------------------------------------
  2539*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2540* EFFECTIVE    NUMBER
  2541*-----------------------------------------------------------------
  2542* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2543* 092705    2005050300006  PEMA  ADD SPP LEASES
  2544* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2545* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2546* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2547* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2548* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2549******************************************************************
  2550
  2551 01  ACCOUNT-MASTER.
  2552     12  AM-RECORD-ID                      PIC XX.
  2553         88  VALID-AM-ID                      VALUE 'AM'.
  2554
  2555     12  AM-CONTROL-PRIMARY.
  2556         16  AM-COMPANY-CD                 PIC X.
  2557         16  AM-MSTR-CNTRL.
  2558             20  AM-CONTROL-A.
  2559                 24  AM-CARRIER            PIC X.
  2560                 24  AM-GROUPING.
  2561                     28 AM-GROUPING-PREFIX PIC XXX.
  2562                     28 AM-GROUPING-PRIME  PIC XXX.
  2563                 24  AM-STATE              PIC XX.
  2564                 24  AM-ACCOUNT.
  2565                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2566                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  51
* EL162.cbl
  2567             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2568                                           PIC X(19).
  2569             20  AM-CNTRL-B.
  2570                 24  AM-EXPIRATION-DT      PIC XX.
  2571                 24  FILLER                PIC X(4).
  2572             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2573                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2574
  2575     12  AM-CONTROL-BY-VAR-GRP.
  2576         16  AM-COMPANY-CD-A1              PIC X.
  2577         16  AM-VG-CARRIER                 PIC X.
  2578         16  AM-VG-GROUPING                PIC X(6).
  2579         16  AM-VG-STATE                   PIC XX.
  2580         16  AM-VG-ACCOUNT                 PIC X(10).
  2581         16  AM-VG-DATE.
  2582             20  AM-VG-EXPIRATION-DT       PIC XX.
  2583             20  FILLER                    PIC X(4).
  2584         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2585                                           PIC 9(11)      COMP-3.
  2586     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2587         16  FILLER                        PIC X(10).
  2588         16  AM-VG-KEY3.
  2589             20  AM-VG3-ACCOUNT            PIC X(10).
  2590             20  AM-VG3-EXP-DT             PIC XX.
  2591         16  FILLER                        PIC X(4).
  2592     12  AM-MAINT-INFORMATION.
  2593         16  AM-LAST-MAINT-DT              PIC XX.
  2594         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2595         16  AM-LAST-MAINT-USER            PIC X(4).
  2596         16  FILLER                        PIC XX.
  2597
  2598     12  AM-EFFECTIVE-DT                   PIC XX.
  2599     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2600
  2601     12  AM-PREV-DATES  COMP-3.
  2602         16  AM-PREV-EXP-DT                PIC 9(11).
  2603         16  AM-PREV-EFF-DT                PIC 9(11).
  2604
  2605     12  AM-REPORT-CODE-1                  PIC X(10).
  2606     12  AM-REPORT-CODE-2                  PIC X(10).
  2607
  2608     12  AM-CITY-CODE                      PIC X(4).
  2609     12  AM-COUNTY-PARISH                  PIC X(6).
  2610
  2611     12  AM-NAME                           PIC X(30).
  2612     12  AM-PERSON                         PIC X(30).
  2613     12  AM-ADDRS                          PIC X(30).
  2614     12  AM-CITY.
  2615         16  AM-ADDR-CITY                  PIC X(28).
  2616         16  AM-ADDR-STATE                 PIC XX.
  2617     12  AM-ZIP.
  2618         16  AM-ZIP-PRIME.
  2619             20  AM-ZIP-PRI-1ST            PIC X.
  2620                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2621             20  FILLER                    PIC X(4).
  2622         16  AM-ZIP-PLUS4                  PIC X(4).
  2623     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2624         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  52
* EL162.cbl
  2625         16  AM-CAN-POSTAL-2               PIC XXX.
  2626         16  FILLER                        PIC XXX.
  2627     12  AM-TEL-NO.
  2628         16  AM-AREA-CODE                  PIC 999.
  2629         16  AM-TEL-PRE                    PIC 999.
  2630         16  AM-TEL-NBR                    PIC 9(4).
  2631     12  AM-TEL-LOC                        PIC X.
  2632         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2633         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2634
  2635     12  AM-COMM-STRUCTURE.
  2636         16  AM-DEFN-1.
  2637             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2638                 24  AM-AGT.
  2639                     28  AM-AGT-PREFIX     PIC X(4).
  2640                     28  AM-AGT-PRIME      PIC X(6).
  2641                 24  AM-COM-TYP            PIC X.
  2642                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2643                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2644                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2645                 24  AM-RECALC-LV-INDIC    PIC X.
  2646                 24  AM-RETRO-LV-INDIC     PIC X.
  2647                 24  AM-GL-CODES           PIC X.
  2648                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2649                 24  FILLER                PIC X(01).
  2650         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2651             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2652                 24  FILLER                PIC X(11).
  2653                 24  AM-L-COMA             PIC XXX.
  2654                 24  AM-J-COMA             PIC XXX.
  2655                 24  AM-A-COMA             PIC XXX.
  2656                 24  FILLER                PIC X(6).
  2657
  2658     12  AM-COMM-CHANGE-STATUS             PIC X.
  2659         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2660
  2661     12  AM-CSR-CODE                       PIC X(4).
  2662
  2663     12  AM-BILLING-STATUS                 PIC X.
  2664         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2665         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2666     12  AM-AUTO-REFUND-SW                 PIC X.
  2667         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2668         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2669     12  AM-GPCD                           PIC 99.
  2670     12  AM-IG                             PIC X.
  2671         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2672         88  AM-HAS-GROUP                     VALUE '2'.
  2673     12  AM-STATUS                         PIC X.
  2674         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2675         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2676         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2677         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2678         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2679         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2680     12  AM-REMIT-TO                       PIC 99.
  2681     12  AM-ID-NO                          PIC X(11).
  2682
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  53
* EL162.cbl
  2683     12  AM-CAL-TABLE                      PIC XX.
  2684     12  AM-LF-DEVIATION                   PIC XXX.
  2685     12  AM-AH-DEVIATION                   PIC XXX.
  2686     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2687     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2688     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2689     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2690     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2691     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2692
  2693     12  AM-USER-FIELDS.
  2694         16  AM-FLD-1                      PIC XX.
  2695         16  AM-FLD-2                      PIC XX.
  2696         16  AM-FLD-3                      PIC XX.
  2697         16  AM-FLD-4                      PIC XX.
  2698         16  AM-FLD-5                      PIC XX.
  2699
  2700     12  AM-1ST-PROD-DATE.
  2701         16  AM-1ST-PROD-YR                PIC XX.
  2702         16  AM-1ST-PROD-MO                PIC XX.
  2703         16  AM-1ST-PROD-DA                PIC XX.
  2704     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2705     12  AM-CERTS-PURGED-DATE.
  2706         16  AM-PUR-YR                     PIC XX.
  2707         16  AM-PUR-MO                     PIC XX.
  2708         16  AM-PUR-DA                     PIC XX.
  2709     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2710     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2711     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2712     12  AM-INACTIVE-DATE.
  2713         16  AM-INA-MO                     PIC 99.
  2714         16  AM-INA-DA                     PIC 99.
  2715         16  AM-INA-YR                     PIC 99.
  2716     12  AM-AR-HI-CERT-DATE                PIC XX.
  2717
  2718     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2719     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2720
  2721     12  AM-OB-PAYMENT-MODE                PIC X.
  2722         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2723         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2724         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2725         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2726
  2727     12  AM-AH-ONLY-INDICATOR              PIC X.
  2728         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2729         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2730
  2731     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2732
  2733     12  AM-OVER-SHORT.
  2734         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2735         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2736
  2737     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2738     12  AM-DCC-CLP-STATE                  PIC XX.
  2739
  2740     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  54
* EL162.cbl
  2741     12  AM-RECALC-REIN                    PIC X.
  2742
  2743     12  AM-REI-TABLE                      PIC XXX.
  2744     12  AM-REI-ET-LF                      PIC X.
  2745     12  AM-REI-ET-AH                      PIC X.
  2746     12  AM-REI-PE-LF                      PIC X.
  2747     12  AM-REI-PE-AH                      PIC X.
  2748     12  AM-REI-PRT-ST                     PIC X.
  2749     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2750     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2751     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2752     12  AM-REI-GROUP-A                    PIC X(6).
  2753     12  AM-REI-MORT                       PIC X(4).
  2754     12  AM-REI-PRT-OW                     PIC X.
  2755     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2756     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2757     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2758     12  AM-REI-GROUP-B                    PIC X(6).
  2759
  2760     12  AM-TRUST-TYPE                     PIC X(2).
  2761
  2762     12  AM-EMPLOYER-STMT-USED             PIC X.
  2763     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2764
  2765     12  AM-STD-AH-TYPE                    PIC XX.
  2766     12  AM-EARN-METHODS.
  2767         16  AM-EARN-METHOD-R              PIC X.
  2768             88 AM-REF-RL-R78                 VALUE 'R'.
  2769             88 AM-REF-RL-PR                  VALUE 'P'.
  2770             88 AM-REF-RL-MEAN                VALUE 'M'.
  2771             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2772         16  AM-EARN-METHOD-L              PIC X.
  2773             88 AM-REF-LL-R78                 VALUE 'R'.
  2774             88 AM-REF-LL-PR                  VALUE 'P'.
  2775             88 AM-REF-LL-MEAN                VALUE 'M'.
  2776             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2777         16  AM-EARN-METHOD-A              PIC X.
  2778             88 AM-REF-AH-R78                 VALUE 'R'.
  2779             88 AM-REF-AH-PR                  VALUE 'P'.
  2780             88 AM-REF-AH-MEAN                VALUE 'M'.
  2781             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2782             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2783             88 AM-REF-AH-NET                 VALUE 'N'.
  2784
  2785     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2786     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2787     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2788
  2789     12  AM-RET-Y-N                        PIC X.
  2790     12  AM-RET-P-E                        PIC X.
  2791     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2792     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2793     12  AM-RET-GRP                        PIC X(6).
  2794     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2795         16  AM-POOL-PRIME                 PIC XXX.
  2796         16  AM-POOL-SUB                   PIC XXX.
  2797     12  AM-RETRO-EARNINGS.
  2798         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  55
* EL162.cbl
  2799         16  AM-RET-EARN-L                 PIC X.
  2800         16  AM-RET-EARN-A                 PIC X.
  2801     12  AM-RET-ST-TAX-USE                 PIC X.
  2802         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2803         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2804     12  AM-RETRO-BEG-EARNINGS.
  2805         16  AM-RET-BEG-EARN-R             PIC X.
  2806         16  AM-RET-BEG-EARN-L             PIC X.
  2807         16  AM-RET-BEG-EARN-A             PIC X.
  2808     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2809     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2810
  2811     12  AM-USER-SELECT-OPTIONS.
  2812         16  AM-USER-SELECT-1              PIC X(10).
  2813         16  AM-USER-SELECT-2              PIC X(10).
  2814         16  AM-USER-SELECT-3              PIC X(10).
  2815         16  AM-USER-SELECT-4              PIC X(10).
  2816         16  AM-USER-SELECT-5              PIC X(10).
  2817
  2818     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2819
  2820     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2821
  2822     12  AM-RPT045A-SWITCH                 PIC X.
  2823         88  RPT045A-OFF                   VALUE 'N'.
  2824
  2825     12  AM-INSURANCE-LIMITS.
  2826         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2827         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2828
  2829     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2830         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2831
  2832     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2833         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2834         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2835
  2836     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2837
  2838     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2839     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2840     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2841     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2842     12  AM-DCC-UEF-STATE                  PIC XX.
  2843     12  FILLER                            PIC XXX.
  2844     12  AM-REPORT-CODE-3                  PIC X(10).
  2845*    12  FILLER                            PIC X(22).
  2846
  2847     12  AM-RESERVE-DATE.
  2848         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2849         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2850         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2851
  2852     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2853     12  AM-NOTIFICATION-TYPES.
  2854         16  AM-NOTIF-OF-LETTERS           PIC X.
  2855         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2856         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  56
* EL162.cbl
  2857         16  AM-NOTIF-OF-STATUS            PIC X.
  2858
  2859     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2860         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2861         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2862         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2863         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2864
  2865     12  AM-BENEFIT-CONTROLS.
  2866         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2867             20  AM-BENEFIT-CODE           PIC XX.
  2868             20  AM-BENEFIT-TYPE           PIC X.
  2869             20  AM-BENEFIT-REVISION       PIC XXX.
  2870             20  AM-BENEFIT-REM-TERM       PIC X.
  2871             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2872             20  FILLER                    PIC XX.
  2873         16  FILLER                        PIC X(80).
  2874
  2875     12  AM-TRANSFER-DATA.
  2876         16  AM-TRANSFERRED-FROM.
  2877             20  AM-TRNFROM-CARRIER        PIC X.
  2878             20  AM-TRNFROM-GROUPING.
  2879                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2880                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2881             20  AM-TRNFROM-STATE          PIC XX.
  2882             20  AM-TRNFROM-ACCOUNT.
  2883                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2884                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2885             20  AM-TRNFROM-DTE            PIC XX.
  2886         16  AM-TRANSFERRED-TO.
  2887             20  AM-TRNTO-CARRIER          PIC X.
  2888             20  AM-TRNTO-GROUPING.
  2889                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2890                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2891             20  AM-TRNTO-STATE            PIC XX.
  2892             20  AM-TRNTO-ACCOUNT.
  2893                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2894                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2895             20  AM-TRNTO-DTE              PIC XX.
  2896         16  FILLER                        PIC X(10).
  2897
  2898     12  AM-SAVED-REMIT-TO                 PIC 99.
  2899
  2900     12  AM-COMM-STRUCTURE-SAVED.
  2901         16  AM-DEFN-1-SAVED.
  2902             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2903                 24  AM-AGT-SV             PIC X(10).
  2904                 24  AM-COM-TYP-SV         PIC X.
  2905                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2906                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2907                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2908                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2909                 24  FILLER                PIC X.
  2910                 24  AM-GL-CODES-SV        PIC X.
  2911                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2912                 24  FILLER                PIC X.
  2913         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2914             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  57
* EL162.cbl
  2915                 24  FILLER                PIC X(11).
  2916                 24  AM-L-COMA-SV          PIC XXX.
  2917                 24  AM-J-COMA-SV          PIC XXX.
  2918                 24  AM-A-COMA-SV          PIC XXX.
  2919                 24  FILLER                PIC X(6).
  2920
  2921     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2922         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2923            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2924            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2925            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2926
  2927     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2928     12  FILLER                            PIC X(120).
  2929
  2930     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2931         16  AM-CONTROL-NAME               PIC X(30).
  2932         16  AM-EXECUTIVE-ONE.
  2933             20  AM-EXEC1-NAME             PIC X(15).
  2934             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2935                                                          COMP-3.
  2936             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2937                                                          COMP-3.
  2938         16  AM-EXECUTIVE-TWO.
  2939             20  AM-EXEC2-NAME             PIC X(15).
  2940             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2941                                                          COMP-3.
  2942             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2943                                                          COMP-3.
  2944
  2945     12  AM-RETRO-ADDITIONAL-DATA.
  2946         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2947         16  AM-RETRO-PREM-P-E             PIC X.
  2948         16  AM-RETRO-CLMS-P-I             PIC X.
  2949         16  AM-RETRO-RET-BRACKET-LF.
  2950             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2951                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2952                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2953             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2954                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2955                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2956             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2957                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2958                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2959         16  AM-RETRO-RET-BRACKET-AH.
  2960             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2961                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2962                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2963                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2964             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2965                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2966                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2967             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2968                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2969                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2970
  2971     12  AM-COMMENTS.
  2972         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  58
* EL162.cbl
  2973
  2974     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2975         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2976         16  AM-FLI-BILLING-CODE           PIC X.
  2977         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2978         16  AM-FLI-UNITED-IDENT           PIC X.
  2979         16  AM-FLI-INTEREST-LOST-DATA.
  2980             20  AM-FLI-BANK-NO            PIC X(5).
  2981             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2982             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2983             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2984         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2985             20  AM-FLI-AGT                PIC X(9).
  2986             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2987             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2988         16  FILLER                        PIC X(102).
  2989
  2990     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2991         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2992             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2993             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2994             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2995             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2996             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2997         16  FILLER                          PIC X(10).
  2998******************************************************************
  2999
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  59
* EL162.cbl
  3001 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  3002                          ACTIVITY-TRAILERS ACCOUNT-MASTER.
  3003 0000-DFHEXIT SECTION.
  3004     MOVE '9#                    $   ' TO DFHEIV0.
  3005     MOVE 'EL162' TO DFHEIV1.
  3006     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3007
  3008     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3009     MOVE '5'                   TO DC-OPTION-CODE.
  3010     PERFORM 9700-DATE-LINK.
  3011     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3012     MOVE DC-BIN-DATE-1         TO  BIN-CURRENT-DATE.
  3013
  3014     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  3015
  3016     IF PI-COMPANY-ID = 'DMD'
  3017         MOVE -1                TO  DC-ELAPSED-MONTHS
  3018         MOVE +0                TO  DC-ELAPSED-DAYS
  3019         MOVE '6'               TO  DC-OPTION-CODE
  3020         PERFORM 9700-DATE-LINK
  3021         MOVE DC-BIN-DATE-2     TO  CURRENT-MINUS1-SAVE.
  3022
  3023     IF EIBCALEN NOT GREATER THAN ZERO
  3024         GO TO 8800-UNAUTHORIZED-ACCESS.
  3025
  3026     IF PI-CALLING-PROGRAM = PGM-EL150
  3027         MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3028         MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3029         MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3030         MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3031         MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3032         MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3033         MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3034         MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3035         MOVE +1                   TO SUB
  3036         PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3037         MOVE LOW-VALUES           TO EL162AO
  3038                                      PI-DISPLAYED-TRAILER-CODES
  3039         MOVE 1                    TO PI-ACTV-SEQ
  3040                                      PI-NEXT-TRLR-SUB
  3041         GO TO 7000-BUILD-SCREEN.
  3042
  3043     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3044         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3045************ FIRST TIME IN FROM MENU, FORCE THE CLAIM
  3046************ TO BE DESIGNATED THRU EL132.
  3047             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3048             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3049             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3050             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3051             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3052             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3053             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3054             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3055             MOVE PGM-EL132            TO PGM-NAME
  3056             GO TO 9300-XCTL
  3057         ELSE
  3058             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  60
* EL162.cbl
  3059             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3060             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3061             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3062             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3063             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3064             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3065             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  3066             MOVE +1                   TO SUB
  3067             PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3068             MOVE LOW-VALUES           TO EL162AO
  3069                                       PI-DISPLAYED-TRAILER-CODES
  3070             MOVE 1                    TO PI-ACTV-SEQ
  3071                                          PI-NEXT-TRLR-SUB
  3072             GO TO 7000-BUILD-SCREEN.
  3073
  3074     IF EIBAID = DFHCLEAR
  3075         GO TO 9400-CLEAR.
  3076
  3077
  3078* EXEC CICS HANDLE CONDITION
  3079*        PGMIDERR(9600-PGMID-ERROR)
  3080*        ERROR   (9990-ABEND)
  3081*    END-EXEC.
  3082*    MOVE '"$L.                  ! " #00003073' TO DFHEIV0
  3083     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3085     MOVE X'2220233030303033303733' TO DFHEIV0(25:11)
  3086     CALL 'kxdfhei1' USING DFHEIV0
  3087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3088
  3089
  3090     IF PI-PROCESSOR-ID = 'LGXX'
  3091         GO TO 0200-RECEIVE.
  3092
  3093
  3094* EXEC CICS READQ TS
  3095*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3096*        INTO    (SECURITY-CONTROL)
  3097*        LENGTH  (SC-COMM-LENGTH)
  3098*        ITEM    (SC-ITEM)
  3099*    END-EXEC.
  3100*    MOVE '*$II   L              ''   #00003081' TO DFHEIV0
  3101     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3102     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3103     MOVE X'2020233030303033303831' TO DFHEIV0(25:11)
  3104     CALL 'kxdfhei1' USING DFHEIV0,
  3105           PI-SECURITY-TEMP-STORE-ID,
  3106           SECURITY-CONTROL,
  3107           SC-COMM-LENGTH,
  3108           SC-ITEM,
  3109           DFHEIV99,
  3110           DFHEIV99
  3111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3112
  3113
  3114     MOVE SC-CLAIMS-DISPLAY (2)    TO  PI-DISPLAY-CAP.
  3115     MOVE SC-CLAIMS-UPDATE  (2)    TO  PI-MODIFY-CAP.
  3116
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  61
* EL162.cbl
  3117     IF NOT MODIFY-CAP
  3118         MOVE 'UPDATE'             TO  SM-READ
  3119         PERFORM 9995-SECURITY-VIOLATION
  3120         MOVE ER-0070              TO  EMI-ERROR
  3121         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3122         GO TO 8100-SEND-INITIAL-MAP.
  3123
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  62
* EL162.cbl
  3125 0200-RECEIVE.
  3126
  3127     MOVE LOW-VALUES TO EL162AI.
  3128
  3129     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3130         MOVE ER-0008            TO EMI-ERROR
  3131         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3132         GO TO 8200-SEND-DATAONLY.
  3133
  3134
  3135* EXEC CICS RECEIVE
  3136*        MAP   (MAP-NAME)
  3137*        MAPSET(MAPSET-NAME)
  3138*        INTO  (EL162AI)
  3139*    END-EXEC.
  3140     MOVE LENGTH OF
  3141      EL162AI
  3142       TO DFHEIV11
  3143*    MOVE '8"T I  L              ''   #00003108' TO DFHEIV0
  3144     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3146     MOVE X'2020233030303033313038' TO DFHEIV0(25:11)
  3147     CALL 'kxdfhei1' USING DFHEIV0,
  3148           MAP-NAME,
  3149           EL162AI,
  3150           DFHEIV11,
  3151           MAPSET-NAME,
  3152           DFHEIV99,
  3153           DFHEIV99
  3154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3155
  3156
  3157     IF ENTERPFL = ZERO
  3158         GO TO 0300-CHECK-PFKEYS.
  3159
  3160     IF EIBAID NOT = DFHENTER
  3161         MOVE ER-0004            TO EMI-ERROR
  3162         GO TO 0320-INPUT-ERROR.
  3163
  3164     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3165         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3166     ELSE
  3167         MOVE ER-0029            TO EMI-ERROR
  3168         GO TO 0320-INPUT-ERROR.
  3169
  3170 0300-CHECK-PFKEYS.
  3171     IF EIBAID = DFHPF23
  3172         GO TO 8810-PF23.
  3173
  3174     IF EIBAID = DFHPF24
  3175         GO TO 9200-RETURN-MAIN-MENU.
  3176
  3177     IF EIBAID = DFHPF12
  3178         GO TO 9500-PF12.
  3179
  3180     IF PI-COMPANY-ID = 'DMD'
  3181         MOVE SPACE              TO PI-DMD-FORCE-ERROR.
  3182
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  63
* EL162.cbl
  3183     IF EIBAID = DFHPF4
  3184         IF PI-COMPANY-ID NOT = 'DMD'
  3185             MOVE ER-0029        TO EMI-ERROR
  3186             GO TO 0320-INPUT-ERROR
  3187         ELSE
  3188             MOVE 'X'            TO PI-DMD-FORCE-ERROR
  3189             MOVE DFHENTER       TO EIBAID
  3190             GO TO 0330-EDIT-DATA.
  3191
  3192     IF EIBAID = DFHPF5
  3193         IF PI-RETURN-TO-PROGRAM = 'EL150'
  3194             MOVE ER-0029        TO EMI-ERROR
  3195             GO TO 0320-INPUT-ERROR
  3196         ELSE
  3197             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  3198             MOVE PGM-EL132      TO PGM-NAME
  3199             GO TO 9300-XCTL.
  3200
  3201     IF PI-CLAIM-NO = SPACES
  3202        MOVE ER-0319             TO EMI-ERROR
  3203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3204        GO TO 8100-SEND-INITIAL-MAP.
  3205
  3206     IF SC-RECL (1) > 0 OR SC-STOPL (1) > 0 OR
  3207        SC-RECL (2) > 0 OR SC-STOPL (2) > 0 OR
  3208        SC-RECL (3) > 0 OR SC-STOPL (3) > 0 OR
  3209        SC-RECL (4) > 0 OR SC-STOPL (4) > 0 OR
  3210        UREL > 0  OR USENTL > 0  OR
  3211*00409         UBYL > 0  OR UFORML > 0  OR URECDTEL > 0
  3212        UFORML > 0  OR URECDTEL > 0
  3213          IF EIBAID NOT = DFHENTER
  3214             MOVE ER-0050            TO EMI-ERROR
  3215             GO TO 0320-INPUT-ERROR.
  3216
  3217     IF EIBAID = DFHPF1
  3218         GO TO 6000-BROWSE-FORWARD.
  3219
  3220     IF EIBAID = DFHPF2
  3221         GO TO 6100-BROWSE-BACKWARD.
  3222
  3223     IF EIBAID = DFHPF6
  3224         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  3225         MOVE PGM-EL141          TO PGM-NAME
  3226         GO TO 9300-XCTL.
  3227
  3228     IF EIBAID = DFHPF7
  3229         MOVE PGM-EL1284          TO PGM-NAME
  3230         GO TO 9300-XCTL.
  3231
  3232     IF EIBAID = DFHENTER
  3233         GO TO 0330-EDIT-DATA.
  3234
  3235     MOVE ER-0029                TO EMI-ERROR.
  3236
  3237 0320-INPUT-ERROR.
  3238     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3239
  3240     MOVE AL-UNBON        TO ENTERPFA.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  64
* EL162.cbl
  3241
  3242     IF ENTERPFL = 0
  3243         MOVE -1          TO URECDTEL
  3244     ELSE
  3245         MOVE -1          TO ENTERPFL.
  3246
  3247     GO TO 8200-SEND-DATAONLY.
  3248
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  65
* EL162.cbl
  3250 0330-EDIT-DATA.
  3251     SET SC-INDX  INDX           TO 1.
  3252     SET INDX2                   TO 1.
  3253
  3254 0331-LOOP.
  3255     IF SC-RECL (SC-INDX) > ZERO
  3256        MOVE SC-REC (SC-INDX)    TO DEEDIT-FIELD
  3257        PERFORM 8600-DEEDIT
  3258        MOVE '1'                 TO REC-DATA-SW
  3259        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3260        MOVE '4'                 TO DC-OPTION-CODE
  3261        PERFORM 9700-DATE-LINK
  3262        IF DATE-CONVERSION-ERROR
  3263           MOVE ER-0021          TO EMI-ERROR
  3264           MOVE -1               TO SC-RECL (SC-INDX)
  3265           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3266           PERFORM 9900-ERROR-FORMAT
  3267                                 THRU 9900-EXIT
  3268        ELSE
  3269           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3270              MOVE ER-0539       TO EMI-ERROR
  3271              MOVE -1            TO SC-RECL (SC-INDX)
  3272              MOVE AL-UABON      TO SC-RECA (SC-INDX)
  3273              PERFORM 9900-ERROR-FORMAT
  3274                                 THRU 9900-EXIT
  3275           ELSE
  3276              MOVE DC-BIN-DATE-1 TO REC-DATE-SAVE (INDX)
  3277              MOVE DEEDIT-FIELD-V0
  3278                                 TO SC-REC-O (SC-INDX)
  3279              INSPECT SC-REC (SC-INDX) CONVERTING ' ' TO '/'
  3280           END-IF
  3281        END-IF
  3282     ELSE
  3283        MOVE LOW-VALUES          TO REC-DATE-SAVE (INDX)
  3284     END-IF
  3285     IF PI-COMPANY-ID = 'DMD'
  3286       IF SC-RECL (SC-INDX) > 0
  3287         IF REC-DATE-SAVE (INDX) < CURRENT-MINUS1-SAVE
  3288         IF NOT PI-DMD-FORCED
  3289           MOVE ER-7839        TO EMI-ERROR
  3290           MOVE -1             TO SC-RECL (SC-INDX)
  3291           MOVE AL-UABON       TO SC-RECA (SC-INDX)
  3292           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3293         END-IF
  3294         ELSE
  3295         IF REC-DATE-SAVE (INDX) > BIN-CURRENT-DATE
  3296           MOVE ER-0539          TO EMI-ERROR
  3297           MOVE -1               TO SC-RECL (SC-INDX)
  3298           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3300
  3301     IF SC-STOPL (SC-INDX) > ZERO
  3302        MOVE SC-STOP (SC-INDX)    TO DEEDIT-FIELD
  3303        PERFORM 8600-DEEDIT
  3304        MOVE '1'                 TO REC-DATA-SW
  3305        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3306        MOVE '4'                 TO DC-OPTION-CODE
  3307        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  66
* EL162.cbl
  3308        IF DATE-CONVERSION-ERROR
  3309           MOVE ER-0021          TO EMI-ERROR
  3310           MOVE -1               TO SC-STOPL (SC-INDX)
  3311           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3312           PERFORM 9900-ERROR-FORMAT
  3313                                 THRU 9900-EXIT
  3314        ELSE
  3315           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3316              MOVE ER-0895       TO EMI-ERROR
  3317              MOVE -1            TO SC-STOPL (SC-INDX)
  3318              MOVE AL-UABON      TO SC-STOPA (SC-INDX)
  3319              PERFORM 9900-ERROR-FORMAT
  3320                                 THRU 9900-EXIT
  3321           ELSE
  3322              MOVE DC-BIN-DATE-1 TO STOP-DATE-SAVE (INDX2)
  3323              MOVE DEEDIT-FIELD-V0 TO SC-STOP-O (SC-INDX)
  3324              INSPECT SC-STOP (SC-INDX) CONVERTING ' ' TO '/'
  3325           END-IF
  3326        END-IF
  3327     ELSE
  3328        MOVE LOW-VALUES          TO STOP-DATE-SAVE (INDX2)
  3329     END-IF.
  3330
  3331     SET SC-INDX
  3332            INDX2
  3333            INDX UP BY 1.
  3334
  3335     IF SC-INDX NOT = 5
  3336        GO TO 0331-LOOP.
  3337
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  67
* EL162.cbl
  3339
  3340     IF URECDTEL > 0
  3341        MOVE URECDTEI            TO DEEDIT-FIELD
  3342        PERFORM 8600-DEEDIT
  3343        MOVE '1'                 TO UNSOL-DATA-SW
  3344        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3345        MOVE '4'                 TO DC-OPTION-CODE
  3346        PERFORM 9700-DATE-LINK
  3347        IF DATE-CONVERSION-ERROR
  3348           MOVE ER-0021          TO EMI-ERROR
  3349           MOVE -1               TO URECDTEL
  3350           MOVE AL-UABON         TO URECDTEA
  3351           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3352        ELSE
  3353           MOVE DC-BIN-DATE-1    TO URECDTE-SAVE
  3354           MOVE DEEDIT-FIELD-V0  TO URECDTEO
  3355           INSPECT URECDTEI CONVERTING ' ' TO '/'.
  3356
  3357     IF PI-COMPANY-ID = 'DMD'
  3358       IF URECDTEL > 0
  3359         IF URECDTE-SAVE < CURRENT-MINUS1-SAVE
  3360         IF NOT PI-DMD-FORCED
  3361           MOVE ER-7839        TO EMI-ERROR
  3362           MOVE -1             TO URECDTEL
  3363           MOVE AL-UABON       TO URECDTEA
  3364           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3365         END-IF
  3366         ELSE
  3367         IF URECDTE-SAVE > BIN-CURRENT-DATE
  3368           MOVE ER-0539          TO EMI-ERROR
  3369           MOVE -1               TO URECDTEL
  3370           MOVE AL-UABON         TO URECDTEA
  3371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3372
  3373     IF USENTL > 0
  3374        MOVE USENTI              TO DEEDIT-FIELD
  3375        PERFORM 8600-DEEDIT
  3376        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3377        MOVE '4'                 TO DC-OPTION-CODE
  3378        PERFORM 9700-DATE-LINK
  3379        IF DATE-CONVERSION-ERROR
  3380           MOVE ER-0021          TO EMI-ERROR
  3381           MOVE -1               TO USENTL
  3382           MOVE AL-UABON         TO USENTA
  3383           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3384          ELSE
  3385           MOVE DC-BIN-DATE-1    TO USENT-SAVE
  3386           MOVE DEEDIT-FIELD-V0  TO USENTO
  3387           INSPECT USENTI CONVERTING ' ' TO '/'
  3388        ELSE
  3389           MOVE LOW-VALUES       TO USENT-SAVE.
  3390
  3391     IF USENT-SAVE   NOT = LOW-VALUES AND
  3392        URECDTE-SAVE NOT = LOW-VALUES
  3393          IF USENT-SAVE GREATER THAN URECDTE-SAVE
  3394             MOVE ER-0514        TO EMI-ERROR
  3395             MOVE -1             TO URECDTEL
  3396             MOVE AL-UABON       TO URECDTEA
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  68
* EL162.cbl
  3397             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3398
  3399     IF URECDTE-SAVE NOT = LOW-VALUES
  3400          IF URECDTE-SAVE GREATER THAN BIN-CURRENT-DATE
  3401             MOVE ER-0539        TO EMI-ERROR
  3402             MOVE -1             TO URECDTEL
  3403             MOVE AL-UABON       TO URECDTEA
  3404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3405
  3406     IF URECDTEL = ZEROS
  3407        IF USENTL > ZEROS  OR
  3408*00570            UBYL   > ZEROS  OR
  3409           UFORML > ZEROS  OR
  3410           UREL   > ZEROS
  3411              MOVE ER-0321          TO EMI-ERROR
  3412              MOVE -1               TO URECDTEL
  3413              PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT.
  3414
  3415     IF NOT EMI-NO-ERRORS
  3416        GO TO 8200-SEND-DATAONLY.
  3417
  3418     IF NOT MODIFY-CAP
  3419         MOVE ER-0070            TO EMI-ERROR
  3420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3421         MOVE LOW-VALUES TO EL162AO
  3422         GO TO 8100-SEND-INITIAL-MAP.
  3423
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  69
* EL162.cbl
  3425     PERFORM 3000-BUILD-KEYS.
  3426
  3427     IF REC-DATA
  3428        PERFORM 4000-UPDATE-RECEIVE-DATES THRU 4099-EXIT
  3429                VARYING SC-INDX FROM 1 BY 1 UNTIL
  3430                SC-INDX = 5.
  3431
  3432     PERFORM 4100-CREATE-NEW-TRLR THRU 4199-EXIT.
  3433
  3434     MOVE ER-ZEROS               TO EMI-ERROR.
  3435     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  3436                                    ZIPI PHONEI.
  3437
  3438     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3439
  3440     MOVE -1                     TO SC-RECL (1).
  3441     GO TO 8200-SEND-DATAONLY.
  3442
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  70
* EL162.cbl
  3444 2000-ZERO-PI-TRLR-TABLE.
  3445
  3446     MOVE +0                     TO PI-TRLRS (SUB).
  3447     ADD +1 TO SUB.
  3448
  3449     IF SUB > +50
  3450        MOVE +0                  TO SUB
  3451        GO TO 2010-EXIT.
  3452
  3453     GO TO 2000-ZERO-PI-TRLR-TABLE.
  3454
  3455 2010-EXIT.
  3456     EXIT.
  3457
  3458 3000-BUILD-KEYS.
  3459     MOVE PI-CLAIM-NO            TO PI-CLAM-CLAIM
  3460                                    PI-ACTV-CLAIM
  3461                                    CLAIMNOI.
  3462
  3463     MOVE PI-CERT-NO             TO PI-CLAM-CERT-NO
  3464                                    PI-ACTV-CERT-NO
  3465                                    CERTNOI.
  3466
  3467     MOVE PI-COMPANY-CD          TO PI-CLAM-COMP-CD
  3468                                    PI-ACTV-COMP-CD.
  3469
  3470     MOVE PI-CARRIER             TO PI-CLAM-CARRIER
  3471                                    PI-ACTV-CARRIER
  3472                                    CARRI.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  71
* EL162.cbl
  3474 4000-UPDATE-RECEIVE-DATES.
  3475
  3476     IF SC-RECL (SC-INDX) = ZERO AND SC-STOPL (SC-INDX)
  3477        GO TO 4099-EXIT.
  3478
  3479     MOVE SC-TRLRNO (SC-INDX)    TO PI-ACTV-SEQ.
  3480
  3481*00648      IF SC-RECL (SC-INDX) = ZERO
  3482*00649          EXEC CICS READ
  3483*00650               DATASET (ELTRLR-FILE-ID)
  3484*00651               RIDFLD  (PI-ACTV-KEY)
  3485*00652               SET     (ADDRESS OF ACTIVITY-TRAILERS)
  3486*00653          END-EXEC
  3487*00654         ELSE
  3488
  3489* EXEC CICS READ
  3490*             DATASET(ELTRLR-FILE-ID)
  3491*             RIDFLD (PI-ACTV-KEY)
  3492*             SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3493*             UPDATE
  3494*        END-EXEC.
  3495*    MOVE '&"S        EU         (   #00003445' TO DFHEIV0
  3496     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3497     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3498     MOVE X'2020233030303033343435' TO DFHEIV0(25:11)
  3499     CALL 'kxdfhei1' USING DFHEIV0,
  3500           ELTRLR-FILE-ID,
  3501           DFHEIV20,
  3502           DFHEIV99,
  3503           PI-ACTV-KEY,
  3504           DFHEIV99,
  3505           DFHEIV99,
  3506           DFHEIV99
  3507     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3508         DFHEIV20
  3509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3510
  3511
  3512     SET INDX2 TO SC-INDX.
  3513
  3514     IF SC-STOPL (SC-INDX) = ZEROS
  3515         GO TO 4000-BYPASS-STOP-DATE
  3516     END-IF.
  3517
  3518     IF (CORRESPONDENCE-TR AND
  3519         STOP-DATE-SAVE (INDX2) LESS THAN AT-LETTER-SENT-DT)
  3520              OR
  3521        (FORM-CONTROL-TR AND
  3522         STOP-DATE-SAVE (INDX2) LESS THAN AT-FORM-SEND-ON-DT)
  3523           MOVE ER-0896          TO EMI-ERROR
  3524           MOVE -1               TO SC-STOPL (SC-INDX)
  3525           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3526           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3527
  3528* EXEC CICS SYNCPOINT
  3529*               ROLLBACK
  3530*          END-EXEC
  3531*    MOVE '6"R                   !   #00003467' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  72
* EL162.cbl
  3532     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3534     MOVE X'2020233030303033343637' TO DFHEIV0(25:11)
  3535     CALL 'kxdfhei1' USING DFHEIV0
  3536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3537           GO TO 8200-SEND-DATAONLY
  3538     END-IF.
  3539
  3540     IF CORRESPONDENCE-TR
  3541        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-LETTER-DT
  3542        MOVE PI-PROCESSOR-ID     TO AT-CORR-LAST-UPDATED-BY
  3543        MOVE BIN-CURRENT-DATE    TO AT-CORR-LAST-MAINT-DT
  3544     END-IF.
  3545
  3546     IF FORM-CONTROL-TR
  3547        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-FORM-DT
  3548        MOVE PI-PROCESSOR-ID     TO AT-FORM-LAST-UPDATED-BY
  3549        MOVE BIN-CURRENT-DATE    TO AT-FORM-LAST-MAINT-DT
  3550     END-IF.
  3551     MOVE AL-UANOF               TO SC-STOPA (SC-INDX).
  3552
  3553 4000-BYPASS-STOP-DATE.
  3554
  3555     IF SC-RECL (SC-INDX) = ZEROS
  3556*00673         GO TO 4099-EXIT.
  3557        GO TO 4090-REWRITE
  3558     END-IF.
  3559
  3560     SET INDX TO SC-INDX.
  3561
  3562     IF (CORRESPONDENCE-TR AND
  3563         REC-DATE-SAVE (INDX)  LESS THAN AT-LETTER-SENT-DT)
  3564              OR
  3565        (FORM-CONTROL-TR AND
  3566         REC-DATE-SAVE (INDX)  LESS THAN AT-FORM-SEND-ON-DT)
  3567           MOVE ER-0514          TO EMI-ERROR
  3568           MOVE -1               TO SC-RECL (SC-INDX)
  3569           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3571
  3572* EXEC CICS SYNCPOINT
  3573*               ROLLBACK
  3574*          END-EXEC
  3575*    MOVE '6"R                   !   #00003504' TO DFHEIV0
  3576     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3578     MOVE X'2020233030303033353034' TO DFHEIV0(25:11)
  3579     CALL 'kxdfhei1' USING DFHEIV0
  3580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3581           GO TO 8200-SEND-DATAONLY.
  3582
  3583     IF CORRESPONDENCE-TR
  3584        MOVE REC-DATE-SAVE (INDX)   TO AT-LETTER-ANSWERED-DT
  3585        MOVE PI-PROCESSOR-ID        TO AT-CORR-LAST-UPDATED-BY
  3586        MOVE BIN-CURRENT-DATE       TO AT-CORR-LAST-MAINT-DT.
  3587
  3588     IF FORM-CONTROL-TR
  3589        MOVE PI-PROCESSOR-ID        TO AT-FORM-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  73
* EL162.cbl
  3590        MOVE BIN-CURRENT-DATE       TO AT-FORM-LAST-MAINT-DT
  3591        IF SC-TYPE (SC-INDX) = 'C'
  3592           MOVE REC-DATE-SAVE (INDX)   TO AT-FORM-ANSWERED-DT
  3593        ELSE
  3594        IF SC-TYPE (SC-INDX) = 'E'
  3595           MOVE REC-DATE-SAVE (INDX)   TO AT-EMP-FORM-ANSWERED-DT
  3596        ELSE
  3597        IF SC-TYPE (SC-INDX) = 'P'
  3598           MOVE REC-DATE-SAVE (INDX)   TO AT-PHY-FORM-ANSWERED-DT.
  3599
  3600     MOVE AL-UANOF               TO SC-RECA (SC-INDX).
  3601
  3602 4090-REWRITE.
  3603
  3604     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3605
  3606     IF PI-COMPANY-ID = 'DMD'
  3607         MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY.
  3608
  3609
  3610* EXEC CICS REWRITE
  3611*         FROM   (ACTIVITY-TRAILERS)
  3612*         DATASET(ELTRLR-FILE-ID)
  3613*    END-EXEC.
  3614     MOVE LENGTH OF
  3615      ACTIVITY-TRAILERS
  3616       TO DFHEIV11
  3617*    MOVE '&& L                  %   #00003535' TO DFHEIV0
  3618     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3619     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3620     MOVE X'2020233030303033353335' TO DFHEIV0(25:11)
  3621     CALL 'kxdfhei1' USING DFHEIV0,
  3622           ELTRLR-FILE-ID,
  3623           ACTIVITY-TRAILERS,
  3624           DFHEIV11,
  3625           DFHEIV99
  3626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3627
  3628
  3629 4099-EXIT.
  3630      EXIT.
  3631
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  74
* EL162.cbl
  3633 4100-CREATE-NEW-TRLR.
  3634
  3635
  3636* EXEC CICS READ
  3637*         DATASET(ELMSTR-FILE-ID)
  3638*         SET    (ADDRESS OF CLAIM-MASTER)
  3639*         RIDFLD (PI-CLAM-KEY)
  3640*         UPDATE
  3641*    END-EXEC.
  3642*    MOVE '&"S        EU         (   #00003546' TO DFHEIV0
  3643     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3644     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3645     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  3646     CALL 'kxdfhei1' USING DFHEIV0,
  3647           ELMSTR-FILE-ID,
  3648           DFHEIV20,
  3649           DFHEIV99,
  3650           PI-CLAM-KEY,
  3651           DFHEIV99,
  3652           DFHEIV99,
  3653           DFHEIV99
  3654     SET ADDRESS OF CLAIM-MASTER TO
  3655         DFHEIV20
  3656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3657
  3658
  3659     IF FILEL > ZEROS
  3660        MOVE FILEI               TO CL-FILE-LOCATION.
  3661
  3662     IF NOT UNSOL-DATA
  3663        GO TO 4150-REWRITE-CLAIM.
  3664
  3665     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  3666
  3667
  3668* EXEC CICS GETMAIN
  3669*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3670*         INITIMG(GETMAIN-SPACE)
  3671*         LENGTH (ACTV-LENGTH)
  3672*    END-EXEC.
  3673*    MOVE ',"IL                  $   #00003561' TO DFHEIV0
  3674     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3676     MOVE X'2020233030303033353631' TO DFHEIV0(25:11)
  3677     CALL 'kxdfhei1' USING DFHEIV0,
  3678           DFHEIV20,
  3679           ACTV-LENGTH,
  3680           GETMAIN-SPACE
  3681     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3682         DFHEIV20
  3683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3684
  3685
  3686     MOVE 'AT'                   TO AT-RECORD-ID.
  3687     MOVE  4                     TO AT-TRAILER-TYPE.
  3688     MOVE BIN-CURRENT-DATE       TO AT-RECORDED-DT
  3689                                    AT-CORR-LAST-MAINT-DT
  3690
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  75
* EL162.cbl
  3691     IF UBYL > +0
  3692        MOVE UBYI                TO AT-RECORDED-BY
  3693                                    AT-CORR-LAST-UPDATED-BY
  3694     ELSE
  3695        MOVE PI-PROCESSOR-ID     TO AT-RECORDED-BY
  3696                                    AT-CORR-LAST-UPDATED-BY.
  3697
  3698     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3699     MOVE PI-ACTV-KEY            TO AT-CONTROL-PRIMARY.
  3700     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  3701     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
  3702     MOVE USENT-SAVE             TO AT-LETTER-SENT-DT.
  3703     MOVE LOW-VALUES             TO AT-RECEIPT-FOLLOW-UP
  3704                                    AT-AUTO-RE-SEND-DT
  3705                                    AT-INITIAL-PRINT-DATE
  3706                                    AT-RESEND-PRINT-DATE.
  3707     MOVE URECDTE-SAVE           TO AT-LETTER-ANSWERED-DT.
  3708     MOVE ZEROS                  TO AT-LETTER-ARCHIVE-NO.
  3709     MOVE '1'                    TO AT-LETTER-ORIGIN.
  3710
  3711     IF UFORML > 0
  3712        MOVE UFORMI              TO AT-STD-LETTER-FORM
  3713       ELSE
  3714        MOVE SPACES              TO AT-STD-LETTER-FORM.
  3715
  3716     IF UREL > 0
  3717        MOVE UREI                TO AT-REASON-TEXT
  3718       ELSE
  3719        MOVE SPACES              TO AT-REASON-TEXT.
  3720
  3721     MOVE SPACES                 TO AT-ADDRESSEE-NAME
  3722                                    AT-ADDRESEE-TYPE.
  3723     MOVE ZEROS                  TO AT-ADDRESS-REC-SEQ-NO.
  3724     MOVE 'U'                    TO AT-CORR-SOL-UNSOL.
  3725
  3726
  3727* EXEC CICS WRITE
  3728*         DATASET(ELTRLR-FILE-ID)
  3729*         FROM   (ACTIVITY-TRAILERS)
  3730*         RIDFLD (AT-CONTROL-PRIMARY)
  3731*    END-EXEC.
  3732     MOVE LENGTH OF
  3733      ACTIVITY-TRAILERS
  3734       TO DFHEIV11
  3735*    MOVE '&$ L                  ''   #00003607' TO DFHEIV0
  3736     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3738     MOVE X'2020233030303033363037' TO DFHEIV0(25:11)
  3739     CALL 'kxdfhei1' USING DFHEIV0,
  3740           ELTRLR-FILE-ID,
  3741           ACTIVITY-TRAILERS,
  3742           DFHEIV11,
  3743           AT-CONTROL-PRIMARY,
  3744           DFHEIV99,
  3745           DFHEIV99
  3746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3747
  3748
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  76
* EL162.cbl
  3749     MOVE SPACES                 TO URECDTEI
  3750                                    USENTI
  3751*00795                                     UBYI
  3752                                    UFORMI
  3753                                    UREI.
  3754
  3755     MOVE AL-UANOF               TO URECDTEA
  3756                                    USENTA
  3757*00801                                     UBYA
  3758                                    UFORMA
  3759                                    UREA.
  3760
  3761     MOVE PI-PROCESSOR-ID        TO UBYI.
  3762
  3763 4150-REWRITE-CLAIM.
  3764
  3765* EXEC CICS HANDLE CONDITION
  3766*        DUPKEY (4199-EXIT)
  3767*    END-EXEC.
  3768*    MOVE '"$$                   ! # #00003628' TO DFHEIV0
  3769     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  3770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3771     MOVE X'2320233030303033363238' TO DFHEIV0(25:11)
  3772     CALL 'kxdfhei1' USING DFHEIV0
  3773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3774
  3775
  3776     MOVE PI-PROCESSOR-ID   TO  CL-LAST-MAINT-USER.
  3777     MOVE EIBTIME           TO  CL-LAST-MAINT-HHMMSS.
  3778     MOVE BIN-CURRENT-DATE  TO  CL-LAST-MAINT-DT.
  3779     MOVE '2'               TO  CL-LAST-MAINT-TYPE.
  3780
  3781     IF PI-COMPANY-ID = 'DMD'
  3782         MOVE 11                 TO CL-ACTIVITY-CODE
  3783         MOVE BIN-CURRENT-DATE   TO CL-ACTIVITY-MAINT-DT
  3784         MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  3785         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
  3786
  3787
  3788* EXEC CICS REWRITE
  3789*         DATASET(ELMSTR-FILE-ID)
  3790*         FROM   (CLAIM-MASTER)
  3791*    END-EXEC.
  3792     MOVE LENGTH OF
  3793      CLAIM-MASTER
  3794       TO DFHEIV11
  3795*    MOVE '&& L                  %   #00003643' TO DFHEIV0
  3796     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3797     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3798     MOVE X'2020233030303033363433' TO DFHEIV0(25:11)
  3799     CALL 'kxdfhei1' USING DFHEIV0,
  3800           ELMSTR-FILE-ID,
  3801           CLAIM-MASTER,
  3802           DFHEIV11,
  3803           DFHEIV99
  3804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3805
  3806
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  77
* EL162.cbl
  3807 4199-EXIT.
  3808      EXIT.
  3809
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  78
* EL162.cbl
  3811 4200-LOCATE-ADDRESS.
  3812     IF ADDR-TYPE = '3' AND ADDR-SEQ = ZEROS
  3813        GO TO 4210-READ-ACCOUNT.
  3814
  3815     IF ADDR-TYPE = SPACES OR ADDR-SEQ = ZEROS
  3816        GO TO 4290-ERROR.
  3817
  3818     MOVE ADDR-SEQ               TO PI-ACTV-SEQ.
  3819
  3820
  3821* EXEC CICS HANDLE CONDITION
  3822*         NOTFND(4290-ERROR)
  3823*    END-EXEC.
  3824*    MOVE '"$I                   ! $ #00003661' TO DFHEIV0
  3825     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3827     MOVE X'2420233030303033363631' TO DFHEIV0(25:11)
  3828     CALL 'kxdfhei1' USING DFHEIV0
  3829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3830
  3831
  3832
  3833* EXEC CICS READ
  3834*         DATASET(ELTRLR-FILE-ID)
  3835*         RIDFLD (PI-ACTV-KEY)
  3836*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3837*    END-EXEC.
  3838*    MOVE '&"S        E          (   #00003665' TO DFHEIV0
  3839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3841     MOVE X'2020233030303033363635' TO DFHEIV0(25:11)
  3842     CALL 'kxdfhei1' USING DFHEIV0,
  3843           ELTRLR-FILE-ID,
  3844           DFHEIV20,
  3845           DFHEIV99,
  3846           PI-ACTV-KEY,
  3847           DFHEIV99,
  3848           DFHEIV99,
  3849           DFHEIV99
  3850     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3851         DFHEIV20
  3852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3853
  3854
  3855     MOVE AT-MAIL-TO-NAME        TO ADDR1O.
  3856     MOVE AT-ADDRESS-LINE-1      TO ADDR2O.
  3857     MOVE AT-ADDRESS-LINE-2      TO ADDR3O.
  3858*    MOVE AT-CITY-STATE          TO ADDR4O.
  3859     STRING AT-CITY ' ' AT-STATE
  3860        DELIMITED BY '  ' INTO ADDR4O
  3861     END-STRING
  3862     MOVE AT-PHONE-NO            TO PHONEO.
  3863     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3864
  3865     IF AT-CANADIAN-POST-CODE
  3866         MOVE AT-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3867         MOVE AT-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3868         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  79
* EL162.cbl
  3869                                    WS-CAN-FILLER
  3870         MOVE WS-CANADIAN-POSTAL-CODES
  3871                                 TO ZIPO
  3872     ELSE
  3873         MOVE AT-ZIP-CODE        TO WS-ZIP-CODE
  3874         IF AT-ZIP-PLUS4 = SPACES OR ZEROS
  3875             MOVE SPACES         TO WS-ZIP-PLUS4
  3876                                    WS-DASH
  3877             MOVE WS-ZIP         TO ZIPO
  3878         ELSE
  3879             MOVE AT-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3880             MOVE '-'            TO WS-DASH
  3881             MOVE WS-ZIP         TO ZIPO.
  3882
  3883     GO TO 4299-EXIT.
  3884
  3885 4210-READ-ACCOUNT.
  3886     MOVE PI-COMPANY-CD          TO ACCT-CO.
  3887     MOVE PI-CARRIER             TO ACCT-CARRIER.
  3888     MOVE PI-GROUPING            TO ACCT-GROUPING.
  3889     MOVE PI-STATE               TO ACCT-STATE.
  3890     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  3891     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DATE.
  3892
  3893
  3894* EXEC CICS HANDLE CONDITION
  3895*         NOTOPEN(8880-ACCT-NOT-OPEN)
  3896*         NOTFND (4250-ACCT-NOT-FOUND)
  3897*    END-EXEC.
  3898*    MOVE '"$JI                  ! % #00003709' TO DFHEIV0
  3899     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3901     MOVE X'2520233030303033373039' TO DFHEIV0(25:11)
  3902     CALL 'kxdfhei1' USING DFHEIV0
  3903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3904
  3905
  3906
  3907* EXEC CICS STARTBR
  3908*         RIDFLD   (ACCT-KEY)
  3909*         DATASET  (ERACCT-FILE-ID)
  3910*         KEYLENGTH(13)
  3911*         GENERIC
  3912*    END-EXEC.
  3913     MOVE 13
  3914       TO DFHEIV11
  3915     MOVE 0
  3916       TO DFHEIV12
  3917*    MOVE '&,   KG    G          &   #00003714' TO DFHEIV0
  3918     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3919     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3920     MOVE X'2020233030303033373134' TO DFHEIV0(25:11)
  3921     CALL 'kxdfhei1' USING DFHEIV0,
  3922           ERACCT-FILE-ID,
  3923           ACCT-KEY,
  3924           DFHEIV11,
  3925           DFHEIV12,
  3926           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  80
* EL162.cbl
  3927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3928
  3929
  3930     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  3931
  3932 4230-READNEXT.
  3933
  3934* EXEC CICS READNEXT
  3935*         DATASET(ERACCT-FILE-ID)
  3936*         SET    (ADDRESS OF ACCOUNT-MASTER)
  3937*         RIDFLD (ACCT-KEY)
  3938*    END-EXEC.
  3939     MOVE 0
  3940       TO DFHEIV11
  3941*    MOVE '&.S                   )   #00003724' TO DFHEIV0
  3942     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3943     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3944     MOVE X'2020233030303033373234' TO DFHEIV0(25:11)
  3945     CALL 'kxdfhei1' USING DFHEIV0,
  3946           ERACCT-FILE-ID,
  3947           DFHEIV20,
  3948           DFHEIV99,
  3949           ACCT-KEY,
  3950           DFHEIV99,
  3951           DFHEIV11,
  3952           DFHEIV99,
  3953           DFHEIV99
  3954     SET ADDRESS OF ACCOUNT-MASTER TO
  3955         DFHEIV20
  3956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3957
  3958
  3959     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  3960        GO TO 4250-ACCT-NOT-FOUND.
  3961
  3962     IF PI-CERT-EFF-DT NOT LESS THAN AM-EFFECTIVE-DT AND
  3963        PI-CERT-EFF-DT     LESS THAN AM-EXPIRATION-DT
  3964        NEXT SENTENCE
  3965      ELSE
  3966        GO TO 4230-READNEXT.
  3967
  3968     MOVE AM-NAME                TO ADDR1O.
  3969     MOVE AM-PERSON              TO ADDR2O.
  3970     MOVE AM-ADDRS               TO ADDR3O.
  3971*    MOVE AM-CITY                TO ADDR4O.
  3972     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3973        DELIMITED BY '  ' INTO ADDR4O
  3974     END-STRING
  3975
  3976     MOVE AM-TEL-NO              TO WS-WORK-PHONE.
  3977     INSPECT WS-WORK-PHONE CONVERTING ' ' TO '0'.
  3978     MOVE WS-NUMERIC-PHONE       TO PHONEO.
  3979     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3980
  3981     IF AM-CANADIAN-POST-CODE
  3982         MOVE AM-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3983         MOVE AM-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3984         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  81
* EL162.cbl
  3985                                    WS-CAN-FILLER
  3986         MOVE WS-CANADIAN-POSTAL-CODES
  3987                                 TO ZIPO
  3988     ELSE
  3989         MOVE AM-ZIP-PRIME       TO WS-ZIP-CODE
  3990         IF AM-ZIP-PLUS4 = SPACES OR ZEROS
  3991             MOVE SPACES         TO WS-ZIP-PLUS4
  3992                                    WS-DASH
  3993             MOVE WS-ZIP         TO ZIPO
  3994         ELSE
  3995             MOVE AM-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3996             MOVE '-'            TO WS-DASH
  3997             MOVE WS-ZIP         TO ZIPO.
  3998
  3999     PERFORM 4240-ENDBR.
  4000
  4001     GO TO 4299-EXIT.
  4002
  4003 4240-ENDBR.
  4004
  4005* EXEC CICS ENDBR
  4006*         DATASET(ERACCT-FILE-ID)
  4007*    END-EXEC.
  4008     MOVE 0
  4009       TO DFHEIV11
  4010*    MOVE '&2                    $   #00003775' TO DFHEIV0
  4011     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4012     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4013     MOVE X'2020233030303033373735' TO DFHEIV0(25:11)
  4014     CALL 'kxdfhei1' USING DFHEIV0,
  4015           ERACCT-FILE-ID,
  4016           DFHEIV11,
  4017           DFHEIV99
  4018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4019
  4020
  4021 4250-ACCT-NOT-FOUND.
  4022     PERFORM 4240-ENDBR.
  4023     MOVE ER-0179                TO EMI-ERROR.
  4024     MOVE -1                     TO SC-RECL (1).
  4025     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4026                                    ZIPI PHONEI.
  4027
  4028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4029
  4030 4290-ERROR.
  4031     MOVE ER-0322                TO EMI-ERROR.
  4032     MOVE -1                     TO SC-RECL (1).
  4033     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4034                                    ZIPI PHONEI.
  4035
  4036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4037
  4038 4299-EXIT.
  4039      EXIT.
  4040
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  82
* EL162.cbl
  4042 6000-BROWSE-FORWARD.
  4043     IF PI-ACTV-SAVE NOT = PI-ACTV-PARTIAL
  4044        MOVE ER-0066             TO EMI-ERROR
  4045        MOVE -1                  TO SC-RECL (1)
  4046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4047        GO TO 8200-SEND-DATAONLY.
  4048
  4049     MOVE LOW-VALUES             TO EL162AI.
  4050     ADD 1 TO PI-ACTV-SEQ.
  4051
  4052     GO TO 7000-BUILD-SCREEN.
  4053
  4054 6100-BROWSE-BACKWARD.
  4055
  4056     IF PI-NEXT-TRLR-SUB > 8
  4057        SUBTRACT 4 FROM PI-NEXT-TRLR-SUB.
  4058
  4059     MOVE PI-NEXT-TRLR-SUB       TO SUB.
  4060
  4061     IF SUB = 1 OR 5
  4062        MOVE ER-0067             TO EMI-ERROR
  4063        MOVE -1                  TO SC-RECL (1)
  4064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4065        MOVE  1                  TO SUB
  4066        MOVE  +1                 TO PI-NEXT-TRLR-SUB
  4067     ELSE
  4068        SUBTRACT 4 FROM SUB
  4069        MOVE SUB                 TO PI-NEXT-TRLR-SUB.
  4070
  4071     MOVE LOW-VALUES             TO EL162AI
  4072                                    TRL-LINES.
  4073     MOVE PI-ACTV-SAVE           TO PI-ACTV-PARTIAL.
  4074
  4075     MOVE PI-TRLRS (SUB)         TO PI-ACTV-SEQ.
  4076
  4077     GO TO 7000-BUILD-SCREEN.
  4078
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  83
* EL162.cbl
  4080 6200-FORMAT-DATA.
  4081
  4082     IF FORM-CONTROL-TR
  4083        GO TO 6250-FORMAT-FORM.
  4084
  4085     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
  4086        MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
  4087        MOVE SPACES                TO DC-OPTION-CODE
  4088        PERFORM 9700-DATE-LINK
  4089        MOVE DC-GREG-DATE-1-EDIT   TO SC-REC (SC-INDX).
  4090
  4091     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  4092        MOVE AT-STOP-LETTER-DT     TO DC-BIN-DATE-1
  4093        MOVE SPACES                TO DC-OPTION-CODE
  4094        PERFORM 9700-DATE-LINK
  4095        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4096     END-IF.
  4097
  4098     IF AT-LETTER-SENT-DT NOT = LOW-VALUES
  4099        MOVE AT-LETTER-SENT-DT   TO DC-BIN-DATE-1
  4100        MOVE SPACES              TO DC-OPTION-CODE
  4101        PERFORM 9700-DATE-LINK
  4102        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4103
  4104     IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
  4105        MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
  4106        MOVE SPACES              TO DC-OPTION-CODE
  4107        PERFORM 9700-DATE-LINK
  4108        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4109
  4110     IF AT-RECEIPT-FOLLOW-UP NOT = LOW-VALUES
  4111        MOVE AT-RECEIPT-FOLLOW-UP TO DC-BIN-DATE-1
  4112        MOVE SPACES               TO DC-OPTION-CODE
  4113        PERFORM 9700-DATE-LINK
  4114        MOVE DC-GREG-DATE-1-EDIT  TO SC-FOLLOWUP (SC-INDX).
  4115
  4116     MOVE AT-STD-LETTER-FORM     TO SC-FORM (SC-INDX).
  4117
  4118     IF INSURED-ADDRESEE
  4119        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4120     ELSE
  4121     IF BENEFICIARY-ADDRESEE
  4122        MOVE 'BENEFI '           TO SC-TO (SC-INDX)
  4123     ELSE
  4124     IF ACCOUNT-ADDRESEE
  4125        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4126     ELSE
  4127     IF PHYSICIAN-ADDRESEE
  4128        MOVE 'DOCTOR'            TO SC-TO (SC-INDX)
  4129     ELSE
  4130     IF EMPLOYER-ADDRESEE
  4131        MOVE 'EMPLOYER'          TO SC-TO (SC-INDX)
  4132     ELSE
  4133     IF OTHER-ADDRESEE-1
  4134        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4135     ELSE
  4136        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4137
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  84
* EL162.cbl
  4138     IF AT-LETTER-ARCHIVE-NO NOT = +0
  4139        MOVE AT-LETTER-ARCHIVE-NO TO SC-ARCHIVE (SC-INDX)
  4140     ELSE
  4141        MOVE SPACES              TO SC-ARCHIVE (SC-INDX).
  4142
  4143     MOVE 'L'                    TO SC-TYPE   (SC-INDX).
  4144
  4145     MOVE AT-REASON-TEXT         TO SC-REASON (SC-INDX).
  4146
  4147*    IF PI-COMPANY-ID = 'DMD'
  4148*       IF AT-DMD-LETTER-PURGED
  4149*          MOVE AT-REASON-TEXT          TO WS-REASON
  4150*          MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
  4151*          MOVE SPACES                  TO DC-OPTION-CODE
  4152*          PERFORM 9700-DATE-LINK
  4153*          MOVE 'PURGED -'              TO WS-REASON (51:9)
  4154*          MOVE DC-GREG-DATE-1-EDIT     TO WS-REASON (60:11)
  4155*          MOVE WS-REASON               TO SC-REASON (SC-INDX).
  4156*
  4157     MOVE AT-RECORDED-BY         TO SC-BY     (SC-INDX).
  4158     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO (SC-INDX).
  4159     MOVE AL-UANOF               TO SC-RECA   (SC-INDX)
  4160                                    SC-STOPA  (SC-INDX).
  4161
  4162     GO TO 6299-EXIT.
  4163
  4164 6250-FORMAT-FORM.
  4165
  4166     IF AT-STOP-FORM-DT NOT = LOW-VALUES AND SPACES
  4167        MOVE AT-STOP-FORM-DT       TO DC-BIN-DATE-1
  4168        MOVE SPACES                TO DC-OPTION-CODE
  4169        PERFORM 9700-DATE-LINK
  4170        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4171     END-IF.
  4172
  4173     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4174        IF (AT-FORM-ANSWERED-DT = LOW-VALUES)
  4175                         OR
  4176           (AT-FORM-ANSWERED-DT NOT = LOW-VALUES  AND
  4177            AT-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4178             NEXT SENTENCE
  4179         ELSE
  4180             GO TO 6260-CHECK-EMPLOYER-FORM
  4181     ELSE
  4182        GO TO 6260-CHECK-EMPLOYER-FORM.
  4183
  4184     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
  4185        MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4186        MOVE SPACES              TO DC-OPTION-CODE
  4187        PERFORM 9700-DATE-LINK
  4188        MOVE DC-GREG-DATE-1-EDIT TO SC-REC (SC-INDX).
  4189
  4190     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4191        MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
  4192        MOVE SPACES              TO DC-OPTION-CODE
  4193        PERFORM 9700-DATE-LINK
  4194        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4195
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  85
* EL162.cbl
  4196     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4197        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4198        MOVE SPACES              TO DC-OPTION-CODE
  4199        PERFORM 9700-DATE-LINK
  4200        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4201
  4202     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4203        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4204        MOVE SPACES                 TO DC-OPTION-CODE
  4205        PERFORM 9700-DATE-LINK
  4206        MOVE DC-GREG-DATE-1-EDIT TO SC-FOLLOWUP (SC-INDX).
  4207
  4208     IF AT-FORM-TYPE = '1'
  4209        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4210     ELSE
  4211        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4212
  4213     IF FORM-TO-INSURED
  4214        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4215     ELSE
  4216     IF FORM-TO-ACCOUNT
  4217        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4218     ELSE
  4219     IF FORM-TO-OTHER-1
  4220        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4221     ELSE
  4222     IF FORM-TO-OTHER-2
  4223        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4224
  4225     MOVE 'CLAIMANT'             TO SC-ARCHIVE (SC-INDX).
  4226     MOVE 'C'                    TO SC-TYPE    (SC-INDX).
  4227     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4228     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4229     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4230     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4231     MOVE AL-UANOF               TO SC-RECA    (SC-INDX).
  4232     MOVE AL-UANOF               TO SC-STOPA   (SC-INDX).
  4233
  4234 6260-CHECK-EMPLOYER-FORM.
  4235
  4236     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4237        IF (AT-EMP-FORM-ANSWERED-DT = LOW-VALUES)
  4238                          OR
  4239           (AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4240            AT-EMP-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4241              NEXT SENTENCE
  4242          ELSE
  4243              GO TO 6280-CHECK-PHYSICIAN-FORM
  4244     ELSE
  4245        GO TO 6280-CHECK-PHYSICIAN-FORM.
  4246
  4247     IF SC-TYPE (SC-INDX) = 'C'
  4248        SET SC-INDX UP BY 1
  4249        ADD +1 TO PI-NEXT-TRLR-SUB.
  4250
  4251     IF AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES
  4252        MOVE AT-EMP-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4253        MOVE SPACES                  TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  86
* EL162.cbl
  4254        PERFORM 9700-DATE-LINK
  4255        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4256
  4257     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4258        MOVE AT-EMP-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4259        MOVE SPACES                 TO DC-OPTION-CODE
  4260        PERFORM 9700-DATE-LINK
  4261        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4262
  4263     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4264        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4265        MOVE SPACES              TO DC-OPTION-CODE
  4266        PERFORM 9700-DATE-LINK
  4267        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4268
  4269     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4270        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4271        MOVE SPACES                 TO DC-OPTION-CODE
  4272        PERFORM 9700-DATE-LINK
  4273        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4274
  4275     IF AT-FORM-TYPE = '1'
  4276        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4277     ELSE
  4278        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4279
  4280     IF FORM-TO-INSURED
  4281        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4282     ELSE
  4283     IF FORM-TO-ACCOUNT
  4284        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4285     ELSE
  4286     IF FORM-TO-OTHER-1
  4287        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4288     ELSE
  4289     IF FORM-TO-OTHER-2
  4290        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4291
  4292     MOVE 'EMPLOYER'             TO SC-ARCHIVE (SC-INDX).
  4293     MOVE 'E'                    TO SC-TYPE    (SC-INDX).
  4294     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4295     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4296     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4297     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4298     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4299                                    SC-STOPA   (SC-INDX).
  4300
  4301 6280-CHECK-PHYSICIAN-FORM.
  4302
  4303     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4304        IF (AT-PHY-FORM-ANSWERED-DT = LOW-VALUES)
  4305                         OR
  4306           (AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4307            AT-PHY-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4308              NEXT SENTENCE
  4309          ELSE
  4310              GO TO 6299-EXIT
  4311     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  87
* EL162.cbl
  4312        GO TO 6299-EXIT.
  4313
  4314     IF SC-TYPE (SC-INDX) = 'C' OR 'E'
  4315        SET SC-INDX UP BY 1
  4316        ADD +1 TO PI-NEXT-TRLR-SUB.
  4317
  4318     IF AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES
  4319        MOVE AT-PHY-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4320        MOVE SPACES                  TO DC-OPTION-CODE
  4321        PERFORM 9700-DATE-LINK
  4322        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4323
  4324     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4325        MOVE AT-PHY-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4326        MOVE SPACES                 TO DC-OPTION-CODE
  4327        PERFORM 9700-DATE-LINK
  4328        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4329
  4330     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4331        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4332        MOVE SPACES              TO DC-OPTION-CODE
  4333        PERFORM 9700-DATE-LINK
  4334        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4335
  4336     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4337        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4338        MOVE SPACES                 TO DC-OPTION-CODE
  4339        PERFORM 9700-DATE-LINK
  4340        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4341
  4342     IF AT-FORM-TYPE = '1'
  4343        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4344     ELSE
  4345        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4346
  4347     IF FORM-TO-INSURED
  4348        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4349     ELSE
  4350     IF FORM-TO-ACCOUNT
  4351        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4352     ELSE
  4353     IF FORM-TO-OTHER-1
  4354        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4355     ELSE
  4356     IF FORM-TO-OTHER-2
  4357        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4358
  4359     MOVE ' DOCTOR '             TO SC-ARCHIVE (SC-INDX).
  4360     MOVE 'P'                    TO SC-TYPE    (SC-INDX).
  4361     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4362     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4363     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4364     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4365     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4366                                    SC-STOPA   (SC-INDX).
  4367
  4368 6299-EXIT.
  4369      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  88
* EL162.cbl
  4370
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  89
* EL162.cbl
  4372 7000-BUILD-SCREEN.
  4373
  4374     IF PI-CLAIM-NO = SPACES
  4375        MOVE ER-0319             TO EMI-ERROR
  4376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4377        GO TO 8100-SEND-INITIAL-MAP.
  4378
  4379     PERFORM 3000-BUILD-KEYS.
  4380
  4381     MOVE PI-PROCESSOR-ID        TO UBYI.
  4382
  4383
  4384* EXEC CICS HANDLE CONDITION
  4385*         NOTOPEN(8870-CLAIM-NOT-OPEN)
  4386*         NOTFND (8860-CLAIM-NOT-FOUND)
  4387*    END-EXEC.
  4388*    MOVE '"$JI                  ! & #00004141' TO DFHEIV0
  4389     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4391     MOVE X'2620233030303034313431' TO DFHEIV0(25:11)
  4392     CALL 'kxdfhei1' USING DFHEIV0
  4393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4394
  4395
  4396
  4397* EXEC CICS READ
  4398*         DATASET(ELMSTR-FILE-ID)
  4399*         RIDFLD (PI-CLAM-KEY)
  4400*         SET    (ADDRESS OF CLAIM-MASTER)
  4401*    END-EXEC.
  4402*    MOVE '&"S        E          (   #00004146' TO DFHEIV0
  4403     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4405     MOVE X'2020233030303034313436' TO DFHEIV0(25:11)
  4406     CALL 'kxdfhei1' USING DFHEIV0,
  4407           ELMSTR-FILE-ID,
  4408           DFHEIV20,
  4409           DFHEIV99,
  4410           PI-CLAM-KEY,
  4411           DFHEIV99,
  4412           DFHEIV99,
  4413           DFHEIV99
  4414     SET ADDRESS OF CLAIM-MASTER TO
  4415         DFHEIV20
  4416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4417
  4418
  4419     EVALUATE TRUE
  4420     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  4421        MOVE PI-LIFE-OVERRIDE-L6 TO TYPEI
  4422     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  4423        MOVE PI-AH-OVERRIDE-L6   TO TYPEI
  4424     WHEN CL-CLAIM-TYPE = 'I'
  4425        MOVE ' IU   '            TO TYPEI
  4426     WHEN CL-CLAIM-TYPE = 'G'
  4427        MOVE ' GAP  '            TO TYPEI
  4428
  4429     WHEN CL-CLAIM-TYPE = 'F'
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  90
* EL162.cbl
  4430        MOVE ' FAM  '            TO TYPEI
  4431     END-EVALUATE
  4432
  4433     MOVE CL-INSURED-LAST-NAME   TO LASTNMEI.
  4434     MOVE CL-FILE-LOCATION       TO FILEI.
  4435     MOVE PI-ACTV-PARTIAL        TO PI-ACTV-SAVE.
  4436
  4437     IF CL-1ST-TRL-AVAIL
  4438        GO TO 7100-NOT-FOUND.
  4439
  4440 7010-START-BROWSE.
  4441
  4442
  4443* EXEC CICS HANDLE CONDITION
  4444*         NOTOPEN(8820-ACTV-NOT-OPEN)
  4445*         NOTFND (7100-NOT-FOUND)
  4446*         ENDFILE(7100-NOT-FOUND)
  4447*    END-EXEC.
  4448*    MOVE '"$JI''                 ! '' #00004175' TO DFHEIV0
  4449     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4451     MOVE X'2720233030303034313735' TO DFHEIV0(25:11)
  4452     CALL 'kxdfhei1' USING DFHEIV0
  4453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4454
  4455
  4456
  4457* EXEC CICS STARTBR
  4458*         DATASET(ELTRLR-FILE-ID)
  4459*         RIDFLD (PI-ACTV-KEY)
  4460*         GTEQ
  4461*    END-EXEC.
  4462     MOVE 0
  4463       TO DFHEIV11
  4464*    MOVE '&,         G          &   #00004181' TO DFHEIV0
  4465     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4466     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4467     MOVE X'2020233030303034313831' TO DFHEIV0(25:11)
  4468     CALL 'kxdfhei1' USING DFHEIV0,
  4469           ELTRLR-FILE-ID,
  4470           PI-ACTV-KEY,
  4471           DFHEIV99,
  4472           DFHEIV11,
  4473           DFHEIV99
  4474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4475
  4476
  4477     SET SC-INDX TO 1.
  4478
  4479 7020-READ-NEXT.
  4480
  4481
  4482* EXEC CICS READNEXT
  4483*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  4484*         RIDFLD   (PI-ACTV-KEY)
  4485*         DATASET  (ELTRLR-FILE-ID)
  4486*    END-EXEC.
  4487     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  91
* EL162.cbl
  4488       TO DFHEIV11
  4489*    MOVE '&.S                   )   #00004191' TO DFHEIV0
  4490     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4491     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4492     MOVE X'2020233030303034313931' TO DFHEIV0(25:11)
  4493     CALL 'kxdfhei1' USING DFHEIV0,
  4494           ELTRLR-FILE-ID,
  4495           DFHEIV20,
  4496           DFHEIV99,
  4497           PI-ACTV-KEY,
  4498           DFHEIV99,
  4499           DFHEIV11,
  4500           DFHEIV99,
  4501           DFHEIV99
  4502     SET ADDRESS OF ACTIVITY-TRAILERS TO
  4503         DFHEIV20
  4504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4505
  4506
  4507     IF PI-ACTV-PARTIAL NOT = PI-ACTV-SAVE
  4508        GO TO 7100-NOT-FOUND.
  4509
  4510     IF AT-TRAILER-TYPE = '4' OR  'A'
  4511        NEXT SENTENCE
  4512     ELSE
  4513        GO TO 7020-READ-NEXT.
  4514
  4515     IF CORRESPONDENCE-TR
  4516        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND
  4517           AT-LETTER-ANSWERED-DT NOT = BIN-CURRENT-DATE
  4518             GO TO 7020-READ-NEXT.
  4519
  4520     IF CORRESPONDENCE-TR AND
  4521        AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND
  4522        AT-RESEND-LETTER-FORM NOT = LOW-VALUES
  4523             GO TO 7020-READ-NEXT
  4524     END-IF.
  4525
  4526     IF CORRESPONDENCE-TR AND
  4527        AT-STOP-LETTER-DT NOT = LOW-VALUES AND
  4528        AT-STOP-LETTER-DT NOT = SPACES AND
  4529        AT-STOP-LETTER-DT NOT = BIN-CURRENT-DATE
  4530*        AT-STOP-LETTER-DT = AT-LETTER-SENT-DT
  4531             GO TO 7020-READ-NEXT
  4532     END-IF.
  4533
  4534     IF NOT FORM-CONTROL-TR
  4535        GO TO 7030-CONTINUE.
  4536
  4537     IF ((AT-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4538          AT-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4539          AT-FORM-SEND-ON-DT = LOW-VALUES)
  4540       AND
  4541        ((AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4542          AT-EMP-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4543          AT-EMP-FORM-SEND-ON-DT = LOW-VALUES)
  4544       AND
  4545        ((AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  92
* EL162.cbl
  4546          AT-PHY-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4547          AT-PHY-FORM-SEND-ON-DT = LOW-VALUES)
  4548             GO TO 7020-READ-NEXT.
  4549
  4550     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) AND
  4551        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4552        IF SC-INDX > 2
  4553           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4554           GO TO 7040-END-BUILD-SCREEN.
  4555
  4556     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) OR
  4557        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4558        IF SC-INDX > 3
  4559           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4560           GO TO 7040-END-BUILD-SCREEN.
  4561
  4562 7030-CONTINUE.
  4563
  4564     PERFORM 6200-FORMAT-DATA THRU 6299-EXIT.
  4565
  4566     MOVE PI-ACTV-SEQ             TO PI-ACTV-SAVE-SEQ.
  4567
  4568     MOVE AT-SEQUENCE-NO          TO PI-TRLRS (PI-NEXT-TRLR-SUB).
  4569
  4570     ADD 1   TO PI-NEXT-TRLR-SUB.
  4571     SET SC-INDX UP BY 1.
  4572
  4573     IF SC-INDX NOT = 5
  4574        GO TO 7020-READ-NEXT.
  4575
  4576 7040-END-BUILD-SCREEN.
  4577
  4578     IF SC-INDX = +2
  4579        ADD +3 TO PI-NEXT-TRLR-SUB
  4580     ELSE
  4581     IF SC-INDX = +3
  4582        ADD +2 TO PI-NEXT-TRLR-SUB
  4583     ELSE
  4584     IF SC-INDX = +4
  4585        ADD +1 TO PI-NEXT-TRLR-SUB.
  4586
  4587     MOVE -1                     TO SC-RECL (1).
  4588     GO TO 8100-SEND-INITIAL-MAP.
  4589
  4590 7100-NOT-FOUND.
  4591     IF PI-NEXT-TRLR-SUB = 1
  4592        MOVE ER-0320             TO EMI-ERROR
  4593        MOVE -1                  TO URECDTEL
  4594        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4595        GO TO 8100-SEND-INITIAL-MAP.
  4596
  4597     MOVE -1                     TO SC-RECL (1).
  4598
  4599*    IF ANY LINES WERE PRINTED THEN
  4600*    SET THE SUB TO ALWAYS BE 1 GREATER THAN A MULTIPLE OF 4.
  4601
  4602     SET INDX-WORK TO SC-INDX.
  4603
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  93
* EL162.cbl
  4604     IF SC-INDX NOT = 1
  4605        COMPUTE PI-NEXT-TRLR-SUB = (4 - INDX-WORK) + 1 +
  4606                                    PI-NEXT-TRLR-SUB.
  4607
  4608     IF EIBAID NOT = DFHPF1
  4609        GO TO 8100-SEND-INITIAL-MAP.
  4610
  4611     MOVE ER-0066                TO EMI-ERROR.
  4612     MOVE -1                     TO SC-RECL (1).
  4613
  4614     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4615
  4616     GO TO 8100-SEND-INITIAL-MAP.
  4617
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  94
* EL162.cbl
  4619 8100-SEND-INITIAL-MAP.
  4620     MOVE SAVE-DATE    TO RUNDTEO.
  4621     MOVE EIBTIME      TO TIME-IN.
  4622     MOVE TIME-OUT     TO RUNTIMEO.
  4623
  4624     IF NOT EMI-NO-ERRORS
  4625         SET EMI-INDX TO 1
  4626         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSG1O.
  4627
  4628     IF PI-COMPANY-ID NOT = 'DMD'
  4629         MOVE SPACES             TO PF4KEYO.
  4630
  4631     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4632         MOVE SPACES             TO PF5KEYO.
  4633
  4634
  4635* EXEC CICS SEND
  4636*        MAP   (MAP-NAME)
  4637*        MAPSET(MAPSET-NAME)
  4638*        FROM  (EL162AO)
  4639*        ERASE
  4640*        CURSOR
  4641*    END-EXEC.
  4642     MOVE LENGTH OF
  4643      EL162AO
  4644       TO DFHEIV12
  4645     MOVE -1
  4646       TO DFHEIV11
  4647*    MOVE '8$     CT  E    H L F ,   #00004324' TO DFHEIV0
  4648     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4649     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4650     MOVE X'2020233030303034333234' TO DFHEIV0(25:11)
  4651     CALL 'kxdfhei1' USING DFHEIV0,
  4652           MAP-NAME,
  4653           EL162AO,
  4654           DFHEIV12,
  4655           MAPSET-NAME,
  4656           DFHEIV99,
  4657           DFHEIV99,
  4658           DFHEIV99,
  4659           DFHEIV11,
  4660           DFHEIV99,
  4661           DFHEIV99,
  4662           DFHEIV99
  4663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4664
  4665
  4666     GO TO 9100-RETURN-TRAN.
  4667
  4668 8200-SEND-DATAONLY.
  4669     MOVE SAVE-DATE            TO RUNDTEO.
  4670     MOVE EIBTIME              TO TIME-IN.
  4671     MOVE TIME-OUT             TO RUNTIMEO.
  4672     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4673
  4674     IF PI-COMPANY-ID NOT = 'DMD'
  4675         MOVE SPACES             TO PF4KEYO.
  4676
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  95
* EL162.cbl
  4677     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4678         MOVE SPACES             TO PF5KEYO.
  4679
  4680
  4681* EXEC CICS SEND
  4682*        MAP   (MAP-NAME)
  4683*        MAPSET(MAPSET-NAME)
  4684*        FROM  (EL162AO)
  4685*        DATAONLY
  4686*        CURSOR
  4687*    END-EXEC.
  4688     MOVE LENGTH OF
  4689      EL162AO
  4690       TO DFHEIV12
  4691     MOVE -1
  4692       TO DFHEIV11
  4693*    MOVE '8$D    CT       H L F ,   #00004346' TO DFHEIV0
  4694     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4695     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4696     MOVE X'2020233030303034333436' TO DFHEIV0(25:11)
  4697     CALL 'kxdfhei1' USING DFHEIV0,
  4698           MAP-NAME,
  4699           EL162AO,
  4700           DFHEIV12,
  4701           MAPSET-NAME,
  4702           DFHEIV99,
  4703           DFHEIV99,
  4704           DFHEIV99,
  4705           DFHEIV11,
  4706           DFHEIV99,
  4707           DFHEIV99,
  4708           DFHEIV99
  4709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4710
  4711
  4712     GO TO 9100-RETURN-TRAN.
  4713
  4714 8300-SEND-TEXT.
  4715
  4716* EXEC CICS SEND TEXT
  4717*        FROM  (LOGOFF-TEXT)
  4718*        LENGTH(LOGOFF-LENGTH)
  4719*        ERASE
  4720*        FREEKB
  4721*    END-EXEC.
  4722*    MOVE '8&      T  E F  H   F -   #00004357' TO DFHEIV0
  4723     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4724     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4725     MOVE X'2020233030303034333537' TO DFHEIV0(25:11)
  4726     CALL 'kxdfhei1' USING DFHEIV0,
  4727           LOGOFF-TEXT,
  4728           LOGOFF-LENGTH,
  4729           DFHEIV99,
  4730           DFHEIV99,
  4731           DFHEIV99,
  4732           DFHEIV99,
  4733           DFHEIV99,
  4734           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  96
* EL162.cbl
  4735           DFHEIV99,
  4736           DFHEIV99,
  4737           DFHEIV99,
  4738           DFHEIV99
  4739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4740
  4741
  4742
  4743* EXEC CICS RETURN
  4744*    END-EXEC.
  4745*    MOVE '.(                    ''   #00004364' TO DFHEIV0
  4746     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4747     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4748     MOVE X'2020233030303034333634' TO DFHEIV0(25:11)
  4749     CALL 'kxdfhei1' USING DFHEIV0,
  4750           DFHEIV99,
  4751           DFHEIV99,
  4752           DFHEIV99,
  4753           DFHEIV99,
  4754           DFHEIV99,
  4755           DFHEIV99
  4756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4757
  4758
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  97
* EL162.cbl
  4760 8600-DEEDIT.
  4761
  4762* EXEC CICS BIF DEEDIT
  4763*        FIELD (DEEDIT-FIELD)
  4764*        LENGTH(15)
  4765*    END-EXEC.
  4766     MOVE 15
  4767       TO DFHEIV11
  4768*    MOVE '@"L                   #   #00004369' TO DFHEIV0
  4769     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4770     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4771     MOVE X'2020233030303034333639' TO DFHEIV0(25:11)
  4772     CALL 'kxdfhei1' USING DFHEIV0,
  4773           DEEDIT-FIELD,
  4774           DFHEIV11
  4775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4776
  4777
  4778 8800-UNAUTHORIZED-ACCESS.
  4779     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  4780     GO TO 8300-SEND-TEXT.
  4781
  4782 8810-PF23.
  4783     MOVE EIBAID                   TO PI-ENTRY-CD-1.
  4784     MOVE XCTL-005 TO PGM-NAME.
  4785     GO TO 9300-XCTL.
  4786
  4787 8820-ACTV-NOT-OPEN.
  4788     MOVE ER-0172                TO EMI-ERROR.
  4789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4790     GO TO 8200-SEND-DATAONLY.
  4791
  4792 8860-CLAIM-NOT-FOUND.
  4793     MOVE ER-0319                TO EMI-ERROR.
  4794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4795     GO TO 8100-SEND-INITIAL-MAP.
  4796
  4797 8870-CLAIM-NOT-OPEN.
  4798     MOVE ER-0042                TO EMI-ERROR.
  4799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4800     GO TO 8200-SEND-DATAONLY.
  4801
  4802 8880-ACCT-NOT-OPEN.
  4803     MOVE ER-0168                TO EMI-ERROR
  4804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4805     GO TO 8200-SEND-DATAONLY.
  4806
  4807 9100-RETURN-TRAN.
  4808     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4809     MOVE MAP-NUMBER           TO PI-CURRENT-SCREEN-NO.
  4810
  4811* EXEC CICS RETURN
  4812*        TRANSID(TRANS-ID)
  4813*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4814*        LENGTH(PI-COMM-LENGTH)
  4815*    END-EXEC.
  4816*    MOVE '.(CT                  ''   #00004406' TO DFHEIV0
  4817     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  98
* EL162.cbl
  4818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4819     MOVE X'2020233030303034343036' TO DFHEIV0(25:11)
  4820     CALL 'kxdfhei1' USING DFHEIV0,
  4821           TRANS-ID,
  4822           PROGRAM-INTERFACE-BLOCK,
  4823           PI-COMM-LENGTH,
  4824           DFHEIV99,
  4825           DFHEIV99,
  4826           DFHEIV99
  4827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4828
  4829
  4830 9200-RETURN-MAIN-MENU.
  4831     MOVE XCTL-126 TO PGM-NAME.
  4832     GO TO 9300-XCTL.
  4833
  4834 9300-XCTL.
  4835
  4836* EXEC CICS XCTL
  4837*        PROGRAM(PGM-NAME)
  4838*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4839*        LENGTH(PI-COMM-LENGTH)
  4840*    END-EXEC.
  4841*    MOVE '.$C                   %   #00004417' TO DFHEIV0
  4842     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4844     MOVE X'2020233030303034343137' TO DFHEIV0(25:11)
  4845     CALL 'kxdfhei1' USING DFHEIV0,
  4846           PGM-NAME,
  4847           PROGRAM-INTERFACE-BLOCK,
  4848           PI-COMM-LENGTH,
  4849           DFHEIV99
  4850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4851
  4852
  4853 9400-CLEAR.
  4854     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4855     GO TO 9300-XCTL.
  4856
  4857 9500-PF12.
  4858     MOVE XCTL-010 TO PGM-NAME.
  4859     GO TO 9300-XCTL.
  4860
  4861 9600-PGMID-ERROR.
  4862
  4863* EXEC CICS HANDLE CONDITION
  4864*        PGMIDERR(8300-SEND-TEXT)
  4865*    END-EXEC.
  4866*    MOVE '"$L                   ! ( #00004432' TO DFHEIV0
  4867     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4869     MOVE X'2820233030303034343332' TO DFHEIV0(25:11)
  4870     CALL 'kxdfhei1' USING DFHEIV0
  4871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4872
  4873
  4874     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4875     MOVE ' '          TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page  99
* EL162.cbl
  4876     MOVE XCTL-005     TO PGM-NAME.
  4877     MOVE PGM-NAME     TO LOGOFF-PGM.
  4878     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4879     GO TO 9300-XCTL.
  4880
  4881 9700-DATE-LINK.
  4882     MOVE LINK-ELDATCV           TO PGM-NAME.
  4883
  4884
  4885* EXEC CICS LINK
  4886*         PROGRAM (PGM-NAME)
  4887*         COMMAREA(DATE-CONVERSION-DATA)
  4888*         LENGTH  (DC-COMM-LENGTH)
  4889*    END-EXEC.
  4890*    MOVE '."C                   (   #00004446' TO DFHEIV0
  4891     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4893     MOVE X'2020233030303034343436' TO DFHEIV0(25:11)
  4894     CALL 'kxdfhei1' USING DFHEIV0,
  4895           PGM-NAME,
  4896           DATE-CONVERSION-DATA,
  4897           DC-COMM-LENGTH,
  4898           DFHEIV99,
  4899           DFHEIV99,
  4900           DFHEIV99,
  4901           DFHEIV99
  4902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4903
  4904
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page 100
* EL162.cbl
  4906 9900-ERROR-FORMAT.
  4907     IF NOT EMI-ERRORS-COMPLETE
  4908         MOVE LINK-001 TO PGM-NAME
  4909
  4910* EXEC CICS LINK
  4911*            PROGRAM (PGM-NAME)
  4912*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4913*            LENGTH  (EMI-COMM-LENGTH)
  4914*        END-EXEC.
  4915*    MOVE '."C                   (   #00004456' TO DFHEIV0
  4916     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4917     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4918     MOVE X'2020233030303034343536' TO DFHEIV0(25:11)
  4919     CALL 'kxdfhei1' USING DFHEIV0,
  4920           PGM-NAME,
  4921           ERROR-MESSAGE-INTERFACE-BLOCK,
  4922           EMI-COMM-LENGTH,
  4923           DFHEIV99,
  4924           DFHEIV99,
  4925           DFHEIV99,
  4926           DFHEIV99
  4927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4928
  4929
  4930 9900-EXIT.
  4931     EXIT.
  4932
  4933 9990-ABEND.
  4934     MOVE LINK-004 TO PGM-NAME.
  4935     MOVE DFHEIBLK TO EMI-LINE1.
  4936
  4937
  4938* EXEC CICS LINK
  4939*        PROGRAM (PGM-NAME)
  4940*        COMMAREA(EMI-LINE1)
  4941*        LENGTH  (72)
  4942*    END-EXEC.
  4943     MOVE 72
  4944       TO DFHEIV11
  4945*    MOVE '."C                   (   #00004469' TO DFHEIV0
  4946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4948     MOVE X'2020233030303034343639' TO DFHEIV0(25:11)
  4949     CALL 'kxdfhei1' USING DFHEIV0,
  4950           PGM-NAME,
  4951           EMI-LINE1,
  4952           DFHEIV11,
  4953           DFHEIV99,
  4954           DFHEIV99,
  4955           DFHEIV99,
  4956           DFHEIV99
  4957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4958
  4959
  4960     GO TO 8200-SEND-DATAONLY.
  4961
  4962 9995-SECURITY-VIOLATION.
  4963*                            COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page 101
* EL162.cbl
  4964******************************************************************
  4965*                                                                *
  4966*                            ELCSCTP                             *
  4967*                            VMOD=2.001                          *
  4968*                                                                *
  4969*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4970******************************************************************
  4971
  4972
  4973     MOVE EIBDATE          TO SM-JUL-DATE.
  4974     MOVE EIBTRMID         TO SM-TERMID.
  4975     MOVE THIS-PGM         TO SM-PGM.
  4976     MOVE EIBTIME          TO TIME-IN.
  4977     MOVE TIME-OUT         TO SM-TIME.
  4978     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4979
  4980
  4981* EXEC CICS LINK
  4982*         PROGRAM  ('EL003')
  4983*         COMMAREA (SECURITY-MESSAGE)
  4984*         LENGTH   (80)
  4985*    END-EXEC.
  4986     MOVE 'EL003' TO DFHEIV1
  4987     MOVE 80
  4988       TO DFHEIV11
  4989*    MOVE '."C                   (   #00004495' TO DFHEIV0
  4990     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4992     MOVE X'2020233030303034343935' TO DFHEIV0(25:11)
  4993     CALL 'kxdfhei1' USING DFHEIV0,
  4994           DFHEIV1,
  4995           SECURITY-MESSAGE,
  4996           DFHEIV11,
  4997           DFHEIV99,
  4998           DFHEIV99,
  4999           DFHEIV99,
  5000           DFHEIV99
  5001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5002
  5003
  5004******************************************************************
  5005
  5006
  5007
  5008 9999-DFHBACK SECTION.
  5009     MOVE '9%                    "   ' TO DFHEIV0
  5010     MOVE 'EL162' TO DFHEIV1
  5011     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5012     GOBACK.
  5013 9999-DFHEXIT.
  5014     IF DFHEIGDJ EQUAL 0001
  5015         NEXT SENTENCE
  5016     ELSE IF DFHEIGDJ EQUAL 2
  5017         GO TO 9600-PGMID-ERROR,
  5018               9990-ABEND
  5019         DEPENDING ON DFHEIGDI
  5020     ELSE IF DFHEIGDJ EQUAL 3
  5021         GO TO 4199-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:14 Page 102
* EL162.cbl
  5022         DEPENDING ON DFHEIGDI
  5023     ELSE IF DFHEIGDJ EQUAL 4
  5024         GO TO 4290-ERROR
  5025         DEPENDING ON DFHEIGDI
  5026     ELSE IF DFHEIGDJ EQUAL 5
  5027         GO TO 8880-ACCT-NOT-OPEN,
  5028               4250-ACCT-NOT-FOUND
  5029         DEPENDING ON DFHEIGDI
  5030     ELSE IF DFHEIGDJ EQUAL 6
  5031         GO TO 8870-CLAIM-NOT-OPEN,
  5032               8860-CLAIM-NOT-FOUND
  5033         DEPENDING ON DFHEIGDI
  5034     ELSE IF DFHEIGDJ EQUAL 7
  5035         GO TO 8820-ACTV-NOT-OPEN,
  5036               7100-NOT-FOUND,
  5037               7100-NOT-FOUND
  5038         DEPENDING ON DFHEIGDI
  5039     ELSE IF DFHEIGDJ EQUAL 8
  5040         GO TO 8300-SEND-TEXT
  5041         DEPENDING ON DFHEIGDI.
  5042     MOVE '9%                    "   ' TO DFHEIV0
  5043     MOVE 'EL162' TO DFHEIV1
  5044     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5045     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4876     Code:       13959
