* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 020317  IR2016110900001  PEMA  FIXED MISC PROBLEMS
    37* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    38* 111418  CR2018103100001  PEMA  ADD REISSUE CAPABILITY
    39* 040919  CR2019040900001  PEMA  FIX RETURN TO ON REISSUES
    40* 111219  CR2019110700001  PEMA  ALLOW REVERSAL OF VOID ON SAME DA
    41* 030921  CR2019012500003  PEMA  Connect to sdv-db01.cso.local
    42******************************************************************
    43 ENVIRONMENT DIVISION.
    44
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    51 77  s1                          pic s999 comp-3 value +0.
    52 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    53 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    54 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    55 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    56 77  ws-pyaj-browse-sw           pic x value spaces.
    57     88  pyaj-browse-started        value 'Y'.
    58 77  ws-browse-sw                pic x value spaces.
    59     88  i-say-when                 value 'Y'.
    60 77  ws-delete-sw                pic x value ' '.
    61     88  row-deleted                 value 'Y'.
    62 77  ws-sql-code                 pic s9(7) value zeros.
    63 77  ws-dis-sql-code             pic -9999999 value zeros.
    64 77  ws-match-sw                 pic x  value ' '.
    65     88  found-a-match             value 'Y'.
    66 77  ws-commit-sw                pic x value ' '.
    67     88  tbl-commited                value 'Y'.
    68 01  P pointer.
    69 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    70 01  var-ptr pointer.
    71 01  env-var-len                 pic 9(4)  binary.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   3
* EL677.cbl
    72
    73 01  WS-KIXSYS.
    74     05  WS-KIX-FIL1             PIC X(10).
    75     05  WS-KIX-APPS             PIC X(10).
    76     05  WS-KIX-ENV              PIC X(10).
    77     05  WS-KIX-MYENV            PIC X(10).
    78     05  WS-KIX-SYS              PIC X(10).
*   79 EXEC SQL
*   80    INCLUDE SQLDA
*   81 END-EXEC
    82 01 SQLDA sync.
    83    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    84    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    85    05 SQLN                  PIC S9(4) COMP-5 value 0.
    86    05 SQLD                  PIC S9(4) COMP-5 value 0.
    87    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    88       10 SQLTYPE            PIC S9(4) COMP-5.
    89       10 SQLLEN             PIC S9(4) COMP-5.
    90$IF P64 SET
    91X      *> For 64-bit environments, ensure that SQLDATA is
    92X      *> aligned on an 8-byte boundary.
    93X      10 FILLER             PIC S9(9) COMP-5.
    94$END
    95       10 SQLDATA            USAGE POINTER.
    96       10 SQLIND             USAGE POINTER.
    97       10 SQLNAME.
    98          15 SQLNAMEL        PIC S9(4) COMP-5.
    99          15 SQLNAMEC        PIC X(30).
   100
   101* Values for SQLTYPE
   102
   103 78  ESQL-DATE-CHAR              VALUE 384.
   104 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   105 78  ESQL-DATE-REC               VALUE 386.
   106 78  ESQL-DATE-REC-NULL          VALUE 387.
   107 78  ESQL-TIME-CHAR              VALUE 388.
   108 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   109 78  ESQL-TIME-REC               VALUE 390.
   110 78  ESQL-TIME-REC-NULL          VALUE 391.
   111 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   112 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   113 78  ESQL-TIMESTAMP-REC          VALUE 394.
   114 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   115 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   116 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   117 78  ESQL-TS-OFFSET-REC          VALUE 398.
   118 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   119 78  ESQL-LONGVARBINARY          VALUE 404.
   120 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   121 78  ESQL-LONGVARCHAR            VALUE 408.
   122 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   123 78  ESQL-BINARY                 VALUE 444.
   124 78  ESQL-BINARY-NULL            VALUE 445.
   125 78  ESQL-VARBINARY              VALUE 446.
   126 78  ESQL-VARBINARY-NULL         VALUE 447.
   127 78  ESQL-VARCHAR                VALUE 448.
   128 78  ESQL-VARCHAR-NULL           VALUE 449.
   129
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   131 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   132
   133 78  ESQL-CHAR                   VALUE 452.
   134 78  ESQL-CHAR-NULL              VALUE 453.
   135
   136 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   137 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   138
   139 78  ESQL-DOUBLE                 VALUE 480.
   140 78  ESQL-DOUBLE-NULL            VALUE 481.
   141 78  ESQL-REAL                   VALUE 482.
   142 78  ESQL-REAL-NULL              VALUE 483.
   143 78  ESQL-DECIMAL                VALUE 484.
   144 78  ESQL-DECIMAL-NULL           VALUE 485.
   145 78  ESQL-INTEGER                VALUE 496.
   146 78  ESQL-INTEGER-NULL           VALUE 497.
   147 78  ESQL-SMALLINT               VALUE 500.
   148 78  ESQL-SMALLINT-NULL          VALUE 501.
   149 78  ESQL-TINYINT                VALUE 502.
   150 78  ESQL-TINYINT-NULL           VALUE 503.
*  151 EXEC SQL
*  152    INCLUDE SQLCA
*  153 END-EXEC
   154 01 SQLCA.
   155     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   156     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   157     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   158     05  SQLERRM.
   159         49  SQLERRML    PIC S9(4) COMP-5.
   160         49  SQLERRMC    PIC X(70).
   161     05  SQLERRP         PIC X(8).
   162     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   163     05  SQLWARN.
   164         10  SQLWARN0    PIC X.
   165         10  SQLWARN1    PIC X.
   166         10  SQLWARN2    PIC X.
   167         10  SQLWARN3    PIC X.
   168         10  SQLWARN4    PIC X.
   169         10  SQLWARN5    PIC X.
   170         10  SQLWARN6    PIC X.
   171         10  SQLWARN7    PIC X.
   172     05  SQLEXT.
   173         10  SQLWARN8    PIC X.
   174         10  SQLWARN9    PIC X.
   175         10  SQLWARN10   PIC X.
   176         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   177     05  SQLSTATE    PIC X(5).
   178 EXEC SQL
   179    BEGIN DECLARE SECTION
   180 END-EXEC
   181 01  ws-paid-bank-work-area.
   182     05  ws-pb-compid            pic x(9).
   183     05  ws-pb-check-no          pic x(10).
   184     05  ws-pb-bad-check-no      pic x(10).
   185     05  ws-check-amount         pic x(10).
   186 01  Paid-Bank-Info.
   187     05  pb-check-no             pic 9(10).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   5
* EL677.cbl
   188     05  pb-tran-type            pic x.
   189     05  pb-bank-acct-desc       pic x(50).
   190     05  pb-amount               pic x(12).
   191     05  pb-paid-date            pic x(25).
   192 01  ws-key-stuff.
   193     05  ws-compid               pic xxx.
   194     05  ws-carrier              pic x.
   195     05  ws-grouping             pic x(6).
   196     05  ws-state                pic xx.
   197     05  ws-account              pic x(10).
   198     05  ws-eff-date             pic x(10).
   199     05  ws-certificate          pic x(10).
   200     05  ws-cert-sfx             pic x.
   201     05  ws-seq-no               pic 999.
   202     05  ws-type                 pic x.
   203     05  ws-check-sub-type       pic x.
   204 01  svr                         pic x(32).
   205 01  usr                         pic x(32).
   206 01  pass                        pic x(32).
   207 01  usr-pass                    pic x(64).
   208 01  ws-disp-code                pic s9(11).
   209***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   210***                                                            ***
   211***  These indicators are used to determine if a variable      ***
   212***  is passed nulls from sql. The indicator will be -1        ***
   213***  if the value on sql is nulls and +0 if the value is       ***
   214***  something other than nulls. Here is an example on how     ***
   215***  to use the indicator variables.                           ***
   216***                                                            ***
   217***     EXEC SQL                                               ***
   218***        fetch checkapp into                                 ***
   219***           :db-app-status :nu-app-status,                   ***
   220***           :db-app-by     :nu-app-by,                       ***
   221***           :db-app-date   :nu-app-date,                     ***
   222***           :db-app-batch  :nu-app-batch                     ***
   223***     END-EXEC                                               ***
   224***                                                            ***
   225***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   226 01  indicator-vaiables-for-nulls.
   227     05  nu-app-status           pic s9(4) comp value +0.
   228     05  nu-app-by               pic s9(4) comp value +0.
   229     05  nu-app-date             pic s9(4) comp value +0.
   230     05  nu-app-batch            pic s9(4) comp value +0.
   231 01  daily-check-request-rec.
   232     05  db-compid               pic xxx.
   233     05  db-carrier              pic x.
   234     05  db-grouping             pic x(6).
   235     05  db-state                pic xx.
   236     05  db-account              pic x(10).
   237     05  db-effdate              pic x(10).
   238     05  db-certificate          pic x(10).
   239     05  db-cert-sfx             pic x.
   240     05  db-seq-no               pic 999.
   241     05  db-type                 pic x.
   242     05  db-amount-n             pic 9(7).99.
   243     05  db-amount redefines db-amount-n
   244                                 pic x(10).
   245     05  db-checkno              pic x(15).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   6
* EL677.cbl
   246     05  db-checkdate            pic x(10).
   247     05  db-checkstatus          pic 9(5).
   248     05  db-releasebatch         pic 9(5).
   249     05  db-releasedt            pic x(10).
   250     05  db-releaseby            pic x(4).
   251     05  db-payeename1           pic x(30).
   252     05  db-payeename2           pic x(30).
   253     05  db-payeeaddr1           pic x(30).
   254     05  db-payeeaddr2           pic x(30).
   255     05  db-payeecity            pic x(30).
   256     05  db-payeest              pic xx.
   257     05  db-payeezip             pic x(10).
   258     05  db-fincar               pic x.
   259     05  db-fingrp               pic x(6).
   260     05  db-finresp              pic x(10).
   261     05  db-finacct              pic x(10).
   262     05  db-preparer             pic x(4).
   263     05  db-app-status           pic x(9).
   264     05  dp-app-status-n redefines db-app-status
   265                                 pic 9(9).
   266     05  db-app-by               pic x(20).
   267     05  db-app-date             pic x(30).
   268     05  db-app-batch            pic x(10).
   269     05  db-return-to            pic x(30).
   270     05  db-insured-name         pic x(30).
   271     05  db-check-sub-type       pic x.
   272 EXEC SQL
   273    END DECLARE SECTION
   274 END-EXEC
   275*                            COPY ELCSCTM.
   276******************************************************************
   277*                                                                *
   278*                                                                *
   279*                            ELCSCTM                             *
   280*                            VMOD=2.001                          *
   281*                                                                *
   282*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   283*                                                                *
   284******************************************************************
   285 01  SECURITY-MESSAGE.
   286     12  FILLER                          PIC X(30)
   287            VALUE '** LOGIC SECURITY VIOLATION -'.
   288     12  SM-READ                         PIC X(6).
   289     12  FILLER                          PIC X(5)
   290            VALUE ' PGM='.
   291     12  SM-PGM                          PIC X(6).
   292     12  FILLER                          PIC X(5)
   293            VALUE ' OPR='.
   294     12  SM-PROCESSOR-ID                 PIC X(4).
   295     12  FILLER                          PIC X(6)
   296            VALUE ' TERM='.
   297     12  SM-TERMID                       PIC X(4).
   298     12  FILLER                          PIC XX   VALUE SPACE.
   299     12  SM-JUL-DATE                     PIC 9(5).
   300     12  FILLER                          PIC X    VALUE SPACE.
   301     12  SM-TIME                         PIC 99.99.
   302
   303*                            COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   7
* EL677.cbl
   304******************************************************************
   305*                                                                *
   306*                                                                *
   307*                            ELCSCRTY                            *
   308*                            VMOD=2.001                          *
   309*                                                                *
   310*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   311*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   312*        SAVED IN PI-SECURITY-ADDRESS.                           *
   313*                                                                *
   314******************************************************************
   315 01  SECURITY-CONTROL.
   316     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   317     12  FILLER                       PIC XX    VALUE 'SC'.
   318     12  SC-CREDIT-CODES.
   319         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   320             20  SC-CREDIT-DISPLAY    PIC X.
   321             20  SC-CREDIT-UPDATE     PIC X.
   322     12  SC-CLAIMS-CODES.
   323         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   324             20  SC-CLAIMS-DISPLAY    PIC X.
   325             20  SC-CLAIMS-UPDATE     PIC X.
   326 01  ws-dummy-erchek             pic x(600).
   327 01  filler.
   328     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   329     05  WS-CHECK-AMT-TMPX REDEFINES
   330         WS-CHECK-AMT-TMP        PIC X(10).
   331 01  ws-compare-erchek-key          pic x(33) value low-values.
   332 01  ws-eracct-sw                   pic x value ' '.
   333     88  eracct-found                 value 'Y'.
   334 01  ws-eracct-start-sw             pic x value ' '.
   335     88  eracct-start                 value 'Y'.
   336 01  WS-MISC-AREA.
   337     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   338     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   339     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   340
   341 01  ws-user-defined.
   342     05  ws-user-reason         pic xxx.
   343     05  ws-user-cert-no        pic x(11).
   344     05  ws-user-name           pic x(28).
   345 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   346 01  STANDARD-AREAS.
   347     12  ws-connect-sw               pic x  value ' '.
   348         88  connected-to-db             value 'Y'.
   349     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   350     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   351     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   352     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   353     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   354     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   355     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   356     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   357     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   358     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   359     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   360     12  TIME-OUT-R  REDEFINES TIME-IN.
   361         16  FILLER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   8
* EL677.cbl
   362         16  TIME-OUT                PIC 99V99.
   363         16  FILLER                  PIC XX.
   364     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   365     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   366     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   367     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   368     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   369     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   370     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   371     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   372     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   373     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   374     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   375     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   376     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   377     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   378     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   379     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   380     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   381     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   382     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   383     12  QID.
   384         16  QID-TERM                PIC X(4)    VALUE SPACES.
   385         16  FILLER                  PIC X(4)    VALUE '677A'.
   386
   387 01  WORK-AREAS.
   388     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   389     12  WS-AM-WK REDEFINES WS-AM-WORK.
   390         16  WS-AM-NUM               PIC S9(7)V99.
   391         16  WS-AM-SIGN              PIC X.
   392     12  WS-CHECK-WORK.
   393         16  FILLER                  PIC X        VALUE SPACE.
   394         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   395     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   396     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   397     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   398     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   399     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   400     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   401     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   402         WS-DT-DEEDIT-FIELD.
   403         16  FILLER                  PIC X(4).
   404         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   405     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   406     12  WS-DEEDIT-FIELD-V0          REDEFINES
   407         WS-DEEDIT-FIELD-A           PIC S9(15).
   408
   409     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   410     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   411         88 WS-CERT-FOUND                        VALUE 'Y'.
   412         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   413     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   414         88 WS-PNDB-FOUND                        VALUE 'Y'.
   415         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   416     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   417         88  WS-PROCESS-CERT                     VALUE 'Y'.
   418     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   419         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   9
* EL677.cbl
   420     12  WS-TMS-ENTRY-COMMENT.
   421         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   422         16  FILLER                  PIC XX      VALUE SPACES.
   423         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   424     12  WS-ZIP-CODE.
   425         16  WS-ZIP-PRIME.
   426             20  WS-ZIP-PRI-1ST      PIC X.
   427                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   428             20  FILLER              PIC X(4).
   429         16  WS-ZIP-PLUS4            PIC X(4).
   430     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   431         16  WS-CAN-POST1-1          PIC XXX.
   432         16  WS-CAN-POST1-2.
   433             20  WS-CAN-POST-4TH     PIC X.
   434             20  FILLER              PIC XX.
   435         16  FILLER                  PIC XXX.
   436     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   437         16  WS-CAN-POST2-1          PIC XXX.
   438         16  FILLER                  PIC X.
   439         16  WS-CAN-POST2-2          PIC XXX.
   440         16  FILLER                  PIC XX.
   441
   442*                                    COPY ELCNWA.
   443*****************************************************************
   444*                                                               *
   445*                                                               *
   446*                            ELCNWA.                            *
   447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   448*                            VMOD=2.003                         *
   449*                                                               *
   450*            M O V E   N A M E   W O R K   A R E A.             *
   451*                                                               *
   452*****************************************************************.
   453
   454 01  WS-NAME-WORK-AREA.
   455     05  WS-INSURED-LAST-NAME        PIC X(15).
   456     05  WS-INSURED-1ST-NAME         PIC X(12).
   457     05  WS-INSURED-MID-INIT         PIC X.
   458
   459     05  WS-NAME-WORK.
   460         10  WS-NW                   PIC X
   461             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   462
   463     05  WS-NAME-WORK2.
   464         10  WS-NW2                  PIC X
   465             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   466                                        NWA-INDEX0.
   467
   468     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   469                                     COMP-3.
   470
   471 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   472     88  RESP-NORMAL                    VALUE +0.
   473     88  resp-file-notfnd               value +12.
   474     88  RESP-NOTFND                    VALUE +13.
   475     88  resp-duprec                    value +14.
   476     88  resp-dupkey                    value +15.
   477     88  resp-invreq                    value +16.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  10
* EL677.cbl
   478     88  RESP-NOTOPEN                   VALUE +19.
   479     88  RESP-ENDFILE                   VALUE +20.
   480     88  resp-lengtherr                 value +22.
   481 01  ACCESS-KEYS.
   482     12  ELCNTL-KEY.
   483         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   484         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   485         16 ELCNTL-ACCESS.
   486             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   487             20  FILLER              PIC X       VALUE SPACES.
   488             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   489         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   490
   491     12  ERACCT-KEY.
   492         16  ERACCT-CO               PIC X       VALUE SPACES.
   493         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   494         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   495         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   496         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   497         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   498         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   499
   500     12  SAVE-ERACCT-KEY.
   501         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   502         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   503         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   504         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   505         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   506         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   507         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   508
   509     12  ERCOMP-KEY.
   510         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   511         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   512         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   513         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   514         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   515         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   516
   517     12  ELCERT-KEY.
   518         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   519         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   520         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   521         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   522         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   523         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   524         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   525         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   526
   527     12  ERPNDB-PRIMARY-KEY.
   528         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   529         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   530         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   531         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   532
   533     12  ERPNDB-ALT-KEY.
   534         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   535         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  11
* EL677.cbl
   536         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   537         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   538         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   539         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   540         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   541         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   542         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   543         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   544
   545     12  ERCHEK-KEY.
   546         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   547         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   548         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   549         16  CHEK-STATE              PIC XX      VALUE SPACES.
   550         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   551         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   552         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   553         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   554         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   555
   556     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   557     12  ERPYAJ-KEY.
   558         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   559         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   560         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   561         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   562         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   563         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   564         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   565
   566 01  ERROR-NUMBERS.
   567     12  ER-0000                 PIC X(4)    VALUE '0000'.
   568     12  ER-0004                 PIC X(4)    VALUE '0004'.
   569     12  ER-0013                 PIC X(4)    VALUE '0013'.
   570     12  ER-0022                 PIC X(4)    VALUE '0022'.
   571     12  ER-0023                 PIC X(4)    VALUE '0023'.
   572     12  ER-0029                 PIC X(4)    VALUE '0029'.
   573     12  ER-0070                 PIC X(4)    VALUE '0070'.
   574     12  ER-0194                 PIC X(4)    VALUE '0194'.
   575     12  ER-0195                 PIC X(4)    VALUE '0195'.
   576     12  ER-0196                 PIC X(4)    VALUE '0196'.
   577     12  ER-0197                 PIC X(4)    VALUE '0197'.
   578     12  ER-0203                 PIC X(4)    VALUE '0203'.
   579     12  ER-0215                 PIC X(4)    VALUE '0215'.
   580     12  ER-0216                 PIC X(4)    VALUE '0216'.
   581     12  ER-0433                 PIC X(4)    VALUE '0433'.
   582     12  ER-1159                 PIC X(4)    VALUE '1159'.
   583     12  ER-1162                 PIC X(4)    VALUE '1162'.
   584     12  ER-2056                 PIC X(4)    VALUE '2056'.
   585     12  ER-2208                 PIC X(4)    VALUE '2208'.
   586     12  ER-2209                 PIC X(4)    VALUE '2209'.
   587     12  ER-2210                 PIC X(4)    VALUE '2210'.
   588     12  ER-2230                 PIC X(4)    VALUE '2230'.
   589     12  ER-2237                 PIC X(4)    VALUE '2237'.
   590     12  ER-2238                 PIC X(4)    VALUE '2238'.
   591     12  ER-2394                 PIC X(4)    VALUE '2394'.
   592     12  ER-2583                 PIC X(4)    VALUE '2583'.
   593     12  ER-2600                 PIC X(4)    VALUE '2600'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  12
* EL677.cbl
   594     12  ER-2726                 PIC X(4)    VALUE '2726'.
   595     12  ER-2907                 PIC X(4)    VALUE '2907'.
   596     12  ER-2908                 PIC X(4)    VALUE '2908'.
   597     12  ER-3044                 PIC X(4)    VALUE '3044'.
   598     12  ER-3046                 PIC X(4)    VALUE '3046'.
   599     12  er-3274                 pic x(4)    value '3274'.
   600     12  er-3450                 pic x(4)    value '3450'.
   601     12  er-3451                 pic x(4)    value '3451'.
   602     12  er-3452                 pic x(4)    value '3452'.
   603     12  er-3453                 pic x(4)    value '3453'.
   604     12  er-3454                 pic x(4)    value '3454'.
   605     12  er-3455                 pic x(4)    value '3455'.
   606     12  er-3459                 pic x(4)    value '3459'.
   607     12  er-3460                 pic x(4)    value '3460'.
   608     12  er-3461                 pic x(4)    value '3461'.
   609     12  er-3462                 pic x(4)    value '3462'.
   610     12  er-3463                 pic x(4)    value '3463'.
   611     12  er-9999                 pic x(4)    value '9999'.
   612*                                COPY ELCLOGOF.
   613******************************************************************
   614*                                                                *
   615*                                                                *
   616*                            ELCLOGOF.                           *
   617*                            VMOD=2.001                          *
   618*                                                                *
   619*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   620*                                                                *
   621******************************************************************
   622 01  CLASIC-LOGOFF.
   623     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   624     12  LOGOFF-TEXT.
   625         16  FILLER          PIC X(5)    VALUE SPACES.
   626         16  LOGOFF-MSG.
   627             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   628             20  FILLER      PIC X       VALUE SPACES.
   629             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   630         16  FILLER          PIC X(80)
   631           VALUE '* YOU ARE NOW LOGGED OFF'.
   632         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   633         16  FILLER          PIC X       VALUE QUOTE.
   634         16  LOGOFF-SYS-MSG  PIC X(17)
   635           VALUE 'S CLAS-IC SYSTEM '.
   636     12  TEXT-MESSAGES.
   637         16  UNACCESS-MSG    PIC X(29)
   638             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   639         16  PGMIDERR-MSG    PIC X(17)
   640             VALUE 'PROGRAM NOT FOUND'.
   641*                                COPY ELCDATE.
   642******************************************************************
   643*                                                                *
   644*                                                                *
   645*                            ELCDATE.                            *
   646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   647*                            VMOD=2.003
   648*                                                                *
   649*                                                                *
   650*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   651*                 LENGTH = 200                                   *
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  13
* EL677.cbl
   652******************************************************************
   653
   654 01  DATE-CONVERSION-DATA.
   655     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   656     12  DC-OPTION-CODE                PIC X.
   657         88  BIN-TO-GREG                VALUE ' '.
   658         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   659         88  EDIT-GREG-TO-BIN           VALUE '2'.
   660         88  YMD-GREG-TO-BIN            VALUE '3'.
   661         88  MDY-GREG-TO-BIN            VALUE '4'.
   662         88  JULIAN-TO-BIN              VALUE '5'.
   663         88  BIN-PLUS-ELAPSED           VALUE '6'.
   664         88  FIND-CENTURY               VALUE '7'.
   665         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   666         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   667         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   668         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   669         88  JULIAN-TO-BIN-3            VALUE 'C'.
   670         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   671         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   672         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   673         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   674         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   675         88  CHECK-LEAP-YEAR            VALUE 'H'.
   676         88  BIN-3-TO-GREG              VALUE 'I'.
   677         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   678         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   679         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   680         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   681         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   682         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   683         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   684         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   685         88  THREE-CHARACTER-BIN
   686                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   687         88  GREGORIAN-TO-BIN
   688                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   689         88  BIN-TO-GREGORIAN
   690                  VALUES ' ' '1' 'I' '8' 'G'.
   691         88  JULIAN-TO-BINARY
   692                  VALUES '5' 'C' 'E' 'F'.
   693     12  DC-ERROR-CODE                 PIC X.
   694         88  NO-CONVERSION-ERROR        VALUE ' '.
   695         88  DATE-CONVERSION-ERROR
   696                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   697         88  DATE-IS-ZERO               VALUE '1'.
   698         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   699         88  DATE-IS-INVALID            VALUE '3'.
   700         88  DATE1-GREATER-DATE2        VALUE '4'.
   701         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   702         88  DATE-INVALID-OPTION        VALUE '9'.
   703         88  INVALID-CENTURY            VALUE 'A'.
   704         88  ONLY-CENTURY               VALUE 'B'.
   705         88  ONLY-LEAP-YEAR             VALUE 'C'.
   706         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   707     12  DC-END-OF-MONTH               PIC X.
   708         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   709     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  14
* EL677.cbl
   710         88  USE-NORMAL-PROCESS         VALUE ' '.
   711         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   712         88  ADJUST-UP-100-YRS          VALUE '2'.
   713     12  FILLER                        PIC X.
   714     12  DC-CONVERSION-DATES.
   715         16  DC-BIN-DATE-1             PIC XX.
   716         16  DC-BIN-DATE-2             PIC XX.
   717         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   718         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   719                       DC-GREG-DATE-1-EDIT.
   720             20  DC-EDIT1-MONTH        PIC 99.
   721             20  SLASH1-1              PIC X.
   722             20  DC-EDIT1-DAY          PIC 99.
   723             20  SLASH1-2              PIC X.
   724             20  DC-EDIT1-YEAR         PIC 99.
   725         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   726         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   727                     DC-GREG-DATE-2-EDIT.
   728             20  DC-EDIT2-MONTH        PIC 99.
   729             20  SLASH2-1              PIC X.
   730             20  DC-EDIT2-DAY          PIC 99.
   731             20  SLASH2-2              PIC X.
   732             20  DC-EDIT2-YEAR         PIC 99.
   733         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   734         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   735                     DC-GREG-DATE-1-YMD.
   736             20  DC-YMD-YEAR           PIC 99.
   737             20  DC-YMD-MONTH          PIC 99.
   738             20  DC-YMD-DAY            PIC 99.
   739         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   740         16  DC-GREG-DATE-1-MDY-R REDEFINES
   741                      DC-GREG-DATE-1-MDY.
   742             20  DC-MDY-MONTH          PIC 99.
   743             20  DC-MDY-DAY            PIC 99.
   744             20  DC-MDY-YEAR           PIC 99.
   745         16  DC-GREG-DATE-1-ALPHA.
   746             20  DC-ALPHA-MONTH        PIC X(10).
   747             20  DC-ALPHA-DAY          PIC 99.
   748             20  FILLER                PIC XX.
   749             20  DC-ALPHA-CENTURY.
   750                 24 DC-ALPHA-CEN-N     PIC 99.
   751             20  DC-ALPHA-YEAR         PIC 99.
   752         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   753         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   754         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   755         16  DC-JULIAN-DATE            PIC 9(05).
   756         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   757                                       PIC 9(05).
   758         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   759             20  DC-JULIAN-YEAR        PIC 99.
   760             20  DC-JULIAN-DAYS        PIC 999.
   761         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   762         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   763         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   764     12  DATE-CONVERSION-VARIBLES.
   765         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   766         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   767             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  15
* EL677.cbl
   768             20  HOLD-CEN-1-CCYY.
   769                 24  HOLD-CEN-1-CC     PIC 99.
   770                 24  HOLD-CEN-1-YY     PIC 99.
   771             20  HOLD-CEN-1-MO         PIC 99.
   772             20  HOLD-CEN-1-DA         PIC 99.
   773         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   774             20  HOLD-CEN-1-R-MO       PIC 99.
   775             20  HOLD-CEN-1-R-DA       PIC 99.
   776             20  HOLD-CEN-1-R-CCYY.
   777                 24  HOLD-CEN-1-R-CC   PIC 99.
   778                 24  HOLD-CEN-1-R-YY   PIC 99.
   779             20  FILLER                PIC 9(3).
   780         16  HOLD-CENTURY-1-X.
   781             20  FILLER                PIC X(3)  VALUE SPACES.
   782             20  HOLD-CEN-1-X-CCYY.
   783                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   784                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   785             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   786             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   787         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   788             20  HOLD-CEN-1-R-X-MO     PIC XX.
   789             20  HOLD-CEN-1-R-X-DA     PIC XX.
   790             20  HOLD-CEN-1-R-X-CCYY.
   791                 24  HOLD-CEN-1-R-X-CC PIC XX.
   792                 24  HOLD-CEN-1-R-X-YY PIC XX.
   793             20  FILLER                PIC XXX.
   794         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   795         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   796         16  DC-JULIAN-DATE-1          PIC 9(07).
   797         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   798             20  DC-JULIAN-1-CCYY.
   799                 24  DC-JULIAN-1-CC    PIC 99.
   800                 24  DC-JULIAN-1-YR    PIC 99.
   801             20  DC-JULIAN-DA-1        PIC 999.
   802         16  DC-JULIAN-DATE-2          PIC 9(07).
   803         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   804             20  DC-JULIAN-2-CCYY.
   805                 24  DC-JULIAN-2-CC    PIC 99.
   806                 24  DC-JULIAN-2-YR    PIC 99.
   807             20  DC-JULIAN-DA-2        PIC 999.
   808         16  DC-GREG-DATE-A-EDIT.
   809             20  DC-EDITA-MONTH        PIC 99.
   810             20  SLASHA-1              PIC X VALUE '/'.
   811             20  DC-EDITA-DAY          PIC 99.
   812             20  SLASHA-2              PIC X VALUE '/'.
   813             20  DC-EDITA-CCYY.
   814                 24  DC-EDITA-CENT     PIC 99.
   815                 24  DC-EDITA-YEAR     PIC 99.
   816         16  DC-GREG-DATE-B-EDIT.
   817             20  DC-EDITB-MONTH        PIC 99.
   818             20  SLASHB-1              PIC X VALUE '/'.
   819             20  DC-EDITB-DAY          PIC 99.
   820             20  SLASHB-2              PIC X VALUE '/'.
   821             20  DC-EDITB-CCYY.
   822                 24  DC-EDITB-CENT     PIC 99.
   823                 24  DC-EDITB-YEAR     PIC 99.
   824         16  DC-GREG-DATE-CYMD         PIC 9(08).
   825         16  DC-GREG-DATE-CYMD-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  16
* EL677.cbl
   826                              DC-GREG-DATE-CYMD.
   827             20  DC-CYMD-CEN           PIC 99.
   828             20  DC-CYMD-YEAR          PIC 99.
   829             20  DC-CYMD-MONTH         PIC 99.
   830             20  DC-CYMD-DAY           PIC 99.
   831         16  DC-GREG-DATE-MDCY         PIC 9(08).
   832         16  DC-GREG-DATE-MDCY-R REDEFINES
   833                              DC-GREG-DATE-MDCY.
   834             20  DC-MDCY-MONTH         PIC 99.
   835             20  DC-MDCY-DAY           PIC 99.
   836             20  DC-MDCY-CEN           PIC 99.
   837             20  DC-MDCY-YEAR          PIC 99.
   838    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   839        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   840    12  DC-EL310-DATE                  PIC X(21).
   841    12  FILLER                         PIC X(28).
   842*                                COPY ELCATTR.
   843******************************************************************
   844*                                                                *
   845*                            ELCATTR.                            *
   846*                            VMOD=2.001                          *
   847*                                                                *
   848*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   849*                                                                *
   850*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   851*                                                                *
   852*                   POS 1   P=PROTECTED                          *
   853*                           U=UNPROTECTED                        *
   854*                           S=ASKIP                              *
   855*                   POS 2   A=ALPHA/NUMERIC                      *
   856*                           N=NUMERIC                            *
   857*                   POS 3   N=NORMAL                             *
   858*                           B=BRIGHT                             *
   859*                           D=DARK                               *
   860*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   861*                           OF=MODIFIED DATA TAG OFF             *
   862*                                                                *
   863*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   864******************************************************************
   865 01  ATTRIBUTE-LIST.
   866     12  AL-PABOF            PIC X       VALUE 'Y'.
   867     12  AL-PABON            PIC X       VALUE 'Z'.
   868     12  AL-PADOF            PIC X       VALUE '%'.
   869     12  AL-PADON            PIC X       VALUE '_'.
   870     12  AL-PANOF            PIC X       VALUE '-'.
   871     12  AL-PANON            PIC X       VALUE '/'.
   872     12  AL-SABOF            PIC X       VALUE '8'.
   873     12  AL-SABON            PIC X       VALUE '9'.
   874     12  AL-SADOF            PIC X       VALUE '@'.
   875     12  AL-SADON            PIC X       VALUE QUOTE.
   876     12  AL-SANOF            PIC X       VALUE '0'.
   877     12  AL-SANON            PIC X       VALUE '1'.
   878     12  AL-UABOF            PIC X       VALUE 'H'.
   879     12  AL-UABON            PIC X       VALUE 'I'.
   880     12  AL-UADOF            PIC X       VALUE '<'.
   881     12  AL-UADON            PIC X       VALUE '('.
   882     12  AL-UANOF            PIC X       VALUE ' '.
   883     12  AL-UANON            PIC X       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  17
* EL677.cbl
   884     12  AL-UNBOF            PIC X       VALUE 'Q'.
   885     12  AL-UNBON            PIC X       VALUE 'R'.
   886     12  AL-UNDOF            PIC X       VALUE '*'.
   887     12  AL-UNDON            PIC X       VALUE ')'.
   888     12  AL-UNNOF            PIC X       VALUE '&'.
   889     12  AL-UNNON            PIC X       VALUE 'J'.
   890*                                COPY ELCEMIB.
   891******************************************************************
   892*                                                                *
   893*                                                                *
   894*                            ELCEMIB.                            *
   895*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   896*                            VMOD=2.005                          *
   897*                                                                *
   898*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   899*                                                                *
   900******************************************************************
   901 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   902     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   903     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   904     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   905     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   906     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   907     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   908     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   909     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   910     12  EMI-SWITCH1             PIC X        VALUE '1'.
   911         88  EMI-NO-ERRORS                    VALUE '1'.
   912         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   913         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   914     12  EMI-SWITCH2             PIC X        VALUE '1'.
   915         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   916     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   917         88  EMI-AREA1-EMPTY                  VALUE '1'.
   918         88  EMI-AREA1-FULL                   VALUE '2'.
   919     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   920         88  EMI-AREA2-EMPTY                  VALUE '1'.
   921         88  EMI-AREA2-FULL                   VALUE '2'.
   922     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   923         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   924         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   925         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   926         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   927         88  EMI-BYPASS-FATALS                VALUE 'X'.
   928     12  EMI-ERROR-LINES.
   929         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   930         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   931         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   932         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   933             20  EMI-ERR-CODES OCCURS 10 TIMES.
   934                 24  EMI-ERR-NUM         PIC X(4).
   935                 24  EMI-FILLER          PIC X.
   936                 24  EMI-SEV             PIC X.
   937                 24  FILLER              PIC X.
   938             20  FILLER                  PIC X(02).
   939     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   940         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   941             20  EMI-ERROR-NUMBER    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  18
* EL677.cbl
   942             20  EMI-FILL            PIC X.
   943             20  EMI-SEVERITY        PIC X.
   944             20  FILLER              PIC X.
   945             20  EMI-ERROR-TEXT.
   946                 24  EMI-TEXT-VARIABLE   PIC X(10).
   947                 24  FILLER          PIC X(55).
   948     12  EMI-SEVERITY-SAVE           PIC X.
   949         88  EMI-NOTE                    VALUE 'N'.
   950         88  EMI-WARNING                 VALUE 'W'.
   951         88  EMI-FORCABLE                VALUE 'F'.
   952         88  EMI-FATAL                   VALUE 'X'.
   953     12  EMI-MESSAGE-FLAG            PIC X.
   954         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   955         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   956     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   957     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   958         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   959         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   960         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   961     12  emi-claim-no                pic x(7).
   962     12  emi-claim-type              pic x(6).
   963     12  FILLER                      PIC X(124)  VALUE SPACES.
   964     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   965     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   966     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   967     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   968*                                COPY ELCINTF.
   969******************************************************************
   970*                                                                *
   971*                                                                *
   972*                            ELCINTF.                            *
   973*                            VMOD=2.017                          *
   974*                                                                *
   975*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   976*                                                                *
   977*       LENGTH = 1024                                            *
   978*                                                                *
   979******************************************************************
   980*                   C H A N G E   L O G
   981*
   982* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   983*-----------------------------------------------------------------
   984*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   985* EFFECTIVE    NUMBER
   986*-----------------------------------------------------------------
   987* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   988******************************************************************
   989 01  PROGRAM-INTERFACE-BLOCK.
   990     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   991     12  PI-CALLING-PROGRAM              PIC X(8).
   992     12  PI-SAVED-PROGRAM-1              PIC X(8).
   993     12  PI-SAVED-PROGRAM-2              PIC X(8).
   994     12  PI-SAVED-PROGRAM-3              PIC X(8).
   995     12  PI-SAVED-PROGRAM-4              PIC X(8).
   996     12  PI-SAVED-PROGRAM-5              PIC X(8).
   997     12  PI-SAVED-PROGRAM-6              PIC X(8).
   998     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   999     12  PI-COMPANY-ID                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  19
* EL677.cbl
  1000     12  PI-COMPANY-CD                   PIC X.
  1001
  1002     12  PI-COMPANY-PASSWORD             PIC X(8).
  1003
  1004     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1005
  1006     12  PI-CONTROL-IN-PROGRESS.
  1007         16  PI-CARRIER                  PIC X.
  1008         16  PI-GROUPING                 PIC X(6).
  1009         16  PI-STATE                    PIC XX.
  1010         16  PI-ACCOUNT                  PIC X(10).
  1011         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1012                                         PIC X(10).
  1013         16  PI-CLAIM-CERT-GRP.
  1014             20  PI-CLAIM-NO             PIC X(7).
  1015             20  PI-CERT-NO.
  1016                 25  PI-CERT-PRIME       PIC X(10).
  1017                 25  PI-CERT-SFX         PIC X.
  1018             20  PI-CERT-EFF-DT          PIC XX.
  1019         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1020             20  PI-PLAN-CODE            PIC X(2).
  1021             20  PI-REVISION-NUMBER      PIC X(3).
  1022             20  PI-PLAN-EFF-DT          PIC X(2).
  1023             20  PI-PLAN-EXP-DT          PIC X(2).
  1024             20  FILLER                  PIC X(11).
  1025         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1026             20  PI-OE-REFERENCE-1.
  1027                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1028                 25  PI-OE-REF-1-SUFF    PIC XX.
  1029
  1030     12  PI-SESSION-IN-PROGRESS          PIC X.
  1031         88  CLAIM-SESSION                   VALUE '1'.
  1032         88  CREDIT-SESSION                  VALUE '2'.
  1033         88  WARRANTY-SESSION                VALUE '3'.
  1034         88  MORTGAGE-SESSION                VALUE '4'.
  1035         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1036
  1037
  1038*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1039
  1040     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1041     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1042
  1043     12  PI-CREDIT-USER                  PIC X.
  1044         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1045         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1046
  1047     12  PI-CLAIM-USER                   PIC X.
  1048         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1049         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1050
  1051     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1052         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1053         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1054         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1055         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1056         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1057
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  20
* EL677.cbl
  1058     12  PI-PROCESSOR-ID                 PIC X(4).
  1059
  1060     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1061
  1062     12  PI-MEMBER-CAPTION               PIC X(10).
  1063
  1064     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1065         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1066
  1067     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1068     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1069     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1070     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1071
  1072     12  PI-AH-OVERRIDE-L1               PIC X.
  1073     12  PI-AH-OVERRIDE-L2               PIC XX.
  1074     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1075     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1076
  1077     12  PI-NEW-SYSTEM                   PIC X(2).
  1078
  1079     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1080     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1081         88  PI-USES-PAID-TO                 VALUE '1'.
  1082     12  PI-CRDTCRD-SYSTEM.
  1083         16  PI-CRDTCRD-USER             PIC X.
  1084             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1085             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1086         16  PI-CC-MONTH-END-DT          PIC XX.
  1087     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1088
  1089     12  PI-OE-REFERENCE-2.
  1090         16  PI-OE-REF-2-PRIME           PIC X(10).
  1091         16  PI-OE-REF-2-SUFF            PIC X.
  1092
  1093     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1094
  1095     12  PI-LANGUAGE-TYPE                PIC X.
  1096             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1097             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1098             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1099
  1100     12  PI-POLICY-LINKAGE-IND           PIC X.
  1101         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1102         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1103                                                   LOW-VALUES.
  1104
  1105     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1106     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1107         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1108         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1109
  1110     12  PI-PROCESSOR-CSR-IND            PIC X.
  1111         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1112         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1113
  1114     12  FILLER                          PIC X(3).
  1115
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  21
* EL677.cbl
  1116     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1117
  1118     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1119         PI-SYSTEM-LEVEL.
  1120
  1121         16  PI-ENTRY-CODES.
  1122             20  PI-ENTRY-CD-1           PIC X.
  1123             20  PI-ENTRY-CD-2           PIC X.
  1124
  1125         16  PI-RETURN-CODES.
  1126             20  PI-RETURN-CD-1          PIC X.
  1127             20  PI-RETURN-CD-2          PIC X.
  1128
  1129         16  PI-UPDATE-STATUS-SAVE.
  1130             20  PI-UPDATE-BY            PIC X(4).
  1131             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1132
  1133         16  PI-LOWER-CASE-LETTERS       PIC X.
  1134             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1135
  1136*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1137*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1138*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1139
  1140         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1141             88  ST-ACCNT-CNTL               VALUE ' '.
  1142             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1143             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1144             88  ACCNT-CNTL                  VALUE '3'.
  1145             88  CARR-ACCNT-CNTL             VALUE '4'.
  1146
  1147         16  PI-PROCESSOR-CAP-LIST.
  1148             20  PI-SYSTEM-CONTROLS.
  1149                24 PI-SYSTEM-DISPLAY     PIC X.
  1150                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1151                24 PI-SYSTEM-MODIFY      PIC X.
  1152                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1153             20  FILLER                  PIC XX.
  1154             20  PI-DISPLAY-CAP          PIC X.
  1155                 88  DISPLAY-CAP             VALUE 'Y'.
  1156             20  PI-MODIFY-CAP           PIC X.
  1157                 88  MODIFY-CAP              VALUE 'Y'.
  1158             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1159                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1160             20  PI-FORCE-CAP            PIC X.
  1161                 88  FORCE-CAP               VALUE 'Y'.
  1162
  1163         16  PI-PROGRAM-CONTROLS.
  1164             20  PI-PGM-PRINT-OPT        PIC X.
  1165             20  PI-PGM-FORMAT-OPT       PIC X.
  1166             20  PI-PGM-PROCESS-OPT      PIC X.
  1167             20  PI-PGM-TOTALS-OPT       PIC X.
  1168
  1169         16  PI-HELP-INTERFACE.
  1170             20  PI-LAST-ERROR-NO        PIC X(4).
  1171             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1172
  1173         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  22
* EL677.cbl
  1174             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1175
  1176         16  PI-CR-CONTROL-IN-PROGRESS.
  1177             20  PI-CR-CARRIER           PIC X.
  1178             20  PI-CR-GROUPING          PIC X(6).
  1179             20  PI-CR-STATE             PIC XX.
  1180             20  PI-CR-ACCOUNT           PIC X(10).
  1181             20  PI-CR-FIN-RESP          PIC X(10).
  1182             20  PI-CR-TYPE              PIC X.
  1183
  1184         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1185
  1186         16  PI-CR-MONTH-END-DT          PIC XX.
  1187
  1188         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1189             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1190             88  PI-ZERO-CARRIER             VALUE '1'.
  1191             88  PI-ZERO-GROUPING            VALUE '2'.
  1192             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1193
  1194         16  PI-CARRIER-SECURITY         PIC X.
  1195             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1196
  1197         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1198             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1199             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1200
  1201         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1202             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1203                                         INDEXED BY PI-ACCESS-NDX
  1204                                         PIC X.
  1205
  1206         16  PI-GA-BILLING-CONTROL       PIC X.
  1207             88  PI-GA-BILLING               VALUE '1'.
  1208
  1209         16  PI-MAIL-PROCESSING          PIC X.
  1210             88  PI-MAIL-YES                 VALUE 'Y'.
  1211
  1212         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1213
  1214         16  PI-AR-SYSTEM.
  1215             20  PI-AR-PROCESSING-CNTL   PIC X.
  1216                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1217             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1218             20  PI-AR-MONTH-END-DT      PIC XX.
  1219
  1220         16  PI-MP-SYSTEM.
  1221             20  PI-MORTGAGE-USER            PIC X.
  1222                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1223                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1224             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1225                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1226                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1227                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1228                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1229                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1230             20  PI-MP-MONTH-END-DT          PIC XX.
  1231             20  PI-MP-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  23
* EL677.cbl
  1232                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1233                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1234
  1235         16  PI-LABEL-CONTROL            PIC X(01).
  1236             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1237             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1238
  1239         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1240             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1241
  1242         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1243             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1244             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1245
  1246         16  FILLER                      PIC X(14).
  1247
  1248     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1249******************************************************************
  1250     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1251         16  PI-EOF-SW               PIC X.
  1252             88  PI-FILE-EOF                     VALUE 'Y'.
  1253         16  PI-PREV-MAINT           PIC X.
  1254         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1255         16  PI-ERCHEK-KEY.
  1256             20  PI-CHEK-COMP-CD     PIC X.
  1257             20  PI-CHEK-CARRIER     PIC X.
  1258             20  PI-CHEK-GROUPING    PIC X(6).
  1259             20  PI-CHEK-STATE       PIC XX.
  1260             20  PI-CHEK-ACCOUNT     PIC X(10).
  1261             20  PI-CHEK-EFF-DT      PIC XX.
  1262             20  PI-CHEK-CERT-NO     PIC X(10).
  1263             20  PI-CHEK-SUF-NO      PIC X.
  1264             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1265         16  PI-ACCOUNT-ADDRESS.
  1266             20  PI-AM-NAME          PIC X(30).
  1267             20  PI-AM-ADDRS         PIC X(30).
  1268             20  PI-AM-CITY-st.
  1269                 24  pi-am-city      PIC X(28).
  1270                 24  pi-am-st        pic xx.
  1271             20  PI-AM-ZIP-CODE.
  1272                 24  PI-AM-ZIP-PRIME PIC X(5).
  1273                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1274         16  PI-PROCESS-CERT-SW          PIC X.
  1275             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1276         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1277             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1278         16  PI-PAYTO1                   PIC X(30).
  1279         16  PI-REFERENCE                PIC X(12).
  1280         16  PI-CANC-DT                  PIC XX.
  1281         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1282         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1283         16  PI-INSURED-NAME             PIC X(28).
  1284         16  PI-PFKEY                    PIC XXX.
  1285             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1286             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1287         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1288         16  PI-TYPE                     PIC X.
  1289         16  pi-prev-paid                pic s9(7)v99 comp-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  24
* EL677.cbl
  1290         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1291         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1292         16  pi-chek-rec-cnt             pic s999 comp-3.
  1293         16  pi-am-csr                   pic x(4).
  1294         16  pi-return-to                pic x(30).
  1295         16  pi-prev-ded-comm            pic x.
  1296         16  pi-table-name               pic x(30).
  1297         16  pi-check-cashed             pic x.
  1298         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1299         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1300         16  pi-check-type               pic x.
  1301             88  pi-corr-check              value 'C'.
  1302             88  pi-ref-check               value 'R'.
  1303         16  pi-check-cut                pic x.
  1304         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1305         16  pi-previous-deduct-comm     pic x.
  1306         16  pi-void-reissue-pass        pic x.
  1307             88  pi-void-complete           value '1'.
  1308             88  pi-address-selected        value '2'.
  1309         16  pi-void-reissue-amt         pic s9(7)v99 comp-3.
  1310         16  FILLER                      PIC X(304). *> wass 311
  1311*                                    COPY ELCAID.
  1312******************************************************************
  1313*                                                                *
  1314*                            ELCAID.                             *
  1315*                            VMOD=2.001                          *
  1316*                                                                *
  1317*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1318*                                                                *
  1319*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1320*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1321******************************************************************
  1322
  1323 01  DFHAID.
  1324   02  DFHNULL   PIC  X  VALUE  ' '.
  1325   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1326   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1327   02  DFHPEN    PIC  X  VALUE  '='.
  1328   02  DFHOPID   PIC  X  VALUE  'W'.
  1329   02  DFHPA1    PIC  X  VALUE  '%'.
  1330   02  DFHPA2    PIC  X  VALUE  '>'.
  1331   02  DFHPA3    PIC  X  VALUE  ','.
  1332   02  DFHPF1    PIC  X  VALUE  '1'.
  1333   02  DFHPF2    PIC  X  VALUE  '2'.
  1334   02  DFHPF3    PIC  X  VALUE  '3'.
  1335   02  DFHPF4    PIC  X  VALUE  '4'.
  1336   02  DFHPF5    PIC  X  VALUE  '5'.
  1337   02  DFHPF6    PIC  X  VALUE  '6'.
  1338   02  DFHPF7    PIC  X  VALUE  '7'.
  1339   02  DFHPF8    PIC  X  VALUE  '8'.
  1340   02  DFHPF9    PIC  X  VALUE  '9'.
  1341   02  DFHPF10   PIC  X  VALUE  ':'.
  1342   02  DFHPF11   PIC  X  VALUE  '#'.
  1343   02  DFHPF12   PIC  X  VALUE  '@'.
  1344   02  DFHPF13   PIC  X  VALUE  'A'.
  1345   02  DFHPF14   PIC  X  VALUE  'B'.
  1346   02  DFHPF15   PIC  X  VALUE  'C'.
  1347   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  25
* EL677.cbl
  1348   02  DFHPF17   PIC  X  VALUE  'E'.
  1349   02  DFHPF18   PIC  X  VALUE  'F'.
  1350   02  DFHPF19   PIC  X  VALUE  'G'.
  1351   02  DFHPF20   PIC  X  VALUE  'H'.
  1352   02  DFHPF21   PIC  X  VALUE  'I'.
  1353*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1354   02  DFHPF22   PIC  X  VALUE  '['.
  1355   02  DFHPF23   PIC  X  VALUE  '.'.
  1356   02  DFHPF24   PIC  X  VALUE  '<'.
  1357   02  DFHMSRE   PIC  X  VALUE  'X'.
  1358   02  DFHSTRF   PIC  X  VALUE  'h'.
  1359   02  DFHTRIG   PIC  X  VALUE  '"'.
  1360 01  FILLER    REDEFINES DFHAID.
  1361     12  FILLER                      PIC X(8).
  1362     12  PF-VALUES                   PIC X       OCCURS 24.
  1363     12  FILLER                      PIC X(3).
  1364*                                    COPY EL677S.
  1365 01  EL677AI.
  1366     05  FILLER            PIC  X(0012).
  1367*    -------------------------------
  1368     05  DATEL PIC S9(0004) COMP.
  1369     05  DATEF PIC  X(0001).
  1370     05  FILLER REDEFINES DATEF.
  1371         10  DATEA PIC  X(0001).
  1372     05  DATEI PIC  X(0008).
  1373*    -------------------------------
  1374     05  TIMEL PIC S9(0004) COMP.
  1375     05  TIMEF PIC  X(0001).
  1376     05  FILLER REDEFINES TIMEF.
  1377         10  TIMEA PIC  X(0001).
  1378     05  TIMEI PIC  X(0005).
  1379*    -------------------------------
  1380     05  MAINTL PIC S9(0004) COMP.
  1381     05  MAINTF PIC  X(0001).
  1382     05  FILLER REDEFINES MAINTF.
  1383         10  MAINTA PIC  X(0001).
  1384     05  MAINTI PIC  X(0001).
  1385*    -------------------------------
  1386     05  DMAINT1L PIC S9(0004) COMP.
  1387     05  DMAINT1F PIC  X(0001).
  1388     05  FILLER REDEFINES DMAINT1F.
  1389         10  DMAINT1A PIC  X(0001).
  1390     05  DMAINT1I PIC  X(0009).
  1391*    -------------------------------
  1392     05  DMAINT2L PIC S9(0004) COMP.
  1393     05  DMAINT2F PIC  X(0001).
  1394     05  FILLER REDEFINES DMAINT2F.
  1395         10  DMAINT2A PIC  X(0001).
  1396     05  DMAINT2I PIC  X(0029).
  1397*    -------------------------------
  1398     05  CARRIERL PIC S9(0004) COMP.
  1399     05  CARRIERF PIC  X(0001).
  1400     05  FILLER REDEFINES CARRIERF.
  1401         10  CARRIERA PIC  X(0001).
  1402     05  CARRIERI PIC  X(0001).
  1403*    -------------------------------
  1404     05  GROUPL PIC S9(0004) COMP.
  1405     05  GROUPF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  26
* EL677.cbl
  1406     05  FILLER REDEFINES GROUPF.
  1407         10  GROUPA PIC  X(0001).
  1408     05  GROUPI PIC  X(0006).
  1409*    -------------------------------
  1410     05  STATEL PIC S9(0004) COMP.
  1411     05  STATEF PIC  X(0001).
  1412     05  FILLER REDEFINES STATEF.
  1413         10  STATEA PIC  X(0001).
  1414     05  STATEI PIC  X(0002).
  1415*    -------------------------------
  1416     05  ACCTL PIC S9(0004) COMP.
  1417     05  ACCTF PIC  X(0001).
  1418     05  FILLER REDEFINES ACCTF.
  1419         10  ACCTA PIC  X(0001).
  1420     05  ACCTI PIC  X(0010).
  1421*    -------------------------------
  1422     05  EFFDTL PIC S9(0004) COMP.
  1423     05  EFFDTF PIC  X(0001).
  1424     05  FILLER REDEFINES EFFDTF.
  1425         10  EFFDTA PIC  X(0001).
  1426     05  EFFDTI PIC  X(0008).
  1427*    -------------------------------
  1428     05  CERTNOL PIC S9(0004) COMP.
  1429     05  CERTNOF PIC  X(0001).
  1430     05  FILLER REDEFINES CERTNOF.
  1431         10  CERTNOA PIC  X(0001).
  1432     05  CERTNOI PIC  X(0010).
  1433*    -------------------------------
  1434     05  SFXL PIC S9(0004) COMP.
  1435     05  SFXF PIC  X(0001).
  1436     05  FILLER REDEFINES SFXF.
  1437         10  SFXA PIC  X(0001).
  1438     05  SFXI PIC  X(0001).
  1439*    -------------------------------
  1440     05  SEQL PIC S9(0004) COMP.
  1441     05  SEQF PIC  X(0001).
  1442     05  FILLER REDEFINES SEQF.
  1443         10  SEQA PIC  X(0001).
  1444     05  SEQI PIC  99.
  1445*    -------------------------------
  1446     05  PAYTO1L PIC S9(0004) COMP.
  1447     05  PAYTO1F PIC  X(0001).
  1448     05  FILLER REDEFINES PAYTO1F.
  1449         10  PAYTO1A PIC  X(0001).
  1450     05  PAYTO1I PIC  X(0030).
  1451*    -------------------------------
  1452     05  CREATEDL PIC S9(0004) COMP.
  1453     05  CREATEDF PIC  X(0001).
  1454     05  FILLER REDEFINES CREATEDF.
  1455         10  CREATEDA PIC  X(0001).
  1456     05  CREATEDI PIC  X(0008).
  1457*    -------------------------------
  1458     05  CBYL PIC S9(0004) COMP.
  1459     05  CBYF PIC  X(0001).
  1460     05  FILLER REDEFINES CBYF.
  1461         10  CBYA PIC  X(0001).
  1462     05  CBYI PIC  X(0004).
  1463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  27
* EL677.cbl
  1464     05  PAYTO2L PIC S9(0004) COMP.
  1465     05  PAYTO2F PIC  X(0001).
  1466     05  FILLER REDEFINES PAYTO2F.
  1467         10  PAYTO2A PIC  X(0001).
  1468     05  PAYTO2I PIC  X(0030).
  1469*    -------------------------------
  1470     05  PAYEEL PIC S9(0004) COMP.
  1471     05  PAYEEF PIC  X(0001).
  1472     05  FILLER REDEFINES PAYEEF.
  1473         10  PAYEEA PIC  X(0001).
  1474     05  PAYEEI PIC  X(0006).
  1475*    -------------------------------
  1476     05  APVSTATL PIC S9(0004) COMP.
  1477     05  APVSTATF PIC  X(0001).
  1478     05  FILLER REDEFINES APVSTATF.
  1479         10  APVSTATA PIC  X(0001).
  1480     05  APVSTATI PIC  X(0009).
  1481*    -------------------------------
  1482     05  PAYAD1L PIC S9(0004) COMP.
  1483     05  PAYAD1F PIC  X(0001).
  1484     05  FILLER REDEFINES PAYAD1F.
  1485         10  PAYAD1A PIC  X(0001).
  1486     05  PAYAD1I PIC  X(0030).
  1487*    -------------------------------
  1488     05  APVDTL PIC S9(0004) COMP.
  1489     05  APVDTF PIC  X(0001).
  1490     05  FILLER REDEFINES APVDTF.
  1491         10  APVDTA PIC  X(0001).
  1492     05  APVDTI PIC  X(0008).
  1493*    -------------------------------
  1494     05  APVBYL PIC S9(0004) COMP.
  1495     05  APVBYF PIC  X(0001).
  1496     05  FILLER REDEFINES APVBYF.
  1497         10  APVBYA PIC  X(0001).
  1498     05  APVBYI PIC  X(0004).
  1499*    -------------------------------
  1500     05  PAYAD2L PIC S9(0004) COMP.
  1501     05  PAYAD2F PIC  X(0001).
  1502     05  FILLER REDEFINES PAYAD2F.
  1503         10  PAYAD2A PIC  X(0001).
  1504     05  PAYAD2I PIC  X(0030).
  1505*    -------------------------------
  1506     05  VOIDEDL PIC S9(0004) COMP.
  1507     05  VOIDEDF PIC  X(0001).
  1508     05  FILLER REDEFINES VOIDEDF.
  1509         10  VOIDEDA PIC  X(0001).
  1510     05  VOIDEDI PIC  X(0008).
  1511*    -------------------------------
  1512     05  VBYL PIC S9(0004) COMP.
  1513     05  VBYF PIC  X(0001).
  1514     05  FILLER REDEFINES VBYF.
  1515         10  VBYA PIC  X(0001).
  1516     05  VBYI PIC  X(0004).
  1517*    -------------------------------
  1518     05  PAYCTYL PIC S9(0004) COMP.
  1519     05  PAYCTYF PIC  X(0001).
  1520     05  FILLER REDEFINES PAYCTYF.
  1521         10  PAYCTYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  28
* EL677.cbl
  1522     05  PAYCTYI PIC  X(0028).
  1523*    -------------------------------
  1524     05  PAYSTL PIC S9(0004) COMP.
  1525     05  PAYSTF PIC  X(0001).
  1526     05  FILLER REDEFINES PAYSTF.
  1527         10  PAYSTA PIC  X(0001).
  1528     05  PAYSTI PIC  X(0002).
  1529*    -------------------------------
  1530     05  PRINTEDL PIC S9(0004) COMP.
  1531     05  PRINTEDF PIC  X(0001).
  1532     05  FILLER REDEFINES PRINTEDF.
  1533         10  PRINTEDA PIC  X(0001).
  1534     05  PRINTEDI PIC  X(0008).
  1535*    -------------------------------
  1536     05  PTOZIPL PIC S9(0004) COMP.
  1537     05  PTOZIPF PIC  X(0001).
  1538     05  FILLER REDEFINES PTOZIPF.
  1539         10  PTOZIPA PIC  X(0001).
  1540     05  PTOZIPI PIC  X(0009).
  1541*    -------------------------------
  1542     05  DEDCYNL PIC S9(0004) COMP.
  1543     05  DEDCYNF PIC  X(0001).
  1544     05  FILLER REDEFINES DEDCYNF.
  1545         10  DEDCYNA PIC  X(0001).
  1546     05  DEDCYNI PIC  X(0001).
  1547*    -------------------------------
  1548     05  CASHEDL PIC S9(0004) COMP.
  1549     05  CASHEDF PIC  X(0001).
  1550     05  FILLER REDEFINES CASHEDF.
  1551         10  CASHEDA PIC  X(0001).
  1552     05  CASHEDI PIC  X(0008).
  1553*    -------------------------------
  1554     05  RETTOL PIC S9(0004) COMP.
  1555     05  RETTOF PIC  X(0001).
  1556     05  FILLER REDEFINES RETTOF.
  1557         10  RETTOA PIC  X(0001).
  1558     05  RETTOI PIC  X(0030).
  1559*    -------------------------------
  1560     05  DPREML PIC S9(0004) COMP.
  1561     05  DPREMF PIC  X(0001).
  1562     05  FILLER REDEFINES DPREMF.
  1563         10  DPREMA PIC  X(0001).
  1564     05  DPREMI PIC  X(0005).
  1565*    -------------------------------
  1566     05  PREML PIC S9(0004) COMP.
  1567     05  PREMF PIC  X(0001).
  1568     05  FILLER REDEFINES PREMF.
  1569         10  PREMA PIC  X(0001).
  1570     05  PREMI PIC  X(0008).
  1571*    -------------------------------
  1572     05  DCOMML PIC S9(0004) COMP.
  1573     05  DCOMMF PIC  X(0001).
  1574     05  FILLER REDEFINES DCOMMF.
  1575         10  DCOMMA PIC  X(0001).
  1576     05  DCOMMI PIC  X(0005).
  1577*    -------------------------------
  1578     05  ISSCOMML PIC S9(0004) COMP.
  1579     05  ISSCOMMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  29
* EL677.cbl
  1580     05  FILLER REDEFINES ISSCOMMF.
  1581         10  ISSCOMMA PIC  X(0001).
  1582     05  ISSCOMMI PIC  X(0008).
  1583*    -------------------------------
  1584     05  DREFL PIC S9(0004) COMP.
  1585     05  DREFF PIC  X(0001).
  1586     05  FILLER REDEFINES DREFF.
  1587         10  DREFA PIC  X(0001).
  1588     05  DREFI PIC  X(0004).
  1589*    -------------------------------
  1590     05  REFL PIC S9(0004) COMP.
  1591     05  REFF PIC  X(0001).
  1592     05  FILLER REDEFINES REFF.
  1593         10  REFA PIC  X(0001).
  1594     05  REFI PIC  X(0008).
  1595*    -------------------------------
  1596     05  DUECOMML PIC S9(0004) COMP.
  1597     05  DUECOMMF PIC  X(0001).
  1598     05  FILLER REDEFINES DUECOMMF.
  1599         10  DUECOMMA PIC  X(0001).
  1600     05  DUECOMMI PIC  X(0007).
  1601*    -------------------------------
  1602     05  UECOMML PIC S9(0004) COMP.
  1603     05  UECOMMF PIC  X(0001).
  1604     05  FILLER REDEFINES UECOMMF.
  1605         10  UECOMMA PIC  X(0001).
  1606     05  UECOMMI PIC  X(0008).
  1607*    -------------------------------
  1608     05  DPREPDL PIC S9(0004) COMP.
  1609     05  DPREPDF PIC  X(0001).
  1610     05  FILLER REDEFINES DPREPDF.
  1611         10  DPREPDA PIC  X(0001).
  1612     05  DPREPDI PIC  X(0006).
  1613*    -------------------------------
  1614     05  PREPDL PIC S9(0004) COMP.
  1615     05  PREPDF PIC  X(0001).
  1616     05  FILLER REDEFINES PREPDF.
  1617         10  PREPDA PIC  X(0001).
  1618     05  PREPDI PIC  X(0008).
  1619*    -------------------------------
  1620     05  AMOUNTL PIC S9(0004) COMP.
  1621     05  AMOUNTF PIC  X(0001).
  1622     05  FILLER REDEFINES AMOUNTF.
  1623         10  AMOUNTA PIC  X(0001).
  1624     05  AMOUNTI PIC  S9(9)V99.
  1625*    -------------------------------
  1626     05  CHECKL PIC S9(0004) COMP.
  1627     05  CHECKF PIC  X(0001).
  1628     05  FILLER REDEFINES CHECKF.
  1629         10  CHECKA PIC  X(0001).
  1630     05  CHECKI PIC  X(0007).
  1631*    -------------------------------
  1632     05  TYPEL PIC S9(0004) COMP.
  1633     05  TYPEF PIC  X(0001).
  1634     05  FILLER REDEFINES TYPEF.
  1635         10  TYPEA PIC  X(0001).
  1636     05  TYPEI PIC  X(0001).
  1637*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  30
* EL677.cbl
  1638     05  REASONL PIC S9(0004) COMP.
  1639     05  REASONF PIC  X(0001).
  1640     05  FILLER REDEFINES REASONF.
  1641         10  REASONA PIC  X(0001).
  1642     05  REASONI PIC  X(0025).
  1643*    -------------------------------
  1644     05  VREASONL PIC S9(0004) COMP.
  1645     05  VREASONF PIC  X(0001).
  1646     05  FILLER REDEFINES VREASONF.
  1647         10  VREASONA PIC  X(0001).
  1648     05  VREASONI PIC  X(0024).
  1649*    -------------------------------
  1650     05  STUBL PIC S9(0004) COMP.
  1651     05  STUBF PIC  X(0001).
  1652     05  FILLER REDEFINES STUBF.
  1653         10  STUBA PIC  X(0001).
  1654     05  STUBI PIC  X(0030).
  1655*    -------------------------------
  1656     05  TEXT1L PIC S9(0004) COMP.
  1657     05  TEXT1F PIC  X(0001).
  1658     05  FILLER REDEFINES TEXT1F.
  1659         10  TEXT1A PIC  X(0001).
  1660     05  TEXT1I PIC  X(0050).
  1661*    -------------------------------
  1662     05  TEXT2L PIC S9(0004) COMP.
  1663     05  TEXT2F PIC  X(0001).
  1664     05  FILLER REDEFINES TEXT2F.
  1665         10  TEXT2A PIC  X(0001).
  1666     05  TEXT2I PIC  X(0050).
  1667*    -------------------------------
  1668     05  TEXT3L PIC S9(0004) COMP.
  1669     05  TEXT3F PIC  X(0001).
  1670     05  FILLER REDEFINES TEXT3F.
  1671         10  TEXT3A PIC  X(0001).
  1672     05  TEXT3I PIC  X(0040).
  1673*    -------------------------------
  1674     05  ERRMSG1L PIC S9(0004) COMP.
  1675     05  ERRMSG1F PIC  X(0001).
  1676     05  FILLER REDEFINES ERRMSG1F.
  1677         10  ERRMSG1A PIC  X(0001).
  1678     05  ERRMSG1I PIC  X(0079).
  1679*    -------------------------------
  1680     05  ERRMSG2L PIC S9(0004) COMP.
  1681     05  ERRMSG2F PIC  X(0001).
  1682     05  FILLER REDEFINES ERRMSG2F.
  1683         10  ERRMSG2A PIC  X(0001).
  1684     05  ERRMSG2I PIC  X(0079).
  1685*    -------------------------------
  1686     05  PFENTERL PIC S9(0004) COMP.
  1687     05  PFENTERF PIC  X(0001).
  1688     05  FILLER REDEFINES PFENTERF.
  1689         10  PFENTERA PIC  X(0001).
  1690     05  PFENTERI PIC  9(2).
  1691*    -------------------------------
  1692     05  PF3L PIC S9(0004) COMP.
  1693     05  PF3F PIC  X(0001).
  1694     05  FILLER REDEFINES PF3F.
  1695         10  PF3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  31
* EL677.cbl
  1696     05  PF3I PIC  X(0016).
  1697*    -------------------------------
  1698     05  PF57L PIC S9(0004) COMP.
  1699     05  PF57F PIC  X(0001).
  1700     05  FILLER REDEFINES PF57F.
  1701         10  PF57A PIC  X(0001).
  1702     05  PF57I PIC  X(0030).
  1703*    -------------------------------
  1704     05  PF4L PIC S9(0004) COMP.
  1705     05  PF4F PIC  X(0001).
  1706     05  FILLER REDEFINES PF4F.
  1707         10  PF4A PIC  X(0001).
  1708     05  PF4I PIC  X(0018).
  1709*    -------------------------------
  1710     05  PF6L PIC S9(0004) COMP.
  1711     05  PF6F PIC  X(0001).
  1712     05  FILLER REDEFINES PF6F.
  1713         10  PF6A PIC  X(0001).
  1714     05  PF6I PIC  X(0013).
  1715 01  EL677AO REDEFINES EL677AI.
  1716     05  FILLER            PIC  X(0012).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  DATEO PIC  X(0008).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  TIMEO PIC  99.99.
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  MAINTO PIC  X(0001).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  DMAINT1O PIC  X(0009).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  DMAINT2O PIC  X(0029).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  CARRIERO PIC  X(0001).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  GROUPO PIC  X(0006).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  STATEO PIC  X(0002).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  ACCTO PIC  X(0010).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  EFFDTO PIC  99B99B99.
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  CERTNOO PIC  X(0010).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  SFXO PIC  X(0001).
  1753*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  32
* EL677.cbl
  1754     05  FILLER            PIC  X(0003).
  1755     05  SEQO PIC  99.
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  PAYTO1O PIC  X(0030).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  CREATEDO PIC  X(0008).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  CBYO PIC  X(0004).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  PAYTO2O PIC  X(0030).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  PAYEEO PIC  X(0006).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  APVSTATO PIC  X(0009).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  PAYAD1O PIC  X(0030).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  APVDTO PIC  X(0008).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  APVBYO PIC  X(0004).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  PAYAD2O PIC  X(0030).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  VOIDEDO PIC  X(0008).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  VBYO PIC  X(0004).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  PAYCTYO PIC  X(0028).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  PAYSTO PIC  X(0002).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  PRINTEDO PIC  99B99B99.
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  PTOZIPO PIC  X(0009).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  DEDCYNO PIC  X(0001).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  CASHEDO PIC  X(0008).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  33
* EL677.cbl
  1812     05  RETTOO PIC  X(0030).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  DPREMO PIC  X(0005).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  PREMO PIC  Z(5).99.
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  DCOMMO PIC  X(0005).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  ISSCOMMO PIC  Z(5).99.
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  DREFO PIC  X(0004).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  REFO PIC  Z(5).99.
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  DUECOMMO PIC  X(0007).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  UECOMMO PIC  Z(5).99.
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  DPREPDO PIC  X(0006).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  PREPDO PIC  Z(5).99.
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  AMOUNTO PIC  Z(7).ZZ-.
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  CHECKO PIC  X(0007).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  TYPEO PIC  X(0001).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  REASONO PIC  X(0025).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  VREASONO PIC  X(0024).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  STUBO PIC  X(0030).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  TEXT1O PIC  X(0050).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  TEXT2O PIC  X(0050).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  TEXT3O PIC  X(0040).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  34
* EL677.cbl
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  ERRMSG1O PIC  X(0079).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ERRMSG2O PIC  X(0079).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  PFENTERO PIC  99.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  PF3O PIC  X(0016).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  PF57O PIC  X(0030).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  PF4O PIC  X(0018).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  PF6O PIC  X(0013).
  1891*    -------------------------------
  1892****************************************************************
  1893*
  1894* Copyright (c) 2007-2013 Dell Inc.
  1895* All rights reserved.
  1896*
  1897****************************************************************
  1898 01  DFHEIV.
  1899   02  DFHEIV0               PIC X(35).
  1900   02  DFHEIV1               PIC X(08).
  1901   02  DFHEIV2               PIC X(08).
  1902   02  DFHEIV3               PIC X(08).
  1903   02  DFHEIV4               PIC X(06).
  1904   02  DFHEIV5               PIC X(04).
  1905   02  DFHEIV6               PIC X(04).
  1906   02  DFHEIV7               PIC X(02).
  1907   02  DFHEIV8               PIC X(02).
  1908   02  DFHEIV9               PIC X(01).
  1909   02  DFHEIV10              PIC S9(7) COMP-3.
  1910   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1911   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1912   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1913   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1914   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1915   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1916   02  DFHEIV17              PIC X(04).
  1917   02  DFHEIV18              PIC X(04).
  1918   02  DFHEIV19              PIC X(04).
  1919   02  DFHEIV20              USAGE IS POINTER.
  1920   02  DFHEIV21              USAGE IS POINTER.
  1921   02  DFHEIV22              USAGE IS POINTER.
  1922   02  DFHEIV23              USAGE IS POINTER.
  1923   02  DFHEIV24              USAGE IS POINTER.
  1924   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1925   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1926   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1927   02  DFHEIV28              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  35
* EL677.cbl
  1928   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1929   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1930   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1931   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1932   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1933   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1934   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1935   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1936   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1937   02  FILLER                PIC X(02).
  1938   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1939   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1940   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1941   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1942   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1943   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1944   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1945 LINKAGE  SECTION.
  1946*****************************************************************
  1947*                                                               *
  1948* Copyright (c) 2007-2013 Dell Inc.                             *
  1949* All rights reserved.                                          *
  1950*                                                               *
  1951*****************************************************************
  1952 01  dfheiblk.
  1953     02  eibtime          pic s9(7) comp-3.
  1954     02  eibdate          pic s9(7) comp-3.
  1955     02  eibtrnid         pic x(4).
  1956     02  eibtaskn         pic s9(7) comp-3.
  1957     02  eibtrmid         pic x(4).
  1958     02  dfheigdi         pic s9(4) comp.
  1959     02  eibcposn         pic s9(4) comp.
  1960     02  eibcalen         pic s9(4) comp.
  1961     02  eibaid           pic x(1).
  1962     02  eibfiller1       pic x(1).
  1963     02  eibfn            pic x(2).
  1964     02  eibfiller2       pic x(2).
  1965     02  eibrcode         pic x(6).
  1966     02  eibfiller3       pic x(2).
  1967     02  eibds            pic x(8).
  1968     02  eibreqid         pic x(8).
  1969     02  eibrsrce         pic x(8).
  1970     02  eibsync          pic x(1).
  1971     02  eibfree          pic x(1).
  1972     02  eibrecv          pic x(1).
  1973     02  eibsend          pic x(1).
  1974     02  eibatt           pic x(1).
  1975     02  eibeoc           pic x(1).
  1976     02  eibfmh           pic x(1).
  1977     02  eibcompl         pic x(1).
  1978     02  eibsig           pic x(1).
  1979     02  eibconf          pic x(1).
  1980     02  eiberr           pic x(1).
  1981     02  eibrldbk         pic x(1).
  1982     02  eiberrcd         pic x(4).
  1983     02  eibsynrb         pic x(1).
  1984     02  eibnodat         pic x(1).
  1985     02  eibfiller5       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  36
* EL677.cbl
  1986     02  eibresp          pic s9(8) comp.
  1987     02  eibresp2         pic s9(8) comp.
  1988     02  dfheigdj         pic s9(4) comp.
  1989     02  dfheigdk         pic s9(4) comp.
  1990 01  DFHCOMMAREA.
  1991     05  filler                  PIC X(1024).
  1992 01  var  pic x(30).
  1993*                                COPY ELCCNTL.
  1994******************************************************************
  1995*                                                                *
  1996*                                                                *
  1997*                            ELCCNTL.                            *
  1998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1999*                            VMOD=2.059                          *
  2000*                                                                *
  2001*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2002*                                                                *
  2003*   FILE TYPE = VSAM,KSDS                                        *
  2004*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2005*                                                                *
  2006*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2007*       ALTERNATE INDEX = NONE                                   *
  2008*                                                                *
  2009*   LOG = YES                                                    *
  2010*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2011******************************************************************
  2012*                   C H A N G E   L O G
  2013*
  2014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2015*-----------------------------------------------------------------
  2016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2017* EFFECTIVE    NUMBER
  2018*-----------------------------------------------------------------
  2019* 082503                   PEMA  ADD BENEFIT GROUP
  2020* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2021* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2022* 092705    2005050300006  PEMA  ADD SPP LEASES
  2023* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2024* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2025* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2026* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2027* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2028* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2029* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2030* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2031* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2032* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2033* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2034******************************************************************
  2035*
  2036 01  CONTROL-FILE.
  2037     12  CF-RECORD-ID                       PIC XX.
  2038         88  VALID-CF-ID                        VALUE 'CF'.
  2039
  2040     12  CF-CONTROL-PRIMARY.
  2041         16  CF-COMPANY-ID                  PIC XXX.
  2042         16  CF-RECORD-TYPE                 PIC X.
  2043             88  CF-COMPANY-MASTER              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  37
* EL677.cbl
  2044             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2045             88  CF-STATE-MASTER                VALUE '3'.
  2046             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2047             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2048             88  CF-CARRIER-MASTER              VALUE '6'.
  2049             88  CF-MORTALITY-MASTER            VALUE '7'.
  2050             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2051             88  CF-TERMINAL-MASTER             VALUE '9'.
  2052             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2053             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2054             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2055             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2056             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2057             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2058             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2059             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2060             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2061         16  CF-ACCESS-CD-GENL              PIC X(4).
  2062         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2063             20  CF-PROCESSOR               PIC X(4).
  2064         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2065             20  CF-STATE-CODE              PIC XX.
  2066             20  FILLER                     PIC XX.
  2067         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2068             20  FILLER                     PIC XX.
  2069             20  CF-HI-BEN-IN-REC           PIC XX.
  2070         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2071             20  FILLER                     PIC XXX.
  2072             20  CF-CARRIER-CNTL            PIC X.
  2073         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2074             20  FILLER                     PIC XX.
  2075             20  CF-HI-TYPE-IN-REC          PIC 99.
  2076         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2077             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2078                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2079             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2080             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2081         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2082             20  FILLER                     PIC X.
  2083             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2084         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2085             20  FILLER                     PIC XX.
  2086             20  CF-MORTGAGE-PLAN           PIC XX.
  2087         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2088
  2089     12  CF-LAST-MAINT-DT                   PIC XX.
  2090     12  CF-LAST-MAINT-BY                   PIC X(4).
  2091     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2092
  2093     12  CF-RECORD-BODY                     PIC X(728).
  2094
  2095
  2096****************************************************************
  2097*             COMPANY MASTER RECORD                            *
  2098****************************************************************
  2099
  2100     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2101         16  CF-COMPANY-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  38
* EL677.cbl
  2102             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2103             20  CF-CL-IN-CARE-OF           PIC X(30).
  2104             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2105             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2106             20  CF-CL-CITY-STATE           PIC X(30).
  2107             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2108             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2109         16  CF-COMPANY-CD                  PIC X.
  2110         16  CF-COMPANY-PASSWORD            PIC X(8).
  2111         16  CF-SECURITY-OPTION             PIC X.
  2112             88  ALL-SECURITY                   VALUE '1'.
  2113             88  COMPANY-VERIFY                 VALUE '2'.
  2114             88  PROCESSOR-VERIFY               VALUE '3'.
  2115             88  NO-SECURITY                    VALUE '4'.
  2116             88  ALL-BUT-TERM                   VALUE '5'.
  2117         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2118             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2119         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2120             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2121         16  CF-INFORCE-LOCATION            PIC X.
  2122             88  CERTS-ARE-ONLINE               VALUE '1'.
  2123             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2124             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2125         16  CF-LOWER-CASE-LETTERS          PIC X.
  2126         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2127             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2128             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2129             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2130             88  CF-ACCNT-CNTL                  VALUE '3'.
  2131             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2132
  2133         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2134         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2135
  2136         16  CF-LGX-CREDIT-USER             PIC X.
  2137             88  CO-IS-NOT-USER                 VALUE 'N'.
  2138             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2139
  2140         16 CF-CREDIT-CALC-CODES.
  2141             20  CF-CR-REM-TERM-CALC PIC X.
  2142               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2143               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2144               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2145               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2146               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2147               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2148               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2149             20  CF-CR-R78-METHOD           PIC X.
  2150               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2151               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2152
  2153         16  CF-CLAIM-CONTROL-COUNTS.
  2154             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2155                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2156
  2157             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2158                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2159
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  39
* EL677.cbl
  2160             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2161                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2162
  2163             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2164                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2165
  2166         16  CF-CURRENT-MONTH-END           PIC XX.
  2167
  2168         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2169             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2170             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2171             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2172             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2173                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2174                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2175             20  CF-CO-PREM-REJECT-SW       PIC X.
  2176                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2177                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2178             20  CF-CO-REF-REJECT-SW        PIC X.
  2179                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2180                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2181
  2182         16  CF-CO-REPORTING-DT             PIC XX.
  2183         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2184         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2185           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2186           88  CF-CO-MONTH-END                  VALUE '1'.
  2187
  2188         16  CF-LGX-CLAIM-USER              PIC X.
  2189             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2190             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2191
  2192         16  CF-CREDIT-EDIT-CONTROLS.
  2193             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2194             20  CF-MIN-AGE                 PIC 99.
  2195             20  CF-DEFAULT-AGE             PIC 99.
  2196             20  CF-MIN-TERM                PIC S999      COMP-3.
  2197             20  CF-MAX-TERM                PIC S999      COMP-3.
  2198             20  CF-DEFAULT-SEX             PIC X.
  2199             20  CF-JOINT-AGE-INPUT         PIC X.
  2200                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2201             20  CF-BIRTH-DATE-INPUT        PIC X.
  2202                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2203             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2204                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2205                 88  CF-ZERO-CARRIER            VALUE '1'.
  2206                 88  CF-ZERO-GROUPING           VALUE '2'.
  2207                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2208             20  CF-EDIT-SW                 PIC X.
  2209                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2210             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2211             20  CF-CR-PR-METHOD            PIC X.
  2212               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2213               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2214             20  FILLER                     PIC X.
  2215
  2216         16  CF-CREDIT-MISC-CONTROLS.
  2217             20  CF-REIN-TABLE-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  40
* EL677.cbl
  2218                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2219             20  CF-COMP-TABLE-SW           PIC X.
  2220                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2221             20  CF-EXPERIENCE-RETENTION-AGE
  2222                                            PIC S9        COMP-3.
  2223             20  CF-CONVERSION-DT           PIC XX.
  2224             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2225             20  CF-RUN-FREQUENCY-SW        PIC X.
  2226                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2227                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2228
  2229             20  CF-CR-CHECK-NO-CONTROL.
  2230                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2231                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2232                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2233                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2234                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2235                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2236
  2237                 24  CF-CR-CHECK-COUNT       REDEFINES
  2238                     CF-CR-CHECK-COUNTER      PIC X(4).
  2239
  2240                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2241                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2242
  2243                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2244                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2245                 24  CF-MAIL-PROCESSING       PIC X.
  2246                     88  MAIL-PROCESSING          VALUE 'Y'.
  2247
  2248         16  CF-MISC-SYSTEM-CONTROL.
  2249             20  CF-SYSTEM-C                 PIC X.
  2250                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2251             20  CF-SYSTEM-D                 PIC X.
  2252                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2253             20  CF-SOC-SEC-NO-SW            PIC X.
  2254                 88  SOC-SEC-NO-USED             VALUE '1'.
  2255             20  CF-MEMBER-NO-SW             PIC X.
  2256                 88  MEMBER-NO-USED              VALUE '1'.
  2257             20  CF-TAX-ID-NUMBER            PIC X(11).
  2258             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2259             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2260                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2261                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2262                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2263                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2264             20  CF-SYSTEM-E                 PIC X.
  2265                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2266
  2267         16  CF-LGX-LIFE-USER               PIC X.
  2268             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2269             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2270
  2271         16  CF-CR-MONTH-END-DT             PIC XX.
  2272
  2273         16  CF-FILE-MAINT-DATES.
  2274             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2275                 88  CF-LAST-BATCH-RESET        VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  41
* EL677.cbl
  2276             20  CF-LAST-BATCH       REDEFINES
  2277                 CF-LAST-BATCH-NO               PIC X(4).
  2278             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2279             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2280             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2281             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2282             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2283             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2284             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2285             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2286             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2287             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2288
  2289         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2290         16  FILLER                         PIC X.
  2291
  2292         16  CF-ALT-MORT-CODE               PIC X(4).
  2293         16  CF-MEMBER-CAPTION              PIC X(10).
  2294
  2295         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2296             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2297             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2298             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2299             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2300             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2301
  2302         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2303
  2304         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2305         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2306         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2307         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2308
  2309         16  CF-AH-OVERRIDE-L1              PIC X.
  2310         16  CF-AH-OVERRIDE-L2              PIC XX.
  2311         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2312         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2313
  2314         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2315         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2316
  2317         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2318         16  CF-AR-LAST-EL860-DT            PIC XX.
  2319         16  CF-MP-MONTH-END-DT             PIC XX.
  2320
  2321         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2322         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2323             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2324
  2325         16  CF-AR-MONTH-END-DT             PIC XX.
  2326
  2327         16  CF-CRDTCRD-USER                PIC X.
  2328             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2329             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2330
  2331         16  CF-CC-MONTH-END-DT             PIC XX.
  2332
  2333         16  CF-PRINT-ADDRESS-LABELS        PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  42
* EL677.cbl
  2334
  2335         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2336             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2337             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2338             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2339         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2340         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2341         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2342         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2343             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2344             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2345         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2346         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2347         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2348             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2349         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2350
  2351         16  CF-CL-ZIP-CODE.
  2352             20  CF-CL-ZIP-PRIME.
  2353                 24  CF-CL-ZIP-1ST          PIC X.
  2354                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2355                 24  FILLER                 PIC X(4).
  2356             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2357         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2358             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2359             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2360             20  FILLER                     PIC XXX.
  2361
  2362         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2363         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2364         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2365         16  CF-CO-OPTION-START-DATE        PIC XX.
  2366         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2367           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2368                                                      '3' '4'.
  2369           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2370           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2371           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2372           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2373           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2374           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2375
  2376         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2377
  2378         16  CF-PAYMENT-APPROVAL-LEVELS.
  2379             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2380             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2381             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2382             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2383             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2384             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2385
  2386         16  CF-END-USER-REPORTING-USER     PIC X.
  2387             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2388             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2389
  2390         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2391             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  43
* EL677.cbl
  2392             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2393
  2394         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2395
  2396         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2397         16  FILLER                         PIC X.
  2398
  2399         16  CF-CREDIT-ARCHIVE-CNTL.
  2400             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2401             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2402             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2403
  2404         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2405
  2406         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2407             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2408             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2409
  2410         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2411             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2412             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2413
  2414         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2415
  2416         16  CF-CO-ACH-ID-CODE              PIC  X.
  2417             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2418             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2419             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2420         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2421         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2422         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2423         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2424         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2425         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2426         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2427         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2428         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2429                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2430         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2431                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2432
  2433         16  CF-CO-OVER-SHORT.
  2434             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2435             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2436
  2437*         16  FILLER                         PIC X(102).
  2438         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2439             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2440             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2441
  2442         16  CF-AH-APPROVAL-DAYS.
  2443             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2444             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2445             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2446             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2447
  2448         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2449
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  44
* EL677.cbl
  2450         16  CF-APPROV-LEV-5.
  2451             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2452             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2453             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2454
  2455         16  FILLER                         PIC X(68).
  2456****************************************************************
  2457*             PROCESSOR/USER RECORD                            *
  2458****************************************************************
  2459
  2460     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2461         16  CF-PROCESSOR-NAME              PIC X(30).
  2462         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2463         16  CF-PROCESSOR-TITLE             PIC X(26).
  2464         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2465                 88  MESSAGE-YES                VALUE 'Y'.
  2466                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2467
  2468*****************************************************
  2469****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2470****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2471****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2472****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2473*****************************************************
  2474
  2475         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2476             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2477             20  CF-APPLICATION-FORCE       PIC X.
  2478             20  CF-INDIVIDUAL-APP.
  2479                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2480                     28  CF-BROWSE-APP      PIC X.
  2481                     28  CF-UPDATE-APP      PIC X.
  2482
  2483         16  CF-CURRENT-TERM-ON             PIC X(4).
  2484         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2485             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2486             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2487             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2488             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2489             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2490             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2491             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2492         16  CF-PROCESSOR-CARRIER           PIC X.
  2493             88  NO-CARRIER-SECURITY            VALUE ' '.
  2494         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2495             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2496         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2497             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2498         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2499             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2500
  2501         16  CF-PROC-SYS-ACCESS-SW.
  2502             20  CF-PROC-CREDIT-CLAIMS-SW.
  2503                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2504                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2505                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2506                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2507             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  45
* EL677.cbl
  2508                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2509                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2510             20  CF-PROC-LIFE-GNRLDGR-SW.
  2511                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2512                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2513                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2514                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2515             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2516                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2517                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2518         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2519             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2520             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2521         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2522
  2523         16  CF-APPROVAL-LEVEL                  PIC X.
  2524             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2525             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2526             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2527             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2528             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2529
  2530         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2531
  2532         16  CF-LANGUAGE-TYPE                   PIC X.
  2533             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2534             88  CF-LANG-IS-FR                      VALUE 'F'.
  2535
  2536         16  CF-CSR-IND                         PIC X.
  2537         16  FILLER                             PIC X(239).
  2538
  2539****************************************************************
  2540*             PROCESSOR/REMINDERS RECORD                       *
  2541****************************************************************
  2542
  2543     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2544         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2545             20  CF-START-REMIND-DT         PIC XX.
  2546             20  CF-END-REMIND-DT           PIC XX.
  2547             20  CF-REMINDER-TEXT           PIC X(50).
  2548         16  FILLER                         PIC X(296).
  2549
  2550
  2551****************************************************************
  2552*             STATE MASTER RECORD                              *
  2553****************************************************************
  2554
  2555     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2556         16  CF-STATE-ABBREVIATION          PIC XX.
  2557         16  CF-STATE-NAME                  PIC X(25).
  2558         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2559         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2560             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2561             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2562             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2563             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2564                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2565                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  46
* EL677.cbl
  2566             20  CF-ST-PREM-REJECT-SW       PIC X.
  2567                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2568                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2569             20  CF-ST-REF-REJECT-SW        PIC X.
  2570                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2571                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2572         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2573         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2574         16  CF-ST-REFUND-RULES.
  2575             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2576             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2577             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2578         16  CF-ST-FST-PMT-EXTENSION.
  2579             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2580             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2581                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2582                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2583                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2584                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2585         16  CF-ST-STATE-CALL.
  2586             20  CF-ST-CALL-UNEARNED        PIC X.
  2587             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2588             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2589         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2590             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2591             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2592         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2593         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2594         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2595         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2596         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2597         16  FILLER                         PIC X.
  2598         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2599             20  CF-ST-BENEFIT-CD           PIC XX.
  2600             20  CF-ST-BENEFIT-KIND         PIC X.
  2601                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2602                 88  CF-ST-AH-KIND              VALUE 'A'.
  2603             20  CF-ST-REM-TERM-CALC        PIC X.
  2604                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2605                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2606                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2607                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2608                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2609                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2610                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2611                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2612
  2613             20  CF-ST-REFUND-CALC          PIC X.
  2614                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2615                 88  ST-REFD-BY-R78             VALUE '1'.
  2616                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2617                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2618                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2619                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2620                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2621                 88  ST-REFD-UTAH               VALUE '7'.
  2622                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2623                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  47
* EL677.cbl
  2624                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2625
  2626             20  CF-ST-EARNING-CALC         PIC X.
  2627                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2628                 88  ST-EARN-BY-R78             VALUE '1'.
  2629                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2630                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2631                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2632                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2633                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2634                 88  ST-EARN-MEAN               VALUE '8'.
  2635                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2636
  2637             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2638                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2639                 88  ST-OVRD-BY-R78             VALUE '1'.
  2640                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2641                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2642                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2643                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2644                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2645                 88  ST-OVRD-MEAN               VALUE '8'.
  2646                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2647             20  cf-st-extra-periods        pic 9.
  2648*            20  FILLER                     PIC X.
  2649
  2650         16  CF-ST-COMMISSION-CAPS.
  2651             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2652             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2653             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2654             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2655         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2656                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2657                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2658                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2659
  2660         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2661
  2662         16  CF-ST-STATUTORY-INTEREST.
  2663             20  CF-ST-STAT-DATE-FROM       PIC X.
  2664                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2665                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2666             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2667             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2668             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2669             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2670             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2671
  2672         16  CF-ST-OVER-SHORT.
  2673             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2674             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2675
  2676         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2677
  2678         16  CF-ST-RT-CALC                  PIC X.
  2679
  2680         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2681         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  48
* EL677.cbl
  2682         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2683         16  CF-ST-RF-LR-CALC               PIC X.
  2684         16  CF-ST-RF-LL-CALC               PIC X.
  2685         16  CF-ST-RF-LN-CALC               PIC X.
  2686         16  CF-ST-RF-AH-CALC               PIC X.
  2687         16  CF-ST-RF-CP-CALC               PIC X.
  2688*        16  FILLER                         PIC X(206).
  2689*CIDMOD         16  FILLER                         PIC X(192).
  2690         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2691             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2692         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2693         16  CF-ST-VFY-2ND-BENE             PIC X.
  2694         16  CF-ST-CAUSAL-STATE             PIC X.
  2695         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2696         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2697         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2698             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2699         16  CF-ST-NET-ONLY-STATE           PIC X.
  2700             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2701         16  cf-commission-cap-required     pic x.
  2702         16  CF-ST-GA-COMMISSION-CAPS.
  2703             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2704             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2705             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2706             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2707         16  CF-ST-TOT-COMMISSION-CAPS.
  2708             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2709             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2710             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2711             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2712         16  FILLER                         PIC X(156).
  2713
  2714****************************************************************
  2715*             BENEFIT MASTER RECORD                            *
  2716****************************************************************
  2717
  2718     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2719         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2720             20  CF-BENEFIT-CODE            PIC XX.
  2721             20  CF-BENEFIT-NUMERIC  REDEFINES
  2722                 CF-BENEFIT-CODE            PIC XX.
  2723             20  CF-BENEFIT-ALPHA           PIC XXX.
  2724             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2725             20  CF-BENEFIT-COMMENT         PIC X(10).
  2726
  2727             20  CF-LF-COVERAGE-TYPE        PIC X.
  2728                 88  CF-REDUCING                VALUE 'R'.
  2729                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2730
  2731             20  CF-SPECIAL-CALC-CD         PIC X.
  2732                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2733                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2734                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2735                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2736                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2737                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2738                 88  CF-FARM-PLAN               VALUE 'F'.
  2739                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  49
* EL677.cbl
  2740                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2741                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2742                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2743                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2744                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2745                 88  CF-PRUDENTIAL              VALUE 'P'.
  2746                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2747                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2748                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2749                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2750                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2751                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2752
  2753             20  CF-JOINT-INDICATOR         PIC X.
  2754                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2755
  2756*            20  FILLER                     PIC X(12).
  2757             20  cf-maximum-benefits        pic s999 comp-3.
  2758             20  FILLER                     PIC X(09).
  2759             20  CF-BENEFIT-CATEGORY        PIC X.
  2760             20  CF-LOAN-TYPE               PIC X(8).
  2761
  2762             20  CF-CO-REM-TERM-CALC        PIC X.
  2763                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2764                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2765                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2766                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2767                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2768
  2769             20  CF-CO-EARNINGS-CALC        PIC X.
  2770                 88  CO-EARN-BY-R78             VALUE '1'.
  2771                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2772                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2773                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2774                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2775                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2776                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2777                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2778
  2779             20  CF-CO-REFUND-CALC          PIC X.
  2780                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2781                 88  CO-REFD-BY-R78             VALUE '1'.
  2782                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2783                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2784                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2785                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2786                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2787                 88  CO-REFD-MEAN               VALUE '8'.
  2788                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2789                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2790                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2791
  2792             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2793                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2794                 88  CO-OVRD-BY-R78             VALUE '1'.
  2795                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2796                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2797                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  50
* EL677.cbl
  2798                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2799                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2800                 88  CO-OVRD-MEAN               VALUE '8'.
  2801                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2802
  2803             20  CF-CO-BEN-I-G-CD           PIC X.
  2804                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2805                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2806                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2807
  2808         16  FILLER                         PIC X(304).
  2809
  2810
  2811****************************************************************
  2812*             CARRIER MASTER RECORD                            *
  2813****************************************************************
  2814
  2815     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2816         16  CF-ADDRESS-DATA.
  2817             20  CF-MAIL-TO-NAME            PIC X(30).
  2818             20  CF-IN-CARE-OF              PIC X(30).
  2819             20  CF-ADDRESS-LINE-1          PIC X(30).
  2820             20  CF-ADDRESS-LINE-2          PIC X(30).
  2821             20  CF-CITY-STATE              PIC X(30).
  2822             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2823             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2824
  2825         16  CF-CLAIM-NO-CONTROL.
  2826             20  CF-CLAIM-NO-METHOD         PIC X.
  2827                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2828                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2829                 88  CLAIM-NO-SEQ               VALUE '3'.
  2830                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2831             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2832                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2833                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2834                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2835
  2836         16  CF-CHECK-NO-CONTROL.
  2837             20  CF-CHECK-NO-METHOD         PIC X.
  2838                 88  CHECK-NO-MANUAL            VALUE '1'.
  2839                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2840                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2841                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2842             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2843                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2844
  2845         16  CF-DOMICILE-STATE              PIC XX.
  2846
  2847         16  CF-EXPENSE-CONTROLS.
  2848             20  CF-EXPENSE-METHOD          PIC X.
  2849                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2850                 88  DOLLARS-PER-PMT            VALUE '2'.
  2851                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2852                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2853             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2854             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2855
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  51
* EL677.cbl
  2856         16  CF-CORRESPONDENCE-CONTROL.
  2857             20  CF-LETTER-RESEND-OPT       PIC X.
  2858                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2859                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2860             20  FILLER                     PIC X(4).
  2861
  2862         16  CF-RESERVE-CONTROLS.
  2863             20  CF-MANUAL-SW               PIC X.
  2864                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2865             20  CF-FUTURE-SW               PIC X.
  2866                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2867             20  CF-PTC-SW                  PIC X.
  2868                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2869             20  CF-IBNR-SW                 PIC X.
  2870                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2871             20  CF-PTC-LF-SW               PIC X.
  2872                 88  CF-LF-PTC-USED             VALUE '1'.
  2873             20  CF-CDT-ACCESS-METHOD       PIC X.
  2874                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2875                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2876                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2877             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2878
  2879         16  CF-CLAIM-CALC-METHOD           PIC X.
  2880             88  360-PLUS-MONTHS                VALUE '1'.
  2881             88  365-PLUS-MONTHS                VALUE '2'.
  2882             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2883             88  360-DAILY                      VALUE '4'.
  2884             88  365-DAILY                      VALUE '5'.
  2885
  2886         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2887         16  FILLER                         PIC X(11).
  2888
  2889         16  CF-LIMIT-AMOUNTS.
  2890             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2891             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2892             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2893             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2894             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2895             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2896             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2897             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2898             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2899             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2900
  2901         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2902         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2903         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2904
  2905         16  CF-ZIP-CODE.
  2906             20  CF-ZIP-PRIME.
  2907                 24  CF-ZIP-1ST             PIC X.
  2908                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2909                 24  FILLER                 PIC X(4).
  2910             20  CF-ZIP-PLUS4               PIC X(4).
  2911         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2912             20  CF-CAN-POSTAL-1            PIC XXX.
  2913             20  CF-CAN-POSTAL-2            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  52
* EL677.cbl
  2914             20  FILLER                     PIC XXX.
  2915
  2916         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2917         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2918         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2919
  2920         16  CF-RATING-SWITCH               PIC X.
  2921             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2922             88  CF-NO-RATING                   VALUE 'N'.
  2923
  2924         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2925
  2926         16  CF-CARRIER-OVER-SHORT.
  2927             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2928             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2929
  2930         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2931         16  CF-SECPAY-SWITCH               PIC X.
  2932             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2933             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2934         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2935         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2936         16  FILLER                         PIC X(444).
  2937*        16  FILLER                         PIC X(452).
  2938
  2939
  2940****************************************************************
  2941*             MORTALITY MASTER RECORD                          *
  2942****************************************************************
  2943
  2944     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2945         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2946                                INDEXED BY CF-MORT-NDX.
  2947             20  CF-MORT-TABLE              PIC X(5).
  2948             20  CF-MORT-TABLE-TYPE         PIC X.
  2949                 88  CF-MORT-JOINT              VALUE 'J'.
  2950                 88  CF-MORT-SINGLE             VALUE 'S'.
  2951                 88  CF-MORT-COMBINED           VALUE 'C'.
  2952                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2953                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2954             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2955             20  CF-MORT-AGE-METHOD         PIC XX.
  2956                 88  CF-AGE-LAST                VALUE 'AL'.
  2957                 88  CF-AGE-NEAR                VALUE 'AN'.
  2958             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2959             20  CF-MORT-ADJUSTMENT-DIRECTION
  2960                                            PIC X.
  2961                 88  CF-MINUS                   VALUE '-'.
  2962                 88  CF-PLUS                    VALUE '+'.
  2963             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2964             20  CF-MORT-JOINT-CODE         PIC X.
  2965                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2966             20  CF-MORT-PC-Q               PIC X.
  2967                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2968             20  CF-MORT-TABLE-CODE         PIC X(4).
  2969             20  CF-MORT-COMMENTS           PIC X(15).
  2970             20  FILLER                     PIC X(14).
  2971
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  53
* EL677.cbl
  2972         16  FILLER                         PIC X(251).
  2973
  2974
  2975****************************************************************
  2976*             BUSSINESS TYPE MASTER RECORD                     *
  2977****************************************************************
  2978
  2979     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2980* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2981* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2982* AND RECORD 05 IS TYPES 81-99
  2983         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2984             20  CF-BUSINESS-TITLE          PIC  X(19).
  2985             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2986                                            PIC S9V9(4) COMP-3.
  2987             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2988             20  FILLER                     PIC  X.
  2989         16  FILLER                         PIC  X(248).
  2990
  2991
  2992****************************************************************
  2993*             TERMINAL MASTER RECORD                           *
  2994****************************************************************
  2995
  2996     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2997
  2998         16  CF-COMPANY-TERMINALS.
  2999             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3000                                  PIC X(4).
  3001         16  FILLER               PIC X(248).
  3002
  3003
  3004****************************************************************
  3005*             LIFE EDIT MASTER RECORD                          *
  3006****************************************************************
  3007
  3008     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3009         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3010             20  CF-LIFE-CODE-IN            PIC XX.
  3011             20  CF-LIFE-CODE-OUT           PIC XX.
  3012         16  FILLER                         PIC X(248).
  3013
  3014
  3015****************************************************************
  3016*             AH EDIT MASTER RECORD                            *
  3017****************************************************************
  3018
  3019     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3020         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3021             20  CF-AH-CODE-IN              PIC XXX.
  3022             20  CF-AH-CODE-OUT             PIC XX.
  3023         16  FILLER                         PIC X(248).
  3024
  3025
  3026****************************************************************
  3027*             CREDIBILITY TABLES                               *
  3028****************************************************************
  3029
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  54
* EL677.cbl
  3030     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3031         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3032                             INDEXED BY CF-CRDB-NDX.
  3033             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3034             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3035             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3036         16  FILLER                         PIC  X(332).
  3037
  3038
  3039****************************************************************
  3040*             REPORT CUSTOMIZATION RECORD                      *
  3041****************************************************************
  3042
  3043     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3044         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3045             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3046             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3047             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3048**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3049****       A T-TRANSFER.                                   ****
  3050             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3051
  3052         16  FILLER                         PIC XX.
  3053
  3054         16  CF-CARRIER-CNTL-OPT.
  3055             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3056                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3057                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3058             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3059                                            PIC X.
  3060         16  CF-GROUP-CNTL-OPT.
  3061             20  CF-GROUP-OPT-SEQ           PIC 9.
  3062                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3063                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3064             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3065                                            PIC X(6).
  3066         16  CF-STATE-CNTL-OPT.
  3067             20  CF-STATE-OPT-SEQ           PIC 9.
  3068                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3069                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3070             20  CF-STATE-SELECT OCCURS 3 TIMES
  3071                                            PIC XX.
  3072         16  CF-ACCOUNT-CNTL-OPT.
  3073             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3074                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3075                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3076             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3077                                            PIC X(10).
  3078         16  CF-BUS-TYP-CNTL-OPT.
  3079             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3080                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3081                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3082             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3083                                            PIC XX.
  3084         16  CF-LF-TYP-CNTL-OPT.
  3085             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3086                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3087                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  55
* EL677.cbl
  3088             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3089                                            PIC XX.
  3090         16  CF-AH-TYP-CNTL-OPT.
  3091             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3092                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3093                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3094             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3095                                            PIC XX.
  3096         16  CF-REPTCD1-CNTL-OPT.
  3097             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3098                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3099                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3100             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3101                                            PIC X(10).
  3102         16  CF-REPTCD2-CNTL-OPT.
  3103             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3104                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3105                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3106             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3107                                            PIC X(10).
  3108         16  CF-USER1-CNTL-OPT.
  3109             20  CF-USER1-OPT-SEQ           PIC 9.
  3110                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3111                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3112             20  CF-USER1-SELECT OCCURS 3 TIMES
  3113                                            PIC X(10).
  3114         16  CF-USER2-CNTL-OPT.
  3115             20  CF-USER2-OPT-SEQ           PIC 9.
  3116                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3117                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3118             20  CF-USER2-SELECT OCCURS 3 TIMES
  3119                                            PIC X(10).
  3120         16  CF-USER3-CNTL-OPT.
  3121             20  CF-USER3-OPT-SEQ           PIC 9.
  3122                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3123                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3124             20  CF-USER3-SELECT OCCURS 3 TIMES
  3125                                            PIC X(10).
  3126         16  CF-USER4-CNTL-OPT.
  3127             20  CF-USER4-OPT-SEQ           PIC 9.
  3128                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3129                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3130             20  CF-USER4-SELECT OCCURS 3 TIMES
  3131                                            PIC X(10).
  3132         16  CF-USER5-CNTL-OPT.
  3133             20  CF-USER5-OPT-SEQ           PIC 9.
  3134                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3135                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3136             20  CF-USER5-SELECT OCCURS 3 TIMES
  3137                                            PIC X(10).
  3138         16  CF-REINS-CNTL-OPT.
  3139             20  CF-REINS-OPT-SEQ           PIC 9.
  3140                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3141                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3142             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3143                 24  CF-REINS-PRIME         PIC XXX.
  3144                 24  CF-REINS-SUB           PIC XXX.
  3145
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  56
* EL677.cbl
  3146         16  CF-AGENT-CNTL-OPT.
  3147             20  CF-AGENT-OPT-SEQ           PIC 9.
  3148                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3149                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3150             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3151                                            PIC X(10).
  3152
  3153         16  FILLER                         PIC X(43).
  3154
  3155         16  CF-LOSS-RATIO-SELECT.
  3156             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3157             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3158         16  CF-ENTRY-DATE-SELECT.
  3159             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3160             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3161         16  CF-EFFECTIVE-DATE-SELECT.
  3162             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3163             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3164
  3165         16  CF-EXCEPTION-LIST-IND          PIC X.
  3166             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3167
  3168         16  FILLER                         PIC X(318).
  3169
  3170****************************************************************
  3171*                  EXCEPTION REPORTING RECORD                  *
  3172****************************************************************
  3173
  3174     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3175         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3176             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3177
  3178         16  CF-COMBINED-LIFE-AH-OPT.
  3179             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3180             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3181             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3182             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3183
  3184         16  CF-LIFE-OPT.
  3185             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3186             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3187             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3188             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3189             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3190             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3191             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3192             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3193             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3194             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3195
  3196         16  CF-AH-OPT.
  3197             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3198             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3199             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3200             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3201             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3202             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3203             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  57
* EL677.cbl
  3204             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3205             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3206             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3207
  3208         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3209             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3210             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3211             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3212
  3213         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3214
  3215         16  FILLER                         PIC X(673).
  3216
  3217
  3218****************************************************************
  3219*             MORTGAGE SYSTEM PLAN RECORD                      *
  3220****************************************************************
  3221
  3222     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3223         16  CF-PLAN-TYPE                   PIC X.
  3224             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3225             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3226             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3227         16  CF-PLAN-ABBREV                 PIC XXX.
  3228         16  CF-PLAN-DESCRIPT               PIC X(10).
  3229         16  CF-PLAN-NOTES                  PIC X(20).
  3230         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3231         16  CF-PLAN-UNDERWRITING.
  3232             20  CF-PLAN-TERM-DATA.
  3233                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3234                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3235             20  CF-PLAN-AGE-DATA.
  3236                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3237                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3238                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3239             20  CF-PLAN-BENEFIT-DATA.
  3240                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3241                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3242                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3243                                            PIC S9(7)V99  COMP-3.
  3244         16  CF-PLAN-POLICY-FORMS.
  3245             20  CF-POLICY-FORM             PIC X(12).
  3246             20  CF-MASTER-APPLICATION      PIC X(12).
  3247             20  CF-MASTER-POLICY           PIC X(12).
  3248         16  CF-PLAN-RATING.
  3249             20  CF-RATE-CODE               PIC X(5).
  3250             20  CF-SEX-RATING              PIC X.
  3251                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3252                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3253             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3254             20  CF-SUB-STD-TYPE            PIC X.
  3255                 88  CF-PCT-OF-PREM            VALUE '1'.
  3256                 88  CF-PCT-OF-BENE            VALUE '2'.
  3257         16  CF-PLAN-PREM-TOLERANCES.
  3258             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3259             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3260         16  CF-PLAN-PYMT-TOLERANCES.
  3261             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  58
* EL677.cbl
  3262             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3263         16  CF-PLAN-MISC-DATA.
  3264             20  FILLER                     PIC X.
  3265             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3266             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3267         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3268         16  CF-PLAN-IND-GRP                PIC X.
  3269             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3270                                                     '1'.
  3271             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3272                                                     '2'.
  3273         16  CF-MIB-SEARCH-SW               PIC X.
  3274             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3275             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3276             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3277             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3278         16  CF-ALPHA-SEARCH-SW             PIC X.
  3279             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3280             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3281             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3282             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3283             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3284             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3285             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3286             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3287             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3288             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3289                                                     'A' 'B' 'C'
  3290                                                     'X' 'Y' 'Z'.
  3291         16  CF-EFF-DT-RULE-SW              PIC X.
  3292             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3293             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3294             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3295             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3296             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3297         16  FILLER                         PIC X(4).
  3298         16  CF-HEALTH-QUESTIONS            PIC X.
  3299             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3300         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3301         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3302         16  CF-PLAN-SNGL-JNT               PIC X.
  3303             88  CF-COMBINED-PLAN              VALUE 'C'.
  3304             88  CF-JNT-PLAN                   VALUE 'J'.
  3305             88  CF-SNGL-PLAN                  VALUE 'S'.
  3306         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3307         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3308         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3309         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3310         16  CF-RERATE-CNTL                 PIC  X.
  3311             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3312             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3313             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3314             88  CF-AUTO-RECALC                 VALUE '4'.
  3315         16  CF-BENEFIT-TYPE                PIC  X.
  3316             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3317             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3318         16  CF-POLICY-FEE                  PIC S999V99
  3319                                                    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  59
* EL677.cbl
  3320         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3321         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3322         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3323         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3324         16  FILLER                         PIC  X(32).
  3325         16  CF-TERMINATION-FORM            PIC  X(04).
  3326         16  FILLER                         PIC  X(08).
  3327         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3328                                                       COMP-3.
  3329         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3330         16  CF-ISSUE-LETTER                PIC  X(4).
  3331         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3332         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3333             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3334             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3335         16  CF-MP-REFUND-CALC              PIC X.
  3336             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3337             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3338             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3339             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3340             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3341             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3342             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3343             88  CF-MP-REFD-MEAN                VALUE '8'.
  3344         16  CF-ALT-RATE-CODE               PIC  X(5).
  3345
  3346
  3347         16  FILLER                         PIC X(498).
  3348****************************************************************
  3349*             MORTGAGE COMPANY MASTER RECORD                   *
  3350****************************************************************
  3351
  3352     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3353         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3354         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3355             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3356             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3357             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3358             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3359             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3360
  3361         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3362         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3363         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3364         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3365         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3366
  3367         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3368             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3369         16  CF-MP-RECON-USE-IND            PIC X(1).
  3370             88  CF-MP-USE-RECON             VALUE 'Y'.
  3371         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3372             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3373         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3374             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3375             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3376         16  FILLER                         PIC X(1).
  3377         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  60
* EL677.cbl
  3378             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3379         16  CF-MORTG-MIB-VERSION           PIC X.
  3380             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3381             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3382             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3383         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3384             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3385                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3386             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3387                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3388             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3389                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3390             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3391                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3392             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3393                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3394             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3395                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3396         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3397         16  FILLER                         PIC X(7).
  3398         16  CF-MORTG-DESTINATION-SYMBOL.
  3399             20  CF-MORTG-MIB-COMM          PIC X(5).
  3400             20  CF-MORTG-MIB-TERM          PIC X(5).
  3401         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3402             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3403         16  FILLER                         PIC X(03).
  3404         16  CF-MP-CHECK-NO-CONTROL.
  3405             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3406                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3407                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3408                                                ' ' LOW-VALUES.
  3409                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3410                                               VALUE '3'.
  3411         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3412         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3413         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3414             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3415                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3416             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3417                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3418             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3419                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3420             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3421                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3422             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3423                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3424             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3425                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3426         16  CF-MORTG-BILLING-AREA.
  3427             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3428                                            PIC X.
  3429         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3430         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3431         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3432         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3433             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3434             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3435         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  61
* EL677.cbl
  3436         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3437             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3438             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3439         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3440         16  FILLER                         PIC X(8).
  3441         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3442         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3443         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3444         16  CF-ACH-COMPANY-ID.
  3445             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3446                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3447                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3448                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3449             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3450         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3451             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3452         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3453             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3454             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3455         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3456         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3457         16  FILLER                         PIC X(536).
  3458
  3459****************************************************************
  3460*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3461****************************************************************
  3462
  3463     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3464         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3465             20  CF-FEMALE-HEIGHT.
  3466                 24  CF-FEMALE-FT           PIC 99.
  3467                 24  CF-FEMALE-IN           PIC 99.
  3468             20  CF-FEMALE-MIN-WT           PIC 999.
  3469             20  CF-FEMALE-MAX-WT           PIC 999.
  3470         16  FILLER                         PIC X(428).
  3471
  3472     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3473         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3474             20  CF-MALE-HEIGHT.
  3475                 24  CF-MALE-FT             PIC 99.
  3476                 24  CF-MALE-IN             PIC 99.
  3477             20  CF-MALE-MIN-WT             PIC 999.
  3478             20  CF-MALE-MAX-WT             PIC 999.
  3479         16  FILLER                         PIC X(428).
  3480******************************************************************
  3481*             AUTOMATIC ACTIVITY RECORD                          *
  3482******************************************************************
  3483     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3484         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3485             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3486             20  CF-SYS-LETTER-ID           PIC X(04).
  3487             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3488             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3489             20  CF-SYS-RESET-SW            PIC X(01).
  3490             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3491             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3492
  3493         16  FILLER                         PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  62
* EL677.cbl
  3494
  3495         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3496             20  CF-USER-ACTIVE-SW          PIC X(01).
  3497             20  CF-USER-LETTER-ID          PIC X(04).
  3498             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3499             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3500             20  CF-USER-RESET-SW           PIC X(01).
  3501             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3502             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3503             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3504
  3505         16  FILLER                         PIC X(246).
  3506*                                COPY ERCCHEK.
  3507******************************************************************
  3508*                                                                *
  3509*                                                                *
  3510*                            ERCCHEK                             *
  3511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3512*                            VMOD=2.008                          *
  3513*                                                                *
  3514*   FILE DESCRIPTION = CHECK RECORDS                             *
  3515*                                                                *
  3516*   FILE TYPE = VSAM,KSDS                                        *
  3517*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3518*                                                                *
  3519*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3520*       ALTERNATE INDEX = NONE                                   *
  3521*                                                                *
  3522*   LOG = YES                                                    *
  3523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3524******************************************************************
  3525*                   C H A N G E   L O G
  3526*
  3527* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3528*-----------------------------------------------------------------
  3529*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3530* EFFECTIVE    NUMBER
  3531*-----------------------------------------------------------------
  3532* 021414    2003053000001  PEMA  changes for auto chk request
  3533******************************************************************
  3534 01  CHECK-RECORDS.
  3535     12  CH-RECORD-ID                      PIC XX.
  3536         88  VALID-CH-ID                      VALUE 'CH'.
  3537
  3538     12  CH-CONTROL-PRIMARY.
  3539         16  CH-COMPANY-CD                 PIC X.
  3540         16  CH-CARRIER                    PIC X.
  3541         16  CH-GROUPING                   PIC X(6).
  3542         16  CH-STATE                      PIC XX.
  3543         16  CH-ACCOUNT                    PIC X(10).
  3544         16  CH-CERT-EFF-DT                PIC XX.
  3545         16  CH-CERT-NO.
  3546             20  CH-CERT-PRIME             PIC X(10).
  3547             20  CH-CERT-SFX               PIC X.
  3548         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3549
  3550     12  CH-RECORDED-DT                    PIC XX.
  3551     12  CH-RECORDED-BY                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  63
* EL677.cbl
  3552     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3553
  3554     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3555     12  CH-CHECK-NO                       PIC X(7).
  3556     12  CH-REASON-FOR-CHECK               PIC X(25).
  3557     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3558     12  FILLER                            PIC X.
  3559
  3560     12  CH-PAYEE-INFO.
  3561         16  CH-PAYEE-NAME-1               PIC X(30).
  3562         16  CH-PAYEE-NAME-2               PIC X(30).
  3563         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3564         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3565         16  CH-PAYEE-CITY-ST.
  3566             20  CH-PAYEE-CITY             PIC X(28).
  3567             20  CH-PAYEE-STATE            PIC XX.
  3568         16  CH-PAYEE-ZIP-CODE.
  3569             20  CH-PAYEE-ZIP.
  3570                 24  CH-ZIP-PRI-1ST        PIC X.
  3571                     88  CH-CANADIAN-POST-CODE
  3572                                           VALUES 'A' THRU 'Z'.
  3573                 24  FILLER                PIC X(4).
  3574             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3575         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3576             20  CH-CAN-POSTAL-1           PIC XXX.
  3577             20  CH-CAN-POSTAL-2           PIC XXX.
  3578             20  FILLER                    PIC XXX.
  3579
  3580     12  CH-CHECK-STUB-TEXT.
  3581         16  CH-STUB-LINE-1                PIC X(30).
  3582         16  CH-TEXT-LINE-1                PIC X(50).
  3583         16  CH-TEXT-LINE-2                PIC X(50).
  3584         16  CH-TEXT-LINE-3                PIC X(40).
  3585     12  CH-RETURN-TO                      PIC X(30).
  3586
  3587     12  CH-COMPENSATION-CONTROL.
  3588         16  CH-COMP-CARRIER               PIC X.
  3589         16  CH-COMP-GROUPING              PIC X(6).
  3590         16  CH-COMP-FIN-RESP              PIC X(10).
  3591         16  CH-COMP-ACCOUNT               PIC X(10).
  3592
  3593     12  CH-CREDIT-SELECT-DT               PIC XX.
  3594     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3595     12  CH-PAYEE-CODE                     PIC X(6).
  3596
  3597     12  CH-VOID-DATA.
  3598         20  CH-VOID-DT                    PIC XX.
  3599         20  CH-VOID-BY                    PIC X(4).
  3600         20  CH-VOID-REASON                PIC X(25).
  3601
  3602     12  CH-APPROVAL-DATA.
  3603         20  CH-APPROVAL-DT                PIC XX.
  3604         20  CH-APPROVAL-STATUS            PIC X.
  3605             88  CH-IN-LIMBO                  VALUE ' '.
  3606             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3607             88  CH-APPROVED                  VALUE 'A'.
  3608             88  CH-DENIED                    VALUE 'D'.
  3609         20  CH-APPROVED-BY                PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  64
* EL677.cbl
  3610     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3611             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3612     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3613
  3614     12  ch-released-dt                    pic xx.
  3615     12  ch-check-cashed-dt                pic xx.
  3616     12  FILLER                            PIC X.
  3617*    12  CH-CHECK-REFERENCE                PIC X(12).
  3618     12  CH-CHECK-ORIGIN-SW                PIC X.
  3619             88  CH-REFUND-CHECK              VALUE 'R'.
  3620             88  CH-MAINT-CHECK               VALUE 'M'.
  3621
  3622     12  CH-CANC-DT                        PIC XX.
  3623     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3624     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3625
  3626     12  CH-INSURED-NAME                   PIC X(28).
  3627
  3628     12  ch-released-by                    pic x(4).
  3629     12  ch-csr                            pic x(4).
  3630     12  ch-deduct-commission              pic x.
  3631         88  ch-deduct-comm                  value 'Y'.
  3632         88  ch-do-not-deduct-comm           value 'N'.
  3633
  3634     12  FILLER                            PIC X(11).
  3635*    12  CH-LETTER-TABLE.
  3636*        16  CH-LETTERS OCCURS 3 TIMES
  3637*                       INDEXED BY CH-LT-NDX
  3638*                                          PIC X(04).
  3639
  3640     12  FILLER                            PIC X(07).
  3641
  3642*                                COPY ERCACCT.
  3643******************************************************************
  3644*                                                                *
  3645*                                                                *
  3646*                            ERCACCT                             *
  3647*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3648*                            VMOD=2.031                          *
  3649*                                                                *
  3650*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3651*                                                                *
  3652*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3653*   VSAM ACCOUNT MASTER FILES.                                   *
  3654*                                                                *
  3655*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3656*                                                                *
  3657*   FILE TYPE = VSAM,KSDS                                        *
  3658*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3659*                                                                *
  3660*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3661*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3662*                                                                *
  3663*   LOG = NO                                                     *
  3664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3665*                                                                *
  3666*                                                                *
  3667******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  65
* EL677.cbl
  3668*                   C H A N G E   L O G
  3669*
  3670* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3671*-----------------------------------------------------------------
  3672*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3673* EFFECTIVE    NUMBER
  3674*-----------------------------------------------------------------
  3675* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3676* 092705    2005050300006  PEMA  ADD SPP LEASES
  3677* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3678* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3679* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3680* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3681* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3682* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3683******************************************************************
  3684
  3685 01  ACCOUNT-MASTER.
  3686     12  AM-RECORD-ID                      PIC XX.
  3687         88  VALID-AM-ID                      VALUE 'AM'.
  3688
  3689     12  AM-CONTROL-PRIMARY.
  3690         16  AM-COMPANY-CD                 PIC X.
  3691         16  AM-MSTR-CNTRL.
  3692             20  AM-CONTROL-A.
  3693                 24  AM-CARRIER            PIC X.
  3694                 24  AM-GROUPING.
  3695                     28 AM-GROUPING-PREFIX PIC XXX.
  3696                     28 AM-GROUPING-PRIME  PIC XXX.
  3697                 24  AM-STATE              PIC XX.
  3698                 24  AM-ACCOUNT.
  3699                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3700                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3701             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3702                                           PIC X(19).
  3703             20  AM-CNTRL-B.
  3704                 24  AM-EXPIRATION-DT      PIC XX.
  3705                 24  FILLER                PIC X(4).
  3706             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3707                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3708
  3709     12  AM-CONTROL-BY-VAR-GRP.
  3710         16  AM-COMPANY-CD-A1              PIC X.
  3711         16  AM-VG-CARRIER                 PIC X.
  3712         16  AM-VG-GROUPING                PIC X(6).
  3713         16  AM-VG-STATE                   PIC XX.
  3714         16  AM-VG-ACCOUNT                 PIC X(10).
  3715         16  AM-VG-DATE.
  3716             20  AM-VG-EXPIRATION-DT       PIC XX.
  3717             20  FILLER                    PIC X(4).
  3718         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3719                                           PIC 9(11)      COMP-3.
  3720     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3721         16  FILLER                        PIC X(10).
  3722         16  AM-VG-KEY3.
  3723             20  AM-VG3-ACCOUNT            PIC X(10).
  3724             20  AM-VG3-EXP-DT             PIC XX.
  3725         16  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  66
* EL677.cbl
  3726     12  AM-MAINT-INFORMATION.
  3727         16  AM-LAST-MAINT-DT              PIC XX.
  3728         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3729         16  AM-LAST-MAINT-USER            PIC X(4).
  3730         16  FILLER                        PIC XX.
  3731
  3732     12  AM-EFFECTIVE-DT                   PIC XX.
  3733     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3734
  3735     12  AM-PREV-DATES  COMP-3.
  3736         16  AM-PREV-EXP-DT                PIC 9(11).
  3737         16  AM-PREV-EFF-DT                PIC 9(11).
  3738
  3739     12  AM-REPORT-CODE-1                  PIC X(10).
  3740     12  AM-REPORT-CODE-2                  PIC X(10).
  3741
  3742     12  AM-CITY-CODE                      PIC X(4).
  3743     12  AM-COUNTY-PARISH                  PIC X(6).
  3744
  3745     12  AM-NAME                           PIC X(30).
  3746     12  AM-PERSON                         PIC X(30).
  3747     12  AM-ADDRS                          PIC X(30).
  3748     12  AM-CITY.
  3749         16  AM-ADDR-CITY                  PIC X(28).
  3750         16  AM-ADDR-STATE                 PIC XX.
  3751     12  AM-ZIP.
  3752         16  AM-ZIP-PRIME.
  3753             20  AM-ZIP-PRI-1ST            PIC X.
  3754                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3755             20  FILLER                    PIC X(4).
  3756         16  AM-ZIP-PLUS4                  PIC X(4).
  3757     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3758         16  AM-CAN-POSTAL-1               PIC XXX.
  3759         16  AM-CAN-POSTAL-2               PIC XXX.
  3760         16  FILLER                        PIC XXX.
  3761     12  AM-TEL-NO.
  3762         16  AM-AREA-CODE                  PIC 999.
  3763         16  AM-TEL-PRE                    PIC 999.
  3764         16  AM-TEL-NBR                    PIC 9(4).
  3765     12  AM-TEL-LOC                        PIC X.
  3766         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3767         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3768
  3769     12  AM-COMM-STRUCTURE.
  3770         16  AM-DEFN-1.
  3771             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3772                 24  AM-AGT.
  3773                     28  AM-AGT-PREFIX     PIC X(4).
  3774                     28  AM-AGT-PRIME      PIC X(6).
  3775                 24  AM-COM-TYP            PIC X.
  3776                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3777                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3778                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3779                 24  AM-RECALC-LV-INDIC    PIC X.
  3780                 24  AM-RETRO-LV-INDIC     PIC X.
  3781                 24  AM-GL-CODES           PIC X.
  3782                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3783                 24  FILLER                PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  67
* EL677.cbl
  3784         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3785             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3786                 24  FILLER                PIC X(11).
  3787                 24  AM-L-COMA             PIC XXX.
  3788                 24  AM-J-COMA             PIC XXX.
  3789                 24  AM-A-COMA             PIC XXX.
  3790                 24  FILLER                PIC X(6).
  3791
  3792     12  AM-COMM-CHANGE-STATUS             PIC X.
  3793         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3794
  3795     12  AM-CSR-CODE                       PIC X(4).
  3796
  3797     12  AM-BILLING-STATUS                 PIC X.
  3798         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3799         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3800     12  AM-AUTO-REFUND-SW                 PIC X.
  3801         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3802         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3803     12  AM-GPCD                           PIC 99.
  3804     12  AM-IG                             PIC X.
  3805         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3806         88  AM-HAS-GROUP                     VALUE '2'.
  3807     12  AM-STATUS                         PIC X.
  3808         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3809         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3810         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3811         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3812         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3813         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3814         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3815         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3816         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3817         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3818     12  AM-REMIT-TO                       PIC 99.
  3819     12  AM-ID-NO                          PIC X(11).
  3820
  3821     12  AM-CAL-TABLE                      PIC XX.
  3822     12  AM-LF-DEVIATION                   PIC XXX.
  3823     12  AM-AH-DEVIATION                   PIC XXX.
  3824     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3825     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3826     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3827     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3828     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3829     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3830
  3831     12  AM-USER-FIELDS.
  3832         16  AM-FLD-1                      PIC XX.
  3833         16  AM-FLD-2                      PIC XX.
  3834         16  AM-FLD-3                      PIC XX.
  3835         16  AM-FLD-4                      PIC XX.
  3836         16  AM-FLD-5                      PIC XX.
  3837
  3838     12  AM-1ST-PROD-DATE.
  3839         16  AM-1ST-PROD-YR                PIC XX.
  3840         16  AM-1ST-PROD-MO                PIC XX.
  3841         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  68
* EL677.cbl
  3842     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3843     12  AM-CERTS-PURGED-DATE.
  3844         16  AM-PUR-YR                     PIC XX.
  3845         16  AM-PUR-MO                     PIC XX.
  3846         16  AM-PUR-DA                     PIC XX.
  3847     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3848     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3849     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3850     12  AM-INACTIVE-DATE.
  3851         16  AM-INA-MO                     PIC 99.
  3852         16  AM-INA-DA                     PIC 99.
  3853         16  AM-INA-YR                     PIC 99.
  3854     12  AM-AR-HI-CERT-DATE                PIC XX.
  3855
  3856     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3857     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3858
  3859     12  AM-OB-PAYMENT-MODE                PIC X.
  3860         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3861         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3862         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3863         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3864
  3865     12  AM-AH-ONLY-INDICATOR              PIC X.
  3866         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3867         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3868
  3869     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3870
  3871     12  AM-OVER-SHORT.
  3872         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3873         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3874
  3875     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3876     12  AM-DCC-CLP-STATE                  PIC XX.
  3877
  3878     12  AM-RECALC-COMM                    PIC X.
  3879     12  AM-RECALC-REIN                    PIC X.
  3880
  3881     12  AM-REI-TABLE                      PIC XXX.
  3882     12  AM-REI-ET-LF                      PIC X.
  3883     12  AM-REI-ET-AH                      PIC X.
  3884     12  AM-REI-PE-LF                      PIC X.
  3885     12  AM-REI-PE-AH                      PIC X.
  3886     12  AM-REI-PRT-ST                     PIC X.
  3887     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3888     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3889     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3890     12  AM-REI-GROUP-A                    PIC X(6).
  3891     12  AM-REI-MORT                       PIC X(4).
  3892     12  AM-REI-PRT-OW                     PIC X.
  3893     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3894     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3895     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3896     12  AM-REI-GROUP-B                    PIC X(6).
  3897
  3898     12  AM-TRUST-TYPE                     PIC X(2).
  3899
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  69
* EL677.cbl
  3900     12  AM-EMPLOYER-STMT-USED             PIC X.
  3901     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3902
  3903     12  AM-STD-AH-TYPE                    PIC XX.
  3904     12  AM-EARN-METHODS.
  3905         16  AM-EARN-METHOD-R              PIC X.
  3906             88 AM-REF-RL-R78                 VALUE 'R'.
  3907             88 AM-REF-RL-PR                  VALUE 'P'.
  3908             88 AM-REF-RL-MEAN                VALUE 'M'.
  3909             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3910         16  AM-EARN-METHOD-L              PIC X.
  3911             88 AM-REF-LL-R78                 VALUE 'R'.
  3912             88 AM-REF-LL-PR                  VALUE 'P'.
  3913             88 AM-REF-LL-MEAN                VALUE 'M'.
  3914             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3915         16  AM-EARN-METHOD-A              PIC X.
  3916             88 AM-REF-AH-R78                 VALUE 'R'.
  3917             88 AM-REF-AH-PR                  VALUE 'P'.
  3918             88 AM-REF-AH-MEAN                VALUE 'M'.
  3919             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3920             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3921             88 AM-REF-AH-NET                 VALUE 'N'.
  3922
  3923     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3924     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3925     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3926
  3927     12  AM-RET-Y-N                        PIC X.
  3928     12  AM-RET-P-E                        PIC X.
  3929     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3930     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3931     12  AM-RET-GRP                        PIC X(6).
  3932     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3933         16  AM-POOL-PRIME                 PIC XXX.
  3934         16  AM-POOL-SUB                   PIC XXX.
  3935     12  AM-RETRO-EARNINGS.
  3936         16  AM-RET-EARN-R                 PIC X.
  3937         16  AM-RET-EARN-L                 PIC X.
  3938         16  AM-RET-EARN-A                 PIC X.
  3939     12  AM-RET-ST-TAX-USE                 PIC X.
  3940         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3941         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3942     12  AM-RETRO-BEG-EARNINGS.
  3943         16  AM-RET-BEG-EARN-R             PIC X.
  3944         16  AM-RET-BEG-EARN-L             PIC X.
  3945         16  AM-RET-BEG-EARN-A             PIC X.
  3946     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3947     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3948
  3949     12  AM-USER-SELECT-OPTIONS.
  3950         16  AM-USER-SELECT-1              PIC X(10).
  3951         16  AM-USER-SELECT-2              PIC X(10).
  3952         16  AM-USER-SELECT-3              PIC X(10).
  3953         16  AM-USER-SELECT-4              PIC X(10).
  3954         16  AM-USER-SELECT-5              PIC X(10).
  3955
  3956     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3957
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  70
* EL677.cbl
  3958     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3959
  3960     12  AM-RPT045A-SWITCH                 PIC X.
  3961         88  RPT045A-OFF                   VALUE 'N'.
  3962
  3963     12  AM-INSURANCE-LIMITS.
  3964         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3965         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3966
  3967     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3968         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3969
  3970     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3971         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3972         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3973
  3974     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3975
  3976     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3977     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3978     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3979     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3980     12  AM-DCC-UEF-STATE                  PIC XX.
  3981     12  FILLER                            PIC XXX.
  3982     12  AM-REPORT-CODE-3                  PIC X(10).
  3983*    12  FILLER                            PIC X(22).
  3984
  3985     12  AM-RESERVE-DATE.
  3986         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3987         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3988         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3989
  3990     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3991     12  AM-NOTIFICATION-TYPES.
  3992         16  AM-NOTIF-OF-LETTERS           PIC X.
  3993         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3994         16  AM-NOTIF-OF-REPORTS           PIC X.
  3995         16  AM-NOTIF-OF-STATUS            PIC X.
  3996
  3997     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3998         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3999         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4000         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4001         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4002
  4003     12  AM-BENEFIT-CONTROLS.
  4004         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4005             20  AM-BENEFIT-CODE           PIC XX.
  4006             20  AM-BENEFIT-TYPE           PIC X.
  4007             20  AM-BENEFIT-REVISION       PIC XXX.
  4008             20  AM-BENEFIT-REM-TERM       PIC X.
  4009             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4010             20  FILLER                    PIC XX.
  4011         16  FILLER                        PIC X(80).
  4012
  4013     12  AM-TRANSFER-DATA.
  4014         16  AM-TRANSFERRED-FROM.
  4015             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  71
* EL677.cbl
  4016             20  AM-TRNFROM-GROUPING.
  4017                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4018                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4019             20  AM-TRNFROM-STATE          PIC XX.
  4020             20  AM-TRNFROM-ACCOUNT.
  4021                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4022                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4023             20  AM-TRNFROM-DTE            PIC XX.
  4024         16  AM-TRANSFERRED-TO.
  4025             20  AM-TRNTO-CARRIER          PIC X.
  4026             20  AM-TRNTO-GROUPING.
  4027                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4028                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4029             20  AM-TRNTO-STATE            PIC XX.
  4030             20  AM-TRNTO-ACCOUNT.
  4031                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4032                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4033             20  AM-TRNTO-DTE              PIC XX.
  4034         16  FILLER                        PIC X(10).
  4035
  4036     12  AM-SAVED-REMIT-TO                 PIC 99.
  4037
  4038     12  AM-COMM-STRUCTURE-SAVED.
  4039         16  AM-DEFN-1-SAVED.
  4040             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4041                 24  AM-AGT-SV             PIC X(10).
  4042                 24  AM-COM-TYP-SV         PIC X.
  4043                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4044                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4045                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4046                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4047                 24  FILLER                PIC X.
  4048                 24  AM-GL-CODES-SV        PIC X.
  4049                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4050                 24  FILLER                PIC X.
  4051         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4052             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4053                 24  FILLER                PIC X(11).
  4054                 24  AM-L-COMA-SV          PIC XXX.
  4055                 24  AM-J-COMA-SV          PIC XXX.
  4056                 24  AM-A-COMA-SV          PIC XXX.
  4057                 24  FILLER                PIC X(6).
  4058
  4059     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4060         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4061            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4062            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4063            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4064
  4065     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4066     12  FILLER                            PIC X(120).
  4067
  4068     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4069         16  AM-CONTROL-NAME               PIC X(30).
  4070         16  AM-EXECUTIVE-ONE.
  4071             20  AM-EXEC1-NAME             PIC X(15).
  4072             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4073                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  72
* EL677.cbl
  4074             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4075                                                          COMP-3.
  4076         16  AM-EXECUTIVE-TWO.
  4077             20  AM-EXEC2-NAME             PIC X(15).
  4078             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4079                                                          COMP-3.
  4080             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4081                                                          COMP-3.
  4082
  4083     12  AM-RETRO-ADDITIONAL-DATA.
  4084         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4085         16  AM-RETRO-PREM-P-E             PIC X.
  4086         16  AM-RETRO-CLMS-P-I             PIC X.
  4087         16  AM-RETRO-RET-BRACKET-LF.
  4088             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4089                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4090                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4091             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4092                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4093                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4094             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4095                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4096                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4097         16  AM-RETRO-RET-BRACKET-AH.
  4098             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4099                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4100                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4101                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4102             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4103                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4104                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4105             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4106                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4107                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4108
  4109     12  AM-COMMENTS.
  4110         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4111
  4112     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4113         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4114         16  AM-FLI-BILLING-CODE           PIC X.
  4115         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4116         16  AM-FLI-UNITED-IDENT           PIC X.
  4117         16  AM-FLI-INTEREST-LOST-DATA.
  4118             20  AM-FLI-BANK-NO            PIC X(5).
  4119             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4120             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4121             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4122         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4123             20  AM-FLI-AGT                PIC X(9).
  4124             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4125             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4126         16  FILLER                        PIC X(102).
  4127
  4128     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4129         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4130             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4131             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  73
* EL677.cbl
  4132             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4133             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4134             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4135         16  FILLER                          PIC X(10).
  4136******************************************************************
  4137*                                COPY ERCCOMP.
  4138******************************************************************
  4139*                                                                *
  4140*                                                                *
  4141*                            ERCCOMP                             *
  4142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4143*                            VMOD=2.019                          *
  4144*                                                                *
  4145*   ONLINE CREDIT SYSTEM                                         *
  4146*                                                                *
  4147*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4148*                                                                *
  4149*   FILE TYPE = VSAM,KSDS                                        *
  4150*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4151*                                                                *
  4152*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4153*       ALTERNATE PATH = NONE                                    *
  4154*                                                                *
  4155*   LOG = NO                                                     *
  4156*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4157*                                                                *
  4158******************************************************************
  4159*                   C H A N G E   L O G
  4160*
  4161* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4162*-----------------------------------------------------------------
  4163*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4164* EFFECTIVE    NUMBER
  4165*-----------------------------------------------------------------
  4166* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4167* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4168* 092205    2005050300006  PEMA  ADD LEASE FEE
  4169* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4170* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4171* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4172* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4173* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4174* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4175******************************************************************
  4176
  4177 01  COMPENSATION-MASTER.
  4178     12  CO-RECORD-ID                          PIC XX.
  4179         88  VALID-CO-ID                          VALUE 'CO'.
  4180
  4181     12  CO-CONTROL-PRIMARY.
  4182         16  CO-COMPANY-CD                     PIC X.
  4183         16  CO-CONTROL.
  4184             20  CO-CTL-1.
  4185                 24  CO-CARR-GROUP.
  4186                     28  CO-CARRIER            PIC X.
  4187                     28  CO-GROUPING.
  4188                         32  CO-GROUP-PREFIX   PIC XXX.
  4189                         32  CO-GROUP-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  74
* EL677.cbl
  4190                 24  CO-RESP-NO.
  4191                     28  CO-RESP-PREFIX        PIC X(4).
  4192                     28  CO-RESP-PRIME         PIC X(6).
  4193             20  CO-CTL-2.
  4194                 24  CO-ACCOUNT.
  4195                     28  CO-ACCT-PREFIX        PIC X(4).
  4196                     28  CO-ACCT-PRIME         PIC X(6).
  4197         16  CO-TYPE                           PIC X.
  4198             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4199             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4200             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4201
  4202     12  CO-MAINT-INFORMATION.
  4203         16  CO-LAST-MAINT-DT                  PIC XX.
  4204         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4205         16  CO-LAST-MAINT-USER                PIC X(4).
  4206     12  FILLER                                PIC XX.
  4207     12  CO-STMT-TYPE                          PIC XXX.
  4208     12  CO-COMP-TYPE                          PIC X.
  4209         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4210     12  CO-STMT-OWNER                         PIC X(4).
  4211     12  CO-BALANCE-CONTROL                    PIC X.
  4212         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4213         88  CO-NO-BALANCE                        VALUE 'N'.
  4214
  4215     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4216         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4217         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4218         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4219
  4220     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4221         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4222         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4223
  4224     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4225     12  CO-GA-DIRECT-DEP                      PIC X.
  4226     12  CO-FUTURE-SPACE                       PIC X.
  4227         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4228
  4229     12  CO-ACCT-NAME                          PIC X(30).
  4230     12  CO-MAIL-NAME                          PIC X(30).
  4231     12  CO-ADDR-1                             PIC X(30).
  4232     12  CO-ADDR-2                             PIC X(30).
  4233     12  CO-ADDR-3.
  4234         16  CO-ADDR-CITY                      PIC X(27).
  4235         16  CO-ADDR-STATE                     PIC XX.
  4236     12  CO-CSO-1099                           PIC X.
  4237     12  CO-ZIP.
  4238         16  CO-ZIP-PRIME.
  4239             20  CO-ZIP-PRI-1ST                PIC X.
  4240                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4241             20  FILLER                        PIC X(4).
  4242         16  CO-ZIP-PLUS4                      PIC X(4).
  4243     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4244         16  CO-CAN-POSTAL-1                   PIC XXX.
  4245         16  CO-CAN-POSTAL-2                   PIC XXX.
  4246         16  FILLER                            PIC XXX.
  4247     12  CO-SOC-SEC                            PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  75
* EL677.cbl
  4248     12  CO-TELEPHONE.
  4249         16  CO-AREA-CODE                      PIC XXX.
  4250         16  CO-PREFIX                         PIC XXX.
  4251         16  CO-PHONE                          PIC X(4).
  4252
  4253     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4254
  4255     12  CO-AR-BAL-LEVEL                       PIC X.
  4256         88  CO-AR-REF-LVL                        VALUE '1'.
  4257         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4258         88  CO-AR-BILL-LVL                       VALUE '2'.
  4259         88  CO-AR-AGT-LVL                        VALUE '3'.
  4260         88  CO-AR-FR-LVL                         VALUE '4'.
  4261
  4262     12  CO-AR-NORMAL-PRINT                    PIC X.
  4263         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4264         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4265
  4266     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4267
  4268     12  CO-AR-REPORTING                       PIC X.
  4269         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4270         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4271
  4272     12  CO-AR-PULL-CHECK                      PIC X.
  4273         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4274         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4275
  4276     12  CO-AR-BALANCE-PRINT                   PIC X.
  4277         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4278
  4279     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4280         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4281         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4282         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4283
  4284     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4285
  4286     12  CO-USER-CODE                          PIC X.
  4287     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4288
  4289******************************************************************
  4290*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4291*    THE LAST MONTH END RUN.
  4292******************************************************************
  4293
  4294     12  CO-LAST-ACTIVITY-DATE.
  4295         16  CO-ACT-YEAR                       PIC 99.
  4296         16  CO-ACT-MONTH                      PIC 99.
  4297         16  CO-ACT-DAY                        PIC 99.
  4298
  4299     12  CO-LAST-STMT-DT.
  4300         16  CO-LAST-STMT-YEAR                 PIC 99.
  4301         16  CO-LAST-STMT-MONTH                PIC 99.
  4302         16  CO-LAST-STMT-DAY                  PIC 99.
  4303
  4304     12  CO-MO-END-TOTALS.
  4305         16  CO-MONTHLY-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  76
* EL677.cbl
  4306             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4307             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4308             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4309             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4310             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4311
  4312         16  CO-AGING-TOTALS.
  4313             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4314             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4315             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4316             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4317
  4318         16  CO-YTD-TOTALS.
  4319             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4320             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4321
  4322         16  CO-OVER-UNDER-TOTALS.
  4323             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4324             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4325
  4326     12  CO-MISCELLANEOUS-TOTALS.
  4327         16  CO-FICA-TOTALS.
  4328             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4329             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4330
  4331         16  CO-CLAIM-TOTALS.
  4332             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4333             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4334
  4335******************************************************************
  4336*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4337*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4338******************************************************************
  4339
  4340     12  CO-CURRENT-TOTALS.
  4341         16  CO-CURRENT-LAST-STMT-DT.
  4342             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4343             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4344             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4345
  4346         16  CO-CURRENT-MONTHLY-TOTALS.
  4347             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4348             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4349             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4350             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4351             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4352
  4353         16  CO-CURRENT-AGING-TOTALS.
  4354             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4355             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4356             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4357             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4358
  4359         16  CO-CURRENT-YTD-TOTALS.
  4360             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4361             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4362
  4363     12  CO-PAID-COMM-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  77
* EL677.cbl
  4364         16  CO-YTD-PAID-COMMS.
  4365             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4366             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4367
  4368     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4369         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4370         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4371
  4372     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4373         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4374         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4375         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4376         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4377         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4378         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4379         88  CO-FINAL-LETTER                  VALUE 'F'.
  4380         88  CO-RECONCILING                   VALUE 'R'.
  4381         88  CO-PHONE-CALL                    VALUE 'P'.
  4382         88  CO-LEGAL                         VALUE 'L'.
  4383         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4384         88  CO-WRITE-OFF                     VALUE 'W'.
  4385         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4386
  4387     12  CO-CSR-CODE                       PIC X(4).
  4388
  4389     12  CO-GA-STATUS-INFO.
  4390         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4391         16  CO-GA-TERMINATION-DT          PIC XX.
  4392         16  CO-GA-STATUS-CODE             PIC X.
  4393             88  CO-GA-ACTIVE                 VALUE 'A'.
  4394             88  CO-GA-INACTIVE               VALUE 'I'.
  4395             88  CO-GA-PENDING                VALUE 'P'.
  4396         16  CO-GA-COMMENTS.
  4397             20  CO-GA-COMMENT-1           PIC X(40).
  4398             20  CO-GA-COMMENT-2           PIC X(40).
  4399             20  CO-GA-COMMENT-3           PIC X(40).
  4400             20  CO-GA-COMMENT-4           PIC X(40).
  4401
  4402     12  CO-RPTCD2                         PIC X(10).
  4403     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4404         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4405         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4406
  4407     12  CO-TYPE-AGENT                     PIC X(01).
  4408         88  CO-CORPORATION                   VALUE 'C'.
  4409         88  CO-PARTNERSHIP                   VALUE 'P'.
  4410         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4411         88  CO-TRUST                         VALUE 'T'.
  4412         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4413
  4414     12  CO-FAXNO.
  4415         16  CO-FAX-AREA-CODE                  PIC XXX.
  4416         16  CO-FAX-PREFIX                     PIC XXX.
  4417         16  CO-FAX-PHONE                      PIC X(4).
  4418
  4419     12  CO-BANK-INFORMATION.
  4420         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4421         16  CO-BANK-TRANSIT-NON REDEFINES
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  78
* EL677.cbl
  4422             CO-BANK-TRANSIT-NO                PIC 9(8).
  4423
  4424         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4425     12  CO-MISC-DEDUCT-INFO REDEFINES
  4426                  CO-BANK-INFORMATION.
  4427         16  CO-MD-GL-ACCT                     PIC X(10).
  4428         16  CO-MD-DIV                         PIC XX.
  4429         16  CO-MD-CENTER                      PIC X(4).
  4430         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4431         16  CO-CREATE-AP-CHECK                PIC X.
  4432         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4433         16  FILLER                            PIC XXX.
  4434     12  CO-ACH-STATUS                         PIC X.
  4435         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4436         88  CO-ACH-PENDING                        VALUE 'P'.
  4437
  4438     12  CO-BILL-SW                            PIC X.
  4439     12  CO-CONTROL-NAME                       PIC X(30).
  4440     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4441     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4442     12  CO-CLP-STATE                          PIC XX.
  4443     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4444     12  CO-SPP-REFUND-EDIT                    PIC X.
  4445
  4446******************************************************************
  4447*                                COPY ELCCERT.
  4448******************************************************************
  4449*                                                                *
  4450*                            ELCCERT.                            *
  4451*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4452*                            VMOD=2.013                          *
  4453*                                                                *
  4454*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4455*                                                                *
  4456*   FILE TYPE = VSAM,KSDS                                        *
  4457*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4458*                                                                *
  4459*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4460*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4461*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4462*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4463*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4464*                                                                *
  4465*   LOG = YES                                                    *
  4466*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4467******************************************************************
  4468*                   C H A N G E   L O G
  4469*
  4470* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4471*-----------------------------------------------------------------
  4472*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4473* EFFECTIVE    NUMBER
  4474*-----------------------------------------------------------------
  4475* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4476* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4477* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4478* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4479* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  79
* EL677.cbl
  4480* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4481* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4482* 032612  CR2011110200001  PEMA  AHL CHANGES
  4483* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4484* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4485* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4486******************************************************************
  4487
  4488 01  CERTIFICATE-MASTER.
  4489     12  CM-RECORD-ID                      PIC XX.
  4490         88  VALID-CM-ID                      VALUE 'CM'.
  4491
  4492     12  CM-CONTROL-PRIMARY.
  4493         16  CM-COMPANY-CD                 PIC X.
  4494         16  CM-CARRIER                    PIC X.
  4495         16  CM-GROUPING.
  4496             20  CM-GROUPING-PREFIX        PIC X(3).
  4497             20  CM-GROUPING-PRIME         PIC X(3).
  4498         16  CM-STATE                      PIC XX.
  4499         16  CM-ACCOUNT.
  4500             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4501             20  CM-ACCOUNT-PRIME          PIC X(6).
  4502         16  CM-CERT-EFF-DT                PIC XX.
  4503         16  CM-CERT-NO.
  4504             20  CM-CERT-PRIME             PIC X(10).
  4505             20  CM-CERT-SFX               PIC X.
  4506
  4507     12  CM-CONTROL-BY-NAME.
  4508         16  CM-COMPANY-CD-A1              PIC X.
  4509         16  CM-INSURED-LAST-NAME          PIC X(15).
  4510         16  CM-INSURED-INITIALS.
  4511             20  CM-INSURED-INITIAL1       PIC X.
  4512             20  CM-INSURED-INITIAL2       PIC X.
  4513
  4514     12  CM-CONTROL-BY-SSN.
  4515         16  CM-COMPANY-CD-A2              PIC X.
  4516         16  CM-SOC-SEC-NO.
  4517             20  CM-SSN-STATE              PIC XX.
  4518             20  CM-SSN-ACCOUNT            PIC X(6).
  4519             20  CM-SSN-LN3.
  4520                 25  CM-INSURED-INITIALS-A2.
  4521                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4522                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4523                 25 CM-PART-LAST-NAME-A2         PIC X.
  4524
  4525     12  CM-CONTROL-BY-CERT-NO.
  4526         16  CM-COMPANY-CD-A4              PIC X.
  4527         16  CM-CERT-NO-A4                 PIC X(11).
  4528
  4529     12  CM-CONTROL-BY-MEMB.
  4530         16  CM-COMPANY-CD-A5              PIC X.
  4531         16  CM-MEMBER-NO.
  4532             20  CM-MEMB-STATE             PIC XX.
  4533             20  CM-MEMB-ACCOUNT           PIC X(6).
  4534             20  CM-MEMB-LN4.
  4535                 25  CM-INSURED-INITIALS-A5.
  4536                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4537                     30 CM-INSURED-INITIAL2-A5   PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  80
* EL677.cbl
  4538                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4539
  4540     12  CM-INSURED-PROFILE-DATA.
  4541         16  CM-INSURED-FIRST-NAME.
  4542             20  CM-INSURED-1ST-INIT       PIC X.
  4543             20  FILLER                    PIC X(9).
  4544         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4545         16  CM-INSURED-SEX                PIC X.
  4546             88  CM-SEX-MALE                  VALUE 'M'.
  4547             88  CM-SEX-FEMAL                 VALUE 'F'.
  4548         16  CM-INSURED-JOINT-AGE          PIC 99.
  4549         16  CM-JOINT-INSURED-NAME.
  4550             20  CM-JT-LAST-NAME           PIC X(15).
  4551             20  CM-JT-FIRST-NAME.
  4552                 24  CM-JT-1ST-INIT        PIC X.
  4553                 24  FILLER                PIC X(9).
  4554             20  CM-JT-INITIAL             PIC X.
  4555
  4556     12  CM-LIFE-DATA.
  4557         16  CM-LF-BENEFIT-CD              PIC XX.
  4558         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4559         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4560         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4561         16  CM-LF-DEV-CODE                PIC XXX.
  4562         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4563         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4564         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4565         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4566         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4567         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4568         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4569         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4570         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4571         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4572         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4573         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4574         16  cm-temp-epiq                  pic xx.
  4575             88  EPIQ-CLASS                  value 'EQ'.
  4576*        16  FILLER                        PIC XX.
  4577
  4578     12  CM-AH-DATA.
  4579         16  CM-AH-BENEFIT-CD              PIC XX.
  4580         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4581         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4582         16  CM-AH-DEV-CODE                PIC XXX.
  4583         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4584         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4585         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4586         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4587         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4588         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4589         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4590         16  CM-AH-PAID-THRU-DT            PIC XX.
  4591             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4592         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4593         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4594         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4595         16  FILLER                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  81
* EL677.cbl
  4596
  4597     12  CM-LOAN-INFORMATION.
  4598         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4599         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4600                                           PIC S9(5)V99  COMP-3.
  4601         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4602         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4603         16  CM-PAY-FREQUENCY              PIC S99.
  4604         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4605         16  CM-RATE-CLASS                 PIC XX.
  4606         16  CM-BENEFICIARY                PIC X(25).
  4607         16  CM-POLICY-FORM-NO             PIC X(12).
  4608         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4609         16  CM-LAST-ADD-ON-DT             PIC XX.
  4610         16  CM-DEDUCTIBLE-AMOUNTS.
  4611             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4612             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4613         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4614             20  CM-RESIDENT-STATE         PIC XX.
  4615             20  CM-RATE-CODE              PIC X(4).
  4616             20  FILLER                    PIC XX.
  4617         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4618             20  CM-LOAN-OFFICER           PIC X(5).
  4619             20  FILLER                    PIC XXX.
  4620         16  CM-CSR-CODE                   PIC XXX.
  4621         16  CM-UNDERWRITING-CODE          PIC X.
  4622             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4623         16  CM-POST-CARD-IND              PIC X.
  4624         16  CM-REF-INTERFACE-SW           PIC X.
  4625         16  CM-PREMIUM-TYPE               PIC X.
  4626             88  CM-SING-PRM                  VALUE '1'.
  4627             88  CM-O-B-COVERAGE              VALUE '2'.
  4628             88  CM-OPEN-END                  VALUE '3'.
  4629         16  CM-IND-GRP-TYPE               PIC X.
  4630             88  CM-INDIVIDUAL                VALUE 'I'.
  4631             88  CM-GROUP                     VALUE 'G'.
  4632         16  CM-SKIP-CODE                  PIC X.
  4633             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4634             88  SKIP-JULY                    VALUE '1'.
  4635             88  SKIP-AUGUST                  VALUE '2'.
  4636             88  SKIP-SEPTEMBER               VALUE '3'.
  4637             88  SKIP-JULY-AUG                VALUE '4'.
  4638             88  SKIP-AUG-SEPT                VALUE '5'.
  4639             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4640             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4641             88  SKIP-JUNE                    VALUE '8'.
  4642             88  SKIP-JUNE-JULY               VALUE '9'.
  4643             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4644             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4645         16  CM-PAYMENT-MODE               PIC X.
  4646             88  PAY-MONTHLY                  VALUE SPACE.
  4647             88  PAY-WEEKLY                   VALUE '1'.
  4648             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4649             88  PAY-BI-WEEKLY                VALUE '3'.
  4650             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4651         16  CM-LOAN-NUMBER                PIC X(8).
  4652         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4653         16  CM-OLD-LOF                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  82
* EL677.cbl
  4654*        16  CM-LOAN-OFFICER               PIC XXX.
  4655         16  CM-REIN-TABLE                 PIC XXX.
  4656         16  CM-SPECIAL-REIN-CODE          PIC X.
  4657         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4658         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4659         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4660
  4661     12  CM-STATUS-DATA.
  4662         16  CM-ENTRY-STATUS               PIC X.
  4663         16  CM-ENTRY-DT                   PIC XX.
  4664
  4665         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4666         16  CM-LF-CANCEL-DT               PIC XX.
  4667         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4668
  4669         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4670         16  CM-LF-DEATH-DT                PIC XX.
  4671         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4672
  4673         16  CM-LF-CURRENT-STATUS          PIC X.
  4674             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4675                                                'M' '4' '5' '9'.
  4676             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4677             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4678             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4679             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4680             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4681             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4682             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4683             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4684             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4685             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4686             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4687             88  CM-LF-DECLINED               VALUE 'D'.
  4688             88  CM-LF-VOIDED                 VALUE 'V'.
  4689
  4690         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4691         16  CM-AH-CANCEL-DT               PIC XX.
  4692         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4693
  4694         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4695         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4696         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4697
  4698         16  CM-AH-CURRENT-STATUS          PIC X.
  4699             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4700                                                'M' '4' '5' '9'.
  4701             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4702             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4703             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4704             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4705             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4706             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4707             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4708             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4709             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4710             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4711             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  83
* EL677.cbl
  4712             88  CM-AH-DECLINED               VALUE 'D'.
  4713             88  CM-AH-VOIDED                 VALUE 'V'.
  4714
  4715         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4716             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4717             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4718             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4719         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4720
  4721         16  CM-ENTRY-BATCH                PIC X(6).
  4722         16  CM-LF-EXIT-BATCH              PIC X(6).
  4723         16  CM-AH-EXIT-BATCH              PIC X(6).
  4724         16  CM-LAST-MONTH-END             PIC XX.
  4725
  4726     12  CM-NOTE-SW                        PIC X.
  4727         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4728         88  CERT-NOTES-PRESENT               VALUE '1'.
  4729         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4730         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4731         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4732         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4733         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4734         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4735     12  CM-COMP-EXCP-SW                   PIC X.
  4736         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4737         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4738     12  CM-INSURED-ADDRESS-SW             PIC X.
  4739         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4740         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4741
  4742*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4743     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4744     12  FILLER                            PIC X.
  4745
  4746*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4747     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4748     12  FILLER                            PIC X.
  4749*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4750     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4751
  4752     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4753         88  CERT-ADDED-BATCH                 VALUE ' '.
  4754         88  CERT-ADDED-ONLINE                VALUE '1'.
  4755         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4756         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4757         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4758     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4759         88  CERT-AS-LOADED                   VALUE ' '.
  4760         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4761         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4762         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4763         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4764         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4765         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4766         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4767
  4768     12  CM-ACCOUNT-COMM-PCTS.
  4769         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  84
* EL677.cbl
  4770         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4771
  4772     12  CM-USER-FIELD                     PIC X.
  4773     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4774     12  CM-CLP-STATE                      PIC XX.
  4775     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4776     12  CM-USER-RESERVED                  PIC XXX.
  4777     12  FILLER REDEFINES CM-USER-RESERVED.
  4778         16  CM-AH-CLASS-CD                PIC XX.
  4779         16  F                             PIC X.
  4780******************************************************************
  4781*                                COPY ERCPNDB.
  4782******************************************************************
  4783*                                                                *
  4784*                                                                *
  4785*                            ERCPNDB.                            *
  4786*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4787*                            VMOD=2.025                          *
  4788*                                                                *
  4789*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4790*                                                                *
  4791******************************************************************
  4792*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4793*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4794******************************************************************
  4795*                                                                *
  4796*                                                                *
  4797*   FILE TYPE = VSAM,KSDS                                        *
  4798*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4799*                                                                *
  4800*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4801*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4802*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4803*                                                 RKP=13,LEN=36  *
  4804*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4805*                                      AND CHG-SEQ.)             *
  4806*                                                RKP=49,LEN=11   *
  4807*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4808*                                      AND CHG-SEQ.)             *
  4809*                                                RKP=60,LEN=15   *
  4810*                                                                *
  4811*   LOG = NO                                                     *
  4812*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4813******************************************************************
  4814******************************************************************
  4815*                   C H A N G E   L O G
  4816*
  4817* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4818*-----------------------------------------------------------------
  4819*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4820* EFFECTIVE    NUMBER
  4821*-----------------------------------------------------------------
  4822* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4823* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4824* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4825* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4826* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4827* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  85
* EL677.cbl
  4828* 032306                   PEMA  ADD BOW LOAN NUMBER
  4829* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4830* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4831* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4832* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4833* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4834* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4835* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4836* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4837* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4838* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4839* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4840* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4841* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  4842******************************************************************
  4843
  4844 01  PENDING-BUSINESS.
  4845     12  PB-RECORD-ID                     PIC XX.
  4846         88  VALID-PB-ID                        VALUE 'PB'.
  4847
  4848     12  PB-CONTROL-PRIMARY.
  4849         16  PB-COMPANY-CD                PIC X.
  4850         16  PB-ENTRY-BATCH               PIC X(6).
  4851         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4852         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4853
  4854     12  PB-CONTROL-BY-ACCOUNT.
  4855         16  PB-COMPANY-CD-A1             PIC X.
  4856         16  PB-CARRIER                   PIC X.
  4857         16  PB-GROUPING.
  4858             20  PB-GROUPING-PREFIX       PIC XXX.
  4859             20  PB-GROUPING-PRIME        PIC XXX.
  4860         16  PB-STATE                     PIC XX.
  4861         16  PB-ACCOUNT.
  4862             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4863             20  PB-ACCOUNT-PRIME         PIC X(6).
  4864         16  PB-CERT-EFF-DT               PIC XX.
  4865         16  PB-CERT-NO.
  4866             20  PB-CERT-PRIME            PIC X(10).
  4867             20  PB-CERT-SFX              PIC X.
  4868         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4869
  4870         16  PB-RECORD-TYPE               PIC X.
  4871             88  PB-MAILING-DATA                VALUE '0'.
  4872             88  PB-ISSUE                       VALUE '1'.
  4873             88  PB-CANCELLATION                VALUE '2'.
  4874             88  PB-BATCH-TRAILER               VALUE '9'.
  4875
  4876     12  PB-CONTROL-BY-ORIG-BATCH.
  4877         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4878         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4879         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4880         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4881
  4882     12  PB-CONTROL-BY-CSR.
  4883         16  PB-CSR-COMPANY-CD            PIC X.
  4884         16  PB-CSR-ID                    PIC X(4).
  4885         16  PB-CSR-ENTRY-BATCH           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  86
* EL677.cbl
  4886         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4887         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4888******************************************************************
  4889*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4890******************************************************************
  4891
  4892     12  PB-LAST-MAINT-DT                 PIC XX.
  4893     12  PB-LAST-MAINT-BY                 PIC X(4).
  4894     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4895
  4896     12  PB-RECORD-BODY                   PIC X(375).
  4897
  4898     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4899         16  PB-CERT-ORIGIN               PIC X.
  4900             88  CLASIC-CREATED-CERT         VALUE '1'.
  4901         16  PB-I-NAME.
  4902             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4903             20  PB-I-INSURED-FIRST-NAME.
  4904                 24  PB-I-INSURED-1ST-INIT PIC X.
  4905                 24  FILLER                PIC X(9).
  4906             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4907         16  PB-I-AGE                     PIC S99   COMP-3.
  4908         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4909         16  PB-I-BIRTHDAY                PIC XX.
  4910         16  PB-I-INSURED-SEX             PIC X.
  4911             88  PB-SEX-MALE     VALUE 'M'.
  4912             88  PB-SEX-FEMALE   VALUE 'F'.
  4913
  4914         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4915         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4916         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4917         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4918         16  PB-I-SKIP-CODE               PIC X.
  4919             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4920             88  PB-SKIP-JULY              VALUE '1'.
  4921             88  PB-SKIP-AUGUST            VALUE '2'.
  4922             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4923             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4924             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4925             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4926             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4927             88  PB-SKIP-JUNE              VALUE '8'.
  4928             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4929             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4930             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4931         16  PB-I-TERM-TYPE               PIC X.
  4932             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4933             88  PB-PAID-WEEKLY            VALUE 'W'.
  4934             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4935             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4936             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4937         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4938         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4939         16  PB-I-DATA-ENTRY-SW           PIC X.
  4940             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4941             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4942             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4943             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  87
* EL677.cbl
  4944         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4945         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4946*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4947         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4948         16  PB-I-LETTER-REQD             PIC X.
  4949
  4950         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4951             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4952             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4953                                                   '90' THRU '99'.
  4954         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4955                                          PIC XX.
  4956         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4957         16  PB-I-AMOUNT-FINANCED REDEFINES
  4958                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4959         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4960         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4961                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4962         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4963         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4964         16  PB-I-CLP-AMOUNT REDEFINES
  4965                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4966         16  PB-I-LF-CALC-FLAG            PIC X.
  4967             88 PB-COMP-LF-PREM               VALUE '?'.
  4968         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4969         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4970         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4971         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4972         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4973         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4974         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4975         16  PB-I-LF-ABBR                 PIC XXX.
  4976         16  PB-I-LF-INPUT-CD             PIC XX.
  4977
  4978         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4979             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4980             88  PB-INVALID-AH               VALUE '  ' '00'
  4981                                                   '90' THRU '99'.
  4982         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4983         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4984         16  PB-I-AH-CALC-FLAG            PIC X.
  4985             88 PB-COMP-AH-PREM                  VALUE '?'.
  4986         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4987         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4988         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4989         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4990         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4991         16  PB-I-AH-ABBR                 PIC XXX.
  4992         16  PB-I-AH-INPUT-CD             PIC XXX.
  4993
  4994         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4995         16  PB-I-REIN-TABLE              PIC XXX.
  4996         16  PB-I-BUSINESS-TYPE           PIC 99.
  4997         16  PB-I-INDV-GRP-CD             PIC X.
  4998         16  PB-I-MORT-CODE.
  4999             20  PB-I-TABLE               PIC X.
  5000             20  PB-I-INTEREST            PIC XX.
  5001             20  PB-I-MORT-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  88
* EL677.cbl
  5002         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5003         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5004         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5005         16  PB-I-INDV-GRP-OVRD           PIC X.
  5006         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5007         16  PB-I-SIG-SW                  PIC X.
  5008             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5009         16  PB-I-RATE-CLASS              PIC XX.
  5010         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5011         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5012         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5013         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5014         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5015         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5016         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5017         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5018         16  PB-I-OB-FLAG                 PIC X.
  5019             88  PB-I-OB                      VALUE 'B'.
  5020             88  PB-I-SUMMARY                 VALUE 'Z'.
  5021         16  PB-I-ENTRY-STATUS            PIC X.
  5022             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5023                                              'M' '5' '9' '2'.
  5024             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5025             88  PB-I-POLICY-PENDING          VALUE '2'.
  5026             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5027             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5028             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5029             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5030             88  PB-I-REIN-ONLY               VALUE '9'.
  5031             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5032             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5033             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5034             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5035         16  PB-I-INT-CODE                PIC X.
  5036             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5037             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5038         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5039         16  PB-I-SOC-SEC-NO              PIC X(11).
  5040         16  PB-I-MEMBER-NO               PIC X(12).
  5041         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5042*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5043         16  PB-I-OLD-LOF                 PIC XXX.
  5044         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5045         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5046         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5047         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5048         16  PB-I-LIFE-INDICATOR          PIC X.
  5049             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5050         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5051         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5052                                          PIC S9(5)V99    COMP-3.
  5053         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5054             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5055             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5056         16  PB-I-1ST-PMT-DT              PIC XX.
  5057         16  PB-I-JOINT-INSURED.
  5058             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5059             20 PB-I-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  89
* EL677.cbl
  5060                24  PB-I-JOINT-FIRST-INIT PIC X.
  5061                24  FILLER                PIC X(9).
  5062             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5063*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5064         16  PB-I-BENEFICIARY-NAME.
  5065             20  PB-I-BANK-NUMBER         PIC X(10).
  5066             20  FILLER                   PIC X(15).
  5067         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5068         16  PB-I-REFERENCE               PIC X(12).
  5069         16  FILLER REDEFINES PB-I-REFERENCE.
  5070             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5071             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5072             20  PB-I-CLP-STATE           PIC XX.
  5073         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5074             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5075             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5076             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5077         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5078         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5079         16  PB-I-RESIDENT-STATE          PIC XX.
  5080         16  PB-I-RATE-CODE               PIC X(4).
  5081         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5082         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5083         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5084         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5085         16  PB-I-BANK-NOCHRGB            PIC 99.
  5086         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5087         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5088
  5089     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5090         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5091             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5092         16  PB-C-CANCEL-ORIGIN           PIC X.
  5093             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5094         16  PB-C-LF-CANCEL-DT            PIC XX.
  5095         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5096         16  PB-C-LF-CALC-REQ             PIC X.
  5097             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5098         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5099         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5100         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5101             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5102         16  PB-C-AH-CANCEL-DT            PIC XX.
  5103         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5104         16  PB-C-AH-CALC-REQ             PIC X.
  5105             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5106         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5107         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5108         16  PB-C-LAST-NAME               PIC X(15).
  5109         16  PB-C-REFUND-SW               PIC X.
  5110             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5111             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5112         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5113         16  PB-C-PAYEE-CODE              PIC X(6).
  5114         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5115         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5116         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5117         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  90
* EL677.cbl
  5118         16  PB-C-REFERENCE               PIC X(12).
  5119         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5120         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5121         16  PB-C-POST-CARD-IND           PIC X.
  5122         16  PB-C-CANCEL-REASON           PIC X.
  5123         16  PB-C-REF-INTERFACE-SW        PIC X.
  5124         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5125         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5126         16  FILLER                       PIC X(01).
  5127*        16  FILLER                       PIC X(18).
  5128         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5129*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5130         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  5131         16  PB-CANCELED-CERT-DATA.
  5132             20  PB-CI-INSURED-NAME.
  5133                 24  PB-CI-LAST-NAME      PIC X(15).
  5134                 24  PB-CI-INITIALS       PIC XX.
  5135             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5136             20  PB-CI-INSURED-SEX        PIC X.
  5137             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5138             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5139             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5140             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5141             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5142             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5143             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5144             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5145             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5146             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5147             20  PB-CI-RATE-CLASS         PIC XX.
  5148             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5149             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5150             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5151             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5152             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5153             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5154             20  PB-CI-LF-ABBR            PIC X(3).
  5155             20  PB-CI-AH-ABBR            PIC X(3).
  5156             20  PB-CI-OB-FLAG            PIC X.
  5157                 88  PB-CI-OB                VALUE 'B'.
  5158             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5159                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5160                                           'M' '4' '5' '9' '2'.
  5161                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5162                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5163                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5164                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5165                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5166                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5167                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5168                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5169                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5170                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5171                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5172                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5173                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5174             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5175                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  91
* EL677.cbl
  5176                                           'M' '4' '5' '9' '2'.
  5177                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5178                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5179                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5180                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5181                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5182                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5183                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5184                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5185                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5186                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5187                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5188                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5189                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5190             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5191             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5192             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5193             20  PB-CI-MEMBER-NO          PIC X(12).
  5194             20  PB-CI-INT-CODE           PIC X.
  5195                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5196                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5197             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5198             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5199             20  PB-CI-COMP-EXCP-SW       PIC X.
  5200                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5201                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5202             20  PB-CI-ENTRY-STATUS       PIC X.
  5203             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5204             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5205             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5206             20  PB-CI-DEATH-DT           PIC XX.
  5207             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5208             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5209             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5210             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5211             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5212             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5213             20  PB-CI-ENTRY-DT              PIC XX.
  5214             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5215             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5216             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5217             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5218             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5219             20  PB-CI-OLD-LOF               PIC XXX.
  5220*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5221             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5222             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5223             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5224             20  PB-CI-INDV-GRP-CD           PIC X.
  5225             20  PB-CI-BENEFICIARY-NAME.
  5226                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5227                 24  FILLER                  PIC X(15).
  5228             20  PB-CI-NOTE-SW               PIC X.
  5229             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5230             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5231             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5232             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5233             20  PB-CI-LOAN-OFFICER          PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  92
* EL677.cbl
  5234             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5235             20  PB-CI-FIRST-NAME            PIC X(10).
  5236             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5237
  5238         16  FILLER                       PIC X(13).
  5239*032306  16  FILLER                       PIC X(27).
  5240*        16  FILLER                       PIC X(46).
  5241
  5242     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5243         16  FILLER                       PIC X(10).
  5244         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5245         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5246         16  PB-M-INSURED-MID-INIT        PIC X.
  5247         16  PB-M-INSURED-AGE             PIC 99.
  5248         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5249         16  PB-M-INSURED-SEX             PIC X.
  5250         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5251         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5252         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5253         16  PB-M-INSURED-CITY-STATE.
  5254             20  PB-M-INSURED-CITY        PIC X(28).
  5255             20  PB-M-INSURED-STATE       PIC XX.
  5256         16  PB-M-INSURED-ZIP-CODE.
  5257             20  PB-M-INSURED-ZIP-PRIME.
  5258                 24  PB-M-INSURED-ZIP-1   PIC X.
  5259                     88  PB-M-CANADIAN-POST-CODE
  5260                                             VALUE 'A' THRU 'Z'.
  5261                 24  FILLER               PIC X(4).
  5262             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5263         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5264                                        PB-M-INSURED-ZIP-CODE.
  5265             20  PM-M-INS-CAN-POST1       PIC XXX.
  5266             20  PM-M-INS-CAN-POST2       PIC XXX.
  5267             20  FILLER                   PIC XXX.
  5268         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5269         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5270         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5271         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5272         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5273         16  PB-M-CRED-BENE-CITYST.
  5274             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5275             20  PB-M-CRED-BENE-STATE     PIC XX.
  5276         16  FILLER                       PIC X(92).
  5277
  5278     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5279         16  FILLER                       PIC X(10).
  5280         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5281         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5282         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5283         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5284         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5285         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5286         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5287         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5288         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5289         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5290         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5291         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  93
* EL677.cbl
  5292         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5293         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5294         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5295         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5296         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5297         16  PB-ACCOUNT-NAME              PIC X(30).
  5298         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5299         16  PB-REFERENCE                 PIC X(12).
  5300         16  PB-B-RECEIVED-DT             PIC XX.
  5301         16  FILLER                       PIC X(234).
  5302
  5303     12  PB-RECORD-STATUS.
  5304         16  PB-CREDIT-SELECT-DT          PIC XX.
  5305         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5306         16  PB-BILLED-DT                 PIC XX.
  5307         16  PB-BILLING-STATUS            PIC X.
  5308             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5309             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5310             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5311         16  PB-RECORD-BILL               PIC X.
  5312             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5313             88  PB-RECORD-RETURNED           VALUE 'R'.
  5314             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5315             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5316             88  PB-OVERRIDE-AH               VALUE 'A'.
  5317             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5318         16  PB-BATCH-ENTRY               PIC X.
  5319             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5320             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5321             88  PB-REISSUED-CERT             VALUE 'E'.
  5322             88  PB-CASH-CERT                 VALUE 'C'.
  5323             88  PB-MONTHLY-CERT              VALUE 'M'.
  5324             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5325             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5326             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5327         16  PB-FORCE-CODE                PIC X.
  5328             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5329             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5330             88  PB-CANCEL-FORCE              VALUE '8'.
  5331             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5332             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5333             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5334             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5335             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5336             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5337             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  5338             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5339         16  PB-FATAL-FLAG                PIC X.
  5340             88  PB-FATAL-ERRORS              VALUE 'X'.
  5341         16  PB-FORCE-ER-CD               PIC X.
  5342             88  PB-FORCE-ERRORS              VALUE 'F'.
  5343             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5344         16  PB-WARN-ER-CD                PIC X.
  5345             88  PB-WARNING-ERRORS            VALUE 'W'.
  5346         16  FILLER                       PIC X.
  5347         16  PB-OUT-BAL-CD                PIC X.
  5348             88  PB-OUT-OF-BAL                VALUE 'O'.
  5349         16  PB-LIFE-OVERRIDE-L1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  94
* EL677.cbl
  5350         16  PB-AH-OVERRIDE-L1            PIC X.
  5351         16  PB-INPUT-DT                  PIC XX.
  5352         16  PB-INPUT-BY                  PIC X(4).
  5353         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5354         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5355         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5356         16  PB-LF-EARNING-METHOD         PIC X.
  5357         16  PB-AH-EARNING-METHOD         PIC X.
  5358         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5359         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5360         16  PB-REIN-CD                   PIC XXX.
  5361         16  PB-LF-REFUND-TYPE            PIC X.
  5362         16  PB-AH-REFUND-TYPE            PIC X.
  5363         16  PB-ACCT-EFF-DT               PIC XX.
  5364         16  PB-ACCT-EXP-DT               PIC XX.
  5365         16  PB-COMPANY-ID                PIC X(3).
  5366         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5367         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5368         16  PB-SV-CARRIER                PIC X.
  5369         16  PB-SV-GROUPING               PIC X(6).
  5370         16  PB-SV-STATE                  PIC XX.
  5371         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5372         16  PB-GA-BILLING-INFO.
  5373             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5374                                          PIC XX.
  5375         16  PB-SV-REMIT-TO  REDEFINES
  5376             PB-GA-BILLING-INFO           PIC X(10).
  5377         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5378         16  PB-I-LOAN-OFFICER            PIC X(5).
  5379         16  PB-I-VIN                     PIC X(17).
  5380
  5381         16  FILLER                       PIC X(04).
  5382         16  IMNET-BYPASS-SW              PIC X.
  5383
  5384******************************************************************
  5385*                COMMON EDIT ERRORS                              *
  5386******************************************************************
  5387
  5388     12  PB-COMMON-ERRORS.
  5389         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5390                                           PIC S9(4)     COMP.
  5391
  5392******************************************************************
  5393*                                COPY ERCPNDM.
  5394******************************************************************
  5395*                                                                *
  5396*                                                                *
  5397*                            ERCPNDM                             *
  5398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5399*                            VMOD=2.003                          *
  5400*                                                                *
  5401*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5402*                                                                *
  5403*   FILE TYPE = VSAM,KSDS                                        *
  5404*   RECORD SIZE = 374   RECFORM = FIX                            *
  5405*                                                                *
  5406*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5407*   ALTERNATE PATH    = NOT USED                                 *
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  95
* EL677.cbl
  5408*                                                                *
  5409*   LOG = YES                                                    *
  5410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5411******************************************************************
  5412*                   C H A N G E   L O G
  5413*
  5414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5415*-----------------------------------------------------------------
  5416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5417* EFFECTIVE    NUMBER
  5418*-----------------------------------------------------------------
  5419* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5420* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5421* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5422* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  5423******************************************************************
  5424
  5425 01  PENDING-MAILING-DATA.
  5426     12  PM-RECORD-ID                      PIC XX.
  5427         88  VALID-MA-ID                       VALUE 'PM'.
  5428
  5429     12  PM-CONTROL-PRIMARY.
  5430         16  PM-COMPANY-CD                 PIC X.
  5431         16  PM-ENTRY-BATCH                PIC X(6).
  5432         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5433         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5434
  5435     12  FILLER                            PIC X(14).
  5436
  5437     12  PM-ACCESS-CONTROL.
  5438         16  PM-SOURCE-SYSTEM              PIC XX.
  5439             88  PM-FROM-CREDIT                VALUE 'CR'.
  5440             88  PM-FROM-VSI                   VALUE 'VS'.
  5441             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5442             88  PM-FROM-OTHER                 VALUE 'OT'.
  5443         16  PM-RECORD-ADD-DT              PIC XX.
  5444         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5445         16  PM-LAST-MAINT-DT              PIC XX.
  5446         16  PM-LAST-MAINT-BY              PIC XXXX.
  5447         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5448
  5449     12  PM-PROFILE-INFO.
  5450         16  PM-QUALIFY-CODE-1             PIC XX.
  5451         16  PM-QUALIFY-CODE-2             PIC XX.
  5452         16  PM-QUALIFY-CODE-3             PIC XX.
  5453         16  PM-QUALIFY-CODE-4             PIC XX.
  5454         16  PM-QUALIFY-CODE-5             PIC XX.
  5455
  5456         16  PM-INSURED-LAST-NAME          PIC X(15).
  5457         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5458         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5459         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5460         16  PM-INSURED-BIRTH-DT           PIC XX.
  5461         16  PM-INSURED-SEX                PIC X.
  5462             88  PM-SEX-MALE                   VALUE 'M'.
  5463             88  PM-SEX-FEMALE                 VALUE 'F'.
  5464         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5465
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  96
* EL677.cbl
  5466         16  PM-ADDRESS-CORRECTED          PIC X.
  5467         16  PM-JOINT-BIRTH-DT             PIC XX.
  5468*        16  FILLER                        PIC X(12).
  5469
  5470         16  PM-ADDRESS-LINE-1             PIC X(30).
  5471         16  PM-ADDRESS-LINE-2             PIC X(30).
  5472         16  PM-CITY-STATE.
  5473             20  PM-CITY                   PIC X(28).
  5474             20  PM-STATE                  PIC XX.
  5475         16  PM-ZIP.
  5476             20  PM-ZIP-CODE.
  5477                 24  PM-ZIP-1              PIC X.
  5478                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5479                 24  FILLER                PIC X(4).
  5480             20  PM-ZIP-PLUS4              PIC X(4).
  5481         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5482             20  PM-CAN-POST1              PIC XXX.
  5483             20  PM-CAN-POST2              PIC XXX.
  5484             20  FILLER                    PIC XXX.
  5485
  5486         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5487         16  pm-city-st-zip-verified       pic x.
  5488         16  FILLER                        PIC XX.
  5489
  5490     12  PM-CRED-BENE-INFO.
  5491         16  PM-CRED-BENE-NAME             PIC X(25).
  5492         16  PM-CRED-BENE-ADDR             PIC X(30).
  5493         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5494         16  PM-CRED-BENE-CTYST.
  5495             20  PM-CRED-BENE-CITY         PIC X(28).
  5496             20  PM-CRED-BENE-STATE        PIC XX.
  5497         16  PM-CRED-BENE-ZIP.
  5498             20  PM-CB-ZIP-CODE.
  5499                 24  PM-CB-ZIP-1           PIC X.
  5500                     88  PM-CB-CANADIAN-POST-CODE
  5501                                  VALUE 'A' THRU 'Z'.
  5502                 24  FILLER                PIC X(4).
  5503             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5504         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5505             20  PM-CB-CAN-POST1           PIC XXX.
  5506             20  PM-CB-CAN-POST2           PIC XXX.
  5507             20  FILLER                    PIC XXX.
  5508     12  PM-POST-CARD-MAIL-DATA.
  5509         16  PM-MAIL-DATA OCCURS 7.
  5510             20  PM-MAIL-TYPE              PIC X.
  5511                 88  PM-12MO-MAILING           VALUE '1'.
  5512                 88  PM-EXP-MAILING            VALUE '2'.
  5513             20  PM-MAIL-STATUS            PIC X.
  5514                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5515                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5516                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5517             20  PM-MAIL-DATE              PIC XX.
  5518     12  FILLER                            PIC XX.
  5519     12  FILLER                            PIC X(12).
  5520*    12  FILLER                            PIC X(30).
  5521
  5522******************************************************************
  5523*                                COPY ERCMAIL.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  97
* EL677.cbl
  5524******************************************************************
  5525*                                                                *
  5526*                                                                *
  5527*                            ERCMAIL                             *
  5528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5529*                            VMOD=2.003                          *
  5530*                                                                *
  5531*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5532*                                                                *
  5533*   FILE TYPE = VSAM,KSDS                                        *
  5534*   RECORD SIZE = 374   RECFORM = FIX                            *
  5535*                                                                *
  5536*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5537*   ALTERNATE PATH    = NOT USED                                 *
  5538*                                                                *
  5539*   LOG = YES                                                    *
  5540*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5541******************************************************************
  5542*                   C H A N G E   L O G
  5543*
  5544* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5545*-----------------------------------------------------------------
  5546*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5547* EFFECTIVE    NUMBER
  5548*-----------------------------------------------------------------
  5549* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5550* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5551* 111108                   PEMA  ADD CRED BENE ADDR2
  5552******************************************************************
  5553
  5554 01  MAILING-DATA.
  5555     12  MA-RECORD-ID                      PIC XX.
  5556         88  VALID-MA-ID                       VALUE 'MA'.
  5557
  5558     12  MA-CONTROL-PRIMARY.
  5559         16  MA-COMPANY-CD                 PIC X.
  5560         16  MA-CARRIER                    PIC X.
  5561         16  MA-GROUPING.
  5562             20  MA-GROUPING-PREFIX        PIC XXX.
  5563             20  MA-GROUPING-PRIME         PIC XXX.
  5564         16  MA-STATE                      PIC XX.
  5565         16  MA-ACCOUNT.
  5566             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5567             20  MA-ACCOUNT-PRIME          PIC X(6).
  5568         16  MA-CERT-EFF-DT                PIC XX.
  5569         16  MA-CERT-NO.
  5570             20  MA-CERT-PRIME             PIC X(10).
  5571             20  MA-CERT-SFX               PIC X.
  5572
  5573     12  FILLER                            PIC XX.
  5574
  5575     12  MA-ACCESS-CONTROL.
  5576         16  MA-SOURCE-SYSTEM              PIC XX.
  5577             88  MA-FROM-CREDIT                VALUE 'CR'.
  5578             88  MA-FROM-VSI                   VALUE 'VS'.
  5579             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5580             88  MA-FROM-OTHER                 VALUE 'OT'.
  5581         16  MA-RECORD-ADD-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  98
* EL677.cbl
  5582         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5583         16  MA-LAST-MAINT-DT              PIC XX.
  5584         16  MA-LAST-MAINT-BY              PIC XXXX.
  5585         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5586
  5587     12  MA-PROFILE-INFO.
  5588         16  MA-QUALIFY-CODE-1             PIC XX.
  5589         16  MA-QUALIFY-CODE-2             PIC XX.
  5590         16  MA-QUALIFY-CODE-3             PIC XX.
  5591         16  MA-QUALIFY-CODE-4             PIC XX.
  5592         16  MA-QUALIFY-CODE-5             PIC XX.
  5593
  5594         16  MA-INSURED-LAST-NAME          PIC X(15).
  5595         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5596         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5597         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5598         16  MA-INSURED-BIRTH-DT           PIC XX.
  5599         16  MA-INSURED-SEX                PIC X.
  5600             88  MA-SEX-MALE                   VALUE 'M'.
  5601             88  MA-SEX-FEMALE                 VALUE 'F'.
  5602         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5603
  5604         16  MA-ADDRESS-CORRECTED          PIC X.
  5605         16  MA-JOINT-BIRTH-DT             PIC XX.
  5606*        16  FILLER                        PIC X(12).
  5607
  5608         16  MA-ADDRESS-LINE-1             PIC X(30).
  5609         16  MA-ADDRESS-LINE-2             PIC X(30).
  5610         16  MA-CITY-STATE.
  5611             20  MA-CITY                   PIC X(28).
  5612             20  MA-ADDR-STATE             PIC XX.
  5613         16  MA-ZIP.
  5614             20  MA-ZIP-CODE.
  5615                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5616                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5617                 24  FILLER                PIC X(4).
  5618             20  MA-ZIP-PLUS4              PIC X(4).
  5619         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5620             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5621             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5622             20  FILLER                    PIC X(3).
  5623
  5624         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5625
  5626         16  FILLER                        PIC XXX.
  5627*        16  FILLER                        PIC X(10).
  5628
  5629     12  MA-CRED-BENE-INFO.
  5630         16  MA-CRED-BENE-NAME                 PIC X(25).
  5631         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5632         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5633         16  MA-CRED-BENE-CTYST.
  5634             20  MA-CRED-BENE-CITY             PIC X(28).
  5635             20  MA-CRED-BENE-STATE            PIC XX.
  5636         16  MA-CRED-BENE-ZIP.
  5637             20  MA-CB-ZIP-CODE.
  5638                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5639                     88  MA-CB-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  99
* EL677.cbl
  5640                                           VALUE 'A' THRU 'Z'.
  5641                 24  FILLER                    PIC X(4).
  5642             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5643         16  MA-CB-CANADIAN-POSTAL-CODE
  5644                            REDEFINES MA-CRED-BENE-ZIP.
  5645             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5646             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5647             20  FILLER                        PIC X(3).
  5648     12  MA-POST-CARD-MAIL-DATA.
  5649         16  MA-MAIL-DATA OCCURS 7.
  5650             20  MA-MAIL-TYPE              PIC X.
  5651                 88  MA-12MO-MAILING           VALUE '1'.
  5652                 88  MA-EXP-MAILING            VALUE '2'.
  5653             20  MA-MAIL-STATUS            PIC X.
  5654                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5655                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5656                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5657             20  MA-MAIL-DATE              PIC XX.
  5658     12  FILLER                            PIC XX.
  5659     12  FILLER                            PIC XX.
  5660*    12  FILLER                            PIC X(30).
  5661******************************************************************
  5662*                                COPY ERCPYAJ.
  5663******************************************************************
  5664*                                                                *
  5665*                            ERCPYAJ                             *
  5666*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5667*                            VMOD=2.015                          *
  5668*                                                                *
  5669*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5670*                                                                *
  5671*                                                                *
  5672*   FILE TYPE = VSAM,KSDS                                        *
  5673*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5674*                                                                *
  5675*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5676*       ALTERNATE PATHS = NONE                                   *
  5677*                                                                *
  5678*   LOG = YES                                                    *
  5679*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5680******************************************************************
  5681******************************************************************
  5682*                   C H A N G E   L O G
  5683*
  5684* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5685*-----------------------------------------------------------------
  5686*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5687* EFFECTIVE    NUMBER
  5688*-----------------------------------------------------------------
  5689* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5690* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5691******************************************************************
  5692
  5693 01  PENDING-PAY-ADJ.
  5694     12  PY-RECORD-ID                     PIC XX.
  5695         88  VALID-PY-ID                        VALUE 'PY'.
  5696
  5697     12  PY-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 100
* EL677.cbl
  5698         16  PY-COMPANY-CD                PIC X.
  5699         16  PY-CARRIER                   PIC X.
  5700         16  PY-GROUPING                  PIC X(6).
  5701         16  PY-FIN-RESP                  PIC X(10).
  5702         16  PY-ACCOUNT                   PIC X(10).
  5703         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5704                                          PIC X(10).
  5705         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5706         16  PY-RECORD-TYPE               PIC X.
  5707             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5708             88  PY-DEPOSIT                   VALUE 'D'.
  5709             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5710             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5711             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5712             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5713             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5714             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5715             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5716             88  PY-FICA-ENTRY                VALUE 'F'.
  5717             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5718             88  PY-POLICY-FEE                VALUE 'W'.
  5719             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5720
  5721     12  PY-PYMT-TYPE                     PIC X.
  5722             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5723             88  PY-REINS-PYMT                VALUE 'R'.
  5724             88  PY-EXP-PYMT                  VALUE 'E'.
  5725
  5726     12  PY-BIL-INV                       PIC X(6).
  5727     12  PY-REF-NO                        PIC X(12).
  5728
  5729     12  PY-LAST-MAINT-DT                 PIC XX.
  5730     12  PY-LAST-MAINT-BY                 PIC X(4).
  5731     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5732
  5733     12  PY-PYADJ-RECORD.
  5734         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5735         16  PY-ENTRY-COMMENT             PIC X(30).
  5736         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5737             20  PY-GL-ACCOUNT            PIC X(10).
  5738             20  PY-GL-STATE              PIC X(02).
  5739             20  PY-GL-CANC-SW            PIC X(01).
  5740                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5741                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5742             20  PY-GL-COMMENT            PIC X(10).
  5743             20  FILLER      REDEFINES PY-GL-COMMENT.
  5744                 24  PY-GL-CHECK-NO       PIC 9(06).
  5745                 24  FILLER               PIC X(04).
  5746             20  FILLER                   PIC X(07).
  5747         16  PY-SAVE-ACCOUNT              PIC X(10).
  5748         16  PY-SAVE-TYPE                 PIC X(01).
  5749
  5750         16  PY-LETTERS.
  5751             20  PY-LETTER OCCURS 3 TIMES
  5752                           INDEXED BY PY-LET-NDX
  5753                                          PIC X(04).
  5754
  5755         16  PY-ERCOMP-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 101
* EL677.cbl
  5756             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5757             88  PY-GA-TYPE                   VALUE 'G'.
  5758             88  PY-BANK-TYPE                 VALUE 'B'.
  5759         16  FILLER                       PIC X(05).
  5760
  5761     12  PY-RECORD-STATUS.
  5762         16  PY-CREDIT-SELECT-DT          PIC XX.
  5763         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5764         16  PY-BILLED-DATE               PIC XX.
  5765         16  PY-REPORTED-DT               PIC XX.
  5766         16  PY-PMT-APPLIED               PIC X.
  5767             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5768             88  PY-GA-PMT                    VALUE 'G'.
  5769             88  PY-OVWRITE-PMT               VALUE 'O'.
  5770             88  PY-NON-AR-PMT                VALUE 'N'.
  5771         16  FILLER                       PIC X(5).
  5772         16  PY-INPUT-DT                  PIC XX.
  5773         16  PY-CHECK-NUMBER              PIC X(6).
  5774         16  PY-VOID-SW                   PIC X.
  5775             88  PY-CHECK-VOIDED              VALUE 'V'.
  5776         16  PY-CHECK-ORIGIN-SW           PIC X.
  5777             88  PY-BILLING-CHECK             VALUE 'B'.
  5778             88  PY-REFUND-CHECK              VALUE 'R'.
  5779             88  PY-GA-CHECK                  VALUE 'G'.
  5780             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5781             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5782         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5783         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5784         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5785         16  PY-BILL-FLAG                 PIC X.
  5786             88  PY-BILLED                    VALUE 'B'.
  5787         16  PY-AR-FLAG                   PIC X.
  5788             88  PY-AR-CYCLE                  VALUE 'C'.
  5789             88  PY-AR-MONTH-END              VALUE 'M'.
  5790         16  PY-AR-DATE                   PIC XX.
  5791
  5792     12  PY-GL-CODES.
  5793         16  PY-GL-DB                     PIC X(14).
  5794         16  PY-GL-CR                     PIC X(14).
  5795         16  PY-GL-FLAG                   PIC X.
  5796         16  PY-GL-DATE                   PIC XX.
  5797
  5798     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5799     12  FILLER                           PIC X(3).
  5800******************************************************************
  5801 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5802                          CHECK-RECORDS ACCOUNT-MASTER
  5803                          COMPENSATION-MASTER
  5804                          CERTIFICATE-MASTER PENDING-BUSINESS
  5805                          PENDING-MAILING-DATA MAILING-DATA
  5806                          PENDING-PAY-ADJ.
  5807 0000-DFHEXIT SECTION.
  5808     MOVE '9#                    $   ' TO DFHEIV0.
  5809     MOVE 'EL677' TO DFHEIV1.
  5810     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5811
  5812     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5813     MOVE '5'                    TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 102
* EL677.cbl
  5814     PERFORM 8500-DATE-CONVERT.
  5815     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5816     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5817     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5818
  5819     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5820
  5821     IF PI-AMOUNT NOT NUMERIC
  5822         MOVE ZEROS              TO  PI-AMOUNT.
  5823
  5824     IF EIBCALEN = 0
  5825         GO TO 8800-UNAUTHORIZED-ACCESS.
  5826     set P to address of KIXSYS
  5827     CALL "getenv" using by value P returning var-ptr
  5828     if var-ptr = null then
  5829        display ' kixsys not set '
  5830     else
  5831        set address of var to var-ptr
  5832        move 0 to env-var-len
  5833        inspect var tallying env-var-len
  5834          for characters before X'00'
  5835        unstring var (1:env-var-len) delimited by '/'
  5836           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5837              WS-KIX-SYS
  5838        end-unstring
  5839     end-if
  5840     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5841     MOVE 2                      TO  EMI-SWITCH2.
  5842     MOVE EIBTRMID               TO  QID-TERM.
  5843
  5844     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5845         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5846
  5847     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5848         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5849             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5850             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5851             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5852             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5853             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5854             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5855             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5856             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5857         ELSE
  5858             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5859             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5860             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5861             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5862             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5863             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5864             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5865             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5866
  5867     MOVE LOW-VALUES             TO  EL677AI.
  5868
  5869     if eibtrnid not = trans-id
  5870        evaluate true
  5871           when pi-return-to-program = 'EL6315'
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 103
* EL677.cbl
  5872              move pi-company-cd to pi-chek-comp-cd
  5873              move pi-carrier    to pi-chek-carrier
  5874              move pi-grouping   to pi-chek-grouping
  5875              move pi-state      to pi-chek-state
  5876              move pi-account    to pi-chek-account
  5877              move pi-cert-eff-dt to pi-chek-eff-dt
  5878              move pi-cert-prime to pi-chek-cert-no
  5879              move pi-cert-sfx   to pi-chek-suf-no
  5880              move +1            to pi-chek-sequence
  5881              move 'C'           to pi-check-type *> Correction
  5882              move 'S'           to mainti
  5883              move +1            to maintl
  5884              move al-uanon      to mainta
  5885              move dfhenter      to eibaid
  5886              go to 5000-browse-file
  5887           when pi-return-to-program = 'EL6318'
  5888              move 'C'           to pi-check-type *> Correction
  5889           when other
  5890              move 'R'           to pi-check-type *> Refund
  5891        end-evaluate
  5892     end-if
  5893     IF EIBTRNID NOT = TRANS-ID
  5894         move pi-processor-id    to pi-return-to
  5895         move +1                 to dedcynl
  5896         move 'N'                to dedcyno
  5897         move al-uanon           to dedcyna
  5898         move dfhpf7             to eibaid
  5899         move ' '                to pi-void-reissue-pass
  5900         move zeros              to pi-void-reissue-amt
  5901         perform 6800-browse-previous-chek-recs *> totals up prev
  5902                                 thru 6800-exit
  5903         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5904                                                *> pending record
  5905         IF PI-TO-EL677-FROM-EL1273
  5906             MOVE 'S'            TO MAINTI
  5907             MOVE 1              TO MAINTL
  5908             MOVE AL-UABON       TO MAINTA
  5909             MOVE DFHENTER       TO EIBAID
  5910             GO TO 5000-BROWSE-FILE.
  5911
  5912     IF EIBTRNID NOT = TRANS-ID
  5913        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5914           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5915           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5916           IF PI-PROCESS-BENEFICIARY
  5917              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5918           ELSE
  5919              GO TO 6300-BUILD-CERT-SCREEN
  5920           end-if
  5921        ELSE
  5922           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5923              GO TO 8100-SEND-INITIAL-MAP
  5924           ELSE
  5925              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5926              IF PI-PROCESS-BENEFICIARY
  5927                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5928              ELSE
  5929                 GO TO 6300-BUILD-CERT-SCREEN
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 104
* EL677.cbl
  5930              end-if
  5931           end-if
  5932        end-if
  5933      end-if
  5934
  5935     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5936                                     PI-CHEK-COMP-CD.
  5937
  5938
  5939* EXEC CICS HANDLE CONDITION
  5940*        PGMIDERR  (9600-PGMID-ERROR)
  5941*        ERROR     (9990-ABEND)
  5942*    END-EXEC.
  5943*    MOVE '"$L.                  ! " #00005841' TO DFHEIV0
  5944     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5945     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5946     MOVE X'2220233030303035383431' TO DFHEIV0(25:11)
  5947     CALL 'kxdfhei1' USING DFHEIV0
  5948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5949
  5950
  5951     IF EIBAID = DFHCLEAR
  5952         GO TO 9400-CLEAR.
  5953
  5954     IF PI-PROCESSOR-ID = 'LGXX'
  5955         GO TO 0200-RECEIVE.
  5956
  5957
  5958* EXEC CICS READQ TS
  5959*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5960*        INTO   (SECURITY-CONTROL)
  5961*        LENGTH (SC-COMM-LENGTH)
  5962*        ITEM   (SC-ITEM)
  5963*    END-EXEC.
  5964*    MOVE '*$II   L              ''   #00005852' TO DFHEIV0
  5965     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5966     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5967     MOVE X'2020233030303035383532' TO DFHEIV0(25:11)
  5968     CALL 'kxdfhei1' USING DFHEIV0,
  5969           PI-SECURITY-TEMP-STORE-ID,
  5970           SECURITY-CONTROL,
  5971           SC-COMM-LENGTH,
  5972           SC-ITEM,
  5973           DFHEIV99,
  5974           DFHEIV99
  5975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5976
  5977
  5978     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5979     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5980
  5981     IF NOT DISPLAY-CAP
  5982         MOVE 'READ'          TO SM-READ
  5983         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5984         MOVE ER-0070         TO  EMI-ERROR
  5985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5986         GO TO 8100-SEND-INITIAL-MAP.
  5987
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 105
* EL677.cbl
  5988 0200-RECEIVE.
  5989     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5990         MOVE ER-1159            TO  EMI-ERROR
  5991         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5992         MOVE -1                 TO  PFENTERL
  5993         GO TO 8200-SEND-DATAONLY.
  5994
  5995
  5996* EXEC CICS HANDLE CONDITION
  5997*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5998*    END-EXEC.
  5999*    MOVE '"$?                   ! # #00005876' TO DFHEIV0
  6000     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6002     MOVE X'2320233030303035383736' TO DFHEIV0(25:11)
  6003     CALL 'kxdfhei1' USING DFHEIV0
  6004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6005
  6006
  6007
  6008* EXEC CICS RECEIVE
  6009*        MAP      (EL677A)
  6010*        MAPSET   (MAPSET-NAME)
  6011*        INTO     (EL677AI)
  6012*    END-EXEC.
  6013     MOVE LENGTH OF
  6014      EL677AI
  6015       TO DFHEIV11
  6016*    MOVE '8"T I  L              ''   #00005880' TO DFHEIV0
  6017     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6018     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6019     MOVE X'2020233030303035383830' TO DFHEIV0(25:11)
  6020     CALL 'kxdfhei1' USING DFHEIV0,
  6021           EL677A,
  6022           EL677AI,
  6023           DFHEIV11,
  6024           MAPSET-NAME,
  6025           DFHEIV99,
  6026           DFHEIV99
  6027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6028
  6029
  6030     IF PFENTERL GREATER ZERO
  6031         IF EIBAID NOT = DFHENTER
  6032             MOVE ER-0004        TO  EMI-ERROR
  6033             MOVE AL-UNBOF       TO  PFENTERA
  6034             MOVE -1             TO  PFENTERL
  6035             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6036             GO TO 8200-SEND-DATAONLY
  6037         ELSE
  6038             IF (PFENTERI NUMERIC) AND
  6039                (PFENTERI GREATER 0 AND LESS 25)
  6040                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6041             ELSE
  6042                 MOVE ER-0029    TO  EMI-ERROR
  6043                 MOVE AL-UNBOF   TO  PFENTERA
  6044                 MOVE -1         TO  PFENTERL
  6045                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 106
* EL677.cbl
  6046                 GO TO 8200-SEND-DATAONLY.
  6047 0300-CHECK-PFKEYS.
  6048     IF EIBAID = DFHPF23
  6049         GO TO 8810-PF23.
  6050
  6051     IF EIBAID = DFHPF24
  6052         GO TO 9200-RETURN-MAIN-MENU.
  6053
  6054     IF EIBAID = DFHPF12
  6055         GO TO 9500-PF12.
  6056
  6057     IF EIBAID = DFHPF1 OR DFHPF2
  6058         GO TO 5000-BROWSE-FILE.
  6059
  6060     if PI-TO-EL677-FROM-EL1273
  6061        and (eibaid not = dfhenter)
  6062        and (pi-void-reissue-pass not = '1' and '2')
  6063        go to 0320-input-error
  6064     end-if
  6065     IF EIBAID = DFHPF3
  6066         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6067         MOVE 'PF3'              TO  PI-PFKEY
  6068         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6069         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6070             GO TO 9400-CLEAR
  6071         ELSE
  6072             MOVE XCTL-1273      TO  PGM-NAME
  6073             GO TO 9300-XCTL.
  6074
  6075     IF EIBAID = DFHPF4
  6076         IF NOT FORCE-CAP
  6077             MOVE ER-0433        TO EMI-ERROR
  6078             MOVE -1             TO PFENTERL
  6079             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6080             GO TO 8200-SEND-DATAONLY.
  6081
  6082     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6083                             DFHPF5 OR DFHPF6 or dfhpf7
  6084         GO TO 1000-EDIT-DATA.
  6085
  6086*    IF EIBAID = DFHPF7
  6087*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6088*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6089*        MOVE XCTL-114           TO  PGM-NAME
  6090*        GO TO 9300-XCTL.
  6091
  6092 0320-INPUT-ERROR.
  6093     MOVE ER-0029                TO  EMI-ERROR.
  6094     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6095     MOVE -1                     TO  PFENTERL.
  6096     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 107
* EL677.cbl
  6098
  6099 1000-EDIT-DATA.
  6100     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D' or 'R' or 'X'
  6101         MOVE AL-UANON           TO MAINTA
  6102         IF MAINTI = 'C' OR 'V' OR 'R'
  6103             IF PI-PREV-MAINT = 'S'  OR  'C' or 'R'
  6104                 NEXT SENTENCE
  6105             ELSE
  6106                 MOVE ER-2056    TO  EMI-ERROR
  6107                 MOVE -1         TO  MAINTL
  6108                 MOVE AL-UABON   TO  MAINTA
  6109                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6110                 GO TO 1100-EDIT-COMPLETE
  6111         ELSE
  6112             NEXT SENTENCE
  6113     ELSE
  6114         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6115            NEXT SENTENCE
  6116         ELSE
  6117            MOVE ER-0023            TO  EMI-ERROR
  6118            MOVE -1                 TO  MAINTL
  6119            MOVE AL-UABON           TO  MAINTA
  6120            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6121
  6122     IF MODIFY-CAP
  6123         NEXT SENTENCE
  6124       ELSE
  6125         IF MAINTI NOT = 'S'
  6126            MOVE 'UPDATE'       TO SM-READ
  6127            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6128            MOVE ER-0070        TO EMI-ERROR
  6129            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6130            GO TO 8100-SEND-INITIAL-MAP.
  6131
  6132     if (pi-return-to-program = 'EL1273')
  6133        and (MAINTI not = 'S' and 'V' and 'R' and 'D' and 'X')
  6134        move 'S'                 to mainti
  6135        move +1                  to maintl
  6136        move al-uanon            to mainta
  6137     end-if
  6138     IF CARRIERI NOT = LOW-VALUES
  6139         MOVE AL-UANON           TO  CARRIERA
  6140         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6141         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6142                                     PI-CARRIER
  6143     ELSE
  6144         MOVE -1                 TO  CARRIERL
  6145         MOVE AL-UABON           TO  CARRIERA
  6146         MOVE ER-0194            TO  EMI-ERROR
  6147         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6148
  6149     IF GROUPI NOT = LOW-VALUES
  6150         MOVE AL-UANON           TO  GROUPA
  6151         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6152                                     PI-GROUPING
  6153     ELSE
  6154         MOVE -1                 TO  GROUPL
  6155         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 108
* EL677.cbl
  6156         MOVE ER-0195            TO  EMI-ERROR
  6157         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6158
  6159     IF STATEI NOT = LOW-VALUES
  6160         MOVE AL-UANON           TO  STATEA
  6161         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6162         MOVE STATEI             TO  PI-CHEK-STATE
  6163                                     PI-STATE
  6164     ELSE
  6165         MOVE -1                 TO  STATEL
  6166         MOVE AL-UABON           TO  STATEA
  6167         MOVE ER-0196            TO  EMI-ERROR
  6168         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6169
  6170     IF EFFDTL GREATER ZERO
  6171         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6172         PERFORM 8700-DEEDIT
  6173         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6174             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6175             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6176             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6177             MOVE '4'                TO  DC-OPTION-CODE
  6178             PERFORM 8500-DATE-CONVERT
  6179             IF DC-ERROR-CODE NOT = SPACES
  6180                 MOVE ER-0215        TO  EMI-ERROR
  6181                 PERFORM 9900-ERROR-FORMAT
  6182                 MOVE -1             TO  EFFDTL
  6183                 MOVE AL-UABON       TO  EFFDTA
  6184               ELSE
  6185                 MOVE AL-UANON       TO  EFFDTA
  6186                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6187                                         PI-CERT-EFF-DT
  6188           ELSE
  6189             MOVE ER-0215        TO  EMI-ERROR
  6190             PERFORM 9900-ERROR-FORMAT
  6191             MOVE -1             TO  EFFDTL
  6192             MOVE AL-UABON       TO  EFFDTA
  6193       ELSE
  6194         MOVE ER-0216            TO  EMI-ERROR
  6195         PERFORM 9900-ERROR-FORMAT
  6196         MOVE -1                 TO  EFFDTL
  6197         MOVE AL-UABOF           TO  EFFDTA.
  6198
  6199     IF ACCTI NOT = LOW-VALUES
  6200         MOVE AL-UANON           TO  ACCTA
  6201         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6202         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6203                                     PI-ACCOUNT
  6204     ELSE
  6205         MOVE -1                 TO  ACCTL
  6206         MOVE AL-UABON           TO  ACCTA
  6207         MOVE ER-0197            TO  EMI-ERROR
  6208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6209
  6210     IF CERTNOI NOT = LOW-VALUES
  6211         MOVE AL-UANON           TO  CERTNOA
  6212         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6213                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 109
* EL677.cbl
  6214     ELSE
  6215         MOVE -1                 TO  CERTNOL
  6216         MOVE AL-UABON           TO  CERTNOA
  6217         MOVE ER-0203            TO  EMI-ERROR
  6218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6219
  6220     IF SFXI  = LOW-VALUES
  6221         MOVE SPACE              TO  SFXI.
  6222
  6223     MOVE AL-UANON               TO  SFXA.
  6224
  6225     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6226                                     PI-CERT-SFX.
  6227     IF SEQI = LOW-VALUES
  6228         MOVE +1                 TO  SEQI.
  6229
  6230     MOVE AL-UNNON               TO  SEQA.
  6231     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6232
  6233     IF PAYTO1L > 0
  6234         MOVE PAYTO1I            TO  PI-PAYTO1
  6235     ELSE
  6236         MOVE SPACES             TO  PI-PAYTO1.
  6237
  6238     IF AMOUNTL > 0
  6239
  6240* EXEC CICS BIF DEEDIT
  6241*            FIELD   (AMOUNTI)
  6242*            LENGTH  (11)
  6243*        END-EXEC
  6244     MOVE 11
  6245       TO DFHEIV11
  6246*    MOVE '@"L                   #   #00006095' TO DFHEIV0
  6247     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6248     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6249     MOVE X'2020233030303036303935' TO DFHEIV0(25:11)
  6250     CALL 'kxdfhei1' USING DFHEIV0,
  6251           AMOUNTI,
  6252           DFHEIV11
  6253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6254         MOVE AMOUNTI            TO  PI-AMOUNT
  6255     ELSE
  6256         MOVE ZEROS              TO  PI-AMOUNT.
  6257
  6258     IF TYPEL > 0
  6259         MOVE TYPEI              TO  PI-TYPE
  6260     ELSE
  6261         MOVE SPACE              TO  PI-TYPE.
  6262
  6263*    IF REFL > 0
  6264*        MOVE REFI               TO  PI-REFERENCE
  6265*    ELSE
  6266*        MOVE SPACES             TO  PI-REFERENCE.
  6267     if rettol not = zeros
  6268        move rettoi              to pi-return-to
  6269        MOVE AL-UANON            TO  RETTOA
  6270     end-if
  6271     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 110
* EL677.cbl
  6272        if dedcyni = 'Y' OR 'N'
  6273           move al-uanon         to dedcyna
  6274           continue
  6275        else
  6276           move er-3451          to emi-error
  6277           move -1               to dedcynl
  6278           move al-uabon         to dedcyna
  6279           perform 9900-error-format
  6280                                 thru 9900-exit
  6281        end-if
  6282     end-if
  6283
  6284     if mainti = 'V' or 'R'
  6285        if ((vreasonl > zeros)
  6286           and (vreasoni (1:2) not = spaces))
  6287             or (pi-void-reissue-pass = '1' or '2')
  6288           continue
  6289        else
  6290           move er-3454          to emi-error
  6291           move -1               to vreasonl
  6292           move al-uabon         to vreasona
  6293           perform 9900-error-format
  6294                                 thru 9900-exit
  6295        end-if
  6296     end-if
  6297     if (mainti = 'A')
  6298        and (pi-prev-paid > zeros)
  6299        and (pi-check-type = 'C')
  6300        move er-3459             to emi-error
  6301        move -1                  to maintl
  6302        move al-uabon            to mainta
  6303        perform 9900-error-format
  6304                                 thru 9900-exit
  6305     end-if
  6306     if mainti = 'A'
  6307        continue
  6308     else
  6309        IF MAINTI = 'S'
  6310           or pi-prev-maint = 'S'
  6311           GO TO 1100-EDIT-COMPLETE
  6312        end-if
  6313     end-if
  6314     if (pi-void-reissue-pass = '1')
  6315        and (mainti = 'R')
  6316        if emi-error = zeros
  6317           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6318              go to 7500-reissue-pass-1
  6319           else
  6320              if eibaid = dfhenter
  6321                 move er-3460    to emi-error
  6322                 move -1         to maintl
  6323                 move al-uabon   to mainta
  6324                 perform 9900-error-format
  6325                                 thru 9900-exit
  6326              end-if
  6327           end-if
  6328        end-if
  6329     end-if
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 111
* EL677.cbl
  6330
  6331     if (pi-void-reissue-pass = '2')
  6332        and (mainti = 'R')
  6333        if emi-error = zeros
  6334           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6335              go to 7500-reissue-pass-1
  6336           else
  6337              if eibaid = dfhenter
  6338                 go to 7510-reissue-pass-2
  6339              end-if
  6340           end-if
  6341        end-if
  6342     end-if
  6343*    if (pi-void-reissue-pass = '1')
  6344*       and (mainti = 'R')
  6345*       if emi-error = zeros
  6346*          if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6347*             go to 7500-reissue-pass-1
  6348*          else
  6349*             if eibaid = dfhenter
  6350*                go to 7510-reissue-pass-2
  6351*                move '2'        to pi-void-reissue-pass
  6352*             end-if
  6353*          end-if
  6354*       end-if
  6355*    end-if
  6356     IF EIBAID = DFHPF5
  6357        IF EMI-ERROR = ZEROS
  6358          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6359        ELSE
  6360          GO TO 1100-EDIT-COMPLETE.
  6361
  6362     IF EIBAID = DFHPF6
  6363        IF EMI-ERROR = ZEROS
  6364           GO TO 6300-BUILD-CERT-SCREEN
  6365         ELSE
  6366           GO TO 1100-EDIT-COMPLETE.
  6367
  6368     IF EIBAID = DFHPF7
  6369        IF EMI-ERROR = ZEROS
  6370           GO TO 6600-build-beneficiary-screen
  6371         ELSE
  6372           GO TO 1100-EDIT-COMPLETE.
  6373     if mainti = 'A'
  6374        if dedcynl not = zeros
  6375           if dedcyni <> pi-previous-deduct-comm
  6376              perform 6700-build-common
  6377                                 thru 6700-exit
  6378              MOVE WS-REFUND-AMOUNT
  6379                                 TO AMOUNTO
  6380              MOVE AL-UANON      TO PAYTO1A
  6381                                    PAYTO2A
  6382                                    PAYAD1A
  6383                                    PAYCTYA
  6384                                    paysta
  6385                                    PTOZIPA
  6386              GO TO 8100-send-initial-map
  6387           end-if
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 112
* EL677.cbl
  6388        end-if
  6389     end-if
  6390*    if mainti = 'V'
  6391*       if (vreasonl > zeros)
  6392*          and (vreasoni (1:2) not = spaces)
  6393*          continue
  6394*       else
  6395*          move er-3454          to emi-error
  6396*          move -1               to vreasonl
  6397*          move al-uabon         to vreasona
  6398*          perform 9900-error-format
  6399*                                thru 9900-exit
  6400*       end-if
  6401*    end-if
  6402     IF MAINTI = 'A'
  6403        if (payto1i not = spaces and low-values)
  6404           and (payad1i not = spaces and low-values)
  6405           and (payctyi not = spaces and low-values)
  6406           and (paysti not = spaces and low-values)
  6407           and (ptozipi not = spaces and low-values)
  6408           continue
  6409        else
  6410           MOVE -1               TO PAYTO1L
  6411           MOVE ER-2907          TO EMI-ERROR
  6412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6413        end-if
  6414     end-if
  6415
  6416     IF MAINTI = 'A'
  6417         IF EIBAID NOT = DFHPF4
  6418             MOVE DFHENTER       TO  EIBAID
  6419             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6420
  6421     IF MAINTI = 'S' OR 'V' or 'R' or 'D' or 'X'
  6422         GO TO 1100-EDIT-COMPLETE.
  6423
  6424     IF PRINTEDL GREATER THAN +0
  6425         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6426         PERFORM 8700-DEEDIT
  6427         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6428             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6429             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6430             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6431             MOVE '4'                TO  DC-OPTION-CODE
  6432             PERFORM 8500-DATE-CONVERT
  6433             IF DC-ERROR-CODE NOT = SPACES
  6434                 MOVE ER-3046        TO  EMI-ERROR
  6435                 PERFORM 9900-ERROR-FORMAT
  6436                 MOVE -1             TO  PRINTEDL
  6437                 MOVE AL-UABON       TO  PRINTEDA
  6438                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6439             ELSE
  6440                 MOVE AL-UANON       TO  PRINTEDA
  6441                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6442         ELSE
  6443             MOVE ER-3046        TO  EMI-ERROR
  6444             PERFORM 9900-ERROR-FORMAT
  6445             MOVE -1             TO  PRINTEDL
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 113
* EL677.cbl
  6446             MOVE AL-UABON       TO  PRINTEDA
  6447             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6448
  6449     IF AMOUNTL = ZEROS
  6450         GO TO 1050-CK-AMT.
  6451
  6452*    EXEC CICS BIF DEEDIT
  6453*        FIELD   (AMOUNTI)
  6454*        LENGTH  (11)
  6455*    END-EXEC.
  6456
  6457     IF AMOUNTI NOT NUMERIC     OR
  6458        AMOUNTI LESS THAN ZERO  OR
  6459       (AMOUNTI = ZEROS  AND
  6460               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6461          MOVE ER-1159            TO  EMI-ERROR
  6462          MOVE -1                 TO  AMOUNTL
  6463          MOVE AL-UNBON           TO  AMOUNTA
  6464          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6465          GO TO 1100-EDIT-COMPLETE.
  6466
  6467     MOVE AMOUNTI                TO  WS-AM-WORK.
  6468
  6469     IF WS-AM-SIGN = SPACES
  6470         MOVE WS-AM-NUM          TO  WS-AMT
  6471         ADD 0                   TO  WS-AMT
  6472       ELSE
  6473         MOVE AMOUNTI            TO  WS-AMT
  6474         ADD 0                   TO  WS-AMT.
  6475
  6476     IF MAINTI = 'A'
  6477        IF EIBAID = DFHENTER
  6478           if (ws-amt + pi-prev-paid) >
  6479              (cm-lf-premium-amt + cm-lf-alt-premium-amt +
  6480                 cm-ah-premium-amt)
  6481              move zeros to ws-amt
  6482           end-if
  6483        end-if
  6484     end-if
  6485      MOVE WS-AMT                TO  AMOUNTO.
  6486      MOVE AL-UNNON              TO  AMOUNTA.
  6487
  6488 1050-CK-AMT.
  6489     IF AMOUNTL = ZEROS AND
  6490        MAINTI  = 'A'
  6491         MOVE ER-1159            TO  EMI-ERROR
  6492         MOVE -1                 TO  AMOUNTL
  6493         MOVE AL-UNBON           TO  AMOUNTA
  6494         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6495
  6496*    MOVE AL-UANON              TO  TYPEA.
  6497     if (amountl <> zeros)
  6498        if (ws-amt <= zeros)
  6499           and (pi-check-type <> 'C')
  6500           MOVE ER-9999          TO EMI-ERROR
  6501           MOVE -1               TO AMOUNTL
  6502           MOVE AL-UNBON         TO AMOUNTA
  6503           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 114
* EL677.cbl
  6504                                 THRU 9900-EXIT
  6505        end-if
  6506     end-if
  6507     IF TYPEL GREATER THAN ZEROS
  6508         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6509             NEXT SENTENCE
  6510         ELSE
  6511             MOVE ER-3044    TO  EMI-ERROR
  6512             MOVE -1         TO  TYPEL
  6513             MOVE AL-PABON   TO  TYPEA
  6514             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6515     ELSE
  6516         IF MAINTI  = 'A'
  6517             MOVE ER-3044    TO  EMI-ERROR
  6518             MOVE -1         TO  TYPEL
  6519             MOVE AL-PABON   TO  TYPEA
  6520             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6521
  6522
  6523 1100-EDIT-COMPLETE.
  6524
  6525     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6526       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6527        EIBAID NOT = DFHPF4)
  6528         GO TO 8200-SEND-DATAONLY.
  6529
  6530     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6531
  6532     IF MAINTI = 'A'
  6533         GO TO 2000-ADD-RECORD.
  6534
  6535*    IF MAINTI = 'C' OR 'V'
  6536     IF MAINTI = 'V' or 'R' or 'X'
  6537         GO TO 3000-CHANGE-RECORD.
  6538
  6539     IF MAINTI = 'S' or 'C'
  6540         GO TO 5000-BROWSE-FILE.
  6541
  6542     if mainti = 'D'
  6543        go to 3400-delete-record
  6544     end-if
  6545     .
  6546 1200-VERIFY-CARRIER-ID.
  6547     MOVE SPACES                 TO ELCNTL-KEY.
  6548     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6549     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6550     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6551     MOVE +0                     TO ELCNTL-SEQ.
  6552
  6553
  6554* EXEC CICS HANDLE CONDITION
  6555*        NOTFND   (1290-NO-CARRIER)
  6556*    END-EXEC.
  6557*    MOVE '"$I                   ! $ #00006398' TO DFHEIV0
  6558     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6560     MOVE X'2420233030303036333938' TO DFHEIV0(25:11)
  6561     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 115
* EL677.cbl
  6562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6563
  6564
  6565
  6566* EXEC CICS READ
  6567*        DATASET   (ELCNTL-FILE-ID)
  6568*        SET       (ADDRESS OF CONTROL-FILE)
  6569*        RIDFLD    (ELCNTL-KEY)
  6570*    END-EXEC.
  6571*    MOVE '&"S        E          (   #00006402' TO DFHEIV0
  6572     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6574     MOVE X'2020233030303036343032' TO DFHEIV0(25:11)
  6575     CALL 'kxdfhei1' USING DFHEIV0,
  6576           ELCNTL-FILE-ID,
  6577           DFHEIV20,
  6578           DFHEIV99,
  6579           ELCNTL-KEY,
  6580           DFHEIV99,
  6581           DFHEIV99,
  6582           DFHEIV99
  6583     SET ADDRESS OF CONTROL-FILE TO
  6584         DFHEIV20
  6585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6586
  6587
  6588     GO TO 1200-EXIT.
  6589
  6590 1290-NO-CARRIER.
  6591     MOVE ER-2208                TO EMI-ERROR.
  6592     MOVE -1                     TO CARRIERL.
  6593     MOVE AL-UABON               TO CARRIERA.
  6594     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6595
  6596 1200-EXIT.
  6597      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 116
* EL677.cbl
  6599 1300-VERIFY-STATE-ID.
  6600     MOVE SPACES                 TO ELCNTL-KEY.
  6601     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6602     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6603     MOVE STATEI                 TO ELCNTL-STATE.
  6604     MOVE +0                     TO ELCNTL-SEQ.
  6605
  6606
  6607* EXEC CICS HANDLE CONDITION
  6608*        NOTFND   (1380-NO-STATE)
  6609*    END-EXEC.
  6610*    MOVE '"$I                   ! % #00006426' TO DFHEIV0
  6611     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6613     MOVE X'2520233030303036343236' TO DFHEIV0(25:11)
  6614     CALL 'kxdfhei1' USING DFHEIV0
  6615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6616
  6617
  6618
  6619* EXEC CICS READ
  6620*        DATASET   (ELCNTL-FILE-ID)
  6621*        SET       (ADDRESS OF CONTROL-FILE)
  6622*        RIDFLD    (ELCNTL-KEY)
  6623*    END-EXEC.
  6624*    MOVE '&"S        E          (   #00006430' TO DFHEIV0
  6625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6627     MOVE X'2020233030303036343330' TO DFHEIV0(25:11)
  6628     CALL 'kxdfhei1' USING DFHEIV0,
  6629           ELCNTL-FILE-ID,
  6630           DFHEIV20,
  6631           DFHEIV99,
  6632           ELCNTL-KEY,
  6633           DFHEIV99,
  6634           DFHEIV99,
  6635           DFHEIV99
  6636     SET ADDRESS OF CONTROL-FILE TO
  6637         DFHEIV20
  6638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6639
  6640
  6641     GO TO 1390-EXIT.
  6642
  6643 1380-NO-STATE.
  6644     MOVE ER-2209                TO EMI-ERROR.
  6645     MOVE -1                     TO STATEL.
  6646     MOVE AL-UABON               TO STATEA.
  6647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6648
  6649 1390-EXIT.
  6650      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 117
* EL677.cbl
  6652
  6653 1400-VERIFY-ACCOUNT.
  6654     IF EIBAID = DFHPF5
  6655         GO TO 1410-BUILD-ACCOUNT-KEY.
  6656
  6657     IF MAINTL GREATER +0
  6658         NEXT SENTENCE
  6659       ELSE
  6660         GO TO 1490-EXIT.
  6661
  6662*    IF MAINTI = 'A' OR 'C' OR 'V'
  6663     IF MAINTI = 'A' OR 'V' or 'R'
  6664         NEXT SENTENCE
  6665       ELSE
  6666         GO TO 1490-EXIT.
  6667
  6668 1410-BUILD-ACCOUNT-KEY.
  6669     MOVE CARRIERI               TO ERACCT-CARRIER.
  6670     MOVE GROUPI                 TO ERACCT-GROUPING
  6671     MOVE STATEI                 TO ERACCT-STATE.
  6672     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6673     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6674
  6675     MOVE '2'                    TO DC-OPTION-CODE.
  6676     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6677
  6678     PERFORM 8500-DATE-CONVERT.
  6679     IF DATE-CONVERSION-ERROR
  6680        GO TO 1480-ACCOUNT-INVALID.
  6681
  6682     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6683    .
  6684 1420-get-eracct.
  6685     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6686
  6687
  6688* EXEC CICS HANDLE CONDITION
  6689*        NOTFND   (1480-ACCOUNT-INVALID)
  6690*        ENDFILE  (1480-ACCOUNT-INVALID)
  6691*    END-EXEC.
  6692*    MOVE '"$I''                  ! & #00006482' TO DFHEIV0
  6693     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6695     MOVE X'2620233030303036343832' TO DFHEIV0(25:11)
  6696     CALL 'kxdfhei1' USING DFHEIV0
  6697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6698
  6699
  6700
  6701* EXEC CICS STARTBR
  6702*        DATASET   (ERACCT-FILE-ID)
  6703*        RIDFLD    (ERACCT-KEY)
  6704*    END-EXEC.
  6705     MOVE 0
  6706       TO DFHEIV11
  6707*    MOVE '&,         G          &   #00006487' TO DFHEIV0
  6708     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6709     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 118
* EL677.cbl
  6710     MOVE X'2020233030303036343837' TO DFHEIV0(25:11)
  6711     CALL 'kxdfhei1' USING DFHEIV0,
  6712           ERACCT-FILE-ID,
  6713           ERACCT-KEY,
  6714           DFHEIV99,
  6715           DFHEIV11,
  6716           DFHEIV99
  6717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6718
  6719
  6720     set eracct-start to true
  6721     .
  6722 1420-READNEXT-ACCOUNT-MASTER.
  6723
  6724* EXEC CICS READNEXT
  6725*        DATASET   (ERACCT-FILE-ID)
  6726*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6727*        RIDFLD    (ERACCT-KEY)
  6728*    END-EXEC.
  6729     MOVE 0
  6730       TO DFHEIV11
  6731*    MOVE '&.S                   )   #00006495' TO DFHEIV0
  6732     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6733     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6734     MOVE X'2020233030303036343935' TO DFHEIV0(25:11)
  6735     CALL 'kxdfhei1' USING DFHEIV0,
  6736           ERACCT-FILE-ID,
  6737           DFHEIV20,
  6738           DFHEIV99,
  6739           ERACCT-KEY,
  6740           DFHEIV99,
  6741           DFHEIV11,
  6742           DFHEIV99,
  6743           DFHEIV99
  6744     SET ADDRESS OF ACCOUNT-MASTER TO
  6745         DFHEIV20
  6746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6747
  6748
  6749*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6750*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6751*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6752*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6753*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6754*         GO TO 1480-ACCOUNT-INVALID.
  6755*
  6756*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6757*        GO TO 1480-ACCOUNT-INVALID.
  6758*
  6759*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6760*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6761
  6762     evaluate true
  6763        when (save-eracct-key (1:20) not =
  6764           am-control-primary (1:20))
  6765           and (not eracct-found)
  6766           go to 1480-account-invalid
  6767        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 119
* EL677.cbl
  6768           am-control-primary (1:20))
  6769           and (eracct-found)
  6770           move ws-hold-eracct-record
  6771                                 to account-master
  6772        when (sv-acct-exp-date < am-effective-dt)
  6773           and (not eracct-found)
  6774           go to 1480-account-invalid
  6775        when sv-acct-exp-date >= am-expiration-dt
  6776           go to 1420-readnext-account-master
  6777        when am-expiration-dt = high-values
  6778           continue
  6779        when other
  6780           set eracct-found to true
  6781           move account-master   to ws-hold-eracct-record
  6782           go to 1420-readnext-account-master
  6783     end-evaluate
  6784     if eracct-start
  6785
  6786* exec cics endbr
  6787*          dataset  (eracct-file-id)
  6788*       end-exec
  6789     MOVE 0
  6790       TO DFHEIV11
  6791*    MOVE '&2                    $   #00006537' TO DFHEIV0
  6792     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6793     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6794     MOVE X'2020233030303036353337' TO DFHEIV0(25:11)
  6795     CALL 'kxdfhei1' USING DFHEIV0,
  6796           eracct-file-id,
  6797           DFHEIV11,
  6798           DFHEIV99
  6799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6800     end-if
  6801*    if am-expiration-dt = high-values
  6802*       continue
  6803*    else
  6804*       move account-master      to ws-hold-eracct-record
  6805*       go to 1420-readnext-account-master
  6806*    end-if
  6807     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6808     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6809     MOVE AM-STATE               TO PI-CR-STATE.
  6810     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6811
  6812     MOVE AM-NAME                TO PI-AM-NAME.
  6813     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6814     MOVE AM-CITY                TO PI-AM-CITY-st
  6815     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6816     move am-csr-code            to pi-am-csr
  6817
  6818     MOVE +0                     TO WS-SUB.
  6819
  6820 1430-FIND-ACC-AGT.
  6821     ADD +1                      TO WS-SUB.
  6822
  6823     IF  WS-SUB GREATER +10
  6824         GO TO 1480-ACCOUNT-INVALID.
  6825
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 120
* EL677.cbl
  6826     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6827         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6828       ELSE
  6829         GO TO 1430-FIND-ACC-AGT.
  6830
  6831     MOVE AL-UANON               TO CARRIERA
  6832                                    GROUPA
  6833                                    STATEA.
  6834
  6835     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6836
  6837     GO TO 1490-EXIT.
  6838
  6839 1480-ACCOUNT-INVALID.
  6840     MOVE -1                     TO CARRIERL
  6841     MOVE AL-UANON               TO CARRIERA
  6842                                    GROUPA
  6843                                    STATEA
  6844                                    ACCTA.
  6845     MOVE ER-2210                TO EMI-ERROR.
  6846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6847     GO TO 8200-SEND-DATAONLY.
  6848
  6849 1490-EXIT.
  6850      EXIT.
  6851
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 121
* EL677.cbl
  6853 1500-VERIFY-PENDING-BUS-REC.
  6854     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6855     if pi-corr-check
  6856        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6857        go to 1590-exit
  6858     end-if
  6859
  6860* EXEC CICS HANDLE CONDITION
  6861*        NOTFND   (1590-EXIT)
  6862*    END-EXEC.
  6863*    MOVE '"$I                   ! '' #00006599' TO DFHEIV0
  6864     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6866     MOVE X'2720233030303036353939' TO DFHEIV0(25:11)
  6867     CALL 'kxdfhei1' USING DFHEIV0
  6868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6869
  6870
  6871
  6872     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6873     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6874     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6875     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6876     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6877     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6878     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6879     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6880     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6881     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6882
  6883     IF ST-ACCNT-CNTL  OR
  6884        ACCNT-CNTL
  6885          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6886
  6887     IF ST-ACCNT-CNTL      OR
  6888        CARR-ST-ACCNT-CNTL OR
  6889        ACCNT-CNTL         OR
  6890        CARR-ACCNT-CNTL
  6891          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6892
  6893     IF ACCNT-CNTL OR
  6894        CARR-ACCNT-CNTL
  6895          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6896
  6897
  6898* EXEC CICS READ
  6899*         DATASET   (ERPNDB-ALT-FILE-ID)
  6900*         SET       (ADDRESS OF PENDING-BUSINESS)
  6901*         RIDFLD    (ERPNDB-ALT-KEY)
  6902*     END-EXEC.
  6903*    MOVE '&"S        E          (   #00006629' TO DFHEIV0
  6904     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6906     MOVE X'2020233030303036363239' TO DFHEIV0(25:11)
  6907     CALL 'kxdfhei1' USING DFHEIV0,
  6908           ERPNDB-ALT-FILE-ID,
  6909           DFHEIV20,
  6910           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 122
* EL677.cbl
  6911           ERPNDB-ALT-KEY,
  6912           DFHEIV99,
  6913           DFHEIV99,
  6914           DFHEIV99
  6915     SET ADDRESS OF PENDING-BUSINESS TO
  6916         DFHEIV20
  6917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6918
  6919
  6920     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6921
  6922     IF PB-C-PAYEE-CODE GREATER SPACES
  6923        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6924
  6925     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6926*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6927
  6928     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6929     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6930
  6931     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6932         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6933     ELSE
  6934         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6935
  6936*    IF MAINTI = 'A' OR 'C'
  6937*      IF PB-C-REFUND-CREATED
  6938*          MOVE -1               TO  MAINTL
  6939*          MOVE ER-3445          TO  EMI-ERROR
  6940*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6941
  6942 1590-EXIT.
  6943      EXIT.
  6944
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 123
* EL677.cbl
  6946 2000-ADD-RECORD.
  6947
  6948* EXEC CICS GETMAIN
  6949*        SET      (ADDRESS OF CHECK-RECORDS)
  6950*        LENGTH   (600)
  6951*        INITIMG  (GETMAIN-SPACE)
  6952*    END-EXEC.
  6953     MOVE 600
  6954       TO DFHEIV11
  6955*    MOVE ',"IL                  $   #00006662' TO DFHEIV0
  6956     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6957     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6958     MOVE X'2020233030303036363632' TO DFHEIV0(25:11)
  6959     CALL 'kxdfhei1' USING DFHEIV0,
  6960           DFHEIV20,
  6961           DFHEIV11,
  6962           GETMAIN-SPACE
  6963     SET ADDRESS OF CHECK-RECORDS TO
  6964         DFHEIV20
  6965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6966
  6967
  6968     MOVE 'CH'                   TO CH-RECORD-ID.
  6969     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6970     MOVE CARRIERI               TO CH-CARRIER.
  6971     MOVE GROUPI                 TO CH-GROUPING.
  6972     MOVE STATEI                 TO CH-STATE.
  6973     MOVE ACCTI                  TO CH-ACCOUNT.
  6974
  6975     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6976     MOVE '2'                    TO DC-OPTION-CODE.
  6977     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6978     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6979
  6980     MOVE CERTNOI                TO CH-CERT-PRIME.
  6981     MOVE SFXI                   TO CH-CERT-SFX.
  6982
  6983     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6984
  6985     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6986                                    ch-released-by
  6987     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6988
  6989     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6990     MOVE '5'                    TO DC-OPTION-CODE.
  6991     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6992     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6993                                    ch-released-dt
  6994
  6995     move 'P'                    to ch-approval-status
  6996
  6997     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6998                                    CH-VOID-DT
  6999                                    CH-CREDIT-ACCEPT-DT
  7000                                    CH-CANC-DT
  7001                                    ch-approval-dt
  7002                                    ch-check-cashed-dt
  7003     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 124
* EL677.cbl
  7004                                    CH-AH-REFUND
  7005*                                   CH-DEDUCT-WITHHELD
  7006*                                   CH-ADDITIONAL-CHARGE.
  7007
  7008     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7009
  7010     if pi-prev-paid not numeric
  7011        move zeros               to pi-prev-paid
  7012     end-if
  7013     if pi-prev-paid-this-month not numeric
  7014        move zeros               to pi-prev-paid-this-month
  7015     end-if
  7016     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7017       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7018        EIBAID NOT = DFHPF4)
  7019         GO TO 8200-SEND-DATAONLY.
  7020
  7021     add ch-amount-paid to pi-prev-paid
  7022     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  7023     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  7024     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  7025     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  7026     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  7027     move pi-am-csr              to ch-csr
  7028     .
  7029 2100-WRITE-RECORD.
  7030
  7031* exec cics read
  7032*       dataset    (erchek-file-id)
  7033*       into       (ws-dummy-erchek)
  7034*       ridfld     (ch-control-primary)
  7035*       resp       (ws-response)
  7036*    end-exec
  7037     MOVE LENGTH OF
  7038      ws-dummy-erchek
  7039       TO DFHEIV11
  7040*    MOVE '&"IL       E          (  N#00006730' TO DFHEIV0
  7041     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7043     MOVE X'204E233030303036373330' TO DFHEIV0(25:11)
  7044     CALL 'kxdfhei1' USING DFHEIV0,
  7045           erchek-file-id,
  7046           ws-dummy-erchek,
  7047           DFHEIV11,
  7048           ch-control-primary,
  7049           DFHEIV99,
  7050           DFHEIV99,
  7051           DFHEIV99
  7052     MOVE EIBRESP  TO ws-response
  7053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7054     if RESP-NOTFND
  7055        continue
  7056     else
  7057        add +1 to ch-sequence-no
  7058        add 1 to seqi
  7059        go to 2100-write-record
  7060     end-if
  7061     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 125
* EL677.cbl
  7062
  7063* EXEC CICS HANDLE CONDITION
  7064*        DUPREC (2200-DUPREC)
  7065*    END-EXEC.
  7066*    MOVE '"$%                   ! ( #00006744' TO DFHEIV0
  7067     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7069     MOVE X'2820233030303036373434' TO DFHEIV0(25:11)
  7070     CALL 'kxdfhei1' USING DFHEIV0
  7071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7072
  7073
  7074     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7075     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7076                                    CH-CHECK-QUE-SEQUENCE
  7077
  7078
  7079* EXEC CICS WRITE
  7080*        DATASET  (ERCHEK-FILE-ID)
  7081*        FROM     (CHECK-RECORDS)
  7082*        RIDFLD   (CH-CONTROL-PRIMARY)
  7083*        resp     (ws-response)
  7084*    END-EXEC.
  7085     MOVE LENGTH OF
  7086      CHECK-RECORDS
  7087       TO DFHEIV11
  7088*    MOVE '&$ L                  ''  N#00006752' TO DFHEIV0
  7089     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7090     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7091     MOVE X'204E233030303036373532' TO DFHEIV0(25:11)
  7092     CALL 'kxdfhei1' USING DFHEIV0,
  7093           ERCHEK-FILE-ID,
  7094           CHECK-RECORDS,
  7095           DFHEIV11,
  7096           CH-CONTROL-PRIMARY,
  7097           DFHEIV99,
  7098           DFHEIV99
  7099     MOVE EIBRESP  TO ws-response
  7100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7101
  7102     if resp-normal and pi-check-type = 'C'
  7103        move 'Y'                 to pi-check-cut
  7104     end-if
  7105     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7106             ERCHEK-RECORD-LENGTH + 23.
  7107
  7108     if pi-check-type not = 'C'
  7109        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7110                                 THRU 6200-EXIT
  7111        if resp-normal
  7112           MOVE 'Y'              TO PB-C-REFUND-SW
  7113           add +1 to pi-chek-rec-cnt
  7114           perform 6210-rewrite-pndb
  7115                                 thru 6210-exit
  7116*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7117        end-if
  7118     end-if
  7119     IF EMI-NO-ERRORS
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 126
* EL677.cbl
  7120         MOVE ER-0000            TO EMI-ERROR
  7121     ELSE
  7122         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7123            EIBAID = DFHPF4
  7124             MOVE ER-2600        TO EMI-ERROR.
  7125
  7126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7127
  7128     MOVE LOW-VALUES             TO EL677AI.
  7129
  7130     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7131     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7132     MOVE PI-CHEK-STATE          TO STATEO.
  7133     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7134
  7135     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7136     MOVE SPACE                  TO DC-OPTION-CODE.
  7137     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7138     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7139
  7140     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7141     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7142     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7143
  7144     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7145                                    ACCTA     EFFDTA  CERTNOA
  7146                                    SFXA.
  7147     MOVE AL-UNNON               TO SEQA.
  7148     go to 5000-browse-file
  7149     GO TO 8100-SEND-INITIAL-MAP.
  7150
  7151 2200-DUPREC.
  7152     ADD +1 TO CH-SEQUENCE-NO.
  7153     MOVE CH-SEQUENCE-NO         TO SEQO
  7154                                    PI-CHEK-SEQUENCE
  7155                                    CHEK-RECORD-SEQ.
  7156     GO TO 2100-WRITE-RECORD.
  7157 2700-WRITE-SQL.
  7158     perform 2710-build-rec      thru 2710-exit
  7159     perform 2720-insert-row     thru 2720-exit
  7160     perform 4300-FINISH-UP-DB   thru 4300-exit
  7161     .
  7162 2700-EXIT.
  7163     EXIT.
  7164 2710-BUILD-REC.
  7165     move spaces                 to daily-check-request-rec
  7166     move pi-company-id          to db-compid
  7167     move ch-carrier             to db-carrier
  7168                                    db-fincar
  7169     move ch-grouping            to db-grouping
  7170                                    db-fingrp
  7171     move ch-state               to db-state
  7172     move ch-account             to db-account
  7173     move ch-cert-eff-dt         to dc-bin-date-1
  7174     move ' '                    to dc-option-code
  7175     perform 8500-date-convert   thru 8500-exit
  7176     if no-conversion-error
  7177        move dc-greg-date-a-edit to db-effdate
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 127
* EL677.cbl
  7178     else
  7179        move spaces              to db-effdate
  7180     end-if
  7181     move ch-cert-prime          to db-certificate
  7182     move ch-cert-sfx            to db-cert-sfx
  7183     move ch-sequence-no         to db-seq-no
  7184     move '1'                    to db-type
  7185                                    db-check-sub-type
  7186     if pi-check-type = 'C'
  7187        move '2'                 to db-check-sub-type
  7188     end-if
  7189     move ch-amount-paid         to db-amount-n
  7190     move zeros                  to db-checkstatus
  7191     move ch-check-que-control   to db-releasebatch
  7192     move save-bin-date          to dc-bin-date-1
  7193     move ' '                    to dc-option-code
  7194     perform 8500-date-convert   thru 8500-exit
  7195     if no-conversion-error
  7196        move dc-greg-date-a-edit to db-releasedt
  7197     else
  7198        move spaces              to db-releasedt
  7199     end-if
  7200     move pi-processor-id        to db-releaseby
  7201     move ch-payee-name-1        to db-payeename1
  7202     move ch-payee-name-2        to db-payeename2
  7203     move ch-payee-address-1     to db-payeeaddr1
  7204     move ch-payee-address-2     to db-payeeaddr2
  7205     move ch-payee-city          to db-payeecity
  7206     move ch-payee-state         to db-payeest
  7207     move ch-payee-zip-code      to db-payeezip
  7208     move ch-comp-fin-resp       to db-finresp
  7209     move ch-comp-account        to db-finacct
  7210     move ch-recorded-by         to db-preparer
  7211     move ch-return-to           to db-return-to
  7212     move pi-table-name          to db-insured-name
  7213     .
  7214 2710-EXIT.
  7215     EXIT.
  7216 2720-INSERT-ROW.
  7217     if not connected-to-db
  7218        perform 4100-CONNECT-TO-DB
  7219                                 thru 4100-exit
  7220     end-if
  7221     EXEC SQL
  7222        INSERT into ChkApp_Check (
  7223           Company,
  7224           CertCarrier,
  7225           CertGroup,
  7226           CertState,
  7227           CertAccount,
  7228           CertEffDate,
  7229           CertNumber,
  7230           CertNumberSuf,
  7231           CheckSeqNbr,
  7232           CheckType,
  7233           CheckAmount,
  7234           ReleaseBatchNbr,
  7235           ReleaseDate,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 128
* EL677.cbl
  7236           ReleasedBy,
  7237           PayeeName1,
  7238           PayeeName2,
  7239           PayeeAddress1,
  7240           PayeeAddress2,
  7241           PayeeCity,
  7242           PayeeState,
  7243           PayeeZip,
  7244           CompCarrier,
  7245           CompGroup,
  7246           CompFinResp,
  7247           CompAccount,
  7248           Preparer,
  7249           ReturnTo,
  7250           InsuredName,
  7251           CheckSubType)
  7252         VALUES (
  7253           :DB-CompId,
  7254           :DB-Carrier,
  7255           :DB-Grouping,
  7256           :DB-State,
  7257           :DB-Account,
  7258           :DB-EffDate,
  7259           :DB-Certificate,
  7260           :db-cert-sfx,
  7261           :DB-Seq-No,
  7262           :DB-Type,
  7263           :db-amount,
  7264           :db-releasebatch,
  7265           :db-releasedt,
  7266           :db-releaseby,
  7267           :db-payeename1,
  7268           :db-payeename2,
  7269           :db-payeeaddr1,
  7270           :db-payeeaddr2,
  7271           :db-payeecity,
  7272           :db-payeest,
  7273           :db-payeezip,
  7274           :db-fincar,
  7275           :db-fingrp,
  7276           :db-finresp,
  7277           :db-finacct,
  7278           :db-preparer,
  7279           :db-return-to,
  7280           :db-insured-name,
  7281           :db-check-sub-type)
  7282     END-EXEC
  7283*    display ' db-compid     ' db-compid
  7284*    display ' db-carrier    ' db-carrier
  7285*    display ' db-group      ' db-grouping
  7286*    display ' db state      ' db-state
  7287*    display ' accounbt      ' db-account
  7288*    display ' effdt         ' db-effdate
  7289*    display ' cert          ' db-certificate
  7290*    display ' suffix        ' db-cert-sfx
  7291*    display ' seq no        ' db-seq-no
  7292*    display ' type          ' db-type
  7293     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 129
* EL677.cbl
  7294        add +1                   to ch-sequence-no
  7295        move ch-sequence-no      to DB-Seq-No
  7296        go to 2720-insert-row
  7297     end-if
  7298     if sqlcode not = 0
  7299        display "Error: cannot insert row "
  7300        display ' sql return code ' sqlcode
  7301        move sqlcode to ws-sql-code
  7302        move ws-sql-code to ws-dis-sql-code
  7303        display ' dis sql code ' ws-dis-sql-code
  7304        display ' sql err mess    ' sqlerrmc
  7305        move sqlcode to ws-sql-code
  7306        move ws-sql-code to ws-dis-sql-code
  7307        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7308           into EMI-MESSAGE-AREA (1)
  7309        end-string
  7310        display ' msga1 ' emi-message-area (1)
  7311        perform 4300-FINISH-UP-DB thru 4300-exit
  7312        go to 8200-send-dataonly
  7313*       goback
  7314     end-if
  7315     .
  7316 2720-EXIT.
  7317     EXIT.
  7318 3000-CHANGE-RECORD.
  7319
  7320* EXEC CICS HANDLE CONDITION
  7321*        NOTFND (3900-RECORD-NOTFND)
  7322*    END-EXEC.
  7323*    MOVE '"$I                   ! ) #00006976' TO DFHEIV0
  7324     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7326     MOVE X'2920233030303036393736' TO DFHEIV0(25:11)
  7327     CALL 'kxdfhei1' USING DFHEIV0
  7328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7329
  7330     if mainti <> 'X'
  7331        go to 3000-continue
  7332     end-if
  7333
  7334     move pi-erchek-key          to erchek-key
  7335
  7336
  7337* exec cics startbr
  7338*        dataset     ('ERCHEK')
  7339*        ridfld      (erchek-key)
  7340*        resp        (ws-response)
  7341*    end-exec
  7342     MOVE 'ERCHEK' TO DFHEIV1
  7343     MOVE 0
  7344       TO DFHEIV11
  7345*    MOVE '&,         G          &  N#00006985' TO DFHEIV0
  7346     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7347     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7348     MOVE X'204E233030303036393835' TO DFHEIV0(25:11)
  7349     CALL 'kxdfhei1' USING DFHEIV0,
  7350           DFHEIV1,
  7351           erchek-key,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 130
* EL677.cbl
  7352           DFHEIV99,
  7353           DFHEIV11,
  7354           DFHEIV99
  7355     MOVE EIBRESP  TO ws-response
  7356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7357
  7358     if not resp-normal
  7359        display ' bad startbr ' ws-response
  7360        go to 3000-continue
  7361     end-if
  7362
  7363     .
  7364 3000-readnext.
  7365
  7366
  7367* exec cics readnext
  7368*       dataset    ('ERCHEK')
  7369*       ridfld  (erchek-key)
  7370*       set     (address of check-records)
  7371*       resp    (ws-response)
  7372*    end-exec
  7373     MOVE 'ERCHEK' TO DFHEIV1
  7374     MOVE 0
  7375       TO DFHEIV11
  7376*    MOVE '&.S                   )  N#00006999' TO DFHEIV0
  7377     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7378     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7379     MOVE X'204E233030303036393939' TO DFHEIV0(25:11)
  7380     CALL 'kxdfhei1' USING DFHEIV0,
  7381           DFHEIV1,
  7382           DFHEIV20,
  7383           DFHEIV99,
  7384           erchek-key,
  7385           DFHEIV99,
  7386           DFHEIV11,
  7387           DFHEIV99,
  7388           DFHEIV99
  7389     SET ADDRESS OF check-records TO
  7390         DFHEIV20
  7391     MOVE EIBRESP  TO ws-response
  7392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7393
  7394     if not resp-normal
  7395        display ' bad readnext ' ws-response
  7396        go to 3000-endbr
  7397     end-if
  7398
  7399     if ch-company-cd = pi-company-cd and
  7400        ch-carrier    = pi-chek-carrier and
  7401        ch-state      = pi-chek-state and
  7402        ch-account    = pi-chek-account and
  7403        ch-cert-eff-dt = pi-chek-eff-dt and
  7404        ch-cert-prime = pi-chek-cert-no and
  7405        ch-cert-sfx   = pi-chek-suf-no
  7406        continue
  7407     else
  7408        go to 3000-endbr
  7409     end-if
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 131
* EL677.cbl
  7410
  7411     if ch-amount-paid = pi-void-reissue-amt and
  7412        ch-void-dt = low-values and
  7413        ch-recorded-dt = save-bin-date
  7414        move er-3463             to emi-error
  7415        move -1                  to maintl
  7416        move al-uabon            to mainta
  7417        perform 9900-error-format
  7418                                 thru 9900-exit
  7419        go to 8200-send-dataonly
  7420     else
  7421        go to 3000-readnext
  7422     end-if
  7423
  7424     .
  7425 3000-endbr.
  7426
  7427
  7428* exec cics endbr
  7429*       dataset   ('ERCHEK')
  7430*    end-exec
  7431     MOVE 'ERCHEK' TO DFHEIV1
  7432     MOVE 0
  7433       TO DFHEIV11
  7434*    MOVE '&2                    $   #00007039' TO DFHEIV0
  7435     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7437     MOVE X'2020233030303037303339' TO DFHEIV0(25:11)
  7438     CALL 'kxdfhei1' USING DFHEIV0,
  7439           DFHEIV1,
  7440           DFHEIV11,
  7441           DFHEIV99
  7442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7443
  7444     .
  7445 3000-continue.
  7446
  7447
  7448* EXEC CICS READ
  7449*        DATASET  (ERCHEK-FILE-ID)
  7450*        SET      (ADDRESS OF CHECK-RECORDS)
  7451*        RIDFLD   (PI-ERCHEK-KEY)
  7452*        UPDATE
  7453*    END-EXEC.
  7454*    MOVE '&"S        EU         (   #00007046' TO DFHEIV0
  7455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7456     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7457     MOVE X'2020233030303037303436' TO DFHEIV0(25:11)
  7458     CALL 'kxdfhei1' USING DFHEIV0,
  7459           ERCHEK-FILE-ID,
  7460           DFHEIV20,
  7461           DFHEIV99,
  7462           PI-ERCHEK-KEY,
  7463           DFHEIV99,
  7464           DFHEIV99,
  7465           DFHEIV99
  7466     SET ADDRESS OF CHECK-RECORDS TO
  7467         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 132
* EL677.cbl
  7468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7469
  7470
  7471     IF CH-LF-REFUND NOT NUMERIC
  7472         MOVE ZEROS              TO CH-LF-REFUND.
  7473     IF CH-AH-REFUND NOT NUMERIC
  7474         MOVE ZEROS              TO CH-AH-REFUND.
  7475*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7476*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7477*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7478*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7479
  7480     IF VREASONL NOT = ZEROS
  7481         MOVE VREASONI           TO  CH-VOID-REASON.
  7482
  7483     IF MAINTI = 'V' or 'R'
  7484        GO TO 3050-void-processing
  7485     end-if
  7486     .
  7487 3010-VOID-REVERSAL.  *>  Mainti of X only
  7488
  7489     if ch-void-dt = low-values
  7490        move er-3462             to emi-error
  7491        move -1                  to maintl
  7492        move al-uabon            to mainta
  7493
  7494* exec cics unlock
  7495*          dataset    (ERCHEK-FILE-ID)
  7496*       end-exec
  7497*    MOVE '&*                    #   #00007075' TO DFHEIV0
  7498     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7499     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7500     MOVE X'2020233030303037303735' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0,
  7502           ERCHEK-FILE-ID,
  7503           DFHEIV99
  7504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7505        perform 9900-error-format
  7506                                 thru 9900-exit
  7507        go to 8200-send-dataonly
  7508     end-if
  7509
  7510     if ch-void-dt <> SAVE-BIN-DATE
  7511        move er-3461             to emi-error
  7512        move -1                  to maintl
  7513        move al-uabon            to mainta
  7514
  7515* exec cics unlock
  7516*          dataset    (ERCHEK-FILE-ID)
  7517*       end-exec
  7518*    MOVE '&*                    #   #00007087' TO DFHEIV0
  7519     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7520     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7521     MOVE X'2020233030303037303837' TO DFHEIV0(25:11)
  7522     CALL 'kxdfhei1' USING DFHEIV0,
  7523           ERCHEK-FILE-ID,
  7524           DFHEIV99
  7525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 133
* EL677.cbl
  7526        perform 9900-error-format
  7527                                 thru 9900-exit
  7528        go to 8200-send-dataonly
  7529     end-if
  7530
  7531     move low-values             to ch-void-dt
  7532     move spaces                 to ch-void-by
  7533                                    ch-void-reason
  7534
  7535     go to 3100-rewrite-record
  7536     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7537
  7538     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7539
  7540     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7541       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7542        EIBAID NOT = DFHPF4)
  7543         GO TO 8200-SEND-DATAONLY.
  7544     go to 3100-rewrite-record
  7545     .
  7546 3050-void-processing.
  7547     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7548     if sqlcode = 0
  7549        perform 4200-get-tbl-row thru 4200-exit
  7550        if sqlcode = 0
  7551           if nu-app-date = -1
  7552              move -1            to maintl
  7553              move er-3453       to emi-error
  7554              move al-uabon      to mainta
  7555              perform 9900-error-format
  7556                                 thru 9900-exit
  7557              perform 4300-FINISH-UP-DB thru 4300-exit
  7558              go to 8200-send-dataonly
  7559           end-if
  7560        end-if
  7561        if connected-to-db
  7562           perform 4300-FINISH-UP-DB thru 4300-exit
  7563        end-if
  7564     end-if
  7565     if (ch-check-written-dt = low-values)
  7566        or (ch-check-no = spaces)
  7567        move -1                  to maintl
  7568        move er-3455             to emi-error
  7569        move al-uabon            to mainta
  7570        perform 9900-error-format
  7571                                 thru 9900-exit
  7572        perform 4300-FINISH-UP-DB thru 4300-exit
  7573        go to 8200-send-dataonly
  7574     end-if
  7575     .
  7576 3100-REWRITE-RECORD.
  7577     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7578
  7579     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7580     MOVE '5'                    TO DC-OPTION-CODE.
  7581     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7582
  7583     IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 134
* EL677.cbl
  7584       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7585     end-if
  7586     IF MAINTI = 'V' or 'R'
  7587        IF (CH-VOID-DT = LOW-VALUES)
  7588           and (pi-check-cashed = spaces)
  7589           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7590           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7591           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7592           if pi-chek-rec-cnt = +1
  7593              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7594                                 THRU 6200-EXIT
  7595              if resp-normal
  7596                 MOVE ' '        TO PB-C-REFUND-SW
  7597                 perform 6210-rewrite-pndb
  7598                                 thru 6210-exit
  7599              end-if
  7600           end-if
  7601        ELSE
  7602           MOVE -1               TO MAINTL
  7603           MOVE ER-2583          TO EMI-ERROR
  7604           MOVE AL-UABON         TO MAINTA
  7605           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7606           GO TO 8200-SEND-DATAONLY
  7607        end-if
  7608     end-if
  7609
  7610     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7611
  7612
  7613* EXEC CICS REWRITE
  7614*        DATASET  (ERCHEK-FILE-ID)
  7615*        FROM     (CHECK-RECORDS)
  7616*    END-EXEC.
  7617     MOVE LENGTH OF
  7618      CHECK-RECORDS
  7619       TO DFHEIV11
  7620*    MOVE '&& L                  %   #00007176' TO DFHEIV0
  7621     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7622     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7623     MOVE X'2020233030303037313736' TO DFHEIV0(25:11)
  7624     CALL 'kxdfhei1' USING DFHEIV0,
  7625           ERCHEK-FILE-ID,
  7626           CHECK-RECORDS,
  7627           DFHEIV11,
  7628           DFHEIV99
  7629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7630
  7631
  7632     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7633        (MAINTI EQUAL 'C')          AND
  7634        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7635            PERFORM 3300-UPDATE-ERPYAJ THRU 3300-EXIT.
  7636     if mainti = 'X'
  7637        perform 3320-remove-rev-erpyaj-rec
  7638                                 thru 3320-exit
  7639     end-if
  7640     IF EMI-NO-ERRORS
  7641         MOVE ER-0000            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 135
* EL677.cbl
  7642     ELSE
  7643         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7644            EIBAID = DFHPF4
  7645             MOVE ER-2600        TO EMI-ERROR.
  7646     if mainti = 'R'
  7647        if pi-void-reissue-pass = ' '
  7648           move '1'              to pi-void-reissue-pass
  7649        MOVE ER-3274             TO EMI-ERROR
  7650        end-if
  7651     end-if
  7652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7653
  7654     MOVE LOW-VALUES             TO EL677AI.
  7655
  7656     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7657     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7658     MOVE PI-CHEK-STATE          TO STATEO.
  7659     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7660
  7661     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7662     MOVE SPACE                  TO DC-OPTION-CODE.
  7663     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7664     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7665
  7666     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7667     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7668     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7669
  7670     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7671                                     ACCTA   EFFDTA
  7672                                    CERTNOA   SFXA.
  7673
  7674     MOVE AL-UNNON               TO SEQA.
  7675     go to 5000-browse-file
  7676*    GO TO 8100-SEND-INITIAL-MAP.
  7677
  7678     .
  7679 3200-PAY-ADJS-REVERSAL.
  7680
  7681     IF CH-AMOUNT-PAID NOT = ZEROS
  7682         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7683         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7684
  7685     GO TO 3290-EXIT
  7686     .
  7687 3250-BUILD-ERPYAJ-REVERSAL.
  7688
  7689
  7690* EXEC CICS GETMAIN
  7691*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7692*        LENGTH  (200)
  7693*        INITIMG (GETMAIN-SPACE)
  7694*    END-EXEC.
  7695     MOVE 200
  7696       TO DFHEIV11
  7697*    MOVE ',"IL                  $   #00007238' TO DFHEIV0
  7698     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7699     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 136
* EL677.cbl
  7700     MOVE X'2020233030303037323338' TO DFHEIV0(25:11)
  7701     CALL 'kxdfhei1' USING DFHEIV0,
  7702           DFHEIV20,
  7703           DFHEIV11,
  7704           GETMAIN-SPACE
  7705     SET ADDRESS OF PENDING-PAY-ADJ TO
  7706         DFHEIV20
  7707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7708
  7709
  7710     MOVE 'PY'                   TO PY-RECORD-ID.
  7711     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7712
  7713     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7714     IF PI-ZERO-CARRIER  OR
  7715        PI-ZERO-CAR-GROUP
  7716         MOVE ZERO               TO PY-CARRIER.
  7717
  7718     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7719     IF PI-ZERO-GROUPING  OR
  7720        PI-ZERO-CAR-GROUP
  7721         MOVE ZERO               TO PY-GROUPING.
  7722
  7723     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7724     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7725     MOVE 'R'                    TO PY-RECORD-TYPE.
  7726     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7727     move '1825011300'           to py-gl-account
  7728     move 'VOID REFCK'           TO py-gl-comment
  7729     move ch-amount-paid         to py-entry-amt
  7730*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7731
  7732     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7733     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7734
  7735     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7736     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7737     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7738                                    PY-INPUT-DT.
  7739*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7740*                                   PY-CHECK-QUE-SEQUENCE.
  7741     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7742                                    PY-BILLED-DATE
  7743                                    PY-REPORTED-DT
  7744                                    PY-CHECK-WRITTEN-DT
  7745                                    PY-AR-DATE
  7746                                    PY-GL-DATE.
  7747     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7748     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7749*    MOVE 'V'                    TO PY-VOID-SW.
  7750*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7751
  7752     IF PI-AR-PROCESSING
  7753         MOVE 'B'                TO PY-PYMT-TYPE
  7754         MOVE 'A'                TO PY-PMT-APPLIED.
  7755
  7756 3259-BUILD-EXIT.
  7757     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 137
* EL677.cbl
  7758
  7759 3280-WRITE-ERPYAJ-REVERSAL.
  7760
  7761
  7762* EXEC CICS HANDLE CONDITION
  7763*        DUPREC (3287-DUPREC)
  7764*    END-EXEC.
  7765*    MOVE '"$%                   ! * #00007295' TO DFHEIV0
  7766     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7768     MOVE X'2A20233030303037323935' TO DFHEIV0(25:11)
  7769     CALL 'kxdfhei1' USING DFHEIV0
  7770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7771
  7772
  7773
  7774* EXEC CICS WRITE
  7775*        DATASET (ERPYAJ-FILE-ID)
  7776*        FROM    (PENDING-PAY-ADJ)
  7777*        RIDFLD  (PY-CONTROL-PRIMARY)
  7778*    END-EXEC.
  7779     MOVE LENGTH OF
  7780      PENDING-PAY-ADJ
  7781       TO DFHEIV11
  7782*    MOVE '&$ L                  ''   #00007299' TO DFHEIV0
  7783     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7784     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7785     MOVE X'2020233030303037323939' TO DFHEIV0(25:11)
  7786     CALL 'kxdfhei1' USING DFHEIV0,
  7787           ERPYAJ-FILE-ID,
  7788           PENDING-PAY-ADJ,
  7789           DFHEIV11,
  7790           PY-CONTROL-PRIMARY,
  7791           DFHEIV99,
  7792           DFHEIV99
  7793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7794
  7795
  7796     GO TO 3289-WRITE-EXIT.
  7797
  7798 3287-DUPREC.
  7799     ADD +1 TO PY-FILE-SEQ-NO.
  7800
  7801     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7802
  7803 3289-WRITE-EXIT.
  7804     EXIT.
  7805
  7806 3290-EXIT.
  7807      EXIT.
  7808
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 138
* EL677.cbl
  7810 3300-UPDATE-ERPYAJ.
  7811
  7812
  7813* EXEC CICS GETMAIN
  7814*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7815*        LENGTH  (200)
  7816*        INITIMG (GETMAIN-SPACE)
  7817*    END-EXEC.
  7818     MOVE 200
  7819       TO DFHEIV11
  7820*    MOVE ',"IL                  $   #00007321' TO DFHEIV0
  7821     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7822     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7823     MOVE X'2020233030303037333231' TO DFHEIV0(25:11)
  7824     CALL 'kxdfhei1' USING DFHEIV0,
  7825           DFHEIV20,
  7826           DFHEIV11,
  7827           GETMAIN-SPACE
  7828     SET ADDRESS OF PENDING-PAY-ADJ TO
  7829         DFHEIV20
  7830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7831
  7832
  7833     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7834     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7835     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7836     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7837     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7838     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7839     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7840
  7841
  7842* EXEC CICS HANDLE CONDITION
  7843*        NOTFND   (3300-EXIT)
  7844*        ENDFILE  (3300-EXIT)
  7845*    END-EXEC.
  7846*    MOVE '"$I''                  ! + #00007335' TO DFHEIV0
  7847     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7849     MOVE X'2B20233030303037333335' TO DFHEIV0(25:11)
  7850     CALL 'kxdfhei1' USING DFHEIV0
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7852
  7853
  7854 3300-READNEXT-ERPYAJ.
  7855
  7856
  7857* EXEC CICS READ
  7858*        DATASET  (ERPYAJ-FILE-ID)
  7859*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7860*        RIDFLD   (ERPYAJ-KEY)
  7861*        GTEQ
  7862*    END-EXEC.
  7863*    MOVE '&"S        G          (   #00007342' TO DFHEIV0
  7864     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7866     MOVE X'2020233030303037333432' TO DFHEIV0(25:11)
  7867     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 139
* EL677.cbl
  7868           ERPYAJ-FILE-ID,
  7869           DFHEIV20,
  7870           DFHEIV99,
  7871           ERPYAJ-KEY,
  7872           DFHEIV99,
  7873           DFHEIV99,
  7874           DFHEIV99
  7875     SET ADDRESS OF PENDING-PAY-ADJ TO
  7876         DFHEIV20
  7877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7878
  7879
  7880     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7881
  7882     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7883        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7884        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7885        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7886        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7887        (PY-RECORD-TYPE   NOT = 'C')
  7888          GO TO 3300-EXIT.
  7889
  7890     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7891         ADD +1 TO PYAJ-FILE-SEQ-NO
  7892         GO TO 3300-READNEXT-ERPYAJ.
  7893
  7894
  7895* EXEC CICS READ UPDATE
  7896*        DATASET   (ERPYAJ-FILE-ID)
  7897*        RIDFLD    (ERPYAJ-KEY)
  7898*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7899*    END-EXEC.
  7900*    MOVE '&"S        EU         (   #00007363' TO DFHEIV0
  7901     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7902     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7903     MOVE X'2020233030303037333633' TO DFHEIV0(25:11)
  7904     CALL 'kxdfhei1' USING DFHEIV0,
  7905           ERPYAJ-FILE-ID,
  7906           DFHEIV20,
  7907           DFHEIV99,
  7908           ERPYAJ-KEY,
  7909           DFHEIV99,
  7910           DFHEIV99,
  7911           DFHEIV99
  7912     SET ADDRESS OF PENDING-PAY-ADJ TO
  7913         DFHEIV20
  7914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7915
  7916
  7917     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7918     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7919
  7920     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7921
  7922     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7923     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7924     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7925
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 140
* EL677.cbl
  7926
  7927* EXEC CICS REWRITE
  7928*        DATASET  (ERPYAJ-FILE-ID)
  7929*        FROM     (PENDING-PAY-ADJ)
  7930*    END-EXEC.
  7931     MOVE LENGTH OF
  7932      PENDING-PAY-ADJ
  7933       TO DFHEIV11
  7934*    MOVE '&& L                  %   #00007378' TO DFHEIV0
  7935     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7936     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7937     MOVE X'2020233030303037333738' TO DFHEIV0(25:11)
  7938     CALL 'kxdfhei1' USING DFHEIV0,
  7939           ERPYAJ-FILE-ID,
  7940           PENDING-PAY-ADJ,
  7941           DFHEIV11,
  7942           DFHEIV99
  7943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7944
  7945
  7946 3300-EXIT.
  7947      EXIT.
  7948
  7949 3320-remove-rev-erpyaj-rec.
  7950
  7951
  7952* EXEC CICS GETMAIN
  7953*       SET     (ADDRESS OF PENDING-PAY-ADJ)
  7954*       LENGTH  (200)
  7955*       INITIMG (GETMAIN-SPACE)
  7956*    END-EXEC
  7957     MOVE 200
  7958       TO DFHEIV11
  7959*    MOVE ',"IL                  $   #00007388' TO DFHEIV0
  7960     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7961     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7962     MOVE X'2020233030303037333838' TO DFHEIV0(25:11)
  7963     CALL 'kxdfhei1' USING DFHEIV0,
  7964           DFHEIV20,
  7965           DFHEIV11,
  7966           GETMAIN-SPACE
  7967     SET ADDRESS OF PENDING-PAY-ADJ TO
  7968         DFHEIV20
  7969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7970
  7971     MOVE PI-COMPANY-CD          TO erpyaj-key
  7972     MOVE ch-comp-CARRIER        TO PYAJ-CARRIER
  7973     MOVE ch-comp-grouping       TO PYAJ-GROUPING
  7974     MOVE ch-comp-fin-resp       TO PYAJ-FIN-RESP
  7975     MOVE ch-comp-account        TO PYAJ-ACCOUNT
  7976     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO
  7977
  7978     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7979     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7980
  7981* exec cics startbr
  7982*       dataset    ('ERPYAJ')
  7983*       ridfld     (erpyaj-key)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 141
* EL677.cbl
  7984*       resp       (ws-response)
  7985*    end-exec
  7986     MOVE 'ERPYAJ' TO DFHEIV1
  7987     MOVE 0
  7988       TO DFHEIV11
  7989*    MOVE '&,         G          &  N#00007403' TO DFHEIV0
  7990     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7991     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7992     MOVE X'204E233030303037343033' TO DFHEIV0(25:11)
  7993     CALL 'kxdfhei1' USING DFHEIV0,
  7994           DFHEIV1,
  7995           erpyaj-key,
  7996           DFHEIV99,
  7997           DFHEIV11,
  7998           DFHEIV99
  7999     MOVE EIBRESP  TO ws-response
  8000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8001
  8002     if not resp-normal
  8003        display ' no erpyaj found ' pyaj-carrier ' '
  8004        pyaj-fin-resp ' ' pyaj-account
  8005        go to 3320-exit
  8006     end-if
  8007
  8008     set pyaj-browse-started to true
  8009
  8010     .
  8011 3320-readnext.
  8012
  8013
  8014* exec cics readnext
  8015*       dataset     ('ERPYAJ')
  8016*       set         (address of pending-pay-adj)
  8017*       ridfld      (erpyaj-key)
  8018*       resp        (ws-response)
  8019*    end-exec
  8020     MOVE 'ERPYAJ' TO DFHEIV1
  8021     MOVE 0
  8022       TO DFHEIV11
  8023*    MOVE '&.S                   )  N#00007420' TO DFHEIV0
  8024     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8025     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8026     MOVE X'204E233030303037343230' TO DFHEIV0(25:11)
  8027     CALL 'kxdfhei1' USING DFHEIV0,
  8028           DFHEIV1,
  8029           DFHEIV20,
  8030           DFHEIV99,
  8031           erpyaj-key,
  8032           DFHEIV99,
  8033           DFHEIV11,
  8034           DFHEIV99,
  8035           DFHEIV99
  8036     SET ADDRESS OF pending-pay-adj TO
  8037         DFHEIV20
  8038     MOVE EIBRESP  TO ws-response
  8039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8040
  8041     if not resp-normal
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 142
* EL677.cbl
  8042        display ' error 3320-readnext ' ws-response
  8043        go to 3320-exit
  8044     end-if
  8045
  8046     if ch-comp-carrier = py-carrier and
  8047        ch-comp-fin-resp  = py-fin-resp and
  8048        ch-comp-account = py-account
  8049        if py-record-type = 'R' and
  8050           ch-amount-paid = py-entry-amt and
  8051           py-last-maint-dt = save-bin-date and
  8052           py-gl-comment = 'VOID REFCK' and
  8053           py-check-number = ch-check-no(2:6) and
  8054           py-gl-account = '1825011300'
  8055
  8056* exec cics delete
  8057*             dataset     ('ERPYAJ')
  8058*             ridfld      (erpyaj-key)
  8059*             resp        (ws-response)
  8060*          end-exec
  8061     MOVE 'ERPYAJ' TO DFHEIV1
  8062*    MOVE '&(  R                 &  N#00007441' TO DFHEIV0
  8063     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8064     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8065     MOVE X'204E233030303037343431' TO DFHEIV0(25:11)
  8066     CALL 'kxdfhei1' USING DFHEIV0,
  8067           DFHEIV1,
  8068           erpyaj-key,
  8069           DFHEIV99,
  8070           DFHEIV99,
  8071           DFHEIV99
  8072     MOVE EIBRESP  TO ws-response
  8073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8074           if not resp-normal
  8075              display ' bad delete ' ws-response ' ' pyaj-account
  8076           end-if
  8077        else
  8078           go to 3320-readnext
  8079        end-if
  8080     end-if
  8081
  8082     .
  8083 3320-end-browse.
  8084
  8085     if pyaj-browse-started
  8086
  8087* exec cics endbr
  8088*           dataset    ('ERPYAJ')
  8089*       end-exec
  8090     MOVE 'ERPYAJ' TO DFHEIV1
  8091     MOVE 0
  8092       TO DFHEIV11
  8093*    MOVE '&2                    $   #00007458' TO DFHEIV0
  8094     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8095     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8096     MOVE X'2020233030303037343538' TO DFHEIV0(25:11)
  8097     CALL 'kxdfhei1' USING DFHEIV0,
  8098           DFHEIV1,
  8099           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 143
* EL677.cbl
  8100           DFHEIV99
  8101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8102     end-if
  8103     .
  8104 3320-exit.
  8105     exit.
  8106 3400-delete-record.
  8107
  8108* EXEC CICS READ
  8109*        DATASET  (ERCHEK-FILE-ID)
  8110*        SET      (ADDRESS OF CHECK-RECORDS)
  8111*        RIDFLD   (PI-ERCHEK-KEY)
  8112*        UPDATE
  8113*        resp     (ws-response)
  8114*    END-EXEC
  8115*    MOVE '&"S        EU         (  N#00007466' TO DFHEIV0
  8116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8117     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8118     MOVE X'204E233030303037343636' TO DFHEIV0(25:11)
  8119     CALL 'kxdfhei1' USING DFHEIV0,
  8120           ERCHEK-FILE-ID,
  8121           DFHEIV20,
  8122           DFHEIV99,
  8123           PI-ERCHEK-KEY,
  8124           DFHEIV99,
  8125           DFHEIV99,
  8126           DFHEIV99
  8127     SET ADDRESS OF CHECK-RECORDS TO
  8128         DFHEIV20
  8129     MOVE EIBRESP  TO ws-response
  8130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8131     if (ch-in-limbo or ch-approv-pending)
  8132        and (ch-void-dt = low-values)
  8133        and (ch-check-written-dt = low-values)
  8134        and (ch-credit-accept-dt = low-values)
  8135        perform 3500-check-tbl   thru 3500-exit
  8136        if (row-deleted and tbl-commited)
  8137*          or (emi-error = er-3450)
  8138
  8139* exec cics delete
  8140*             dataset   (erchek-file-id)
  8141*          end-exec
  8142*    MOVE '&(                    &   #00007480' TO DFHEIV0
  8143     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8144     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8145     MOVE X'2020233030303037343830' TO DFHEIV0(25:11)
  8146     CALL 'kxdfhei1' USING DFHEIV0,
  8147           erchek-file-id,
  8148           DFHEIV99,
  8149           DFHEIV99,
  8150           DFHEIV99,
  8151           DFHEIV99
  8152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8153           move spaces to pi-check-cut
  8154        end-if
  8155     else
  8156        move -1               to maintl
  8157        move er-3452          to emi-error
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 144
* EL677.cbl
  8158        move al-uabon         to mainta
  8159        perform 9900-error-format
  8160                                 thru 9900-exit
  8161        go to 8200-send-dataonly
  8162     end-if
  8163     if pi-chek-rec-cnt = +1
  8164        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8165                                 THRU 6200-EXIT
  8166        if resp-normal
  8167           MOVE ' '              TO PB-C-REFUND-SW
  8168           perform 6210-rewrite-pndb
  8169                                 thru 6210-exit
  8170        end-if
  8171     end-if
  8172     MOVE ER-0000            TO EMI-ERROR
  8173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8174     MOVE LOW-VALUES             TO EL677AI.
  8175     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8176     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8177     MOVE PI-CHEK-STATE          TO STATEO.
  8178     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8179     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8180     MOVE SPACE                  TO DC-OPTION-CODE.
  8181     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8182     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8183     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8184     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8185     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8186     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8187                                    ACCTA   EFFDTA
  8188                                    CERTNOA   SFXA.
  8189     MOVE AL-UNNON               TO SEQA.
  8190     GO TO 8100-SEND-INITIAL-MAP
  8191     .
  8192 3400-exit.
  8193     exit.
  8194 3500-check-tbl.
  8195     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8196     if sqlcode = 0
  8197        perform 4200-get-tbl-row thru 4200-exit
  8198     end-if
  8199      if sqlcode = 0
  8200         if (nu-app-date = -1)
  8201            or (db-app-status = '2')
  8202            perform 4250-delete-row thru 4250-exit
  8203         else
  8204           MOVE ER-3452            TO  EMI-ERROR
  8205           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8206           MOVE -1                 TO  PFENTERL
  8207           GO TO 8200-SEND-DATAONLY
  8208        end-if
  8209      else
  8210         MOVE ER-3450            TO  EMI-ERROR
  8211         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8212         MOVE -1                 TO  PFENTERL
  8213*        GO TO 8200-SEND-DATAONLY
  8214      end-if
  8215     if connected-to-db
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 145
* EL677.cbl
  8216        perform 4300-FINISH-UP-DB thru 4300-exit
  8217     end-if
  8218     .
  8219 3500-exit.
  8220     exit.
  8221 3900-RECORD-NOTFND.
  8222     MOVE ER-2908                TO EMI-ERROR.
  8223     MOVE -1                     TO CARRIERL
  8224     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8225                                    ACCTA     EFFDTA  CERTNOA
  8226                                    SFXA      SEQA.
  8227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8228     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 146
* EL677.cbl
  8230 4000-ADD-CHANGE.
  8231     IF PAYTO1L NOT = ZEROS
  8232        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8233     END-IF
  8234
  8235     IF PAYTO2L NOT = ZEROS
  8236         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8237
  8238     IF PAYAD1L NOT = ZEROS
  8239         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8240
  8241     IF PAYAD2L NOT = ZEROS
  8242         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8243
  8244     IF PAYctyL NOT = ZEROS
  8245         MOVE payctyi            TO CH-PAYEE-CITY.
  8246
  8247     IF PAYstL NOT = ZEROS
  8248         MOVE paysti            TO CH-PAYEE-state.
  8249
  8250     IF PAYEEI GREATER SPACES
  8251        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8252
  8253     IF PTOZIPL  =  ZEROS
  8254         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8255         GO TO 4000-CK-REST.
  8256
  8257     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8258
  8259     IF NOT WS-CANADIAN-POST-CODE
  8260         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8261         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8262         GO TO 4000-CK-REST.
  8263
  8264     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8265     IF WS-CAN-POST-4TH = SPACE OR '-'
  8266         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8267         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8268     ELSE
  8269         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8270         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8271
  8272 4000-CK-REST.
  8273
  8274     IF RETTOL NOT = ZEROS
  8275        MOVE RETTOI TO CH-RETURN-TO.
  8276     if dedcynl not = zeros
  8277        move dedcyni             to ch-deduct-commission
  8278     end-if
  8279*    if dedcynl not = zeros
  8280*       if (dedcyni = 'Y')
  8281*          or (pi-prev-ded-comm = 'Y')
  8282*          compute ws-amt =
  8283*             pi-refund-on-pending-rec -
  8284*                pi-prev-paid - pi-ue-comm
  8285*       else
  8286*          if dedcyni = 'N'
  8287*             compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 147
* EL677.cbl
  8288*                pi-refund-on-pending-rec -
  8289*                   pi-prev-paid-this-month
  8290*          end-if
  8291*       end-if
  8292*    end-if
  8293     if pi-check-type = 'C'
  8294        compute ws-amt =
  8295           pi-endt-prm-diff - pi-prev-paid
  8296        if (dedcyni = 'Y')
  8297           or (pi-prev-ded-comm = 'Y')
  8298           compute ws-amt =
  8299              ws-amt - pi-ue-comm
  8300        end-if
  8301        if ws-amt <= zeros
  8302           move pi-endt-prm-diff to ws-amt
  8303        end-if
  8304     end-if
  8305     IF AMOUNTL NOT = ZEROS
  8306         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8307         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8308
  8309     IF CHECKL NOT = ZEROS
  8310         MOVE CHECKI             TO CH-CHECK-NO.
  8311
  8312     IF REASONL NOT = ZEROS
  8313         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8314
  8315*    IF DEDAMTL NOT = ZEROS
  8316*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8317*                                   DEDAMTO.
  8318
  8319*    IF ADDLCHGL NOT = ZEROS
  8320*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8321*                                   ADDLCHGO.
  8322
  8323     IF STUBL NOT = ZEROS
  8324         MOVE STUBI              TO CH-STUB-LINE-1.
  8325
  8326     IF TEXT1L NOT = ZEROS
  8327         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8328
  8329     IF TEXT2L NOT = ZEROS
  8330         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8331
  8332     IF TEXT3L NOT = ZEROS
  8333         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8334
  8335     IF TYPEL NOT = ZEROS
  8336         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8337
  8338*    MOVE LETTER1I               TO CH-LETTERS (1).
  8339*    MOVE LETTER2I               TO CH-LETTERS (2).
  8340*    MOVE LETTER3I               TO CH-LETTERS (3).
  8341
  8342*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8343     IF CH-CHECK-ORIGIN-SW = 'R'
  8344         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8345*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 148
* EL677.cbl
  8346         MOVE PI-CANC-DT             TO CH-CANC-DT
  8347         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8348         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8349     end-if
  8350     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8351*    IF PI-AR-PROCESSING AND
  8352*       REFL NOT = ZERO
  8353*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8354
  8355 4000-EXIT.
  8356      EXIT.
  8357 4100-CONNECT-TO-DB.
  8358     move 'HOVTSTDB01_ChkApprv'  to svr
  8359     move 'appuser'              to usr
  8360     move 'appuser@cso'          to pass
  8361
  8362     if ws-kix-myenv = 'cid1p'
  8363        move 'SDVDB01_ChkApprv'  to svr
  8364        move 'appuser'           to usr
  8365        move 'appuser@cso'       to pass
  8366     end-if
  8367     string
  8368         usr delimited space
  8369         "." delimited size
  8370         pass delimited space into usr-pass
  8371     end-string
  8372     EXEC SQL
  8373        CONNECT TO :svr USER :usr-pass
  8374     END-EXEC
  8375     if sqlcode not = 0
  8376        display "Error: cannot connect "
  8377        display sqlcode
  8378        display sqlerrmc
  8379     end-if
  8380     set connected-to-db to true
  8381     .
  8382 4100-EXIT.
  8383     EXIT.
  8384 4200-get-tbl-row.
  8385***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8386***                                                            ***
  8387***  I'm only expecting one row so no cursor is declared       ***
  8388***                                                            ***
  8389***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8390     move pi-company-id          to ws-compid
  8391     move ch-carrier             to ws-carrier
  8392     move ch-grouping            to ws-grouping
  8393     move ch-state               to ws-state
  8394     move ch-account             to ws-account
  8395     move ch-cert-eff-dt         to dc-bin-date-1
  8396     move ' '                    to dc-option-code
  8397     perform 8500-date-convert   thru 8500-exit
  8398     if no-conversion-error
  8399        move dc-greg-date-a-edit to ws-eff-date
  8400     end-if
  8401     move ch-cert-prime          to ws-certificate
  8402     move ch-cert-sfx            to ws-cert-sfx
  8403     move ch-sequence-no         to ws-seq-no
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 149
* EL677.cbl
  8404     move '1'                    to ws-type
  8405                                    ws-check-sub-type
  8406     if pi-check-type = 'C'
  8407        move '2'                 to ws-check-sub-type
  8408     end-if
  8409     exec sql
  8410        SELECT
  8411           ApprovalStatus,
  8412           MaintainedBy,
  8413           MaintainedDate,
  8414           ApprovalBatch
  8415        INTO
  8416           :db-app-status :nu-app-status,
  8417           :db-app-by :nu-app-by,
  8418           :db-app-date :nu-app-date,
  8419           :db-app-batch :nu-app-batch
  8420        FROM
  8421           ChkApp_Check
  8422        WHERE
  8423           Company           = :ws-compid
  8424           and CertCarrier   = :ws-carrier
  8425           and CertGroup     = :ws-grouping
  8426           and CertState     = :ws-state
  8427           and CertAccount   = :ws-account
  8428           and CertEffDate   = :ws-eff-date
  8429           and CertNumber    = :ws-certificate
  8430           and CertNumberSuf = :ws-cert-sfx
  8431           and CheckSeqNbr   = :ws-seq-no
  8432           and CheckType     = :ws-type
  8433           and CheckSubType  = :ws-check-sub-type
  8434     end-exec
  8435     if sqlcode not = 0
  8436        display "Error: cannot read row "
  8437        display ' sql return code ' sqlcode
  8438        display ' sql err mess    ' sqlerrmc
  8439        go to 4200-exit
  8440     end-if
  8441*    display ' status ' db-app-status
  8442*    display ' by     ' db-app-by
  8443*    display ' date   ' db-app-date
  8444*    display ' batch  ' db-app-batch
  8445*    if nu-app-date = -1
  8446*       display ' approval date is low-values '
  8447*    else
  8448*       display ' approval date is NOT low values '
  8449*    end-if
  8450     .
  8451 4200-exit.
  8452     exit.
  8453 4250-delete-row.
  8454     EXEC SQL
  8455        DELETE
  8456           from ChkApp_Check
  8457        WHERE
  8458           Company           = :ws-compid
  8459           and CertCarrier   = :ws-carrier
  8460           and CertGroup     = :ws-grouping
  8461           and CertState     = :ws-state
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 150
* EL677.cbl
  8462           and CertAccount   = :ws-account
  8463           and CertEffDate   = :ws-eff-date
  8464           and CertNumber    = :ws-certificate
  8465           and CertNumberSuf = :ws-cert-sfx
  8466           and CheckSeqNbr   = :ws-seq-no
  8467           and CheckType     = :ws-type
  8468           and CheckSubType  = :ws-check-sub-type
  8469     END-EXEC
  8470     if sqlcode not = 0
  8471        display "Error: cannot delete row  "
  8472        display ' sql retrun code ' sqlcode
  8473        display ' sql err mess    ' sqlerrmc
  8474        go to 4250-exit
  8475     end-if
  8476     set row-deleted         to true
  8477     EXEC SQL
  8478         commit transaction
  8479     END-EXEC
  8480     if sqlcode not = 0
  8481        display "Error: commit "
  8482        display ' sql return code ' sqlcode
  8483        display ' sql err mess    ' sqlerrmc
  8484        go to 4250-exit
  8485     end-if
  8486     set tbl-commited to true
  8487     .
  8488 4250-exit.
  8489     exit.
  8490 4300-FINISH-UP-DB.
  8491     EXEC SQL
  8492         commit work release
  8493     END-EXEC
  8494     if sqlcode not = 0
  8495        display "Error: commit release "
  8496        display ' sql return code ' sqlcode
  8497        display ' sql err mess    ' sqlerrmc
  8498     end-if
  8499     .
  8500 4300-EXIT.
  8501     EXIT.
  8502 5000-BROWSE-FILE.
  8503
  8504* EXEC CICS HANDLE CONDITION
  8505*        NOTFND   (5560-END-OF-FILE)
  8506*        ENDFILE  (5560-END-OF-FILE)
  8507*    END-EXEC.
  8508*    MOVE '"$I''                  ! , #00007833' TO DFHEIV0
  8509     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8511     MOVE X'2C20233030303037383333' TO DFHEIV0(25:11)
  8512     CALL 'kxdfhei1' USING DFHEIV0
  8513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8514
  8515
  8516     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8517
  8518     IF SEQI = LOW-VALUES
  8519         MOVE +1                 TO CHEK-RECORD-SEQ.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 151
* EL677.cbl
  8520
  8521     IF EIBAID = DFHPF2
  8522         GO TO 5100-BROWSE-BKWD.
  8523
  8524 5010-READ-LOOP.
  8525     IF EIBAID = DFHPF1
  8526         ADD +1                  TO CHEK-RECORD-SEQ.
  8527
  8528
  8529* EXEC CICS READ
  8530*        DATASET  (ERCHEK-FILE-ID)
  8531*        SET      (ADDRESS OF CHECK-RECORDS)
  8532*        RIDFLD   (ERCHEK-KEY)
  8533*        GTEQ
  8534*    END-EXEC.
  8535*    MOVE '&"S        G          (   #00007850' TO DFHEIV0
  8536     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8538     MOVE X'2020233030303037383530' TO DFHEIV0(25:11)
  8539     CALL 'kxdfhei1' USING DFHEIV0,
  8540           ERCHEK-FILE-ID,
  8541           DFHEIV20,
  8542           DFHEIV99,
  8543           ERCHEK-KEY,
  8544           DFHEIV99,
  8545           DFHEIV99,
  8546           DFHEIV99
  8547     SET ADDRESS OF CHECK-RECORDS TO
  8548         DFHEIV20
  8549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8550
  8551
  8552     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8553         IF EIBAID = DFHENTER
  8554             GO TO 5550-NO-RECORD
  8555         ELSE
  8556             GO TO 5560-END-OF-FILE.
  8557
  8558        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8559           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8560           PI-CHEK-STATE      = CH-STATE       AND
  8561           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8562           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8563           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8564           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8565              GO TO 5500-FORMAT-SCREEN
  8566            ELSE
  8567              IF EIBAID = DFHPF1
  8568                  GO TO 5560-END-OF-FILE
  8569                ELSE
  8570                  GO TO 5550-NO-RECORD.
  8571
  8572     IF EIBAID = DFHENTER
  8573        IF CHEK-CARRIER    = CH-CARRIER     AND
  8574           CHEK-GROUPING   = CH-GROUPING    AND
  8575           CHEK-STATE      = CH-STATE       AND
  8576           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8577           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 152
* EL677.cbl
  8578           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8579           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8580           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8581              GO TO 5500-FORMAT-SCREEN
  8582        ELSE
  8583              GO TO 5550-NO-RECORD.
  8584
  8585     GO TO 5500-FORMAT-SCREEN.
  8586
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 153
* EL677.cbl
  8588
  8589 5100-BROWSE-BKWD.
  8590
  8591* EXEC CICS STARTBR
  8592*        DATASET  (ERCHEK-FILE-ID)
  8593*        RIDFLD   (ERCHEK-KEY)
  8594*    END-EXEC.
  8595     MOVE 0
  8596       TO DFHEIV11
  8597*    MOVE '&,         G          &   #00007895' TO DFHEIV0
  8598     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8599     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8600     MOVE X'2020233030303037383935' TO DFHEIV0(25:11)
  8601     CALL 'kxdfhei1' USING DFHEIV0,
  8602           ERCHEK-FILE-ID,
  8603           ERCHEK-KEY,
  8604           DFHEIV99,
  8605           DFHEIV11,
  8606           DFHEIV99
  8607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8608
  8609
  8610
  8611* EXEC CICS READPREV
  8612*        DATASET  (ERCHEK-FILE-ID)
  8613*        SET      (ADDRESS OF CHECK-RECORDS)
  8614*        RIDFLD   (ERCHEK-KEY)
  8615*    END-EXEC.
  8616     MOVE 0
  8617       TO DFHEIV11
  8618*    MOVE '&0S                   )   #00007900' TO DFHEIV0
  8619     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8620     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8621     MOVE X'2020233030303037393030' TO DFHEIV0(25:11)
  8622     CALL 'kxdfhei1' USING DFHEIV0,
  8623           ERCHEK-FILE-ID,
  8624           DFHEIV20,
  8625           DFHEIV99,
  8626           ERCHEK-KEY,
  8627           DFHEIV99,
  8628           DFHEIV11,
  8629           DFHEIV99,
  8630           DFHEIV99
  8631     SET ADDRESS OF CHECK-RECORDS TO
  8632         DFHEIV20
  8633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8634
  8635
  8636 5110-READ-LOOP.
  8637     IF PI-FILE-EOF
  8638         MOVE SPACE              TO PI-EOF-SW
  8639     ELSE
  8640
  8641* EXEC CICS READPREV
  8642*            DATASET  (ERCHEK-FILE-ID)
  8643*            SET      (ADDRESS OF CHECK-RECORDS)
  8644*            RIDFLD   (ERCHEK-KEY)
  8645*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 154
* EL677.cbl
  8646     MOVE 0
  8647       TO DFHEIV11
  8648*    MOVE '&0S                   )   #00007910' TO DFHEIV0
  8649     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8650     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8651     MOVE X'2020233030303037393130' TO DFHEIV0(25:11)
  8652     CALL 'kxdfhei1' USING DFHEIV0,
  8653           ERCHEK-FILE-ID,
  8654           DFHEIV20,
  8655           DFHEIV99,
  8656           ERCHEK-KEY,
  8657           DFHEIV99,
  8658           DFHEIV11,
  8659           DFHEIV99,
  8660           DFHEIV99
  8661     SET ADDRESS OF CHECK-RECORDS TO
  8662         DFHEIV20
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8664
  8665
  8666     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8667         GO TO 5560-END-OF-FILE.
  8668
  8669        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8670           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8671           PI-CHEK-STATE      = CH-STATE       AND
  8672           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8673           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8674           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8675           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8676              GO TO 5500-FORMAT-SCREEN
  8677            ELSE
  8678              GO TO 5560-END-OF-FILE.
  8679
  8680     GO TO 5500-FORMAT-SCREEN.
  8681
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 155
* EL677.cbl
  8683*                          COPY ELCNPD.
  8684*****************************************************************
  8685*                                                               *
  8686*                                                               *
  8687*                            ELCNPD                             *
  8688*                            VMOD=2.001                         *
  8689*****************************************************************
  8690
  8691 5200-MOVE-NAME.
  8692*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8693*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8694*            BLANKS.                                            *
  8695*                                                               *
  8696*                  FIELD               VALUE                    *
  8697*                                                               *
  8698*                LAST NAME (CL15)      SMITH                    *
  8699*                1ST NAME  (CL12)      JOHN                     *
  8700*                MID NAME  (CL1)       A                        *
  8701*                                                               *
  8702*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8703*         *                                                     *
  8704*         *              JOHN A. SMITH                          *
  8705*         *                                                     *
  8706*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8707*         *  STORAGE COPYBOOK:                                  *
  8708*         *                                                     *
  8709*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8710*         *******************************************************.
  8711
  8712     MOVE SPACES                 TO  WS-NAME-WORK
  8713                                     WS-NAME-WORK2.
  8714     MOVE ZERO                   TO  WS-NAME-SW.
  8715     SET NWA-INDEX TO +1.
  8716
  8717     IF WS-INSURED-1ST-NAME = SPACES  AND
  8718        WS-INSURED-MID-INIT = SPACES
  8719         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8720         GO TO 5200-EXIT.
  8721
  8722     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8723     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8724
  8725     SET NWA-INDEX UP BY +1
  8726     IF WS-INSURED-MID-INIT NOT = SPACES
  8727        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8728        SET NWA-INDEX UP BY +1
  8729        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8730        SET NWA-INDEX UP BY +2.
  8731
  8732     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8733     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8734
  8735
  8736 5200-EXIT.
  8737     EXIT.
  8738
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 156
* EL677.cbl
  8740 5300-MOVE-NAME SECTION.
  8741     IF WS-NAME-SW GREATER THAN +1
  8742         GO TO 5390-EXIT.
  8743
  8744     IF WS-NAME-WORK2 = SPACES
  8745         GO TO 5390-EXIT.
  8746
  8747     SET NWA-INDEX2 TO +1.
  8748     SET NWA-INDEX3 TO +2.
  8749
  8750 5310-MOVE-NAME.
  8751     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8752
  8753     IF NWA-INDEX LESS THAN +30
  8754        SET NWA-INDEX UP BY +1
  8755     ELSE
  8756        ADD +2  TO  WS-NAME-SW
  8757        GO TO 5390-EXIT.
  8758
  8759     IF NWA-INDEX2 LESS THAN +20
  8760         SET NWA-INDEX2 UP BY +1
  8761         SET NWA-INDEX3 UP BY +1.
  8762
  8763     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8764        WS-NW2 (NWA-INDEX3) = SPACES
  8765        GO TO 5390-EXIT.
  8766
  8767     GO TO 5310-MOVE-NAME.
  8768
  8769 5390-EXIT.
  8770     EXIT.
  8771
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 157
* EL677.cbl
  8774 5500-FORMAT-SCREEN.
  8775     MOVE LOW-VALUES             TO  EL677AI.
  8776     if pi-void-reissue-pass = '1'
  8777        move 'R'                 to mainti
  8778                                    pi-prev-maint
  8779     else
  8780        MOVE 'S'                 TO MAINTI
  8781                                    PI-PREV-MAINT
  8782     end-if
  8783     MOVE +1                     TO  MAINTL.
  8784     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8785     MOVE CH-CARRIER             TO  CARRIERO.
  8786     MOVE CH-GROUPING            TO  GROUPO.
  8787     MOVE CH-STATE               TO  STATEO.
  8788     MOVE CH-ACCOUNT             TO  ACCTO.
  8789
  8790     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8791     MOVE SPACE                  TO  DC-OPTION-CODE.
  8792     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8793     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8794
  8795     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8796     MOVE CH-CERT-SFX            TO  SFXO.
  8797     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8798
  8799     MOVE AL-UANON               TO  CARRIERA
  8800                                     GROUPA
  8801                                     STATEA
  8802                                     ACCTA
  8803                                     EFFDTA
  8804                                     CERTNOA
  8805                                     SFXA.
  8806     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8807
  8808     if ch-approval-dt not = low-values
  8809        move ch-approval-dt      to dc-bin-date-1
  8810        move ' '                 to dc-option-code
  8811        perform 8500-date-convert thru 8500-exit
  8812        move dc-greg-date-1-edit to apvdto
  8813     end-if
  8814     evaluate ch-approval-status
  8815        when '2'
  8816           move 'PENDING '       TO APVSTATO
  8817        when 'P'
  8818           move 'PENDING '       TO APVSTATO
  8819        when 'A'
  8820           move 'APPROVED'       to apvstato
  8821        when 'D'
  8822           move 'DENIED'         to apvstato
  8823     end-evaluate
  8824     move ch-approved-by         to apvbyo
  8825*    IF PI-COMPANY-ID = 'TMS'
  8826*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8827*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8828*    ELSE
  8829         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8830         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8831
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 158
* EL677.cbl
  8832     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8833     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8834     move ch-payee-city          to payctyo
  8835     move ch-payee-state         to paysto
  8836     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8837
  8838     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8839         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8840         MOVE AL-UANON           TO  PTOZIPA.
  8841
  8842     MOVE CH-RETURN-TO           TO  RETTOO
  8843*    if ch-check-cashed-dt not = spaces and low-values
  8844*       move ch-check-cashed-dt  to dc-bin-date-1
  8845*       MOVE SPACE               TO  DC-OPTION-CODE
  8846*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8847*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8848*    end-if
  8849     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8850     MOVE SPACE                  TO  DC-OPTION-CODE.
  8851     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8852     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8853
  8854     MOVE CH-RECORDED-BY         TO  CBYO.
  8855
  8856     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8857         NEXT SENTENCE
  8858     ELSE
  8859         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8860         MOVE SPACE                  TO  DC-OPTION-CODE
  8861         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8862         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8863         MOVE CH-VOID-BY             TO  VBYO.
  8864
  8865     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8866         NEXT SENTENCE
  8867     ELSE
  8868         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8869         MOVE SPACE                  TO  DC-OPTION-CODE
  8870         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8871         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8872
  8873     MOVE CH-AMOUNT-PAID         TO  AMOUNTO
  8874                                     pi-void-reissue-amt
  8875     MOVE AL-SANOF               TO  AMOUNTA.
  8876     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8877     MOVE AL-SANOF               TO  TYPEA.
  8878     MOVE CH-CHECK-NO            TO  CHECKO.
  8879     move ch-deduct-commission   to dedcyno
  8880     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8881     MOVE CH-VOID-REASON         TO  VREASONO.
  8882
  8883     MOVE CH-STUB-LINE-1         TO  STUBO.
  8884     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8885     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8886     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8887     IF CH-LF-REFUND NOT NUMERIC
  8888         MOVE ZEROS              TO CH-LF-REFUND.
  8889     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 159
* EL677.cbl
  8890         MOVE ZEROS              TO CH-AH-REFUND.
  8891     if (ch-check-no not = spaces and low-values)
  8892        and (ch-check-written-dt not = low-values)
  8893        perform 5800-fetch-check-cashed-dt
  8894                                 thru 5800-exit
  8895     end-if
  8896     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
  8897        CH-VOID-DT          GREATER LOW-VALUES
  8898        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8899                                     STUBA     TEXT1A   TEXT2A
  8900                                     TEXT3A    PAYTO1A  SFXA
  8901                                     PAYTO2A   PAYAD1A  PAYctyA
  8902                                     paysta    RETTOA   PAYAD2A
  8903                                     PTOZIPA
  8904                                     PRINTEDA
  8905     ELSE
  8906        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8907                                     ACCTA     EFFDTA   CERTNOA
  8908                                     CHECKA    REASONA  VREASONA
  8909                                     STUBA     TEXT1A   TEXT2A
  8910                                     TEXT3A    PAYTO1A  SFXA
  8911                                     PAYTO2A   PAYAD1A  PAYctyA
  8912                                     paysta    RETTOA   PAYAD2A
  8913                                     PRINTEDA.
  8914
  8915     MOVE AL-UNNON               TO SEQA.
  8916     perform 5600-get-erpndb     thru 5600-exit
  8917     perform 5700-get-elcert     thru 5700-exit
  8918*    move pi-prev-paid           to prepdo
  8919     move al-sadof               to drefa
  8920*    if WS-PNDB-FOUND
  8921*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8922*    end-if
  8923     if WS-CERT-FOUND
  8924        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8925           cm-lf-alt-premium-amt
  8926        compute ws-tot-iss-prem  =
  8927           cm-ah-premium-amt + ws-tot-lf-prem
  8928        compute ws-tot-iss-comm =
  8929           (ws-tot-lf-prem * cm-life-comm-pct) +
  8930           (cm-ah-premium-amt * cm-ah-comm-pct)
  8931        compute ws-tot-ref-comm =
  8932           (pi-lf-refund * cm-life-comm-pct) +
  8933           (pi-ah-refund * cm-ah-comm-pct)
  8934        move ws-tot-iss-prem     to premo
  8935        move ws-tot-iss-comm     to isscommo
  8936*       move ws-tot-ref-comm     to uecommo
  8937     end-if
  8938     if PI-TO-EL677-FROM-EL1273
  8939        move zeros               to premo
  8940                                    isscommo
  8941                                    uecommo
  8942                                    prepdo
  8943                                    refo
  8944     end-if
  8945     GO TO 8100-SEND-INITIAL-MAP
  8946     .
  8947 5550-NO-RECORD.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 160
* EL677.cbl
  8948     MOVE ER-1162                TO  EMI-ERROR.
  8949     MOVE -1                     TO  CARRIERL.
  8950     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8951                                     ACCTA     EFFDTA  CERTNOA
  8952                                     SFXA      SEQA.
  8953     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8954
  8955     IF (NOT PI-TO-EL677-FROM-EL1273)
  8956        and (pi-return-to-program not = 'EL6315')
  8957         GO TO 8200-SEND-DATAONLY.
  8958
  8959     MOVE CHEK-CARRIER           TO  CARRIERO.
  8960     MOVE CHEK-GROUPING          TO  GROUPO.
  8961     MOVE CHEK-STATE             TO  STATEO.
  8962     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8963
  8964     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8965     MOVE SPACE                  TO  DC-OPTION-CODE.
  8966     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8967     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8968
  8969     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8970     MOVE CHEK-SUF-NO            TO  SFXO.
  8971     GO TO 8100-SEND-INITIAL-MAP.
  8972
  8973 5560-END-OF-FILE.
  8974     IF EIBAID = DFHPF1
  8975         MOVE 'Y'                TO  PI-EOF-SW
  8976         MOVE ER-2237            TO  EMI-ERROR
  8977     ELSE
  8978     IF EIBAID = DFHENTER
  8979        GO TO 5550-NO-RECORD
  8980     ELSE
  8981*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8982         MOVE ER-2238            TO  EMI-ERROR.
  8983
  8984     MOVE -1                     TO  MAINTL.
  8985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8986     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 161
* EL677.cbl
  8988 5600-get-erpndb.
  8989     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8990     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8991     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8992     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8993     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8994     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8995     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8996     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8997     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8998     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8999     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  9000     IF ST-ACCNT-CNTL  OR
  9001        ACCNT-CNTL
  9002          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9003     IF ST-ACCNT-CNTL      OR
  9004        CARR-ST-ACCNT-CNTL OR
  9005        ACCNT-CNTL         OR
  9006        CARR-ACCNT-CNTL
  9007          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9008     IF ACCNT-CNTL OR
  9009        CARR-ACCNT-CNTL
  9010          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9011
  9012* EXEC CICS READ
  9013*         DATASET   (ERPNDB-ALT-FILE-ID)
  9014*         SET       (ADDRESS OF PENDING-BUSINESS)
  9015*         RIDFLD    (ERPNDB-ALT-KEY)
  9016*         resp      (ws-response)
  9017*    END-EXEC
  9018*    MOVE '&"S        E          (  N#00008261' TO DFHEIV0
  9019     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9021     MOVE X'204E233030303038323631' TO DFHEIV0(25:11)
  9022     CALL 'kxdfhei1' USING DFHEIV0,
  9023           ERPNDB-ALT-FILE-ID,
  9024           DFHEIV20,
  9025           DFHEIV99,
  9026           ERPNDB-ALT-KEY,
  9027           DFHEIV99,
  9028           DFHEIV99,
  9029           DFHEIV99
  9030     SET ADDRESS OF PENDING-BUSINESS TO
  9031         DFHEIV20
  9032     MOVE EIBRESP  TO ws-response
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9034     if resp-normal
  9035        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9036        compute pi-refund-on-pending-rec =
  9037           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9038     end-if
  9039     .
  9040 5600-exit.
  9041     exit.
  9042 5700-get-elcert.
  9043     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9044     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9045     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 162
* EL677.cbl
  9046     MOVE PI-STATE               TO  ELCERT-STATE.
  9047     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9048     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9049     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9050     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9051     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9052
  9053* EXEC CICS READ
  9054*         DATASET   (ELCERT-FILE-ID)
  9055*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9056*         RIDFLD    (ELCERT-KEY)
  9057*         resp      (ws-response)
  9058*    END-EXEC
  9059*    MOVE '&"S        E          (  N#00008285' TO DFHEIV0
  9060     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9062     MOVE X'204E233030303038323835' TO DFHEIV0(25:11)
  9063     CALL 'kxdfhei1' USING DFHEIV0,
  9064           ELCERT-FILE-ID,
  9065           DFHEIV20,
  9066           DFHEIV99,
  9067           ELCERT-KEY,
  9068           DFHEIV99,
  9069           DFHEIV99,
  9070           DFHEIV99
  9071     SET ADDRESS OF CERTIFICATE-MASTER TO
  9072         DFHEIV20
  9073     MOVE EIBRESP  TO ws-response
  9074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9075     if resp-normal
  9076        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9077     end-if
  9078     .
  9079 5700-exit.
  9080     exit.
  9081 5800-fetch-check-cashed-dt.
  9082     move ' '                    to ws-connect-sw
  9083                                    ws-match-sw
  9084                                    pi-check-cashed
  9085     move 'NTCSO2_PdBnkInfo'     to svr
  9086     move 'sa'                   to usr
  9087     move 'ntcso2'               to pass
  9088     string
  9089         usr delimited space
  9090         "." delimited size
  9091         pass delimited space into usr-pass
  9092     end-string
  9093     EXEC SQL
  9094        CONNECT TO :svr USER :usr-pass
  9095     END-EXEC
  9096     if sqlcode not = 0
  9097        display "Error: cannot connect to pdbnkinfo "
  9098        display sqlcode
  9099        display sqlerrmc
  9100        go to 5800-exit
  9101     end-if
  9102     set connected-to-db to true
  9103     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 163
* EL677.cbl
  9104        move 'CSO - AP%'         to ws-pb-compid
  9105     else
  9106        move 'AHL - AP%'         to ws-pb-compid
  9107     end-if
  9108     move '000'                  to ws-pb-check-no (1:3)
  9109     move ch-check-no            to ws-pb-check-no (4:7)
  9110     move spaces                 to ws-pb-bad-check-no
  9111     perform varying s1 from +1 by +1 until
  9112        (s1 > +10)
  9113        or (ws-pb-check-no (s1:1) not = '0')
  9114     end-perform
  9115     if s1 < +11
  9116        move ws-pb-check-no (s1:11 - s1)
  9117                            to ws-pb-bad-check-no (1: 11 - s1)
  9118     end-if
  9119*    display ' compid **' ws-pb-compid '**'
  9120*    display ' ckno  **' ws-pb-check-no '**'
  9121     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9122     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9123     MOVE SPACES              TO pb-paid-date
  9124
  9125     EXEC SQL
  9126        CALL pbi_GetCashDate_by_TransactionNbr
  9127           @compid          = :ws-pb-compid,
  9128           @checkno         = :ws-pb-check-no,
  9129           @badcheckno      = :ws-pb-bad-check-no,
  9130           @checkamount     = :ws-check-amount,
  9131           @checkcasheddate = :pb-paid-date :nu-app-date OUT
  9132     END-EXEC
  9133     if sqlcode not = 0
  9134        display "Error: cannot run stor proc  "
  9135        move sqlcode            to ws-sql-code
  9136        move ws-sql-code to ws-dis-sql-code
  9137        display ' dis sql code ' ws-dis-sql-code
  9138        display ' sql return code ' sqlcode
  9139        display ' sql err mess    ' sqlerrmc
  9140        go to 5800-disconnect
  9141     end-if
  9142     if nu-app-date = -1 *> no check cashed date
  9143        go to 5800-disconnect
  9144     end-if
  9145***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9146***                                                            ***
  9147***  The following code works just as well as the above        ***
  9148***  stored procedure and just as fast.                        ***
  9149***  Originally, I had declared a cursor and fetched through   ***
  9150***  the record set to find the correct check and that REALLY  ***
  9151***  slowed the response down to ~ 3/4 second.                 ***
  9152***                                                            ***
  9153***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9154*     EXEC SQL
  9155*        SELECT
  9156*           PaidDate
  9157*        INTO
  9158*           :pb-paid-date
  9159*        FROM
  9160*           dbo.cso_pbi_TransactionLookup
  9161*        WHERE
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 164
* EL677.cbl
  9162*           (BankAcctDescr like :ws-pb-compid)
  9163*           and (Amount = :ws-check-amount)
  9164*           and ((transactionNbr = :ws-pb-check-no)
  9165*                  or
  9166*               (transactionnbr = :ws-pb-bad-check-no))
  9167**          and (CAST(TransactionNbr AS INT) =
  9168**             :ws-pb-check-no-num)
  9169**          and (right('00000' + rtrim(TransactionNbr),10)
  9170**             = :ws-pb-check-no)
  9171**          and (TransactionNbr  = :ws-pb-check-no)
  9172*     END-EXEC
  9173*    display ' chkno  ' pb-check-no
  9174*    display ' desc   ' pb-bank-acct-desc
  9175*    display ' trn typ' pb-tran-type
  9176*    display ' amt   *' pb-amount '**'
  9177*    display ' pd dte ' pb-paid-date
  9178     string pb-paid-date (1:4)
  9179            pb-paid-date (6:2)
  9180            pb-paid-date (9:2)
  9181        delimited by size into dc-greg-date-cymd-r
  9182     end-string
  9183     move 'L'                    to dc-option-code
  9184     perform 8500-date-convert   thru 8500-exit
  9185     if no-conversion-error
  9186*       move dc-bin-date-1       to ws-bin-cashed-dt
  9187        move dc-greg-date-1-edit to cashedo
  9188        move 'Y' to pi-check-cashed
  9189     else
  9190        display ' error cvtdte cash dt ' pb-paid-date ' '
  9191           dc-error-code
  9192     end-if
  9193     .
  9194 5800-disconnect.
  9195     EXEC SQL
  9196        DISCONNECT ALL
  9197     END-EXEC
  9198     if sqlcode not = 0
  9199        display "Error: cannot disconnect pdbnk "
  9200        display ' sql return code ' sqlcode
  9201        display ' sql err mess    ' sqlerrmc
  9202     end-if
  9203     .
  9204 5800-exit.
  9205     exit.
  9206 6000-VERIFY-COMP-MASTER.
  9207
  9208* EXEC CICS HANDLE CONDITION
  9209*        NOTFND   (6070-NO-COMP-MSTR)
  9210*    END-EXEC.
  9211*    MOVE '"$I                   ! - #00008423' TO DFHEIV0
  9212     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9214     MOVE X'2D20233030303038343233' TO DFHEIV0(25:11)
  9215     CALL 'kxdfhei1' USING DFHEIV0
  9216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9217
  9218
  9219     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 165
* EL677.cbl
  9220
  9221     IF NOT PI-ZERO-CARRIER AND
  9222        NOT PI-ZERO-CAR-GROUP
  9223         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9224     ELSE
  9225         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9226
  9227     IF NOT PI-ZERO-GROUPING  AND
  9228        NOT PI-ZERO-CAR-GROUP
  9229         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9230     ELSE
  9231         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9232
  9233     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9234     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9235     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9236
  9237
  9238* EXEC CICS READ
  9239*         DATASET   (ERCOMP-FILE-ID)
  9240*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9241*         RIDFLD    (ERCOMP-KEY)
  9242*     END-EXEC.
  9243*    MOVE '&"S        E          (   #00008445' TO DFHEIV0
  9244     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9246     MOVE X'2020233030303038343435' TO DFHEIV0(25:11)
  9247     CALL 'kxdfhei1' USING DFHEIV0,
  9248           ERCOMP-FILE-ID,
  9249           DFHEIV20,
  9250           DFHEIV99,
  9251           ERCOMP-KEY,
  9252           DFHEIV99,
  9253           DFHEIV99,
  9254           DFHEIV99
  9255     SET ADDRESS OF COMPENSATION-MASTER TO
  9256         DFHEIV20
  9257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9258
  9259
  9260     GO TO 6090-EXIT.
  9261
  9262 6070-NO-COMP-MSTR.
  9263     MOVE -1                     TO  CARRIERL.
  9264     MOVE ER-2230                TO  EMI-ERROR.
  9265     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9266     GO TO 8200-SEND-DATAONLY.
  9267
  9268 6090-EXIT.
  9269      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 166
* EL677.cbl
  9271 6100-VERIFY-CERTIFICATE.
  9272
  9273* EXEC CICS HANDLE CONDITION
  9274*        NOTFND   (6170-NO-CERTIFICATE)
  9275*    END-EXEC.
  9276*    MOVE '"$I                   ! . #00008463' TO DFHEIV0
  9277     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9279     MOVE X'2E20233030303038343633' TO DFHEIV0(25:11)
  9280     CALL 'kxdfhei1' USING DFHEIV0
  9281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9282
  9283
  9284     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9285     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9286     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9287     MOVE PI-STATE               TO  ELCERT-STATE.
  9288     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9289     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9290     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9291     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9292
  9293     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9294
  9295     MOVE SPACES                 TO  PI-REFERENCE
  9296*                                    PI-INSURED-NAME.
  9297     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9298*    MOVE ZEROS                  TO  PI-LF-REFUND
  9299*                                    PI-AH-REFUND.
  9300
  9301
  9302* EXEC CICS READ
  9303*         DATASET   (ELCERT-FILE-ID)
  9304*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9305*         RIDFLD    (ELCERT-KEY)
  9306*     END-EXEC.
  9307*    MOVE '&"S        E          (   #00008484' TO DFHEIV0
  9308     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9310     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  9311     CALL 'kxdfhei1' USING DFHEIV0,
  9312           ELCERT-FILE-ID,
  9313           DFHEIV20,
  9314           DFHEIV99,
  9315           ELCERT-KEY,
  9316           DFHEIV99,
  9317           DFHEIV99,
  9318           DFHEIV99
  9319     SET ADDRESS OF CERTIFICATE-MASTER TO
  9320         DFHEIV20
  9321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9322
  9323
  9324     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9325
  9326*    MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9327*    MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9328     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 167
* EL677.cbl
  9329         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9330     ELSE
  9331         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9332             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9333*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9334
  9335     GO TO 6190-EXIT.
  9336
  9337 6170-NO-CERTIFICATE.
  9338     MOVE -1                     TO  CARRIERL.
  9339     MOVE ER-2726                TO  EMI-ERROR.
  9340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9341
  9342 6190-EXIT.
  9343      EXIT.
  9344
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 168
* EL677.cbl
  9346 6200-UPDATE-PENDING-BUS-REC.
  9347     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9348     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9349     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9350     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9351     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9352     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9353     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9354     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9355     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9356     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9357
  9358     IF ST-ACCNT-CNTL  OR
  9359        ACCNT-CNTL
  9360          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9361
  9362     IF ST-ACCNT-CNTL      OR
  9363        CARR-ST-ACCNT-CNTL OR
  9364        ACCNT-CNTL         OR
  9365        CARR-ACCNT-CNTL
  9366          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9367
  9368     IF ACCNT-CNTL OR
  9369        CARR-ACCNT-CNTL
  9370          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9371
  9372
  9373* EXEC CICS READ
  9374*         DATASET   (ERPNDB-ALT-FILE-ID)
  9375*         SET       (ADDRESS OF PENDING-BUSINESS)
  9376*         RIDFLD    (ERPNDB-ALT-KEY)
  9377*         resp      (ws-response)
  9378*     END-EXEC.
  9379*    MOVE '&"S        E          (  N#00008538' TO DFHEIV0
  9380     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9382     MOVE X'204E233030303038353338' TO DFHEIV0(25:11)
  9383     CALL 'kxdfhei1' USING DFHEIV0,
  9384           ERPNDB-ALT-FILE-ID,
  9385           DFHEIV20,
  9386           DFHEIV99,
  9387           ERPNDB-ALT-KEY,
  9388           DFHEIV99,
  9389           DFHEIV99,
  9390           DFHEIV99
  9391     SET ADDRESS OF PENDING-BUSINESS TO
  9392         DFHEIV20
  9393     MOVE EIBRESP  TO ws-response
  9394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9395
  9396
  9397     if not resp-normal
  9398        go to 6200-exit
  9399     end-if
  9400     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9401
  9402
  9403* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 169
* EL677.cbl
  9404*         DATASET   (ERPNDB-FILE-ID)
  9405*         SET       (ADDRESS OF PENDING-BUSINESS)
  9406*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9407*         UPDATE
  9408*         resp      (ws-response)
  9409*     END-EXEC.
  9410*    MOVE '&"S        EU         (  N#00008550' TO DFHEIV0
  9411     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9412     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9413     MOVE X'204E233030303038353530' TO DFHEIV0(25:11)
  9414     CALL 'kxdfhei1' USING DFHEIV0,
  9415           ERPNDB-FILE-ID,
  9416           DFHEIV20,
  9417           DFHEIV99,
  9418           ERPNDB-PRIMARY-KEY,
  9419           DFHEIV99,
  9420           DFHEIV99,
  9421           DFHEIV99
  9422     SET ADDRESS OF PENDING-BUSINESS TO
  9423         DFHEIV20
  9424     MOVE EIBRESP  TO ws-response
  9425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9426
  9427
  9428 6200-EXIT.
  9429      EXIT.
  9430 6210-rewrite-pndb.
  9431
  9432* EXEC CICS REWRITE
  9433*        DATASET  (ERPNDB-FILE-ID)
  9434*        FROM     (PENDING-BUSINESS)
  9435*    END-EXEC
  9436     MOVE LENGTH OF
  9437      PENDING-BUSINESS
  9438       TO DFHEIV11
  9439*    MOVE '&& L                  %   #00008561' TO DFHEIV0
  9440     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9441     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9442     MOVE X'2020233030303038353631' TO DFHEIV0(25:11)
  9443     CALL 'kxdfhei1' USING DFHEIV0,
  9444           ERPNDB-FILE-ID,
  9445           PENDING-BUSINESS,
  9446           DFHEIV11,
  9447           DFHEIV99
  9448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9449     .
  9450 6210-exit.
  9451     exit.
  9452 6300-BUILD-CERT-SCREEN.
  9453*    move 'N'                    to dedcyni
  9454*                                   pi-prev-ded-comm
  9455     MOVE LOW-VALUES             TO  EL677AI.
  9456     perform 6700-build-common   thru 6700-exit
  9457     if ws-refund-amount = zeros
  9458        move pi-company-cd       to pi-chek-comp-cd
  9459        move pi-carrier          to pi-chek-carrier
  9460        move pi-grouping         to pi-chek-grouping
  9461        move pi-state            to pi-chek-state
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 170
* EL677.cbl
  9462        move pi-account          to pi-chek-account
  9463        move pi-cert-eff-dt      to pi-chek-eff-dt
  9464        move pi-cert-prime       to pi-chek-cert-no
  9465        move pi-cert-sfx         to pi-chek-suf-no
  9466        move +1                  to pi-chek-sequence
  9467             MOVE 'S'            TO MAINTI
  9468             MOVE 1              TO MAINTL
  9469             MOVE AL-UABON       TO MAINTA
  9470             MOVE DFHENTER       TO EIBAID
  9471        go to 5000-browse-file
  9472     end-if
  9473     IF WS-CERT-NOT-FOUND
  9474         GO TO 8100-SEND-INITIAL-MAP.
  9475
  9476*    IF WS-PNDB-FOUND
  9477*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9478*                                   PB-C-AH-CANCEL-AMT
  9479*        MOVE 'R'                TO  TYPEO
  9480*        IF PI-AR-PROCESSING
  9481*            MOVE AL-UANON       TO  REFA
  9482*            MOVE PB-C-REFERENCE TO  REFO
  9483*        END-IF
  9484*    ELSE
  9485*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9486*                                   CM-AH-ITD-CANCEL-AMT.
  9487     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9488     MOVE pi-check-type           TO TYPEO
  9489
  9490     IF PI-COMPANY-ID = 'TMS'
  9491         MOVE WS-NAME-WORK         TO PAYTO1I
  9492                                      PI-PAYTO1
  9493         MOVE AL-UANON             TO PAYTO1A
  9494     ELSE
  9495         MOVE WS-NAME-WORK         TO PAYTO1I
  9496                                      PI-PAYTO1
  9497         MOVE AL-UANON             TO PAYTO1A.
  9498
  9499*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9500*    MOVE AL-UANON                 TO PAYTO1AA.
  9501     move 'N'                    to dedcyni
  9502     move al-uanon               to dedcyna
  9503     move 'INS'                  to payeeo
  9504     move al-panon               to payeea
  9505     IF PI-MAIL-YES
  9506         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9507
  9508     GO TO 8100-SEND-INITIAL-MAP.
  9509
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 171
* EL677.cbl
  9511
  9512 6400-MAILING-ADDRESS.
  9513
  9514* EXEC CICS HANDLE CONDITION
  9515*        NOTFND   (6470-NO-ADDRESS)
  9516*    END-EXEC.
  9517*    MOVE '"$I                   ! / #00008629' TO DFHEIV0
  9518     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9520     MOVE X'2F20233030303038363239' TO DFHEIV0(25:11)
  9521     CALL 'kxdfhei1' USING DFHEIV0
  9522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9523
  9524
  9525
  9526* EXEC CICS READ
  9527*        DATASET   (ERMAIL-FILE-ID)
  9528*        SET       (ADDRESS OF MAILING-DATA)
  9529*        RIDFLD    (ELCERT-KEY)
  9530*    END-EXEC.
  9531*    MOVE '&"S        E          (   #00008633' TO DFHEIV0
  9532     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9534     MOVE X'2020233030303038363333' TO DFHEIV0(25:11)
  9535     CALL 'kxdfhei1' USING DFHEIV0,
  9536           ERMAIL-FILE-ID,
  9537           DFHEIV20,
  9538           DFHEIV99,
  9539           ELCERT-KEY,
  9540           DFHEIV99,
  9541           DFHEIV99,
  9542           DFHEIV99
  9543     SET ADDRESS OF MAILING-DATA TO
  9544         DFHEIV20
  9545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9546
  9547
  9548     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9549     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9550     move ma-city                to payctyi
  9551     move ma-addr-state          to paysti
  9552     MOVE MA-ZIP                 TO PTOZIPI.
  9553     MOVE AL-UANON               TO PAYAD1A
  9554                                    PAYAD2A
  9555                                    PAYctyA
  9556                                    paysta
  9557                                    PTOZIPA.
  9558
  9559     GO TO 6490-EXIT.
  9560
  9561 6470-NO-ADDRESS.
  9562     MOVE -1                     TO  PAYAD1L.
  9563     MOVE ER-2394                TO  EMI-ERROR.
  9564     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9565
  9566 6490-EXIT.
  9567      EXIT.
  9568
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 172
* EL677.cbl
  9570
  9571 6500-BUILD-ACCOUNT-SCREEN.
  9572     MOVE LOW-VALUES             TO  EL677AI.
  9573     perform 6700-build-common   thru 6700-exit
  9574     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9575     MOVE PI-AM-NAME             TO PAYTO1I
  9576     MOVE SPACES                 TO PAYTO2I
  9577     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9578     MOVE PI-AM-CITY             TO PAYCTYI
  9579     move pi-am-st               to paysti
  9580     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9581     move 'ACCT'                 to payeeo
  9582     move al-panon               to payeea
  9583     MOVE AL-UANON               TO PAYTO1A
  9584                                    PAYTO2A
  9585                                    PAYAD1A
  9586                                    PAYCTYA
  9587                                    paysta
  9588                                    PTOZIPA
  9589     GO TO 8100-SEND-INITIAL-MAP
  9590     .
  9591 6600-BUILD-BENEFICIARY-SCREEN.
  9592     MOVE LOW-VALUES             TO  EL677AI.
  9593     perform 6700-build-common   thru 6700-exit
  9594     IF WS-CERT-NOT-FOUND
  9595         GO TO 8100-SEND-INITIAL-MAP.
  9596
  9597*    IF WS-PNDB-FOUND
  9598*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9599*                                   PB-C-AH-CANCEL-AMT
  9600*        MOVE 'R'                TO  TYPEO
  9601*        IF PI-AR-PROCESSING
  9602*            MOVE AL-UANON       TO  REFA
  9603*            MOVE PB-C-REFERENCE TO  REFO
  9604*        END-IF
  9605*    ELSE
  9606*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9607*                                   CM-AH-ITD-CANCEL-AMT.
  9608
  9609     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9610     MOVE pi-check-type           TO  TYPEO.
  9611
  9612     IF PI-COMPANY-ID = 'TMS'
  9613         MOVE WS-NAME-WORK         TO PAYTO1I
  9614                                      PI-PAYTO1
  9615         MOVE AL-UANON             TO PAYTO1A
  9616     ELSE
  9617         MOVE WS-NAME-WORK         TO PAYTO1I
  9618                                      PI-PAYTO1
  9619         MOVE AL-UANON             TO PAYTO1A.
  9620
  9621*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9622*    MOVE AL-UANON                 TO PAYTO1AA.
  9623
  9624     move 'N'                    to dedcyni
  9625     move al-uanon               to dedcyna
  9626     move 'BENE'                 to payeeo
  9627     move al-panon               to payeea
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 173
* EL677.cbl
  9628     IF PI-MAIL-YES
  9629         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
  9630
  9631     GO TO 8100-SEND-INITIAL-MAP.
  9632
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 174
* EL677.cbl
  9634
  9635 6620-MAILING-ADDRESS.
  9636
  9637* EXEC CICS HANDLE CONDITION
  9638*        NOTFND   (6670-NO-beneficiary)
  9639*    END-EXEC.
  9640*    MOVE '"$I                   ! 0 #00008727' TO DFHEIV0
  9641     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9643     MOVE X'3020233030303038373237' TO DFHEIV0(25:11)
  9644     CALL 'kxdfhei1' USING DFHEIV0
  9645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9646
  9647
  9648
  9649* EXEC CICS READ
  9650*        DATASET   (ERMAIL-FILE-ID)
  9651*        SET       (ADDRESS OF MAILING-DATA)
  9652*        RIDFLD    (ELCERT-KEY)
  9653*    END-EXEC.
  9654*    MOVE '&"S        E          (   #00008731' TO DFHEIV0
  9655     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9657     MOVE X'2020233030303038373331' TO DFHEIV0(25:11)
  9658     CALL 'kxdfhei1' USING DFHEIV0,
  9659           ERMAIL-FILE-ID,
  9660           DFHEIV20,
  9661           DFHEIV99,
  9662           ELCERT-KEY,
  9663           DFHEIV99,
  9664           DFHEIV99,
  9665           DFHEIV99
  9666     SET ADDRESS OF MAILING-DATA TO
  9667         DFHEIV20
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670
  9671     move spaces                 to payto2i
  9672     move ma-cred-bene-name      to payto1i
  9673     MOVE MA-cred-bene-addr      TO PAYad1I.
  9674     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9675     move ma-cred-bene-city      to payctyi
  9676     move ma-cred-bene-state     to paysti
  9677     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9678     MOVE AL-UANON               TO payto1a
  9679                                    PAYTO2A
  9680                                    PAYad1A
  9681                                    payad2a
  9682                                    PAYctyA
  9683                                    paysta
  9684                                    PTOZIPA.
  9685
  9686     GO TO 6690-EXIT.
  9687
  9688 6670-NO-BENEFICIARY.
  9689     MOVE -1                     TO  PAYTO1L.
  9690     MOVE ER-2394                TO  EMI-ERROR.
  9691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 175
* EL677.cbl
  9692
  9693 6690-EXIT.
  9694      EXIT.
  9695 6700-build-common.
  9696     if not eracct-found
  9697        move pi-company-cd       to eracct-co
  9698        move pi-carrier          to eracct-carrier
  9699        move pi-grouping         to eracct-grouping
  9700        move pi-state            to eracct-state
  9701        move pi-account          to eracct-account
  9702        move pi-cert-eff-dt      to eracct-exp-date
  9703        perform 1420-get-eracct  thru 1490-exit
  9704     end-if
  9705*    if WS-PNDB-NOT-FOUND
  9706*       perform 5600-get-erpndb thru 5600-exit
  9707*    end-if
  9708*    MOVE LOW-VALUES             TO  EL677AI.
  9709     MOVE 'A'                    TO  MAINTI.
  9710     MOVE AL-UANON               TO  MAINTA.
  9711     MOVE +1                     TO  MAINTL.
  9712     MOVE PI-CARRIER             TO  CARRIERO.
  9713     MOVE PI-GROUPING            TO  GROUPO.
  9714     MOVE PI-STATE               TO  STATEO.
  9715     MOVE PI-ACCOUNT             TO  ACCTO.
  9716     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9717     MOVE PI-CERT-SFX            TO  SFXO.
  9718     MOVE PI-AMOUNT              TO  AMOUNTO.
  9719*    MOVE PI-TYPE                TO  TYPEO.
  9720     move pi-check-type          to  typeo
  9721     move pi-return-to           to  rettoo
  9722*    MOVE PI-REFERENCE           TO  REFO.
  9723     MOVE PI-PAYTO1              TO  PAYTO1O.
  9724     MOVE AL-UANON               TO  CARRIERA
  9725                                     GROUPA
  9726                                     STATEA
  9727                                     ACCTA
  9728                                     CERTNOA
  9729                                     SFXA
  9730                                     PAYTO1A
  9731                                     PAYTO2A
  9732*                                    AMOUNTA
  9733*                                    TYPEA
  9734                                     rettoa
  9735                                     payeea.
  9736     move al-panon               to typea
  9737     move al-panon               to amounta
  9738     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9739     MOVE ' '                    TO  DC-OPTION-CODE.
  9740     PERFORM 8500-DATE-CONVERT.
  9741     IF NO-CONVERSION-ERROR
  9742         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9743         MOVE AL-UANON            TO  EFFDTA
  9744         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9745         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9746     ELSE
  9747         GO TO 8200-SEND-DATAONLY.
  9748     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9749         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 176
* EL677.cbl
  9750         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9751     ELSE
  9752         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9753         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9754     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9755     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9756     move spaces to pi-insured-name
  9757     string cm-insured-last-name ' '
  9758            cm-insured-first-name delimited by '  '
  9759        into pi-insured-name
  9760     end-string
  9761     move spaces                 to pi-table-name
  9762     string cm-insured-last-name ', '
  9763            cm-insured-first-name ' '
  9764            cm-insured-initial2
  9765        delimited by '  '
  9766        into
  9767           pi-table-name
  9768     end-string
  9769*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9770     if eibaid = dfhpf5
  9771        move 'Y'                 to dedcyni
  9772        move al-uanon            to dedcyna
  9773     end-if
  9774    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9775       cm-lf-alt-premium-amt
  9776    compute ws-tot-iss-prem  =
  9777       cm-ah-premium-amt + ws-tot-lf-prem
  9778    compute ws-tot-iss-comm =
  9779       (ws-tot-lf-prem * cm-life-comm-pct) +
  9780       (cm-ah-premium-amt * cm-ah-comm-pct)
  9781    compute ws-tot-ref-comm =
  9782       (pi-lf-refund * cm-life-comm-pct) +
  9783       (pi-ah-refund * cm-ah-comm-pct)
  9784     move ws-tot-iss-prem        to premo
  9785     move ws-tot-iss-comm        to isscommo
  9786     move al-sadof               to drefa
  9787                                    refa
  9788*    compute refo = pi-lf-refund + pi-ah-refund
  9789     move pi-prev-paid            to prepdo
  9790     move ws-tot-ref-comm         to uecommo
  9791                                     pi-ue-comm
  9792***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9793***     pi-prev-paid
  9794     compute ws-refund-amount =
  9795        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9796     if (pi-refund-on-pending-rec + pi-prev-paid) >
  9797        ws-tot-iss-prem
  9798        move zeros               to ws-refund-amount
  9799     end-if
  9800     if ((dedcyni = 'Y')
  9801        or (pi-prev-ded-comm = 'Y'))
  9802        and (ws-refund-amount >= ws-tot-ref-comm)
  9803        compute ws-refund-amount = ws-refund-amount -
  9804           ws-tot-ref-comm
  9805     end-if
  9806     if pi-check-type = 'C'
  9807*       move pi-endt-prm-diff    to refo
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 177
* EL677.cbl
  9808        move pi-endt-com-diff    to uecommo
  9809                                    pi-ue-comm
  9810        compute ws-refund-amount =
  9811           pi-endt-prm-diff - pi-prev-paid
  9812        if (dedcyni = 'Y')
  9813           or (pi-prev-ded-comm = 'Y')
  9814           compute ws-refund-amount = ws-refund-amount -
  9815              pi-endt-com-diff
  9816        end-if
  9817        if ws-refund-amount <= zeros
  9818           move pi-endt-prm-diff to ws-refund-amount
  9819        end-if
  9820     end-if
  9821     if not WS-CERT-NOT-FOUND
  9822        string
  9823           pi-cert-prime         ' : '
  9824           cm-insured-last-name  ', '
  9825           cm-insured-first-name ' : '
  9826           pi-account            ' : '
  9827           pi-am-csr delimited by '  ' into text1o
  9828        end-string
  9829        move al-uanon            to text1a
  9830        MOVE 'REF'               TO WS-USER-REASON
  9831        if pi-check-type = 'C'
  9832           move 'COR'            to ws-user-reason
  9833        end-if
  9834        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9835        inspect ws-user-cert-no replacing leading zeros
  9836           by spaces
  9837        move pi-insured-name     to ws-user-name
  9838        perform varying s1 from +1 by +1 until
  9839           (s1 > +11)
  9840           or (ws-user-cert-no (s1:1)) <> ' '
  9841        end-perform
  9842        string ws-user-reason  ' ' delimited by size
  9843               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9844                  delimited by size
  9845               cm-insured-last-name ' '
  9846               cm-insured-first-name delimited by '  '
  9847           into stubo
  9848        end-string
  9849        move al-uanon            to stuba
  9850     end-if
  9851     .
  9852 6700-exit.
  9853     exit.
  9854 6800-browse-previous-chek-recs.
  9855***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9856***                                                            ***
  9857**** this should be the first time through, we need to gather  ***
  9858**** all the erchek records for this pending record, add the   ***
  9859**** amounts and make sure this check request will not exceed  ***
  9860**** the collected premium                                     ***
  9861***                                                            ***
  9862***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9863     move zeros                  to pi-prev-paid
  9864                                    pi-prev-paid-this-month
  9865                                    ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 178
* EL677.cbl
  9866                                    pi-chek-rec-cnt
  9867     move spaces                 to pi-prev-ded-comm
  9868     move pi-company-cd          to chek-company-cd
  9869     move pi-carrier             to chek-carrier
  9870     move pi-grouping            to chek-grouping
  9871     move pi-state               to chek-state
  9872     move pi-account             to chek-account
  9873     move pi-cert-prime          to chek-cert-no
  9874     move pi-cert-sfx            to chek-suf-no
  9875     move pi-cert-eff-dt         to chek-eff-dt
  9876     move +0                     to chek-record-seq
  9877     move erchek-key             to ws-compare-erchek-key
  9878
  9879* EXEC CICS STARTBR
  9880*       DATASET  (ERCHEK-FILE-ID)
  9881*       RIDFLD   (ERCHEK-KEY)
  9882*       resp     (ws-response)
  9883*    END-EXEC
  9884     MOVE 0
  9885       TO DFHEIV11
  9886*    MOVE '&,         G          &  N#00008944' TO DFHEIV0
  9887     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9888     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9889     MOVE X'204E233030303038393434' TO DFHEIV0(25:11)
  9890     CALL 'kxdfhei1' USING DFHEIV0,
  9891           ERCHEK-FILE-ID,
  9892           ERCHEK-KEY,
  9893           DFHEIV99,
  9894           DFHEIV11,
  9895           DFHEIV99
  9896     MOVE EIBRESP  TO ws-response
  9897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9898     if not resp-normal
  9899        go to 6800-exit
  9900     end-if
  9901     perform until i-say-when
  9902
  9903* EXEC CICS READNEXT
  9904*          DATASET   (ERCHEK-FILE-ID)
  9905*          SET       (ADDRESS OF CHECK-RECORDS)
  9906*          RIDFLD    (ERCHEK-KEY)
  9907*          resp      (ws-response)
  9908*       END-EXEC
  9909     MOVE 0
  9910       TO DFHEIV11
  9911*    MOVE '&.S                   )  N#00008953' TO DFHEIV0
  9912     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9913     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9914     MOVE X'204E233030303038393533' TO DFHEIV0(25:11)
  9915     CALL 'kxdfhei1' USING DFHEIV0,
  9916           ERCHEK-FILE-ID,
  9917           DFHEIV20,
  9918           DFHEIV99,
  9919           ERCHEK-KEY,
  9920           DFHEIV99,
  9921           DFHEIV11,
  9922           DFHEIV99,
  9923           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 179
* EL677.cbl
  9924     SET ADDRESS OF CHECK-RECORDS TO
  9925         DFHEIV20
  9926     MOVE EIBRESP  TO ws-response
  9927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9928        if resp-normal
  9929           and erchek-key (1:33) = ws-compare-erchek-key
  9930           if (ch-void-dt = low-values)
  9931              and (not ch-denied)
  9932              if pi-check-type = 'R'
  9933                 and ch-check-origin-sw = 'C'
  9934                 continue
  9935              else
  9936                 compute pi-prev-paid = pi-prev-paid +
  9937                    ch-amount-paid
  9938                 add +1 to pi-chek-rec-cnt
  9939                 move ch-deduct-commission
  9940                                 to pi-prev-ded-comm
  9941                 if ch-credit-select-dt = pi-cr-month-end-dt
  9942                    compute pi-prev-paid-this-month =
  9943                       pi-prev-paid-this-month + ch-amount-paid
  9944                 end-if
  9945              end-if
  9946           end-if
  9947        else
  9948           set i-say-when to true
  9949        end-if
  9950     end-perform
  9951     .
  9952 6800-exit.
  9953     exit.
  9954 7000-SET-PI-AREA.
  9955     MOVE CARRIERI               TO  PI-CARRIER
  9956                                     PI-CHEK-CARRIER.
  9957     MOVE GROUPI                 TO  PI-GROUPING
  9958                                     PI-CHEK-GROUPING.
  9959     MOVE STATEI                 TO  PI-STATE
  9960                                     PI-CHEK-STATE.
  9961     MOVE ACCTI                  TO  PI-ACCOUNT
  9962                                     PI-CHEK-ACCOUNT.
  9963     MOVE CERTNOI                TO  PI-CERT-PRIME
  9964                                     PI-CHEK-CERT-NO.
  9965     IF SFXI NOT = LOW-VALUES
  9966         MOVE SFXI               TO  PI-CERT-SFX
  9967                                     PI-CHEK-SUF-NO
  9968     ELSE
  9969         MOVE SPACE              TO  PI-CERT-SFX
  9970                                     PI-CHEK-SUF-NO.
  9971
  9972     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9973     MOVE '2'                    TO  DC-OPTION-CODE.
  9974     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9975     IF DATE-CONVERSION-ERROR
  9976         MOVE ER-0215            TO  EMI-ERROR
  9977         MOVE -1                 TO  EFFDTL
  9978         MOVE AL-UNBON           TO  EFFDTA
  9979         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9980         GO TO 8200-SEND-DATAONLY
  9981     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 180
* EL677.cbl
  9982         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9983                                     PI-CHEK-EFF-DT.
  9984
  9985 7090-EXIT.
  9986      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 181
* EL677.cbl
  9988 7100-CREATE-TEMP-STORAGE.
  9989     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9990
  9991
  9992* EXEC CICS WRITEQ TS
  9993*        QUEUE   (QID)
  9994*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9995*        LENGTH  (PI-COMM-LENGTH)
  9996*    END-EXEC.
  9997*    MOVE '*"     L              ''   #00009022' TO DFHEIV0
  9998     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10000     MOVE X'2020233030303039303232' TO DFHEIV0(25:11)
 10001     CALL 'kxdfhei1' USING DFHEIV0,
 10002           QID,
 10003           PROGRAM-INTERFACE-BLOCK,
 10004           PI-COMM-LENGTH,
 10005           DFHEIV99,
 10006           DFHEIV99,
 10007           DFHEIV99
 10008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10009
 10010
 10011 7100-EXIT.
 10012      EXIT.
 10013
 10014 7200-RECOVER-TEMP-STORAGE.
 10015
 10016* EXEC CICS READQ TS
 10017*        QUEUE   (QID)
 10018*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10019*        LENGTH  (PI-COMM-LENGTH)
 10020*    END-EXEC.
 10021*    MOVE '*$I    L              ''   #00009032' TO DFHEIV0
 10022     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10023     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10024     MOVE X'2020233030303039303332' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           QID,
 10027           PROGRAM-INTERFACE-BLOCK,
 10028           PI-COMM-LENGTH,
 10029           DFHEIV99,
 10030           DFHEIV99,
 10031           DFHEIV99
 10032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10033
 10034
 10035     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10036
 10037 7200-EXIT.
 10038      EXIT.
 10039
 10040 7300-DELETE-TEMP-STORAGE.
 10041
 10042* EXEC CICS HANDLE CONDITION
 10043*        QIDERR  (7300-EXIT)
 10044*    END-EXEC.
 10045*    MOVE '"$N                   ! 1 #00009044' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 182
* EL677.cbl
 10046     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10048     MOVE X'3120233030303039303434' TO DFHEIV0(25:11)
 10049     CALL 'kxdfhei1' USING DFHEIV0
 10050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10051
 10052
 10053
 10054* EXEC CICS DELETEQ TS
 10055*        QUEUE  (QID)
 10056*    END-EXEC.
 10057*    MOVE '*&                    #   #00009048' TO DFHEIV0
 10058     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10059     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10060     MOVE X'2020233030303039303438' TO DFHEIV0(25:11)
 10061     CALL 'kxdfhei1' USING DFHEIV0,
 10062           QID,
 10063           DFHEIV99
 10064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10065
 10066
 10067 7300-EXIT.
 10068      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 183
* EL677.cbl
 10070 7500-reissue-pass-1.
 10071
 10072     move '2'                    to pi-void-reissue-pass
 10073
 10074     move pi-void-reissue-amt    to amounto
 10075
 10076     if eibaid = dfhpf5
 10077        MOVE PI-AM-NAME          TO PAYTO1I
 10078        MOVE SPACES              TO PAYTO2I
 10079        MOVE PI-AM-ADDRS         TO PAYAD1I
 10080        MOVE PI-AM-CITY          TO PAYCTYI
 10081        move pi-am-st            to paysti
 10082        MOVE PI-AM-ZIP-CODE      TO PTOZIPI
 10083        move 'ACCT'              to payeeo
 10084        move al-panon            to payeea
 10085
 10086        MOVE AL-UANON            TO PAYTO1A
 10087                                    PAYTO2A
 10088                                    PAYAD1A
 10089                                    PAYCTYA
 10090                                    paysta
 10091                                    PTOZIPA
 10092                                    payeea
 10093        GO TO 8100-SEND-INITIAL-MAP
 10094     end-if
 10095
 10096     perform 5700-get-elcert     thru 5700-exit
 10097     move spaces                 to pi-table-name
 10098     string cm-insured-last-name ', '
 10099            cm-insured-first-name ' '
 10100            cm-insured-initial2
 10101        delimited by '  '
 10102        into
 10103           pi-table-name
 10104     end-string
 10105
 10106     IF CM-INSURED-FIRST-NAME GREATER SPACES
 10107         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
 10108         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
 10109     ELSE
 10110         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
 10111         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
 10112
 10113     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
 10114
 10115     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10116
 10117     if eibaid = dfhpf7
 10118
 10119* EXEC CICS READ
 10120*           DATASET   (ERMAIL-FILE-ID)
 10121*           SET       (ADDRESS OF MAILING-DATA)
 10122*           RIDFLD    (ELCERT-KEY)
 10123*           resp      (ws-response)
 10124*       END-EXEC
 10125*    MOVE '&"S        E          (  N#00009103' TO DFHEIV0
 10126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 184
* EL677.cbl
 10128     MOVE X'204E233030303039313033' TO DFHEIV0(25:11)
 10129     CALL 'kxdfhei1' USING DFHEIV0,
 10130           ERMAIL-FILE-ID,
 10131           DFHEIV20,
 10132           DFHEIV99,
 10133           ELCERT-KEY,
 10134           DFHEIV99,
 10135           DFHEIV99,
 10136           DFHEIV99
 10137     SET ADDRESS OF MAILING-DATA TO
 10138         DFHEIV20
 10139     MOVE EIBRESP  TO ws-response
 10140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10141        if resp-normal
 10142           move spaces             to payto2i
 10143           move ma-cred-bene-name  to payto1i
 10144           MOVE MA-cred-bene-addr  TO PAYad1I
 10145           MOVE MA-cred-bene-addr2 TO PAYad2I
 10146           move ma-cred-bene-city  to payctyi
 10147           move ma-cred-bene-state to paysti
 10148           MOVE MA-cred-bene-zip   TO PTOZIPI
 10149           move 'BENE'              to payeeo
 10150           MOVE AL-UANON           TO payto1a
 10151                                      PAYTO2A
 10152                                      PAYad1A
 10153                                      payad2a
 10154                                      PAYctyA
 10155                                      paysta
 10156                                      PTOZIPA
 10157                                      payeea
 10158        end-if
 10159     end-if
 10160
 10161     if eibaid = dfhpf6
 10162
 10163* EXEC CICS READ
 10164*           DATASET   (ERMAIL-FILE-ID)
 10165*           SET       (ADDRESS OF MAILING-DATA)
 10166*           RIDFLD    (ELCERT-KEY)
 10167*           resp      (ws-response)
 10168*       END-EXEC
 10169*    MOVE '&"S        E          (  N#00009130' TO DFHEIV0
 10170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10172     MOVE X'204E233030303039313330' TO DFHEIV0(25:11)
 10173     CALL 'kxdfhei1' USING DFHEIV0,
 10174           ERMAIL-FILE-ID,
 10175           DFHEIV20,
 10176           DFHEIV99,
 10177           ELCERT-KEY,
 10178           DFHEIV99,
 10179           DFHEIV99,
 10180           DFHEIV99
 10181     SET ADDRESS OF MAILING-DATA TO
 10182         DFHEIV20
 10183     MOVE EIBRESP  TO ws-response
 10184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10185        if resp-normal
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 185
* EL677.cbl
 10186           move spaces            to payto2i
 10187           move ws-name-work      to payto1i
 10188           MOVE MA-ADDRESS-LINE-1 TO PAYAD1I
 10189           MOVE MA-ADDRESS-LINE-2 TO PAYAD2I
 10190           move ma-city           to payctyi
 10191           move ma-addr-state     to paysti
 10192           move 'INS'             to payeeo
 10193           MOVE MA-ZIP            TO PTOZIPI
 10194           MOVE AL-UANON          TO PAYAD1A
 10195                                     PAYAD2A
 10196                                     PAYctyA
 10197                                     paysta
 10198                                     PTOZIPA
 10199                                     payto1a
 10200                                     payeea
 10201        end-if
 10202     end-if
 10203
 10204     GO TO 8100-SEND-INITIAL-MAP
 10205
 10206     .
 10207 7500-exit.
 10208     exit.
 10209
 10210 7510-reissue-pass-2.
 10211
 10212
 10213* EXEC CICS READ
 10214*        DATASET  (ERCHEK-FILE-ID)
 10215*        SET      (ADDRESS OF CHECK-RECORDS)
 10216*        RIDFLD   (PI-ERCHEK-KEY)
 10217*        resp     (ws-response)
 10218*    END-EXEC
 10219*    MOVE '&"S        E          (  N#00009163' TO DFHEIV0
 10220     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10221     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10222     MOVE X'204E233030303039313633' TO DFHEIV0(25:11)
 10223     CALL 'kxdfhei1' USING DFHEIV0,
 10224           ERCHEK-FILE-ID,
 10225           DFHEIV20,
 10226           DFHEIV99,
 10227           PI-ERCHEK-KEY,
 10228           DFHEIV99,
 10229           DFHEIV99,
 10230           DFHEIV99
 10231     SET ADDRESS OF CHECK-RECORDS TO
 10232         DFHEIV20
 10233     MOVE EIBRESP  TO ws-response
 10234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10235
 10236     if not resp-normal
 10237        go to 7510-exit
 10238     end-if
 10239
 10240     if ch-void-dt not = save-bin-date
 10241        display ' something went wrong here '
 10242        go to 7510-exit
 10243     end-if
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 186
* EL677.cbl
 10244
 10245     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS
 10246     MOVE save-bin-date          TO CH-RECORDED-DT
 10247                                    ch-released-dt
 10248     move pi-processor-id        to ch-recorded-by
 10249                                    ch-released-by
 10250                                    ch-return-to
 10251     move spaces                 to ch-check-no
 10252                                    ch-void-by
 10253                                    ch-void-reason
 10254                                    ch-approved-by
 10255
 10256
 10257     move 'P'                    to ch-approval-status
 10258
 10259     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
 10260                                    CH-VOID-DT
 10261                                    CH-CREDIT-ACCEPT-DT
 10262                                    ch-approval-dt
 10263                                    ch-check-cashed-dt
 10264     add +1 to ch-sequence-no
 10265     if ch-check-origin-sw = 'R'
 10266        move 'R'                 to pi-check-type
 10267     else
 10268        move 'C'                 to pi-check-type
 10269     end-if
 10270
 10271     .
 10272 7510-WRITE-RECORD.
 10273
 10274
 10275* exec cics read
 10276*       dataset    (erchek-file-id)
 10277*       into       (ws-dummy-erchek)
 10278*       ridfld     (ch-control-primary)
 10279*       resp       (ws-response)
 10280*    end-exec
 10281     MOVE LENGTH OF
 10282      ws-dummy-erchek
 10283       TO DFHEIV11
 10284*    MOVE '&"IL       E          (  N#00009208' TO DFHEIV0
 10285     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10287     MOVE X'204E233030303039323038' TO DFHEIV0(25:11)
 10288     CALL 'kxdfhei1' USING DFHEIV0,
 10289           erchek-file-id,
 10290           ws-dummy-erchek,
 10291           DFHEIV11,
 10292           ch-control-primary,
 10293           DFHEIV99,
 10294           DFHEIV99,
 10295           DFHEIV99
 10296     MOVE EIBRESP  TO ws-response
 10297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10298     if RESP-NOTFND
 10299        continue
 10300     else
 10301        add +1                   to ch-sequence-no
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 187
* EL677.cbl
 10302        add 1                    to seqi
 10303        go to 7510-write-record
 10304     end-if
 10305
 10306     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
 10307     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
 10308                                    CH-CHECK-QUE-SEQUENCE
 10309
 10310     IF PAYTO1L NOT = ZEROS
 10311        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
 10312     END-IF
 10313     IF PAYTO2L NOT = ZEROS
 10314        MOVE PAYTO2I             TO CH-PAYEE-NAME-2
 10315     end-if
 10316     IF PAYAD1L NOT = ZEROS
 10317        MOVE PAYAD1I             TO CH-PAYEE-ADDRESS-1
 10318     end-if
 10319     IF PAYAD2L NOT = ZEROS
 10320        MOVE PAYAD2I             TO CH-PAYEE-ADDRESS-2
 10321     end-if
 10322     IF PAYctyL NOT = ZEROS
 10323        MOVE payctyi             TO CH-PAYEE-CITY
 10324     end-if
 10325     IF PAYstL NOT = ZEROS
 10326        MOVE paysti              TO CH-PAYEE-state
 10327     end-if
 10328     IF PAYEEI GREATER SPACES
 10329        mOVE PAYEEI               TO CH-PAYEE-CODE
 10330     end-if
 10331     IF PTOZIPL  =  ZEROS
 10332        MOVE ZEROS               TO CH-PAYEE-ZIP-CODE
 10333     else
 10334        MOVE PTOZIPI             TO WS-ZIP-CODE
 10335        IF NOT WS-CANADIAN-POST-CODE
 10336           MOVE WS-ZIP-PRIME     TO CH-PAYEE-ZIP
 10337           MOVE WS-ZIP-PLUS4     TO CH-PAYEE-ZIP-EXT
 10338        end-if
 10339     end-if
 10340
 10341     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
 10342
 10343
 10344* EXEC CICS WRITE
 10345*        DATASET  (ERCHEK-FILE-ID)
 10346*        FROM     (CHECK-RECORDS)
 10347*        RIDFLD   (CH-CONTROL-PRIMARY)
 10348*        resp     (ws-response)
 10349*    END-EXEC.
 10350     MOVE LENGTH OF
 10351      CHECK-RECORDS
 10352       TO DFHEIV11
 10353*    MOVE '&$ L                  ''  N#00009259' TO DFHEIV0
 10354     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10355     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10356     MOVE X'204E233030303039323539' TO DFHEIV0(25:11)
 10357     CALL 'kxdfhei1' USING DFHEIV0,
 10358           ERCHEK-FILE-ID,
 10359           CHECK-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 188
* EL677.cbl
 10360           DFHEIV11,
 10361           CH-CONTROL-PRIMARY,
 10362           DFHEIV99,
 10363           DFHEIV99
 10364     MOVE EIBRESP  TO ws-response
 10365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10366
 10367     COMPUTE WS-JOURNAL-RECORD-LENGTH =
 10368             ERCHEK-RECORD-LENGTH + 23.
 10369
 10370     IF EMI-NO-ERRORS
 10371        MOVE ER-0000             TO EMI-ERROR
 10372     ELSE
 10373        IF EMI-FORCABLE-CTR GREATER THAN +0  AND
 10374           EIBAID = DFHPF4
 10375           MOVE ER-2600          TO EMI-ERROR
 10376        end-if
 10377     end-if
 10378
 10379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10380
 10381     MOVE LOW-VALUES             TO EL677AI.
 10382
 10383     MOVE PI-CHEK-CARRIER        TO CARRIERO.
 10384     MOVE PI-CHEK-GROUPING       TO GROUPO.
 10385     MOVE PI-CHEK-STATE          TO STATEO.
 10386     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
 10387
 10388     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
 10389     MOVE SPACE                  TO DC-OPTION-CODE.
 10390     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10391     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
 10392
 10393     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
 10394     MOVE PI-CHEK-SUF-NO         TO SFXO.
 10395     MOVE PI-CHEK-SEQUENCE       TO SEQO.
 10396
 10397     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
 10398                                    ACCTA     EFFDTA  CERTNOA
 10399                                    SFXA.
 10400     MOVE AL-UNNON               TO SEQA
 10401     move ' ' to pi-void-reissue-pass
 10402     go to 5000-browse-file
 10403
 10404     .
 10405 7510-exit.
 10406     exit.
 10407 8100-SEND-INITIAL-MAP.
 10408     MOVE SAVE-DATE              TO  DATEO.
 10409     MOVE EIBTIME                TO  TIME-IN.
 10410     MOVE TIME-OUT               TO  TIMEO.
 10411     MOVE -1                     TO  MAINTL
 10412     move al-uanon               to mainta
 10413     move dedcyni                to pi-previous-deduct-comm
 10414     if (PI-TO-EL677-FROM-EL1273)
 10415        and (pi-void-reissue-pass = ' ')
 10416        move al-sadof            to pf3a
 10417                                    pf4a
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 189
* EL677.cbl
 10418                                    pf57a
 10419                                    pf6a
 10420                                    dprema
 10421                                    dcomma
 10422                                    drefa
 10423                                    duecomma
 10424                                    dprepda
 10425                                    prema
 10426                                    isscomma
 10427                                    refa
 10428                                    uecomma
 10429                                    prepda
 10430        move ', VOID(V)'         to dmaint1o
 10431        move 'VOID & REISSUE(R), DELETE(D)'
 10432                                 TO dmaint2o
 10433     end-if
 10434     if (pi-to-el677-from-el1273)
 10435        and (pi-void-reissue-pass = '1')
 10436        move al-sadof            to pf3a
 10437                                    pf4a
 10438                                    dprema
 10439                                    dcomma
 10440                                    drefa
 10441                                    duecomma
 10442                                    dprepda
 10443                                    prema
 10444                                    isscomma
 10445                                    refa
 10446                                    uecomma
 10447                                    prepda
 10448        move ', VOID(V)'         to dmaint1o
 10449        move 'VOID AND REISSUE(R)'
 10450                                 TO dmaint2o
 10451     end-if
 10452     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10453     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10454
 10455
 10456* EXEC CICS SEND
 10457*        MAP      (EL677A)
 10458*        MAPSET   (MAPSET-NAME)
 10459*        FROM     (EL677AO)
 10460*        ERASE
 10461*        CURSOR
 10462*    END-EXEC.
 10463     MOVE LENGTH OF
 10464      EL677AO
 10465       TO DFHEIV12
 10466     MOVE -1
 10467       TO DFHEIV11
 10468*    MOVE '8$     CT  E    H L F ,   #00009353' TO DFHEIV0
 10469     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10470     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10471     MOVE X'2020233030303039333533' TO DFHEIV0(25:11)
 10472     CALL 'kxdfhei1' USING DFHEIV0,
 10473           EL677A,
 10474           EL677AO,
 10475           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 190
* EL677.cbl
 10476           MAPSET-NAME,
 10477           DFHEIV99,
 10478           DFHEIV99,
 10479           DFHEIV99,
 10480           DFHEIV11,
 10481           DFHEIV99,
 10482           DFHEIV99,
 10483           DFHEIV99
 10484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10485
 10486
 10487     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 191
* EL677.cbl
 10489 8200-SEND-DATAONLY.
 10490     if connected-to-db
 10491        perform 4300-FINISH-UP-DB thru 4300-exit
 10492     end-if
 10493     MOVE SAVE-DATE              TO  DATEO.
 10494     MOVE EIBTIME                TO  TIME-IN.
 10495     MOVE TIME-OUT               TO  TIMEO.
 10496     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10497     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10498
 10499
 10500* EXEC CICS SEND
 10501*        MAP     (EL677A)
 10502*        MAPSET  (MAPSET-NAME)
 10503*        FROM    (EL677AO)
 10504*        DATAONLY
 10505*        CURSOR
 10506*    END-EXEC.
 10507     MOVE LENGTH OF
 10508      EL677AO
 10509       TO DFHEIV12
 10510     MOVE -1
 10511       TO DFHEIV11
 10512*    MOVE '8$D    CT       H L F ,   #00009373' TO DFHEIV0
 10513     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10514     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10515     MOVE X'2020233030303039333733' TO DFHEIV0(25:11)
 10516     CALL 'kxdfhei1' USING DFHEIV0,
 10517           EL677A,
 10518           EL677AO,
 10519           DFHEIV12,
 10520           MAPSET-NAME,
 10521           DFHEIV99,
 10522           DFHEIV99,
 10523           DFHEIV99,
 10524           DFHEIV11,
 10525           DFHEIV99,
 10526           DFHEIV99,
 10527           DFHEIV99
 10528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10529
 10530
 10531     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 192
* EL677.cbl
 10533 8300-SEND-TEXT.
 10534
 10535* EXEC CICS SEND TEXT
 10536*        FROM     (LOGOFF-TEXT)
 10537*        LENGTH   (LOGOFF-LENGTH)
 10538*        ERASE
 10539*        FREEKB
 10540*    END-EXEC.
 10541*    MOVE '8&      T  E F  H   F -   #00009384' TO DFHEIV0
 10542     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10543     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10544     MOVE X'2020233030303039333834' TO DFHEIV0(25:11)
 10545     CALL 'kxdfhei1' USING DFHEIV0,
 10546           LOGOFF-TEXT,
 10547           LOGOFF-LENGTH,
 10548           DFHEIV99,
 10549           DFHEIV99,
 10550           DFHEIV99,
 10551           DFHEIV99,
 10552           DFHEIV99,
 10553           DFHEIV99,
 10554           DFHEIV99,
 10555           DFHEIV99,
 10556           DFHEIV99,
 10557           DFHEIV99
 10558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10559
 10560
 10561
 10562* EXEC CICS RETURN
 10563*    END-EXEC.
 10564*    MOVE '.(                    ''   #00009391' TO DFHEIV0
 10565     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10567     MOVE X'2020233030303039333931' TO DFHEIV0(25:11)
 10568     CALL 'kxdfhei1' USING DFHEIV0,
 10569           DFHEIV99,
 10570           DFHEIV99,
 10571           DFHEIV99,
 10572           DFHEIV99,
 10573           DFHEIV99,
 10574           DFHEIV99
 10575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10576
 10577
 10578 8500-DATE-CONVERT.
 10579     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10580
 10581
 10582* EXEC CICS LINK
 10583*        PROGRAM    (PGM-NAME)
 10584*        COMMAREA   (DATE-CONVERSION-DATA)
 10585*        LENGTH     (DC-COMM-LENGTH)
 10586*    END-EXEC.
 10587*    MOVE '."C                   (   #00009397' TO DFHEIV0
 10588     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10590     MOVE X'2020233030303039333937' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 193
* EL677.cbl
 10591     CALL 'kxdfhei1' USING DFHEIV0,
 10592           PGM-NAME,
 10593           DATE-CONVERSION-DATA,
 10594           DC-COMM-LENGTH,
 10595           DFHEIV99,
 10596           DFHEIV99,
 10597           DFHEIV99,
 10598           DFHEIV99
 10599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10600
 10601
 10602 8500-EXIT.
 10603      EXIT.
 10604
 10605 8600-DEEDIT.
 10606
 10607* EXEC CICS BIF DEEDIT
 10608*        FIELD   (WS-DEEDIT-FIELD)
 10609*        LENGTH  (10)
 10610*    END-EXEC.
 10611     MOVE 10
 10612       TO DFHEIV11
 10613*    MOVE '@"L                   #   #00009407' TO DFHEIV0
 10614     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10615     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10616     MOVE X'2020233030303039343037' TO DFHEIV0(25:11)
 10617     CALL 'kxdfhei1' USING DFHEIV0,
 10618           WS-DEEDIT-FIELD,
 10619           DFHEIV11
 10620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10621
 10622
 10623 8600-EXIT.
 10624      EXIT.
 10625
 10626 8700-DEEDIT.
 10627
 10628* EXEC CICS BIF DEEDIT
 10629*        FIELD   (WS-DT-DEEDIT-FIELD)
 10630*        LENGTH  (10)
 10631*    END-EXEC.
 10632     MOVE 10
 10633       TO DFHEIV11
 10634*    MOVE '@"L                   #   #00009416' TO DFHEIV0
 10635     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10636     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10637     MOVE X'2020233030303039343136' TO DFHEIV0(25:11)
 10638     CALL 'kxdfhei1' USING DFHEIV0,
 10639           WS-DT-DEEDIT-FIELD,
 10640           DFHEIV11
 10641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10642
 10643
 10644 8700-EXIT.
 10645      EXIT.
 10646
 10647 8800-UNAUTHORIZED-ACCESS.
 10648     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 194
* EL677.cbl
 10649     GO TO 8300-SEND-TEXT.
 10650
 10651 8810-PF23.
 10652     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10653     MOVE XCTL-005               TO  PGM-NAME.
 10654     GO TO 9300-XCTL.
 10655
 10656
 10657 9100-RETURN-TRAN.
 10658     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10659     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10660
 10661* EXEC CICS RETURN
 10662*        TRANSID  (TRANS-ID)
 10663*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10664*        LENGTH   (PI-COMM-LENGTH)
 10665*    END-EXEC.
 10666*    MOVE '.(CT                  ''   #00009437' TO DFHEIV0
 10667     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10669     MOVE X'2020233030303039343337' TO DFHEIV0(25:11)
 10670     CALL 'kxdfhei1' USING DFHEIV0,
 10671           TRANS-ID,
 10672           PROGRAM-INTERFACE-BLOCK,
 10673           PI-COMM-LENGTH,
 10674           DFHEIV99,
 10675           DFHEIV99,
 10676           DFHEIV99
 10677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10678
 10679
 10680
 10681* GOBACK.
 10682     MOVE '9%                    "   ' TO DFHEIV0
 10683     MOVE 'EL677' TO DFHEIV1
 10684     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10685     GOBACK.
 10686
 10687 9200-RETURN-MAIN-MENU.
 10688     MOVE XCTL-626               TO  PGM-NAME.
 10689     GO TO 9300-XCTL.
 10690
 10691 9300-XCTL.
 10692
 10693* EXEC CICS XCTL
 10694*        PROGRAM    (PGM-NAME)
 10695*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10696*        LENGTH     (PI-COMM-LENGTH)
 10697*    END-EXEC.
 10698*    MOVE '.$C                   %   #00009450' TO DFHEIV0
 10699     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10700     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10701     MOVE X'2020233030303039343530' TO DFHEIV0(25:11)
 10702     CALL 'kxdfhei1' USING DFHEIV0,
 10703           PGM-NAME,
 10704           PROGRAM-INTERFACE-BLOCK,
 10705           PI-COMM-LENGTH,
 10706           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 195
* EL677.cbl
 10707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10708
 10709
 10710 9400-CLEAR.
 10711     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10712     MOVE SPACES                 TO  PI-PFKEY.
 10713     GO TO 9300-XCTL.
 10714
 10715 9500-PF12.
 10716     MOVE XCTL-010               TO  PGM-NAME.
 10717     GO TO 9300-XCTL.
 10718
 10719 9600-PGMID-ERROR.
 10720
 10721* EXEC CICS HANDLE CONDITION
 10722*        PGMIDERR    (8300-SEND-TEXT)
 10723*    END-EXEC.
 10724*    MOVE '"$L                   ! 2 #00009466' TO DFHEIV0
 10725     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10726     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10727     MOVE X'3220233030303039343636' TO DFHEIV0(25:11)
 10728     CALL 'kxdfhei1' USING DFHEIV0
 10729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10730
 10731
 10732     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10733     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10734     MOVE XCTL-005               TO  PGM-NAME.
 10735     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10736     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10737
 10738     GO TO 9300-XCTL.
 10739
 10740 9900-ERROR-FORMAT.
 10741     IF NOT EMI-ERRORS-COMPLETE
 10742         MOVE LINK-001           TO  PGM-NAME
 10743
 10744* EXEC CICS LINK
 10745*            PROGRAM    (PGM-NAME)
 10746*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10747*            LENGTH     (EMI-COMM-LENGTH)
 10748*        END-EXEC.
 10749*    MOVE '."C                   (   #00009481' TO DFHEIV0
 10750     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10752     MOVE X'2020233030303039343831' TO DFHEIV0(25:11)
 10753     CALL 'kxdfhei1' USING DFHEIV0,
 10754           PGM-NAME,
 10755           ERROR-MESSAGE-INTERFACE-BLOCK,
 10756           EMI-COMM-LENGTH,
 10757           DFHEIV99,
 10758           DFHEIV99,
 10759           DFHEIV99,
 10760           DFHEIV99
 10761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10762
 10763
 10764 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 196
* EL677.cbl
 10765      EXIT.
 10766
 10767 9990-ABEND.
 10768     MOVE LINK-004               TO  PGM-NAME.
 10769     MOVE DFHEIBLK               TO  EMI-LINE1.
 10770
 10771* EXEC CICS LINK
 10772*        PROGRAM   (PGM-NAME)
 10773*        COMMAREA  (EMI-LINE1)
 10774*        LENGTH    (72)
 10775*    END-EXEC.
 10776     MOVE 72
 10777       TO DFHEIV11
 10778*    MOVE '."C                   (   #00009493' TO DFHEIV0
 10779     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10780     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10781     MOVE X'2020233030303039343933' TO DFHEIV0(25:11)
 10782     CALL 'kxdfhei1' USING DFHEIV0,
 10783           PGM-NAME,
 10784           EMI-LINE1,
 10785           DFHEIV11,
 10786           DFHEIV99,
 10787           DFHEIV99,
 10788           DFHEIV99,
 10789           DFHEIV99
 10790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10791
 10792
 10793     GO TO 8200-SEND-DATAONLY.
 10794
 10795 9995-SECURITY-VIOLATION.
 10796*                            COPY ELCSCTP.
 10797******************************************************************
 10798*                                                                *
 10799*                            ELCSCTP                             *
 10800*                            VMOD=2.001                          *
 10801*                                                                *
 10802*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10803******************************************************************
 10804
 10805
 10806     MOVE EIBDATE          TO SM-JUL-DATE.
 10807     MOVE EIBTRMID         TO SM-TERMID.
 10808     MOVE THIS-PGM         TO SM-PGM.
 10809     MOVE EIBTIME          TO TIME-IN.
 10810     MOVE TIME-OUT         TO SM-TIME.
 10811     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10812
 10813
 10814* EXEC CICS LINK
 10815*         PROGRAM  ('EL003')
 10816*         COMMAREA (SECURITY-MESSAGE)
 10817*         LENGTH   (80)
 10818*    END-EXEC.
 10819     MOVE 'EL003' TO DFHEIV1
 10820     MOVE 80
 10821       TO DFHEIV11
 10822*    MOVE '."C                   (   #00009519' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 197
* EL677.cbl
 10823     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10824     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10825     MOVE X'2020233030303039353139' TO DFHEIV0(25:11)
 10826     CALL 'kxdfhei1' USING DFHEIV0,
 10827           DFHEIV1,
 10828           SECURITY-MESSAGE,
 10829           DFHEIV11,
 10830           DFHEIV99,
 10831           DFHEIV99,
 10832           DFHEIV99,
 10833           DFHEIV99
 10834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10835
 10836
 10837******************************************************************
 10838
 10839
 10840 9995-EXIT.
 10841     EXIT.
 10842
 10843
 10844 9999-DFHBACK SECTION.
 10845     MOVE '9%                    "   ' TO DFHEIV0
 10846     MOVE 'EL677' TO DFHEIV1
 10847     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10848     GOBACK.
 10849 9999-DFHEXIT.
 10850     IF DFHEIGDJ EQUAL 0001
 10851         NEXT SENTENCE
 10852     ELSE IF DFHEIGDJ EQUAL 2
 10853         GO TO 9600-PGMID-ERROR,
 10854               9990-ABEND
 10855         DEPENDING ON DFHEIGDI
 10856     ELSE IF DFHEIGDJ EQUAL 3
 10857         GO TO 8100-SEND-INITIAL-MAP
 10858         DEPENDING ON DFHEIGDI
 10859     ELSE IF DFHEIGDJ EQUAL 4
 10860         GO TO 1290-NO-CARRIER
 10861         DEPENDING ON DFHEIGDI
 10862     ELSE IF DFHEIGDJ EQUAL 5
 10863         GO TO 1380-NO-STATE
 10864         DEPENDING ON DFHEIGDI
 10865     ELSE IF DFHEIGDJ EQUAL 6
 10866         GO TO 1480-ACCOUNT-INVALID,
 10867               1480-ACCOUNT-INVALID
 10868         DEPENDING ON DFHEIGDI
 10869     ELSE IF DFHEIGDJ EQUAL 7
 10870         GO TO 1590-EXIT
 10871         DEPENDING ON DFHEIGDI
 10872     ELSE IF DFHEIGDJ EQUAL 8
 10873         GO TO 2200-DUPREC
 10874         DEPENDING ON DFHEIGDI
 10875     ELSE IF DFHEIGDJ EQUAL 9
 10876         GO TO 3900-RECORD-NOTFND
 10877         DEPENDING ON DFHEIGDI
 10878     ELSE IF DFHEIGDJ EQUAL 10
 10879         GO TO 3287-DUPREC
 10880         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page 198
* EL677.cbl
 10881     ELSE IF DFHEIGDJ EQUAL 11
 10882         GO TO 3300-EXIT,
 10883               3300-EXIT
 10884         DEPENDING ON DFHEIGDI
 10885     ELSE IF DFHEIGDJ EQUAL 12
 10886         GO TO 5560-END-OF-FILE,
 10887               5560-END-OF-FILE
 10888         DEPENDING ON DFHEIGDI
 10889     ELSE IF DFHEIGDJ EQUAL 13
 10890         GO TO 6070-NO-COMP-MSTR
 10891         DEPENDING ON DFHEIGDI
 10892     ELSE IF DFHEIGDJ EQUAL 14
 10893         GO TO 6170-NO-CERTIFICATE
 10894         DEPENDING ON DFHEIGDI
 10895     ELSE IF DFHEIGDJ EQUAL 15
 10896         GO TO 6470-NO-ADDRESS
 10897         DEPENDING ON DFHEIGDI
 10898     ELSE IF DFHEIGDJ EQUAL 16
 10899         GO TO 6670-NO-beneficiary
 10900         DEPENDING ON DFHEIGDI
 10901     ELSE IF DFHEIGDJ EQUAL 17
 10902         GO TO 7300-EXIT
 10903         DEPENDING ON DFHEIGDI
 10904     ELSE IF DFHEIGDJ EQUAL 18
 10905         GO TO 8300-SEND-TEXT
 10906         DEPENDING ON DFHEIGDI.
 10907     MOVE '9%                    "   ' TO DFHEIV0
 10908     MOVE 'EL677' TO DFHEIV1
 10909     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10910     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      141524     Code:       40789
